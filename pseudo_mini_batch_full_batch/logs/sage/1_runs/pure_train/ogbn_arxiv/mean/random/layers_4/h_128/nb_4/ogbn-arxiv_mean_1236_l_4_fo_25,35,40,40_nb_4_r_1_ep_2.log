Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648479638.8163793
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023541927337646484
random selection method range initialization spend 0.006120443344116211
time for parepare:  0.018983125686645508
local_output_nid generation:  0.008335351943969727
local_in_edges_tensor generation:  0.007634878158569336
mini_batch_src_global generation:  0.006546497344970703
r_  generation:  0.08236384391784668
local_output_nid generation:  0.011796236038208008
local_in_edges_tensor generation:  0.0057942867279052734
mini_batch_src_global generation:  0.00882863998413086
r_  generation:  0.08999872207641602
local_output_nid generation:  0.011940479278564453
local_in_edges_tensor generation:  0.005910158157348633
mini_batch_src_global generation:  0.006563901901245117
r_  generation:  0.09083127975463867
local_output_nid generation:  0.01195073127746582
local_in_edges_tensor generation:  0.005896806716918945
mini_batch_src_global generation:  0.00748896598815918
r_  generation:  0.09473013877868652
----------------------check_connections_block total spend ----------------------------- 0.5588092803955078
generate_one_block  0.10126805305480957
generate_one_block  0.10285830497741699
generate_one_block  0.10390257835388184
generate_one_block  0.10396909713745117
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03732776641845703
gen group dst list time:  0.011464834213256836
time for parepare:  0.019214153289794922
local_output_nid generation:  0.019746065139770508
local_in_edges_tensor generation:  0.041573286056518555
mini_batch_src_global generation:  0.038559675216674805
r_  generation:  0.4074852466583252
local_output_nid generation:  0.025870323181152344
local_in_edges_tensor generation:  0.0398561954498291
mini_batch_src_global generation:  0.04814457893371582
r_  generation:  0.4135630130767822
local_output_nid generation:  0.026730060577392578
local_in_edges_tensor generation:  0.03261542320251465
mini_batch_src_global generation:  0.05717062950134277
r_  generation:  0.4271087646484375
local_output_nid generation:  0.026214599609375
local_in_edges_tensor generation:  0.03229117393493652
mini_batch_src_global generation:  0.04907536506652832
r_  generation:  0.42576003074645996
----------------------check_connections_block total spend ----------------------------- 2.5004682540893555
generate_one_block  0.5746638774871826
generate_one_block  0.5350501537322998
generate_one_block  0.5543320178985596
generate_one_block  0.5420656204223633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03213858604431152
gen group dst list time:  0.02104020118713379
time for parepare:  0.018663883209228516
local_output_nid generation:  0.029470443725585938
local_in_edges_tensor generation:  0.044698476791381836
mini_batch_src_global generation:  0.05281472206115723
r_  generation:  0.530487060546875
local_output_nid generation:  0.036835670471191406
local_in_edges_tensor generation:  0.05366015434265137
mini_batch_src_global generation:  0.06039738655090332
r_  generation:  0.543971061706543
local_output_nid generation:  0.0369875431060791
local_in_edges_tensor generation:  0.04458951950073242
mini_batch_src_global generation:  0.05634641647338867
r_  generation:  0.5496175289154053
local_output_nid generation:  0.036812543869018555
local_in_edges_tensor generation:  0.03608989715576172
mini_batch_src_global generation:  0.05672764778137207
r_  generation:  0.5602612495422363
----------------------check_connections_block total spend ----------------------------- 3.225168228149414
generate_one_block  0.686002254486084
generate_one_block  0.6920866966247559
generate_one_block  0.6919364929199219
generate_one_block  0.6815402507781982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025502681732177734
gen group dst list time:  0.02398085594177246
time for parepare:  0.018810272216796875
local_output_nid generation:  0.03305697441101074
local_in_edges_tensor generation:  0.04121994972229004
mini_batch_src_global generation:  0.04492688179016113
r_  generation:  0.5075023174285889
local_output_nid generation:  0.03915071487426758
local_in_edges_tensor generation:  0.04836106300354004
mini_batch_src_global generation:  0.057109832763671875
r_  generation:  0.5151424407958984
local_output_nid generation:  0.04198122024536133
local_in_edges_tensor generation:  0.048276424407958984
mini_batch_src_global generation:  0.05725240707397461
r_  generation:  0.5150115489959717
local_output_nid generation:  0.03904438018798828
local_in_edges_tensor generation:  0.04450416564941406
mini_batch_src_global generation:  0.056629180908203125
r_  generation:  0.5195817947387695
----------------------check_connections_block total spend ----------------------------- 3.0948803424835205
generate_one_block  0.630833625793457
generate_one_block  0.658839225769043
generate_one_block  0.6424286365509033
generate_one_block  0.6605663299560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

connection checking time:  8.82051682472229
block generation total time  7.550345182418823
average batch blocks generation time:  1.8875862956047058
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.1163172721862793  GigaBytes
Max Memory Allocated: 0.1163172721862793  GigaBytes

torch.Size([166672, 128])
torch.Size([164695, 128])
torch.Size([155004, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 1.018458366394043  GigaBytes
Max Memory Allocated: 1.0581612586975098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.1201329231262207  GigaBytes
Max Memory Allocated: 1.1140198707580566  GigaBytes

torch.Size([166690, 128])
torch.Size([164789, 128])
torch.Size([155019, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.0191431045532227  GigaBytes
Max Memory Allocated: 1.1140198707580566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.1211390495300293  GigaBytes
Max Memory Allocated: 1.1145610809326172  GigaBytes

torch.Size([166652, 128])
torch.Size([164721, 128])
torch.Size([155257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.020319938659668  GigaBytes
Max Memory Allocated: 1.1145610809326172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.12159442901611328  GigaBytes
Max Memory Allocated: 1.1163330078125  GigaBytes

torch.Size([166738, 128])
torch.Size([164832, 128])
torch.Size([155169, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.0208673477172852  GigaBytes
Max Memory Allocated: 1.1163330078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060593605041503906 |0.11268883943557739 |0.1801641583442688 |0.00011026859283447266 |0.043444275856018066 |0.004678487777709961 |
----------------------------------------------------------pseudo_mini_loss sum 5.739597320556641
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351985
Number of first layer input nodes during this epoch:  666752
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.18712472915649414  GigaBytes
Max Memory Allocated: 1.1166143417358398  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023573875427246094
random selection method range initialization spend 0.005370140075683594
time for parepare:  0.01842331886291504
local_output_nid generation:  0.008598566055297852
local_in_edges_tensor generation:  0.014510154724121094
mini_batch_src_global generation:  0.006870746612548828
r_  generation:  0.07950067520141602
local_output_nid generation:  0.01154947280883789
local_in_edges_tensor generation:  0.005871295928955078
mini_batch_src_global generation:  0.008773326873779297
r_  generation:  0.08724498748779297
local_output_nid generation:  0.011769294738769531
local_in_edges_tensor generation:  0.0059163570404052734
mini_batch_src_global generation:  0.0066640377044677734
r_  generation:  0.09031176567077637
local_output_nid generation:  0.01173710823059082
local_in_edges_tensor generation:  0.0058519840240478516
mini_batch_src_global generation:  0.007387876510620117
r_  generation:  0.0936272144317627
----------------------check_connections_block total spend ----------------------------- 0.5574800968170166
generate_one_block  0.09998488426208496
generate_one_block  0.10300016403198242
generate_one_block  0.10203766822814941
generate_one_block  0.10283493995666504
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0399785041809082
gen group dst list time:  0.011259078979492188
time for parepare:  0.018779277801513672
local_output_nid generation:  0.019721031188964844
local_in_edges_tensor generation:  0.04631662368774414
mini_batch_src_global generation:  0.04189467430114746
r_  generation:  0.4006524085998535
local_output_nid generation:  0.025618791580200195
local_in_edges_tensor generation:  0.04060053825378418
mini_batch_src_global generation:  0.0521693229675293
r_  generation:  0.41194605827331543
local_output_nid generation:  0.025238037109375
local_in_edges_tensor generation:  0.037615299224853516
mini_batch_src_global generation:  0.04862236976623535
r_  generation:  0.4186422824859619
local_output_nid generation:  0.025374889373779297
local_in_edges_tensor generation:  0.029808998107910156
mini_batch_src_global generation:  0.049910783767700195
r_  generation:  0.4231555461883545
----------------------check_connections_block total spend ----------------------------- 2.484457492828369
generate_one_block  0.5358755588531494
generate_one_block  0.5429623126983643
generate_one_block  0.5614700317382812
generate_one_block  0.55116868019104
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029702186584472656
gen group dst list time:  0.020968914031982422
time for parepare:  0.01892995834350586
local_output_nid generation:  0.02916264533996582
local_in_edges_tensor generation:  0.0440220832824707
mini_batch_src_global generation:  0.04927396774291992
r_  generation:  0.5254466533660889
local_output_nid generation:  0.03986692428588867
local_in_edges_tensor generation:  0.05300164222717285
mini_batch_src_global generation:  0.06055116653442383
r_  generation:  0.55100417137146
local_output_nid generation:  0.040520668029785156
local_in_edges_tensor generation:  0.04035067558288574
mini_batch_src_global generation:  0.062200307846069336
r_  generation:  0.5492761135101318
local_output_nid generation:  0.04047894477844238
local_in_edges_tensor generation:  0.045189619064331055
mini_batch_src_global generation:  0.05631875991821289
r_  generation:  0.5543253421783447
----------------------check_connections_block total spend ----------------------------- 3.241020917892456
generate_one_block  0.6869187355041504
generate_one_block  0.6944832801818848
generate_one_block  0.6917421817779541
generate_one_block  0.693894624710083
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028122663497924805
gen group dst list time:  0.023744821548461914
time for parepare:  0.019407272338867188
local_output_nid generation:  0.033666133880615234
local_in_edges_tensor generation:  0.04251360893249512
mini_batch_src_global generation:  0.04538846015930176
r_  generation:  0.5056538581848145
local_output_nid generation:  0.04270815849304199
local_in_edges_tensor generation:  0.045857906341552734
mini_batch_src_global generation:  0.06366491317749023
r_  generation:  0.5103251934051514
local_output_nid generation:  0.03947138786315918
local_in_edges_tensor generation:  0.05334806442260742
mini_batch_src_global generation:  0.06473875045776367
r_  generation:  0.5229189395904541
local_output_nid generation:  0.04272627830505371
local_in_edges_tensor generation:  0.052822113037109375
mini_batch_src_global generation:  0.06148576736450195
r_  generation:  0.5095400810241699
----------------------check_connections_block total spend ----------------------------- 3.150639057159424
generate_one_block  0.6453230381011963
generate_one_block  0.7058942317962646
generate_one_block  0.6916017532348633
generate_one_block  0.6772494316101074
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.18712472915649414  GigaBytes
Max Memory Allocated: 1.1166143417358398  GigaBytes

connection checking time:  8.876117467880249
block generation total time  7.678583860397339
average batch blocks generation time:  1.9196459650993347
block dataloader generation time/epoch 18.608127117156982
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.1219339370727539  GigaBytes
Max Memory Allocated: 1.1166143417358398  GigaBytes

torch.Size([166728, 128])
torch.Size([164766, 128])
torch.Size([154863, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.0208477973937988  GigaBytes
Max Memory Allocated: 1.1166143417358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.12240743637084961  GigaBytes
Max Memory Allocated: 1.1166143417358398  GigaBytes

torch.Size([166619, 128])
torch.Size([164645, 128])
torch.Size([155048, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.021322250366211  GigaBytes
Max Memory Allocated: 1.1166143417358398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.1223444938659668  GigaBytes
Max Memory Allocated: 1.117105484008789  GigaBytes

torch.Size([166727, 128])
torch.Size([164888, 128])
torch.Size([155384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.0217623710632324  GigaBytes
Max Memory Allocated: 1.117105484008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.12241268157958984  GigaBytes
Max Memory Allocated: 1.1175494194030762  GigaBytes

torch.Size([166682, 128])
torch.Size([164726, 128])
torch.Size([155060, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.021489143371582  GigaBytes
Max Memory Allocated: 1.1175494194030762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06536096334457397 |0.033759355545043945 |0.00527501106262207 |9.381771087646484e-05 |0.016650915145874023 |0.00397801399230957 |
----------------------------------------------------------pseudo_mini_loss sum 3.743685007095337
Total (block generation + training)time/epoch 19.154622316360474
Training time/epoch 0.54618239402771
Training time without block to device /epoch 0.4111449718475342
Training time without total dataloading part /epoch 0.0920569896697998
load block tensor time/epoch 0.2614438533782959
block to device time/epoch 0.13503742218017578
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2351710
Number of first layer input nodes during this epoch:  666756
