Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648493207.9052582
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024211883544921875
random selection method range initialization spend 0.006217241287231445
time for parepare:  0.019217252731323242
local_output_nid generation:  0.008188724517822266
local_in_edges_tensor generation:  0.008620500564575195
mini_batch_src_global generation:  0.0066699981689453125
r_  generation:  0.08339619636535645
local_output_nid generation:  0.011808156967163086
local_in_edges_tensor generation:  0.005935192108154297
mini_batch_src_global generation:  0.008713960647583008
r_  generation:  0.08955979347229004
local_output_nid generation:  0.011968135833740234
local_in_edges_tensor generation:  0.006014347076416016
mini_batch_src_global generation:  0.006529092788696289
r_  generation:  0.09040975570678711
local_output_nid generation:  0.011751174926757812
local_in_edges_tensor generation:  0.006011962890625
mini_batch_src_global generation:  0.00735783576965332
r_  generation:  0.09107756614685059
----------------------check_connections_block total spend ----------------------------- 0.5561323165893555
generate_one_block  0.10059070587158203
generate_one_block  0.10270047187805176
generate_one_block  0.10199689865112305
generate_one_block  0.10151863098144531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0380246639251709
gen group dst list time:  0.011644840240478516
time for parepare:  0.019210100173950195
local_output_nid generation:  0.019330263137817383
local_in_edges_tensor generation:  0.04185676574707031
mini_batch_src_global generation:  0.03832507133483887
r_  generation:  0.4030618667602539
local_output_nid generation:  0.025838851928710938
local_in_edges_tensor generation:  0.040685415267944336
mini_batch_src_global generation:  0.04814887046813965
r_  generation:  0.41921472549438477
local_output_nid generation:  0.025889158248901367
local_in_edges_tensor generation:  0.03231000900268555
mini_batch_src_global generation:  0.04785490036010742
r_  generation:  0.42725062370300293
local_output_nid generation:  0.026041746139526367
local_in_edges_tensor generation:  0.02919769287109375
mini_batch_src_global generation:  0.04932761192321777
r_  generation:  0.42262744903564453
----------------------check_connections_block total spend ----------------------------- 2.486177682876587
generate_one_block  0.5709743499755859
generate_one_block  0.5575160980224609
generate_one_block  0.5353281497955322
generate_one_block  0.5277233123779297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03340649604797363
gen group dst list time:  0.02120804786682129
time for parepare:  0.018636703491210938
local_output_nid generation:  0.02967381477355957
local_in_edges_tensor generation:  0.05498218536376953
mini_batch_src_global generation:  0.05379509925842285
r_  generation:  0.5414650440216064
local_output_nid generation:  0.03646087646484375
local_in_edges_tensor generation:  0.05551719665527344
mini_batch_src_global generation:  0.061784982681274414
r_  generation:  0.5416975021362305
local_output_nid generation:  0.03638863563537598
local_in_edges_tensor generation:  0.04993629455566406
mini_batch_src_global generation:  0.0574488639831543
r_  generation:  0.5556039810180664
local_output_nid generation:  0.036336660385131836
local_in_edges_tensor generation:  0.035980939865112305
mini_batch_src_global generation:  0.06347227096557617
r_  generation:  0.5648088455200195
----------------------check_connections_block total spend ----------------------------- 3.2761754989624023
generate_one_block  0.6827678680419922
generate_one_block  0.6934738159179688
generate_one_block  0.699711799621582
generate_one_block  0.6940839290618896
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027628660202026367
gen group dst list time:  0.024584293365478516
time for parepare:  0.018580198287963867
local_output_nid generation:  0.03267216682434082
local_in_edges_tensor generation:  0.042453765869140625
mini_batch_src_global generation:  0.04938793182373047
r_  generation:  0.5436587333679199
local_output_nid generation:  0.03859281539916992
local_in_edges_tensor generation:  0.04203915596008301
mini_batch_src_global generation:  0.06230640411376953
r_  generation:  0.543813943862915
local_output_nid generation:  0.0386965274810791
local_in_edges_tensor generation:  0.042775630950927734
mini_batch_src_global generation:  0.06285429000854492
r_  generation:  0.546673059463501
local_output_nid generation:  0.03888297080993652
local_in_edges_tensor generation:  0.042327880859375
mini_batch_src_global generation:  0.06176567077636719
r_  generation:  0.5480706691741943
----------------------check_connections_block total spend ----------------------------- 3.2552995681762695
generate_one_block  0.6784019470214844
generate_one_block  0.7198255062103271
generate_one_block  0.6855862140655518
generate_one_block  0.6929786205291748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024998188018798828
gen group dst list time:  0.02501511573791504
time for parepare:  0.019118309020996094
local_output_nid generation:  0.03469061851501465
local_in_edges_tensor generation:  0.0430295467376709
mini_batch_src_global generation:  0.04529261589050293
r_  generation:  0.5087268352508545
local_output_nid generation:  0.04027414321899414
local_in_edges_tensor generation:  0.05293416976928711
mini_batch_src_global generation:  0.05817699432373047
r_  generation:  0.5090186595916748
local_output_nid generation:  0.039681434631347656
local_in_edges_tensor generation:  0.039800167083740234
mini_batch_src_global generation:  0.05776023864746094
r_  generation:  0.5075814723968506
local_output_nid generation:  0.03990507125854492
local_in_edges_tensor generation:  0.04832816123962402
mini_batch_src_global generation:  0.05856633186340332
r_  generation:  0.5313849449157715
----------------------check_connections_block total spend ----------------------------- 3.1146700382232666
generate_one_block  0.6284024715423584
generate_one_block  0.6362404823303223
generate_one_block  0.6410195827484131
generate_one_block  0.6420900821685791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  12.132322788238525
block generation total time  10.286124229431152
average batch blocks generation time:  2.571531057357788
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12977075576782227  GigaBytes
Max Memory Allocated: 0.12977075576782227  GigaBytes

torch.Size([167383, 128])
torch.Size([166873, 128])
torch.Size([164861, 128])
torch.Size([154901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 1.3878464698791504  GigaBytes
Max Memory Allocated: 1.427678108215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.13498783111572266  GigaBytes
Max Memory Allocated: 1.4840178489685059  GigaBytes

torch.Size([167441, 128])
torch.Size([166892, 128])
torch.Size([164907, 128])
torch.Size([155245, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.388411045074463  GigaBytes
Max Memory Allocated: 1.4840178489685059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.13460540771484375  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

torch.Size([167340, 128])
torch.Size([166762, 128])
torch.Size([164705, 128])
torch.Size([154863, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.3880829811096191  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.13510847091674805  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

torch.Size([167435, 128])
torch.Size([166887, 128])
torch.Size([164902, 128])
torch.Size([155000, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.3885412216186523  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04872393608093262 |0.09916770458221436 |0.17707288265228271 |0.00012600421905517578 |0.04401063919067383 |0.0030083656311035156 |
----------------------------------------------------------pseudo_mini_loss sum 5.6021552085876465
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021705
Number of first layer input nodes during this epoch:  669599
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.22826671600341797  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025208711624145508
random selection method range initialization spend 0.005461931228637695
time for parepare:  0.018762588500976562
local_output_nid generation:  0.008242607116699219
local_in_edges_tensor generation:  0.009191036224365234
mini_batch_src_global generation:  0.006607532501220703
r_  generation:  0.08093142509460449
local_output_nid generation:  0.011641502380371094
local_in_edges_tensor generation:  0.006303310394287109
mini_batch_src_global generation:  0.009073257446289062
r_  generation:  0.08816003799438477
local_output_nid generation:  0.011862516403198242
local_in_edges_tensor generation:  0.0061321258544921875
mini_batch_src_global generation:  0.006927490234375
r_  generation:  0.09090805053710938
local_output_nid generation:  0.011870384216308594
local_in_edges_tensor generation:  0.006219148635864258
mini_batch_src_global generation:  0.010266304016113281
r_  generation:  0.09207844734191895
----------------------check_connections_block total spend ----------------------------- 0.5588564872741699
generate_one_block  0.10676002502441406
generate_one_block  0.10233759880065918
generate_one_block  0.10757136344909668
generate_one_block  0.11755967140197754
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05271768569946289
gen group dst list time:  0.015029668807983398
time for parepare:  0.0273435115814209
local_output_nid generation:  0.02323150634765625
local_in_edges_tensor generation:  0.048752546310424805
mini_batch_src_global generation:  0.03936314582824707
r_  generation:  0.40970873832702637
local_output_nid generation:  0.026078224182128906
local_in_edges_tensor generation:  0.04165363311767578
mini_batch_src_global generation:  0.04873156547546387
r_  generation:  0.4179697036743164
local_output_nid generation:  0.0259397029876709
local_in_edges_tensor generation:  0.038480281829833984
mini_batch_src_global generation:  0.04874873161315918
r_  generation:  0.42500829696655273
local_output_nid generation:  0.02585744857788086
local_in_edges_tensor generation:  0.03132319450378418
mini_batch_src_global generation:  0.050176143646240234
r_  generation:  0.4304320812225342
----------------------check_connections_block total spend ----------------------------- 2.533169984817505
generate_one_block  0.5561585426330566
generate_one_block  0.5464627742767334
generate_one_block  0.5799767971038818
generate_one_block  0.5373234748840332
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0488893985748291
gen group dst list time:  0.021405696868896484
time for parepare:  0.01995372772216797
local_output_nid generation:  0.03212714195251465
local_in_edges_tensor generation:  0.05899620056152344
mini_batch_src_global generation:  0.05553269386291504
r_  generation:  0.5497515201568604
local_output_nid generation:  0.03836488723754883
local_in_edges_tensor generation:  0.05559182167053223
mini_batch_src_global generation:  0.06330347061157227
r_  generation:  0.5612373352050781
local_output_nid generation:  0.04410743713378906
local_in_edges_tensor generation:  0.06312680244445801
mini_batch_src_global generation:  0.07825756072998047
r_  generation:  0.5658652782440186
local_output_nid generation:  0.03836989402770996
local_in_edges_tensor generation:  0.04561209678649902
mini_batch_src_global generation:  0.0603938102722168
r_  generation:  0.5782680511474609
----------------------check_connections_block total spend ----------------------------- 3.4121036529541016
generate_one_block  0.7214879989624023
generate_one_block  0.709047794342041
generate_one_block  0.699739933013916
generate_one_block  0.7068827152252197
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04325509071350098
gen group dst list time:  0.027542591094970703
time for parepare:  0.019450664520263672
local_output_nid generation:  0.037720680236816406
local_in_edges_tensor generation:  0.059377431869506836
mini_batch_src_global generation:  0.0756540298461914
r_  generation:  0.560718297958374
local_output_nid generation:  0.04160022735595703
local_in_edges_tensor generation:  0.05996298789978027
mini_batch_src_global generation:  0.06475043296813965
r_  generation:  0.5475184917449951
local_output_nid generation:  0.03945636749267578
local_in_edges_tensor generation:  0.043099164962768555
mini_batch_src_global generation:  0.06917500495910645
r_  generation:  0.5486130714416504
local_output_nid generation:  0.039678335189819336
local_in_edges_tensor generation:  0.038433074951171875
mini_batch_src_global generation:  0.06405305862426758
r_  generation:  0.5528652667999268
----------------------check_connections_block total spend ----------------------------- 3.3640732765197754
generate_one_block  0.6912915706634521
generate_one_block  0.6915605068206787
generate_one_block  0.6849863529205322
generate_one_block  0.6982176303863525
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03585338592529297
gen group dst list time:  0.025175809860229492
time for parepare:  0.01931905746459961
local_output_nid generation:  0.03324079513549805
local_in_edges_tensor generation:  0.05140399932861328
mini_batch_src_global generation:  0.049231767654418945
r_  generation:  0.5043032169342041
local_output_nid generation:  0.039067983627319336
local_in_edges_tensor generation:  0.05238485336303711
mini_batch_src_global generation:  0.05817890167236328
r_  generation:  0.5093398094177246
local_output_nid generation:  0.039266109466552734
local_in_edges_tensor generation:  0.040082693099975586
mini_batch_src_global generation:  0.05862855911254883
r_  generation:  0.5108544826507568
local_output_nid generation:  0.03908109664916992
local_in_edges_tensor generation:  0.03932976722717285
mini_batch_src_global generation:  0.05894160270690918
r_  generation:  0.5146100521087646
----------------------check_connections_block total spend ----------------------------- 3.10581111907959
generate_one_block  0.6474766731262207
generate_one_block  0.6538715362548828
generate_one_block  0.6404645442962646
generate_one_block  0.6513261795043945
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.22826671600341797  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

connection checking time:  12.415158033370972
block generation total time  10.416275024414062
average batch blocks generation time:  2.6040687561035156
block dataloader generation time/epoch 25.182485818862915
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.13598108291625977  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

torch.Size([167469, 128])
torch.Size([166864, 128])
torch.Size([164877, 128])
torch.Size([155070, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.389047622680664  GigaBytes
Max Memory Allocated: 1.4844002723693848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.13584136962890625  GigaBytes
Max Memory Allocated: 1.4846830368041992  GigaBytes

torch.Size([167471, 128])
torch.Size([166901, 128])
torch.Size([164818, 128])
torch.Size([154943, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.388601303100586  GigaBytes
Max Memory Allocated: 1.4846830368041992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.13608026504516602  GigaBytes
Max Memory Allocated: 1.4846830368041992  GigaBytes

torch.Size([167466, 128])
torch.Size([166845, 128])
torch.Size([164751, 128])
torch.Size([154989, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.389153003692627  GigaBytes
Max Memory Allocated: 1.4846830368041992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.1357860565185547  GigaBytes
Max Memory Allocated: 1.485015869140625  GigaBytes

torch.Size([167444, 128])
torch.Size([166822, 128])
torch.Size([164674, 128])
torch.Size([154665, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.3884100914001465  GigaBytes
Max Memory Allocated: 1.485015869140625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07570904493331909 |0.03910517692565918 |0.0061473846435546875 |9.369850158691406e-05 |0.027022898197174072 |0.002930164337158203 |
----------------------------------------------------------pseudo_mini_loss sum 3.8809282779693604
Total (block generation + training)time/epoch 25.861456871032715
Training time/epoch 0.6786842346191406
Training time without block to device /epoch 0.5222635269165039
Training time without total dataloading part /epoch 0.1359860897064209
load block tensor time/epoch 0.30283617973327637
block to device time/epoch 0.15642070770263672
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021376
Number of first layer input nodes during this epoch:  669850
