Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648507691.5704856
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02479243278503418
random selection method range initialization spend 0.006573677062988281
time for parepare:  0.01888298988342285
local_output_nid generation:  0.01592421531677246
local_in_edges_tensor generation:  0.014931917190551758
mini_batch_src_global generation:  0.014126300811767578
r_  generation:  0.17087340354919434
local_output_nid generation:  0.02148151397705078
local_in_edges_tensor generation:  0.015473604202270508
mini_batch_src_global generation:  0.017332077026367188
r_  generation:  0.17978453636169434
----------------------check_connections_block total spend ----------------------------- 0.5472738742828369
generate_one_block  0.19641804695129395
generate_one_block  0.20054411888122559
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04051804542541504
gen group dst list time:  0.007597446441650391
time for parepare:  0.019663572311401367
local_output_nid generation:  0.025232791900634766
local_in_edges_tensor generation:  0.045861005783081055
mini_batch_src_global generation:  0.04639911651611328
r_  generation:  0.49463510513305664
local_output_nid generation:  0.03380227088928223
local_in_edges_tensor generation:  0.047675132751464844
mini_batch_src_global generation:  0.056967973709106445
r_  generation:  0.5093588829040527
----------------------check_connections_block total spend ----------------------------- 1.5105772018432617
generate_one_block  0.6411359310150146
generate_one_block  0.6556527614593506
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.030726194381713867
gen group dst list time:  0.011776208877563477
time for parepare:  0.01891613006591797
local_output_nid generation:  0.029468774795532227
local_in_edges_tensor generation:  0.048723459243774414
mini_batch_src_global generation:  0.05563950538635254
r_  generation:  0.5588791370391846
local_output_nid generation:  0.03737902641296387
local_in_edges_tensor generation:  0.05655717849731445
mini_batch_src_global generation:  0.06414508819580078
r_  generation:  0.5634117126464844
----------------------check_connections_block total spend ----------------------------- 1.6914076805114746
generate_one_block  0.729778528213501
generate_one_block  0.722599983215332
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03596210479736328
gen group dst list time:  0.012553215026855469
time for parepare:  0.019158363342285156
local_output_nid generation:  0.03188180923461914
local_in_edges_tensor generation:  0.04931473731994629
mini_batch_src_global generation:  0.05258631706237793
r_  generation:  0.5593948364257812
local_output_nid generation:  0.0408785343170166
local_in_edges_tensor generation:  0.058077096939086914
mini_batch_src_global generation:  0.0648796558380127
r_  generation:  0.5725796222686768
----------------------check_connections_block total spend ----------------------------- 1.7163679599761963
generate_one_block  0.7037122249603271
generate_one_block  0.7236499786376953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02956986427307129
gen group dst list time:  0.012567758560180664
time for parepare:  0.01921987533569336
local_output_nid generation:  0.032202720642089844
local_in_edges_tensor generation:  0.04498577117919922
mini_batch_src_global generation:  0.053053855895996094
r_  generation:  0.5481770038604736
local_output_nid generation:  0.04112648963928223
local_in_edges_tensor generation:  0.03633832931518555
mini_batch_src_global generation:  0.06351447105407715
r_  generation:  0.5535240173339844
----------------------check_connections_block total spend ----------------------------- 1.6569972038269043
generate_one_block  0.6877706050872803
generate_one_block  0.6898643970489502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027779102325439453
gen group dst list time:  0.012572050094604492
time for parepare:  0.018948078155517578
local_output_nid generation:  0.03229999542236328
local_in_edges_tensor generation:  0.04451894760131836
mini_batch_src_global generation:  0.0457768440246582
r_  generation:  0.5191183090209961
local_output_nid generation:  0.038229942321777344
local_in_edges_tensor generation:  0.053508758544921875
mini_batch_src_global generation:  0.05953168869018555
r_  generation:  0.526299238204956
----------------------check_connections_block total spend ----------------------------- 1.5895111560821533
generate_one_block  0.6446104049682617
generate_one_block  0.6509225368499756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  8.16486120223999
block generation total time  6.8496973514556885
average batch blocks generation time:  3.4248486757278442
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.14707136154174805  GigaBytes
Max Memory Allocated: 0.14707136154174805  GigaBytes

torch.Size([168047, 128])
torch.Size([167918, 32])
torch.Size([167621, 32])
torch.Size([166820, 32])
torch.Size([163005, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.6243515014648438  GigaBytes
Max Memory Allocated: 0.6311273574829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.15569400787353516  GigaBytes
Max Memory Allocated: 0.6477870941162109  GigaBytes

torch.Size([167999, 128])
torch.Size([167878, 32])
torch.Size([167550, 32])
torch.Size([166706, 32])
torch.Size([162834, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.6276993751525879  GigaBytes
Max Memory Allocated: 0.6477870941162109  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.058107733726501465 |0.1778661012649536 |0.3403327465057373 |0.000133514404296875 |0.0473790168762207 |0.0073850154876708984 |
----------------------------------------------------------pseudo_mini_loss sum 5.1846513748168945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1935677
Number of first layer input nodes during this epoch:  336046
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2980375289916992  GigaBytes
Max Memory Allocated: 0.6511712074279785  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02092599868774414
random selection method range initialization spend 0.005599260330200195
time for parepare:  0.02132415771484375
local_output_nid generation:  0.01665782928466797
local_in_edges_tensor generation:  0.01462244987487793
mini_batch_src_global generation:  0.01375126838684082
r_  generation:  0.17514801025390625
local_output_nid generation:  0.02164006233215332
local_in_edges_tensor generation:  0.016218900680541992
mini_batch_src_global generation:  0.025156259536743164
r_  generation:  0.18267393112182617
----------------------check_connections_block total spend ----------------------------- 0.570427417755127
generate_one_block  0.21334123611450195
generate_one_block  0.21267318725585938
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.06139373779296875
gen group dst list time:  0.00720977783203125
time for parepare:  0.018954038619995117
local_output_nid generation:  0.025754690170288086
local_in_edges_tensor generation:  0.07570290565490723
mini_batch_src_global generation:  0.05122232437133789
r_  generation:  0.4982903003692627
local_output_nid generation:  0.03145170211791992
local_in_edges_tensor generation:  0.051132917404174805
mini_batch_src_global generation:  0.05666804313659668
r_  generation:  0.5049161911010742
----------------------check_connections_block total spend ----------------------------- 1.549140453338623
generate_one_block  0.6572704315185547
generate_one_block  0.6600751876831055
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.051157236099243164
gen group dst list time:  0.011789083480834961
time for parepare:  0.018747568130493164
local_output_nid generation:  0.03014969825744629
local_in_edges_tensor generation:  0.055931806564331055
mini_batch_src_global generation:  0.05193781852722168
r_  generation:  0.5633373260498047
local_output_nid generation:  0.03726840019226074
local_in_edges_tensor generation:  0.05792593955993652
mini_batch_src_global generation:  0.06778573989868164
r_  generation:  0.5792179107666016
----------------------check_connections_block total spend ----------------------------- 1.7238514423370361
generate_one_block  0.7549347877502441
generate_one_block  0.7333095073699951
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04785490036010742
gen group dst list time:  0.014609098434448242
time for parepare:  0.01891469955444336
local_output_nid generation:  0.03180336952209473
local_in_edges_tensor generation:  0.06626653671264648
mini_batch_src_global generation:  0.05063271522521973
r_  generation:  0.5631868839263916
local_output_nid generation:  0.037731170654296875
local_in_edges_tensor generation:  0.05650496482849121
mini_batch_src_global generation:  0.06433582305908203
r_  generation:  0.5762939453125
----------------------check_connections_block total spend ----------------------------- 1.7372112274169922
generate_one_block  0.7494053840637207
generate_one_block  0.7364740371704102
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.056821584701538086
gen group dst list time:  0.014791727066040039
time for parepare:  0.01852273941040039
local_output_nid generation:  0.030664682388305664
local_in_edges_tensor generation:  0.05259370803833008
mini_batch_src_global generation:  0.05340719223022461
r_  generation:  0.5489318370819092
local_output_nid generation:  0.03782486915588379
local_in_edges_tensor generation:  0.04289817810058594
mini_batch_src_global generation:  0.06765055656433105
r_  generation:  0.5590147972106934
----------------------check_connections_block total spend ----------------------------- 1.684011697769165
generate_one_block  0.6897656917572021
generate_one_block  0.715688943862915
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04146742820739746
gen group dst list time:  0.012655496597290039
time for parepare:  0.018889904022216797
local_output_nid generation:  0.03292393684387207
local_in_edges_tensor generation:  0.045549869537353516
mini_batch_src_global generation:  0.0470120906829834
r_  generation:  0.5138883590698242
local_output_nid generation:  0.038578033447265625
local_in_edges_tensor generation:  0.038825273513793945
mini_batch_src_global generation:  0.06955194473266602
r_  generation:  0.519453763961792
----------------------check_connections_block total spend ----------------------------- 1.578723430633545
generate_one_block  0.6356174945831299
generate_one_block  0.6488144397735596
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2980375289916992  GigaBytes
Max Memory Allocated: 0.6511712074279785  GigaBytes

connection checking time:  8.272938251495361
block generation total time  6.981355905532837
average batch blocks generation time:  3.4906779527664185
block dataloader generation time/epoch 17.728039264678955
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.1562342643737793  GigaBytes
Max Memory Allocated: 0.6511712074279785  GigaBytes

torch.Size([168044, 128])
torch.Size([167913, 32])
torch.Size([167610, 32])
torch.Size([166795, 32])
torch.Size([162911, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.6284689903259277  GigaBytes
Max Memory Allocated: 0.6511712074279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.1558079719543457  GigaBytes
Max Memory Allocated: 0.651942253112793  GigaBytes

torch.Size([168059, 128])
torch.Size([167928, 32])
torch.Size([167639, 32])
torch.Size([166755, 32])
torch.Size([162866, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.6277222633361816  GigaBytes
Max Memory Allocated: 0.651942253112793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08362042903900146 |0.05360913276672363 |0.007035732269287109 |0.00010883808135986328 |0.007555127143859863 |0.0059735774993896484 |
----------------------------------------------------------pseudo_mini_loss sum 4.665183067321777
Total (block generation + training)time/epoch 18.101751804351807
Training time/epoch 0.37337708473205566
Training time without block to device /epoch 0.2661588191986084
Training time without total dataloading part /epoch 0.03537297248840332
load block tensor time/epoch 0.16724085807800293
block to device time/epoch 0.10721826553344727
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1935650
Number of first layer input nodes during this epoch:  336103
