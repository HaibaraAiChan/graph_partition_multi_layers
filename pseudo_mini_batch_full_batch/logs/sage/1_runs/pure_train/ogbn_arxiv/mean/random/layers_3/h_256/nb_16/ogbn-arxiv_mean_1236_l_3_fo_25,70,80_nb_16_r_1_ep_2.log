Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648444470.1623158
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02818465232849121
random selection method range initialization spend 0.006449460983276367
time for parepare:  0.01880621910095215
local_output_nid generation:  0.0022301673889160156
local_in_edges_tensor generation:  0.006348848342895508
mini_batch_src_global generation:  0.001977205276489258
r_  generation:  0.020509958267211914
local_output_nid generation:  0.002895355224609375
local_in_edges_tensor generation:  0.0017886161804199219
mini_batch_src_global generation:  0.002425670623779297
r_  generation:  0.02140641212463379
local_output_nid generation:  0.003260374069213867
local_in_edges_tensor generation:  0.0018906593322753906
mini_batch_src_global generation:  0.0017189979553222656
r_  generation:  0.021228313446044922
local_output_nid generation:  0.0031554698944091797
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.020541906356811523
local_output_nid generation:  0.003056049346923828
local_in_edges_tensor generation:  0.0015196800231933594
mini_batch_src_global generation:  0.0016014575958251953
r_  generation:  0.0198519229888916
local_output_nid generation:  0.0030105113983154297
local_in_edges_tensor generation:  0.00152587890625
mini_batch_src_global generation:  0.0016634464263916016
r_  generation:  0.021306991577148438
local_output_nid generation:  0.002971649169921875
local_in_edges_tensor generation:  0.001497030258178711
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.020676612854003906
local_output_nid generation:  0.0028700828552246094
local_in_edges_tensor generation:  0.0015087127685546875
mini_batch_src_global generation:  0.0016384124755859375
r_  generation:  0.020842790603637695
local_output_nid generation:  0.0029540061950683594
local_in_edges_tensor generation:  0.0014569759368896484
mini_batch_src_global generation:  0.0017099380493164062
r_  generation:  0.021273136138916016
local_output_nid generation:  0.0028841495513916016
local_in_edges_tensor generation:  0.001575469970703125
mini_batch_src_global generation:  0.0017313957214355469
r_  generation:  0.021192073822021484
local_output_nid generation:  0.0029296875
local_in_edges_tensor generation:  0.0015044212341308594
mini_batch_src_global generation:  0.0017352104187011719
r_  generation:  0.020915508270263672
local_output_nid generation:  0.0028319358825683594
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0017344951629638672
r_  generation:  0.02160167694091797
local_output_nid generation:  0.002907276153564453
local_in_edges_tensor generation:  0.0015766620635986328
mini_batch_src_global generation:  0.0017285346984863281
r_  generation:  0.021715164184570312
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.0017082691192626953
r_  generation:  0.02145528793334961
local_output_nid generation:  0.0029473304748535156
local_in_edges_tensor generation:  0.0015523433685302734
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.021647930145263672
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.0015130043029785156
mini_batch_src_global generation:  0.0017588138580322266
r_  generation:  0.021389007568359375
----------------------check_connections_block total spend ----------------------------- 0.5472853183746338
generate_one_block  0.031230688095092773
generate_one_block  0.031504154205322266
generate_one_block  0.03570294380187988
generate_one_block  0.03160715103149414
generate_one_block  0.02992391586303711
generate_one_block  0.0319216251373291
generate_one_block  0.030752897262573242
generate_one_block  0.03009486198425293
generate_one_block  0.031722307205200195
generate_one_block  0.030918121337890625
generate_one_block  0.03077101707458496
generate_one_block  0.03180551528930664
generate_one_block  0.0316770076751709
generate_one_block  0.03125643730163574
generate_one_block  0.031432390213012695
generate_one_block  0.030849456787109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04370617866516113
gen group dst list time:  0.020694732666015625
time for parepare:  0.0196530818939209
local_output_nid generation:  0.009128808975219727
local_in_edges_tensor generation:  0.022211313247680664
mini_batch_src_global generation:  0.02736663818359375
r_  generation:  0.25521421432495117
local_output_nid generation:  0.013605594635009766
local_in_edges_tensor generation:  0.023845434188842773
mini_batch_src_global generation:  0.03285861015319824
r_  generation:  0.2700226306915283
local_output_nid generation:  0.013309001922607422
local_in_edges_tensor generation:  0.022369861602783203
mini_batch_src_global generation:  0.03569173812866211
r_  generation:  0.2875797748565674
local_output_nid generation:  0.01307535171508789
local_in_edges_tensor generation:  0.01890707015991211
mini_batch_src_global generation:  0.032979726791381836
r_  generation:  0.2754795551300049
local_output_nid generation:  0.015971899032592773
local_in_edges_tensor generation:  0.014336347579956055
mini_batch_src_global generation:  0.03321981430053711
r_  generation:  0.29274511337280273
local_output_nid generation:  0.016354799270629883
local_in_edges_tensor generation:  0.03173542022705078
mini_batch_src_global generation:  0.03558230400085449
r_  generation:  0.2785050868988037
local_output_nid generation:  0.013615608215332031
local_in_edges_tensor generation:  0.018776655197143555
mini_batch_src_global generation:  0.033750057220458984
r_  generation:  0.26893138885498047
local_output_nid generation:  0.013174295425415039
local_in_edges_tensor generation:  0.016567230224609375
mini_batch_src_global generation:  0.033447980880737305
r_  generation:  0.26453065872192383
local_output_nid generation:  0.01363992691040039
local_in_edges_tensor generation:  0.014373779296875
mini_batch_src_global generation:  0.03436875343322754
r_  generation:  0.2719614505767822
local_output_nid generation:  0.013434648513793945
local_in_edges_tensor generation:  0.018594026565551758
mini_batch_src_global generation:  0.035247087478637695
r_  generation:  0.27622437477111816
local_output_nid generation:  0.013449430465698242
local_in_edges_tensor generation:  0.014425516128540039
mini_batch_src_global generation:  0.03463625907897949
r_  generation:  0.27954673767089844
local_output_nid generation:  0.014041662216186523
local_in_edges_tensor generation:  0.018804311752319336
mini_batch_src_global generation:  0.03433084487915039
r_  generation:  0.2927262783050537
local_output_nid generation:  0.014693021774291992
local_in_edges_tensor generation:  0.017110347747802734
mini_batch_src_global generation:  0.03571033477783203
r_  generation:  0.27731800079345703
local_output_nid generation:  0.013817071914672852
local_in_edges_tensor generation:  0.0165708065032959
mini_batch_src_global generation:  0.035576820373535156
r_  generation:  0.277742862701416
local_output_nid generation:  0.013537168502807617
local_in_edges_tensor generation:  0.018726348876953125
mini_batch_src_global generation:  0.03721213340759277
r_  generation:  0.27718496322631836
local_output_nid generation:  0.013589859008789062
local_in_edges_tensor generation:  0.01460719108581543
mini_batch_src_global generation:  0.03503060340881348
r_  generation:  0.2749507427215576
----------------------check_connections_block total spend ----------------------------- 6.4502646923065186
generate_one_block  0.37026095390319824
generate_one_block  0.36213088035583496
generate_one_block  0.37220096588134766
generate_one_block  0.3509643077850342
generate_one_block  0.361680269241333
generate_one_block  0.37329840660095215
generate_one_block  0.36922740936279297
generate_one_block  0.34836912155151367
generate_one_block  0.3647606372833252
generate_one_block  0.3614006042480469
generate_one_block  0.35047149658203125
generate_one_block  0.35872840881347656
generate_one_block  0.3626246452331543
generate_one_block  0.35752344131469727
generate_one_block  0.3660240173339844
generate_one_block  0.3495967388153076
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07539653778076172
gen group dst list time:  0.06981587409973145
time for parepare:  0.01945352554321289
local_output_nid generation:  0.0269012451171875
local_in_edges_tensor generation:  0.05057191848754883
mini_batch_src_global generation:  0.04303598403930664
r_  generation:  0.4862329959869385
local_output_nid generation:  0.033106327056884766
local_in_edges_tensor generation:  0.04909086227416992
mini_batch_src_global generation:  0.052828073501586914
r_  generation:  0.47122907638549805
local_output_nid generation:  0.033551931381225586
local_in_edges_tensor generation:  0.055010080337524414
mini_batch_src_global generation:  0.05135512351989746
r_  generation:  0.4941132068634033
local_output_nid generation:  0.03606843948364258
local_in_edges_tensor generation:  0.04323840141296387
mini_batch_src_global generation:  0.059149742126464844
r_  generation:  0.47195959091186523
local_output_nid generation:  0.03359699249267578
local_in_edges_tensor generation:  0.038851261138916016
mini_batch_src_global generation:  0.052169084548950195
r_  generation:  0.472240686416626
local_output_nid generation:  0.03372931480407715
local_in_edges_tensor generation:  0.03477048873901367
mini_batch_src_global generation:  0.05632638931274414
r_  generation:  0.47350502014160156
local_output_nid generation:  0.03354024887084961
local_in_edges_tensor generation:  0.044707536697387695
mini_batch_src_global generation:  0.053469181060791016
r_  generation:  0.48067188262939453
local_output_nid generation:  0.03383922576904297
local_in_edges_tensor generation:  0.03198409080505371
mini_batch_src_global generation:  0.05435371398925781
r_  generation:  0.47269511222839355
local_output_nid generation:  0.03341031074523926
local_in_edges_tensor generation:  0.032462120056152344
mini_batch_src_global generation:  0.053189992904663086
r_  generation:  0.4783296585083008
local_output_nid generation:  0.034334421157836914
local_in_edges_tensor generation:  0.04038190841674805
mini_batch_src_global generation:  0.053859710693359375
r_  generation:  0.4796173572540283
local_output_nid generation:  0.03365373611450195
local_in_edges_tensor generation:  0.036049604415893555
mini_batch_src_global generation:  0.05286884307861328
r_  generation:  0.48255085945129395
local_output_nid generation:  0.03386640548706055
local_in_edges_tensor generation:  0.05089831352233887
mini_batch_src_global generation:  0.054197072982788086
r_  generation:  0.4854581356048584
local_output_nid generation:  0.03462529182434082
local_in_edges_tensor generation:  0.0446314811706543
mini_batch_src_global generation:  0.07024860382080078
r_  generation:  0.4907517433166504
local_output_nid generation:  0.03618431091308594
local_in_edges_tensor generation:  0.038286685943603516
mini_batch_src_global generation:  0.053733110427856445
r_  generation:  0.48058128356933594
local_output_nid generation:  0.033699750900268555
local_in_edges_tensor generation:  0.03255915641784668
mini_batch_src_global generation:  0.05342388153076172
r_  generation:  0.4838223457336426
local_output_nid generation:  0.033858537673950195
local_in_edges_tensor generation:  0.04221534729003906
mini_batch_src_global generation:  0.05334162712097168
r_  generation:  0.47937655448913574
----------------------check_connections_block total spend ----------------------------- 11.486191987991333
generate_one_block  0.6038925647735596
generate_one_block  0.5881319046020508
generate_one_block  0.6248931884765625
generate_one_block  0.6103601455688477
generate_one_block  0.5822057723999023
generate_one_block  0.607917308807373
generate_one_block  0.6541593074798584
generate_one_block  0.58831787109375
generate_one_block  0.5890347957611084
generate_one_block  0.6024329662322998
generate_one_block  0.5939359664916992
generate_one_block  0.6052095890045166
generate_one_block  0.5962197780609131
generate_one_block  0.5848567485809326
generate_one_block  0.5979278087615967
generate_one_block  0.5996289253234863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  17.93645668029785
block generation total time  15.408386945724487
average batch blocks generation time:  0.9630241841077805
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09324359893798828  GigaBytes
Max Memory Allocated: 0.09324359893798828  GigaBytes

torch.Size([156511, 128])
torch.Size([129500, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 0.7636170387268066  GigaBytes
Max Memory Allocated: 0.8052268028259277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5330810546875 GB
    Memory Allocated: 0.09601020812988281  GigaBytes
Max Memory Allocated: 0.8510675430297852  GigaBytes

torch.Size([157150, 128])
torch.Size([130280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5330810546875 GB
    Memory Allocated: 0.7704434394836426  GigaBytes
Max Memory Allocated: 0.8510675430297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09620857238769531  GigaBytes
Max Memory Allocated: 0.8579425811767578  GigaBytes

torch.Size([157166, 128])
torch.Size([130781, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7749691009521484  GigaBytes
Max Memory Allocated: 0.8579425811767578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09594106674194336  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157131, 128])
torch.Size([130161, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7690901756286621  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09555339813232422  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156680, 128])
torch.Size([129249, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7584633827209473  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09613370895385742  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157141, 128])
torch.Size([130240, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7731714248657227  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09586000442504883  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157087, 128])
torch.Size([130223, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7673702239990234  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09564399719238281  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156924, 128])
torch.Size([129765, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7607064247131348  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09566450119018555  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156357, 128])
torch.Size([129114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7620329856872559  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09593534469604492  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157043, 128])
torch.Size([130077, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7691149711608887  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09581279754638672  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156974, 128])
torch.Size([129965, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7636294364929199  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09610748291015625  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157364, 128])
torch.Size([130899, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7737398147583008  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09595251083374023  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157005, 128])
torch.Size([130070, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7689838409423828  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09595537185668945  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157059, 128])
torch.Size([129998, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7675056457519531  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09584188461303711  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156783, 128])
torch.Size([129858, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7649116516113281  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09577465057373047  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156846, 128])
torch.Size([129856, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7636933326721191  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05982774496078491 |0.03552307188510895 |0.04964224994182587 |9.638071060180664e-05 |0.011252880096435547 |0.001720428466796875 |
----------------------------------------------------------pseudo_mini_loss sum 6.280045032501221
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5321686
Number of first layer input nodes during this epoch:  2511221
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.12307977676391602  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021065950393676758
random selection method range initialization spend 0.005609750747680664
time for parepare:  0.017814159393310547
local_output_nid generation:  0.002296924591064453
local_in_edges_tensor generation:  0.008624076843261719
mini_batch_src_global generation:  0.0019960403442382812
r_  generation:  0.02030038833618164
local_output_nid generation:  0.003093719482421875
local_in_edges_tensor generation:  0.001734018325805664
mini_batch_src_global generation:  0.002404451370239258
r_  generation:  0.02108001708984375
local_output_nid generation:  0.0031206607818603516
local_in_edges_tensor generation:  0.001627206802368164
mini_batch_src_global generation:  0.0015597343444824219
r_  generation:  0.020875215530395508
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.001558542251586914
mini_batch_src_global generation:  0.0015757083892822266
r_  generation:  0.02097153663635254
local_output_nid generation:  0.002947568893432617
local_in_edges_tensor generation:  0.0015537738800048828
mini_batch_src_global generation:  0.0015828609466552734
r_  generation:  0.021360158920288086
local_output_nid generation:  0.002972841262817383
local_in_edges_tensor generation:  0.0015244483947753906
mini_batch_src_global generation:  0.0016047954559326172
r_  generation:  0.021134614944458008
local_output_nid generation:  0.002970457077026367
local_in_edges_tensor generation:  0.0015404224395751953
mini_batch_src_global generation:  0.0016808509826660156
r_  generation:  0.02206897735595703
local_output_nid generation:  0.0030074119567871094
local_in_edges_tensor generation:  0.0015437602996826172
mini_batch_src_global generation:  0.0016765594482421875
r_  generation:  0.020985126495361328
local_output_nid generation:  0.0029959678649902344
local_in_edges_tensor generation:  0.0015769004821777344
mini_batch_src_global generation:  0.0016636848449707031
r_  generation:  0.021933555603027344
local_output_nid generation:  0.0029764175415039062
local_in_edges_tensor generation:  0.0015416145324707031
mini_batch_src_global generation:  0.0016765594482421875
r_  generation:  0.021940946578979492
local_output_nid generation:  0.002984285354614258
local_in_edges_tensor generation:  0.0015108585357666016
mini_batch_src_global generation:  0.0017375946044921875
r_  generation:  0.021592378616333008
local_output_nid generation:  0.00299835205078125
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.0017066001892089844
r_  generation:  0.021567106246948242
local_output_nid generation:  0.0029642581939697266
local_in_edges_tensor generation:  0.0015187263488769531
mini_batch_src_global generation:  0.001756429672241211
r_  generation:  0.022003173828125
local_output_nid generation:  0.0029611587524414062
local_in_edges_tensor generation:  0.0015244483947753906
mini_batch_src_global generation:  0.0017523765563964844
r_  generation:  0.022838592529296875
local_output_nid generation:  0.002964019775390625
local_in_edges_tensor generation:  0.0016200542449951172
mini_batch_src_global generation:  0.0017330646514892578
r_  generation:  0.02160334587097168
local_output_nid generation:  0.0030031204223632812
local_in_edges_tensor generation:  0.001560211181640625
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.02170419692993164
----------------------check_connections_block total spend ----------------------------- 0.5581557750701904
generate_one_block  0.033843040466308594
generate_one_block  0.03200697898864746
generate_one_block  0.03124213218688965
generate_one_block  0.03171563148498535
generate_one_block  0.03132891654968262
generate_one_block  0.033426761627197266
generate_one_block  0.03158068656921387
generate_one_block  0.030425310134887695
generate_one_block  0.03165435791015625
generate_one_block  0.03119659423828125
generate_one_block  0.031209707260131836
generate_one_block  0.030654191970825195
generate_one_block  0.03140091896057129
generate_one_block  0.03192424774169922
generate_one_block  0.03107905387878418
generate_one_block  0.031946420669555664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038635969161987305
gen group dst list time:  0.019501686096191406
time for parepare:  0.019159555435180664
local_output_nid generation:  0.009116411209106445
local_in_edges_tensor generation:  0.02579045295715332
mini_batch_src_global generation:  0.0252532958984375
r_  generation:  0.25397825241088867
local_output_nid generation:  0.013102531433105469
local_in_edges_tensor generation:  0.023482084274291992
mini_batch_src_global generation:  0.03251957893371582
r_  generation:  0.27399539947509766
local_output_nid generation:  0.013593912124633789
local_in_edges_tensor generation:  0.018999576568603516
mini_batch_src_global generation:  0.03135418891906738
r_  generation:  0.2668490409851074
local_output_nid generation:  0.013536930084228516
local_in_edges_tensor generation:  0.01919722557067871
mini_batch_src_global generation:  0.03239870071411133
r_  generation:  0.27507591247558594
local_output_nid generation:  0.013216018676757812
local_in_edges_tensor generation:  0.016313791275024414
mini_batch_src_global generation:  0.033783912658691406
r_  generation:  0.27826571464538574
local_output_nid generation:  0.013834238052368164
local_in_edges_tensor generation:  0.02457427978515625
mini_batch_src_global generation:  0.037187814712524414
r_  generation:  0.2875528335571289
local_output_nid generation:  0.015324831008911133
local_in_edges_tensor generation:  0.02143263816833496
mini_batch_src_global generation:  0.03382420539855957
r_  generation:  0.27254796028137207
local_output_nid generation:  0.013201236724853516
local_in_edges_tensor generation:  0.015906333923339844
mini_batch_src_global generation:  0.0333707332611084
r_  generation:  0.26929593086242676
local_output_nid generation:  0.013328790664672852
local_in_edges_tensor generation:  0.016005516052246094
mini_batch_src_global generation:  0.035689592361450195
r_  generation:  0.27187061309814453
local_output_nid generation:  0.013242006301879883
local_in_edges_tensor generation:  0.018373489379882812
mini_batch_src_global generation:  0.03394126892089844
r_  generation:  0.2938046455383301
local_output_nid generation:  0.013170003890991211
local_in_edges_tensor generation:  0.015839338302612305
mini_batch_src_global generation:  0.03429722785949707
r_  generation:  0.27381110191345215
local_output_nid generation:  0.013252019882202148
local_in_edges_tensor generation:  0.01579117774963379
mini_batch_src_global generation:  0.0363924503326416
r_  generation:  0.28017377853393555
local_output_nid generation:  0.01345062255859375
local_in_edges_tensor generation:  0.01864337921142578
mini_batch_src_global generation:  0.03473973274230957
r_  generation:  0.2818644046783447
local_output_nid generation:  0.013477325439453125
local_in_edges_tensor generation:  0.01638054847717285
mini_batch_src_global generation:  0.03740096092224121
r_  generation:  0.2891426086425781
local_output_nid generation:  0.014450550079345703
local_in_edges_tensor generation:  0.014039039611816406
mini_batch_src_global generation:  0.034256696701049805
r_  generation:  0.2722175121307373
local_output_nid generation:  0.013374567031860352
local_in_edges_tensor generation:  0.013900041580200195
mini_batch_src_global generation:  0.03823351860046387
r_  generation:  0.28849053382873535
----------------------check_connections_block total spend ----------------------------- 6.435171365737915
generate_one_block  0.3717043399810791
generate_one_block  0.3824286460876465
generate_one_block  0.3591156005859375
generate_one_block  0.358872652053833
generate_one_block  0.35715341567993164
generate_one_block  0.3481450080871582
generate_one_block  0.40383148193359375
generate_one_block  0.3489096164703369
generate_one_block  0.3543579578399658
generate_one_block  0.35813188552856445
generate_one_block  0.36802244186401367
generate_one_block  0.3526160717010498
generate_one_block  0.3546891212463379
generate_one_block  0.3688974380493164
generate_one_block  0.3434112071990967
generate_one_block  0.34632015228271484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04360461235046387
gen group dst list time:  0.07035660743713379
time for parepare:  0.018941879272460938
local_output_nid generation:  0.028024673461914062
local_in_edges_tensor generation:  0.06009221076965332
mini_batch_src_global generation:  0.042951107025146484
r_  generation:  0.4680161476135254
local_output_nid generation:  0.03274130821228027
local_in_edges_tensor generation:  0.04816699028015137
mini_batch_src_global generation:  0.05320549011230469
r_  generation:  0.46215009689331055
local_output_nid generation:  0.032943010330200195
local_in_edges_tensor generation:  0.03628826141357422
mini_batch_src_global generation:  0.05113577842712402
r_  generation:  0.46812009811401367
local_output_nid generation:  0.033159732818603516
local_in_edges_tensor generation:  0.03501605987548828
mini_batch_src_global generation:  0.05139279365539551
r_  generation:  0.4781346321105957
local_output_nid generation:  0.03381037712097168
local_in_edges_tensor generation:  0.08609676361083984
mini_batch_src_global generation:  0.05576801300048828
r_  generation:  0.4835236072540283
local_output_nid generation:  0.03283214569091797
local_in_edges_tensor generation:  0.0476224422454834
mini_batch_src_global generation:  0.06273794174194336
r_  generation:  0.4832737445831299
local_output_nid generation:  0.0360713005065918
local_in_edges_tensor generation:  0.038385868072509766
mini_batch_src_global generation:  0.05664491653442383
r_  generation:  0.47750091552734375
local_output_nid generation:  0.0332026481628418
local_in_edges_tensor generation:  0.0351407527923584
mini_batch_src_global generation:  0.053264617919921875
r_  generation:  0.47664403915405273
local_output_nid generation:  0.03343534469604492
local_in_edges_tensor generation:  0.04015493392944336
mini_batch_src_global generation:  0.05335545539855957
r_  generation:  0.47832751274108887
local_output_nid generation:  0.033304452896118164
local_in_edges_tensor generation:  0.0400388240814209
mini_batch_src_global generation:  0.05367088317871094
r_  generation:  0.47740674018859863
local_output_nid generation:  0.03369736671447754
local_in_edges_tensor generation:  0.03519892692565918
mini_batch_src_global generation:  0.05308794975280762
r_  generation:  0.4944443702697754
local_output_nid generation:  0.03393149375915527
local_in_edges_tensor generation:  0.03490638732910156
mini_batch_src_global generation:  0.05352926254272461
r_  generation:  0.48910069465637207
local_output_nid generation:  0.03390622138977051
local_in_edges_tensor generation:  0.03604555130004883
mini_batch_src_global generation:  0.05346345901489258
r_  generation:  0.4784255027770996
local_output_nid generation:  0.03391122817993164
local_in_edges_tensor generation:  0.03997445106506348
mini_batch_src_global generation:  0.056301116943359375
r_  generation:  0.4820249080657959
local_output_nid generation:  0.03369331359863281
local_in_edges_tensor generation:  0.032012224197387695
mini_batch_src_global generation:  0.05356931686401367
r_  generation:  0.4870331287384033
local_output_nid generation:  0.03436136245727539
local_in_edges_tensor generation:  0.03145742416381836
mini_batch_src_global generation:  0.05434775352478027
r_  generation:  0.47724223136901855
----------------------check_connections_block total spend ----------------------------- 11.430957794189453
generate_one_block  0.6008074283599854
generate_one_block  0.6069912910461426
generate_one_block  0.6105060577392578
generate_one_block  0.6084475517272949
generate_one_block  0.6009228229522705
generate_one_block  0.6091718673706055
generate_one_block  0.5963194370269775
generate_one_block  0.5911741256713867
generate_one_block  0.62972092628479
generate_one_block  0.596433162689209
generate_one_block  0.5935556888580322
generate_one_block  0.6010746955871582
generate_one_block  0.599200963973999
generate_one_block  0.6063807010650635
generate_one_block  0.5988917350769043
generate_one_block  0.5940473079681396
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.12307977676391602  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

connection checking time:  17.866129159927368
block generation total time  15.420252799987793
average batch blocks generation time:  0.9637657999992371
block dataloader generation time/epoch 35.559481382369995
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09763574600219727  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([157050, 128])
torch.Size([130436, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7744917869567871  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09759950637817383  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

torch.Size([156925, 128])
torch.Size([130530, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7757210731506348  GigaBytes
Max Memory Allocated: 0.8643770217895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09754705429077148  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156859, 128])
torch.Size([129951, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7686948776245117  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974588394165039  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156720, 128])
torch.Size([129938, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7688770294189453  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09769201278686523  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([157175, 128])
torch.Size([130499, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7718520164489746  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09749126434326172  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([157048, 128])
torch.Size([130464, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7693967819213867  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09745979309082031  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156816, 128])
torch.Size([129703, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7666168212890625  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09707212448120117  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156521, 128])
torch.Size([129189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7600235939025879  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751510620117188  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156952, 128])
torch.Size([130291, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7708759307861328  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0973353385925293  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156649, 128])
torch.Size([130048, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7694892883300781  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09734678268432617  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156783, 128])
torch.Size([129929, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655677795410156  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09750175476074219  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156972, 128])
torch.Size([129599, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7655477523803711  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09751653671264648  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156873, 128])
torch.Size([130593, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7721133232116699  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09768199920654297  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156812, 128])
torch.Size([130534, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7753539085388184  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.0974264144897461  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156998, 128])
torch.Size([129824, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7644743919372559  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09739875793457031  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

torch.Size([156994, 128])
torch.Size([129787, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7658743858337402  GigaBytes
Max Memory Allocated: 0.8649153709411621  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0670618861913681 |0.014310359954833984 |0.0036400258541107178 |9.527802467346191e-05 |0.004630789160728455 |0.0029404163360595703 |
----------------------------------------------------------pseudo_mini_loss sum 3.2375526428222656
Total (block generation + training)time/epoch 37.06100583076477
Training time/epoch 1.5012359619140625
Training time without block to device /epoch 1.2722702026367188
Training time without total dataloading part /epoch 0.13679790496826172
load block tensor time/epoch 1.0729901790618896
block to device time/epoch 0.22896575927734375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5322821
Number of first layer input nodes during this epoch:  2510147
