Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648478911.755406
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024596452713012695
random selection method range initialization spend 0.005563259124755859
time for parepare:  0.01854419708251953
local_output_nid generation:  0.002131938934326172
local_in_edges_tensor generation:  0.00473332405090332
mini_batch_src_global generation:  0.0017654895782470703
r_  generation:  0.018509626388549805
local_output_nid generation:  0.00266265869140625
local_in_edges_tensor generation:  0.0016422271728515625
mini_batch_src_global generation:  0.0021965503692626953
r_  generation:  0.018126249313354492
local_output_nid generation:  0.0028123855590820312
local_in_edges_tensor generation:  0.001615762710571289
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.017520904541015625
local_output_nid generation:  0.0028886795043945312
local_in_edges_tensor generation:  0.0014994144439697266
mini_batch_src_global generation:  0.0013344287872314453
r_  generation:  0.018161535263061523
local_output_nid generation:  0.0028524398803710938
local_in_edges_tensor generation:  0.0014731884002685547
mini_batch_src_global generation:  0.0013780593872070312
r_  generation:  0.018160581588745117
local_output_nid generation:  0.0029244422912597656
local_in_edges_tensor generation:  0.0014865398406982422
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.018520116806030273
local_output_nid generation:  0.0029578208923339844
local_in_edges_tensor generation:  0.0014803409576416016
mini_batch_src_global generation:  0.0014922618865966797
r_  generation:  0.018430233001708984
local_output_nid generation:  0.0028429031372070312
local_in_edges_tensor generation:  0.0015189647674560547
mini_batch_src_global generation:  0.0014927387237548828
r_  generation:  0.019002914428710938
local_output_nid generation:  0.0029344558715820312
local_in_edges_tensor generation:  0.0015294551849365234
mini_batch_src_global generation:  0.0015006065368652344
r_  generation:  0.018874406814575195
local_output_nid generation:  0.0029408931732177734
local_in_edges_tensor generation:  0.0014674663543701172
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.019237041473388672
local_output_nid generation:  0.0028810501098632812
local_in_edges_tensor generation:  0.0014591217041015625
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.01880669593811035
local_output_nid generation:  0.0028603076934814453
local_in_edges_tensor generation:  0.0014731884002685547
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.019340038299560547
local_output_nid generation:  0.002847909927368164
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0014994144439697266
r_  generation:  0.0186614990234375
local_output_nid generation:  0.0028743743896484375
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.01953411102294922
local_output_nid generation:  0.0028989315032958984
local_in_edges_tensor generation:  0.0014739036560058594
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.01875138282775879
local_output_nid generation:  0.002949953079223633
local_in_edges_tensor generation:  0.0014998912811279297
mini_batch_src_global generation:  0.0015308856964111328
r_  generation:  0.019321918487548828
----------------------check_connections_block total spend ----------------------------- 0.49202752113342285
generate_one_block  0.02696824073791504
generate_one_block  0.028193235397338867
generate_one_block  0.029699087142944336
generate_one_block  0.02789139747619629
generate_one_block  0.027484893798828125
generate_one_block  0.0279080867767334
generate_one_block  0.027596473693847656
generate_one_block  0.027811527252197266
generate_one_block  0.028130531311035156
generate_one_block  0.028176307678222656
generate_one_block  0.02787923812866211
generate_one_block  0.02856135368347168
generate_one_block  0.027019977569580078
generate_one_block  0.02824854850769043
generate_one_block  0.027621746063232422
generate_one_block  0.027593612670898438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04188203811645508
gen group dst list time:  0.018727779388427734
time for parepare:  0.01929950714111328
local_output_nid generation:  0.008146524429321289
local_in_edges_tensor generation:  0.019344806671142578
mini_batch_src_global generation:  0.021096467971801758
r_  generation:  0.19585442543029785
local_output_nid generation:  0.013625383377075195
local_in_edges_tensor generation:  0.02043008804321289
mini_batch_src_global generation:  0.025166749954223633
r_  generation:  0.2062840461730957
local_output_nid generation:  0.013373136520385742
local_in_edges_tensor generation:  0.016692399978637695
mini_batch_src_global generation:  0.023787260055541992
r_  generation:  0.20729374885559082
local_output_nid generation:  0.013461828231811523
local_in_edges_tensor generation:  0.01459360122680664
mini_batch_src_global generation:  0.027597665786743164
r_  generation:  0.20938658714294434
local_output_nid generation:  0.013606548309326172
local_in_edges_tensor generation:  0.017102479934692383
mini_batch_src_global generation:  0.025937318801879883
r_  generation:  0.21442484855651855
local_output_nid generation:  0.013602018356323242
local_in_edges_tensor generation:  0.018245935440063477
mini_batch_src_global generation:  0.02671027183532715
r_  generation:  0.21572494506835938
local_output_nid generation:  0.013565778732299805
local_in_edges_tensor generation:  0.013368844985961914
mini_batch_src_global generation:  0.026510953903198242
r_  generation:  0.21317100524902344
local_output_nid generation:  0.013762950897216797
local_in_edges_tensor generation:  0.019008636474609375
mini_batch_src_global generation:  0.026964664459228516
r_  generation:  0.2183699607849121
local_output_nid generation:  0.013831853866577148
local_in_edges_tensor generation:  0.01523137092590332
mini_batch_src_global generation:  0.028041839599609375
r_  generation:  0.22113490104675293
local_output_nid generation:  0.013823270797729492
local_in_edges_tensor generation:  0.013503789901733398
mini_batch_src_global generation:  0.0275118350982666
r_  generation:  0.21804380416870117
local_output_nid generation:  0.013522148132324219
local_in_edges_tensor generation:  0.014784097671508789
mini_batch_src_global generation:  0.026949405670166016
r_  generation:  0.2113478183746338
local_output_nid generation:  0.013796091079711914
local_in_edges_tensor generation:  0.01700305938720703
mini_batch_src_global generation:  0.02732992172241211
r_  generation:  0.2247600555419922
local_output_nid generation:  0.013609647750854492
local_in_edges_tensor generation:  0.014824390411376953
mini_batch_src_global generation:  0.027188777923583984
r_  generation:  0.21397185325622559
local_output_nid generation:  0.013895273208618164
local_in_edges_tensor generation:  0.016857385635375977
mini_batch_src_global generation:  0.0273590087890625
r_  generation:  0.22217035293579102
local_output_nid generation:  0.013712406158447266
local_in_edges_tensor generation:  0.014124870300292969
mini_batch_src_global generation:  0.03093409538269043
r_  generation:  0.21825361251831055
local_output_nid generation:  0.01390528678894043
local_in_edges_tensor generation:  0.013817071914672852
mini_batch_src_global generation:  0.027927875518798828
r_  generation:  0.22142362594604492
----------------------check_connections_block total spend ----------------------------- 5.099609375
generate_one_block  0.2786269187927246
generate_one_block  0.287930965423584
generate_one_block  0.27462244033813477
generate_one_block  0.2758667469024658
generate_one_block  0.3007388114929199
generate_one_block  0.2784109115600586
generate_one_block  0.27691006660461426
generate_one_block  0.2841629981994629
generate_one_block  0.292008638381958
generate_one_block  0.2794821262359619
generate_one_block  0.270322322845459
generate_one_block  0.2884833812713623
generate_one_block  0.2730581760406494
generate_one_block  0.2869143486022949
generate_one_block  0.2838633060455322
generate_one_block  0.2865452766418457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05554676055908203
gen group dst list time:  0.0633242130279541
time for parepare:  0.020351409912109375
local_output_nid generation:  0.026120662689208984
local_in_edges_tensor generation:  0.05868721008300781
mini_batch_src_global generation:  0.04862856864929199
r_  generation:  0.4743647575378418
local_output_nid generation:  0.032071590423583984
local_in_edges_tensor generation:  0.04907369613647461
mini_batch_src_global generation:  0.055779457092285156
r_  generation:  0.4790830612182617
local_output_nid generation:  0.03102421760559082
local_in_edges_tensor generation:  0.03635263442993164
mini_batch_src_global generation:  0.054435014724731445
r_  generation:  0.48954176902770996
local_output_nid generation:  0.031397342681884766
local_in_edges_tensor generation:  0.03815293312072754
mini_batch_src_global generation:  0.055585622787475586
r_  generation:  0.4849827289581299
local_output_nid generation:  0.030913114547729492
local_in_edges_tensor generation:  0.04029035568237305
mini_batch_src_global generation:  0.059066057205200195
r_  generation:  0.49158716201782227
local_output_nid generation:  0.03109598159790039
local_in_edges_tensor generation:  0.0359950065612793
mini_batch_src_global generation:  0.05640006065368652
r_  generation:  0.49330806732177734
local_output_nid generation:  0.031093597412109375
local_in_edges_tensor generation:  0.04173851013183594
mini_batch_src_global generation:  0.06331634521484375
r_  generation:  0.48986101150512695
local_output_nid generation:  0.031093835830688477
local_in_edges_tensor generation:  0.043468475341796875
mini_batch_src_global generation:  0.05652737617492676
r_  generation:  0.49305009841918945
local_output_nid generation:  0.03713369369506836
local_in_edges_tensor generation:  0.037819862365722656
mini_batch_src_global generation:  0.06931281089782715
r_  generation:  0.49970030784606934
local_output_nid generation:  0.03220558166503906
local_in_edges_tensor generation:  0.03636479377746582
mini_batch_src_global generation:  0.057091712951660156
r_  generation:  0.49189114570617676
local_output_nid generation:  0.03229331970214844
local_in_edges_tensor generation:  0.03621721267700195
mini_batch_src_global generation:  0.0556035041809082
r_  generation:  0.5001709461212158
local_output_nid generation:  0.032685041427612305
local_in_edges_tensor generation:  0.03628087043762207
mini_batch_src_global generation:  0.05713367462158203
r_  generation:  0.49048948287963867
local_output_nid generation:  0.03220033645629883
local_in_edges_tensor generation:  0.03689432144165039
mini_batch_src_global generation:  0.05713033676147461
r_  generation:  0.49689340591430664
local_output_nid generation:  0.0329747200012207
local_in_edges_tensor generation:  0.040349721908569336
mini_batch_src_global generation:  0.057390451431274414
r_  generation:  0.49262452125549316
local_output_nid generation:  0.0331571102142334
local_in_edges_tensor generation:  0.032866477966308594
mini_batch_src_global generation:  0.056552886962890625
r_  generation:  0.5094623565673828
local_output_nid generation:  0.03330063819885254
local_in_edges_tensor generation:  0.03577589988708496
mini_batch_src_global generation:  0.0576016902923584
r_  generation:  0.49912452697753906
----------------------check_connections_block total spend ----------------------------- 11.633105993270874
generate_one_block  0.6280746459960938
generate_one_block  0.645056962966919
generate_one_block  0.624852180480957
generate_one_block  0.6357076168060303
generate_one_block  0.6313714981079102
generate_one_block  0.6301324367523193
generate_one_block  0.6774075031280518
generate_one_block  0.6366264820098877
generate_one_block  0.6389672756195068
generate_one_block  0.6304917335510254
generate_one_block  0.6144626140594482
generate_one_block  0.6310269832611084
generate_one_block  0.6322972774505615
generate_one_block  0.6332037448883057
generate_one_block  0.6274693012237549
generate_one_block  0.6351261138916016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032175302505493164
gen group dst list time:  0.0890512466430664
time for parepare:  0.01935863494873047
local_output_nid generation:  0.03323173522949219
local_in_edges_tensor generation:  0.0484471321105957
mini_batch_src_global generation:  0.04446554183959961
r_  generation:  0.48520565032958984
local_output_nid generation:  0.03849983215332031
local_in_edges_tensor generation:  0.03906130790710449
mini_batch_src_global generation:  0.05521512031555176
r_  generation:  0.4949946403503418
local_output_nid generation:  0.03763580322265625
local_in_edges_tensor generation:  0.03914213180541992
mini_batch_src_global generation:  0.05302715301513672
r_  generation:  0.4987668991088867
local_output_nid generation:  0.037756919860839844
local_in_edges_tensor generation:  0.03802299499511719
mini_batch_src_global generation:  0.05250096321105957
r_  generation:  0.5060157775878906
local_output_nid generation:  0.03855323791503906
local_in_edges_tensor generation:  0.05113983154296875
mini_batch_src_global generation:  0.052712202072143555
r_  generation:  0.503793478012085
local_output_nid generation:  0.037647247314453125
local_in_edges_tensor generation:  0.040990591049194336
mini_batch_src_global generation:  0.053839921951293945
r_  generation:  0.5113193988800049
local_output_nid generation:  0.03756237030029297
local_in_edges_tensor generation:  0.038573265075683594
mini_batch_src_global generation:  0.0540616512298584
r_  generation:  0.5114121437072754
local_output_nid generation:  0.037507057189941406
local_in_edges_tensor generation:  0.04285478591918945
mini_batch_src_global generation:  0.053978681564331055
r_  generation:  0.5182161331176758
local_output_nid generation:  0.037751197814941406
local_in_edges_tensor generation:  0.03409552574157715
mini_batch_src_global generation:  0.05518364906311035
r_  generation:  0.516624927520752
local_output_nid generation:  0.03794693946838379
local_in_edges_tensor generation:  0.03786277770996094
mini_batch_src_global generation:  0.05483818054199219
r_  generation:  0.5164399147033691
local_output_nid generation:  0.037926673889160156
local_in_edges_tensor generation:  0.03814697265625
mini_batch_src_global generation:  0.05482745170593262
r_  generation:  0.5224077701568604
local_output_nid generation:  0.03789806365966797
local_in_edges_tensor generation:  0.03847646713256836
mini_batch_src_global generation:  0.05884122848510742
r_  generation:  0.5312798023223877
local_output_nid generation:  0.03879094123840332
local_in_edges_tensor generation:  0.048189401626586914
mini_batch_src_global generation:  0.05624842643737793
r_  generation:  0.5171549320220947
local_output_nid generation:  0.03854942321777344
local_in_edges_tensor generation:  0.04558730125427246
mini_batch_src_global generation:  0.055060625076293945
r_  generation:  0.5160412788391113
local_output_nid generation:  0.03868293762207031
local_in_edges_tensor generation:  0.03960537910461426
mini_batch_src_global generation:  0.05575060844421387
r_  generation:  0.5149750709533691
local_output_nid generation:  0.03834867477416992
local_in_edges_tensor generation:  0.033448219299316406
mini_batch_src_global generation:  0.055811405181884766
r_  generation:  0.5197587013244629
----------------------check_connections_block total spend ----------------------------- 12.215932846069336
generate_one_block  0.6275675296783447
generate_one_block  0.7146904468536377
generate_one_block  0.623528003692627
generate_one_block  0.6326050758361816
generate_one_block  0.6392521858215332
generate_one_block  0.6530096530914307
generate_one_block  0.6276345252990723
generate_one_block  0.6394286155700684
generate_one_block  0.6192340850830078
generate_one_block  0.6319589614868164
generate_one_block  0.6199100017547607
generate_one_block  0.635683536529541
generate_one_block  0.6514673233032227
generate_one_block  0.6463875770568848
generate_one_block  0.6258583068847656
generate_one_block  0.6155273914337158
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  28.94864821434021
block generation total time  24.87396502494812
average batch blocks generation time:  1.5546228140592575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10675907135009766  GigaBytes
Max Memory Allocated: 0.10675907135009766  GigaBytes

torch.Size([163669, 128])
torch.Size([155593, 64])
torch.Size([123755, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.4278225898742676  GigaBytes
Max Memory Allocated: 0.4355463981628418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.10803842544555664  GigaBytes
Max Memory Allocated: 0.4498753547668457  GigaBytes

torch.Size([163806, 128])
torch.Size([155831, 64])
torch.Size([124108, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.4284391403198242  GigaBytes
Max Memory Allocated: 0.4498753547668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10796785354614258  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

torch.Size([163549, 128])
torch.Size([155366, 64])
torch.Size([123232, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4266190528869629  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10791540145874023  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

torch.Size([163671, 128])
torch.Size([155387, 64])
torch.Size([123139, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42652416229248047  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10802221298217773  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

torch.Size([163761, 128])
torch.Size([155676, 64])
torch.Size([123785, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4276542663574219  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10796213150024414  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

torch.Size([163589, 128])
torch.Size([155594, 64])
torch.Size([123499, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4269075393676758  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10794305801391602  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

torch.Size([163771, 128])
torch.Size([155481, 64])
torch.Size([123351, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42676544189453125  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10805273056030273  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

torch.Size([163772, 128])
torch.Size([155759, 64])
torch.Size([124422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42887258529663086  GigaBytes
Max Memory Allocated: 0.4503602981567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10807943344116211  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

torch.Size([163764, 128])
torch.Size([155527, 64])
torch.Size([124026, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4283175468444824  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10802412033081055  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

torch.Size([163645, 128])
torch.Size([155644, 64])
torch.Size([124002, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42799997329711914  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10787248611450195  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

torch.Size([163604, 128])
torch.Size([155348, 64])
torch.Size([123057, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4264388084411621  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10813379287719727  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

torch.Size([163556, 128])
torch.Size([155477, 64])
torch.Size([123597, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42838335037231445  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10787248611450195  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

torch.Size([163688, 128])
torch.Size([155738, 64])
torch.Size([123749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42722177505493164  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10811090469360352  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

torch.Size([163671, 128])
torch.Size([155690, 64])
torch.Size([124412, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4293251037597656  GigaBytes
Max Memory Allocated: 0.45082712173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10800886154174805  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

torch.Size([163562, 128])
torch.Size([155375, 64])
torch.Size([123984, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42786169052124023  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10802316665649414  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

torch.Size([163552, 128])
torch.Size([155370, 64])
torch.Size([124027, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4280428886413574  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04862174391746521 |0.042761459946632385 |0.049682214856147766 |9.752810001373291e-05 |0.009657815098762512 |0.005181789398193359 |
----------------------------------------------------------pseudo_mini_loss sum 5.645262241363525
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7748572
Number of first layer input nodes during this epoch:  2618630
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.16819286346435547  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.020914554595947266
random selection method range initialization spend 0.005465507507324219
time for parepare:  0.018038272857666016
local_output_nid generation:  0.0024042129516601562
local_in_edges_tensor generation:  0.0048601627349853516
mini_batch_src_global generation:  0.0019452571868896484
r_  generation:  0.01890087127685547
local_output_nid generation:  0.0028607845306396484
local_in_edges_tensor generation:  0.0016510486602783203
mini_batch_src_global generation:  0.0021517276763916016
r_  generation:  0.01829838752746582
local_output_nid generation:  0.0029211044311523438
local_in_edges_tensor generation:  0.001560211181640625
mini_batch_src_global generation:  0.0013885498046875
r_  generation:  0.01828145980834961
local_output_nid generation:  0.002907276153564453
local_in_edges_tensor generation:  0.0015223026275634766
mini_batch_src_global generation:  0.0014071464538574219
r_  generation:  0.018891096115112305
local_output_nid generation:  0.0028777122497558594
local_in_edges_tensor generation:  0.001504659652709961
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.019049882888793945
local_output_nid generation:  0.0028810501098632812
local_in_edges_tensor generation:  0.0014581680297851562
mini_batch_src_global generation:  0.0014574527740478516
r_  generation:  0.019382238388061523
local_output_nid generation:  0.002874135971069336
local_in_edges_tensor generation:  0.0014543533325195312
mini_batch_src_global generation:  0.0015497207641601562
r_  generation:  0.019739627838134766
local_output_nid generation:  0.0029592514038085938
local_in_edges_tensor generation:  0.0015268325805664062
mini_batch_src_global generation:  0.0014469623565673828
r_  generation:  0.019293785095214844
local_output_nid generation:  0.002887248992919922
local_in_edges_tensor generation:  0.0014314651489257812
mini_batch_src_global generation:  0.0014939308166503906
r_  generation:  0.019327163696289062
local_output_nid generation:  0.002878904342651367
local_in_edges_tensor generation:  0.0014040470123291016
mini_batch_src_global generation:  0.0014774799346923828
r_  generation:  0.019301652908325195
local_output_nid generation:  0.0028581619262695312
local_in_edges_tensor generation:  0.0014140605926513672
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.01921868324279785
local_output_nid generation:  0.002836942672729492
local_in_edges_tensor generation:  0.001425027847290039
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.019781112670898438
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0014259815216064453
mini_batch_src_global generation:  0.0015287399291992188
r_  generation:  0.019847869873046875
local_output_nid generation:  0.0028808116912841797
local_in_edges_tensor generation:  0.0014252662658691406
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.019858360290527344
local_output_nid generation:  0.0029458999633789062
local_in_edges_tensor generation:  0.0014684200286865234
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.020066022872924805
local_output_nid generation:  0.0029196739196777344
local_in_edges_tensor generation:  0.0014581680297851562
mini_batch_src_global generation:  0.001543283462524414
r_  generation:  0.019382953643798828
----------------------check_connections_block total spend ----------------------------- 0.5079193115234375
generate_one_block  0.030871868133544922
generate_one_block  0.027741193771362305
generate_one_block  0.0270688533782959
generate_one_block  0.027927160263061523
generate_one_block  0.027620315551757812
generate_one_block  0.030733585357666016
generate_one_block  0.028424978256225586
generate_one_block  0.02742791175842285
generate_one_block  0.027474403381347656
generate_one_block  0.027822256088256836
generate_one_block  0.027211427688598633
generate_one_block  0.02788400650024414
generate_one_block  0.02783942222595215
generate_one_block  0.028151512145996094
generate_one_block  0.02842235565185547
generate_one_block  0.02831721305847168
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03862333297729492
gen group dst list time:  0.01662421226501465
time for parepare:  0.0189054012298584
local_output_nid generation:  0.008265018463134766
local_in_edges_tensor generation:  0.019121646881103516
mini_batch_src_global generation:  0.023357629776000977
r_  generation:  0.20264673233032227
local_output_nid generation:  0.012334823608398438
local_in_edges_tensor generation:  0.01952672004699707
mini_batch_src_global generation:  0.024729251861572266
r_  generation:  0.20644402503967285
local_output_nid generation:  0.011732816696166992
local_in_edges_tensor generation:  0.013718843460083008
mini_batch_src_global generation:  0.02387380599975586
r_  generation:  0.21233773231506348
local_output_nid generation:  0.012137174606323242
local_in_edges_tensor generation:  0.019902706146240234
mini_batch_src_global generation:  0.02686786651611328
r_  generation:  0.21748781204223633
local_output_nid generation:  0.012623071670532227
local_in_edges_tensor generation:  0.011971235275268555
mini_batch_src_global generation:  0.026517152786254883
r_  generation:  0.22188258171081543
local_output_nid generation:  0.012724161148071289
local_in_edges_tensor generation:  0.014081716537475586
mini_batch_src_global generation:  0.027113914489746094
r_  generation:  0.22199654579162598
local_output_nid generation:  0.01278543472290039
local_in_edges_tensor generation:  0.012629508972167969
mini_batch_src_global generation:  0.027248144149780273
r_  generation:  0.22550106048583984
local_output_nid generation:  0.012682437896728516
local_in_edges_tensor generation:  0.012624025344848633
mini_batch_src_global generation:  0.029492855072021484
r_  generation:  0.22508883476257324
local_output_nid generation:  0.01376795768737793
local_in_edges_tensor generation:  0.02021169662475586
mini_batch_src_global generation:  0.03013324737548828
r_  generation:  0.23781490325927734
local_output_nid generation:  0.014836788177490234
local_in_edges_tensor generation:  0.01869344711303711
mini_batch_src_global generation:  0.028983116149902344
r_  generation:  0.2223377227783203
local_output_nid generation:  0.012234687805175781
local_in_edges_tensor generation:  0.014770746231079102
mini_batch_src_global generation:  0.02712392807006836
r_  generation:  0.21965289115905762
local_output_nid generation:  0.012446880340576172
local_in_edges_tensor generation:  0.013159751892089844
mini_batch_src_global generation:  0.027713298797607422
r_  generation:  0.2207949161529541
local_output_nid generation:  0.012351751327514648
local_in_edges_tensor generation:  0.012666702270507812
mini_batch_src_global generation:  0.045630693435668945
r_  generation:  0.22568273544311523
local_output_nid generation:  0.012588024139404297
local_in_edges_tensor generation:  0.01615285873413086
mini_batch_src_global generation:  0.027750730514526367
r_  generation:  0.22836065292358398
local_output_nid generation:  0.012653589248657227
local_in_edges_tensor generation:  0.01847219467163086
mini_batch_src_global generation:  0.02795720100402832
r_  generation:  0.22519922256469727
local_output_nid generation:  0.012357234954833984
local_in_edges_tensor generation:  0.0128021240234375
mini_batch_src_global generation:  0.02903437614440918
r_  generation:  0.21981239318847656
----------------------check_connections_block total spend ----------------------------- 5.2221314907073975
generate_one_block  0.2917215824127197
generate_one_block  0.273590087890625
generate_one_block  0.27515506744384766
generate_one_block  0.29044175148010254
generate_one_block  0.2873878479003906
generate_one_block  0.2850625514984131
generate_one_block  0.3180828094482422
generate_one_block  0.27639245986938477
generate_one_block  0.300121545791626
generate_one_block  0.30005836486816406
generate_one_block  0.2774505615234375
generate_one_block  0.3008847236633301
generate_one_block  0.2854745388031006
generate_one_block  0.28338027000427246
generate_one_block  0.2871286869049072
generate_one_block  0.2924530506134033
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07022309303283691
gen group dst list time:  0.07089114189147949
time for parepare:  0.017778635025024414
local_output_nid generation:  0.02627277374267578
local_in_edges_tensor generation:  0.05753493309020996
mini_batch_src_global generation:  0.049405574798583984
r_  generation:  0.4814879894256592
local_output_nid generation:  0.03116631507873535
local_in_edges_tensor generation:  0.05084061622619629
mini_batch_src_global generation:  0.0554499626159668
r_  generation:  0.5082676410675049
local_output_nid generation:  0.033241987228393555
local_in_edges_tensor generation:  0.05510067939758301
mini_batch_src_global generation:  0.06612801551818848
r_  generation:  0.4957566261291504
local_output_nid generation:  0.03519797325134277
local_in_edges_tensor generation:  0.043685197830200195
mini_batch_src_global generation:  0.05954551696777344
r_  generation:  0.4928464889526367
local_output_nid generation:  0.032012224197387695
local_in_edges_tensor generation:  0.08574795722961426
mini_batch_src_global generation:  0.05621218681335449
r_  generation:  0.4950692653656006
local_output_nid generation:  0.0308077335357666
local_in_edges_tensor generation:  0.03629493713378906
mini_batch_src_global generation:  0.06121516227722168
r_  generation:  0.4893150329589844
local_output_nid generation:  0.031191110610961914
local_in_edges_tensor generation:  0.04120659828186035
mini_batch_src_global generation:  0.05677437782287598
r_  generation:  0.5023922920227051
local_output_nid generation:  0.03138160705566406
local_in_edges_tensor generation:  0.035950660705566406
mini_batch_src_global generation:  0.057959794998168945
r_  generation:  0.49832916259765625
local_output_nid generation:  0.03110051155090332
local_in_edges_tensor generation:  0.03219938278198242
mini_batch_src_global generation:  0.05650019645690918
r_  generation:  0.4992060661315918
local_output_nid generation:  0.031075000762939453
local_in_edges_tensor generation:  0.048554182052612305
mini_batch_src_global generation:  0.058760643005371094
r_  generation:  0.494037389755249
local_output_nid generation:  0.03100728988647461
local_in_edges_tensor generation:  0.03036046028137207
mini_batch_src_global generation:  0.056353092193603516
r_  generation:  0.503307580947876
local_output_nid generation:  0.03245830535888672
local_in_edges_tensor generation:  0.037919044494628906
mini_batch_src_global generation:  0.05961108207702637
r_  generation:  0.5072338581085205
local_output_nid generation:  0.03315901756286621
local_in_edges_tensor generation:  0.042464256286621094
mini_batch_src_global generation:  0.062007904052734375
r_  generation:  0.49637722969055176
local_output_nid generation:  0.03199505805969238
local_in_edges_tensor generation:  0.037799835205078125
mini_batch_src_global generation:  0.05799102783203125
r_  generation:  0.49219822883605957
local_output_nid generation:  0.03237295150756836
local_in_edges_tensor generation:  0.0402226448059082
mini_batch_src_global generation:  0.05733656883239746
r_  generation:  0.4986262321472168
local_output_nid generation:  0.03265881538391113
local_in_edges_tensor generation:  0.0510556697845459
mini_batch_src_global generation:  0.05779910087585449
r_  generation:  0.4947326183319092
----------------------check_connections_block total spend ----------------------------- 11.860191345214844
generate_one_block  0.644465446472168
generate_one_block  0.643345832824707
generate_one_block  0.6283054351806641
generate_one_block  0.6402499675750732
generate_one_block  0.6350564956665039
generate_one_block  0.6266844272613525
generate_one_block  0.6456649303436279
generate_one_block  0.6413719654083252
generate_one_block  0.6736383438110352
generate_one_block  0.6395995616912842
generate_one_block  0.6282246112823486
generate_one_block  0.6340410709381104
generate_one_block  0.6491096019744873
generate_one_block  0.6183879375457764
generate_one_block  0.6351101398468018
generate_one_block  0.6405496597290039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03972911834716797
gen group dst list time:  0.09762954711914062
time for parepare:  0.02157759666442871
local_output_nid generation:  0.03432917594909668
local_in_edges_tensor generation:  0.05652356147766113
mini_batch_src_global generation:  0.04489302635192871
r_  generation:  0.4897634983062744
local_output_nid generation:  0.0404047966003418
local_in_edges_tensor generation:  0.037549734115600586
mini_batch_src_global generation:  0.05584836006164551
r_  generation:  0.49951863288879395
local_output_nid generation:  0.04063057899475098
local_in_edges_tensor generation:  0.03936123847961426
mini_batch_src_global generation:  0.06467628479003906
r_  generation:  0.5032179355621338
local_output_nid generation:  0.03894186019897461
local_in_edges_tensor generation:  0.03786921501159668
mini_batch_src_global generation:  0.053185462951660156
r_  generation:  0.5039288997650146
local_output_nid generation:  0.037981271743774414
local_in_edges_tensor generation:  0.045900583267211914
mini_batch_src_global generation:  0.053653717041015625
r_  generation:  0.5097126960754395
local_output_nid generation:  0.03801155090332031
local_in_edges_tensor generation:  0.046610116958618164
mini_batch_src_global generation:  0.053827762603759766
r_  generation:  0.5146825313568115
local_output_nid generation:  0.038039207458496094
local_in_edges_tensor generation:  0.0422823429107666
mini_batch_src_global generation:  0.054564476013183594
r_  generation:  0.5209348201751709
local_output_nid generation:  0.03819704055786133
local_in_edges_tensor generation:  0.04651379585266113
mini_batch_src_global generation:  0.055208683013916016
r_  generation:  0.5152392387390137
local_output_nid generation:  0.038364410400390625
local_in_edges_tensor generation:  0.04673123359680176
mini_batch_src_global generation:  0.0553438663482666
r_  generation:  0.5254306793212891
local_output_nid generation:  0.03808760643005371
local_in_edges_tensor generation:  0.04178667068481445
mini_batch_src_global generation:  0.055336952209472656
r_  generation:  0.5199308395385742
local_output_nid generation:  0.03785276412963867
local_in_edges_tensor generation:  0.03735685348510742
mini_batch_src_global generation:  0.05514860153198242
r_  generation:  0.5230627059936523
local_output_nid generation:  0.03827619552612305
local_in_edges_tensor generation:  0.041773319244384766
mini_batch_src_global generation:  0.05582618713378906
r_  generation:  0.5159063339233398
local_output_nid generation:  0.038092851638793945
local_in_edges_tensor generation:  0.056160926818847656
mini_batch_src_global generation:  0.054674386978149414
r_  generation:  0.5205144882202148
local_output_nid generation:  0.038199663162231445
local_in_edges_tensor generation:  0.03759312629699707
mini_batch_src_global generation:  0.05542278289794922
r_  generation:  0.5185379981994629
local_output_nid generation:  0.03807997703552246
local_in_edges_tensor generation:  0.04173684120178223
mini_batch_src_global generation:  0.05961036682128906
r_  generation:  0.5260055065155029
local_output_nid generation:  0.0380094051361084
local_in_edges_tensor generation:  0.05120038986206055
mini_batch_src_global generation:  0.055204153060913086
r_  generation:  0.5200202465057373
----------------------check_connections_block total spend ----------------------------- 12.36015796661377
generate_one_block  0.6480932235717773
generate_one_block  0.6405842304229736
generate_one_block  0.6206130981445312
generate_one_block  0.6313643455505371
generate_one_block  0.6242885589599609
generate_one_block  0.6399261951446533
generate_one_block  0.7083330154418945
generate_one_block  0.6206338405609131
generate_one_block  0.6351866722106934
generate_one_block  0.6156935691833496
generate_one_block  0.6229381561279297
generate_one_block  0.6318259239196777
generate_one_block  0.6426401138305664
generate_one_block  0.6364223957061768
generate_one_block  0.6342000961303711
generate_one_block  0.639056921005249
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.16819286346435547  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

connection checking time:  29.44248080253601
block generation total time  25.04039168357849
average batch blocks generation time:  1.5650244802236557
block dataloader generation time/epoch 57.06826400756836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10833930969238281  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

torch.Size([163553, 128])
torch.Size([155578, 64])
torch.Size([124108, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4287285804748535  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10819482803344727  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

torch.Size([163757, 128])
torch.Size([155770, 64])
torch.Size([123886, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4277815818786621  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1081995964050293  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

torch.Size([163330, 128])
torch.Size([155166, 64])
torch.Size([123144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42679882049560547  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10834169387817383  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

torch.Size([163510, 128])
torch.Size([155638, 64])
torch.Size([124584, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4293999671936035  GigaBytes
Max Memory Allocated: 0.45094776153564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10834550857543945  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163408, 128])
torch.Size([155130, 64])
torch.Size([123410, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42735910415649414  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10835695266723633  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163610, 128])
torch.Size([155648, 64])
torch.Size([123500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42815732955932617  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10834932327270508  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163574, 128])
torch.Size([155583, 64])
torch.Size([124120, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4289731979370117  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10829782485961914  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163520, 128])
torch.Size([155348, 64])
torch.Size([123480, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42750072479248047  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10822057723999023  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163629, 128])
torch.Size([155561, 64])
torch.Size([123674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4273815155029297  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10830450057983398  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163356, 128])
torch.Size([155206, 64])
torch.Size([123670, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42778825759887695  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10821008682250977  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163620, 128])
torch.Size([155294, 64])
torch.Size([122479, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42613983154296875  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10831499099731445  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163499, 128])
torch.Size([155416, 64])
torch.Size([123454, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.427793025970459  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10828351974487305  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163520, 128])
torch.Size([155453, 64])
torch.Size([123915, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.428037166595459  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10831117630004883  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163412, 128])
torch.Size([155281, 64])
torch.Size([123143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42716455459594727  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10835027694702148  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163554, 128])
torch.Size([155688, 64])
torch.Size([124533, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4295492172241211  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10830163955688477  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

torch.Size([163710, 128])
torch.Size([155958, 64])
torch.Size([124608, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4290432929992676  GigaBytes
Max Memory Allocated: 0.4512791633605957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046198949217796326 |0.0253773033618927 |0.004711657762527466 |9.262561798095703e-05 |0.0044652968645095825 |0.001873016357421875 |
----------------------------------------------------------pseudo_mini_loss sum 4.447702884674072
Total (block generation + training)time/epoch 58.40996336936951
Training time/epoch 1.3414065837860107
Training time without block to device /epoch 0.9353697299957275
Training time without total dataloading part /epoch 0.15018630027770996
load block tensor time/epoch 0.7391831874847412
block to device time/epoch 0.4060368537902832
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7745814
Number of first layer input nodes during this epoch:  2616562
