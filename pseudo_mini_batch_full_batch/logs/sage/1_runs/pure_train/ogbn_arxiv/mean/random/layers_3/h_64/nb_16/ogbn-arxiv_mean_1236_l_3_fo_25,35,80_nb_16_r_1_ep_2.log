Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439951.9826636
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027992963790893555
random selection method range initialization spend 0.0063343048095703125
time for parepare:  0.018572330474853516
local_output_nid generation:  0.0021381378173828125
local_in_edges_tensor generation:  0.005214214324951172
mini_batch_src_global generation:  0.001974344253540039
r_  generation:  0.020093917846679688
local_output_nid generation:  0.0025174617767333984
local_in_edges_tensor generation:  0.001725912094116211
mini_batch_src_global generation:  0.002503633499145508
r_  generation:  0.01999640464782715
local_output_nid generation:  0.0027952194213867188
local_in_edges_tensor generation:  0.0016283988952636719
mini_batch_src_global generation:  0.001589059829711914
r_  generation:  0.020015954971313477
local_output_nid generation:  0.0028586387634277344
local_in_edges_tensor generation:  0.001657247543334961
mini_batch_src_global generation:  0.0015757083892822266
r_  generation:  0.020128250122070312
local_output_nid generation:  0.0029146671295166016
local_in_edges_tensor generation:  0.0015146732330322266
mini_batch_src_global generation:  0.0015270709991455078
r_  generation:  0.02012491226196289
local_output_nid generation:  0.002920866012573242
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0015840530395507812
r_  generation:  0.020239830017089844
local_output_nid generation:  0.0028731822967529297
local_in_edges_tensor generation:  0.0014922618865966797
mini_batch_src_global generation:  0.0016372203826904297
r_  generation:  0.020804405212402344
local_output_nid generation:  0.0028874874114990234
local_in_edges_tensor generation:  0.001489877700805664
mini_batch_src_global generation:  0.00429081916809082
r_  generation:  0.021351337432861328
local_output_nid generation:  0.002877950668334961
local_in_edges_tensor generation:  0.0015194416046142578
mini_batch_src_global generation:  0.0017352104187011719
r_  generation:  0.021698951721191406
local_output_nid generation:  0.002909421920776367
local_in_edges_tensor generation:  0.0015003681182861328
mini_batch_src_global generation:  0.0016756057739257812
r_  generation:  0.021248817443847656
local_output_nid generation:  0.002887248992919922
local_in_edges_tensor generation:  0.001527547836303711
mini_batch_src_global generation:  0.0018095970153808594
r_  generation:  0.022144079208374023
local_output_nid generation:  0.0029137134552001953
local_in_edges_tensor generation:  0.0014526844024658203
mini_batch_src_global generation:  0.0017452239990234375
r_  generation:  0.02178502082824707
local_output_nid generation:  0.0029511451721191406
local_in_edges_tensor generation:  0.0015218257904052734
mini_batch_src_global generation:  0.0017724037170410156
r_  generation:  0.021982669830322266
local_output_nid generation:  0.0028791427612304688
local_in_edges_tensor generation:  0.0014481544494628906
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.021225929260253906
local_output_nid generation:  0.002874612808227539
local_in_edges_tensor generation:  0.0014722347259521484
mini_batch_src_global generation:  0.0017371177673339844
r_  generation:  0.021317005157470703
local_output_nid generation:  0.0028994083404541016
local_in_edges_tensor generation:  0.001512289047241211
mini_batch_src_global generation:  0.0018134117126464844
r_  generation:  0.021642208099365234
----------------------check_connections_block total spend ----------------------------- 0.5431616306304932
generate_one_block  0.031202316284179688
generate_one_block  0.03171586990356445
generate_one_block  0.033744096755981445
generate_one_block  0.03167295455932617
generate_one_block  0.030672311782836914
generate_one_block  0.03041696548461914
generate_one_block  0.030495643615722656
generate_one_block  0.03189659118652344
generate_one_block  0.03186798095703125
generate_one_block  0.030673503875732422
generate_one_block  0.03211069107055664
generate_one_block  0.03116631507873535
generate_one_block  0.03151512145996094
generate_one_block  0.03036046028137207
generate_one_block  0.0303194522857666
generate_one_block  0.03061985969543457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03874611854553223
gen group dst list time:  0.02050304412841797
time for parepare:  0.020617961883544922
local_output_nid generation:  0.00953817367553711
local_in_edges_tensor generation:  0.022989988327026367
mini_batch_src_global generation:  0.021106958389282227
r_  generation:  0.21492552757263184
local_output_nid generation:  0.016629695892333984
local_in_edges_tensor generation:  0.021731138229370117
mini_batch_src_global generation:  0.026882648468017578
r_  generation:  0.22275018692016602
local_output_nid generation:  0.016582012176513672
local_in_edges_tensor generation:  0.02058100700378418
mini_batch_src_global generation:  0.025855541229248047
r_  generation:  0.22510147094726562
local_output_nid generation:  0.01682448387145996
local_in_edges_tensor generation:  0.018429040908813477
mini_batch_src_global generation:  0.03980302810668945
r_  generation:  0.23179054260253906
local_output_nid generation:  0.01654362678527832
local_in_edges_tensor generation:  0.013996362686157227
mini_batch_src_global generation:  0.02761983871459961
r_  generation:  0.2299356460571289
local_output_nid generation:  0.016739845275878906
local_in_edges_tensor generation:  0.013719797134399414
mini_batch_src_global generation:  0.02847909927368164
r_  generation:  0.22707295417785645
local_output_nid generation:  0.016798019409179688
local_in_edges_tensor generation:  0.019590139389038086
mini_batch_src_global generation:  0.028047561645507812
r_  generation:  0.22969913482666016
local_output_nid generation:  0.01710820198059082
local_in_edges_tensor generation:  0.018294334411621094
mini_batch_src_global generation:  0.029280900955200195
r_  generation:  0.2338721752166748
local_output_nid generation:  0.01705336570739746
local_in_edges_tensor generation:  0.01599407196044922
mini_batch_src_global generation:  0.029196739196777344
r_  generation:  0.23640012741088867
local_output_nid generation:  0.016925811767578125
local_in_edges_tensor generation:  0.015722036361694336
mini_batch_src_global generation:  0.02879929542541504
r_  generation:  0.22990918159484863
local_output_nid generation:  0.01706099510192871
local_in_edges_tensor generation:  0.018514633178710938
mini_batch_src_global generation:  0.0296933650970459
r_  generation:  0.2437281608581543
local_output_nid generation:  0.01700735092163086
local_in_edges_tensor generation:  0.014373302459716797
mini_batch_src_global generation:  0.02897357940673828
r_  generation:  0.23502469062805176
local_output_nid generation:  0.01697373390197754
local_in_edges_tensor generation:  0.015734434127807617
mini_batch_src_global generation:  0.02967357635498047
r_  generation:  0.2349386215209961
local_output_nid generation:  0.016691207885742188
local_in_edges_tensor generation:  0.0157473087310791
mini_batch_src_global generation:  0.02893996238708496
r_  generation:  0.23300385475158691
local_output_nid generation:  0.016843080520629883
local_in_edges_tensor generation:  0.01641392707824707
mini_batch_src_global generation:  0.031116962432861328
r_  generation:  0.23341035842895508
local_output_nid generation:  0.01702117919921875
local_in_edges_tensor generation:  0.01502227783203125
mini_batch_src_global generation:  0.028703689575195312
r_  generation:  0.2335042953491211
----------------------check_connections_block total spend ----------------------------- 5.529472827911377
generate_one_block  0.3155100345611572
generate_one_block  0.3089179992675781
generate_one_block  0.3079378604888916
generate_one_block  0.3102564811706543
generate_one_block  0.311840295791626
generate_one_block  0.2989614009857178
generate_one_block  0.308546781539917
generate_one_block  0.31328511238098145
generate_one_block  0.31328320503234863
generate_one_block  0.2973361015319824
generate_one_block  0.319028377532959
generate_one_block  0.3043084144592285
generate_one_block  0.3044626712799072
generate_one_block  0.29872775077819824
generate_one_block  0.3107476234436035
generate_one_block  0.297116756439209
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03609800338745117
gen group dst list time:  0.06072640419006348
time for parepare:  0.019149065017700195
local_output_nid generation:  0.025400876998901367
local_in_edges_tensor generation:  0.04026031494140625
mini_batch_src_global generation:  0.04519224166870117
r_  generation:  0.4350113868713379
local_output_nid generation:  0.03189206123352051
local_in_edges_tensor generation:  0.0469357967376709
mini_batch_src_global generation:  0.051078081130981445
r_  generation:  0.4492950439453125
local_output_nid generation:  0.03103780746459961
local_in_edges_tensor generation:  0.039658546447753906
mini_batch_src_global generation:  0.05044865608215332
r_  generation:  0.45210886001586914
local_output_nid generation:  0.03153705596923828
local_in_edges_tensor generation:  0.03560042381286621
mini_batch_src_global generation:  0.055141448974609375
r_  generation:  0.44966602325439453
local_output_nid generation:  0.031217336654663086
local_in_edges_tensor generation:  0.03134298324584961
mini_batch_src_global generation:  0.05180478096008301
r_  generation:  0.4636218547821045
local_output_nid generation:  0.031180620193481445
local_in_edges_tensor generation:  0.030426502227783203
mini_batch_src_global generation:  0.05416131019592285
r_  generation:  0.45070433616638184
local_output_nid generation:  0.03145408630371094
local_in_edges_tensor generation:  0.04287433624267578
mini_batch_src_global generation:  0.0521388053894043
r_  generation:  0.4666919708251953
local_output_nid generation:  0.03159809112548828
local_in_edges_tensor generation:  0.046661376953125
mini_batch_src_global generation:  0.05341172218322754
r_  generation:  0.4602620601654053
local_output_nid generation:  0.032111167907714844
local_in_edges_tensor generation:  0.03848671913146973
mini_batch_src_global generation:  0.052056074142456055
r_  generation:  0.4693751335144043
local_output_nid generation:  0.03156089782714844
local_in_edges_tensor generation:  0.03447604179382324
mini_batch_src_global generation:  0.05345749855041504
r_  generation:  0.4587063789367676
local_output_nid generation:  0.03195834159851074
local_in_edges_tensor generation:  0.03943490982055664
mini_batch_src_global generation:  0.051938533782958984
r_  generation:  0.47278904914855957
local_output_nid generation:  0.03161334991455078
local_in_edges_tensor generation:  0.03409886360168457
mini_batch_src_global generation:  0.05315113067626953
r_  generation:  0.4658794403076172
local_output_nid generation:  0.03164076805114746
local_in_edges_tensor generation:  0.031191587448120117
mini_batch_src_global generation:  0.0521845817565918
r_  generation:  0.46069931983947754
local_output_nid generation:  0.031703948974609375
local_in_edges_tensor generation:  0.03220105171203613
mini_batch_src_global generation:  0.052686452865600586
r_  generation:  0.46088266372680664
local_output_nid generation:  0.03167009353637695
local_in_edges_tensor generation:  0.03655290603637695
mini_batch_src_global generation:  0.05330801010131836
r_  generation:  0.4660344123840332
local_output_nid generation:  0.03178524971008301
local_in_edges_tensor generation:  0.03825044631958008
mini_batch_src_global generation:  0.052903175354003906
r_  generation:  0.4559323787689209
----------------------check_connections_block total spend ----------------------------- 10.872298002243042
generate_one_block  0.5832862854003906
generate_one_block  0.600837230682373
generate_one_block  0.5816466808319092
generate_one_block  0.5938200950622559
generate_one_block  0.5725610256195068
generate_one_block  0.5735921859741211
generate_one_block  0.6319282054901123
generate_one_block  0.5969088077545166
generate_one_block  0.5974562168121338
generate_one_block  0.5822854042053223
generate_one_block  0.597449779510498
generate_one_block  0.5900988578796387
generate_one_block  0.5785748958587646
generate_one_block  0.5786614418029785
generate_one_block  0.5816965103149414
generate_one_block  0.6113300323486328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  16.40177083015442
block generation total time  14.372400522232056
average batch blocks generation time:  0.8982750326395035
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09085702896118164  GigaBytes
Max Memory Allocated: 0.09085702896118164  GigaBytes

torch.Size([154890, 128])
torch.Size([124368, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.25733184814453125  GigaBytes
Max Memory Allocated: 0.2660961151123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09175491333007812  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155120, 128])
torch.Size([125470, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2550339698791504  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0917959213256836  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([154736, 128])
torch.Size([124823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2554802894592285  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0918731689453125  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155143, 128])
torch.Size([125576, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2561163902282715  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09158992767333984  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([154966, 128])
torch.Size([124545, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2532072067260742  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09157848358154297  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([154876, 128])
torch.Size([124173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2516803741455078  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09167289733886719  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155187, 128])
torch.Size([125003, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25400781631469727  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09181594848632812  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155009, 128])
torch.Size([125117, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25578784942626953  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09183883666992188  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155166, 128])
torch.Size([125650, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25628089904785156  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09168148040771484  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155338, 128])
torch.Size([125025, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25397777557373047  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09193038940429688  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

torch.Size([155446, 128])
torch.Size([126125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2581758499145508  GigaBytes
Max Memory Allocated: 0.2797966003417969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09171009063720703  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155273, 128])
torch.Size([125317, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.254453182220459  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09174060821533203  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154959, 128])
torch.Size([124843, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2542386054992676  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09161376953125  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154962, 128])
torch.Size([124861, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2523951530456543  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09169960021972656  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155262, 128])
torch.Size([124865, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25385618209838867  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09161853790283203  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154954, 128])
torch.Size([124379, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2532186508178711  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03643876314163208 |0.03390456736087799 |0.050130993127822876 |9.751319885253906e-05 |0.010084956884384155 |0.0024886131286621094 |
----------------------------------------------------------pseudo_mini_loss sum 5.346532821655273
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5212399
Number of first layer input nodes during this epoch:  2481287
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.12709474563598633  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.055420637130737305
random selection method range initialization spend 0.004987478256225586
time for parepare:  0.017691612243652344
local_output_nid generation:  0.0023245811462402344
local_in_edges_tensor generation:  0.0052106380462646484
mini_batch_src_global generation:  0.0019578933715820312
r_  generation:  0.022436857223510742
local_output_nid generation:  0.0029556751251220703
local_in_edges_tensor generation:  0.0016326904296875
mini_batch_src_global generation:  0.0022835731506347656
r_  generation:  0.019898414611816406
local_output_nid generation:  0.0029435157775878906
local_in_edges_tensor generation:  0.001626729965209961
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.020558834075927734
local_output_nid generation:  0.002965688705444336
local_in_edges_tensor generation:  0.0015206336975097656
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.02028679847717285
local_output_nid generation:  0.0029366016387939453
local_in_edges_tensor generation:  0.0015418529510498047
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.020899057388305664
local_output_nid generation:  0.002985239028930664
local_in_edges_tensor generation:  0.0015642642974853516
mini_batch_src_global generation:  0.0016436576843261719
r_  generation:  0.02264714241027832
local_output_nid generation:  0.0030629634857177734
local_in_edges_tensor generation:  0.0016007423400878906
mini_batch_src_global generation:  0.0017180442810058594
r_  generation:  0.022309303283691406
local_output_nid generation:  0.002986907958984375
local_in_edges_tensor generation:  0.0015349388122558594
mini_batch_src_global generation:  0.0016529560089111328
r_  generation:  0.02135300636291504
local_output_nid generation:  0.0029621124267578125
local_in_edges_tensor generation:  0.001529693603515625
mini_batch_src_global generation:  0.0017299652099609375
r_  generation:  0.02235102653503418
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.0015344619750976562
mini_batch_src_global generation:  0.0016999244689941406
r_  generation:  0.022424697875976562
local_output_nid generation:  0.0030221939086914062
local_in_edges_tensor generation:  0.001556396484375
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.022693395614624023
local_output_nid generation:  0.0029821395874023438
local_in_edges_tensor generation:  0.0015273094177246094
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.02243781089782715
local_output_nid generation:  0.003020048141479492
local_in_edges_tensor generation:  0.0015244483947753906
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.02197432518005371
local_output_nid generation:  0.003020048141479492
local_in_edges_tensor generation:  0.0015170574188232422
mini_batch_src_global generation:  0.0017468929290771484
r_  generation:  0.021929264068603516
local_output_nid generation:  0.0029692649841308594
local_in_edges_tensor generation:  0.0015342235565185547
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.02289581298828125
local_output_nid generation:  0.0029571056365966797
local_in_edges_tensor generation:  0.001566171646118164
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.022871732711791992
----------------------check_connections_block total spend ----------------------------- 0.5597198009490967
generate_one_block  0.048399925231933594
generate_one_block  0.030208110809326172
generate_one_block  0.03085017204284668
generate_one_block  0.030543088912963867
generate_one_block  0.030773639678955078
generate_one_block  0.03534865379333496
generate_one_block  0.03222370147705078
generate_one_block  0.030687808990478516
generate_one_block  0.03187990188598633
generate_one_block  0.03175640106201172
generate_one_block  0.031444549560546875
generate_one_block  0.031731367111206055
generate_one_block  0.03478384017944336
generate_one_block  0.033573150634765625
generate_one_block  0.03500509262084961
generate_one_block  0.041585445404052734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03582572937011719
gen group dst list time:  0.019500017166137695
time for parepare:  0.01912665367126465
local_output_nid generation:  0.00925302505493164
local_in_edges_tensor generation:  0.01999688148498535
mini_batch_src_global generation:  0.023526430130004883
r_  generation:  0.21676182746887207
local_output_nid generation:  0.013052701950073242
local_in_edges_tensor generation:  0.018770456314086914
mini_batch_src_global generation:  0.026951074600219727
r_  generation:  0.21607494354248047
local_output_nid generation:  0.013330698013305664
local_in_edges_tensor generation:  0.019039630889892578
mini_batch_src_global generation:  0.0257718563079834
r_  generation:  0.2250654697418213
local_output_nid generation:  0.013400077819824219
local_in_edges_tensor generation:  0.016991853713989258
mini_batch_src_global generation:  0.026668787002563477
r_  generation:  0.2263801097869873
local_output_nid generation:  0.013042926788330078
local_in_edges_tensor generation:  0.013446569442749023
mini_batch_src_global generation:  0.027731657028198242
r_  generation:  0.22690343856811523
local_output_nid generation:  0.013380765914916992
local_in_edges_tensor generation:  0.018146514892578125
mini_batch_src_global generation:  0.03287005424499512
r_  generation:  0.24553966522216797
local_output_nid generation:  0.013047218322753906
local_in_edges_tensor generation:  0.015640974044799805
mini_batch_src_global generation:  0.029207229614257812
r_  generation:  0.23782110214233398
local_output_nid generation:  0.012816667556762695
local_in_edges_tensor generation:  0.01574540138244629
mini_batch_src_global generation:  0.029305458068847656
r_  generation:  0.23724079132080078
local_output_nid generation:  0.013088226318359375
local_in_edges_tensor generation:  0.015679597854614258
mini_batch_src_global generation:  0.03241157531738281
r_  generation:  0.24572491645812988
local_output_nid generation:  0.015435934066772461
local_in_edges_tensor generation:  0.019991397857666016
mini_batch_src_global generation:  0.030371665954589844
r_  generation:  0.245147705078125
local_output_nid generation:  0.014264345169067383
local_in_edges_tensor generation:  0.016879558563232422
mini_batch_src_global generation:  0.03013443946838379
r_  generation:  0.24879097938537598
local_output_nid generation:  0.015556573867797852
local_in_edges_tensor generation:  0.022602081298828125
mini_batch_src_global generation:  0.03272104263305664
r_  generation:  0.2424616813659668
local_output_nid generation:  0.013387680053710938
local_in_edges_tensor generation:  0.016654491424560547
mini_batch_src_global generation:  0.029512882232666016
r_  generation:  0.2461841106414795
local_output_nid generation:  0.013239145278930664
local_in_edges_tensor generation:  0.018502235412597656
mini_batch_src_global generation:  0.02908611297607422
r_  generation:  0.24105381965637207
local_output_nid generation:  0.013608455657958984
local_in_edges_tensor generation:  0.01961231231689453
mini_batch_src_global generation:  0.0313107967376709
r_  generation:  0.24305272102355957
local_output_nid generation:  0.014410734176635742
local_in_edges_tensor generation:  0.021271467208862305
mini_batch_src_global generation:  0.030627012252807617
r_  generation:  0.2606241703033447
----------------------check_connections_block total spend ----------------------------- 5.637211084365845
generate_one_block  0.3201479911804199
generate_one_block  0.2936441898345947
generate_one_block  0.3026394844055176
generate_one_block  0.29731321334838867
generate_one_block  0.3264925479888916
generate_one_block  0.32311582565307617
generate_one_block  0.36047983169555664
generate_one_block  0.3072047233581543
generate_one_block  0.33115243911743164
generate_one_block  0.312563419342041
generate_one_block  0.31021714210510254
generate_one_block  0.3048064708709717
generate_one_block  0.3137185573577881
generate_one_block  0.30182623863220215
generate_one_block  0.31357336044311523
generate_one_block  0.31385326385498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08292078971862793
gen group dst list time:  0.06885838508605957
time for parepare:  0.021157503128051758
local_output_nid generation:  0.026564598083496094
local_in_edges_tensor generation:  0.060604095458984375
mini_batch_src_global generation:  0.04187202453613281
r_  generation:  0.4502575397491455
local_output_nid generation:  0.03216958045959473
local_in_edges_tensor generation:  0.04575967788696289
mini_batch_src_global generation:  0.05417776107788086
r_  generation:  0.4480400085449219
local_output_nid generation:  0.031412601470947266
local_in_edges_tensor generation:  0.03438901901245117
mini_batch_src_global generation:  0.05356240272521973
r_  generation:  0.4536912441253662
local_output_nid generation:  0.03281044960021973
local_in_edges_tensor generation:  0.03430581092834473
mini_batch_src_global generation:  0.05215167999267578
r_  generation:  0.4501373767852783
local_output_nid generation:  0.031850337982177734
local_in_edges_tensor generation:  0.08011269569396973
mini_batch_src_global generation:  0.053359270095825195
r_  generation:  0.46280765533447266
local_output_nid generation:  0.03326153755187988
local_in_edges_tensor generation:  0.0501255989074707
mini_batch_src_global generation:  0.053891897201538086
r_  generation:  0.47742772102355957
local_output_nid generation:  0.03291511535644531
local_in_edges_tensor generation:  0.04259371757507324
mini_batch_src_global generation:  0.055121660232543945
r_  generation:  0.46881628036499023
local_output_nid generation:  0.03432321548461914
local_in_edges_tensor generation:  0.0379183292388916
mini_batch_src_global generation:  0.053733110427856445
r_  generation:  0.45659351348876953
local_output_nid generation:  0.033243417739868164
local_in_edges_tensor generation:  0.04054832458496094
mini_batch_src_global generation:  0.05242609977722168
r_  generation:  0.463015079498291
local_output_nid generation:  0.033059120178222656
local_in_edges_tensor generation:  0.03088521957397461
mini_batch_src_global generation:  0.05377316474914551
r_  generation:  0.46282172203063965
local_output_nid generation:  0.032781124114990234
local_in_edges_tensor generation:  0.03763318061828613
mini_batch_src_global generation:  0.0511929988861084
r_  generation:  0.4677391052246094
local_output_nid generation:  0.033174753189086914
local_in_edges_tensor generation:  0.030536651611328125
mini_batch_src_global generation:  0.056301116943359375
r_  generation:  0.4582483768463135
local_output_nid generation:  0.032984018325805664
local_in_edges_tensor generation:  0.03461265563964844
mini_batch_src_global generation:  0.052086830139160156
r_  generation:  0.4688999652862549
local_output_nid generation:  0.03271317481994629
local_in_edges_tensor generation:  0.030074357986450195
mini_batch_src_global generation:  0.053969383239746094
r_  generation:  0.4601881504058838
local_output_nid generation:  0.03325796127319336
local_in_edges_tensor generation:  0.030710220336914062
mini_batch_src_global generation:  0.052236080169677734
r_  generation:  0.4664604663848877
local_output_nid generation:  0.033197641372680664
local_in_edges_tensor generation:  0.035042762756347656
mini_batch_src_global generation:  0.05291104316711426
r_  generation:  0.4696071147918701
----------------------check_connections_block total spend ----------------------------- 11.021779775619507
generate_one_block  0.5911378860473633
generate_one_block  0.5942676067352295
generate_one_block  0.5916414260864258
generate_one_block  0.5844733715057373
generate_one_block  0.5901374816894531
generate_one_block  0.5894577503204346
generate_one_block  0.5880262851715088
generate_one_block  0.5992028713226318
generate_one_block  0.6352236270904541
generate_one_block  0.575453519821167
generate_one_block  0.5827004909515381
generate_one_block  0.593250036239624
generate_one_block  0.5888481140136719
generate_one_block  0.5785162448883057
generate_one_block  0.5739185810089111
generate_one_block  0.6033341884613037
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.12709474563598633  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

connection checking time:  16.65899085998535
block generation total time  14.492338180541992
average batch blocks generation time:  0.9057711362838745
block dataloader generation time/epoch 33.541770696640015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09204244613647461  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155101, 128])
torch.Size([124963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2558002471923828  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09164810180664062  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155027, 128])
torch.Size([124625, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25187110900878906  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09185123443603516  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154402, 128])
torch.Size([123727, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.25171899795532227  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09173202514648438  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154917, 128])
torch.Size([124063, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2513418197631836  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09181785583496094  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155284, 128])
torch.Size([125036, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25384044647216797  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09215641021728516  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154932, 128])
torch.Size([125095, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2575106620788574  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09200572967529297  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155085, 128])
torch.Size([125001, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25489234924316406  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0919046401977539  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155069, 128])
torch.Size([124890, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2539196014404297  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09212779998779297  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155234, 128])
torch.Size([125629, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2577333450317383  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09203147888183594  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155083, 128])
torch.Size([124774, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25571346282958984  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09203815460205078  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154755, 128])
torch.Size([124619, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25448083877563477  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09201622009277344  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155083, 128])
torch.Size([125191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25498008728027344  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09192276000976562  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155114, 128])
torch.Size([125080, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.25442028045654297  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09175777435302734  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([154523, 128])
torch.Size([123784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2515268325805664  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09203720092773438  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155010, 128])
torch.Size([124520, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2543187141418457  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09210205078125  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

torch.Size([155059, 128])
torch.Size([125311, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2575063705444336  GigaBytes
Max Memory Allocated: 0.2802414894104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034874096512794495 |0.012367576360702515 |0.003626495599746704 |9.350478649139404e-05 |0.0043043047189712524 |0.00299072265625 |
----------------------------------------------------------pseudo_mini_loss sum 4.0969390869140625
Total (block generation + training)time/epoch 34.45787477493286
Training time/epoch 0.9158549308776855
Training time without block to device /epoch 0.7179737091064453
Training time without total dataloading part /epoch 0.1313796043395996
load block tensor time/epoch 0.5579855442047119
block to device time/epoch 0.19788122177124023
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5206278
Number of first layer input nodes during this epoch:  2479678
