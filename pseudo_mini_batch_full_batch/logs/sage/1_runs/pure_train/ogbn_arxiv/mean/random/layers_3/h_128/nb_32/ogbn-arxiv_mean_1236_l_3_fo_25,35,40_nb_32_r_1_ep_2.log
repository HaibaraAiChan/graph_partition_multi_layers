Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441580.1957562
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024918317794799805
random selection method range initialization spend 0.0063304901123046875
time for parepare:  0.01813340187072754
local_output_nid generation:  0.0011184215545654297
local_in_edges_tensor generation:  0.0038530826568603516
mini_batch_src_global generation:  0.0013704299926757812
r_  generation:  0.00867915153503418
local_output_nid generation:  0.0012516975402832031
local_in_edges_tensor generation:  0.0009868144989013672
mini_batch_src_global generation:  0.0014264583587646484
r_  generation:  0.00765538215637207
local_output_nid generation:  0.001314401626586914
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0008959770202636719
r_  generation:  0.007749080657958984
local_output_nid generation:  0.0013341903686523438
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0008232593536376953
r_  generation:  0.007546424865722656
local_output_nid generation:  0.0013437271118164062
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0007686614990234375
r_  generation:  0.007450103759765625
local_output_nid generation:  0.0013768672943115234
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0008957386016845703
r_  generation:  0.007781505584716797
local_output_nid generation:  0.0013349056243896484
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0007970333099365234
r_  generation:  0.007714509963989258
local_output_nid generation:  0.0013511180877685547
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0007872581481933594
r_  generation:  0.007752656936645508
local_output_nid generation:  0.0014007091522216797
local_in_edges_tensor generation:  0.0007741451263427734
mini_batch_src_global generation:  0.000820159912109375
r_  generation:  0.008379936218261719
local_output_nid generation:  0.0014204978942871094
local_in_edges_tensor generation:  0.0007460117340087891
mini_batch_src_global generation:  0.0008411407470703125
r_  generation:  0.007925987243652344
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0008242130279541016
r_  generation:  0.008124828338623047
local_output_nid generation:  0.0013804435729980469
local_in_edges_tensor generation:  0.0007452964782714844
mini_batch_src_global generation:  0.0008242130279541016
r_  generation:  0.007991313934326172
local_output_nid generation:  0.0013737678527832031
local_in_edges_tensor generation:  0.0007500648498535156
mini_batch_src_global generation:  0.0008132457733154297
r_  generation:  0.007962703704833984
local_output_nid generation:  0.0013823509216308594
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0008461475372314453
r_  generation:  0.008215188980102539
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.0008406639099121094
r_  generation:  0.008292675018310547
local_output_nid generation:  0.001363992691040039
local_in_edges_tensor generation:  0.0007364749908447266
mini_batch_src_global generation:  0.0008590221405029297
r_  generation:  0.008509159088134766
local_output_nid generation:  0.0013720989227294922
local_in_edges_tensor generation:  0.0007352828979492188
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.008133411407470703
local_output_nid generation:  0.0013666152954101562
local_in_edges_tensor generation:  0.0007340908050537109
mini_batch_src_global generation:  0.0008366107940673828
r_  generation:  0.008046150207519531
local_output_nid generation:  0.0013742446899414062
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0008404254913330078
r_  generation:  0.008162736892700195
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0007338523864746094
mini_batch_src_global generation:  0.0008168220520019531
r_  generation:  0.007922649383544922
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007219314575195312
mini_batch_src_global generation:  0.0008516311645507812
r_  generation:  0.008063077926635742
local_output_nid generation:  0.0013816356658935547
local_in_edges_tensor generation:  0.0007348060607910156
mini_batch_src_global generation:  0.0008320808410644531
r_  generation:  0.008237361907958984
local_output_nid generation:  0.0013968944549560547
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.000972747802734375
r_  generation:  0.008426666259765625
local_output_nid generation:  0.0014004707336425781
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0008172988891601562
r_  generation:  0.007939338684082031
local_output_nid generation:  0.0013856887817382812
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.007990121841430664
local_output_nid generation:  0.0013782978057861328
local_in_edges_tensor generation:  0.0007340908050537109
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.008300304412841797
local_output_nid generation:  0.0013613700866699219
local_in_edges_tensor generation:  0.0007376670837402344
mini_batch_src_global generation:  0.0008237361907958984
r_  generation:  0.008065223693847656
local_output_nid generation:  0.0013737678527832031
local_in_edges_tensor generation:  0.0007221698760986328
mini_batch_src_global generation:  0.0009367465972900391
r_  generation:  0.008048295974731445
local_output_nid generation:  0.0013730525970458984
local_in_edges_tensor generation:  0.0007531642913818359
mini_batch_src_global generation:  0.0008461475372314453
r_  generation:  0.00805974006652832
local_output_nid generation:  0.0013856887817382812
local_in_edges_tensor generation:  0.00518345832824707
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.008401632308959961
local_output_nid generation:  0.0012590885162353516
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.0009815692901611328
r_  generation:  0.008268356323242188
local_output_nid generation:  0.0013346672058105469
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0009028911590576172
r_  generation:  0.008172035217285156
----------------------check_connections_block total spend ----------------------------- 0.4613206386566162
generate_one_block  0.013554573059082031
generate_one_block  0.01325678825378418
generate_one_block  0.013157367706298828
generate_one_block  0.012937545776367188
generate_one_block  0.012920141220092773
generate_one_block  0.01308131217956543
generate_one_block  0.012691974639892578
generate_one_block  0.012730121612548828
generate_one_block  0.013193130493164062
generate_one_block  0.01342463493347168
generate_one_block  0.0132598876953125
generate_one_block  0.012871742248535156
generate_one_block  0.012935638427734375
generate_one_block  0.013588190078735352
generate_one_block  0.013304948806762695
generate_one_block  0.013492822647094727
generate_one_block  0.012964248657226562
generate_one_block  0.012929916381835938
generate_one_block  0.013202667236328125
generate_one_block  0.01297140121459961
generate_one_block  0.013201475143432617
generate_one_block  0.013124942779541016
generate_one_block  0.013309955596923828
generate_one_block  0.012715816497802734
generate_one_block  0.012929439544677734
generate_one_block  0.013269424438476562
generate_one_block  0.012850046157836914
generate_one_block  0.01283884048461914
generate_one_block  0.012993574142456055
generate_one_block  0.013242959976196289
generate_one_block  0.013428449630737305
generate_one_block  0.013008594512939453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042163848876953125
gen group dst list time:  0.02103424072265625
time for parepare:  0.01872396469116211
local_output_nid generation:  0.004518032073974609
local_in_edges_tensor generation:  0.013870477676391602
mini_batch_src_global generation:  0.01130986213684082
r_  generation:  0.11304092407226562
local_output_nid generation:  0.007483005523681641
local_in_edges_tensor generation:  0.01174020767211914
mini_batch_src_global generation:  0.014171123504638672
r_  generation:  0.1205298900604248
local_output_nid generation:  0.007303476333618164
local_in_edges_tensor generation:  0.007809162139892578
mini_batch_src_global generation:  0.013357162475585938
r_  generation:  0.12522387504577637
local_output_nid generation:  0.006959676742553711
local_in_edges_tensor generation:  0.007923364639282227
mini_batch_src_global generation:  0.013963460922241211
r_  generation:  0.12326455116271973
local_output_nid generation:  0.006975650787353516
local_in_edges_tensor generation:  0.008555173873901367
mini_batch_src_global generation:  0.014586448669433594
r_  generation:  0.12752199172973633
local_output_nid generation:  0.0071070194244384766
local_in_edges_tensor generation:  0.008678913116455078
mini_batch_src_global generation:  0.015120744705200195
r_  generation:  0.12711477279663086
local_output_nid generation:  0.0070879459381103516
local_in_edges_tensor generation:  0.008482217788696289
mini_batch_src_global generation:  0.014944076538085938
r_  generation:  0.12920212745666504
local_output_nid generation:  0.007178544998168945
local_in_edges_tensor generation:  0.008738517761230469
mini_batch_src_global generation:  0.016350507736206055
r_  generation:  0.1299757957458496
local_output_nid generation:  0.007288932800292969
local_in_edges_tensor generation:  0.008011341094970703
mini_batch_src_global generation:  0.015662431716918945
r_  generation:  0.13217687606811523
local_output_nid generation:  0.007179737091064453
local_in_edges_tensor generation:  0.008734941482543945
mini_batch_src_global generation:  0.016234159469604492
r_  generation:  0.13488984107971191
local_output_nid generation:  0.00729823112487793
local_in_edges_tensor generation:  0.009848356246948242
mini_batch_src_global generation:  0.016880512237548828
r_  generation:  0.13487839698791504
local_output_nid generation:  0.007146120071411133
local_in_edges_tensor generation:  0.009021282196044922
mini_batch_src_global generation:  0.016021251678466797
r_  generation:  0.1314988136291504
local_output_nid generation:  0.007161855697631836
local_in_edges_tensor generation:  0.009944915771484375
mini_batch_src_global generation:  0.01603841781616211
r_  generation:  0.13207626342773438
local_output_nid generation:  0.007276773452758789
local_in_edges_tensor generation:  0.009977579116821289
mini_batch_src_global generation:  0.016335725784301758
r_  generation:  0.13724207878112793
local_output_nid generation:  0.007285594940185547
local_in_edges_tensor generation:  0.009148597717285156
mini_batch_src_global generation:  0.016313791275024414
r_  generation:  0.135054349899292
local_output_nid generation:  0.007326364517211914
local_in_edges_tensor generation:  0.007885932922363281
mini_batch_src_global generation:  0.017461776733398438
r_  generation:  0.13611412048339844
local_output_nid generation:  0.007105350494384766
local_in_edges_tensor generation:  0.007622241973876953
mini_batch_src_global generation:  0.015826940536499023
r_  generation:  0.13069391250610352
local_output_nid generation:  0.007203102111816406
local_in_edges_tensor generation:  0.007772684097290039
mini_batch_src_global generation:  0.016582489013671875
r_  generation:  0.13084745407104492
local_output_nid generation:  0.007204771041870117
local_in_edges_tensor generation:  0.007896184921264648
mini_batch_src_global generation:  0.015729188919067383
r_  generation:  0.13059020042419434
local_output_nid generation:  0.007208347320556641
local_in_edges_tensor generation:  0.009601593017578125
mini_batch_src_global generation:  0.01688981056213379
r_  generation:  0.13863468170166016
local_output_nid generation:  0.0072193145751953125
local_in_edges_tensor generation:  0.007738590240478516
mini_batch_src_global generation:  0.0169980525970459
r_  generation:  0.13414216041564941
local_output_nid generation:  0.007173061370849609
local_in_edges_tensor generation:  0.009078025817871094
mini_batch_src_global generation:  0.016043663024902344
r_  generation:  0.13450384140014648
local_output_nid generation:  0.007287740707397461
local_in_edges_tensor generation:  0.011083126068115234
mini_batch_src_global generation:  0.01643204689025879
r_  generation:  0.13755536079406738
local_output_nid generation:  0.00709223747253418
local_in_edges_tensor generation:  0.0074269771575927734
mini_batch_src_global generation:  0.015871524810791016
r_  generation:  0.12905645370483398
local_output_nid generation:  0.007127046585083008
local_in_edges_tensor generation:  0.007839202880859375
mini_batch_src_global generation:  0.015557289123535156
r_  generation:  0.1335601806640625
local_output_nid generation:  0.0072400569915771484
local_in_edges_tensor generation:  0.009820699691772461
mini_batch_src_global generation:  0.01658487319946289
r_  generation:  0.13465642929077148
local_output_nid generation:  0.007209300994873047
local_in_edges_tensor generation:  0.008680105209350586
mini_batch_src_global generation:  0.015702009201049805
r_  generation:  0.13309931755065918
local_output_nid generation:  0.0071642398834228516
local_in_edges_tensor generation:  0.007610321044921875
mini_batch_src_global generation:  0.01575446128845215
r_  generation:  0.13123106956481934
local_output_nid generation:  0.007166862487792969
local_in_edges_tensor generation:  0.009647369384765625
mini_batch_src_global generation:  0.015998363494873047
r_  generation:  0.1344294548034668
local_output_nid generation:  0.007309675216674805
local_in_edges_tensor generation:  0.010045528411865234
mini_batch_src_global generation:  0.01611614227294922
r_  generation:  0.14007782936096191
local_output_nid generation:  0.007317781448364258
local_in_edges_tensor generation:  0.010085582733154297
mini_batch_src_global generation:  0.016344308853149414
r_  generation:  0.14007210731506348
local_output_nid generation:  0.007248401641845703
local_in_edges_tensor generation:  0.007852792739868164
mini_batch_src_global generation:  0.01600337028503418
r_  generation:  0.13331937789916992
----------------------check_connections_block total spend ----------------------------- 6.236074209213257
generate_one_block  0.1628742218017578
generate_one_block  0.16105365753173828
generate_one_block  0.18531489372253418
generate_one_block  0.15846753120422363
generate_one_block  0.15833687782287598
generate_one_block  0.1645653247833252
generate_one_block  0.15845131874084473
generate_one_block  0.1627788543701172
generate_one_block  0.1702868938446045
generate_one_block  0.16824865341186523
generate_one_block  0.16607189178466797
generate_one_block  0.16426348686218262
generate_one_block  0.16168522834777832
generate_one_block  0.17073798179626465
generate_one_block  0.1696779727935791
generate_one_block  0.19336342811584473
generate_one_block  0.16143417358398438
generate_one_block  0.1647167205810547
generate_one_block  0.1640310287475586
generate_one_block  0.16754961013793945
generate_one_block  0.1688060760498047
generate_one_block  0.167982816696167
generate_one_block  0.17102980613708496
generate_one_block  0.1587071418762207
generate_one_block  0.16405057907104492
generate_one_block  0.17055630683898926
generate_one_block  0.16210556030273438
generate_one_block  0.16132569313049316
generate_one_block  0.16320252418518066
generate_one_block  0.1785283088684082
generate_one_block  0.1768498420715332
generate_one_block  0.16485142707824707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0584101676940918
gen group dst list time:  0.1056678295135498
time for parepare:  0.018810749053955078
local_output_nid generation:  0.020743131637573242
local_in_edges_tensor generation:  0.04894852638244629
mini_batch_src_global generation:  0.03591442108154297
r_  generation:  0.3737800121307373
local_output_nid generation:  0.027354001998901367
local_in_edges_tensor generation:  0.041374921798706055
mini_batch_src_global generation:  0.04800081253051758
r_  generation:  0.387117862701416
local_output_nid generation:  0.026932716369628906
local_in_edges_tensor generation:  0.035025596618652344
mini_batch_src_global generation:  0.04492592811584473
r_  generation:  0.3911919593811035
local_output_nid generation:  0.0258023738861084
local_in_edges_tensor generation:  0.02753424644470215
mini_batch_src_global generation:  0.04772830009460449
r_  generation:  0.38934755325317383
local_output_nid generation:  0.02497100830078125
local_in_edges_tensor generation:  0.0342104434967041
mini_batch_src_global generation:  0.04591035842895508
r_  generation:  0.39068150520324707
local_output_nid generation:  0.025341033935546875
local_in_edges_tensor generation:  0.03803896903991699
mini_batch_src_global generation:  0.04710960388183594
r_  generation:  0.39781618118286133
local_output_nid generation:  0.025020360946655273
local_in_edges_tensor generation:  0.03451728820800781
mini_batch_src_global generation:  0.046977996826171875
r_  generation:  0.3937368392944336
local_output_nid generation:  0.02517533302307129
local_in_edges_tensor generation:  0.027469158172607422
mini_batch_src_global generation:  0.04659008979797363
r_  generation:  0.39063048362731934
local_output_nid generation:  0.025545358657836914
local_in_edges_tensor generation:  0.03467154502868652
mini_batch_src_global generation:  0.0496983528137207
r_  generation:  0.4087831974029541
local_output_nid generation:  0.025688648223876953
local_in_edges_tensor generation:  0.03842282295227051
mini_batch_src_global generation:  0.047568321228027344
r_  generation:  0.3952460289001465
local_output_nid generation:  0.02550983428955078
local_in_edges_tensor generation:  0.031385183334350586
mini_batch_src_global generation:  0.047037363052368164
r_  generation:  0.40981149673461914
local_output_nid generation:  0.02540111541748047
local_in_edges_tensor generation:  0.0269927978515625
mini_batch_src_global generation:  0.04683542251586914
r_  generation:  0.39304637908935547
local_output_nid generation:  0.02505970001220703
local_in_edges_tensor generation:  0.02819514274597168
mini_batch_src_global generation:  0.046540021896362305
r_  generation:  0.3967454433441162
local_output_nid generation:  0.02567291259765625
local_in_edges_tensor generation:  0.03146839141845703
mini_batch_src_global generation:  0.04732084274291992
r_  generation:  0.3973231315612793
local_output_nid generation:  0.025655031204223633
local_in_edges_tensor generation:  0.03855133056640625
mini_batch_src_global generation:  0.04705357551574707
r_  generation:  0.39977240562438965
local_output_nid generation:  0.02551579475402832
local_in_edges_tensor generation:  0.038648366928100586
mini_batch_src_global generation:  0.04724836349487305
r_  generation:  0.3990597724914551
local_output_nid generation:  0.02542281150817871
local_in_edges_tensor generation:  0.031575918197631836
mini_batch_src_global generation:  0.04713082313537598
r_  generation:  0.3949000835418701
local_output_nid generation:  0.025724411010742188
local_in_edges_tensor generation:  0.027803897857666016
mini_batch_src_global generation:  0.04774665832519531
r_  generation:  0.3962557315826416
local_output_nid generation:  0.026465892791748047
local_in_edges_tensor generation:  0.0335841178894043
mini_batch_src_global generation:  0.048851728439331055
r_  generation:  0.41360926628112793
local_output_nid generation:  0.02610325813293457
local_in_edges_tensor generation:  0.03467988967895508
mini_batch_src_global generation:  0.05602216720581055
r_  generation:  0.3961145877838135
local_output_nid generation:  0.027141571044921875
local_in_edges_tensor generation:  0.03425288200378418
mini_batch_src_global generation:  0.04624438285827637
r_  generation:  0.39590930938720703
local_output_nid generation:  0.026083946228027344
local_in_edges_tensor generation:  0.03451657295227051
mini_batch_src_global generation:  0.04745912551879883
r_  generation:  0.39968371391296387
local_output_nid generation:  0.026453256607055664
local_in_edges_tensor generation:  0.031386613845825195
mini_batch_src_global generation:  0.04752469062805176
r_  generation:  0.40052151679992676
local_output_nid generation:  0.0260467529296875
local_in_edges_tensor generation:  0.037741661071777344
mini_batch_src_global generation:  0.04809260368347168
r_  generation:  0.40095019340515137
local_output_nid generation:  0.026206493377685547
local_in_edges_tensor generation:  0.027767419815063477
mini_batch_src_global generation:  0.04689645767211914
r_  generation:  0.40003395080566406
local_output_nid generation:  0.026272058486938477
local_in_edges_tensor generation:  0.030192136764526367
mini_batch_src_global generation:  0.04758286476135254
r_  generation:  0.40179991722106934
local_output_nid generation:  0.026517629623413086
local_in_edges_tensor generation:  0.030935287475585938
mini_batch_src_global generation:  0.0467991828918457
r_  generation:  0.3993377685546875
local_output_nid generation:  0.026445627212524414
local_in_edges_tensor generation:  0.042009830474853516
mini_batch_src_global generation:  0.04814577102661133
r_  generation:  0.3938326835632324
local_output_nid generation:  0.026346921920776367
local_in_edges_tensor generation:  0.02780318260192871
mini_batch_src_global generation:  0.04750990867614746
r_  generation:  0.39853382110595703
local_output_nid generation:  0.027582168579101562
local_in_edges_tensor generation:  0.03233146667480469
mini_batch_src_global generation:  0.0581059455871582
r_  generation:  0.4083530902862549
local_output_nid generation:  0.028713464736938477
local_in_edges_tensor generation:  0.03365945816040039
mini_batch_src_global generation:  0.0520021915435791
r_  generation:  0.4033675193786621
local_output_nid generation:  0.026396751403808594
local_in_edges_tensor generation:  0.028285503387451172
mini_batch_src_global generation:  0.04921102523803711
r_  generation:  0.39786744117736816
----------------------check_connections_block total spend ----------------------------- 18.96511936187744
generate_one_block  0.6162662506103516
generate_one_block  0.5128445625305176
generate_one_block  0.5165560245513916
generate_one_block  0.5060999393463135
generate_one_block  0.5314686298370361
generate_one_block  0.5199465751647949
generate_one_block  0.506096363067627
generate_one_block  0.5067369937896729
generate_one_block  0.5187640190124512
generate_one_block  0.516244649887085
generate_one_block  0.5216705799102783
generate_one_block  0.499417781829834
generate_one_block  0.4996507167816162
generate_one_block  0.521134614944458
generate_one_block  0.5213897228240967
generate_one_block  0.5197138786315918
generate_one_block  0.5021636486053467
generate_one_block  0.5020158290863037
generate_one_block  0.5037357807159424
generate_one_block  0.5062334537506104
generate_one_block  0.5328454971313477
generate_one_block  0.5295224189758301
generate_one_block  0.5259020328521729
generate_one_block  0.5075066089630127
generate_one_block  0.5165765285491943
generate_one_block  0.5168423652648926
generate_one_block  0.5139846801757812
generate_one_block  0.513493537902832
generate_one_block  0.5005762577056885
generate_one_block  0.5209314823150635
generate_one_block  0.5277345180511475
generate_one_block  0.5043857097625732
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  25.2011935710907
block generation total time  21.900357484817505
average batch blocks generation time:  0.684386171400547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08283090591430664  GigaBytes
Max Memory Allocated: 0.08283090591430664  GigaBytes

torch.Size([145432, 128])
torch.Size([98872, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.34540891647338867  GigaBytes
Max Memory Allocated: 0.35550355911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08360481262207031  GigaBytes
Max Memory Allocated: 0.3953690528869629  GigaBytes

torch.Size([145631, 128])
torch.Size([99196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3466930389404297  GigaBytes
Max Memory Allocated: 0.3953690528869629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0825963020324707  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

torch.Size([145237, 128])
torch.Size([98933, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3466668128967285  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08350181579589844  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

torch.Size([145587, 128])
torch.Size([98992, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3444690704345703  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08209848403930664  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

torch.Size([144479, 128])
torch.Size([97713, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34131908416748047  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08362960815429688  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

torch.Size([145827, 128])
torch.Size([99515, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34668445587158203  GigaBytes
Max Memory Allocated: 0.3969001770019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08350849151611328  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

torch.Size([145468, 128])
torch.Size([98612, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34401607513427734  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08256101608276367  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

torch.Size([145369, 128])
torch.Size([98496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34314393997192383  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08368206024169922  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

torch.Size([145352, 128])
torch.Size([99057, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3478398323059082  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0836477279663086  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

torch.Size([145854, 128])
torch.Size([99535, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3484039306640625  GigaBytes
Max Memory Allocated: 0.39734506607055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08467960357666016  GigaBytes
Max Memory Allocated: 0.398252010345459  GigaBytes

torch.Size([145672, 128])
torch.Size([99623, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3496718406677246  GigaBytes
Max Memory Allocated: 0.398252010345459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08357810974121094  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

torch.Size([145563, 128])
torch.Size([98919, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3452315330505371  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0835409164428711  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

torch.Size([145411, 128])
torch.Size([98483, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34465503692626953  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08372163772583008  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

torch.Size([145373, 128])
torch.Size([99391, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34828853607177734  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08469104766845703  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

torch.Size([145598, 128])
torch.Size([99893, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.350222110748291  GigaBytes
Max Memory Allocated: 0.3994765281677246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08472442626953125  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145667, 128])
torch.Size([99534, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34957075119018555  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08356285095214844  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145638, 128])
torch.Size([98797, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3446345329284668  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08362770080566406  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145563, 128])
torch.Size([98925, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34554624557495117  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08253860473632812  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145308, 128])
torch.Size([98756, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34399986267089844  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08226966857910156  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([144628, 128])
torch.Size([98157, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3430647850036621  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08261442184448242  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145179, 128])
torch.Size([99012, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34674644470214844  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0836954116821289  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145472, 128])
torch.Size([99055, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3466167449951172  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08470726013183594  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

torch.Size([145773, 128])
torch.Size([100231, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35091733932495117  GigaBytes
Max Memory Allocated: 0.40018129348754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08254051208496094  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145310, 128])
torch.Size([98755, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3439517021179199  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08236312866210938  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([144760, 128])
torch.Size([98821, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34509992599487305  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08468914031982422  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145651, 128])
torch.Size([99603, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3496251106262207  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08361530303955078  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145877, 128])
torch.Size([99517, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3469839096069336  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08344554901123047  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145519, 128])
torch.Size([98445, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34381628036499023  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08352279663085938  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145755, 128])
torch.Size([98821, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3451828956604004  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08469581604003906  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145873, 128])
torch.Size([99996, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3504319190979004  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08470487594604492  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145540, 128])
torch.Size([99978, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3503737449645996  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0836029052734375  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145567, 128])
torch.Size([99235, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34799861907958984  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03290855139493942 |0.02105110138654709 |0.0267866849899292 |9.614229202270508e-05 |0.005061440169811249 |0.0038013458251953125 |
----------------------------------------------------------pseudo_mini_loss sum 5.600521564483643
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8577132
Number of first layer input nodes during this epoch:  4654933
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10178232192993164  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022563695907592773
random selection method range initialization spend 0.005756378173828125
time for parepare:  0.016247987747192383
local_output_nid generation:  0.001253366470336914
local_in_edges_tensor generation:  0.0046269893646240234
mini_batch_src_global generation:  0.0013689994812011719
r_  generation:  0.008553504943847656
local_output_nid generation:  0.0013899803161621094
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0012087821960449219
r_  generation:  0.008270978927612305
local_output_nid generation:  0.0014078617095947266
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.007714748382568359
local_output_nid generation:  0.0014004707336425781
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.007996559143066406
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.007802248001098633
local_output_nid generation:  0.0014438629150390625
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.008278131484985352
local_output_nid generation:  0.0013806819915771484
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.009465456008911133
local_output_nid generation:  0.0013797283172607422
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0008032321929931641
r_  generation:  0.008146286010742188
local_output_nid generation:  0.0013720989227294922
local_in_edges_tensor generation:  0.0007302761077880859
mini_batch_src_global generation:  0.0008034706115722656
r_  generation:  0.00786447525024414
local_output_nid generation:  0.0013816356658935547
local_in_edges_tensor generation:  0.0007264614105224609
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.007987260818481445
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007138252258300781
mini_batch_src_global generation:  0.0007696151733398438
r_  generation:  0.007589101791381836
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0007870197296142578
r_  generation:  0.008161067962646484
local_output_nid generation:  0.001367330551147461
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0008039474487304688
r_  generation:  0.008018732070922852
local_output_nid generation:  0.0013804435729980469
local_in_edges_tensor generation:  0.0007183551788330078
mini_batch_src_global generation:  0.0008301734924316406
r_  generation:  0.008339881896972656
local_output_nid generation:  0.0013659000396728516
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0008301734924316406
r_  generation:  0.009718894958496094
local_output_nid generation:  0.0013849735260009766
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008094310760498047
r_  generation:  0.008163928985595703
local_output_nid generation:  0.0013909339904785156
local_in_edges_tensor generation:  0.000720977783203125
mini_batch_src_global generation:  0.0008261203765869141
r_  generation:  0.007956266403198242
local_output_nid generation:  0.0014014244079589844
local_in_edges_tensor generation:  0.0007238388061523438
mini_batch_src_global generation:  0.000823974609375
r_  generation:  0.008110523223876953
local_output_nid generation:  0.001379251480102539
local_in_edges_tensor generation:  0.0007171630859375
mini_batch_src_global generation:  0.0008122920989990234
r_  generation:  0.008263826370239258
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0008568763732910156
r_  generation:  0.008516073226928711
local_output_nid generation:  0.0014162063598632812
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.0008292198181152344
r_  generation:  0.008205413818359375
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.00080108642578125
mini_batch_src_global generation:  0.0008168220520019531
r_  generation:  0.00828862190246582
local_output_nid generation:  0.001390695571899414
local_in_edges_tensor generation:  0.0007159709930419922
mini_batch_src_global generation:  0.0007989406585693359
r_  generation:  0.010469198226928711
local_output_nid generation:  0.0014164447784423828
local_in_edges_tensor generation:  0.0007228851318359375
mini_batch_src_global generation:  0.0008189678192138672
r_  generation:  0.008151769638061523
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0008792877197265625
r_  generation:  0.008512258529663086
local_output_nid generation:  0.0013985633850097656
local_in_edges_tensor generation:  0.0007250308990478516
mini_batch_src_global generation:  0.0008301734924316406
r_  generation:  0.008467435836791992
local_output_nid generation:  0.001390218734741211
local_in_edges_tensor generation:  0.000705718994140625
mini_batch_src_global generation:  0.00080108642578125
r_  generation:  0.007809638977050781
local_output_nid generation:  0.0013849735260009766
local_in_edges_tensor generation:  0.0007228851318359375
mini_batch_src_global generation:  0.0008485317230224609
r_  generation:  0.008649110794067383
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.0007023811340332031
mini_batch_src_global generation:  0.0007891654968261719
r_  generation:  0.007892131805419922
local_output_nid generation:  0.0014078617095947266
local_in_edges_tensor generation:  0.00072479248046875
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.008150577545166016
local_output_nid generation:  0.0013811588287353516
local_in_edges_tensor generation:  0.0007843971252441406
mini_batch_src_global generation:  0.004203319549560547
r_  generation:  0.008112192153930664
local_output_nid generation:  0.0013909339904785156
local_in_edges_tensor generation:  0.0007395744323730469
mini_batch_src_global generation:  0.0008265972137451172
r_  generation:  0.00840306282043457
----------------------check_connections_block total spend ----------------------------- 0.46443724632263184
generate_one_block  0.017487287521362305
generate_one_block  0.015686988830566406
generate_one_block  0.013030767440795898
generate_one_block  0.013191938400268555
generate_one_block  0.012933969497680664
generate_one_block  0.015839815139770508
generate_one_block  0.012925148010253906
generate_one_block  0.013283252716064453
generate_one_block  0.013158321380615234
generate_one_block  0.012773990631103516
generate_one_block  0.012274742126464844
generate_one_block  0.013157367706298828
generate_one_block  0.012828826904296875
generate_one_block  0.016283273696899414
generate_one_block  0.013025283813476562
generate_one_block  0.012877702713012695
generate_one_block  0.012710332870483398
generate_one_block  0.012825250625610352
generate_one_block  0.013103723526000977
generate_one_block  0.01307988166809082
generate_one_block  0.01598358154296875
generate_one_block  0.012943506240844727
generate_one_block  0.012743949890136719
generate_one_block  0.012871980667114258
generate_one_block  0.013201475143432617
generate_one_block  0.012939214706420898
generate_one_block  0.012628316879272461
generate_one_block  0.013513326644897461
generate_one_block  0.014817237854003906
generate_one_block  0.013013839721679688
generate_one_block  0.01301431655883789
generate_one_block  0.013716936111450195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03719758987426758
gen group dst list time:  0.018931865692138672
time for parepare:  0.022377490997314453
local_output_nid generation:  0.004785776138305664
local_in_edges_tensor generation:  0.013511419296264648
mini_batch_src_global generation:  0.012166738510131836
r_  generation:  0.1347954273223877
local_output_nid generation:  0.008443593978881836
local_in_edges_tensor generation:  0.009316205978393555
mini_batch_src_global generation:  0.014747381210327148
r_  generation:  0.1268019676208496
local_output_nid generation:  0.009779930114746094
local_in_edges_tensor generation:  0.04622769355773926
mini_batch_src_global generation:  0.014971733093261719
r_  generation:  0.12510967254638672
local_output_nid generation:  0.008897781372070312
local_in_edges_tensor generation:  0.010100126266479492
mini_batch_src_global generation:  0.014533758163452148
r_  generation:  0.13055825233459473
local_output_nid generation:  0.008863687515258789
local_in_edges_tensor generation:  0.008726119995117188
mini_batch_src_global generation:  0.015141487121582031
r_  generation:  0.16636967658996582
local_output_nid generation:  0.012677431106567383
local_in_edges_tensor generation:  0.013844966888427734
mini_batch_src_global generation:  0.01915764808654785
r_  generation:  0.15508127212524414
local_output_nid generation:  0.012944936752319336
local_in_edges_tensor generation:  0.011005878448486328
mini_batch_src_global generation:  0.0208432674407959
r_  generation:  0.14529728889465332
local_output_nid generation:  0.009151220321655273
local_in_edges_tensor generation:  0.009003162384033203
mini_batch_src_global generation:  0.01637887954711914
r_  generation:  0.13470029830932617
local_output_nid generation:  0.008784770965576172
local_in_edges_tensor generation:  0.008632898330688477
mini_batch_src_global generation:  0.017401456832885742
r_  generation:  0.1346602439880371
local_output_nid generation:  0.00860452651977539
local_in_edges_tensor generation:  0.009768486022949219
mini_batch_src_global generation:  0.015874147415161133
r_  generation:  0.14546513557434082
local_output_nid generation:  0.011331558227539062
local_in_edges_tensor generation:  0.014976978302001953
mini_batch_src_global generation:  0.01638484001159668
r_  generation:  0.12590432167053223
local_output_nid generation:  0.008091449737548828
local_in_edges_tensor generation:  0.009414196014404297
mini_batch_src_global generation:  0.017006635665893555
r_  generation:  0.13629603385925293
local_output_nid generation:  0.008026123046875
local_in_edges_tensor generation:  0.009470939636230469
mini_batch_src_global generation:  0.01613140106201172
r_  generation:  0.13352227210998535
local_output_nid generation:  0.008230924606323242
local_in_edges_tensor generation:  0.009707450866699219
mini_batch_src_global generation:  0.04300856590270996
r_  generation:  0.14000749588012695
local_output_nid generation:  0.008041858673095703
local_in_edges_tensor generation:  0.008420705795288086
mini_batch_src_global generation:  0.01739192008972168
r_  generation:  0.13513541221618652
local_output_nid generation:  0.007926702499389648
local_in_edges_tensor generation:  0.007318735122680664
mini_batch_src_global generation:  0.016225099563598633
r_  generation:  0.1343376636505127
local_output_nid generation:  0.007825136184692383
local_in_edges_tensor generation:  0.00721287727355957
mini_batch_src_global generation:  0.016085386276245117
r_  generation:  0.13045001029968262
local_output_nid generation:  0.007775783538818359
local_in_edges_tensor generation:  0.008495092391967773
mini_batch_src_global generation:  0.036650896072387695
r_  generation:  0.1361086368560791
local_output_nid generation:  0.008945703506469727
local_in_edges_tensor generation:  0.015490293502807617
mini_batch_src_global generation:  0.024379968643188477
r_  generation:  0.14127492904663086
local_output_nid generation:  0.010211944580078125
local_in_edges_tensor generation:  0.010307788848876953
mini_batch_src_global generation:  0.016965389251708984
r_  generation:  0.1694955825805664
local_output_nid generation:  0.010699748992919922
local_in_edges_tensor generation:  0.009586572647094727
mini_batch_src_global generation:  0.022641897201538086
r_  generation:  0.1371622085571289
local_output_nid generation:  0.007624149322509766
local_in_edges_tensor generation:  0.008324861526489258
mini_batch_src_global generation:  0.016086339950561523
r_  generation:  0.13248515129089355
local_output_nid generation:  0.007490873336791992
local_in_edges_tensor generation:  0.007376432418823242
mini_batch_src_global generation:  0.0158231258392334
r_  generation:  0.13265466690063477
local_output_nid generation:  0.007420539855957031
local_in_edges_tensor generation:  0.00948333740234375
mini_batch_src_global generation:  0.01645517349243164
r_  generation:  0.13382887840270996
local_output_nid generation:  0.007587909698486328
local_in_edges_tensor generation:  0.00851893424987793
mini_batch_src_global generation:  0.03363609313964844
r_  generation:  0.14595818519592285
local_output_nid generation:  0.0075168609619140625
local_in_edges_tensor generation:  0.010487079620361328
mini_batch_src_global generation:  0.01677250862121582
r_  generation:  0.13772368431091309
local_output_nid generation:  0.0073816776275634766
local_in_edges_tensor generation:  0.007270336151123047
mini_batch_src_global generation:  0.016294240951538086
r_  generation:  0.13393068313598633
local_output_nid generation:  0.008527278900146484
local_in_edges_tensor generation:  0.014033079147338867
mini_batch_src_global generation:  0.017138004302978516
r_  generation:  0.13952016830444336
local_output_nid generation:  0.007208108901977539
local_in_edges_tensor generation:  0.007180452346801758
mini_batch_src_global generation:  0.01567816734313965
r_  generation:  0.12719106674194336
local_output_nid generation:  0.0075800418853759766
local_in_edges_tensor generation:  0.007507801055908203
mini_batch_src_global generation:  0.016152143478393555
r_  generation:  0.13713479042053223
local_output_nid generation:  0.007625102996826172
local_in_edges_tensor generation:  0.007241010665893555
mini_batch_src_global generation:  0.0164031982421875
r_  generation:  0.13477182388305664
local_output_nid generation:  0.007689237594604492
local_in_edges_tensor generation:  0.010684967041015625
mini_batch_src_global generation:  0.02622699737548828
r_  generation:  0.1453249454498291
----------------------check_connections_block total spend ----------------------------- 6.73598837852478
generate_one_block  0.1809237003326416
generate_one_block  0.16555380821228027
generate_one_block  0.15644073486328125
generate_one_block  0.1645357608795166
generate_one_block  0.18183255195617676
generate_one_block  0.17032408714294434
generate_one_block  0.16666865348815918
generate_one_block  0.16829824447631836
generate_one_block  0.16050171852111816
generate_one_block  0.1614696979522705
generate_one_block  0.1531963348388672
generate_one_block  0.17033672332763672
generate_one_block  0.16605067253112793
generate_one_block  0.17691826820373535
generate_one_block  0.1636507511138916
generate_one_block  0.1617746353149414
generate_one_block  0.16004085540771484
generate_one_block  0.17464780807495117
generate_one_block  0.17959141731262207
generate_one_block  0.2015392780303955
generate_one_block  0.16703438758850098
generate_one_block  0.16313862800598145
generate_one_block  0.15961861610412598
generate_one_block  0.16445446014404297
generate_one_block  0.17344284057617188
generate_one_block  0.16493988037109375
generate_one_block  0.15987825393676758
generate_one_block  0.1733531951904297
generate_one_block  0.15377116203308105
generate_one_block  0.16780829429626465
generate_one_block  0.16230320930480957
generate_one_block  0.173842191696167
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04652810096740723
gen group dst list time:  0.09584951400756836
time for parepare:  0.01744675636291504
local_output_nid generation:  0.021736621856689453
local_in_edges_tensor generation:  0.056696176528930664
mini_batch_src_global generation:  0.03876447677612305
r_  generation:  0.3915061950683594
local_output_nid generation:  0.02770376205444336
local_in_edges_tensor generation:  0.03951239585876465
mini_batch_src_global generation:  0.04566454887390137
r_  generation:  0.386411190032959
local_output_nid generation:  0.03865671157836914
local_in_edges_tensor generation:  0.0327761173248291
mini_batch_src_global generation:  0.04523062705993652
r_  generation:  0.3949289321899414
local_output_nid generation:  0.026312589645385742
local_in_edges_tensor generation:  0.029247522354125977
mini_batch_src_global generation:  0.04952263832092285
r_  generation:  0.39697933197021484
local_output_nid generation:  0.026774168014526367
local_in_edges_tensor generation:  0.03432893753051758
mini_batch_src_global generation:  0.046794891357421875
r_  generation:  0.4024391174316406
local_output_nid generation:  0.026787281036376953
local_in_edges_tensor generation:  0.029871463775634766
mini_batch_src_global generation:  0.04790854454040527
r_  generation:  0.404813289642334
local_output_nid generation:  0.026428937911987305
local_in_edges_tensor generation:  0.029398441314697266
mini_batch_src_global generation:  0.052361488342285156
r_  generation:  0.405933141708374
local_output_nid generation:  0.026961803436279297
local_in_edges_tensor generation:  0.03694581985473633
mini_batch_src_global generation:  0.0474855899810791
r_  generation:  0.4032304286956787
local_output_nid generation:  0.0266416072845459
local_in_edges_tensor generation:  0.028923749923706055
mini_batch_src_global generation:  0.04707026481628418
r_  generation:  0.42378950119018555
local_output_nid generation:  0.030400991439819336
local_in_edges_tensor generation:  0.03663182258605957
mini_batch_src_global generation:  0.04953169822692871
r_  generation:  0.39999866485595703
local_output_nid generation:  0.026989221572875977
local_in_edges_tensor generation:  0.029931306838989258
mini_batch_src_global generation:  0.04650306701660156
r_  generation:  0.3945188522338867
local_output_nid generation:  0.027378320693969727
local_in_edges_tensor generation:  0.033128976821899414
mini_batch_src_global generation:  0.04711341857910156
r_  generation:  0.40358638763427734
local_output_nid generation:  0.027188539505004883
local_in_edges_tensor generation:  0.03699755668640137
mini_batch_src_global generation:  0.04652571678161621
r_  generation:  0.4157850742340088
local_output_nid generation:  0.027542829513549805
local_in_edges_tensor generation:  0.02918267250061035
mini_batch_src_global generation:  0.04765820503234863
r_  generation:  0.3996250629425049
local_output_nid generation:  0.02707195281982422
local_in_edges_tensor generation:  0.026428699493408203
mini_batch_src_global generation:  0.047080278396606445
r_  generation:  0.398831844329834
local_output_nid generation:  0.027211666107177734
local_in_edges_tensor generation:  0.026450634002685547
mini_batch_src_global generation:  0.05027508735656738
r_  generation:  0.40042734146118164
local_output_nid generation:  0.027067899703979492
local_in_edges_tensor generation:  0.026703834533691406
mini_batch_src_global generation:  0.04667091369628906
r_  generation:  0.4016098976135254
local_output_nid generation:  0.02883315086364746
local_in_edges_tensor generation:  0.02969837188720703
mini_batch_src_global generation:  0.05025625228881836
r_  generation:  0.3993852138519287
local_output_nid generation:  0.027436017990112305
local_in_edges_tensor generation:  0.03654670715332031
mini_batch_src_global generation:  0.04674792289733887
r_  generation:  0.40708065032958984
local_output_nid generation:  0.027391910552978516
local_in_edges_tensor generation:  0.03331327438354492
mini_batch_src_global generation:  0.047373056411743164
r_  generation:  0.4083874225616455
local_output_nid generation:  0.02750873565673828
local_in_edges_tensor generation:  0.0388641357421875
mini_batch_src_global generation:  0.04739236831665039
r_  generation:  0.40488553047180176
local_output_nid generation:  0.02727055549621582
local_in_edges_tensor generation:  0.025465726852416992
mini_batch_src_global generation:  0.04759025573730469
r_  generation:  0.39650702476501465
local_output_nid generation:  0.026980876922607422
local_in_edges_tensor generation:  0.025645017623901367
mini_batch_src_global generation:  0.04656481742858887
r_  generation:  0.3998594284057617
local_output_nid generation:  0.027106761932373047
local_in_edges_tensor generation:  0.02920246124267578
mini_batch_src_global generation:  0.047391653060913086
r_  generation:  0.39824485778808594
local_output_nid generation:  0.027389049530029297
local_in_edges_tensor generation:  0.041066884994506836
mini_batch_src_global generation:  0.04644322395324707
r_  generation:  0.40765881538391113
local_output_nid generation:  0.027224063873291016
local_in_edges_tensor generation:  0.028377771377563477
mini_batch_src_global generation:  0.04767298698425293
r_  generation:  0.4035487174987793
local_output_nid generation:  0.028226375579833984
local_in_edges_tensor generation:  0.03290581703186035
mini_batch_src_global generation:  0.06798791885375977
r_  generation:  0.40240955352783203
local_output_nid generation:  0.028528690338134766
local_in_edges_tensor generation:  0.030770063400268555
mini_batch_src_global generation:  0.04765439033508301
r_  generation:  0.40248847007751465
local_output_nid generation:  0.026587963104248047
local_in_edges_tensor generation:  0.027775049209594727
mini_batch_src_global generation:  0.04644942283630371
r_  generation:  0.39463376998901367
local_output_nid generation:  0.026902198791503906
local_in_edges_tensor generation:  0.028118610382080078
mini_batch_src_global generation:  0.05018472671508789
r_  generation:  0.4005904197692871
local_output_nid generation:  0.02703261375427246
local_in_edges_tensor generation:  0.03535056114196777
mini_batch_src_global generation:  0.046506404876708984
r_  generation:  0.4020979404449463
local_output_nid generation:  0.027408838272094727
local_in_edges_tensor generation:  0.028444766998291016
mini_batch_src_global generation:  0.050676822662353516
r_  generation:  0.4050271511077881
----------------------check_connections_block total spend ----------------------------- 19.114447593688965
generate_one_block  0.5257461071014404
generate_one_block  0.5250821113586426
generate_one_block  0.5055649280548096
generate_one_block  0.5190684795379639
generate_one_block  0.6227447986602783
generate_one_block  0.5327863693237305
generate_one_block  0.5135328769683838
generate_one_block  0.5207397937774658
generate_one_block  0.5078840255737305
generate_one_block  0.5145070552825928
generate_one_block  0.5027391910552979
generate_one_block  0.5352725982666016
generate_one_block  0.5363316535949707
generate_one_block  0.525789737701416
generate_one_block  0.5232679843902588
generate_one_block  0.5176889896392822
generate_one_block  0.5115969181060791
generate_one_block  0.5133259296417236
generate_one_block  0.5254344940185547
generate_one_block  0.525200366973877
generate_one_block  0.5225770473480225
generate_one_block  0.5121893882751465
generate_one_block  0.5102634429931641
generate_one_block  0.5117771625518799
generate_one_block  0.5518441200256348
generate_one_block  0.5098817348480225
generate_one_block  0.5093870162963867
generate_one_block  0.5306124687194824
generate_one_block  0.5241034030914307
generate_one_block  0.5216619968414307
generate_one_block  0.5220084190368652
generate_one_block  0.5341284275054932
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10178232192993164  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

connection checking time:  25.850435972213745
block generation total time  22.132619857788086
average batch blocks generation time:  0.6916443705558777
block dataloader generation time/epoch 50.28771662712097
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08527898788452148  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145411, 128])
torch.Size([99622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.35025596618652344  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08302497863769531  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145240, 128])
torch.Size([97961, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34302711486816406  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08396244049072266  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145555, 128])
torch.Size([98483, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3448944091796875  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08313322067260742  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145135, 128])
torch.Size([98563, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3446989059448242  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08414077758789062  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145141, 128])
torch.Size([99370, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3473849296569824  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08527565002441406  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

torch.Size([145806, 128])
torch.Size([100467, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.355623722076416  GigaBytes
Max Memory Allocated: 0.4007415771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0832676887512207  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145369, 128])
torch.Size([99203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34642791748046875  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08410882949829102  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145040, 128])
torch.Size([99422, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3487224578857422  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08415031433105469  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145660, 128])
torch.Size([99080, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3462510108947754  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0830693244934082  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145113, 128])
torch.Size([98577, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3450312614440918  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08381271362304688  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145500, 128])
torch.Size([97660, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34226465225219727  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08427000045776367  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145405, 128])
torch.Size([98938, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34696054458618164  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08410263061523438  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145104, 128])
torch.Size([98849, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34614992141723633  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0842447280883789  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145271, 128])
torch.Size([99479, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34897375106811523  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08313989639282227  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145263, 128])
torch.Size([98296, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34552001953125  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08317184448242188  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145348, 128])
torch.Size([98807, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3448147773742676  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08301830291748047  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145272, 128])
torch.Size([98671, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.343660831451416  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08313274383544922  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145298, 128])
torch.Size([98834, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3445625305175781  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08404016494750977  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([144904, 128])
torch.Size([98929, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3469233512878418  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08425140380859375  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145390, 128])
torch.Size([99527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3489985466003418  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145958, 128])
torch.Size([99559, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.35006046295166016  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.082977294921875  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145100, 128])
torch.Size([98612, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34383726119995117  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08407783508300781  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145681, 128])
torch.Size([98825, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3451418876647949  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08314943313598633  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145303, 128])
torch.Size([98737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34478139877319336  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0842747688293457  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145365, 128])
torch.Size([99686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3493928909301758  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08318901062011719  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145240, 128])
torch.Size([99158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3463773727416992  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08309125900268555  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145327, 128])
torch.Size([98535, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3433551788330078  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0852813720703125  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([146104, 128])
torch.Size([99902, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3508753776550293  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08261728286743164  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([144921, 128])
torch.Size([97113, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3375515937805176  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08426856994628906  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145646, 128])
torch.Size([99210, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3486194610595703  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08418655395507812  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145590, 128])
torch.Size([99270, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34755945205688477  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08431291580200195  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

torch.Size([145391, 128])
torch.Size([99888, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3501853942871094  GigaBytes
Max Memory Allocated: 0.4069490432739258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03169289976358414 |0.010490171611309052 |0.0036071836948394775 |8.954107761383057e-05 |0.0037195011973381042 |0.0016591548919677734 |
----------------------------------------------------------pseudo_mini_loss sum 3.576089382171631
Total (block generation + training)time/epoch 51.923869132995605
Training time/epoch 1.635871410369873
Training time without block to device /epoch 1.3001859188079834
Training time without total dataloading part /epoch 0.23897838592529297
load block tensor time/epoch 1.0141727924346924
block to device time/epoch 0.33568549156188965
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8570299
Number of first layer input nodes during this epoch:  4651851
