Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648490688.0020857
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02348637580871582
random selection method range initialization spend 0.0062062740325927734
time for parepare:  0.018640995025634766
local_output_nid generation:  0.008355855941772461
local_in_edges_tensor generation:  0.007676601409912109
mini_batch_src_global generation:  0.00653839111328125
r_  generation:  0.08357524871826172
local_output_nid generation:  0.011783838272094727
local_in_edges_tensor generation:  0.005884885787963867
mini_batch_src_global generation:  0.008658647537231445
r_  generation:  0.08798098564147949
local_output_nid generation:  0.011870145797729492
local_in_edges_tensor generation:  0.006058216094970703
mini_batch_src_global generation:  0.006598949432373047
r_  generation:  0.08886861801147461
local_output_nid generation:  0.011923789978027344
local_in_edges_tensor generation:  0.006049394607543945
mini_batch_src_global generation:  0.007391929626464844
r_  generation:  0.09238219261169434
----------------------check_connections_block total spend ----------------------------- 0.5525286197662354
generate_one_block  0.10163593292236328
generate_one_block  0.1019439697265625
generate_one_block  0.1021730899810791
generate_one_block  0.10344624519348145
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03816843032836914
gen group dst list time:  0.011432886123657227
time for parepare:  0.01923370361328125
local_output_nid generation:  0.019488811492919922
local_in_edges_tensor generation:  0.0401921272277832
mini_batch_src_global generation:  0.038155555725097656
r_  generation:  0.40424370765686035
local_output_nid generation:  0.02661919593811035
local_in_edges_tensor generation:  0.03976559638977051
mini_batch_src_global generation:  0.048360347747802734
r_  generation:  0.41982173919677734
local_output_nid generation:  0.02654409408569336
local_in_edges_tensor generation:  0.03307056427001953
mini_batch_src_global generation:  0.04785561561584473
r_  generation:  0.42057275772094727
local_output_nid generation:  0.026799917221069336
local_in_edges_tensor generation:  0.033233642578125
mini_batch_src_global generation:  0.04888153076171875
r_  generation:  0.4244403839111328
----------------------check_connections_block total spend ----------------------------- 2.4865000247955322
generate_one_block  0.5629653930664062
generate_one_block  0.5338249206542969
generate_one_block  0.5411767959594727
generate_one_block  0.5429279804229736
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0395665168762207
gen group dst list time:  0.020856618881225586
time for parepare:  0.018704891204833984
local_output_nid generation:  0.029168367385864258
local_in_edges_tensor generation:  0.045722246170043945
mini_batch_src_global generation:  0.05008554458618164
r_  generation:  0.551694393157959
local_output_nid generation:  0.03648781776428223
local_in_edges_tensor generation:  0.05733609199523926
mini_batch_src_global generation:  0.06220221519470215
r_  generation:  0.5542669296264648
local_output_nid generation:  0.03676271438598633
local_in_edges_tensor generation:  0.0475919246673584
mini_batch_src_global generation:  0.05678081512451172
r_  generation:  0.5617873668670654
local_output_nid generation:  0.036428213119506836
local_in_edges_tensor generation:  0.040727853775024414
mini_batch_src_global generation:  0.05913400650024414
r_  generation:  0.5683975219726562
----------------------check_connections_block total spend ----------------------------- 3.2977709770202637
generate_one_block  0.7113597393035889
generate_one_block  0.7070102691650391
generate_one_block  0.7119119167327881
generate_one_block  0.6997525691986084
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04803895950317383
gen group dst list time:  0.028960704803466797
time for parepare:  0.019115209579467773
local_output_nid generation:  0.033917903900146484
local_in_edges_tensor generation:  0.04475831985473633
mini_batch_src_global generation:  0.04931831359863281
r_  generation:  0.5439162254333496
local_output_nid generation:  0.040181875228881836
local_in_edges_tensor generation:  0.05107522010803223
mini_batch_src_global generation:  0.06813669204711914
r_  generation:  0.5474061965942383
local_output_nid generation:  0.03901267051696777
local_in_edges_tensor generation:  0.055951833724975586
mini_batch_src_global generation:  0.06888628005981445
r_  generation:  0.552424430847168
local_output_nid generation:  0.039478302001953125
local_in_edges_tensor generation:  0.05013537406921387
mini_batch_src_global generation:  0.07366800308227539
r_  generation:  0.5652334690093994
----------------------check_connections_block total spend ----------------------------- 3.348459482192993
generate_one_block  0.7038357257843018
generate_one_block  0.7240948677062988
generate_one_block  0.6969048976898193
generate_one_block  0.7062044143676758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03392958641052246
gen group dst list time:  0.02493882179260254
time for parepare:  0.01893329620361328
local_output_nid generation:  0.0331568717956543
local_in_edges_tensor generation:  0.05401873588562012
mini_batch_src_global generation:  0.047000885009765625
r_  generation:  0.505530834197998
local_output_nid generation:  0.0389256477355957
local_in_edges_tensor generation:  0.04352998733520508
mini_batch_src_global generation:  0.05808424949645996
r_  generation:  0.5101537704467773
local_output_nid generation:  0.03908133506774902
local_in_edges_tensor generation:  0.04408597946166992
mini_batch_src_global generation:  0.061805009841918945
r_  generation:  0.5108888149261475
local_output_nid generation:  0.03898358345031738
local_in_edges_tensor generation:  0.035685062408447266
mini_batch_src_global generation:  0.0590519905090332
r_  generation:  0.5125458240509033
----------------------check_connections_block total spend ----------------------------- 3.0918352603912354
generate_one_block  0.6435427665710449
generate_one_block  0.6495206356048584
generate_one_block  0.6527609825134277
generate_one_block  0.6339247226715088
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

connection checking time:  12.224565744400024
block generation total time  10.42171859741211
average batch blocks generation time:  2.6054296493530273
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12936067581176758  GigaBytes
Max Memory Allocated: 0.12936067581176758  GigaBytes

torch.Size([167379, 128])
torch.Size([166857, 32])
torch.Size([164856, 32])
torch.Size([155130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.47138261795043945  GigaBytes
Max Memory Allocated: 0.47477054595947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.1351766586303711  GigaBytes
Max Memory Allocated: 0.49138832092285156  GigaBytes

torch.Size([167409, 128])
torch.Size([166837, 32])
torch.Size([164748, 32])
torch.Size([154635, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.47388553619384766  GigaBytes
Max Memory Allocated: 0.49138832092285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.13449525833129883  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

torch.Size([167413, 128])
torch.Size([166888, 32])
torch.Size([164908, 32])
torch.Size([155178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.4730525016784668  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.13456964492797852  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

torch.Size([167380, 128])
torch.Size([166834, 32])
torch.Size([164760, 32])
torch.Size([154997, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.4727292060852051  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047808051109313965 |0.11715996265411377 |0.18506097793579102 |0.0001208186149597168 |0.03425741195678711 |0.0035982131958007812 |
----------------------------------------------------------pseudo_mini_loss sum 4.935840129852295
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021445
Number of first layer input nodes during this epoch:  669581
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2394704818725586  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03593850135803223
random selection method range initialization spend 0.005577564239501953
time for parepare:  0.018277645111083984
local_output_nid generation:  0.008715391159057617
local_in_edges_tensor generation:  0.0088348388671875
mini_batch_src_global generation:  0.0064966678619384766
r_  generation:  0.08551859855651855
local_output_nid generation:  0.011780738830566406
local_in_edges_tensor generation:  0.005893707275390625
mini_batch_src_global generation:  0.013401508331298828
r_  generation:  0.09683370590209961
local_output_nid generation:  0.013153314590454102
local_in_edges_tensor generation:  0.00951242446899414
mini_batch_src_global generation:  0.010314702987670898
r_  generation:  0.0955967903137207
local_output_nid generation:  0.012994527816772461
local_in_edges_tensor generation:  0.006106853485107422
mini_batch_src_global generation:  0.00753474235534668
r_  generation:  0.09317564964294434
----------------------check_connections_block total spend ----------------------------- 0.6076688766479492
generate_one_block  0.10092759132385254
generate_one_block  0.1025385856628418
generate_one_block  0.10324478149414062
generate_one_block  0.10370540618896484
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04985523223876953
gen group dst list time:  0.011094808578491211
time for parepare:  0.02055644989013672
local_output_nid generation:  0.020037412643432617
local_in_edges_tensor generation:  0.04715752601623535
mini_batch_src_global generation:  0.041776418685913086
r_  generation:  0.4105339050292969
local_output_nid generation:  0.025689363479614258
local_in_edges_tensor generation:  0.04073071479797363
mini_batch_src_global generation:  0.04886507987976074
r_  generation:  0.4253115653991699
local_output_nid generation:  0.028191328048706055
local_in_edges_tensor generation:  0.03689765930175781
mini_batch_src_global generation:  0.04839301109313965
r_  generation:  0.4281325340270996
local_output_nid generation:  0.026926279067993164
local_in_edges_tensor generation:  0.02984786033630371
mini_batch_src_global generation:  0.05234527587890625
r_  generation:  0.4548826217651367
----------------------check_connections_block total spend ----------------------------- 2.5667858123779297
generate_one_block  0.57088303565979
generate_one_block  0.5579230785369873
generate_one_block  0.5861179828643799
generate_one_block  0.5617330074310303
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04992961883544922
gen group dst list time:  0.02410745620727539
time for parepare:  0.018857479095458984
local_output_nid generation:  0.030132055282592773
local_in_edges_tensor generation:  0.05869746208190918
mini_batch_src_global generation:  0.049869537353515625
r_  generation:  0.5560951232910156
local_output_nid generation:  0.03697609901428223
local_in_edges_tensor generation:  0.05591750144958496
mini_batch_src_global generation:  0.06345295906066895
r_  generation:  0.5610232353210449
local_output_nid generation:  0.0371856689453125
local_in_edges_tensor generation:  0.055650949478149414
mini_batch_src_global generation:  0.05802798271179199
r_  generation:  0.5828475952148438
local_output_nid generation:  0.041101932525634766
local_in_edges_tensor generation:  0.05397295951843262
mini_batch_src_global generation:  0.06713032722473145
r_  generation:  0.5599956512451172
----------------------check_connections_block total spend ----------------------------- 3.4170174598693848
generate_one_block  0.7327167987823486
generate_one_block  0.7313973903656006
generate_one_block  0.7206647396087646
generate_one_block  0.7159082889556885
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04392385482788086
gen group dst list time:  0.031084299087524414
time for parepare:  0.018709659576416016
local_output_nid generation:  0.0336000919342041
local_in_edges_tensor generation:  0.05299949645996094
mini_batch_src_global generation:  0.054091453552246094
r_  generation:  0.5386579036712646
local_output_nid generation:  0.03810715675354004
local_in_edges_tensor generation:  0.04424643516540527
mini_batch_src_global generation:  0.062460899353027344
r_  generation:  0.544409990310669
local_output_nid generation:  0.03830313682556152
local_in_edges_tensor generation:  0.04682326316833496
mini_batch_src_global generation:  0.06281566619873047
r_  generation:  0.5470287799835205
local_output_nid generation:  0.04004168510437012
local_in_edges_tensor generation:  0.04181480407714844
mini_batch_src_global generation:  0.06233477592468262
r_  generation:  0.5723896026611328
----------------------check_connections_block total spend ----------------------------- 3.302891492843628
generate_one_block  0.7008261680603027
generate_one_block  0.7039375305175781
generate_one_block  0.7301645278930664
generate_one_block  0.7184007167816162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03663182258605957
gen group dst list time:  0.024933338165283203
time for parepare:  0.019530773162841797
local_output_nid generation:  0.034067392349243164
local_in_edges_tensor generation:  0.059752702713012695
mini_batch_src_global generation:  0.04775667190551758
r_  generation:  0.5102427005767822
local_output_nid generation:  0.0398867130279541
local_in_edges_tensor generation:  0.04689836502075195
mini_batch_src_global generation:  0.058136701583862305
r_  generation:  0.5131561756134033
local_output_nid generation:  0.039513587951660156
local_in_edges_tensor generation:  0.041741371154785156
mini_batch_src_global generation:  0.0584712028503418
r_  generation:  0.5153567790985107
local_output_nid generation:  0.041321516036987305
local_in_edges_tensor generation:  0.04159402847290039
mini_batch_src_global generation:  0.05771970748901367
r_  generation:  0.5258734226226807
----------------------check_connections_block total spend ----------------------------- 3.1339588165283203
generate_one_block  0.635425329208374
generate_one_block  0.6454281806945801
generate_one_block  0.6492130756378174
generate_one_block  0.6490957736968994
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2394704818725586  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

connection checking time:  12.420653581619263
block generation total time  10.609835624694824
average batch blocks generation time:  2.652458906173706
block dataloader generation time/epoch 25.45427894592285
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.13460206985473633  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

torch.Size([167408, 128])
torch.Size([166801, 32])
torch.Size([164737, 32])
torch.Size([154863, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.4725618362426758  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.13471412658691406  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

torch.Size([167440, 128])
torch.Size([166871, 32])
torch.Size([164858, 32])
torch.Size([154902, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.4729032516479492  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.1346440315246582  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

torch.Size([167440, 128])
torch.Size([166858, 32])
torch.Size([164899, 32])
torch.Size([155132, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.47296762466430664  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.13467645645141602  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

torch.Size([167413, 128])
torch.Size([166841, 32])
torch.Size([164828, 32])
torch.Size([154910, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.4728412628173828  GigaBytes
Max Memory Allocated: 0.4930267333984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052928805351257324 |0.04562145471572876 |0.005761921405792236 |9.79304313659668e-05 |0.02069079875946045 |0.002651691436767578 |
----------------------------------------------------------pseudo_mini_loss sum 4.282801151275635
Total (block generation + training)time/epoch 26.00473952293396
Training time/epoch 0.5502543449401855
Training time without block to device /epoch 0.3677685260772705
Training time without total dataloading part /epoch 0.10885429382324219
load block tensor time/epoch 0.2117152214050293
block to device time/epoch 0.18248581886291504
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021210
Number of first layer input nodes during this epoch:  669701
