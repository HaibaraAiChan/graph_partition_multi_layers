Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648437429.1333964
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024770021438598633
random selection method range initialization spend 0.006591320037841797
time for parepare:  0.018810272216796875
local_output_nid generation:  0.004342079162597656
local_in_edges_tensor generation:  0.006365299224853516
mini_batch_src_global generation:  0.003242015838623047
r_  generation:  0.03698325157165527
local_output_nid generation:  0.005595207214355469
local_in_edges_tensor generation:  0.003155231475830078
mini_batch_src_global generation:  0.004204750061035156
r_  generation:  0.0397028923034668
local_output_nid generation:  0.005972623825073242
local_in_edges_tensor generation:  0.0032525062561035156
mini_batch_src_global generation:  0.0028684139251708984
r_  generation:  0.0405881404876709
local_output_nid generation:  0.006028890609741211
local_in_edges_tensor generation:  0.0032896995544433594
mini_batch_src_global generation:  0.002939462661743164
r_  generation:  0.04001903533935547
local_output_nid generation:  0.005976676940917969
local_in_edges_tensor generation:  0.0033178329467773438
mini_batch_src_global generation:  0.0031461715698242188
r_  generation:  0.041483402252197266
local_output_nid generation:  0.0060558319091796875
local_in_edges_tensor generation:  0.003265857696533203
mini_batch_src_global generation:  0.003235340118408203
r_  generation:  0.04112362861633301
local_output_nid generation:  0.0060999393463134766
local_in_edges_tensor generation:  0.0032835006713867188
mini_batch_src_global generation:  0.0031566619873046875
r_  generation:  0.04171872138977051
local_output_nid generation:  0.006114006042480469
local_in_edges_tensor generation:  0.0033288002014160156
mini_batch_src_global generation:  0.0032253265380859375
r_  generation:  0.0407106876373291
----------------------check_connections_block total spend ----------------------------- 0.519296407699585
generate_one_block  0.05493950843811035
generate_one_block  0.05566573143005371
generate_one_block  0.055684566497802734
generate_one_block  0.0547487735748291
generate_one_block  0.058709144592285156
generate_one_block  0.05492401123046875
generate_one_block  0.05426216125488281
generate_one_block  0.05335426330566406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04100465774536133
gen group dst list time:  0.015044689178466797
time for parepare:  0.019916772842407227
local_output_nid generation:  0.013992071151733398
local_in_edges_tensor generation:  0.030200719833374023
mini_batch_src_global generation:  0.030350923538208008
r_  generation:  0.28787946701049805
local_output_nid generation:  0.022722244262695312
local_in_edges_tensor generation:  0.031052112579345703
mini_batch_src_global generation:  0.03772163391113281
r_  generation:  0.30397462844848633
local_output_nid generation:  0.02228546142578125
local_in_edges_tensor generation:  0.02570176124572754
mini_batch_src_global generation:  0.03504776954650879
r_  generation:  0.30823254585266113
local_output_nid generation:  0.02198052406311035
local_in_edges_tensor generation:  0.019977807998657227
mini_batch_src_global generation:  0.03642010688781738
r_  generation:  0.3071930408477783
local_output_nid generation:  0.02213883399963379
local_in_edges_tensor generation:  0.025065898895263672
mini_batch_src_global generation:  0.03898000717163086
r_  generation:  0.3110363483428955
local_output_nid generation:  0.022087812423706055
local_in_edges_tensor generation:  0.02319025993347168
mini_batch_src_global generation:  0.03735685348510742
r_  generation:  0.3181779384613037
local_output_nid generation:  0.022073745727539062
local_in_edges_tensor generation:  0.020246267318725586
mini_batch_src_global generation:  0.04858684539794922
r_  generation:  0.3064253330230713
local_output_nid generation:  0.022136449813842773
local_in_edges_tensor generation:  0.025052309036254883
mini_batch_src_global generation:  0.03634333610534668
r_  generation:  0.30909204483032227
----------------------check_connections_block total spend ----------------------------- 3.6683855056762695
generate_one_block  0.3942716121673584
generate_one_block  0.4119713306427002
generate_one_block  0.39242982864379883
generate_one_block  0.38999295234680176
generate_one_block  0.40488147735595703
generate_one_block  0.40007925033569336
generate_one_block  0.39336419105529785
generate_one_block  0.3903689384460449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036713600158691406
gen group dst list time:  0.03553915023803711
time for parepare:  0.019883155822753906
local_output_nid generation:  0.02838301658630371
local_in_edges_tensor generation:  0.04398965835571289
mini_batch_src_global generation:  0.04787874221801758
r_  generation:  0.4796924591064453
local_output_nid generation:  0.03512382507324219
local_in_edges_tensor generation:  0.05126070976257324
mini_batch_src_global generation:  0.053648948669433594
r_  generation:  0.4812169075012207
local_output_nid generation:  0.03531241416931152
local_in_edges_tensor generation:  0.0429377555847168
mini_batch_src_global generation:  0.05104780197143555
r_  generation:  0.49190497398376465
local_output_nid generation:  0.03514289855957031
local_in_edges_tensor generation:  0.03869009017944336
mini_batch_src_global generation:  0.0573122501373291
r_  generation:  0.4916660785675049
local_output_nid generation:  0.03519463539123535
local_in_edges_tensor generation:  0.043238162994384766
mini_batch_src_global generation:  0.0531160831451416
r_  generation:  0.4987223148345947
local_output_nid generation:  0.0353398323059082
local_in_edges_tensor generation:  0.03419613838195801
mini_batch_src_global generation:  0.05664968490600586
r_  generation:  0.48943042755126953
local_output_nid generation:  0.03548121452331543
local_in_edges_tensor generation:  0.03523993492126465
mini_batch_src_global generation:  0.053519487380981445
r_  generation:  0.5028519630432129
local_output_nid generation:  0.03558802604675293
local_in_edges_tensor generation:  0.03397631645202637
mini_batch_src_global generation:  0.05595040321350098
r_  generation:  0.4893038272857666
----------------------check_connections_block total spend ----------------------------- 5.8301756381988525
generate_one_block  0.6093530654907227
generate_one_block  0.625920295715332
generate_one_block  0.6190249919891357
generate_one_block  0.6146156787872314
generate_one_block  0.6221234798431396
generate_one_block  0.6146442890167236
generate_one_block  0.6394405364990234
generate_one_block  0.6188952922821045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  9.498561143875122
block generation total time  8.141377210617065
average batch blocks generation time:  1.0176721513271332
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09553861618041992  GigaBytes
Max Memory Allocated: 0.09553861618041992  GigaBytes

torch.Size([160293, 128])
torch.Size([140593, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.21294498443603516  GigaBytes
Max Memory Allocated: 0.21530866622924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09771585464477539  GigaBytes
Max Memory Allocated: 0.22696447372436523  GigaBytes

torch.Size([160868, 128])
torch.Size([141911, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21512317657470703  GigaBytes
Max Memory Allocated: 0.22696447372436523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09829998016357422  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160397, 128])
torch.Size([141136, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21223974227905273  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.0983881950378418  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160634, 128])
torch.Size([141483, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21302032470703125  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09836578369140625  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160531, 128])
torch.Size([141197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.2120060920715332  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09803199768066406  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160681, 128])
torch.Size([141228, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21399545669555664  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.0973362922668457  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160522, 128])
torch.Size([141288, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21236515045166016  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09787368774414062  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160523, 128])
torch.Size([141282, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21256065368652344  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035890549421310425 |0.048206716775894165 |0.09723585844039917 |0.00010055303573608398 |0.009069651365280151 |0.003572225570678711 |
----------------------------------------------------------pseudo_mini_loss sum 4.9996562004089355
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957402
Number of first layer input nodes during this epoch:  1284449
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.13953733444213867  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024053096771240234
random selection method range initialization spend 0.005843162536621094
time for parepare:  0.022154569625854492
local_output_nid generation:  0.004740238189697266
local_in_edges_tensor generation:  0.006482839584350586
mini_batch_src_global generation:  0.003239870071411133
r_  generation:  0.0368502140045166
local_output_nid generation:  0.005745410919189453
local_in_edges_tensor generation:  0.003522157669067383
mini_batch_src_global generation:  0.004215240478515625
r_  generation:  0.03984546661376953
local_output_nid generation:  0.006031036376953125
local_in_edges_tensor generation:  0.0035660266876220703
mini_batch_src_global generation:  0.002981424331665039
r_  generation:  0.03969597816467285
local_output_nid generation:  0.006061077117919922
local_in_edges_tensor generation:  0.003513336181640625
mini_batch_src_global generation:  0.003094911575317383
r_  generation:  0.039839982986450195
local_output_nid generation:  0.005991220474243164
local_in_edges_tensor generation:  0.003598451614379883
mini_batch_src_global generation:  0.0031626224517822266
r_  generation:  0.044026851654052734
local_output_nid generation:  0.006131887435913086
local_in_edges_tensor generation:  0.003549337387084961
mini_batch_src_global generation:  0.003461122512817383
r_  generation:  0.0416262149810791
local_output_nid generation:  0.006033420562744141
local_in_edges_tensor generation:  0.0035419464111328125
mini_batch_src_global generation:  0.0033850669860839844
r_  generation:  0.04799151420593262
local_output_nid generation:  0.0068166255950927734
local_in_edges_tensor generation:  0.0074503421783447266
mini_batch_src_global generation:  0.0048370361328125
r_  generation:  0.049597740173339844
----------------------check_connections_block total spend ----------------------------- 0.5637702941894531
generate_one_block  0.05468559265136719
generate_one_block  0.058541297912597656
generate_one_block  0.05762457847595215
generate_one_block  0.05973935127258301
generate_one_block  0.057909250259399414
generate_one_block  0.05701279640197754
generate_one_block  0.059583187103271484
generate_one_block  0.05660128593444824
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.060689449310302734
gen group dst list time:  0.01494598388671875
time for parepare:  0.02205944061279297
local_output_nid generation:  0.01352834701538086
local_in_edges_tensor generation:  0.04422473907470703
mini_batch_src_global generation:  0.02982926368713379
r_  generation:  0.28902578353881836
local_output_nid generation:  0.018773317337036133
local_in_edges_tensor generation:  0.03051900863647461
mini_batch_src_global generation:  0.03526186943054199
r_  generation:  0.3000826835632324
local_output_nid generation:  0.018005847930908203
local_in_edges_tensor generation:  0.02543354034423828
mini_batch_src_global generation:  0.03498268127441406
r_  generation:  0.3034989833831787
local_output_nid generation:  0.01786518096923828
local_in_edges_tensor generation:  0.020430803298950195
mini_batch_src_global generation:  0.03679633140563965
r_  generation:  0.3057117462158203
local_output_nid generation:  0.018131017684936523
local_in_edges_tensor generation:  0.027425765991210938
mini_batch_src_global generation:  0.0391240119934082
r_  generation:  0.3109731674194336
local_output_nid generation:  0.017974376678466797
local_in_edges_tensor generation:  0.025639772415161133
mini_batch_src_global generation:  0.03770947456359863
r_  generation:  0.3137993812561035
local_output_nid generation:  0.018050193786621094
local_in_edges_tensor generation:  0.022036075592041016
mini_batch_src_global generation:  0.03758597373962402
r_  generation:  0.31079697608947754
local_output_nid generation:  0.018108367919921875
local_in_edges_tensor generation:  0.02199554443359375
mini_batch_src_global generation:  0.039999961853027344
r_  generation:  0.31073737144470215
----------------------check_connections_block total spend ----------------------------- 3.641941547393799
generate_one_block  0.40099024772644043
generate_one_block  0.39553046226501465
generate_one_block  0.4029366970062256
generate_one_block  0.40773630142211914
generate_one_block  0.4128901958465576
generate_one_block  0.40631985664367676
generate_one_block  0.4193270206451416
generate_one_block  0.4374051094055176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035451412200927734
gen group dst list time:  0.036324501037597656
time for parepare:  0.02069544792175293
local_output_nid generation:  0.02863144874572754
local_in_edges_tensor generation:  0.05902886390686035
mini_batch_src_global generation:  0.049841880798339844
r_  generation:  0.473482608795166
local_output_nid generation:  0.03496193885803223
local_in_edges_tensor generation:  0.05055356025695801
mini_batch_src_global generation:  0.054444313049316406
r_  generation:  0.480069637298584
local_output_nid generation:  0.035016536712646484
local_in_edges_tensor generation:  0.047014474868774414
mini_batch_src_global generation:  0.050943613052368164
r_  generation:  0.4941694736480713
local_output_nid generation:  0.03652644157409668
local_in_edges_tensor generation:  0.05358719825744629
mini_batch_src_global generation:  0.05518698692321777
r_  generation:  0.4922974109649658
local_output_nid generation:  0.03664660453796387
local_in_edges_tensor generation:  0.04757404327392578
mini_batch_src_global generation:  0.0639493465423584
r_  generation:  0.5134124755859375
local_output_nid generation:  0.038378238677978516
local_in_edges_tensor generation:  0.05116605758666992
mini_batch_src_global generation:  0.05783653259277344
r_  generation:  0.4917168617248535
local_output_nid generation:  0.036435842514038086
local_in_edges_tensor generation:  0.0393826961517334
mini_batch_src_global generation:  0.06294107437133789
r_  generation:  0.501511812210083
local_output_nid generation:  0.03611564636230469
local_in_edges_tensor generation:  0.0380253791809082
mini_batch_src_global generation:  0.05969357490539551
r_  generation:  0.4876728057861328
----------------------check_connections_block total spend ----------------------------- 5.950387239456177
generate_one_block  0.6255979537963867
generate_one_block  0.6150162220001221
generate_one_block  0.6275670528411865
generate_one_block  0.63102126121521
generate_one_block  0.6032085418701172
generate_one_block  0.61962890625
generate_one_block  0.6002810001373291
generate_one_block  0.6068267822265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.13953733444213867  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

connection checking time:  9.592328786849976
block generation total time  8.212283611297607
average batch blocks generation time:  1.026535451412201
block dataloader generation time/epoch 19.845349311828613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09798717498779297  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160538, 128])
torch.Size([141048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21377277374267578  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09807443618774414  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160424, 128])
torch.Size([140989, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21405458450317383  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09803247451782227  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160484, 128])
torch.Size([141008, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21399354934692383  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09748506546020508  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160496, 128])
torch.Size([141189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21247577667236328  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09811782836914062  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160463, 128])
torch.Size([141063, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2142934799194336  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09876155853271484  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160547, 128])
torch.Size([141100, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21422433853149414  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.098480224609375  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160666, 128])
torch.Size([141376, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2122955322265625  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09851312637329102  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

torch.Size([160633, 128])
torch.Size([141427, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2122631072998047  GigaBytes
Max Memory Allocated: 0.22800111770629883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04070866107940674 |0.015268653631210327 |0.003645002841949463 |9.22083854675293e-05 |0.004604130983352661 |0.0029053688049316406 |
----------------------------------------------------------pseudo_mini_loss sum 4.307122707366943
Total (block generation + training)time/epoch 20.383573532104492
Training time/epoch 0.5378985404968262
Training time without block to device /epoch 0.41574931144714355
Training time without total dataloading part /epoch 0.06963610649108887
load block tensor time/epoch 0.3256692886352539
block to device time/epoch 0.12214922904968262
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2956166
Number of first layer input nodes during this epoch:  1284251
