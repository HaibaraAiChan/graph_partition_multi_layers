Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648511089.3217065
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.025074481964111328
random selection method range initialization spend 0.006206989288330078
time for parepare:  0.018427133560180664
local_output_nid generation:  0.008331298828125
local_in_edges_tensor generation:  0.00898432731628418
mini_batch_src_global generation:  0.006494283676147461
r_  generation:  0.0818185806274414
local_output_nid generation:  0.011536359786987305
local_in_edges_tensor generation:  0.006067991256713867
mini_batch_src_global generation:  0.008637189865112305
r_  generation:  0.08747196197509766
local_output_nid generation:  0.011741399765014648
local_in_edges_tensor generation:  0.006129264831542969
mini_batch_src_global generation:  0.006790876388549805
r_  generation:  0.08875012397766113
local_output_nid generation:  0.01172494888305664
local_in_edges_tensor generation:  0.006114959716796875
mini_batch_src_global generation:  0.007153987884521484
r_  generation:  0.09159421920776367
----------------------check_connections_block total spend ----------------------------- 0.5487465858459473
generate_one_block  0.10162639617919922
generate_one_block  0.10391879081726074
generate_one_block  0.10259151458740234
generate_one_block  0.1023566722869873
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04183077812194824
gen group dst list time:  0.011697530746459961
time for parepare:  0.019858121871948242
local_output_nid generation:  0.019391536712646484
local_in_edges_tensor generation:  0.04341006278991699
mini_batch_src_global generation:  0.04171466827392578
r_  generation:  0.4016599655151367
local_output_nid generation:  0.02875351905822754
local_in_edges_tensor generation:  0.04132986068725586
mini_batch_src_global generation:  0.048046112060546875
r_  generation:  0.41012001037597656
local_output_nid generation:  0.02936863899230957
local_in_edges_tensor generation:  0.0332944393157959
mini_batch_src_global generation:  0.04853224754333496
r_  generation:  0.4203214645385742
local_output_nid generation:  0.029766082763671875
local_in_edges_tensor generation:  0.037537336349487305
mini_batch_src_global generation:  0.05225944519042969
r_  generation:  0.42156076431274414
----------------------check_connections_block total spend ----------------------------- 2.504037857055664
generate_one_block  0.5678868293762207
generate_one_block  0.5360429286956787
generate_one_block  0.544919490814209
generate_one_block  0.5514237880706787
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.035767316818237305
gen group dst list time:  0.021310091018676758
time for parepare:  0.019031763076782227
local_output_nid generation:  0.03005075454711914
local_in_edges_tensor generation:  0.043598175048828125
mini_batch_src_global generation:  0.0540013313293457
r_  generation:  0.5396244525909424
local_output_nid generation:  0.0402073860168457
local_in_edges_tensor generation:  0.057709693908691406
mini_batch_src_global generation:  0.06280255317687988
r_  generation:  0.549206018447876
local_output_nid generation:  0.036405324935913086
local_in_edges_tensor generation:  0.04280900955200195
mini_batch_src_global generation:  0.0579524040222168
r_  generation:  0.5667448043823242
local_output_nid generation:  0.03803300857543945
local_in_edges_tensor generation:  0.052054643630981445
mini_batch_src_global generation:  0.06151151657104492
r_  generation:  0.5659723281860352
----------------------check_connections_block total spend ----------------------------- 3.316335678100586
generate_one_block  0.7371883392333984
generate_one_block  0.705538272857666
generate_one_block  0.7016160488128662
generate_one_block  0.7057042121887207
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05085873603820801
gen group dst list time:  0.03278183937072754
time for parepare:  0.018591642379760742
local_output_nid generation:  0.03353095054626465
local_in_edges_tensor generation:  0.06506681442260742
mini_batch_src_global generation:  0.055678367614746094
r_  generation:  0.5505445003509521
local_output_nid generation:  0.03969097137451172
local_in_edges_tensor generation:  0.05880284309387207
mini_batch_src_global generation:  0.06359052658081055
r_  generation:  0.5641520023345947
local_output_nid generation:  0.03840136528015137
local_in_edges_tensor generation:  0.048696041107177734
mini_batch_src_global generation:  0.06408858299255371
r_  generation:  0.5686123371124268
local_output_nid generation:  0.038410186767578125
local_in_edges_tensor generation:  0.03990435600280762
mini_batch_src_global generation:  0.0635831356048584
r_  generation:  0.5627319812774658
----------------------check_connections_block total spend ----------------------------- 3.379084587097168
generate_one_block  0.7055788040161133
generate_one_block  0.7424435615539551
generate_one_block  0.7059659957885742
generate_one_block  0.713869571685791
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04439568519592285
gen group dst list time:  0.027074575424194336
time for parepare:  0.019314050674438477
local_output_nid generation:  0.03454995155334473
local_in_edges_tensor generation:  0.04710578918457031
mini_batch_src_global generation:  0.050873517990112305
r_  generation:  0.5415141582489014
local_output_nid generation:  0.04211115837097168
local_in_edges_tensor generation:  0.04199957847595215
mini_batch_src_global generation:  0.06373095512390137
r_  generation:  0.5443055629730225
local_output_nid generation:  0.03892087936401367
local_in_edges_tensor generation:  0.04639410972595215
mini_batch_src_global generation:  0.06375360488891602
r_  generation:  0.5515413284301758
local_output_nid generation:  0.04056549072265625
local_in_edges_tensor generation:  0.04163408279418945
mini_batch_src_global generation:  0.06359601020812988
r_  generation:  0.5547196865081787
----------------------check_connections_block total spend ----------------------------- 3.295675277709961
generate_one_block  0.686499834060669
generate_one_block  0.7001597881317139
generate_one_block  0.7035095691680908
generate_one_block  0.7119290828704834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03278398513793945
gen group dst list time:  0.028910160064697266
time for parepare:  0.01899099349975586
local_output_nid generation:  0.034360408782958984
local_in_edges_tensor generation:  0.049303531646728516
mini_batch_src_global generation:  0.04635119438171387
r_  generation:  0.5068597793579102
local_output_nid generation:  0.03929328918457031
local_in_edges_tensor generation:  0.0484161376953125
mini_batch_src_global generation:  0.05784463882446289
r_  generation:  0.5081114768981934
local_output_nid generation:  0.03921318054199219
local_in_edges_tensor generation:  0.044742584228515625
mini_batch_src_global generation:  0.05832219123840332
r_  generation:  0.5319375991821289
local_output_nid generation:  0.039345502853393555
local_in_edges_tensor generation:  0.04010891914367676
mini_batch_src_global generation:  0.059316158294677734
r_  generation:  0.5216734409332275
----------------------check_connections_block total spend ----------------------------- 3.1304798126220703
generate_one_block  0.6434905529022217
generate_one_block  0.6768379211425781
generate_one_block  0.6349105834960938
generate_one_block  0.6362369060516357
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

connection checking time:  15.62561321258545
block generation total time  13.311752080917358
average batch blocks generation time:  3.3279380202293396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.14287996292114258  GigaBytes
Max Memory Allocated: 0.14287996292114258  GigaBytes

torch.Size([167762, 128])
torch.Size([167509, 128])
torch.Size([166902, 128])
torch.Size([164772, 128])
torch.Size([154984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2127685546875 GB
    Memory Allocated: 1.7545275688171387  GigaBytes
Max Memory Allocated: 1.7943625450134277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.1482071876525879  GigaBytes
Max Memory Allocated: 1.8502373695373535  GigaBytes

torch.Size([167753, 128])
torch.Size([167533, 128])
torch.Size([166944, 128])
torch.Size([164893, 128])
torch.Size([155083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.7568988800048828  GigaBytes
Max Memory Allocated: 1.8502373695373535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.14776039123535156  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

torch.Size([167748, 128])
torch.Size([167509, 128])
torch.Size([166896, 128])
torch.Size([164787, 128])
torch.Size([154863, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.7547907829284668  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.14780807495117188  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

torch.Size([167750, 128])
torch.Size([167521, 128])
torch.Size([166915, 128])
torch.Size([164794, 128])
torch.Size([155066, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.7553200721740723  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06977880001068115 |0.13150179386138916 |0.18365448713302612 |0.0001195073127746582 |0.05806279182434082 |0.00413060188293457 |
----------------------------------------------------------pseudo_mini_loss sum 5.924466133117676
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3693141
Number of first layer input nodes during this epoch:  671013
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 0.26728296279907227  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.020666122436523438
random selection method range initialization spend 0.0048847198486328125
time for parepare:  0.017287731170654297
local_output_nid generation:  0.00877833366394043
local_in_edges_tensor generation:  0.008800745010375977
mini_batch_src_global generation:  0.00652766227722168
r_  generation:  0.08036923408508301
local_output_nid generation:  0.011737585067749023
local_in_edges_tensor generation:  0.0058329105377197266
mini_batch_src_global generation:  0.00987386703491211
r_  generation:  0.08713459968566895
local_output_nid generation:  0.01187276840209961
local_in_edges_tensor generation:  0.005729198455810547
mini_batch_src_global generation:  0.006612300872802734
r_  generation:  0.09012293815612793
local_output_nid generation:  0.01182103157043457
local_in_edges_tensor generation:  0.005883216857910156
mini_batch_src_global generation:  0.008525848388671875
r_  generation:  0.09315633773803711
----------------------check_connections_block total spend ----------------------------- 0.5527410507202148
generate_one_block  0.098785400390625
generate_one_block  0.1012420654296875
generate_one_block  0.10144281387329102
generate_one_block  0.10309433937072754
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03926205635070801
gen group dst list time:  0.01129913330078125
time for parepare:  0.01894235610961914
local_output_nid generation:  0.01999688148498535
local_in_edges_tensor generation:  0.04385113716125488
mini_batch_src_global generation:  0.04157257080078125
r_  generation:  0.4008314609527588
local_output_nid generation:  0.026311635971069336
local_in_edges_tensor generation:  0.041007041931152344
mini_batch_src_global generation:  0.04900407791137695
r_  generation:  0.41658496856689453
local_output_nid generation:  0.025300264358520508
local_in_edges_tensor generation:  0.030939340591430664
mini_batch_src_global generation:  0.05246567726135254
r_  generation:  0.42610955238342285
local_output_nid generation:  0.026223421096801758
local_in_edges_tensor generation:  0.0395817756652832
mini_batch_src_global generation:  0.06212306022644043
r_  generation:  0.4315519332885742
----------------------check_connections_block total spend ----------------------------- 2.5320146083831787
generate_one_block  0.539252758026123
generate_one_block  0.5479915142059326
generate_one_block  0.5642163753509521
generate_one_block  0.5356433391571045
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04476308822631836
gen group dst list time:  0.021429061889648438
time for parepare:  0.01895594596862793
local_output_nid generation:  0.029656648635864258
local_in_edges_tensor generation:  0.06603360176086426
mini_batch_src_global generation:  0.04992985725402832
r_  generation:  0.5459549427032471
local_output_nid generation:  0.03664231300354004
local_in_edges_tensor generation:  0.0569911003112793
mini_batch_src_global generation:  0.061713457107543945
r_  generation:  0.5509729385375977
local_output_nid generation:  0.03711962699890137
local_in_edges_tensor generation:  0.04713106155395508
mini_batch_src_global generation:  0.05638480186462402
r_  generation:  0.5637490749359131
local_output_nid generation:  0.03682661056518555
local_in_edges_tensor generation:  0.03682589530944824
mini_batch_src_global generation:  0.05787205696105957
r_  generation:  0.5649006366729736
----------------------check_connections_block total spend ----------------------------- 3.3041610717773438
generate_one_block  0.714754581451416
generate_one_block  0.7131204605102539
generate_one_block  0.6977636814117432
generate_one_block  0.6892642974853516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04455280303955078
gen group dst list time:  0.02379465103149414
time for parepare:  0.019206762313842773
local_output_nid generation:  0.03422665596008301
local_in_edges_tensor generation:  0.05054163932800293
mini_batch_src_global generation:  0.05198335647583008
r_  generation:  0.5564324855804443
local_output_nid generation:  0.039880990982055664
local_in_edges_tensor generation:  0.058016300201416016
mini_batch_src_global generation:  0.06405472755432129
r_  generation:  0.5613210201263428
local_output_nid generation:  0.038973093032836914
local_in_edges_tensor generation:  0.049009084701538086
mini_batch_src_global generation:  0.06375837326049805
r_  generation:  0.5617563724517822
local_output_nid generation:  0.03919506072998047
local_in_edges_tensor generation:  0.03847694396972656
mini_batch_src_global generation:  0.0629587173461914
r_  generation:  0.5639994144439697
----------------------check_connections_block total spend ----------------------------- 3.3608410358428955
generate_one_block  0.6979622840881348
generate_one_block  0.7197911739349365
generate_one_block  0.7071423530578613
generate_one_block  0.7134051322937012
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03770303726196289
gen group dst list time:  0.02501654624938965
time for parepare:  0.019102096557617188
local_output_nid generation:  0.03341031074523926
local_in_edges_tensor generation:  0.04965376853942871
mini_batch_src_global generation:  0.04975771903991699
r_  generation:  0.5433521270751953
local_output_nid generation:  0.04025411605834961
local_in_edges_tensor generation:  0.03943943977355957
mini_batch_src_global generation:  0.06295490264892578
r_  generation:  0.5550029277801514
local_output_nid generation:  0.03993558883666992
local_in_edges_tensor generation:  0.04982590675354004
mini_batch_src_global generation:  0.06232857704162598
r_  generation:  0.5515186786651611
local_output_nid generation:  0.04000687599182129
local_in_edges_tensor generation:  0.04398202896118164
mini_batch_src_global generation:  0.06372714042663574
r_  generation:  0.559506893157959
----------------------check_connections_block total spend ----------------------------- 3.321308135986328
generate_one_block  0.6841392517089844
generate_one_block  0.6949043273925781
generate_one_block  0.6998648643493652
generate_one_block  0.695460319519043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037549495697021484
gen group dst list time:  0.02465963363647461
time for parepare:  0.01880049705505371
local_output_nid generation:  0.034761667251586914
local_in_edges_tensor generation:  0.04540109634399414
mini_batch_src_global generation:  0.04572439193725586
r_  generation:  0.5084991455078125
local_output_nid generation:  0.04101085662841797
local_in_edges_tensor generation:  0.052645206451416016
mini_batch_src_global generation:  0.05844879150390625
r_  generation:  0.5160887241363525
local_output_nid generation:  0.03958463668823242
local_in_edges_tensor generation:  0.0440213680267334
mini_batch_src_global generation:  0.05923581123352051
r_  generation:  0.5160534381866455
local_output_nid generation:  0.04335284233093262
local_in_edges_tensor generation:  0.03564453125
mini_batch_src_global generation:  0.058620452880859375
r_  generation:  0.5196151733398438
----------------------check_connections_block total spend ----------------------------- 3.123216390609741
generate_one_block  0.630040168762207
generate_one_block  0.6497030258178711
generate_one_block  0.6539802551269531
generate_one_block  0.6699774265289307
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 0.26728296279907227  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

connection checking time:  15.641541242599487
block generation total time  13.218377590179443
average batch blocks generation time:  3.304594397544861
block dataloader generation time/epoch 31.335060596466064
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 0.14979028701782227  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

torch.Size([167738, 128])
torch.Size([167458, 128])
torch.Size([166841, 128])
torch.Size([164776, 128])
torch.Size([155007, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5936279296875 GB
    Memory Allocated: 1.759775161743164  GigaBytes
Max Memory Allocated: 1.8518481254577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5955810546875 GB
    Memory Allocated: 0.15045404434204102  GigaBytes
Max Memory Allocated: 1.8554210662841797  GigaBytes

torch.Size([167776, 128])
torch.Size([167552, 128])
torch.Size([166957, 128])
torch.Size([164875, 128])
torch.Size([155168, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5955810546875 GB
    Memory Allocated: 1.760030746459961  GigaBytes
Max Memory Allocated: 1.8554210662841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5975341796875 GB
    Memory Allocated: 0.14978837966918945  GigaBytes
Max Memory Allocated: 1.8558330535888672  GigaBytes

torch.Size([167777, 128])
torch.Size([167539, 128])
torch.Size([166923, 128])
torch.Size([164791, 128])
torch.Size([155132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5975341796875 GB
    Memory Allocated: 1.7598133087158203  GigaBytes
Max Memory Allocated: 1.8558330535888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5975341796875 GB
    Memory Allocated: 0.14951276779174805  GigaBytes
Max Memory Allocated: 1.8558330535888672  GigaBytes

torch.Size([167712, 128])
torch.Size([167472, 128])
torch.Size([166863, 128])
torch.Size([164725, 128])
torch.Size([154891, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5975341796875 GB
    Memory Allocated: 1.7578620910644531  GigaBytes
Max Memory Allocated: 1.8558330535888672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08725172281265259 |0.03794211149215698 |0.007418334484100342 |0.0001074671745300293 |0.0322529673576355 |0.005901336669921875 |
----------------------------------------------------------pseudo_mini_loss sum 4.145681381225586
Total (block generation + training)time/epoch 32.10720157623291
Training time/epoch 0.7717852592468262
Training time without block to device /epoch 0.6200168132781982
Training time without total dataloading part /epoch 0.16501641273498535
load block tensor time/epoch 0.34900689125061035
block to device time/epoch 0.15176844596862793
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3693623
Number of first layer input nodes during this epoch:  671003
