Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648494538.5142043
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02496814727783203
random selection method range initialization spend 0.006445169448852539
time for parepare:  0.018551111221313477
local_output_nid generation:  0.004306793212890625
local_in_edges_tensor generation:  0.006139278411865234
mini_batch_src_global generation:  0.003386259078979492
r_  generation:  0.03813004493713379
local_output_nid generation:  0.005743741989135742
local_in_edges_tensor generation:  0.003050565719604492
mini_batch_src_global generation:  0.004199504852294922
r_  generation:  0.03886079788208008
local_output_nid generation:  0.0061266422271728516
local_in_edges_tensor generation:  0.003068685531616211
mini_batch_src_global generation:  0.002947568893432617
r_  generation:  0.0394439697265625
local_output_nid generation:  0.006194114685058594
local_in_edges_tensor generation:  0.0031468868255615234
mini_batch_src_global generation:  0.003002166748046875
r_  generation:  0.04088425636291504
local_output_nid generation:  0.006136894226074219
local_in_edges_tensor generation:  0.003108978271484375
mini_batch_src_global generation:  0.003063201904296875
r_  generation:  0.04068756103515625
local_output_nid generation:  0.006112098693847656
local_in_edges_tensor generation:  0.0031676292419433594
mini_batch_src_global generation:  0.0032165050506591797
r_  generation:  0.04125857353210449
local_output_nid generation:  0.006102800369262695
local_in_edges_tensor generation:  0.0030031204223632812
mini_batch_src_global generation:  0.0033235549926757812
r_  generation:  0.042386531829833984
local_output_nid generation:  0.006117343902587891
local_in_edges_tensor generation:  0.0030837059020996094
mini_batch_src_global generation:  0.0033309459686279297
r_  generation:  0.041139841079711914
----------------------check_connections_block total spend ----------------------------- 0.5192825794219971
generate_one_block  0.05572366714477539
generate_one_block  0.0551145076751709
generate_one_block  0.05561709403991699
generate_one_block  0.05539250373840332
generate_one_block  0.05815911293029785
generate_one_block  0.054574012756347656
generate_one_block  0.0564570426940918
generate_one_block  0.05590033531188965
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04100632667541504
gen group dst list time:  0.015257835388183594
time for parepare:  0.019752025604248047
local_output_nid generation:  0.013735055923461914
local_in_edges_tensor generation:  0.03070855140686035
mini_batch_src_global generation:  0.02860093116760254
r_  generation:  0.3044452667236328
local_output_nid generation:  0.021642684936523438
local_in_edges_tensor generation:  0.03171062469482422
mini_batch_src_global generation:  0.044203996658325195
r_  generation:  0.3255422115325928
local_output_nid generation:  0.021820545196533203
local_in_edges_tensor generation:  0.02927851676940918
mini_batch_src_global generation:  0.03640556335449219
r_  generation:  0.3280608654022217
local_output_nid generation:  0.021788835525512695
local_in_edges_tensor generation:  0.02344346046447754
mini_batch_src_global generation:  0.04024672508239746
r_  generation:  0.3372802734375
local_output_nid generation:  0.01968240737915039
local_in_edges_tensor generation:  0.041420936584472656
mini_batch_src_global generation:  0.047563791275024414
r_  generation:  0.31680750846862793
local_output_nid generation:  0.019663333892822266
local_in_edges_tensor generation:  0.027107954025268555
mini_batch_src_global generation:  0.038369178771972656
r_  generation:  0.3114657402038574
local_output_nid generation:  0.018640995025634766
local_in_edges_tensor generation:  0.020885229110717773
mini_batch_src_global generation:  0.03890490531921387
r_  generation:  0.3215672969818115
local_output_nid generation:  0.018555164337158203
local_in_edges_tensor generation:  0.020639419555664062
mini_batch_src_global generation:  0.03826284408569336
r_  generation:  0.31705212593078613
----------------------check_connections_block total spend ----------------------------- 3.8447463512420654
generate_one_block  0.41802191734313965
generate_one_block  0.41132593154907227
generate_one_block  0.41228485107421875
generate_one_block  0.4125525951385498
generate_one_block  0.40955185890197754
generate_one_block  0.4379768371582031
generate_one_block  0.4334452152252197
generate_one_block  0.41219329833984375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0677187442779541
gen group dst list time:  0.04162430763244629
time for parepare:  0.019206523895263672
local_output_nid generation:  0.0298001766204834
local_in_edges_tensor generation:  0.05540609359741211
mini_batch_src_global generation:  0.04864501953125
r_  generation:  0.5397706031799316
local_output_nid generation:  0.03551769256591797
local_in_edges_tensor generation:  0.05416274070739746
mini_batch_src_global generation:  0.060448408126831055
r_  generation:  0.546699047088623
local_output_nid generation:  0.03600049018859863
local_in_edges_tensor generation:  0.045810699462890625
mini_batch_src_global generation:  0.056407928466796875
r_  generation:  0.5508806705474854
local_output_nid generation:  0.036775827407836914
local_in_edges_tensor generation:  0.04770207405090332
mini_batch_src_global generation:  0.061258792877197266
r_  generation:  0.5602989196777344
local_output_nid generation:  0.03886127471923828
local_in_edges_tensor generation:  0.04714393615722656
mini_batch_src_global generation:  0.06737899780273438
r_  generation:  0.559410572052002
local_output_nid generation:  0.03666877746582031
local_in_edges_tensor generation:  0.04203176498413086
mini_batch_src_global generation:  0.06351900100708008
r_  generation:  0.5415661334991455
local_output_nid generation:  0.03665733337402344
local_in_edges_tensor generation:  0.045427560806274414
mini_batch_src_global generation:  0.05897092819213867
r_  generation:  0.5489728450775146
local_output_nid generation:  0.03677511215209961
local_in_edges_tensor generation:  0.04001259803771973
mini_batch_src_global generation:  0.0613865852355957
r_  generation:  0.5421319007873535
----------------------check_connections_block total spend ----------------------------- 6.547816514968872
generate_one_block  0.6906173229217529
generate_one_block  0.6902344226837158
generate_one_block  0.722510576248169
generate_one_block  0.7079448699951172
generate_one_block  0.6774168014526367
generate_one_block  0.6866872310638428
generate_one_block  0.7277371883392334
generate_one_block  0.6783723831176758
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045623779296875
gen group dst list time:  0.04496407508850098
time for parepare:  0.019252538681030273
local_output_nid generation:  0.035088300704956055
local_in_edges_tensor generation:  0.05836653709411621
mini_batch_src_global generation:  0.04988503456115723
r_  generation:  0.5377912521362305
local_output_nid generation:  0.039816856384277344
local_in_edges_tensor generation:  0.05458211898803711
mini_batch_src_global generation:  0.06196022033691406
r_  generation:  0.5423007011413574
local_output_nid generation:  0.038915395736694336
local_in_edges_tensor generation:  0.050247907638549805
mini_batch_src_global generation:  0.06118416786193848
r_  generation:  0.5572667121887207
local_output_nid generation:  0.03920769691467285
local_in_edges_tensor generation:  0.04049992561340332
mini_batch_src_global generation:  0.05897378921508789
r_  generation:  0.5576908588409424
local_output_nid generation:  0.039220571517944336
local_in_edges_tensor generation:  0.040560007095336914
mini_batch_src_global generation:  0.06303548812866211
r_  generation:  0.5537018775939941
local_output_nid generation:  0.038980722427368164
local_in_edges_tensor generation:  0.04617142677307129
mini_batch_src_global generation:  0.05779218673706055
r_  generation:  0.5555119514465332
local_output_nid generation:  0.03896474838256836
local_in_edges_tensor generation:  0.03661608695983887
mini_batch_src_global generation:  0.05950665473937988
r_  generation:  0.5641403198242188
local_output_nid generation:  0.03963160514831543
local_in_edges_tensor generation:  0.03607797622680664
mini_batch_src_global generation:  0.059484243392944336
r_  generation:  0.5640244483947754
----------------------check_connections_block total spend ----------------------------- 6.59637975692749
generate_one_block  0.6838846206665039
generate_one_block  0.6926665306091309
generate_one_block  0.6889040470123291
generate_one_block  0.6905262470245361
generate_one_block  0.6914651393890381
generate_one_block  0.6888294219970703
generate_one_block  0.7221226692199707
generate_one_block  0.6984410285949707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0521237850189209
gen group dst list time:  0.0480649471282959
time for parepare:  0.01934194564819336
local_output_nid generation:  0.03668785095214844
local_in_edges_tensor generation:  0.04912376403808594
mini_batch_src_global generation:  0.04749584197998047
r_  generation:  0.5052182674407959
local_output_nid generation:  0.04072904586791992
local_in_edges_tensor generation:  0.0398714542388916
mini_batch_src_global generation:  0.05733036994934082
r_  generation:  0.5221343040466309
local_output_nid generation:  0.04160618782043457
local_in_edges_tensor generation:  0.041663169860839844
mini_batch_src_global generation:  0.05821824073791504
r_  generation:  0.5106916427612305
local_output_nid generation:  0.041365861892700195
local_in_edges_tensor generation:  0.0420231819152832
mini_batch_src_global generation:  0.05797076225280762
r_  generation:  0.5135266780853271
local_output_nid generation:  0.04307198524475098
local_in_edges_tensor generation:  0.04181933403015137
mini_batch_src_global generation:  0.06047964096069336
r_  generation:  0.5164968967437744
local_output_nid generation:  0.04123663902282715
local_in_edges_tensor generation:  0.03764772415161133
mini_batch_src_global generation:  0.05762815475463867
r_  generation:  0.5177516937255859
local_output_nid generation:  0.0413508415222168
local_in_edges_tensor generation:  0.04146385192871094
mini_batch_src_global generation:  0.05790233612060547
r_  generation:  0.5160760879516602
local_output_nid generation:  0.04162931442260742
local_in_edges_tensor generation:  0.04643058776855469
mini_batch_src_global generation:  0.05694150924682617
r_  generation:  0.5212290287017822
----------------------check_connections_block total spend ----------------------------- 6.21771502494812
generate_one_block  0.63039231300354
generate_one_block  0.6422090530395508
generate_one_block  0.6453697681427002
generate_one_block  0.6384389400482178
generate_one_block  0.6430552005767822
generate_one_block  0.6354992389678955
generate_one_block  0.6374602317810059
generate_one_block  0.6897051334381104
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

connection checking time:  23.206657648086548
block generation total time  19.64784288406372
average batch blocks generation time:  2.455980360507965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.1277632713317871  GigaBytes
Max Memory Allocated: 0.1277632713317871  GigaBytes

torch.Size([166955, 128])
torch.Size([165691, 256])
torch.Size([161317, 256])
torch.Size([142136, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.2858080863952637  GigaBytes
Max Memory Allocated: 2.3479390144348145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 0.1311020851135254  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166992, 128])
torch.Size([165827, 256])
torch.Size([161419, 256])
torch.Size([141899, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.2806396484375  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.1318349838256836  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166960, 128])
torch.Size([165753, 256])
torch.Size([161490, 256])
torch.Size([142200, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.28409481048584  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.13193559646606445  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([167027, 128])
torch.Size([165809, 256])
torch.Size([161326, 256])
torch.Size([142002, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.282116413116455  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.13202333450317383  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([167028, 128])
torch.Size([165875, 256])
torch.Size([161436, 256])
torch.Size([142044, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.2815399169921875  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.1309223175048828  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166989, 128])
torch.Size([165785, 256])
torch.Size([161419, 256])
torch.Size([142064, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.278726577758789  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.1316671371459961  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166927, 128])
torch.Size([165727, 256])
torch.Size([161304, 256])
torch.Size([142005, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.281564712524414  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.13150501251220703  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166941, 128])
torch.Size([165740, 256])
torch.Size([161352, 256])
torch.Size([141900, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.2805285453796387  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13447356224060059 |0.07677128911018372 |0.10469129681587219 |0.00010558962821960449 |0.06273442506790161 |0.0039327144622802734 |
----------------------------------------------------------pseudo_mini_loss sum 6.034846782684326
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5632301
Number of first layer input nodes during this epoch:  1335819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.21765708923339844  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025394678115844727
random selection method range initialization spend 0.006821870803833008
time for parepare:  0.018790483474731445
local_output_nid generation:  0.004647254943847656
local_in_edges_tensor generation:  0.007909536361694336
mini_batch_src_global generation:  0.003964662551879883
r_  generation:  0.03687715530395508
local_output_nid generation:  0.005854129791259766
local_in_edges_tensor generation:  0.003225088119506836
mini_batch_src_global generation:  0.004048347473144531
r_  generation:  0.039569854736328125
local_output_nid generation:  0.005964756011962891
local_in_edges_tensor generation:  0.0031425952911376953
mini_batch_src_global generation:  0.003367900848388672
r_  generation:  0.0411372184753418
local_output_nid generation:  0.0061016082763671875
local_in_edges_tensor generation:  0.0032088756561279297
mini_batch_src_global generation:  0.003608226776123047
r_  generation:  0.04200911521911621
local_output_nid generation:  0.0059964656829833984
local_in_edges_tensor generation:  0.0031676292419433594
mini_batch_src_global generation:  0.003073453903198242
r_  generation:  0.040320634841918945
local_output_nid generation:  0.00603032112121582
local_in_edges_tensor generation:  0.0030798912048339844
mini_batch_src_global generation:  0.003389120101928711
r_  generation:  0.04159259796142578
local_output_nid generation:  0.006026268005371094
local_in_edges_tensor generation:  0.003213644027709961
mini_batch_src_global generation:  0.0033257007598876953
r_  generation:  0.04212832450866699
local_output_nid generation:  0.0060427188873291016
local_in_edges_tensor generation:  0.0030167102813720703
mini_batch_src_global generation:  0.0033588409423828125
r_  generation:  0.041852474212646484
----------------------check_connections_block total spend ----------------------------- 0.5333132743835449
generate_one_block  0.06059122085571289
generate_one_block  0.0533599853515625
generate_one_block  0.05401039123535156
generate_one_block  0.05481719970703125
generate_one_block  0.054169654846191406
generate_one_block  0.05456352233886719
generate_one_block  0.05550241470336914
generate_one_block  0.05812430381774902
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03913474082946777
gen group dst list time:  0.014299392700195312
time for parepare:  0.01864480972290039
local_output_nid generation:  0.012975215911865234
local_in_edges_tensor generation:  0.03143906593322754
mini_batch_src_global generation:  0.027896642684936523
r_  generation:  0.2933821678161621
local_output_nid generation:  0.018016338348388672
local_in_edges_tensor generation:  0.029458284378051758
mini_batch_src_global generation:  0.035593509674072266
r_  generation:  0.31052160263061523
local_output_nid generation:  0.018693208694458008
local_in_edges_tensor generation:  0.02722787857055664
mini_batch_src_global generation:  0.03581738471984863
r_  generation:  0.3154473304748535
local_output_nid generation:  0.018860816955566406
local_in_edges_tensor generation:  0.025372028350830078
mini_batch_src_global generation:  0.0370030403137207
r_  generation:  0.32112574577331543
local_output_nid generation:  0.01771402359008789
local_in_edges_tensor generation:  0.019673824310302734
mini_batch_src_global generation:  0.04005551338195801
r_  generation:  0.3165910243988037
local_output_nid generation:  0.017818450927734375
local_in_edges_tensor generation:  0.020021677017211914
mini_batch_src_global generation:  0.038491249084472656
r_  generation:  0.32625651359558105
local_output_nid generation:  0.018878698348999023
local_in_edges_tensor generation:  0.0280306339263916
mini_batch_src_global generation:  0.038535118103027344
r_  generation:  0.3431546688079834
local_output_nid generation:  0.020394325256347656
local_in_edges_tensor generation:  0.03341531753540039
mini_batch_src_global generation:  0.04486823081970215
r_  generation:  0.32237863540649414
----------------------check_connections_block total spend ----------------------------- 3.768462896347046
generate_one_block  0.40768861770629883
generate_one_block  0.40045166015625
generate_one_block  0.4239933490753174
generate_one_block  0.41771554946899414
generate_one_block  0.4087834358215332
generate_one_block  0.40421080589294434
generate_one_block  0.41562604904174805
generate_one_block  0.44196200370788574
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.049309730529785156
gen group dst list time:  0.03994011878967285
time for parepare:  0.0182340145111084
local_output_nid generation:  0.02837061882019043
local_in_edges_tensor generation:  0.06194496154785156
mini_batch_src_global generation:  0.04911994934082031
r_  generation:  0.5251097679138184
local_output_nid generation:  0.03861856460571289
local_in_edges_tensor generation:  0.05940508842468262
mini_batch_src_global generation:  0.07049441337585449
r_  generation:  0.532785177230835
local_output_nid generation:  0.03547263145446777
local_in_edges_tensor generation:  0.04288291931152344
mini_batch_src_global generation:  0.06060314178466797
r_  generation:  0.5416264533996582
local_output_nid generation:  0.03556323051452637
local_in_edges_tensor generation:  0.04976987838745117
mini_batch_src_global generation:  0.06075096130371094
r_  generation:  0.540726900100708
local_output_nid generation:  0.03542685508728027
local_in_edges_tensor generation:  0.03994131088256836
mini_batch_src_global generation:  0.05885791778564453
r_  generation:  0.5565299987792969
local_output_nid generation:  0.03506064414978027
local_in_edges_tensor generation:  0.03517317771911621
mini_batch_src_global generation:  0.0617070198059082
r_  generation:  0.542130708694458
local_output_nid generation:  0.035161495208740234
local_in_edges_tensor generation:  0.03918743133544922
mini_batch_src_global generation:  0.05932474136352539
r_  generation:  0.5482916831970215
local_output_nid generation:  0.035085201263427734
local_in_edges_tensor generation:  0.03995776176452637
mini_batch_src_global generation:  0.06444573402404785
r_  generation:  0.5341296195983887
----------------------check_connections_block total spend ----------------------------- 6.406934022903442
generate_one_block  0.6782371997833252
generate_one_block  0.6732649803161621
generate_one_block  0.6811187267303467
generate_one_block  0.6785306930541992
generate_one_block  0.6896524429321289
generate_one_block  0.691420316696167
generate_one_block  0.6739253997802734
generate_one_block  0.6967349052429199
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04410886764526367
gen group dst list time:  0.05364274978637695
time for parepare:  0.018840312957763672
local_output_nid generation:  0.03402566909790039
local_in_edges_tensor generation:  0.06379413604736328
mini_batch_src_global generation:  0.052965641021728516
r_  generation:  0.5345184803009033
local_output_nid generation:  0.04132509231567383
local_in_edges_tensor generation:  0.08918404579162598
mini_batch_src_global generation:  0.06132769584655762
r_  generation:  0.5377817153930664
local_output_nid generation:  0.039086341857910156
local_in_edges_tensor generation:  0.04256916046142578
mini_batch_src_global generation:  0.06465935707092285
r_  generation:  0.5415668487548828
local_output_nid generation:  0.03923344612121582
local_in_edges_tensor generation:  0.05769824981689453
mini_batch_src_global generation:  0.06201481819152832
r_  generation:  0.5590963363647461
local_output_nid generation:  0.03929424285888672
local_in_edges_tensor generation:  0.03867650032043457
mini_batch_src_global generation:  0.05876636505126953
r_  generation:  0.5576040744781494
local_output_nid generation:  0.03889751434326172
local_in_edges_tensor generation:  0.03868746757507324
mini_batch_src_global generation:  0.06384921073913574
r_  generation:  0.5521869659423828
local_output_nid generation:  0.03908944129943848
local_in_edges_tensor generation:  0.03747391700744629
mini_batch_src_global generation:  0.05962395668029785
r_  generation:  0.5559115409851074
local_output_nid generation:  0.03898954391479492
local_in_edges_tensor generation:  0.0474553108215332
mini_batch_src_global generation:  0.058653831481933594
r_  generation:  0.558896541595459
----------------------check_connections_block total spend ----------------------------- 6.618267059326172
generate_one_block  0.6911900043487549
generate_one_block  0.6728546619415283
generate_one_block  0.6902053356170654
generate_one_block  0.6882331371307373
generate_one_block  0.6873888969421387
generate_one_block  0.6791925430297852
generate_one_block  0.6854767799377441
generate_one_block  0.7002232074737549
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04300236701965332
gen group dst list time:  0.049692392349243164
time for parepare:  0.018585920333862305
local_output_nid generation:  0.03576469421386719
local_in_edges_tensor generation:  0.04999232292175293
mini_batch_src_global generation:  0.04646015167236328
r_  generation:  0.501929759979248
local_output_nid generation:  0.04059195518493652
local_in_edges_tensor generation:  0.03675723075866699
mini_batch_src_global generation:  0.05767464637756348
r_  generation:  0.5183618068695068
local_output_nid generation:  0.04270648956298828
local_in_edges_tensor generation:  0.03976035118103027
mini_batch_src_global generation:  0.06424689292907715
r_  generation:  0.5078864097595215
local_output_nid generation:  0.04154825210571289
local_in_edges_tensor generation:  0.03741312026977539
mini_batch_src_global generation:  0.058144330978393555
r_  generation:  0.5092697143554688
local_output_nid generation:  0.04180097579956055
local_in_edges_tensor generation:  0.04422950744628906
mini_batch_src_global generation:  0.05826830863952637
r_  generation:  0.5131301879882812
local_output_nid generation:  0.04140019416809082
local_in_edges_tensor generation:  0.08071494102478027
mini_batch_src_global generation:  0.05759453773498535
r_  generation:  0.5150611400604248
local_output_nid generation:  0.040949106216430664
local_in_edges_tensor generation:  0.03936624526977539
mini_batch_src_global generation:  0.05846357345581055
r_  generation:  0.5132646560668945
local_output_nid generation:  0.04048728942871094
local_in_edges_tensor generation:  0.04487109184265137
mini_batch_src_global generation:  0.05718398094177246
r_  generation:  0.5194013118743896
----------------------check_connections_block total spend ----------------------------- 6.234449148178101
generate_one_block  0.632051944732666
generate_one_block  0.6362102031707764
generate_one_block  0.6366438865661621
generate_one_block  0.6441524028778076
generate_one_block  0.637519359588623
generate_one_block  0.6344075202941895
generate_one_block  0.6283767223358154
generate_one_block  0.6426002979278564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.21765708923339844  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

connection checking time:  23.02811312675476
block generation total time  19.3700430393219
average batch blocks generation time:  2.4212553799152374
block dataloader generation time/epoch 45.04615592956543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.1352062225341797  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166910, 128])
torch.Size([165782, 256])
torch.Size([161457, 256])
torch.Size([142184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.2836976051330566  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13453102111816406  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166849, 128])
torch.Size([165579, 256])
torch.Size([161139, 256])
torch.Size([141647, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.2807884216308594  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13520240783691406  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166899, 128])
torch.Size([165645, 256])
torch.Size([161298, 256])
torch.Size([142239, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.286991596221924  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 0.1355290412902832  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166933, 128])
torch.Size([165765, 256])
torch.Size([161400, 256])
torch.Size([142229, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.2864484786987305  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 0.1356344223022461  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166906, 128])
torch.Size([165701, 256])
torch.Size([161304, 256])
torch.Size([142064, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.2851548194885254  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 0.13436603546142578  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166877, 128])
torch.Size([165653, 256])
torch.Size([161210, 256])
torch.Size([141940, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.284505844116211  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 0.13550806045532227  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166859, 128])
torch.Size([165632, 256])
torch.Size([161230, 256])
torch.Size([141950, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.284626007080078  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 0.13565826416015625  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

torch.Size([166874, 128])
torch.Size([165670, 256])
torch.Size([161211, 256])
torch.Size([142019, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.28665828704834  GigaBytes
Max Memory Allocated: 2.4180192947387695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.19351014494895935 |0.03816118836402893 |0.005591899156570435 |8.991360664367676e-05 |0.006760448217391968 |0.004714250564575195 |
----------------------------------------------------------pseudo_mini_loss sum 3.546682834625244
Total (block generation + training)time/epoch 47.20112156867981
Training time/epoch 2.1547434329986572
Training time without block to device /epoch 1.8494539260864258
Training time without total dataloading part /epoch 0.10425233840942383
load block tensor time/epoch 1.5480811595916748
block to device time/epoch 0.30528950691223145
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5629414
Number of first layer input nodes during this epoch:  1335107
