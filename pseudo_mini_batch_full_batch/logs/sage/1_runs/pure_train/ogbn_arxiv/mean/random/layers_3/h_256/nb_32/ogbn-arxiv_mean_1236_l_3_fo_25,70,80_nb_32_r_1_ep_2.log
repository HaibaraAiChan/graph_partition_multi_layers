Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648444553.0269356
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026973485946655273
random selection method range initialization spend 0.006548643112182617
time for parepare:  0.018665313720703125
local_output_nid generation:  0.00107574462890625
local_in_edges_tensor generation:  0.004022359848022461
mini_batch_src_global generation:  0.0016133785247802734
r_  generation:  0.01049351692199707
local_output_nid generation:  0.0012717247009277344
local_in_edges_tensor generation:  0.0010139942169189453
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.009555339813232422
local_output_nid generation:  0.0013387203216552734
local_in_edges_tensor generation:  0.0009477138519287109
mini_batch_src_global generation:  0.0011136531829833984
r_  generation:  0.009729385375976562
local_output_nid generation:  0.0013613700866699219
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.000926971435546875
r_  generation:  0.009058952331542969
local_output_nid generation:  0.0014107227325439453
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.009773731231689453
local_output_nid generation:  0.0014107227325439453
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.009627819061279297
local_output_nid generation:  0.0014142990112304688
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0009658336639404297
r_  generation:  0.00942373275756836
local_output_nid generation:  0.0014350414276123047
local_in_edges_tensor generation:  0.0008137226104736328
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.009569644927978516
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.0007944107055664062
mini_batch_src_global generation:  0.0009429454803466797
r_  generation:  0.009073019027709961
local_output_nid generation:  0.0014116764068603516
local_in_edges_tensor generation:  0.0008037090301513672
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.009241819381713867
local_output_nid generation:  0.0014176368713378906
local_in_edges_tensor generation:  0.0008065700531005859
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.009688138961791992
local_output_nid generation:  0.001413106918334961
local_in_edges_tensor generation:  0.0008311271667480469
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010062217712402344
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0007941722869873047
mini_batch_src_global generation:  0.0009729862213134766
r_  generation:  0.009391546249389648
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0008270740509033203
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.009721517562866211
local_output_nid generation:  0.0014655590057373047
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009652137756347656
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0009682178497314453
r_  generation:  0.00933218002319336
local_output_nid generation:  0.0014400482177734375
local_in_edges_tensor generation:  0.0007991790771484375
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009832382202148438
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0010395050048828125
r_  generation:  0.009971857070922852
local_output_nid generation:  0.0014390945434570312
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.009752988815307617
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.0008182525634765625
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.009519338607788086
local_output_nid generation:  0.0014541149139404297
local_in_edges_tensor generation:  0.0008013248443603516
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009805917739868164
local_output_nid generation:  0.0014500617980957031
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0009710788726806641
r_  generation:  0.009563922882080078
local_output_nid generation:  0.0014383792877197266
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0009591579437255859
r_  generation:  0.009433269500732422
local_output_nid generation:  0.0014998912811279297
local_in_edges_tensor generation:  0.0008087158203125
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.010339975357055664
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0008027553558349609
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.00981903076171875
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.009718894958496094
local_output_nid generation:  0.0014348030090332031
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.009639978408813477
local_output_nid generation:  0.0014328956604003906
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0010273456573486328
r_  generation:  0.010051250457763672
local_output_nid generation:  0.0014421939849853516
local_in_edges_tensor generation:  0.0008292198181152344
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.009949445724487305
local_output_nid generation:  0.0014536380767822266
local_in_edges_tensor generation:  0.005485057830810547
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.009826183319091797
local_output_nid generation:  0.0013561248779296875
local_in_edges_tensor generation:  0.0008299350738525391
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.010101556777954102
local_output_nid generation:  0.0013773441314697266
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.009405374526977539
----------------------check_connections_block total spend ----------------------------- 0.5307245254516602
generate_one_block  0.015827655792236328
generate_one_block  0.015141010284423828
generate_one_block  0.01566934585571289
generate_one_block  0.014174938201904297
generate_one_block  0.01585984230041504
generate_one_block  0.015107393264770508
generate_one_block  0.014598608016967773
generate_one_block  0.015229225158691406
generate_one_block  0.014313459396362305
generate_one_block  0.014513969421386719
generate_one_block  0.014927148818969727
generate_one_block  0.015252828598022461
generate_one_block  0.014203310012817383
generate_one_block  0.014946460723876953
generate_one_block  0.01472020149230957
generate_one_block  0.014096260070800781
generate_one_block  0.014707326889038086
generate_one_block  0.015545129776000977
generate_one_block  0.014941692352294922
generate_one_block  0.014371871948242188
generate_one_block  0.014653921127319336
generate_one_block  0.01436924934387207
generate_one_block  0.014316558837890625
generate_one_block  0.015861988067626953
generate_one_block  0.014719247817993164
generate_one_block  0.014675140380859375
generate_one_block  0.014601469039916992
generate_one_block  0.015199661254882812
generate_one_block  0.015011072158813477
generate_one_block  0.014526128768920898
generate_one_block  0.015523672103881836
generate_one_block  0.014229059219360352
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04674172401428223
gen group dst list time:  0.023397445678710938
time for parepare:  0.019764184951782227
local_output_nid generation:  0.005304813385009766
local_in_edges_tensor generation:  0.015543699264526367
mini_batch_src_global generation:  0.01623845100402832
r_  generation:  0.16040492057800293
local_output_nid generation:  0.010200738906860352
local_in_edges_tensor generation:  0.016164302825927734
mini_batch_src_global generation:  0.02070331573486328
r_  generation:  0.16448283195495605
local_output_nid generation:  0.010540008544921875
local_in_edges_tensor generation:  0.01362156867980957
mini_batch_src_global generation:  0.019533872604370117
r_  generation:  0.17429780960083008
local_output_nid generation:  0.009896993637084961
local_in_edges_tensor generation:  0.011051654815673828
mini_batch_src_global generation:  0.019582509994506836
r_  generation:  0.16240930557250977
local_output_nid generation:  0.010553121566772461
local_in_edges_tensor generation:  0.013787984848022461
mini_batch_src_global generation:  0.021447420120239258
r_  generation:  0.1824185848236084
local_output_nid generation:  0.010312080383300781
local_in_edges_tensor generation:  0.011863946914672852
mini_batch_src_global generation:  0.021687030792236328
r_  generation:  0.1742100715637207
local_output_nid generation:  0.010349512100219727
local_in_edges_tensor generation:  0.01018214225769043
mini_batch_src_global generation:  0.0211331844329834
r_  generation:  0.17352509498596191
local_output_nid generation:  0.010380744934082031
local_in_edges_tensor generation:  0.012705564498901367
mini_batch_src_global generation:  0.021929264068603516
r_  generation:  0.17686128616333008
local_output_nid generation:  0.010126590728759766
local_in_edges_tensor generation:  0.012767314910888672
mini_batch_src_global generation:  0.021566152572631836
r_  generation:  0.16846489906311035
local_output_nid generation:  0.010097980499267578
local_in_edges_tensor generation:  0.011194467544555664
mini_batch_src_global generation:  0.02100396156311035
r_  generation:  0.17065715789794922
local_output_nid generation:  0.010313987731933594
local_in_edges_tensor generation:  0.013454198837280273
mini_batch_src_global generation:  0.0238339900970459
r_  generation:  0.1773993968963623
local_output_nid generation:  0.010483264923095703
local_in_edges_tensor generation:  0.014522075653076172
mini_batch_src_global generation:  0.022693395614624023
r_  generation:  0.1775965690612793
local_output_nid generation:  0.010044574737548828
local_in_edges_tensor generation:  0.009680986404418945
mini_batch_src_global generation:  0.021217823028564453
r_  generation:  0.16852068901062012
local_output_nid generation:  0.010412931442260742
local_in_edges_tensor generation:  0.010242700576782227
mini_batch_src_global generation:  0.02359771728515625
r_  generation:  0.17657136917114258
local_output_nid generation:  0.010272502899169922
local_in_edges_tensor generation:  0.014460325241088867
mini_batch_src_global generation:  0.022135019302368164
r_  generation:  0.17866015434265137
local_output_nid generation:  0.00989532470703125
local_in_edges_tensor generation:  0.010068893432617188
mini_batch_src_global generation:  0.02156543731689453
r_  generation:  0.1680748462677002
local_output_nid generation:  0.010199785232543945
local_in_edges_tensor generation:  0.010123014450073242
mini_batch_src_global generation:  0.022002696990966797
r_  generation:  0.18006229400634766
local_output_nid generation:  0.010357856750488281
local_in_edges_tensor generation:  0.012953996658325195
mini_batch_src_global generation:  0.022774219512939453
r_  generation:  0.17739224433898926
local_output_nid generation:  0.010566473007202148
local_in_edges_tensor generation:  0.014727115631103516
mini_batch_src_global generation:  0.02255392074584961
r_  generation:  0.17974543571472168
local_output_nid generation:  0.01010751724243164
local_in_edges_tensor generation:  0.009847879409790039
mini_batch_src_global generation:  0.022078752517700195
r_  generation:  0.1733689308166504
local_output_nid generation:  0.010198593139648438
local_in_edges_tensor generation:  0.009952306747436523
mini_batch_src_global generation:  0.02225947380065918
r_  generation:  0.17649102210998535
local_output_nid generation:  0.010320186614990234
local_in_edges_tensor generation:  0.01021265983581543
mini_batch_src_global generation:  0.022196292877197266
r_  generation:  0.17352581024169922
local_output_nid generation:  0.010165929794311523
local_in_edges_tensor generation:  0.011432647705078125
mini_batch_src_global generation:  0.02477407455444336
r_  generation:  0.1719677448272705
local_output_nid generation:  0.01080632209777832
local_in_edges_tensor generation:  0.015132904052734375
mini_batch_src_global generation:  0.02449941635131836
r_  generation:  0.18518400192260742
local_output_nid generation:  0.010183095932006836
local_in_edges_tensor generation:  0.010408163070678711
mini_batch_src_global generation:  0.022683382034301758
r_  generation:  0.17665529251098633
local_output_nid generation:  0.010402679443359375
local_in_edges_tensor generation:  0.009890317916870117
mini_batch_src_global generation:  0.02240157127380371
r_  generation:  0.17713570594787598
local_output_nid generation:  0.010241985321044922
local_in_edges_tensor generation:  0.00984644889831543
mini_batch_src_global generation:  0.021791458129882812
r_  generation:  0.17297625541687012
local_output_nid generation:  0.010452747344970703
local_in_edges_tensor generation:  0.010108470916748047
mini_batch_src_global generation:  0.02261042594909668
r_  generation:  0.18195700645446777
local_output_nid generation:  0.010345220565795898
local_in_edges_tensor generation:  0.011635303497314453
mini_batch_src_global generation:  0.02266693115234375
r_  generation:  0.17978644371032715
local_output_nid generation:  0.010231971740722656
local_in_edges_tensor generation:  0.01309823989868164
mini_batch_src_global generation:  0.022420406341552734
r_  generation:  0.18000173568725586
local_output_nid generation:  0.010344505310058594
local_in_edges_tensor generation:  0.010032892227172852
mini_batch_src_global generation:  0.022174596786499023
r_  generation:  0.1819629669189453
local_output_nid generation:  0.010030746459960938
local_in_edges_tensor generation:  0.010443449020385742
mini_batch_src_global generation:  0.021715879440307617
r_  generation:  0.17164182662963867
----------------------check_connections_block total spend ----------------------------- 8.280046701431274
generate_one_block  0.23138952255249023
generate_one_block  0.23008465766906738
generate_one_block  0.25966310501098633
generate_one_block  0.21617770195007324
generate_one_block  0.24133062362670898
generate_one_block  0.2297048568725586
generate_one_block  0.21889066696166992
generate_one_block  0.22928380966186523
generate_one_block  0.21781587600708008
generate_one_block  0.2201521396636963
generate_one_block  0.2383716106414795
generate_one_block  0.23598122596740723
generate_one_block  0.2148730754852295
generate_one_block  0.22739362716674805
generate_one_block  0.2253873348236084
generate_one_block  0.23666810989379883
generate_one_block  0.2342836856842041
generate_one_block  0.2307734489440918
generate_one_block  0.2357006072998047
generate_one_block  0.22082757949829102
generate_one_block  0.22202420234680176
generate_one_block  0.21959137916564941
generate_one_block  0.2183704376220703
generate_one_block  0.24683308601379395
generate_one_block  0.22771358489990234
generate_one_block  0.22886967658996582
generate_one_block  0.21803593635559082
generate_one_block  0.23750758171081543
generate_one_block  0.23149609565734863
generate_one_block  0.22690868377685547
generate_one_block  0.2345414161682129
generate_one_block  0.21941447257995605
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03674173355102539
gen group dst list time:  0.10043978691101074
time for parepare:  0.019255638122558594
local_output_nid generation:  0.02266097068786621
local_in_edges_tensor generation:  0.03765296936035156
mini_batch_src_global generation:  0.04122138023376465
r_  generation:  0.4094734191894531
local_output_nid generation:  0.029636859893798828
local_in_edges_tensor generation:  0.045172691345214844
mini_batch_src_global generation:  0.04857778549194336
r_  generation:  0.41249632835388184
local_output_nid generation:  0.029396772384643555
local_in_edges_tensor generation:  0.03764963150024414
mini_batch_src_global generation:  0.04765748977661133
r_  generation:  0.42682743072509766
local_output_nid generation:  0.027517080307006836
local_in_edges_tensor generation:  0.03322315216064453
mini_batch_src_global generation:  0.04791617393493652
r_  generation:  0.41832828521728516
local_output_nid generation:  0.027953147888183594
local_in_edges_tensor generation:  0.038184165954589844
mini_batch_src_global generation:  0.04882550239562988
r_  generation:  0.42795896530151367
local_output_nid generation:  0.028101205825805664
local_in_edges_tensor generation:  0.03840184211730957
mini_batch_src_global generation:  0.049739837646484375
r_  generation:  0.42496299743652344
local_output_nid generation:  0.028128862380981445
local_in_edges_tensor generation:  0.030069828033447266
mini_batch_src_global generation:  0.05188322067260742
r_  generation:  0.4272913932800293
local_output_nid generation:  0.027922868728637695
local_in_edges_tensor generation:  0.0333104133605957
mini_batch_src_global generation:  0.04975008964538574
r_  generation:  0.4271841049194336
local_output_nid generation:  0.028162479400634766
local_in_edges_tensor generation:  0.03102278709411621
mini_batch_src_global generation:  0.04903864860534668
r_  generation:  0.43917393684387207
local_output_nid generation:  0.027596473693847656
local_in_edges_tensor generation:  0.03030991554260254
mini_batch_src_global generation:  0.04897260665893555
r_  generation:  0.42659664154052734
local_output_nid generation:  0.028157472610473633
local_in_edges_tensor generation:  0.03804945945739746
mini_batch_src_global generation:  0.05013108253479004
r_  generation:  0.43154048919677734
local_output_nid generation:  0.02818608283996582
local_in_edges_tensor generation:  0.04187130928039551
mini_batch_src_global generation:  0.05299568176269531
r_  generation:  0.43605780601501465
local_output_nid generation:  0.027652978897094727
local_in_edges_tensor generation:  0.03163576126098633
mini_batch_src_global generation:  0.04941296577453613
r_  generation:  0.4314150810241699
local_output_nid generation:  0.02800154685974121
local_in_edges_tensor generation:  0.046654701232910156
mini_batch_src_global generation:  0.05164933204650879
r_  generation:  0.4337577819824219
local_output_nid generation:  0.027587175369262695
local_in_edges_tensor generation:  0.02798008918762207
mini_batch_src_global generation:  0.049730777740478516
r_  generation:  0.4309844970703125
local_output_nid generation:  0.02736186981201172
local_in_edges_tensor generation:  0.030517101287841797
mini_batch_src_global generation:  0.04946303367614746
r_  generation:  0.4307117462158203
local_output_nid generation:  0.027962207794189453
local_in_edges_tensor generation:  0.03485107421875
mini_batch_src_global generation:  0.05305838584899902
r_  generation:  0.4388308525085449
local_output_nid generation:  0.027936458587646484
local_in_edges_tensor generation:  0.03129291534423828
mini_batch_src_global generation:  0.0495145320892334
r_  generation:  0.4328138828277588
local_output_nid generation:  0.028720617294311523
local_in_edges_tensor generation:  0.034043073654174805
mini_batch_src_global generation:  0.05331015586853027
r_  generation:  0.4456465244293213
local_output_nid generation:  0.02876758575439453
local_in_edges_tensor generation:  0.027477264404296875
mini_batch_src_global generation:  0.049921512603759766
r_  generation:  0.43155908584594727
local_output_nid generation:  0.02781224250793457
local_in_edges_tensor generation:  0.026678800582885742
mini_batch_src_global generation:  0.04989504814147949
r_  generation:  0.4352400302886963
local_output_nid generation:  0.0280611515045166
local_in_edges_tensor generation:  0.03478717803955078
mini_batch_src_global generation:  0.050447702407836914
r_  generation:  0.4464404582977295
local_output_nid generation:  0.028166532516479492
local_in_edges_tensor generation:  0.03181958198547363
mini_batch_src_global generation:  0.052460670471191406
r_  generation:  0.42760419845581055
local_output_nid generation:  0.02830791473388672
local_in_edges_tensor generation:  0.027185916900634766
mini_batch_src_global generation:  0.05336356163024902
r_  generation:  0.43552589416503906
local_output_nid generation:  0.028304338455200195
local_in_edges_tensor generation:  0.030417203903198242
mini_batch_src_global generation:  0.05035519599914551
r_  generation:  0.44552159309387207
local_output_nid generation:  0.029254674911499023
local_in_edges_tensor generation:  0.041454315185546875
mini_batch_src_global generation:  0.0518651008605957
r_  generation:  0.43076205253601074
local_output_nid generation:  0.02853107452392578
local_in_edges_tensor generation:  0.030684709548950195
mini_batch_src_global generation:  0.049527883529663086
r_  generation:  0.4299001693725586
local_output_nid generation:  0.02895188331604004
local_in_edges_tensor generation:  0.031748294830322266
mini_batch_src_global generation:  0.05038285255432129
r_  generation:  0.4350428581237793
local_output_nid generation:  0.03041672706604004
local_in_edges_tensor generation:  0.034348249435424805
mini_batch_src_global generation:  0.05322098731994629
r_  generation:  0.4306156635284424
local_output_nid generation:  0.028472900390625
local_in_edges_tensor generation:  0.03002190589904785
mini_batch_src_global generation:  0.0502321720123291
r_  generation:  0.42927980422973633
local_output_nid generation:  0.028573989868164062
local_in_edges_tensor generation:  0.03427553176879883
mini_batch_src_global generation:  0.052739858627319336
r_  generation:  0.4333152770996094
local_output_nid generation:  0.028781890869140625
local_in_edges_tensor generation:  0.026823759078979492
mini_batch_src_global generation:  0.053275346755981445
r_  generation:  0.4304673671722412
----------------------check_connections_block total spend ----------------------------- 20.469824075698853
generate_one_block  0.6566777229309082
generate_one_block  0.5540885925292969
generate_one_block  0.5690767765045166
generate_one_block  0.5626463890075684
generate_one_block  0.5630996227264404
generate_one_block  0.5581755638122559
generate_one_block  0.5548014640808105
generate_one_block  0.5555775165557861
generate_one_block  0.550250768661499
generate_one_block  0.5492818355560303
generate_one_block  0.5531888008117676
generate_one_block  0.5642988681793213
generate_one_block  0.542442798614502
generate_one_block  0.5643627643585205
generate_one_block  0.5442149639129639
generate_one_block  0.5452346801757812
generate_one_block  0.5555770397186279
generate_one_block  0.5527262687683105
generate_one_block  0.5878283977508545
generate_one_block  0.5445601940155029
generate_one_block  0.5580010414123535
generate_one_block  0.5613269805908203
generate_one_block  0.544827938079834
generate_one_block  0.5716488361358643
generate_one_block  0.5802221298217773
generate_one_block  0.5535969734191895
generate_one_block  0.5407407283782959
generate_one_block  0.5563442707061768
generate_one_block  0.5560634136199951
generate_one_block  0.5499866008758545
generate_one_block  0.5626645088195801
generate_one_block  0.5603952407836914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  28.749870777130127
block generation total time  25.24998950958252
average batch blocks generation time:  0.7890621721744537
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08604955673217773  GigaBytes
Max Memory Allocated: 0.08604955673217773  GigaBytes

torch.Size([148492, 128])
torch.Size([109725, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.6056122779846191  GigaBytes
Max Memory Allocated: 0.6299338340759277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.08707332611083984  GigaBytes
Max Memory Allocated: 0.7133960723876953  GigaBytes

torch.Size([148198, 128])
torch.Size([109339, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.6003389358520508  GigaBytes
Max Memory Allocated: 0.7133960723876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3240966796875 GB
    Memory Allocated: 0.08768320083618164  GigaBytes
Max Memory Allocated: 0.7133960723876953  GigaBytes

torch.Size([148995, 128])
torch.Size([110948, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 0.6131296157836914  GigaBytes
Max Memory Allocated: 0.7133960723876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.0870518684387207  GigaBytes
Max Memory Allocated: 0.7171854972839355  GigaBytes

torch.Size([148641, 128])
torch.Size([108965, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5961694717407227  GigaBytes
Max Memory Allocated: 0.7171854972839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08786916732788086  GigaBytes
Max Memory Allocated: 0.7171854972839355  GigaBytes

torch.Size([149107, 128])
torch.Size([111318, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6142349243164062  GigaBytes
Max Memory Allocated: 0.7171854972839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08755159378051758  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149113, 128])
torch.Size([110398, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6069278717041016  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08751583099365234  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149312, 128])
torch.Size([110447, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.604794979095459  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08746862411499023  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149001, 128])
torch.Size([109871, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6055688858032227  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08715581893920898  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148765, 128])
torch.Size([109558, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5990691184997559  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08676576614379883  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148169, 128])
torch.Size([108233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5927920341491699  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08749532699584961  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148893, 128])
torch.Size([109418, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6023902893066406  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08780527114868164  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149389, 128])
torch.Size([111041, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6102638244628906  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08685970306396484  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148382, 128])
torch.Size([108836, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5954704284667969  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08780670166015625  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149554, 128])
torch.Size([110777, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6081337928771973  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08715677261352539  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148639, 128])
torch.Size([109473, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6007137298583984  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08695411682128906  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148684, 128])
torch.Size([108793, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5952672958374023  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08700990676879883  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148033, 128])
torch.Size([109135, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5992846488952637  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08702468872070312  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148166, 128])
torch.Size([109077, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.601104736328125  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08781957626342773  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149499, 128])
torch.Size([111151, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6106719970703125  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08673715591430664  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([147863, 128])
torch.Size([108769, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5971016883850098  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08728170394897461  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148875, 128])
torch.Size([109348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5999212265014648  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08728694915771484  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([148922, 128])
torch.Size([109873, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.603358268737793  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08721113204956055  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149049, 128])
torch.Size([109348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5992159843444824  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08791828155517578  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

torch.Size([149372, 128])
torch.Size([111865, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6188755035400391  GigaBytes
Max Memory Allocated: 0.7193808555603027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08741474151611328  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148956, 128])
torch.Size([110048, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6049513816833496  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08748435974121094  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149068, 128])
torch.Size([109982, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.604590892791748  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08707332611083984  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148682, 128])
torch.Size([108843, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.597966194152832  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08759021759033203  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148944, 128])
torch.Size([110551, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6083993911743164  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08724832534790039  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148505, 128])
torch.Size([109762, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6057009696960449  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08727407455444336  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148681, 128])
torch.Size([109427, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.5999813079833984  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.0872197151184082  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148339, 128])
torch.Size([109738, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6060380935668945  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.08725214004516602  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149047, 128])
torch.Size([109701, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8651123046875 GB
    Memory Allocated: 0.6014118194580078  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050214529037475586 |0.02488846331834793 |0.027013570070266724 |9.432435035705566e-05 |0.006230399012565613 |0.0022420883178710938 |
----------------------------------------------------------pseudo_mini_loss sum 6.314319610595703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9114717
Number of first layer input nodes during this epoch:  4761335
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022335052490234375
random selection method range initialization spend 0.005396604537963867
time for parepare:  0.017977476119995117
local_output_nid generation:  0.0012273788452148438
local_in_edges_tensor generation:  0.00628352165222168
mini_batch_src_global generation:  0.0017549991607666016
r_  generation:  0.01015162467956543
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.001607656478881836
r_  generation:  0.010357856750488281
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.009870290756225586
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.009876012802124023
local_output_nid generation:  0.0014963150024414062
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.009946823120117188
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008168220520019531
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.009803533554077148
local_output_nid generation:  0.0014812946319580078
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.009978294372558594
local_output_nid generation:  0.0015118122100830078
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.001026153564453125
r_  generation:  0.009998083114624023
local_output_nid generation:  0.0014886856079101562
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.009613752365112305
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0008180141448974609
mini_batch_src_global generation:  0.001180410385131836
r_  generation:  0.010438919067382812
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.0007843971252441406
mini_batch_src_global generation:  0.0010781288146972656
r_  generation:  0.009804010391235352
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0007724761962890625
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.010129690170288086
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.0007853507995605469
mini_batch_src_global generation:  0.001069784164428711
r_  generation:  0.010422945022583008
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0025446414947509766
r_  generation:  0.009891033172607422
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.00978231430053711
local_output_nid generation:  0.0014815330505371094
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0010046958923339844
r_  generation:  0.009741783142089844
local_output_nid generation:  0.0014722347259521484
local_in_edges_tensor generation:  0.0007498264312744141
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.01019597053527832
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.0010335445404052734
r_  generation:  0.010331392288208008
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007703304290771484
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.010040044784545898
local_output_nid generation:  0.001483917236328125
local_in_edges_tensor generation:  0.0007750988006591797
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.010091781616210938
local_output_nid generation:  0.0014786720275878906
local_in_edges_tensor generation:  0.0007748603820800781
mini_batch_src_global generation:  0.0011279582977294922
r_  generation:  0.010119915008544922
local_output_nid generation:  0.0014858245849609375
local_in_edges_tensor generation:  0.0007598400115966797
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.010003089904785156
local_output_nid generation:  0.0015194416046142578
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0010328292846679688
r_  generation:  0.009983539581298828
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.010172605514526367
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0010640621185302734
r_  generation:  0.010292768478393555
local_output_nid generation:  0.0015175342559814453
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0010819435119628906
r_  generation:  0.010313034057617188
local_output_nid generation:  0.003013134002685547
local_in_edges_tensor generation:  0.0007851123809814453
mini_batch_src_global generation:  0.0011324882507324219
r_  generation:  0.010525226593017578
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.010243654251098633
local_output_nid generation:  0.0014815330505371094
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.009661436080932617
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.0010552406311035156
r_  generation:  0.01027536392211914
local_output_nid generation:  0.0015211105346679688
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.010022163391113281
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.0007612705230712891
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.010264158248901367
----------------------check_connections_block total spend ----------------------------- 0.5469863414764404
generate_one_block  0.029659509658813477
generate_one_block  0.018174409866333008
generate_one_block  0.015433549880981445
generate_one_block  0.015093326568603516
generate_one_block  0.015240669250488281
generate_one_block  0.01604771614074707
generate_one_block  0.015207052230834961
generate_one_block  0.014742136001586914
generate_one_block  0.014440059661865234
generate_one_block  0.015320062637329102
generate_one_block  0.014625310897827148
generate_one_block  0.015094280242919922
generate_one_block  0.015490055084228516
generate_one_block  0.014283180236816406
generate_one_block  0.014327287673950195
generate_one_block  0.014241218566894531
generate_one_block  0.015017986297607422
generate_one_block  0.01492929458618164
generate_one_block  0.01484060287475586
generate_one_block  0.01731729507446289
generate_one_block  0.014814615249633789
generate_one_block  0.01441192626953125
generate_one_block  0.014800310134887695
generate_one_block  0.01484990119934082
generate_one_block  0.015036344528198242
generate_one_block  0.01465153694152832
generate_one_block  0.01534581184387207
generate_one_block  0.014885187149047852
generate_one_block  0.014377117156982422
generate_one_block  0.015256404876708984
generate_one_block  0.014701128005981445
generate_one_block  0.01494455337524414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04506826400756836
gen group dst list time:  0.02158045768737793
time for parepare:  0.01911640167236328
local_output_nid generation:  0.005483388900756836
local_in_edges_tensor generation:  0.016726255416870117
mini_batch_src_global generation:  0.016314268112182617
r_  generation:  0.16203761100769043
local_output_nid generation:  0.008675575256347656
local_in_edges_tensor generation:  0.014899730682373047
mini_batch_src_global generation:  0.02274155616760254
r_  generation:  0.17115187644958496
local_output_nid generation:  0.008873462677001953
local_in_edges_tensor generation:  0.03151440620422363
mini_batch_src_global generation:  0.022359132766723633
r_  generation:  0.17822265625
local_output_nid generation:  0.008623361587524414
local_in_edges_tensor generation:  0.01204371452331543
mini_batch_src_global generation:  0.020616769790649414
r_  generation:  0.17534756660461426
local_output_nid generation:  0.008634090423583984
local_in_edges_tensor generation:  0.012071847915649414
mini_batch_src_global generation:  0.02188897132873535
r_  generation:  0.18390274047851562
local_output_nid generation:  0.00827169418334961
local_in_edges_tensor generation:  0.009046316146850586
mini_batch_src_global generation:  0.0223388671875
r_  generation:  0.17811274528503418
local_output_nid generation:  0.00837087631225586
local_in_edges_tensor generation:  0.0104522705078125
mini_batch_src_global generation:  0.02254796028137207
r_  generation:  0.18909072875976562
local_output_nid generation:  0.009169578552246094
local_in_edges_tensor generation:  0.016111373901367188
mini_batch_src_global generation:  0.02337336540222168
r_  generation:  0.19255566596984863
local_output_nid generation:  0.010408163070678711
local_in_edges_tensor generation:  0.011171817779541016
mini_batch_src_global generation:  0.02409982681274414
r_  generation:  0.17985272407531738
local_output_nid generation:  0.008682012557983398
local_in_edges_tensor generation:  0.014006376266479492
mini_batch_src_global generation:  0.0256807804107666
r_  generation:  0.1836557388305664
local_output_nid generation:  0.008628129959106445
local_in_edges_tensor generation:  0.009624004364013672
mini_batch_src_global generation:  0.02269268035888672
r_  generation:  0.1796412467956543
local_output_nid generation:  0.008761167526245117
local_in_edges_tensor generation:  0.00886845588684082
mini_batch_src_global generation:  0.022722721099853516
r_  generation:  0.17496848106384277
local_output_nid generation:  0.00907278060913086
local_in_edges_tensor generation:  0.013644695281982422
mini_batch_src_global generation:  0.023784875869750977
r_  generation:  0.18678808212280273
local_output_nid generation:  0.00859379768371582
local_in_edges_tensor generation:  0.00849771499633789
mini_batch_src_global generation:  0.022057533264160156
r_  generation:  0.17583084106445312
local_output_nid generation:  0.008647441864013672
local_in_edges_tensor generation:  0.008577823638916016
mini_batch_src_global generation:  0.021752357482910156
r_  generation:  0.17433857917785645
local_output_nid generation:  0.008551836013793945
local_in_edges_tensor generation:  0.01002812385559082
mini_batch_src_global generation:  0.022023916244506836
r_  generation:  0.17263555526733398
local_output_nid generation:  0.008798360824584961
local_in_edges_tensor generation:  0.013231277465820312
mini_batch_src_global generation:  0.0458986759185791
r_  generation:  0.18412423133850098
local_output_nid generation:  0.008824825286865234
local_in_edges_tensor generation:  0.010399818420410156
mini_batch_src_global generation:  0.022782325744628906
r_  generation:  0.17925572395324707
local_output_nid generation:  0.00866842269897461
local_in_edges_tensor generation:  0.010092020034790039
mini_batch_src_global generation:  0.02277350425720215
r_  generation:  0.17728543281555176
local_output_nid generation:  0.008359193801879883
local_in_edges_tensor generation:  0.010279417037963867
mini_batch_src_global generation:  0.03566789627075195
r_  generation:  0.18062901496887207
local_output_nid generation:  0.009546995162963867
local_in_edges_tensor generation:  0.018100261688232422
mini_batch_src_global generation:  0.024220943450927734
r_  generation:  0.18237948417663574
local_output_nid generation:  0.008243083953857422
local_in_edges_tensor generation:  0.008965730667114258
mini_batch_src_global generation:  0.032207489013671875
r_  generation:  0.186570405960083
local_output_nid generation:  0.00828695297241211
local_in_edges_tensor generation:  0.012102127075195312
mini_batch_src_global generation:  0.025399446487426758
r_  generation:  0.1844496726989746
local_output_nid generation:  0.01049661636352539
local_in_edges_tensor generation:  0.011796712875366211
mini_batch_src_global generation:  0.026767492294311523
r_  generation:  0.17991256713867188
local_output_nid generation:  0.008551359176635742
local_in_edges_tensor generation:  0.010402202606201172
mini_batch_src_global generation:  0.025026798248291016
r_  generation:  0.18312764167785645
local_output_nid generation:  0.00818634033203125
local_in_edges_tensor generation:  0.01038503646850586
mini_batch_src_global generation:  0.02504444122314453
r_  generation:  0.18005847930908203
local_output_nid generation:  0.008575916290283203
local_in_edges_tensor generation:  0.012374162673950195
mini_batch_src_global generation:  0.02744603157043457
r_  generation:  0.19249868392944336
local_output_nid generation:  0.008339643478393555
local_in_edges_tensor generation:  0.008823394775390625
mini_batch_src_global generation:  0.023982524871826172
r_  generation:  0.18084716796875
local_output_nid generation:  0.00808572769165039
local_in_edges_tensor generation:  0.009587287902832031
mini_batch_src_global generation:  0.03594970703125
r_  generation:  0.18108844757080078
local_output_nid generation:  0.008321285247802734
local_in_edges_tensor generation:  0.008831501007080078
mini_batch_src_global generation:  0.023258686065673828
r_  generation:  0.18074703216552734
local_output_nid generation:  0.008206844329833984
local_in_edges_tensor generation:  0.008780717849731445
mini_batch_src_global generation:  0.022566556930541992
r_  generation:  0.18123626708984375
local_output_nid generation:  0.008218050003051758
local_in_edges_tensor generation:  0.008733034133911133
mini_batch_src_global generation:  0.022350072860717773
r_  generation:  0.17647528648376465
----------------------check_connections_block total spend ----------------------------- 8.540611267089844
generate_one_block  0.23041033744812012
generate_one_block  0.2317805290222168
generate_one_block  0.23311710357666016
generate_one_block  0.22518157958984375
generate_one_block  0.24936294555664062
generate_one_block  0.22022747993469238
generate_one_block  0.23743367195129395
generate_one_block  0.22506022453308105
generate_one_block  0.23009538650512695
generate_one_block  0.23502397537231445
generate_one_block  0.22799134254455566
generate_one_block  0.2227792739868164
generate_one_block  0.24120140075683594
generate_one_block  0.22113919258117676
generate_one_block  0.21401095390319824
generate_one_block  0.21376371383666992
generate_one_block  0.23010468482971191
generate_one_block  0.2291097640991211
generate_one_block  0.22237253189086914
generate_one_block  0.25957274436950684
generate_one_block  0.22844386100769043
generate_one_block  0.21545839309692383
generate_one_block  0.2241199016571045
generate_one_block  0.23074030876159668
generate_one_block  0.23116445541381836
generate_one_block  0.23008966445922852
generate_one_block  0.2740347385406494
generate_one_block  0.23012757301330566
generate_one_block  0.21626782417297363
generate_one_block  0.22566008567810059
generate_one_block  0.22179079055786133
generate_one_block  0.22098422050476074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0494844913482666
gen group dst list time:  0.10590243339538574
time for parepare:  0.01736307144165039
local_output_nid generation:  0.023775577545166016
local_in_edges_tensor generation:  0.0604250431060791
mini_batch_src_global generation:  0.039398908615112305
r_  generation:  0.4205925464630127
local_output_nid generation:  0.030182838439941406
local_in_edges_tensor generation:  0.04390287399291992
mini_batch_src_global generation:  0.049562692642211914
r_  generation:  0.424485445022583
local_output_nid generation:  0.02957606315612793
local_in_edges_tensor generation:  0.037238359451293945
mini_batch_src_global generation:  0.05111861228942871
r_  generation:  0.4308054447174072
local_output_nid generation:  0.028639554977416992
local_in_edges_tensor generation:  0.02921319007873535
mini_batch_src_global generation:  0.04924416542053223
r_  generation:  0.42674684524536133
local_output_nid generation:  0.02871227264404297
local_in_edges_tensor generation:  0.02890777587890625
mini_batch_src_global generation:  0.04983997344970703
r_  generation:  0.43411946296691895
local_output_nid generation:  0.029163360595703125
local_in_edges_tensor generation:  0.031040191650390625
mini_batch_src_global generation:  0.05022311210632324
r_  generation:  0.4292917251586914
local_output_nid generation:  0.02847123146057129
local_in_edges_tensor generation:  0.03676462173461914
mini_batch_src_global generation:  0.04969596862792969
r_  generation:  0.4453084468841553
local_output_nid generation:  0.029158353805541992
local_in_edges_tensor generation:  0.039110422134399414
mini_batch_src_global generation:  0.05878043174743652
r_  generation:  0.43099141120910645
local_output_nid generation:  0.02853703498840332
local_in_edges_tensor generation:  0.03543257713317871
mini_batch_src_global generation:  0.050684213638305664
r_  generation:  0.43157243728637695
local_output_nid generation:  0.028716564178466797
local_in_edges_tensor generation:  0.03695082664489746
mini_batch_src_global generation:  0.05008220672607422
r_  generation:  0.43971776962280273
local_output_nid generation:  0.03062605857849121
local_in_edges_tensor generation:  0.0400848388671875
mini_batch_src_global generation:  0.050229549407958984
r_  generation:  0.4319772720336914
local_output_nid generation:  0.029218196868896484
local_in_edges_tensor generation:  0.029538393020629883
mini_batch_src_global generation:  0.050405263900756836
r_  generation:  0.42803072929382324
local_output_nid generation:  0.029259681701660156
local_in_edges_tensor generation:  0.031197547912597656
mini_batch_src_global generation:  0.05276608467102051
r_  generation:  0.441941499710083
local_output_nid generation:  0.029210567474365234
local_in_edges_tensor generation:  0.03232383728027344
mini_batch_src_global generation:  0.05041980743408203
r_  generation:  0.429166316986084
local_output_nid generation:  0.028979063034057617
local_in_edges_tensor generation:  0.03228926658630371
mini_batch_src_global generation:  0.04956364631652832
r_  generation:  0.42758965492248535
local_output_nid generation:  0.0292203426361084
local_in_edges_tensor generation:  0.03256511688232422
mini_batch_src_global generation:  0.049655914306640625
r_  generation:  0.42865610122680664
local_output_nid generation:  0.02962970733642578
local_in_edges_tensor generation:  0.03729677200317383
mini_batch_src_global generation:  0.04952526092529297
r_  generation:  0.4297330379486084
local_output_nid generation:  0.029522418975830078
local_in_edges_tensor generation:  0.03276777267456055
mini_batch_src_global generation:  0.05042743682861328
r_  generation:  0.43451356887817383
local_output_nid generation:  0.029650449752807617
local_in_edges_tensor generation:  0.03265237808227539
mini_batch_src_global generation:  0.05012965202331543
r_  generation:  0.4307115077972412
local_output_nid generation:  0.029119014739990234
local_in_edges_tensor generation:  0.03635430335998535
mini_batch_src_global generation:  0.050051212310791016
r_  generation:  0.4298582077026367
local_output_nid generation:  0.02961111068725586
local_in_edges_tensor generation:  0.032588958740234375
mini_batch_src_global generation:  0.04941272735595703
r_  generation:  0.4340548515319824
local_output_nid generation:  0.029314279556274414
local_in_edges_tensor generation:  0.0323481559753418
mini_batch_src_global generation:  0.050142765045166016
r_  generation:  0.429246187210083
local_output_nid generation:  0.02963709831237793
local_in_edges_tensor generation:  0.032981157302856445
mini_batch_src_global generation:  0.049712419509887695
r_  generation:  0.4319179058074951
local_output_nid generation:  0.029443740844726562
local_in_edges_tensor generation:  0.032364606857299805
mini_batch_src_global generation:  0.05005168914794922
r_  generation:  0.44434452056884766
local_output_nid generation:  0.030020713806152344
local_in_edges_tensor generation:  0.036612510681152344
mini_batch_src_global generation:  0.05263042449951172
r_  generation:  0.4371209144592285
local_output_nid generation:  0.02919626235961914
local_in_edges_tensor generation:  0.036100149154663086
mini_batch_src_global generation:  0.050469160079956055
r_  generation:  0.42917561531066895
local_output_nid generation:  0.029330015182495117
local_in_edges_tensor generation:  0.029160022735595703
mini_batch_src_global generation:  0.053466796875
r_  generation:  0.4390547275543213
local_output_nid generation:  0.02981853485107422
local_in_edges_tensor generation:  0.03692221641540527
mini_batch_src_global generation:  0.050298452377319336
r_  generation:  0.4335660934448242
local_output_nid generation:  0.029008865356445312
local_in_edges_tensor generation:  0.02870035171508789
mini_batch_src_global generation:  0.050592899322509766
r_  generation:  0.4297802448272705
local_output_nid generation:  0.02927374839782715
local_in_edges_tensor generation:  0.03475189208984375
mini_batch_src_global generation:  0.05305027961730957
r_  generation:  0.4311192035675049
local_output_nid generation:  0.03210878372192383
local_in_edges_tensor generation:  0.029566526412963867
mini_batch_src_global generation:  0.05018115043640137
r_  generation:  0.43023085594177246
local_output_nid generation:  0.029386520385742188
local_in_edges_tensor generation:  0.03256869316101074
mini_batch_src_global generation:  0.05077695846557617
r_  generation:  0.4401113986968994
----------------------check_connections_block total spend ----------------------------- 20.56514596939087
generate_one_block  0.5569043159484863
generate_one_block  0.5790820121765137
generate_one_block  0.5583226680755615
generate_one_block  0.5421252250671387
generate_one_block  0.6450130939483643
generate_one_block  0.5534844398498535
generate_one_block  0.5566136837005615
generate_one_block  0.5524148941040039
generate_one_block  0.5576393604278564
generate_one_block  0.552525520324707
generate_one_block  0.5577330589294434
generate_one_block  0.5412790775299072
generate_one_block  0.5510308742523193
generate_one_block  0.5489413738250732
generate_one_block  0.5358715057373047
generate_one_block  0.5532717704772949
generate_one_block  0.5610315799713135
generate_one_block  0.5554327964782715
generate_one_block  0.564293622970581
generate_one_block  0.554487943649292
generate_one_block  0.5550601482391357
generate_one_block  0.5510778427124023
generate_one_block  0.560492992401123
generate_one_block  0.5577571392059326
generate_one_block  0.5889580249786377
generate_one_block  0.5514068603515625
generate_one_block  0.5725445747375488
generate_one_block  0.5696358680725098
generate_one_block  0.5463955402374268
generate_one_block  0.5591001510620117
generate_one_block  0.5442070960998535
generate_one_block  0.5440614223480225
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.10921096801757812  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

connection checking time:  29.105757236480713
block generation total time  25.22681713104248
average batch blocks generation time:  0.7883380353450775
block dataloader generation time/epoch 56.87833118438721
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.0892782211303711  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149395, 128])
torch.Size([110780, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6084270477294922  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08937835693359375  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149332, 128])
torch.Size([110546, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6091227531433105  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08926057815551758  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149043, 128])
torch.Size([111071, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6136531829833984  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08924674987792969  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149398, 128])
torch.Size([110578, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6083836555480957  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08934688568115234  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149190, 128])
torch.Size([110327, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6098613739013672  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08899497985839844  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148986, 128])
torch.Size([109483, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6022458076477051  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.0892171859741211  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149002, 128])
torch.Size([110287, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6092362403869629  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08890914916992188  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148782, 128])
torch.Size([109543, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6035752296447754  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08900594711303711  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148985, 128])
torch.Size([109959, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6048083305358887  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08935165405273438  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149248, 128])
torch.Size([110348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.610076904296875  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08908462524414062  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149130, 128])
torch.Size([110355, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6052842140197754  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08899688720703125  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149102, 128])
torch.Size([109798, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6049346923828125  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08939743041992188  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149278, 128])
torch.Size([110241, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.609795093536377  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08876895904541016  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148844, 128])
torch.Size([109302, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.5997076034545898  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08861541748046875  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148612, 128])
torch.Size([108965, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.5979022979736328  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08858442306518555  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148595, 128])
torch.Size([108773, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.5981478691101074  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08930063247680664  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149389, 128])
torch.Size([110302, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6069579124450684  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08917951583862305  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149277, 128])
torch.Size([110264, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.607600212097168  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08901453018188477  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148949, 128])
torch.Size([110194, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6059951782226562  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08881139755249023  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148539, 128])
torch.Size([109324, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6022648811340332  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08890676498413086  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148739, 128])
torch.Size([109435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.602933406829834  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08861446380615234  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148494, 128])
torch.Size([109127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.5996098518371582  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08925247192382812  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149482, 128])
torch.Size([109772, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.606712818145752  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08880281448364258  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148507, 128])
torch.Size([109323, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6022157669067383  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.09038066864013672  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149640, 128])
torch.Size([111182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6131429672241211  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.0889739990234375  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148930, 128])
torch.Size([109670, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6050386428833008  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08931875228881836  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148803, 128])
torch.Size([110832, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6120409965515137  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08936214447021484  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149352, 128])
torch.Size([110890, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.609520435333252  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08877372741699219  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([148824, 128])
torch.Size([109028, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.5983948707580566  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08921527862548828  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149214, 128])
torch.Size([110095, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6074419021606445  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08893728256225586  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149067, 128])
torch.Size([109334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.602109432220459  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.08896112442016602  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

torch.Size([149135, 128])
torch.Size([109432, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8670654296875 GB
    Memory Allocated: 0.6027593612670898  GigaBytes
Max Memory Allocated: 0.7259221076965332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0488901361823082 |0.015553638339042664 |0.003679312765598297 |9.431689977645874e-05 |0.003428049385547638 |0.0013697147369384766 |
----------------------------------------------------------pseudo_mini_loss sum 3.2346434593200684
Total (block generation + training)time/epoch 59.2418007850647
Training time/epoch 2.363227605819702
Training time without block to device /epoch 1.865511178970337
Training time without total dataloading part /epoch 0.23182344436645508
load block tensor time/epoch 1.5644843578338623
block to device time/epoch 0.49771642684936523
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9128109
Number of first layer input nodes during this epoch:  4769263
