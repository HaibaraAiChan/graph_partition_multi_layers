Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648480614.1253319
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024400711059570312
random selection method range initialization spend 0.006044626235961914
time for parepare:  0.018685102462768555
local_output_nid generation:  0.0022161006927490234
local_in_edges_tensor generation:  0.004645824432373047
mini_batch_src_global generation:  0.0017895698547363281
r_  generation:  0.018149614334106445
local_output_nid generation:  0.0026330947875976562
local_in_edges_tensor generation:  0.001680612564086914
mini_batch_src_global generation:  0.0022034645080566406
r_  generation:  0.017774581909179688
local_output_nid generation:  0.0027921199798583984
local_in_edges_tensor generation:  0.001600027084350586
mini_batch_src_global generation:  0.0014190673828125
r_  generation:  0.017406463623046875
local_output_nid generation:  0.002808094024658203
local_in_edges_tensor generation:  0.0015883445739746094
mini_batch_src_global generation:  0.0013680458068847656
r_  generation:  0.017917156219482422
local_output_nid generation:  0.002886533737182617
local_in_edges_tensor generation:  0.0015785694122314453
mini_batch_src_global generation:  0.0014138221740722656
r_  generation:  0.017783403396606445
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0014910697937011719
mini_batch_src_global generation:  0.0014595985412597656
r_  generation:  0.018754243850708008
local_output_nid generation:  0.002897500991821289
local_in_edges_tensor generation:  0.001569986343383789
mini_batch_src_global generation:  0.0015115737915039062
r_  generation:  0.01846456527709961
local_output_nid generation:  0.002897500991821289
local_in_edges_tensor generation:  0.0015032291412353516
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.018844127655029297
local_output_nid generation:  0.0028662681579589844
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0014793872833251953
r_  generation:  0.018442392349243164
local_output_nid generation:  0.0028662681579589844
local_in_edges_tensor generation:  0.0014503002166748047
mini_batch_src_global generation:  0.0015327930450439453
r_  generation:  0.018674612045288086
local_output_nid generation:  0.0029172897338867188
local_in_edges_tensor generation:  0.0014810562133789062
mini_batch_src_global generation:  0.0016117095947265625
r_  generation:  0.01914834976196289
local_output_nid generation:  0.002879619598388672
local_in_edges_tensor generation:  0.0015478134155273438
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.018844127655029297
local_output_nid generation:  0.0028510093688964844
local_in_edges_tensor generation:  0.0015866756439208984
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.018659591674804688
local_output_nid generation:  0.002866983413696289
local_in_edges_tensor generation:  0.001474618911743164
mini_batch_src_global generation:  0.001554250717163086
r_  generation:  0.01886296272277832
local_output_nid generation:  0.002889394760131836
local_in_edges_tensor generation:  0.0015230178833007812
mini_batch_src_global generation:  0.001598358154296875
r_  generation:  0.019260644912719727
local_output_nid generation:  0.0028541088104248047
local_in_edges_tensor generation:  0.0014834403991699219
mini_batch_src_global generation:  0.001584768295288086
r_  generation:  0.018987655639648438
----------------------check_connections_block total spend ----------------------------- 0.4908413887023926
generate_one_block  0.027172327041625977
generate_one_block  0.028107643127441406
generate_one_block  0.030405044555664062
generate_one_block  0.028071880340576172
generate_one_block  0.027669191360473633
generate_one_block  0.028011560440063477
generate_one_block  0.02752065658569336
generate_one_block  0.027691364288330078
generate_one_block  0.02756500244140625
generate_one_block  0.02727198600769043
generate_one_block  0.027564287185668945
generate_one_block  0.027878284454345703
generate_one_block  0.027400493621826172
generate_one_block  0.027945518493652344
generate_one_block  0.027754783630371094
generate_one_block  0.02740311622619629
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04116535186767578
gen group dst list time:  0.018807411193847656
time for parepare:  0.01914691925048828
local_output_nid generation:  0.008185625076293945
local_in_edges_tensor generation:  0.01738595962524414
mini_batch_src_global generation:  0.019769906997680664
r_  generation:  0.1960163116455078
local_output_nid generation:  0.012158870697021484
local_in_edges_tensor generation:  0.020277023315429688
mini_batch_src_global generation:  0.02581930160522461
r_  generation:  0.20575952529907227
local_output_nid generation:  0.011747121810913086
local_in_edges_tensor generation:  0.016230106353759766
mini_batch_src_global generation:  0.024617671966552734
r_  generation:  0.2085893154144287
local_output_nid generation:  0.01197052001953125
local_in_edges_tensor generation:  0.017957687377929688
mini_batch_src_global generation:  0.02566695213317871
r_  generation:  0.21403980255126953
local_output_nid generation:  0.011789560317993164
local_in_edges_tensor generation:  0.012190580368041992
mini_batch_src_global generation:  0.039037466049194336
r_  generation:  0.21484041213989258
local_output_nid generation:  0.011913537979125977
local_in_edges_tensor generation:  0.014650344848632812
mini_batch_src_global generation:  0.0275726318359375
r_  generation:  0.21803975105285645
local_output_nid generation:  0.011843442916870117
local_in_edges_tensor generation:  0.012472867965698242
mini_batch_src_global generation:  0.027388334274291992
r_  generation:  0.21358299255371094
local_output_nid generation:  0.012092351913452148
local_in_edges_tensor generation:  0.01644754409790039
mini_batch_src_global generation:  0.027862071990966797
r_  generation:  0.21908307075500488
local_output_nid generation:  0.011904001235961914
local_in_edges_tensor generation:  0.016184568405151367
mini_batch_src_global generation:  0.02727651596069336
r_  generation:  0.21375393867492676
local_output_nid generation:  0.011844873428344727
local_in_edges_tensor generation:  0.014109611511230469
mini_batch_src_global generation:  0.029355525970458984
r_  generation:  0.216569185256958
local_output_nid generation:  0.01193547248840332
local_in_edges_tensor generation:  0.01480722427368164
mini_batch_src_global generation:  0.029689788818359375
r_  generation:  0.2211925983428955
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.01317453384399414
mini_batch_src_global generation:  0.02837085723876953
r_  generation:  0.21450185775756836
local_output_nid generation:  0.011884927749633789
local_in_edges_tensor generation:  0.012217521667480469
mini_batch_src_global generation:  0.02790689468383789
r_  generation:  0.2169184684753418
local_output_nid generation:  0.011919260025024414
local_in_edges_tensor generation:  0.01858830451965332
mini_batch_src_global generation:  0.029900074005126953
r_  generation:  0.21979618072509766
local_output_nid generation:  0.011946916580200195
local_in_edges_tensor generation:  0.016535043716430664
mini_batch_src_global generation:  0.028420448303222656
r_  generation:  0.22185730934143066
local_output_nid generation:  0.011841535568237305
local_in_edges_tensor generation:  0.012764930725097656
mini_batch_src_global generation:  0.02862238883972168
r_  generation:  0.21604251861572266
----------------------check_connections_block total spend ----------------------------- 5.096143960952759
generate_one_block  0.2766685485839844
generate_one_block  0.2780601978302002
generate_one_block  0.27857208251953125
generate_one_block  0.2826097011566162
generate_one_block  0.2940096855163574
generate_one_block  0.2898554801940918
generate_one_block  0.2737722396850586
generate_one_block  0.2867109775543213
generate_one_block  0.27655529975891113
generate_one_block  0.2772104740142822
generate_one_block  0.28540730476379395
generate_one_block  0.27306199073791504
generate_one_block  0.2752220630645752
generate_one_block  0.2858703136444092
generate_one_block  0.2905592918395996
generate_one_block  0.277632474899292
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03952193260192871
gen group dst list time:  0.0595698356628418
time for parepare:  0.0191342830657959
local_output_nid generation:  0.025455236434936523
local_in_edges_tensor generation:  0.04190945625305176
mini_batch_src_global generation:  0.04598641395568848
r_  generation:  0.47634220123291016
local_output_nid generation:  0.03124547004699707
local_in_edges_tensor generation:  0.05014681816101074
mini_batch_src_global generation:  0.05747032165527344
r_  generation:  0.4792821407318115
local_output_nid generation:  0.03088545799255371
local_in_edges_tensor generation:  0.050391435623168945
mini_batch_src_global generation:  0.06005501747131348
r_  generation:  0.4904360771179199
local_output_nid generation:  0.03064441680908203
local_in_edges_tensor generation:  0.04246807098388672
mini_batch_src_global generation:  0.057760000228881836
r_  generation:  0.4870796203613281
local_output_nid generation:  0.030629396438598633
local_in_edges_tensor generation:  0.037062644958496094
mini_batch_src_global generation:  0.05774354934692383
r_  generation:  0.4931347370147705
local_output_nid generation:  0.030637502670288086
local_in_edges_tensor generation:  0.033138275146484375
mini_batch_src_global generation:  0.05872988700866699
r_  generation:  0.4868900775909424
local_output_nid generation:  0.03076624870300293
local_in_edges_tensor generation:  0.03319215774536133
mini_batch_src_global generation:  0.05805206298828125
r_  generation:  0.49463677406311035
local_output_nid generation:  0.030725955963134766
local_in_edges_tensor generation:  0.03664207458496094
mini_batch_src_global generation:  0.05841827392578125
r_  generation:  0.4951190948486328
local_output_nid generation:  0.030983924865722656
local_in_edges_tensor generation:  0.04153800010681152
mini_batch_src_global generation:  0.05901789665222168
r_  generation:  0.4971923828125
local_output_nid generation:  0.03099799156188965
local_in_edges_tensor generation:  0.036951303482055664
mini_batch_src_global generation:  0.06255817413330078
r_  generation:  0.4929237365722656
local_output_nid generation:  0.031026601791381836
local_in_edges_tensor generation:  0.03335905075073242
mini_batch_src_global generation:  0.058042287826538086
r_  generation:  0.49813103675842285
local_output_nid generation:  0.030935287475585938
local_in_edges_tensor generation:  0.036908626556396484
mini_batch_src_global generation:  0.05905771255493164
r_  generation:  0.4893224239349365
local_output_nid generation:  0.0309293270111084
local_in_edges_tensor generation:  0.03706693649291992
mini_batch_src_global generation:  0.05807209014892578
r_  generation:  0.49463844299316406
local_output_nid generation:  0.031154155731201172
local_in_edges_tensor generation:  0.04221749305725098
mini_batch_src_global generation:  0.05858302116394043
r_  generation:  0.4953641891479492
local_output_nid generation:  0.030759096145629883
local_in_edges_tensor generation:  0.0420382022857666
mini_batch_src_global generation:  0.05896925926208496
r_  generation:  0.509131908416748
local_output_nid generation:  0.03074193000793457
local_in_edges_tensor generation:  0.032943010330200195
mini_batch_src_global generation:  0.0592801570892334
r_  generation:  0.4930236339569092
----------------------check_connections_block total spend ----------------------------- 11.61660647392273
generate_one_block  0.626701831817627
generate_one_block  0.6217038631439209
generate_one_block  0.6327376365661621
generate_one_block  0.6400313377380371
generate_one_block  0.6284723281860352
generate_one_block  0.6196215152740479
generate_one_block  0.6903591156005859
generate_one_block  0.6371586322784424
generate_one_block  0.640995979309082
generate_one_block  0.6434123516082764
generate_one_block  0.6262350082397461
generate_one_block  0.6418399810791016
generate_one_block  0.6401724815368652
generate_one_block  0.6330502033233643
generate_one_block  0.6339647769927979
generate_one_block  0.6467926502227783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06441712379455566
gen group dst list time:  0.09503722190856934
time for parepare:  0.019942283630371094
local_output_nid generation:  0.03347516059875488
local_in_edges_tensor generation:  0.05458688735961914
mini_batch_src_global generation:  0.0462493896484375
r_  generation:  0.4846189022064209
local_output_nid generation:  0.03887605667114258
local_in_edges_tensor generation:  0.043961524963378906
mini_batch_src_global generation:  0.05683398246765137
r_  generation:  0.49317002296447754
local_output_nid generation:  0.03769207000732422
local_in_edges_tensor generation:  0.039795875549316406
mini_batch_src_global generation:  0.055006980895996094
r_  generation:  0.4952876567840576
local_output_nid generation:  0.03757429122924805
local_in_edges_tensor generation:  0.044512271881103516
mini_batch_src_global generation:  0.05414390563964844
r_  generation:  0.4996378421783447
local_output_nid generation:  0.038147926330566406
local_in_edges_tensor generation:  0.0443415641784668
mini_batch_src_global generation:  0.05475258827209473
r_  generation:  0.5030450820922852
local_output_nid generation:  0.03767228126525879
local_in_edges_tensor generation:  0.03506803512573242
mini_batch_src_global generation:  0.055348873138427734
r_  generation:  0.5040688514709473
local_output_nid generation:  0.037706613540649414
local_in_edges_tensor generation:  0.03935742378234863
mini_batch_src_global generation:  0.055840492248535156
r_  generation:  0.5071852207183838
local_output_nid generation:  0.03799867630004883
local_in_edges_tensor generation:  0.048333168029785156
mini_batch_src_global generation:  0.0554966926574707
r_  generation:  0.5090000629425049
local_output_nid generation:  0.03794407844543457
local_in_edges_tensor generation:  0.0443878173828125
mini_batch_src_global generation:  0.05651211738586426
r_  generation:  0.5142600536346436
local_output_nid generation:  0.037940025329589844
local_in_edges_tensor generation:  0.03995823860168457
mini_batch_src_global generation:  0.05636715888977051
r_  generation:  0.5111825466156006
local_output_nid generation:  0.038076162338256836
local_in_edges_tensor generation:  0.03961777687072754
mini_batch_src_global generation:  0.05724143981933594
r_  generation:  0.5156102180480957
local_output_nid generation:  0.038182735443115234
local_in_edges_tensor generation:  0.04050898551940918
mini_batch_src_global generation:  0.06018543243408203
r_  generation:  0.5135700702667236
local_output_nid generation:  0.03780794143676758
local_in_edges_tensor generation:  0.0382997989654541
mini_batch_src_global generation:  0.056527137756347656
r_  generation:  0.5160698890686035
local_output_nid generation:  0.03788018226623535
local_in_edges_tensor generation:  0.04174947738647461
mini_batch_src_global generation:  0.0566706657409668
r_  generation:  0.5163452625274658
local_output_nid generation:  0.03764081001281738
local_in_edges_tensor generation:  0.03976845741271973
mini_batch_src_global generation:  0.057175397872924805
r_  generation:  0.518139123916626
local_output_nid generation:  0.03791451454162598
local_in_edges_tensor generation:  0.03572893142700195
mini_batch_src_global generation:  0.060494184494018555
r_  generation:  0.5243270397186279
----------------------check_connections_block total spend ----------------------------- 12.212275505065918
generate_one_block  0.6285624504089355
generate_one_block  0.6987113952636719
generate_one_block  0.6400494575500488
generate_one_block  0.6433365345001221
generate_one_block  0.6229739189147949
generate_one_block  0.6203789710998535
generate_one_block  0.628105640411377
generate_one_block  0.6425366401672363
generate_one_block  0.6400611400604248
generate_one_block  0.6345527172088623
generate_one_block  0.6248509883880615
generate_one_block  0.6283564567565918
generate_one_block  0.629723072052002
generate_one_block  0.6268186569213867
generate_one_block  0.637279748916626
generate_one_block  0.6346197128295898
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  28.925025939941406
block generation total time  24.885945320129395
average batch blocks generation time:  1.5553715825080872
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10780143737792969  GigaBytes
Max Memory Allocated: 0.10780143737792969  GigaBytes

torch.Size([163599, 128])
torch.Size([155494, 256])
torch.Size([123618, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8416748046875 GB
    Memory Allocated: 1.3640494346618652  GigaBytes
Max Memory Allocated: 1.401512622833252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3084716796875 GB
    Memory Allocated: 0.10986948013305664  GigaBytes
Max Memory Allocated: 1.4425420761108398  GigaBytes

torch.Size([163558, 128])
torch.Size([155189, 256])
torch.Size([123367, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3084716796875 GB
    Memory Allocated: 1.366231918334961  GigaBytes
Max Memory Allocated: 1.4425420761108398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3084716796875 GB
    Memory Allocated: 0.11001729965209961  GigaBytes
Max Memory Allocated: 1.4450011253356934  GigaBytes

torch.Size([163835, 128])
torch.Size([155901, 256])
torch.Size([124037, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9119873046875 GB
    Memory Allocated: 1.3721628189086914  GigaBytes
Max Memory Allocated: 1.4450011253356934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11000585556030273  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

torch.Size([163680, 128])
torch.Size([155626, 256])
torch.Size([123628, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3674330711364746  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10997724533081055  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

torch.Size([163496, 128])
torch.Size([155563, 256])
torch.Size([123757, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3669252395629883  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10988426208496094  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

torch.Size([163421, 128])
torch.Size([155170, 256])
torch.Size([123353, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3665008544921875  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10997724533081055  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

torch.Size([163487, 128])
torch.Size([155257, 256])
torch.Size([123314, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3644285202026367  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.1100773811340332  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

torch.Size([163678, 128])
torch.Size([155580, 256])
torch.Size([124142, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3743033409118652  GigaBytes
Max Memory Allocated: 1.4503989219665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11002302169799805  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163679, 128])
torch.Size([155758, 256])
torch.Size([124303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3715176582336426  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10992097854614258  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163588, 128])
torch.Size([155725, 256])
torch.Size([124022, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3704242706298828  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11012029647827148  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163505, 128])
torch.Size([155421, 256])
torch.Size([123788, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3683476448059082  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10991239547729492  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163688, 128])
torch.Size([155795, 256])
torch.Size([124138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3710803985595703  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10999631881713867  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163579, 128])
torch.Size([155643, 256])
torch.Size([123891, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3676233291625977  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10997390747070312  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163557, 128])
torch.Size([155594, 256])
torch.Size([124155, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3725438117980957  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11008310317993164  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163629, 128])
torch.Size([155526, 256])
torch.Size([123650, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3682875633239746  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.10987234115600586  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163672, 128])
torch.Size([155510, 256])
torch.Size([123233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 1.3641114234924316  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10917608439922333 |0.04440520703792572 |0.052998751401901245 |9.605288505554199e-05 |0.011862769722938538 |0.0024297237396240234 |
----------------------------------------------------------pseudo_mini_loss sum 6.4217963218688965
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7748089
Number of first layer input nodes during this epoch:  2617651
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16101741790771484  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.018937110900878906
random selection method range initialization spend 0.005476474761962891
time for parepare:  0.01812458038330078
local_output_nid generation:  0.0023679733276367188
local_in_edges_tensor generation:  0.004711151123046875
mini_batch_src_global generation:  0.0019161701202392578
r_  generation:  0.018372535705566406
local_output_nid generation:  0.0027627944946289062
local_in_edges_tensor generation:  0.0017383098602294922
mini_batch_src_global generation:  0.0022199153900146484
r_  generation:  0.0190279483795166
local_output_nid generation:  0.0028619766235351562
local_in_edges_tensor generation:  0.001567840576171875
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.0189816951751709
local_output_nid generation:  0.0029146671295166016
local_in_edges_tensor generation:  0.0015273094177246094
mini_batch_src_global generation:  0.0014371871948242188
r_  generation:  0.01804327964782715
local_output_nid generation:  0.0028564929962158203
local_in_edges_tensor generation:  0.0014815330505371094
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.01890277862548828
local_output_nid generation:  0.002967357635498047
local_in_edges_tensor generation:  0.0014750957489013672
mini_batch_src_global generation:  0.0014886856079101562
r_  generation:  0.019155263900756836
local_output_nid generation:  0.0029125213623046875
local_in_edges_tensor generation:  0.0015184879302978516
mini_batch_src_global generation:  0.0015249252319335938
r_  generation:  0.019424915313720703
local_output_nid generation:  0.0029573440551757812
local_in_edges_tensor generation:  0.0014917850494384766
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.019110441207885742
local_output_nid generation:  0.0029070377349853516
local_in_edges_tensor generation:  0.0014662742614746094
mini_batch_src_global generation:  0.0015418529510498047
r_  generation:  0.019344568252563477
local_output_nid generation:  0.002916574478149414
local_in_edges_tensor generation:  0.0014510154724121094
mini_batch_src_global generation:  0.0015723705291748047
r_  generation:  0.019504070281982422
local_output_nid generation:  0.0029587745666503906
local_in_edges_tensor generation:  0.00150299072265625
mini_batch_src_global generation:  0.0015823841094970703
r_  generation:  0.01957392692565918
local_output_nid generation:  0.002979755401611328
local_in_edges_tensor generation:  0.0014696121215820312
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.019060134887695312
local_output_nid generation:  0.002913236618041992
local_in_edges_tensor generation:  0.0014464855194091797
mini_batch_src_global generation:  0.0015511512756347656
r_  generation:  0.019886255264282227
local_output_nid generation:  0.002969980239868164
local_in_edges_tensor generation:  0.001458883285522461
mini_batch_src_global generation:  0.0015461444854736328
r_  generation:  0.019250869750976562
local_output_nid generation:  0.002925872802734375
local_in_edges_tensor generation:  0.001425027847290039
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.0190277099609375
local_output_nid generation:  0.002919435501098633
local_in_edges_tensor generation:  0.0014188289642333984
mini_batch_src_global generation:  0.0015845298767089844
r_  generation:  0.019382476806640625
----------------------check_connections_block total spend ----------------------------- 0.5031425952911377
generate_one_block  0.0272367000579834
generate_one_block  0.028919696807861328
generate_one_block  0.028071165084838867
generate_one_block  0.027355194091796875
generate_one_block  0.02759718894958496
generate_one_block  0.030646085739135742
generate_one_block  0.028044939041137695
generate_one_block  0.027923107147216797
generate_one_block  0.02843761444091797
generate_one_block  0.028314828872680664
generate_one_block  0.028178930282592773
generate_one_block  0.0275723934173584
generate_one_block  0.027739524841308594
generate_one_block  0.02750539779663086
generate_one_block  0.02725529670715332
generate_one_block  0.028438091278076172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03787708282470703
gen group dst list time:  0.016688108444213867
time for parepare:  0.019056320190429688
local_output_nid generation:  0.008264303207397461
local_in_edges_tensor generation:  0.018332481384277344
mini_batch_src_global generation:  0.024997949600219727
r_  generation:  0.19916844367980957
local_output_nid generation:  0.012662410736083984
local_in_edges_tensor generation:  0.020162582397460938
mini_batch_src_global generation:  0.027190446853637695
r_  generation:  0.2097334861755371
local_output_nid generation:  0.011949777603149414
local_in_edges_tensor generation:  0.01616191864013672
mini_batch_src_global generation:  0.024729490280151367
r_  generation:  0.21224617958068848
local_output_nid generation:  0.011723518371582031
local_in_edges_tensor generation:  0.012337923049926758
mini_batch_src_global generation:  0.025310993194580078
r_  generation:  0.20568275451660156
local_output_nid generation:  0.012412309646606445
local_in_edges_tensor generation:  0.01549983024597168
mini_batch_src_global generation:  0.027667999267578125
r_  generation:  0.2174232006072998
local_output_nid generation:  0.0126495361328125
local_in_edges_tensor generation:  0.016201019287109375
mini_batch_src_global generation:  0.028792858123779297
r_  generation:  0.2187824249267578
local_output_nid generation:  0.012687444686889648
local_in_edges_tensor generation:  0.012315750122070312
mini_batch_src_global generation:  0.027770042419433594
r_  generation:  0.21708416938781738
local_output_nid generation:  0.012570858001708984
local_in_edges_tensor generation:  0.015778303146362305
mini_batch_src_global generation:  0.02709031105041504
r_  generation:  0.22034072875976562
local_output_nid generation:  0.0125885009765625
local_in_edges_tensor generation:  0.017839670181274414
mini_batch_src_global generation:  0.027867555618286133
r_  generation:  0.22055840492248535
local_output_nid generation:  0.011841773986816406
local_in_edges_tensor generation:  0.01420283317565918
mini_batch_src_global generation:  0.029863357543945312
r_  generation:  0.21920442581176758
local_output_nid generation:  0.011923789978027344
local_in_edges_tensor generation:  0.014139413833618164
mini_batch_src_global generation:  0.02936697006225586
r_  generation:  0.22302627563476562
local_output_nid generation:  0.011792182922363281
local_in_edges_tensor generation:  0.013664960861206055
mini_batch_src_global generation:  0.027852535247802734
r_  generation:  0.2189638614654541
local_output_nid generation:  0.011974334716796875
local_in_edges_tensor generation:  0.012565851211547852
mini_batch_src_global generation:  0.02793121337890625
r_  generation:  0.22225666046142578
local_output_nid generation:  0.012897014617919922
local_in_edges_tensor generation:  0.012242794036865234
mini_batch_src_global generation:  0.027368545532226562
r_  generation:  0.22069859504699707
local_output_nid generation:  0.011963129043579102
local_in_edges_tensor generation:  0.018925905227661133
mini_batch_src_global generation:  0.029207229614257812
r_  generation:  0.2248215675354004
local_output_nid generation:  0.014273405075073242
local_in_edges_tensor generation:  0.016133546829223633
mini_batch_src_global generation:  0.028349876403808594
r_  generation:  0.22197699546813965
----------------------check_connections_block total spend ----------------------------- 5.160703182220459
generate_one_block  0.2969026565551758
generate_one_block  0.28799962997436523
generate_one_block  0.2862255573272705
generate_one_block  0.2751047611236572
generate_one_block  0.28138136863708496
generate_one_block  0.2806730270385742
generate_one_block  0.30556488037109375
generate_one_block  0.28378963470458984
generate_one_block  0.28260278701782227
generate_one_block  0.2791469097137451
generate_one_block  0.28571176528930664
generate_one_block  0.30167531967163086
generate_one_block  0.2850666046142578
generate_one_block  0.27219271659851074
generate_one_block  0.2790822982788086
generate_one_block  0.2744629383087158
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08051419258117676
gen group dst list time:  0.06707286834716797
time for parepare:  0.017370223999023438
local_output_nid generation:  0.025571346282958984
local_in_edges_tensor generation:  0.06128525733947754
mini_batch_src_global generation:  0.045943498611450195
r_  generation:  0.501662015914917
local_output_nid generation:  0.03110480308532715
local_in_edges_tensor generation:  0.0504000186920166
mini_batch_src_global generation:  0.05856132507324219
r_  generation:  0.4907546043395996
local_output_nid generation:  0.034699201583862305
local_in_edges_tensor generation:  0.05650806427001953
mini_batch_src_global generation:  0.055840253829956055
r_  generation:  0.514009952545166
local_output_nid generation:  0.034337759017944336
local_in_edges_tensor generation:  0.04680132865905762
mini_batch_src_global generation:  0.064849853515625
r_  generation:  0.48002028465270996
local_output_nid generation:  0.03209233283996582
local_in_edges_tensor generation:  0.09513449668884277
mini_batch_src_global generation:  0.06293916702270508
r_  generation:  0.4907045364379883
local_output_nid generation:  0.03130340576171875
local_in_edges_tensor generation:  0.05064535140991211
mini_batch_src_global generation:  0.05823659896850586
r_  generation:  0.4912445545196533
local_output_nid generation:  0.03122854232788086
local_in_edges_tensor generation:  0.03334546089172363
mini_batch_src_global generation:  0.0754542350769043
r_  generation:  0.49667787551879883
local_output_nid generation:  0.031152725219726562
local_in_edges_tensor generation:  0.03283238410949707
mini_batch_src_global generation:  0.059189796447753906
r_  generation:  0.49953246116638184
local_output_nid generation:  0.03131246566772461
local_in_edges_tensor generation:  0.03717923164367676
mini_batch_src_global generation:  0.05804252624511719
r_  generation:  0.5026111602783203
local_output_nid generation:  0.03205156326293945
local_in_edges_tensor generation:  0.054155826568603516
mini_batch_src_global generation:  0.05974578857421875
r_  generation:  0.49579286575317383
local_output_nid generation:  0.03187370300292969
local_in_edges_tensor generation:  0.041347503662109375
mini_batch_src_global generation:  0.06040477752685547
r_  generation:  0.5189383029937744
local_output_nid generation:  0.03559517860412598
local_in_edges_tensor generation:  0.03800010681152344
mini_batch_src_global generation:  0.06735372543334961
r_  generation:  0.488908052444458
local_output_nid generation:  0.03229379653930664
local_in_edges_tensor generation:  0.04108858108520508
mini_batch_src_global generation:  0.05792689323425293
r_  generation:  0.49829912185668945
local_output_nid generation:  0.03207087516784668
local_in_edges_tensor generation:  0.03478527069091797
mini_batch_src_global generation:  0.05833864212036133
r_  generation:  0.49895334243774414
local_output_nid generation:  0.032233238220214844
local_in_edges_tensor generation:  0.03418278694152832
mini_batch_src_global generation:  0.06102728843688965
r_  generation:  0.49855494499206543
local_output_nid generation:  0.03265190124511719
local_in_edges_tensor generation:  0.03952622413635254
mini_batch_src_global generation:  0.058089494705200195
r_  generation:  0.4869198799133301
----------------------check_connections_block total spend ----------------------------- 11.890453815460205
generate_one_block  0.6393747329711914
generate_one_block  0.6432778835296631
generate_one_block  0.6314616203308105
generate_one_block  0.613335371017456
generate_one_block  0.6407582759857178
generate_one_block  0.6404550075531006
generate_one_block  0.6248598098754883
generate_one_block  0.631704568862915
generate_one_block  0.6789267063140869
generate_one_block  0.6335089206695557
generate_one_block  0.6423671245574951
generate_one_block  0.6330897808074951
generate_one_block  0.6492886543273926
generate_one_block  0.6201198101043701
generate_one_block  0.6250567436218262
generate_one_block  0.6420495510101318
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042371511459350586
gen group dst list time:  0.09885048866271973
time for parepare:  0.01909661293029785
local_output_nid generation:  0.033941030502319336
local_in_edges_tensor generation:  0.05489921569824219
mini_batch_src_global generation:  0.04558253288269043
r_  generation:  0.4867978096008301
local_output_nid generation:  0.040586233139038086
local_in_edges_tensor generation:  0.04014277458190918
mini_batch_src_global generation:  0.059237003326416016
r_  generation:  0.48759984970092773
local_output_nid generation:  0.04066753387451172
local_in_edges_tensor generation:  0.03975486755371094
mini_batch_src_global generation:  0.05524253845214844
r_  generation:  0.49872517585754395
local_output_nid generation:  0.03850698471069336
local_in_edges_tensor generation:  0.04030489921569824
mini_batch_src_global generation:  0.05495333671569824
r_  generation:  0.49880528450012207
local_output_nid generation:  0.03787732124328613
local_in_edges_tensor generation:  0.045110464096069336
mini_batch_src_global generation:  0.054506778717041016
r_  generation:  0.5039236545562744
local_output_nid generation:  0.038082122802734375
local_in_edges_tensor generation:  0.04477381706237793
mini_batch_src_global generation:  0.0538485050201416
r_  generation:  0.5055787563323975
local_output_nid generation:  0.03785562515258789
local_in_edges_tensor generation:  0.03553032875061035
mini_batch_src_global generation:  0.05642080307006836
r_  generation:  0.5103943347930908
local_output_nid generation:  0.03782534599304199
local_in_edges_tensor generation:  0.03939676284790039
mini_batch_src_global generation:  0.05564093589782715
r_  generation:  0.5058760643005371
local_output_nid generation:  0.03787064552307129
local_in_edges_tensor generation:  0.0445559024810791
mini_batch_src_global generation:  0.05608034133911133
r_  generation:  0.5119314193725586
local_output_nid generation:  0.0380711555480957
local_in_edges_tensor generation:  0.04088330268859863
mini_batch_src_global generation:  0.05690503120422363
r_  generation:  0.5145206451416016
local_output_nid generation:  0.03812384605407715
local_in_edges_tensor generation:  0.03983664512634277
mini_batch_src_global generation:  0.05702710151672363
r_  generation:  0.5183041095733643
local_output_nid generation:  0.03833127021789551
local_in_edges_tensor generation:  0.04444599151611328
mini_batch_src_global generation:  0.05602097511291504
r_  generation:  0.5123400688171387
local_output_nid generation:  0.03816652297973633
local_in_edges_tensor generation:  0.04851794242858887
mini_batch_src_global generation:  0.05992889404296875
r_  generation:  0.5143747329711914
local_output_nid generation:  0.03841590881347656
local_in_edges_tensor generation:  0.039919376373291016
mini_batch_src_global generation:  0.05640387535095215
r_  generation:  0.5185415744781494
local_output_nid generation:  0.03850054740905762
local_in_edges_tensor generation:  0.04490470886230469
mini_batch_src_global generation:  0.057802677154541016
r_  generation:  0.5283057689666748
local_output_nid generation:  0.039636850357055664
local_in_edges_tensor generation:  0.0430757999420166
mini_batch_src_global generation:  0.0580744743347168
r_  generation:  0.5131053924560547
----------------------check_connections_block total spend ----------------------------- 12.249155044555664
generate_one_block  0.6367247104644775
generate_one_block  0.6372196674346924
generate_one_block  0.6332271099090576
generate_one_block  0.6263282299041748
generate_one_block  0.6289267539978027
generate_one_block  0.6265566349029541
generate_one_block  0.7007579803466797
generate_one_block  0.6349589824676514
generate_one_block  0.6400539875030518
generate_one_block  0.6276531219482422
generate_one_block  0.6412186622619629
generate_one_block  0.6166541576385498
generate_one_block  0.6840667724609375
generate_one_block  0.6605980396270752
generate_one_block  0.6401631832122803
generate_one_block  0.6307220458984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.16101741790771484  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

connection checking time:  29.300312042236328
block generation total time  25.013047456741333
average batch blocks generation time:  1.5633154660463333
block dataloader generation time/epoch 56.92799115180969
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0643310546875 GB
    Memory Allocated: 0.11266136169433594  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163441, 128])
torch.Size([155210, 256])
torch.Size([123412, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0662841796875 GB
    Memory Allocated: 1.368180274963379  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11263036727905273  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

torch.Size([163574, 128])
torch.Size([155597, 256])
torch.Size([123984, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3765788078308105  GigaBytes
Max Memory Allocated: 1.4539852142333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11273050308227539  GigaBytes
Max Memory Allocated: 1.456125259399414  GigaBytes

torch.Size([163716, 128])
torch.Size([155809, 256])
torch.Size([124184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3768653869628906  GigaBytes
Max Memory Allocated: 1.456125259399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11224937438964844  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163545, 128])
torch.Size([155227, 256])
torch.Size([122315, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3593764305114746  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11262750625610352  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163791, 128])
torch.Size([155851, 256])
torch.Size([124264, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3746585845947266  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11260604858398438  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163599, 128])
torch.Size([155601, 256])
torch.Size([124235, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3763585090637207  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11260080337524414  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163576, 128])
torch.Size([155496, 256])
torch.Size([123568, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3694028854370117  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11259984970092773  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163714, 128])
torch.Size([155598, 256])
torch.Size([123752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3711891174316406  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11275053024291992  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163679, 128])
torch.Size([155729, 256])
torch.Size([124393, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3763504028320312  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11256933212280273  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163658, 128])
torch.Size([155565, 256])
torch.Size([123800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3716039657592773  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11273336410522461  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163633, 128])
torch.Size([155632, 256])
torch.Size([124209, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3756775856018066  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11249971389770508  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163650, 128])
torch.Size([155466, 256])
torch.Size([123319, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3664560317993164  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11272764205932617  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163670, 128])
torch.Size([155622, 256])
torch.Size([123978, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3745527267456055  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.1125955581665039  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163875, 128])
torch.Size([156052, 256])
torch.Size([124067, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.374596118927002  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11261224746704102  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163698, 128])
torch.Size([155735, 256])
torch.Size([123810, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3700380325317383  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 0.11257219314575195  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

torch.Size([163792, 128])
torch.Size([155896, 256])
torch.Size([124321, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0682373046875 GB
    Memory Allocated: 1.3744068145751953  GigaBytes
Max Memory Allocated: 1.456221580505371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11048394441604614 |0.025332435965538025 |0.005764082074165344 |8.970499038696289e-05 |0.009014442563056946 |0.0018219947814941406 |
----------------------------------------------------------pseudo_mini_loss sum 3.273564100265503
Total (block generation + training)time/epoch 59.46209144592285
Training time/epoch 2.533792018890381
Training time without block to device /epoch 2.1284730434417725
Training time without total dataloading part /epoch 0.2397136688232422
load block tensor time/epoch 1.7677431106567383
block to device time/epoch 0.4053189754486084
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7751608
Number of first layer input nodes during this epoch:  2618611
