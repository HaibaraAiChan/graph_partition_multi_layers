Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648440382.0819364
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02744150161743164
random selection method range initialization spend 0.006338834762573242
time for parepare:  0.018585920333862305
local_output_nid generation:  0.004219532012939453
local_in_edges_tensor generation:  0.006684303283691406
mini_batch_src_global generation:  0.003705263137817383
r_  generation:  0.04158592224121094
local_output_nid generation:  0.0057065486907958984
local_in_edges_tensor generation:  0.0032699108123779297
mini_batch_src_global generation:  0.004848480224609375
r_  generation:  0.042940616607666016
local_output_nid generation:  0.006016254425048828
local_in_edges_tensor generation:  0.0031876564025878906
mini_batch_src_global generation:  0.0030045509338378906
r_  generation:  0.043663740158081055
local_output_nid generation:  0.0059931278228759766
local_in_edges_tensor generation:  0.003269672393798828
mini_batch_src_global generation:  0.003480195999145508
r_  generation:  0.04440450668334961
local_output_nid generation:  0.006100654602050781
local_in_edges_tensor generation:  0.003256559371948242
mini_batch_src_global generation:  0.003625631332397461
r_  generation:  0.04566311836242676
local_output_nid generation:  0.006040334701538086
local_in_edges_tensor generation:  0.0032482147216796875
mini_batch_src_global generation:  0.003827810287475586
r_  generation:  0.04732036590576172
local_output_nid generation:  0.0060803890228271484
local_in_edges_tensor generation:  0.0032320022583007812
mini_batch_src_global generation:  0.003810882568359375
r_  generation:  0.04616951942443848
local_output_nid generation:  0.006093263626098633
local_in_edges_tensor generation:  0.0032176971435546875
mini_batch_src_global generation:  0.00395965576171875
r_  generation:  0.04668235778808594
----------------------check_connections_block total spend ----------------------------- 0.5694963932037354
generate_one_block  0.06250429153442383
generate_one_block  0.062459707260131836
generate_one_block  0.06058311462402344
generate_one_block  0.06427121162414551
generate_one_block  0.0668179988861084
generate_one_block  0.06241893768310547
generate_one_block  0.061097145080566406
generate_one_block  0.060636043548583984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043763160705566406
gen group dst list time:  0.016201019287109375
time for parepare:  0.020245790481567383
local_output_nid generation:  0.014936208724975586
local_in_edges_tensor generation:  0.036431074142456055
mini_batch_src_global generation:  0.03543210029602051
r_  generation:  0.3587055206298828
local_output_nid generation:  0.023656129837036133
local_in_edges_tensor generation:  0.03581881523132324
mini_batch_src_global generation:  0.04794597625732422
r_  generation:  0.3705160617828369
local_output_nid generation:  0.023576736450195312
local_in_edges_tensor generation:  0.02573680877685547
mini_batch_src_global generation:  0.04353642463684082
r_  generation:  0.3701963424682617
local_output_nid generation:  0.02449178695678711
local_in_edges_tensor generation:  0.025237321853637695
mini_batch_src_global generation:  0.0481419563293457
r_  generation:  0.3771500587463379
local_output_nid generation:  0.023967742919921875
local_in_edges_tensor generation:  0.029369354248046875
mini_batch_src_global generation:  0.04552650451660156
r_  generation:  0.3788483142852783
local_output_nid generation:  0.023879051208496094
local_in_edges_tensor generation:  0.028861522674560547
mini_batch_src_global generation:  0.049221038818359375
r_  generation:  0.3922410011291504
local_output_nid generation:  0.02404165267944336
local_in_edges_tensor generation:  0.023140668869018555
mini_batch_src_global generation:  0.046483516693115234
r_  generation:  0.3797423839569092
local_output_nid generation:  0.02412128448486328
local_in_edges_tensor generation:  0.02148580551147461
mini_batch_src_global generation:  0.0468297004699707
r_  generation:  0.3764054775238037
----------------------check_connections_block total spend ----------------------------- 4.451316833496094
generate_one_block  0.5067965984344482
generate_one_block  0.5128219127655029
generate_one_block  0.4866461753845215
generate_one_block  0.5051195621490479
generate_one_block  0.4951777458190918
generate_one_block  0.5210471153259277
generate_one_block  0.49568748474121094
generate_one_block  0.49514222145080566
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032697439193725586
gen group dst list time:  0.036829233169555664
time for parepare:  0.019292354583740234
local_output_nid generation:  0.029185771942138672
local_in_edges_tensor generation:  0.04518532752990723
mini_batch_src_global generation:  0.04805135726928711
r_  generation:  0.48158884048461914
local_output_nid generation:  0.034795522689819336
local_in_edges_tensor generation:  0.052710771560668945
mini_batch_src_global generation:  0.05550575256347656
r_  generation:  0.49712181091308594
local_output_nid generation:  0.035144805908203125
local_in_edges_tensor generation:  0.04419970512390137
mini_batch_src_global generation:  0.05434918403625488
r_  generation:  0.48697328567504883
local_output_nid generation:  0.03522944450378418
local_in_edges_tensor generation:  0.044203996658325195
mini_batch_src_global generation:  0.05236506462097168
r_  generation:  0.4949679374694824
local_output_nid generation:  0.03848862648010254
local_in_edges_tensor generation:  0.044289588928222656
mini_batch_src_global generation:  0.05366206169128418
r_  generation:  0.4965481758117676
local_output_nid generation:  0.035378217697143555
local_in_edges_tensor generation:  0.040206193923950195
mini_batch_src_global generation:  0.05411553382873535
r_  generation:  0.5029780864715576
local_output_nid generation:  0.03536796569824219
local_in_edges_tensor generation:  0.0362093448638916
mini_batch_src_global generation:  0.05412483215332031
r_  generation:  0.5071761608123779
local_output_nid generation:  0.03524327278137207
local_in_edges_tensor generation:  0.03648495674133301
mini_batch_src_global generation:  0.05415511131286621
r_  generation:  0.5040369033813477
----------------------check_connections_block total spend ----------------------------- 5.951221466064453
generate_one_block  0.6124575138092041
generate_one_block  0.6332616806030273
generate_one_block  0.6166326999664307
generate_one_block  0.6297047138214111
generate_one_block  0.6310114860534668
generate_one_block  0.6242079734802246
generate_one_block  0.6317687034606934
generate_one_block  0.6106922626495361
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  10.402538299560547
block generation total time  9.00817584991455
average batch blocks generation time:  1.1260219812393188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09972190856933594  GigaBytes
Max Memory Allocated: 0.09972190856933594  GigaBytes

torch.Size([162180, 128])
torch.Size([145927, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.3155403137207031  GigaBytes
Max Memory Allocated: 0.3285789489746094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.10208988189697266  GigaBytes
Max Memory Allocated: 0.3502845764160156  GigaBytes

torch.Size([162113, 128])
torch.Size([145925, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.3169136047363281  GigaBytes
Max Memory Allocated: 0.3502845764160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.101898193359375  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

torch.Size([162329, 128])
torch.Size([145820, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.31540584564208984  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.10191631317138672  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

torch.Size([162238, 128])
torch.Size([146118, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.31670045852661133  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.10209321975708008  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

torch.Size([162287, 128])
torch.Size([146030, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.3165712356567383  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10223007202148438  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

torch.Size([162328, 128])
torch.Size([146394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31710052490234375  GigaBytes
Max Memory Allocated: 0.3514590263366699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10191869735717773  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162186, 128])
torch.Size([145875, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31632089614868164  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10213232040405273  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162341, 128])
torch.Size([145760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31612682342529297  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040796250104904175 |0.049084484577178955 |0.09303992986679077 |0.00010591745376586914 |0.012774527072906494 |0.003496885299682617 |
----------------------------------------------------------pseudo_mini_loss sum 5.3130998611450195
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3055067
Number of first layer input nodes during this epoch:  1298002
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.14818334579467773  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027669191360473633
random selection method range initialization spend 0.005568742752075195
time for parepare:  0.0180666446685791
local_output_nid generation:  0.00437617301940918
local_in_edges_tensor generation:  0.006498813629150391
mini_batch_src_global generation:  0.003675699234008789
r_  generation:  0.04076051712036133
local_output_nid generation:  0.005819797515869141
local_in_edges_tensor generation:  0.006076335906982422
mini_batch_src_global generation:  0.004673480987548828
r_  generation:  0.042435646057128906
local_output_nid generation:  0.006108283996582031
local_in_edges_tensor generation:  0.0034263134002685547
mini_batch_src_global generation:  0.0032842159271240234
r_  generation:  0.05106997489929199
local_output_nid generation:  0.0068895816802978516
local_in_edges_tensor generation:  0.012944459915161133
mini_batch_src_global generation:  0.00541234016418457
r_  generation:  0.055930137634277344
local_output_nid generation:  0.006673097610473633
local_in_edges_tensor generation:  0.004241228103637695
mini_batch_src_global generation:  0.003915309906005859
r_  generation:  0.04973554611206055
local_output_nid generation:  0.006256103515625
local_in_edges_tensor generation:  0.0032427310943603516
mini_batch_src_global generation:  0.004224061965942383
r_  generation:  0.051247596740722656
local_output_nid generation:  0.00658416748046875
local_in_edges_tensor generation:  0.0033271312713623047
mini_batch_src_global generation:  0.004063844680786133
r_  generation:  0.05023026466369629
local_output_nid generation:  0.006246328353881836
local_in_edges_tensor generation:  0.003482818603515625
mini_batch_src_global generation:  0.005064964294433594
r_  generation:  0.04954671859741211
----------------------check_connections_block total spend ----------------------------- 0.6372764110565186
generate_one_block  0.059369564056396484
generate_one_block  0.06340646743774414
generate_one_block  0.06652069091796875
generate_one_block  0.061879634857177734
generate_one_block  0.06421113014221191
generate_one_block  0.06324291229248047
generate_one_block  0.06530213356018066
generate_one_block  0.06458616256713867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08735847473144531
gen group dst list time:  0.016492843627929688
time for parepare:  0.019088268280029297
local_output_nid generation:  0.014663934707641602
local_in_edges_tensor generation:  0.0592041015625
mini_batch_src_global generation:  0.03893327713012695
r_  generation:  0.35901784896850586
local_output_nid generation:  0.01995563507080078
local_in_edges_tensor generation:  0.03577756881713867
mini_batch_src_global generation:  0.04471230506896973
r_  generation:  0.3680903911590576
local_output_nid generation:  0.019473552703857422
local_in_edges_tensor generation:  0.032953500747680664
mini_batch_src_global generation:  0.04460787773132324
r_  generation:  0.3817741870880127
local_output_nid generation:  0.01933121681213379
local_in_edges_tensor generation:  0.029471635818481445
mini_batch_src_global generation:  0.045880794525146484
r_  generation:  0.38118410110473633
local_output_nid generation:  0.019585609436035156
local_in_edges_tensor generation:  0.026180744171142578
mini_batch_src_global generation:  0.04968857765197754
r_  generation:  0.3867940902709961
local_output_nid generation:  0.019522666931152344
local_in_edges_tensor generation:  0.02323603630065918
mini_batch_src_global generation:  0.047277212142944336
r_  generation:  0.39130544662475586
local_output_nid generation:  0.0194549560546875
local_in_edges_tensor generation:  0.023420333862304688
mini_batch_src_global generation:  0.04705023765563965
r_  generation:  0.3908650875091553
local_output_nid generation:  0.02191925048828125
local_in_edges_tensor generation:  0.03248429298400879
mini_batch_src_global generation:  0.046724557876586914
r_  generation:  0.39542317390441895
----------------------check_connections_block total spend ----------------------------- 4.525953054428101
generate_one_block  0.5091369152069092
generate_one_block  0.5128493309020996
generate_one_block  0.5285818576812744
generate_one_block  0.5240576267242432
generate_one_block  0.5217792987823486
generate_one_block  0.5194435119628906
generate_one_block  0.5200905799865723
generate_one_block  0.5449845790863037
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04707694053649902
gen group dst list time:  0.0388336181640625
time for parepare:  0.01983046531677246
local_output_nid generation:  0.039170265197753906
local_in_edges_tensor generation:  0.06051921844482422
mini_batch_src_global generation:  0.04867148399353027
r_  generation:  0.48198866844177246
local_output_nid generation:  0.035349369049072266
local_in_edges_tensor generation:  0.05118227005004883
mini_batch_src_global generation:  0.05745363235473633
r_  generation:  0.4947521686553955
local_output_nid generation:  0.036776065826416016
local_in_edges_tensor generation:  0.056640625
mini_batch_src_global generation:  0.055745840072631836
r_  generation:  0.5058541297912598
local_output_nid generation:  0.040294647216796875
local_in_edges_tensor generation:  0.05251002311706543
mini_batch_src_global generation:  0.05618643760681152
r_  generation:  0.4983203411102295
local_output_nid generation:  0.03663444519042969
local_in_edges_tensor generation:  0.04033660888671875
mini_batch_src_global generation:  0.05430173873901367
r_  generation:  0.4997093677520752
local_output_nid generation:  0.036670684814453125
local_in_edges_tensor generation:  0.0391538143157959
mini_batch_src_global generation:  0.05410885810852051
r_  generation:  0.5012435913085938
local_output_nid generation:  0.0366520881652832
local_in_edges_tensor generation:  0.0343477725982666
mini_batch_src_global generation:  0.05810070037841797
r_  generation:  0.5054104328155518
local_output_nid generation:  0.03695559501647949
local_in_edges_tensor generation:  0.04290175437927246
mini_batch_src_global generation:  0.05456900596618652
r_  generation:  0.5186769962310791
----------------------check_connections_block total spend ----------------------------- 6.089977979660034
generate_one_block  0.6288661956787109
generate_one_block  0.6275351047515869
generate_one_block  0.6250038146972656
generate_one_block  0.6327109336853027
generate_one_block  0.6268579959869385
generate_one_block  0.6147449016571045
generate_one_block  0.622765064239502
generate_one_block  0.6267380714416504
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.14818334579467773  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

connection checking time:  10.615931034088135
block generation total time  9.186145782470703
average batch blocks generation time:  1.148268222808838
block dataloader generation time/epoch 22.048244953155518
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10242843627929688  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162402, 128])
torch.Size([146290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31664323806762695  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.1022176742553711  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162092, 128])
torch.Size([145393, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3154153823852539  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10224390029907227  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162186, 128])
torch.Size([146104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31712961196899414  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10225152969360352  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162378, 128])
torch.Size([146298, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31670665740966797  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10251617431640625  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

torch.Size([162285, 128])
torch.Size([146034, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31731128692626953  GigaBytes
Max Memory Allocated: 0.3519105911254883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10229682922363281  GigaBytes
Max Memory Allocated: 0.3520336151123047  GigaBytes

torch.Size([162004, 128])
torch.Size([145596, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3169989585876465  GigaBytes
Max Memory Allocated: 0.3520336151123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10224676132202148  GigaBytes
Max Memory Allocated: 0.3520336151123047  GigaBytes

torch.Size([162182, 128])
torch.Size([145959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31651973724365234  GigaBytes
Max Memory Allocated: 0.3520336151123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10257291793823242  GigaBytes
Max Memory Allocated: 0.3520336151123047  GigaBytes

torch.Size([162263, 128])
torch.Size([145968, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31731128692626953  GigaBytes
Max Memory Allocated: 0.3520336151123047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04226452112197876 |0.0169602632522583 |0.0036333203315734863 |9.062886238098145e-05 |0.007261037826538086 |0.0030760765075683594 |
----------------------------------------------------------pseudo_mini_loss sum 4.092656135559082
Total (block generation + training)time/epoch 22.638288974761963
Training time/epoch 0.5897665023803711
Training time without block to device /epoch 0.4540843963623047
Training time without total dataloading part /epoch 0.09095597267150879
load block tensor time/epoch 0.3381161689758301
block to device time/epoch 0.1356821060180664
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3054595
Number of first layer input nodes during this epoch:  1297792
