Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648480537.3716412
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0247347354888916
random selection method range initialization spend 0.00652313232421875
time for parepare:  0.018608808517456055
local_output_nid generation:  0.004300355911254883
local_in_edges_tensor generation:  0.006090641021728516
mini_batch_src_global generation:  0.0032880306243896484
r_  generation:  0.038228750228881836
local_output_nid generation:  0.0058116912841796875
local_in_edges_tensor generation:  0.0032002925872802734
mini_batch_src_global generation:  0.004294157028198242
r_  generation:  0.039186716079711914
local_output_nid generation:  0.0060577392578125
local_in_edges_tensor generation:  0.003250598907470703
mini_batch_src_global generation:  0.0029413700103759766
r_  generation:  0.03980660438537598
local_output_nid generation:  0.006056547164916992
local_in_edges_tensor generation:  0.0032880306243896484
mini_batch_src_global generation:  0.003054380416870117
r_  generation:  0.04181814193725586
local_output_nid generation:  0.00611567497253418
local_in_edges_tensor generation:  0.0032358169555664062
mini_batch_src_global generation:  0.0031158924102783203
r_  generation:  0.04097390174865723
local_output_nid generation:  0.006054878234863281
local_in_edges_tensor generation:  0.003258228302001953
mini_batch_src_global generation:  0.0033583641052246094
r_  generation:  0.04202389717102051
local_output_nid generation:  0.0060956478118896484
local_in_edges_tensor generation:  0.0031659603118896484
mini_batch_src_global generation:  0.003519773483276367
r_  generation:  0.04252362251281738
local_output_nid generation:  0.006104230880737305
local_in_edges_tensor generation:  0.003164529800415039
mini_batch_src_global generation:  0.003508329391479492
r_  generation:  0.04197502136230469
----------------------check_connections_block total spend ----------------------------- 0.5257568359375
generate_one_block  0.05520176887512207
generate_one_block  0.056166887283325195
generate_one_block  0.056433677673339844
generate_one_block  0.055581092834472656
generate_one_block  0.05890512466430664
generate_one_block  0.0564417839050293
generate_one_block  0.055588483810424805
generate_one_block  0.05554652214050293
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04259514808654785
gen group dst list time:  0.017568588256835938
time for parepare:  0.02005791664123535
local_output_nid generation:  0.013926029205322266
local_in_edges_tensor generation:  0.03624081611633301
mini_batch_src_global generation:  0.030692577362060547
r_  generation:  0.3000972270965576
local_output_nid generation:  0.02116680145263672
local_in_edges_tensor generation:  0.030731678009033203
mini_batch_src_global generation:  0.03883481025695801
r_  generation:  0.32873034477233887
local_output_nid generation:  0.021178722381591797
local_in_edges_tensor generation:  0.02478933334350586
mini_batch_src_global generation:  0.0383450984954834
r_  generation:  0.32184743881225586
local_output_nid generation:  0.021262645721435547
local_in_edges_tensor generation:  0.025227785110473633
mini_batch_src_global generation:  0.042917728424072266
r_  generation:  0.33546876907348633
local_output_nid generation:  0.025250673294067383
local_in_edges_tensor generation:  0.03695559501647949
mini_batch_src_global generation:  0.05785417556762695
r_  generation:  0.3236429691314697
local_output_nid generation:  0.01884746551513672
local_in_edges_tensor generation:  0.02473139762878418
mini_batch_src_global generation:  0.04165911674499512
r_  generation:  0.32129526138305664
local_output_nid generation:  0.018645524978637695
local_in_edges_tensor generation:  0.023696422576904297
mini_batch_src_global generation:  0.04066133499145508
r_  generation:  0.3202018737792969
local_output_nid generation:  0.01862025260925293
local_in_edges_tensor generation:  0.017534732818603516
mini_batch_src_global generation:  0.04127359390258789
r_  generation:  0.3213803768157959
----------------------check_connections_block total spend ----------------------------- 3.857271194458008
generate_one_block  0.41107678413391113
generate_one_block  0.41462278366088867
generate_one_block  0.4145331382751465
generate_one_block  0.4160044193267822
generate_one_block  0.407071590423584
generate_one_block  0.43066954612731934
generate_one_block  0.407564640045166
generate_one_block  0.4109506607055664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.056186676025390625
gen group dst list time:  0.036191463470458984
time for parepare:  0.01912975311279297
local_output_nid generation:  0.02854180335998535
local_in_edges_tensor generation:  0.08310651779174805
mini_batch_src_global generation:  0.052933692932128906
r_  generation:  0.5225224494934082
local_output_nid generation:  0.04049539566040039
local_in_edges_tensor generation:  0.05374407768249512
mini_batch_src_global generation:  0.06685066223144531
r_  generation:  0.5536110401153564
local_output_nid generation:  0.03904008865356445
local_in_edges_tensor generation:  0.054421186447143555
mini_batch_src_global generation:  0.07453322410583496
r_  generation:  0.5445520877838135
local_output_nid generation:  0.037029266357421875
local_in_edges_tensor generation:  0.054793596267700195
mini_batch_src_global generation:  0.07684087753295898
r_  generation:  0.5439939498901367
local_output_nid generation:  0.03821063041687012
local_in_edges_tensor generation:  0.04976320266723633
mini_batch_src_global generation:  0.061748504638671875
r_  generation:  0.5528430938720703
local_output_nid generation:  0.03600811958312988
local_in_edges_tensor generation:  0.03918194770812988
mini_batch_src_global generation:  0.06697416305541992
r_  generation:  0.5333926677703857
local_output_nid generation:  0.036110639572143555
local_in_edges_tensor generation:  0.0358278751373291
mini_batch_src_global generation:  0.06255245208740234
r_  generation:  0.5701394081115723
local_output_nid generation:  0.03692317008972168
local_in_edges_tensor generation:  0.046181678771972656
mini_batch_src_global generation:  0.06689739227294922
r_  generation:  0.534466028213501
----------------------check_connections_block total spend ----------------------------- 6.578722238540649
generate_one_block  0.6773746013641357
generate_one_block  0.6940231323242188
generate_one_block  0.6700072288513184
generate_one_block  0.6836390495300293
generate_one_block  0.6715409755706787
generate_one_block  0.6693124771118164
generate_one_block  0.702099084854126
generate_one_block  0.6720418930053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05422401428222656
gen group dst list time:  0.048013925552368164
time for parepare:  0.0191342830657959
local_output_nid generation:  0.034935951232910156
local_in_edges_tensor generation:  0.05670523643493652
mini_batch_src_global generation:  0.049767494201660156
r_  generation:  0.5128834247589111
local_output_nid generation:  0.0398411750793457
local_in_edges_tensor generation:  0.05446982383728027
mini_batch_src_global generation:  0.057057857513427734
r_  generation:  0.5082600116729736
local_output_nid generation:  0.041724443435668945
local_in_edges_tensor generation:  0.04213261604309082
mini_batch_src_global generation:  0.058573246002197266
r_  generation:  0.508202314376831
local_output_nid generation:  0.03989815711975098
local_in_edges_tensor generation:  0.041106462478637695
mini_batch_src_global generation:  0.055210113525390625
r_  generation:  0.5100760459899902
local_output_nid generation:  0.03999066352844238
local_in_edges_tensor generation:  0.04084467887878418
mini_batch_src_global generation:  0.058141231536865234
r_  generation:  0.5163133144378662
local_output_nid generation:  0.04024624824523926
local_in_edges_tensor generation:  0.040738582611083984
mini_batch_src_global generation:  0.05416440963745117
r_  generation:  0.5190639495849609
local_output_nid generation:  0.04032611846923828
local_in_edges_tensor generation:  0.0412752628326416
mini_batch_src_global generation:  0.05539822578430176
r_  generation:  0.5195660591125488
local_output_nid generation:  0.04004931449890137
local_in_edges_tensor generation:  0.04591727256774902
mini_batch_src_global generation:  0.05521249771118164
r_  generation:  0.5226335525512695
----------------------check_connections_block total spend ----------------------------- 6.198682546615601
generate_one_block  0.631669282913208
generate_one_block  0.6475329399108887
generate_one_block  0.6336085796356201
generate_one_block  0.6421911716461182
generate_one_block  0.642979621887207
generate_one_block  0.6364867687225342
generate_one_block  0.6870043277740479
generate_one_block  0.6375305652618408
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  16.634675979614258
block generation total time  13.911535263061523
average batch blocks generation time:  1.7389419078826904
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11222028732299805  GigaBytes
Max Memory Allocated: 0.11222028732299805  GigaBytes

torch.Size([165534, 128])
torch.Size([161034, 256])
torch.Size([141670, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.5768351554870605  GigaBytes
Max Memory Allocated: 1.6367626190185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.1154484748840332  GigaBytes
Max Memory Allocated: 1.7050137519836426  GigaBytes

torch.Size([165593, 128])
torch.Size([161376, 256])
torch.Size([142132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5815491676330566  GigaBytes
Max Memory Allocated: 1.7050137519836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11528778076171875  GigaBytes
Max Memory Allocated: 1.7097420692443848  GigaBytes

torch.Size([165377, 128])
torch.Size([160998, 256])
torch.Size([141732, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5784735679626465  GigaBytes
Max Memory Allocated: 1.7097420692443848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11541366577148438  GigaBytes
Max Memory Allocated: 1.7097420692443848  GigaBytes

torch.Size([165513, 128])
torch.Size([161113, 256])
torch.Size([141934, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.580897331237793  GigaBytes
Max Memory Allocated: 1.7097420692443848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1154012680053711  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

torch.Size([165590, 128])
torch.Size([161340, 256])
torch.Size([142266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5803842544555664  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11537408828735352  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

torch.Size([165501, 128])
torch.Size([161144, 256])
torch.Size([141909, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5794239044189453  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11533689498901367  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

torch.Size([165508, 128])
torch.Size([161158, 256])
torch.Size([142123, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5800485610961914  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11540651321411133  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

torch.Size([165583, 128])
torch.Size([161144, 256])
torch.Size([141800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5791473388671875  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11261346936225891 |0.06439802050590515 |0.10092824697494507 |0.00010952353477478027 |0.02446839213371277 |0.003235340118408203 |
----------------------------------------------------------pseudo_mini_loss sum 6.3434014320373535
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4291396
Number of first layer input nodes during this epoch:  1324199
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 0.17305946350097656  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.020471811294555664
random selection method range initialization spend 0.005357027053833008
time for parepare:  0.017130136489868164
local_output_nid generation:  0.004436969757080078
local_in_edges_tensor generation:  0.008161783218383789
mini_batch_src_global generation:  0.003315448760986328
r_  generation:  0.03710126876831055
local_output_nid generation:  0.0059261322021484375
local_in_edges_tensor generation:  0.003114461898803711
mini_batch_src_global generation:  0.004074573516845703
r_  generation:  0.038530588150024414
local_output_nid generation:  0.006006002426147461
local_in_edges_tensor generation:  0.0031502246856689453
mini_batch_src_global generation:  0.0027620792388916016
r_  generation:  0.0387420654296875
local_output_nid generation:  0.0059893131256103516
local_in_edges_tensor generation:  0.0031120777130126953
mini_batch_src_global generation:  0.003053426742553711
r_  generation:  0.041526079177856445
local_output_nid generation:  0.006664276123046875
local_in_edges_tensor generation:  0.006257772445678711
mini_batch_src_global generation:  0.004503488540649414
r_  generation:  0.04170727729797363
local_output_nid generation:  0.006103992462158203
local_in_edges_tensor generation:  0.0032455921173095703
mini_batch_src_global generation:  0.009049415588378906
r_  generation:  0.04116082191467285
local_output_nid generation:  0.006704568862915039
local_in_edges_tensor generation:  0.0031735897064208984
mini_batch_src_global generation:  0.003503561019897461
r_  generation:  0.040207862854003906
local_output_nid generation:  0.00615382194519043
local_in_edges_tensor generation:  0.0030689239501953125
mini_batch_src_global generation:  0.003362894058227539
r_  generation:  0.04119396209716797
----------------------check_connections_block total spend ----------------------------- 0.5473663806915283
generate_one_block  0.054049015045166016
generate_one_block  0.05354475975036621
generate_one_block  0.05398201942443848
generate_one_block  0.053839921951293945
generate_one_block  0.054960012435913086
generate_one_block  0.05475974082946777
generate_one_block  0.05817365646362305
generate_one_block  0.058327436447143555
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05059671401977539
gen group dst list time:  0.01466226577758789
time for parepare:  0.021023273468017578
local_output_nid generation:  0.013214349746704102
local_in_edges_tensor generation:  0.043817758560180664
mini_batch_src_global generation:  0.03087162971496582
r_  generation:  0.29981279373168945
local_output_nid generation:  0.0187222957611084
local_in_edges_tensor generation:  0.02962779998779297
mini_batch_src_global generation:  0.03668212890625
r_  generation:  0.30315113067626953
local_output_nid generation:  0.01830291748046875
local_in_edges_tensor generation:  0.024387598037719727
mini_batch_src_global generation:  0.03588247299194336
r_  generation:  0.31099677085876465
local_output_nid generation:  0.017694950103759766
local_in_edges_tensor generation:  0.021988868713378906
mini_batch_src_global generation:  0.037168264389038086
r_  generation:  0.3091394901275635
local_output_nid generation:  0.017896175384521484
local_in_edges_tensor generation:  0.02457904815673828
mini_batch_src_global generation:  0.03978157043457031
r_  generation:  0.31617283821105957
local_output_nid generation:  0.01773858070373535
local_in_edges_tensor generation:  0.0214688777923584
mini_batch_src_global generation:  0.044707298278808594
r_  generation:  0.316786527633667
local_output_nid generation:  0.01781153678894043
local_in_edges_tensor generation:  0.019041061401367188
mini_batch_src_global generation:  0.04311800003051758
r_  generation:  0.3156092166900635
local_output_nid generation:  0.01797342300415039
local_in_edges_tensor generation:  0.024455547332763672
mini_batch_src_global generation:  0.037912607192993164
r_  generation:  0.3139221668243408
----------------------check_connections_block total spend ----------------------------- 3.6937506198883057
generate_one_block  0.40589475631713867
generate_one_block  0.40288877487182617
generate_one_block  0.4128551483154297
generate_one_block  0.41170740127563477
generate_one_block  0.42003726959228516
generate_one_block  0.41141200065612793
generate_one_block  0.4044628143310547
generate_one_block  0.4272615909576416
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0498964786529541
gen group dst list time:  0.03757309913635254
time for parepare:  0.018744230270385742
local_output_nid generation:  0.028300762176513672
local_in_edges_tensor generation:  0.06258916854858398
mini_batch_src_global generation:  0.051189422607421875
r_  generation:  0.5347702503204346
local_output_nid generation:  0.03472328186035156
local_in_edges_tensor generation:  0.05336403846740723
mini_batch_src_global generation:  0.06363391876220703
r_  generation:  0.5182783603668213
local_output_nid generation:  0.03437542915344238
local_in_edges_tensor generation:  0.0447843074798584
mini_batch_src_global generation:  0.054418325424194336
r_  generation:  0.5285871028900146
local_output_nid generation:  0.034363508224487305
local_in_edges_tensor generation:  0.044907331466674805
mini_batch_src_global generation:  0.05815529823303223
r_  generation:  0.5153357982635498
local_output_nid generation:  0.034546613693237305
local_in_edges_tensor generation:  0.03965449333190918
mini_batch_src_global generation:  0.06079745292663574
r_  generation:  0.5321123600006104
local_output_nid generation:  0.034456729888916016
local_in_edges_tensor generation:  0.03936934471130371
mini_batch_src_global generation:  0.0592038631439209
r_  generation:  0.5213079452514648
local_output_nid generation:  0.03496098518371582
local_in_edges_tensor generation:  0.03974485397338867
mini_batch_src_global generation:  0.07949590682983398
r_  generation:  0.5315077304840088
local_output_nid generation:  0.03482985496520996
local_in_edges_tensor generation:  0.03946876525878906
mini_batch_src_global generation:  0.05901050567626953
r_  generation:  0.5216100215911865
----------------------check_connections_block total spend ----------------------------- 6.262435674667358
generate_one_block  0.6700584888458252
generate_one_block  0.663060188293457
generate_one_block  0.6660234928131104
generate_one_block  0.6568543910980225
generate_one_block  0.668550968170166
generate_one_block  0.6534206867218018
generate_one_block  0.6633164882659912
generate_one_block  0.677072286605835
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037120819091796875
gen group dst list time:  0.047179222106933594
time for parepare:  0.019388437271118164
local_output_nid generation:  0.034285783767700195
local_in_edges_tensor generation:  0.04312777519226074
mini_batch_src_global generation:  0.05060291290283203
r_  generation:  0.5376148223876953
local_output_nid generation:  0.04041457176208496
local_in_edges_tensor generation:  0.048004865646362305
mini_batch_src_global generation:  0.06468057632446289
r_  generation:  0.5083999633789062
local_output_nid generation:  0.0422663688659668
local_in_edges_tensor generation:  0.04807877540588379
mini_batch_src_global generation:  0.058440208435058594
r_  generation:  0.5022580623626709
local_output_nid generation:  0.04001331329345703
local_in_edges_tensor generation:  0.039815425872802734
mini_batch_src_global generation:  0.05498147010803223
r_  generation:  0.5113623142242432
local_output_nid generation:  0.03987693786621094
local_in_edges_tensor generation:  0.038503408432006836
mini_batch_src_global generation:  0.05762982368469238
r_  generation:  0.5120959281921387
local_output_nid generation:  0.039339542388916016
local_in_edges_tensor generation:  0.03540778160095215
mini_batch_src_global generation:  0.05516529083251953
r_  generation:  0.5239670276641846
local_output_nid generation:  0.03947162628173828
local_in_edges_tensor generation:  0.03854656219482422
mini_batch_src_global generation:  0.055028438568115234
r_  generation:  0.5137720108032227
local_output_nid generation:  0.0394899845123291
local_in_edges_tensor generation:  0.0475006103515625
mini_batch_src_global generation:  0.054233551025390625
r_  generation:  0.5201349258422852
----------------------check_connections_block total spend ----------------------------- 6.192242622375488
generate_one_block  0.6372256278991699
generate_one_block  0.6214742660522461
generate_one_block  0.6532320976257324
generate_one_block  0.6363120079040527
generate_one_block  0.6347625255584717
generate_one_block  0.6221964359283447
generate_one_block  0.6428134441375732
generate_one_block  0.6350131034851074
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 0.17305946350097656  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

connection checking time:  16.148428916931152
block generation total time  13.697906255722046
average batch blocks generation time:  1.7122382819652557
block dataloader generation time/epoch 32.147812366485596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 0.11795854568481445  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

torch.Size([165486, 128])
torch.Size([161136, 256])
torch.Size([141708, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 1.5820941925048828  GigaBytes
Max Memory Allocated: 1.7101335525512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11784982681274414  GigaBytes
Max Memory Allocated: 1.7111015319824219  GigaBytes

torch.Size([165492, 128])
torch.Size([161170, 256])
torch.Size([141634, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5792522430419922  GigaBytes
Max Memory Allocated: 1.7111015319824219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.1180572509765625  GigaBytes
Max Memory Allocated: 1.7111015319824219  GigaBytes

torch.Size([165569, 128])
torch.Size([161369, 256])
torch.Size([142426, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5902953147888184  GigaBytes
Max Memory Allocated: 1.7111015319824219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11794328689575195  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

torch.Size([165481, 128])
torch.Size([161161, 256])
torch.Size([141883, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.582895278930664  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11805343627929688  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

torch.Size([165544, 128])
torch.Size([161290, 256])
torch.Size([142138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5847606658935547  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11796092987060547  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

torch.Size([165438, 128])
torch.Size([161061, 256])
torch.Size([141869, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5818614959716797  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11799240112304688  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

torch.Size([165621, 128])
torch.Size([161370, 256])
torch.Size([142155, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5834646224975586  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11792278289794922  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

torch.Size([165501, 128])
torch.Size([161221, 256])
torch.Size([142103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5824356079101562  GigaBytes
Max Memory Allocated: 1.7191386222839355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.134730726480484 |0.026042848825454712 |0.007280856370925903 |9.47117805480957e-05 |0.0041907429695129395 |0.002198457717895508 |
----------------------------------------------------------pseudo_mini_loss sum 3.2721190452575684
Total (block generation + training)time/epoch 33.65911388397217
Training time/epoch 1.5109896659851074
Training time without block to device /epoch 1.3026468753814697
Training time without total dataloading part /epoch 0.09472894668579102
load block tensor time/epoch 1.077845811843872
block to device time/epoch 0.2083427906036377
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4292650
Number of first layer input nodes during this epoch:  1324132
