Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648478758.7309012
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024599075317382812
random selection method range initialization spend 0.006109952926635742
time for parepare:  0.018469572067260742
local_output_nid generation:  0.016048192977905273
local_in_edges_tensor generation:  0.015629291534423828
mini_batch_src_global generation:  0.013872623443603516
r_  generation:  0.16886472702026367
local_output_nid generation:  0.021634817123413086
local_in_edges_tensor generation:  0.01587653160095215
mini_batch_src_global generation:  0.017322540283203125
r_  generation:  0.18053054809570312
----------------------check_connections_block total spend ----------------------------- 0.5460879802703857
generate_one_block  0.19815349578857422
generate_one_block  0.20233988761901855
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041066884994506836
gen group dst list time:  0.007500648498535156
time for parepare:  0.0191805362701416
local_output_nid generation:  0.025101661682128906
local_in_edges_tensor generation:  0.04936790466308594
mini_batch_src_global generation:  0.04538440704345703
r_  generation:  0.498751163482666
local_output_nid generation:  0.03184962272644043
local_in_edges_tensor generation:  0.047849416732788086
mini_batch_src_global generation:  0.056363821029663086
r_  generation:  0.5107276439666748
----------------------check_connections_block total spend ----------------------------- 1.5208210945129395
generate_one_block  0.6444070339202881
generate_one_block  0.6622939109802246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03078770637512207
gen group dst list time:  0.01173543930053711
time for parepare:  0.018746614456176758
local_output_nid generation:  0.030079126358032227
local_in_edges_tensor generation:  0.048470258712768555
mini_batch_src_global generation:  0.05355358123779297
r_  generation:  0.551354169845581
local_output_nid generation:  0.03733229637145996
local_in_edges_tensor generation:  0.05734992027282715
mini_batch_src_global generation:  0.06200814247131348
r_  generation:  0.5533900260925293
----------------------check_connections_block total spend ----------------------------- 1.6647663116455078
generate_one_block  0.724170446395874
generate_one_block  0.7125115394592285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02740001678466797
gen group dst list time:  0.012593984603881836
time for parepare:  0.018718481063842773
local_output_nid generation:  0.03161740303039551
local_in_edges_tensor generation:  0.04368948936462402
mini_batch_src_global generation:  0.04705476760864258
r_  generation:  0.5155048370361328
local_output_nid generation:  0.038062334060668945
local_in_edges_tensor generation:  0.04334235191345215
mini_batch_src_global generation:  0.057184696197509766
r_  generation:  0.527435302734375
----------------------check_connections_block total spend ----------------------------- 1.5678906440734863
generate_one_block  0.6474943161010742
generate_one_block  0.6572892665863037
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  4.753478050231934
block generation total time  4.048166513442993
average batch blocks generation time:  2.0240832567214966
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.11987686157226562  GigaBytes
Max Memory Allocated: 0.11987686157226562  GigaBytes

torch.Size([167419, 128])
torch.Size([166739, 64])
torch.Size([162933, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.6099233627319336  GigaBytes
Max Memory Allocated: 0.6367168426513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.12721586227416992  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

torch.Size([167419, 128])
torch.Size([166723, 64])
torch.Size([162969, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.6102328300476074  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03153026103973389 |0.16804516315460205 |0.3607974052429199 |0.00016796588897705078 |0.03297126293182373 |0.004716396331787109 |
----------------------------------------------------------pseudo_mini_loss sum 5.474349021911621
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1263241
Number of first layer input nodes during this epoch:  334838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.21308135986328125  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.026269197463989258
random selection method range initialization spend 0.006430149078369141
time for parepare:  0.01874518394470215
local_output_nid generation:  0.016187667846679688
local_in_edges_tensor generation:  0.014503955841064453
mini_batch_src_global generation:  0.01557159423828125
r_  generation:  0.17534971237182617
local_output_nid generation:  0.021628618240356445
local_in_edges_tensor generation:  0.015452146530151367
mini_batch_src_global generation:  0.016713380813598633
r_  generation:  0.20267534255981445
----------------------check_connections_block total spend ----------------------------- 0.5800344944000244
generate_one_block  0.2149207592010498
generate_one_block  0.2052454948425293
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0562891960144043
gen group dst list time:  0.007451057434082031
time for parepare:  0.02052617073059082
local_output_nid generation:  0.024714231491088867
local_in_edges_tensor generation:  0.06805658340454102
mini_batch_src_global generation:  0.04580831527709961
r_  generation:  0.5003187656402588
local_output_nid generation:  0.031600236892700195
local_in_edges_tensor generation:  0.05316162109375
mini_batch_src_global generation:  0.05636787414550781
r_  generation:  0.5115776062011719
----------------------check_connections_block total spend ----------------------------- 1.5480704307556152
generate_one_block  0.6505434513092041
generate_one_block  0.6765496730804443
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045754432678222656
gen group dst list time:  0.011948823928833008
time for parepare:  0.019233226776123047
local_output_nid generation:  0.030657052993774414
local_in_edges_tensor generation:  0.06376242637634277
mini_batch_src_global generation:  0.05391573905944824
r_  generation:  0.5476779937744141
local_output_nid generation:  0.038483381271362305
local_in_edges_tensor generation:  0.05820965766906738
mini_batch_src_global generation:  0.06116366386413574
r_  generation:  0.5607616901397705
----------------------check_connections_block total spend ----------------------------- 1.6914081573486328
generate_one_block  0.7486622333526611
generate_one_block  0.7227637767791748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.12096953392028809
gen group dst list time:  0.0171968936920166
time for parepare:  0.018878936767578125
local_output_nid generation:  0.03206920623779297
local_in_edges_tensor generation:  0.05536675453186035
mini_batch_src_global generation:  0.0478053092956543
r_  generation:  0.5440139770507812
local_output_nid generation:  0.03859901428222656
local_in_edges_tensor generation:  0.04422879219055176
mini_batch_src_global generation:  0.060555219650268555
r_  generation:  0.5258362293243408
----------------------check_connections_block total spend ----------------------------- 1.6137690544128418
generate_one_block  0.717771053314209
generate_one_block  0.6728167533874512
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.21308135986328125  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

connection checking time:  4.85324764251709
block generation total time  4.1891069412231445
average batch blocks generation time:  2.0945534706115723
block dataloader generation time/epoch 11.173399209976196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.12807941436767578  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

torch.Size([167425, 128])
torch.Size([166653, 64])
torch.Size([162814, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.6098637580871582  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.12841463088989258  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

torch.Size([167414, 128])
torch.Size([166666, 64])
torch.Size([162799, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.6097350120544434  GigaBytes
Max Memory Allocated: 0.6718592643737793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03255164623260498 |0.03802680969238281 |0.004974246025085449 |0.00010824203491210938 |0.03296196460723877 |0.003844022750854492 |
----------------------------------------------------------pseudo_mini_loss sum 4.387152194976807
Total (block generation + training)time/epoch 11.448797941207886
Training time/epoch 0.2751038074493408
Training time without block to device /epoch 0.1990501880645752
Training time without total dataloading part /epoch 0.07993292808532715
load block tensor time/epoch 0.06510329246520996
block to device time/epoch 0.07605361938476562
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1262670
Number of first layer input nodes during this epoch:  334839
