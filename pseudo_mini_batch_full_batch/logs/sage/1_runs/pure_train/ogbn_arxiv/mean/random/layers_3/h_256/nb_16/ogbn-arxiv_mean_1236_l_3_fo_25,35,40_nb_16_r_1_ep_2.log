Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443520.1536381
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024640321731567383
random selection method range initialization spend 0.006409168243408203
time for parepare:  0.018405437469482422
local_output_nid generation:  0.0021805763244628906
local_in_edges_tensor generation:  0.004620075225830078
mini_batch_src_global generation:  0.0016868114471435547
r_  generation:  0.017833709716796875
local_output_nid generation:  0.0025970935821533203
local_in_edges_tensor generation:  0.0017571449279785156
mini_batch_src_global generation:  0.0021872520446777344
r_  generation:  0.018189430236816406
local_output_nid generation:  0.002855062484741211
local_in_edges_tensor generation:  0.0016186237335205078
mini_batch_src_global generation:  0.001443624496459961
r_  generation:  0.018455028533935547
local_output_nid generation:  0.002825021743774414
local_in_edges_tensor generation:  0.00171661376953125
mini_batch_src_global generation:  0.0014581680297851562
r_  generation:  0.018891096115112305
local_output_nid generation:  0.003134012222290039
local_in_edges_tensor generation:  0.0016834735870361328
mini_batch_src_global generation:  0.014923334121704102
r_  generation:  0.018130064010620117
local_output_nid generation:  0.0031385421752929688
local_in_edges_tensor generation:  0.0016355514526367188
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.01891040802001953
local_output_nid generation:  0.0029921531677246094
local_in_edges_tensor generation:  0.001630544662475586
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.018451690673828125
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0015087127685546875
mini_batch_src_global generation:  0.0015022754669189453
r_  generation:  0.018546342849731445
local_output_nid generation:  0.002952098846435547
local_in_edges_tensor generation:  0.001550912857055664
mini_batch_src_global generation:  0.0014166831970214844
r_  generation:  0.018711090087890625
local_output_nid generation:  0.00289154052734375
local_in_edges_tensor generation:  0.0014801025390625
mini_batch_src_global generation:  0.001466989517211914
r_  generation:  0.018616914749145508
local_output_nid generation:  0.0028562545776367188
local_in_edges_tensor generation:  0.0015285015106201172
mini_batch_src_global generation:  0.0014505386352539062
r_  generation:  0.018674135208129883
local_output_nid generation:  0.0028715133666992188
local_in_edges_tensor generation:  0.0014805793762207031
mini_batch_src_global generation:  0.0014564990997314453
r_  generation:  0.018899202346801758
local_output_nid generation:  0.002879619598388672
local_in_edges_tensor generation:  0.001466989517211914
mini_batch_src_global generation:  0.0015811920166015625
r_  generation:  0.018864154815673828
local_output_nid generation:  0.002888917922973633
local_in_edges_tensor generation:  0.0015382766723632812
mini_batch_src_global generation:  0.0015659332275390625
r_  generation:  0.019084453582763672
local_output_nid generation:  0.00289154052734375
local_in_edges_tensor generation:  0.001531362533569336
mini_batch_src_global generation:  0.001531839370727539
r_  generation:  0.01903820037841797
local_output_nid generation:  0.002871274948120117
local_in_edges_tensor generation:  0.001514434814453125
mini_batch_src_global generation:  0.0015578269958496094
r_  generation:  0.018761634826660156
----------------------check_connections_block total spend ----------------------------- 0.5169508457183838
generate_one_block  0.027254819869995117
generate_one_block  0.027954816818237305
generate_one_block  0.03114938735961914
generate_one_block  0.02799224853515625
generate_one_block  0.02672743797302246
generate_one_block  0.027880430221557617
generate_one_block  0.027385950088500977
generate_one_block  0.026860475540161133
generate_one_block  0.027457475662231445
generate_one_block  0.02734231948852539
generate_one_block  0.027080059051513672
generate_one_block  0.027965545654296875
generate_one_block  0.02742290496826172
generate_one_block  0.02738642692565918
generate_one_block  0.027524709701538086
generate_one_block  0.027041196823120117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038533687591552734
gen group dst list time:  0.018713951110839844
time for parepare:  0.018909931182861328
local_output_nid generation:  0.008100032806396484
local_in_edges_tensor generation:  0.017009496688842773
mini_batch_src_global generation:  0.018709659576416016
r_  generation:  0.19074130058288574
local_output_nid generation:  0.01212167739868164
local_in_edges_tensor generation:  0.019400358200073242
mini_batch_src_global generation:  0.024323463439941406
r_  generation:  0.19906902313232422
local_output_nid generation:  0.01201772689819336
local_in_edges_tensor generation:  0.018030881881713867
mini_batch_src_global generation:  0.02528095245361328
r_  generation:  0.20461368560791016
local_output_nid generation:  0.011789560317993164
local_in_edges_tensor generation:  0.012669563293457031
mini_batch_src_global generation:  0.02441573143005371
r_  generation:  0.20215487480163574
local_output_nid generation:  0.011753320693969727
local_in_edges_tensor generation:  0.012156009674072266
mini_batch_src_global generation:  0.024904966354370117
r_  generation:  0.202406644821167
local_output_nid generation:  0.011903524398803711
local_in_edges_tensor generation:  0.01734185218811035
mini_batch_src_global generation:  0.025522947311401367
r_  generation:  0.21152853965759277
local_output_nid generation:  0.011685371398925781
local_in_edges_tensor generation:  0.015844345092773438
mini_batch_src_global generation:  0.0253143310546875
r_  generation:  0.20460987091064453
local_output_nid generation:  0.01174783706665039
local_in_edges_tensor generation:  0.013817548751831055
mini_batch_src_global generation:  0.024997711181640625
r_  generation:  0.20322513580322266
local_output_nid generation:  0.011732816696166992
local_in_edges_tensor generation:  0.014290332794189453
mini_batch_src_global generation:  0.027551651000976562
r_  generation:  0.2106950283050537
local_output_nid generation:  0.011708498001098633
local_in_edges_tensor generation:  0.013852834701538086
mini_batch_src_global generation:  0.025904178619384766
r_  generation:  0.20783281326293945
local_output_nid generation:  0.011756420135498047
local_in_edges_tensor generation:  0.012194156646728516
mini_batch_src_global generation:  0.025658369064331055
r_  generation:  0.20619606971740723
local_output_nid generation:  0.012052059173583984
local_in_edges_tensor generation:  0.014057397842407227
mini_batch_src_global generation:  0.026330947875976562
r_  generation:  0.21026158332824707
local_output_nid generation:  0.011857271194458008
local_in_edges_tensor generation:  0.01567840576171875
mini_batch_src_global generation:  0.02618241310119629
r_  generation:  0.20887398719787598
local_output_nid generation:  0.011868953704833984
local_in_edges_tensor generation:  0.01219487190246582
mini_batch_src_global generation:  0.02587604522705078
r_  generation:  0.2081441879272461
local_output_nid generation:  0.011866331100463867
local_in_edges_tensor generation:  0.014285802841186523
mini_batch_src_global generation:  0.027448415756225586
r_  generation:  0.21027708053588867
local_output_nid generation:  0.011757373809814453
local_in_edges_tensor generation:  0.012527704238891602
mini_batch_src_global generation:  0.026084184646606445
r_  generation:  0.2061905860900879
----------------------check_connections_block total spend ----------------------------- 4.865023612976074
generate_one_block  0.274139404296875
generate_one_block  0.2713582515716553
generate_one_block  0.2801942825317383
generate_one_block  0.26621150970458984
generate_one_block  0.27689528465270996
generate_one_block  0.2737300395965576
generate_one_block  0.2646632194519043
generate_one_block  0.26236748695373535
generate_one_block  0.2719552516937256
generate_one_block  0.2708475589752197
generate_one_block  0.26921606063842773
generate_one_block  0.27068281173706055
generate_one_block  0.27094197273254395
generate_one_block  0.2666752338409424
generate_one_block  0.2748692035675049
generate_one_block  0.26322484016418457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03676271438598633
gen group dst list time:  0.05841374397277832
time for parepare:  0.019018888473510742
local_output_nid generation:  0.025290966033935547
local_in_edges_tensor generation:  0.04640507698059082
mini_batch_src_global generation:  0.041455745697021484
r_  generation:  0.4318089485168457
local_output_nid generation:  0.030936241149902344
local_in_edges_tensor generation:  0.048195838928222656
mini_batch_src_global generation:  0.05085921287536621
r_  generation:  0.4428670406341553
local_output_nid generation:  0.030377864837646484
local_in_edges_tensor generation:  0.040398597717285156
mini_batch_src_global generation:  0.05008816719055176
r_  generation:  0.44602060317993164
local_output_nid generation:  0.0309445858001709
local_in_edges_tensor generation:  0.0368959903717041
mini_batch_src_global generation:  0.0528261661529541
r_  generation:  0.4526848793029785
local_output_nid generation:  0.030034780502319336
local_in_edges_tensor generation:  0.03195643424987793
mini_batch_src_global generation:  0.051680803298950195
r_  generation:  0.44862961769104004
local_output_nid generation:  0.030379533767700195
local_in_edges_tensor generation:  0.03577899932861328
mini_batch_src_global generation:  0.052300214767456055
r_  generation:  0.4553098678588867
local_output_nid generation:  0.030393362045288086
local_in_edges_tensor generation:  0.04101276397705078
mini_batch_src_global generation:  0.05186915397644043
r_  generation:  0.45552849769592285
local_output_nid generation:  0.030295848846435547
local_in_edges_tensor generation:  0.03320741653442383
mini_batch_src_global generation:  0.05236697196960449
r_  generation:  0.44896817207336426
local_output_nid generation:  0.030243635177612305
local_in_edges_tensor generation:  0.03206634521484375
mini_batch_src_global generation:  0.05185890197753906
r_  generation:  0.4536144733428955
local_output_nid generation:  0.030292510986328125
local_in_edges_tensor generation:  0.0402987003326416
mini_batch_src_global generation:  0.05285167694091797
r_  generation:  0.4558091163635254
local_output_nid generation:  0.030238628387451172
local_in_edges_tensor generation:  0.03650712966918945
mini_batch_src_global generation:  0.05187845230102539
r_  generation:  0.45459461212158203
local_output_nid generation:  0.030498743057250977
local_in_edges_tensor generation:  0.04378628730773926
mini_batch_src_global generation:  0.05199313163757324
r_  generation:  0.4528377056121826
local_output_nid generation:  0.030559778213500977
local_in_edges_tensor generation:  0.03300786018371582
mini_batch_src_global generation:  0.051747798919677734
r_  generation:  0.4592101573944092
local_output_nid generation:  0.030155181884765625
local_in_edges_tensor generation:  0.03232550621032715
mini_batch_src_global generation:  0.052445411682128906
r_  generation:  0.44981837272644043
local_output_nid generation:  0.030405521392822266
local_in_edges_tensor generation:  0.03625655174255371
mini_batch_src_global generation:  0.05190324783325195
r_  generation:  0.45700812339782715
local_output_nid generation:  0.030556201934814453
local_in_edges_tensor generation:  0.032579898834228516
mini_batch_src_global generation:  0.05361223220825195
r_  generation:  0.454204797744751
----------------------check_connections_block total spend ----------------------------- 10.691009998321533
generate_one_block  0.573850154876709
generate_one_block  0.5862584114074707
generate_one_block  0.5827505588531494
generate_one_block  0.5743231773376465
generate_one_block  0.5660099983215332
generate_one_block  0.5793561935424805
generate_one_block  0.6166870594024658
generate_one_block  0.5613062381744385
generate_one_block  0.5852985382080078
generate_one_block  0.5804486274719238
generate_one_block  0.571631908416748
generate_one_block  0.5837192535400391
generate_one_block  0.579695463180542
generate_one_block  0.5745172500610352
generate_one_block  0.5639359951019287
generate_one_block  0.5690796375274658
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  15.556033611297607
block generation total time  13.576840877532959
average batch blocks generation time:  0.8485525548458099
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0906672477722168  GigaBytes
Max Memory Allocated: 0.0906672477722168  GigaBytes

torch.Size([154170, 128])
torch.Size([122188, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.7160234451293945  GigaBytes
Max Memory Allocated: 0.7534122467041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.0918736457824707  GigaBytes
Max Memory Allocated: 0.7948293685913086  GigaBytes

torch.Size([154721, 128])
torch.Size([122764, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.7172369956970215  GigaBytes
Max Memory Allocated: 0.7948293685913086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.0924978256225586  GigaBytes
Max Memory Allocated: 0.7963113784790039  GigaBytes

torch.Size([154881, 128])
torch.Size([123361, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 0.7238750457763672  GigaBytes
Max Memory Allocated: 0.7963113784790039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09186744689941406  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154786, 128])
torch.Size([122688, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7165288925170898  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09212779998779297  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154333, 128])
torch.Size([121825, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7101101875305176  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09195518493652344  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154778, 128])
torch.Size([122555, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.716611385345459  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09218883514404297  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154732, 128])
torch.Size([122708, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7149991989135742  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09161663055419922  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154558, 128])
torch.Size([122189, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7136077880859375  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09230422973632812  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([153997, 128])
torch.Size([121796, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7125453948974609  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09176111221313477  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154537, 128])
torch.Size([122442, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7157783508300781  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09222221374511719  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154639, 128])
torch.Size([122462, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7148890495300293  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09201622009277344  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154958, 128])
torch.Size([123410, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7234916687011719  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0923147201538086  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154531, 128])
torch.Size([122634, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7162933349609375  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09177827835083008  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154645, 128])
torch.Size([122237, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7166132926940918  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09228038787841797  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154411, 128])
torch.Size([122206, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7160110473632812  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09152841567993164  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154343, 128])
torch.Size([121888, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7126717567443848  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055836692452430725 |0.0372534841299057 |0.05095934867858887 |9.414553642272949e-05 |0.010699376463890076 |0.0024039745330810547 |
----------------------------------------------------------pseudo_mini_loss sum 6.254767417907715
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5093559
Number of first layer input nodes during this epoch:  2473020
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11475467681884766  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02576160430908203
random selection method range initialization spend 0.0071065425872802734
time for parepare:  0.018352985382080078
local_output_nid generation:  0.0023818016052246094
local_in_edges_tensor generation:  0.00867605209350586
mini_batch_src_global generation:  0.002057313919067383
r_  generation:  0.019255399703979492
local_output_nid generation:  0.0029556751251220703
local_in_edges_tensor generation:  0.0016574859619140625
mini_batch_src_global generation:  0.0024247169494628906
r_  generation:  0.020209312438964844
local_output_nid generation:  0.0030450820922851562
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.0016558170318603516
r_  generation:  0.020351171493530273
local_output_nid generation:  0.002988100051879883
local_in_edges_tensor generation:  0.0014820098876953125
mini_batch_src_global generation:  0.0017273426055908203
r_  generation:  0.020071029663085938
local_output_nid generation:  0.0029048919677734375
local_in_edges_tensor generation:  0.00144195556640625
mini_batch_src_global generation:  0.0016858577728271484
r_  generation:  0.02060675621032715
local_output_nid generation:  0.002927064895629883
local_in_edges_tensor generation:  0.0014536380767822266
mini_batch_src_global generation:  0.0018210411071777344
r_  generation:  0.027924299240112305
local_output_nid generation:  0.002938985824584961
local_in_edges_tensor generation:  0.001477956771850586
mini_batch_src_global generation:  0.001476287841796875
r_  generation:  0.019273996353149414
local_output_nid generation:  0.0029144287109375
local_in_edges_tensor generation:  0.0014350414276123047
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.02030158042907715
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0014216899871826172
mini_batch_src_global generation:  0.0015325546264648438
r_  generation:  0.019409894943237305
local_output_nid generation:  0.0029506683349609375
local_in_edges_tensor generation:  0.001363992691040039
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.019385099411010742
local_output_nid generation:  0.002919435501098633
local_in_edges_tensor generation:  0.001394033432006836
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.01912379264831543
local_output_nid generation:  0.002905130386352539
local_in_edges_tensor generation:  0.0013973712921142578
mini_batch_src_global generation:  0.0015666484832763672
r_  generation:  0.019099950790405273
local_output_nid generation:  0.0028662681579589844
local_in_edges_tensor generation:  0.0014276504516601562
mini_batch_src_global generation:  0.0015676021575927734
r_  generation:  0.019486665725708008
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.001394033432006836
mini_batch_src_global generation:  0.0015752315521240234
r_  generation:  0.019481658935546875
local_output_nid generation:  0.0029256343841552734
local_in_edges_tensor generation:  0.0014028549194335938
mini_batch_src_global generation:  0.0016045570373535156
r_  generation:  0.018992900848388672
local_output_nid generation:  0.002959728240966797
local_in_edges_tensor generation:  0.0014302730560302734
mini_batch_src_global generation:  0.001592874526977539
r_  generation:  0.019003868103027344
----------------------check_connections_block total spend ----------------------------- 0.5336720943450928
generate_one_block  0.031166791915893555
generate_one_block  0.028598308563232422
generate_one_block  0.027817249298095703
generate_one_block  0.027681350708007812
generate_one_block  0.028245925903320312
generate_one_block  0.030390024185180664
generate_one_block  0.027873516082763672
generate_one_block  0.027428627014160156
generate_one_block  0.028020858764648438
generate_one_block  0.027454853057861328
generate_one_block  0.027204275131225586
generate_one_block  0.027939796447753906
generate_one_block  0.028355121612548828
generate_one_block  0.02799224853515625
generate_one_block  0.027246713638305664
generate_one_block  0.027762174606323242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03909182548522949
gen group dst list time:  0.01727890968322754
time for parepare:  0.018702268600463867
local_output_nid generation:  0.00821375846862793
local_in_edges_tensor generation:  0.020739316940307617
mini_batch_src_global generation:  0.020196914672851562
r_  generation:  0.191788911819458
local_output_nid generation:  0.012018918991088867
local_in_edges_tensor generation:  0.019259929656982422
mini_batch_src_global generation:  0.024498939514160156
r_  generation:  0.20415115356445312
local_output_nid generation:  0.011961221694946289
local_in_edges_tensor generation:  0.016224145889282227
mini_batch_src_global generation:  0.026947975158691406
r_  generation:  0.2056417465209961
local_output_nid generation:  0.012393951416015625
local_in_edges_tensor generation:  0.01411890983581543
mini_batch_src_global generation:  0.02543330192565918
r_  generation:  0.2075510025024414
local_output_nid generation:  0.012400388717651367
local_in_edges_tensor generation:  0.0159299373626709
mini_batch_src_global generation:  0.0300595760345459
r_  generation:  0.21039533615112305
local_output_nid generation:  0.011949300765991211
local_in_edges_tensor generation:  0.012535810470581055
mini_batch_src_global generation:  0.02574753761291504
r_  generation:  0.2281503677368164
local_output_nid generation:  0.01334381103515625
local_in_edges_tensor generation:  0.015358924865722656
mini_batch_src_global generation:  0.03932690620422363
r_  generation:  0.2110588550567627
local_output_nid generation:  0.013338088989257812
local_in_edges_tensor generation:  0.02727198600769043
mini_batch_src_global generation:  0.026990413665771484
r_  generation:  0.20519208908081055
local_output_nid generation:  0.012119770050048828
local_in_edges_tensor generation:  0.01704883575439453
mini_batch_src_global generation:  0.028118371963500977
r_  generation:  0.21147894859313965
local_output_nid generation:  0.012327194213867188
local_in_edges_tensor generation:  0.01215672492980957
mini_batch_src_global generation:  0.025981426239013672
r_  generation:  0.20917606353759766
local_output_nid generation:  0.012360811233520508
local_in_edges_tensor generation:  0.011742830276489258
mini_batch_src_global generation:  0.026120424270629883
r_  generation:  0.20913290977478027
local_output_nid generation:  0.012356758117675781
local_in_edges_tensor generation:  0.011767148971557617
mini_batch_src_global generation:  0.026427030563354492
r_  generation:  0.2255234718322754
local_output_nid generation:  0.012313604354858398
local_in_edges_tensor generation:  0.01545405387878418
mini_batch_src_global generation:  0.02841663360595703
r_  generation:  0.21452713012695312
local_output_nid generation:  0.012412309646606445
local_in_edges_tensor generation:  0.015481948852539062
mini_batch_src_global generation:  0.026868820190429688
r_  generation:  0.21556711196899414
local_output_nid generation:  0.012182950973510742
local_in_edges_tensor generation:  0.012142181396484375
mini_batch_src_global generation:  0.026486635208129883
r_  generation:  0.20578694343566895
local_output_nid generation:  0.012160778045654297
local_in_edges_tensor generation:  0.012716054916381836
mini_batch_src_global generation:  0.026143789291381836
r_  generation:  0.20765042304992676
----------------------check_connections_block total spend ----------------------------- 5.0038628578186035
generate_one_block  0.28945016860961914
generate_one_block  0.28574585914611816
generate_one_block  0.2738990783691406
generate_one_block  0.27161335945129395
generate_one_block  0.2705371379852295
generate_one_block  0.26848626136779785
generate_one_block  0.29656553268432617
generate_one_block  0.2619624137878418
generate_one_block  0.26740479469299316
generate_one_block  0.2681884765625
generate_one_block  0.2641632556915283
generate_one_block  0.27161645889282227
generate_one_block  0.2741200923919678
generate_one_block  0.28406286239624023
generate_one_block  0.260164737701416
generate_one_block  0.26018357276916504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10491132736206055
gen group dst list time:  0.06917691230773926
time for parepare:  0.017662763595581055
local_output_nid generation:  0.025570154190063477
local_in_edges_tensor generation:  0.052393198013305664
mini_batch_src_global generation:  0.041133880615234375
r_  generation:  0.43450140953063965
local_output_nid generation:  0.031071901321411133
local_in_edges_tensor generation:  0.04621767997741699
mini_batch_src_global generation:  0.050995588302612305
r_  generation:  0.44175243377685547
local_output_nid generation:  0.03075242042541504
local_in_edges_tensor generation:  0.03504180908203125
mini_batch_src_global generation:  0.05016207695007324
r_  generation:  0.4536442756652832
local_output_nid generation:  0.030368804931640625
local_in_edges_tensor generation:  0.0342564582824707
mini_batch_src_global generation:  0.051604509353637695
r_  generation:  0.44739794731140137
local_output_nid generation:  0.031032085418701172
local_in_edges_tensor generation:  0.08043551445007324
mini_batch_src_global generation:  0.05428457260131836
r_  generation:  0.45580077171325684
local_output_nid generation:  0.03091716766357422
local_in_edges_tensor generation:  0.03078937530517578
mini_batch_src_global generation:  0.05237722396850586
r_  generation:  0.45292091369628906
local_output_nid generation:  0.0310366153717041
local_in_edges_tensor generation:  0.03228044509887695
mini_batch_src_global generation:  0.05197572708129883
r_  generation:  0.45358967781066895
local_output_nid generation:  0.03072500228881836
local_in_edges_tensor generation:  0.03007221221923828
mini_batch_src_global generation:  0.05203890800476074
r_  generation:  0.4498708248138428
local_output_nid generation:  0.030916452407836914
local_in_edges_tensor generation:  0.03593754768371582
mini_batch_src_global generation:  0.05165553092956543
r_  generation:  0.4599781036376953
local_output_nid generation:  0.03099346160888672
local_in_edges_tensor generation:  0.03845024108886719
mini_batch_src_global generation:  0.05204629898071289
r_  generation:  0.44651269912719727
local_output_nid generation:  0.030631542205810547
local_in_edges_tensor generation:  0.0382997989654541
mini_batch_src_global generation:  0.05221867561340332
r_  generation:  0.45670533180236816
local_output_nid generation:  0.03059077262878418
local_in_edges_tensor generation:  0.030826807022094727
mini_batch_src_global generation:  0.05213785171508789
r_  generation:  0.449108362197876
local_output_nid generation:  0.03093695640563965
local_in_edges_tensor generation:  0.038425445556640625
mini_batch_src_global generation:  0.051781415939331055
r_  generation:  0.4631662368774414
local_output_nid generation:  0.03173041343688965
local_in_edges_tensor generation:  0.03869962692260742
mini_batch_src_global generation:  0.05276370048522949
r_  generation:  0.4567141532897949
local_output_nid generation:  0.030864238739013672
local_in_edges_tensor generation:  0.03411436080932617
mini_batch_src_global generation:  0.05199575424194336
r_  generation:  0.4636108875274658
local_output_nid generation:  0.03111410140991211
local_in_edges_tensor generation:  0.03331422805786133
mini_batch_src_global generation:  0.05213761329650879
r_  generation:  0.45113039016723633
----------------------check_connections_block total spend ----------------------------- 10.746907949447632
generate_one_block  0.5721735954284668
generate_one_block  0.5859549045562744
generate_one_block  0.5728809833526611
generate_one_block  0.5733077526092529
generate_one_block  0.5917465686798096
generate_one_block  0.5740466117858887
generate_one_block  0.575361967086792
generate_one_block  0.5702865123748779
generate_one_block  0.6105012893676758
generate_one_block  0.5768520832061768
generate_one_block  0.5745015144348145
generate_one_block  0.5821192264556885
generate_one_block  0.6136894226074219
generate_one_block  0.6267175674438477
generate_one_block  0.5804901123046875
generate_one_block  0.5827147960662842
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11475467681884766  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

connection checking time:  15.750770807266235
block generation total time  13.73150897026062
average batch blocks generation time:  0.8582193106412888
block dataloader generation time/epoch 31.812559366226196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09393453598022461  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154727, 128])
torch.Size([122843, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.718480110168457  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09356927871704102  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

torch.Size([154697, 128])
torch.Size([123196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7246270179748535  GigaBytes
Max Memory Allocated: 0.8049201965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09398937225341797  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154646, 128])
torch.Size([122549, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7195277214050293  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09341049194335938  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154472, 128])
torch.Size([122487, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.718818187713623  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0940237045288086  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([155021, 128])
torch.Size([123305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7215962409973145  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09345436096191406  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154734, 128])
torch.Size([123005, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7174797058105469  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0938711166381836  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154432, 128])
torch.Size([122030, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7171430587768555  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09306764602661133  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154243, 128])
torch.Size([121729, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7109522819519043  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09394454956054688  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154784, 128])
torch.Size([122854, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7186017036437988  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09328556060791016  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154324, 128])
torch.Size([122573, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7175273895263672  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09382820129394531  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154499, 128])
torch.Size([122414, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.716890811920166  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09337759017944336  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154609, 128])
torch.Size([122079, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7175693511962891  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.0939779281616211  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154506, 128])
torch.Size([122976, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7200703620910645  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09352779388427734  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154486, 128])
torch.Size([123280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7214179039001465  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09377861022949219  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154693, 128])
torch.Size([122210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7155194282531738  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09325647354125977  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

torch.Size([154669, 128])
torch.Size([122047, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7156453132629395  GigaBytes
Max Memory Allocated: 0.8056349754333496  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06051082909107208 |0.014112353324890137 |0.0039972662925720215 |0.00010009109973907471 |0.003678634762763977 |0.0022592544555664062 |
----------------------------------------------------------pseudo_mini_loss sum 3.2386934757232666
Total (block generation + training)time/epoch 33.192875385284424
Training time/epoch 1.3800511360168457
Training time without block to device /epoch 1.1542534828186035
Training time without total dataloading part /epoch 0.12667512893676758
load block tensor time/epoch 0.9681732654571533
block to device time/epoch 0.2257976531982422
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5097417
Number of first layer input nodes during this epoch:  2473542
