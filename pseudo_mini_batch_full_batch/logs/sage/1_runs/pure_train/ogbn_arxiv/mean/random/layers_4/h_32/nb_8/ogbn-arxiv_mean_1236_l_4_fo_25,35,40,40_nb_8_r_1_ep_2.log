Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648477987.5944474
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02374863624572754
random selection method range initialization spend 0.006178379058837891
time for parepare:  0.019162416458129883
local_output_nid generation:  0.004210710525512695
local_in_edges_tensor generation:  0.005038022994995117
mini_batch_src_global generation:  0.003286600112915039
r_  generation:  0.03803229331970215
local_output_nid generation:  0.0060083866119384766
local_in_edges_tensor generation:  0.0031685829162597656
mini_batch_src_global generation:  0.004166364669799805
r_  generation:  0.03879261016845703
local_output_nid generation:  0.006139278411865234
local_in_edges_tensor generation:  0.003216981887817383
mini_batch_src_global generation:  0.0028238296508789062
r_  generation:  0.040044546127319336
local_output_nid generation:  0.0061495304107666016
local_in_edges_tensor generation:  0.0031630992889404297
mini_batch_src_global generation:  0.0029718875885009766
r_  generation:  0.04072070121765137
local_output_nid generation:  0.006110191345214844
local_in_edges_tensor generation:  0.0032243728637695312
mini_batch_src_global generation:  0.0030829906463623047
r_  generation:  0.04187917709350586
local_output_nid generation:  0.006206989288330078
local_in_edges_tensor generation:  0.003106832504272461
mini_batch_src_global generation:  0.0033609867095947266
r_  generation:  0.041708946228027344
local_output_nid generation:  0.0061435699462890625
local_in_edges_tensor generation:  0.003153562545776367
mini_batch_src_global generation:  0.003269195556640625
r_  generation:  0.041460275650024414
local_output_nid generation:  0.006070137023925781
local_in_edges_tensor generation:  0.0031599998474121094
mini_batch_src_global generation:  0.0033621788024902344
r_  generation:  0.04260110855102539
----------------------check_connections_block total spend ----------------------------- 0.5231642723083496
generate_one_block  0.05420637130737305
generate_one_block  0.05516195297241211
generate_one_block  0.05908393859863281
generate_one_block  0.05913996696472168
generate_one_block  0.058539390563964844
generate_one_block  0.05556774139404297
generate_one_block  0.05460357666015625
generate_one_block  0.055742502212524414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04008078575134277
gen group dst list time:  0.015343904495239258
time for parepare:  0.019396066665649414
local_output_nid generation:  0.013364791870117188
local_in_edges_tensor generation:  0.028867721557617188
mini_batch_src_global generation:  0.030266523361206055
r_  generation:  0.2965676784515381
local_output_nid generation:  0.0202634334564209
local_in_edges_tensor generation:  0.028426647186279297
mini_batch_src_global generation:  0.036524057388305664
r_  generation:  0.3043386936187744
local_output_nid generation:  0.020140886306762695
local_in_edges_tensor generation:  0.02326679229736328
mini_batch_src_global generation:  0.036193132400512695
r_  generation:  0.3116593360900879
local_output_nid generation:  0.01999068260192871
local_in_edges_tensor generation:  0.023565292358398438
mini_batch_src_global generation:  0.037190914154052734
r_  generation:  0.32243871688842773
local_output_nid generation:  0.020102262496948242
local_in_edges_tensor generation:  0.02064990997314453
mini_batch_src_global generation:  0.03819775581359863
r_  generation:  0.315565824508667
local_output_nid generation:  0.02006840705871582
local_in_edges_tensor generation:  0.020369291305541992
mini_batch_src_global generation:  0.04080963134765625
r_  generation:  0.31829118728637695
local_output_nid generation:  0.020222902297973633
local_in_edges_tensor generation:  0.020329713821411133
mini_batch_src_global generation:  0.03822064399719238
r_  generation:  0.3199021816253662
local_output_nid generation:  0.020307540893554688
local_in_edges_tensor generation:  0.02039480209350586
mini_batch_src_global generation:  0.04051947593688965
r_  generation:  0.3250732421875
----------------------check_connections_block total spend ----------------------------- 3.7027199268341064
generate_one_block  0.40374255180358887
generate_one_block  0.3959534168243408
generate_one_block  0.4103109836578369
generate_one_block  0.40663957595825195
generate_one_block  0.4030885696411133
generate_one_block  0.4254417419433594
generate_one_block  0.3979072570800781
generate_one_block  0.41374683380126953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03259158134460449
gen group dst list time:  0.03569936752319336
time for parepare:  0.019197702407836914
local_output_nid generation:  0.028644323348999023
local_in_edges_tensor generation:  0.04440927505493164
mini_batch_src_global generation:  0.05115795135498047
r_  generation:  0.505866527557373
local_output_nid generation:  0.03734326362609863
local_in_edges_tensor generation:  0.052498579025268555
mini_batch_src_global generation:  0.058649301528930664
r_  generation:  0.509080171585083
local_output_nid generation:  0.03818511962890625
local_in_edges_tensor generation:  0.04333758354187012
mini_batch_src_global generation:  0.05486106872558594
r_  generation:  0.5242764949798584
local_output_nid generation:  0.03757452964782715
local_in_edges_tensor generation:  0.0388028621673584
mini_batch_src_global generation:  0.05887770652770996
r_  generation:  0.521812915802002
local_output_nid generation:  0.0377497673034668
local_in_edges_tensor generation:  0.03821134567260742
mini_batch_src_global generation:  0.05718278884887695
r_  generation:  0.5324018001556396
local_output_nid generation:  0.037822723388671875
local_in_edges_tensor generation:  0.043170928955078125
mini_batch_src_global generation:  0.05916309356689453
r_  generation:  0.5232772827148438
local_output_nid generation:  0.0375056266784668
local_in_edges_tensor generation:  0.037957191467285156
mini_batch_src_global generation:  0.061852455139160156
r_  generation:  0.5452072620391846
local_output_nid generation:  0.03760099411010742
local_in_edges_tensor generation:  0.03431296348571777
mini_batch_src_global generation:  0.05975818634033203
r_  generation:  0.5208134651184082
----------------------check_connections_block total spend ----------------------------- 6.1955060958862305
generate_one_block  0.6734716892242432
generate_one_block  0.6703801155090332
generate_one_block  0.6695854663848877
generate_one_block  0.667804479598999
generate_one_block  0.6594521999359131
generate_one_block  0.661196231842041
generate_one_block  0.6912927627563477
generate_one_block  0.646376371383667
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03691720962524414
gen group dst list time:  0.0507962703704834
time for parepare:  0.019702672958374023
local_output_nid generation:  0.035387277603149414
local_in_edges_tensor generation:  0.06979799270629883
mini_batch_src_global generation:  0.04980158805847168
r_  generation:  0.4952263832092285
local_output_nid generation:  0.039009809494018555
local_in_edges_tensor generation:  0.0529937744140625
mini_batch_src_global generation:  0.06615781784057617
r_  generation:  0.5024709701538086
local_output_nid generation:  0.04084348678588867
local_in_edges_tensor generation:  0.044075727462768555
mini_batch_src_global generation:  0.06013822555541992
r_  generation:  0.5015044212341309
local_output_nid generation:  0.039777517318725586
local_in_edges_tensor generation:  0.03950238227844238
mini_batch_src_global generation:  0.05470776557922363
r_  generation:  0.514070987701416
local_output_nid generation:  0.0397951602935791
local_in_edges_tensor generation:  0.04047656059265137
mini_batch_src_global generation:  0.054683685302734375
r_  generation:  0.5116531848907471
local_output_nid generation:  0.039757490158081055
local_in_edges_tensor generation:  0.04439067840576172
mini_batch_src_global generation:  0.054559946060180664
r_  generation:  0.5144751071929932
local_output_nid generation:  0.03986001014709473
local_in_edges_tensor generation:  0.0355372428894043
mini_batch_src_global generation:  0.054680824279785156
r_  generation:  0.5186538696289062
local_output_nid generation:  0.039752960205078125
local_in_edges_tensor generation:  0.04338479042053223
mini_batch_src_global generation:  0.055498361587524414
r_  generation:  0.5192673206329346
----------------------check_connections_block total spend ----------------------------- 6.175105333328247
generate_one_block  0.6283910274505615
generate_one_block  0.6326761245727539
generate_one_block  0.6352348327636719
generate_one_block  0.6373388767242432
generate_one_block  0.6341688632965088
generate_one_block  0.6391470432281494
generate_one_block  0.6777060031890869
generate_one_block  0.621978759765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

connection checking time:  16.073331356048584
block generation total time  13.703031778335571
average batch blocks generation time:  1.7128789722919464
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11096763610839844  GigaBytes
Max Memory Allocated: 0.11096763610839844  GigaBytes

torch.Size([165447, 128])
torch.Size([161204, 32])
torch.Size([141865, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.32228660583496094  GigaBytes
Max Memory Allocated: 0.3246884346008301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1127161979675293  GigaBytes
Max Memory Allocated: 0.3363504409790039  GigaBytes

torch.Size([165477, 128])
torch.Size([161056, 32])
torch.Size([141763, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3217148780822754  GigaBytes
Max Memory Allocated: 0.3363504409790039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11345481872558594  GigaBytes
Max Memory Allocated: 0.3363504409790039  GigaBytes

torch.Size([165554, 128])
torch.Size([161361, 32])
torch.Size([142367, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32343053817749023  GigaBytes
Max Memory Allocated: 0.3363504409790039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1136322021484375  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165415, 128])
torch.Size([161118, 32])
torch.Size([142025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.323519229888916  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1136937141418457  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165595, 128])
torch.Size([161319, 32])
torch.Size([142119, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3234243392944336  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11373758316040039  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165510, 128])
torch.Size([161162, 32])
torch.Size([141961, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3236808776855469  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1137242317199707  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165595, 128])
torch.Size([161383, 32])
torch.Size([142231, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3234701156616211  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11370849609375  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165463, 128])
torch.Size([160973, 32])
torch.Size([141869, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.323699951171875  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039561301469802856 |0.06452655792236328 |0.09359139204025269 |0.00010630488395690918 |0.021593302488327026 |0.0028324127197265625 |
----------------------------------------------------------pseudo_mini_loss sum 5.139166831970215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292494
Number of first layer input nodes during this epoch:  1324056
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.18273258209228516  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.01939702033996582
random selection method range initialization spend 0.006453037261962891
time for parepare:  0.019329071044921875
local_output_nid generation:  0.005566120147705078
local_in_edges_tensor generation:  0.011532068252563477
mini_batch_src_global generation:  0.004225015640258789
r_  generation:  0.03729128837585449
local_output_nid generation:  0.006965160369873047
local_in_edges_tensor generation:  0.0038437843322753906
mini_batch_src_global generation:  0.004255771636962891
r_  generation:  0.039275407791137695
local_output_nid generation:  0.007286548614501953
local_in_edges_tensor generation:  0.003920078277587891
mini_batch_src_global generation:  0.0028905868530273438
r_  generation:  0.039218902587890625
local_output_nid generation:  0.0072972774505615234
local_in_edges_tensor generation:  0.003949880599975586
mini_batch_src_global generation:  0.003094196319580078
r_  generation:  0.04098963737487793
local_output_nid generation:  0.007262229919433594
local_in_edges_tensor generation:  0.004006385803222656
mini_batch_src_global generation:  0.003315448760986328
r_  generation:  0.04163956642150879
local_output_nid generation:  0.00732874870300293
local_in_edges_tensor generation:  0.004143714904785156
mini_batch_src_global generation:  0.003485441207885742
r_  generation:  0.04160475730895996
local_output_nid generation:  0.00726318359375
local_in_edges_tensor generation:  0.004163980484008789
mini_batch_src_global generation:  0.0035381317138671875
r_  generation:  0.04111838340759277
local_output_nid generation:  0.007314920425415039
local_in_edges_tensor generation:  0.004096031188964844
mini_batch_src_global generation:  0.0034716129302978516
r_  generation:  0.042188405990600586
----------------------check_connections_block total spend ----------------------------- 0.5493719577789307
generate_one_block  0.06705307960510254
generate_one_block  0.0577387809753418
generate_one_block  0.05544757843017578
generate_one_block  0.05519509315490723
generate_one_block  0.055098533630371094
generate_one_block  0.05538773536682129
generate_one_block  0.05981278419494629
generate_one_block  0.05692625045776367
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04043984413146973
gen group dst list time:  0.014771223068237305
time for parepare:  0.019997835159301758
local_output_nid generation:  0.01419520378112793
local_in_edges_tensor generation:  0.03514361381530762
mini_batch_src_global generation:  0.030803918838500977
r_  generation:  0.30101466178894043
local_output_nid generation:  0.023312091827392578
local_in_edges_tensor generation:  0.029874086380004883
mini_batch_src_global generation:  0.04017996788024902
r_  generation:  0.3149700164794922
local_output_nid generation:  0.026062488555908203
local_in_edges_tensor generation:  0.02510690689086914
mini_batch_src_global generation:  0.036350250244140625
r_  generation:  0.322645902633667
local_output_nid generation:  0.022302865982055664
local_in_edges_tensor generation:  0.01920151710510254
mini_batch_src_global generation:  0.043051719665527344
r_  generation:  0.3418698310852051
local_output_nid generation:  0.021913766860961914
local_in_edges_tensor generation:  0.03317546844482422
mini_batch_src_global generation:  0.05568742752075195
r_  generation:  0.33217692375183105
local_output_nid generation:  0.01865077018737793
local_in_edges_tensor generation:  0.035590171813964844
mini_batch_src_global generation:  0.040307044982910156
r_  generation:  0.35003066062927246
local_output_nid generation:  0.01946568489074707
local_in_edges_tensor generation:  0.0312809944152832
mini_batch_src_global generation:  0.043102264404296875
r_  generation:  0.3179764747619629
local_output_nid generation:  0.01967763900756836
local_in_edges_tensor generation:  0.029446840286254883
mini_batch_src_global generation:  0.03904843330383301
r_  generation:  0.32662129402160645
----------------------check_connections_block total spend ----------------------------- 3.9426229000091553
generate_one_block  0.41973447799682617
generate_one_block  0.42431640625
generate_one_block  0.4078342914581299
generate_one_block  0.4118669033050537
generate_one_block  0.42159032821655273
generate_one_block  0.40779614448547363
generate_one_block  0.4055452346801758
generate_one_block  0.449462890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03683066368103027
gen group dst list time:  0.03597760200500488
time for parepare:  0.01997828483581543
local_output_nid generation:  0.0286407470703125
local_in_edges_tensor generation:  0.058414459228515625
mini_batch_src_global generation:  0.04802751541137695
r_  generation:  0.5140926837921143
local_output_nid generation:  0.03692126274108887
local_in_edges_tensor generation:  0.058771610260009766
mini_batch_src_global generation:  0.05995512008666992
r_  generation:  0.5384573936462402
local_output_nid generation:  0.037940025329589844
local_in_edges_tensor generation:  0.04772186279296875
mini_batch_src_global generation:  0.06508779525756836
r_  generation:  0.5296037197113037
local_output_nid generation:  0.03609800338745117
local_in_edges_tensor generation:  0.03994870185852051
mini_batch_src_global generation:  0.05953645706176758
r_  generation:  0.5214390754699707
local_output_nid generation:  0.03609752655029297
local_in_edges_tensor generation:  0.038799285888671875
mini_batch_src_global generation:  0.06114077568054199
r_  generation:  0.5342319011688232
local_output_nid generation:  0.036231279373168945
local_in_edges_tensor generation:  0.0364990234375
mini_batch_src_global generation:  0.05961418151855469
r_  generation:  0.5373480319976807
local_output_nid generation:  0.03670501708984375
local_in_edges_tensor generation:  0.03504371643066406
mini_batch_src_global generation:  0.05851554870605469
r_  generation:  0.5362470149993896
local_output_nid generation:  0.036160945892333984
local_in_edges_tensor generation:  0.04867959022521973
mini_batch_src_global generation:  0.0631253719329834
r_  generation:  0.5264346599578857
----------------------check_connections_block total spend ----------------------------- 6.322154998779297
generate_one_block  0.6643993854522705
generate_one_block  0.6621413230895996
generate_one_block  0.6646091938018799
generate_one_block  0.6665983200073242
generate_one_block  0.6686444282531738
generate_one_block  0.6700625419616699
generate_one_block  0.6783525943756104
generate_one_block  0.6866354942321777
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03789472579956055
gen group dst list time:  0.04891562461853027
time for parepare:  0.018964290618896484
local_output_nid generation:  0.035324811935424805
local_in_edges_tensor generation:  0.05961179733276367
mini_batch_src_global generation:  0.04560232162475586
r_  generation:  0.5528178215026855
local_output_nid generation:  0.04129505157470703
local_in_edges_tensor generation:  0.05107569694519043
mini_batch_src_global generation:  0.057465553283691406
r_  generation:  0.5133135318756104
local_output_nid generation:  0.03901553153991699
local_in_edges_tensor generation:  0.04741239547729492
mini_batch_src_global generation:  0.0569150447845459
r_  generation:  0.5083885192871094
local_output_nid generation:  0.03899693489074707
local_in_edges_tensor generation:  0.03790092468261719
mini_batch_src_global generation:  0.05471491813659668
r_  generation:  0.5180518627166748
local_output_nid generation:  0.0390629768371582
local_in_edges_tensor generation:  0.046393394470214844
mini_batch_src_global generation:  0.054726362228393555
r_  generation:  0.5164353847503662
local_output_nid generation:  0.03904247283935547
local_in_edges_tensor generation:  0.040149688720703125
mini_batch_src_global generation:  0.056093692779541016
r_  generation:  0.5230591297149658
local_output_nid generation:  0.03923940658569336
local_in_edges_tensor generation:  0.04715681076049805
mini_batch_src_global generation:  0.055419206619262695
r_  generation:  0.5158600807189941
local_output_nid generation:  0.04075813293457031
local_in_edges_tensor generation:  0.047312259674072266
mini_batch_src_global generation:  0.0578458309173584
r_  generation:  0.5355031490325928
----------------------check_connections_block total spend ----------------------------- 6.275636911392212
generate_one_block  0.6342213153839111
generate_one_block  0.6350522041320801
generate_one_block  0.6444461345672607
generate_one_block  0.6240756511688232
generate_one_block  0.6375942230224609
generate_one_block  0.6290309429168701
generate_one_block  0.6394355297088623
generate_one_block  0.6508331298828125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.18273258209228516  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

connection checking time:  16.540414810180664
block generation total time  13.804279088973999
average batch blocks generation time:  1.7255348861217499
block dataloader generation time/epoch 32.70908212661743
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1138143539428711  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165479, 128])
torch.Size([161104, 32])
torch.Size([141885, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32355403900146484  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11395835876464844  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

torch.Size([165631, 128])
torch.Size([161337, 32])
torch.Size([142298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32384729385375977  GigaBytes
Max Memory Allocated: 0.3376307487487793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11381912231445312  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

torch.Size([165570, 128])
torch.Size([161397, 32])
torch.Size([142393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32374000549316406  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11372661590576172  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

torch.Size([165416, 128])
torch.Size([161030, 32])
torch.Size([141966, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3237166404724121  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11381149291992188  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

torch.Size([165449, 128])
torch.Size([161090, 32])
torch.Size([141988, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32356834411621094  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11371183395385742  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

torch.Size([165385, 128])
torch.Size([161031, 32])
torch.Size([141974, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32349586486816406  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1137089729309082  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

torch.Size([165522, 128])
torch.Size([161225, 32])
torch.Size([142145, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32230710983276367  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1136178970336914  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

torch.Size([165563, 128])
torch.Size([161307, 32])
torch.Size([142216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3236703872680664  GigaBytes
Max Memory Allocated: 0.3377399444580078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04807227849960327 |0.0263710618019104 |0.004685908555984497 |9.429454803466797e-05 |0.009540587663650513 |0.003823995590209961 |
----------------------------------------------------------pseudo_mini_loss sum 4.540696620941162
Total (block generation + training)time/epoch 33.45605778694153
Training time/epoch 0.7466776371002197
Training time without block to device /epoch 0.5357091426849365
Training time without total dataloading part /epoch 0.11839032173156738
load block tensor time/epoch 0.38457822799682617
block to device time/epoch 0.2109684944152832
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4293572
Number of first layer input nodes during this epoch:  1324015
