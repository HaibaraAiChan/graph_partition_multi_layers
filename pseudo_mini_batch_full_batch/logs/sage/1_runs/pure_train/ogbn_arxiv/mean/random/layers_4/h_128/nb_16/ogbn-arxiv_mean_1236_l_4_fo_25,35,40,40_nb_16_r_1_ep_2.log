Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648479760.0871632
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024904966354370117
random selection method range initialization spend 0.006318569183349609
time for parepare:  0.018258333206176758
local_output_nid generation:  0.0021300315856933594
local_in_edges_tensor generation:  0.004694461822509766
mini_batch_src_global generation:  0.0017082691192626953
r_  generation:  0.017366886138916016
local_output_nid generation:  0.0025322437286376953
local_in_edges_tensor generation:  0.0016667842864990234
mini_batch_src_global generation:  0.002094745635986328
r_  generation:  0.017833709716796875
local_output_nid generation:  0.002691984176635742
local_in_edges_tensor generation:  0.0015671253204345703
mini_batch_src_global generation:  0.0013623237609863281
r_  generation:  0.017718791961669922
local_output_nid generation:  0.002930164337158203
local_in_edges_tensor generation:  0.0016007423400878906
mini_batch_src_global generation:  0.0014328956604003906
r_  generation:  0.01841878890991211
local_output_nid generation:  0.0031614303588867188
local_in_edges_tensor generation:  0.0016283988952636719
mini_batch_src_global generation:  0.014435052871704102
r_  generation:  0.018401145935058594
local_output_nid generation:  0.003139972686767578
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.0014591217041015625
r_  generation:  0.018625974655151367
local_output_nid generation:  0.002964496612548828
local_in_edges_tensor generation:  0.0015802383422851562
mini_batch_src_global generation:  0.001432657241821289
r_  generation:  0.018224000930786133
local_output_nid generation:  0.0028693675994873047
local_in_edges_tensor generation:  0.0014955997467041016
mini_batch_src_global generation:  0.0014188289642333984
r_  generation:  0.018339157104492188
local_output_nid generation:  0.00290679931640625
local_in_edges_tensor generation:  0.001444101333618164
mini_batch_src_global generation:  0.0013985633850097656
r_  generation:  0.01830124855041504
local_output_nid generation:  0.0028629302978515625
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.01862931251525879
local_output_nid generation:  0.002797842025756836
local_in_edges_tensor generation:  0.0015139579772949219
mini_batch_src_global generation:  0.0015063285827636719
r_  generation:  0.018830060958862305
local_output_nid generation:  0.002826690673828125
local_in_edges_tensor generation:  0.0014917850494384766
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.018554210662841797
local_output_nid generation:  0.002830982208251953
local_in_edges_tensor generation:  0.0014977455139160156
mini_batch_src_global generation:  0.0014958381652832031
r_  generation:  0.018609046936035156
local_output_nid generation:  0.0028734207153320312
local_in_edges_tensor generation:  0.0014827251434326172
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.01841425895690918
local_output_nid generation:  0.002846956253051758
local_in_edges_tensor generation:  0.0014727115631103516
mini_batch_src_global generation:  0.0015461444854736328
r_  generation:  0.01863861083984375
local_output_nid generation:  0.0027875900268554688
local_in_edges_tensor generation:  0.0014986991882324219
mini_batch_src_global generation:  0.001491546630859375
r_  generation:  0.018537282943725586
----------------------check_connections_block total spend ----------------------------- 0.5057709217071533
generate_one_block  0.02683734893798828
generate_one_block  0.027048826217651367
generate_one_block  0.030194759368896484
generate_one_block  0.027194499969482422
generate_one_block  0.02655935287475586
generate_one_block  0.027125120162963867
generate_one_block  0.02743387222290039
generate_one_block  0.026617765426635742
generate_one_block  0.026657819747924805
generate_one_block  0.02756524085998535
generate_one_block  0.02763962745666504
generate_one_block  0.027024507522583008
generate_one_block  0.027567148208618164
generate_one_block  0.027205705642700195
generate_one_block  0.027432680130004883
generate_one_block  0.02682018280029297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041698455810546875
gen group dst list time:  0.01839303970336914
time for parepare:  0.01929926872253418
local_output_nid generation:  0.008007049560546875
local_in_edges_tensor generation:  0.019225120544433594
mini_batch_src_global generation:  0.01889657974243164
r_  generation:  0.19336676597595215
local_output_nid generation:  0.01452326774597168
local_in_edges_tensor generation:  0.02048182487487793
mini_batch_src_global generation:  0.024683237075805664
r_  generation:  0.20660686492919922
local_output_nid generation:  0.014449834823608398
local_in_edges_tensor generation:  0.016570091247558594
mini_batch_src_global generation:  0.02350902557373047
r_  generation:  0.20920920372009277
local_output_nid generation:  0.014510631561279297
local_in_edges_tensor generation:  0.014974355697631836
mini_batch_src_global generation:  0.02440333366394043
r_  generation:  0.20857644081115723
local_output_nid generation:  0.014569997787475586
local_in_edges_tensor generation:  0.01490473747253418
mini_batch_src_global generation:  0.02557086944580078
r_  generation:  0.21152114868164062
local_output_nid generation:  0.014663219451904297
local_in_edges_tensor generation:  0.018688440322875977
mini_batch_src_global generation:  0.026334524154663086
r_  generation:  0.21741580963134766
local_output_nid generation:  0.01471710205078125
local_in_edges_tensor generation:  0.013910293579101562
mini_batch_src_global generation:  0.026555299758911133
r_  generation:  0.21386313438415527
local_output_nid generation:  0.014639616012573242
local_in_edges_tensor generation:  0.015029430389404297
mini_batch_src_global generation:  0.026602745056152344
r_  generation:  0.21157073974609375
local_output_nid generation:  0.014768362045288086
local_in_edges_tensor generation:  0.015195608139038086
mini_batch_src_global generation:  0.02642536163330078
r_  generation:  0.21386075019836426
local_output_nid generation:  0.014735937118530273
local_in_edges_tensor generation:  0.014910697937011719
mini_batch_src_global generation:  0.028911590576171875
r_  generation:  0.21728205680847168
local_output_nid generation:  0.014936208724975586
local_in_edges_tensor generation:  0.016823530197143555
mini_batch_src_global generation:  0.027590513229370117
r_  generation:  0.21827459335327148
local_output_nid generation:  0.014846086502075195
local_in_edges_tensor generation:  0.017244338989257812
mini_batch_src_global generation:  0.027370452880859375
r_  generation:  0.22304153442382812
local_output_nid generation:  0.014778614044189453
local_in_edges_tensor generation:  0.013367176055908203
mini_batch_src_global generation:  0.027503252029418945
r_  generation:  0.21790146827697754
local_output_nid generation:  0.015099763870239258
local_in_edges_tensor generation:  0.013401269912719727
mini_batch_src_global generation:  0.02773451805114746
r_  generation:  0.21612048149108887
local_output_nid generation:  0.0147857666015625
local_in_edges_tensor generation:  0.01895880699157715
mini_batch_src_global generation:  0.02760624885559082
r_  generation:  0.21859979629516602
local_output_nid generation:  0.014617443084716797
local_in_edges_tensor generation:  0.013431549072265625
mini_batch_src_global generation:  0.027637004852294922
r_  generation:  0.21521568298339844
----------------------check_connections_block total spend ----------------------------- 5.082133531570435
generate_one_block  0.2756345272064209
generate_one_block  0.28089022636413574
generate_one_block  0.28020381927490234
generate_one_block  0.2751424312591553
generate_one_block  0.29436492919921875
generate_one_block  0.2767047882080078
generate_one_block  0.2759585380554199
generate_one_block  0.27434325218200684
generate_one_block  0.2754957675933838
generate_one_block  0.28269267082214355
generate_one_block  0.28259801864624023
generate_one_block  0.2837371826171875
generate_one_block  0.28034329414367676
generate_one_block  0.27799296379089355
generate_one_block  0.2885444164276123
generate_one_block  0.2783236503601074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04034566879272461
gen group dst list time:  0.059592485427856445
time for parepare:  0.018641948699951172
local_output_nid generation:  0.024598121643066406
local_in_edges_tensor generation:  0.04121279716491699
mini_batch_src_global generation:  0.04874992370605469
r_  generation:  0.4711036682128906
local_output_nid generation:  0.030985355377197266
local_in_edges_tensor generation:  0.04881405830383301
mini_batch_src_global generation:  0.06140542030334473
r_  generation:  0.4751756191253662
local_output_nid generation:  0.030174970626831055
local_in_edges_tensor generation:  0.040119171142578125
mini_batch_src_global generation:  0.05513453483581543
r_  generation:  0.4873642921447754
local_output_nid generation:  0.030332565307617188
local_in_edges_tensor generation:  0.04392385482788086
mini_batch_src_global generation:  0.06468796730041504
r_  generation:  0.4781467914581299
local_output_nid generation:  0.03080916404724121
local_in_edges_tensor generation:  0.03345441818237305
mini_batch_src_global generation:  0.05608391761779785
r_  generation:  0.4841890335083008
local_output_nid generation:  0.030076026916503906
local_in_edges_tensor generation:  0.03357362747192383
mini_batch_src_global generation:  0.05782938003540039
r_  generation:  0.48317718505859375
local_output_nid generation:  0.03179144859313965
local_in_edges_tensor generation:  0.03563547134399414
mini_batch_src_global generation:  0.057379722595214844
r_  generation:  0.4868643283843994
local_output_nid generation:  0.030754804611206055
local_in_edges_tensor generation:  0.03335165977478027
mini_batch_src_global generation:  0.05759406089782715
r_  generation:  0.48479700088500977
local_output_nid generation:  0.03209519386291504
local_in_edges_tensor generation:  0.03958868980407715
mini_batch_src_global generation:  0.056084394454956055
r_  generation:  0.49733710289001465
local_output_nid generation:  0.03184962272644043
local_in_edges_tensor generation:  0.04265451431274414
mini_batch_src_global generation:  0.06062793731689453
r_  generation:  0.47956180572509766
local_output_nid generation:  0.031549692153930664
local_in_edges_tensor generation:  0.04007744789123535
mini_batch_src_global generation:  0.06001710891723633
r_  generation:  0.4895758628845215
local_output_nid generation:  0.030462265014648438
local_in_edges_tensor generation:  0.03398919105529785
mini_batch_src_global generation:  0.07281374931335449
r_  generation:  0.4951622486114502
local_output_nid generation:  0.03149080276489258
local_in_edges_tensor generation:  0.02933049201965332
mini_batch_src_global generation:  0.057912588119506836
r_  generation:  0.48934030532836914
local_output_nid generation:  0.031769514083862305
local_in_edges_tensor generation:  0.03432464599609375
mini_batch_src_global generation:  0.058854103088378906
r_  generation:  0.48911547660827637
local_output_nid generation:  0.03351640701293945
local_in_edges_tensor generation:  0.038451433181762695
mini_batch_src_global generation:  0.05854988098144531
r_  generation:  0.4945826530456543
local_output_nid generation:  0.03114032745361328
local_in_edges_tensor generation:  0.03031301498413086
mini_batch_src_global generation:  0.05875587463378906
r_  generation:  0.48418092727661133
----------------------check_connections_block total spend ----------------------------- 11.488789796829224
generate_one_block  0.6296367645263672
generate_one_block  0.6351585388183594
generate_one_block  0.6321680545806885
generate_one_block  0.6376132965087891
generate_one_block  0.6273975372314453
generate_one_block  0.6258151531219482
generate_one_block  0.6767113208770752
generate_one_block  0.6269946098327637
generate_one_block  0.6367027759552002
generate_one_block  0.6275575160980225
generate_one_block  0.6293818950653076
generate_one_block  0.6378428936004639
generate_one_block  0.6283969879150391
generate_one_block  0.6328530311584473
generate_one_block  0.6326906681060791
generate_one_block  0.6295762062072754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06896781921386719
gen group dst list time:  0.08832979202270508
time for parepare:  0.019161224365234375
local_output_nid generation:  0.03259921073913574
local_in_edges_tensor generation:  0.04868006706237793
mini_batch_src_global generation:  0.04425215721130371
r_  generation:  0.48351383209228516
local_output_nid generation:  0.03824901580810547
local_in_edges_tensor generation:  0.03895854949951172
mini_batch_src_global generation:  0.05530261993408203
r_  generation:  0.4885234832763672
local_output_nid generation:  0.0369565486907959
local_in_edges_tensor generation:  0.037439823150634766
mini_batch_src_global generation:  0.05289626121520996
r_  generation:  0.4933772087097168
local_output_nid generation:  0.03688335418701172
local_in_edges_tensor generation:  0.041475534439086914
mini_batch_src_global generation:  0.052461862564086914
r_  generation:  0.5014283657073975
local_output_nid generation:  0.03690075874328613
local_in_edges_tensor generation:  0.04360342025756836
mini_batch_src_global generation:  0.05262279510498047
r_  generation:  0.5034141540527344
local_output_nid generation:  0.037035226821899414
local_in_edges_tensor generation:  0.046060800552368164
mini_batch_src_global generation:  0.05197477340698242
r_  generation:  0.5058779716491699
local_output_nid generation:  0.037268877029418945
local_in_edges_tensor generation:  0.04135417938232422
mini_batch_src_global generation:  0.05341458320617676
r_  generation:  0.5100576877593994
local_output_nid generation:  0.03682231903076172
local_in_edges_tensor generation:  0.04141855239868164
mini_batch_src_global generation:  0.053784847259521484
r_  generation:  0.5146567821502686
local_output_nid generation:  0.037215471267700195
local_in_edges_tensor generation:  0.043856143951416016
mini_batch_src_global generation:  0.05814719200134277
r_  generation:  0.5162897109985352
local_output_nid generation:  0.03722023963928223
local_in_edges_tensor generation:  0.045716047286987305
mini_batch_src_global generation:  0.0554804801940918
r_  generation:  0.5168890953063965
local_output_nid generation:  0.03714895248413086
local_in_edges_tensor generation:  0.037320613861083984
mini_batch_src_global generation:  0.05504631996154785
r_  generation:  0.5295143127441406
local_output_nid generation:  0.03726315498352051
local_in_edges_tensor generation:  0.043526411056518555
mini_batch_src_global generation:  0.05564594268798828
r_  generation:  0.5332891941070557
local_output_nid generation:  0.03728437423706055
local_in_edges_tensor generation:  0.051418304443359375
mini_batch_src_global generation:  0.06233716011047363
r_  generation:  0.5234165191650391
local_output_nid generation:  0.037199974060058594
local_in_edges_tensor generation:  0.045174598693847656
mini_batch_src_global generation:  0.05497241020202637
r_  generation:  0.5144431591033936
local_output_nid generation:  0.03707766532897949
local_in_edges_tensor generation:  0.04781985282897949
mini_batch_src_global generation:  0.055226802825927734
r_  generation:  0.5181982517242432
local_output_nid generation:  0.03712153434753418
local_in_edges_tensor generation:  0.0415501594543457
mini_batch_src_global generation:  0.0555117130279541
r_  generation:  0.5280399322509766
----------------------check_connections_block total spend ----------------------------- 12.26708173751831
generate_one_block  0.6142125129699707
generate_one_block  0.7075929641723633
generate_one_block  0.6303348541259766
generate_one_block  0.6347320079803467
generate_one_block  0.6326014995574951
generate_one_block  0.6188600063323975
generate_one_block  0.6322121620178223
generate_one_block  0.6245765686035156
generate_one_block  0.6399803161621094
generate_one_block  0.6396727561950684
generate_one_block  0.6279933452606201
generate_one_block  0.6312620639801025
generate_one_block  0.6549911499023438
generate_one_block  0.6359529495239258
generate_one_block  0.6228947639465332
generate_one_block  0.6326906681060791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

connection checking time:  28.83800506591797
block generation total time  24.810028314590454
average batch blocks generation time:  1.5506267696619034
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10692977905273438  GigaBytes
Max Memory Allocated: 0.10692977905273438  GigaBytes

torch.Size([163647, 128])
torch.Size([155540, 128])
torch.Size([123794, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.7892322540283203  GigaBytes
Max Memory Allocated: 0.80657958984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6170654296875 GB
    Memory Allocated: 0.10827493667602539  GigaBytes
Max Memory Allocated: 0.8296098709106445  GigaBytes

torch.Size([163787, 128])
torch.Size([155787, 128])
torch.Size([123963, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 0.7919960021972656  GigaBytes
Max Memory Allocated: 0.8296098709106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.10820436477661133  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163554, 128])
torch.Size([155284, 128])
torch.Size([123496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7886285781860352  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10821199417114258  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163595, 128])
torch.Size([155497, 128])
torch.Size([123759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7895736694335938  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.1081852912902832  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163809, 128])
torch.Size([155857, 128])
torch.Size([123772, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7905969619750977  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10823678970336914  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163673, 128])
torch.Size([155456, 128])
torch.Size([123617, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.78973388671875  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10821294784545898  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163666, 128])
torch.Size([155491, 128])
torch.Size([123622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7892460823059082  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10813093185424805  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163462, 128])
torch.Size([155030, 128])
torch.Size([122553, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7860369682312012  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10820531845092773  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

torch.Size([163800, 128])
torch.Size([155759, 128])
torch.Size([124135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7915668487548828  GigaBytes
Max Memory Allocated: 0.83123779296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10828638076782227  GigaBytes
Max Memory Allocated: 0.8313708305358887  GigaBytes

torch.Size([163626, 128])
torch.Size([155594, 128])
torch.Size([123871, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7910943031311035  GigaBytes
Max Memory Allocated: 0.8313708305358887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10831308364868164  GigaBytes
Max Memory Allocated: 0.8322558403015137  GigaBytes

torch.Size([163613, 128])
torch.Size([155515, 128])
torch.Size([123755, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7910447120666504  GigaBytes
Max Memory Allocated: 0.8322558403015137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10834836959838867  GigaBytes
Max Memory Allocated: 0.8322558403015137  GigaBytes

torch.Size([163678, 128])
torch.Size([155814, 128])
torch.Size([124689, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7943587303161621  GigaBytes
Max Memory Allocated: 0.8322558403015137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10826730728149414  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163733, 128])
torch.Size([155568, 128])
torch.Size([123981, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7909770011901855  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10825109481811523  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163550, 128])
torch.Size([155590, 128])
torch.Size([124248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7909598350524902  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10832357406616211  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163692, 128])
torch.Size([155562, 128])
torch.Size([123891, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7910699844360352  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.10816621780395508  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163725, 128])
torch.Size([155543, 128])
torch.Size([123443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.7887668609619141  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05486772954463959 |0.046296343207359314 |0.04886193573474884 |9.939074516296387e-05 |0.010865986347198486 |0.002243518829345703 |
----------------------------------------------------------pseudo_mini_loss sum 5.843875885009766
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7748813
Number of first layer input nodes during this epoch:  2618610
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.15727758407592773  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.050519466400146484
random selection method range initialization spend 0.007984399795532227
time for parepare:  0.02012944221496582
local_output_nid generation:  0.0024127960205078125
local_in_edges_tensor generation:  0.012166500091552734
mini_batch_src_global generation:  0.0022230148315429688
r_  generation:  0.02012491226196289
local_output_nid generation:  0.003505706787109375
local_in_edges_tensor generation:  0.0019459724426269531
mini_batch_src_global generation:  0.007663726806640625
r_  generation:  0.019025087356567383
local_output_nid generation:  0.003566265106201172
local_in_edges_tensor generation:  0.001800537109375
mini_batch_src_global generation:  0.001409769058227539
r_  generation:  0.018395185470581055
local_output_nid generation:  0.003520965576171875
local_in_edges_tensor generation:  0.0015308856964111328
mini_batch_src_global generation:  0.0013518333435058594
r_  generation:  0.018034934997558594
local_output_nid generation:  0.003473043441772461
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.018522977828979492
local_output_nid generation:  0.0035161972045898438
local_in_edges_tensor generation:  0.0015363693237304688
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.01882195472717285
local_output_nid generation:  0.0034906864166259766
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.0015194416046142578
r_  generation:  0.01964259147644043
local_output_nid generation:  0.0035245418548583984
local_in_edges_tensor generation:  0.0015015602111816406
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.0204925537109375
local_output_nid generation:  0.003595590591430664
local_in_edges_tensor generation:  0.0015516281127929688
mini_batch_src_global generation:  0.001497507095336914
r_  generation:  0.019288301467895508
local_output_nid generation:  0.0036690235137939453
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.001497507095336914
r_  generation:  0.01938462257385254
local_output_nid generation:  0.0035767555236816406
local_in_edges_tensor generation:  0.0016696453094482422
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.01979660987854004
local_output_nid generation:  0.003565549850463867
local_in_edges_tensor generation:  0.0015473365783691406
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.019559144973754883
local_output_nid generation:  0.003538846969604492
local_in_edges_tensor generation:  0.0014941692352294922
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.01933574676513672
local_output_nid generation:  0.0034639835357666016
local_in_edges_tensor generation:  0.0015277862548828125
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.020048856735229492
local_output_nid generation:  0.003545045852661133
local_in_edges_tensor generation:  0.001531362533569336
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.019245386123657227
local_output_nid generation:  0.003467559814453125
local_in_edges_tensor generation:  0.0015347003936767578
mini_batch_src_global generation:  0.0015363693237304688
r_  generation:  0.01967334747314453
----------------------check_connections_block total spend ----------------------------- 0.5334413051605225
generate_one_block  0.02717280387878418
generate_one_block  0.028653383255004883
generate_one_block  0.02765512466430664
generate_one_block  0.02735137939453125
generate_one_block  0.027370929718017578
generate_one_block  0.030510902404785156
generate_one_block  0.0282590389251709
generate_one_block  0.02820611000061035
generate_one_block  0.02750420570373535
generate_one_block  0.027318239212036133
generate_one_block  0.027703523635864258
generate_one_block  0.027981281280517578
generate_one_block  0.027599811553955078
generate_one_block  0.0284576416015625
generate_one_block  0.027689218521118164
generate_one_block  0.0282285213470459
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.047777652740478516
gen group dst list time:  0.016726016998291016
time for parepare:  0.01988840103149414
local_output_nid generation:  0.008306026458740234
local_in_edges_tensor generation:  0.022513389587402344
mini_batch_src_global generation:  0.01906585693359375
r_  generation:  0.2039475440979004
local_output_nid generation:  0.01580643653869629
local_in_edges_tensor generation:  0.025119304656982422
mini_batch_src_global generation:  0.02735757827758789
r_  generation:  0.20805025100708008
local_output_nid generation:  0.015498876571655273
local_in_edges_tensor generation:  0.01866769790649414
mini_batch_src_global generation:  0.023792743682861328
r_  generation:  0.21151447296142578
local_output_nid generation:  0.015473127365112305
local_in_edges_tensor generation:  0.019167423248291016
mini_batch_src_global generation:  0.024588346481323242
r_  generation:  0.21331119537353516
local_output_nid generation:  0.01657271385192871
local_in_edges_tensor generation:  0.018774747848510742
mini_batch_src_global generation:  0.025902748107910156
r_  generation:  0.21630597114562988
local_output_nid generation:  0.017567157745361328
local_in_edges_tensor generation:  0.01678776741027832
mini_batch_src_global generation:  0.026484966278076172
r_  generation:  0.21597886085510254
local_output_nid generation:  0.016381025314331055
local_in_edges_tensor generation:  0.016901016235351562
mini_batch_src_global generation:  0.028902530670166016
r_  generation:  0.22138261795043945
local_output_nid generation:  0.01648569107055664
local_in_edges_tensor generation:  0.017041921615600586
mini_batch_src_global generation:  0.02717423439025879
r_  generation:  0.22041893005371094
local_output_nid generation:  0.016127586364746094
local_in_edges_tensor generation:  0.015044212341308594
mini_batch_src_global generation:  0.02671647071838379
r_  generation:  0.21504473686218262
local_output_nid generation:  0.016118526458740234
local_in_edges_tensor generation:  0.01473546028137207
mini_batch_src_global generation:  0.02702808380126953
r_  generation:  0.21905088424682617
local_output_nid generation:  0.01574420928955078
local_in_edges_tensor generation:  0.02062678337097168
mini_batch_src_global generation:  0.02726292610168457
r_  generation:  0.21965289115905762
local_output_nid generation:  0.015891551971435547
local_in_edges_tensor generation:  0.01703667640686035
mini_batch_src_global generation:  0.0267791748046875
r_  generation:  0.21717381477355957
local_output_nid generation:  0.015551567077636719
local_in_edges_tensor generation:  0.01689934730529785
mini_batch_src_global generation:  0.02707982063293457
r_  generation:  0.21720552444458008
local_output_nid generation:  0.0159151554107666
local_in_edges_tensor generation:  0.019372940063476562
mini_batch_src_global generation:  0.029352426528930664
r_  generation:  0.2299044132232666
local_output_nid generation:  0.013824939727783203
local_in_edges_tensor generation:  0.020823001861572266
mini_batch_src_global generation:  0.028133392333984375
r_  generation:  0.23721623420715332
local_output_nid generation:  0.015693187713623047
local_in_edges_tensor generation:  0.017235994338989258
mini_batch_src_global generation:  0.029135704040527344
r_  generation:  0.21889472007751465
----------------------check_connections_block total spend ----------------------------- 5.232818603515625
generate_one_block  0.2809786796569824
generate_one_block  0.2868959903717041
generate_one_block  0.283205509185791
generate_one_block  0.27442216873168945
generate_one_block  0.28804588317871094
generate_one_block  0.27556824684143066
generate_one_block  0.30707383155822754
generate_one_block  0.2846858501434326
generate_one_block  0.2733027935028076
generate_one_block  0.2731819152832031
generate_one_block  0.2883942127227783
generate_one_block  0.2792820930480957
generate_one_block  0.2736344337463379
generate_one_block  0.29190516471862793
generate_one_block  0.29207682609558105
generate_one_block  0.2734262943267822
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05269432067871094
gen group dst list time:  0.0662689208984375
time for parepare:  0.018203020095825195
local_output_nid generation:  0.026155948638916016
local_in_edges_tensor generation:  0.05960559844970703
mini_batch_src_global generation:  0.04538917541503906
r_  generation:  0.48214006423950195
local_output_nid generation:  0.031171083450317383
local_in_edges_tensor generation:  0.049957990646362305
mini_batch_src_global generation:  0.05636167526245117
r_  generation:  0.48114705085754395
local_output_nid generation:  0.031352996826171875
local_in_edges_tensor generation:  0.03786182403564453
mini_batch_src_global generation:  0.05863499641418457
r_  generation:  0.48303771018981934
local_output_nid generation:  0.03143477439880371
local_in_edges_tensor generation:  0.03525805473327637
mini_batch_src_global generation:  0.0567014217376709
r_  generation:  0.481154203414917
local_output_nid generation:  0.031484127044677734
local_in_edges_tensor generation:  0.07963180541992188
mini_batch_src_global generation:  0.061440229415893555
r_  generation:  0.48994922637939453
local_output_nid generation:  0.03149271011352539
local_in_edges_tensor generation:  0.041643619537353516
mini_batch_src_global generation:  0.057273149490356445
r_  generation:  0.48478007316589355
local_output_nid generation:  0.031967878341674805
local_in_edges_tensor generation:  0.037888526916503906
mini_batch_src_global generation:  0.056586503982543945
r_  generation:  0.4984312057495117
local_output_nid generation:  0.031185626983642578
local_in_edges_tensor generation:  0.037191152572631836
mini_batch_src_global generation:  0.05735445022583008
r_  generation:  0.48529982566833496
local_output_nid generation:  0.03138542175292969
local_in_edges_tensor generation:  0.0374147891998291
mini_batch_src_global generation:  0.05703592300415039
r_  generation:  0.49288320541381836
local_output_nid generation:  0.03269648551940918
local_in_edges_tensor generation:  0.03728055953979492
mini_batch_src_global generation:  0.05708026885986328
r_  generation:  0.48838043212890625
local_output_nid generation:  0.03159642219543457
local_in_edges_tensor generation:  0.04783439636230469
mini_batch_src_global generation:  0.057767391204833984
r_  generation:  0.497652530670166
local_output_nid generation:  0.03167128562927246
local_in_edges_tensor generation:  0.03735184669494629
mini_batch_src_global generation:  0.05795550346374512
r_  generation:  0.48961615562438965
local_output_nid generation:  0.03176450729370117
local_in_edges_tensor generation:  0.0419766902923584
mini_batch_src_global generation:  0.06390929222106934
r_  generation:  0.4929628372192383
local_output_nid generation:  0.03154897689819336
local_in_edges_tensor generation:  0.04542183876037598
mini_batch_src_global generation:  0.07899355888366699
r_  generation:  0.4904286861419678
local_output_nid generation:  0.03403449058532715
local_in_edges_tensor generation:  0.040497779846191406
mini_batch_src_global generation:  0.061070919036865234
r_  generation:  0.49492835998535156
local_output_nid generation:  0.032804250717163086
local_in_edges_tensor generation:  0.03841090202331543
mini_batch_src_global generation:  0.05805683135986328
r_  generation:  0.48412203788757324
----------------------check_connections_block total spend ----------------------------- 11.673004865646362
generate_one_block  0.6228375434875488
generate_one_block  0.6346597671508789
generate_one_block  0.6230788230895996
generate_one_block  0.6225128173828125
generate_one_block  0.6313211917877197
generate_one_block  0.6467850208282471
generate_one_block  0.6273024082183838
generate_one_block  0.624241828918457
generate_one_block  0.6626653671264648
generate_one_block  0.6269135475158691
generate_one_block  0.6400895118713379
generate_one_block  0.6309707164764404
generate_one_block  0.619163990020752
generate_one_block  0.6398670673370361
generate_one_block  0.6396133899688721
generate_one_block  0.6141555309295654
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03960537910461426
gen group dst list time:  0.09384799003601074
time for parepare:  0.019258975982666016
local_output_nid generation:  0.03272676467895508
local_in_edges_tensor generation:  0.05567502975463867
mini_batch_src_global generation:  0.04575634002685547
r_  generation:  0.48520851135253906
local_output_nid generation:  0.040114641189575195
local_in_edges_tensor generation:  0.04076504707336426
mini_batch_src_global generation:  0.056127309799194336
r_  generation:  0.4956498146057129
local_output_nid generation:  0.04034996032714844
local_in_edges_tensor generation:  0.04007101058959961
mini_batch_src_global generation:  0.0592036247253418
r_  generation:  0.5002293586730957
local_output_nid generation:  0.03914618492126465
local_in_edges_tensor generation:  0.04305696487426758
mini_batch_src_global generation:  0.05305671691894531
r_  generation:  0.49916529655456543
local_output_nid generation:  0.03873252868652344
local_in_edges_tensor generation:  0.05002284049987793
mini_batch_src_global generation:  0.05401945114135742
r_  generation:  0.5086512565612793
local_output_nid generation:  0.03809809684753418
local_in_edges_tensor generation:  0.0472104549407959
mini_batch_src_global generation:  0.07384800910949707
r_  generation:  0.5051076412200928
local_output_nid generation:  0.040001869201660156
local_in_edges_tensor generation:  0.04781222343444824
mini_batch_src_global generation:  0.054955482482910156
r_  generation:  0.5112307071685791
local_output_nid generation:  0.038687705993652344
local_in_edges_tensor generation:  0.04232454299926758
mini_batch_src_global generation:  0.05524110794067383
r_  generation:  0.5107033252716064
local_output_nid generation:  0.03901171684265137
local_in_edges_tensor generation:  0.04528927803039551
mini_batch_src_global generation:  0.05526995658874512
r_  generation:  0.5226788520812988
local_output_nid generation:  0.0390777587890625
local_in_edges_tensor generation:  0.041228294372558594
mini_batch_src_global generation:  0.05586385726928711
r_  generation:  0.5164566040039062
local_output_nid generation:  0.038969993591308594
local_in_edges_tensor generation:  0.039990901947021484
mini_batch_src_global generation:  0.05981898307800293
r_  generation:  0.5157055854797363
local_output_nid generation:  0.04248189926147461
local_in_edges_tensor generation:  0.03708624839782715
mini_batch_src_global generation:  0.05684375762939453
r_  generation:  0.5165762901306152
local_output_nid generation:  0.03943753242492676
local_in_edges_tensor generation:  0.039077043533325195
mini_batch_src_global generation:  0.056398868560791016
r_  generation:  0.5167765617370605
local_output_nid generation:  0.039467811584472656
local_in_edges_tensor generation:  0.045111894607543945
mini_batch_src_global generation:  0.055606842041015625
r_  generation:  0.5195374488830566
local_output_nid generation:  0.03942465782165527
local_in_edges_tensor generation:  0.04080486297607422
mini_batch_src_global generation:  0.0567014217376709
r_  generation:  0.5196037292480469
local_output_nid generation:  0.03914952278137207
local_in_edges_tensor generation:  0.03651833534240723
mini_batch_src_global generation:  0.05684828758239746
r_  generation:  0.5163824558258057
----------------------check_connections_block total spend ----------------------------- 12.307946681976318
generate_one_block  0.6513373851776123
generate_one_block  0.6383440494537354
generate_one_block  0.6348481178283691
generate_one_block  0.6273393630981445
generate_one_block  0.6162033081054688
generate_one_block  0.62689208984375
generate_one_block  0.7007570266723633
generate_one_block  0.618018627166748
generate_one_block  0.6312341690063477
generate_one_block  0.6356806755065918
generate_one_block  0.6275815963745117
generate_one_block  0.6115686893463135
generate_one_block  0.6257874965667725
generate_one_block  0.6214828491210938
generate_one_block  0.6283869743347168
generate_one_block  0.6253962516784668
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.15727758407592773  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

connection checking time:  29.213770151138306
block generation total time  24.753117084503174
average batch blocks generation time:  1.5470698177814484
block dataloader generation time/epoch 56.610575437545776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10900545120239258  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163879, 128])
torch.Size([156009, 128])
torch.Size([123990, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7916221618652344  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10908079147338867  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163647, 128])
torch.Size([155454, 128])
torch.Size([123393, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7904925346374512  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10904264450073242  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163511, 128])
torch.Size([155300, 128])
torch.Size([123775, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7906765937805176  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163566, 128])
torch.Size([155367, 128])
torch.Size([122987, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7878623008728027  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10904836654663086  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163501, 128])
torch.Size([155158, 128])
torch.Size([123348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7896904945373535  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.1089940071105957  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163725, 128])
torch.Size([155478, 128])
torch.Size([123391, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7889895439147949  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10916757583618164  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

torch.Size([163826, 128])
torch.Size([155935, 128])
torch.Size([124781, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7956705093383789  GigaBytes
Max Memory Allocated: 0.835303783416748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10904741287231445  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163701, 128])
torch.Size([155325, 128])
torch.Size([123329, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7902560234069824  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10898256301879883  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163833, 128])
torch.Size([156006, 128])
torch.Size([123897, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7919092178344727  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10898256301879883  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163658, 128])
torch.Size([155701, 128])
torch.Size([123751, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7915596961975098  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.1090846061706543  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163672, 128])
torch.Size([155820, 128])
torch.Size([124545, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7940859794616699  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10904455184936523  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163670, 128])
torch.Size([155523, 128])
torch.Size([124002, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7918238639831543  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10898733139038086  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163603, 128])
torch.Size([155476, 128])
torch.Size([123662, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7896175384521484  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10924768447875977  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163573, 128])
torch.Size([155461, 128])
torch.Size([124153, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7934832572937012  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10917043685913086  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163761, 128])
torch.Size([155902, 128])
torch.Size([124649, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.7948188781738281  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.10905313491821289  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

torch.Size([163677, 128])
torch.Size([155526, 128])
torch.Size([123495, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0838623046875 GB
    Memory Allocated: 0.790247917175293  GigaBytes
Max Memory Allocated: 0.8365635871887207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054503947496414185 |0.024660050868988037 |0.004693567752838135 |9.426474571228027e-05 |0.006665393710136414 |0.0034682750701904297 |
----------------------------------------------------------pseudo_mini_loss sum 3.783351182937622
Total (block generation + training)time/epoch 58.1215660572052
Training time/epoch 1.5106873512268066
Training time without block to device /epoch 1.116126537322998
Training time without total dataloading part /epoch 0.1867198944091797
load block tensor time/epoch 0.872063159942627
block to device time/epoch 0.3945608139038086
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7750272
Number of first layer input nodes during this epoch:  2618803
