Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648512780.646213
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02479100227355957
random selection method range initialization spend 0.00644230842590332
time for parepare:  0.018618345260620117
local_output_nid generation:  0.00827932357788086
local_in_edges_tensor generation:  0.009244680404663086
mini_batch_src_global generation:  0.006453514099121094
r_  generation:  0.08393979072570801
local_output_nid generation:  0.011658668518066406
local_in_edges_tensor generation:  0.0060427188873291016
mini_batch_src_global generation:  0.008666276931762695
r_  generation:  0.08964014053344727
local_output_nid generation:  0.011789798736572266
local_in_edges_tensor generation:  0.006291627883911133
mini_batch_src_global generation:  0.006434917449951172
r_  generation:  0.0889883041381836
local_output_nid generation:  0.011892318725585938
local_in_edges_tensor generation:  0.0061419010162353516
mini_batch_src_global generation:  0.007338523864746094
r_  generation:  0.09067559242248535
----------------------check_connections_block total spend ----------------------------- 0.5520074367523193
generate_one_block  0.10175800323486328
generate_one_block  0.10312128067016602
generate_one_block  0.10193061828613281
generate_one_block  0.10205793380737305
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04239010810852051
gen group dst list time:  0.011275053024291992
time for parepare:  0.019610166549682617
local_output_nid generation:  0.0196990966796875
local_in_edges_tensor generation:  0.04159069061279297
mini_batch_src_global generation:  0.038335323333740234
r_  generation:  0.4002246856689453
local_output_nid generation:  0.029633045196533203
local_in_edges_tensor generation:  0.03902125358581543
mini_batch_src_global generation:  0.04801225662231445
r_  generation:  0.41359782218933105
local_output_nid generation:  0.029377222061157227
local_in_edges_tensor generation:  0.03303360939025879
mini_batch_src_global generation:  0.04760122299194336
r_  generation:  0.41787171363830566
local_output_nid generation:  0.029532194137573242
local_in_edges_tensor generation:  0.03279995918273926
mini_batch_src_global generation:  0.04889512062072754
r_  generation:  0.42510509490966797
----------------------check_connections_block total spend ----------------------------- 2.486365556716919
generate_one_block  0.5610156059265137
generate_one_block  0.5409178733825684
generate_one_block  0.541607141494751
generate_one_block  0.5448713302612305
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03663492202758789
gen group dst list time:  0.020681381225585938
time for parepare:  0.01937127113342285
local_output_nid generation:  0.030137300491333008
local_in_edges_tensor generation:  0.05652046203613281
mini_batch_src_global generation:  0.05428886413574219
r_  generation:  0.5465123653411865
local_output_nid generation:  0.04073333740234375
local_in_edges_tensor generation:  0.05462932586669922
mini_batch_src_global generation:  0.061786651611328125
r_  generation:  0.5538694858551025
local_output_nid generation:  0.04078269004821777
local_in_edges_tensor generation:  0.046845197677612305
mini_batch_src_global generation:  0.056679487228393555
r_  generation:  0.5626068115234375
local_output_nid generation:  0.04063153266906738
local_in_edges_tensor generation:  0.04188108444213867
mini_batch_src_global generation:  0.06286096572875977
r_  generation:  0.5575840473175049
----------------------check_connections_block total spend ----------------------------- 3.3101673126220703
generate_one_block  0.6942462921142578
generate_one_block  0.7106404304504395
generate_one_block  0.7092831134796143
generate_one_block  0.7087290287017822
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03707599639892578
gen group dst list time:  0.023421049118041992
time for parepare:  0.01900649070739746
local_output_nid generation:  0.03242826461791992
local_in_edges_tensor generation:  0.05040907859802246
mini_batch_src_global generation:  0.05521845817565918
r_  generation:  0.5536067485809326
local_output_nid generation:  0.03823995590209961
local_in_edges_tensor generation:  0.05855369567871094
mini_batch_src_global generation:  0.06493496894836426
r_  generation:  0.5600123405456543
local_output_nid generation:  0.038485050201416016
local_in_edges_tensor generation:  0.054016828536987305
mini_batch_src_global generation:  0.06402349472045898
r_  generation:  0.5639455318450928
local_output_nid generation:  0.03871488571166992
local_in_edges_tensor generation:  0.04446077346801758
mini_batch_src_global generation:  0.06287026405334473
r_  generation:  0.5680239200592041
----------------------check_connections_block total spend ----------------------------- 3.3717000484466553
generate_one_block  0.6992597579956055
generate_one_block  0.7151238918304443
generate_one_block  0.712151288986206
generate_one_block  0.7098419666290283
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02911663055419922
gen group dst list time:  0.024338245391845703
time for parepare:  0.019193410873413086
local_output_nid generation:  0.03364872932434082
local_in_edges_tensor generation:  0.05139946937561035
mini_batch_src_global generation:  0.05229592323303223
r_  generation:  0.5545046329498291
local_output_nid generation:  0.0393214225769043
local_in_edges_tensor generation:  0.03883504867553711
mini_batch_src_global generation:  0.0641641616821289
r_  generation:  0.5521743297576904
local_output_nid generation:  0.03905129432678223
local_in_edges_tensor generation:  0.037772417068481445
mini_batch_src_global generation:  0.0635983943939209
r_  generation:  0.5536208152770996
local_output_nid generation:  0.03893852233886719
local_in_edges_tensor generation:  0.03896021842956543
mini_batch_src_global generation:  0.06327056884765625
r_  generation:  0.5556325912475586
----------------------check_connections_block total spend ----------------------------- 3.3112900257110596
generate_one_block  0.6842246055603027
generate_one_block  0.6913049221038818
generate_one_block  0.6938962936401367
generate_one_block  0.7047443389892578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04696369171142578
gen group dst list time:  0.02501368522644043
time for parepare:  0.02017998695373535
local_output_nid generation:  0.03553438186645508
local_in_edges_tensor generation:  0.04679155349731445
mini_batch_src_global generation:  0.04644656181335449
r_  generation:  0.5081768035888672
local_output_nid generation:  0.03933858871459961
local_in_edges_tensor generation:  0.041959524154663086
mini_batch_src_global generation:  0.0583193302154541
r_  generation:  0.5140604972839355
local_output_nid generation:  0.03945565223693848
local_in_edges_tensor generation:  0.047171831130981445
mini_batch_src_global generation:  0.05833029747009277
r_  generation:  0.5190973281860352
local_output_nid generation:  0.040014028549194336
local_in_edges_tensor generation:  0.04517626762390137
mini_batch_src_global generation:  0.0586698055267334
r_  generation:  0.5136508941650391
----------------------check_connections_block total spend ----------------------------- 3.1180951595306396
generate_one_block  0.6330795288085938
generate_one_block  0.6831731796264648
generate_one_block  0.6504101753234863
generate_one_block  0.6493797302246094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

connection checking time:  15.597618103027344
block generation total time  13.237900495529175
average batch blocks generation time:  3.3094751238822937
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.14444684982299805  GigaBytes
Max Memory Allocated: 0.14444684982299805  GigaBytes

torch.Size([167784, 128])
torch.Size([167567, 256])
torch.Size([166896, 256])
torch.Size([164825, 256])
torch.Size([154804, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8065185546875 GB
    Memory Allocated: 3.2041993141174316  GigaBytes
Max Memory Allocated: 3.291944980621338  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 0.15165424346923828  GigaBytes
Max Memory Allocated: 3.395266056060791  GigaBytes

torch.Size([167749, 128])
torch.Size([167514, 256])
torch.Size([166855, 256])
torch.Size([164721, 256])
torch.Size([154879, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 3.213085174560547  GigaBytes
Max Memory Allocated: 3.395266056060791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.15203475952148438  GigaBytes
Max Memory Allocated: 3.4061732292175293  GigaBytes

torch.Size([167767, 128])
torch.Size([167538, 256])
torch.Size([166908, 256])
torch.Size([164806, 256])
torch.Size([154936, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 3.2091798782348633  GigaBytes
Max Memory Allocated: 3.4061732292175293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.15316104888916016  GigaBytes
Max Memory Allocated: 3.4061732292175293  GigaBytes

torch.Size([167751, 128])
torch.Size([167518, 256])
torch.Size([166925, 256])
torch.Size([164793, 256])
torch.Size([155092, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 3.2193922996520996  GigaBytes
Max Memory Allocated: 3.4061732292175293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1793532371520996 |0.13758403062820435 |0.2011716365814209 |0.00011098384857177734 |0.0687175989151001 |0.007627964019775391 |
----------------------------------------------------------pseudo_mini_loss sum 6.153446674346924
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3693243
Number of first layer input nodes during this epoch:  671051
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.27679443359375  GigaBytes
Max Memory Allocated: 3.412515640258789  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02083754539489746
random selection method range initialization spend 0.006712436676025391
time for parepare:  0.018831253051757812
local_output_nid generation:  0.008401155471801758
local_in_edges_tensor generation:  0.013579607009887695
mini_batch_src_global generation:  0.007813692092895508
r_  generation:  0.08181953430175781
local_output_nid generation:  0.012023210525512695
local_in_edges_tensor generation:  0.005878925323486328
mini_batch_src_global generation:  0.00852346420288086
r_  generation:  0.08765029907226562
local_output_nid generation:  0.012182474136352539
local_in_edges_tensor generation:  0.005726337432861328
mini_batch_src_global generation:  0.006607770919799805
r_  generation:  0.0895833969116211
local_output_nid generation:  0.012212514877319336
local_in_edges_tensor generation:  0.005792140960693359
mini_batch_src_global generation:  0.0076143741607666016
r_  generation:  0.09452342987060547
----------------------check_connections_block total spend ----------------------------- 0.5617506504058838
generate_one_block  0.10147333145141602
generate_one_block  0.10206055641174316
generate_one_block  0.10235404968261719
generate_one_block  0.10520172119140625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04246926307678223
gen group dst list time:  0.010970354080200195
time for parepare:  0.019509077072143555
local_output_nid generation:  0.020586252212524414
local_in_edges_tensor generation:  0.04569244384765625
mini_batch_src_global generation:  0.038541316986083984
r_  generation:  0.41601133346557617
local_output_nid generation:  0.02889418601989746
local_in_edges_tensor generation:  0.04105424880981445
mini_batch_src_global generation:  0.050070762634277344
r_  generation:  0.4238243103027344
local_output_nid generation:  0.02788686752319336
local_in_edges_tensor generation:  0.032869815826416016
mini_batch_src_global generation:  0.04773759841918945
r_  generation:  0.4257535934448242
local_output_nid generation:  0.02801966667175293
local_in_edges_tensor generation:  0.03377389907836914
mini_batch_src_global generation:  0.0500035285949707
r_  generation:  0.4356095790863037
----------------------check_connections_block total spend ----------------------------- 2.536316156387329
generate_one_block  0.5553321838378906
generate_one_block  0.5454080104827881
generate_one_block  0.5696704387664795
generate_one_block  0.5799310207366943
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04783821105957031
gen group dst list time:  0.023874282836914062
time for parepare:  0.020569801330566406
local_output_nid generation:  0.030179738998413086
local_in_edges_tensor generation:  0.06276059150695801
mini_batch_src_global generation:  0.05457019805908203
r_  generation:  0.5492703914642334
local_output_nid generation:  0.03696322441101074
local_in_edges_tensor generation:  0.056964874267578125
mini_batch_src_global generation:  0.06215929985046387
r_  generation:  0.5555295944213867
local_output_nid generation:  0.03712654113769531
local_in_edges_tensor generation:  0.046338796615600586
mini_batch_src_global generation:  0.05764293670654297
r_  generation:  0.5690906047821045
local_output_nid generation:  0.03677654266357422
local_in_edges_tensor generation:  0.03797435760498047
mini_batch_src_global generation:  0.058841705322265625
r_  generation:  0.566685676574707
----------------------check_connections_block total spend ----------------------------- 3.347161054611206
generate_one_block  0.7628393173217773
generate_one_block  0.7202553749084473
generate_one_block  0.7018508911132812
generate_one_block  0.7107281684875488
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04617881774902344
gen group dst list time:  0.02784109115600586
time for parepare:  0.018736839294433594
local_output_nid generation:  0.0340733528137207
local_in_edges_tensor generation:  0.0609433650970459
mini_batch_src_global generation:  0.05219531059265137
r_  generation:  0.5611672401428223
local_output_nid generation:  0.039734840393066406
local_in_edges_tensor generation:  0.05647134780883789
mini_batch_src_global generation:  0.06435465812683105
r_  generation:  0.585460901260376
local_output_nid generation:  0.03874802589416504
local_in_edges_tensor generation:  0.042586565017700195
mini_batch_src_global generation:  0.06449103355407715
r_  generation:  0.5688455104827881
local_output_nid generation:  0.03891611099243164
local_in_edges_tensor generation:  0.04163479804992676
mini_batch_src_global generation:  0.06456518173217773
r_  generation:  0.5730874538421631
----------------------check_connections_block total spend ----------------------------- 3.418400287628174
generate_one_block  0.704064130783081
generate_one_block  0.7209036350250244
generate_one_block  0.6967554092407227
generate_one_block  0.7270379066467285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04161715507507324
gen group dst list time:  0.025074005126953125
time for parepare:  0.02009296417236328
local_output_nid generation:  0.03425002098083496
local_in_edges_tensor generation:  0.04665040969848633
mini_batch_src_global generation:  0.05092048645019531
r_  generation:  0.5508477687835693
local_output_nid generation:  0.040212154388427734
local_in_edges_tensor generation:  0.03720545768737793
mini_batch_src_global generation:  0.06571602821350098
r_  generation:  0.5615229606628418
local_output_nid generation:  0.04144883155822754
local_in_edges_tensor generation:  0.055959224700927734
mini_batch_src_global generation:  0.06356573104858398
r_  generation:  0.5639674663543701
local_output_nid generation:  0.039458274841308594
local_in_edges_tensor generation:  0.04659247398376465
mini_batch_src_global generation:  0.06999492645263672
r_  generation:  0.5723981857299805
----------------------check_connections_block total spend ----------------------------- 3.3818798065185547
generate_one_block  0.7084457874298096
generate_one_block  0.7041163444519043
generate_one_block  0.6999626159667969
generate_one_block  0.7044775485992432
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03567314147949219
gen group dst list time:  0.0286405086517334
time for parepare:  0.019356966018676758
local_output_nid generation:  0.0348963737487793
local_in_edges_tensor generation:  0.05554914474487305
mini_batch_src_global generation:  0.04966926574707031
r_  generation:  0.5133392810821533
local_output_nid generation:  0.04128384590148926
local_in_edges_tensor generation:  0.055039405822753906
mini_batch_src_global generation:  0.06189894676208496
r_  generation:  0.5173099040985107
local_output_nid generation:  0.039530038833618164
local_in_edges_tensor generation:  0.062250614166259766
mini_batch_src_global generation:  0.05894064903259277
r_  generation:  0.519230842590332
local_output_nid generation:  0.03989744186401367
local_in_edges_tensor generation:  0.045633554458618164
mini_batch_src_global generation:  0.0588071346282959
r_  generation:  0.5204505920410156
----------------------check_connections_block total spend ----------------------------- 3.185581684112549
generate_one_block  0.6458652019500732
generate_one_block  0.6327400207519531
generate_one_block  0.6492152214050293
generate_one_block  0.681511640548706
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.27679443359375  GigaBytes
Max Memory Allocated: 3.412515640258789  GigaBytes

connection checking time:  15.869338989257812
block generation total time  13.42111086845398
average batch blocks generation time:  3.355277717113495
block dataloader generation time/epoch 31.836905479431152
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 0.15619277954101562  GigaBytes
Max Memory Allocated: 3.412515640258789  GigaBytes

torch.Size([167775, 128])
torch.Size([167565, 256])
torch.Size([166967, 256])
torch.Size([164843, 256])
torch.Size([154711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 3.218161106109619  GigaBytes
Max Memory Allocated: 3.412515640258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 0.15661048889160156  GigaBytes
Max Memory Allocated: 3.412515640258789  GigaBytes

torch.Size([167777, 128])
torch.Size([167569, 256])
torch.Size([166976, 256])
torch.Size([164935, 256])
torch.Size([155245, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 3.2222933769226074  GigaBytes
Max Memory Allocated: 3.412515640258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 0.15769624710083008  GigaBytes
Max Memory Allocated: 3.4138336181640625  GigaBytes

torch.Size([167828, 128])
torch.Size([167606, 256])
torch.Size([166973, 256])
torch.Size([164882, 256])
torch.Size([154930, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 3.223360061645508  GigaBytes
Max Memory Allocated: 3.4138336181640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 0.1577134132385254  GigaBytes
Max Memory Allocated: 3.4143424034118652  GigaBytes

torch.Size([167793, 128])
torch.Size([167578, 256])
torch.Size([166968, 256])
torch.Size([164900, 256])
torch.Size([155120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 3.2291932106018066  GigaBytes
Max Memory Allocated: 3.4143424034118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12258905172348022 |0.04951965808868408 |0.01886647939682007 |9.78708267211914e-05 |0.12585175037384033 |0.005641937255859375 |
----------------------------------------------------------pseudo_mini_loss sum 3.769498109817505
Total (block generation + training)time/epoch 33.40134024620056
Training time/epoch 1.5641567707061768
Training time without block to device /epoch 1.3660781383514404
Training time without total dataloading part /epoch 0.5849063396453857
load block tensor time/epoch 0.4903562068939209
block to device time/epoch 0.19807863235473633
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3694050
Number of first layer input nodes during this epoch:  671173
