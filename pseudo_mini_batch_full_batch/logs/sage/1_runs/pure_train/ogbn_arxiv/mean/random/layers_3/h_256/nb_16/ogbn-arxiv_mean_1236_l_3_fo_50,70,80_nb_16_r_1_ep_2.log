Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648444996.3253832
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027584314346313477
random selection method range initialization spend 0.0066335201263427734
time for parepare:  0.01911163330078125
local_output_nid generation:  0.0022284984588623047
local_in_edges_tensor generation:  0.003876209259033203
mini_batch_src_global generation:  0.0020325183868408203
r_  generation:  0.021070480346679688
local_output_nid generation:  0.0028977394104003906
local_in_edges_tensor generation:  0.0017266273498535156
mini_batch_src_global generation:  0.002386808395385742
r_  generation:  0.021077394485473633
local_output_nid generation:  0.0030012130737304688
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.0016934871673583984
r_  generation:  0.02159714698791504
local_output_nid generation:  0.0030307769775390625
local_in_edges_tensor generation:  0.0016672611236572266
mini_batch_src_global generation:  0.001650094985961914
r_  generation:  0.020907878875732422
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.0015437602996826172
mini_batch_src_global generation:  0.0015478134155273438
r_  generation:  0.020333290100097656
local_output_nid generation:  0.002969503402709961
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.0016906261444091797
r_  generation:  0.02215862274169922
local_output_nid generation:  0.002989053726196289
local_in_edges_tensor generation:  0.0015530586242675781
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.021979093551635742
local_output_nid generation:  0.003091573715209961
local_in_edges_tensor generation:  0.0016047954559326172
mini_batch_src_global generation:  0.0016543865203857422
r_  generation:  0.021166086196899414
local_output_nid generation:  0.0029823780059814453
local_in_edges_tensor generation:  0.0015769004821777344
mini_batch_src_global generation:  0.001708984375
r_  generation:  0.021986722946166992
local_output_nid generation:  0.003003835678100586
local_in_edges_tensor generation:  0.0016112327575683594
mini_batch_src_global generation:  0.0017752647399902344
r_  generation:  0.02194666862487793
local_output_nid generation:  0.003015756607055664
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.001737833023071289
r_  generation:  0.021813631057739258
local_output_nid generation:  0.0029778480529785156
local_in_edges_tensor generation:  0.0015807151794433594
mini_batch_src_global generation:  0.0017962455749511719
r_  generation:  0.022347450256347656
local_output_nid generation:  0.0029747486114501953
local_in_edges_tensor generation:  0.0015926361083984375
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.022173643112182617
local_output_nid generation:  0.002997875213623047
local_in_edges_tensor generation:  0.0015864372253417969
mini_batch_src_global generation:  0.0017867088317871094
r_  generation:  0.022234678268432617
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.0015530586242675781
mini_batch_src_global generation:  0.001798391342163086
r_  generation:  0.022218942642211914
local_output_nid generation:  0.0029740333557128906
local_in_edges_tensor generation:  0.0016558170318603516
mini_batch_src_global generation:  0.0017879009246826172
r_  generation:  0.02204751968383789
----------------------check_connections_block total spend ----------------------------- 0.558861255645752
generate_one_block  0.031206130981445312
generate_one_block  0.03224587440490723
generate_one_block  0.036130666732788086
generate_one_block  0.03238487243652344
generate_one_block  0.030331850051879883
generate_one_block  0.03268933296203613
generate_one_block  0.03163266181945801
generate_one_block  0.031131267547607422
generate_one_block  0.031990766525268555
generate_one_block  0.031491994857788086
generate_one_block  0.03132009506225586
generate_one_block  0.03229379653930664
generate_one_block  0.03191065788269043
generate_one_block  0.031636953353881836
generate_one_block  0.03161287307739258
generate_one_block  0.031572818756103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04273653030395508
gen group dst list time:  0.02083134651184082
time for parepare:  0.019612550735473633
local_output_nid generation:  0.009256601333618164
local_in_edges_tensor generation:  0.020801305770874023
mini_batch_src_global generation:  0.02790999412536621
r_  generation:  0.25205206871032715
local_output_nid generation:  0.013502120971679688
local_in_edges_tensor generation:  0.02389693260192871
mini_batch_src_global generation:  0.033129215240478516
r_  generation:  0.2628796100616455
local_output_nid generation:  0.013301372528076172
local_in_edges_tensor generation:  0.026575088500976562
mini_batch_src_global generation:  0.032217979431152344
r_  generation:  0.27626562118530273
local_output_nid generation:  0.013021707534790039
local_in_edges_tensor generation:  0.019435405731201172
mini_batch_src_global generation:  0.03262782096862793
r_  generation:  0.2690091133117676
local_output_nid generation:  0.012844562530517578
local_in_edges_tensor generation:  0.013960123062133789
mini_batch_src_global generation:  0.0328984260559082
r_  generation:  0.2642500400543213
local_output_nid generation:  0.01322317123413086
local_in_edges_tensor generation:  0.01965951919555664
mini_batch_src_global generation:  0.03951263427734375
r_  generation:  0.29831719398498535
local_output_nid generation:  0.013812541961669922
local_in_edges_tensor generation:  0.02603459358215332
mini_batch_src_global generation:  0.03876686096191406
r_  generation:  0.2694728374481201
local_output_nid generation:  0.01430368423461914
local_in_edges_tensor generation:  0.019600629806518555
mini_batch_src_global generation:  0.03426766395568848
r_  generation:  0.2633650302886963
local_output_nid generation:  0.01639842987060547
local_in_edges_tensor generation:  0.02177572250366211
mini_batch_src_global generation:  0.03480076789855957
r_  generation:  0.28884267807006836
local_output_nid generation:  0.013472557067871094
local_in_edges_tensor generation:  0.019876718521118164
mini_batch_src_global generation:  0.03519749641418457
r_  generation:  0.27982521057128906
local_output_nid generation:  0.01419210433959961
local_in_edges_tensor generation:  0.015107870101928711
mini_batch_src_global generation:  0.03885531425476074
r_  generation:  0.29128289222717285
local_output_nid generation:  0.016302824020385742
local_in_edges_tensor generation:  0.03246593475341797
mini_batch_src_global generation:  0.03549814224243164
r_  generation:  0.27580738067626953
local_output_nid generation:  0.013512611389160156
local_in_edges_tensor generation:  0.02115345001220703
mini_batch_src_global generation:  0.036977529525756836
r_  generation:  0.27479982376098633
local_output_nid generation:  0.013524770736694336
local_in_edges_tensor generation:  0.014175653457641602
mini_batch_src_global generation:  0.035497426986694336
r_  generation:  0.2883427143096924
local_output_nid generation:  0.013607025146484375
local_in_edges_tensor generation:  0.02131509780883789
mini_batch_src_global generation:  0.03502917289733887
r_  generation:  0.274585485458374
local_output_nid generation:  0.01923823356628418
local_in_edges_tensor generation:  0.018002748489379883
mini_batch_src_global generation:  0.03597378730773926
r_  generation:  0.2686655521392822
----------------------check_connections_block total spend ----------------------------- 6.48138689994812
generate_one_block  0.373183012008667
generate_one_block  0.37139105796813965
generate_one_block  0.3822338581085205
generate_one_block  0.35599589347839355
generate_one_block  0.38371729850769043
generate_one_block  0.37079715728759766
generate_one_block  0.37039947509765625
generate_one_block  0.40023255348205566
generate_one_block  0.36255478858947754
generate_one_block  0.36226439476013184
generate_one_block  0.34552693367004395
generate_one_block  0.3585031032562256
generate_one_block  0.35620927810668945
generate_one_block  0.35663771629333496
generate_one_block  0.3844742774963379
generate_one_block  0.34915709495544434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06022167205810547
gen group dst list time:  0.07384514808654785
time for parepare:  0.022186279296875
local_output_nid generation:  0.02791571617126465
local_in_edges_tensor generation:  0.08063077926635742
mini_batch_src_global generation:  0.06467008590698242
r_  generation:  0.514624834060669
local_output_nid generation:  0.035246849060058594
local_in_edges_tensor generation:  0.053225040435791016
mini_batch_src_global generation:  0.066162109375
r_  generation:  0.5209524631500244
local_output_nid generation:  0.03360748291015625
local_in_edges_tensor generation:  0.04818153381347656
mini_batch_src_global generation:  0.05908846855163574
r_  generation:  0.5354382991790771
local_output_nid generation:  0.03360295295715332
local_in_edges_tensor generation:  0.039075613021850586
mini_batch_src_global generation:  0.060605525970458984
r_  generation:  0.5301239490509033
local_output_nid generation:  0.03336381912231445
local_in_edges_tensor generation:  0.03371691703796387
mini_batch_src_global generation:  0.060979366302490234
r_  generation:  0.5383768081665039
local_output_nid generation:  0.03359031677246094
local_in_edges_tensor generation:  0.03368806838989258
mini_batch_src_global generation:  0.06192207336425781
r_  generation:  0.55586838722229
local_output_nid generation:  0.033768653869628906
local_in_edges_tensor generation:  0.04849076271057129
mini_batch_src_global generation:  0.06285738945007324
r_  generation:  0.545957088470459
local_output_nid generation:  0.03377819061279297
local_in_edges_tensor generation:  0.044280290603637695
mini_batch_src_global generation:  0.0627899169921875
r_  generation:  0.5354714393615723
local_output_nid generation:  0.03362154960632324
local_in_edges_tensor generation:  0.03401350975036621
mini_batch_src_global generation:  0.06250381469726562
r_  generation:  0.5372533798217773
local_output_nid generation:  0.03351259231567383
local_in_edges_tensor generation:  0.048104286193847656
mini_batch_src_global generation:  0.06270003318786621
r_  generation:  0.5388834476470947
local_output_nid generation:  0.03405904769897461
local_in_edges_tensor generation:  0.03839874267578125
mini_batch_src_global generation:  0.06309199333190918
r_  generation:  0.5411064624786377
local_output_nid generation:  0.03423190116882324
local_in_edges_tensor generation:  0.043122291564941406
mini_batch_src_global generation:  0.06303644180297852
r_  generation:  0.5499892234802246
local_output_nid generation:  0.03490734100341797
local_in_edges_tensor generation:  0.04236745834350586
mini_batch_src_global generation:  0.06296062469482422
r_  generation:  0.5584619045257568
local_output_nid generation:  0.03641462326049805
local_in_edges_tensor generation:  0.04430055618286133
mini_batch_src_global generation:  0.06926822662353516
r_  generation:  0.5389785766601562
local_output_nid generation:  0.033995866775512695
local_in_edges_tensor generation:  0.04146003723144531
mini_batch_src_global generation:  0.06286907196044922
r_  generation:  0.5393929481506348
local_output_nid generation:  0.0340268611907959
local_in_edges_tensor generation:  0.04364824295043945
mini_batch_src_global generation:  0.06629371643066406
r_  generation:  0.541393518447876
----------------------check_connections_block total spend ----------------------------- 12.848787546157837
generate_one_block  0.7002034187316895
generate_one_block  0.7007203102111816
generate_one_block  0.7112727165222168
generate_one_block  0.695814847946167
generate_one_block  0.6776599884033203
generate_one_block  0.7009515762329102
generate_one_block  0.7524704933166504
generate_one_block  0.6779465675354004
generate_one_block  0.6756160259246826
generate_one_block  0.7034893035888672
generate_one_block  0.7001943588256836
generate_one_block  0.7073667049407959
generate_one_block  0.6927139759063721
generate_one_block  0.6809821128845215
generate_one_block  0.6743206977844238
generate_one_block  0.698552131652832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  19.330174446105957
block generation total time  17.03355312347412
average batch blocks generation time:  1.0645970702171326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09582090377807617  GigaBytes
Max Memory Allocated: 0.09582090377807617  GigaBytes

torch.Size([157226, 128])
torch.Size([129452, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.7682657241821289  GigaBytes
Max Memory Allocated: 0.8098716735839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5389404296875 GB
    Memory Allocated: 0.09823131561279297  GigaBytes
Max Memory Allocated: 0.8557085990905762  GigaBytes

torch.Size([157730, 128])
torch.Size([130174, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5389404296875 GB
    Memory Allocated: 0.7752265930175781  GigaBytes
Max Memory Allocated: 0.8557085990905762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09940624237060547  GigaBytes
Max Memory Allocated: 0.862614631652832  GigaBytes

torch.Size([157865, 128])
torch.Size([130753, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7809391021728516  GigaBytes
Max Memory Allocated: 0.862614631652832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09820699691772461  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157799, 128])
torch.Size([130038, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7711629867553711  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09783267974853516  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157382, 128])
torch.Size([129286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7622766494750977  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09844589233398438  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157844, 128])
torch.Size([130213, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7791328430175781  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0990743637084961  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157827, 128])
torch.Size([130287, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7722969055175781  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09792757034301758  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157599, 128])
torch.Size([129689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7642102241516113  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0979757308959961  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157104, 128])
torch.Size([129015, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7658061981201172  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09820842742919922  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157682, 128])
torch.Size([130070, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7743468284606934  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09808111190795898  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157639, 128])
torch.Size([129843, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7674150466918945  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09838676452636719  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([158004, 128])
torch.Size([130967, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7799382209777832  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09819364547729492  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157645, 128])
torch.Size([129966, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7705564498901367  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09822654724121094  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157702, 128])
torch.Size([129875, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7742667198181152  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09811115264892578  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157440, 128])
torch.Size([129781, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696361541748047  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09807825088500977  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157595, 128])
torch.Size([129870, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7678289413452148  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055142730474472046 |0.03354424238204956 |0.050520509481430054 |0.00010110437870025635 |0.010758280754089355 |0.0018532276153564453 |
----------------------------------------------------------pseudo_mini_loss sum 6.287378311157227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5331766
Number of first layer input nodes during this epoch:  2522083
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12730693817138672  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02110433578491211
random selection method range initialization spend 0.004879474639892578
time for parepare:  0.017293691635131836
local_output_nid generation:  0.0024127960205078125
local_in_edges_tensor generation:  0.0059621334075927734
mini_batch_src_global generation:  0.0020601749420166016
r_  generation:  0.02008962631225586
local_output_nid generation:  0.002901315689086914
local_in_edges_tensor generation:  0.0017333030700683594
mini_batch_src_global generation:  0.002378225326538086
r_  generation:  0.021034955978393555
local_output_nid generation:  0.002893209457397461
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.020991086959838867
local_output_nid generation:  0.0029354095458984375
local_in_edges_tensor generation:  0.0015325546264648438
mini_batch_src_global generation:  0.001621246337890625
r_  generation:  0.020720243453979492
local_output_nid generation:  0.002876758575439453
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.0016303062438964844
r_  generation:  0.02166128158569336
local_output_nid generation:  0.0029463768005371094
local_in_edges_tensor generation:  0.0014672279357910156
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.020951509475708008
local_output_nid generation:  0.002947568893432617
local_in_edges_tensor generation:  0.001506805419921875
mini_batch_src_global generation:  0.0016798973083496094
r_  generation:  0.021761417388916016
local_output_nid generation:  0.0029141902923583984
local_in_edges_tensor generation:  0.00151824951171875
mini_batch_src_global generation:  0.0016367435455322266
r_  generation:  0.021058082580566406
local_output_nid generation:  0.002919435501098633
local_in_edges_tensor generation:  0.0015041828155517578
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.022236347198486328
local_output_nid generation:  0.0029904842376708984
local_in_edges_tensor generation:  0.001537322998046875
mini_batch_src_global generation:  0.0016984939575195312
r_  generation:  0.021703481674194336
local_output_nid generation:  0.0029196739196777344
local_in_edges_tensor generation:  0.0015077590942382812
mini_batch_src_global generation:  0.0017077922821044922
r_  generation:  0.02156543731689453
local_output_nid generation:  0.002889871597290039
local_in_edges_tensor generation:  0.0014889240264892578
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.02178645133972168
local_output_nid generation:  0.002918720245361328
local_in_edges_tensor generation:  0.0015323162078857422
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.02205634117126465
local_output_nid generation:  0.0029449462890625
local_in_edges_tensor generation:  0.0015225410461425781
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.022709369659423828
local_output_nid generation:  0.0029404163360595703
local_in_edges_tensor generation:  0.0014910697937011719
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.021494388580322266
local_output_nid generation:  0.0029611587524414062
local_in_edges_tensor generation:  0.0015566349029541016
mini_batch_src_global generation:  0.001714944839477539
r_  generation:  0.021902799606323242
----------------------check_connections_block total spend ----------------------------- 0.5514223575592041
generate_one_block  0.03382086753845215
generate_one_block  0.0317535400390625
generate_one_block  0.031237363815307617
generate_one_block  0.031594038009643555
generate_one_block  0.031908273696899414
generate_one_block  0.03320908546447754
generate_one_block  0.03153538703918457
generate_one_block  0.03068709373474121
generate_one_block  0.03183746337890625
generate_one_block  0.031172990798950195
generate_one_block  0.030868053436279297
generate_one_block  0.031174659729003906
generate_one_block  0.03182721138000488
generate_one_block  0.03195309638977051
generate_one_block  0.031030654907226562
generate_one_block  0.03353452682495117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038239479064941406
gen group dst list time:  0.019260883331298828
time for parepare:  0.019467830657958984
local_output_nid generation:  0.009222269058227539
local_in_edges_tensor generation:  0.02196478843688965
mini_batch_src_global generation:  0.02737283706665039
r_  generation:  0.2513923645019531
local_output_nid generation:  0.013510942459106445
local_in_edges_tensor generation:  0.02391219139099121
mini_batch_src_global generation:  0.034744977951049805
r_  generation:  0.2586555480957031
local_output_nid generation:  0.013720273971557617
local_in_edges_tensor generation:  0.02169966697692871
mini_batch_src_global generation:  0.03144073486328125
r_  generation:  0.2639303207397461
local_output_nid generation:  0.013834714889526367
local_in_edges_tensor generation:  0.014604806900024414
mini_batch_src_global generation:  0.03326773643493652
r_  generation:  0.26697492599487305
local_output_nid generation:  0.013280153274536133
local_in_edges_tensor generation:  0.018806934356689453
mini_batch_src_global generation:  0.03345370292663574
r_  generation:  0.2703213691711426
local_output_nid generation:  0.013268470764160156
local_in_edges_tensor generation:  0.014486074447631836
mini_batch_src_global generation:  0.0343470573425293
r_  generation:  0.26514506340026855
local_output_nid generation:  0.01305079460144043
local_in_edges_tensor generation:  0.014568805694580078
mini_batch_src_global generation:  0.03377270698547363
r_  generation:  0.26670002937316895
local_output_nid generation:  0.012824773788452148
local_in_edges_tensor generation:  0.01618194580078125
mini_batch_src_global generation:  0.03352761268615723
r_  generation:  0.25916051864624023
local_output_nid generation:  0.013034582138061523
local_in_edges_tensor generation:  0.019191265106201172
mini_batch_src_global generation:  0.03620266914367676
r_  generation:  0.26880669593811035
local_output_nid generation:  0.012824535369873047
local_in_edges_tensor generation:  0.01658010482788086
mini_batch_src_global generation:  0.03654313087463379
r_  generation:  0.26907896995544434
local_output_nid generation:  0.013011455535888672
local_in_edges_tensor generation:  0.016952991485595703
mini_batch_src_global generation:  0.03448176383972168
r_  generation:  0.2667429447174072
local_output_nid generation:  0.012891769409179688
local_in_edges_tensor generation:  0.02101445198059082
mini_batch_src_global generation:  0.03859758377075195
r_  generation:  0.2682046890258789
local_output_nid generation:  0.01293039321899414
local_in_edges_tensor generation:  0.01690673828125
mini_batch_src_global generation:  0.03498387336730957
r_  generation:  0.27291274070739746
local_output_nid generation:  0.013200998306274414
local_in_edges_tensor generation:  0.021997690200805664
mini_batch_src_global generation:  0.03547930717468262
r_  generation:  0.2761547565460205
local_output_nid generation:  0.012761592864990234
local_in_edges_tensor generation:  0.014369964599609375
mini_batch_src_global generation:  0.03816103935241699
r_  generation:  0.26604795455932617
local_output_nid generation:  0.01294255256652832
local_in_edges_tensor generation:  0.014345884323120117
mini_batch_src_global generation:  0.03415036201477051
r_  generation:  0.26471662521362305
----------------------check_connections_block total spend ----------------------------- 6.241220474243164
generate_one_block  0.3514270782470703
generate_one_block  0.3617987632751465
generate_one_block  0.3526158332824707
generate_one_block  0.35332536697387695
generate_one_block  0.35714054107666016
generate_one_block  0.3444406986236572
generate_one_block  0.3737926483154297
generate_one_block  0.3375668525695801
generate_one_block  0.35257720947265625
generate_one_block  0.35558128356933594
generate_one_block  0.3449592590332031
generate_one_block  0.3489503860473633
generate_one_block  0.3568437099456787
generate_one_block  0.3707420825958252
generate_one_block  0.340517520904541
generate_one_block  0.3388345241546631
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041431427001953125
gen group dst list time:  0.06234622001647949
time for parepare:  0.017946958541870117
local_output_nid generation:  0.026425838470458984
local_in_edges_tensor generation:  0.03847002983093262
mini_batch_src_global generation:  0.05396461486816406
r_  generation:  0.5093703269958496
local_output_nid generation:  0.03260302543640137
local_in_edges_tensor generation:  0.05231356620788574
mini_batch_src_global generation:  0.06275200843811035
r_  generation:  0.525824785232544
local_output_nid generation:  0.03238368034362793
local_in_edges_tensor generation:  0.038400888442993164
mini_batch_src_global generation:  0.05955982208251953
r_  generation:  0.5276885032653809
local_output_nid generation:  0.033983707427978516
local_in_edges_tensor generation:  0.04939579963684082
mini_batch_src_global generation:  0.06103992462158203
r_  generation:  0.5311789512634277
local_output_nid generation:  0.03240537643432617
local_in_edges_tensor generation:  0.08334040641784668
mini_batch_src_global generation:  0.0607907772064209
r_  generation:  0.5340263843536377
local_output_nid generation:  0.033904314041137695
local_in_edges_tensor generation:  0.03846883773803711
mini_batch_src_global generation:  0.061821937561035156
r_  generation:  0.5341577529907227
local_output_nid generation:  0.03262758255004883
local_in_edges_tensor generation:  0.032990217208862305
mini_batch_src_global generation:  0.062334537506103516
r_  generation:  0.532346248626709
local_output_nid generation:  0.035604238510131836
local_in_edges_tensor generation:  0.037993431091308594
mini_batch_src_global generation:  0.07020449638366699
r_  generation:  0.5330724716186523
local_output_nid generation:  0.03251004219055176
local_in_edges_tensor generation:  0.041094064712524414
mini_batch_src_global generation:  0.06559538841247559
r_  generation:  0.5339698791503906
local_output_nid generation:  0.03229641914367676
local_in_edges_tensor generation:  0.04993295669555664
mini_batch_src_global generation:  0.06869649887084961
r_  generation:  0.5374362468719482
local_output_nid generation:  0.03358030319213867
local_in_edges_tensor generation:  0.042195796966552734
mini_batch_src_global generation:  0.06230735778808594
r_  generation:  0.5327613353729248
local_output_nid generation:  0.03314518928527832
local_in_edges_tensor generation:  0.03932309150695801
mini_batch_src_global generation:  0.073760986328125
r_  generation:  0.5353424549102783
local_output_nid generation:  0.03522300720214844
local_in_edges_tensor generation:  0.04758787155151367
mini_batch_src_global generation:  0.062188148498535156
r_  generation:  0.5367157459259033
local_output_nid generation:  0.03414154052734375
local_in_edges_tensor generation:  0.04026985168457031
mini_batch_src_global generation:  0.06235456466674805
r_  generation:  0.555922269821167
local_output_nid generation:  0.03423357009887695
local_in_edges_tensor generation:  0.03769707679748535
mini_batch_src_global generation:  0.06279873847961426
r_  generation:  0.5342464447021484
local_output_nid generation:  0.03373456001281738
local_in_edges_tensor generation:  0.037641048431396484
mini_batch_src_global generation:  0.06245684623718262
r_  generation:  0.5404858589172363
----------------------check_connections_block total spend ----------------------------- 12.688504457473755
generate_one_block  0.6927039623260498
generate_one_block  0.6942484378814697
generate_one_block  0.6876990795135498
generate_one_block  0.6830301284790039
generate_one_block  0.6829323768615723
generate_one_block  0.6846506595611572
generate_one_block  0.6856284141540527
generate_one_block  0.6775991916656494
generate_one_block  0.7134130001068115
generate_one_block  0.6766698360443115
generate_one_block  0.6772012710571289
generate_one_block  0.6781623363494873
generate_one_block  0.6770682334899902
generate_one_block  0.6828644275665283
generate_one_block  0.6772832870483398
generate_one_block  0.6808514595031738
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.12730693817138672  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

connection checking time:  18.92972493171692
block generation total time  16.593119859695435
average batch blocks generation time:  1.0370699912309647
block dataloader generation time/epoch 37.83384847640991
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10086393356323242  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157744, 128])
torch.Size([130436, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7804927825927734  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995317459106445  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

torch.Size([157731, 128])
torch.Size([130646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7817931175231934  GigaBytes
Max Memory Allocated: 0.8704080581665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09989404678344727  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157649, 128])
torch.Size([129888, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7739043235778809  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09982872009277344  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157566, 128])
torch.Size([129942, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7740802764892578  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10088253021240234  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157950, 128])
torch.Size([130534, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7788019180297852  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09981107711791992  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157801, 128])
torch.Size([130426, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7743940353393555  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0997624397277832  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157575, 128])
torch.Size([129543, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7708754539489746  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.0994110107421875  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157344, 128])
torch.Size([129243, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7638039588928223  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.10081195831298828  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157699, 128])
torch.Size([130286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7773127555847168  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09964799880981445  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157399, 128])
torch.Size([130120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.774810791015625  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09969902038574219  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157606, 128])
torch.Size([129895, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7698698043823242  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09984588623046875  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157756, 128])
torch.Size([129702, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7714066505432129  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09980297088623047  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157548, 128])
torch.Size([130439, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7771382331848145  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09995889663696289  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157515, 128])
torch.Size([130563, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7801985740661621  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.1006937026977539  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157777, 128])
torch.Size([129850, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7695431709289551  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.09972238540649414  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

torch.Size([157763, 128])
torch.Size([129955, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.7705702781677246  GigaBytes
Max Memory Allocated: 0.8710274696350098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06114153563976288 |0.012513548135757446 |0.003719434142112732 |9.350478649139404e-05 |0.004003018140792847 |0.0015676021575927734 |
----------------------------------------------------------pseudo_mini_loss sum 3.239043712615967
Total (block generation + training)time/epoch 39.20176362991333
Training time/epoch 1.3676292896270752
Training time without block to device /epoch 1.167412519454956
Training time without total dataloading part /epoch 0.12662291526794434
load block tensor time/epoch 0.978264570236206
block to device time/epoch 0.20021677017211914
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5335384
Number of first layer input nodes during this epoch:  2522423
