Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648509413.9454718
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024652481079101562
random selection method range initialization spend 0.006472349166870117
time for parepare:  0.018400907516479492
local_output_nid generation:  0.008232593536376953
local_in_edges_tensor generation:  0.008964776992797852
mini_batch_src_global generation:  0.006491899490356445
r_  generation:  0.0838785171508789
local_output_nid generation:  0.011669158935546875
local_in_edges_tensor generation:  0.005989551544189453
mini_batch_src_global generation:  0.008625030517578125
r_  generation:  0.08923983573913574
local_output_nid generation:  0.011676311492919922
local_in_edges_tensor generation:  0.006138801574707031
mini_batch_src_global generation:  0.0064544677734375
r_  generation:  0.08889508247375488
local_output_nid generation:  0.011903047561645508
local_in_edges_tensor generation:  0.006067752838134766
mini_batch_src_global generation:  0.007399320602416992
r_  generation:  0.09196066856384277
----------------------check_connections_block total spend ----------------------------- 0.5530877113342285
generate_one_block  0.10204434394836426
generate_one_block  0.10268044471740723
generate_one_block  0.1016237735748291
generate_one_block  0.10230612754821777
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04071497917175293
gen group dst list time:  0.011301994323730469
time for parepare:  0.01960444450378418
local_output_nid generation:  0.01948070526123047
local_in_edges_tensor generation:  0.04298877716064453
mini_batch_src_global generation:  0.03868436813354492
r_  generation:  0.41114187240600586
local_output_nid generation:  0.02851700782775879
local_in_edges_tensor generation:  0.04074239730834961
mini_batch_src_global generation:  0.04789233207702637
r_  generation:  0.4257495403289795
local_output_nid generation:  0.028863906860351562
local_in_edges_tensor generation:  0.030575037002563477
mini_batch_src_global generation:  0.048815011978149414
r_  generation:  0.4330291748046875
local_output_nid generation:  0.028900623321533203
local_in_edges_tensor generation:  0.03022146224975586
mini_batch_src_global generation:  0.05207538604736328
r_  generation:  0.4324228763580322
----------------------check_connections_block total spend ----------------------------- 2.5351383686065674
generate_one_block  0.5770871639251709
generate_one_block  0.5504090785980225
generate_one_block  0.5315251350402832
generate_one_block  0.5492832660675049
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03692436218261719
gen group dst list time:  0.02065563201904297
time for parepare:  0.01888442039489746
local_output_nid generation:  0.02940988540649414
local_in_edges_tensor generation:  0.04812479019165039
mini_batch_src_global generation:  0.05451321601867676
r_  generation:  0.5460076332092285
local_output_nid generation:  0.036446571350097656
local_in_edges_tensor generation:  0.05763077735900879
mini_batch_src_global generation:  0.062404632568359375
r_  generation:  0.5467216968536377
local_output_nid generation:  0.03613758087158203
local_in_edges_tensor generation:  0.04213404655456543
mini_batch_src_global generation:  0.057797908782958984
r_  generation:  0.5617880821228027
local_output_nid generation:  0.03617143630981445
local_in_edges_tensor generation:  0.041785478591918945
mini_batch_src_global generation:  0.060125112533569336
r_  generation:  0.5631427764892578
----------------------check_connections_block total spend ----------------------------- 3.2844340801239014
generate_one_block  0.6900928020477295
generate_one_block  0.7093803882598877
generate_one_block  0.6980781555175781
generate_one_block  0.6993098258972168
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06247758865356445
gen group dst list time:  0.028248310089111328
time for parepare:  0.01858806610107422
local_output_nid generation:  0.03319215774536133
local_in_edges_tensor generation:  0.05903792381286621
mini_batch_src_global generation:  0.051947832107543945
r_  generation:  0.5606634616851807
local_output_nid generation:  0.03928780555725098
local_in_edges_tensor generation:  0.057950735092163086
mini_batch_src_global generation:  0.06874561309814453
r_  generation:  0.5655272006988525
local_output_nid generation:  0.03856992721557617
local_in_edges_tensor generation:  0.05532979965209961
mini_batch_src_global generation:  0.07309198379516602
r_  generation:  0.5649709701538086
local_output_nid generation:  0.03844714164733887
local_in_edges_tensor generation:  0.04918360710144043
mini_batch_src_global generation:  0.06603145599365234
r_  generation:  0.5620920658111572
----------------------check_connections_block total spend ----------------------------- 3.4236390590667725
generate_one_block  0.7091302871704102
generate_one_block  0.7209012508392334
generate_one_block  0.7227747440338135
generate_one_block  0.696540117263794
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06383514404296875
gen group dst list time:  0.02879810333251953
time for parepare:  0.018743038177490234
local_output_nid generation:  0.033197879791259766
local_in_edges_tensor generation:  0.05619478225708008
mini_batch_src_global generation:  0.05147528648376465
r_  generation:  0.5491781234741211
local_output_nid generation:  0.03914833068847656
local_in_edges_tensor generation:  0.03776860237121582
mini_batch_src_global generation:  0.06279230117797852
r_  generation:  0.5573973655700684
local_output_nid generation:  0.03962087631225586
local_in_edges_tensor generation:  0.04663538932800293
mini_batch_src_global generation:  0.06439876556396484
r_  generation:  0.556403636932373
local_output_nid generation:  0.03918313980102539
local_in_edges_tensor generation:  0.04739546775817871
mini_batch_src_global generation:  0.06348752975463867
r_  generation:  0.5547046661376953
----------------------check_connections_block total spend ----------------------------- 3.3309216499328613
generate_one_block  0.6923632621765137
generate_one_block  0.7047789096832275
generate_one_block  0.6903815269470215
generate_one_block  0.6941583156585693
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027992725372314453
gen group dst list time:  0.025316953659057617
time for parepare:  0.01969122886657715
local_output_nid generation:  0.0356602668762207
local_in_edges_tensor generation:  0.04321551322937012
mini_batch_src_global generation:  0.049845218658447266
r_  generation:  0.5100541114807129
local_output_nid generation:  0.039392709732055664
local_in_edges_tensor generation:  0.052324533462524414
mini_batch_src_global generation:  0.058747053146362305
r_  generation:  0.5210850238800049
local_output_nid generation:  0.03953218460083008
local_in_edges_tensor generation:  0.045362234115600586
mini_batch_src_global generation:  0.06354117393493652
r_  generation:  0.5200848579406738
local_output_nid generation:  0.03973698616027832
local_in_edges_tensor generation:  0.03603672981262207
mini_batch_src_global generation:  0.05892157554626465
r_  generation:  0.5223841667175293
----------------------check_connections_block total spend ----------------------------- 3.13767671585083
generate_one_block  0.6415421962738037
generate_one_block  0.6798818111419678
generate_one_block  0.6467800140380859
generate_one_block  0.6501021385192871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

connection checking time:  15.711809873580933
block generation total time  13.254500389099121
average batch blocks generation time:  3.3136250972747803
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.14241886138916016  GigaBytes
Max Memory Allocated: 0.14241886138916016  GigaBytes

torch.Size([167773, 128])
torch.Size([167528, 64])
torch.Size([166926, 64])
torch.Size([164870, 64])
torch.Size([155048, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.9455428123474121  GigaBytes
Max Memory Allocated: 0.964503288269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14907026290893555  GigaBytes
Max Memory Allocated: 0.9924159049987793  GigaBytes

torch.Size([167746, 128])
torch.Size([167494, 64])
torch.Size([166908, 64])
torch.Size([164925, 64])
torch.Size([155096, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9486026763916016  GigaBytes
Max Memory Allocated: 0.9924159049987793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14901494979858398  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

torch.Size([167788, 128])
torch.Size([167532, 64])
torch.Size([166937, 64])
torch.Size([164982, 64])
torch.Size([155110, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9483695030212402  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14902305603027344  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

torch.Size([167744, 128])
torch.Size([167481, 64])
torch.Size([166816, 64])
torch.Size([164640, 64])
torch.Size([154743, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9479718208312988  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050000548362731934 |0.13256621360778809 |0.18642973899841309 |0.00011909008026123047 |0.04755455255508423 |0.0038406848907470703 |
----------------------------------------------------------pseudo_mini_loss sum 5.145942687988281
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3693481
Number of first layer input nodes during this epoch:  671051
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.2814345359802246  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0286407470703125
random selection method range initialization spend 0.00532078742980957
time for parepare:  0.018079280853271484
local_output_nid generation:  0.008617162704467773
local_in_edges_tensor generation:  0.009005069732666016
mini_batch_src_global generation:  0.006803274154663086
r_  generation:  0.08125114440917969
local_output_nid generation:  0.011905431747436523
local_in_edges_tensor generation:  0.005876779556274414
mini_batch_src_global generation:  0.008999347686767578
r_  generation:  0.08982133865356445
local_output_nid generation:  0.01211094856262207
local_in_edges_tensor generation:  0.0061757564544677734
mini_batch_src_global generation:  0.016455411911010742
r_  generation:  0.09621644020080566
local_output_nid generation:  0.012152433395385742
local_in_edges_tensor generation:  0.005878925323486328
mini_batch_src_global generation:  0.007627725601196289
r_  generation:  0.09836816787719727
----------------------check_connections_block total spend ----------------------------- 0.5828206539154053
generate_one_block  0.11410212516784668
generate_one_block  0.10710430145263672
generate_one_block  0.10887980461120605
generate_one_block  0.10537409782409668
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.06564664840698242
gen group dst list time:  0.010840415954589844
time for parepare:  0.020539045333862305
local_output_nid generation:  0.019335269927978516
local_in_edges_tensor generation:  0.0501551628112793
mini_batch_src_global generation:  0.03794360160827637
r_  generation:  0.4055955410003662
local_output_nid generation:  0.025657176971435547
local_in_edges_tensor generation:  0.04056811332702637
mini_batch_src_global generation:  0.047776222229003906
r_  generation:  0.4223952293395996
local_output_nid generation:  0.024643659591674805
local_in_edges_tensor generation:  0.03352856636047363
mini_batch_src_global generation:  0.04772830009460449
r_  generation:  0.41898274421691895
local_output_nid generation:  0.02459096908569336
local_in_edges_tensor generation:  0.03313279151916504
mini_batch_src_global generation:  0.04900217056274414
r_  generation:  0.4324765205383301
----------------------check_connections_block total spend ----------------------------- 2.50494647026062
generate_one_block  0.544161319732666
generate_one_block  0.5401017665863037
generate_one_block  0.5710465908050537
generate_one_block  0.5434041023254395
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05096721649169922
gen group dst list time:  0.023014545440673828
time for parepare:  0.023458242416381836
local_output_nid generation:  0.054030418395996094
local_in_edges_tensor generation:  0.07380318641662598
mini_batch_src_global generation:  0.053045034408569336
r_  generation:  0.556751012802124
local_output_nid generation:  0.05117297172546387
local_in_edges_tensor generation:  0.05671095848083496
mini_batch_src_global generation:  0.06722474098205566
r_  generation:  0.5823912620544434
local_output_nid generation:  0.049588918685913086
local_in_edges_tensor generation:  0.06258654594421387
mini_batch_src_global generation:  0.0682370662689209
r_  generation:  0.5783708095550537
local_output_nid generation:  0.04613614082336426
local_in_edges_tensor generation:  0.05211782455444336
mini_batch_src_global generation:  0.06211733818054199
r_  generation:  0.6022911071777344
----------------------check_connections_block total spend ----------------------------- 3.5640976428985596
generate_one_block  0.7267179489135742
generate_one_block  0.7436017990112305
generate_one_block  0.7010674476623535
generate_one_block  0.7051291465759277
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04819059371948242
gen group dst list time:  0.03400397300720215
time for parepare:  0.018748998641967773
local_output_nid generation:  0.03491711616516113
local_in_edges_tensor generation:  0.06740498542785645
mini_batch_src_global generation:  0.05114603042602539
r_  generation:  0.5644378662109375
local_output_nid generation:  0.04075360298156738
local_in_edges_tensor generation:  0.06065106391906738
mini_batch_src_global generation:  0.07176399230957031
r_  generation:  0.5802385807037354
local_output_nid generation:  0.04259157180786133
local_in_edges_tensor generation:  0.06094694137573242
mini_batch_src_global generation:  0.07062149047851562
r_  generation:  0.5687892436981201
local_output_nid generation:  0.04265403747558594
local_in_edges_tensor generation:  0.043263912200927734
mini_batch_src_global generation:  0.0632486343383789
r_  generation:  0.5686993598937988
----------------------check_connections_block total spend ----------------------------- 3.4757866859436035
generate_one_block  0.7044501304626465
generate_one_block  0.734961986541748
generate_one_block  0.6993446350097656
generate_one_block  0.7154808044433594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04740285873413086
gen group dst list time:  0.024431228637695312
time for parepare:  0.019341230392456055
local_output_nid generation:  0.03351187705993652
local_in_edges_tensor generation:  0.05250144004821777
mini_batch_src_global generation:  0.04952836036682129
r_  generation:  0.5461931228637695
local_output_nid generation:  0.039984941482543945
local_in_edges_tensor generation:  0.043648481369018555
mini_batch_src_global generation:  0.06314730644226074
r_  generation:  0.5577683448791504
local_output_nid generation:  0.0398404598236084
local_in_edges_tensor generation:  0.04090237617492676
mini_batch_src_global generation:  0.06354212760925293
r_  generation:  0.5557053089141846
local_output_nid generation:  0.04056882858276367
local_in_edges_tensor generation:  0.04064464569091797
mini_batch_src_global generation:  0.06470584869384766
r_  generation:  0.5615103244781494
----------------------check_connections_block total spend ----------------------------- 3.3398754596710205
generate_one_block  0.6995739936828613
generate_one_block  0.7277302742004395
generate_one_block  0.7258949279785156
generate_one_block  0.6945967674255371
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03660297393798828
gen group dst list time:  0.028426647186279297
time for parepare:  0.018746137619018555
local_output_nid generation:  0.03439903259277344
local_in_edges_tensor generation:  0.05475616455078125
mini_batch_src_global generation:  0.045744895935058594
r_  generation:  0.5107154846191406
local_output_nid generation:  0.041374921798706055
local_in_edges_tensor generation:  0.0559537410736084
mini_batch_src_global generation:  0.057633161544799805
r_  generation:  0.5187251567840576
local_output_nid generation:  0.040010929107666016
local_in_edges_tensor generation:  0.05090951919555664
mini_batch_src_global generation:  0.0585784912109375
r_  generation:  0.5191466808319092
local_output_nid generation:  0.03961944580078125
local_in_edges_tensor generation:  0.03810834884643555
mini_batch_src_global generation:  0.05835723876953125
r_  generation:  0.5257868766784668
----------------------check_connections_block total spend ----------------------------- 3.156841278076172
generate_one_block  0.6333930492401123
generate_one_block  0.6476898193359375
generate_one_block  0.6472330093383789
generate_one_block  0.6775619983673096
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.2814345359802246  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

connection checking time:  16.041547536849976
block generation total time  13.38314151763916
average batch blocks generation time:  3.34578537940979
block dataloader generation time/epoch 32.05894136428833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14943742752075195  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

torch.Size([167750, 128])
torch.Size([167511, 64])
torch.Size([166922, 64])
torch.Size([164835, 64])
torch.Size([154936, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9480443000793457  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14944171905517578  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

torch.Size([167761, 128])
torch.Size([167551, 64])
torch.Size([166945, 64])
torch.Size([164898, 64])
torch.Size([155170, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9491782188415527  GigaBytes
Max Memory Allocated: 0.9948229789733887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.14942455291748047  GigaBytes
Max Memory Allocated: 0.9953646659851074  GigaBytes

torch.Size([167748, 128])
torch.Size([167509, 64])
torch.Size([166886, 64])
torch.Size([164809, 64])
torch.Size([155007, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.9485368728637695  GigaBytes
Max Memory Allocated: 0.9953646659851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.14945077896118164  GigaBytes
Max Memory Allocated: 0.9953646659851074  GigaBytes

torch.Size([167774, 128])
torch.Size([167541, 64])
torch.Size([166902, 64])
torch.Size([164767, 64])
torch.Size([154884, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.9489555358886719  GigaBytes
Max Memory Allocated: 0.9953646659851074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08824437856674194 |0.05185556411743164 |0.007221400737762451 |9.840726852416992e-05 |0.007973849773406982 |0.005561113357543945 |
----------------------------------------------------------pseudo_mini_loss sum 4.075313568115234
Total (block generation + training)time/epoch 32.75860929489136
Training time/epoch 0.6993370056152344
Training time without block to device /epoch 0.4919147491455078
Training time without total dataloading part /epoch 0.06673574447631836
load block tensor time/epoch 0.3529775142669678
block to device time/epoch 0.20742225646972656
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3692937
Number of first layer input nodes during this epoch:  671033
