Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648492008.1715202
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.023737668991088867
random selection method range initialization spend 0.006556987762451172
time for parepare:  0.019074201583862305
local_output_nid generation:  0.004280567169189453
local_in_edges_tensor generation:  0.005142688751220703
mini_batch_src_global generation:  0.003301858901977539
r_  generation:  0.038214921951293945
local_output_nid generation:  0.005974769592285156
local_in_edges_tensor generation:  0.003070354461669922
mini_batch_src_global generation:  0.004247188568115234
r_  generation:  0.03951239585876465
local_output_nid generation:  0.006117820739746094
local_in_edges_tensor generation:  0.00316619873046875
mini_batch_src_global generation:  0.0027899742126464844
r_  generation:  0.038814544677734375
local_output_nid generation:  0.0061473846435546875
local_in_edges_tensor generation:  0.0031604766845703125
mini_batch_src_global generation:  0.002999544143676758
r_  generation:  0.04128265380859375
local_output_nid generation:  0.00609278678894043
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.0031435489654541016
r_  generation:  0.041671037673950195
local_output_nid generation:  0.006121635437011719
local_in_edges_tensor generation:  0.0032219886779785156
mini_batch_src_global generation:  0.003296375274658203
r_  generation:  0.04173564910888672
local_output_nid generation:  0.006109714508056641
local_in_edges_tensor generation:  0.0031807422637939453
mini_batch_src_global generation:  0.003339052200317383
r_  generation:  0.04147648811340332
local_output_nid generation:  0.006079912185668945
local_in_edges_tensor generation:  0.003137826919555664
mini_batch_src_global generation:  0.0034530162811279297
r_  generation:  0.04318499565124512
----------------------check_connections_block total spend ----------------------------- 0.5245120525360107
generate_one_block  0.05473732948303223
generate_one_block  0.05568528175354004
generate_one_block  0.054908037185668945
generate_one_block  0.05659151077270508
generate_one_block  0.05865836143493652
generate_one_block  0.05573391914367676
generate_one_block  0.055715084075927734
generate_one_block  0.05733966827392578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03915262222290039
gen group dst list time:  0.015460014343261719
time for parepare:  0.019455671310424805
local_output_nid generation:  0.013589620590209961
local_in_edges_tensor generation:  0.031232833862304688
mini_batch_src_global generation:  0.028256654739379883
r_  generation:  0.29431772232055664
local_output_nid generation:  0.02126312255859375
local_in_edges_tensor generation:  0.029548168182373047
mini_batch_src_global generation:  0.03921103477478027
r_  generation:  0.32149267196655273
local_output_nid generation:  0.020846128463745117
local_in_edges_tensor generation:  0.027074813842773438
mini_batch_src_global generation:  0.03551459312438965
r_  generation:  0.32131028175354004
local_output_nid generation:  0.022782325744628906
local_in_edges_tensor generation:  0.03704524040222168
mini_batch_src_global generation:  0.04877638816833496
r_  generation:  0.3268852233886719
local_output_nid generation:  0.019665956497192383
local_in_edges_tensor generation:  0.022161483764648438
mini_batch_src_global generation:  0.03792595863342285
r_  generation:  0.3219733238220215
local_output_nid generation:  0.018889904022216797
local_in_edges_tensor generation:  0.021213054656982422
mini_batch_src_global generation:  0.0389552116394043
r_  generation:  0.3238668441772461
local_output_nid generation:  0.018639326095581055
local_in_edges_tensor generation:  0.023882150650024414
mini_batch_src_global generation:  0.039052486419677734
r_  generation:  0.328167200088501
local_output_nid generation:  0.018844127655029297
local_in_edges_tensor generation:  0.020876169204711914
mini_batch_src_global generation:  0.03910112380981445
r_  generation:  0.3303968906402588
----------------------check_connections_block total spend ----------------------------- 3.8151323795318604
generate_one_block  0.43212151527404785
generate_one_block  0.4197196960449219
generate_one_block  0.4102764129638672
generate_one_block  0.4218935966491699
generate_one_block  0.40613412857055664
generate_one_block  0.42453551292419434
generate_one_block  0.41423463821411133
generate_one_block  0.40912938117980957
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05489826202392578
gen group dst list time:  0.03598189353942871
time for parepare:  0.019229650497436523
local_output_nid generation:  0.028029203414916992
local_in_edges_tensor generation:  0.0615842342376709
mini_batch_src_global generation:  0.05608844757080078
r_  generation:  0.5446302890777588
local_output_nid generation:  0.038281917572021484
local_in_edges_tensor generation:  0.06180596351623535
mini_batch_src_global generation:  0.0841987133026123
r_  generation:  0.5893795490264893
local_output_nid generation:  0.042580604553222656
local_in_edges_tensor generation:  0.062131404876708984
mini_batch_src_global generation:  0.08446145057678223
r_  generation:  0.5702090263366699
local_output_nid generation:  0.036521196365356445
local_in_edges_tensor generation:  0.04362750053405762
mini_batch_src_global generation:  0.06573796272277832
r_  generation:  0.5631821155548096
local_output_nid generation:  0.03907489776611328
local_in_edges_tensor generation:  0.05398368835449219
mini_batch_src_global generation:  0.0667886734008789
r_  generation:  0.566338062286377
local_output_nid generation:  0.03612351417541504
local_in_edges_tensor generation:  0.03783679008483887
mini_batch_src_global generation:  0.06519508361816406
r_  generation:  0.5653538703918457
local_output_nid generation:  0.03925728797912598
local_in_edges_tensor generation:  0.05148911476135254
mini_batch_src_global generation:  0.06830286979675293
r_  generation:  0.5537471771240234
local_output_nid generation:  0.03634357452392578
local_in_edges_tensor generation:  0.04231691360473633
mini_batch_src_global generation:  0.061705827713012695
r_  generation:  0.5830621719360352
----------------------check_connections_block total spend ----------------------------- 6.832762241363525
generate_one_block  0.7338674068450928
generate_one_block  0.7112257480621338
generate_one_block  0.7276973724365234
generate_one_block  0.6995799541473389
generate_one_block  0.6785018444061279
generate_one_block  0.6817657947540283
generate_one_block  0.7196609973907471
generate_one_block  0.6797895431518555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03834414482116699
gen group dst list time:  0.044801950454711914
time for parepare:  0.0189821720123291
local_output_nid generation:  0.03393077850341797
local_in_edges_tensor generation:  0.06949877738952637
mini_batch_src_global generation:  0.05318737030029297
r_  generation:  0.5346260070800781
local_output_nid generation:  0.039637088775634766
local_in_edges_tensor generation:  0.054987430572509766
mini_batch_src_global generation:  0.061788320541381836
r_  generation:  0.5523614883422852
local_output_nid generation:  0.03883528709411621
local_in_edges_tensor generation:  0.04530954360961914
mini_batch_src_global generation:  0.06149125099182129
r_  generation:  0.549846887588501
local_output_nid generation:  0.040428876876831055
local_in_edges_tensor generation:  0.043633222579956055
mini_batch_src_global generation:  0.058709144592285156
r_  generation:  0.5584304332733154
local_output_nid generation:  0.03908514976501465
local_in_edges_tensor generation:  0.04546976089477539
mini_batch_src_global generation:  0.058733463287353516
r_  generation:  0.5648620128631592
local_output_nid generation:  0.0422210693359375
local_in_edges_tensor generation:  0.049451351165771484
mini_batch_src_global generation:  0.06404256820678711
r_  generation:  0.553898811340332
local_output_nid generation:  0.04024100303649902
local_in_edges_tensor generation:  0.04395699501037598
mini_batch_src_global generation:  0.05856609344482422
r_  generation:  0.5549788475036621
local_output_nid generation:  0.04032325744628906
local_in_edges_tensor generation:  0.035391807556152344
mini_batch_src_global generation:  0.05890965461730957
r_  generation:  0.6288001537322998
----------------------check_connections_block total spend ----------------------------- 6.7211668491363525
generate_one_block  0.7241013050079346
generate_one_block  0.6940841674804688
generate_one_block  0.7027993202209473
generate_one_block  0.6878402233123779
generate_one_block  0.6884927749633789
generate_one_block  0.6999547481536865
generate_one_block  0.7313811779022217
generate_one_block  0.6770069599151611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03378462791442871
gen group dst list time:  0.046607255935668945
time for parepare:  0.019597291946411133
local_output_nid generation:  0.03747296333312988
local_in_edges_tensor generation:  0.0510098934173584
mini_batch_src_global generation:  0.04526376724243164
r_  generation:  0.5038199424743652
local_output_nid generation:  0.03995990753173828
local_in_edges_tensor generation:  0.0374755859375
mini_batch_src_global generation:  0.05767512321472168
r_  generation:  0.5089569091796875
local_output_nid generation:  0.04008650779724121
local_in_edges_tensor generation:  0.03712582588195801
mini_batch_src_global generation:  0.059860944747924805
r_  generation:  0.5252692699432373
local_output_nid generation:  0.040143728256225586
local_in_edges_tensor generation:  0.04203081130981445
mini_batch_src_global generation:  0.05749106407165527
r_  generation:  0.5155198574066162
local_output_nid generation:  0.04406118392944336
local_in_edges_tensor generation:  0.04949331283569336
mini_batch_src_global generation:  0.06045341491699219
r_  generation:  0.5271351337432861
local_output_nid generation:  0.04300665855407715
local_in_edges_tensor generation:  0.04677414894104004
mini_batch_src_global generation:  0.05655479431152344
r_  generation:  0.5150730609893799
local_output_nid generation:  0.04110407829284668
local_in_edges_tensor generation:  0.043936967849731445
mini_batch_src_global generation:  0.056983232498168945
r_  generation:  0.512662410736084
local_output_nid generation:  0.04136037826538086
local_in_edges_tensor generation:  0.04670000076293945
mini_batch_src_global generation:  0.056954383850097656
r_  generation:  0.5147473812103271
----------------------check_connections_block total spend ----------------------------- 6.240060329437256
generate_one_block  0.6373205184936523
generate_one_block  0.6428077220916748
generate_one_block  0.6599924564361572
generate_one_block  0.6504662036895752
generate_one_block  0.6430525779724121
generate_one_block  0.6449582576751709
generate_one_block  0.6498775482177734
generate_one_block  0.7035350799560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

connection checking time:  23.609121799468994
block generation total time  19.807804584503174
average batch blocks generation time:  2.4759755730628967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1258983612060547  GigaBytes
Max Memory Allocated: 0.1258983612060547  GigaBytes

torch.Size([166927, 128])
torch.Size([165671, 64])
torch.Size([161230, 64])
torch.Size([141970, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.6875309944152832  GigaBytes
Max Memory Allocated: 0.6992912292480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 0.1277923583984375  GigaBytes
Max Memory Allocated: 0.719062328338623  GigaBytes

torch.Size([166895, 128])
torch.Size([165584, 64])
torch.Size([161120, 64])
torch.Size([141731, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 0.6859498023986816  GigaBytes
Max Memory Allocated: 0.719062328338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12832355499267578  GigaBytes
Max Memory Allocated: 0.719062328338623  GigaBytes

torch.Size([166980, 128])
torch.Size([165785, 64])
torch.Size([161504, 64])
torch.Size([142262, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6867551803588867  GigaBytes
Max Memory Allocated: 0.719062328338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12864208221435547  GigaBytes
Max Memory Allocated: 0.719062328338623  GigaBytes

torch.Size([166912, 128])
torch.Size([165668, 64])
torch.Size([161279, 64])
torch.Size([142362, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.688875675201416  GigaBytes
Max Memory Allocated: 0.719062328338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12844562530517578  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166917, 128])
torch.Size([165622, 64])
torch.Size([161195, 64])
torch.Size([141770, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6876344680786133  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12852954864501953  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166903, 128])
torch.Size([165724, 64])
torch.Size([161309, 64])
torch.Size([142042, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6886696815490723  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12747764587402344  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166958, 128])
torch.Size([165699, 64])
torch.Size([161200, 64])
torch.Size([142085, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6877241134643555  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1273951530456543  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166957, 128])
torch.Size([165660, 64])
torch.Size([161160, 64])
torch.Size([141872, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6864500045776367  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0572642982006073 |0.08176109194755554 |0.0939730703830719 |0.00010341405868530273 |0.02007332444190979 |0.006278276443481445 |
----------------------------------------------------------pseudo_mini_loss sum 5.522068500518799
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5630241
Number of first layer input nodes during this epoch:  1335449
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.22612714767456055  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.020662307739257812
random selection method range initialization spend 0.006851673126220703
time for parepare:  0.01767110824584961
local_output_nid generation:  0.004609823226928711
local_in_edges_tensor generation:  0.005731344223022461
mini_batch_src_global generation:  0.0033071041107177734
r_  generation:  0.039002418518066406
local_output_nid generation:  0.005925178527832031
local_in_edges_tensor generation:  0.0030443668365478516
mini_batch_src_global generation:  0.0057811737060546875
r_  generation:  0.043685197830200195
local_output_nid generation:  0.008882284164428711
local_in_edges_tensor generation:  0.004104137420654297
mini_batch_src_global generation:  0.0031328201293945312
r_  generation:  0.0421757698059082
local_output_nid generation:  0.009002923965454102
local_in_edges_tensor generation:  0.004138946533203125
mini_batch_src_global generation:  0.0032792091369628906
r_  generation:  0.04388141632080078
local_output_nid generation:  0.00904703140258789
local_in_edges_tensor generation:  0.004154205322265625
mini_batch_src_global generation:  0.003534555435180664
r_  generation:  0.04378795623779297
local_output_nid generation:  0.009013652801513672
local_in_edges_tensor generation:  0.0042209625244140625
mini_batch_src_global generation:  0.003930330276489258
r_  generation:  0.04394030570983887
local_output_nid generation:  0.009083747863769531
local_in_edges_tensor generation:  0.004240512847900391
mini_batch_src_global generation:  0.0037648677825927734
r_  generation:  0.04354715347290039
local_output_nid generation:  0.009073972702026367
local_in_edges_tensor generation:  0.004233121871948242
mini_batch_src_global generation:  0.0036966800689697266
r_  generation:  0.04300379753112793
----------------------check_connections_block total spend ----------------------------- 0.579810619354248
generate_one_block  0.06945395469665527
generate_one_block  0.05569028854370117
generate_one_block  0.05469989776611328
generate_one_block  0.05561995506286621
generate_one_block  0.05532026290893555
generate_one_block  0.07030200958251953
generate_one_block  0.056600332260131836
generate_one_block  0.06444096565246582
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04287433624267578
gen group dst list time:  0.016289710998535156
time for parepare:  0.028116703033447266
local_output_nid generation:  0.02732682228088379
local_in_edges_tensor generation:  0.03691267967224121
mini_batch_src_global generation:  0.03301095962524414
r_  generation:  0.30440402030944824
local_output_nid generation:  0.023519277572631836
local_in_edges_tensor generation:  0.03578042984008789
mini_batch_src_global generation:  0.03667926788330078
r_  generation:  0.31411314010620117
local_output_nid generation:  0.028198957443237305
local_in_edges_tensor generation:  0.0431523323059082
mini_batch_src_global generation:  0.04882311820983887
r_  generation:  0.3155086040496826
local_output_nid generation:  0.01962447166442871
local_in_edges_tensor generation:  0.023864030838012695
mini_batch_src_global generation:  0.03724789619445801
r_  generation:  0.311614990234375
local_output_nid generation:  0.020380735397338867
local_in_edges_tensor generation:  0.018103361129760742
mini_batch_src_global generation:  0.03946995735168457
r_  generation:  0.3214123249053955
local_output_nid generation:  0.02064228057861328
local_in_edges_tensor generation:  0.023973703384399414
mini_batch_src_global generation:  0.038710594177246094
r_  generation:  0.3243701457977295
local_output_nid generation:  0.020541906356811523
local_in_edges_tensor generation:  0.023800134658813477
mini_batch_src_global generation:  0.03862643241882324
r_  generation:  0.3187263011932373
local_output_nid generation:  0.02045750617980957
local_in_edges_tensor generation:  0.01803112030029297
mini_batch_src_global generation:  0.0384221076965332
r_  generation:  0.31275057792663574
----------------------check_connections_block total spend ----------------------------- 3.823948860168457
generate_one_block  0.40621519088745117
generate_one_block  0.4112231731414795
generate_one_block  0.4098069667816162
generate_one_block  0.39768385887145996
generate_one_block  0.4116520881652832
generate_one_block  0.4146134853363037
generate_one_block  0.4031696319580078
generate_one_block  0.4366023540496826
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04060626029968262
gen group dst list time:  0.036127328872680664
time for parepare:  0.018034934997558594
local_output_nid generation:  0.02848982810974121
local_in_edges_tensor generation:  0.0644986629486084
mini_batch_src_global generation:  0.04863619804382324
r_  generation:  0.5277090072631836
local_output_nid generation:  0.03475236892700195
local_in_edges_tensor generation:  0.05292940139770508
mini_batch_src_global generation:  0.062108755111694336
r_  generation:  0.55379319190979
local_output_nid generation:  0.037366390228271484
local_in_edges_tensor generation:  0.05855441093444824
mini_batch_src_global generation:  0.06625699996948242
r_  generation:  0.5484204292297363
local_output_nid generation:  0.03652167320251465
local_in_edges_tensor generation:  0.04942202568054199
mini_batch_src_global generation:  0.06272387504577637
r_  generation:  0.5307521820068359
local_output_nid generation:  0.03619265556335449
local_in_edges_tensor generation:  0.03807806968688965
mini_batch_src_global generation:  0.05955672264099121
r_  generation:  0.5471954345703125
local_output_nid generation:  0.03637576103210449
local_in_edges_tensor generation:  0.043053627014160156
mini_batch_src_global generation:  0.06198287010192871
r_  generation:  0.5375816822052002
local_output_nid generation:  0.036246538162231445
local_in_edges_tensor generation:  0.036174774169921875
mini_batch_src_global generation:  0.059828758239746094
r_  generation:  0.5622904300689697
local_output_nid generation:  0.03594183921813965
local_in_edges_tensor generation:  0.033082008361816406
mini_batch_src_global generation:  0.06541872024536133
r_  generation:  0.5384409427642822
----------------------check_connections_block total spend ----------------------------- 6.441256761550903
generate_one_block  0.7030022144317627
generate_one_block  0.6814212799072266
generate_one_block  0.6833679676055908
generate_one_block  0.688969612121582
generate_one_block  0.6952300071716309
generate_one_block  0.6994292736053467
generate_one_block  0.6859734058380127
generate_one_block  0.6820089817047119
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038004159927368164
gen group dst list time:  0.053560495376586914
time for parepare:  0.018762826919555664
local_output_nid generation:  0.03558850288391113
local_in_edges_tensor generation:  0.06662559509277344
mini_batch_src_global generation:  0.05270504951477051
r_  generation:  0.5349948406219482
local_output_nid generation:  0.04143214225769043
local_in_edges_tensor generation:  0.0924367904663086
mini_batch_src_global generation:  0.06151390075683594
r_  generation:  0.5427050590515137
local_output_nid generation:  0.03977179527282715
local_in_edges_tensor generation:  0.05056118965148926
mini_batch_src_global generation:  0.06160545349121094
r_  generation:  0.5417110919952393
local_output_nid generation:  0.03897356986999512
local_in_edges_tensor generation:  0.05018305778503418
mini_batch_src_global generation:  0.05916166305541992
r_  generation:  0.5511648654937744
local_output_nid generation:  0.039008378982543945
local_in_edges_tensor generation:  0.04957914352416992
mini_batch_src_global generation:  0.05886054039001465
r_  generation:  0.5627577304840088
local_output_nid generation:  0.03905797004699707
local_in_edges_tensor generation:  0.04520249366760254
mini_batch_src_global generation:  0.05982708930969238
r_  generation:  0.554436206817627
local_output_nid generation:  0.03911876678466797
local_in_edges_tensor generation:  0.040754079818725586
mini_batch_src_global generation:  0.0596013069152832
r_  generation:  0.5601401329040527
local_output_nid generation:  0.03886842727661133
local_in_edges_tensor generation:  0.04029989242553711
mini_batch_src_global generation:  0.05913281440734863
r_  generation:  0.561305046081543
----------------------check_connections_block total spend ----------------------------- 6.64863133430481
generate_one_block  0.7112576961517334
generate_one_block  0.6926860809326172
generate_one_block  0.6959271430969238
generate_one_block  0.6988651752471924
generate_one_block  0.6946432590484619
generate_one_block  0.6922249794006348
generate_one_block  0.677405834197998
generate_one_block  0.6763162612915039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03268861770629883
gen group dst list time:  0.05033135414123535
time for parepare:  0.018964767456054688
local_output_nid generation:  0.037281036376953125
local_in_edges_tensor generation:  0.051674842834472656
mini_batch_src_global generation:  0.04745078086853027
r_  generation:  0.5053508281707764
local_output_nid generation:  0.041207313537597656
local_in_edges_tensor generation:  0.045801401138305664
mini_batch_src_global generation:  0.05719637870788574
r_  generation:  0.5170421600341797
local_output_nid generation:  0.04185342788696289
local_in_edges_tensor generation:  0.03937244415283203
mini_batch_src_global generation:  0.05785632133483887
r_  generation:  0.5191190242767334
local_output_nid generation:  0.043071746826171875
local_in_edges_tensor generation:  0.03782224655151367
mini_batch_src_global generation:  0.05847907066345215
r_  generation:  0.5095672607421875
local_output_nid generation:  0.04224729537963867
local_in_edges_tensor generation:  0.0377352237701416
mini_batch_src_global generation:  0.05820775032043457
r_  generation:  0.5085122585296631
local_output_nid generation:  0.042368173599243164
local_in_edges_tensor generation:  0.08035445213317871
mini_batch_src_global generation:  0.05664563179016113
r_  generation:  0.5094692707061768
local_output_nid generation:  0.04135894775390625
local_in_edges_tensor generation:  0.03952741622924805
mini_batch_src_global generation:  0.056679487228393555
r_  generation:  0.5114490985870361
local_output_nid generation:  0.04103851318359375
local_in_edges_tensor generation:  0.039778947830200195
mini_batch_src_global generation:  0.057172298431396484
r_  generation:  0.5132324695587158
----------------------check_connections_block total spend ----------------------------- 6.2227795124053955
generate_one_block  0.634540319442749
generate_one_block  0.6495480537414551
generate_one_block  0.6356914043426514
generate_one_block  0.6348381042480469
generate_one_block  0.6429872512817383
generate_one_block  0.6406784057617188
generate_one_block  0.6378247737884521
generate_one_block  0.6366159915924072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.22612714767456055  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

connection checking time:  23.136616468429565
block generation total time  19.462420225143433
average batch blocks generation time:  2.432802528142929
block dataloader generation time/epoch 45.230003118515015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12875938415527344  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166918, 128])
torch.Size([165705, 64])
torch.Size([161365, 64])
torch.Size([142044, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6887903213500977  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1287250518798828  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166920, 128])
torch.Size([165697, 64])
torch.Size([161270, 64])
torch.Size([141941, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6882367134094238  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12886667251586914  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166898, 128])
torch.Size([165685, 64])
torch.Size([161301, 64])
torch.Size([142234, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6891641616821289  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12864017486572266  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166861, 128])
torch.Size([165684, 64])
torch.Size([161407, 64])
torch.Size([142363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6877179145812988  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1289196014404297  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166936, 128])
torch.Size([165801, 64])
torch.Size([161529, 64])
torch.Size([142298, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6892838478088379  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1288003921508789  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

torch.Size([166945, 128])
torch.Size([165735, 64])
torch.Size([161454, 64])
torch.Size([142705, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6893644332885742  GigaBytes
Max Memory Allocated: 0.7209758758544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1288318634033203  GigaBytes
Max Memory Allocated: 0.7213683128356934  GigaBytes

torch.Size([166923, 128])
torch.Size([165712, 64])
torch.Size([161335, 64])
torch.Size([141977, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6885824203491211  GigaBytes
Max Memory Allocated: 0.7213683128356934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1276397705078125  GigaBytes
Max Memory Allocated: 0.7213683128356934  GigaBytes

torch.Size([166889, 128])
torch.Size([165633, 64])
torch.Size([161102, 64])
torch.Size([141525, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6850371360778809  GigaBytes
Max Memory Allocated: 0.7213683128356934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06661352515220642 |0.03838878870010376 |0.00591614842414856 |9.5367431640625e-05 |0.006343424320220947 |0.004927635192871094 |
----------------------------------------------------------pseudo_mini_loss sum 4.435160160064697
Total (block generation + training)time/epoch 46.228909492492676
Training time/epoch 0.9986939430236816
Training time without block to device /epoch 0.6915836334228516
Training time without total dataloading part /epoch 0.10376715660095215
load block tensor time/epoch 0.5329082012176514
block to device time/epoch 0.3071103096008301
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5632231
Number of first layer input nodes during this epoch:  1335290
