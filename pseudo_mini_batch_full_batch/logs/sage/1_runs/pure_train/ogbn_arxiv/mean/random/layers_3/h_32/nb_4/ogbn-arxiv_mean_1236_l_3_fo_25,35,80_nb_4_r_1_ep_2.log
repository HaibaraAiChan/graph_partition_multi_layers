Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648437852.2867248
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02771306037902832
random selection method range initialization spend 0.006479740142822266
time for parepare:  0.018558263778686523
local_output_nid generation:  0.008385419845581055
local_in_edges_tensor generation:  0.009347200393676758
mini_batch_src_global generation:  0.007475376129150391
r_  generation:  0.0916595458984375
local_output_nid generation:  0.011708259582519531
local_in_edges_tensor generation:  0.006308317184448242
mini_batch_src_global generation:  0.010036468505859375
r_  generation:  0.09799885749816895
local_output_nid generation:  0.012011051177978516
local_in_edges_tensor generation:  0.006587028503417969
mini_batch_src_global generation:  0.007703542709350586
r_  generation:  0.10202813148498535
local_output_nid generation:  0.011890649795532227
local_in_edges_tensor generation:  0.006223201751708984
mini_batch_src_global generation:  0.008377790451049805
r_  generation:  0.10235762596130371
----------------------check_connections_block total spend ----------------------------- 0.6078433990478516
generate_one_block  0.11669015884399414
generate_one_block  0.11682581901550293
generate_one_block  0.11709284782409668
generate_one_block  0.1142573356628418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04106307029724121
gen group dst list time:  0.011886835098266602
time for parepare:  0.01958751678466797
local_output_nid generation:  0.02063298225402832
local_in_edges_tensor generation:  0.044114112854003906
mini_batch_src_global generation:  0.043784141540527344
r_  generation:  0.41985011100769043
local_output_nid generation:  0.030447006225585938
local_in_edges_tensor generation:  0.041420698165893555
mini_batch_src_global generation:  0.04963827133178711
r_  generation:  0.4333834648132324
local_output_nid generation:  0.03110957145690918
local_in_edges_tensor generation:  0.035672903060913086
mini_batch_src_global generation:  0.0493168830871582
r_  generation:  0.4438302516937256
local_output_nid generation:  0.030796527862548828
local_in_edges_tensor generation:  0.02688908576965332
mini_batch_src_global generation:  0.050752878189086914
r_  generation:  0.441251277923584
----------------------check_connections_block total spend ----------------------------- 2.597242593765259
generate_one_block  0.5893902778625488
generate_one_block  0.583076000213623
generate_one_block  0.5797631740570068
generate_one_block  0.5586943626403809
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03288888931274414
gen group dst list time:  0.0211029052734375
time for parepare:  0.0198211669921875
local_output_nid generation:  0.030736923217773438
local_in_edges_tensor generation:  0.047714948654174805
mini_batch_src_global generation:  0.04632163047790527
r_  generation:  0.4983036518096924
local_output_nid generation:  0.04551291465759277
local_in_edges_tensor generation:  0.05376839637756348
mini_batch_src_global generation:  0.056032657623291016
r_  generation:  0.5066862106323242
local_output_nid generation:  0.04253268241882324
local_in_edges_tensor generation:  0.04595685005187988
mini_batch_src_global generation:  0.053813934326171875
r_  generation:  0.5104351043701172
local_output_nid generation:  0.042928457260131836
local_in_edges_tensor generation:  0.0412294864654541
mini_batch_src_global generation:  0.052234649658203125
r_  generation:  0.5207159519195557
----------------------check_connections_block total spend ----------------------------- 3.067507743835449
generate_one_block  0.6611843109130859
generate_one_block  0.6814117431640625
generate_one_block  0.6515460014343262
generate_one_block  0.6362357139587402
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  5.664750337600708
block generation total time  4.941301584243774
average batch blocks generation time:  1.2353253960609436
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10225439071655273  GigaBytes
Max Memory Allocated: 0.10225439071655273  GigaBytes

torch.Size([164479, 128])
torch.Size([155590, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.2541847229003906  GigaBytes
Max Memory Allocated: 0.2576618194580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.10657310485839844  GigaBytes
Max Memory Allocated: 0.2774052619934082  GigaBytes

torch.Size([164589, 128])
torch.Size([155665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.25776195526123047  GigaBytes
Max Memory Allocated: 0.2774052619934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.10597372055053711  GigaBytes
Max Memory Allocated: 0.2787661552429199  GigaBytes

torch.Size([164620, 128])
torch.Size([155800, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.2579021453857422  GigaBytes
Max Memory Allocated: 0.2787661552429199  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.10695695877075195  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

torch.Size([164569, 128])
torch.Size([155750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.25742530822753906  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03826165199279785 |0.09969013929367065 |0.18946236371994019 |0.0001309514045715332 |0.022890985012054443 |0.0019085407257080078 |
----------------------------------------------------------pseudo_mini_loss sum 4.996259689331055
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1711007
Number of first layer input nodes during this epoch:  658257
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.15696001052856445  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029924869537353516
random selection method range initialization spend 0.005758047103881836
time for parepare:  0.01937389373779297
local_output_nid generation:  0.008613824844360352
local_in_edges_tensor generation:  0.010156869888305664
mini_batch_src_global generation:  0.007483005523681641
r_  generation:  0.08918285369873047
local_output_nid generation:  0.011734962463378906
local_in_edges_tensor generation:  0.006592750549316406
mini_batch_src_global generation:  0.010971546173095703
r_  generation:  0.09939742088317871
local_output_nid generation:  0.011961936950683594
local_in_edges_tensor generation:  0.0062046051025390625
mini_batch_src_global generation:  0.008228063583374023
r_  generation:  0.10413599014282227
local_output_nid generation:  0.01194310188293457
local_in_edges_tensor generation:  0.006197214126586914
mini_batch_src_global generation:  0.008694887161254883
r_  generation:  0.10576534271240234
----------------------check_connections_block total spend ----------------------------- 0.6193850040435791
generate_one_block  0.1220102310180664
generate_one_block  0.11818742752075195
generate_one_block  0.1193075180053711
generate_one_block  0.11886787414550781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03260016441345215
gen group dst list time:  0.012194395065307617
time for parepare:  0.019146442413330078
local_output_nid generation:  0.020174026489257812
local_in_edges_tensor generation:  0.04571270942687988
mini_batch_src_global generation:  0.044379234313964844
r_  generation:  0.435072660446167
local_output_nid generation:  0.026769638061523438
local_in_edges_tensor generation:  0.04495382308959961
mini_batch_src_global generation:  0.050948381423950195
r_  generation:  0.4415271282196045
local_output_nid generation:  0.02697014808654785
local_in_edges_tensor generation:  0.04022336006164551
mini_batch_src_global generation:  0.05035567283630371
r_  generation:  0.45188307762145996
local_output_nid generation:  0.026627063751220703
local_in_edges_tensor generation:  0.03617715835571289
mini_batch_src_global generation:  0.05097651481628418
r_  generation:  0.44871950149536133
----------------------check_connections_block total spend ----------------------------- 2.6491916179656982
generate_one_block  0.5665895938873291
generate_one_block  0.5703260898590088
generate_one_block  0.6041533946990967
generate_one_block  0.5982620716094971
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05214357376098633
gen group dst list time:  0.025977134704589844
time for parepare:  0.019385814666748047
local_output_nid generation:  0.02951669692993164
local_in_edges_tensor generation:  0.07647490501403809
mini_batch_src_global generation:  0.04584383964538574
r_  generation:  0.4995546340942383
local_output_nid generation:  0.03665637969970703
local_in_edges_tensor generation:  0.054534912109375
mini_batch_src_global generation:  0.0560147762298584
r_  generation:  0.5046043395996094
local_output_nid generation:  0.03705859184265137
local_in_edges_tensor generation:  0.04639911651611328
mini_batch_src_global generation:  0.05382728576660156
r_  generation:  0.5110187530517578
local_output_nid generation:  0.0367124080657959
local_in_edges_tensor generation:  0.046425819396972656
mini_batch_src_global generation:  0.05304145812988281
r_  generation:  0.5177311897277832
----------------------check_connections_block total spend ----------------------------- 3.0749330520629883
generate_one_block  0.652813196182251
generate_one_block  0.6381490230560303
generate_one_block  0.6411600112915039
generate_one_block  0.6479063034057617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.15696001052856445  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

connection checking time:  5.7241246700286865
block generation total time  4.9193596839904785
average batch blocks generation time:  1.2298399209976196
block dataloader generation time/epoch 12.678990364074707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.1059422492980957  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

torch.Size([164510, 128])
torch.Size([155557, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.25476884841918945  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.10712099075317383  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

torch.Size([164504, 128])
torch.Size([155551, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.2546558380126953  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.10614919662475586  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

torch.Size([164718, 128])
torch.Size([155871, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.25822877883911133  GigaBytes
Max Memory Allocated: 0.2796297073364258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.10711050033569336  GigaBytes
Max Memory Allocated: 0.28000974655151367  GigaBytes

torch.Size([164551, 128])
torch.Size([155765, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.2579941749572754  GigaBytes
Max Memory Allocated: 0.28000974655151367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03946501016616821 |0.01818603277206421 |0.00411611795425415 |9.876489639282227e-05 |0.01045382022857666 |0.0015327930450439453 |
----------------------------------------------------------pseudo_mini_loss sum 4.299640655517578
Total (block generation + training)time/epoch 12.99700117111206
Training time/epoch 0.317767858505249
Training time without block to device /epoch 0.2450237274169922
Training time without total dataloading part /epoch 0.06020760536193848
load block tensor time/epoch 0.15786004066467285
block to device time/epoch 0.07274413108825684
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1710581
Number of first layer input nodes during this epoch:  658283
