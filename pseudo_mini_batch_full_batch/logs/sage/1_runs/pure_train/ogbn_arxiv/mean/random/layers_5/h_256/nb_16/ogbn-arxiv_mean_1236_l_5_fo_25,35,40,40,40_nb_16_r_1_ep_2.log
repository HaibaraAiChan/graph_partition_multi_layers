Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648494641.928493
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02398371696472168
random selection method range initialization spend 0.006550312042236328
time for parepare:  0.019231081008911133
local_output_nid generation:  0.002130746841430664
local_in_edges_tensor generation:  0.0037822723388671875
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.01892542839050293
local_output_nid generation:  0.002854585647583008
local_in_edges_tensor generation:  0.0016503334045410156
mini_batch_src_global generation:  0.002187967300415039
r_  generation:  0.018795013427734375
local_output_nid generation:  0.0029408931732177734
local_in_edges_tensor generation:  0.0015556812286376953
mini_batch_src_global generation:  0.001371145248413086
r_  generation:  0.01820659637451172
local_output_nid generation:  0.0029098987579345703
local_in_edges_tensor generation:  0.0014815330505371094
mini_batch_src_global generation:  0.001369476318359375
r_  generation:  0.01876211166381836
local_output_nid generation:  0.002990245819091797
local_in_edges_tensor generation:  0.0014710426330566406
mini_batch_src_global generation:  0.001405954360961914
r_  generation:  0.01888561248779297
local_output_nid generation:  0.0029251575469970703
local_in_edges_tensor generation:  0.0014879703521728516
mini_batch_src_global generation:  0.001417398452758789
r_  generation:  0.0187532901763916
local_output_nid generation:  0.0029098987579345703
local_in_edges_tensor generation:  0.0014307498931884766
mini_batch_src_global generation:  0.0014216899871826172
r_  generation:  0.019255399703979492
local_output_nid generation:  0.0029020309448242188
local_in_edges_tensor generation:  0.0014309883117675781
mini_batch_src_global generation:  0.0014519691467285156
r_  generation:  0.019377708435058594
local_output_nid generation:  0.0028944015502929688
local_in_edges_tensor generation:  0.001512765884399414
mini_batch_src_global generation:  0.001428365707397461
r_  generation:  0.019396066665649414
local_output_nid generation:  0.002931356430053711
local_in_edges_tensor generation:  0.001439809799194336
mini_batch_src_global generation:  0.0014488697052001953
r_  generation:  0.019118309020996094
local_output_nid generation:  0.0029289722442626953
local_in_edges_tensor generation:  0.0014500617980957031
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.019776105880737305
local_output_nid generation:  0.003016233444213867
local_in_edges_tensor generation:  0.0014715194702148438
mini_batch_src_global generation:  0.0014722347259521484
r_  generation:  0.018671512603759766
local_output_nid generation:  0.0029211044311523438
local_in_edges_tensor generation:  0.0014886856079101562
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.019323348999023438
local_output_nid generation:  0.0029125213623046875
local_in_edges_tensor generation:  0.0014655590057373047
mini_batch_src_global generation:  0.0015032291412353516
r_  generation:  0.019495248794555664
local_output_nid generation:  0.0029211044311523438
local_in_edges_tensor generation:  0.0014095306396484375
mini_batch_src_global generation:  0.0015079975128173828
r_  generation:  0.0194854736328125
local_output_nid generation:  0.0029485225677490234
local_in_edges_tensor generation:  0.0014464855194091797
mini_batch_src_global generation:  0.0015118122100830078
r_  generation:  0.019069433212280273
----------------------check_connections_block total spend ----------------------------- 0.4987945556640625
generate_one_block  0.027666807174682617
generate_one_block  0.028899192810058594
generate_one_block  0.027893781661987305
generate_one_block  0.030829429626464844
generate_one_block  0.028578996658325195
generate_one_block  0.028174161911010742
generate_one_block  0.027812719345092773
generate_one_block  0.028059005737304688
generate_one_block  0.027786970138549805
generate_one_block  0.02771759033203125
generate_one_block  0.028092384338378906
generate_one_block  0.02681756019592285
generate_one_block  0.02810811996459961
generate_one_block  0.028255224227905273
generate_one_block  0.02808666229248047
generate_one_block  0.027410507202148438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.038887739181518555
gen group dst list time:  0.018764972686767578
time for parepare:  0.019011497497558594
local_output_nid generation:  0.008270978927612305
local_in_edges_tensor generation:  0.01713848114013672
mini_batch_src_global generation:  0.01983642578125
r_  generation:  0.20084381103515625
local_output_nid generation:  0.012068510055541992
local_in_edges_tensor generation:  0.019906282424926758
mini_batch_src_global generation:  0.02535080909729004
r_  generation:  0.2094578742980957
local_output_nid generation:  0.011762142181396484
local_in_edges_tensor generation:  0.015749692916870117
mini_batch_src_global generation:  0.02379631996154785
r_  generation:  0.20818758010864258
local_output_nid generation:  0.011702537536621094
local_in_edges_tensor generation:  0.015657901763916016
mini_batch_src_global generation:  0.025054216384887695
r_  generation:  0.21244192123413086
local_output_nid generation:  0.011778116226196289
local_in_edges_tensor generation:  0.012520790100097656
mini_batch_src_global generation:  0.03140902519226074
r_  generation:  0.2161731719970703
local_output_nid generation:  0.012004375457763672
local_in_edges_tensor generation:  0.01396489143371582
mini_batch_src_global generation:  0.028011560440063477
r_  generation:  0.21718168258666992
local_output_nid generation:  0.011942863464355469
local_in_edges_tensor generation:  0.012771844863891602
mini_batch_src_global generation:  0.02670907974243164
r_  generation:  0.21861481666564941
local_output_nid generation:  0.011849403381347656
local_in_edges_tensor generation:  0.01611924171447754
mini_batch_src_global generation:  0.0269925594329834
r_  generation:  0.22000384330749512
local_output_nid generation:  0.011992216110229492
local_in_edges_tensor generation:  0.016041278839111328
mini_batch_src_global generation:  0.026960134506225586
r_  generation:  0.22000956535339355
local_output_nid generation:  0.011689901351928711
local_in_edges_tensor generation:  0.012224197387695312
mini_batch_src_global generation:  0.026636123657226562
r_  generation:  0.21334195137023926
local_output_nid generation:  0.011676549911499023
local_in_edges_tensor generation:  0.012349367141723633
mini_batch_src_global generation:  0.02809619903564453
r_  generation:  0.21667885780334473
local_output_nid generation:  0.011632919311523438
local_in_edges_tensor generation:  0.013859748840332031
mini_batch_src_global generation:  0.026158809661865234
r_  generation:  0.21194815635681152
local_output_nid generation:  0.011873960494995117
local_in_edges_tensor generation:  0.01985621452331543
mini_batch_src_global generation:  0.02900409698486328
r_  generation:  0.221909761428833
local_output_nid generation:  0.01187896728515625
local_in_edges_tensor generation:  0.014162302017211914
mini_batch_src_global generation:  0.027664899826049805
r_  generation:  0.22181487083435059
local_output_nid generation:  0.011862993240356445
local_in_edges_tensor generation:  0.01620936393737793
mini_batch_src_global generation:  0.027805805206298828
r_  generation:  0.22355318069458008
local_output_nid generation:  0.011576414108276367
local_in_edges_tensor generation:  0.01251840591430664
mini_batch_src_global generation:  0.026837825775146484
r_  generation:  0.21579265594482422
----------------------check_connections_block total spend ----------------------------- 5.072118043899536
generate_one_block  0.28325843811035156
generate_one_block  0.2924783229827881
generate_one_block  0.2703971862792969
generate_one_block  0.2790844440460205
generate_one_block  0.2985391616821289
generate_one_block  0.27921485900878906
generate_one_block  0.2807285785675049
generate_one_block  0.28250861167907715
generate_one_block  0.285372257232666
generate_one_block  0.2680060863494873
generate_one_block  0.2716505527496338
generate_one_block  0.2662036418914795
generate_one_block  0.28668999671936035
generate_one_block  0.2815055847167969
generate_one_block  0.28961849212646484
generate_one_block  0.2717902660369873
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03444671630859375
gen group dst list time:  0.05920124053955078
time for parepare:  0.018898487091064453
local_output_nid generation:  0.024418354034423828
local_in_edges_tensor generation:  0.04099631309509277
mini_batch_src_global generation:  0.046536922454833984
r_  generation:  0.49680113792419434
local_output_nid generation:  0.030816078186035156
local_in_edges_tensor generation:  0.04921269416809082
mini_batch_src_global generation:  0.057639122009277344
r_  generation:  0.4930884838104248
local_output_nid generation:  0.02994370460510254
local_in_edges_tensor generation:  0.035445451736450195
mini_batch_src_global generation:  0.05682039260864258
r_  generation:  0.5076084136962891
local_output_nid generation:  0.030104875564575195
local_in_edges_tensor generation:  0.03541731834411621
mini_batch_src_global generation:  0.058942556381225586
r_  generation:  0.510199785232544
local_output_nid generation:  0.030262470245361328
local_in_edges_tensor generation:  0.04059600830078125
mini_batch_src_global generation:  0.05771303176879883
r_  generation:  0.5101563930511475
local_output_nid generation:  0.030263185501098633
local_in_edges_tensor generation:  0.03519558906555176
mini_batch_src_global generation:  0.05920529365539551
r_  generation:  0.5049092769622803
local_output_nid generation:  0.03052687644958496
local_in_edges_tensor generation:  0.04018855094909668
mini_batch_src_global generation:  0.05791425704956055
r_  generation:  0.5190768241882324
local_output_nid generation:  0.030776262283325195
local_in_edges_tensor generation:  0.03990292549133301
mini_batch_src_global generation:  0.05939769744873047
r_  generation:  0.5110037326812744
local_output_nid generation:  0.03081059455871582
local_in_edges_tensor generation:  0.03495335578918457
mini_batch_src_global generation:  0.05876588821411133
r_  generation:  0.5118699073791504
local_output_nid generation:  0.030453920364379883
local_in_edges_tensor generation:  0.030827999114990234
mini_batch_src_global generation:  0.05937385559082031
r_  generation:  0.5089740753173828
local_output_nid generation:  0.030704736709594727
local_in_edges_tensor generation:  0.03828120231628418
mini_batch_src_global generation:  0.05806756019592285
r_  generation:  0.5143716335296631
local_output_nid generation:  0.03036189079284668
local_in_edges_tensor generation:  0.031033992767333984
mini_batch_src_global generation:  0.058829307556152344
r_  generation:  0.5008869171142578
local_output_nid generation:  0.03082108497619629
local_in_edges_tensor generation:  0.04007101058959961
mini_batch_src_global generation:  0.058016061782836914
r_  generation:  0.5194041728973389
local_output_nid generation:  0.030458450317382812
local_in_edges_tensor generation:  0.035742759704589844
mini_batch_src_global generation:  0.059275150299072266
r_  generation:  0.507723331451416
local_output_nid generation:  0.030501365661621094
local_in_edges_tensor generation:  0.031528472900390625
mini_batch_src_global generation:  0.06238126754760742
r_  generation:  0.5110998153686523
local_output_nid generation:  0.0305025577545166
local_in_edges_tensor generation:  0.035488128662109375
mini_batch_src_global generation:  0.05888819694519043
r_  generation:  0.5132355690002441
----------------------check_connections_block total spend ----------------------------- 11.853599071502686
generate_one_block  0.6449816226959229
generate_one_block  0.6497898101806641
generate_one_block  0.6446096897125244
generate_one_block  0.6519415378570557
generate_one_block  0.6439917087554932
generate_one_block  0.6472456455230713
generate_one_block  0.6968598365783691
generate_one_block  0.6534051895141602
generate_one_block  0.6606926918029785
generate_one_block  0.6622164249420166
generate_one_block  0.6522610187530518
generate_one_block  0.6434946060180664
generate_one_block  0.6564631462097168
generate_one_block  0.6520471572875977
generate_one_block  0.6480271816253662
generate_one_block  0.6447632312774658
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0534970760345459
gen group dst list time:  0.09658622741699219
time for parepare:  0.019388675689697266
local_output_nid generation:  0.03373885154724121
local_in_edges_tensor generation:  0.07320880889892578
mini_batch_src_global generation:  0.05031156539916992
r_  generation:  0.5274667739868164
local_output_nid generation:  0.03879380226135254
local_in_edges_tensor generation:  0.05562567710876465
mini_batch_src_global generation:  0.06164073944091797
r_  generation:  0.5318853855133057
local_output_nid generation:  0.03762078285217285
local_in_edges_tensor generation:  0.041374921798706055
mini_batch_src_global generation:  0.06254076957702637
r_  generation:  0.5348687171936035
local_output_nid generation:  0.037445783615112305
local_in_edges_tensor generation:  0.04222846031188965
mini_batch_src_global generation:  0.05856895446777344
r_  generation:  0.5388984680175781
local_output_nid generation:  0.03777575492858887
local_in_edges_tensor generation:  0.037113189697265625
mini_batch_src_global generation:  0.05869150161743164
r_  generation:  0.5477290153503418
local_output_nid generation:  0.03807640075683594
local_in_edges_tensor generation:  0.041966915130615234
mini_batch_src_global generation:  0.059426069259643555
r_  generation:  0.5505063533782959
local_output_nid generation:  0.039191484451293945
local_in_edges_tensor generation:  0.042119741439819336
mini_batch_src_global generation:  0.0628509521484375
r_  generation:  0.5619466304779053
local_output_nid generation:  0.03860902786254883
local_in_edges_tensor generation:  0.058225393295288086
mini_batch_src_global generation:  0.05981302261352539
r_  generation:  0.5674388408660889
local_output_nid generation:  0.038394927978515625
local_in_edges_tensor generation:  0.04824709892272949
mini_batch_src_global generation:  0.08573460578918457
r_  generation:  0.5621869564056396
local_output_nid generation:  0.04029107093811035
local_in_edges_tensor generation:  0.0508122444152832
mini_batch_src_global generation:  0.07746767997741699
r_  generation:  0.560791015625
local_output_nid generation:  0.03911423683166504
local_in_edges_tensor generation:  0.0474851131439209
mini_batch_src_global generation:  0.06003141403198242
r_  generation:  0.5618360042572021
local_output_nid generation:  0.039064645767211914
local_in_edges_tensor generation:  0.04634237289428711
mini_batch_src_global generation:  0.05961918830871582
r_  generation:  0.5589776039123535
local_output_nid generation:  0.039261579513549805
local_in_edges_tensor generation:  0.04619646072387695
mini_batch_src_global generation:  0.060079097747802734
r_  generation:  0.5610897541046143
local_output_nid generation:  0.03899335861206055
local_in_edges_tensor generation:  0.03692173957824707
mini_batch_src_global generation:  0.06086397171020508
r_  generation:  0.5573899745941162
local_output_nid generation:  0.038902997970581055
local_in_edges_tensor generation:  0.03731536865234375
mini_batch_src_global generation:  0.06144380569458008
r_  generation:  0.562157154083252
local_output_nid generation:  0.03986620903015137
local_in_edges_tensor generation:  0.037020206451416016
mini_batch_src_global generation:  0.06451988220214844
r_  generation:  0.5594453811645508
----------------------check_connections_block total spend ----------------------------- 13.298548936843872
generate_one_block  0.6864814758300781
generate_one_block  0.6796693801879883
generate_one_block  0.7683868408203125
generate_one_block  0.6860766410827637
generate_one_block  0.6705663204193115
generate_one_block  0.6760289669036865
generate_one_block  0.6953504085540771
generate_one_block  0.6976141929626465
generate_one_block  0.683539867401123
generate_one_block  0.6925413608551025
generate_one_block  0.6840636730194092
generate_one_block  0.6816766262054443
generate_one_block  0.7000119686126709
generate_one_block  0.6808121204376221
generate_one_block  0.6741878986358643
generate_one_block  0.6823520660400391
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04229021072387695
gen group dst list time:  0.09353160858154297
time for parepare:  0.02092289924621582
local_output_nid generation:  0.03665328025817871
local_in_edges_tensor generation:  0.045041561126708984
mini_batch_src_global generation:  0.04502534866333008
r_  generation:  0.5055932998657227
local_output_nid generation:  0.042615652084350586
local_in_edges_tensor generation:  0.03436112403869629
mini_batch_src_global generation:  0.057128190994262695
r_  generation:  0.5133240222930908
local_output_nid generation:  0.039954423904418945
local_in_edges_tensor generation:  0.0369265079498291
mini_batch_src_global generation:  0.05768442153930664
r_  generation:  0.507744312286377
local_output_nid generation:  0.03979969024658203
local_in_edges_tensor generation:  0.03729891777038574
mini_batch_src_global generation:  0.056799888610839844
r_  generation:  0.505786657333374
local_output_nid generation:  0.03982996940612793
local_in_edges_tensor generation:  0.03447604179382324
mini_batch_src_global generation:  0.05701041221618652
r_  generation:  0.5081415176391602
local_output_nid generation:  0.03960013389587402
local_in_edges_tensor generation:  0.037312984466552734
mini_batch_src_global generation:  0.0629422664642334
r_  generation:  0.5281691551208496
local_output_nid generation:  0.042268991470336914
local_in_edges_tensor generation:  0.04071474075317383
mini_batch_src_global generation:  0.05974578857421875
r_  generation:  0.5171663761138916
local_output_nid generation:  0.041492462158203125
local_in_edges_tensor generation:  0.04567432403564453
mini_batch_src_global generation:  0.05722165107727051
r_  generation:  0.5152602195739746
local_output_nid generation:  0.04122662544250488
local_in_edges_tensor generation:  0.04123663902282715
mini_batch_src_global generation:  0.05768465995788574
r_  generation:  0.570537805557251
local_output_nid generation:  0.06442523002624512
local_in_edges_tensor generation:  0.054662466049194336
mini_batch_src_global generation:  0.06572914123535156
r_  generation:  0.5651991367340088
local_output_nid generation:  0.06608438491821289
local_in_edges_tensor generation:  0.05099606513977051
mini_batch_src_global generation:  0.06549620628356934
r_  generation:  0.5769267082214355
local_output_nid generation:  0.06637740135192871
local_in_edges_tensor generation:  0.05438089370727539
mini_batch_src_global generation:  0.06463384628295898
r_  generation:  0.5670835971832275
local_output_nid generation:  0.06591439247131348
local_in_edges_tensor generation:  0.0555882453918457
mini_batch_src_global generation:  0.06575393676757812
r_  generation:  0.5660254955291748
local_output_nid generation:  0.05251669883728027
local_in_edges_tensor generation:  0.04295158386230469
mini_batch_src_global generation:  0.06623458862304688
r_  generation:  0.5408177375793457
local_output_nid generation:  0.044628143310546875
local_in_edges_tensor generation:  0.04422926902770996
mini_batch_src_global generation:  0.06478643417358398
r_  generation:  0.5348889827728271
local_output_nid generation:  0.04190325736999512
local_in_edges_tensor generation:  0.04901456832885742
mini_batch_src_global generation:  0.06015443801879883
r_  generation:  0.561903715133667
----------------------check_connections_block total spend ----------------------------- 13.133138656616211
generate_one_block  0.6801590919494629
generate_one_block  0.6627984046936035
generate_one_block  0.6581487655639648
generate_one_block  0.6564936637878418
generate_one_block  0.7855308055877686
generate_one_block  0.6537528038024902
generate_one_block  0.6599888801574707
generate_one_block  0.6597452163696289
generate_one_block  0.6345257759094238
generate_one_block  0.6548476219177246
generate_one_block  0.6505579948425293
generate_one_block  0.6486012935638428
generate_one_block  0.6631834506988525
generate_one_block  0.6341814994812012
generate_one_block  0.6475751399993896
generate_one_block  0.6553952693939209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

connection checking time:  43.357404708862305
block generation total time  36.58468246459961
average batch blocks generation time:  2.2865426540374756
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12354898452758789  GigaBytes
Max Memory Allocated: 0.12354898452758789  GigaBytes

torch.Size([166337, 128])
torch.Size([164061, 256])
torch.Size([156097, 256])
torch.Size([124558, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5838623046875 GB
    Memory Allocated: 2.068474292755127  GigaBytes
Max Memory Allocated: 2.1073508262634277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 0.1271958351135254  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166195, 128])
torch.Size([163904, 256])
torch.Size([155680, 256])
torch.Size([123685, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0607309341430664  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12697219848632812  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166341, 128])
torch.Size([164129, 256])
torch.Size([156006, 256])
torch.Size([123643, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.059849262237549  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12709569931030273  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166178, 128])
torch.Size([163819, 256])
torch.Size([155663, 256])
torch.Size([123722, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.058913230895996  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12707853317260742  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166258, 128])
torch.Size([163895, 256])
torch.Size([155727, 256])
torch.Size([123473, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0600948333740234  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12708568572998047  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166232, 128])
torch.Size([163873, 256])
torch.Size([155749, 256])
torch.Size([123799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0610952377319336  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12708282470703125  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166300, 128])
torch.Size([163956, 256])
torch.Size([155807, 256])
torch.Size([123650, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0598502159118652  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12714195251464844  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166337, 128])
torch.Size([164081, 256])
torch.Size([155847, 256])
torch.Size([123867, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0625877380371094  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12711668014526367  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166329, 128])
torch.Size([163991, 256])
torch.Size([155887, 256])
torch.Size([124184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0665283203125  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12692928314208984  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166377, 128])
torch.Size([164176, 256])
torch.Size([156145, 256])
torch.Size([123514, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.058838367462158  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12699651718139648  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166210, 128])
torch.Size([163893, 256])
torch.Size([155835, 256])
torch.Size([123493, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.057368278503418  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.1267848014831543  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166325, 128])
torch.Size([164070, 256])
torch.Size([156003, 256])
torch.Size([123427, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0555338859558105  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12715959548950195  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166282, 128])
torch.Size([164081, 256])
torch.Size([155983, 256])
torch.Size([124131, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.067333698272705  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12710905075073242  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166209, 128])
torch.Size([163940, 256])
torch.Size([155790, 256])
torch.Size([123815, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0604782104492188  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12715482711791992  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166280, 128])
torch.Size([163952, 256])
torch.Size([155744, 256])
torch.Size([123694, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0609545707702637  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12691020965576172  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166316, 128])
torch.Size([163990, 256])
torch.Size([155904, 256])
torch.Size([123794, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0587377548217773  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.15861697494983673 |0.058785662055015564 |0.05115655064582825 |9.717047214508057e-05 |0.02925075590610504 |0.007336139678955078 |
----------------------------------------------------------pseudo_mini_loss sum 6.104511260986328
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10419839
Number of first layer input nodes during this epoch:  2660506
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 0.20577335357666016  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.020061492919921875
random selection method range initialization spend 0.005743741989135742
time for parepare:  0.017414093017578125
local_output_nid generation:  0.002376556396484375
local_in_edges_tensor generation:  0.00772547721862793
mini_batch_src_global generation:  0.0018968582153320312
r_  generation:  0.018262863159179688
local_output_nid generation:  0.0028307437896728516
local_in_edges_tensor generation:  0.0016818046569824219
mini_batch_src_global generation:  0.0020401477813720703
r_  generation:  0.01931905746459961
local_output_nid generation:  0.002832174301147461
local_in_edges_tensor generation:  0.0015099048614501953
mini_batch_src_global generation:  0.0014443397521972656
r_  generation:  0.01854419708251953
local_output_nid generation:  0.0028672218322753906
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0014567375183105469
r_  generation:  0.01896047592163086
local_output_nid generation:  0.0028257369995117188
local_in_edges_tensor generation:  0.0014426708221435547
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.019168615341186523
local_output_nid generation:  0.002820253372192383
local_in_edges_tensor generation:  0.0014314651489257812
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.0192718505859375
local_output_nid generation:  0.002915620803833008
local_in_edges_tensor generation:  0.0014653205871582031
mini_batch_src_global generation:  0.0014758110046386719
r_  generation:  0.019604206085205078
local_output_nid generation:  0.0030698776245117188
local_in_edges_tensor generation:  0.0016472339630126953
mini_batch_src_global generation:  0.0015854835510253906
r_  generation:  0.019951820373535156
local_output_nid generation:  0.0031282901763916016
local_in_edges_tensor generation:  0.0014717578887939453
mini_batch_src_global generation:  0.001497030258178711
r_  generation:  0.019664525985717773
local_output_nid generation:  0.0029611587524414062
local_in_edges_tensor generation:  0.0014140605926513672
mini_batch_src_global generation:  0.00157928466796875
r_  generation:  0.019092321395874023
local_output_nid generation:  0.002904653549194336
local_in_edges_tensor generation:  0.0013844966888427734
mini_batch_src_global generation:  0.0016033649444580078
r_  generation:  0.01949477195739746
local_output_nid generation:  0.0029489994049072266
local_in_edges_tensor generation:  0.0014481544494628906
mini_batch_src_global generation:  0.0015797615051269531
r_  generation:  0.02011704444885254
local_output_nid generation:  0.00290679931640625
local_in_edges_tensor generation:  0.0014605522155761719
mini_batch_src_global generation:  0.0015985965728759766
r_  generation:  0.01957392692565918
local_output_nid generation:  0.002936840057373047
local_in_edges_tensor generation:  0.001413583755493164
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.019732952117919922
local_output_nid generation:  0.002911090850830078
local_in_edges_tensor generation:  0.0013720989227294922
mini_batch_src_global generation:  0.0015976428985595703
r_  generation:  0.019445419311523438
local_output_nid generation:  0.0029053688049316406
local_in_edges_tensor generation:  0.0013701915740966797
mini_batch_src_global generation:  0.001535177230834961
r_  generation:  0.019841432571411133
----------------------check_connections_block total spend ----------------------------- 0.5096390247344971
generate_one_block  0.03064751625061035
generate_one_block  0.02808356285095215
generate_one_block  0.026829004287719727
generate_one_block  0.02737593650817871
generate_one_block  0.02762603759765625
generate_one_block  0.029934406280517578
generate_one_block  0.027808666229248047
generate_one_block  0.02764415740966797
generate_one_block  0.027596712112426758
generate_one_block  0.02718210220336914
generate_one_block  0.027549266815185547
generate_one_block  0.027702808380126953
generate_one_block  0.028194665908813477
generate_one_block  0.027712106704711914
generate_one_block  0.027582645416259766
generate_one_block  0.02838420867919922
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.035181522369384766
gen group dst list time:  0.01791977882385254
time for parepare:  0.0217437744140625
local_output_nid generation:  0.008263826370239258
local_in_edges_tensor generation:  0.0345609188079834
mini_batch_src_global generation:  0.018712759017944336
r_  generation:  0.20236587524414062
local_output_nid generation:  0.012413978576660156
local_in_edges_tensor generation:  0.022668838500976562
mini_batch_src_global generation:  0.024728775024414062
r_  generation:  0.21123623847961426
local_output_nid generation:  0.012137413024902344
local_in_edges_tensor generation:  0.017191410064697266
mini_batch_src_global generation:  0.023514270782470703
r_  generation:  0.2063136100769043
local_output_nid generation:  0.012161493301391602
local_in_edges_tensor generation:  0.014007806777954102
mini_batch_src_global generation:  0.026302099227905273
r_  generation:  0.2094264030456543
local_output_nid generation:  0.011811256408691406
local_in_edges_tensor generation:  0.01580023765563965
mini_batch_src_global generation:  0.02757406234741211
r_  generation:  0.2150886058807373
local_output_nid generation:  0.011850595474243164
local_in_edges_tensor generation:  0.012605905532836914
mini_batch_src_global generation:  0.02654123306274414
r_  generation:  0.21284198760986328
local_output_nid generation:  0.012224197387695312
local_in_edges_tensor generation:  0.012162208557128906
mini_batch_src_global generation:  0.028416872024536133
r_  generation:  0.21731996536254883
local_output_nid generation:  0.012466907501220703
local_in_edges_tensor generation:  0.016077041625976562
mini_batch_src_global generation:  0.028405427932739258
r_  generation:  0.23024201393127441
local_output_nid generation:  0.014510869979858398
local_in_edges_tensor generation:  0.01236271858215332
mini_batch_src_global generation:  0.027506113052368164
r_  generation:  0.22014641761779785
local_output_nid generation:  0.013031005859375
local_in_edges_tensor generation:  0.013104915618896484
mini_batch_src_global generation:  0.027268171310424805
r_  generation:  0.21552681922912598
local_output_nid generation:  0.012853384017944336
local_in_edges_tensor generation:  0.013709306716918945
mini_batch_src_global generation:  0.02864670753479004
r_  generation:  0.21766281127929688
local_output_nid generation:  0.012577056884765625
local_in_edges_tensor generation:  0.014041900634765625
mini_batch_src_global generation:  0.026863813400268555
r_  generation:  0.22000336647033691
local_output_nid generation:  0.012403249740600586
local_in_edges_tensor generation:  0.016284942626953125
mini_batch_src_global generation:  0.02886199951171875
r_  generation:  0.21954560279846191
local_output_nid generation:  0.012098550796508789
local_in_edges_tensor generation:  0.012238740921020508
mini_batch_src_global generation:  0.027436256408691406
r_  generation:  0.21863579750061035
local_output_nid generation:  0.012119293212890625
local_in_edges_tensor generation:  0.013983488082885742
mini_batch_src_global generation:  0.02715015411376953
r_  generation:  0.21738958358764648
local_output_nid generation:  0.012258529663085938
local_in_edges_tensor generation:  0.01582479476928711
mini_batch_src_global generation:  0.02762436866760254
r_  generation:  0.22074198722839355
----------------------check_connections_block total spend ----------------------------- 5.107819318771362
generate_one_block  0.28006505966186523
generate_one_block  0.2752523422241211
generate_one_block  0.27173852920532227
generate_one_block  0.2767314910888672
generate_one_block  0.2807788848876953
generate_one_block  0.2746758460998535
generate_one_block  0.302290678024292
generate_one_block  0.2859938144683838
generate_one_block  0.2718994617462158
generate_one_block  0.2745790481567383
generate_one_block  0.28009486198425293
generate_one_block  0.27712249755859375
generate_one_block  0.2846062183380127
generate_one_block  0.2873973846435547
generate_one_block  0.2785031795501709
generate_one_block  0.2854435443878174
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.051174163818359375
gen group dst list time:  0.06076836585998535
time for parepare:  0.01761794090270996
local_output_nid generation:  0.025528907775878906
local_in_edges_tensor generation:  0.05513715744018555
mini_batch_src_global generation:  0.04889225959777832
r_  generation:  0.485532283782959
local_output_nid generation:  0.033199310302734375
local_in_edges_tensor generation:  0.051009416580200195
mini_batch_src_global generation:  0.058347463607788086
r_  generation:  0.5026123523712158
local_output_nid generation:  0.031269073486328125
local_in_edges_tensor generation:  0.05266451835632324
mini_batch_src_global generation:  0.059456825256347656
r_  generation:  0.5143282413482666
local_output_nid generation:  0.031436920166015625
local_in_edges_tensor generation:  0.042761802673339844
mini_batch_src_global generation:  0.07082104682922363
r_  generation:  0.49898433685302734
local_output_nid generation:  0.03307151794433594
local_in_edges_tensor generation:  0.10019540786743164
mini_batch_src_global generation:  0.05731940269470215
r_  generation:  0.5041725635528564
local_output_nid generation:  0.0313417911529541
local_in_edges_tensor generation:  0.0421299934387207
mini_batch_src_global generation:  0.06228804588317871
r_  generation:  0.5144367218017578
local_output_nid generation:  0.031249284744262695
local_in_edges_tensor generation:  0.037279367446899414
mini_batch_src_global generation:  0.05856490135192871
r_  generation:  0.5177278518676758
local_output_nid generation:  0.031374454498291016
local_in_edges_tensor generation:  0.03676247596740723
mini_batch_src_global generation:  0.06282615661621094
r_  generation:  0.5054781436920166
local_output_nid generation:  0.03132891654968262
local_in_edges_tensor generation:  0.03689885139465332
mini_batch_src_global generation:  0.0583345890045166
r_  generation:  0.5063436031341553
local_output_nid generation:  0.03141307830810547
local_in_edges_tensor generation:  0.03521394729614258
mini_batch_src_global generation:  0.05964374542236328
r_  generation:  0.4983680248260498
local_output_nid generation:  0.03105640411376953
local_in_edges_tensor generation:  0.03252148628234863
mini_batch_src_global generation:  0.06158804893493652
r_  generation:  0.5058486461639404
local_output_nid generation:  0.031320810317993164
local_in_edges_tensor generation:  0.03713655471801758
mini_batch_src_global generation:  0.05921316146850586
r_  generation:  0.5006217956542969
local_output_nid generation:  0.03119659423828125
local_in_edges_tensor generation:  0.032886505126953125
mini_batch_src_global generation:  0.058135271072387695
r_  generation:  0.5179495811462402
local_output_nid generation:  0.03255105018615723
local_in_edges_tensor generation:  0.03756093978881836
mini_batch_src_global generation:  0.06097078323364258
r_  generation:  0.49927735328674316
local_output_nid generation:  0.031199932098388672
local_in_edges_tensor generation:  0.04175591468811035
mini_batch_src_global generation:  0.05797004699707031
r_  generation:  0.5035643577575684
local_output_nid generation:  0.031186580657958984
local_in_edges_tensor generation:  0.03681778907775879
mini_batch_src_global generation:  0.06234145164489746
r_  generation:  0.49901437759399414
----------------------check_connections_block total spend ----------------------------- 11.969955444335938
generate_one_block  0.6444110870361328
generate_one_block  0.6467838287353516
generate_one_block  0.6338427066802979
generate_one_block  0.6484463214874268
generate_one_block  0.674473762512207
generate_one_block  0.659611701965332
generate_one_block  0.654341459274292
generate_one_block  0.6525990962982178
generate_one_block  0.6890671253204346
generate_one_block  0.6459865570068359
generate_one_block  0.6553966999053955
generate_one_block  0.6468725204467773
generate_one_block  0.6325352191925049
generate_one_block  0.6589870452880859
generate_one_block  0.6473586559295654
generate_one_block  0.6430392265319824
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05075430870056152
gen group dst list time:  0.09606528282165527
time for parepare:  0.019315481185913086
local_output_nid generation:  0.033388614654541016
local_in_edges_tensor generation:  0.059720754623413086
mini_batch_src_global generation:  0.05218148231506348
r_  generation:  0.5273919105529785
local_output_nid generation:  0.040308237075805664
local_in_edges_tensor generation:  0.05609560012817383
mini_batch_src_global generation:  0.06048893928527832
r_  generation:  0.538886547088623
local_output_nid generation:  0.04015159606933594
local_in_edges_tensor generation:  0.0469202995300293
mini_batch_src_global generation:  0.05779218673706055
r_  generation:  0.5418338775634766
local_output_nid generation:  0.04015207290649414
local_in_edges_tensor generation:  0.03657889366149902
mini_batch_src_global generation:  0.05709981918334961
r_  generation:  0.5398895740509033
local_output_nid generation:  0.0381619930267334
local_in_edges_tensor generation:  0.04184317588806152
mini_batch_src_global generation:  0.057924747467041016
r_  generation:  0.5607266426086426
local_output_nid generation:  0.037639617919921875
local_in_edges_tensor generation:  0.037035226821899414
mini_batch_src_global generation:  0.05825662612915039
r_  generation:  0.5468125343322754
local_output_nid generation:  0.037724971771240234
local_in_edges_tensor generation:  0.04163527488708496
mini_batch_src_global generation:  0.05916333198547363
r_  generation:  0.5550878047943115
local_output_nid generation:  0.0376286506652832
local_in_edges_tensor generation:  0.046823740005493164
mini_batch_src_global generation:  0.06267762184143066
r_  generation:  0.5499789714813232
local_output_nid generation:  0.037642717361450195
local_in_edges_tensor generation:  0.03706789016723633
mini_batch_src_global generation:  0.060450077056884766
r_  generation:  0.5593907833099365
local_output_nid generation:  0.037841081619262695
local_in_edges_tensor generation:  0.041519880294799805
mini_batch_src_global generation:  0.059221506118774414
r_  generation:  0.5559427738189697
local_output_nid generation:  0.03796124458312988
local_in_edges_tensor generation:  0.0495147705078125
mini_batch_src_global generation:  0.06351995468139648
r_  generation:  0.5647096633911133
local_output_nid generation:  0.038774967193603516
local_in_edges_tensor generation:  0.040964603424072266
mini_batch_src_global generation:  0.05931234359741211
r_  generation:  0.5549919605255127
local_output_nid generation:  0.040770769119262695
local_in_edges_tensor generation:  0.03770709037780762
mini_batch_src_global generation:  0.05969977378845215
r_  generation:  0.5588831901550293
local_output_nid generation:  0.038138389587402344
local_in_edges_tensor generation:  0.041916847229003906
mini_batch_src_global generation:  0.05983781814575195
r_  generation:  0.560112714767456
local_output_nid generation:  0.037758588790893555
local_in_edges_tensor generation:  0.03744816780090332
mini_batch_src_global generation:  0.059685707092285156
r_  generation:  0.5608556270599365
local_output_nid generation:  0.03797793388366699
local_in_edges_tensor generation:  0.046100616455078125
mini_batch_src_global generation:  0.06380844116210938
r_  generation:  0.5610463619232178
----------------------check_connections_block total spend ----------------------------- 13.182726621627808
generate_one_block  0.6788666248321533
generate_one_block  0.6822052001953125
generate_one_block  0.699073076248169
generate_one_block  0.6682593822479248
generate_one_block  0.6867659091949463
generate_one_block  0.6893928050994873
generate_one_block  0.7917673587799072
generate_one_block  0.6997051239013672
generate_one_block  0.6844091415405273
generate_one_block  0.6925203800201416
generate_one_block  0.6971526145935059
generate_one_block  0.6783401966094971
generate_one_block  0.6737916469573975
generate_one_block  0.6721701622009277
generate_one_block  0.6788845062255859
generate_one_block  0.6988792419433594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.055528879165649414
gen group dst list time:  0.09393048286437988
time for parepare:  0.018927574157714844
local_output_nid generation:  0.03542900085449219
local_in_edges_tensor generation:  0.050127506256103516
mini_batch_src_global generation:  0.04381966590881348
r_  generation:  0.5078349113464355
local_output_nid generation:  0.04173707962036133
local_in_edges_tensor generation:  0.036108970642089844
mini_batch_src_global generation:  0.057337045669555664
r_  generation:  0.5048072338104248
local_output_nid generation:  0.039730072021484375
local_in_edges_tensor generation:  0.037278175354003906
mini_batch_src_global generation:  0.06834554672241211
r_  generation:  0.5088515281677246
local_output_nid generation:  0.039728641510009766
local_in_edges_tensor generation:  0.036606788635253906
mini_batch_src_global generation:  0.05968737602233887
r_  generation:  0.5046327114105225
local_output_nid generation:  0.0399935245513916
local_in_edges_tensor generation:  0.03683280944824219
mini_batch_src_global generation:  0.05865812301635742
r_  generation:  0.516420841217041
local_output_nid generation:  0.041370391845703125
local_in_edges_tensor generation:  0.041906118392944336
mini_batch_src_global generation:  0.05715179443359375
r_  generation:  0.5097131729125977
local_output_nid generation:  0.04042792320251465
local_in_edges_tensor generation:  0.04077649116516113
mini_batch_src_global generation:  0.05624699592590332
r_  generation:  0.513709545135498
local_output_nid generation:  0.04047560691833496
local_in_edges_tensor generation:  0.05206871032714844
mini_batch_src_global generation:  0.05634140968322754
r_  generation:  0.510075569152832
local_output_nid generation:  0.04034709930419922
local_in_edges_tensor generation:  0.04068112373352051
mini_batch_src_global generation:  0.05699753761291504
r_  generation:  0.5268158912658691
local_output_nid generation:  0.040374040603637695
local_in_edges_tensor generation:  0.049836158752441406
mini_batch_src_global generation:  0.060659170150756836
r_  generation:  0.5228924751281738
local_output_nid generation:  0.040400028228759766
local_in_edges_tensor generation:  0.04604148864746094
mini_batch_src_global generation:  0.05634880065917969
r_  generation:  0.5220108032226562
local_output_nid generation:  0.04065418243408203
local_in_edges_tensor generation:  0.04088115692138672
mini_batch_src_global generation:  0.056684017181396484
r_  generation:  0.5198581218719482
local_output_nid generation:  0.04071855545043945
local_in_edges_tensor generation:  0.045580387115478516
mini_batch_src_global generation:  0.05652952194213867
r_  generation:  0.5224947929382324
local_output_nid generation:  0.040766239166259766
local_in_edges_tensor generation:  0.04358315467834473
mini_batch_src_global generation:  0.06163430213928223
r_  generation:  0.5249669551849365
local_output_nid generation:  0.040839195251464844
local_in_edges_tensor generation:  0.0407557487487793
mini_batch_src_global generation:  0.05593466758728027
r_  generation:  0.5174291133880615
local_output_nid generation:  0.04496359825134277
local_in_edges_tensor generation:  0.04825615882873535
mini_batch_src_global generation:  0.07399797439575195
r_  generation:  0.5284214019775391
----------------------check_connections_block total spend ----------------------------- 12.489681959152222
generate_one_block  0.6361789703369141
generate_one_block  0.6489851474761963
generate_one_block  0.6429686546325684
generate_one_block  0.6412093639373779
generate_one_block  0.6400916576385498
generate_one_block  0.6421830654144287
generate_one_block  0.6438887119293213
generate_one_block  0.6447021961212158
generate_one_block  0.6504509449005127
generate_one_block  0.7327134609222412
generate_one_block  0.6547048091888428
generate_one_block  0.6412229537963867
generate_one_block  0.6409320831298828
generate_one_block  0.6409342288970947
generate_one_block  0.6395676136016846
generate_one_block  0.6554718017578125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 0.20577335357666016  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

connection checking time:  42.75018334388733
block generation total time  36.38931488990784
average batch blocks generation time:  2.27433218061924
block dataloader generation time/epoch 82.14736080169678
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 0.13050460815429688  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166278, 128])
torch.Size([163855, 256])
torch.Size([155392, 256])
torch.Size([123141, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0559396743774414  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1306915283203125  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166325, 128])
torch.Size([164048, 256])
torch.Size([156127, 256])
torch.Size([124180, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0692334175109863  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13051939010620117  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166347, 128])
torch.Size([163995, 256])
torch.Size([155796, 256])
torch.Size([123305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.058999538421631  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13059616088867188  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166049, 128])
torch.Size([163568, 256])
torch.Size([155345, 256])
torch.Size([123360, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0574445724487305  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13068485260009766  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166209, 128])
torch.Size([163869, 256])
torch.Size([155691, 256])
torch.Size([123629, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.064164638519287  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.130615234375  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166273, 128])
torch.Size([163874, 256])
torch.Size([155814, 256])
torch.Size([123932, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.067089557647705  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13066577911376953  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166201, 128])
torch.Size([163806, 256])
torch.Size([155607, 256])
torch.Size([123568, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0602288246154785  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13072824478149414  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166268, 128])
torch.Size([163923, 256])
torch.Size([155818, 256])
torch.Size([124074, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.070253849029541  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13065814971923828  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166264, 128])
torch.Size([163875, 256])
torch.Size([155712, 256])
torch.Size([123779, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.062014579772949  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13059139251708984  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166240, 128])
torch.Size([163895, 256])
torch.Size([155743, 256])
torch.Size([123303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0590386390686035  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13068389892578125  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166171, 128])
torch.Size([163821, 256])
torch.Size([155834, 256])
torch.Size([123968, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.069342613220215  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13064289093017578  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166263, 128])
torch.Size([163892, 256])
torch.Size([155623, 256])
torch.Size([123462, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0614137649536133  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.1307215690612793  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166163, 128])
torch.Size([163696, 256])
torch.Size([155251, 256])
torch.Size([123233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.059736728668213  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13069772720336914  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166285, 128])
torch.Size([163903, 256])
torch.Size([155717, 256])
torch.Size([123920, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0691943168640137  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13062429428100586  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166219, 128])
torch.Size([163768, 256])
torch.Size([155435, 256])
torch.Size([123512, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.0603713989257812  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 0.13071250915527344  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

torch.Size([166302, 128])
torch.Size([164005, 256])
torch.Size([156014, 256])
torch.Size([123943, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3865966796875 GB
    Memory Allocated: 2.071227550506592  GigaBytes
Max Memory Allocated: 2.1502723693847656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18135057389736176 |0.04034072160720825 |0.005944088101387024 |9.272992610931396e-05 |0.005537316203117371 |0.0022878646850585938 |
----------------------------------------------------------pseudo_mini_loss sum 3.531064748764038
Total (block generation + training)time/epoch 86.07110905647278
Training time/epoch 3.9233884811401367
Training time without block to device /epoch 3.2779369354248047
Training time without total dataloading part /epoch 0.18747401237487793
load block tensor time/epoch 2.901609182357788
block to device time/epoch 0.645451545715332
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10411322
Number of first layer input nodes during this epoch:  2659857
