Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648492110.1451554
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.05529356002807617
random selection method range initialization spend 0.006154775619506836
time for parepare:  0.018894672393798828
local_output_nid generation:  0.0021674633026123047
local_in_edges_tensor generation:  0.004629611968994141
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.01810455322265625
local_output_nid generation:  0.0026810169219970703
local_in_edges_tensor generation:  0.001726388931274414
mini_batch_src_global generation:  0.0021436214447021484
r_  generation:  0.018332719802856445
local_output_nid generation:  0.0029342174530029297
local_in_edges_tensor generation:  0.0015628337860107422
mini_batch_src_global generation:  0.0014529228210449219
r_  generation:  0.018157482147216797
local_output_nid generation:  0.0029921531677246094
local_in_edges_tensor generation:  0.0015294551849365234
mini_batch_src_global generation:  0.0014796257019042969
r_  generation:  0.018137454986572266
local_output_nid generation:  0.0029609203338623047
local_in_edges_tensor generation:  0.0015254020690917969
mini_batch_src_global generation:  0.0014290809631347656
r_  generation:  0.018033266067504883
local_output_nid generation:  0.002888917922973633
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.017812013626098633
local_output_nid generation:  0.0028781890869140625
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.018665313720703125
local_output_nid generation:  0.0029151439666748047
local_in_edges_tensor generation:  0.0014977455139160156
mini_batch_src_global generation:  0.0015087127685546875
r_  generation:  0.019490480422973633
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.0015137195587158203
mini_batch_src_global generation:  0.0014786720275878906
r_  generation:  0.01870274543762207
local_output_nid generation:  0.0028581619262695312
local_in_edges_tensor generation:  0.001461029052734375
mini_batch_src_global generation:  0.0014379024505615234
r_  generation:  0.018697500228881836
local_output_nid generation:  0.0029370784759521484
local_in_edges_tensor generation:  0.0014438629150390625
mini_batch_src_global generation:  0.0015115737915039062
r_  generation:  0.018979549407958984
local_output_nid generation:  0.002911090850830078
local_in_edges_tensor generation:  0.0015189647674560547
mini_batch_src_global generation:  0.0015273094177246094
r_  generation:  0.019021987915039062
local_output_nid generation:  0.0029211044311523438
local_in_edges_tensor generation:  0.0015630722045898438
mini_batch_src_global generation:  0.001508951187133789
r_  generation:  0.019007444381713867
local_output_nid generation:  0.002882242202758789
local_in_edges_tensor generation:  0.0014541149139404297
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.019230365753173828
local_output_nid generation:  0.0029134750366210938
local_in_edges_tensor generation:  0.0014984607696533203
mini_batch_src_global generation:  0.0015497207641601562
r_  generation:  0.01923823356628418
local_output_nid generation:  0.002875089645385742
local_in_edges_tensor generation:  0.0015034675598144531
mini_batch_src_global generation:  0.0015513896942138672
r_  generation:  0.01916027069091797
----------------------check_connections_block total spend ----------------------------- 0.4932515621185303
generate_one_block  0.026822328567504883
generate_one_block  0.02790069580078125
generate_one_block  0.027820348739624023
generate_one_block  0.03043508529663086
generate_one_block  0.02768421173095703
generate_one_block  0.02671647071838379
generate_one_block  0.028529882431030273
generate_one_block  0.028689861297607422
generate_one_block  0.027814865112304688
generate_one_block  0.02764606475830078
generate_one_block  0.02751922607421875
generate_one_block  0.028069019317626953
generate_one_block  0.027782678604125977
generate_one_block  0.028500080108642578
generate_one_block  0.028244972229003906
generate_one_block  0.027867555618286133
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.039354801177978516
gen group dst list time:  0.019115447998046875
time for parepare:  0.019234418869018555
local_output_nid generation:  0.008145809173583984
local_in_edges_tensor generation:  0.017285585403442383
mini_batch_src_global generation:  0.01921701431274414
r_  generation:  0.19380807876586914
local_output_nid generation:  0.013695716857910156
local_in_edges_tensor generation:  0.020114660263061523
mini_batch_src_global generation:  0.025278091430664062
r_  generation:  0.20159125328063965
local_output_nid generation:  0.013812065124511719
local_in_edges_tensor generation:  0.016478538513183594
mini_batch_src_global generation:  0.030725479125976562
r_  generation:  0.2074413299560547
local_output_nid generation:  0.013774871826171875
local_in_edges_tensor generation:  0.01637744903564453
mini_batch_src_global generation:  0.024976015090942383
r_  generation:  0.21079516410827637
local_output_nid generation:  0.01398324966430664
local_in_edges_tensor generation:  0.015071392059326172
mini_batch_src_global generation:  0.028852462768554688
r_  generation:  0.21746349334716797
local_output_nid generation:  0.013546228408813477
local_in_edges_tensor generation:  0.013009071350097656
mini_batch_src_global generation:  0.025884389877319336
r_  generation:  0.2082200050354004
local_output_nid generation:  0.014097452163696289
local_in_edges_tensor generation:  0.013520479202270508
mini_batch_src_global generation:  0.02898573875427246
r_  generation:  0.21942663192749023
local_output_nid generation:  0.014074325561523438
local_in_edges_tensor generation:  0.01686692237854004
mini_batch_src_global generation:  0.02751898765563965
r_  generation:  0.21798205375671387
local_output_nid generation:  0.01386260986328125
local_in_edges_tensor generation:  0.01313328742980957
mini_batch_src_global generation:  0.027455806732177734
r_  generation:  0.21534013748168945
local_output_nid generation:  0.01374959945678711
local_in_edges_tensor generation:  0.013024091720581055
mini_batch_src_global generation:  0.026842117309570312
r_  generation:  0.21449923515319824
local_output_nid generation:  0.013915300369262695
local_in_edges_tensor generation:  0.014773368835449219
mini_batch_src_global generation:  0.02880382537841797
r_  generation:  0.21515750885009766
local_output_nid generation:  0.014033317565917969
local_in_edges_tensor generation:  0.018679141998291016
mini_batch_src_global generation:  0.031078338623046875
r_  generation:  0.2196650505065918
local_output_nid generation:  0.013886213302612305
local_in_edges_tensor generation:  0.015064716339111328
mini_batch_src_global generation:  0.027992963790893555
r_  generation:  0.21666216850280762
local_output_nid generation:  0.014046192169189453
local_in_edges_tensor generation:  0.013108015060424805
mini_batch_src_global generation:  0.02793598175048828
r_  generation:  0.22080683708190918
local_output_nid generation:  0.013975858688354492
local_in_edges_tensor generation:  0.016982078552246094
mini_batch_src_global generation:  0.028110504150390625
r_  generation:  0.22083330154418945
local_output_nid generation:  0.013873577117919922
local_in_edges_tensor generation:  0.013249397277832031
mini_batch_src_global generation:  0.027987957000732422
r_  generation:  0.2173154354095459
----------------------check_connections_block total spend ----------------------------- 5.085371971130371
generate_one_block  0.2764732837677002
generate_one_block  0.27392148971557617
generate_one_block  0.27907371520996094
generate_one_block  0.2783939838409424
generate_one_block  0.2983896732330322
generate_one_block  0.2675333023071289
generate_one_block  0.2869994640350342
generate_one_block  0.28820371627807617
generate_one_block  0.27740955352783203
generate_one_block  0.2714958190917969
generate_one_block  0.2738628387451172
generate_one_block  0.2908298969268799
generate_one_block  0.27782678604125977
generate_one_block  0.28365373611450195
generate_one_block  0.29117774963378906
generate_one_block  0.2765359878540039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04009246826171875
gen group dst list time:  0.059250831604003906
time for parepare:  0.01868152618408203
local_output_nid generation:  0.025014877319335938
local_in_edges_tensor generation:  0.0416715145111084
mini_batch_src_global generation:  0.05069470405578613
r_  generation:  0.4821889400482178
local_output_nid generation:  0.030906200408935547
local_in_edges_tensor generation:  0.048976898193359375
mini_batch_src_global generation:  0.057405948638916016
r_  generation:  0.49137067794799805
local_output_nid generation:  0.030453205108642578
local_in_edges_tensor generation:  0.03608345985412598
mini_batch_src_global generation:  0.05779385566711426
r_  generation:  0.49747371673583984
local_output_nid generation:  0.03046131134033203
local_in_edges_tensor generation:  0.049109458923339844
mini_batch_src_global generation:  0.05803489685058594
r_  generation:  0.493330717086792
local_output_nid generation:  0.03068375587463379
local_in_edges_tensor generation:  0.03647446632385254
mini_batch_src_global generation:  0.05919790267944336
r_  generation:  0.502288818359375
local_output_nid generation:  0.03084087371826172
local_in_edges_tensor generation:  0.032062530517578125
mini_batch_src_global generation:  0.06264758110046387
r_  generation:  0.49462437629699707
local_output_nid generation:  0.03086376190185547
local_in_edges_tensor generation:  0.03174161911010742
mini_batch_src_global generation:  0.06228923797607422
r_  generation:  0.5011911392211914
local_output_nid generation:  0.030778169631958008
local_in_edges_tensor generation:  0.049123287200927734
mini_batch_src_global generation:  0.05914926528930664
r_  generation:  0.5024139881134033
local_output_nid generation:  0.03077387809753418
local_in_edges_tensor generation:  0.031404733657836914
mini_batch_src_global generation:  0.059659719467163086
r_  generation:  0.5088949203491211
local_output_nid generation:  0.030640125274658203
local_in_edges_tensor generation:  0.03368234634399414
mini_batch_src_global generation:  0.05940532684326172
r_  generation:  0.4984869956970215
local_output_nid generation:  0.03060293197631836
local_in_edges_tensor generation:  0.03149294853210449
mini_batch_src_global generation:  0.06268906593322754
r_  generation:  0.5074679851531982
local_output_nid generation:  0.03054499626159668
local_in_edges_tensor generation:  0.04917287826538086
mini_batch_src_global generation:  0.060343265533447266
r_  generation:  0.4998438358306885
local_output_nid generation:  0.030486106872558594
local_in_edges_tensor generation:  0.03632760047912598
mini_batch_src_global generation:  0.059119224548339844
r_  generation:  0.5039370059967041
local_output_nid generation:  0.030745506286621094
local_in_edges_tensor generation:  0.040807485580444336
mini_batch_src_global generation:  0.05971980094909668
r_  generation:  0.5016400814056396
local_output_nid generation:  0.031003475189208984
local_in_edges_tensor generation:  0.04096722602844238
mini_batch_src_global generation:  0.0595088005065918
r_  generation:  0.5046477317810059
local_output_nid generation:  0.030681848526000977
local_in_edges_tensor generation:  0.03082561492919922
mini_batch_src_global generation:  0.059406280517578125
r_  generation:  0.5007779598236084
----------------------check_connections_block total spend ----------------------------- 11.741780281066895
generate_one_block  0.6398699283599854
generate_one_block  0.6430151462554932
generate_one_block  0.6474447250366211
generate_one_block  0.6611509323120117
generate_one_block  0.659337043762207
generate_one_block  0.6386334896087646
generate_one_block  0.691889762878418
generate_one_block  0.6533219814300537
generate_one_block  0.6457676887512207
generate_one_block  0.6791203022003174
generate_one_block  0.655113935470581
generate_one_block  0.6575729846954346
generate_one_block  0.672868013381958
generate_one_block  0.681621789932251
generate_one_block  0.6504607200622559
generate_one_block  0.6693911552429199
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04998660087585449
gen group dst list time:  0.10246515274047852
time for parepare:  0.019351720809936523
local_output_nid generation:  0.03392958641052246
local_in_edges_tensor generation:  0.07266831398010254
mini_batch_src_global generation:  0.05043292045593262
r_  generation:  0.5438628196716309
local_output_nid generation:  0.0394744873046875
local_in_edges_tensor generation:  0.05544614791870117
mini_batch_src_global generation:  0.06483030319213867
r_  generation:  0.5347464084625244
local_output_nid generation:  0.0384829044342041
local_in_edges_tensor generation:  0.044211387634277344
mini_batch_src_global generation:  0.05997943878173828
r_  generation:  0.5460314750671387
local_output_nid generation:  0.03987693786621094
local_in_edges_tensor generation:  0.05243825912475586
mini_batch_src_global generation:  0.06035971641540527
r_  generation:  0.5465676784515381
local_output_nid generation:  0.038912296295166016
local_in_edges_tensor generation:  0.04569411277770996
mini_batch_src_global generation:  0.0683891773223877
r_  generation:  0.5655977725982666
local_output_nid generation:  0.04201173782348633
local_in_edges_tensor generation:  0.04416513442993164
mini_batch_src_global generation:  0.06506633758544922
r_  generation:  0.549450159072876
local_output_nid generation:  0.040081024169921875
local_in_edges_tensor generation:  0.04428219795227051
mini_batch_src_global generation:  0.05984330177307129
r_  generation:  0.5559711456298828
local_output_nid generation:  0.03954362869262695
local_in_edges_tensor generation:  0.04911088943481445
mini_batch_src_global generation:  0.05983233451843262
r_  generation:  0.5643658638000488
local_output_nid generation:  0.0442349910736084
local_in_edges_tensor generation:  0.041136741638183594
mini_batch_src_global generation:  0.06037497520446777
r_  generation:  0.5575840473175049
local_output_nid generation:  0.039746999740600586
local_in_edges_tensor generation:  0.04416608810424805
mini_batch_src_global generation:  0.06575989723205566
r_  generation:  0.5559077262878418
local_output_nid generation:  0.039937734603881836
local_in_edges_tensor generation:  0.040656328201293945
mini_batch_src_global generation:  0.06478333473205566
r_  generation:  0.5630464553833008
local_output_nid generation:  0.040956974029541016
local_in_edges_tensor generation:  0.0474703311920166
mini_batch_src_global generation:  0.06116294860839844
r_  generation:  0.5602319240570068
local_output_nid generation:  0.039855003356933594
local_in_edges_tensor generation:  0.03601241111755371
mini_batch_src_global generation:  0.06122946739196777
r_  generation:  0.5648159980773926
local_output_nid generation:  0.04008984565734863
local_in_edges_tensor generation:  0.040859222412109375
mini_batch_src_global generation:  0.061836957931518555
r_  generation:  0.5599627494812012
local_output_nid generation:  0.03995370864868164
local_in_edges_tensor generation:  0.044289588928222656
mini_batch_src_global generation:  0.06065511703491211
r_  generation:  0.5706996917724609
local_output_nid generation:  0.039997100830078125
local_in_edges_tensor generation:  0.048464059829711914
mini_batch_src_global generation:  0.09973716735839844
r_  generation:  0.5581109523773193
----------------------check_connections_block total spend ----------------------------- 13.388878107070923
generate_one_block  0.7065632343292236
generate_one_block  0.6766717433929443
generate_one_block  0.7629306316375732
generate_one_block  0.6852891445159912
generate_one_block  0.6826004981994629
generate_one_block  0.6887121200561523
generate_one_block  0.6691184043884277
generate_one_block  0.673560380935669
generate_one_block  0.672837495803833
generate_one_block  0.6798865795135498
generate_one_block  0.6830670833587646
generate_one_block  0.6786737442016602
generate_one_block  0.6708803176879883
generate_one_block  0.6769788265228271
generate_one_block  0.6812934875488281
generate_one_block  0.6833040714263916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049515485763549805
gen group dst list time:  0.09724545478820801
time for parepare:  0.018984079360961914
local_output_nid generation:  0.035987138748168945
local_in_edges_tensor generation:  0.049097537994384766
mini_batch_src_global generation:  0.04503154754638672
r_  generation:  0.5022182464599609
local_output_nid generation:  0.041672706604003906
local_in_edges_tensor generation:  0.03598737716674805
mini_batch_src_global generation:  0.057060956954956055
r_  generation:  0.5115787982940674
local_output_nid generation:  0.039183855056762695
local_in_edges_tensor generation:  0.036626577377319336
mini_batch_src_global generation:  0.05782461166381836
r_  generation:  0.5062727928161621
local_output_nid generation:  0.039305686950683594
local_in_edges_tensor generation:  0.040804147720336914
mini_batch_src_global generation:  0.05690741539001465
r_  generation:  0.5059647560119629
local_output_nid generation:  0.039176225662231445
local_in_edges_tensor generation:  0.03651618957519531
mini_batch_src_global generation:  0.0575709342956543
r_  generation:  0.5121829509735107
local_output_nid generation:  0.03952956199645996
local_in_edges_tensor generation:  0.03755903244018555
mini_batch_src_global generation:  0.057394981384277344
r_  generation:  0.5095553398132324
local_output_nid generation:  0.03958773612976074
local_in_edges_tensor generation:  0.03676891326904297
mini_batch_src_global generation:  0.05739617347717285
r_  generation:  0.5121855735778809
local_output_nid generation:  0.03961944580078125
local_in_edges_tensor generation:  0.03921246528625488
mini_batch_src_global generation:  0.05693554878234863
r_  generation:  0.5112500190734863
local_output_nid generation:  0.03972959518432617
local_in_edges_tensor generation:  0.04205441474914551
mini_batch_src_global generation:  0.05751848220825195
r_  generation:  0.5153954029083252
local_output_nid generation:  0.03927421569824219
local_in_edges_tensor generation:  0.05200839042663574
mini_batch_src_global generation:  0.056389808654785156
r_  generation:  0.5128679275512695
local_output_nid generation:  0.03923177719116211
local_in_edges_tensor generation:  0.04223489761352539
mini_batch_src_global generation:  0.05660271644592285
r_  generation:  0.5161917209625244
local_output_nid generation:  0.03942251205444336
local_in_edges_tensor generation:  0.055344343185424805
mini_batch_src_global generation:  0.06576085090637207
r_  generation:  0.5150430202484131
local_output_nid generation:  0.04113888740539551
local_in_edges_tensor generation:  0.04184699058532715
mini_batch_src_global generation:  0.06081104278564453
r_  generation:  0.5178897380828857
local_output_nid generation:  0.04037976264953613
local_in_edges_tensor generation:  0.03946065902709961
mini_batch_src_global generation:  0.06225228309631348
r_  generation:  0.5159764289855957
local_output_nid generation:  0.0408935546875
local_in_edges_tensor generation:  0.04109954833984375
mini_batch_src_global generation:  0.06045722961425781
r_  generation:  0.5179266929626465
local_output_nid generation:  0.04041790962219238
local_in_edges_tensor generation:  0.045441627502441406
mini_batch_src_global generation:  0.05767703056335449
r_  generation:  0.5169401168823242
----------------------check_connections_block total spend ----------------------------- 12.374844074249268
generate_one_block  0.6238634586334229
generate_one_block  0.6289715766906738
generate_one_block  0.6311023235321045
generate_one_block  0.6365797519683838
generate_one_block  0.72212815284729
generate_one_block  0.636925220489502
generate_one_block  0.6289467811584473
generate_one_block  0.6312587261199951
generate_one_block  0.6394832134246826
generate_one_block  0.6322219371795654
generate_one_block  0.6394040584564209
generate_one_block  0.638361930847168
generate_one_block  0.6301441192626953
generate_one_block  0.6255645751953125
generate_one_block  0.6344001293182373
generate_one_block  0.6476194858551025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

connection checking time:  42.590874433517456
block generation total time  36.237703800201416
average batch blocks generation time:  2.2648564875125885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12173604965209961  GigaBytes
Max Memory Allocated: 0.12173604965209961  GigaBytes

torch.Size([166363, 128])
torch.Size([164044, 64])
torch.Size([155926, 64])
torch.Size([124142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6227879524230957  GigaBytes
Max Memory Allocated: 0.6304821968078613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12340116500854492  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

torch.Size([166177, 128])
torch.Size([163745, 64])
torch.Size([155563, 64])
torch.Size([123523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6209158897399902  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12342214584350586  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

torch.Size([166178, 128])
torch.Size([163688, 64])
torch.Size([155418, 64])
torch.Size([123186, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6205258369445801  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12343883514404297  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

torch.Size([166169, 128])
torch.Size([163788, 64])
torch.Size([155643, 64])
torch.Size([123612, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6211895942687988  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.1234731674194336  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

torch.Size([166311, 128])
torch.Size([164079, 64])
torch.Size([156182, 64])
torch.Size([123990, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6226115226745605  GigaBytes
Max Memory Allocated: 0.6450691223144531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12337255477905273  GigaBytes
Max Memory Allocated: 0.6452198028564453  GigaBytes

torch.Size([166264, 128])
torch.Size([163976, 64])
torch.Size([155883, 64])
torch.Size([123455, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6211633682250977  GigaBytes
Max Memory Allocated: 0.6452198028564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12347173690795898  GigaBytes
Max Memory Allocated: 0.6452198028564453  GigaBytes

torch.Size([166265, 128])
torch.Size([163843, 64])
torch.Size([155919, 64])
torch.Size([124302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6229948997497559  GigaBytes
Max Memory Allocated: 0.6452198028564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12347030639648438  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

torch.Size([166296, 128])
torch.Size([163824, 64])
torch.Size([155430, 64])
torch.Size([123897, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6221942901611328  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12344741821289062  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

torch.Size([166258, 128])
torch.Size([163828, 64])
torch.Size([155549, 64])
torch.Size([123637, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.621464729309082  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.1234130859375  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

torch.Size([166215, 128])
torch.Size([163847, 64])
torch.Size([155612, 64])
torch.Size([123281, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6207242012023926  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.123443603515625  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

torch.Size([166274, 128])
torch.Size([163992, 64])
torch.Size([155911, 64])
torch.Size([123694, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6217422485351562  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.1234579086303711  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

torch.Size([166250, 128])
torch.Size([163962, 64])
torch.Size([155877, 64])
torch.Size([124106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6239924430847168  GigaBytes
Max Memory Allocated: 0.645301342010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12346267700195312  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166311, 128])
torch.Size([164030, 64])
torch.Size([155850, 64])
torch.Size([123848, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6220760345458984  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12347412109375  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166286, 128])
torch.Size([163915, 64])
torch.Size([155762, 64])
torch.Size([124244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.622767448425293  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12345600128173828  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166332, 128])
torch.Size([163944, 64])
torch.Size([155850, 64])
torch.Size([123977, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.622704029083252  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12342548370361328  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166282, 128])
torch.Size([163920, 64])
torch.Size([155808, 64])
torch.Size([123638, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6215829849243164  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06382812559604645 |0.06496916711330414 |0.047095492482185364 |0.00012168288230895996 |0.00961574912071228 |0.003529071807861328 |
----------------------------------------------------------pseudo_mini_loss sum 5.561490535736084
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10417019
Number of first layer input nodes during this epoch:  2660231
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.2115774154663086  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.019638776779174805
random selection method range initialization spend 0.004943370819091797
time for parepare:  0.018082618713378906
local_output_nid generation:  0.002410411834716797
local_in_edges_tensor generation:  0.006511688232421875
mini_batch_src_global generation:  0.0019290447235107422
r_  generation:  0.01842665672302246
local_output_nid generation:  0.002958536148071289
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.002068758010864258
r_  generation:  0.03225827217102051
local_output_nid generation:  0.0052967071533203125
local_in_edges_tensor generation:  0.0022954940795898438
mini_batch_src_global generation:  0.0016536712646484375
r_  generation:  0.019552946090698242
local_output_nid generation:  0.004474639892578125
local_in_edges_tensor generation:  0.0019114017486572266
mini_batch_src_global generation:  0.0015683174133300781
r_  generation:  0.018778324127197266
local_output_nid generation:  0.00442957878112793
local_in_edges_tensor generation:  0.0018928050994873047
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.019176244735717773
local_output_nid generation:  0.004217863082885742
local_in_edges_tensor generation:  0.001834869384765625
mini_batch_src_global generation:  0.0016300678253173828
r_  generation:  0.01939535140991211
local_output_nid generation:  0.004307985305786133
local_in_edges_tensor generation:  0.0018384456634521484
mini_batch_src_global generation:  0.0016198158264160156
r_  generation:  0.01966381072998047
local_output_nid generation:  0.004171848297119141
local_in_edges_tensor generation:  0.001821756362915039
mini_batch_src_global generation:  0.0016512870788574219
r_  generation:  0.019425153732299805
local_output_nid generation:  0.004174470901489258
local_in_edges_tensor generation:  0.0017800331115722656
mini_batch_src_global generation:  0.0016009807586669922
r_  generation:  0.01992011070251465
local_output_nid generation:  0.004280805587768555
local_in_edges_tensor generation:  0.0018541812896728516
mini_batch_src_global generation:  0.0016493797302246094
r_  generation:  0.01950860023498535
local_output_nid generation:  0.004236459732055664
local_in_edges_tensor generation:  0.0018305778503417969
mini_batch_src_global generation:  0.001596212387084961
r_  generation:  0.019947528839111328
local_output_nid generation:  0.004376649856567383
local_in_edges_tensor generation:  0.0019040107727050781
mini_batch_src_global generation:  0.0016720294952392578
r_  generation:  0.02002692222595215
local_output_nid generation:  0.004311084747314453
local_in_edges_tensor generation:  0.0019016265869140625
mini_batch_src_global generation:  0.0016560554504394531
r_  generation:  0.019658327102661133
local_output_nid generation:  0.004219532012939453
local_in_edges_tensor generation:  0.0018506050109863281
mini_batch_src_global generation:  0.0015716552734375
r_  generation:  0.019477128982543945
local_output_nid generation:  0.0043201446533203125
local_in_edges_tensor generation:  0.001851797103881836
mini_batch_src_global generation:  0.0016324520111083984
r_  generation:  0.01933121681213379
local_output_nid generation:  0.004179954528808594
local_in_edges_tensor generation:  0.001840353012084961
mini_batch_src_global generation:  0.0016009807586669922
r_  generation:  0.01962566375732422
----------------------check_connections_block total spend ----------------------------- 0.5553679466247559
generate_one_block  0.028580427169799805
generate_one_block  0.028642892837524414
generate_one_block  0.02815842628479004
generate_one_block  0.02804088592529297
generate_one_block  0.02856922149658203
generate_one_block  0.032778263092041016
generate_one_block  0.02875351905822754
generate_one_block  0.02827167510986328
generate_one_block  0.02931499481201172
generate_one_block  0.028462648391723633
generate_one_block  0.028856277465820312
generate_one_block  0.02914905548095703
generate_one_block  0.028940439224243164
generate_one_block  0.028643369674682617
generate_one_block  0.028364181518554688
generate_one_block  0.029201507568359375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03947806358337402
gen group dst list time:  0.019694089889526367
time for parepare:  0.01929926872253418
local_output_nid generation:  0.009129762649536133
local_in_edges_tensor generation:  0.024918556213378906
mini_batch_src_global generation:  0.019971847534179688
r_  generation:  0.20039844512939453
local_output_nid generation:  0.012944221496582031
local_in_edges_tensor generation:  0.020711183547973633
mini_batch_src_global generation:  0.027498722076416016
r_  generation:  0.21066522598266602
local_output_nid generation:  0.01322031021118164
local_in_edges_tensor generation:  0.01531839370727539
mini_batch_src_global generation:  0.026952266693115234
r_  generation:  0.23907232284545898
local_output_nid generation:  0.01862478256225586
local_in_edges_tensor generation:  0.02045440673828125
mini_batch_src_global generation:  0.029088497161865234
r_  generation:  0.23651742935180664
local_output_nid generation:  0.021848678588867188
local_in_edges_tensor generation:  0.02169942855834961
mini_batch_src_global generation:  0.029637575149536133
r_  generation:  0.24207067489624023
local_output_nid generation:  0.019200563430786133
local_in_edges_tensor generation:  0.015452861785888672
mini_batch_src_global generation:  0.032877445220947266
r_  generation:  0.2420668601989746
local_output_nid generation:  0.019165754318237305
local_in_edges_tensor generation:  0.0189664363861084
mini_batch_src_global generation:  0.03073263168334961
r_  generation:  0.2431168556213379
local_output_nid generation:  0.01913928985595703
local_in_edges_tensor generation:  0.015318870544433594
mini_batch_src_global generation:  0.030042648315429688
r_  generation:  0.2314162254333496
local_output_nid generation:  0.019776105880737305
local_in_edges_tensor generation:  0.020781517028808594
mini_batch_src_global generation:  0.03282761573791504
r_  generation:  0.24803614616394043
local_output_nid generation:  0.019352197647094727
local_in_edges_tensor generation:  0.016911983489990234
mini_batch_src_global generation:  0.03055405616760254
r_  generation:  0.257997989654541
local_output_nid generation:  0.023200273513793945
local_in_edges_tensor generation:  0.03735160827636719
mini_batch_src_global generation:  0.03470110893249512
r_  generation:  0.2437136173248291
local_output_nid generation:  0.019219636917114258
local_in_edges_tensor generation:  0.018124103546142578
mini_batch_src_global generation:  0.03236126899719238
r_  generation:  0.2432258129119873
local_output_nid generation:  0.019393205642700195
local_in_edges_tensor generation:  0.018335819244384766
mini_batch_src_global generation:  0.03315854072570801
r_  generation:  0.24197149276733398
local_output_nid generation:  0.019112825393676758
local_in_edges_tensor generation:  0.01554417610168457
mini_batch_src_global generation:  0.0313112735748291
r_  generation:  0.23427915573120117
local_output_nid generation:  0.019090890884399414
local_in_edges_tensor generation:  0.014353752136230469
mini_batch_src_global generation:  0.03148245811462402
r_  generation:  0.23627233505249023
local_output_nid generation:  0.018838167190551758
local_in_edges_tensor generation:  0.014090299606323242
mini_batch_src_global generation:  0.03168296813964844
r_  generation:  0.23770642280578613
----------------------check_connections_block total spend ----------------------------- 5.773635625839233
generate_one_block  0.29074716567993164
generate_one_block  0.30294227600097656
generate_one_block  0.2814147472381592
generate_one_block  0.2820272445678711
generate_one_block  0.2946798801422119
generate_one_block  0.28411388397216797
generate_one_block  0.34217047691345215
generate_one_block  0.2800629138946533
generate_one_block  0.2890655994415283
generate_one_block  0.27524399757385254
generate_one_block  0.28524184226989746
generate_one_block  0.2820909023284912
generate_one_block  0.28258562088012695
generate_one_block  0.2718183994293213
generate_one_block  0.2756075859069824
generate_one_block  0.2916421890258789
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05210375785827637
gen group dst list time:  0.06359314918518066
time for parepare:  0.017686128616333008
local_output_nid generation:  0.026360750198364258
local_in_edges_tensor generation:  0.06103849411010742
mini_batch_src_global generation:  0.04988718032836914
r_  generation:  0.4892745018005371
local_output_nid generation:  0.031647682189941406
local_in_edges_tensor generation:  0.04991507530212402
mini_batch_src_global generation:  0.057570695877075195
r_  generation:  0.49585986137390137
local_output_nid generation:  0.0316929817199707
local_in_edges_tensor generation:  0.04109787940979004
mini_batch_src_global generation:  0.056321144104003906
r_  generation:  0.5037462711334229
local_output_nid generation:  0.03776240348815918
local_in_edges_tensor generation:  0.03665471076965332
mini_batch_src_global generation:  0.0618138313293457
r_  generation:  0.49967265129089355
local_output_nid generation:  0.03206324577331543
local_in_edges_tensor generation:  0.09429812431335449
mini_batch_src_global generation:  0.05791521072387695
r_  generation:  0.5189046859741211
local_output_nid generation:  0.03141665458679199
local_in_edges_tensor generation:  0.03996443748474121
mini_batch_src_global generation:  0.06385922431945801
r_  generation:  0.5306305885314941
local_output_nid generation:  0.03648185729980469
local_in_edges_tensor generation:  0.0474700927734375
mini_batch_src_global generation:  0.06772947311401367
r_  generation:  0.5156145095825195
local_output_nid generation:  0.032647132873535156
local_in_edges_tensor generation:  0.04000973701477051
mini_batch_src_global generation:  0.06568264961242676
r_  generation:  0.5018682479858398
local_output_nid generation:  0.03259873390197754
local_in_edges_tensor generation:  0.032094717025756836
mini_batch_src_global generation:  0.05800962448120117
r_  generation:  0.5259103775024414
local_output_nid generation:  0.032392024993896484
local_in_edges_tensor generation:  0.03298330307006836
mini_batch_src_global generation:  0.06107664108276367
r_  generation:  0.5037202835083008
local_output_nid generation:  0.03278088569641113
local_in_edges_tensor generation:  0.04144597053527832
mini_batch_src_global generation:  0.05920553207397461
r_  generation:  0.512843132019043
local_output_nid generation:  0.032869577407836914
local_in_edges_tensor generation:  0.03859138488769531
mini_batch_src_global generation:  0.06112074851989746
r_  generation:  0.5031201839447021
local_output_nid generation:  0.03275442123413086
local_in_edges_tensor generation:  0.0425717830657959
mini_batch_src_global generation:  0.05910778045654297
r_  generation:  0.5080850124359131
local_output_nid generation:  0.03252553939819336
local_in_edges_tensor generation:  0.03686046600341797
mini_batch_src_global generation:  0.06320452690124512
r_  generation:  0.501467227935791
local_output_nid generation:  0.03258395195007324
local_in_edges_tensor generation:  0.03594660758972168
mini_batch_src_global generation:  0.05926156044006348
r_  generation:  0.5072569847106934
local_output_nid generation:  0.032355308532714844
local_in_edges_tensor generation:  0.03608560562133789
mini_batch_src_global generation:  0.05978822708129883
r_  generation:  0.5011777877807617
----------------------check_connections_block total spend ----------------------------- 12.048777103424072
generate_one_block  0.6714327335357666
generate_one_block  0.676762580871582
generate_one_block  0.6483447551727295
generate_one_block  0.647345781326294
generate_one_block  0.658902645111084
generate_one_block  0.6650540828704834
generate_one_block  0.6556816101074219
generate_one_block  0.6492393016815186
generate_one_block  0.7020862102508545
generate_one_block  0.6497483253479004
generate_one_block  0.6634082794189453
generate_one_block  0.6524257659912109
generate_one_block  0.6468601226806641
generate_one_block  0.6343119144439697
generate_one_block  0.6428787708282471
generate_one_block  0.6441569328308105
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05807948112487793
gen group dst list time:  0.09881973266601562
time for parepare:  0.019272804260253906
local_output_nid generation:  0.034258365631103516
local_in_edges_tensor generation:  0.06793451309204102
mini_batch_src_global generation:  0.050065040588378906
r_  generation:  0.5316786766052246
local_output_nid generation:  0.041274309158325195
local_in_edges_tensor generation:  0.05574965476989746
mini_batch_src_global generation:  0.061557769775390625
r_  generation:  0.5328390598297119
local_output_nid generation:  0.040787696838378906
local_in_edges_tensor generation:  0.05139493942260742
mini_batch_src_global generation:  0.05872702598571777
r_  generation:  0.5591869354248047
local_output_nid generation:  0.040988922119140625
local_in_edges_tensor generation:  0.0370941162109375
mini_batch_src_global generation:  0.05766153335571289
r_  generation:  0.5413818359375
local_output_nid generation:  0.038694143295288086
local_in_edges_tensor generation:  0.04641318321228027
mini_batch_src_global generation:  0.06227374076843262
r_  generation:  0.549553632736206
local_output_nid generation:  0.0383150577545166
local_in_edges_tensor generation:  0.03695082664489746
mini_batch_src_global generation:  0.0583648681640625
r_  generation:  0.5536088943481445
local_output_nid generation:  0.03836178779602051
local_in_edges_tensor generation:  0.0460054874420166
mini_batch_src_global generation:  0.058618783950805664
r_  generation:  0.5528242588043213
local_output_nid generation:  0.03836560249328613
local_in_edges_tensor generation:  0.04701519012451172
mini_batch_src_global generation:  0.05953860282897949
r_  generation:  0.5555143356323242
local_output_nid generation:  0.039278268814086914
local_in_edges_tensor generation:  0.041512250900268555
mini_batch_src_global generation:  0.06002068519592285
r_  generation:  0.5611217021942139
local_output_nid generation:  0.03863048553466797
local_in_edges_tensor generation:  0.04095578193664551
mini_batch_src_global generation:  0.05999255180358887
r_  generation:  0.5573134422302246
local_output_nid generation:  0.03846454620361328
local_in_edges_tensor generation:  0.046472787857055664
mini_batch_src_global generation:  0.06122112274169922
r_  generation:  0.5603339672088623
local_output_nid generation:  0.038422584533691406
local_in_edges_tensor generation:  0.03733468055725098
mini_batch_src_global generation:  0.06062722206115723
r_  generation:  0.5591211318969727
local_output_nid generation:  0.038393259048461914
local_in_edges_tensor generation:  0.03824877738952637
mini_batch_src_global generation:  0.06115221977233887
r_  generation:  0.572669506072998
local_output_nid generation:  0.03865838050842285
local_in_edges_tensor generation:  0.03708004951477051
mini_batch_src_global generation:  0.061466217041015625
r_  generation:  0.5575351715087891
local_output_nid generation:  0.038198232650756836
local_in_edges_tensor generation:  0.04640913009643555
mini_batch_src_global generation:  0.06088066101074219
r_  generation:  0.5686585903167725
local_output_nid generation:  0.03833746910095215
local_in_edges_tensor generation:  0.03702592849731445
mini_batch_src_global generation:  0.06053018569946289
r_  generation:  0.5582802295684814
----------------------check_connections_block total spend ----------------------------- 13.226463317871094
generate_one_block  0.6788053512573242
generate_one_block  0.6870148181915283
generate_one_block  0.6883020401000977
generate_one_block  0.6787459850311279
generate_one_block  0.679415225982666
generate_one_block  0.6898274421691895
generate_one_block  0.7561342716217041
generate_one_block  0.681361198425293
generate_one_block  0.6820032596588135
generate_one_block  0.6843438148498535
generate_one_block  0.6854238510131836
generate_one_block  0.6779718399047852
generate_one_block  0.67576003074646
generate_one_block  0.6834566593170166
generate_one_block  0.6925985813140869
generate_one_block  0.6749725341796875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.054631948471069336
gen group dst list time:  0.09351348876953125
time for parepare:  0.01892685890197754
local_output_nid generation:  0.0364375114440918
local_in_edges_tensor generation:  0.04742002487182617
mini_batch_src_global generation:  0.047661781311035156
r_  generation:  0.509366512298584
local_output_nid generation:  0.042223215103149414
local_in_edges_tensor generation:  0.05308175086975098
mini_batch_src_global generation:  0.05800151824951172
r_  generation:  0.5097026824951172
local_output_nid generation:  0.040065765380859375
local_in_edges_tensor generation:  0.048036813735961914
mini_batch_src_global generation:  0.057192087173461914
r_  generation:  0.5355286598205566
local_output_nid generation:  0.04262113571166992
local_in_edges_tensor generation:  0.03703141212463379
mini_batch_src_global generation:  0.057657480239868164
r_  generation:  0.5144519805908203
local_output_nid generation:  0.04105186462402344
local_in_edges_tensor generation:  0.046339988708496094
mini_batch_src_global generation:  0.05708122253417969
r_  generation:  0.5116045475006104
local_output_nid generation:  0.04119133949279785
local_in_edges_tensor generation:  0.04157280921936035
mini_batch_src_global generation:  0.05805397033691406
r_  generation:  0.5134716033935547
local_output_nid generation:  0.04127001762390137
local_in_edges_tensor generation:  0.040584564208984375
mini_batch_src_global generation:  0.05717611312866211
r_  generation:  0.5103087425231934
local_output_nid generation:  0.041344642639160156
local_in_edges_tensor generation:  0.04620766639709473
mini_batch_src_global generation:  0.05727386474609375
r_  generation:  0.5142261981964111
local_output_nid generation:  0.041188716888427734
local_in_edges_tensor generation:  0.04095268249511719
mini_batch_src_global generation:  0.057111263275146484
r_  generation:  0.5151166915893555
local_output_nid generation:  0.04101896286010742
local_in_edges_tensor generation:  0.04617595672607422
mini_batch_src_global generation:  0.05691838264465332
r_  generation:  0.5195877552032471
local_output_nid generation:  0.04120039939880371
local_in_edges_tensor generation:  0.040668487548828125
mini_batch_src_global generation:  0.056931495666503906
r_  generation:  0.5166752338409424
local_output_nid generation:  0.04117560386657715
local_in_edges_tensor generation:  0.04128432273864746
mini_batch_src_global generation:  0.05749225616455078
r_  generation:  0.5235116481781006
local_output_nid generation:  0.04099392890930176
local_in_edges_tensor generation:  0.04520416259765625
mini_batch_src_global generation:  0.05660080909729004
r_  generation:  0.5221495628356934
local_output_nid generation:  0.04099011421203613
local_in_edges_tensor generation:  0.042485952377319336
mini_batch_src_global generation:  0.05737447738647461
r_  generation:  0.5247631072998047
local_output_nid generation:  0.04148054122924805
local_in_edges_tensor generation:  0.045346736907958984
mini_batch_src_global generation:  0.05646467208862305
r_  generation:  0.5234839916229248
local_output_nid generation:  0.041136741638183594
local_in_edges_tensor generation:  0.04138469696044922
mini_batch_src_global generation:  0.05704617500305176
r_  generation:  0.5246145725250244
----------------------check_connections_block total spend ----------------------------- 12.536731719970703
generate_one_block  0.6416158676147461
generate_one_block  0.6496384143829346
generate_one_block  0.6402866840362549
generate_one_block  0.6418609619140625
generate_one_block  0.6392619609832764
generate_one_block  0.6396875381469727
generate_one_block  0.6376945972442627
generate_one_block  0.6407651901245117
generate_one_block  0.6420068740844727
generate_one_block  0.7144958972930908
generate_one_block  0.6399693489074707
generate_one_block  0.6431331634521484
generate_one_block  0.6399023532867432
generate_one_block  0.6437327861785889
generate_one_block  0.6394557952880859
generate_one_block  0.6400918960571289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.2115774154663086  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

connection checking time:  43.5856077671051
block generation total time  36.449830770492554
average batch blocks generation time:  2.2781144231557846
block dataloader generation time/epoch 83.13618731498718
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12377071380615234  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166202, 128])
torch.Size([163792, 64])
torch.Size([155662, 64])
torch.Size([123592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6217045783996582  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12380838394165039  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166300, 128])
torch.Size([164002, 64])
torch.Size([156016, 64])
torch.Size([123958, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6227455139160156  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12378931045532227  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166260, 128])
torch.Size([163876, 64])
torch.Size([155612, 64])
torch.Size([123332, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6212310791015625  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12379026412963867  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166225, 128])
torch.Size([163843, 64])
torch.Size([155658, 64])
torch.Size([123883, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6220226287841797  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.1238255500793457  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166288, 128])
torch.Size([163923, 64])
torch.Size([155655, 64])
torch.Size([123969, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6225728988647461  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12379884719848633  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166178, 128])
torch.Size([163799, 64])
torch.Size([155747, 64])
torch.Size([124022, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6223211288452148  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12382125854492188  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166215, 128])
torch.Size([163941, 64])
torch.Size([156002, 64])
torch.Size([124376, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6230564117431641  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12375640869140625  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166259, 128])
torch.Size([163934, 64])
torch.Size([155909, 64])
torch.Size([123681, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6218628883361816  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12386178970336914  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

torch.Size([166223, 128])
torch.Size([163958, 64])
torch.Size([156012, 64])
torch.Size([124445, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6250057220458984  GigaBytes
Max Memory Allocated: 0.6460452079772949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12376117706298828  GigaBytes
Max Memory Allocated: 0.6471028327941895  GigaBytes

torch.Size([166324, 128])
torch.Size([164046, 64])
torch.Size([155871, 64])
torch.Size([123489, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6218509674072266  GigaBytes
Max Memory Allocated: 0.6471028327941895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.1238565444946289  GigaBytes
Max Memory Allocated: 0.6471028327941895  GigaBytes

torch.Size([166229, 128])
torch.Size([163953, 64])
torch.Size([155904, 64])
torch.Size([124682, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6248564720153809  GigaBytes
Max Memory Allocated: 0.6471028327941895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12380838394165039  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

torch.Size([166292, 128])
torch.Size([163940, 64])
torch.Size([155899, 64])
torch.Size([124019, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6227469444274902  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.1238093376159668  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

torch.Size([166288, 128])
torch.Size([163928, 64])
torch.Size([155728, 64])
torch.Size([123852, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6225714683532715  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12376642227172852  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

torch.Size([166204, 128])
torch.Size([163806, 64])
torch.Size([155701, 64])
torch.Size([123514, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6213798522949219  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12376689910888672  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

torch.Size([166278, 128])
torch.Size([163987, 64])
torch.Size([155854, 64])
torch.Size([123383, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6216001510620117  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12374544143676758  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

torch.Size([166143, 128])
torch.Size([163751, 64])
torch.Size([155397, 64])
torch.Size([123010, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6203789710998535  GigaBytes
Max Memory Allocated: 0.647282600402832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061823874711990356 |0.03678050637245178 |0.005474165081977844 |8.976459503173828e-05 |0.006376966834068298 |0.002160310745239258 |
----------------------------------------------------------pseudo_mini_loss sum 4.447479724884033
Total (block generation + training)time/epoch 84.97039127349854
Training time/epoch 1.8339262008666992
Training time without block to device /epoch 1.2454380989074707
Training time without total dataloading part /epoch 0.19321465492248535
load block tensor time/epoch 0.9891819953918457
block to device time/epoch 0.5884881019592285
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10417165
Number of first layer input nodes during this epoch:  2659908
