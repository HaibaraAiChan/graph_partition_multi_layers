Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648493369.2129436
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024263620376586914
random selection method range initialization spend 0.006249427795410156
time for parepare:  0.017923593521118164
local_output_nid generation:  0.002198934555053711
local_in_edges_tensor generation:  0.004835605621337891
mini_batch_src_global generation:  0.0016872882843017578
r_  generation:  0.017130613327026367
local_output_nid generation:  0.0024526119232177734
local_in_edges_tensor generation:  0.001708984375
mini_batch_src_global generation:  0.001974344253540039
r_  generation:  0.017305612564086914
local_output_nid generation:  0.0027196407318115234
local_in_edges_tensor generation:  0.0015604496002197266
mini_batch_src_global generation:  0.0013494491577148438
r_  generation:  0.016680002212524414
local_output_nid generation:  0.0027463436126708984
local_in_edges_tensor generation:  0.001535654067993164
mini_batch_src_global generation:  0.0013616085052490234
r_  generation:  0.01741504669189453
local_output_nid generation:  0.002768993377685547
local_in_edges_tensor generation:  0.0014972686767578125
mini_batch_src_global generation:  0.0013833045959472656
r_  generation:  0.017926931381225586
local_output_nid generation:  0.002756834030151367
local_in_edges_tensor generation:  0.0014417171478271484
mini_batch_src_global generation:  0.0013439655303955078
r_  generation:  0.018373727798461914
local_output_nid generation:  0.0028107166290283203
local_in_edges_tensor generation:  0.0015227794647216797
mini_batch_src_global generation:  0.0014460086822509766
r_  generation:  0.01891303062438965
local_output_nid generation:  0.002806425094604492
local_in_edges_tensor generation:  0.0014560222625732422
mini_batch_src_global generation:  0.0014140605926513672
r_  generation:  0.01866436004638672
local_output_nid generation:  0.002859830856323242
local_in_edges_tensor generation:  0.0014650821685791016
mini_batch_src_global generation:  0.0014612674713134766
r_  generation:  0.018004179000854492
local_output_nid generation:  0.0028028488159179688
local_in_edges_tensor generation:  0.0014569759368896484
mini_batch_src_global generation:  0.0015010833740234375
r_  generation:  0.01891469955444336
local_output_nid generation:  0.002794027328491211
local_in_edges_tensor generation:  0.0015172958374023438
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.018930673599243164
local_output_nid generation:  0.0028204917907714844
local_in_edges_tensor generation:  0.0015053749084472656
mini_batch_src_global generation:  0.00153350830078125
r_  generation:  0.01905059814453125
local_output_nid generation:  0.0028057098388671875
local_in_edges_tensor generation:  0.0014660358428955078
mini_batch_src_global generation:  0.0014841556549072266
r_  generation:  0.018481731414794922
local_output_nid generation:  0.0028672218322753906
local_in_edges_tensor generation:  0.0015037059783935547
mini_batch_src_global generation:  0.0014946460723876953
r_  generation:  0.019150733947753906
local_output_nid generation:  0.0028810501098632812
local_in_edges_tensor generation:  0.0015370845794677734
mini_batch_src_global generation:  0.001535177230834961
r_  generation:  0.018656492233276367
local_output_nid generation:  0.002825498580932617
local_in_edges_tensor generation:  0.0014636516571044922
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.018587112426757812
----------------------check_connections_block total spend ----------------------------- 0.48119354248046875
generate_one_block  0.02724480628967285
generate_one_block  0.027607202529907227
generate_one_block  0.027126073837280273
generate_one_block  0.03008294105529785
generate_one_block  0.0278472900390625
generate_one_block  0.02772045135498047
generate_one_block  0.028187036514282227
generate_one_block  0.027585744857788086
generate_one_block  0.027113676071166992
generate_one_block  0.027918100357055664
generate_one_block  0.02830791473388672
generate_one_block  0.028861045837402344
generate_one_block  0.02800917625427246
generate_one_block  0.029217958450317383
generate_one_block  0.0276029109954834
generate_one_block  0.027853012084960938
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03967475891113281
gen group dst list time:  0.01845574378967285
time for parepare:  0.018747329711914062
local_output_nid generation:  0.008589744567871094
local_in_edges_tensor generation:  0.019837141036987305
mini_batch_src_global generation:  0.020978212356567383
r_  generation:  0.19802117347717285
local_output_nid generation:  0.012154340744018555
local_in_edges_tensor generation:  0.019757509231567383
mini_batch_src_global generation:  0.024624109268188477
r_  generation:  0.20700645446777344
local_output_nid generation:  0.011950016021728516
local_in_edges_tensor generation:  0.016542911529541016
mini_batch_src_global generation:  0.023672819137573242
r_  generation:  0.2079172134399414
local_output_nid generation:  0.01201629638671875
local_in_edges_tensor generation:  0.014047861099243164
mini_batch_src_global generation:  0.024704694747924805
r_  generation:  0.2108771800994873
local_output_nid generation:  0.01205897331237793
local_in_edges_tensor generation:  0.01798558235168457
mini_batch_src_global generation:  0.026406526565551758
r_  generation:  0.21957612037658691
local_output_nid generation:  0.012035608291625977
local_in_edges_tensor generation:  0.012872457504272461
mini_batch_src_global generation:  0.026668548583984375
r_  generation:  0.21488595008850098
local_output_nid generation:  0.012228965759277344
local_in_edges_tensor generation:  0.015092611312866211
mini_batch_src_global generation:  0.026972532272338867
r_  generation:  0.22281599044799805
local_output_nid generation:  0.012102603912353516
local_in_edges_tensor generation:  0.01829981803894043
mini_batch_src_global generation:  0.027568817138671875
r_  generation:  0.21877551078796387
local_output_nid generation:  0.011844396591186523
local_in_edges_tensor generation:  0.01309347152709961
mini_batch_src_global generation:  0.026375293731689453
r_  generation:  0.21297597885131836
local_output_nid generation:  0.012246370315551758
local_in_edges_tensor generation:  0.014482498168945312
mini_batch_src_global generation:  0.027313709259033203
r_  generation:  0.2210536003112793
local_output_nid generation:  0.01221776008605957
local_in_edges_tensor generation:  0.016520977020263672
mini_batch_src_global generation:  0.02895808219909668
r_  generation:  0.2235884666442871
local_output_nid generation:  0.012206315994262695
local_in_edges_tensor generation:  0.014558076858520508
mini_batch_src_global generation:  0.027744293212890625
r_  generation:  0.22058868408203125
local_output_nid generation:  0.01192784309387207
local_in_edges_tensor generation:  0.013078451156616211
mini_batch_src_global generation:  0.026440858840942383
r_  generation:  0.2135927677154541
local_output_nid generation:  0.012226343154907227
local_in_edges_tensor generation:  0.016358137130737305
mini_batch_src_global generation:  0.02757120132446289
r_  generation:  0.22425413131713867
local_output_nid generation:  0.01194000244140625
local_in_edges_tensor generation:  0.01294255256652832
mini_batch_src_global generation:  0.027068376541137695
r_  generation:  0.21375489234924316
local_output_nid generation:  0.011982202529907227
local_in_edges_tensor generation:  0.014450550079345703
mini_batch_src_global generation:  0.026804208755493164
r_  generation:  0.21959972381591797
----------------------check_connections_block total spend ----------------------------- 5.081030368804932
generate_one_block  0.2822244167327881
generate_one_block  0.2851133346557617
generate_one_block  0.27680158615112305
generate_one_block  0.2755875587463379
generate_one_block  0.3021249771118164
generate_one_block  0.27602100372314453
generate_one_block  0.2872002124786377
generate_one_block  0.2852599620819092
generate_one_block  0.27230167388916016
generate_one_block  0.28062868118286133
generate_one_block  0.2851393222808838
generate_one_block  0.2811746597290039
generate_one_block  0.2735772132873535
generate_one_block  0.2847576141357422
generate_one_block  0.2811546325683594
generate_one_block  0.27873826026916504
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04129290580749512
gen group dst list time:  0.05954575538635254
time for parepare:  0.019378185272216797
local_output_nid generation:  0.025775671005249023
local_in_edges_tensor generation:  0.07340407371520996
mini_batch_src_global generation:  0.05065178871154785
r_  generation:  0.4819309711456299
local_output_nid generation:  0.03147006034851074
local_in_edges_tensor generation:  0.04772615432739258
mini_batch_src_global generation:  0.05711007118225098
r_  generation:  0.4897274971008301
local_output_nid generation:  0.030687570571899414
local_in_edges_tensor generation:  0.04060196876525879
mini_batch_src_global generation:  0.05642199516296387
r_  generation:  0.4957599639892578
local_output_nid generation:  0.030858278274536133
local_in_edges_tensor generation:  0.03185272216796875
mini_batch_src_global generation:  0.059144020080566406
r_  generation:  0.4990048408508301
local_output_nid generation:  0.031154870986938477
local_in_edges_tensor generation:  0.03525066375732422
mini_batch_src_global generation:  0.06162619590759277
r_  generation:  0.5013749599456787
local_output_nid generation:  0.030954599380493164
local_in_edges_tensor generation:  0.04190421104431152
mini_batch_src_global generation:  0.05896592140197754
r_  generation:  0.5054988861083984
local_output_nid generation:  0.03108501434326172
local_in_edges_tensor generation:  0.039437294006347656
mini_batch_src_global generation:  0.0581820011138916
r_  generation:  0.5076320171356201
local_output_nid generation:  0.030816316604614258
local_in_edges_tensor generation:  0.03501272201538086
mini_batch_src_global generation:  0.059981346130371094
r_  generation:  0.5132441520690918
local_output_nid generation:  0.030588626861572266
local_in_edges_tensor generation:  0.03538918495178223
mini_batch_src_global generation:  0.05858635902404785
r_  generation:  0.5035455226898193
local_output_nid generation:  0.030602455139160156
local_in_edges_tensor generation:  0.03142809867858887
mini_batch_src_global generation:  0.06010270118713379
r_  generation:  0.5077917575836182
local_output_nid generation:  0.03080916404724121
local_in_edges_tensor generation:  0.03511834144592285
mini_batch_src_global generation:  0.059270381927490234
r_  generation:  0.5095336437225342
local_output_nid generation:  0.0308382511138916
local_in_edges_tensor generation:  0.04083514213562012
mini_batch_src_global generation:  0.05925774574279785
r_  generation:  0.5084943771362305
local_output_nid generation:  0.03066849708557129
local_in_edges_tensor generation:  0.0353240966796875
mini_batch_src_global generation:  0.06165909767150879
r_  generation:  0.5075216293334961
local_output_nid generation:  0.030806303024291992
local_in_edges_tensor generation:  0.03981804847717285
mini_batch_src_global generation:  0.05858039855957031
r_  generation:  0.5144691467285156
local_output_nid generation:  0.030902862548828125
local_in_edges_tensor generation:  0.032761573791503906
mini_batch_src_global generation:  0.059236764907836914
r_  generation:  0.5110940933227539
local_output_nid generation:  0.030815601348876953
local_in_edges_tensor generation:  0.03433561325073242
mini_batch_src_global generation:  0.059095144271850586
r_  generation:  0.515939474105835
----------------------check_connections_block total spend ----------------------------- 11.853833436965942
generate_one_block  0.6560957431793213
generate_one_block  0.6560769081115723
generate_one_block  0.649956226348877
generate_one_block  0.6379551887512207
generate_one_block  0.6575555801391602
generate_one_block  0.6506903171539307
generate_one_block  0.694713830947876
generate_one_block  0.6539669036865234
generate_one_block  0.6368858814239502
generate_one_block  0.6457359790802002
generate_one_block  0.6451005935668945
generate_one_block  0.6378934383392334
generate_one_block  0.6650762557983398
generate_one_block  0.6558969020843506
generate_one_block  0.6509525775909424
generate_one_block  0.6391751766204834
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06223893165588379
gen group dst list time:  0.0847315788269043
time for parepare:  0.020033836364746094
local_output_nid generation:  0.03380584716796875
local_in_edges_tensor generation:  0.08317995071411133
mini_batch_src_global generation:  0.05276298522949219
r_  generation:  0.5213446617126465
local_output_nid generation:  0.03875327110290527
local_in_edges_tensor generation:  0.05735898017883301
mini_batch_src_global generation:  0.06057429313659668
r_  generation:  0.5332520008087158
local_output_nid generation:  0.03785276412963867
local_in_edges_tensor generation:  0.05330967903137207
mini_batch_src_global generation:  0.07729578018188477
r_  generation:  0.543971061706543
local_output_nid generation:  0.03988790512084961
local_in_edges_tensor generation:  0.05492258071899414
mini_batch_src_global generation:  0.06373190879821777
r_  generation:  0.5335884094238281
local_output_nid generation:  0.03900432586669922
local_in_edges_tensor generation:  0.04231572151184082
mini_batch_src_global generation:  0.061937808990478516
r_  generation:  0.5405111312866211
local_output_nid generation:  0.03895735740661621
local_in_edges_tensor generation:  0.043404340744018555
mini_batch_src_global generation:  0.05799579620361328
r_  generation:  0.5425095558166504
local_output_nid generation:  0.03879189491271973
local_in_edges_tensor generation:  0.04214978218078613
mini_batch_src_global generation:  0.0588076114654541
r_  generation:  0.5552129745483398
local_output_nid generation:  0.03892397880554199
local_in_edges_tensor generation:  0.04314994812011719
mini_batch_src_global generation:  0.06513190269470215
r_  generation:  0.5590128898620605
local_output_nid generation:  0.04070544242858887
local_in_edges_tensor generation:  0.03840947151184082
mini_batch_src_global generation:  0.05916857719421387
r_  generation:  0.5516109466552734
local_output_nid generation:  0.03877758979797363
local_in_edges_tensor generation:  0.03960394859313965
mini_batch_src_global generation:  0.06331467628479004
r_  generation:  0.5541868209838867
local_output_nid generation:  0.03895735740661621
local_in_edges_tensor generation:  0.045049190521240234
mini_batch_src_global generation:  0.0597684383392334
r_  generation:  0.5545361042022705
local_output_nid generation:  0.03889632225036621
local_in_edges_tensor generation:  0.04332256317138672
mini_batch_src_global generation:  0.06082653999328613
r_  generation:  0.5568389892578125
local_output_nid generation:  0.03897738456726074
local_in_edges_tensor generation:  0.04735374450683594
mini_batch_src_global generation:  0.05969834327697754
r_  generation:  0.5591962337493896
local_output_nid generation:  0.03887033462524414
local_in_edges_tensor generation:  0.04291057586669922
mini_batch_src_global generation:  0.06085014343261719
r_  generation:  0.5555276870727539
local_output_nid generation:  0.0390775203704834
local_in_edges_tensor generation:  0.042195796966552734
mini_batch_src_global generation:  0.061452627182006836
r_  generation:  0.5578098297119141
local_output_nid generation:  0.03885817527770996
local_in_edges_tensor generation:  0.04243779182434082
mini_batch_src_global generation:  0.06089472770690918
r_  generation:  0.5549297332763672
----------------------check_connections_block total spend ----------------------------- 13.225847244262695
generate_one_block  0.7020227909088135
generate_one_block  0.6894176006317139
generate_one_block  0.7651040554046631
generate_one_block  0.6893112659454346
generate_one_block  0.6847929954528809
generate_one_block  0.6880888938903809
generate_one_block  0.6873466968536377
generate_one_block  0.683997631072998
generate_one_block  0.6707897186279297
generate_one_block  0.6733713150024414
generate_one_block  0.6896414756774902
generate_one_block  0.6909432411193848
generate_one_block  0.6885664463043213
generate_one_block  0.6950085163116455
generate_one_block  0.6901376247406006
generate_one_block  0.6757869720458984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0623929500579834
gen group dst list time:  0.09677600860595703
time for parepare:  0.019203662872314453
local_output_nid generation:  0.03656148910522461
local_in_edges_tensor generation:  0.046478986740112305
mini_batch_src_global generation:  0.04459571838378906
r_  generation:  0.5016705989837646
local_output_nid generation:  0.04281806945800781
local_in_edges_tensor generation:  0.034873008728027344
mini_batch_src_global generation:  0.056496381759643555
r_  generation:  0.505892276763916
local_output_nid generation:  0.0404207706451416
local_in_edges_tensor generation:  0.03833150863647461
mini_batch_src_global generation:  0.060318708419799805
r_  generation:  0.5032734870910645
local_output_nid generation:  0.040120840072631836
local_in_edges_tensor generation:  0.04333639144897461
mini_batch_src_global generation:  0.0656881332397461
r_  generation:  0.5263464450836182
local_output_nid generation:  0.041777610778808594
local_in_edges_tensor generation:  0.04303765296936035
mini_batch_src_global generation:  0.06655025482177734
r_  generation:  0.5141775608062744
local_output_nid generation:  0.04235124588012695
local_in_edges_tensor generation:  0.04031014442443848
mini_batch_src_global generation:  0.056780338287353516
r_  generation:  0.5150930881500244
local_output_nid generation:  0.04137444496154785
local_in_edges_tensor generation:  0.04144024848937988
mini_batch_src_global generation:  0.05614972114562988
r_  generation:  0.5115625858306885
local_output_nid generation:  0.04164576530456543
local_in_edges_tensor generation:  0.04518556594848633
mini_batch_src_global generation:  0.05556535720825195
r_  generation:  0.513740062713623
local_output_nid generation:  0.04180645942687988
local_in_edges_tensor generation:  0.0364835262298584
mini_batch_src_global generation:  0.056344032287597656
r_  generation:  0.5194613933563232
local_output_nid generation:  0.04149198532104492
local_in_edges_tensor generation:  0.04487013816833496
mini_batch_src_global generation:  0.0560910701751709
r_  generation:  0.5190896987915039
local_output_nid generation:  0.04181051254272461
local_in_edges_tensor generation:  0.0401155948638916
mini_batch_src_global generation:  0.05636191368103027
r_  generation:  0.5178759098052979
local_output_nid generation:  0.04170823097229004
local_in_edges_tensor generation:  0.04140353202819824
mini_batch_src_global generation:  0.057305097579956055
r_  generation:  0.5217702388763428
local_output_nid generation:  0.042130231857299805
local_in_edges_tensor generation:  0.0507502555847168
mini_batch_src_global generation:  0.05633044242858887
r_  generation:  0.5168943405151367
local_output_nid generation:  0.04229283332824707
local_in_edges_tensor generation:  0.0400080680847168
mini_batch_src_global generation:  0.05640697479248047
r_  generation:  0.5191383361816406
local_output_nid generation:  0.04166388511657715
local_in_edges_tensor generation:  0.03970789909362793
mini_batch_src_global generation:  0.05802345275878906
r_  generation:  0.5240123271942139
local_output_nid generation:  0.041480302810668945
local_in_edges_tensor generation:  0.048856496810913086
mini_batch_src_global generation:  0.05627274513244629
r_  generation:  0.5196325778961182
----------------------check_connections_block total spend ----------------------------- 12.468217611312866
generate_one_block  0.6475722789764404
generate_one_block  0.6404712200164795
generate_one_block  0.6315217018127441
generate_one_block  0.6350128650665283
generate_one_block  0.721696138381958
generate_one_block  0.6426503658294678
generate_one_block  0.6446201801300049
generate_one_block  0.6298916339874268
generate_one_block  0.6406738758087158
generate_one_block  0.628685712814331
generate_one_block  0.6461093425750732
generate_one_block  0.6313486099243164
generate_one_block  0.6673040390014648
generate_one_block  0.6590883731842041
generate_one_block  0.6417880058288574
generate_one_block  0.7349481582641602
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  42.628928661346436
block generation total time  36.44924235343933
average batch blocks generation time:  2.278077647089958
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12217283248901367  GigaBytes
Max Memory Allocated: 0.12217283248901367  GigaBytes

torch.Size([166187, 128])
torch.Size([163796, 128])
torch.Size([155573, 128])
torch.Size([123185, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5623779296875 GB
    Memory Allocated: 1.150467872619629  GigaBytes
Max Memory Allocated: 1.1680850982666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1170654296875 GB
    Memory Allocated: 0.12361621856689453  GigaBytes
Max Memory Allocated: 1.189692497253418  GigaBytes

torch.Size([166258, 128])
torch.Size([163876, 128])
torch.Size([155721, 128])
torch.Size([123984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4393310546875 GB
    Memory Allocated: 1.1534919738769531  GigaBytes
Max Memory Allocated: 1.189692497253418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.1235342025756836  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

torch.Size([166211, 128])
torch.Size([163839, 128])
torch.Size([155646, 128])
torch.Size([123386, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1508259773254395  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12349891662597656  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

torch.Size([166162, 128])
torch.Size([163868, 128])
torch.Size([155715, 128])
torch.Size([123541, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.151595115661621  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12364864349365234  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

torch.Size([166234, 128])
torch.Size([163892, 128])
torch.Size([155666, 128])
torch.Size([124137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1535348892211914  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12353134155273438  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

torch.Size([166322, 128])
torch.Size([164033, 128])
torch.Size([156128, 128])
torch.Size([124303, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1545491218566895  GigaBytes
Max Memory Allocated: 1.1928610801696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12379837036132812  GigaBytes
Max Memory Allocated: 1.1942052841186523  GigaBytes

torch.Size([166284, 128])
torch.Size([163985, 128])
torch.Size([155823, 128])
torch.Size([124343, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1560139656066895  GigaBytes
Max Memory Allocated: 1.1942052841186523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12368106842041016  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166375, 128])
torch.Size([164053, 128])
torch.Size([156081, 128])
torch.Size([124255, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1545782089233398  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12341117858886719  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166132, 128])
torch.Size([163623, 128])
torch.Size([155186, 128])
torch.Size([122565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1462397575378418  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.1235809326171875  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166222, 128])
torch.Size([163788, 128])
torch.Size([155394, 128])
torch.Size([123021, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1494488716125488  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12372493743896484  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166264, 128])
torch.Size([163917, 128])
torch.Size([155743, 128])
torch.Size([123960, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1535840034484863  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.1236124038696289  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166182, 128])
torch.Size([163831, 128])
torch.Size([155703, 128])
torch.Size([123530, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1536107063293457  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12344169616699219  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166290, 128])
torch.Size([164024, 128])
torch.Size([155990, 128])
torch.Size([123918, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1521415710449219  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12370872497558594  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166260, 128])
torch.Size([163918, 128])
torch.Size([155750, 128])
torch.Size([124019, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.154369831085205  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12349510192871094  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166256, 128])
torch.Size([163946, 128])
torch.Size([155922, 128])
torch.Size([123700, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1519718170166016  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.1235055923461914  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166330, 128])
torch.Size([164017, 128])
torch.Size([155698, 128])
torch.Size([123418, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.1513166427612305  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062382057309150696 |0.05571587383747101 |0.049137383699417114 |0.00011038780212402344 |0.02297145128250122 |0.0033168792724609375 |
----------------------------------------------------------pseudo_mini_loss sum 5.749895095825195
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10414061
Number of first layer input nodes during this epoch:  2659969
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.19973421096801758  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.01944136619567871
random selection method range initialization spend 0.0050394535064697266
time for parepare:  0.017869949340820312
local_output_nid generation:  0.002593517303466797
local_in_edges_tensor generation:  0.00801849365234375
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.018316030502319336
local_output_nid generation:  0.0030481815338134766
local_in_edges_tensor generation:  0.0017008781433105469
mini_batch_src_global generation:  0.002011537551879883
r_  generation:  0.019757747650146484
local_output_nid generation:  0.0029625892639160156
local_in_edges_tensor generation:  0.0015759468078613281
mini_batch_src_global generation:  0.0014548301696777344
r_  generation:  0.018858909606933594
local_output_nid generation:  0.0029065608978271484
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.0014598369598388672
r_  generation:  0.01906728744506836
local_output_nid generation:  0.0028684139251708984
local_in_edges_tensor generation:  0.0014605522155761719
mini_batch_src_global generation:  0.0014781951904296875
r_  generation:  0.018770694732666016
local_output_nid generation:  0.0028524398803710938
local_in_edges_tensor generation:  0.0014979839324951172
mini_batch_src_global generation:  0.0015020370483398438
r_  generation:  0.019345760345458984
local_output_nid generation:  0.0028946399688720703
local_in_edges_tensor generation:  0.0014488697052001953
mini_batch_src_global generation:  0.0015625953674316406
r_  generation:  0.019864559173583984
local_output_nid generation:  0.0028634071350097656
local_in_edges_tensor generation:  0.0014786720275878906
mini_batch_src_global generation:  0.0015845298767089844
r_  generation:  0.019743919372558594
local_output_nid generation:  0.0028481483459472656
local_in_edges_tensor generation:  0.0014650821685791016
mini_batch_src_global generation:  0.0015370845794677734
r_  generation:  0.01932811737060547
local_output_nid generation:  0.0028450489044189453
local_in_edges_tensor generation:  0.0014438629150390625
mini_batch_src_global generation:  0.001590728759765625
r_  generation:  0.01957249641418457
local_output_nid generation:  0.0028705596923828125
local_in_edges_tensor generation:  0.0014188289642333984
mini_batch_src_global generation:  0.001631021499633789
r_  generation:  0.02055501937866211
local_output_nid generation:  0.0028874874114990234
local_in_edges_tensor generation:  0.0014624595642089844
mini_batch_src_global generation:  0.0015995502471923828
r_  generation:  0.019908666610717773
local_output_nid generation:  0.002898693084716797
local_in_edges_tensor generation:  0.0014660358428955078
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.019147396087646484
local_output_nid generation:  0.002875089645385742
local_in_edges_tensor generation:  0.0014371871948242188
mini_batch_src_global generation:  0.0015642642974853516
r_  generation:  0.01961994171142578
local_output_nid generation:  0.0028295516967773438
local_in_edges_tensor generation:  0.0013844966888427734
mini_batch_src_global generation:  0.0015447139739990234
r_  generation:  0.019619226455688477
local_output_nid generation:  0.0028285980224609375
local_in_edges_tensor generation:  0.0014140605926513672
mini_batch_src_global generation:  0.0015947818756103516
r_  generation:  0.019849300384521484
----------------------check_connections_block total spend ----------------------------- 0.5111896991729736
generate_one_block  0.030389070510864258
generate_one_block  0.028511524200439453
generate_one_block  0.027748823165893555
generate_one_block  0.027528047561645508
generate_one_block  0.027044057846069336
generate_one_block  0.0298311710357666
generate_one_block  0.028334856033325195
generate_one_block  0.027522563934326172
generate_one_block  0.02786564826965332
generate_one_block  0.03155946731567383
generate_one_block  0.029088258743286133
generate_one_block  0.02821969985961914
generate_one_block  0.027346372604370117
generate_one_block  0.027390003204345703
generate_one_block  0.02752852439880371
generate_one_block  0.02830791473388672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04102444648742676
gen group dst list time:  0.01650071144104004
time for parepare:  0.019010305404663086
local_output_nid generation:  0.008057117462158203
local_in_edges_tensor generation:  0.020664453506469727
mini_batch_src_global generation:  0.022148847579956055
r_  generation:  0.1974630355834961
local_output_nid generation:  0.012380599975585938
local_in_edges_tensor generation:  0.0196685791015625
mini_batch_src_global generation:  0.025208234786987305
r_  generation:  0.21097826957702637
local_output_nid generation:  0.012495756149291992
local_in_edges_tensor generation:  0.01430964469909668
mini_batch_src_global generation:  0.023746728897094727
r_  generation:  0.21080875396728516
local_output_nid generation:  0.012670040130615234
local_in_edges_tensor generation:  0.014351129531860352
mini_batch_src_global generation:  0.024805545806884766
r_  generation:  0.21303844451904297
local_output_nid generation:  0.01221156120300293
local_in_edges_tensor generation:  0.01394510269165039
mini_batch_src_global generation:  0.02588629722595215
r_  generation:  0.21653127670288086
local_output_nid generation:  0.012181520462036133
local_in_edges_tensor generation:  0.01567983627319336
mini_batch_src_global generation:  0.026233196258544922
r_  generation:  0.21509933471679688
local_output_nid generation:  0.012702465057373047
local_in_edges_tensor generation:  0.015841960906982422
mini_batch_src_global generation:  0.028174877166748047
r_  generation:  0.21956610679626465
local_output_nid generation:  0.012636899948120117
local_in_edges_tensor generation:  0.017556190490722656
mini_batch_src_global generation:  0.027055025100708008
r_  generation:  0.21888065338134766
local_output_nid generation:  0.01273965835571289
local_in_edges_tensor generation:  0.014227151870727539
mini_batch_src_global generation:  0.02713489532470703
r_  generation:  0.2200021743774414
local_output_nid generation:  0.01276087760925293
local_in_edges_tensor generation:  0.012502431869506836
mini_batch_src_global generation:  0.027521610260009766
r_  generation:  0.21864867210388184
local_output_nid generation:  0.01311802864074707
local_in_edges_tensor generation:  0.018550634384155273
mini_batch_src_global generation:  0.02945113182067871
r_  generation:  0.22682666778564453
local_output_nid generation:  0.012807369232177734
local_in_edges_tensor generation:  0.012746334075927734
mini_batch_src_global generation:  0.02766704559326172
r_  generation:  0.22282814979553223
local_output_nid generation:  0.011902332305908203
local_in_edges_tensor generation:  0.012403726577758789
mini_batch_src_global generation:  0.0270230770111084
r_  generation:  0.21680068969726562
local_output_nid generation:  0.012880325317382812
local_in_edges_tensor generation:  0.015011072158813477
mini_batch_src_global generation:  0.02899026870727539
r_  generation:  0.23209667205810547
local_output_nid generation:  0.01314401626586914
local_in_edges_tensor generation:  0.021855831146240234
mini_batch_src_global generation:  0.03182053565979004
r_  generation:  0.22159934043884277
local_output_nid generation:  0.013331413269042969
local_in_edges_tensor generation:  0.016869783401489258
mini_batch_src_global generation:  0.028023242950439453
r_  generation:  0.22146987915039062
----------------------check_connections_block total spend ----------------------------- 5.152724742889404
generate_one_block  0.2742772102355957
generate_one_block  0.2868678569793701
generate_one_block  0.2763650417327881
generate_one_block  0.2771947383880615
generate_one_block  0.2766857147216797
generate_one_block  0.29239749908447266
generate_one_block  0.3091158866882324
generate_one_block  0.2801330089569092
generate_one_block  0.2951803207397461
generate_one_block  0.28711795806884766
generate_one_block  0.29703736305236816
generate_one_block  0.29958200454711914
generate_one_block  0.27870965003967285
generate_one_block  0.27753734588623047
generate_one_block  0.28423357009887695
generate_one_block  0.29438209533691406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0688326358795166
gen group dst list time:  0.06934642791748047
time for parepare:  0.017771244049072266
local_output_nid generation:  0.026500463485717773
local_in_edges_tensor generation:  0.05454134941101074
mini_batch_src_global generation:  0.046900033950805664
r_  generation:  0.5029346942901611
local_output_nid generation:  0.03237724304199219
local_in_edges_tensor generation:  0.05050849914550781
mini_batch_src_global generation:  0.059339046478271484
r_  generation:  0.5095071792602539
local_output_nid generation:  0.03251194953918457
local_in_edges_tensor generation:  0.04860329627990723
mini_batch_src_global generation:  0.07730746269226074
r_  generation:  0.5109138488769531
local_output_nid generation:  0.03376579284667969
local_in_edges_tensor generation:  0.04310750961303711
mini_batch_src_global generation:  0.06278228759765625
r_  generation:  0.5035099983215332
local_output_nid generation:  0.03256416320800781
local_in_edges_tensor generation:  0.1009366512298584
mini_batch_src_global generation:  0.05869007110595703
r_  generation:  0.5099189281463623
local_output_nid generation:  0.031207561492919922
local_in_edges_tensor generation:  0.032825469970703125
mini_batch_src_global generation:  0.05977439880371094
r_  generation:  0.5059893131256104
local_output_nid generation:  0.0315394401550293
local_in_edges_tensor generation:  0.03838682174682617
mini_batch_src_global generation:  0.05850958824157715
r_  generation:  0.5180444717407227
local_output_nid generation:  0.031332969665527344
local_in_edges_tensor generation:  0.04229736328125
mini_batch_src_global generation:  0.05984854698181152
r_  generation:  0.5120806694030762
local_output_nid generation:  0.031389474868774414
local_in_edges_tensor generation:  0.041445255279541016
mini_batch_src_global generation:  0.05964541435241699
r_  generation:  0.5149955749511719
local_output_nid generation:  0.03169107437133789
local_in_edges_tensor generation:  0.04503321647644043
mini_batch_src_global generation:  0.06087160110473633
r_  generation:  0.5092630386352539
local_output_nid generation:  0.03267049789428711
local_in_edges_tensor generation:  0.04705619812011719
mini_batch_src_global generation:  0.06587553024291992
r_  generation:  0.5385916233062744
local_output_nid generation:  0.0355067253112793
local_in_edges_tensor generation:  0.044846534729003906
mini_batch_src_global generation:  0.06775569915771484
r_  generation:  0.5116367340087891
local_output_nid generation:  0.03257012367248535
local_in_edges_tensor generation:  0.03778338432312012
mini_batch_src_global generation:  0.059198856353759766
r_  generation:  0.5177860260009766
local_output_nid generation:  0.032451629638671875
local_in_edges_tensor generation:  0.03759002685546875
mini_batch_src_global generation:  0.06014680862426758
r_  generation:  0.5059521198272705
local_output_nid generation:  0.03241896629333496
local_in_edges_tensor generation:  0.033762454986572266
mini_batch_src_global generation:  0.05870795249938965
r_  generation:  0.5206406116485596
local_output_nid generation:  0.03242754936218262
local_in_edges_tensor generation:  0.03530764579772949
mini_batch_src_global generation:  0.06010556221008301
r_  generation:  0.5037500858306885
----------------------check_connections_block total spend ----------------------------- 12.165266752243042
generate_one_block  0.6513299942016602
generate_one_block  0.6518361568450928
generate_one_block  0.6525003910064697
generate_one_block  0.6565907001495361
generate_one_block  0.652334451675415
generate_one_block  0.6483328342437744
generate_one_block  0.6594827175140381
generate_one_block  0.6578726768493652
generate_one_block  0.6913096904754639
generate_one_block  0.6476554870605469
generate_one_block  0.6624772548675537
generate_one_block  0.6562216281890869
generate_one_block  0.6394100189208984
generate_one_block  0.6386635303497314
generate_one_block  0.6467585563659668
generate_one_block  0.6673381328582764
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.1877574920654297
gen group dst list time:  0.09815526008605957
time for parepare:  0.019459009170532227
local_output_nid generation:  0.0337984561920166
local_in_edges_tensor generation:  0.0812082290649414
mini_batch_src_global generation:  0.05388665199279785
r_  generation:  0.5601325035095215
local_output_nid generation:  0.04162335395812988
local_in_edges_tensor generation:  0.061556339263916016
mini_batch_src_global generation:  0.08227396011352539
r_  generation:  0.5691862106323242
local_output_nid generation:  0.04231834411621094
local_in_edges_tensor generation:  0.042525291442871094
mini_batch_src_global generation:  0.06842231750488281
r_  generation:  0.5970790386199951
local_output_nid generation:  0.045946359634399414
local_in_edges_tensor generation:  0.05865955352783203
mini_batch_src_global generation:  0.07391476631164551
r_  generation:  0.5748937129974365
local_output_nid generation:  0.04013848304748535
local_in_edges_tensor generation:  0.05216193199157715
mini_batch_src_global generation:  0.06841254234313965
r_  generation:  0.5956692695617676
local_output_nid generation:  0.04007554054260254
local_in_edges_tensor generation:  0.03903651237487793
mini_batch_src_global generation:  0.0643012523651123
r_  generation:  0.5674808025360107
local_output_nid generation:  0.04229593276977539
local_in_edges_tensor generation:  0.055290937423706055
mini_batch_src_global generation:  0.06687188148498535
r_  generation:  0.6056334972381592
local_output_nid generation:  0.04254937171936035
local_in_edges_tensor generation:  0.04813718795776367
mini_batch_src_global generation:  0.09155917167663574
r_  generation:  0.550478458404541
local_output_nid generation:  0.040120601654052734
local_in_edges_tensor generation:  0.042014122009277344
mini_batch_src_global generation:  0.06404662132263184
r_  generation:  0.5678610801696777
local_output_nid generation:  0.04036259651184082
local_in_edges_tensor generation:  0.04925060272216797
mini_batch_src_global generation:  0.06251811981201172
r_  generation:  0.5637297630310059
local_output_nid generation:  0.04017305374145508
local_in_edges_tensor generation:  0.03578019142150879
mini_batch_src_global generation:  0.05988264083862305
r_  generation:  0.5612492561340332
local_output_nid generation:  0.04024767875671387
local_in_edges_tensor generation:  0.0372774600982666
mini_batch_src_global generation:  0.06070399284362793
r_  generation:  0.5588071346282959
local_output_nid generation:  0.04195547103881836
local_in_edges_tensor generation:  0.05234360694885254
mini_batch_src_global generation:  0.06055283546447754
r_  generation:  0.5631852149963379
local_output_nid generation:  0.04125261306762695
local_in_edges_tensor generation:  0.03927803039550781
mini_batch_src_global generation:  0.060593366622924805
r_  generation:  0.5648593902587891
local_output_nid generation:  0.04036760330200195
local_in_edges_tensor generation:  0.05692100524902344
mini_batch_src_global generation:  0.06653022766113281
r_  generation:  0.5788636207580566
local_output_nid generation:  0.04214334487915039
local_in_edges_tensor generation:  0.05432271957397461
mini_batch_src_global generation:  0.06378555297851562
r_  generation:  0.5584111213684082
----------------------check_connections_block total spend ----------------------------- 13.814030647277832
generate_one_block  0.6886582374572754
generate_one_block  0.6886007785797119
generate_one_block  0.700946569442749
generate_one_block  0.7110459804534912
generate_one_block  0.7051029205322266
generate_one_block  0.6819045543670654
generate_one_block  0.772902250289917
generate_one_block  0.6777868270874023
generate_one_block  0.6951017379760742
generate_one_block  0.6993889808654785
generate_one_block  0.6751620769500732
generate_one_block  0.6924371719360352
generate_one_block  0.6860601902008057
generate_one_block  0.672360897064209
generate_one_block  0.6750702857971191
generate_one_block  0.6937007904052734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03311610221862793
gen group dst list time:  0.0989999771118164
time for parepare:  0.019095182418823242
local_output_nid generation:  0.03708672523498535
local_in_edges_tensor generation:  0.05417013168334961
mini_batch_src_global generation:  0.04416322708129883
r_  generation:  0.5123562812805176
local_output_nid generation:  0.04230690002441406
local_in_edges_tensor generation:  0.0355687141418457
mini_batch_src_global generation:  0.05787301063537598
r_  generation:  0.511850118637085
local_output_nid generation:  0.04061293601989746
local_in_edges_tensor generation:  0.04094266891479492
mini_batch_src_global generation:  0.0577237606048584
r_  generation:  0.5163891315460205
local_output_nid generation:  0.040830135345458984
local_in_edges_tensor generation:  0.04709148406982422
mini_batch_src_global generation:  0.06007051467895508
r_  generation:  0.523613452911377
local_output_nid generation:  0.04367327690124512
local_in_edges_tensor generation:  0.04209184646606445
mini_batch_src_global generation:  0.05903792381286621
r_  generation:  0.5147874355316162
local_output_nid generation:  0.041570186614990234
local_in_edges_tensor generation:  0.0461735725402832
mini_batch_src_global generation:  0.05652451515197754
r_  generation:  0.5173757076263428
local_output_nid generation:  0.04164433479309082
local_in_edges_tensor generation:  0.03983616828918457
mini_batch_src_global generation:  0.060749053955078125
r_  generation:  0.5213866233825684
local_output_nid generation:  0.041490793228149414
local_in_edges_tensor generation:  0.03674149513244629
mini_batch_src_global generation:  0.05745959281921387
r_  generation:  0.5234858989715576
local_output_nid generation:  0.04165029525756836
local_in_edges_tensor generation:  0.044556379318237305
mini_batch_src_global generation:  0.057129859924316406
r_  generation:  0.5324335098266602
local_output_nid generation:  0.04161214828491211
local_in_edges_tensor generation:  0.04119229316711426
mini_batch_src_global generation:  0.05690789222717285
r_  generation:  0.5230598449707031
local_output_nid generation:  0.04124569892883301
local_in_edges_tensor generation:  0.0396425724029541
mini_batch_src_global generation:  0.056270599365234375
r_  generation:  0.5244016647338867
local_output_nid generation:  0.04174017906188965
local_in_edges_tensor generation:  0.04596424102783203
mini_batch_src_global generation:  0.056069374084472656
r_  generation:  0.5262396335601807
local_output_nid generation:  0.041495561599731445
local_in_edges_tensor generation:  0.03999209403991699
mini_batch_src_global generation:  0.05682802200317383
r_  generation:  0.528710126876831
local_output_nid generation:  0.04172992706298828
local_in_edges_tensor generation:  0.041010141372680664
mini_batch_src_global generation:  0.05696272850036621
r_  generation:  0.5288896560668945
local_output_nid generation:  0.04129457473754883
local_in_edges_tensor generation:  0.04455423355102539
mini_batch_src_global generation:  0.05625724792480469
r_  generation:  0.532799243927002
local_output_nid generation:  0.04165363311767578
local_in_edges_tensor generation:  0.041115760803222656
mini_batch_src_global generation:  0.05657482147216797
r_  generation:  0.5346620082855225
----------------------check_connections_block total spend ----------------------------- 12.597402811050415
generate_one_block  0.6422269344329834
generate_one_block  0.649716854095459
generate_one_block  0.6408913135528564
generate_one_block  0.6465885639190674
generate_one_block  0.6399993896484375
generate_one_block  0.6403875350952148
generate_one_block  0.6411120891571045
generate_one_block  0.6342973709106445
generate_one_block  0.6398899555206299
generate_one_block  0.7206289768218994
generate_one_block  0.6286365985870361
generate_one_block  0.6397571563720703
generate_one_block  0.6461033821105957
generate_one_block  0.6304233074188232
generate_one_block  0.6433131694793701
generate_one_block  0.6477973461151123
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.19973421096801758  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

connection checking time:  43.72942495346069
block generation total time  36.51493167877197
average batch blocks generation time:  2.2821832299232483
block dataloader generation time/epoch 83.43294668197632
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 0.12461328506469727  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166360, 128])
torch.Size([164067, 128])
torch.Size([156049, 128])
torch.Size([123471, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 1.152897834777832  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12479400634765625  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166236, 128])
torch.Size([163853, 128])
torch.Size([155750, 128])
torch.Size([124088, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.155759334564209  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12455272674560547  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166251, 128])
torch.Size([163860, 128])
torch.Size([155542, 128])
torch.Size([123036, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1501879692077637  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12462902069091797  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166238, 128])
torch.Size([163898, 128])
torch.Size([156050, 128])
torch.Size([124096, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.15455961227417  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.1245737075805664  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166353, 128])
torch.Size([164034, 128])
torch.Size([155763, 128])
torch.Size([123427, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1520700454711914  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12453746795654297  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166283, 128])
torch.Size([164016, 128])
torch.Size([155805, 128])
torch.Size([123314, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1519956588745117  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.1246805191040039  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166334, 128])
torch.Size([164005, 128])
torch.Size([155845, 128])
torch.Size([124111, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.155308723449707  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12467384338378906  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166266, 128])
torch.Size([163877, 128])
torch.Size([155725, 128])
torch.Size([123600, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.153191089630127  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.124725341796875  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166252, 128])
torch.Size([163898, 128])
torch.Size([155848, 128])
torch.Size([124086, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1548662185668945  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12466812133789062  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166330, 128])
torch.Size([163976, 128])
torch.Size([155873, 128])
torch.Size([123739, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1537775993347168  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12496185302734375  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

torch.Size([166170, 128])
torch.Size([163719, 128])
torch.Size([155602, 128])
torch.Size([124692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.157360553741455  GigaBytes
Max Memory Allocated: 1.1961255073547363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12474918365478516  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

torch.Size([166279, 128])
torch.Size([163961, 128])
torch.Size([155995, 128])
torch.Size([124414, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1565608978271484  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12455368041992188  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

torch.Size([166314, 128])
torch.Size([163919, 128])
torch.Size([155619, 128])
torch.Size([123234, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1502118110656738  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12459468841552734  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

torch.Size([166159, 128])
torch.Size([163690, 128])
torch.Size([155344, 128])
torch.Size([123246, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1512432098388672  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12461185455322266  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

torch.Size([166223, 128])
torch.Size([163859, 128])
torch.Size([155786, 128])
torch.Size([123724, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1532573699951172  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 0.12469768524169922  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

torch.Size([166246, 128])
torch.Size([163902, 128])
torch.Size([155673, 128])
torch.Size([123805, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5252685546875 GB
    Memory Allocated: 1.1541390419006348  GigaBytes
Max Memory Allocated: 1.1977872848510742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06915321946144104 |0.0318293571472168 |0.006414845585823059 |0.00010593235492706299 |0.009503975510597229 |0.0030345916748046875 |
----------------------------------------------------------pseudo_mini_loss sum 3.8615407943725586
Total (block generation + training)time/epoch 85.39210367202759
Training time/epoch 1.958808183670044
Training time without block to device /epoch 1.4495384693145752
Training time without total dataloading part /epoch 0.2594306468963623
load block tensor time/epoch 1.1064515113830566
block to device time/epoch 0.5092697143554688
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10416805
Number of first layer input nodes during this epoch:  2660294
