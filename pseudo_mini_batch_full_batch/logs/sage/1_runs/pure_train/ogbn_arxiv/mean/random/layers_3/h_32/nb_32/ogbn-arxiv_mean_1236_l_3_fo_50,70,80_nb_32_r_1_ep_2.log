Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439028.5211353
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026955127716064453
random selection method range initialization spend 0.00649261474609375
time for parepare:  0.018845081329345703
local_output_nid generation:  0.0011687278747558594
local_in_edges_tensor generation:  0.004541635513305664
mini_batch_src_global generation:  0.0015978813171386719
r_  generation:  0.010671854019165039
local_output_nid generation:  0.0013141632080078125
local_in_edges_tensor generation:  0.001026153564453125
mini_batch_src_global generation:  0.001600503921508789
r_  generation:  0.009257078170776367
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.009577751159667969
local_output_nid generation:  0.0014271736145019531
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.009212493896484375
local_output_nid generation:  0.0014448165893554688
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0010211467742919922
r_  generation:  0.009661197662353516
local_output_nid generation:  0.001417398452758789
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.0098419189453125
local_output_nid generation:  0.0014438629150390625
local_in_edges_tensor generation:  0.0008256435394287109
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.009636402130126953
local_output_nid generation:  0.0014536380767822266
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.009898900985717773
local_output_nid generation:  0.0014431476593017578
local_in_edges_tensor generation:  0.0007977485656738281
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.00976872444152832
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.00078582763671875
mini_batch_src_global generation:  0.001054525375366211
r_  generation:  0.009876489639282227
local_output_nid generation:  0.0014469623565673828
local_in_edges_tensor generation:  0.0007891654968261719
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.01027369499206543
local_output_nid generation:  0.0015091896057128906
local_in_edges_tensor generation:  0.0008189678192138672
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.010095834732055664
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0008120536804199219
mini_batch_src_global generation:  0.0010411739349365234
r_  generation:  0.010016918182373047
local_output_nid generation:  0.0015113353729248047
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.009867191314697266
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007925033569335938
mini_batch_src_global generation:  0.0010335445404052734
r_  generation:  0.010210037231445312
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0009846687316894531
r_  generation:  0.009534835815429688
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.001054525375366211
r_  generation:  0.009807825088500977
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0010235309600830078
r_  generation:  0.01022028923034668
local_output_nid generation:  0.0015163421630859375
local_in_edges_tensor generation:  0.0007691383361816406
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.010111093521118164
local_output_nid generation:  0.0014774799346923828
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0010330677032470703
r_  generation:  0.010087728500366211
local_output_nid generation:  0.001466989517211914
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.000985860824584961
r_  generation:  0.009587287902832031
local_output_nid generation:  0.001462697982788086
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.010242700576782227
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0007517337799072266
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.009673595428466797
local_output_nid generation:  0.0014357566833496094
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.01049351692199707
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.009786844253540039
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.009776830673217773
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.0007452964782714844
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.010074138641357422
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.00072479248046875
mini_batch_src_global generation:  0.0010025501251220703
r_  generation:  0.010134220123291016
local_output_nid generation:  0.0014696121215820312
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.009800195693969727
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.005499124526977539
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.00957632064819336
local_output_nid generation:  0.0013260841369628906
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.009956598281860352
local_output_nid generation:  0.0013918876647949219
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.009819269180297852
----------------------check_connections_block total spend ----------------------------- 0.5395927429199219
generate_one_block  0.015700817108154297
generate_one_block  0.014550924301147461
generate_one_block  0.015495777130126953
generate_one_block  0.014595508575439453
generate_one_block  0.015263557434082031
generate_one_block  0.01534271240234375
generate_one_block  0.014728307723999023
generate_one_block  0.015197038650512695
generate_one_block  0.014984846115112305
generate_one_block  0.015479564666748047
generate_one_block  0.015223979949951172
generate_one_block  0.014901161193847656
generate_one_block  0.014902353286743164
generate_one_block  0.014891386032104492
generate_one_block  0.015167474746704102
generate_one_block  0.014309406280517578
generate_one_block  0.014624595642089844
generate_one_block  0.01536870002746582
generate_one_block  0.014953374862670898
generate_one_block  0.015294313430786133
generate_one_block  0.01438450813293457
generate_one_block  0.015092134475708008
generate_one_block  0.014357566833496094
generate_one_block  0.01581883430480957
generate_one_block  0.014619588851928711
generate_one_block  0.014421701431274414
generate_one_block  0.014894962310791016
generate_one_block  0.014769554138183594
generate_one_block  0.014335155487060547
generate_one_block  0.014038801193237305
generate_one_block  0.014819860458374023
generate_one_block  0.014335393905639648
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04469418525695801
gen group dst list time:  0.023609638214111328
time for parepare:  0.019452810287475586
local_output_nid generation:  0.005026102066040039
local_in_edges_tensor generation:  0.015034198760986328
mini_batch_src_global generation:  0.01630854606628418
r_  generation:  0.15895414352416992
local_output_nid generation:  0.00822901725769043
local_in_edges_tensor generation:  0.01496744155883789
mini_batch_src_global generation:  0.020371437072753906
r_  generation:  0.16400957107543945
local_output_nid generation:  0.008283376693725586
local_in_edges_tensor generation:  0.012928485870361328
mini_batch_src_global generation:  0.01993727684020996
r_  generation:  0.1818399429321289
local_output_nid generation:  0.007970571517944336
local_in_edges_tensor generation:  0.011029958724975586
mini_batch_src_global generation:  0.020481586456298828
r_  generation:  0.1734919548034668
local_output_nid generation:  0.008109807968139648
local_in_edges_tensor generation:  0.010844945907592773
mini_batch_src_global generation:  0.021146774291992188
r_  generation:  0.1759803295135498
local_output_nid generation:  0.008255720138549805
local_in_edges_tensor generation:  0.01420283317565918
mini_batch_src_global generation:  0.022348403930664062
r_  generation:  0.17992210388183594
local_output_nid generation:  0.007983207702636719
local_in_edges_tensor generation:  0.009153604507446289
mini_batch_src_global generation:  0.0223236083984375
r_  generation:  0.1730806827545166
local_output_nid generation:  0.008082389831542969
local_in_edges_tensor generation:  0.011014223098754883
mini_batch_src_global generation:  0.023593664169311523
r_  generation:  0.18144750595092773
local_output_nid generation:  0.008109331130981445
local_in_edges_tensor generation:  0.009429454803466797
mini_batch_src_global generation:  0.022478103637695312
r_  generation:  0.1793043613433838
local_output_nid generation:  0.007988452911376953
local_in_edges_tensor generation:  0.009422540664672852
mini_batch_src_global generation:  0.022115468978881836
r_  generation:  0.17505836486816406
local_output_nid generation:  0.008022308349609375
local_in_edges_tensor generation:  0.012221097946166992
mini_batch_src_global generation:  0.022656917572021484
r_  generation:  0.18200087547302246
local_output_nid generation:  0.00803685188293457
local_in_edges_tensor generation:  0.010010480880737305
mini_batch_src_global generation:  0.022516727447509766
r_  generation:  0.17836260795593262
local_output_nid generation:  0.008177995681762695
local_in_edges_tensor generation:  0.010846376419067383
mini_batch_src_global generation:  0.022483110427856445
r_  generation:  0.18070459365844727
local_output_nid generation:  0.007960796356201172
local_in_edges_tensor generation:  0.012338638305664062
mini_batch_src_global generation:  0.023116350173950195
r_  generation:  0.1853804588317871
local_output_nid generation:  0.008107900619506836
local_in_edges_tensor generation:  0.010756254196166992
mini_batch_src_global generation:  0.02410268783569336
r_  generation:  0.18192076683044434
local_output_nid generation:  0.0076940059661865234
local_in_edges_tensor generation:  0.009203672409057617
mini_batch_src_global generation:  0.022189617156982422
r_  generation:  0.1754443645477295
local_output_nid generation:  0.007903814315795898
local_in_edges_tensor generation:  0.010198831558227539
mini_batch_src_global generation:  0.02345442771911621
r_  generation:  0.17728710174560547
local_output_nid generation:  0.008115053176879883
local_in_edges_tensor generation:  0.013933897018432617
mini_batch_src_global generation:  0.023198604583740234
r_  generation:  0.18826913833618164
local_output_nid generation:  0.008117437362670898
local_in_edges_tensor generation:  0.012718915939331055
mini_batch_src_global generation:  0.023003339767456055
r_  generation:  0.1796560287475586
local_output_nid generation:  0.008221149444580078
local_in_edges_tensor generation:  0.011087894439697266
mini_batch_src_global generation:  0.024970531463623047
r_  generation:  0.18350672721862793
local_output_nid generation:  0.007837533950805664
local_in_edges_tensor generation:  0.010680675506591797
mini_batch_src_global generation:  0.022327423095703125
r_  generation:  0.17523193359375
local_output_nid generation:  0.008169174194335938
local_in_edges_tensor generation:  0.01102137565612793
mini_batch_src_global generation:  0.024151325225830078
r_  generation:  0.17967534065246582
local_output_nid generation:  0.007901668548583984
local_in_edges_tensor generation:  0.010729074478149414
mini_batch_src_global generation:  0.02241349220275879
r_  generation:  0.17689085006713867
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.012966156005859375
mini_batch_src_global generation:  0.02401137351989746
r_  generation:  0.18800616264343262
local_output_nid generation:  0.007905960083007812
local_in_edges_tensor generation:  0.009336709976196289
mini_batch_src_global generation:  0.02292037010192871
r_  generation:  0.1785132884979248
local_output_nid generation:  0.007863044738769531
local_in_edges_tensor generation:  0.010905265808105469
mini_batch_src_global generation:  0.02260112762451172
r_  generation:  0.1808640956878662
local_output_nid generation:  0.007991552352905273
local_in_edges_tensor generation:  0.011071443557739258
mini_batch_src_global generation:  0.024335861206054688
r_  generation:  0.1803750991821289
local_output_nid generation:  0.007999181747436523
local_in_edges_tensor generation:  0.012193441390991211
mini_batch_src_global generation:  0.02264118194580078
r_  generation:  0.18091630935668945
local_output_nid generation:  0.007800579071044922
local_in_edges_tensor generation:  0.00903940200805664
mini_batch_src_global generation:  0.022278308868408203
r_  generation:  0.17755365371704102
local_output_nid generation:  0.00763702392578125
local_in_edges_tensor generation:  0.009212732315063477
mini_batch_src_global generation:  0.022458553314208984
r_  generation:  0.17406368255615234
local_output_nid generation:  0.007959842681884766
local_in_edges_tensor generation:  0.010912895202636719
mini_batch_src_global generation:  0.022538423538208008
r_  generation:  0.17936062812805176
local_output_nid generation:  0.007759571075439453
local_in_edges_tensor generation:  0.00924825668334961
mini_batch_src_global generation:  0.022157669067382812
r_  generation:  0.1754779815673828
----------------------check_connections_block total spend ----------------------------- 8.31953763961792
generate_one_block  0.22979426383972168
generate_one_block  0.22254133224487305
generate_one_block  0.2603757381439209
generate_one_block  0.22600126266479492
generate_one_block  0.2285933494567871
generate_one_block  0.23545265197753906
generate_one_block  0.22537899017333984
generate_one_block  0.23099589347839355
generate_one_block  0.22681474685668945
generate_one_block  0.2252182960510254
generate_one_block  0.23280620574951172
generate_one_block  0.22673654556274414
generate_one_block  0.23014378547668457
generate_one_block  0.24427223205566406
generate_one_block  0.23406600952148438
generate_one_block  0.2407984733581543
generate_one_block  0.22014665603637695
generate_one_block  0.2349553108215332
generate_one_block  0.23240065574645996
generate_one_block  0.23512935638427734
generate_one_block  0.2180004119873047
generate_one_block  0.22791314125061035
generate_one_block  0.22265028953552246
generate_one_block  0.2413029670715332
generate_one_block  0.22165846824645996
generate_one_block  0.2211287021636963
generate_one_block  0.23041772842407227
generate_one_block  0.22958707809448242
generate_one_block  0.22138190269470215
generate_one_block  0.2174375057220459
generate_one_block  0.2267453670501709
generate_one_block  0.21413969993591309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04354143142700195
gen group dst list time:  0.10217547416687012
time for parepare:  0.018938779830932617
local_output_nid generation:  0.023241281509399414
local_in_edges_tensor generation:  0.04509329795837402
mini_batch_src_global generation:  0.04726219177246094
r_  generation:  0.47197723388671875
local_output_nid generation:  0.031807661056518555
local_in_edges_tensor generation:  0.06792211532592773
mini_batch_src_global generation:  0.07622265815734863
r_  generation:  0.5186946392059326
local_output_nid generation:  0.030858755111694336
local_in_edges_tensor generation:  0.03906083106994629
mini_batch_src_global generation:  0.06109786033630371
r_  generation:  0.49804115295410156
local_output_nid generation:  0.028069257736206055
local_in_edges_tensor generation:  0.03349018096923828
mini_batch_src_global generation:  0.06045198440551758
r_  generation:  0.5178864002227783
local_output_nid generation:  0.03447556495666504
local_in_edges_tensor generation:  0.04047799110412598
mini_batch_src_global generation:  0.08554649353027344
r_  generation:  0.4990699291229248
local_output_nid generation:  0.02945089340209961
local_in_edges_tensor generation:  0.04837632179260254
mini_batch_src_global generation:  0.06692218780517578
r_  generation:  0.5021917819976807
local_output_nid generation:  0.030169963836669922
local_in_edges_tensor generation:  0.04001045227050781
mini_batch_src_global generation:  0.07301473617553711
r_  generation:  0.5220277309417725
local_output_nid generation:  0.03152036666870117
local_in_edges_tensor generation:  0.04188656806945801
mini_batch_src_global generation:  0.06912422180175781
r_  generation:  0.5017514228820801
local_output_nid generation:  0.02914118766784668
local_in_edges_tensor generation:  0.03547835350036621
mini_batch_src_global generation:  0.059815406799316406
r_  generation:  0.5060782432556152
local_output_nid generation:  0.029520273208618164
local_in_edges_tensor generation:  0.031495094299316406
mini_batch_src_global generation:  0.06019186973571777
r_  generation:  0.502600908279419
local_output_nid generation:  0.030379056930541992
local_in_edges_tensor generation:  0.03907132148742676
mini_batch_src_global generation:  0.06009650230407715
r_  generation:  0.5031402111053467
local_output_nid generation:  0.029002666473388672
local_in_edges_tensor generation:  0.029117345809936523
mini_batch_src_global generation:  0.08524203300476074
r_  generation:  0.5013778209686279
local_output_nid generation:  0.03188896179199219
local_in_edges_tensor generation:  0.04029655456542969
mini_batch_src_global generation:  0.08958935737609863
r_  generation:  0.5007586479187012
local_output_nid generation:  0.02937936782836914
local_in_edges_tensor generation:  0.03861713409423828
mini_batch_src_global generation:  0.0597376823425293
r_  generation:  0.5181717872619629
local_output_nid generation:  0.029271841049194336
local_in_edges_tensor generation:  0.02874302864074707
mini_batch_src_global generation:  0.05956673622131348
r_  generation:  0.5043871402740479
local_output_nid generation:  0.02904510498046875
local_in_edges_tensor generation:  0.036864280700683594
mini_batch_src_global generation:  0.059011220932006836
r_  generation:  0.497905969619751
local_output_nid generation:  0.030729293823242188
local_in_edges_tensor generation:  0.03818368911743164
mini_batch_src_global generation:  0.05942869186401367
r_  generation:  0.49923157691955566
local_output_nid generation:  0.029304981231689453
local_in_edges_tensor generation:  0.04418158531188965
mini_batch_src_global generation:  0.05951261520385742
r_  generation:  0.5013236999511719
local_output_nid generation:  0.029424190521240234
local_in_edges_tensor generation:  0.03297829627990723
mini_batch_src_global generation:  0.06085944175720215
r_  generation:  0.500584602355957
local_output_nid generation:  0.02965831756591797
local_in_edges_tensor generation:  0.04171919822692871
mini_batch_src_global generation:  0.060170888900756836
r_  generation:  0.506995677947998
local_output_nid generation:  0.029316186904907227
local_in_edges_tensor generation:  0.032004594802856445
mini_batch_src_global generation:  0.06061530113220215
r_  generation:  0.5185773372650146
local_output_nid generation:  0.029666662216186523
local_in_edges_tensor generation:  0.03660416603088379
mini_batch_src_global generation:  0.06582808494567871
r_  generation:  0.5035271644592285
local_output_nid generation:  0.03034830093383789
local_in_edges_tensor generation:  0.03542447090148926
mini_batch_src_global generation:  0.05915951728820801
r_  generation:  0.504889965057373
local_output_nid generation:  0.029699325561523438
local_in_edges_tensor generation:  0.042428016662597656
mini_batch_src_global generation:  0.06269264221191406
r_  generation:  0.5003161430358887
local_output_nid generation:  0.02902960777282715
local_in_edges_tensor generation:  0.02950596809387207
mini_batch_src_global generation:  0.05882978439331055
r_  generation:  0.506291389465332
local_output_nid generation:  0.029368877410888672
local_in_edges_tensor generation:  0.028153181076049805
mini_batch_src_global generation:  0.06001901626586914
r_  generation:  0.5017242431640625
local_output_nid generation:  0.029111385345458984
local_in_edges_tensor generation:  0.02933502197265625
mini_batch_src_global generation:  0.05788087844848633
r_  generation:  0.5007336139678955
local_output_nid generation:  0.030079126358032227
local_in_edges_tensor generation:  0.03882956504821777
mini_batch_src_global generation:  0.05991244316101074
r_  generation:  0.4990849494934082
local_output_nid generation:  0.028876066207885742
local_in_edges_tensor generation:  0.03319215774536133
mini_batch_src_global generation:  0.0584409236907959
r_  generation:  0.4969024658203125
local_output_nid generation:  0.029045581817626953
local_in_edges_tensor generation:  0.03458046913146973
mini_batch_src_global generation:  0.059038639068603516
r_  generation:  0.5070099830627441
local_output_nid generation:  0.029491662979125977
local_in_edges_tensor generation:  0.033072471618652344
mini_batch_src_global generation:  0.062351226806640625
r_  generation:  0.5010488033294678
local_output_nid generation:  0.028985261917114258
local_in_edges_tensor generation:  0.03310585021972656
mini_batch_src_global generation:  0.05901288986206055
r_  generation:  0.49358510971069336
----------------------check_connections_block total spend ----------------------------- 23.82850933074951
generate_one_block  0.7720816135406494
generate_one_block  0.6504812240600586
generate_one_block  0.6565775871276855
generate_one_block  0.6660556793212891
generate_one_block  0.6600842475891113
generate_one_block  0.6609783172607422
generate_one_block  0.646655797958374
generate_one_block  0.6602218151092529
generate_one_block  0.6619503498077393
generate_one_block  0.6433608531951904
generate_one_block  0.6384801864624023
generate_one_block  0.6456363201141357
generate_one_block  0.6596033573150635
generate_one_block  0.6818668842315674
generate_one_block  0.639570951461792
generate_one_block  0.6282479763031006
generate_one_block  0.6458823680877686
generate_one_block  0.6454381942749023
generate_one_block  0.643704891204834
generate_one_block  0.6646218299865723
generate_one_block  0.6479289531707764
generate_one_block  0.6362850666046143
generate_one_block  0.6431803703308105
generate_one_block  0.6693055629730225
generate_one_block  0.6370368003845215
generate_one_block  0.6441891193389893
generate_one_block  0.6414649486541748
generate_one_block  0.6372253894805908
generate_one_block  0.6407778263092041
generate_one_block  0.6444196701049805
generate_one_block  0.6483466625213623
generate_one_block  0.6422038078308105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  32.14804697036743
block generation total time  28.238849639892578
average batch blocks generation time:  0.8824640512466431
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08860349655151367  GigaBytes
Max Memory Allocated: 0.08860349655151367  GigaBytes

torch.Size([150377, 128])
torch.Size([109751, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.1642894744873047  GigaBytes
Max Memory Allocated: 0.16597270965576172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08880901336669922  GigaBytes
Max Memory Allocated: 0.18413782119750977  GigaBytes

torch.Size([150192, 128])
torch.Size([109118, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16313982009887695  GigaBytes
Max Memory Allocated: 0.18413782119750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08926582336425781  GigaBytes
Max Memory Allocated: 0.18413782119750977  GigaBytes

torch.Size([149991, 128])
torch.Size([109982, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16492080688476562  GigaBytes
Max Memory Allocated: 0.18413782119750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08897209167480469  GigaBytes
Max Memory Allocated: 0.18422508239746094  GigaBytes

torch.Size([149841, 128])
torch.Size([108778, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16420793533325195  GigaBytes
Max Memory Allocated: 0.18422508239746094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0891122817993164  GigaBytes
Max Memory Allocated: 0.18422508239746094  GigaBytes

torch.Size([150801, 128])
torch.Size([110212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16497373580932617  GigaBytes
Max Memory Allocated: 0.18422508239746094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0892953872680664  GigaBytes
Max Memory Allocated: 0.1847209930419922  GigaBytes

torch.Size([150645, 128])
torch.Size([111688, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16691160202026367  GigaBytes
Max Memory Allocated: 0.1847209930419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0890207290649414  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150501, 128])
torch.Size([109834, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16457700729370117  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08920669555664062  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150674, 128])
torch.Size([111291, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1654224395751953  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08910655975341797  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150662, 128])
torch.Size([110828, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16514825820922852  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08899593353271484  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150342, 128])
torch.Size([110183, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16487550735473633  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0891427993774414  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([149857, 128])
torch.Size([109558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16455364227294922  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08897781372070312  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([149845, 128])
torch.Size([109122, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1643986701965332  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08913898468017578  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150276, 128])
torch.Size([110599, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1650371551513672  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08913612365722656  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150407, 128])
torch.Size([110161, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648097038269043  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0891265869140625  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([149681, 128])
torch.Size([109536, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16471385955810547  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08880901336669922  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150130, 128])
torch.Size([109272, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1629180908203125  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08895683288574219  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150263, 128])
torch.Size([109798, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1646585464477539  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08917522430419922  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150361, 128])
torch.Size([110065, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16475677490234375  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08906173706054688  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150225, 128])
torch.Size([109814, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16470766067504883  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0892333984375  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150361, 128])
torch.Size([110260, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16497468948364258  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0888967514038086  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150455, 128])
torch.Size([109660, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1633305549621582  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08904361724853516  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([149772, 128])
torch.Size([109755, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16470861434936523  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0889434814453125  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([149944, 128])
torch.Size([109281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1643834114074707  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08930301666259766  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

torch.Size([150381, 128])
torch.Size([110686, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16623258590698242  GigaBytes
Max Memory Allocated: 0.18556451797485352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08892059326171875  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149832, 128])
torch.Size([109280, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16437292098999023  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0889739990234375  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150966, 128])
torch.Size([110706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16387414932250977  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902645111083984  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149967, 128])
torch.Size([109521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16458368301391602  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08897972106933594  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150189, 128])
torch.Size([109414, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16452932357788086  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08887481689453125  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149844, 128])
torch.Size([108626, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16408777236938477  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08883380889892578  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149835, 128])
torch.Size([109032, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1628270149230957  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08900642395019531  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150661, 128])
torch.Size([110493, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16487503051757812  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08875560760498047  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150090, 128])
torch.Size([109014, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16287899017333984  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031305909156799316 |0.02693675458431244 |0.027357429265975952 |9.47415828704834e-05 |0.005332827568054199 |0.0018477439880371094 |
----------------------------------------------------------pseudo_mini_loss sum 5.062243938446045
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9162829
Number of first layer input nodes during this epoch:  4807368
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12312126159667969  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0226900577545166
random selection method range initialization spend 0.005282402038574219
time for parepare:  0.018197298049926758
local_output_nid generation:  0.0012755393981933594
local_in_edges_tensor generation:  0.004119396209716797
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.010239839553833008
local_output_nid generation:  0.0015213489532470703
local_in_edges_tensor generation:  0.001024007797241211
mini_batch_src_global generation:  0.0015795230865478516
r_  generation:  0.009989500045776367
local_output_nid generation:  0.0015270709991455078
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.009191274642944336
local_output_nid generation:  0.0015149116516113281
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0010046958923339844
r_  generation:  0.00979924201965332
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0008504390716552734
mini_batch_src_global generation:  0.001077890396118164
r_  generation:  0.009728431701660156
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.0008256435394287109
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.010027647018432617
local_output_nid generation:  0.0014731884002685547
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.0010557174682617188
r_  generation:  0.010293722152709961
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0008530616760253906
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.010409355163574219
local_output_nid generation:  0.001489400863647461
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.009955167770385742
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.010429143905639648
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.010386228561401367
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0010428428649902344
r_  generation:  0.010309934616088867
local_output_nid generation:  0.0014986991882324219
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.010317325592041016
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008285045623779297
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.01018071174621582
local_output_nid generation:  0.001497507095336914
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.001062154769897461
r_  generation:  0.010232686996459961
local_output_nid generation:  0.0014879703521728516
local_in_edges_tensor generation:  0.0008094310760498047
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.013106346130371094
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0008296966552734375
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.010059118270874023
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.010223865509033203
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0008270740509033203
mini_batch_src_global generation:  0.0010526180267333984
r_  generation:  0.010415792465209961
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0008325576782226562
mini_batch_src_global generation:  0.0010609626770019531
r_  generation:  0.010580062866210938
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.010444402694702148
local_output_nid generation:  0.001516103744506836
local_in_edges_tensor generation:  0.0008096694946289062
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.010402202606201172
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0010654926300048828
r_  generation:  0.010605335235595703
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0008587837219238281
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.01036524772644043
local_output_nid generation:  0.0015239715576171875
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0010559558868408203
r_  generation:  0.009986639022827148
local_output_nid generation:  0.0014960765838623047
local_in_edges_tensor generation:  0.0008187294006347656
mini_batch_src_global generation:  0.001035928726196289
r_  generation:  0.010460138320922852
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0008413791656494141
mini_batch_src_global generation:  0.0010318756103515625
r_  generation:  0.010213136672973633
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.011002540588378906
local_output_nid generation:  0.0014951229095458984
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0010542869567871094
r_  generation:  0.012862920761108398
local_output_nid generation:  0.0015139579772949219
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.0010333061218261719
r_  generation:  0.010102033615112305
local_output_nid generation:  0.0014994144439697266
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.010884284973144531
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.009977340698242188
----------------------check_connections_block total spend ----------------------------- 0.5577950477600098
generate_one_block  0.023096084594726562
generate_one_block  0.01706409454345703
generate_one_block  0.0166170597076416
generate_one_block  0.014799118041992188
generate_one_block  0.014945507049560547
generate_one_block  0.014835834503173828
generate_one_block  0.014989852905273438
generate_one_block  0.015215873718261719
generate_one_block  0.014615774154663086
generate_one_block  0.016899824142456055
generate_one_block  0.01524209976196289
generate_one_block  0.015755414962768555
generate_one_block  0.015284538269042969
generate_one_block  0.014735698699951172
generate_one_block  0.014750242233276367
generate_one_block  0.014657974243164062
generate_one_block  0.017212867736816406
generate_one_block  0.014924049377441406
generate_one_block  0.01592540740966797
generate_one_block  0.015060901641845703
generate_one_block  0.015558481216430664
generate_one_block  0.01500248908996582
generate_one_block  0.017628192901611328
generate_one_block  0.014700174331665039
generate_one_block  0.014363765716552734
generate_one_block  0.015499591827392578
generate_one_block  0.014865636825561523
generate_one_block  0.015111923217773438
generate_one_block  0.0159759521484375
generate_one_block  0.01719498634338379
generate_one_block  0.015002250671386719
generate_one_block  0.014334917068481445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04328632354736328
gen group dst list time:  0.021813154220581055
time for parepare:  0.02181553840637207
local_output_nid generation:  0.005162477493286133
local_in_edges_tensor generation:  0.015958786010742188
mini_batch_src_global generation:  0.018162012100219727
r_  generation:  0.1653904914855957
local_output_nid generation:  0.008098363876342773
local_in_edges_tensor generation:  0.014972925186157227
mini_batch_src_global generation:  0.02404618263244629
r_  generation:  0.16521716117858887
local_output_nid generation:  0.008235692977905273
local_in_edges_tensor generation:  0.03581857681274414
mini_batch_src_global generation:  0.018449783325195312
r_  generation:  0.17203569412231445
local_output_nid generation:  0.008437633514404297
local_in_edges_tensor generation:  0.01269078254699707
mini_batch_src_global generation:  0.019878864288330078
r_  generation:  0.1777184009552002
local_output_nid generation:  0.0083770751953125
local_in_edges_tensor generation:  0.011375665664672852
mini_batch_src_global generation:  0.023421287536621094
r_  generation:  0.18330621719360352
local_output_nid generation:  0.00811004638671875
local_in_edges_tensor generation:  0.011543035507202148
mini_batch_src_global generation:  0.022257089614868164
r_  generation:  0.18668031692504883
local_output_nid generation:  0.008260011672973633
local_in_edges_tensor generation:  0.011529207229614258
mini_batch_src_global generation:  0.03019261360168457
r_  generation:  0.19419646263122559
local_output_nid generation:  0.011343240737915039
local_in_edges_tensor generation:  0.018624544143676758
mini_batch_src_global generation:  0.024420738220214844
r_  generation:  0.18406271934509277
local_output_nid generation:  0.008262872695922852
local_in_edges_tensor generation:  0.010294914245605469
mini_batch_src_global generation:  0.02215433120727539
r_  generation:  0.17933106422424316
local_output_nid generation:  0.008615255355834961
local_in_edges_tensor generation:  0.00907588005065918
mini_batch_src_global generation:  0.02502274513244629
r_  generation:  0.17836880683898926
local_output_nid generation:  0.008886575698852539
local_in_edges_tensor generation:  0.01080632209777832
mini_batch_src_global generation:  0.02260589599609375
r_  generation:  0.19199395179748535
local_output_nid generation:  0.008751630783081055
local_in_edges_tensor generation:  0.013819217681884766
mini_batch_src_global generation:  0.02278304100036621
r_  generation:  0.18541383743286133
local_output_nid generation:  0.008961915969848633
local_in_edges_tensor generation:  0.01097249984741211
mini_batch_src_global generation:  0.04519510269165039
r_  generation:  0.19385480880737305
local_output_nid generation:  0.00868988037109375
local_in_edges_tensor generation:  0.010783195495605469
mini_batch_src_global generation:  0.023120403289794922
r_  generation:  0.18790221214294434
local_output_nid generation:  0.009567499160766602
local_in_edges_tensor generation:  0.02095341682434082
mini_batch_src_global generation:  0.0245969295501709
r_  generation:  0.19290995597839355
local_output_nid generation:  0.011726617813110352
local_in_edges_tensor generation:  0.013090848922729492
mini_batch_src_global generation:  0.023467540740966797
r_  generation:  0.1819901466369629
local_output_nid generation:  0.008708477020263672
local_in_edges_tensor generation:  0.009636878967285156
mini_batch_src_global generation:  0.022805213928222656
r_  generation:  0.1818253993988037
local_output_nid generation:  0.008651494979858398
local_in_edges_tensor generation:  0.011744976043701172
mini_batch_src_global generation:  0.022872447967529297
r_  generation:  0.18136000633239746
local_output_nid generation:  0.008860588073730469
local_in_edges_tensor generation:  0.011748790740966797
mini_batch_src_global generation:  0.027176618576049805
r_  generation:  0.18146181106567383
local_output_nid generation:  0.008718729019165039
local_in_edges_tensor generation:  0.01040792465209961
mini_batch_src_global generation:  0.04724931716918945
r_  generation:  0.18967604637145996
local_output_nid generation:  0.008544683456420898
local_in_edges_tensor generation:  0.012139320373535156
mini_batch_src_global generation:  0.024992942810058594
r_  generation:  0.18814373016357422
local_output_nid generation:  0.027103900909423828
local_in_edges_tensor generation:  0.009270191192626953
mini_batch_src_global generation:  0.022981643676757812
r_  generation:  0.18712449073791504
local_output_nid generation:  0.00837087631225586
local_in_edges_tensor generation:  0.00958704948425293
mini_batch_src_global generation:  0.022993087768554688
r_  generation:  0.1908574104309082
local_output_nid generation:  0.008362531661987305
local_in_edges_tensor generation:  0.009031295776367188
mini_batch_src_global generation:  0.02332282066345215
r_  generation:  0.18738436698913574
local_output_nid generation:  0.009429931640625
local_in_edges_tensor generation:  0.01615738868713379
mini_batch_src_global generation:  0.022243976593017578
r_  generation:  0.18021059036254883
local_output_nid generation:  0.008492469787597656
local_in_edges_tensor generation:  0.008978843688964844
mini_batch_src_global generation:  0.024294614791870117
r_  generation:  0.1999197006225586
local_output_nid generation:  0.010458946228027344
local_in_edges_tensor generation:  0.012514352798461914
mini_batch_src_global generation:  0.026957988739013672
r_  generation:  0.18555450439453125
local_output_nid generation:  0.008608818054199219
local_in_edges_tensor generation:  0.010711193084716797
mini_batch_src_global generation:  0.022996902465820312
r_  generation:  0.18429231643676758
local_output_nid generation:  0.008601665496826172
local_in_edges_tensor generation:  0.011921405792236328
mini_batch_src_global generation:  0.02341938018798828
r_  generation:  0.1859300136566162
local_output_nid generation:  0.008570194244384766
local_in_edges_tensor generation:  0.009634256362915039
mini_batch_src_global generation:  0.022478818893432617
r_  generation:  0.18289685249328613
local_output_nid generation:  0.008506059646606445
local_in_edges_tensor generation:  0.008655548095703125
mini_batch_src_global generation:  0.022936105728149414
r_  generation:  0.1851637363433838
local_output_nid generation:  0.00843048095703125
local_in_edges_tensor generation:  0.008687019348144531
mini_batch_src_global generation:  0.022345542907714844
r_  generation:  0.1868126392364502
----------------------check_connections_block total spend ----------------------------- 8.713263750076294
generate_one_block  0.23600316047668457
generate_one_block  0.2136681079864502
generate_one_block  0.21711087226867676
generate_one_block  0.22476792335510254
generate_one_block  0.24593520164489746
generate_one_block  0.23308014869689941
generate_one_block  0.22833800315856934
generate_one_block  0.2359161376953125
generate_one_block  0.2235705852508545
generate_one_block  0.2219095230102539
generate_one_block  0.2262098789215088
generate_one_block  0.23586678504943848
generate_one_block  0.24444842338562012
generate_one_block  0.22039532661437988
generate_one_block  0.24199628829956055
generate_one_block  0.22104120254516602
generate_one_block  0.22781944274902344
generate_one_block  0.2270982265472412
generate_one_block  0.2310466766357422
generate_one_block  0.26126599311828613
generate_one_block  0.2389676570892334
generate_one_block  0.23392915725708008
generate_one_block  0.22631406784057617
generate_one_block  0.22326231002807617
generate_one_block  0.2184007167816162
generate_one_block  0.24166297912597656
generate_one_block  0.22798490524291992
generate_one_block  0.226731538772583
generate_one_block  0.2375319004058838
generate_one_block  0.22091102600097656
generate_one_block  0.22599101066589355
generate_one_block  0.22360730171203613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05561423301696777
gen group dst list time:  0.10324859619140625
time for parepare:  0.019504547119140625
local_output_nid generation:  0.02389240264892578
local_in_edges_tensor generation:  0.059256792068481445
mini_batch_src_global generation:  0.04652667045593262
r_  generation:  0.49311017990112305
local_output_nid generation:  0.03100752830505371
local_in_edges_tensor generation:  0.05139327049255371
mini_batch_src_global generation:  0.05934309959411621
r_  generation:  0.4866304397583008
local_output_nid generation:  0.03010082244873047
local_in_edges_tensor generation:  0.039533376693725586
mini_batch_src_global generation:  0.056321144104003906
r_  generation:  0.496079683303833
local_output_nid generation:  0.032106876373291016
local_in_edges_tensor generation:  0.04589080810546875
mini_batch_src_global generation:  0.06028604507446289
r_  generation:  0.4943222999572754
local_output_nid generation:  0.028838396072387695
local_in_edges_tensor generation:  0.036592721939086914
mini_batch_src_global generation:  0.07571148872375488
r_  generation:  0.5131115913391113
local_output_nid generation:  0.0320591926574707
local_in_edges_tensor generation:  0.04089927673339844
mini_batch_src_global generation:  0.06302952766418457
r_  generation:  0.5043206214904785
local_output_nid generation:  0.02992844581604004
local_in_edges_tensor generation:  0.030717134475708008
mini_batch_src_global generation:  0.05918312072753906
r_  generation:  0.5015592575073242
local_output_nid generation:  0.02970576286315918
local_in_edges_tensor generation:  0.03917121887207031
mini_batch_src_global generation:  0.06003737449645996
r_  generation:  0.4954972267150879
local_output_nid generation:  0.029613018035888672
local_in_edges_tensor generation:  0.03134012222290039
mini_batch_src_global generation:  0.05923771858215332
r_  generation:  0.4997224807739258
local_output_nid generation:  0.0299074649810791
local_in_edges_tensor generation:  0.034484148025512695
mini_batch_src_global generation:  0.05942487716674805
r_  generation:  0.5092334747314453
local_output_nid generation:  0.029756546020507812
local_in_edges_tensor generation:  0.03932785987854004
mini_batch_src_global generation:  0.06259989738464355
r_  generation:  0.5056300163269043
local_output_nid generation:  0.02947092056274414
local_in_edges_tensor generation:  0.03019428253173828
mini_batch_src_global generation:  0.05978560447692871
r_  generation:  0.49997854232788086
local_output_nid generation:  0.029635906219482422
local_in_edges_tensor generation:  0.03434133529663086
mini_batch_src_global generation:  0.05895495414733887
r_  generation:  0.5087411403656006
local_output_nid generation:  0.02958989143371582
local_in_edges_tensor generation:  0.03087639808654785
mini_batch_src_global generation:  0.059500932693481445
r_  generation:  0.49863576889038086
local_output_nid generation:  0.029721975326538086
local_in_edges_tensor generation:  0.04814910888671875
mini_batch_src_global generation:  0.05801248550415039
r_  generation:  0.5044827461242676
local_output_nid generation:  0.029462099075317383
local_in_edges_tensor generation:  0.03463411331176758
mini_batch_src_global generation:  0.06002640724182129
r_  generation:  0.4999558925628662
local_output_nid generation:  0.029401540756225586
local_in_edges_tensor generation:  0.03656172752380371
mini_batch_src_global generation:  0.059046268463134766
r_  generation:  0.504957914352417
local_output_nid generation:  0.03033137321472168
local_in_edges_tensor generation:  0.0425412654876709
mini_batch_src_global generation:  0.061422109603881836
r_  generation:  0.4947652816772461
local_output_nid generation:  0.030103445053100586
local_in_edges_tensor generation:  0.0358281135559082
mini_batch_src_global generation:  0.05813121795654297
r_  generation:  0.505573034286499
local_output_nid generation:  0.02955007553100586
local_in_edges_tensor generation:  0.044574737548828125
mini_batch_src_global generation:  0.0639798641204834
r_  generation:  0.4923243522644043
local_output_nid generation:  0.030057668685913086
local_in_edges_tensor generation:  0.03769516944885254
mini_batch_src_global generation:  0.0586247444152832
r_  generation:  0.5204129219055176
local_output_nid generation:  0.030720949172973633
local_in_edges_tensor generation:  0.03955411911010742
mini_batch_src_global generation:  0.06692314147949219
r_  generation:  0.49730777740478516
local_output_nid generation:  0.029665470123291016
local_in_edges_tensor generation:  0.0316767692565918
mini_batch_src_global generation:  0.05864262580871582
r_  generation:  0.5149078369140625
local_output_nid generation:  0.030730009078979492
local_in_edges_tensor generation:  0.03180527687072754
mini_batch_src_global generation:  0.0598752498626709
r_  generation:  0.5071992874145508
local_output_nid generation:  0.02925848960876465
local_in_edges_tensor generation:  0.03769969940185547
mini_batch_src_global generation:  0.058370351791381836
r_  generation:  0.510610818862915
local_output_nid generation:  0.029760360717773438
local_in_edges_tensor generation:  0.037674665451049805
mini_batch_src_global generation:  0.05962419509887695
r_  generation:  0.5057721138000488
local_output_nid generation:  0.029207468032836914
local_in_edges_tensor generation:  0.03752303123474121
mini_batch_src_global generation:  0.05856680870056152
r_  generation:  0.5078697204589844
local_output_nid generation:  0.029565095901489258
local_in_edges_tensor generation:  0.029148578643798828
mini_batch_src_global generation:  0.0630788803100586
r_  generation:  0.506645917892456
local_output_nid generation:  0.029790878295898438
local_in_edges_tensor generation:  0.0379486083984375
mini_batch_src_global generation:  0.058609962463378906
r_  generation:  0.510148286819458
local_output_nid generation:  0.029351472854614258
local_in_edges_tensor generation:  0.027997493743896484
mini_batch_src_global generation:  0.05958366394042969
r_  generation:  0.512843132019043
local_output_nid generation:  0.029337644577026367
local_in_edges_tensor generation:  0.03251504898071289
mini_batch_src_global generation:  0.05820798873901367
r_  generation:  0.5018701553344727
local_output_nid generation:  0.029280900955200195
local_in_edges_tensor generation:  0.03779244422912598
mini_batch_src_global generation:  0.06235814094543457
r_  generation:  0.4931340217590332
----------------------check_connections_block total spend ----------------------------- 23.675538063049316
generate_one_block  0.6757111549377441
generate_one_block  0.6500082015991211
generate_one_block  0.6501367092132568
generate_one_block  0.6566855907440186
generate_one_block  0.7595429420471191
generate_one_block  0.6536462306976318
generate_one_block  0.6515693664550781
generate_one_block  0.659747838973999
generate_one_block  0.6507308483123779
generate_one_block  0.6499927043914795
generate_one_block  0.6589734554290771
generate_one_block  0.6392509937286377
generate_one_block  0.6586759090423584
generate_one_block  0.6412992477416992
generate_one_block  0.6515483856201172
generate_one_block  0.6477806568145752
generate_one_block  0.6607553958892822
generate_one_block  0.7035377025604248
generate_one_block  0.6548902988433838
generate_one_block  0.6659018993377686
generate_one_block  0.6918337345123291
generate_one_block  0.6719503402709961
generate_one_block  0.6510777473449707
generate_one_block  0.6798861026763916
generate_one_block  0.6726744174957275
generate_one_block  0.6793885231018066
generate_one_block  0.6678466796875
generate_one_block  0.6609687805175781
generate_one_block  0.6647274494171143
generate_one_block  0.6374502182006836
generate_one_block  0.6410481929779053
generate_one_block  0.6669614315032959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12312126159667969  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

connection checking time:  32.38880181312561
block generation total time  28.58898162841797
average batch blocks generation time:  0.8934056758880615
block dataloader generation time/epoch 63.58302879333496
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0892481803894043  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150000, 128])
torch.Size([110004, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16473960876464844  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08881759643554688  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149813, 128])
torch.Size([108630, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16277265548706055  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.088897705078125  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149911, 128])
torch.Size([109260, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16313695907592773  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08911895751953125  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150609, 128])
torch.Size([110250, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1650094985961914  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08920097351074219  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150253, 128])
torch.Size([109799, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16469526290893555  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08924579620361328  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150399, 128])
torch.Size([110078, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648693084716797  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08918476104736328  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150081, 128])
torch.Size([110090, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16487741470336914  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08928871154785156  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149787, 128])
torch.Size([110146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16498613357543945  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08904170989990234  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150150, 128])
torch.Size([109523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16451263427734375  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08907890319824219  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150260, 128])
torch.Size([109885, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648550033569336  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08914947509765625  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150676, 128])
torch.Size([110624, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16518592834472656  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08918476104736328  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150263, 128])
torch.Size([109320, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16451549530029297  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08937454223632812  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150538, 128])
torch.Size([110275, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16511249542236328  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08903121948242188  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149976, 128])
torch.Size([109357, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16446304321289062  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08914661407470703  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150032, 128])
torch.Size([109999, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16476058959960938  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08903884887695312  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150102, 128])
torch.Size([109298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16350364685058594  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0891408920288086  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150273, 128])
torch.Size([109762, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16476774215698242  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08906936645507812  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149910, 128])
torch.Size([109257, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16440725326538086  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08914756774902344  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150340, 128])
torch.Size([110158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16500377655029297  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0891265869140625  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150485, 128])
torch.Size([109582, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16472911834716797  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08934497833251953  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150200, 128])
torch.Size([110149, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16509246826171875  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08924198150634766  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150361, 128])
torch.Size([110023, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16489458084106445  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08916282653808594  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150566, 128])
torch.Size([109758, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648087501525879  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08910846710205078  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([149861, 128])
torch.Size([109368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16452407836914062  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08891677856445312  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150165, 128])
torch.Size([108720, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1630849838256836  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08926582336425781  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150629, 128])
torch.Size([111141, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16533422470092773  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08910560607910156  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150295, 128])
torch.Size([109872, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16473388671875  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08916473388671875  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150470, 128])
torch.Size([110511, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1650838851928711  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08928108215332031  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150590, 128])
torch.Size([110701, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1652383804321289  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08905601501464844  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150539, 128])
torch.Size([109649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1647629737854004  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08913612365722656  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150232, 128])
torch.Size([109390, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16460323333740234  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08905410766601562  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

torch.Size([150825, 128])
torch.Size([110330, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16474056243896484  GigaBytes
Max Memory Allocated: 0.18644952774047852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024218305945396423 |0.015384793281555176 |0.0033728107810020447 |8.97720456123352e-05 |0.004107832908630371 |0.0014193058013916016 |
----------------------------------------------------------pseudo_mini_loss sum 4.348130702972412
Total (block generation + training)time/epoch 65.13618803024292
Training time/epoch 1.552910327911377
Training time without block to device /epoch 1.0605969429016113
Training time without total dataloading part /epoch 0.24367260932922363
load block tensor time/epoch 0.7749857902526855
block to device time/epoch 0.4923133850097656
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9162695
Number of first layer input nodes during this epoch:  4808591
