Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443594.616773
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023844003677368164
random selection method range initialization spend 0.0057642459869384766
time for parepare:  0.01945638656616211
local_output_nid generation:  0.00112152099609375
local_in_edges_tensor generation:  0.003049612045288086
mini_batch_src_global generation:  0.0014564990997314453
r_  generation:  0.009253978729248047
local_output_nid generation:  0.0013785362243652344
local_in_edges_tensor generation:  0.0008907318115234375
mini_batch_src_global generation:  0.0013728141784667969
r_  generation:  0.007957935333251953
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0007910728454589844
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.008842229843139648
local_output_nid generation:  0.0014901161193847656
local_in_edges_tensor generation:  0.0007665157318115234
mini_batch_src_global generation:  0.0008456707000732422
r_  generation:  0.007579803466796875
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0007586479187011719
mini_batch_src_global generation:  0.0008554458618164062
r_  generation:  0.008636474609375
local_output_nid generation:  0.0014274120330810547
local_in_edges_tensor generation:  0.0007410049438476562
mini_batch_src_global generation:  0.0008656978607177734
r_  generation:  0.008030176162719727
local_output_nid generation:  0.001444101333618164
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0008280277252197266
r_  generation:  0.00800013542175293
local_output_nid generation:  0.0014073848724365234
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.0008246898651123047
r_  generation:  0.007980108261108398
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.0007908344268798828
r_  generation:  0.007737159729003906
local_output_nid generation:  0.001386404037475586
local_in_edges_tensor generation:  0.0007319450378417969
mini_batch_src_global generation:  0.0008196830749511719
r_  generation:  0.007702827453613281
local_output_nid generation:  0.0013973712921142578
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0008237361907958984
r_  generation:  0.008064985275268555
local_output_nid generation:  0.001383066177368164
local_in_edges_tensor generation:  0.000701904296875
mini_batch_src_global generation:  0.0008392333984375
r_  generation:  0.00831747055053711
local_output_nid generation:  0.0013797283172607422
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.007915019989013672
local_output_nid generation:  0.001402139663696289
local_in_edges_tensor generation:  0.0007112026214599609
mini_batch_src_global generation:  0.0008409023284912109
r_  generation:  0.008076667785644531
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.0007121562957763672
mini_batch_src_global generation:  0.0008437633514404297
r_  generation:  0.008149147033691406
local_output_nid generation:  0.0013954639434814453
local_in_edges_tensor generation:  0.0006971359252929688
mini_batch_src_global generation:  0.0008535385131835938
r_  generation:  0.007926702499389648
local_output_nid generation:  0.0013995170593261719
local_in_edges_tensor generation:  0.0006859302520751953
mini_batch_src_global generation:  0.0008323192596435547
r_  generation:  0.008168697357177734
local_output_nid generation:  0.0013775825500488281
local_in_edges_tensor generation:  0.0007081031799316406
mini_batch_src_global generation:  0.0008521080017089844
r_  generation:  0.00834035873413086
local_output_nid generation:  0.0013668537139892578
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008098125457763672
local_output_nid generation:  0.0013804435729980469
local_in_edges_tensor generation:  0.0007033348083496094
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.008026123046875
local_output_nid generation:  0.0013837814331054688
local_in_edges_tensor generation:  0.0007112026214599609
mini_batch_src_global generation:  0.0008261203765869141
r_  generation:  0.008109569549560547
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.0006940364837646484
mini_batch_src_global generation:  0.0008208751678466797
r_  generation:  0.007972002029418945
local_output_nid generation:  0.0013849735260009766
local_in_edges_tensor generation:  0.0006976127624511719
mini_batch_src_global generation:  0.00083160400390625
r_  generation:  0.00803375244140625
local_output_nid generation:  0.0013761520385742188
local_in_edges_tensor generation:  0.0006997585296630859
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.009235858917236328
local_output_nid generation:  0.0013806819915771484
local_in_edges_tensor generation:  0.0007131099700927734
mini_batch_src_global generation:  0.0009391307830810547
r_  generation:  0.008217334747314453
local_output_nid generation:  0.0014028549194335938
local_in_edges_tensor generation:  0.0007090568542480469
mini_batch_src_global generation:  0.0008502006530761719
r_  generation:  0.008141756057739258
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0007059574127197266
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.008055686950683594
local_output_nid generation:  0.001379251480102539
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.0008935928344726562
r_  generation:  0.008222103118896484
local_output_nid generation:  0.0014278888702392578
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0008687973022460938
r_  generation:  0.008443832397460938
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0052225589752197266
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.008161544799804688
local_output_nid generation:  0.0012705326080322266
local_in_edges_tensor generation:  0.0007307529449462891
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.008285999298095703
local_output_nid generation:  0.0012927055358886719
local_in_edges_tensor generation:  0.0006973743438720703
mini_batch_src_global generation:  0.0008795261383056641
r_  generation:  0.007710933685302734
----------------------check_connections_block total spend ----------------------------- 0.46377015113830566
generate_one_block  0.01374959945678711
generate_one_block  0.013171195983886719
generate_one_block  0.013614177703857422
generate_one_block  0.012726783752441406
generate_one_block  0.013573646545410156
generate_one_block  0.013415336608886719
generate_one_block  0.013020992279052734
generate_one_block  0.013217449188232422
generate_one_block  0.012655973434448242
generate_one_block  0.01292562484741211
generate_one_block  0.013206243515014648
generate_one_block  0.01342010498046875
generate_one_block  0.0128631591796875
generate_one_block  0.01297450065612793
generate_one_block  0.013084173202514648
generate_one_block  0.01264333724975586
generate_one_block  0.01307988166809082
generate_one_block  0.01325535774230957
generate_one_block  0.012975454330444336
generate_one_block  0.012700080871582031
generate_one_block  0.012890815734863281
generate_one_block  0.012803077697753906
generate_one_block  0.012833595275878906
generate_one_block  0.013637065887451172
generate_one_block  0.01303243637084961
generate_one_block  0.013075113296508789
generate_one_block  0.01285243034362793
generate_one_block  0.013253927230834961
generate_one_block  0.013309001922607422
generate_one_block  0.012774229049682617
generate_one_block  0.013438940048217773
generate_one_block  0.012569189071655273
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03823995590209961
gen group dst list time:  0.021248340606689453
time for parepare:  0.018726587295532227
local_output_nid generation:  0.0047168731689453125
local_in_edges_tensor generation:  0.01206827163696289
mini_batch_src_global generation:  0.011701345443725586
r_  generation:  0.11905765533447266
local_output_nid generation:  0.007508277893066406
local_in_edges_tensor generation:  0.007421970367431641
mini_batch_src_global generation:  0.014743804931640625
r_  generation:  0.12503385543823242
local_output_nid generation:  0.007714748382568359
local_in_edges_tensor generation:  0.00874638557434082
mini_batch_src_global generation:  0.014831066131591797
r_  generation:  0.1312711238861084
local_output_nid generation:  0.007069110870361328
local_in_edges_tensor generation:  0.008326530456542969
mini_batch_src_global generation:  0.01407933235168457
r_  generation:  0.12459778785705566
local_output_nid generation:  0.007416248321533203
local_in_edges_tensor generation:  0.009953498840332031
mini_batch_src_global generation:  0.015483617782592773
r_  generation:  0.13705778121948242
local_output_nid generation:  0.007445335388183594
local_in_edges_tensor generation:  0.00760197639465332
mini_batch_src_global generation:  0.015863895416259766
r_  generation:  0.1331956386566162
local_output_nid generation:  0.007212638854980469
local_in_edges_tensor generation:  0.008171796798706055
mini_batch_src_global generation:  0.015760421752929688
r_  generation:  0.1313154697418213
local_output_nid generation:  0.00726318359375
local_in_edges_tensor generation:  0.007688045501708984
mini_batch_src_global generation:  0.015754222869873047
r_  generation:  0.13150405883789062
local_output_nid generation:  0.007106304168701172
local_in_edges_tensor generation:  0.00854039192199707
mini_batch_src_global generation:  0.015732526779174805
r_  generation:  0.12861061096191406
local_output_nid generation:  0.0069997310638427734
local_in_edges_tensor generation:  0.00936126708984375
mini_batch_src_global generation:  0.018422603607177734
r_  generation:  0.12812232971191406
local_output_nid generation:  0.007272005081176758
local_in_edges_tensor generation:  0.009672164916992188
mini_batch_src_global generation:  0.01611948013305664
r_  generation:  0.13364934921264648
local_output_nid generation:  0.007247447967529297
local_in_edges_tensor generation:  0.00976109504699707
mini_batch_src_global generation:  0.017342329025268555
r_  generation:  0.1350696086883545
local_output_nid generation:  0.007125139236450195
local_in_edges_tensor generation:  0.007482290267944336
mini_batch_src_global generation:  0.015675783157348633
r_  generation:  0.13061857223510742
local_output_nid generation:  0.007224321365356445
local_in_edges_tensor generation:  0.008358240127563477
mini_batch_src_global generation:  0.01628875732421875
r_  generation:  0.13548541069030762
local_output_nid generation:  0.007273197174072266
local_in_edges_tensor generation:  0.009499311447143555
mini_batch_src_global generation:  0.016065120697021484
r_  generation:  0.1336665153503418
local_output_nid generation:  0.007048130035400391
local_in_edges_tensor generation:  0.007489919662475586
mini_batch_src_global generation:  0.01580953598022461
r_  generation:  0.12832403182983398
local_output_nid generation:  0.007168769836425781
local_in_edges_tensor generation:  0.007596015930175781
mini_batch_src_global generation:  0.01604437828063965
r_  generation:  0.13649582862854004
local_output_nid generation:  0.0072460174560546875
local_in_edges_tensor generation:  0.010736227035522461
mini_batch_src_global generation:  0.016611576080322266
r_  generation:  0.1345224380493164
local_output_nid generation:  0.007287502288818359
local_in_edges_tensor generation:  0.009731054306030273
mini_batch_src_global generation:  0.01654052734375
r_  generation:  0.1397850513458252
local_output_nid generation:  0.007140398025512695
local_in_edges_tensor generation:  0.007539272308349609
mini_batch_src_global generation:  0.016082048416137695
r_  generation:  0.13556146621704102
local_output_nid generation:  0.007093906402587891
local_in_edges_tensor generation:  0.007460832595825195
mini_batch_src_global generation:  0.0159149169921875
r_  generation:  0.13418173789978027
local_output_nid generation:  0.007093191146850586
local_in_edges_tensor generation:  0.007493734359741211
mini_batch_src_global generation:  0.01589226722717285
r_  generation:  0.13146686553955078
local_output_nid generation:  0.007189273834228516
local_in_edges_tensor generation:  0.007462501525878906
mini_batch_src_global generation:  0.015417337417602539
r_  generation:  0.13101983070373535
local_output_nid generation:  0.007513999938964844
local_in_edges_tensor generation:  0.010022163391113281
mini_batch_src_global generation:  0.016735553741455078
r_  generation:  0.13967418670654297
local_output_nid generation:  0.007293701171875
local_in_edges_tensor generation:  0.009812116622924805
mini_batch_src_global generation:  0.016431808471679688
r_  generation:  0.13308334350585938
local_output_nid generation:  0.007145404815673828
local_in_edges_tensor generation:  0.0075342655181884766
mini_batch_src_global generation:  0.016259193420410156
r_  generation:  0.13510894775390625
local_output_nid generation:  0.007094860076904297
local_in_edges_tensor generation:  0.00757908821105957
mini_batch_src_global generation:  0.015697002410888672
r_  generation:  0.13141345977783203
local_output_nid generation:  0.0073969364166259766
local_in_edges_tensor generation:  0.009209394454956055
mini_batch_src_global generation:  0.017116546630859375
r_  generation:  0.13585615158081055
local_output_nid generation:  0.007321834564208984
local_in_edges_tensor generation:  0.009744882583618164
mini_batch_src_global generation:  0.016510486602783203
r_  generation:  0.1368117332458496
local_output_nid generation:  0.0071794986724853516
local_in_edges_tensor generation:  0.007536172866821289
mini_batch_src_global generation:  0.01616954803466797
r_  generation:  0.1355438232421875
local_output_nid generation:  0.00722503662109375
local_in_edges_tensor generation:  0.008593559265136719
mini_batch_src_global generation:  0.016104936599731445
r_  generation:  0.1367805004119873
local_output_nid generation:  0.007005214691162109
local_in_edges_tensor generation:  0.007253408432006836
mini_batch_src_global generation:  0.015703916549682617
r_  generation:  0.12770438194274902
----------------------check_connections_block total spend ----------------------------- 6.266116619110107
generate_one_block  0.1665489673614502
generate_one_block  0.16350841522216797
generate_one_block  0.18911170959472656
generate_one_block  0.1586909294128418
generate_one_block  0.17252087593078613
generate_one_block  0.1676006317138672
generate_one_block  0.16151070594787598
generate_one_block  0.16546154022216797
generate_one_block  0.16461515426635742
generate_one_block  0.15814471244812012
generate_one_block  0.16666650772094727
generate_one_block  0.16967487335205078
generate_one_block  0.15760183334350586
generate_one_block  0.16466951370239258
generate_one_block  0.16507601737976074
generate_one_block  0.1786050796508789
generate_one_block  0.16724467277526855
generate_one_block  0.1676640510559082
generate_one_block  0.16869568824768066
generate_one_block  0.1601085662841797
generate_one_block  0.1658802032470703
generate_one_block  0.16178679466247559
generate_one_block  0.1602029800415039
generate_one_block  0.17681121826171875
generate_one_block  0.1626567840576172
generate_one_block  0.16534805297851562
generate_one_block  0.16141986846923828
generate_one_block  0.17208647727966309
generate_one_block  0.16988420486450195
generate_one_block  0.16286993026733398
generate_one_block  0.16806697845458984
generate_one_block  0.15508747100830078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03230476379394531
gen group dst list time:  0.09449291229248047
time for parepare:  0.018862485885620117
local_output_nid generation:  0.020560741424560547
local_in_edges_tensor generation:  0.03582000732421875
mini_batch_src_global generation:  0.03579592704772949
r_  generation:  0.38065481185913086
local_output_nid generation:  0.02726149559020996
local_in_edges_tensor generation:  0.03852200508117676
mini_batch_src_global generation:  0.04494786262512207
r_  generation:  0.3872208595275879
local_output_nid generation:  0.027647972106933594
local_in_edges_tensor generation:  0.03587460517883301
mini_batch_src_global generation:  0.044904232025146484
r_  generation:  0.39520978927612305
local_output_nid generation:  0.025928735733032227
local_in_edges_tensor generation:  0.024860382080078125
mini_batch_src_global generation:  0.04650449752807617
r_  generation:  0.39463329315185547
local_output_nid generation:  0.026013851165771484
local_in_edges_tensor generation:  0.026401281356811523
mini_batch_src_global generation:  0.046842336654663086
r_  generation:  0.4011862277984619
local_output_nid generation:  0.025933504104614258
local_in_edges_tensor generation:  0.0330042839050293
mini_batch_src_global generation:  0.0474700927734375
r_  generation:  0.3966500759124756
local_output_nid generation:  0.025909423828125
local_in_edges_tensor generation:  0.0294802188873291
mini_batch_src_global generation:  0.04732394218444824
r_  generation:  0.40152740478515625
local_output_nid generation:  0.02579045295715332
local_in_edges_tensor generation:  0.032598257064819336
mini_batch_src_global generation:  0.0513763427734375
r_  generation:  0.39488863945007324
local_output_nid generation:  0.02600693702697754
local_in_edges_tensor generation:  0.026037931442260742
mini_batch_src_global generation:  0.047078609466552734
r_  generation:  0.39672374725341797
local_output_nid generation:  0.025565385818481445
local_in_edges_tensor generation:  0.025289297103881836
mini_batch_src_global generation:  0.04705500602722168
r_  generation:  0.39123010635375977
local_output_nid generation:  0.025803565979003906
local_in_edges_tensor generation:  0.03561210632324219
mini_batch_src_global generation:  0.04649949073791504
r_  generation:  0.40048980712890625
local_output_nid generation:  0.026785850524902344
local_in_edges_tensor generation:  0.03711652755737305
mini_batch_src_global generation:  0.04721498489379883
r_  generation:  0.4043290615081787
local_output_nid generation:  0.025644540786743164
local_in_edges_tensor generation:  0.02435469627380371
mini_batch_src_global generation:  0.0471653938293457
r_  generation:  0.395526647567749
local_output_nid generation:  0.02587151527404785
local_in_edges_tensor generation:  0.02439427375793457
mini_batch_src_global generation:  0.047430992126464844
r_  generation:  0.4022648334503174
local_output_nid generation:  0.026122570037841797
local_in_edges_tensor generation:  0.034800052642822266
mini_batch_src_global generation:  0.047597646713256836
r_  generation:  0.39913320541381836
local_output_nid generation:  0.02577066421508789
local_in_edges_tensor generation:  0.024458885192871094
mini_batch_src_global generation:  0.04716992378234863
r_  generation:  0.3990178108215332
local_output_nid generation:  0.026282548904418945
local_in_edges_tensor generation:  0.024538516998291016
mini_batch_src_global generation:  0.049634456634521484
r_  generation:  0.39872145652770996
local_output_nid generation:  0.026189804077148438
local_in_edges_tensor generation:  0.027886629104614258
mini_batch_src_global generation:  0.052739858627319336
r_  generation:  0.4066436290740967
local_output_nid generation:  0.02642202377319336
local_in_edges_tensor generation:  0.03709268569946289
mini_batch_src_global generation:  0.05687570571899414
r_  generation:  0.4051525592803955
local_output_nid generation:  0.02750849723815918
local_in_edges_tensor generation:  0.03306889533996582
mini_batch_src_global generation:  0.047521352767944336
r_  generation:  0.39498090744018555
local_output_nid generation:  0.026412010192871094
local_in_edges_tensor generation:  0.025577783584594727
mini_batch_src_global generation:  0.04914379119873047
r_  generation:  0.40531420707702637
local_output_nid generation:  0.026769399642944336
local_in_edges_tensor generation:  0.03193020820617676
mini_batch_src_global generation:  0.048223257064819336
r_  generation:  0.39899611473083496
local_output_nid generation:  0.026563405990600586
local_in_edges_tensor generation:  0.023981809616088867
mini_batch_src_global generation:  0.04750394821166992
r_  generation:  0.3964986801147461
local_output_nid generation:  0.027959585189819336
local_in_edges_tensor generation:  0.03394794464111328
mini_batch_src_global generation:  0.04819130897521973
r_  generation:  0.4061920642852783
local_output_nid generation:  0.026676177978515625
local_in_edges_tensor generation:  0.031648874282836914
mini_batch_src_global generation:  0.04735565185546875
r_  generation:  0.4016227722167969
local_output_nid generation:  0.026787757873535156
local_in_edges_tensor generation:  0.030948877334594727
mini_batch_src_global generation:  0.06146645545959473
r_  generation:  0.4039473533630371
local_output_nid generation:  0.026459217071533203
local_in_edges_tensor generation:  0.02890944480895996
mini_batch_src_global generation:  0.06441450119018555
r_  generation:  0.39778709411621094
local_output_nid generation:  0.02776193618774414
local_in_edges_tensor generation:  0.024997711181640625
mini_batch_src_global generation:  0.05083155632019043
r_  generation:  0.4008769989013672
local_output_nid generation:  0.026628971099853516
local_in_edges_tensor generation:  0.03499746322631836
mini_batch_src_global generation:  0.04685544967651367
r_  generation:  0.4044473171234131
local_output_nid generation:  0.026548385620117188
local_in_edges_tensor generation:  0.02450084686279297
mini_batch_src_global generation:  0.04854297637939453
r_  generation:  0.39748263359069824
local_output_nid generation:  0.026476144790649414
local_in_edges_tensor generation:  0.03144955635070801
mini_batch_src_global generation:  0.04648613929748535
r_  generation:  0.4070308208465576
local_output_nid generation:  0.026376008987426758
local_in_edges_tensor generation:  0.024198293685913086
mini_batch_src_global generation:  0.04756879806518555
r_  generation:  0.39855360984802246
----------------------check_connections_block total spend ----------------------------- 18.93071436882019
generate_one_block  0.6185941696166992
generate_one_block  0.5355019569396973
generate_one_block  0.5207931995391846
generate_one_block  0.502363920211792
generate_one_block  0.5182874202728271
generate_one_block  0.5161986351013184
generate_one_block  0.5051612854003906
generate_one_block  0.5158603191375732
generate_one_block  0.5035223960876465
generate_one_block  0.49651241302490234
generate_one_block  0.5133941173553467
generate_one_block  0.535332202911377
generate_one_block  0.4982738494873047
generate_one_block  0.514857292175293
generate_one_block  0.5140824317932129
generate_one_block  0.5013511180877686
generate_one_block  0.5138623714447021
generate_one_block  0.5116562843322754
generate_one_block  0.5302059650421143
generate_one_block  0.5010824203491211
generate_one_block  0.5166621208190918
generate_one_block  0.5247278213500977
generate_one_block  0.5022799968719482
generate_one_block  0.5268721580505371
generate_one_block  0.5196640491485596
generate_one_block  0.5164706707000732
generate_one_block  0.4990878105163574
generate_one_block  0.5146169662475586
generate_one_block  0.5226449966430664
generate_one_block  0.5019302368164062
generate_one_block  0.5148773193359375
generate_one_block  0.49736547470092773
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  25.196830987930298
block generation total time  21.839914798736572
average batch blocks generation time:  0.6824973374605179
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08246755599975586  GigaBytes
Max Memory Allocated: 0.08246755599975586  GigaBytes

torch.Size([145184, 128])
torch.Size([99206, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.5480680465698242  GigaBytes
Max Memory Allocated: 0.5695962905883789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.08345603942871094  GigaBytes
Max Memory Allocated: 0.6448154449462891  GigaBytes

torch.Size([144760, 128])
torch.Size([98689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.5454492568969727  GigaBytes
Max Memory Allocated: 0.6448154449462891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.6448154449462891  GigaBytes

torch.Size([145763, 128])
torch.Size([99977, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.556706428527832  GigaBytes
Max Memory Allocated: 0.6448154449462891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.08360624313354492  GigaBytes
Max Memory Allocated: 0.6528520584106445  GigaBytes

torch.Size([145371, 128])
torch.Size([98475, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.5425968170166016  GigaBytes
Max Memory Allocated: 0.6528520584106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.0849924087524414  GigaBytes
Max Memory Allocated: 0.6528520584106445  GigaBytes

torch.Size([145792, 128])
torch.Size([100385, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.5583930015563965  GigaBytes
Max Memory Allocated: 0.6528520584106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08405303955078125  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145848, 128])
torch.Size([100017, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5557746887207031  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08469295501708984  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([146147, 128])
torch.Size([99642, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.552736759185791  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08391094207763672  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145654, 128])
torch.Size([99358, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5530800819396973  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08462715148925781  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145463, 128])
torch.Size([98909, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.547478199005127  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08318948745727539  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([144769, 128])
torch.Size([97420, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.537351131439209  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08475971221923828  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145620, 128])
torch.Size([98793, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5475020408630371  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08416986465454102  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([146011, 128])
torch.Size([100172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5552854537963867  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08339452743530273  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145079, 128])
torch.Size([98181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5422744750976562  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08417892456054688  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([146254, 128])
torch.Size([99909, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5533905029296875  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08469200134277344  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145527, 128])
torch.Size([99217, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5498042106628418  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08352470397949219  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([145406, 128])
torch.Size([98221, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5417966842651367  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08346271514892578  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([144796, 128])
torch.Size([98646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.545534610748291  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08335685729980469  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([144666, 128])
torch.Size([98433, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5461058616638184  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08485031127929688  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

torch.Size([146135, 128])
torch.Size([100451, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5563969612121582  GigaBytes
Max Memory Allocated: 0.6551432609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08321332931518555  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

torch.Size([144539, 128])
torch.Size([98046, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5424294471740723  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08466339111328125  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

torch.Size([145552, 128])
torch.Size([98636, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5456814765930176  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.0837244987487793  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

torch.Size([145527, 128])
torch.Size([99227, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5469303131103516  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08449745178222656  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

torch.Size([145887, 128])
torch.Size([98596, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5452308654785156  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.0843353271484375  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

torch.Size([146086, 128])
torch.Size([101178, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5613822937011719  GigaBytes
Max Memory Allocated: 0.6551871299743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08471393585205078  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145583, 128])
torch.Size([99283, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5495486259460449  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08388614654541016  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145654, 128])
torch.Size([99338, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5511083602905273  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08346271514892578  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145176, 128])
torch.Size([98065, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5428586006164551  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08385848999023438  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145374, 128])
torch.Size([99698, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5545072555541992  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08362340927124023  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145021, 128])
torch.Size([99215, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5491514205932617  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.0835423469543457  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145151, 128])
torch.Size([98429, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5434770584106445  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.08360671997070312  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([144992, 128])
torch.Size([99128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5482568740844727  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.0835728645324707  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145605, 128])
torch.Size([98025, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 0.5408363342285156  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044843822717666626 |0.021110326051712036 |0.026830270886421204 |0.00010009855031967163 |0.006102532148361206 |0.0029478073120117188 |
----------------------------------------------------------pseudo_mini_loss sum 6.263408184051514
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8576853
Number of first layer input nodes during this epoch:  4654392
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.10395288467407227  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02053070068359375
random selection method range initialization spend 0.00544285774230957
time for parepare:  0.018763065338134766
local_output_nid generation:  0.0012812614440917969
local_in_edges_tensor generation:  0.007723331451416016
mini_batch_src_global generation:  0.0015604496002197266
r_  generation:  0.008643388748168945
local_output_nid generation:  0.001401662826538086
local_in_edges_tensor generation:  0.0010097026824951172
mini_batch_src_global generation:  0.0014433860778808594
r_  generation:  0.008394241333007812
local_output_nid generation:  0.001430511474609375
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0009462833404541016
r_  generation:  0.00887918472290039
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0008635520935058594
mini_batch_src_global generation:  0.0008807182312011719
r_  generation:  0.008041143417358398
local_output_nid generation:  0.0014300346374511719
local_in_edges_tensor generation:  0.0008356571197509766
mini_batch_src_global generation:  0.0008823871612548828
r_  generation:  0.008215904235839844
local_output_nid generation:  0.0013997554779052734
local_in_edges_tensor generation:  0.00081634521484375
mini_batch_src_global generation:  0.0009131431579589844
r_  generation:  0.007966995239257812
local_output_nid generation:  0.0014133453369140625
local_in_edges_tensor generation:  0.0008225440979003906
mini_batch_src_global generation:  0.0008611679077148438
r_  generation:  0.008212566375732422
local_output_nid generation:  0.001386880874633789
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.008123397827148438
local_output_nid generation:  0.0013775825500488281
local_in_edges_tensor generation:  0.0008172988891601562
mini_batch_src_global generation:  0.0008842945098876953
r_  generation:  0.008009910583496094
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.0008561611175537109
r_  generation:  0.008534908294677734
local_output_nid generation:  0.001390695571899414
local_in_edges_tensor generation:  0.0008165836334228516
mini_batch_src_global generation:  0.0008785724639892578
r_  generation:  0.008261680603027344
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0007967948913574219
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.008263349533081055
local_output_nid generation:  0.001373291015625
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0008769035339355469
r_  generation:  0.00863790512084961
local_output_nid generation:  0.0013949871063232422
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0008261203765869141
r_  generation:  0.007883787155151367
local_output_nid generation:  0.001407623291015625
local_in_edges_tensor generation:  0.0007736682891845703
mini_batch_src_global generation:  0.0008320808410644531
r_  generation:  0.008180618286132812
local_output_nid generation:  0.0013647079467773438
local_in_edges_tensor generation:  0.0007650852203369141
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.008121252059936523
local_output_nid generation:  0.0013701915740966797
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.0008764266967773438
r_  generation:  0.008271455764770508
local_output_nid generation:  0.001421213150024414
local_in_edges_tensor generation:  0.0007722377777099609
mini_batch_src_global generation:  0.0008814334869384766
r_  generation:  0.008411407470703125
local_output_nid generation:  0.0013647079467773438
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0008444786071777344
r_  generation:  0.008396387100219727
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0008902549743652344
r_  generation:  0.008349180221557617
local_output_nid generation:  0.0013964176177978516
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.008311033248901367
local_output_nid generation:  0.0013659000396728516
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.008080720901489258
local_output_nid generation:  0.0013623237609863281
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.008264303207397461
local_output_nid generation:  0.0013844966888427734
local_in_edges_tensor generation:  0.0007545948028564453
mini_batch_src_global generation:  0.0008294582366943359
r_  generation:  0.008334159851074219
local_output_nid generation:  0.0013766288757324219
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0008552074432373047
r_  generation:  0.00841379165649414
local_output_nid generation:  0.0014395713806152344
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.008383750915527344
local_output_nid generation:  0.0014014244079589844
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0008652210235595703
r_  generation:  0.008579015731811523
local_output_nid generation:  0.0014126300811767578
local_in_edges_tensor generation:  0.0007531642913818359
mini_batch_src_global generation:  0.00084686279296875
r_  generation:  0.008219480514526367
local_output_nid generation:  0.0014319419860839844
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0008401870727539062
r_  generation:  0.008028745651245117
local_output_nid generation:  0.0013935565948486328
local_in_edges_tensor generation:  0.0007388591766357422
mini_batch_src_global generation:  0.0008404254913330078
r_  generation:  0.008322954177856445
local_output_nid generation:  0.00139617919921875
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0008304119110107422
r_  generation:  0.00814509391784668
local_output_nid generation:  0.0014123916625976562
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0008258819580078125
r_  generation:  0.008189916610717773
----------------------check_connections_block total spend ----------------------------- 0.4709920883178711
generate_one_block  0.013835906982421875
generate_one_block  0.0161440372467041
generate_one_block  0.013773441314697266
generate_one_block  0.013200759887695312
generate_one_block  0.013454437255859375
generate_one_block  0.013058662414550781
generate_one_block  0.013187646865844727
generate_one_block  0.013189315795898438
generate_one_block  0.013074159622192383
generate_one_block  0.013661623001098633
generate_one_block  0.012915849685668945
generate_one_block  0.013204813003540039
generate_one_block  0.013458490371704102
generate_one_block  0.012660741806030273
generate_one_block  0.012859344482421875
generate_one_block  0.012809991836547852
generate_one_block  0.013270854949951172
generate_one_block  0.01324915885925293
generate_one_block  0.013054370880126953
generate_one_block  0.013023138046264648
generate_one_block  0.013036966323852539
generate_one_block  0.012809276580810547
generate_one_block  0.013251781463623047
generate_one_block  0.013063430786132812
generate_one_block  0.013530254364013672
generate_one_block  0.013037681579589844
generate_one_block  0.013422966003417969
generate_one_block  0.012983560562133789
generate_one_block  0.012880325317382812
generate_one_block  0.013006210327148438
generate_one_block  0.013084650039672852
generate_one_block  0.013066768646240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03616619110107422
gen group dst list time:  0.019738435745239258
time for parepare:  0.019769906997680664
local_output_nid generation:  0.004909992218017578
local_in_edges_tensor generation:  0.015712738037109375
mini_batch_src_global generation:  0.011635065078735352
r_  generation:  0.12050628662109375
local_output_nid generation:  0.007712841033935547
local_in_edges_tensor generation:  0.010592460632324219
mini_batch_src_global generation:  0.014850854873657227
r_  generation:  0.12613582611083984
local_output_nid generation:  0.007925033569335938
local_in_edges_tensor generation:  0.03102278709411621
mini_batch_src_global generation:  0.014731884002685547
r_  generation:  0.13212871551513672
local_output_nid generation:  0.007792949676513672
local_in_edges_tensor generation:  0.008551359176635742
mini_batch_src_global generation:  0.014474153518676758
r_  generation:  0.1305220127105713
local_output_nid generation:  0.007503032684326172
local_in_edges_tensor generation:  0.009694576263427734
mini_batch_src_global generation:  0.01654362678527832
r_  generation:  0.13660216331481934
local_output_nid generation:  0.0072612762451171875
local_in_edges_tensor generation:  0.009706497192382812
mini_batch_src_global generation:  0.01550436019897461
r_  generation:  0.13263154029846191
local_output_nid generation:  0.0074770450592041016
local_in_edges_tensor generation:  0.009820222854614258
mini_batch_src_global generation:  0.016934871673583984
r_  generation:  0.13551712036132812
local_output_nid generation:  0.007347822189331055
local_in_edges_tensor generation:  0.010617733001708984
mini_batch_src_global generation:  0.015976905822753906
r_  generation:  0.1345076560974121
local_output_nid generation:  0.007673501968383789
local_in_edges_tensor generation:  0.009550333023071289
mini_batch_src_global generation:  0.015879392623901367
r_  generation:  0.13444995880126953
local_output_nid generation:  0.007996082305908203
local_in_edges_tensor generation:  0.01071929931640625
mini_batch_src_global generation:  0.01656508445739746
r_  generation:  0.13822031021118164
local_output_nid generation:  0.007643222808837891
local_in_edges_tensor generation:  0.008397102355957031
mini_batch_src_global generation:  0.01616525650024414
r_  generation:  0.1366434097290039
local_output_nid generation:  0.007719993591308594
local_in_edges_tensor generation:  0.010887861251831055
mini_batch_src_global generation:  0.01634836196899414
r_  generation:  0.13479280471801758
local_output_nid generation:  0.007913827896118164
local_in_edges_tensor generation:  0.010919332504272461
mini_batch_src_global generation:  0.02020573616027832
r_  generation:  0.14077210426330566
local_output_nid generation:  0.007570981979370117
local_in_edges_tensor generation:  0.008352279663085938
mini_batch_src_global generation:  0.017728567123413086
r_  generation:  0.132918119430542
local_output_nid generation:  0.00762486457824707
local_in_edges_tensor generation:  0.010136127471923828
mini_batch_src_global generation:  0.016657590866088867
r_  generation:  0.13732433319091797
local_output_nid generation:  0.007732391357421875
local_in_edges_tensor generation:  0.008490800857543945
mini_batch_src_global generation:  0.0156710147857666
r_  generation:  0.1345510482788086
local_output_nid generation:  0.0077092647552490234
local_in_edges_tensor generation:  0.010465383529663086
mini_batch_src_global generation:  0.0162508487701416
r_  generation:  0.14332008361816406
local_output_nid generation:  0.007861137390136719
local_in_edges_tensor generation:  0.010719776153564453
mini_batch_src_global generation:  0.016526222229003906
r_  generation:  0.1404554843902588
local_output_nid generation:  0.007819652557373047
local_in_edges_tensor generation:  0.009524822235107422
mini_batch_src_global generation:  0.016186952590942383
r_  generation:  0.14140748977661133
local_output_nid generation:  0.007776737213134766
local_in_edges_tensor generation:  0.008476734161376953
mini_batch_src_global generation:  0.016558408737182617
r_  generation:  0.14107942581176758
local_output_nid generation:  0.007818460464477539
local_in_edges_tensor generation:  0.008651018142700195
mini_batch_src_global generation:  0.017146587371826172
r_  generation:  0.1466667652130127
local_output_nid generation:  0.008696556091308594
local_in_edges_tensor generation:  0.01619100570678711
mini_batch_src_global generation:  0.018486738204956055
r_  generation:  0.13890600204467773
local_output_nid generation:  0.00984048843383789
local_in_edges_tensor generation:  0.008748054504394531
mini_batch_src_global generation:  0.016353607177734375
r_  generation:  0.1417555809020996
local_output_nid generation:  0.007576942443847656
local_in_edges_tensor generation:  0.010097503662109375
mini_batch_src_global generation:  0.01745438575744629
r_  generation:  0.1367793083190918
local_output_nid generation:  0.0077457427978515625
local_in_edges_tensor generation:  0.008138418197631836
mini_batch_src_global generation:  0.029184818267822266
r_  generation:  0.14654803276062012
local_output_nid generation:  0.007486820220947266
local_in_edges_tensor generation:  0.008063316345214844
mini_batch_src_global generation:  0.016321182250976562
r_  generation:  0.140733003616333
local_output_nid generation:  0.007729053497314453
local_in_edges_tensor generation:  0.00924062728881836
mini_batch_src_global generation:  0.01654672622680664
r_  generation:  0.15045452117919922
local_output_nid generation:  0.007566928863525391
local_in_edges_tensor generation:  0.008954286575317383
mini_batch_src_global generation:  0.016841888427734375
r_  generation:  0.13901376724243164
local_output_nid generation:  0.007410764694213867
local_in_edges_tensor generation:  0.007838726043701172
mini_batch_src_global generation:  0.01594233512878418
r_  generation:  0.14159679412841797
local_output_nid generation:  0.008384466171264648
local_in_edges_tensor generation:  0.013569831848144531
mini_batch_src_global generation:  0.01704716682434082
r_  generation:  0.1480116844177246
local_output_nid generation:  0.009519100189208984
local_in_edges_tensor generation:  0.01632857322692871
mini_batch_src_global generation:  0.017479658126831055
r_  generation:  0.1381535530090332
local_output_nid generation:  0.007553577423095703
local_in_edges_tensor generation:  0.009061098098754883
mini_batch_src_global generation:  0.016179561614990234
r_  generation:  0.13398122787475586
----------------------check_connections_block total spend ----------------------------- 6.578805208206177
generate_one_block  0.17056059837341309
generate_one_block  0.16756796836853027
generate_one_block  0.17679047584533691
generate_one_block  0.167755126953125
generate_one_block  0.18617677688598633
generate_one_block  0.1631791591644287
generate_one_block  0.16749215126037598
generate_one_block  0.1735243797302246
generate_one_block  0.16431236267089844
generate_one_block  0.18000030517578125
generate_one_block  0.16404938697814941
generate_one_block  0.16225290298461914
generate_one_block  0.17275023460388184
generate_one_block  0.1621720790863037
generate_one_block  0.16330170631408691
generate_one_block  0.18835067749023438
generate_one_block  0.1718294620513916
generate_one_block  0.16889119148254395
generate_one_block  0.16583943367004395
generate_one_block  0.20186781883239746
generate_one_block  0.17145824432373047
generate_one_block  0.15781950950622559
generate_one_block  0.16283869743347168
generate_one_block  0.16878080368041992
generate_one_block  0.172224760055542
generate_one_block  0.16558551788330078
generate_one_block  0.18148517608642578
generate_one_block  0.16575241088867188
generate_one_block  0.16801834106445312
generate_one_block  0.1701035499572754
generate_one_block  0.16776204109191895
generate_one_block  0.16765093803405762
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044843196868896484
gen group dst list time:  0.10593867301940918
time for parepare:  0.020009517669677734
local_output_nid generation:  0.022105693817138672
local_in_edges_tensor generation:  0.04638814926147461
mini_batch_src_global generation:  0.03882646560668945
r_  generation:  0.39082908630371094
local_output_nid generation:  0.028020381927490234
local_in_edges_tensor generation:  0.04113006591796875
mini_batch_src_global generation:  0.046721696853637695
r_  generation:  0.39792585372924805
local_output_nid generation:  0.028115272521972656
local_in_edges_tensor generation:  0.034493446350097656
mini_batch_src_global generation:  0.046306610107421875
r_  generation:  0.40402841567993164
local_output_nid generation:  0.028040647506713867
local_in_edges_tensor generation:  0.03416585922241211
mini_batch_src_global generation:  0.04665255546569824
r_  generation:  0.41246652603149414
local_output_nid generation:  0.02647995948791504
local_in_edges_tensor generation:  0.0326840877532959
mini_batch_src_global generation:  0.04970192909240723
r_  generation:  0.40982532501220703
local_output_nid generation:  0.026262760162353516
local_in_edges_tensor generation:  0.026984453201293945
mini_batch_src_global generation:  0.04893136024475098
r_  generation:  0.4079718589782715
local_output_nid generation:  0.027621984481811523
local_in_edges_tensor generation:  0.04009366035461426
mini_batch_src_global generation:  0.05031418800354004
r_  generation:  0.4294917583465576
local_output_nid generation:  0.027480125427246094
local_in_edges_tensor generation:  0.033776283264160156
mini_batch_src_global generation:  0.05458331108093262
r_  generation:  0.4002082347869873
local_output_nid generation:  0.027811050415039062
local_in_edges_tensor generation:  0.03497719764709473
mini_batch_src_global generation:  0.047513723373413086
r_  generation:  0.4042356014251709
local_output_nid generation:  0.027164459228515625
local_in_edges_tensor generation:  0.034125566482543945
mini_batch_src_global generation:  0.04803943634033203
r_  generation:  0.40453028678894043
local_output_nid generation:  0.027241945266723633
local_in_edges_tensor generation:  0.030445098876953125
mini_batch_src_global generation:  0.04744672775268555
r_  generation:  0.40503716468811035
local_output_nid generation:  0.026979446411132812
local_in_edges_tensor generation:  0.027020931243896484
mini_batch_src_global generation:  0.047768592834472656
r_  generation:  0.41311168670654297
local_output_nid generation:  0.027147769927978516
local_in_edges_tensor generation:  0.03382158279418945
mini_batch_src_global generation:  0.05589914321899414
r_  generation:  0.4117155075073242
local_output_nid generation:  0.027092456817626953
local_in_edges_tensor generation:  0.029682397842407227
mini_batch_src_global generation:  0.04732680320739746
r_  generation:  0.40637874603271484
local_output_nid generation:  0.027105093002319336
local_in_edges_tensor generation:  0.03388500213623047
mini_batch_src_global generation:  0.04904508590698242
r_  generation:  0.40601015090942383
local_output_nid generation:  0.027718305587768555
local_in_edges_tensor generation:  0.041990041732788086
mini_batch_src_global generation:  0.04778623580932617
r_  generation:  0.4018371105194092
local_output_nid generation:  0.027143001556396484
local_in_edges_tensor generation:  0.03187131881713867
mini_batch_src_global generation:  0.04680585861206055
r_  generation:  0.4229733943939209
local_output_nid generation:  0.029757261276245117
local_in_edges_tensor generation:  0.030956268310546875
mini_batch_src_global generation:  0.05252885818481445
r_  generation:  0.4042015075683594
local_output_nid generation:  0.02745676040649414
local_in_edges_tensor generation:  0.03080582618713379
mini_batch_src_global generation:  0.04992341995239258
r_  generation:  0.4053080081939697
local_output_nid generation:  0.027076005935668945
local_in_edges_tensor generation:  0.024940013885498047
mini_batch_src_global generation:  0.047182559967041016
r_  generation:  0.4051799774169922
local_output_nid generation:  0.027285099029541016
local_in_edges_tensor generation:  0.02993464469909668
mini_batch_src_global generation:  0.04694056510925293
r_  generation:  0.40316009521484375
local_output_nid generation:  0.027080774307250977
local_in_edges_tensor generation:  0.02437877655029297
mini_batch_src_global generation:  0.04916095733642578
r_  generation:  0.40407276153564453
local_output_nid generation:  0.027113914489746094
local_in_edges_tensor generation:  0.03209543228149414
mini_batch_src_global generation:  0.0501863956451416
r_  generation:  0.41263580322265625
local_output_nid generation:  0.027010440826416016
local_in_edges_tensor generation:  0.024983644485473633
mini_batch_src_global generation:  0.0470280647277832
r_  generation:  0.40438246726989746
local_output_nid generation:  0.027321338653564453
local_in_edges_tensor generation:  0.03522658348083496
mini_batch_src_global generation:  0.04679393768310547
r_  generation:  0.40832948684692383
local_output_nid generation:  0.027987957000732422
local_in_edges_tensor generation:  0.0371556282043457
mini_batch_src_global generation:  0.04780125617980957
r_  generation:  0.4073171615600586
local_output_nid generation:  0.0273897647857666
local_in_edges_tensor generation:  0.03287100791931152
mini_batch_src_global generation:  0.04714632034301758
r_  generation:  0.41460323333740234
local_output_nid generation:  0.027507543563842773
local_in_edges_tensor generation:  0.033304691314697266
mini_batch_src_global generation:  0.04822683334350586
r_  generation:  0.40999722480773926
local_output_nid generation:  0.027163982391357422
local_in_edges_tensor generation:  0.02437114715576172
mini_batch_src_global generation:  0.04661130905151367
r_  generation:  0.4029057025909424
local_output_nid generation:  0.02740192413330078
local_in_edges_tensor generation:  0.029511451721191406
mini_batch_src_global generation:  0.04736161231994629
r_  generation:  0.42679834365844727
local_output_nid generation:  0.02803969383239746
local_in_edges_tensor generation:  0.030431509017944336
mini_batch_src_global generation:  0.049092769622802734
r_  generation:  0.40302348136901855
local_output_nid generation:  0.028180599212646484
local_in_edges_tensor generation:  0.027028560638427734
mini_batch_src_global generation:  0.04740548133850098
r_  generation:  0.4041566848754883
----------------------check_connections_block total spend ----------------------------- 19.3510901927948
generate_one_block  0.5284783840179443
generate_one_block  0.5320496559143066
generate_one_block  0.5255825519561768
generate_one_block  0.5069005489349365
generate_one_block  0.6261687278747559
generate_one_block  0.5166232585906982
generate_one_block  0.5265836715698242
generate_one_block  0.5086140632629395
generate_one_block  0.5230185985565186
generate_one_block  0.5264294147491455
generate_one_block  0.5147550106048584
generate_one_block  0.5149917602539062
generate_one_block  0.5219230651855469
generate_one_block  0.5082125663757324
generate_one_block  0.5162670612335205
generate_one_block  0.509436845779419
generate_one_block  0.5289962291717529
generate_one_block  0.522036075592041
generate_one_block  0.5223355293273926
generate_one_block  0.5117242336273193
generate_one_block  0.5224781036376953
generate_one_block  0.5116603374481201
generate_one_block  0.5226812362670898
generate_one_block  0.5132930278778076
generate_one_block  0.5585427284240723
generate_one_block  0.5189211368560791
generate_one_block  0.532752275466919
generate_one_block  0.5307455062866211
generate_one_block  0.5125188827514648
generate_one_block  0.5115542411804199
generate_one_block  0.5098974704742432
generate_one_block  0.5074036121368408
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.10395288467407227  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

connection checking time:  25.929895401000977
block generation total time  22.201719999313354
average batch blocks generation time:  0.6938037499785423
block dataloader generation time/epoch 50.47444987297058
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08635187149047852  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145879, 128])
torch.Size([99818, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5536923408508301  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08561229705810547  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145760, 128])
torch.Size([99544, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5551509857177734  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.0865478515625  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145548, 128])
torch.Size([100609, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5604844093322754  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08546829223632812  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145682, 128])
torch.Size([99503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5555014610290527  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08652591705322266  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145716, 128])
torch.Size([99817, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5571064949035645  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08534717559814453  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145458, 128])
torch.Size([98939, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5470585823059082  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08546781539916992  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145387, 128])
torch.Size([99435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5547308921813965  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08513641357421875  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145000, 128])
torch.Size([98749, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5470981597900391  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08638381958007812  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145531, 128])
torch.Size([99580, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5539665222167969  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08565473556518555  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145729, 128])
torch.Size([99995, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5575542449951172  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08632183074951172  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145540, 128])
torch.Size([99526, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5528063774108887  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08547306060791016  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145680, 128])
torch.Size([99435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5526185035705566  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08646202087402344  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145676, 128])
torch.Size([99316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5530591011047363  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08513498306274414  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145287, 128])
torch.Size([98338, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5436286926269531  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.085113525390625  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145124, 128])
torch.Size([98658, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5449066162109375  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08497428894042969  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145074, 128])
torch.Size([98056, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5439262390136719  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08639335632324219  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145797, 128])
torch.Size([99557, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5539422035217285  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.0855112075805664  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145716, 128])
torch.Size([99232, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5508794784545898  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08538150787353516  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145398, 128])
torch.Size([99495, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.553034782409668  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08511495590209961  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([144955, 128])
torch.Size([98474, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5467052459716797  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08524465560913086  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145135, 128])
torch.Size([99138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5500869750976562  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08500862121582031  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145032, 128])
torch.Size([98745, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.544428825378418  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08633899688720703  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145818, 128])
torch.Size([99163, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5511484146118164  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08514928817749023  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([144981, 128])
torch.Size([98700, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.546959400177002  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08646678924560547  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145969, 128])
torch.Size([100300, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5569734573364258  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08534622192382812  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145422, 128])
torch.Size([99107, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5484609603881836  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08553647994995117  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145239, 128])
torch.Size([100264, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5556402206420898  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08572673797607422  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145914, 128])
torch.Size([100259, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5549335479736328  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08512210845947266  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145160, 128])
torch.Size([98406, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5442442893981934  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08547687530517578  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145666, 128])
torch.Size([99223, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5496129989624023  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08617973327636719  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145500, 128])
torch.Size([98441, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5467114448547363  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.08514976501464844  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

torch.Size([145330, 128])
torch.Size([98444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.5457959175109863  GigaBytes
Max Memory Allocated: 0.6575736999511719  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04752425104379654 |0.014550037682056427 |0.003623463213443756 |9.422749280929565e-05 |0.003503456711769104 |0.0019159317016601562 |
----------------------------------------------------------pseudo_mini_loss sum 3.2410032749176025
Total (block generation + training)time/epoch 52.76011371612549
Training time/epoch 2.285137176513672
Training time without block to device /epoch 1.8195359706878662
Training time without total dataloading part /epoch 0.23299264907836914
load block tensor time/epoch 1.5207760334014893
block to device time/epoch 0.46560120582580566
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8583811
Number of first layer input nodes during this epoch:  4655103
