Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648509487.5966384
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02380657196044922
random selection method range initialization spend 0.0061244964599609375
time for parepare:  0.01863241195678711
local_output_nid generation:  0.004197120666503906
local_in_edges_tensor generation:  0.0054645538330078125
mini_batch_src_global generation:  0.003404378890991211
r_  generation:  0.03825545310974121
local_output_nid generation:  0.005896806716918945
local_in_edges_tensor generation:  0.003141641616821289
mini_batch_src_global generation:  0.004180908203125
r_  generation:  0.038985490798950195
local_output_nid generation:  0.006012439727783203
local_in_edges_tensor generation:  0.0032262802124023438
mini_batch_src_global generation:  0.002812623977661133
r_  generation:  0.038953304290771484
local_output_nid generation:  0.006031990051269531
local_in_edges_tensor generation:  0.0031833648681640625
mini_batch_src_global generation:  0.0029675960540771484
r_  generation:  0.040746212005615234
local_output_nid generation:  0.006067991256713867
local_in_edges_tensor generation:  0.0031087398529052734
mini_batch_src_global generation:  0.0030677318572998047
r_  generation:  0.04117727279663086
local_output_nid generation:  0.00608515739440918
local_in_edges_tensor generation:  0.0031681060791015625
mini_batch_src_global generation:  0.0032913684844970703
r_  generation:  0.04061269760131836
local_output_nid generation:  0.006068229675292969
local_in_edges_tensor generation:  0.003165006637573242
mini_batch_src_global generation:  0.0033538341522216797
r_  generation:  0.04094982147216797
local_output_nid generation:  0.006070375442504883
local_in_edges_tensor generation:  0.003208637237548828
mini_batch_src_global generation:  0.0033943653106689453
r_  generation:  0.04235029220581055
----------------------check_connections_block total spend ----------------------------- 0.5189807415008545
generate_one_block  0.054935455322265625
generate_one_block  0.05463886260986328
generate_one_block  0.05527687072753906
generate_one_block  0.05572843551635742
generate_one_block  0.05874228477478027
generate_one_block  0.05448722839355469
generate_one_block  0.054496049880981445
generate_one_block  0.055661678314208984
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0402522087097168
gen group dst list time:  0.015871763229370117
time for parepare:  0.019164085388183594
local_output_nid generation:  0.013590097427368164
local_in_edges_tensor generation:  0.031373023986816406
mini_batch_src_global generation:  0.028390169143676758
r_  generation:  0.29508280754089355
local_output_nid generation:  0.020442724227905273
local_in_edges_tensor generation:  0.03026437759399414
mini_batch_src_global generation:  0.03631114959716797
r_  generation:  0.3048548698425293
local_output_nid generation:  0.020116329193115234
local_in_edges_tensor generation:  0.02461528778076172
mini_batch_src_global generation:  0.03792166709899902
r_  generation:  0.30713701248168945
local_output_nid generation:  0.020375967025756836
local_in_edges_tensor generation:  0.025632143020629883
mini_batch_src_global generation:  0.03760361671447754
r_  generation:  0.32119178771972656
local_output_nid generation:  0.02017045021057129
local_in_edges_tensor generation:  0.019257307052612305
mini_batch_src_global generation:  0.03833961486816406
r_  generation:  0.313779354095459
local_output_nid generation:  0.01973867416381836
local_in_edges_tensor generation:  0.021650314331054688
mini_batch_src_global generation:  0.03737616539001465
r_  generation:  0.31326889991760254
local_output_nid generation:  0.020179033279418945
local_in_edges_tensor generation:  0.022137165069580078
mini_batch_src_global generation:  0.03777265548706055
r_  generation:  0.3119943141937256
local_output_nid generation:  0.02008223533630371
local_in_edges_tensor generation:  0.02524113655090332
mini_batch_src_global generation:  0.03801846504211426
r_  generation:  0.3214409351348877
----------------------check_connections_block total spend ----------------------------- 3.684274911880493
generate_one_block  0.40409350395202637
generate_one_block  0.4048933982849121
generate_one_block  0.4070742130279541
generate_one_block  0.4173552989959717
generate_one_block  0.40889549255371094
generate_one_block  0.40606045722961426
generate_one_block  0.40700316429138184
generate_one_block  0.4125797748565674
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03871774673461914
gen group dst list time:  0.03676009178161621
time for parepare:  0.018744468688964844
local_output_nid generation:  0.028878211975097656
local_in_edges_tensor generation:  0.05189156532287598
mini_batch_src_global generation:  0.05291032791137695
r_  generation:  0.5181605815887451
local_output_nid generation:  0.03457832336425781
local_in_edges_tensor generation:  0.05256986618041992
mini_batch_src_global generation:  0.059836387634277344
r_  generation:  0.5268588066101074
local_output_nid generation:  0.03456449508666992
local_in_edges_tensor generation:  0.038594961166381836
mini_batch_src_global generation:  0.05682802200317383
r_  generation:  0.5419540405273438
local_output_nid generation:  0.034834861755371094
local_in_edges_tensor generation:  0.048177242279052734
mini_batch_src_global generation:  0.06164407730102539
r_  generation:  0.536865234375
local_output_nid generation:  0.03538846969604492
local_in_edges_tensor generation:  0.0381922721862793
mini_batch_src_global generation:  0.05847334861755371
r_  generation:  0.5477499961853027
local_output_nid generation:  0.03588461875915527
local_in_edges_tensor generation:  0.036299943923950195
mini_batch_src_global generation:  0.060952186584472656
r_  generation:  0.5431909561157227
local_output_nid generation:  0.03558206558227539
local_in_edges_tensor generation:  0.04767298698425293
mini_batch_src_global generation:  0.06349802017211914
r_  generation:  0.5512735843658447
local_output_nid generation:  0.04058218002319336
local_in_edges_tensor generation:  0.049741268157958984
mini_batch_src_global generation:  0.0729210376739502
r_  generation:  0.5346381664276123
----------------------check_connections_block total spend ----------------------------- 6.376209020614624
generate_one_block  0.6877756118774414
generate_one_block  0.701352596282959
generate_one_block  0.7116312980651855
generate_one_block  0.7137959003448486
generate_one_block  0.6806321144104004
generate_one_block  0.679387092590332
generate_one_block  0.7192611694335938
generate_one_block  0.7006244659423828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05983424186706543
gen group dst list time:  0.05249309539794922
time for parepare:  0.019933462142944336
local_output_nid generation:  0.03558969497680664
local_in_edges_tensor generation:  0.07605981826782227
mini_batch_src_global generation:  0.052130699157714844
r_  generation:  0.5674371719360352
local_output_nid generation:  0.04101824760437012
local_in_edges_tensor generation:  0.06099200248718262
mini_batch_src_global generation:  0.06387829780578613
r_  generation:  0.5813469886779785
local_output_nid generation:  0.043239593505859375
local_in_edges_tensor generation:  0.07122921943664551
mini_batch_src_global generation:  0.0727088451385498
r_  generation:  0.5723855495452881
local_output_nid generation:  0.04288649559020996
local_in_edges_tensor generation:  0.05503344535827637
mini_batch_src_global generation:  0.06482362747192383
r_  generation:  0.5853099822998047
local_output_nid generation:  0.04246044158935547
local_in_edges_tensor generation:  0.05136299133300781
mini_batch_src_global generation:  0.07141590118408203
r_  generation:  0.5681188106536865
local_output_nid generation:  0.039877891540527344
local_in_edges_tensor generation:  0.04494619369506836
mini_batch_src_global generation:  0.06085491180419922
r_  generation:  0.5729012489318848
local_output_nid generation:  0.04108595848083496
local_in_edges_tensor generation:  0.039357900619506836
mini_batch_src_global generation:  0.06247568130493164
r_  generation:  0.5732700824737549
local_output_nid generation:  0.040374040603637695
local_in_edges_tensor generation:  0.04383516311645508
mini_batch_src_global generation:  0.06282448768615723
r_  generation:  0.5917763710021973
----------------------check_connections_block total spend ----------------------------- 6.978233337402344
generate_one_block  0.7432229518890381
generate_one_block  0.712716817855835
generate_one_block  0.7150120735168457
generate_one_block  0.7365016937255859
generate_one_block  0.6967809200286865
generate_one_block  0.7203559875488281
generate_one_block  0.7500267028808594
generate_one_block  0.7077517509460449
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04961442947387695
gen group dst list time:  0.05059099197387695
time for parepare:  0.019665241241455078
local_output_nid generation:  0.036992788314819336
local_in_edges_tensor generation:  0.054872751235961914
mini_batch_src_global generation:  0.050078392028808594
r_  generation:  0.5594453811645508
local_output_nid generation:  0.04250288009643555
local_in_edges_tensor generation:  0.05503702163696289
mini_batch_src_global generation:  0.06424570083618164
r_  generation:  0.5530068874359131
local_output_nid generation:  0.041853904724121094
local_in_edges_tensor generation:  0.04660630226135254
mini_batch_src_global generation:  0.06354427337646484
r_  generation:  0.5530574321746826
local_output_nid generation:  0.04191398620605469
local_in_edges_tensor generation:  0.03990578651428223
mini_batch_src_global generation:  0.06340265274047852
r_  generation:  0.5526957511901855
local_output_nid generation:  0.041931867599487305
local_in_edges_tensor generation:  0.047719717025756836
mini_batch_src_global generation:  0.06513285636901855
r_  generation:  0.5693345069885254
local_output_nid generation:  0.04151725769042969
local_in_edges_tensor generation:  0.037024497985839844
mini_batch_src_global generation:  0.0626676082611084
r_  generation:  0.5580005645751953
local_output_nid generation:  0.041802167892456055
local_in_edges_tensor generation:  0.03625226020812988
mini_batch_src_global generation:  0.06313133239746094
r_  generation:  0.554572343826294
local_output_nid generation:  0.041761159896850586
local_in_edges_tensor generation:  0.0418245792388916
mini_batch_src_global generation:  0.0663611888885498
r_  generation:  0.5625169277191162
----------------------check_connections_block total spend ----------------------------- 6.697044849395752
generate_one_block  0.686884880065918
generate_one_block  0.697662353515625
generate_one_block  0.7007153034210205
generate_one_block  0.6771531105041504
generate_one_block  0.7002737522125244
generate_one_block  0.6776933670043945
generate_one_block  0.677772045135498
generate_one_block  0.7351827621459961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049828290939331055
gen group dst list time:  0.04953169822692871
time for parepare:  0.01965785026550293
local_output_nid generation:  0.037754058837890625
local_in_edges_tensor generation:  0.05368995666503906
mini_batch_src_global generation:  0.0467066764831543
r_  generation:  0.5411074161529541
local_output_nid generation:  0.0415797233581543
local_in_edges_tensor generation:  0.04988288879394531
mini_batch_src_global generation:  0.05902600288391113
r_  generation:  0.5179901123046875
local_output_nid generation:  0.04032707214355469
local_in_edges_tensor generation:  0.04884982109069824
mini_batch_src_global generation:  0.0591280460357666
r_  generation:  0.5260004997253418
local_output_nid generation:  0.043642520904541016
local_in_edges_tensor generation:  0.040825605392456055
mini_batch_src_global generation:  0.060028791427612305
r_  generation:  0.5119402408599854
local_output_nid generation:  0.041364431381225586
local_in_edges_tensor generation:  0.04444313049316406
mini_batch_src_global generation:  0.06207156181335449
r_  generation:  0.5253560543060303
local_output_nid generation:  0.0414271354675293
local_in_edges_tensor generation:  0.04246187210083008
mini_batch_src_global generation:  0.05921649932861328
r_  generation:  0.5173184871673584
local_output_nid generation:  0.04143977165222168
local_in_edges_tensor generation:  0.042710304260253906
mini_batch_src_global generation:  0.05968880653381348
r_  generation:  0.5128700733184814
local_output_nid generation:  0.04185152053833008
local_in_edges_tensor generation:  0.04686999320983887
mini_batch_src_global generation:  0.0587007999420166
r_  generation:  0.5220201015472412
----------------------check_connections_block total spend ----------------------------- 6.322688341140747
generate_one_block  0.6489408016204834
generate_one_block  0.648385763168335
generate_one_block  0.6589229106903076
generate_one_block  0.6305031776428223
generate_one_block  0.6411786079406738
generate_one_block  0.6302182674407959
generate_one_block  0.6360733509063721
generate_one_block  0.6383583545684814
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

connection checking time:  30.05845046043396
block generation total time  25.330703258514404
average batch blocks generation time:  3.1663379073143005
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.13875389099121094  GigaBytes
Max Memory Allocated: 0.13875389099121094  GigaBytes

torch.Size([167480, 128])
torch.Size([167058, 64])
torch.Size([165817, 64])
torch.Size([161418, 64])
torch.Size([142381, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.8853616714477539  GigaBytes
Max Memory Allocated: 0.8980274200439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.14258861541748047  GigaBytes
Max Memory Allocated: 0.9174156188964844  GigaBytes

torch.Size([167553, 128])
torch.Size([167109, 64])
torch.Size([165849, 64])
torch.Size([161365, 64])
torch.Size([141784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.8853306770324707  GigaBytes
Max Memory Allocated: 0.9174156188964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1421198844909668  GigaBytes
Max Memory Allocated: 0.9174156188964844  GigaBytes

torch.Size([167535, 128])
torch.Size([167129, 64])
torch.Size([165895, 64])
torch.Size([161538, 64])
torch.Size([142054, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8863358497619629  GigaBytes
Max Memory Allocated: 0.9174156188964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14226388931274414  GigaBytes
Max Memory Allocated: 0.9179167747497559  GigaBytes

torch.Size([167524, 128])
torch.Size([167069, 64])
torch.Size([165795, 64])
torch.Size([161491, 64])
torch.Size([142419, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8860569000244141  GigaBytes
Max Memory Allocated: 0.9179167747497559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14262676239013672  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167559, 128])
torch.Size([167122, 64])
torch.Size([165873, 64])
torch.Size([161278, 64])
torch.Size([141712, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8845586776733398  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1425642967224121  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167508, 128])
torch.Size([167084, 64])
torch.Size([165809, 64])
torch.Size([161453, 64])
torch.Size([141908, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8838109970092773  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14260292053222656  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167473, 128])
torch.Size([166970, 64])
torch.Size([165626, 64])
torch.Size([161157, 64])
torch.Size([141957, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8840970993041992  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1426682472229004  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167501, 128])
torch.Size([167035, 64])
torch.Size([165735, 64])
torch.Size([161202, 64])
torch.Size([141995, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8856015205383301  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07131794095039368 |0.08946949243545532 |0.09564286470413208 |0.0001036226749420166 |0.02585718035697937 |0.007857561111450195 |
----------------------------------------------------------pseudo_mini_loss sum 5.248985290527344
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6973275
Number of first layer input nodes during this epoch:  1340133
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.26868438720703125  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.019553422927856445
random selection method range initialization spend 0.00691986083984375
time for parepare:  0.01908421516418457
local_output_nid generation:  0.0045468807220458984
local_in_edges_tensor generation:  0.008426427841186523
mini_batch_src_global generation:  0.0041005611419677734
r_  generation:  0.038117408752441406
local_output_nid generation:  0.0059278011322021484
local_in_edges_tensor generation:  0.003041982650756836
mini_batch_src_global generation:  0.0041656494140625
r_  generation:  0.03890085220336914
local_output_nid generation:  0.005942344665527344
local_in_edges_tensor generation:  0.003115415573120117
mini_batch_src_global generation:  0.002928495407104492
r_  generation:  0.03987860679626465
local_output_nid generation:  0.005952596664428711
local_in_edges_tensor generation:  0.003114938735961914
mini_batch_src_global generation:  0.0030274391174316406
r_  generation:  0.04116106033325195
local_output_nid generation:  0.0060672760009765625
local_in_edges_tensor generation:  0.003141164779663086
mini_batch_src_global generation:  0.0031194686889648438
r_  generation:  0.04030418395996094
local_output_nid generation:  0.005982875823974609
local_in_edges_tensor generation:  0.003094196319580078
mini_batch_src_global generation:  0.003246784210205078
r_  generation:  0.04141640663146973
local_output_nid generation:  0.006029367446899414
local_in_edges_tensor generation:  0.003087282180786133
mini_batch_src_global generation:  0.003307819366455078
r_  generation:  0.04205155372619629
local_output_nid generation:  0.006051301956176758
local_in_edges_tensor generation:  0.0031232833862304688
mini_batch_src_global generation:  0.003478527069091797
r_  generation:  0.041831254959106445
----------------------check_connections_block total spend ----------------------------- 0.5265812873840332
generate_one_block  0.0528414249420166
generate_one_block  0.05392026901245117
generate_one_block  0.054041147232055664
generate_one_block  0.05460357666015625
generate_one_block  0.05386042594909668
generate_one_block  0.054808855056762695
generate_one_block  0.05531048774719238
generate_one_block  0.05874466896057129
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03950023651123047
gen group dst list time:  0.014544248580932617
time for parepare:  0.018668413162231445
local_output_nid generation:  0.013403177261352539
local_in_edges_tensor generation:  0.031045913696289062
mini_batch_src_global generation:  0.028614044189453125
r_  generation:  0.296128511428833
local_output_nid generation:  0.0184934139251709
local_in_edges_tensor generation:  0.028656959533691406
mini_batch_src_global generation:  0.036574363708496094
r_  generation:  0.3095278739929199
local_output_nid generation:  0.019034862518310547
local_in_edges_tensor generation:  0.023863554000854492
mini_batch_src_global generation:  0.03594470024108887
r_  generation:  0.31534647941589355
local_output_nid generation:  0.019364118576049805
local_in_edges_tensor generation:  0.023316621780395508
mini_batch_src_global generation:  0.03733253479003906
r_  generation:  0.31731081008911133
local_output_nid generation:  0.019295215606689453
local_in_edges_tensor generation:  0.022009849548339844
mini_batch_src_global generation:  0.03802299499511719
r_  generation:  0.3206024169921875
local_output_nid generation:  0.018126249313354492
local_in_edges_tensor generation:  0.018288850784301758
mini_batch_src_global generation:  0.03864455223083496
r_  generation:  0.31860899925231934
local_output_nid generation:  0.018427371978759766
local_in_edges_tensor generation:  0.023424625396728516
mini_batch_src_global generation:  0.04032468795776367
r_  generation:  0.3268601894378662
local_output_nid generation:  0.018427133560180664
local_in_edges_tensor generation:  0.02069997787475586
mini_batch_src_global generation:  0.0387120246887207
r_  generation:  0.3250105381011963
----------------------check_connections_block total spend ----------------------------- 3.717798948287964
generate_one_block  0.41201186180114746
generate_one_block  0.40456366539001465
generate_one_block  0.40862560272216797
generate_one_block  0.41119933128356934
generate_one_block  0.4232957363128662
generate_one_block  0.4046950340270996
generate_one_block  0.40662503242492676
generate_one_block  0.4496266841888428
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0516352653503418
gen group dst list time:  0.04906630516052246
time for parepare:  0.017918825149536133
local_output_nid generation:  0.029912471771240234
local_in_edges_tensor generation:  0.05924415588378906
mini_batch_src_global generation:  0.04870009422302246
r_  generation:  0.5289015769958496
local_output_nid generation:  0.03502917289733887
local_in_edges_tensor generation:  0.056400299072265625
mini_batch_src_global generation:  0.06046128273010254
r_  generation:  0.5429401397705078
local_output_nid generation:  0.04285240173339844
local_in_edges_tensor generation:  0.04569053649902344
mini_batch_src_global generation:  0.05614805221557617
r_  generation:  0.5732119083404541
local_output_nid generation:  0.040943145751953125
local_in_edges_tensor generation:  0.05765962600708008
mini_batch_src_global generation:  0.06520414352416992
r_  generation:  0.5327823162078857
local_output_nid generation:  0.03650951385498047
local_in_edges_tensor generation:  0.043157100677490234
mini_batch_src_global generation:  0.05934786796569824
r_  generation:  0.5538814067840576
local_output_nid generation:  0.036791324615478516
local_in_edges_tensor generation:  0.04010486602783203
mini_batch_src_global generation:  0.06242942810058594
r_  generation:  0.5502560138702393
local_output_nid generation:  0.03678631782531738
local_in_edges_tensor generation:  0.040207862854003906
mini_batch_src_global generation:  0.07029533386230469
r_  generation:  0.5752484798431396
local_output_nid generation:  0.03655862808227539
local_in_edges_tensor generation:  0.04529166221618652
mini_batch_src_global generation:  0.0659174919128418
r_  generation:  0.5752744674682617
----------------------check_connections_block total spend ----------------------------- 6.581957817077637
generate_one_block  0.7037770748138428
generate_one_block  0.6825785636901855
generate_one_block  0.6834940910339355
generate_one_block  0.6919302940368652
generate_one_block  0.6903500556945801
generate_one_block  0.6869423389434814
generate_one_block  0.6923580169677734
generate_one_block  0.6874704360961914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04639744758605957
gen group dst list time:  0.05207252502441406
time for parepare:  0.01902937889099121
local_output_nid generation:  0.03462505340576172
local_in_edges_tensor generation:  0.06334543228149414
mini_batch_src_global generation:  0.05080866813659668
r_  generation:  0.549126148223877
local_output_nid generation:  0.04231524467468262
local_in_edges_tensor generation:  0.0936739444732666
mini_batch_src_global generation:  0.06618762016296387
r_  generation:  0.5592978000640869
local_output_nid generation:  0.04147648811340332
local_in_edges_tensor generation:  0.05358743667602539
mini_batch_src_global generation:  0.08119678497314453
r_  generation:  0.5748887062072754
local_output_nid generation:  0.042546987533569336
local_in_edges_tensor generation:  0.046784400939941406
mini_batch_src_global generation:  0.06185793876647949
r_  generation:  0.5621883869171143
local_output_nid generation:  0.04056811332702637
local_in_edges_tensor generation:  0.04534196853637695
mini_batch_src_global generation:  0.06153059005737305
r_  generation:  0.5613903999328613
local_output_nid generation:  0.040395498275756836
local_in_edges_tensor generation:  0.04296445846557617
mini_batch_src_global generation:  0.05975914001464844
r_  generation:  0.5685858726501465
local_output_nid generation:  0.04073977470397949
local_in_edges_tensor generation:  0.04085564613342285
mini_batch_src_global generation:  0.06133294105529785
r_  generation:  0.5805637836456299
local_output_nid generation:  0.04037761688232422
local_in_edges_tensor generation:  0.04283618927001953
mini_batch_src_global generation:  0.061154842376708984
r_  generation:  0.5757601261138916
----------------------check_connections_block total spend ----------------------------- 6.842721462249756
generate_one_block  0.7067887783050537
generate_one_block  0.7033991813659668
generate_one_block  0.7114288806915283
generate_one_block  0.7127068042755127
generate_one_block  0.6989963054656982
generate_one_block  0.6868956089019775
generate_one_block  0.6994223594665527
generate_one_block  0.688744068145752
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0388035774230957
gen group dst list time:  0.05324721336364746
time for parepare:  0.018777847290039062
local_output_nid generation:  0.03668618202209473
local_in_edges_tensor generation:  0.05330705642700195
mini_batch_src_global generation:  0.051964521408081055
r_  generation:  0.5534627437591553
local_output_nid generation:  0.04386162757873535
local_in_edges_tensor generation:  0.05405712127685547
mini_batch_src_global generation:  0.06279659271240234
r_  generation:  0.5569005012512207
local_output_nid generation:  0.04160928726196289
local_in_edges_tensor generation:  0.055815696716308594
mini_batch_src_global generation:  0.0661311149597168
r_  generation:  0.5626215934753418
local_output_nid generation:  0.04130697250366211
local_in_edges_tensor generation:  0.046459197998046875
mini_batch_src_global generation:  0.062306880950927734
r_  generation:  0.5698175430297852
local_output_nid generation:  0.04465365409851074
local_in_edges_tensor generation:  0.0465235710144043
mini_batch_src_global generation:  0.06609320640563965
r_  generation:  0.5605461597442627
local_output_nid generation:  0.04240751266479492
local_in_edges_tensor generation:  0.08867096900939941
mini_batch_src_global generation:  0.06185793876647949
r_  generation:  0.5548825263977051
local_output_nid generation:  0.04099416732788086
local_in_edges_tensor generation:  0.041243791580200195
mini_batch_src_global generation:  0.061994075775146484
r_  generation:  0.5558881759643555
local_output_nid generation:  0.04061150550842285
local_in_edges_tensor generation:  0.04555344581604004
mini_batch_src_global generation:  0.06167721748352051
r_  generation:  0.5555999279022217
----------------------check_connections_block total spend ----------------------------- 6.767012119293213
generate_one_block  0.691582441329956
generate_one_block  0.6973063945770264
generate_one_block  0.6944413185119629
generate_one_block  0.6994426250457764
generate_one_block  0.6825203895568848
generate_one_block  0.6913168430328369
generate_one_block  0.68914794921875
generate_one_block  0.6918723583221436
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042806148529052734
gen group dst list time:  0.048074960708618164
time for parepare:  0.01917099952697754
local_output_nid generation:  0.035613298416137695
local_in_edges_tensor generation:  0.05682992935180664
mini_batch_src_global generation:  0.04788494110107422
r_  generation:  0.5104179382324219
local_output_nid generation:  0.04373025894165039
local_in_edges_tensor generation:  0.03662824630737305
mini_batch_src_global generation:  0.05808138847351074
r_  generation:  0.5158286094665527
local_output_nid generation:  0.04360389709472656
local_in_edges_tensor generation:  0.05076742172241211
mini_batch_src_global generation:  0.05835533142089844
r_  generation:  0.5181138515472412
local_output_nid generation:  0.0405428409576416
local_in_edges_tensor generation:  0.046668291091918945
mini_batch_src_global generation:  0.05780911445617676
r_  generation:  0.5238261222839355
local_output_nid generation:  0.040544748306274414
local_in_edges_tensor generation:  0.05466341972351074
mini_batch_src_global generation:  0.05856609344482422
r_  generation:  0.5161809921264648
local_output_nid generation:  0.04068470001220703
local_in_edges_tensor generation:  0.03705334663391113
mini_batch_src_global generation:  0.057773590087890625
r_  generation:  0.5175819396972656
local_output_nid generation:  0.04076528549194336
local_in_edges_tensor generation:  0.036762237548828125
mini_batch_src_global generation:  0.057274580001831055
r_  generation:  0.5156965255737305
local_output_nid generation:  0.040784358978271484
local_in_edges_tensor generation:  0.03635716438293457
mini_batch_src_global generation:  0.06080484390258789
r_  generation:  0.5198452472686768
----------------------check_connections_block total spend ----------------------------- 6.2556397914886475
generate_one_block  0.655266523361206
generate_one_block  0.6304759979248047
generate_one_block  0.6427280902862549
generate_one_block  0.6446592807769775
generate_one_block  0.6454944610595703
generate_one_block  0.6276750564575195
generate_one_block  0.6302368640899658
generate_one_block  0.6484670639038086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.26868438720703125  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

connection checking time:  30.165130138397217
block generation total time  25.110559463500977
average batch blocks generation time:  3.138819932937622
block dataloader generation time/epoch 58.181453227996826
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14260530471801758  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167527, 128])
torch.Size([167022, 64])
torch.Size([165776, 64])
torch.Size([161375, 64])
torch.Size([142346, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8846311569213867  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1430201530456543  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167579, 128])
torch.Size([167102, 64])
torch.Size([165832, 64])
torch.Size([161295, 64])
torch.Size([141353, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.883547306060791  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14304685592651367  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

torch.Size([167545, 128])
torch.Size([167103, 64])
torch.Size([165909, 64])
torch.Size([161479, 64])
torch.Size([142428, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8881363868713379  GigaBytes
Max Memory Allocated: 0.9180231094360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1434025764465332  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

torch.Size([167589, 128])
torch.Size([167121, 64])
torch.Size([165862, 64])
torch.Size([161456, 64])
torch.Size([142250, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8848085403442383  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1425027847290039  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

torch.Size([167589, 128])
torch.Size([167110, 64])
torch.Size([165840, 64])
torch.Size([161458, 64])
torch.Size([142112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8843436241149902  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14302968978881836  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

torch.Size([167539, 128])
torch.Size([167046, 64])
torch.Size([165797, 64])
torch.Size([161366, 64])
torch.Size([141982, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8848052024841309  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14304447174072266  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

torch.Size([167536, 128])
torch.Size([167050, 64])
torch.Size([165754, 64])
torch.Size([161292, 64])
torch.Size([142248, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8877863883972168  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14346075057983398  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

torch.Size([167608, 128])
torch.Size([167109, 64])
torch.Size([165790, 64])
torch.Size([161295, 64])
torch.Size([142017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8848066329956055  GigaBytes
Max Memory Allocated: 0.9199752807617188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06610411405563354 |0.04600578546524048 |0.00673830509185791 |9.271502494812012e-05 |0.033934950828552246 |0.005772590637207031 |
----------------------------------------------------------pseudo_mini_loss sum 4.087337970733643
Total (block generation + training)time/epoch 59.42201614379883
Training time/epoch 1.2402756214141846
Training time without block to device /epoch 0.8722293376922607
Training time without total dataloading part /epoch 0.33190035820007324
load block tensor time/epoch 0.5288329124450684
block to device time/epoch 0.36804628372192383
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6974240
Number of first layer input nodes during this epoch:  1340512
