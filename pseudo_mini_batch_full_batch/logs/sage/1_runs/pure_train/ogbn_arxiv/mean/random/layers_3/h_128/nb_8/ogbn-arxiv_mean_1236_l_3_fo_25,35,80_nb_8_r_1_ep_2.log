Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441914.9319048
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02655768394470215
random selection method range initialization spend 0.006392002105712891
time for parepare:  0.01860189437866211
local_output_nid generation:  0.004230022430419922
local_in_edges_tensor generation:  0.0064771175384521484
mini_batch_src_global generation:  0.003753662109375
r_  generation:  0.04140114784240723
local_output_nid generation:  0.0059661865234375
local_in_edges_tensor generation:  0.0032346248626708984
mini_batch_src_global generation:  0.004741191864013672
r_  generation:  0.04164838790893555
local_output_nid generation:  0.006042003631591797
local_in_edges_tensor generation:  0.003294229507446289
mini_batch_src_global generation:  0.003281116485595703
r_  generation:  0.044403791427612305
local_output_nid generation:  0.0061223506927490234
local_in_edges_tensor generation:  0.003248453140258789
mini_batch_src_global generation:  0.003589630126953125
r_  generation:  0.046773433685302734
local_output_nid generation:  0.0060880184173583984
local_in_edges_tensor generation:  0.0034189224243164062
mini_batch_src_global generation:  0.003699064254760742
r_  generation:  0.04608488082885742
local_output_nid generation:  0.0061380863189697266
local_in_edges_tensor generation:  0.0032033920288085938
mini_batch_src_global generation:  0.003994464874267578
r_  generation:  0.04699277877807617
local_output_nid generation:  0.006069183349609375
local_in_edges_tensor generation:  0.0034275054931640625
mini_batch_src_global generation:  0.003981113433837891
r_  generation:  0.04712343215942383
local_output_nid generation:  0.0061495304107666016
local_in_edges_tensor generation:  0.0033926963806152344
mini_batch_src_global generation:  0.003976583480834961
r_  generation:  0.04819893836975098
----------------------check_connections_block total spend ----------------------------- 0.57460618019104
generate_one_block  0.06103658676147461
generate_one_block  0.06055593490600586
generate_one_block  0.0623469352722168
generate_one_block  0.06378364562988281
generate_one_block  0.06616377830505371
generate_one_block  0.0625758171081543
generate_one_block  0.062001943588256836
generate_one_block  0.06282424926757812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03946995735168457
gen group dst list time:  0.016442060470581055
time for parepare:  0.019861698150634766
local_output_nid generation:  0.01470947265625
local_in_edges_tensor generation:  0.03454995155334473
mini_batch_src_global generation:  0.03290867805480957
r_  generation:  0.3123190402984619
local_output_nid generation:  0.022754669189453125
local_in_edges_tensor generation:  0.031377315521240234
mini_batch_src_global generation:  0.03865957260131836
r_  generation:  0.32041406631469727
local_output_nid generation:  0.023216962814331055
local_in_edges_tensor generation:  0.02955150604248047
mini_batch_src_global generation:  0.03853464126586914
r_  generation:  0.33021092414855957
local_output_nid generation:  0.02332139015197754
local_in_edges_tensor generation:  0.027770280838012695
mini_batch_src_global generation:  0.04242873191833496
r_  generation:  0.33878135681152344
local_output_nid generation:  0.0229494571685791
local_in_edges_tensor generation:  0.020074129104614258
mini_batch_src_global generation:  0.04104018211364746
r_  generation:  0.33595728874206543
local_output_nid generation:  0.023540973663330078
local_in_edges_tensor generation:  0.02362799644470215
mini_batch_src_global generation:  0.04170513153076172
r_  generation:  0.34177136421203613
local_output_nid generation:  0.02319049835205078
local_in_edges_tensor generation:  0.02348947525024414
mini_batch_src_global generation:  0.04114127159118652
r_  generation:  0.3364443778991699
local_output_nid generation:  0.023192644119262695
local_in_edges_tensor generation:  0.02049398422241211
mini_batch_src_global generation:  0.04396343231201172
r_  generation:  0.34452104568481445
----------------------check_connections_block total spend ----------------------------- 3.9598517417907715
generate_one_block  0.4343888759613037
generate_one_block  0.4295063018798828
generate_one_block  0.44121623039245605
generate_one_block  0.4494059085845947
generate_one_block  0.43660640716552734
generate_one_block  0.46292924880981445
generate_one_block  0.4388303756713867
generate_one_block  0.4471700191497803
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03316450119018555
gen group dst list time:  0.03649306297302246
time for parepare:  0.019496917724609375
local_output_nid generation:  0.029338598251342773
local_in_edges_tensor generation:  0.04278421401977539
mini_batch_src_global generation:  0.0451207160949707
r_  generation:  0.475311279296875
local_output_nid generation:  0.03890109062194824
local_in_edges_tensor generation:  0.05164289474487305
mini_batch_src_global generation:  0.05404925346374512
r_  generation:  0.47220659255981445
local_output_nid generation:  0.04215645790100098
local_in_edges_tensor generation:  0.04426145553588867
mini_batch_src_global generation:  0.05080986022949219
r_  generation:  0.49206995964050293
local_output_nid generation:  0.03910636901855469
local_in_edges_tensor generation:  0.04402351379394531
mini_batch_src_global generation:  0.053877830505371094
r_  generation:  0.48347997665405273
local_output_nid generation:  0.03925204277038574
local_in_edges_tensor generation:  0.03470110893249512
mini_batch_src_global generation:  0.05308341979980469
r_  generation:  0.5007102489471436
local_output_nid generation:  0.03644561767578125
local_in_edges_tensor generation:  0.05029606819152832
mini_batch_src_global generation:  0.060071468353271484
r_  generation:  0.4918859004974365
local_output_nid generation:  0.03564953804016113
local_in_edges_tensor generation:  0.04812955856323242
mini_batch_src_global generation:  0.05399036407470703
r_  generation:  0.5004780292510986
local_output_nid generation:  0.03578972816467285
local_in_edges_tensor generation:  0.04476189613342285
mini_batch_src_global generation:  0.06374430656433105
r_  generation:  0.4843313694000244
----------------------check_connections_block total spend ----------------------------- 5.887780427932739
generate_one_block  0.6242613792419434
generate_one_block  0.6185142993927002
generate_one_block  0.6226658821105957
generate_one_block  0.6333482265472412
generate_one_block  0.6108143329620361
generate_one_block  0.62099289894104
generate_one_block  0.6676502227783203
generate_one_block  0.6277110576629639
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  9.84763216972351
block generation total time  8.566011667251587
average batch blocks generation time:  1.0707514584064484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09764575958251953  GigaBytes
Max Memory Allocated: 0.09764575958251953  GigaBytes

torch.Size([161150, 128])
torch.Size([143240, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.5625710487365723  GigaBytes
Max Memory Allocated: 0.593299388885498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.09918832778930664  GigaBytes
Max Memory Allocated: 0.6323065757751465  GigaBytes

torch.Size([160674, 128])
torch.Size([142197, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.5626559257507324  GigaBytes
Max Memory Allocated: 0.6323065757751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.10045671463012695  GigaBytes
Max Memory Allocated: 0.6323065757751465  GigaBytes

torch.Size([160948, 128])
torch.Size([143045, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.5631365776062012  GigaBytes
Max Memory Allocated: 0.6323065757751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.0997171401977539  GigaBytes
Max Memory Allocated: 0.6332383155822754  GigaBytes

torch.Size([160851, 128])
torch.Size([143200, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.5643372535705566  GigaBytes
Max Memory Allocated: 0.6332383155822754  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.09948587417602539  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

torch.Size([160837, 128])
torch.Size([142674, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.5628633499145508  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.10041618347167969  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

torch.Size([160889, 128])
torch.Size([143100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 0.5632429122924805  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09967613220214844  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

torch.Size([161038, 128])
torch.Size([143289, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.563051700592041  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.10048151016235352  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

torch.Size([161094, 128])
torch.Size([143460, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.5645585060119629  GigaBytes
Max Memory Allocated: 0.6338529586791992  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04808351397514343 |0.05330565571784973 |0.09214985370635986 |9.879469871520996e-05 |0.010490894317626953 |0.0026917457580566406 |
----------------------------------------------------------pseudo_mini_loss sum 5.580994606018066
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021009
Number of first layer input nodes during this epoch:  1287481
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.13122797012329102  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.031087636947631836
random selection method range initialization spend 0.004885196685791016
time for parepare:  0.01754307746887207
local_output_nid generation:  0.0043146610260009766
local_in_edges_tensor generation:  0.009387969970703125
mini_batch_src_global generation:  0.0038022994995117188
r_  generation:  0.04036235809326172
local_output_nid generation:  0.005896091461181641
local_in_edges_tensor generation:  0.0031821727752685547
mini_batch_src_global generation:  0.004796266555786133
r_  generation:  0.043639421463012695
local_output_nid generation:  0.006025552749633789
local_in_edges_tensor generation:  0.0032913684844970703
mini_batch_src_global generation:  0.003358125686645508
r_  generation:  0.04304838180541992
local_output_nid generation:  0.006064414978027344
local_in_edges_tensor generation:  0.0032444000244140625
mini_batch_src_global generation:  0.0035288333892822266
r_  generation:  0.04610586166381836
local_output_nid generation:  0.006029605865478516
local_in_edges_tensor generation:  0.003323078155517578
mini_batch_src_global generation:  0.003682374954223633
r_  generation:  0.045624732971191406
local_output_nid generation:  0.0060498714447021484
local_in_edges_tensor generation:  0.0033545494079589844
mini_batch_src_global generation:  0.003917694091796875
r_  generation:  0.04616189002990723
local_output_nid generation:  0.0060482025146484375
local_in_edges_tensor generation:  0.003136157989501953
mini_batch_src_global generation:  0.003999233245849609
r_  generation:  0.04804039001464844
local_output_nid generation:  0.006083250045776367
local_in_edges_tensor generation:  0.0033180713653564453
mini_batch_src_global generation:  0.004187583923339844
r_  generation:  0.04689598083496094
----------------------check_connections_block total spend ----------------------------- 0.5742030143737793
generate_one_block  0.06310677528381348
generate_one_block  0.06162905693054199
generate_one_block  0.060396671295166016
generate_one_block  0.06296634674072266
generate_one_block  0.06136131286621094
generate_one_block  0.06097579002380371
generate_one_block  0.0668020248413086
generate_one_block  0.06250214576721191
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03590893745422363
gen group dst list time:  0.016333818435668945
time for parepare:  0.018892765045166016
local_output_nid generation:  0.014268875122070312
local_in_edges_tensor generation:  0.03573727607727051
mini_batch_src_global generation:  0.033173322677612305
r_  generation:  0.3150057792663574
local_output_nid generation:  0.020045042037963867
local_in_edges_tensor generation:  0.03149914741516113
mini_batch_src_global generation:  0.042980194091796875
r_  generation:  0.32535529136657715
local_output_nid generation:  0.01921367645263672
local_in_edges_tensor generation:  0.02037787437438965
mini_batch_src_global generation:  0.039229631423950195
r_  generation:  0.3287637233734131
local_output_nid generation:  0.019457340240478516
local_in_edges_tensor generation:  0.02574753761291504
mini_batch_src_global generation:  0.03998708724975586
r_  generation:  0.340557336807251
local_output_nid generation:  0.019037961959838867
local_in_edges_tensor generation:  0.023152828216552734
mini_batch_src_global generation:  0.04354500770568848
r_  generation:  0.3369433879852295
local_output_nid generation:  0.019193649291992188
local_in_edges_tensor generation:  0.0227663516998291
mini_batch_src_global generation:  0.044649600982666016
r_  generation:  0.33069849014282227
local_output_nid generation:  0.019518613815307617
local_in_edges_tensor generation:  0.026146650314331055
mini_batch_src_global generation:  0.046076059341430664
r_  generation:  0.3494417667388916
local_output_nid generation:  0.020135879516601562
local_in_edges_tensor generation:  0.028062105178833008
mini_batch_src_global generation:  0.04268813133239746
r_  generation:  0.34012794494628906
----------------------check_connections_block total spend ----------------------------- 3.9586901664733887
generate_one_block  0.4329071044921875
generate_one_block  0.44275927543640137
generate_one_block  0.45798206329345703
generate_one_block  0.44333410263061523
generate_one_block  0.427509069442749
generate_one_block  0.4299159049987793
generate_one_block  0.45263075828552246
generate_one_block  0.46326732635498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04728341102600098
gen group dst list time:  0.03675484657287598
time for parepare:  0.019602298736572266
local_output_nid generation:  0.027615785598754883
local_in_edges_tensor generation:  0.0664217472076416
mini_batch_src_global generation:  0.04768824577331543
r_  generation:  0.47657084465026855
local_output_nid generation:  0.03422093391418457
local_in_edges_tensor generation:  0.04699969291687012
mini_batch_src_global generation:  0.05368947982788086
r_  generation:  0.4782838821411133
local_output_nid generation:  0.03444099426269531
local_in_edges_tensor generation:  0.04120016098022461
mini_batch_src_global generation:  0.051767587661743164
r_  generation:  0.4876101016998291
local_output_nid generation:  0.03453803062438965
local_in_edges_tensor generation:  0.03622150421142578
mini_batch_src_global generation:  0.05420517921447754
r_  generation:  0.4821813106536865
local_output_nid generation:  0.0341036319732666
local_in_edges_tensor generation:  0.03510856628417969
mini_batch_src_global generation:  0.05322670936584473
r_  generation:  0.49073100090026855
local_output_nid generation:  0.03430676460266113
local_in_edges_tensor generation:  0.03204607963562012
mini_batch_src_global generation:  0.0548396110534668
r_  generation:  0.48261499404907227
local_output_nid generation:  0.03442049026489258
local_in_edges_tensor generation:  0.03551530838012695
mini_batch_src_global generation:  0.05375838279724121
r_  generation:  0.49471616744995117
local_output_nid generation:  0.03488755226135254
local_in_edges_tensor generation:  0.0352933406829834
mini_batch_src_global generation:  0.055211782455444336
r_  generation:  0.48387765884399414
----------------------check_connections_block total spend ----------------------------- 5.77608323097229
generate_one_block  0.6250607967376709
generate_one_block  0.6114368438720703
generate_one_block  0.6159367561340332
generate_one_block  0.6174514293670654
generate_one_block  0.6041669845581055
generate_one_block  0.6049973964691162
generate_one_block  0.6274497509002686
generate_one_block  0.6007692813873291
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.13122797012329102  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

connection checking time:  9.734773397445679
block generation total time  8.457574844360352
average batch blocks generation time:  1.057196855545044
block dataloader generation time/epoch 20.319334506988525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10028791427612305  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([160921, 128])
torch.Size([142788, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5635061264038086  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10079383850097656  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([160611, 128])
torch.Size([142644, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5629982948303223  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10039091110229492  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([161001, 128])
torch.Size([143119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5635042190551758  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10097551345825195  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([160908, 128])
torch.Size([142690, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5640082359313965  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10007524490356445  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([160858, 128])
torch.Size([142664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5634298324584961  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10081052780151367  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([161077, 128])
torch.Size([142892, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5629525184631348  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10069561004638672  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([160919, 128])
torch.Size([143157, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5644569396972656  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10025835037231445  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

torch.Size([160958, 128])
torch.Size([142918, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5632896423339844  GigaBytes
Max Memory Allocated: 0.6347355842590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04820907115936279 |0.01829218864440918 |0.0038885772228240967 |0.00010094046592712402 |0.0032944083213806152 |0.0012936592102050781 |
----------------------------------------------------------pseudo_mini_loss sum 3.5703213214874268
Total (block generation + training)time/epoch 20.948358297348022
Training time/epoch 0.6287567615509033
Training time without block to device /epoch 0.4824192523956299
Training time without total dataloading part /epoch 0.059565067291259766
load block tensor time/epoch 0.38567256927490234
block to device time/epoch 0.14633750915527344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019263
Number of first layer input nodes during this epoch:  1287253
