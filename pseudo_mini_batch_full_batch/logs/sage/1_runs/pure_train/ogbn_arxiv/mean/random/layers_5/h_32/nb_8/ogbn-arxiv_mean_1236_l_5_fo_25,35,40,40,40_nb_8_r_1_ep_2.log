Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648490748.0293977
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.023159503936767578
random selection method range initialization spend 0.006165504455566406
time for parepare:  0.018811464309692383
local_output_nid generation:  0.004207611083984375
local_in_edges_tensor generation:  0.005269527435302734
mini_batch_src_global generation:  0.0033004283905029297
r_  generation:  0.03872990608215332
local_output_nid generation:  0.00598597526550293
local_in_edges_tensor generation:  0.003120899200439453
mini_batch_src_global generation:  0.004222869873046875
r_  generation:  0.038934946060180664
local_output_nid generation:  0.006032466888427734
local_in_edges_tensor generation:  0.0031671524047851562
mini_batch_src_global generation:  0.0028066635131835938
r_  generation:  0.03992938995361328
local_output_nid generation:  0.006079912185668945
local_in_edges_tensor generation:  0.0032041072845458984
mini_batch_src_global generation:  0.002924680709838867
r_  generation:  0.04061603546142578
local_output_nid generation:  0.006067514419555664
local_in_edges_tensor generation:  0.003259420394897461
mini_batch_src_global generation:  0.0030395984649658203
r_  generation:  0.040158748626708984
local_output_nid generation:  0.0060384273529052734
local_in_edges_tensor generation:  0.0031774044036865234
mini_batch_src_global generation:  0.003267526626586914
r_  generation:  0.041605234146118164
local_output_nid generation:  0.006028175354003906
local_in_edges_tensor generation:  0.0031244754791259766
mini_batch_src_global generation:  0.003432035446166992
r_  generation:  0.04307293891906738
local_output_nid generation:  0.0061223506927490234
local_in_edges_tensor generation:  0.0031838417053222656
mini_batch_src_global generation:  0.0034437179565429688
r_  generation:  0.04234123229980469
----------------------check_connections_block total spend ----------------------------- 0.5229315757751465
generate_one_block  0.05436348915100098
generate_one_block  0.055196523666381836
generate_one_block  0.05513787269592285
generate_one_block  0.05449366569519043
generate_one_block  0.05744433403015137
generate_one_block  0.05496716499328613
generate_one_block  0.05524015426635742
generate_one_block  0.05487394332885742
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04035592079162598
gen group dst list time:  0.015347719192504883
time for parepare:  0.018965482711791992
local_output_nid generation:  0.013461112976074219
local_in_edges_tensor generation:  0.03219962120056152
mini_batch_src_global generation:  0.030478954315185547
r_  generation:  0.3015758991241455
local_output_nid generation:  0.018544673919677734
local_in_edges_tensor generation:  0.029493331909179688
mini_batch_src_global generation:  0.03688311576843262
r_  generation:  0.3060734272003174
local_output_nid generation:  0.018139123916625977
local_in_edges_tensor generation:  0.02368760108947754
mini_batch_src_global generation:  0.03625607490539551
r_  generation:  0.3106575012207031
local_output_nid generation:  0.018131494522094727
local_in_edges_tensor generation:  0.021060466766357422
mini_batch_src_global generation:  0.03662443161010742
r_  generation:  0.3080158233642578
local_output_nid generation:  0.018141508102416992
local_in_edges_tensor generation:  0.02120685577392578
mini_batch_src_global generation:  0.037908315658569336
r_  generation:  0.3160066604614258
local_output_nid generation:  0.01818990707397461
local_in_edges_tensor generation:  0.026437759399414062
mini_batch_src_global generation:  0.040050506591796875
r_  generation:  0.3151364326477051
local_output_nid generation:  0.01807379722595215
local_in_edges_tensor generation:  0.018582820892333984
mini_batch_src_global generation:  0.04461550712585449
r_  generation:  0.3252701759338379
local_output_nid generation:  0.018183231353759766
local_in_edges_tensor generation:  0.018780946731567383
mini_batch_src_global generation:  0.042383670806884766
r_  generation:  0.32097291946411133
----------------------check_connections_block total spend ----------------------------- 3.690765142440796
generate_one_block  0.41032862663269043
generate_one_block  0.4027693271636963
generate_one_block  0.4054129123687744
generate_one_block  0.3979020118713379
generate_one_block  0.40311312675476074
generate_one_block  0.4165818691253662
generate_one_block  0.4131650924682617
generate_one_block  0.4031956195831299
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03651785850524902
gen group dst list time:  0.03582048416137695
time for parepare:  0.018754959106445312
local_output_nid generation:  0.028201580047607422
local_in_edges_tensor generation:  0.04470396041870117
mini_batch_src_global generation:  0.05009794235229492
r_  generation:  0.5226092338562012
local_output_nid generation:  0.03413844108581543
local_in_edges_tensor generation:  0.052903175354003906
mini_batch_src_global generation:  0.06269454956054688
r_  generation:  0.5283939838409424
local_output_nid generation:  0.035735368728637695
local_in_edges_tensor generation:  0.03948616981506348
mini_batch_src_global generation:  0.058240652084350586
r_  generation:  0.5347213745117188
local_output_nid generation:  0.034566640853881836
local_in_edges_tensor generation:  0.03857588768005371
mini_batch_src_global generation:  0.060182809829711914
r_  generation:  0.5374817848205566
local_output_nid generation:  0.03533220291137695
local_in_edges_tensor generation:  0.06225180625915527
mini_batch_src_global generation:  0.06635046005249023
r_  generation:  0.5883853435516357
local_output_nid generation:  0.03806185722351074
local_in_edges_tensor generation:  0.046004295349121094
mini_batch_src_global generation:  0.0722813606262207
r_  generation:  0.5550429821014404
local_output_nid generation:  0.037216901779174805
local_in_edges_tensor generation:  0.034768104553222656
mini_batch_src_global generation:  0.061069488525390625
r_  generation:  0.5781083106994629
local_output_nid generation:  0.04047560691833496
local_in_edges_tensor generation:  0.052459716796875
mini_batch_src_global generation:  0.0690457820892334
r_  generation:  0.5591905117034912
----------------------check_connections_block total spend ----------------------------- 6.520522117614746
generate_one_block  0.7171492576599121
generate_one_block  0.6924054622650146
generate_one_block  0.6868205070495605
generate_one_block  0.7074716091156006
generate_one_block  0.6880021095275879
generate_one_block  0.6999666690826416
generate_one_block  0.7034134864807129
generate_one_block  0.6828408241271973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05379962921142578
gen group dst list time:  0.05669689178466797
time for parepare:  0.02000737190246582
local_output_nid generation:  0.03488755226135254
local_in_edges_tensor generation:  0.07043337821960449
mini_batch_src_global generation:  0.05005812644958496
r_  generation:  0.5565941333770752
local_output_nid generation:  0.04071235656738281
local_in_edges_tensor generation:  0.06579017639160156
mini_batch_src_global generation:  0.06343293190002441
r_  generation:  0.5662295818328857
local_output_nid generation:  0.043234825134277344
local_in_edges_tensor generation:  0.060657501220703125
mini_batch_src_global generation:  0.06499075889587402
r_  generation:  0.5449981689453125
local_output_nid generation:  0.04085803031921387
local_in_edges_tensor generation:  0.04425382614135742
mini_batch_src_global generation:  0.058637380599975586
r_  generation:  0.5511000156402588
local_output_nid generation:  0.04099154472351074
local_in_edges_tensor generation:  0.04336214065551758
mini_batch_src_global generation:  0.06324362754821777
r_  generation:  0.5498137474060059
local_output_nid generation:  0.040708303451538086
local_in_edges_tensor generation:  0.0439755916595459
mini_batch_src_global generation:  0.06345295906066895
r_  generation:  0.5544004440307617
local_output_nid generation:  0.04246687889099121
local_in_edges_tensor generation:  0.04363107681274414
mini_batch_src_global generation:  0.05952262878417969
r_  generation:  0.5701563358306885
local_output_nid generation:  0.04127192497253418
local_in_edges_tensor generation:  0.03907942771911621
mini_batch_src_global generation:  0.05937385559082031
r_  generation:  0.5643255710601807
----------------------check_connections_block total spend ----------------------------- 6.72470760345459
generate_one_block  0.7395639419555664
generate_one_block  0.7019891738891602
generate_one_block  0.6874387264251709
generate_one_block  0.6872177124023438
generate_one_block  0.684819221496582
generate_one_block  0.6954915523529053
generate_one_block  0.7644379138946533
generate_one_block  0.6831610202789307
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04158973693847656
gen group dst list time:  0.05049395561218262
time for parepare:  0.019974231719970703
local_output_nid generation:  0.038710832595825195
local_in_edges_tensor generation:  0.06434392929077148
mini_batch_src_global generation:  0.04552793502807617
r_  generation:  0.508228063583374
local_output_nid generation:  0.04021024703979492
local_in_edges_tensor generation:  0.045064687728881836
mini_batch_src_global generation:  0.05888724327087402
r_  generation:  0.5225832462310791
local_output_nid generation:  0.04254794120788574
local_in_edges_tensor generation:  0.04595637321472168
mini_batch_src_global generation:  0.05761432647705078
r_  generation:  0.5077345371246338
local_output_nid generation:  0.041158437728881836
local_in_edges_tensor generation:  0.04125618934631348
mini_batch_src_global generation:  0.05716753005981445
r_  generation:  0.5071845054626465
local_output_nid generation:  0.04112076759338379
local_in_edges_tensor generation:  0.04136204719543457
mini_batch_src_global generation:  0.05810904502868652
r_  generation:  0.5077433586120605
local_output_nid generation:  0.040929317474365234
local_in_edges_tensor generation:  0.047742366790771484
mini_batch_src_global generation:  0.055787086486816406
r_  generation:  0.510991096496582
local_output_nid generation:  0.04135608673095703
local_in_edges_tensor generation:  0.04333853721618652
mini_batch_src_global generation:  0.056652069091796875
r_  generation:  0.5139517784118652
local_output_nid generation:  0.041710615158081055
local_in_edges_tensor generation:  0.04302191734313965
mini_batch_src_global generation:  0.057044029235839844
r_  generation:  0.5145254135131836
----------------------check_connections_block total spend ----------------------------- 6.220359563827515
generate_one_block  0.6361656188964844
generate_one_block  0.641869068145752
generate_one_block  0.6384220123291016
generate_one_block  0.654604434967041
generate_one_block  0.6454153060913086
generate_one_block  0.6483821868896484
generate_one_block  0.6560022830963135
generate_one_block  0.7305009365081787
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

connection checking time:  23.156354427337646
block generation total time  19.726019620895386
average batch blocks generation time:  2.465752452611923
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12591552734375  GigaBytes
Max Memory Allocated: 0.12591552734375  GigaBytes

torch.Size([166965, 128])
torch.Size([165726, 32])
torch.Size([161284, 32])
torch.Size([142025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.4376516342163086  GigaBytes
Max Memory Allocated: 0.440610408782959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.1271657943725586  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166951, 128])
torch.Size([165789, 32])
torch.Size([161449, 32])
torch.Size([142415, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.43848133087158203  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.12714672088623047  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166916, 128])
torch.Size([165709, 32])
torch.Size([161257, 32])
torch.Size([141631, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.43823862075805664  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.1270427703857422  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166883, 128])
torch.Size([165595, 32])
torch.Size([161214, 32])
torch.Size([141618, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4366950988769531  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.12713956832885742  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166866, 128])
torch.Size([165603, 32])
torch.Size([161310, 32])
torch.Size([141889, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4380612373352051  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.12717294692993164  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166995, 128])
torch.Size([165849, 32])
torch.Size([161549, 32])
torch.Size([142543, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4383964538574219  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.12723207473754883  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166885, 128])
torch.Size([165656, 32])
torch.Size([161258, 32])
torch.Size([141990, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4385218620300293  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.12716388702392578  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166922, 128])
torch.Size([165656, 32])
torch.Size([161233, 32])
torch.Size([142347, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4384951591491699  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05460038781166077 |0.08906298875808716 |0.09713283181190491 |0.00010609626770019531 |0.01883167028427124 |0.006155252456665039 |
----------------------------------------------------------pseudo_mini_loss sum 4.997028350830078
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5630644
Number of first layer input nodes during this epoch:  1335383
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.2252655029296875  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0203092098236084
random selection method range initialization spend 0.005402803421020508
time for parepare:  0.01737523078918457
local_output_nid generation:  0.004748821258544922
local_in_edges_tensor generation:  0.006281375885009766
mini_batch_src_global generation:  0.0033147335052490234
r_  generation:  0.037078857421875
local_output_nid generation:  0.006667137145996094
local_in_edges_tensor generation:  0.0029747486114501953
mini_batch_src_global generation:  0.004204511642456055
r_  generation:  0.03819417953491211
local_output_nid generation:  0.008765935897827148
local_in_edges_tensor generation:  0.003156900405883789
mini_batch_src_global generation:  0.002832174301147461
r_  generation:  0.039897918701171875
local_output_nid generation:  0.007078647613525391
local_in_edges_tensor generation:  0.003091573715209961
mini_batch_src_global generation:  0.0030028820037841797
r_  generation:  0.04326152801513672
local_output_nid generation:  0.007111787796020508
local_in_edges_tensor generation:  0.0031545162200927734
mini_batch_src_global generation:  0.0031311511993408203
r_  generation:  0.041194915771484375
local_output_nid generation:  0.007142305374145508
local_in_edges_tensor generation:  0.003092050552368164
mini_batch_src_global generation:  0.003264904022216797
r_  generation:  0.041837215423583984
local_output_nid generation:  0.007161855697631836
local_in_edges_tensor generation:  0.003096342086791992
mini_batch_src_global generation:  0.0032753944396972656
r_  generation:  0.04301285743713379
local_output_nid generation:  0.007166624069213867
local_in_edges_tensor generation:  0.0030934810638427734
mini_batch_src_global generation:  0.0033648014068603516
r_  generation:  0.04264950752258301
----------------------check_connections_block total spend ----------------------------- 0.5364794731140137
generate_one_block  0.05920767784118652
generate_one_block  0.05375027656555176
generate_one_block  0.054856300354003906
generate_one_block  0.0552678108215332
generate_one_block  0.05443072319030762
generate_one_block  0.055036306381225586
generate_one_block  0.05630016326904297
generate_one_block  0.06155657768249512
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04026675224304199
gen group dst list time:  0.01437067985534668
time for parepare:  0.018824100494384766
local_output_nid generation:  0.01342630386352539
local_in_edges_tensor generation:  0.02719283103942871
mini_batch_src_global generation:  0.03054642677307129
r_  generation:  0.3009059429168701
local_output_nid generation:  0.021132707595825195
local_in_edges_tensor generation:  0.028692245483398438
mini_batch_src_global generation:  0.036621809005737305
r_  generation:  0.3168308734893799
local_output_nid generation:  0.020602703094482422
local_in_edges_tensor generation:  0.03310990333557129
mini_batch_src_global generation:  0.053449392318725586
r_  generation:  0.3281083106994629
local_output_nid generation:  0.02120685577392578
local_in_edges_tensor generation:  0.029082298278808594
mini_batch_src_global generation:  0.03776121139526367
r_  generation:  0.32675790786743164
local_output_nid generation:  0.018773794174194336
local_in_edges_tensor generation:  0.03444409370422363
mini_batch_src_global generation:  0.03793215751647949
r_  generation:  0.33102941513061523
local_output_nid generation:  0.01873636245727539
local_in_edges_tensor generation:  0.023069381713867188
mini_batch_src_global generation:  0.04139137268066406
r_  generation:  0.34409427642822266
local_output_nid generation:  0.021604061126708984
local_in_edges_tensor generation:  0.030116796493530273
mini_batch_src_global generation:  0.04419445991516113
r_  generation:  0.3230409622192383
local_output_nid generation:  0.018926620483398438
local_in_edges_tensor generation:  0.022372722625732422
mini_batch_src_global generation:  0.03862118721008301
r_  generation:  0.3439152240753174
----------------------check_connections_block total spend ----------------------------- 3.8943803310394287
generate_one_block  0.42046260833740234
generate_one_block  0.4131734371185303
generate_one_block  0.422882080078125
generate_one_block  0.42027759552001953
generate_one_block  0.41001439094543457
generate_one_block  0.41100287437438965
generate_one_block  0.44020676612854004
generate_one_block  0.4446134567260742
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.051161766052246094
gen group dst list time:  0.03869795799255371
time for parepare:  0.020343303680419922
local_output_nid generation:  0.029904603958129883
local_in_edges_tensor generation:  0.059832096099853516
mini_batch_src_global generation:  0.06142401695251465
r_  generation:  0.5508625507354736
local_output_nid generation:  0.03960466384887695
local_in_edges_tensor generation:  0.06173086166381836
mini_batch_src_global generation:  0.079986572265625
r_  generation:  0.5325217247009277
local_output_nid generation:  0.03646421432495117
local_in_edges_tensor generation:  0.048048973083496094
mini_batch_src_global generation:  0.05567479133605957
r_  generation:  0.5432343482971191
local_output_nid generation:  0.036713361740112305
local_in_edges_tensor generation:  0.04578113555908203
mini_batch_src_global generation:  0.06004977226257324
r_  generation:  0.5505859851837158
local_output_nid generation:  0.03666257858276367
local_in_edges_tensor generation:  0.045221567153930664
mini_batch_src_global generation:  0.05821967124938965
r_  generation:  0.5563223361968994
local_output_nid generation:  0.03670501708984375
local_in_edges_tensor generation:  0.040599822998046875
mini_batch_src_global generation:  0.06248116493225098
r_  generation:  0.5437362194061279
local_output_nid generation:  0.03943753242492676
local_in_edges_tensor generation:  0.03985309600830078
mini_batch_src_global generation:  0.05943012237548828
r_  generation:  0.5634336471557617
local_output_nid generation:  0.036659955978393555
local_in_edges_tensor generation:  0.03643631935119629
mini_batch_src_global generation:  0.06104326248168945
r_  generation:  0.5629453659057617
----------------------check_connections_block total spend ----------------------------- 6.533074855804443
generate_one_block  0.6978955268859863
generate_one_block  0.6868982315063477
generate_one_block  0.6858866214752197
generate_one_block  0.687467098236084
generate_one_block  0.6913514137268066
generate_one_block  0.6928153038024902
generate_one_block  0.6889443397521973
generate_one_block  0.6727993488311768
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04991459846496582
gen group dst list time:  0.0515592098236084
time for parepare:  0.019011259078979492
local_output_nid generation:  0.03455376625061035
local_in_edges_tensor generation:  0.06716704368591309
mini_batch_src_global generation:  0.04980063438415527
r_  generation:  0.5434343814849854
local_output_nid generation:  0.04259061813354492
local_in_edges_tensor generation:  0.0899496078491211
mini_batch_src_global generation:  0.06228137016296387
r_  generation:  0.5415432453155518
local_output_nid generation:  0.039543867111206055
local_in_edges_tensor generation:  0.04257774353027344
mini_batch_src_global generation:  0.07047915458679199
r_  generation:  0.543889045715332
local_output_nid generation:  0.04004812240600586
local_in_edges_tensor generation:  0.04219818115234375
mini_batch_src_global generation:  0.05860185623168945
r_  generation:  0.5528018474578857
local_output_nid generation:  0.03974437713623047
local_in_edges_tensor generation:  0.050766706466674805
mini_batch_src_global generation:  0.05896592140197754
r_  generation:  0.554863691329956
local_output_nid generation:  0.04069018363952637
local_in_edges_tensor generation:  0.04879283905029297
mini_batch_src_global generation:  0.059502601623535156
r_  generation:  0.5629713535308838
local_output_nid generation:  0.03991818428039551
local_in_edges_tensor generation:  0.04236912727355957
mini_batch_src_global generation:  0.05879521369934082
r_  generation:  0.5665936470031738
local_output_nid generation:  0.03985857963562012
local_in_edges_tensor generation:  0.05048418045043945
mini_batch_src_global generation:  0.05873990058898926
r_  generation:  0.5754449367523193
----------------------check_connections_block total spend ----------------------------- 6.7149882316589355
generate_one_block  0.6885011196136475
generate_one_block  0.6905624866485596
generate_one_block  0.6845664978027344
generate_one_block  0.685560941696167
generate_one_block  0.6946773529052734
generate_one_block  0.7099237442016602
generate_one_block  0.6924858093261719
generate_one_block  0.6856248378753662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05095219612121582
gen group dst list time:  0.05515241622924805
time for parepare:  0.018993139266967773
local_output_nid generation:  0.035271406173706055
local_in_edges_tensor generation:  0.051943302154541016
mini_batch_src_global generation:  0.046927452087402344
r_  generation:  0.5078442096710205
local_output_nid generation:  0.04053497314453125
local_in_edges_tensor generation:  0.03658699989318848
mini_batch_src_global generation:  0.058246612548828125
r_  generation:  0.5119509696960449
local_output_nid generation:  0.04103732109069824
local_in_edges_tensor generation:  0.037126779556274414
mini_batch_src_global generation:  0.058771610260009766
r_  generation:  0.5146796703338623
local_output_nid generation:  0.04066133499145508
local_in_edges_tensor generation:  0.03705453872680664
mini_batch_src_global generation:  0.05843353271484375
r_  generation:  0.5151026248931885
local_output_nid generation:  0.040837764739990234
local_in_edges_tensor generation:  0.03777623176574707
mini_batch_src_global generation:  0.05900716781616211
r_  generation:  0.5125775337219238
local_output_nid generation:  0.04073452949523926
local_in_edges_tensor generation:  0.07841253280639648
mini_batch_src_global generation:  0.05771517753601074
r_  generation:  0.516364574432373
local_output_nid generation:  0.040747880935668945
local_in_edges_tensor generation:  0.03989362716674805
mini_batch_src_global generation:  0.05779623985290527
r_  generation:  0.521108865737915
local_output_nid generation:  0.04505157470703125
local_in_edges_tensor generation:  0.041208505630493164
mini_batch_src_global generation:  0.05736851692199707
r_  generation:  0.5218961238861084
----------------------check_connections_block total spend ----------------------------- 6.237311601638794
generate_one_block  0.633657693862915
generate_one_block  0.6403746604919434
generate_one_block  0.6355564594268799
generate_one_block  0.6376621723175049
generate_one_block  0.6396539211273193
generate_one_block  0.6380515098571777
generate_one_block  0.6506941318511963
generate_one_block  0.6482694149017334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.2252655029296875  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

connection checking time:  23.3797550201416
block generation total time  19.542513847351074
average batch blocks generation time:  2.4428142309188843
block dataloader generation time/epoch 45.50873064994812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12726497650146484  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166977, 128])
torch.Size([165803, 32])
torch.Size([161458, 32])
torch.Size([142001, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43833208084106445  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12719106674194336  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166955, 128])
torch.Size([165742, 32])
torch.Size([161350, 32])
torch.Size([142094, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4382176399230957  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12729263305664062  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166942, 128])
torch.Size([165719, 32])
torch.Size([161420, 32])
torch.Size([142074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4385218620300293  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12738895416259766  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166861, 128])
torch.Size([165648, 32])
torch.Size([161278, 32])
torch.Size([142074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4387502670288086  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12731361389160156  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([167003, 128])
torch.Size([165845, 32])
torch.Size([161554, 32])
torch.Size([142235, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.438413143157959  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12730789184570312  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([167035, 128])
torch.Size([165880, 32])
torch.Size([161693, 32])
torch.Size([142282, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43851184844970703  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12725830078125  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166964, 128])
torch.Size([165806, 32])
torch.Size([161487, 32])
torch.Size([142031, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4383230209350586  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12726593017578125  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

torch.Size([166855, 128])
torch.Size([165639, 32])
torch.Size([161119, 32])
torch.Size([141895, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4384799003601074  GigaBytes
Max Memory Allocated: 0.45234251022338867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05222705006599426 |0.034331321716308594 |0.005718201398849487 |9.590387344360352e-05 |0.012732446193695068 |0.004801034927368164 |
----------------------------------------------------------pseudo_mini_loss sum 4.308712005615234
Total (block generation + training)time/epoch 46.39874196052551
Training time/epoch 0.8897991180419922
Training time without block to device /epoch 0.6151485443115234
Training time without total dataloading part /epoch 0.15317344665527344
load block tensor time/epoch 0.4178164005279541
block to device time/epoch 0.27465057373046875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5632502
Number of first layer input nodes during this epoch:  1335592
