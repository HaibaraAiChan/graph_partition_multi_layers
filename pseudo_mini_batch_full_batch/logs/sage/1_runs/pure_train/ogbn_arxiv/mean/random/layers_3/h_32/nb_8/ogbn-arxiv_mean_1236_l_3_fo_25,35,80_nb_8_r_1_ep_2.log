Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648437886.8133147
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026738405227661133
random selection method range initialization spend 0.006278276443481445
time for parepare:  0.019023656845092773
local_output_nid generation:  0.004238128662109375
local_in_edges_tensor generation:  0.005357265472412109
mini_batch_src_global generation:  0.003820657730102539
r_  generation:  0.04229569435119629
local_output_nid generation:  0.0059795379638671875
local_in_edges_tensor generation:  0.003215312957763672
mini_batch_src_global generation:  0.004852294921875
r_  generation:  0.04598522186279297
local_output_nid generation:  0.006161928176879883
local_in_edges_tensor generation:  0.0032875537872314453
mini_batch_src_global generation:  0.003453493118286133
r_  generation:  0.04651761054992676
local_output_nid generation:  0.006188869476318359
local_in_edges_tensor generation:  0.003370046615600586
mini_batch_src_global generation:  0.0035605430603027344
r_  generation:  0.04692959785461426
local_output_nid generation:  0.006228208541870117
local_in_edges_tensor generation:  0.0033617019653320312
mini_batch_src_global generation:  0.0037670135498046875
r_  generation:  0.04805254936218262
local_output_nid generation:  0.0062255859375
local_in_edges_tensor generation:  0.003372669219970703
mini_batch_src_global generation:  0.00404810905456543
r_  generation:  0.04824352264404297
local_output_nid generation:  0.0061779022216796875
local_in_edges_tensor generation:  0.0033800601959228516
mini_batch_src_global generation:  0.003959178924560547
r_  generation:  0.04707169532775879
local_output_nid generation:  0.0061566829681396484
local_in_edges_tensor generation:  0.003317117691040039
mini_batch_src_global generation:  0.004052162170410156
r_  generation:  0.04745125770568848
----------------------check_connections_block total spend ----------------------------- 0.5872228145599365
generate_one_block  0.06195664405822754
generate_one_block  0.0637822151184082
generate_one_block  0.0637962818145752
generate_one_block  0.06219124794006348
generate_one_block  0.06686162948608398
generate_one_block  0.06277060508728027
generate_one_block  0.0620119571685791
generate_one_block  0.06088542938232422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03813648223876953
gen group dst list time:  0.016669034957885742
time for parepare:  0.019176959991455078
local_output_nid generation:  0.014540910720825195
local_in_edges_tensor generation:  0.033454179763793945
mini_batch_src_global generation:  0.030666112899780273
r_  generation:  0.3157532215118408
local_output_nid generation:  0.020127534866333008
local_in_edges_tensor generation:  0.032804012298583984
mini_batch_src_global generation:  0.041892051696777344
r_  generation:  0.3398566246032715
local_output_nid generation:  0.019690990447998047
local_in_edges_tensor generation:  0.029862165451049805
mini_batch_src_global generation:  0.03839707374572754
r_  generation:  0.3445014953613281
local_output_nid generation:  0.019493818283081055
local_in_edges_tensor generation:  0.023012399673461914
mini_batch_src_global generation:  0.03979754447937012
r_  generation:  0.3402223587036133
local_output_nid generation:  0.01970219612121582
local_in_edges_tensor generation:  0.02674579620361328
mini_batch_src_global generation:  0.040369272232055664
r_  generation:  0.36320066452026367
local_output_nid generation:  0.024115562438964844
local_in_edges_tensor generation:  0.03486895561218262
mini_batch_src_global generation:  0.04714393615722656
r_  generation:  0.3469231128692627
local_output_nid generation:  0.020058870315551758
local_in_edges_tensor generation:  0.022983074188232422
mini_batch_src_global generation:  0.04056859016418457
r_  generation:  0.3364980220794678
local_output_nid generation:  0.019960403442382812
local_in_edges_tensor generation:  0.024211883544921875
mini_batch_src_global generation:  0.040483951568603516
r_  generation:  0.3306148052215576
----------------------check_connections_block total spend ----------------------------- 4.026581048965454
generate_one_block  0.43741273880004883
generate_one_block  0.4568674564361572
generate_one_block  0.4505469799041748
generate_one_block  0.4593815803527832
generate_one_block  0.5024917125701904
generate_one_block  0.4675419330596924
generate_one_block  0.4534153938293457
generate_one_block  0.44446706771850586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05541372299194336
gen group dst list time:  0.041268110275268555
time for parepare:  0.02376413345336914
local_output_nid generation:  0.028837919235229492
local_in_edges_tensor generation:  0.06836915016174316
mini_batch_src_global generation:  0.04990434646606445
r_  generation:  0.48975586891174316
local_output_nid generation:  0.03726077079772949
local_in_edges_tensor generation:  0.05301213264465332
mini_batch_src_global generation:  0.05699467658996582
r_  generation:  0.4789149761199951
local_output_nid generation:  0.03556418418884277
local_in_edges_tensor generation:  0.04667305946350098
mini_batch_src_global generation:  0.05054283142089844
r_  generation:  0.49051952362060547
local_output_nid generation:  0.03546714782714844
local_in_edges_tensor generation:  0.03980112075805664
mini_batch_src_global generation:  0.053986310958862305
r_  generation:  0.4951934814453125
local_output_nid generation:  0.03548598289489746
local_in_edges_tensor generation:  0.04646420478820801
mini_batch_src_global generation:  0.05284309387207031
r_  generation:  0.4996609687805176
local_output_nid generation:  0.03691554069519043
local_in_edges_tensor generation:  0.04108238220214844
mini_batch_src_global generation:  0.05516481399536133
r_  generation:  0.508141279220581
local_output_nid generation:  0.03802895545959473
local_in_edges_tensor generation:  0.04674863815307617
mini_batch_src_global generation:  0.06256842613220215
r_  generation:  0.49298882484436035
local_output_nid generation:  0.03544807434082031
local_in_edges_tensor generation:  0.03983283042907715
mini_batch_src_global generation:  0.05459284782409668
r_  generation:  0.4927256107330322
----------------------check_connections_block total spend ----------------------------- 5.971077919006348
generate_one_block  0.6110846996307373
generate_one_block  0.6296727657318115
generate_one_block  0.609673261642456
generate_one_block  0.6301805973052979
generate_one_block  0.6228752136230469
generate_one_block  0.6165850162506104
generate_one_block  0.6417801380157471
generate_one_block  0.6021392345428467
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  9.997658967971802
block generation total time  8.636115789413452
average batch blocks generation time:  1.0795144736766815
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09718656539916992  GigaBytes
Max Memory Allocated: 0.09718656539916992  GigaBytes

torch.Size([160659, 128])
torch.Size([142261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.2185802459716797  GigaBytes
Max Memory Allocated: 0.22051668167114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.09973001480102539  GigaBytes
Max Memory Allocated: 0.23347091674804688  GigaBytes

torch.Size([161163, 128])
torch.Size([143524, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.22015047073364258  GigaBytes
Max Memory Allocated: 0.23347091674804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.09852743148803711  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160772, 128])
torch.Size([142821, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6483154296875 GB
    Memory Allocated: 0.2184286117553711  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09908771514892578  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160951, 128])
torch.Size([143083, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21843576431274414  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09948205947875977  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160836, 128])
torch.Size([142823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21885013580322266  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09992027282714844  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160966, 128])
torch.Size([142964, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2196059226989746  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.0984506607055664  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160835, 128])
torch.Size([143000, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21816492080688477  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09893465042114258  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160902, 128])
torch.Size([142915, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21776342391967773  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038049161434173584 |0.06398782134056091 |0.09815791249275208 |0.00011923909187316895 |0.009133607149124146 |0.0021224021911621094 |
----------------------------------------------------------pseudo_mini_loss sum 5.0124945640563965
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3019394
Number of first layer input nodes during this epoch:  1287084
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1416010856628418  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020737409591674805
random selection method range initialization spend 0.005287647247314453
time for parepare:  0.01902151107788086
local_output_nid generation:  0.004610776901245117
local_in_edges_tensor generation:  0.0063288211822509766
mini_batch_src_global generation:  0.003723621368408203
r_  generation:  0.041190147399902344
local_output_nid generation:  0.0070192813873291016
local_in_edges_tensor generation:  0.00315093994140625
mini_batch_src_global generation:  0.004893779754638672
r_  generation:  0.04456639289855957
local_output_nid generation:  0.0073702335357666016
local_in_edges_tensor generation:  0.003326892852783203
mini_batch_src_global generation:  0.0033304691314697266
r_  generation:  0.04563331604003906
local_output_nid generation:  0.007309675216674805
local_in_edges_tensor generation:  0.0032951831817626953
mini_batch_src_global generation:  0.0035088062286376953
r_  generation:  0.04689359664916992
local_output_nid generation:  0.00746607780456543
local_in_edges_tensor generation:  0.0033042430877685547
mini_batch_src_global generation:  0.003780841827392578
r_  generation:  0.046862125396728516
local_output_nid generation:  0.007456541061401367
local_in_edges_tensor generation:  0.003429889678955078
mini_batch_src_global generation:  0.004073143005371094
r_  generation:  0.04824376106262207
local_output_nid generation:  0.0075261592864990234
local_in_edges_tensor generation:  0.0034902095794677734
mini_batch_src_global generation:  0.004034996032714844
r_  generation:  0.047937870025634766
local_output_nid generation:  0.007454872131347656
local_in_edges_tensor generation:  0.003348827362060547
mini_batch_src_global generation:  0.004053354263305664
r_  generation:  0.047945261001586914
----------------------check_connections_block total spend ----------------------------- 0.5938124656677246
generate_one_block  0.0599207878112793
generate_one_block  0.0627894401550293
generate_one_block  0.06233644485473633
generate_one_block  0.06275200843811035
generate_one_block  0.0632624626159668
generate_one_block  0.06378626823425293
generate_one_block  0.06659460067749023
generate_one_block  0.06274223327636719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03560328483581543
gen group dst list time:  0.016596317291259766
time for parepare:  0.019144773483276367
local_output_nid generation:  0.014429330825805664
local_in_edges_tensor generation:  0.032738447189331055
mini_batch_src_global generation:  0.03209686279296875
r_  generation:  0.30987095832824707
local_output_nid generation:  0.020260095596313477
local_in_edges_tensor generation:  0.031075716018676758
mini_batch_src_global generation:  0.03875398635864258
r_  generation:  0.3304886817932129
local_output_nid generation:  0.019330739974975586
local_in_edges_tensor generation:  0.025669336318969727
mini_batch_src_global generation:  0.03811359405517578
r_  generation:  0.3312702178955078
local_output_nid generation:  0.01944589614868164
local_in_edges_tensor generation:  0.026262283325195312
mini_batch_src_global generation:  0.041802406311035156
r_  generation:  0.33796238899230957
local_output_nid generation:  0.019629716873168945
local_in_edges_tensor generation:  0.02473163604736328
mini_batch_src_global generation:  0.040134429931640625
r_  generation:  0.3394756317138672
local_output_nid generation:  0.019699811935424805
local_in_edges_tensor generation:  0.023265361785888672
mini_batch_src_global generation:  0.041388750076293945
r_  generation:  0.34233522415161133
local_output_nid generation:  0.019484996795654297
local_in_edges_tensor generation:  0.020209550857543945
mini_batch_src_global generation:  0.04234814643859863
r_  generation:  0.3420567512512207
local_output_nid generation:  0.021352291107177734
local_in_edges_tensor generation:  0.020111560821533203
mini_batch_src_global generation:  0.041315555572509766
r_  generation:  0.3460419178009033
----------------------check_connections_block total spend ----------------------------- 3.9431793689727783
generate_one_block  0.43612170219421387
generate_one_block  0.44159698486328125
generate_one_block  0.4561135768890381
generate_one_block  0.43898797035217285
generate_one_block  0.4353501796722412
generate_one_block  0.4477109909057617
generate_one_block  0.44730186462402344
generate_one_block  0.46708035469055176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045461416244506836
gen group dst list time:  0.03743171691894531
time for parepare:  0.019866943359375
local_output_nid generation:  0.02798151969909668
local_in_edges_tensor generation:  0.0663461685180664
mini_batch_src_global generation:  0.045316457748413086
r_  generation:  0.4814455509185791
local_output_nid generation:  0.03717494010925293
local_in_edges_tensor generation:  0.051666259765625
mini_batch_src_global generation:  0.05517983436584473
r_  generation:  0.49590039253234863
local_output_nid generation:  0.03689169883728027
local_in_edges_tensor generation:  0.04966378211975098
mini_batch_src_global generation:  0.05245375633239746
r_  generation:  0.5117793083190918
local_output_nid generation:  0.03597211837768555
local_in_edges_tensor generation:  0.05039787292480469
mini_batch_src_global generation:  0.05818986892700195
r_  generation:  0.4946706295013428
local_output_nid generation:  0.03666973114013672
local_in_edges_tensor generation:  0.03758859634399414
mini_batch_src_global generation:  0.054137468338012695
r_  generation:  0.49925971031188965
local_output_nid generation:  0.03580188751220703
local_in_edges_tensor generation:  0.0440218448638916
mini_batch_src_global generation:  0.05821061134338379
r_  generation:  0.4916496276855469
local_output_nid generation:  0.036406517028808594
local_in_edges_tensor generation:  0.03433704376220703
mini_batch_src_global generation:  0.05410599708557129
r_  generation:  0.5064296722412109
local_output_nid generation:  0.03644084930419922
local_in_edges_tensor generation:  0.038285255432128906
mini_batch_src_global generation:  0.05847668647766113
r_  generation:  0.5029323101043701
----------------------check_connections_block total spend ----------------------------- 5.97623610496521
generate_one_block  0.6179890632629395
generate_one_block  0.6085433959960938
generate_one_block  0.6142771244049072
generate_one_block  0.6288535594940186
generate_one_block  0.6053719520568848
generate_one_block  0.6279234886169434
generate_one_block  0.6259987354278564
generate_one_block  0.6263518333435059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1416010856628418  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

connection checking time:  9.919415473937988
block generation total time  8.525572776794434
average batch blocks generation time:  1.0656965970993042
block dataloader generation time/epoch 20.5631320476532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09956073760986328  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160846, 128])
torch.Size([142836, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21783828735351562  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09917545318603516  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160807, 128])
torch.Size([142707, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21889495849609375  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09988117218017578  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160791, 128])
torch.Size([142632, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21776628494262695  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.0990915298461914  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160727, 128])
torch.Size([142873, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21857213973999023  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09948110580444336  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160815, 128])
torch.Size([142771, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21991872787475586  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09879350662231445  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160938, 128])
torch.Size([142852, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2187666893005371  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09922981262207031  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([161085, 128])
torch.Size([143227, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21957063674926758  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09940814971923828  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

torch.Size([160940, 128])
torch.Size([143171, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.22008275985717773  GigaBytes
Max Memory Allocated: 0.23539352416992188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0395035445690155 |0.015702545642852783 |0.003656059503555298 |0.0001004338264465332 |0.00410693883895874 |0.0013742446899414062 |
----------------------------------------------------------pseudo_mini_loss sum 4.3249711990356445
Total (block generation + training)time/epoch 21.092063665390015
Training time/epoch 0.5286500453948975
Training time without block to device /epoch 0.4030296802520752
Training time without total dataloading part /epoch 0.06428170204162598
load block tensor time/epoch 0.316028356552124
block to device time/epoch 0.12562036514282227
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019038
Number of first layer input nodes during this epoch:  1286949
