Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443931.195954
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026685237884521484
random selection method range initialization spend 0.0062410831451416016
time for parepare:  0.018872499465942383
local_output_nid generation:  0.0041961669921875
local_in_edges_tensor generation:  0.00639033317565918
mini_batch_src_global generation:  0.003920555114746094
r_  generation:  0.042406320571899414
local_output_nid generation:  0.005832195281982422
local_in_edges_tensor generation:  0.0032813549041748047
mini_batch_src_global generation:  0.004986286163330078
r_  generation:  0.04467201232910156
local_output_nid generation:  0.006087541580200195
local_in_edges_tensor generation:  0.003251791000366211
mini_batch_src_global generation:  0.0034554004669189453
r_  generation:  0.044161319732666016
local_output_nid generation:  0.0060634613037109375
local_in_edges_tensor generation:  0.0031960010528564453
mini_batch_src_global generation:  0.003511667251586914
r_  generation:  0.0453341007232666
local_output_nid generation:  0.006051063537597656
local_in_edges_tensor generation:  0.003229856491088867
mini_batch_src_global generation:  0.0038874149322509766
r_  generation:  0.046109914779663086
local_output_nid generation:  0.006086111068725586
local_in_edges_tensor generation:  0.003267526626586914
mini_batch_src_global generation:  0.004071235656738281
r_  generation:  0.04732251167297363
local_output_nid generation:  0.006060123443603516
local_in_edges_tensor generation:  0.0032072067260742188
mini_batch_src_global generation:  0.004061222076416016
r_  generation:  0.04703927040100098
local_output_nid generation:  0.006063938140869141
local_in_edges_tensor generation:  0.003213167190551758
mini_batch_src_global generation:  0.004178285598754883
r_  generation:  0.04746532440185547
----------------------check_connections_block total spend ----------------------------- 0.5773756504058838
generate_one_block  0.06123232841491699
generate_one_block  0.0629878044128418
generate_one_block  0.061573028564453125
generate_one_block  0.060579776763916016
generate_one_block  0.06516003608703613
generate_one_block  0.06179523468017578
generate_one_block  0.06150364875793457
generate_one_block  0.061948537826538086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03801441192626953
gen group dst list time:  0.01664876937866211
time for parepare:  0.01957249641418457
local_output_nid generation:  0.01441335678100586
local_in_edges_tensor generation:  0.033689022064208984
mini_batch_src_global generation:  0.03361368179321289
r_  generation:  0.31719017028808594
local_output_nid generation:  0.022747039794921875
local_in_edges_tensor generation:  0.03297257423400879
mini_batch_src_global generation:  0.03917288780212402
r_  generation:  0.33111047744750977
local_output_nid generation:  0.022130250930786133
local_in_edges_tensor generation:  0.027150630950927734
mini_batch_src_global generation:  0.03844308853149414
r_  generation:  0.32894325256347656
local_output_nid generation:  0.02190852165222168
local_in_edges_tensor generation:  0.02106618881225586
mini_batch_src_global generation:  0.04284787178039551
r_  generation:  0.32781219482421875
local_output_nid generation:  0.022416114807128906
local_in_edges_tensor generation:  0.0270535945892334
mini_batch_src_global generation:  0.04007363319396973
r_  generation:  0.33596301078796387
local_output_nid generation:  0.02238750457763672
local_in_edges_tensor generation:  0.026918888092041016
mini_batch_src_global generation:  0.040884971618652344
r_  generation:  0.34172558784484863
local_output_nid generation:  0.022378206253051758
local_in_edges_tensor generation:  0.023731231689453125
mini_batch_src_global generation:  0.043401479721069336
r_  generation:  0.3368220329284668
local_output_nid generation:  0.02205061912536621
local_in_edges_tensor generation:  0.024869918823242188
mini_batch_src_global generation:  0.04147815704345703
r_  generation:  0.3370852470397949
----------------------check_connections_block total spend ----------------------------- 3.958223819732666
generate_one_block  0.43529629707336426
generate_one_block  0.4473271369934082
generate_one_block  0.4272019863128662
generate_one_block  0.4268229007720947
generate_one_block  0.4377725124359131
generate_one_block  0.44593167304992676
generate_one_block  0.4349372386932373
generate_one_block  0.43014001846313477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03260517120361328
gen group dst list time:  0.0396275520324707
time for parepare:  0.019066333770751953
local_output_nid generation:  0.027970314025878906
local_in_edges_tensor generation:  0.043227195739746094
mini_batch_src_global generation:  0.04360079765319824
r_  generation:  0.47249627113342285
local_output_nid generation:  0.03499341011047363
local_in_edges_tensor generation:  0.051192522048950195
mini_batch_src_global generation:  0.05485200881958008
r_  generation:  0.4771568775177002
local_output_nid generation:  0.03499627113342285
local_in_edges_tensor generation:  0.047144412994384766
mini_batch_src_global generation:  0.05157065391540527
r_  generation:  0.49408650398254395
local_output_nid generation:  0.034845829010009766
local_in_edges_tensor generation:  0.037772178649902344
mini_batch_src_global generation:  0.05706381797790527
r_  generation:  0.49375438690185547
local_output_nid generation:  0.03444242477416992
local_in_edges_tensor generation:  0.03404116630554199
mini_batch_src_global generation:  0.05341291427612305
r_  generation:  0.5016782283782959
local_output_nid generation:  0.035047054290771484
local_in_edges_tensor generation:  0.03847026824951172
mini_batch_src_global generation:  0.0549006462097168
r_  generation:  0.4969749450683594
local_output_nid generation:  0.03465843200683594
local_in_edges_tensor generation:  0.04263949394226074
mini_batch_src_global generation:  0.05401921272277832
r_  generation:  0.5069527626037598
local_output_nid generation:  0.03486967086791992
local_in_edges_tensor generation:  0.03459787368774414
mini_batch_src_global generation:  0.05531477928161621
r_  generation:  0.4944446086883545
----------------------check_connections_block total spend ----------------------------- 5.839962720870972
generate_one_block  0.6087212562561035
generate_one_block  0.6200354099273682
generate_one_block  0.6130518913269043
generate_one_block  0.6140017509460449
generate_one_block  0.6089632511138916
generate_one_block  0.6232151985168457
generate_one_block  0.6442863941192627
generate_one_block  0.6121602058410645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.798186540603638
block generation total time  8.42986512184143
average batch blocks generation time:  1.0537331402301788
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09805011749267578  GigaBytes
Max Memory Allocated: 0.09805011749267578  GigaBytes

torch.Size([160854, 128])
torch.Size([142723, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.9354619979858398  GigaBytes
Max Memory Allocated: 1.0015544891357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 0.10085010528564453  GigaBytes
Max Memory Allocated: 1.0760464668273926  GigaBytes

torch.Size([161158, 128])
torch.Size([143376, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3670654296875 GB
    Memory Allocated: 0.9395136833190918  GigaBytes
Max Memory Allocated: 1.0760464668273926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.10062932968139648  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([160891, 128])
torch.Size([142655, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.9342107772827148  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.10117483139038086  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([161013, 128])
torch.Size([143027, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.9316244125366211  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.1011052131652832  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([160921, 128])
torch.Size([142628, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.9345436096191406  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.10116815567016602  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([161087, 128])
torch.Size([143477, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.9363307952880859  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.10072898864746094  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([160968, 128])
torch.Size([142677, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.9361600875854492  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.10064363479614258  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([160799, 128])
torch.Size([142671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.9345779418945312  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0698523223400116 |0.05240169167518616 |0.09770336747169495 |0.00010028481483459473 |0.015364289283752441 |0.0016868114471435547 |
----------------------------------------------------------pseudo_mini_loss sum 6.235138893127441
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3019954
Number of first layer input nodes during this epoch:  1287691
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.13329124450683594  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027293682098388672
random selection method range initialization spend 0.0052318572998046875
time for parepare:  0.017609834671020508
local_output_nid generation:  0.004430532455444336
local_in_edges_tensor generation:  0.011886119842529297
mini_batch_src_global generation:  0.003948211669921875
r_  generation:  0.041938066482543945
local_output_nid generation:  0.005845069885253906
local_in_edges_tensor generation:  0.0032727718353271484
mini_batch_src_global generation:  0.004789590835571289
r_  generation:  0.04394412040710449
local_output_nid generation:  0.006059408187866211
local_in_edges_tensor generation:  0.0033931732177734375
mini_batch_src_global generation:  0.0033621788024902344
r_  generation:  0.044496774673461914
local_output_nid generation:  0.006100654602050781
local_in_edges_tensor generation:  0.0035440921783447266
mini_batch_src_global generation:  0.003509044647216797
r_  generation:  0.045593976974487305
local_output_nid generation:  0.006093263626098633
local_in_edges_tensor generation:  0.003343343734741211
mini_batch_src_global generation:  0.0037729740142822266
r_  generation:  0.04726123809814453
local_output_nid generation:  0.006132602691650391
local_in_edges_tensor generation:  0.0034656524658203125
mini_batch_src_global generation:  0.003903627395629883
r_  generation:  0.04766964912414551
local_output_nid generation:  0.006134748458862305
local_in_edges_tensor generation:  0.003351449966430664
mini_batch_src_global generation:  0.004122734069824219
r_  generation:  0.04860186576843262
local_output_nid generation:  0.006154537200927734
local_in_edges_tensor generation:  0.0033431053161621094
mini_batch_src_global generation:  0.003886699676513672
r_  generation:  0.04819822311401367
----------------------check_connections_block total spend ----------------------------- 0.5850837230682373
generate_one_block  0.06135416030883789
generate_one_block  0.06270432472229004
generate_one_block  0.0625307559967041
generate_one_block  0.06167483329772949
generate_one_block  0.06299924850463867
generate_one_block  0.06222414970397949
generate_one_block  0.06685209274291992
generate_one_block  0.06234455108642578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03643798828125
gen group dst list time:  0.01671886444091797
time for parepare:  0.01931166648864746
local_output_nid generation:  0.01479482650756836
local_in_edges_tensor generation:  0.03632807731628418
mini_batch_src_global generation:  0.03367924690246582
r_  generation:  0.32292914390563965
local_output_nid generation:  0.023176908493041992
local_in_edges_tensor generation:  0.032645225524902344
mini_batch_src_global generation:  0.04009675979614258
r_  generation:  0.3361036777496338
local_output_nid generation:  0.01951885223388672
local_in_edges_tensor generation:  0.024359941482543945
mini_batch_src_global generation:  0.039277076721191406
r_  generation:  0.3377666473388672
local_output_nid generation:  0.019583463668823242
local_in_edges_tensor generation:  0.026353120803833008
mini_batch_src_global generation:  0.04094076156616211
r_  generation:  0.33815550804138184
local_output_nid generation:  0.019635677337646484
local_in_edges_tensor generation:  0.02315664291381836
mini_batch_src_global generation:  0.04241490364074707
r_  generation:  0.3393847942352295
local_output_nid generation:  0.01941394805908203
local_in_edges_tensor generation:  0.020869016647338867
mini_batch_src_global generation:  0.04288315773010254
r_  generation:  0.3401374816894531
local_output_nid generation:  0.01978135108947754
local_in_edges_tensor generation:  0.026593685150146484
mini_batch_src_global generation:  0.043421268463134766
r_  generation:  0.34792375564575195
local_output_nid generation:  0.019436120986938477
local_in_edges_tensor generation:  0.02118682861328125
mini_batch_src_global generation:  0.04123115539550781
r_  generation:  0.3401496410369873
----------------------check_connections_block total spend ----------------------------- 3.997300148010254
generate_one_block  0.4628129005432129
generate_one_block  0.4476311206817627
generate_one_block  0.46175336837768555
generate_one_block  0.4619908332824707
generate_one_block  0.4595072269439697
generate_one_block  0.4364967346191406
generate_one_block  0.45603370666503906
generate_one_block  0.4768669605255127
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035361528396606445
gen group dst list time:  0.03789639472961426
time for parepare:  0.019173622131347656
local_output_nid generation:  0.028662919998168945
local_in_edges_tensor generation:  0.05671215057373047
mini_batch_src_global generation:  0.048079729080200195
r_  generation:  0.49948668479919434
local_output_nid generation:  0.039092063903808594
local_in_edges_tensor generation:  0.05896735191345215
mini_batch_src_global generation:  0.060796260833740234
r_  generation:  0.4816625118255615
local_output_nid generation:  0.03652215003967285
local_in_edges_tensor generation:  0.04204416275024414
mini_batch_src_global generation:  0.05517768859863281
r_  generation:  0.5033538341522217
local_output_nid generation:  0.036164283752441406
local_in_edges_tensor generation:  0.04002666473388672
mini_batch_src_global generation:  0.05358719825744629
r_  generation:  0.5070645809173584
local_output_nid generation:  0.03622889518737793
local_in_edges_tensor generation:  0.04360795021057129
mini_batch_src_global generation:  0.05263948440551758
r_  generation:  0.5041422843933105
local_output_nid generation:  0.036272525787353516
local_in_edges_tensor generation:  0.03749203681945801
mini_batch_src_global generation:  0.05446267127990723
r_  generation:  0.5014181137084961
local_output_nid generation:  0.03599953651428223
local_in_edges_tensor generation:  0.048072099685668945
mini_batch_src_global generation:  0.05786418914794922
r_  generation:  0.5092980861663818
local_output_nid generation:  0.036147117614746094
local_in_edges_tensor generation:  0.048569679260253906
mini_batch_src_global generation:  0.05499005317687988
r_  generation:  0.5116021633148193
----------------------check_connections_block total spend ----------------------------- 6.037165403366089
generate_one_block  0.6413693428039551
generate_one_block  0.6263229846954346
generate_one_block  0.6175568103790283
generate_one_block  0.6169390678405762
generate_one_block  0.6233031749725342
generate_one_block  0.6292223930358887
generate_one_block  0.6222515106201172
generate_one_block  0.6130275726318359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.13329124450683594  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

connection checking time:  10.034465551376343
block generation total time  8.653085708618164
average batch blocks generation time:  1.0816357135772705
block dataloader generation time/epoch 20.84171199798584
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5096435546875 GB
    Memory Allocated: 0.10267162322998047  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

torch.Size([160873, 128])
torch.Size([143209, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.9411144256591797  GigaBytes
Max Memory Allocated: 1.0810041427612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.1018223762512207  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([160956, 128])
torch.Size([142820, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.938899040222168  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.10229873657226562  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([161083, 128])
torch.Size([143409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.9369926452636719  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.10237646102905273  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([160935, 128])
torch.Size([142871, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.9352459907531738  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.10246896743774414  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([160684, 128])
torch.Size([142922, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.9360103607177734  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.10257101058959961  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([161025, 128])
torch.Size([143063, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.9368534088134766  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.1025080680847168  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([160705, 128])
torch.Size([143038, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.9389801025390625  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.10167312622070312  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

torch.Size([161073, 128])
torch.Size([143047, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5115966796875 GB
    Memory Allocated: 0.936070442199707  GigaBytes
Max Memory Allocated: 1.0823736190795898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08070716261863708 |0.01549685001373291 |0.006282776594161987 |9.173154830932617e-05 |0.003035634756088257 |0.0018379688262939453 |
----------------------------------------------------------pseudo_mini_loss sum 3.240396499633789
Total (block generation + training)time/epoch 21.768173217773438
Training time/epoch 0.9261841773986816
Training time without block to device /epoch 0.8022093772888184
Training time without total dataloading part /epoch 0.07711911201477051
load block tensor time/epoch 0.6456573009490967
block to device time/epoch 0.12397480010986328
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021814
Number of first layer input nodes during this epoch:  1287334
