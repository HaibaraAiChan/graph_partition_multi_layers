Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648512986.4199634
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02466893196105957
random selection method range initialization spend 0.006494283676147461
time for parepare:  0.018990278244018555
local_output_nid generation:  0.0021696090698242188
local_in_edges_tensor generation:  0.004880666732788086
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.01819920539855957
local_output_nid generation:  0.0026793479919433594
local_in_edges_tensor generation:  0.0016634464263916016
mini_batch_src_global generation:  0.0021219253540039062
r_  generation:  0.018132925033569336
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.001397848129272461
r_  generation:  0.017737150192260742
local_output_nid generation:  0.002832651138305664
local_in_edges_tensor generation:  0.0015327930450439453
mini_batch_src_global generation:  0.001394033432006836
r_  generation:  0.01833200454711914
local_output_nid generation:  0.0028624534606933594
local_in_edges_tensor generation:  0.0015256404876708984
mini_batch_src_global generation:  0.0014553070068359375
r_  generation:  0.018598556518554688
local_output_nid generation:  0.0028994083404541016
local_in_edges_tensor generation:  0.00157928466796875
mini_batch_src_global generation:  0.0014390945434570312
r_  generation:  0.01842188835144043
local_output_nid generation:  0.0028870105743408203
local_in_edges_tensor generation:  0.0015056133270263672
mini_batch_src_global generation:  0.001435995101928711
r_  generation:  0.01953601837158203
local_output_nid generation:  0.0028574466705322266
local_in_edges_tensor generation:  0.0014653205871582031
mini_batch_src_global generation:  0.001514434814453125
r_  generation:  0.018845796585083008
local_output_nid generation:  0.0028617382049560547
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.0014691352844238281
r_  generation:  0.01879143714904785
local_output_nid generation:  0.0029070377349853516
local_in_edges_tensor generation:  0.0014493465423583984
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.01913738250732422
local_output_nid generation:  0.0028913021087646484
local_in_edges_tensor generation:  0.0014791488647460938
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.019310951232910156
local_output_nid generation:  0.002954721450805664
local_in_edges_tensor generation:  0.001619100570678711
mini_batch_src_global generation:  0.0015344619750976562
r_  generation:  0.019969940185546875
local_output_nid generation:  0.002931833267211914
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.001566171646118164
r_  generation:  0.01958465576171875
local_output_nid generation:  0.002988100051879883
local_in_edges_tensor generation:  0.0015134811401367188
mini_batch_src_global generation:  0.0015850067138671875
r_  generation:  0.01932525634765625
local_output_nid generation:  0.002884387969970703
local_in_edges_tensor generation:  0.0015189647674560547
mini_batch_src_global generation:  0.0015816688537597656
r_  generation:  0.020269393920898438
local_output_nid generation:  0.0031456947326660156
local_in_edges_tensor generation:  0.0017049312591552734
mini_batch_src_global generation:  0.0016798973083496094
r_  generation:  0.020290613174438477
----------------------check_connections_block total spend ----------------------------- 0.5011422634124756
generate_one_block  0.027521610260009766
generate_one_block  0.027981042861938477
generate_one_block  0.027780532836914062
generate_one_block  0.030601024627685547
generate_one_block  0.028371095657348633
generate_one_block  0.027423620223999023
generate_one_block  0.028355836868286133
generate_one_block  0.02757859230041504
generate_one_block  0.027673959732055664
generate_one_block  0.027069807052612305
generate_one_block  0.027626514434814453
generate_one_block  0.028101205825805664
generate_one_block  0.02741527557373047
generate_one_block  0.027988910675048828
generate_one_block  0.027901649475097656
generate_one_block  0.02768111228942871
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.040975332260131836
gen group dst list time:  0.01915287971496582
time for parepare:  0.019457101821899414
local_output_nid generation:  0.008103609085083008
local_in_edges_tensor generation:  0.01729297637939453
mini_batch_src_global generation:  0.019177675247192383
r_  generation:  0.19195961952209473
local_output_nid generation:  0.014234304428100586
local_in_edges_tensor generation:  0.02050042152404785
mini_batch_src_global generation:  0.024945497512817383
r_  generation:  0.21289658546447754
local_output_nid generation:  0.013579130172729492
local_in_edges_tensor generation:  0.02025747299194336
mini_batch_src_global generation:  0.028284072875976562
r_  generation:  0.2179863452911377
local_output_nid generation:  0.014271736145019531
local_in_edges_tensor generation:  0.028850793838500977
mini_batch_src_global generation:  0.0300140380859375
r_  generation:  0.2116096019744873
local_output_nid generation:  0.012319564819335938
local_in_edges_tensor generation:  0.013715982437133789
mini_batch_src_global generation:  0.02694082260131836
r_  generation:  0.2163410186767578
local_output_nid generation:  0.012168645858764648
local_in_edges_tensor generation:  0.013015985488891602
mini_batch_src_global generation:  0.026379823684692383
r_  generation:  0.21324586868286133
local_output_nid generation:  0.01236104965209961
local_in_edges_tensor generation:  0.015720129013061523
mini_batch_src_global generation:  0.027239084243774414
r_  generation:  0.2220444679260254
local_output_nid generation:  0.012257575988769531
local_in_edges_tensor generation:  0.012292861938476562
mini_batch_src_global generation:  0.026862144470214844
r_  generation:  0.21682977676391602
local_output_nid generation:  0.012282371520996094
local_in_edges_tensor generation:  0.01175832748413086
mini_batch_src_global generation:  0.026993513107299805
r_  generation:  0.21647381782531738
local_output_nid generation:  0.012284040451049805
local_in_edges_tensor generation:  0.013366460800170898
mini_batch_src_global generation:  0.02662515640258789
r_  generation:  0.21477913856506348
local_output_nid generation:  0.012313127517700195
local_in_edges_tensor generation:  0.015622138977050781
mini_batch_src_global generation:  0.02872490882873535
r_  generation:  0.21750450134277344
local_output_nid generation:  0.012401819229125977
local_in_edges_tensor generation:  0.015873193740844727
mini_batch_src_global generation:  0.028940200805664062
r_  generation:  0.2200314998626709
local_output_nid generation:  0.012313604354858398
local_in_edges_tensor generation:  0.012309789657592773
mini_batch_src_global generation:  0.02796483039855957
r_  generation:  0.21783828735351562
local_output_nid generation:  0.012342453002929688
local_in_edges_tensor generation:  0.011617422103881836
mini_batch_src_global generation:  0.02813124656677246
r_  generation:  0.22003483772277832
local_output_nid generation:  0.012408733367919922
local_in_edges_tensor generation:  0.0172884464263916
mini_batch_src_global generation:  0.027693986892700195
r_  generation:  0.22307825088500977
local_output_nid generation:  0.012277603149414062
local_in_edges_tensor generation:  0.01395726203918457
mini_batch_src_global generation:  0.028273820877075195
r_  generation:  0.22343826293945312
----------------------check_connections_block total spend ----------------------------- 5.142137765884399
generate_one_block  0.2888016700744629
generate_one_block  0.27643513679504395
generate_one_block  0.2820289134979248
generate_one_block  0.29178595542907715
generate_one_block  0.32247233390808105
generate_one_block  0.283036470413208
generate_one_block  0.29419565200805664
generate_one_block  0.2813699245452881
generate_one_block  0.30788588523864746
generate_one_block  0.2955451011657715
generate_one_block  0.28951048851013184
generate_one_block  0.2870025634765625
generate_one_block  0.2771167755126953
generate_one_block  0.2847135066986084
generate_one_block  0.29274415969848633
generate_one_block  0.29550814628601074
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0625307559967041
gen group dst list time:  0.0685110092163086
time for parepare:  0.02126288414001465
local_output_nid generation:  0.026458263397216797
local_in_edges_tensor generation:  0.0532069206237793
mini_batch_src_global generation:  0.050411224365234375
r_  generation:  0.48325657844543457
local_output_nid generation:  0.031420230865478516
local_in_edges_tensor generation:  0.05176234245300293
mini_batch_src_global generation:  0.05766773223876953
r_  generation:  0.4965500831604004
local_output_nid generation:  0.030840635299682617
local_in_edges_tensor generation:  0.04742240905761719
mini_batch_src_global generation:  0.05708003044128418
r_  generation:  0.50026535987854
local_output_nid generation:  0.03093719482421875
local_in_edges_tensor generation:  0.03837108612060547
mini_batch_src_global generation:  0.05940103530883789
r_  generation:  0.5101683139801025
local_output_nid generation:  0.03070974349975586
local_in_edges_tensor generation:  0.037639617919921875
mini_batch_src_global generation:  0.06218266487121582
r_  generation:  0.507683515548706
local_output_nid generation:  0.03073287010192871
local_in_edges_tensor generation:  0.034052133560180664
mini_batch_src_global generation:  0.05988121032714844
r_  generation:  0.504319429397583
local_output_nid generation:  0.03069782257080078
local_in_edges_tensor generation:  0.03612327575683594
mini_batch_src_global generation:  0.060022830963134766
r_  generation:  0.5124645233154297
local_output_nid generation:  0.03230452537536621
local_in_edges_tensor generation:  0.04319334030151367
mini_batch_src_global generation:  0.05973219871520996
r_  generation:  0.5076456069946289
local_output_nid generation:  0.031546831130981445
local_in_edges_tensor generation:  0.03721046447753906
mini_batch_src_global generation:  0.06879115104675293
r_  generation:  0.5098388195037842
local_output_nid generation:  0.03498244285583496
local_in_edges_tensor generation:  0.040902137756347656
mini_batch_src_global generation:  0.07275676727294922
r_  generation:  0.5031313896179199
local_output_nid generation:  0.032172441482543945
local_in_edges_tensor generation:  0.043077945709228516
mini_batch_src_global generation:  0.062067270278930664
r_  generation:  0.5137193202972412
local_output_nid generation:  0.033239126205444336
local_in_edges_tensor generation:  0.0474853515625
mini_batch_src_global generation:  0.06480860710144043
r_  generation:  0.5063459873199463
local_output_nid generation:  0.032118797302246094
local_in_edges_tensor generation:  0.03327536582946777
mini_batch_src_global generation:  0.05968832969665527
r_  generation:  0.5084576606750488
local_output_nid generation:  0.03188467025756836
local_in_edges_tensor generation:  0.03749561309814453
mini_batch_src_global generation:  0.059575796127319336
r_  generation:  0.506638765335083
local_output_nid generation:  0.031990766525268555
local_in_edges_tensor generation:  0.042771100997924805
mini_batch_src_global generation:  0.05917048454284668
r_  generation:  0.5147678852081299
local_output_nid generation:  0.0321803092956543
local_in_edges_tensor generation:  0.04262375831604004
mini_batch_src_global generation:  0.05941605567932129
r_  generation:  0.5199158191680908
----------------------check_connections_block total spend ----------------------------- 11.987767934799194
generate_one_block  0.6508750915527344
generate_one_block  0.6500844955444336
generate_one_block  0.6444463729858398
generate_one_block  0.6539151668548584
generate_one_block  0.6546192169189453
generate_one_block  0.6352138519287109
generate_one_block  0.7145202159881592
generate_one_block  0.6482143402099609
generate_one_block  0.646658182144165
generate_one_block  0.6345765590667725
generate_one_block  0.6379828453063965
generate_one_block  0.6653385162353516
generate_one_block  0.6405618190765381
generate_one_block  0.6710388660430908
generate_one_block  0.6534812450408936
generate_one_block  0.6557965278625488
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.047112464904785156
gen group dst list time:  0.09062743186950684
time for parepare:  0.01961541175842285
local_output_nid generation:  0.03418874740600586
local_in_edges_tensor generation:  0.07503795623779297
mini_batch_src_global generation:  0.05101633071899414
r_  generation:  0.5360612869262695
local_output_nid generation:  0.03927946090698242
local_in_edges_tensor generation:  0.05737018585205078
mini_batch_src_global generation:  0.06377339363098145
r_  generation:  0.5469067096710205
local_output_nid generation:  0.041407108306884766
local_in_edges_tensor generation:  0.05269455909729004
mini_batch_src_global generation:  0.06830096244812012
r_  generation:  0.5486123561859131
local_output_nid generation:  0.039397239685058594
local_in_edges_tensor generation:  0.04362678527832031
mini_batch_src_global generation:  0.060346126556396484
r_  generation:  0.5516781806945801
local_output_nid generation:  0.03926444053649902
local_in_edges_tensor generation:  0.048143863677978516
mini_batch_src_global generation:  0.05974102020263672
r_  generation:  0.5586469173431396
local_output_nid generation:  0.03914237022399902
local_in_edges_tensor generation:  0.0424349308013916
mini_batch_src_global generation:  0.061441898345947266
r_  generation:  0.5579545497894287
local_output_nid generation:  0.039270639419555664
local_in_edges_tensor generation:  0.03767037391662598
mini_batch_src_global generation:  0.06041669845581055
r_  generation:  0.5643737316131592
local_output_nid generation:  0.04174661636352539
local_in_edges_tensor generation:  0.0431828498840332
mini_batch_src_global generation:  0.06221342086791992
r_  generation:  0.5621724128723145
local_output_nid generation:  0.03942513465881348
local_in_edges_tensor generation:  0.047975778579711914
mini_batch_src_global generation:  0.06154489517211914
r_  generation:  0.5699176788330078
local_output_nid generation:  0.03905987739562988
local_in_edges_tensor generation:  0.03795194625854492
mini_batch_src_global generation:  0.06255865097045898
r_  generation:  0.5640068054199219
local_output_nid generation:  0.03916144371032715
local_in_edges_tensor generation:  0.038292646408081055
mini_batch_src_global generation:  0.06269955635070801
r_  generation:  0.5720274448394775
local_output_nid generation:  0.03918027877807617
local_in_edges_tensor generation:  0.04799079895019531
mini_batch_src_global generation:  0.06282329559326172
r_  generation:  0.5673420429229736
local_output_nid generation:  0.03917074203491211
local_in_edges_tensor generation:  0.04658651351928711
mini_batch_src_global generation:  0.06375002861022949
r_  generation:  0.5784833431243896
local_output_nid generation:  0.03946971893310547
local_in_edges_tensor generation:  0.03847646713256836
mini_batch_src_global generation:  0.06275677680969238
r_  generation:  0.5753295421600342
local_output_nid generation:  0.04048895835876465
local_in_edges_tensor generation:  0.03855133056640625
mini_batch_src_global generation:  0.06351304054260254
r_  generation:  0.5724165439605713
local_output_nid generation:  0.039344072341918945
local_in_edges_tensor generation:  0.04616546630859375
mini_batch_src_global generation:  0.07851743698120117
r_  generation:  0.5698096752166748
----------------------check_connections_block total spend ----------------------------- 13.493182897567749
generate_one_block  0.7064211368560791
generate_one_block  0.6988329887390137
generate_one_block  0.7130715847015381
generate_one_block  0.7978830337524414
generate_one_block  0.7171337604522705
generate_one_block  0.6976354122161865
generate_one_block  0.695833683013916
generate_one_block  0.6906254291534424
generate_one_block  0.7255153656005859
generate_one_block  0.6898200511932373
generate_one_block  0.6983790397644043
generate_one_block  0.7274179458618164
generate_one_block  0.7004163265228271
generate_one_block  0.6998484134674072
generate_one_block  0.7132792472839355
generate_one_block  0.7007009983062744
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047118425369262695
gen group dst list time:  0.09363722801208496
time for parepare:  0.01943230628967285
local_output_nid generation:  0.03603816032409668
local_in_edges_tensor generation:  0.0491485595703125
mini_batch_src_global generation:  0.049532413482666016
r_  generation:  0.537775993347168
local_output_nid generation:  0.042706966400146484
local_in_edges_tensor generation:  0.04125237464904785
mini_batch_src_global generation:  0.06326580047607422
r_  generation:  0.553149938583374
local_output_nid generation:  0.04001808166503906
local_in_edges_tensor generation:  0.0368962287902832
mini_batch_src_global generation:  0.06392216682434082
r_  generation:  0.5397341251373291
local_output_nid generation:  0.039992570877075195
local_in_edges_tensor generation:  0.03648114204406738
mini_batch_src_global generation:  0.062296152114868164
r_  generation:  0.5411999225616455
local_output_nid generation:  0.04011678695678711
local_in_edges_tensor generation:  0.03639578819274902
mini_batch_src_global generation:  0.06240200996398926
r_  generation:  0.5467495918273926
local_output_nid generation:  0.03989386558532715
local_in_edges_tensor generation:  0.04365277290344238
mini_batch_src_global generation:  0.0626215934753418
r_  generation:  0.5482959747314453
local_output_nid generation:  0.040413856506347656
local_in_edges_tensor generation:  0.04084420204162598
mini_batch_src_global generation:  0.06249737739562988
r_  generation:  0.5499613285064697
local_output_nid generation:  0.03991866111755371
local_in_edges_tensor generation:  0.03596329689025879
mini_batch_src_global generation:  0.06270599365234375
r_  generation:  0.5501437187194824
local_output_nid generation:  0.040103912353515625
local_in_edges_tensor generation:  0.04164552688598633
mini_batch_src_global generation:  0.0663461685180664
r_  generation:  0.5521326065063477
local_output_nid generation:  0.040825605392456055
local_in_edges_tensor generation:  0.04547595977783203
mini_batch_src_global generation:  0.06296372413635254
r_  generation:  0.5539755821228027
local_output_nid generation:  0.040041446685791016
local_in_edges_tensor generation:  0.035773277282714844
mini_batch_src_global generation:  0.06319713592529297
r_  generation:  0.5510339736938477
local_output_nid generation:  0.03996109962463379
local_in_edges_tensor generation:  0.04140901565551758
mini_batch_src_global generation:  0.06742191314697266
r_  generation:  0.5578734874725342
local_output_nid generation:  0.040055274963378906
local_in_edges_tensor generation:  0.040758609771728516
mini_batch_src_global generation:  0.062163591384887695
r_  generation:  0.5569632053375244
local_output_nid generation:  0.04011702537536621
local_in_edges_tensor generation:  0.04170656204223633
mini_batch_src_global generation:  0.06629657745361328
r_  generation:  0.5536355972290039
local_output_nid generation:  0.040198326110839844
local_in_edges_tensor generation:  0.04605984687805176
mini_batch_src_global generation:  0.061453819274902344
r_  generation:  0.5596272945404053
local_output_nid generation:  0.04050898551940918
local_in_edges_tensor generation:  0.04046463966369629
mini_batch_src_global generation:  0.06587982177734375
r_  generation:  0.556753396987915
----------------------check_connections_block total spend ----------------------------- 13.214725255966187
generate_one_block  0.6934263706207275
generate_one_block  0.687605619430542
generate_one_block  0.6945314407348633
generate_one_block  0.6822972297668457
generate_one_block  0.6934332847595215
generate_one_block  0.6938817501068115
generate_one_block  0.7456517219543457
generate_one_block  0.6709284782409668
generate_one_block  0.6838703155517578
generate_one_block  0.6948609352111816
generate_one_block  0.683107852935791
generate_one_block  0.6948807239532471
generate_one_block  0.6827375888824463
generate_one_block  0.6984710693359375
generate_one_block  0.6844274997711182
generate_one_block  0.691338300704956
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04224443435668945
gen group dst list time:  0.09536075592041016
time for parepare:  0.018716812133789062
local_output_nid generation:  0.03697967529296875
local_in_edges_tensor generation:  0.048058509826660156
mini_batch_src_global generation:  0.04588031768798828
r_  generation:  0.5085976123809814
local_output_nid generation:  0.04317617416381836
local_in_edges_tensor generation:  0.03782296180725098
mini_batch_src_global generation:  0.058402061462402344
r_  generation:  0.5085034370422363
local_output_nid generation:  0.040711402893066406
local_in_edges_tensor generation:  0.039873600006103516
mini_batch_src_global generation:  0.05948996543884277
r_  generation:  0.5077633857727051
local_output_nid generation:  0.04047822952270508
local_in_edges_tensor generation:  0.035927772521972656
mini_batch_src_global generation:  0.058838605880737305
r_  generation:  0.513676643371582
local_output_nid generation:  0.040671586990356445
local_in_edges_tensor generation:  0.03843975067138672
mini_batch_src_global generation:  0.05907273292541504
r_  generation:  0.5186946392059326
local_output_nid generation:  0.04044151306152344
local_in_edges_tensor generation:  0.038352012634277344
mini_batch_src_global generation:  0.05875372886657715
r_  generation:  0.5156471729278564
local_output_nid generation:  0.04065060615539551
local_in_edges_tensor generation:  0.04917192459106445
mini_batch_src_global generation:  0.058583974838256836
r_  generation:  0.5181803703308105
local_output_nid generation:  0.04139256477355957
local_in_edges_tensor generation:  0.03599381446838379
mini_batch_src_global generation:  0.058983564376831055
r_  generation:  0.5193893909454346
local_output_nid generation:  0.040869951248168945
local_in_edges_tensor generation:  0.04241156578063965
mini_batch_src_global generation:  0.058551788330078125
r_  generation:  0.519974946975708
local_output_nid generation:  0.0415804386138916
local_in_edges_tensor generation:  0.04315042495727539
mini_batch_src_global generation:  0.060715436935424805
r_  generation:  0.5188848972320557
local_output_nid generation:  0.04032468795776367
local_in_edges_tensor generation:  0.03964591026306152
mini_batch_src_global generation:  0.05861067771911621
r_  generation:  0.5245609283447266
local_output_nid generation:  0.04078316688537598
local_in_edges_tensor generation:  0.04794049263000488
mini_batch_src_global generation:  0.05977940559387207
r_  generation:  0.5154967308044434
local_output_nid generation:  0.04063916206359863
local_in_edges_tensor generation:  0.03996753692626953
mini_batch_src_global generation:  0.06252312660217285
r_  generation:  0.5283150672912598
local_output_nid generation:  0.04219818115234375
local_in_edges_tensor generation:  0.04526972770690918
mini_batch_src_global generation:  0.05877280235290527
r_  generation:  0.5237259864807129
local_output_nid generation:  0.04381132125854492
local_in_edges_tensor generation:  0.0444183349609375
mini_batch_src_global generation:  0.061022043228149414
r_  generation:  0.5234367847442627
local_output_nid generation:  0.044676780700683594
local_in_edges_tensor generation:  0.04245567321777344
mini_batch_src_global generation:  0.05877232551574707
r_  generation:  0.5246396064758301
----------------------check_connections_block total spend ----------------------------- 12.532423257827759
generate_one_block  0.633535623550415
generate_one_block  0.6414704322814941
generate_one_block  0.6501734256744385
generate_one_block  0.6266734600067139
generate_one_block  0.6428697109222412
generate_one_block  0.6533782482147217
generate_one_block  0.6501128673553467
generate_one_block  0.6293833255767822
generate_one_block  0.7309761047363281
generate_one_block  0.6355195045471191
generate_one_block  0.6307129859924316
generate_one_block  0.6662874221801758
generate_one_block  0.629833459854126
generate_one_block  0.6522948741912842
generate_one_block  0.6439745426177979
generate_one_block  0.6444127559661865
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

connection checking time:  56.37023711204529
block generation total time  47.917349338531494
average batch blocks generation time:  2.9948343336582184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.1370983123779297  GigaBytes
Max Memory Allocated: 0.1370983123779297  GigaBytes

torch.Size([167246, 128])
torch.Size([166418, 256])
torch.Size([163973, 256])
torch.Size([155524, 256])
torch.Size([123143, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.753542423248291  GigaBytes
Max Memory Allocated: 2.790128231048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3768310546875 GB
    Memory Allocated: 0.14149141311645508  GigaBytes
Max Memory Allocated: 2.831068515777588  GigaBytes

torch.Size([167248, 128])
torch.Size([166456, 256])
torch.Size([164060, 256])
torch.Size([155740, 256])
torch.Size([123544, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3787841796875 GB
    Memory Allocated: 2.762056350708008  GigaBytes
Max Memory Allocated: 2.831068515777588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14149761199951172  GigaBytes
Max Memory Allocated: 2.840357780456543  GigaBytes

torch.Size([167251, 128])
torch.Size([166457, 256])
torch.Size([164111, 256])
torch.Size([155917, 256])
torch.Size([123490, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.7614474296569824  GigaBytes
Max Memory Allocated: 2.840357780456543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14154386520385742  GigaBytes
Max Memory Allocated: 2.840357780456543  GigaBytes

torch.Size([167218, 128])
torch.Size([166315, 256])
torch.Size([163972, 256])
torch.Size([155925, 256])
torch.Size([124132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.767759323120117  GigaBytes
Max Memory Allocated: 2.840357780456543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14154434204101562  GigaBytes
Max Memory Allocated: 2.8470568656921387  GigaBytes

torch.Size([167246, 128])
torch.Size([166449, 256])
torch.Size([164072, 256])
torch.Size([155998, 256])
torch.Size([124100, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.768779754638672  GigaBytes
Max Memory Allocated: 2.8470568656921387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14149045944213867  GigaBytes
Max Memory Allocated: 2.8480963706970215  GigaBytes

torch.Size([167266, 128])
torch.Size([166475, 256])
torch.Size([164094, 256])
torch.Size([155840, 256])
torch.Size([123478, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.760586738586426  GigaBytes
Max Memory Allocated: 2.8480963706970215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14154434204101562  GigaBytes
Max Memory Allocated: 2.8480963706970215  GigaBytes

torch.Size([167288, 128])
torch.Size([166553, 256])
torch.Size([164258, 256])
torch.Size([155975, 256])
torch.Size([124017, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.773624897003174  GigaBytes
Max Memory Allocated: 2.8480963706970215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14151620864868164  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167248, 128])
torch.Size([166445, 256])
torch.Size([164034, 256])
torch.Size([155890, 256])
torch.Size([123773, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.763216495513916  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14151763916015625  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167257, 128])
torch.Size([166509, 256])
torch.Size([164189, 256])
torch.Size([156174, 256])
torch.Size([124217, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.770808219909668  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.1414775848388672  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167258, 128])
torch.Size([166401, 256])
torch.Size([163979, 256])
torch.Size([155501, 256])
torch.Size([123089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.7565197944641113  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14148283004760742  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167253, 128])
torch.Size([166387, 256])
torch.Size([164003, 256])
torch.Size([155788, 256])
torch.Size([123572, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.761455535888672  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14155817031860352  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167236, 128])
torch.Size([166453, 256])
torch.Size([164110, 256])
torch.Size([156109, 256])
torch.Size([124496, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.770434856414795  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14149999618530273  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167212, 128])
torch.Size([166429, 256])
torch.Size([164093, 256])
torch.Size([155965, 256])
torch.Size([123768, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.763535976409912  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14153289794921875  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167272, 128])
torch.Size([166485, 256])
torch.Size([164101, 256])
torch.Size([156005, 256])
torch.Size([124198, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.7703094482421875  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14153575897216797  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167266, 128])
torch.Size([166452, 256])
torch.Size([164014, 256])
torch.Size([155780, 256])
torch.Size([124212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.768853187561035  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 0.14155292510986328  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167277, 128])
torch.Size([166436, 256])
torch.Size([164011, 256])
torch.Size([155848, 256])
torch.Size([124145, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 2.768817901611328  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18612873554229736 |0.07208539545536041 |0.05605460703372955 |9.791553020477295e-05 |0.06613264977931976 |0.008605718612670898 |
----------------------------------------------------------pseudo_mini_loss sum 6.3832783699035645
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13100944
Number of first layer input nodes during this epoch:  2676042
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 0.24965524673461914  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.020845413208007812
random selection method range initialization spend 0.005861997604370117
time for parepare:  0.01816391944885254
local_output_nid generation:  0.002379179000854492
local_in_edges_tensor generation:  0.007054805755615234
mini_batch_src_global generation:  0.002019166946411133
r_  generation:  0.018566608428955078
local_output_nid generation:  0.002864837646484375
local_in_edges_tensor generation:  0.0017361640930175781
mini_batch_src_global generation:  0.0021545886993408203
r_  generation:  0.01957082748413086
local_output_nid generation:  0.002902507781982422
local_in_edges_tensor generation:  0.0016331672668457031
mini_batch_src_global generation:  0.0016016960144042969
r_  generation:  0.019313573837280273
local_output_nid generation:  0.002897500991821289
local_in_edges_tensor generation:  0.0030755996704101562
mini_batch_src_global generation:  0.001631021499633789
r_  generation:  0.0193636417388916
local_output_nid generation:  0.002888917922973633
local_in_edges_tensor generation:  0.0015506744384765625
mini_batch_src_global generation:  0.0015721321105957031
r_  generation:  0.019504547119140625
local_output_nid generation:  0.0029189586639404297
local_in_edges_tensor generation:  0.0015232563018798828
mini_batch_src_global generation:  0.0015633106231689453
r_  generation:  0.019362449645996094
local_output_nid generation:  0.0028994083404541016
local_in_edges_tensor generation:  0.0015094280242919922
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.01931476593017578
local_output_nid generation:  0.002895355224609375
local_in_edges_tensor generation:  0.0014920234680175781
mini_batch_src_global generation:  0.0016009807586669922
r_  generation:  0.019381284713745117
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.0015230178833007812
mini_batch_src_global generation:  0.0015728473663330078
r_  generation:  0.019199132919311523
local_output_nid generation:  0.0028553009033203125
local_in_edges_tensor generation:  0.001470804214477539
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.019034624099731445
local_output_nid generation:  0.0043756961822509766
local_in_edges_tensor generation:  0.0015311241149902344
mini_batch_src_global generation:  0.0015904903411865234
r_  generation:  0.019510269165039062
local_output_nid generation:  0.0028600692749023438
local_in_edges_tensor generation:  0.0014886856079101562
mini_batch_src_global generation:  0.0015578269958496094
r_  generation:  0.01946091651916504
local_output_nid generation:  0.00284576416015625
local_in_edges_tensor generation:  0.0015587806701660156
mini_batch_src_global generation:  0.0016107559204101562
r_  generation:  0.020071029663085938
local_output_nid generation:  0.00287628173828125
local_in_edges_tensor generation:  0.0015017986297607422
mini_batch_src_global generation:  0.0016057491302490234
r_  generation:  0.019450664520263672
local_output_nid generation:  0.0028634071350097656
local_in_edges_tensor generation:  0.0015063285827636719
mini_batch_src_global generation:  0.001627206802368164
r_  generation:  0.019676923751831055
local_output_nid generation:  0.0028543472290039062
local_in_edges_tensor generation:  0.0014803409576416016
mini_batch_src_global generation:  0.0015633106231689453
r_  generation:  0.01978325843811035
----------------------check_connections_block total spend ----------------------------- 0.5137262344360352
generate_one_block  0.03223085403442383
generate_one_block  0.02862262725830078
generate_one_block  0.027500152587890625
generate_one_block  0.027877330780029297
generate_one_block  0.028302669525146484
generate_one_block  0.030209064483642578
generate_one_block  0.0273129940032959
generate_one_block  0.0272219181060791
generate_one_block  0.02747488021850586
generate_one_block  0.0269167423248291
generate_one_block  0.027578353881835938
generate_one_block  0.027820110321044922
generate_one_block  0.028376340866088867
generate_one_block  0.02793264389038086
generate_one_block  0.03089118003845215
generate_one_block  0.028747081756591797
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03990459442138672
gen group dst list time:  0.017093896865844727
time for parepare:  0.019281864166259766
local_output_nid generation:  0.008335590362548828
local_in_edges_tensor generation:  0.01869368553161621
mini_batch_src_global generation:  0.021327733993530273
r_  generation:  0.19956088066101074
local_output_nid generation:  0.014229059219360352
local_in_edges_tensor generation:  0.018880844116210938
mini_batch_src_global generation:  0.02689337730407715
r_  generation:  0.21053314208984375
local_output_nid generation:  0.012687206268310547
local_in_edges_tensor generation:  0.01348876953125
mini_batch_src_global generation:  0.024297714233398438
r_  generation:  0.209791898727417
local_output_nid generation:  0.014334440231323242
local_in_edges_tensor generation:  0.01571941375732422
mini_batch_src_global generation:  0.02552032470703125
r_  generation:  0.21796059608459473
local_output_nid generation:  0.012121438980102539
local_in_edges_tensor generation:  0.01595616340637207
mini_batch_src_global generation:  0.026740074157714844
r_  generation:  0.22201299667358398
local_output_nid generation:  0.01198720932006836
local_in_edges_tensor generation:  0.012483596801757812
mini_batch_src_global generation:  0.02692723274230957
r_  generation:  0.21535420417785645
local_output_nid generation:  0.012499570846557617
local_in_edges_tensor generation:  0.01376485824584961
mini_batch_src_global generation:  0.026854753494262695
r_  generation:  0.21900129318237305
local_output_nid generation:  0.012616872787475586
local_in_edges_tensor generation:  0.012109041213989258
mini_batch_src_global generation:  0.02700209617614746
r_  generation:  0.21798014640808105
local_output_nid generation:  0.012571334838867188
local_in_edges_tensor generation:  0.015961170196533203
mini_batch_src_global generation:  0.028426408767700195
r_  generation:  0.22356009483337402
local_output_nid generation:  0.013717889785766602
local_in_edges_tensor generation:  0.021686077117919922
mini_batch_src_global generation:  0.032495737075805664
r_  generation:  0.23044967651367188
local_output_nid generation:  0.014615535736083984
local_in_edges_tensor generation:  0.01879286766052246
mini_batch_src_global generation:  0.027040719985961914
r_  generation:  0.21934008598327637
local_output_nid generation:  0.013662338256835938
local_in_edges_tensor generation:  0.01608419418334961
mini_batch_src_global generation:  0.02778315544128418
r_  generation:  0.22686505317687988
local_output_nid generation:  0.013493537902832031
local_in_edges_tensor generation:  0.012125730514526367
mini_batch_src_global generation:  0.028659820556640625
r_  generation:  0.22439241409301758
local_output_nid generation:  0.013074636459350586
local_in_edges_tensor generation:  0.013707160949707031
mini_batch_src_global generation:  0.027685165405273438
r_  generation:  0.22080087661743164
local_output_nid generation:  0.013002634048461914
local_in_edges_tensor generation:  0.013831377029418945
mini_batch_src_global generation:  0.04797482490539551
r_  generation:  0.22968125343322754
local_output_nid generation:  0.012890338897705078
local_in_edges_tensor generation:  0.017627716064453125
mini_batch_src_global generation:  0.030942678451538086
r_  generation:  0.23150277137756348
----------------------check_connections_block total spend ----------------------------- 5.224032163619995
generate_one_block  0.28867340087890625
generate_one_block  0.28066372871398926
generate_one_block  0.2772030830383301
generate_one_block  0.28347086906433105
generate_one_block  0.28420281410217285
generate_one_block  0.3033256530761719
generate_one_block  0.31112003326416016
generate_one_block  0.28140783309936523
generate_one_block  0.2939116954803467
generate_one_block  0.28406429290771484
generate_one_block  0.28131580352783203
generate_one_block  0.2850914001464844
generate_one_block  0.2938694953918457
generate_one_block  0.2878236770629883
generate_one_block  0.295182466506958
generate_one_block  0.28600192070007324
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05478048324584961
gen group dst list time:  0.0690603256225586
time for parepare:  0.017826080322265625
local_output_nid generation:  0.027010679244995117
local_in_edges_tensor generation:  0.05304241180419922
mini_batch_src_global generation:  0.05043840408325195
r_  generation:  0.5054473876953125
local_output_nid generation:  0.031755924224853516
local_in_edges_tensor generation:  0.05105733871459961
mini_batch_src_global generation:  0.059667110443115234
r_  generation:  0.499126672744751
local_output_nid generation:  0.03203630447387695
local_in_edges_tensor generation:  0.03829455375671387
mini_batch_src_global generation:  0.05858564376831055
r_  generation:  0.5155632495880127
local_output_nid generation:  0.0319516658782959
local_in_edges_tensor generation:  0.04767036437988281
mini_batch_src_global generation:  0.0634462833404541
r_  generation:  0.502335786819458
local_output_nid generation:  0.03205728530883789
local_in_edges_tensor generation:  0.09344005584716797
mini_batch_src_global generation:  0.060948848724365234
r_  generation:  0.5226640701293945
local_output_nid generation:  0.03280210494995117
local_in_edges_tensor generation:  0.03423881530761719
mini_batch_src_global generation:  0.07021951675415039
r_  generation:  0.521895170211792
local_output_nid generation:  0.03334808349609375
local_in_edges_tensor generation:  0.04875445365905762
mini_batch_src_global generation:  0.06399178504943848
r_  generation:  0.5254435539245605
local_output_nid generation:  0.03433561325073242
local_in_edges_tensor generation:  0.04333758354187012
mini_batch_src_global generation:  0.061809539794921875
r_  generation:  0.505220890045166
local_output_nid generation:  0.03323936462402344
local_in_edges_tensor generation:  0.03293108940124512
mini_batch_src_global generation:  0.05904960632324219
r_  generation:  0.5228462219238281
local_output_nid generation:  0.03322601318359375
local_in_edges_tensor generation:  0.03805184364318848
mini_batch_src_global generation:  0.06432175636291504
r_  generation:  0.511519193649292
local_output_nid generation:  0.033380746841430664
local_in_edges_tensor generation:  0.04657721519470215
mini_batch_src_global generation:  0.05940723419189453
r_  generation:  0.5267744064331055
local_output_nid generation:  0.033451080322265625
local_in_edges_tensor generation:  0.03345489501953125
mini_batch_src_global generation:  0.061779022216796875
r_  generation:  0.5063254833221436
local_output_nid generation:  0.033922433853149414
local_in_edges_tensor generation:  0.04482460021972656
mini_batch_src_global generation:  0.06312084197998047
r_  generation:  0.5148186683654785
local_output_nid generation:  0.03330254554748535
local_in_edges_tensor generation:  0.03801369667053223
mini_batch_src_global generation:  0.060843706130981445
r_  generation:  0.500694751739502
local_output_nid generation:  0.03307509422302246
local_in_edges_tensor generation:  0.033731937408447266
mini_batch_src_global generation:  0.060991764068603516
r_  generation:  0.5186748504638672
local_output_nid generation:  0.03335404396057129
local_in_edges_tensor generation:  0.03791618347167969
mini_batch_src_global generation:  0.07709240913391113
r_  generation:  0.5458033084869385
----------------------check_connections_block total spend ----------------------------- 12.265768051147461
generate_one_block  0.6893727779388428
generate_one_block  0.6464786529541016
generate_one_block  0.6694591045379639
generate_one_block  0.6813147068023682
generate_one_block  0.6799139976501465
generate_one_block  0.6587536334991455
generate_one_block  0.6528208255767822
generate_one_block  0.6475355625152588
generate_one_block  0.6811182498931885
generate_one_block  0.6765749454498291
generate_one_block  0.6722412109375
generate_one_block  0.6541752815246582
generate_one_block  0.668499231338501
generate_one_block  0.6385960578918457
generate_one_block  0.6521611213684082
generate_one_block  0.6821999549865723
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.07139778137207031
gen group dst list time:  0.09984731674194336
time for parepare:  0.01895618438720703
local_output_nid generation:  0.03320479393005371
local_in_edges_tensor generation:  0.05999588966369629
mini_batch_src_global generation:  0.05702686309814453
r_  generation:  0.533038854598999
local_output_nid generation:  0.04066753387451172
local_in_edges_tensor generation:  0.055995941162109375
mini_batch_src_global generation:  0.06285977363586426
r_  generation:  0.539381742477417
local_output_nid generation:  0.040323734283447266
local_in_edges_tensor generation:  0.04167008399963379
mini_batch_src_global generation:  0.06055617332458496
r_  generation:  0.5498635768890381
local_output_nid generation:  0.04053640365600586
local_in_edges_tensor generation:  0.04104447364807129
mini_batch_src_global generation:  0.05972099304199219
r_  generation:  0.5498955249786377
local_output_nid generation:  0.04048466682434082
local_in_edges_tensor generation:  0.04176139831542969
mini_batch_src_global generation:  0.059273719787597656
r_  generation:  0.5696039199829102
local_output_nid generation:  0.037933349609375
local_in_edges_tensor generation:  0.04146003723144531
mini_batch_src_global generation:  0.060929298400878906
r_  generation:  0.5577116012573242
local_output_nid generation:  0.03742241859436035
local_in_edges_tensor generation:  0.041358232498168945
mini_batch_src_global generation:  0.061324357986450195
r_  generation:  0.5687177181243896
local_output_nid generation:  0.03801560401916504
local_in_edges_tensor generation:  0.04136800765991211
mini_batch_src_global generation:  0.061515092849731445
r_  generation:  0.5619947910308838
local_output_nid generation:  0.03778982162475586
local_in_edges_tensor generation:  0.04135322570800781
mini_batch_src_global generation:  0.06138968467712402
r_  generation:  0.5693168640136719
local_output_nid generation:  0.03791069984436035
local_in_edges_tensor generation:  0.04150748252868652
mini_batch_src_global generation:  0.06218910217285156
r_  generation:  0.5718920230865479
local_output_nid generation:  0.03775954246520996
local_in_edges_tensor generation:  0.04175233840942383
mini_batch_src_global generation:  0.06234598159790039
r_  generation:  0.5704448223114014
local_output_nid generation:  0.03775334358215332
local_in_edges_tensor generation:  0.04128909111022949
mini_batch_src_global generation:  0.06214427947998047
r_  generation:  0.5713169574737549
local_output_nid generation:  0.037698984146118164
local_in_edges_tensor generation:  0.041594505310058594
mini_batch_src_global generation:  0.06265759468078613
r_  generation:  0.5738077163696289
local_output_nid generation:  0.03823423385620117
local_in_edges_tensor generation:  0.041396141052246094
mini_batch_src_global generation:  0.06208086013793945
r_  generation:  0.5664811134338379
local_output_nid generation:  0.0381627082824707
local_in_edges_tensor generation:  0.04141879081726074
mini_batch_src_global generation:  0.06354880332946777
r_  generation:  0.5718393325805664
local_output_nid generation:  0.03771400451660156
local_in_edges_tensor generation:  0.04131054878234863
mini_batch_src_global generation:  0.0696561336517334
r_  generation:  0.5690329074859619
----------------------check_connections_block total spend ----------------------------- 13.372637748718262
generate_one_block  0.6933152675628662
generate_one_block  0.6992425918579102
generate_one_block  0.6935155391693115
generate_one_block  0.6943564414978027
generate_one_block  0.7009062767028809
generate_one_block  0.6915912628173828
generate_one_block  0.7779788970947266
generate_one_block  0.6922247409820557
generate_one_block  0.6928935050964355
generate_one_block  0.6947407722473145
generate_one_block  0.6935460567474365
generate_one_block  0.6901848316192627
generate_one_block  0.6931710243225098
generate_one_block  0.6925773620605469
generate_one_block  0.6976349353790283
generate_one_block  0.6897821426391602
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03565645217895508
gen group dst list time:  0.09291505813598633
time for parepare:  0.018735408782958984
local_output_nid generation:  0.0359196662902832
local_in_edges_tensor generation:  0.06092190742492676
mini_batch_src_global generation:  0.05256199836730957
r_  generation:  0.5551009178161621
local_output_nid generation:  0.04215550422668457
local_in_edges_tensor generation:  0.05431079864501953
mini_batch_src_global generation:  0.06313896179199219
r_  generation:  0.5401768684387207
local_output_nid generation:  0.04035592079162598
local_in_edges_tensor generation:  0.04068422317504883
mini_batch_src_global generation:  0.06224322319030762
r_  generation:  0.5616962909698486
local_output_nid generation:  0.04024195671081543
local_in_edges_tensor generation:  0.03987932205200195
mini_batch_src_global generation:  0.06352663040161133
r_  generation:  0.5444655418395996
local_output_nid generation:  0.040282249450683594
local_in_edges_tensor generation:  0.04060029983520508
mini_batch_src_global generation:  0.06176590919494629
r_  generation:  0.551659345626831
local_output_nid generation:  0.04068899154663086
local_in_edges_tensor generation:  0.039992570877075195
mini_batch_src_global generation:  0.06271553039550781
r_  generation:  0.5473530292510986
local_output_nid generation:  0.0400545597076416
local_in_edges_tensor generation:  0.04059338569641113
mini_batch_src_global generation:  0.06124997138977051
r_  generation:  0.5552337169647217
local_output_nid generation:  0.04023432731628418
local_in_edges_tensor generation:  0.0402069091796875
mini_batch_src_global generation:  0.06274986267089844
r_  generation:  0.5503509044647217
local_output_nid generation:  0.04075264930725098
local_in_edges_tensor generation:  0.04080915451049805
mini_batch_src_global generation:  0.06205606460571289
r_  generation:  0.5545985698699951
local_output_nid generation:  0.04039263725280762
local_in_edges_tensor generation:  0.04000353813171387
mini_batch_src_global generation:  0.06287145614624023
r_  generation:  0.5520844459533691
local_output_nid generation:  0.041066884994506836
local_in_edges_tensor generation:  0.04095053672790527
mini_batch_src_global generation:  0.0634150505065918
r_  generation:  0.5582575798034668
local_output_nid generation:  0.04121279716491699
local_in_edges_tensor generation:  0.039702415466308594
mini_batch_src_global generation:  0.06281590461730957
r_  generation:  0.5526363849639893
local_output_nid generation:  0.04043221473693848
local_in_edges_tensor generation:  0.04329347610473633
mini_batch_src_global generation:  0.062441110610961914
r_  generation:  0.5653471946716309
local_output_nid generation:  0.04040265083312988
local_in_edges_tensor generation:  0.04021573066711426
mini_batch_src_global generation:  0.06269407272338867
r_  generation:  0.5553851127624512
local_output_nid generation:  0.04091668128967285
local_in_edges_tensor generation:  0.04073667526245117
mini_batch_src_global generation:  0.06228208541870117
r_  generation:  0.5593140125274658
local_output_nid generation:  0.040758371353149414
local_in_edges_tensor generation:  0.044745445251464844
mini_batch_src_global generation:  0.0626368522644043
r_  generation:  0.5594527721405029
----------------------check_connections_block total spend ----------------------------- 13.306408882141113
generate_one_block  0.681621789932251
generate_one_block  0.6916272640228271
generate_one_block  0.696357250213623
generate_one_block  0.6867947578430176
generate_one_block  0.68770432472229
generate_one_block  0.6883862018585205
generate_one_block  0.6877624988555908
generate_one_block  0.6875369548797607
generate_one_block  0.6949431896209717
generate_one_block  0.7679636478424072
generate_one_block  0.6994116306304932
generate_one_block  0.6856439113616943
generate_one_block  0.6958029270172119
generate_one_block  0.682924747467041
generate_one_block  0.6902463436126709
generate_one_block  0.6748590469360352
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03424501419067383
gen group dst list time:  0.10307121276855469
time for parepare:  0.018621206283569336
local_output_nid generation:  0.03579258918762207
local_in_edges_tensor generation:  0.053829193115234375
mini_batch_src_global generation:  0.04546093940734863
r_  generation:  0.5218410491943359
local_output_nid generation:  0.042795658111572266
local_in_edges_tensor generation:  0.05204916000366211
mini_batch_src_global generation:  0.057433366775512695
r_  generation:  0.4994528293609619
local_output_nid generation:  0.04276633262634277
local_in_edges_tensor generation:  0.03922724723815918
mini_batch_src_global generation:  0.05826520919799805
r_  generation:  0.5020787715911865
local_output_nid generation:  0.0429224967956543
local_in_edges_tensor generation:  0.038567543029785156
mini_batch_src_global generation:  0.057985782623291016
r_  generation:  0.5010223388671875
local_output_nid generation:  0.04293203353881836
local_in_edges_tensor generation:  0.03934502601623535
mini_batch_src_global generation:  0.058402061462402344
r_  generation:  0.5090601444244385
local_output_nid generation:  0.041643381118774414
local_in_edges_tensor generation:  0.03869438171386719
mini_batch_src_global generation:  0.058185577392578125
r_  generation:  0.5030725002288818
local_output_nid generation:  0.03975367546081543
local_in_edges_tensor generation:  0.03926682472229004
mini_batch_src_global generation:  0.05810379981994629
r_  generation:  0.5135195255279541
local_output_nid generation:  0.039526939392089844
local_in_edges_tensor generation:  0.04325556755065918
mini_batch_src_global generation:  0.05782270431518555
r_  generation:  0.5037968158721924
local_output_nid generation:  0.03997230529785156
local_in_edges_tensor generation:  0.039130449295043945
mini_batch_src_global generation:  0.05827522277832031
r_  generation:  0.5039324760437012
local_output_nid generation:  0.03993344306945801
local_in_edges_tensor generation:  0.04326605796813965
mini_batch_src_global generation:  0.057332754135131836
r_  generation:  0.505037784576416
local_output_nid generation:  0.039871931076049805
local_in_edges_tensor generation:  0.03924202919006348
mini_batch_src_global generation:  0.058196306228637695
r_  generation:  0.5054004192352295
local_output_nid generation:  0.03976607322692871
local_in_edges_tensor generation:  0.0386202335357666
mini_batch_src_global generation:  0.05837082862854004
r_  generation:  0.5107128620147705
local_output_nid generation:  0.03980088233947754
local_in_edges_tensor generation:  0.04411149024963379
mini_batch_src_global generation:  0.05774855613708496
r_  generation:  0.5107347965240479
local_output_nid generation:  0.03987455368041992
local_in_edges_tensor generation:  0.03856158256530762
mini_batch_src_global generation:  0.057624101638793945
r_  generation:  0.5107283592224121
local_output_nid generation:  0.03979849815368652
local_in_edges_tensor generation:  0.03880596160888672
mini_batch_src_global generation:  0.060100555419921875
r_  generation:  0.5134150981903076
local_output_nid generation:  0.03990745544433594
local_in_edges_tensor generation:  0.04355144500732422
mini_batch_src_global generation:  0.057443857192993164
r_  generation:  0.5275416374206543
----------------------check_connections_block total spend ----------------------------- 12.318354606628418
generate_one_block  0.6426751613616943
generate_one_block  0.6376996040344238
generate_one_block  0.6372754573822021
generate_one_block  0.6312241554260254
generate_one_block  0.6343894004821777
generate_one_block  0.6403429508209229
generate_one_block  0.6230626106262207
generate_one_block  0.6316046714782715
generate_one_block  0.6374568939208984
generate_one_block  0.6354124546051025
generate_one_block  0.6409749984741211
generate_one_block  0.642725944519043
generate_one_block  0.7256741523742676
generate_one_block  0.6243727207183838
generate_one_block  0.6405313014984131
generate_one_block  0.6330065727233887
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 0.24965524673461914  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

connection checking time:  56.48720145225525
block generation total time  47.814220666885376
average batch blocks generation time:  2.988388791680336
block dataloader generation time/epoch 107.85452914237976
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 0.1461038589477539  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167306, 128])
torch.Size([166521, 256])
torch.Size([164125, 256])
torch.Size([155890, 256])
torch.Size([124222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.773715019226074  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14605283737182617  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167232, 128])
torch.Size([166427, 256])
torch.Size([164003, 256])
torch.Size([155570, 256])
torch.Size([123088, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7638955116271973  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14605045318603516  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167271, 128])
torch.Size([166454, 256])
torch.Size([164049, 256])
torch.Size([155700, 256])
torch.Size([123140, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7642440795898438  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.1461033821105957  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167281, 128])
torch.Size([166450, 256])
torch.Size([164022, 256])
torch.Size([155829, 256])
torch.Size([123948, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7727651596069336  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14609479904174805  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

torch.Size([167264, 128])
torch.Size([166455, 256])
torch.Size([164006, 256])
torch.Size([155860, 256])
torch.Size([124249, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.774280548095703  GigaBytes
Max Memory Allocated: 2.8536548614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14609241485595703  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167328, 128])
torch.Size([166515, 256])
torch.Size([164104, 256])
torch.Size([156057, 256])
torch.Size([124323, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.774183750152588  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14606857299804688  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167197, 128])
torch.Size([166380, 256])
torch.Size([164002, 256])
torch.Size([155804, 256])
torch.Size([123687, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.765434741973877  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14605045318603516  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167267, 128])
torch.Size([166454, 256])
torch.Size([164024, 256])
torch.Size([155861, 256])
torch.Size([123654, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7652692794799805  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14605188369750977  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167256, 128])
torch.Size([166400, 256])
torch.Size([163931, 256])
torch.Size([155500, 256])
torch.Size([123058, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7611351013183594  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14605140686035156  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167246, 128])
torch.Size([166393, 256])
torch.Size([163985, 256])
torch.Size([155927, 256])
torch.Size([123851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.764925003051758  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.1460862159729004  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167232, 128])
torch.Size([166404, 256])
torch.Size([164002, 256])
torch.Size([155865, 256])
torch.Size([124347, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.772718906402588  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14608335494995117  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167303, 128])
torch.Size([166473, 256])
torch.Size([163916, 256])
torch.Size([155628, 256])
torch.Size([123915, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7718348503112793  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14614439010620117  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

torch.Size([167267, 128])
torch.Size([166467, 256])
torch.Size([164055, 256])
torch.Size([155993, 256])
torch.Size([124569, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.777592182159424  GigaBytes
Max Memory Allocated: 2.853793144226074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.1460590362548828  GigaBytes
Max Memory Allocated: 2.8577470779418945  GigaBytes

torch.Size([167220, 128])
torch.Size([166340, 256])
torch.Size([163945, 256])
torch.Size([155810, 256])
torch.Size([123656, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.765742778778076  GigaBytes
Max Memory Allocated: 2.8577470779418945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.1460704803466797  GigaBytes
Max Memory Allocated: 2.8577470779418945  GigaBytes

torch.Size([167275, 128])
torch.Size([166470, 256])
torch.Size([164024, 256])
torch.Size([155722, 256])
torch.Size([123498, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.7665929794311523  GigaBytes
Max Memory Allocated: 2.8577470779418945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 0.14612054824829102  GigaBytes
Max Memory Allocated: 2.8577470779418945  GigaBytes

torch.Size([167235, 128])
torch.Size([166426, 256])
torch.Size([164006, 256])
torch.Size([155888, 256])
torch.Size([124550, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5350341796875 GB
    Memory Allocated: 2.774174213409424  GigaBytes
Max Memory Allocated: 2.8577470779418945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.24391521513462067 |0.04714153707027435 |0.006544575095176697 |8.96453857421875e-05 |0.006879299879074097 |0.0032083988189697266 |
----------------------------------------------------------pseudo_mini_loss sum 3.749821186065674
Total (block generation + training)time/epoch 112.98254704475403
Training time/epoch 5.127732515335083
Training time without block to device /epoch 4.373467922210693
Training time without total dataloading part /epoch 0.21942472457885742
load block tensor time/epoch 3.9026434421539307
block to device time/epoch 0.7542645931243896
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13099566
Number of first layer input nodes during this epoch:  2676180
