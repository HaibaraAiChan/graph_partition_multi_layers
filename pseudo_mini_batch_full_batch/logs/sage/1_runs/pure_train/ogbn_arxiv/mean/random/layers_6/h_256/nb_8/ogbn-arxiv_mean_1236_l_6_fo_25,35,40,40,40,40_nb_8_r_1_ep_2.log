Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648512855.6024542
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02488565444946289
random selection method range initialization spend 0.006604433059692383
time for parepare:  0.018590211868286133
local_output_nid generation:  0.004248857498168945
local_in_edges_tensor generation:  0.005976200103759766
mini_batch_src_global generation:  0.003328084945678711
r_  generation:  0.03824758529663086
local_output_nid generation:  0.005827426910400391
local_in_edges_tensor generation:  0.003139972686767578
mini_batch_src_global generation:  0.00439453125
r_  generation:  0.03844308853149414
local_output_nid generation:  0.005977153778076172
local_in_edges_tensor generation:  0.003155946731567383
mini_batch_src_global generation:  0.0028362274169921875
r_  generation:  0.03976297378540039
local_output_nid generation:  0.006056070327758789
local_in_edges_tensor generation:  0.0032494068145751953
mini_batch_src_global generation:  0.003030538558959961
r_  generation:  0.04008674621582031
local_output_nid generation:  0.005991458892822266
local_in_edges_tensor generation:  0.003170490264892578
mini_batch_src_global generation:  0.0030918121337890625
r_  generation:  0.04071784019470215
local_output_nid generation:  0.0060672760009765625
local_in_edges_tensor generation:  0.0032176971435546875
mini_batch_src_global generation:  0.0033257007598876953
r_  generation:  0.041736602783203125
local_output_nid generation:  0.00614476203918457
local_in_edges_tensor generation:  0.003241300582885742
mini_batch_src_global generation:  0.003368377685546875
r_  generation:  0.04141426086425781
local_output_nid generation:  0.006081104278564453
local_in_edges_tensor generation:  0.003199338912963867
mini_batch_src_global generation:  0.0034487247467041016
r_  generation:  0.0414280891418457
----------------------check_connections_block total spend ----------------------------- 0.5197651386260986
generate_one_block  0.053531646728515625
generate_one_block  0.05647158622741699
generate_one_block  0.05539202690124512
generate_one_block  0.05617928504943848
generate_one_block  0.05840921401977539
generate_one_block  0.05550122261047363
generate_one_block  0.05488920211791992
generate_one_block  0.055573463439941406
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04078936576843262
gen group dst list time:  0.015503168106079102
time for parepare:  0.01903057098388672
local_output_nid generation:  0.01337575912475586
local_in_edges_tensor generation:  0.030107975006103516
mini_batch_src_global generation:  0.030393123626708984
r_  generation:  0.2884652614593506
local_output_nid generation:  0.01813650131225586
local_in_edges_tensor generation:  0.028277158737182617
mini_batch_src_global generation:  0.03924131393432617
r_  generation:  0.3015272617340088
local_output_nid generation:  0.017887353897094727
local_in_edges_tensor generation:  0.02375650405883789
mini_batch_src_global generation:  0.03685283660888672
r_  generation:  0.3095541000366211
local_output_nid generation:  0.018111467361450195
local_in_edges_tensor generation:  0.023287534713745117
mini_batch_src_global generation:  0.03770279884338379
r_  generation:  0.3196232318878174
local_output_nid generation:  0.017946720123291016
local_in_edges_tensor generation:  0.020775556564331055
mini_batch_src_global generation:  0.03811168670654297
r_  generation:  0.3202359676361084
local_output_nid generation:  0.018169403076171875
local_in_edges_tensor generation:  0.020625829696655273
mini_batch_src_global generation:  0.03943133354187012
r_  generation:  0.31783604621887207
local_output_nid generation:  0.018111228942871094
local_in_edges_tensor generation:  0.02037954330444336
mini_batch_src_global generation:  0.03903031349182129
r_  generation:  0.31753039360046387
local_output_nid generation:  0.018198251724243164
local_in_edges_tensor generation:  0.02377939224243164
mini_batch_src_global generation:  0.03960561752319336
r_  generation:  0.3244593143463135
----------------------check_connections_block total spend ----------------------------- 3.6829168796539307
generate_one_block  0.3970527648925781
generate_one_block  0.40472936630249023
generate_one_block  0.4134345054626465
generate_one_block  0.41344332695007324
generate_one_block  0.40252208709716797
generate_one_block  0.42092204093933105
generate_one_block  0.41112470626831055
generate_one_block  0.41477274894714355
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03744959831237793
gen group dst list time:  0.03603482246398926
time for parepare:  0.018741846084594727
local_output_nid generation:  0.028711318969726562
local_in_edges_tensor generation:  0.046083927154541016
mini_batch_src_global generation:  0.04978680610656738
r_  generation:  0.5196433067321777
local_output_nid generation:  0.035082101821899414
local_in_edges_tensor generation:  0.05437779426574707
mini_batch_src_global generation:  0.060545921325683594
r_  generation:  0.5203735828399658
local_output_nid generation:  0.034682512283325195
local_in_edges_tensor generation:  0.04552149772644043
mini_batch_src_global generation:  0.057584285736083984
r_  generation:  0.536717414855957
local_output_nid generation:  0.03536367416381836
local_in_edges_tensor generation:  0.044939517974853516
mini_batch_src_global generation:  0.06441497802734375
r_  generation:  0.527188777923584
local_output_nid generation:  0.03494715690612793
local_in_edges_tensor generation:  0.039115190505981445
mini_batch_src_global generation:  0.05965757369995117
r_  generation:  0.5381500720977783
local_output_nid generation:  0.03500628471374512
local_in_edges_tensor generation:  0.035872697830200195
mini_batch_src_global generation:  0.0656123161315918
r_  generation:  0.5319342613220215
local_output_nid generation:  0.035367488861083984
local_in_edges_tensor generation:  0.040500640869140625
mini_batch_src_global generation:  0.05925154685974121
r_  generation:  0.5417895317077637
local_output_nid generation:  0.03538799285888672
local_in_edges_tensor generation:  0.04619574546813965
mini_batch_src_global generation:  0.062087059020996094
r_  generation:  0.537078857421875
----------------------check_connections_block total spend ----------------------------- 6.291667699813843
generate_one_block  0.6722817420959473
generate_one_block  0.6753354072570801
generate_one_block  0.6741788387298584
generate_one_block  0.6963412761688232
generate_one_block  0.6753835678100586
generate_one_block  0.6817207336425781
generate_one_block  0.7016863822937012
generate_one_block  0.6843039989471436
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03511953353881836
gen group dst list time:  0.04484128952026367
time for parepare:  0.018965721130371094
local_output_nid generation:  0.03335118293762207
local_in_edges_tensor generation:  0.048163652420043945
mini_batch_src_global generation:  0.05063891410827637
r_  generation:  0.5483195781707764
local_output_nid generation:  0.038385629653930664
local_in_edges_tensor generation:  0.0545809268951416
mini_batch_src_global generation:  0.06362700462341309
r_  generation:  0.5452125072479248
local_output_nid generation:  0.03829693794250488
local_in_edges_tensor generation:  0.04636526107788086
mini_batch_src_global generation:  0.06295609474182129
r_  generation:  0.5480556488037109
local_output_nid generation:  0.03817486763000488
local_in_edges_tensor generation:  0.049304962158203125
mini_batch_src_global generation:  0.05930042266845703
r_  generation:  0.5564565658569336
local_output_nid generation:  0.03888821601867676
local_in_edges_tensor generation:  0.040795326232910156
mini_batch_src_global generation:  0.060744524002075195
r_  generation:  0.5585784912109375
local_output_nid generation:  0.038402557373046875
local_in_edges_tensor generation:  0.03523516654968262
mini_batch_src_global generation:  0.060494422912597656
r_  generation:  0.5685913562774658
local_output_nid generation:  0.03835177421569824
local_in_edges_tensor generation:  0.04345130920410156
mini_batch_src_global generation:  0.0625457763671875
r_  generation:  0.5652453899383545
local_output_nid generation:  0.03826785087585449
local_in_edges_tensor generation:  0.03692936897277832
mini_batch_src_global generation:  0.061678171157836914
r_  generation:  0.574824333190918
----------------------check_connections_block total spend ----------------------------- 6.6327643394470215
generate_one_block  0.6917891502380371
generate_one_block  0.7081949710845947
generate_one_block  0.7069087028503418
generate_one_block  0.7414839267730713
generate_one_block  0.7145586013793945
generate_one_block  0.7404129505157471
generate_one_block  0.803584098815918
generate_one_block  0.7306272983551025
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049033403396606445
gen group dst list time:  0.05960273742675781
time for parepare:  0.01974034309387207
local_output_nid generation:  0.038979530334472656
local_in_edges_tensor generation:  0.05704140663146973
mini_batch_src_global generation:  0.05338263511657715
r_  generation:  0.5411562919616699
local_output_nid generation:  0.04314017295837402
local_in_edges_tensor generation:  0.06149768829345703
mini_batch_src_global generation:  0.06296372413635254
r_  generation:  0.5508222579956055
local_output_nid generation:  0.0431671142578125
local_in_edges_tensor generation:  0.0456995964050293
mini_batch_src_global generation:  0.06646442413330078
r_  generation:  0.5544173717498779
local_output_nid generation:  0.04504799842834473
local_in_edges_tensor generation:  0.06100320816040039
mini_batch_src_global generation:  0.0729362964630127
r_  generation:  0.5498871803283691
local_output_nid generation:  0.04236555099487305
local_in_edges_tensor generation:  0.05049943923950195
mini_batch_src_global generation:  0.06299662590026855
r_  generation:  0.5586247444152832
local_output_nid generation:  0.041970252990722656
local_in_edges_tensor generation:  0.03913998603820801
mini_batch_src_global generation:  0.06235003471374512
r_  generation:  0.5536813735961914
local_output_nid generation:  0.042009830474853516
local_in_edges_tensor generation:  0.04050326347351074
mini_batch_src_global generation:  0.06354141235351562
r_  generation:  0.5504746437072754
local_output_nid generation:  0.04285097122192383
local_in_edges_tensor generation:  0.037323951721191406
mini_batch_src_global generation:  0.06246542930603027
r_  generation:  0.56329345703125
----------------------check_connections_block total spend ----------------------------- 6.720700025558472
generate_one_block  0.7244982719421387
generate_one_block  0.6982331275939941
generate_one_block  0.6907057762145996
generate_one_block  0.7040121555328369
generate_one_block  0.693558931350708
generate_one_block  0.6920938491821289
generate_one_block  0.7001492977142334
generate_one_block  0.7374122142791748
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05761528015136719
gen group dst list time:  0.04906821250915527
time for parepare:  0.01928567886352539
local_output_nid generation:  0.036921024322509766
local_in_edges_tensor generation:  0.04760289192199707
mini_batch_src_global generation:  0.04650235176086426
r_  generation:  0.5058655738830566
local_output_nid generation:  0.0421748161315918
local_in_edges_tensor generation:  0.041240692138671875
mini_batch_src_global generation:  0.05809164047241211
r_  generation:  0.5103273391723633
local_output_nid generation:  0.04018688201904297
local_in_edges_tensor generation:  0.04484367370605469
mini_batch_src_global generation:  0.05871915817260742
r_  generation:  0.5094332695007324
local_output_nid generation:  0.04077625274658203
local_in_edges_tensor generation:  0.04702448844909668
mini_batch_src_global generation:  0.05932903289794922
r_  generation:  0.5091221332550049
local_output_nid generation:  0.04039764404296875
local_in_edges_tensor generation:  0.04482078552246094
mini_batch_src_global generation:  0.05859065055847168
r_  generation:  0.5121879577636719
local_output_nid generation:  0.04051947593688965
local_in_edges_tensor generation:  0.03593635559082031
mini_batch_src_global generation:  0.05958890914916992
r_  generation:  0.5162162780761719
local_output_nid generation:  0.040206193923950195
local_in_edges_tensor generation:  0.04511260986328125
mini_batch_src_global generation:  0.06286859512329102
r_  generation:  0.5252485275268555
local_output_nid generation:  0.043816328048706055
local_in_edges_tensor generation:  0.04460000991821289
mini_batch_src_global generation:  0.06010746955871582
r_  generation:  0.5088026523590088
----------------------check_connections_block total spend ----------------------------- 6.226916551589966
generate_one_block  0.6323652267456055
generate_one_block  0.6437215805053711
generate_one_block  0.6380894184112549
generate_one_block  0.6414451599121094
generate_one_block  0.6488780975341797
generate_one_block  0.6400055885314941
generate_one_block  0.6494102478027344
generate_one_block  0.6300978660583496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

connection checking time:  29.554965496063232
block generation total time  25.34147000312805
average batch blocks generation time:  3.1676837503910065
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.1406264305114746  GigaBytes
Max Memory Allocated: 0.1406264305114746  GigaBytes

torch.Size([167528, 128])
torch.Size([167088, 256])
torch.Size([165801, 256])
torch.Size([161320, 256])
torch.Size([141663, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 2.9845752716064453  GigaBytes
Max Memory Allocated: 3.044724941253662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3787841796875 GB
    Memory Allocated: 0.1463484764099121  GigaBytes
Max Memory Allocated: 3.1128530502319336  GigaBytes

torch.Size([167556, 128])
torch.Size([167107, 256])
torch.Size([165787, 256])
torch.Size([161328, 256])
torch.Size([142001, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3807373046875 GB
    Memory Allocated: 2.992447853088379  GigaBytes
Max Memory Allocated: 3.1128530502319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 0.14647722244262695  GigaBytes
Max Memory Allocated: 3.1213321685791016  GigaBytes

torch.Size([167502, 128])
torch.Size([167052, 256])
torch.Size([165723, 256])
torch.Size([161282, 256])
torch.Size([141752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 2.990222930908203  GigaBytes
Max Memory Allocated: 3.1213321685791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 0.14631366729736328  GigaBytes
Max Memory Allocated: 3.1213321685791016  GigaBytes

torch.Size([167556, 128])
torch.Size([167171, 256])
torch.Size([165883, 256])
torch.Size([161503, 256])
torch.Size([142104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 2.995314121246338  GigaBytes
Max Memory Allocated: 3.1213321685791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 0.14613056182861328  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167574, 128])
torch.Size([167156, 256])
torch.Size([165840, 256])
torch.Size([161370, 256])
torch.Size([141856, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 2.989626407623291  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 0.14632272720336914  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167549, 128])
torch.Size([167099, 256])
torch.Size([165793, 256])
torch.Size([161300, 256])
torch.Size([142103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 2.9937024116516113  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 0.1464977264404297  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167553, 128])
torch.Size([167136, 256])
torch.Size([165857, 256])
torch.Size([161497, 256])
torch.Size([142104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 2.992767333984375  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 0.14661359786987305  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167512, 128])
torch.Size([167076, 256])
torch.Size([165723, 256])
torch.Size([161200, 256])
torch.Size([142281, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 2.995608329772949  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1746770739555359 |0.09158837795257568 |0.0990055501461029 |0.00010162591934204102 |0.08876556158065796 |0.008609533309936523 |
----------------------------------------------------------pseudo_mini_loss sum 6.284274578094482
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6973691
Number of first layer input nodes during this epoch:  1340330
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.3846435546875 GB
    Memory Allocated: 0.26293230056762695  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.01832890510559082
random selection method range initialization spend 0.005028486251831055
time for parepare:  0.018430233001708984
local_output_nid generation:  0.0050852298736572266
local_in_edges_tensor generation:  0.007342815399169922
mini_batch_src_global generation:  0.003509998321533203
r_  generation:  0.03790569305419922
local_output_nid generation:  0.005938291549682617
local_in_edges_tensor generation:  0.003033161163330078
mini_batch_src_global generation:  0.00429534912109375
r_  generation:  0.03991246223449707
local_output_nid generation:  0.006043434143066406
local_in_edges_tensor generation:  0.0031516551971435547
mini_batch_src_global generation:  0.0029883384704589844
r_  generation:  0.040041446685791016
local_output_nid generation:  0.006052255630493164
local_in_edges_tensor generation:  0.003089427947998047
mini_batch_src_global generation:  0.0030012130737304688
r_  generation:  0.03981494903564453
local_output_nid generation:  0.006039142608642578
local_in_edges_tensor generation:  0.0031766891479492188
mini_batch_src_global generation:  0.003169536590576172
r_  generation:  0.04080939292907715
local_output_nid generation:  0.006048679351806641
local_in_edges_tensor generation:  0.0030891895294189453
mini_batch_src_global generation:  0.003401041030883789
r_  generation:  0.04156661033630371
local_output_nid generation:  0.006058216094970703
local_in_edges_tensor generation:  0.003121614456176758
mini_batch_src_global generation:  0.0035467147827148438
r_  generation:  0.042695045471191406
local_output_nid generation:  0.006083488464355469
local_in_edges_tensor generation:  0.0030972957611083984
mini_batch_src_global generation:  0.006999492645263672
r_  generation:  0.04639101028442383
----------------------check_connections_block total spend ----------------------------- 0.5414631366729736
generate_one_block  0.05724692344665527
generate_one_block  0.05703592300415039
generate_one_block  0.057248592376708984
generate_one_block  0.056343793869018555
generate_one_block  0.05740928649902344
generate_one_block  0.0584414005279541
generate_one_block  0.05863833427429199
generate_one_block  0.06340765953063965
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04261636734008789
gen group dst list time:  0.016259431838989258
time for parepare:  0.020763397216796875
local_output_nid generation:  0.015908479690551758
local_in_edges_tensor generation:  0.033193111419677734
mini_batch_src_global generation:  0.02866649627685547
r_  generation:  0.30598950386047363
local_output_nid generation:  0.024001121520996094
local_in_edges_tensor generation:  0.032529592514038086
mini_batch_src_global generation:  0.04517507553100586
r_  generation:  0.3406524658203125
local_output_nid generation:  0.028913497924804688
local_in_edges_tensor generation:  0.029977798461914062
mini_batch_src_global generation:  0.04036521911621094
r_  generation:  0.33766698837280273
local_output_nid generation:  0.024061918258666992
local_in_edges_tensor generation:  0.026476383209228516
mini_batch_src_global generation:  0.041017770767211914
r_  generation:  0.3385186195373535
local_output_nid generation:  0.02400660514831543
local_in_edges_tensor generation:  0.02405095100402832
mini_batch_src_global generation:  0.043143272399902344
r_  generation:  0.34285998344421387
local_output_nid generation:  0.02307868003845215
local_in_edges_tensor generation:  0.026853084564208984
mini_batch_src_global generation:  0.04399371147155762
r_  generation:  0.35578179359436035
local_output_nid generation:  0.02659749984741211
local_in_edges_tensor generation:  0.034654855728149414
mini_batch_src_global generation:  0.05005073547363281
r_  generation:  0.34268832206726074
local_output_nid generation:  0.023541688919067383
local_in_edges_tensor generation:  0.028214454650878906
mini_batch_src_global generation:  0.04427814483642578
r_  generation:  0.3435943126678467
----------------------check_connections_block total spend ----------------------------- 4.107974529266357
generate_one_block  0.41965484619140625
generate_one_block  0.4106318950653076
generate_one_block  0.4134984016418457
generate_one_block  0.4137589931488037
generate_one_block  0.42859625816345215
generate_one_block  0.41794323921203613
generate_one_block  0.4268515110015869
generate_one_block  0.4763362407684326
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03983163833618164
gen group dst list time:  0.04232478141784668
time for parepare:  0.0189511775970459
local_output_nid generation:  0.029697895050048828
local_in_edges_tensor generation:  0.0626685619354248
mini_batch_src_global generation:  0.05230283737182617
r_  generation:  0.521709680557251
local_output_nid generation:  0.03620195388793945
local_in_edges_tensor generation:  0.05498790740966797
mini_batch_src_global generation:  0.06047654151916504
r_  generation:  0.5251457691192627
local_output_nid generation:  0.0352025032043457
local_in_edges_tensor generation:  0.04545474052429199
mini_batch_src_global generation:  0.056908369064331055
r_  generation:  0.541755199432373
local_output_nid generation:  0.03535175323486328
local_in_edges_tensor generation:  0.04474639892578125
mini_batch_src_global generation:  0.06145000457763672
r_  generation:  0.5428266525268555
local_output_nid generation:  0.0353696346282959
local_in_edges_tensor generation:  0.03524971008300781
mini_batch_src_global generation:  0.05926680564880371
r_  generation:  0.5485184192657471
local_output_nid generation:  0.035523176193237305
local_in_edges_tensor generation:  0.044966697692871094
mini_batch_src_global generation:  0.06169438362121582
r_  generation:  0.5369224548339844
local_output_nid generation:  0.035201072692871094
local_in_edges_tensor generation:  0.03987431526184082
mini_batch_src_global generation:  0.05998969078063965
r_  generation:  0.5600769519805908
local_output_nid generation:  0.037305593490600586
local_in_edges_tensor generation:  0.043653249740600586
mini_batch_src_global generation:  0.06567764282226562
r_  generation:  0.5436334609985352
----------------------check_connections_block total spend ----------------------------- 6.409708738327026
generate_one_block  0.7110409736633301
generate_one_block  0.6865699291229248
generate_one_block  0.6881532669067383
generate_one_block  0.6832430362701416
generate_one_block  0.6769709587097168
generate_one_block  0.7068743705749512
generate_one_block  0.7159817218780518
generate_one_block  0.7203993797302246
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03817868232727051
gen group dst list time:  0.054750919342041016
time for parepare:  0.019469499588012695
local_output_nid generation:  0.03573465347290039
local_in_edges_tensor generation:  0.05747866630554199
mini_batch_src_global generation:  0.05467414855957031
r_  generation:  0.5449364185333252
local_output_nid generation:  0.041318655014038086
local_in_edges_tensor generation:  0.0899190902709961
mini_batch_src_global generation:  0.06391048431396484
r_  generation:  0.5531961917877197
local_output_nid generation:  0.04041934013366699
local_in_edges_tensor generation:  0.04262542724609375
mini_batch_src_global generation:  0.06383085250854492
r_  generation:  0.5668909549713135
local_output_nid generation:  0.038948774337768555
local_in_edges_tensor generation:  0.05164790153503418
mini_batch_src_global generation:  0.06293225288391113
r_  generation:  0.5637960433959961
local_output_nid generation:  0.038419246673583984
local_in_edges_tensor generation:  0.04726719856262207
mini_batch_src_global generation:  0.06118297576904297
r_  generation:  0.5707476139068604
local_output_nid generation:  0.04040384292602539
local_in_edges_tensor generation:  0.04215097427368164
mini_batch_src_global generation:  0.0653071403503418
r_  generation:  0.5942728519439697
local_output_nid generation:  0.042653799057006836
local_in_edges_tensor generation:  0.05558276176452637
mini_batch_src_global generation:  0.07047605514526367
r_  generation:  0.569969892501831
local_output_nid generation:  0.04021096229553223
local_in_edges_tensor generation:  0.04957842826843262
mini_batch_src_global generation:  0.06373190879821777
r_  generation:  0.5734117031097412
----------------------check_connections_block total spend ----------------------------- 6.841588020324707
generate_one_block  0.7252624034881592
generate_one_block  0.7243452072143555
generate_one_block  0.7183496952056885
generate_one_block  0.7141010761260986
generate_one_block  0.7157127857208252
generate_one_block  0.704242467880249
generate_one_block  0.7019174098968506
generate_one_block  0.7347569465637207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04295492172241211
gen group dst list time:  0.05939126014709473
time for parepare:  0.01879429817199707
local_output_nid generation:  0.03629016876220703
local_in_edges_tensor generation:  0.06032609939575195
mini_batch_src_global generation:  0.04929494857788086
r_  generation:  0.544339656829834
local_output_nid generation:  0.04039883613586426
local_in_edges_tensor generation:  0.04777264595031738
mini_batch_src_global generation:  0.06394028663635254
r_  generation:  0.5464944839477539
local_output_nid generation:  0.04030919075012207
local_in_edges_tensor generation:  0.052741289138793945
mini_batch_src_global generation:  0.06317925453186035
r_  generation:  0.5492620468139648
local_output_nid generation:  0.04033946990966797
local_in_edges_tensor generation:  0.03853178024291992
mini_batch_src_global generation:  0.0633702278137207
r_  generation:  0.5447249412536621
local_output_nid generation:  0.040158987045288086
local_in_edges_tensor generation:  0.04268026351928711
mini_batch_src_global generation:  0.0694589614868164
r_  generation:  0.5511541366577148
local_output_nid generation:  0.04046988487243652
local_in_edges_tensor generation:  0.08029317855834961
mini_batch_src_global generation:  0.062242746353149414
r_  generation:  0.5494472980499268
local_output_nid generation:  0.04070615768432617
local_in_edges_tensor generation:  0.04261660575866699
mini_batch_src_global generation:  0.06271982192993164
r_  generation:  0.552729606628418
local_output_nid generation:  0.04044151306152344
local_in_edges_tensor generation:  0.0590054988861084
mini_batch_src_global generation:  0.06655144691467285
r_  generation:  0.55411696434021
----------------------check_connections_block total spend ----------------------------- 6.6999831199646
generate_one_block  0.6876206398010254
generate_one_block  0.6866281032562256
generate_one_block  0.7153172492980957
generate_one_block  0.6793620586395264
generate_one_block  0.6904706954956055
generate_one_block  0.6827654838562012
generate_one_block  0.6831440925598145
generate_one_block  0.7084834575653076
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044704437255859375
gen group dst list time:  0.04990839958190918
time for parepare:  0.019144296646118164
local_output_nid generation:  0.03701186180114746
local_in_edges_tensor generation:  0.04933285713195801
mini_batch_src_global generation:  0.04521369934082031
r_  generation:  0.5059466361999512
local_output_nid generation:  0.043158531188964844
local_in_edges_tensor generation:  0.0436244010925293
mini_batch_src_global generation:  0.060176849365234375
r_  generation:  0.5202710628509521
local_output_nid generation:  0.04503631591796875
local_in_edges_tensor generation:  0.04127049446105957
mini_batch_src_global generation:  0.06012606620788574
r_  generation:  0.511390209197998
local_output_nid generation:  0.04264712333679199
local_in_edges_tensor generation:  0.039398908615112305
mini_batch_src_global generation:  0.05825328826904297
r_  generation:  0.5100345611572266
local_output_nid generation:  0.04232430458068848
local_in_edges_tensor generation:  0.04091954231262207
mini_batch_src_global generation:  0.058645009994506836
r_  generation:  0.509448766708374
local_output_nid generation:  0.04170489311218262
local_in_edges_tensor generation:  0.03940939903259277
mini_batch_src_global generation:  0.058309078216552734
r_  generation:  0.5113492012023926
local_output_nid generation:  0.04127645492553711
local_in_edges_tensor generation:  0.04101061820983887
mini_batch_src_global generation:  0.05836820602416992
r_  generation:  0.511664867401123
local_output_nid generation:  0.04154539108276367
local_in_edges_tensor generation:  0.04729485511779785
mini_batch_src_global generation:  0.057460784912109375
r_  generation:  0.5116491317749023
----------------------check_connections_block total spend ----------------------------- 6.20661187171936
generate_one_block  0.662405252456665
generate_one_block  0.6431491374969482
generate_one_block  0.6536407470703125
generate_one_block  0.6308224201202393
generate_one_block  0.6367316246032715
generate_one_block  0.6470780372619629
generate_one_block  0.6355602741241455
generate_one_block  0.6456201076507568
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.3846435546875 GB
    Memory Allocated: 0.26293230056762695  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

connection checking time:  30.26586627960205
block generation total time  25.423992395401
average batch blocks generation time:  3.177999049425125
block dataloader generation time/epoch 58.65879154205322
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3846435546875 GB
    Memory Allocated: 0.15108585357666016  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167560, 128])
torch.Size([167095, 256])
torch.Size([165812, 256])
torch.Size([161418, 256])
torch.Size([141859, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3846435546875 GB
    Memory Allocated: 2.9958128929138184  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.15108680725097656  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167568, 128])
torch.Size([167131, 256])
torch.Size([165876, 256])
torch.Size([161404, 256])
torch.Size([141720, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 2.99526309967041  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.15109777450561523  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

torch.Size([167589, 128])
torch.Size([167136, 256])
torch.Size([165838, 256])
torch.Size([161398, 256])
torch.Size([142662, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 3.0030136108398438  GigaBytes
Max Memory Allocated: 3.1255507469177246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.15096807479858398  GigaBytes
Max Memory Allocated: 3.132230758666992  GigaBytes

torch.Size([167537, 128])
torch.Size([167074, 256])
torch.Size([165886, 256])
torch.Size([161497, 256])
torch.Size([141973, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 2.994480609893799  GigaBytes
Max Memory Allocated: 3.132230758666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.1507115364074707  GigaBytes
Max Memory Allocated: 3.132230758666992  GigaBytes

torch.Size([167614, 128])
torch.Size([167131, 256])
torch.Size([165871, 256])
torch.Size([161423, 256])
torch.Size([141763, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 2.993133068084717  GigaBytes
Max Memory Allocated: 3.132230758666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.15110349655151367  GigaBytes
Max Memory Allocated: 3.132230758666992  GigaBytes

torch.Size([167553, 128])
torch.Size([167094, 256])
torch.Size([165800, 256])
torch.Size([161354, 256])
torch.Size([142341, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 3.0030202865600586  GigaBytes
Max Memory Allocated: 3.132230758666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.1511220932006836  GigaBytes
Max Memory Allocated: 3.1322765350341797  GigaBytes

torch.Size([167545, 128])
torch.Size([167085, 256])
torch.Size([165806, 256])
torch.Size([161364, 256])
torch.Size([141994, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 2.9985289573669434  GigaBytes
Max Memory Allocated: 3.1322765350341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 0.151123046875  GigaBytes
Max Memory Allocated: 3.1322765350341797  GigaBytes

torch.Size([167566, 128])
torch.Size([167122, 256])
torch.Size([165874, 256])
torch.Size([161405, 256])
torch.Size([142090, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3865966796875 GB
    Memory Allocated: 2.9994797706604004  GigaBytes
Max Memory Allocated: 3.1322765350341797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.25484612584114075 |0.050642579793930054 |0.009396880865097046 |9.113550186157227e-05 |0.006921559572219849 |0.005718231201171875 |
----------------------------------------------------------pseudo_mini_loss sum 3.7893056869506836
Total (block generation + training)time/epoch 61.516146183013916
Training time/epoch 2.8570358753204346
Training time without block to device /epoch 2.451895236968994
Training time without total dataloading part /epoch 0.1369948387145996
load block tensor time/epoch 2.038769006729126
block to device time/epoch 0.40514063835144043
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6974730
Number of first layer input nodes during this epoch:  1340532
