Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648442969.905252
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026548147201538086
random selection method range initialization spend 0.0062024593353271484
time for parepare:  0.019116878509521484
local_output_nid generation:  0.0022003650665283203
local_in_edges_tensor generation:  0.003974199295043945
mini_batch_src_global generation:  0.0019576549530029297
r_  generation:  0.02103114128112793
local_output_nid generation:  0.0029408931732177734
local_in_edges_tensor generation:  0.0017216205596923828
mini_batch_src_global generation:  0.002360105514526367
r_  generation:  0.02079916000366211
local_output_nid generation:  0.002987384796142578
local_in_edges_tensor generation:  0.0015976428985595703
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.020763874053955078
local_output_nid generation:  0.002986431121826172
local_in_edges_tensor generation:  0.0015687942504882812
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.020212888717651367
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0016236305236816406
mini_batch_src_global generation:  0.0015575885772705078
r_  generation:  0.021373748779296875
local_output_nid generation:  0.0030455589294433594
local_in_edges_tensor generation:  0.0016145706176757812
mini_batch_src_global generation:  0.001626729965209961
r_  generation:  0.022049427032470703
local_output_nid generation:  0.003011465072631836
local_in_edges_tensor generation:  0.00152587890625
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.021948575973510742
local_output_nid generation:  0.003010272979736328
local_in_edges_tensor generation:  0.0015690326690673828
mini_batch_src_global generation:  0.0017485618591308594
r_  generation:  0.022746801376342773
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.0015604496002197266
mini_batch_src_global generation:  0.0016994476318359375
r_  generation:  0.021807432174682617
local_output_nid generation:  0.003036022186279297
local_in_edges_tensor generation:  0.0015835762023925781
mini_batch_src_global generation:  0.0017049312591552734
r_  generation:  0.02219390869140625
local_output_nid generation:  0.003084421157836914
local_in_edges_tensor generation:  0.0015494823455810547
mini_batch_src_global generation:  0.0017957687377929688
r_  generation:  0.022379398345947266
local_output_nid generation:  0.003036975860595703
local_in_edges_tensor generation:  0.0015592575073242188
mini_batch_src_global generation:  0.0017750263214111328
r_  generation:  0.022295236587524414
local_output_nid generation:  0.0030312538146972656
local_in_edges_tensor generation:  0.001577615737915039
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.022753238677978516
local_output_nid generation:  0.003038167953491211
local_in_edges_tensor generation:  0.0015616416931152344
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.021932601928710938
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0015492439270019531
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.022646427154541016
local_output_nid generation:  0.0030257701873779297
local_in_edges_tensor generation:  0.001556396484375
mini_batch_src_global generation:  0.0017926692962646484
r_  generation:  0.02251434326171875
----------------------check_connections_block total spend ----------------------------- 0.5598368644714355
generate_one_block  0.031135082244873047
generate_one_block  0.03208327293395996
generate_one_block  0.03359246253967285
generate_one_block  0.031000137329101562
generate_one_block  0.03157186508178711
generate_one_block  0.03212904930114746
generate_one_block  0.032338857650756836
generate_one_block  0.032918453216552734
generate_one_block  0.03151893615722656
generate_one_block  0.03171396255493164
generate_one_block  0.031862735748291016
generate_one_block  0.03214120864868164
generate_one_block  0.03257012367248535
generate_one_block  0.03108525276184082
generate_one_block  0.03159785270690918
generate_one_block  0.03220486640930176
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04260563850402832
gen group dst list time:  0.020997285842895508
time for parepare:  0.019311904907226562
local_output_nid generation:  0.009199857711791992
local_in_edges_tensor generation:  0.02104043960571289
mini_batch_src_global generation:  0.026908397674560547
r_  generation:  0.24938416481018066
local_output_nid generation:  0.013311147689819336
local_in_edges_tensor generation:  0.023506641387939453
mini_batch_src_global generation:  0.03204488754272461
r_  generation:  0.25952982902526855
local_output_nid generation:  0.012613296508789062
local_in_edges_tensor generation:  0.02279829978942871
mini_batch_src_global generation:  0.03019881248474121
r_  generation:  0.26288294792175293
local_output_nid generation:  0.012746572494506836
local_in_edges_tensor generation:  0.018268823623657227
mini_batch_src_global generation:  0.031330108642578125
r_  generation:  0.2660493850708008
local_output_nid generation:  0.016852617263793945
local_in_edges_tensor generation:  0.019437074661254883
mini_batch_src_global generation:  0.033321380615234375
r_  generation:  0.276721715927124
local_output_nid generation:  0.013046979904174805
local_in_edges_tensor generation:  0.018976211547851562
mini_batch_src_global generation:  0.03681540489196777
r_  generation:  0.27701234817504883
local_output_nid generation:  0.014150857925415039
local_in_edges_tensor generation:  0.024746417999267578
mini_batch_src_global generation:  0.03740048408508301
r_  generation:  0.28085994720458984
local_output_nid generation:  0.015647172927856445
local_in_edges_tensor generation:  0.019652366638183594
mini_batch_src_global generation:  0.03688931465148926
r_  generation:  0.27550387382507324
local_output_nid generation:  0.013471841812133789
local_in_edges_tensor generation:  0.016579151153564453
mini_batch_src_global generation:  0.034899234771728516
r_  generation:  0.2683243751525879
local_output_nid generation:  0.013454675674438477
local_in_edges_tensor generation:  0.014128446578979492
mini_batch_src_global generation:  0.03691554069519043
r_  generation:  0.27242255210876465
local_output_nid generation:  0.013298988342285156
local_in_edges_tensor generation:  0.019388675689697266
mini_batch_src_global generation:  0.03559279441833496
r_  generation:  0.27506518363952637
local_output_nid generation:  0.013740301132202148
local_in_edges_tensor generation:  0.01943039894104004
mini_batch_src_global generation:  0.035416603088378906
r_  generation:  0.2768096923828125
local_output_nid generation:  0.013554573059082031
local_in_edges_tensor generation:  0.016997098922729492
mini_batch_src_global generation:  0.03506612777709961
r_  generation:  0.2770824432373047
local_output_nid generation:  0.013197898864746094
local_in_edges_tensor generation:  0.013951778411865234
mini_batch_src_global generation:  0.0344233512878418
r_  generation:  0.2819535732269287
local_output_nid generation:  0.013340473175048828
local_in_edges_tensor generation:  0.014628171920776367
mini_batch_src_global generation:  0.04032158851623535
r_  generation:  0.27518248558044434
local_output_nid generation:  0.014539718627929688
local_in_edges_tensor generation:  0.03142571449279785
mini_batch_src_global generation:  0.03584146499633789
r_  generation:  0.279998779296875
----------------------check_connections_block total spend ----------------------------- 6.401808977127075
generate_one_block  0.35985803604125977
generate_one_block  0.3494906425476074
generate_one_block  0.34187817573547363
generate_one_block  0.35229969024658203
generate_one_block  0.3774833679199219
generate_one_block  0.3566548824310303
generate_one_block  0.3581972122192383
generate_one_block  0.36545252799987793
generate_one_block  0.3623182773590088
generate_one_block  0.36337900161743164
generate_one_block  0.3655660152435303
generate_one_block  0.3680562973022461
generate_one_block  0.37548041343688965
generate_one_block  0.34760618209838867
generate_one_block  0.3983597755432129
generate_one_block  0.3633556365966797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.082366943359375
gen group dst list time:  0.07184195518493652
time for parepare:  0.02124309539794922
local_output_nid generation:  0.027569055557250977
local_in_edges_tensor generation:  0.06409716606140137
mini_batch_src_global generation:  0.05110979080200195
r_  generation:  0.5223987102508545
local_output_nid generation:  0.03310847282409668
local_in_edges_tensor generation:  0.06067013740539551
mini_batch_src_global generation:  0.06343555450439453
r_  generation:  0.5331802368164062
local_output_nid generation:  0.03357982635498047
local_in_edges_tensor generation:  0.03945326805114746
mini_batch_src_global generation:  0.06798744201660156
r_  generation:  0.5559380054473877
local_output_nid generation:  0.035329341888427734
local_in_edges_tensor generation:  0.04442000389099121
mini_batch_src_global generation:  0.06499052047729492
r_  generation:  0.5370049476623535
local_output_nid generation:  0.03334784507751465
local_in_edges_tensor generation:  0.04512786865234375
mini_batch_src_global generation:  0.06516456604003906
r_  generation:  0.5434224605560303
local_output_nid generation:  0.03354167938232422
local_in_edges_tensor generation:  0.03489875793457031
mini_batch_src_global generation:  0.06131339073181152
r_  generation:  0.5636439323425293
local_output_nid generation:  0.03391695022583008
local_in_edges_tensor generation:  0.03551626205444336
mini_batch_src_global generation:  0.0631706714630127
r_  generation:  0.5470304489135742
local_output_nid generation:  0.033555030822753906
local_in_edges_tensor generation:  0.048995018005371094
mini_batch_src_global generation:  0.06130051612854004
r_  generation:  0.560232400894165
local_output_nid generation:  0.03336286544799805
local_in_edges_tensor generation:  0.034680843353271484
mini_batch_src_global generation:  0.06302642822265625
r_  generation:  0.544424295425415
local_output_nid generation:  0.03329181671142578
local_in_edges_tensor generation:  0.03491640090942383
mini_batch_src_global generation:  0.06218910217285156
r_  generation:  0.5423266887664795
local_output_nid generation:  0.03348684310913086
local_in_edges_tensor generation:  0.03941535949707031
mini_batch_src_global generation:  0.061911582946777344
r_  generation:  0.5504703521728516
local_output_nid generation:  0.0334012508392334
local_in_edges_tensor generation:  0.06318473815917969
mini_batch_src_global generation:  0.06304574012756348
r_  generation:  0.5452084541320801
local_output_nid generation:  0.033197879791259766
local_in_edges_tensor generation:  0.03185606002807617
mini_batch_src_global generation:  0.06259894371032715
r_  generation:  0.5495920181274414
local_output_nid generation:  0.034234046936035156
local_in_edges_tensor generation:  0.03287768363952637
mini_batch_src_global generation:  0.08206057548522949
r_  generation:  0.5448448657989502
local_output_nid generation:  0.03535652160644531
local_in_edges_tensor generation:  0.04993438720703125
mini_batch_src_global generation:  0.06749892234802246
r_  generation:  0.5421910285949707
local_output_nid generation:  0.03359174728393555
local_in_edges_tensor generation:  0.04114890098571777
mini_batch_src_global generation:  0.06316184997558594
r_  generation:  0.5484848022460938
----------------------check_connections_block total spend ----------------------------- 12.916744947433472
generate_one_block  0.6877701282501221
generate_one_block  0.6857588291168213
generate_one_block  0.6841773986816406
generate_one_block  0.6990182399749756
generate_one_block  0.7024202346801758
generate_one_block  0.6903283596038818
generate_one_block  0.7317540645599365
generate_one_block  0.7021317481994629
generate_one_block  0.6834814548492432
generate_one_block  0.6793088912963867
generate_one_block  0.6979761123657227
generate_one_block  0.7049379348754883
generate_one_block  0.6784923076629639
generate_one_block  0.7001199722290039
generate_one_block  0.6950266361236572
generate_one_block  0.6946227550506592
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  19.318553924560547
block generation total time  16.92276120185852
average batch blocks generation time:  1.0576725751161575
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09549808502197266  GigaBytes
Max Memory Allocated: 0.09549808502197266  GigaBytes

torch.Size([157685, 128])
torch.Size([130168, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.47642946243286133  GigaBytes
Max Memory Allocated: 0.49607086181640625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.09804153442382812  GigaBytes
Max Memory Allocated: 0.5198702812194824  GigaBytes

torch.Size([157732, 128])
torch.Size([130073, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4772310256958008  GigaBytes
Max Memory Allocated: 0.5198702812194824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09666204452514648  GigaBytes
Max Memory Allocated: 0.520268440246582  GigaBytes

torch.Size([157203, 128])
torch.Size([129065, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47316503524780273  GigaBytes
Max Memory Allocated: 0.520268440246582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09682369232177734  GigaBytes
Max Memory Allocated: 0.520268440246582  GigaBytes

torch.Size([157372, 128])
torch.Size([129382, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4743785858154297  GigaBytes
Max Memory Allocated: 0.520268440246582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09711122512817383  GigaBytes
Max Memory Allocated: 0.520268440246582  GigaBytes

torch.Size([157577, 128])
torch.Size([129998, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47952747344970703  GigaBytes
Max Memory Allocated: 0.520268440246582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09707975387573242  GigaBytes
Max Memory Allocated: 0.5231842994689941  GigaBytes

torch.Size([157621, 128])
torch.Size([130080, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4780716896057129  GigaBytes
Max Memory Allocated: 0.5231842994689941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09708166122436523  GigaBytes
Max Memory Allocated: 0.5231842994689941  GigaBytes

torch.Size([157471, 128])
torch.Size([129653, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47901010513305664  GigaBytes
Max Memory Allocated: 0.5231842994689941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09722042083740234  GigaBytes
Max Memory Allocated: 0.5231842994689941  GigaBytes

torch.Size([157566, 128])
torch.Size([130075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4801626205444336  GigaBytes
Max Memory Allocated: 0.5231842994689941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09701347351074219  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157576, 128])
torch.Size([129571, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47592782974243164  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09698247909545898  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157321, 128])
torch.Size([129454, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47881412506103516  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09708356857299805  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157425, 128])
torch.Size([129717, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4785737991333008  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.0971994400024414  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157666, 128])
torch.Size([130290, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4797987937927246  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09708356857299805  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157435, 128])
torch.Size([129656, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4790463447570801  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09795951843261719  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157725, 128])
torch.Size([130246, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4765763282775879  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09812164306640625  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157739, 128])
torch.Size([130091, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4802837371826172  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09721231460571289  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157593, 128])
torch.Size([130316, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47999143600463867  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035799115896224976 |0.04022853076457977 |0.0489073246717453 |0.00010435283184051514 |0.00654996931552887 |0.004094839096069336 |
----------------------------------------------------------pseudo_mini_loss sum 5.631052494049072
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5328199
Number of first layer input nodes during this epoch:  2520707
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.12689876556396484  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021972179412841797
random selection method range initialization spend 0.005777597427368164
time for parepare:  0.017900705337524414
local_output_nid generation:  0.0023810863494873047
local_in_edges_tensor generation:  0.007016420364379883
mini_batch_src_global generation:  0.0023627281188964844
r_  generation:  0.02253437042236328
local_output_nid generation:  0.0029768943786621094
local_in_edges_tensor generation:  0.0017311573028564453
mini_batch_src_global generation:  0.0027382373809814453
r_  generation:  0.022800683975219727
local_output_nid generation:  0.0029380321502685547
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.0018718242645263672
r_  generation:  0.02111959457397461
local_output_nid generation:  0.0029473304748535156
local_in_edges_tensor generation:  0.0016560554504394531
mini_batch_src_global generation:  0.0015575885772705078
r_  generation:  0.021052122116088867
local_output_nid generation:  0.0029306411743164062
local_in_edges_tensor generation:  0.0015878677368164062
mini_batch_src_global generation:  0.0015211105346679688
r_  generation:  0.021209001541137695
local_output_nid generation:  0.0029435157775878906
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.0016503334045410156
r_  generation:  0.02082991600036621
local_output_nid generation:  0.002917051315307617
local_in_edges_tensor generation:  0.0016508102416992188
mini_batch_src_global generation:  0.0016663074493408203
r_  generation:  0.022582054138183594
local_output_nid generation:  0.0030095577239990234
local_in_edges_tensor generation:  0.0017054080963134766
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.022197246551513672
local_output_nid generation:  0.0030291080474853516
local_in_edges_tensor generation:  0.0016632080078125
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.02148294448852539
local_output_nid generation:  0.0029489994049072266
local_in_edges_tensor generation:  0.0016889572143554688
mini_batch_src_global generation:  0.0017075538635253906
r_  generation:  0.022182703018188477
local_output_nid generation:  0.0029571056365966797
local_in_edges_tensor generation:  0.0017039775848388672
mini_batch_src_global generation:  0.0017344951629638672
r_  generation:  0.022025108337402344
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0016489028930664062
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.021890640258789062
local_output_nid generation:  0.003016233444213867
local_in_edges_tensor generation:  0.0017316341400146484
mini_batch_src_global generation:  0.001737356185913086
r_  generation:  0.0232851505279541
local_output_nid generation:  0.0029850006103515625
local_in_edges_tensor generation:  0.0016782283782958984
mini_batch_src_global generation:  0.0017960071563720703
r_  generation:  0.022512197494506836
local_output_nid generation:  0.003024578094482422
local_in_edges_tensor generation:  0.0016436576843261719
mini_batch_src_global generation:  0.0017576217651367188
r_  generation:  0.023595809936523438
local_output_nid generation:  0.003010272979736328
local_in_edges_tensor generation:  0.0016827583312988281
mini_batch_src_global generation:  0.0017609596252441406
r_  generation:  0.023302555084228516
----------------------check_connections_block total spend ----------------------------- 0.5747385025024414
generate_one_block  0.039026737213134766
generate_one_block  0.031450510025024414
generate_one_block  0.031461477279663086
generate_one_block  0.031141042709350586
generate_one_block  0.0313265323638916
generate_one_block  0.03356003761291504
generate_one_block  0.032843589782714844
generate_one_block  0.03210783004760742
generate_one_block  0.03143882751464844
generate_one_block  0.031911611557006836
generate_one_block  0.03104233741760254
generate_one_block  0.030863285064697266
generate_one_block  0.03188920021057129
generate_one_block  0.032578468322753906
generate_one_block  0.03148841857910156
generate_one_block  0.032935380935668945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04125380516052246
gen group dst list time:  0.019558191299438477
time for parepare:  0.019503116607666016
local_output_nid generation:  0.009339570999145508
local_in_edges_tensor generation:  0.025369644165039062
mini_batch_src_global generation:  0.02527165412902832
r_  generation:  0.25760912895202637
local_output_nid generation:  0.015314817428588867
local_in_edges_tensor generation:  0.02260136604309082
mini_batch_src_global generation:  0.03173542022705078
r_  generation:  0.25519633293151855
local_output_nid generation:  0.01595783233642578
local_in_edges_tensor generation:  0.021140098571777344
mini_batch_src_global generation:  0.031388044357299805
r_  generation:  0.270261287689209
local_output_nid generation:  0.015727996826171875
local_in_edges_tensor generation:  0.016327857971191406
mini_batch_src_global generation:  0.03244161605834961
r_  generation:  0.27243924140930176
local_output_nid generation:  0.015499114990234375
local_in_edges_tensor generation:  0.016504287719726562
mini_batch_src_global generation:  0.03517341613769531
r_  generation:  0.27825331687927246
local_output_nid generation:  0.016462326049804688
local_in_edges_tensor generation:  0.020427465438842773
mini_batch_src_global generation:  0.033899784088134766
r_  generation:  0.2840766906738281
local_output_nid generation:  0.017863988876342773
local_in_edges_tensor generation:  0.020672082901000977
mini_batch_src_global generation:  0.03671598434448242
r_  generation:  0.27893757820129395
local_output_nid generation:  0.015768051147460938
local_in_edges_tensor generation:  0.02024555206298828
mini_batch_src_global generation:  0.036962032318115234
r_  generation:  0.2713303565979004
local_output_nid generation:  0.015635251998901367
local_in_edges_tensor generation:  0.01479959487915039
mini_batch_src_global generation:  0.034098148345947266
r_  generation:  0.28188538551330566
local_output_nid generation:  0.015770912170410156
local_in_edges_tensor generation:  0.016020774841308594
mini_batch_src_global generation:  0.03655242919921875
r_  generation:  0.2810826301574707
local_output_nid generation:  0.015449285507202148
local_in_edges_tensor generation:  0.01590728759765625
mini_batch_src_global generation:  0.03379940986633301
r_  generation:  0.2728147506713867
local_output_nid generation:  0.015221118927001953
local_in_edges_tensor generation:  0.013731002807617188
mini_batch_src_global generation:  0.03635692596435547
r_  generation:  0.275984525680542
local_output_nid generation:  0.01578831672668457
local_in_edges_tensor generation:  0.018995285034179688
mini_batch_src_global generation:  0.03449654579162598
r_  generation:  0.2776913642883301
local_output_nid generation:  0.013992547988891602
local_in_edges_tensor generation:  0.02284073829650879
mini_batch_src_global generation:  0.03508424758911133
r_  generation:  0.2756187915802002
local_output_nid generation:  0.013353109359741211
local_in_edges_tensor generation:  0.0140533447265625
mini_batch_src_global generation:  0.04520010948181152
r_  generation:  0.27445507049560547
local_output_nid generation:  0.014703035354614258
local_in_edges_tensor generation:  0.021538496017456055
mini_batch_src_global generation:  0.03534221649169922
r_  generation:  0.2790412902832031
----------------------check_connections_block total spend ----------------------------- 6.441071271896362
generate_one_block  0.3619098663330078
generate_one_block  0.3426930904388428
generate_one_block  0.3600032329559326
generate_one_block  0.35875821113586426
generate_one_block  0.3566584587097168
generate_one_block  0.3414487838745117
generate_one_block  0.3959634304046631
generate_one_block  0.3564600944519043
generate_one_block  0.3597419261932373
generate_one_block  0.3641033172607422
generate_one_block  0.3429121971130371
generate_one_block  0.34766340255737305
generate_one_block  0.3667783737182617
generate_one_block  0.36298274993896484
generate_one_block  0.34853482246398926
generate_one_block  0.3596625328063965
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05303144454956055
gen group dst list time:  0.06341052055358887
time for parepare:  0.018325328826904297
local_output_nid generation:  0.02705097198486328
local_in_edges_tensor generation:  0.05605196952819824
mini_batch_src_global generation:  0.05403017997741699
r_  generation:  0.5154120922088623
local_output_nid generation:  0.03249835968017578
local_in_edges_tensor generation:  0.0535123348236084
mini_batch_src_global generation:  0.06360554695129395
r_  generation:  0.5298295021057129
local_output_nid generation:  0.03446388244628906
local_in_edges_tensor generation:  0.052056312561035156
mini_batch_src_global generation:  0.06482791900634766
r_  generation:  0.5529570579528809
local_output_nid generation:  0.03516268730163574
local_in_edges_tensor generation:  0.047423362731933594
mini_batch_src_global generation:  0.07117104530334473
r_  generation:  0.5367431640625
local_output_nid generation:  0.03418326377868652
local_in_edges_tensor generation:  0.10702347755432129
mini_batch_src_global generation:  0.06107521057128906
r_  generation:  0.5425281524658203
local_output_nid generation:  0.03241419792175293
local_in_edges_tensor generation:  0.03544330596923828
mini_batch_src_global generation:  0.06102871894836426
r_  generation:  0.549968957901001
local_output_nid generation:  0.032654523849487305
local_in_edges_tensor generation:  0.04396319389343262
mini_batch_src_global generation:  0.06103706359863281
r_  generation:  0.5477354526519775
local_output_nid generation:  0.032788991928100586
local_in_edges_tensor generation:  0.034828901290893555
mini_batch_src_global generation:  0.061794281005859375
r_  generation:  0.5413188934326172
local_output_nid generation:  0.03252124786376953
local_in_edges_tensor generation:  0.03479886054992676
mini_batch_src_global generation:  0.06201457977294922
r_  generation:  0.5434131622314453
local_output_nid generation:  0.03280210494995117
local_in_edges_tensor generation:  0.039402008056640625
mini_batch_src_global generation:  0.06584000587463379
r_  generation:  0.5444252490997314
local_output_nid generation:  0.03265786170959473
local_in_edges_tensor generation:  0.03950667381286621
mini_batch_src_global generation:  0.06186819076538086
r_  generation:  0.5469505786895752
local_output_nid generation:  0.03264594078063965
local_in_edges_tensor generation:  0.034887075424194336
mini_batch_src_global generation:  0.06252074241638184
r_  generation:  0.5442273616790771
local_output_nid generation:  0.03264021873474121
local_in_edges_tensor generation:  0.044385671615600586
mini_batch_src_global generation:  0.061600685119628906
r_  generation:  0.5468251705169678
local_output_nid generation:  0.03256869316101074
local_in_edges_tensor generation:  0.04422736167907715
mini_batch_src_global generation:  0.06312394142150879
r_  generation:  0.546363115310669
local_output_nid generation:  0.03271317481994629
local_in_edges_tensor generation:  0.03497171401977539
mini_batch_src_global generation:  0.06257963180541992
r_  generation:  0.5454185009002686
local_output_nid generation:  0.03378558158874512
local_in_edges_tensor generation:  0.0528721809387207
mini_batch_src_global generation:  0.06345200538635254
r_  generation:  0.5426735877990723
----------------------check_connections_block total spend ----------------------------- 12.882444143295288
generate_one_block  0.6947438716888428
generate_one_block  0.679764986038208
generate_one_block  0.7071959972381592
generate_one_block  0.6876766681671143
generate_one_block  0.7197940349578857
generate_one_block  0.6879923343658447
generate_one_block  0.6880414485931396
generate_one_block  0.6888422966003418
generate_one_block  0.7189922332763672
generate_one_block  0.6938226222991943
generate_one_block  0.6931092739105225
generate_one_block  0.6858227252960205
generate_one_block  0.69124436378479
generate_one_block  0.6964592933654785
generate_one_block  0.6770162582397461
generate_one_block  0.6988387107849121
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.12689876556396484  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

connection checking time:  19.32351541519165
block generation total time  16.835631608963013
average batch blocks generation time:  1.0522269755601883
block dataloader generation time/epoch 38.52933979034424
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.0977015495300293  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157520, 128])
torch.Size([129610, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4798288345336914  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09740495681762695  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157497, 128])
torch.Size([129435, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4756765365600586  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09772062301635742  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157569, 128])
torch.Size([130191, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4794807434082031  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.0974578857421875  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157164, 128])
torch.Size([129435, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4780287742614746  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09870338439941406  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157757, 128])
torch.Size([130188, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4795551300048828  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09754657745361328  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157674, 128])
torch.Size([129664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4757866859436035  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09769725799560547  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157352, 128])
torch.Size([129567, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.48029518127441406  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09869003295898438  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

torch.Size([157749, 128])
torch.Size([129761, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.481015682220459  GigaBytes
Max Memory Allocated: 0.524139404296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.0973811149597168  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157387, 128])
torch.Size([129475, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47571516036987305  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.0975642204284668  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157137, 128])
torch.Size([129866, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.48015546798706055  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.0975499153137207  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157651, 128])
torch.Size([129765, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47638416290283203  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09757852554321289  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157621, 128])
torch.Size([129651, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4765186309814453  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09763383865356445  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157415, 128])
torch.Size([129880, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47966623306274414  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09876632690429688  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157889, 128])
torch.Size([130421, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.48092174530029297  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09856605529785156  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157733, 128])
torch.Size([129612, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.47667932510375977  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.09779548645019531  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

torch.Size([157624, 128])
torch.Size([130328, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4809131622314453  GigaBytes
Max Memory Allocated: 0.5246162414550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030005604028701782 |0.013440728187561035 |0.0035457462072372437 |9.271502494812012e-05 |0.004994198679924011 |0.0028786659240722656 |
----------------------------------------------------------pseudo_mini_loss sum 3.589430332183838
Total (block generation + training)time/epoch 39.40100026130676
Training time/epoch 0.8714179992675781
Training time without block to device /epoch 0.6563663482666016
Training time without total dataloading part /epoch 0.14100122451782227
load block tensor time/epoch 0.4800896644592285
block to device time/epoch 0.21505165100097656
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5327354
Number of first layer input nodes during this epoch:  2520739
