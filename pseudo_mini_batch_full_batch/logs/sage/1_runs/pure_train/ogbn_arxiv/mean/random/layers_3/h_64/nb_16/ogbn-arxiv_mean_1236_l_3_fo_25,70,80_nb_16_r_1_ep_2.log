Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648440435.4248862
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02755904197692871
random selection method range initialization spend 0.0064394474029541016
time for parepare:  0.018723726272583008
local_output_nid generation:  0.002125263214111328
local_in_edges_tensor generation:  0.005007028579711914
mini_batch_src_global generation:  0.002026081085205078
r_  generation:  0.020534038543701172
local_output_nid generation:  0.002564668655395508
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0024347305297851562
r_  generation:  0.020409107208251953
local_output_nid generation:  0.0028350353240966797
local_in_edges_tensor generation:  0.0015897750854492188
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.020725250244140625
local_output_nid generation:  0.002899169921875
local_in_edges_tensor generation:  0.0015997886657714844
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.02019333839416504
local_output_nid generation:  0.0029146671295166016
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.0016088485717773438
r_  generation:  0.020153045654296875
local_output_nid generation:  0.0029172897338867188
local_in_edges_tensor generation:  0.0015153884887695312
mini_batch_src_global generation:  0.0016558170318603516
r_  generation:  0.020556926727294922
local_output_nid generation:  0.002880573272705078
local_in_edges_tensor generation:  0.0014448165893554688
mini_batch_src_global generation:  0.001638174057006836
r_  generation:  0.02049541473388672
local_output_nid generation:  0.002844095230102539
local_in_edges_tensor generation:  0.0014710426330566406
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.02141118049621582
local_output_nid generation:  0.0028672218322753906
local_in_edges_tensor generation:  0.0015261173248291016
mini_batch_src_global generation:  0.001695394515991211
r_  generation:  0.02154374122619629
local_output_nid generation:  0.002944469451904297
local_in_edges_tensor generation:  0.0014948844909667969
mini_batch_src_global generation:  0.0017354488372802734
r_  generation:  0.02138495445251465
local_output_nid generation:  0.002925872802734375
local_in_edges_tensor generation:  0.0015511512756347656
mini_batch_src_global generation:  0.0018112659454345703
r_  generation:  0.021944046020507812
local_output_nid generation:  0.0029647350311279297
local_in_edges_tensor generation:  0.001470804214477539
mini_batch_src_global generation:  0.0017154216766357422
r_  generation:  0.021462678909301758
local_output_nid generation:  0.0028820037841796875
local_in_edges_tensor generation:  0.0014116764068603516
mini_batch_src_global generation:  0.001725912094116211
r_  generation:  0.021721601486206055
local_output_nid generation:  0.002876758575439453
local_in_edges_tensor generation:  0.0014872550964355469
mini_batch_src_global generation:  0.001678466796875
r_  generation:  0.021477460861206055
local_output_nid generation:  0.0029201507568359375
local_in_edges_tensor generation:  0.0014715194702148438
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.02105855941772461
local_output_nid generation:  0.002907991409301758
local_in_edges_tensor generation:  0.0014927387237548828
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.021353960037231445
----------------------check_connections_block total spend ----------------------------- 0.5409555435180664
generate_one_block  0.031197071075439453
generate_one_block  0.031734466552734375
generate_one_block  0.034253597259521484
generate_one_block  0.03139352798461914
generate_one_block  0.030124902725219727
generate_one_block  0.030490875244140625
generate_one_block  0.03087639808654785
generate_one_block  0.032157182693481445
generate_one_block  0.03191375732421875
generate_one_block  0.030833721160888672
generate_one_block  0.03174924850463867
generate_one_block  0.030853748321533203
generate_one_block  0.03174185752868652
generate_one_block  0.03067326545715332
generate_one_block  0.030889034271240234
generate_one_block  0.03102850914001465
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042597293853759766
gen group dst list time:  0.020817279815673828
time for parepare:  0.019948482513427734
local_output_nid generation:  0.0091705322265625
local_in_edges_tensor generation:  0.02273273468017578
mini_batch_src_global generation:  0.027798175811767578
r_  generation:  0.2556462287902832
local_output_nid generation:  0.01596522331237793
local_in_edges_tensor generation:  0.024568557739257812
mini_batch_src_global generation:  0.03178572654724121
r_  generation:  0.25975632667541504
local_output_nid generation:  0.01596665382385254
local_in_edges_tensor generation:  0.019051313400268555
mini_batch_src_global generation:  0.03127264976501465
r_  generation:  0.2630443572998047
local_output_nid generation:  0.01584482192993164
local_in_edges_tensor generation:  0.019781827926635742
mini_batch_src_global generation:  0.03270840644836426
r_  generation:  0.27590179443359375
local_output_nid generation:  0.015657901763916016
local_in_edges_tensor generation:  0.019163846969604492
mini_batch_src_global generation:  0.0325627326965332
r_  generation:  0.26097869873046875
local_output_nid generation:  0.015624046325683594
local_in_edges_tensor generation:  0.014357805252075195
mini_batch_src_global generation:  0.033080339431762695
r_  generation:  0.2646219730377197
local_output_nid generation:  0.015741348266601562
local_in_edges_tensor generation:  0.015215873718261719
mini_batch_src_global generation:  0.03532075881958008
r_  generation:  0.2654151916503906
local_output_nid generation:  0.015960693359375
local_in_edges_tensor generation:  0.01993083953857422
mini_batch_src_global generation:  0.03382253646850586
r_  generation:  0.2718541622161865
local_output_nid generation:  0.016188621520996094
local_in_edges_tensor generation:  0.01490163803100586
mini_batch_src_global generation:  0.03652548789978027
r_  generation:  0.2741990089416504
local_output_nid generation:  0.01602959632873535
local_in_edges_tensor generation:  0.014841794967651367
mini_batch_src_global generation:  0.03734993934631348
r_  generation:  0.2702486515045166
local_output_nid generation:  0.0162355899810791
local_in_edges_tensor generation:  0.01742076873779297
mini_batch_src_global generation:  0.035231590270996094
r_  generation:  0.277477502822876
local_output_nid generation:  0.01619434356689453
local_in_edges_tensor generation:  0.019488096237182617
mini_batch_src_global generation:  0.03474712371826172
r_  generation:  0.27425408363342285
local_output_nid generation:  0.015998363494873047
local_in_edges_tensor generation:  0.01689600944519043
mini_batch_src_global generation:  0.03410792350769043
r_  generation:  0.2743525505065918
local_output_nid generation:  0.015845298767089844
local_in_edges_tensor generation:  0.0191192626953125
mini_batch_src_global generation:  0.03393363952636719
r_  generation:  0.2712533473968506
local_output_nid generation:  0.01591968536376953
local_in_edges_tensor generation:  0.014475107192993164
mini_batch_src_global generation:  0.03777813911437988
r_  generation:  0.2732703685760498
local_output_nid generation:  0.016026020050048828
local_in_edges_tensor generation:  0.01701664924621582
mini_batch_src_global generation:  0.03420424461364746
r_  generation:  0.2699301242828369
----------------------check_connections_block total spend ----------------------------- 6.319799184799194
generate_one_block  0.36127662658691406
generate_one_block  0.3596940040588379
generate_one_block  0.36246371269226074
generate_one_block  0.36522984504699707
generate_one_block  0.3620872497558594
generate_one_block  0.34786009788513184
generate_one_block  0.35263919830322266
generate_one_block  0.36057400703430176
generate_one_block  0.3654165267944336
generate_one_block  0.35291409492492676
generate_one_block  0.36482834815979004
generate_one_block  0.3529505729675293
generate_one_block  0.35546040534973145
generate_one_block  0.34981393814086914
generate_one_block  0.3640260696411133
generate_one_block  0.3523063659667969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036176204681396484
gen group dst list time:  0.06263494491577148
time for parepare:  0.019526243209838867
local_output_nid generation:  0.027035236358642578
local_in_edges_tensor generation:  0.04110884666442871
mini_batch_src_global generation:  0.04286003112792969
r_  generation:  0.45726585388183594
local_output_nid generation:  0.03638505935668945
local_in_edges_tensor generation:  0.04831242561340332
mini_batch_src_global generation:  0.05396270751953125
r_  generation:  0.4763612747192383
local_output_nid generation:  0.036219120025634766
local_in_edges_tensor generation:  0.04401040077209473
mini_batch_src_global generation:  0.051340341567993164
r_  generation:  0.47454357147216797
local_output_nid generation:  0.03623199462890625
local_in_edges_tensor generation:  0.037256479263305664
mini_batch_src_global generation:  0.05192995071411133
r_  generation:  0.481478214263916
local_output_nid generation:  0.03641819953918457
local_in_edges_tensor generation:  0.03180527687072754
mini_batch_src_global generation:  0.05182814598083496
r_  generation:  0.48142480850219727
local_output_nid generation:  0.03638577461242676
local_in_edges_tensor generation:  0.036446571350097656
mini_batch_src_global generation:  0.056113243103027344
r_  generation:  0.4791548252105713
local_output_nid generation:  0.0366361141204834
local_in_edges_tensor generation:  0.040328025817871094
mini_batch_src_global generation:  0.05237102508544922
r_  generation:  0.474689245223999
local_output_nid generation:  0.03656935691833496
local_in_edges_tensor generation:  0.03610730171203613
mini_batch_src_global generation:  0.056591033935546875
r_  generation:  0.476548433303833
local_output_nid generation:  0.03653573989868164
local_in_edges_tensor generation:  0.039560794830322266
mini_batch_src_global generation:  0.05303049087524414
r_  generation:  0.47680115699768066
local_output_nid generation:  0.03677821159362793
local_in_edges_tensor generation:  0.036257028579711914
mini_batch_src_global generation:  0.05393695831298828
r_  generation:  0.47521376609802246
local_output_nid generation:  0.03675580024719238
local_in_edges_tensor generation:  0.03200483322143555
mini_batch_src_global generation:  0.056836605072021484
r_  generation:  0.4846618175506592
local_output_nid generation:  0.03714776039123535
local_in_edges_tensor generation:  0.040430307388305664
mini_batch_src_global generation:  0.0537567138671875
r_  generation:  0.48392748832702637
local_output_nid generation:  0.03666353225708008
local_in_edges_tensor generation:  0.032288551330566406
mini_batch_src_global generation:  0.05388832092285156
r_  generation:  0.48473644256591797
local_output_nid generation:  0.03662371635437012
local_in_edges_tensor generation:  0.03269839286804199
mini_batch_src_global generation:  0.053501129150390625
r_  generation:  0.4842689037322998
local_output_nid generation:  0.03660416603088379
local_in_edges_tensor generation:  0.03215932846069336
mini_batch_src_global generation:  0.05393362045288086
r_  generation:  0.4855046272277832
local_output_nid generation:  0.036461830139160156
local_in_edges_tensor generation:  0.03582000732421875
mini_batch_src_global generation:  0.05404853820800781
r_  generation:  0.4782381057739258
----------------------check_connections_block total spend ----------------------------- 11.370949506759644
generate_one_block  0.5884466171264648
generate_one_block  0.6054706573486328
generate_one_block  0.5960779190063477
generate_one_block  0.6167221069335938
generate_one_block  0.5853886604309082
generate_one_block  0.5922813415527344
generate_one_block  0.6543796062469482
generate_one_block  0.602102518081665
generate_one_block  0.6340038776397705
generate_one_block  0.6150088310241699
generate_one_block  0.6115682125091553
generate_one_block  0.6205825805664062
generate_one_block  0.6017060279846191
generate_one_block  0.6269693374633789
generate_one_block  0.6128871440887451
generate_one_block  0.6173079013824463
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  17.690748691558838
block generation total time  15.510444402694702
average batch blocks generation time:  0.9694027751684189
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09266376495361328  GigaBytes
Max Memory Allocated: 0.09266376495361328  GigaBytes

torch.Size([156719, 128])
torch.Size([129442, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.2631850242614746  GigaBytes
Max Memory Allocated: 0.2727055549621582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09451484680175781  GigaBytes
Max Memory Allocated: 0.2864060401916504  GigaBytes

torch.Size([157010, 128])
torch.Size([130520, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26430559158325195  GigaBytes
Max Memory Allocated: 0.2864060401916504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09434366226196289  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156555, 128])
torch.Size([129690, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2639307975769043  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09458160400390625  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156910, 128])
torch.Size([130499, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2642207145690918  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09424591064453125  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156748, 128])
torch.Size([129631, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26257944107055664  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09424352645874023  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156715, 128])
torch.Size([129474, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2623605728149414  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09439468383789062  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156924, 128])
torch.Size([130047, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2630124092102051  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944814682006836  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156800, 128])
torch.Size([129988, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26416683197021484  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09456968307495117  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([156935, 128])
torch.Size([130514, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2643008232116699  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0945119857788086  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([157134, 128])
torch.Size([130112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26354503631591797  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09475278854370117  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

torch.Size([157137, 128])
torch.Size([130916, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2652459144592285  GigaBytes
Max Memory Allocated: 0.28681325912475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944361686706543  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156913, 128])
torch.Size([130287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2637500762939453  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09441804885864258  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156803, 128])
torch.Size([129898, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2637786865234375  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0942988395690918  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156781, 128])
torch.Size([129962, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2624692916870117  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09443855285644531  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156960, 128])
torch.Size([129824, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26337289810180664  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09430170059204102  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156727, 128])
torch.Size([129600, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2627582550048828  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037384748458862305 |0.03603711724281311 |0.04904972016811371 |9.53376293182373e-05 |0.008336484432220459 |0.0017976760864257812 |
----------------------------------------------------------pseudo_mini_loss sum 5.342078685760498
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5320938
Number of first layer input nodes during this epoch:  2509771
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.1326451301574707  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025200605392456055
random selection method range initialization spend 0.005528688430786133
time for parepare:  0.01714301109313965
local_output_nid generation:  0.0023987293243408203
local_in_edges_tensor generation:  0.005778074264526367
mini_batch_src_global generation:  0.002118825912475586
r_  generation:  0.020359516143798828
local_output_nid generation:  0.002759695053100586
local_in_edges_tensor generation:  0.0017037391662597656
mini_batch_src_global generation:  0.002307415008544922
r_  generation:  0.019813060760498047
local_output_nid generation:  0.002843618392944336
local_in_edges_tensor generation:  0.0016016960144042969
mini_batch_src_global generation:  0.0015523433685302734
r_  generation:  0.020576000213623047
local_output_nid generation:  0.0028557777404785156
local_in_edges_tensor generation:  0.0015568733215332031
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.020758867263793945
local_output_nid generation:  0.006491899490356445
local_in_edges_tensor generation:  0.004973649978637695
mini_batch_src_global generation:  0.003093719482421875
r_  generation:  0.021535634994506836
local_output_nid generation:  0.0029134750366210938
local_in_edges_tensor generation:  0.0020055770874023438
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.022476911544799805
local_output_nid generation:  0.0029249191284179688
local_in_edges_tensor generation:  0.0016007423400878906
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.023162841796875
local_output_nid generation:  0.0029540061950683594
local_in_edges_tensor generation:  0.0015370845794677734
mini_batch_src_global generation:  0.0017764568328857422
r_  generation:  0.021269798278808594
local_output_nid generation:  0.0029604434967041016
local_in_edges_tensor generation:  0.0015532970428466797
mini_batch_src_global generation:  0.0017690658569335938
r_  generation:  0.02260279655456543
local_output_nid generation:  0.003021240234375
local_in_edges_tensor generation:  0.0015149116516113281
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.02443099021911621
local_output_nid generation:  0.0041866302490234375
local_in_edges_tensor generation:  0.001712799072265625
mini_batch_src_global generation:  0.0018503665924072266
r_  generation:  0.0226743221282959
local_output_nid generation:  0.0030133724212646484
local_in_edges_tensor generation:  0.0015873908996582031
mini_batch_src_global generation:  0.001834869384765625
r_  generation:  0.0221405029296875
local_output_nid generation:  0.002960681915283203
local_in_edges_tensor generation:  0.0015969276428222656
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.02702951431274414
local_output_nid generation:  0.0029892921447753906
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0018405914306640625
r_  generation:  0.021809816360473633
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.0015020370483398438
mini_batch_src_global generation:  0.0018870830535888672
r_  generation:  0.022558927536010742
local_output_nid generation:  0.003023386001586914
local_in_edges_tensor generation:  0.0018532276153564453
mini_batch_src_global generation:  0.0018842220306396484
r_  generation:  0.022705554962158203
----------------------check_connections_block total spend ----------------------------- 0.585078239440918
generate_one_block  0.0308229923248291
generate_one_block  0.030318260192871094
generate_one_block  0.030818462371826172
generate_one_block  0.030666589736938477
generate_one_block  0.030422449111938477
generate_one_block  0.03586697578430176
generate_one_block  0.0323333740234375
generate_one_block  0.030717849731445312
generate_one_block  0.03210902214050293
generate_one_block  0.031667470932006836
generate_one_block  0.03203535079956055
generate_one_block  0.03214287757873535
generate_one_block  0.030849456787109375
generate_one_block  0.030602693557739258
generate_one_block  0.0314786434173584
generate_one_block  0.03329277038574219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05481076240539551
gen group dst list time:  0.019395828247070312
time for parepare:  0.02128124237060547
local_output_nid generation:  0.009329795837402344
local_in_edges_tensor generation:  0.03401660919189453
mini_batch_src_global generation:  0.02515697479248047
r_  generation:  0.26264119148254395
local_output_nid generation:  0.013069868087768555
local_in_edges_tensor generation:  0.02323150634765625
mini_batch_src_global generation:  0.031148433685302734
r_  generation:  0.25356125831604004
local_output_nid generation:  0.01352071762084961
local_in_edges_tensor generation:  0.018693208694458008
mini_batch_src_global generation:  0.03033590316772461
r_  generation:  0.2691962718963623
local_output_nid generation:  0.013520479202270508
local_in_edges_tensor generation:  0.018828868865966797
mini_batch_src_global generation:  0.03149700164794922
r_  generation:  0.266965389251709
local_output_nid generation:  0.01313018798828125
local_in_edges_tensor generation:  0.016637325286865234
mini_batch_src_global generation:  0.03263139724731445
r_  generation:  0.27381110191345215
local_output_nid generation:  0.013691186904907227
local_in_edges_tensor generation:  0.019597291946411133
mini_batch_src_global generation:  0.034343719482421875
r_  generation:  0.287273645401001
local_output_nid generation:  0.013258218765258789
local_in_edges_tensor generation:  0.014882802963256836
mini_batch_src_global generation:  0.03469562530517578
r_  generation:  0.2819058895111084
local_output_nid generation:  0.013096332550048828
local_in_edges_tensor generation:  0.014538764953613281
mini_batch_src_global generation:  0.033991336822509766
r_  generation:  0.277468204498291
local_output_nid generation:  0.015401124954223633
local_in_edges_tensor generation:  0.021868467330932617
mini_batch_src_global generation:  0.03481578826904297
r_  generation:  0.2867147922515869
local_output_nid generation:  0.014912843704223633
local_in_edges_tensor generation:  0.02149820327758789
mini_batch_src_global generation:  0.03458595275878906
r_  generation:  0.28115081787109375
local_output_nid generation:  0.016028165817260742
local_in_edges_tensor generation:  0.017161130905151367
mini_batch_src_global generation:  0.03639864921569824
r_  generation:  0.2847864627838135
local_output_nid generation:  0.01761460304260254
local_in_edges_tensor generation:  0.02379441261291504
mini_batch_src_global generation:  0.035324811935424805
r_  generation:  0.29770445823669434
local_output_nid generation:  0.015320062637329102
local_in_edges_tensor generation:  0.018193721771240234
mini_batch_src_global generation:  0.03506660461425781
r_  generation:  0.27562832832336426
local_output_nid generation:  0.01324009895324707
local_in_edges_tensor generation:  0.015745878219604492
mini_batch_src_global generation:  0.034201860427856445
r_  generation:  0.2698793411254883
local_output_nid generation:  0.01359415054321289
local_in_edges_tensor generation:  0.01960468292236328
mini_batch_src_global generation:  0.03455781936645508
r_  generation:  0.28073859214782715
local_output_nid generation:  0.013584613800048828
local_in_edges_tensor generation:  0.022150516510009766
mini_batch_src_global generation:  0.03526020050048828
r_  generation:  0.2807321548461914
----------------------check_connections_block total spend ----------------------------- 6.452742576599121
generate_one_block  0.36306333541870117
generate_one_block  0.3382997512817383
generate_one_block  0.34819936752319336
generate_one_block  0.36170029640197754
generate_one_block  0.34886956214904785
generate_one_block  0.3780677318572998
generate_one_block  0.4031198024749756
generate_one_block  0.3584787845611572
generate_one_block  0.35970401763916016
generate_one_block  0.3548731803894043
generate_one_block  0.35467958450317383
generate_one_block  0.3490288257598877
generate_one_block  0.34916043281555176
generate_one_block  0.34137964248657227
generate_one_block  0.35897374153137207
generate_one_block  0.3779177665710449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.048540353775024414
gen group dst list time:  0.06710410118103027
time for parepare:  0.020497798919677734
local_output_nid generation:  0.027353763580322266
local_in_edges_tensor generation:  0.06708860397338867
mini_batch_src_global generation:  0.04285097122192383
r_  generation:  0.4572446346282959
local_output_nid generation:  0.03174304962158203
local_in_edges_tensor generation:  0.05152630805969238
mini_batch_src_global generation:  0.05247759819030762
r_  generation:  0.4653620719909668
local_output_nid generation:  0.03858685493469238
local_in_edges_tensor generation:  0.0493321418762207
mini_batch_src_global generation:  0.06779980659484863
r_  generation:  0.46668577194213867
local_output_nid generation:  0.033225059509277344
local_in_edges_tensor generation:  0.044155120849609375
mini_batch_src_global generation:  0.050820350646972656
r_  generation:  0.4637129306793213
local_output_nid generation:  0.03305339813232422
local_in_edges_tensor generation:  0.09660959243774414
mini_batch_src_global generation:  0.0549321174621582
r_  generation:  0.4813508987426758
local_output_nid generation:  0.0326385498046875
local_in_edges_tensor generation:  0.036927223205566406
mini_batch_src_global generation:  0.05622673034667969
r_  generation:  0.4807286262512207
local_output_nid generation:  0.03257298469543457
local_in_edges_tensor generation:  0.03379082679748535
mini_batch_src_global generation:  0.05418109893798828
r_  generation:  0.4785764217376709
local_output_nid generation:  0.032466888427734375
local_in_edges_tensor generation:  0.03218197822570801
mini_batch_src_global generation:  0.057440996170043945
r_  generation:  0.4793412685394287
local_output_nid generation:  0.03360295295715332
local_in_edges_tensor generation:  0.04418683052062988
mini_batch_src_global generation:  0.0569765567779541
r_  generation:  0.47588610649108887
local_output_nid generation:  0.03253936767578125
local_in_edges_tensor generation:  0.03408503532409668
mini_batch_src_global generation:  0.05392050743103027
r_  generation:  0.49442481994628906
local_output_nid generation:  0.03579545021057129
local_in_edges_tensor generation:  0.04249215126037598
mini_batch_src_global generation:  0.05762624740600586
r_  generation:  0.4762706756591797
local_output_nid generation:  0.03377985954284668
local_in_edges_tensor generation:  0.03510642051696777
mini_batch_src_global generation:  0.05778336524963379
r_  generation:  0.47424888610839844
local_output_nid generation:  0.033194780349731445
local_in_edges_tensor generation:  0.03413963317871094
mini_batch_src_global generation:  0.05670666694641113
r_  generation:  0.4758138656616211
local_output_nid generation:  0.03326249122619629
local_in_edges_tensor generation:  0.030242443084716797
mini_batch_src_global generation:  0.05366230010986328
r_  generation:  0.47927021980285645
local_output_nid generation:  0.03284263610839844
local_in_edges_tensor generation:  0.0299527645111084
mini_batch_src_global generation:  0.05361604690551758
r_  generation:  0.4775094985961914
local_output_nid generation:  0.045197486877441406
local_in_edges_tensor generation:  0.03773784637451172
mini_batch_src_global generation:  0.053214311599731445
r_  generation:  0.472506046295166
----------------------check_connections_block total spend ----------------------------- 11.436352968215942
generate_one_block  0.5964398384094238
generate_one_block  0.5976638793945312
generate_one_block  0.5893135070800781
generate_one_block  0.5906639099121094
generate_one_block  0.597853422164917
generate_one_block  0.5936427116394043
generate_one_block  0.6008172035217285
generate_one_block  0.6030077934265137
generate_one_block  0.6373405456542969
generate_one_block  0.5902769565582275
generate_one_block  0.6005070209503174
generate_one_block  0.5958547592163086
generate_one_block  0.6032991409301758
generate_one_block  0.6013920307159424
generate_one_block  0.5895137786865234
generate_one_block  0.5984461307525635
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.1326451301574707  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

connection checking time:  17.889095544815063
block generation total time  15.33154845237732
average batch blocks generation time:  0.9582217782735825
block dataloader generation time/epoch 35.60952854156494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09484338760375977  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([157020, 128])
torch.Size([130105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2645125389099121  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09433794021606445  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156849, 128])
torch.Size([129760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2624998092651367  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09429550170898438  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156254, 128])
torch.Size([128862, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26244020462036133  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09443330764770508  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156797, 128])
torch.Size([129391, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26231861114501953  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09460210800170898  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([157083, 128])
torch.Size([130036, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2630014419555664  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09490489959716797  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

torch.Size([156894, 128])
torch.Size([130202, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26529979705810547  GigaBytes
Max Memory Allocated: 0.2873086929321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09474706649780273  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156911, 128])
torch.Size([130144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26449060440063477  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09460115432739258  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156847, 128])
torch.Size([129884, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2633171081542969  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09488153457641602  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([157019, 128])
torch.Size([130526, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2649688720703125  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.0947413444519043  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156877, 128])
torch.Size([129764, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26442813873291016  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09466791152954102  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156663, 128])
torch.Size([129756, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26415157318115234  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09475088119506836  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156931, 128])
torch.Size([130188, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2644195556640625  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09465408325195312  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156918, 128])
torch.Size([130171, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2638692855834961  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09430170059204102  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156443, 128])
torch.Size([129106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.262420654296875  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09480476379394531  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156952, 128])
torch.Size([129567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.2642631530761719  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.09480857849121094  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

torch.Size([156870, 128])
torch.Size([130244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.26496171951293945  GigaBytes
Max Memory Allocated: 0.2873106002807617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032270580530166626 |0.019112512469291687 |0.003658309578895569 |9.553134441375732e-05 |0.0039050281047821045 |0.001373291015625 |
----------------------------------------------------------pseudo_mini_loss sum 4.107390880584717
Total (block generation + training)time/epoch 36.588897705078125
Training time/epoch 0.9791297912597656
Training time without block to device /epoch 0.6733295917510986
Training time without total dataloading part /epoch 0.12391519546508789
load block tensor time/epoch 0.516329288482666
block to device time/epoch 0.305800199508667
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5317162
Number of first layer input nodes during this epoch:  2509328
