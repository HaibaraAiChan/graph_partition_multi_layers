Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439441.0630481
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023311853408813477
random selection method range initialization spend 0.006242275238037109
time for parepare:  0.018627166748046875
local_output_nid generation:  0.004172325134277344
local_in_edges_tensor generation:  0.005110979080200195
mini_batch_src_global generation:  0.0033028125762939453
r_  generation:  0.03784012794494629
local_output_nid generation:  0.005818605422973633
local_in_edges_tensor generation:  0.003166675567626953
mini_batch_src_global generation:  0.004116535186767578
r_  generation:  0.03935670852661133
local_output_nid generation:  0.0060346126556396484
local_in_edges_tensor generation:  0.003243684768676758
mini_batch_src_global generation:  0.002797365188598633
r_  generation:  0.03961348533630371
local_output_nid generation:  0.006077766418457031
local_in_edges_tensor generation:  0.0032265186309814453
mini_batch_src_global generation:  0.002954721450805664
r_  generation:  0.040401458740234375
local_output_nid generation:  0.006033897399902344
local_in_edges_tensor generation:  0.0032758712768554688
mini_batch_src_global generation:  0.0030748844146728516
r_  generation:  0.04147219657897949
local_output_nid generation:  0.006124258041381836
local_in_edges_tensor generation:  0.0031921863555908203
mini_batch_src_global generation:  0.0033397674560546875
r_  generation:  0.042220115661621094
local_output_nid generation:  0.006130218505859375
local_in_edges_tensor generation:  0.0031461715698242188
mini_batch_src_global generation:  0.003252744674682617
r_  generation:  0.04113149642944336
local_output_nid generation:  0.006064653396606445
local_in_edges_tensor generation:  0.0032112598419189453
mini_batch_src_global generation:  0.003308534622192383
r_  generation:  0.041487932205200195
----------------------check_connections_block total spend ----------------------------- 0.5195441246032715
generate_one_block  0.05478501319885254
generate_one_block  0.0557401180267334
generate_one_block  0.05481696128845215
generate_one_block  0.055023193359375
generate_one_block  0.058539390563964844
generate_one_block  0.05579209327697754
generate_one_block  0.054574012756347656
generate_one_block  0.0544886589050293
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03897380828857422
gen group dst list time:  0.015279769897460938
time for parepare:  0.01868891716003418
local_output_nid generation:  0.013009786605834961
local_in_edges_tensor generation:  0.030440568923950195
mini_batch_src_global generation:  0.02986001968383789
r_  generation:  0.2922251224517822
local_output_nid generation:  0.01846623420715332
local_in_edges_tensor generation:  0.02905893325805664
mini_batch_src_global generation:  0.037421226501464844
r_  generation:  0.29996156692504883
local_output_nid generation:  0.017902612686157227
local_in_edges_tensor generation:  0.02093815803527832
mini_batch_src_global generation:  0.03481292724609375
r_  generation:  0.3035264015197754
local_output_nid generation:  0.018157958984375
local_in_edges_tensor generation:  0.018706560134887695
mini_batch_src_global generation:  0.03654336929321289
r_  generation:  0.3124415874481201
local_output_nid generation:  0.018019437789916992
local_in_edges_tensor generation:  0.026218652725219727
mini_batch_src_global generation:  0.036725521087646484
r_  generation:  0.3141343593597412
local_output_nid generation:  0.01804637908935547
local_in_edges_tensor generation:  0.024162769317626953
mini_batch_src_global generation:  0.03735995292663574
r_  generation:  0.3170950412750244
local_output_nid generation:  0.01802229881286621
local_in_edges_tensor generation:  0.01854562759399414
mini_batch_src_global generation:  0.037338972091674805
r_  generation:  0.31248974800109863
local_output_nid generation:  0.017915964126586914
local_in_edges_tensor generation:  0.018148422241210938
mini_batch_src_global generation:  0.03767585754394531
r_  generation:  0.3095057010650635
----------------------check_connections_block total spend ----------------------------- 3.6180083751678467
generate_one_block  0.40116095542907715
generate_one_block  0.3997044563293457
generate_one_block  0.3833746910095215
generate_one_block  0.39527344703674316
generate_one_block  0.3986997604370117
generate_one_block  0.40907883644104004
generate_one_block  0.38732481002807617
generate_one_block  0.39034509658813477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03428769111633301
gen group dst list time:  0.03568124771118164
time for parepare:  0.019586801528930664
local_output_nid generation:  0.028784513473510742
local_in_edges_tensor generation:  0.04154229164123535
mini_batch_src_global generation:  0.04352235794067383
r_  generation:  0.475238561630249
local_output_nid generation:  0.03450179100036621
local_in_edges_tensor generation:  0.04948091506958008
mini_batch_src_global generation:  0.05355429649353027
r_  generation:  0.47905707359313965
local_output_nid generation:  0.0349733829498291
local_in_edges_tensor generation:  0.03731942176818848
mini_batch_src_global generation:  0.0505218505859375
r_  generation:  0.49265623092651367
local_output_nid generation:  0.03468585014343262
local_in_edges_tensor generation:  0.03705143928527832
mini_batch_src_global generation:  0.05343270301818848
r_  generation:  0.48625612258911133
local_output_nid generation:  0.034708499908447266
local_in_edges_tensor generation:  0.04574990272521973
mini_batch_src_global generation:  0.05233478546142578
r_  generation:  0.5008184909820557
local_output_nid generation:  0.035257816314697266
local_in_edges_tensor generation:  0.04203200340270996
mini_batch_src_global generation:  0.05451464653015137
r_  generation:  0.48819756507873535
local_output_nid generation:  0.03767848014831543
local_in_edges_tensor generation:  0.03308391571044922
mini_batch_src_global generation:  0.05296802520751953
r_  generation:  0.49795031547546387
local_output_nid generation:  0.034619808197021484
local_in_edges_tensor generation:  0.04064202308654785
mini_batch_src_global generation:  0.05488157272338867
r_  generation:  0.49544858932495117
----------------------check_connections_block total spend ----------------------------- 5.807545900344849
generate_one_block  0.6091697216033936
generate_one_block  0.6276991367340088
generate_one_block  0.612471342086792
generate_one_block  0.6287858486175537
generate_one_block  0.6205332279205322
generate_one_block  0.6504771709442139
generate_one_block  0.6587095260620117
generate_one_block  0.6168644428253174
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  9.425554275512695
block generation total time  8.189672470092773
average batch blocks generation time:  1.0237090587615967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09574031829833984  GigaBytes
Max Memory Allocated: 0.09574031829833984  GigaBytes

torch.Size([160470, 128])
torch.Size([141299, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.2999401092529297  GigaBytes
Max Memory Allocated: 0.3118095397949219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09896564483642578  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

torch.Size([160338, 128])
torch.Size([141141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2986316680908203  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09804582595825195  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

torch.Size([160614, 128])
torch.Size([141046, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.29947805404663086  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09826040267944336  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

torch.Size([160591, 128])
torch.Size([141485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.29926252365112305  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09814834594726562  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

torch.Size([160547, 128])
torch.Size([141337, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.3002920150756836  GigaBytes
Max Memory Allocated: 0.3318300247192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09765195846557617  GigaBytes
Max Memory Allocated: 0.3320155143737793  GigaBytes

torch.Size([160614, 128])
torch.Size([141685, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.3000373840332031  GigaBytes
Max Memory Allocated: 0.3320155143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.0982065200805664  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160441, 128])
torch.Size([141135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.29903173446655273  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09812593460083008  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160605, 128])
torch.Size([141034, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2980537414550781  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041501760482788086 |0.0564294159412384 |0.09716135263442993 |0.00010654330253601074 |0.009647756814956665 |0.0021820068359375 |
----------------------------------------------------------pseudo_mini_loss sum 5.301546573638916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957707
Number of first layer input nodes during this epoch:  1284220
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.13924217224121094  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021782636642456055
random selection method range initialization spend 0.005385637283325195
time for parepare:  0.01749706268310547
local_output_nid generation:  0.0045125484466552734
local_in_edges_tensor generation:  0.006123542785644531
mini_batch_src_global generation:  0.0032405853271484375
r_  generation:  0.036765098571777344
local_output_nid generation:  0.00587153434753418
local_in_edges_tensor generation:  0.0029616355895996094
mini_batch_src_global generation:  0.00413966178894043
r_  generation:  0.03828239440917969
local_output_nid generation:  0.005942344665527344
local_in_edges_tensor generation:  0.003082752227783203
mini_batch_src_global generation:  0.0028018951416015625
r_  generation:  0.04097104072570801
local_output_nid generation:  0.006150960922241211
local_in_edges_tensor generation:  0.0031151771545410156
mini_batch_src_global generation:  0.0030062198638916016
r_  generation:  0.04155158996582031
local_output_nid generation:  0.006078958511352539
local_in_edges_tensor generation:  0.0031347274780273438
mini_batch_src_global generation:  0.003123044967651367
r_  generation:  0.04137754440307617
local_output_nid generation:  0.0059893131256103516
local_in_edges_tensor generation:  0.003100156784057617
mini_batch_src_global generation:  0.003362894058227539
r_  generation:  0.04317164421081543
local_output_nid generation:  0.006067752838134766
local_in_edges_tensor generation:  0.003191232681274414
mini_batch_src_global generation:  0.003264188766479492
r_  generation:  0.04108262062072754
local_output_nid generation:  0.006114959716796875
local_in_edges_tensor generation:  0.0031282901763916016
mini_batch_src_global generation:  0.003388643264770508
r_  generation:  0.04217791557312012
----------------------check_connections_block total spend ----------------------------- 0.5216920375823975
generate_one_block  0.052669525146484375
generate_one_block  0.054785966873168945
generate_one_block  0.054960012435913086
generate_one_block  0.05456423759460449
generate_one_block  0.05688667297363281
generate_one_block  0.05615997314453125
generate_one_block  0.05840611457824707
generate_one_block  0.06036186218261719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0365757942199707
gen group dst list time:  0.015111446380615234
time for parepare:  0.018784284591674805
local_output_nid generation:  0.013228654861450195
local_in_edges_tensor generation:  0.02901458740234375
mini_batch_src_global generation:  0.026865243911743164
r_  generation:  0.288010835647583
local_output_nid generation:  0.01843428611755371
local_in_edges_tensor generation:  0.02779102325439453
mini_batch_src_global generation:  0.035141706466674805
r_  generation:  0.29338979721069336
local_output_nid generation:  0.0177915096282959
local_in_edges_tensor generation:  0.02521038055419922
mini_batch_src_global generation:  0.03681135177612305
r_  generation:  0.3020780086517334
local_output_nid generation:  0.017637252807617188
local_in_edges_tensor generation:  0.02048492431640625
mini_batch_src_global generation:  0.03908348083496094
r_  generation:  0.3104360103607178
local_output_nid generation:  0.017804384231567383
local_in_edges_tensor generation:  0.022937774658203125
mini_batch_src_global generation:  0.037270545959472656
r_  generation:  0.3107779026031494
local_output_nid generation:  0.017816543579101562
local_in_edges_tensor generation:  0.02314591407775879
mini_batch_src_global generation:  0.037435054779052734
r_  generation:  0.31349682807922363
local_output_nid generation:  0.017591238021850586
local_in_edges_tensor generation:  0.018117189407348633
mini_batch_src_global generation:  0.03676271438598633
r_  generation:  0.3129854202270508
local_output_nid generation:  0.017825603485107422
local_in_edges_tensor generation:  0.020256996154785156
mini_batch_src_global generation:  0.03902697563171387
r_  generation:  0.31416964530944824
----------------------check_connections_block total spend ----------------------------- 3.5954225063323975
generate_one_block  0.38604235649108887
generate_one_block  0.385650634765625
generate_one_block  0.39992570877075195
generate_one_block  0.39176511764526367
generate_one_block  0.398998498916626
generate_one_block  0.4019498825073242
generate_one_block  0.38538193702697754
generate_one_block  0.4194142818450928
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030248403549194336
gen group dst list time:  0.03567671775817871
time for parepare:  0.018694639205932617
local_output_nid generation:  0.027378559112548828
local_in_edges_tensor generation:  0.04123425483703613
mini_batch_src_global generation:  0.04667377471923828
r_  generation:  0.4687614440917969
local_output_nid generation:  0.03439807891845703
local_in_edges_tensor generation:  0.049773454666137695
mini_batch_src_global generation:  0.053267478942871094
r_  generation:  0.4754211902618408
local_output_nid generation:  0.0342257022857666
local_in_edges_tensor generation:  0.0418550968170166
mini_batch_src_global generation:  0.05005383491516113
r_  generation:  0.4864804744720459
local_output_nid generation:  0.03478264808654785
local_in_edges_tensor generation:  0.03811955451965332
mini_batch_src_global generation:  0.05363798141479492
r_  generation:  0.4812455177307129
local_output_nid generation:  0.03428840637207031
local_in_edges_tensor generation:  0.04163527488708496
mini_batch_src_global generation:  0.052010536193847656
r_  generation:  0.4990079402923584
local_output_nid generation:  0.03411078453063965
local_in_edges_tensor generation:  0.03373861312866211
mini_batch_src_global generation:  0.05458712577819824
r_  generation:  0.482039213180542
local_output_nid generation:  0.0341792106628418
local_in_edges_tensor generation:  0.03769850730895996
mini_batch_src_global generation:  0.05262565612792969
r_  generation:  0.5003597736358643
local_output_nid generation:  0.0343928337097168
local_in_edges_tensor generation:  0.04166817665100098
mini_batch_src_global generation:  0.05429840087890625
r_  generation:  0.482680082321167
----------------------check_connections_block total spend ----------------------------- 5.746281147003174
generate_one_block  0.6030223369598389
generate_one_block  0.6093201637268066
generate_one_block  0.6165065765380859
generate_one_block  0.6146652698516846
generate_one_block  0.6192102432250977
generate_one_block  0.6032254695892334
generate_one_block  0.60610032081604
generate_one_block  0.6207835674285889
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.13924217224121094  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

connection checking time:  9.341703653335571
block generation total time  8.061962366104126
average batch blocks generation time:  1.0077452957630157
block dataloader generation time/epoch 19.303759574890137
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09828901290893555  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160635, 128])
torch.Size([141477, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.30019283294677734  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09821748733520508  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160395, 128])
torch.Size([140711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2973670959472656  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09832334518432617  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160480, 128])
torch.Size([141462, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3003420829772949  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0985107421875  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160677, 128])
torch.Size([141594, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2989354133605957  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09844493865966797  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

torch.Size([160543, 128])
torch.Size([141271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3006014823913574  GigaBytes
Max Memory Allocated: 0.3320345878601074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09831523895263672  GigaBytes
Max Memory Allocated: 0.3323359489440918  GigaBytes

torch.Size([160289, 128])
torch.Size([140983, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2990303039550781  GigaBytes
Max Memory Allocated: 0.3323359489440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09827995300292969  GigaBytes
Max Memory Allocated: 0.3323359489440918  GigaBytes

torch.Size([160539, 128])
torch.Size([141193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.30002689361572266  GigaBytes
Max Memory Allocated: 0.3323359489440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0984182357788086  GigaBytes
Max Memory Allocated: 0.3323359489440918  GigaBytes

torch.Size([160470, 128])
torch.Size([141236, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2993755340576172  GigaBytes
Max Memory Allocated: 0.3323359489440918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0379197895526886 |0.011342734098434448 |0.0035723745822906494 |8.982419967651367e-05 |0.009150385856628418 |0.002828836441040039 |
----------------------------------------------------------pseudo_mini_loss sum 4.078334331512451
Total (block generation + training)time/epoch 19.827449560165405
Training time/epoch 0.5234866142272949
Training time without block to device /epoch 0.43274474143981934
Training time without total dataloading part /epoch 0.10532951354980469
load block tensor time/epoch 0.3033583164215088
block to device time/epoch 0.09074187278747559
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2956766
Number of first layer input nodes during this epoch:  1284028
