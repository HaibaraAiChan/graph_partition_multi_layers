Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648507936.2304435
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024916648864746094
random selection method range initialization spend 0.006266355514526367
time for parepare:  0.01839280128479004
local_output_nid generation:  0.002176046371459961
local_in_edges_tensor generation:  0.00483250617980957
mini_batch_src_global generation:  0.0017101764678955078
r_  generation:  0.017223834991455078
local_output_nid generation:  0.0025177001953125
local_in_edges_tensor generation:  0.0017747879028320312
mini_batch_src_global generation:  0.002131938934326172
r_  generation:  0.017492055892944336
local_output_nid generation:  0.002779245376586914
local_in_edges_tensor generation:  0.001689910888671875
mini_batch_src_global generation:  0.0013244152069091797
r_  generation:  0.0167849063873291
local_output_nid generation:  0.002977132797241211
local_in_edges_tensor generation:  0.0015239715576171875
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.017216205596923828
local_output_nid generation:  0.002885580062866211
local_in_edges_tensor generation:  0.0015361309051513672
mini_batch_src_global generation:  0.0013358592987060547
r_  generation:  0.017887115478515625
local_output_nid generation:  0.002917766571044922
local_in_edges_tensor generation:  0.001562356948852539
mini_batch_src_global generation:  0.0014634132385253906
r_  generation:  0.01805901527404785
local_output_nid generation:  0.002880096435546875
local_in_edges_tensor generation:  0.0015254020690917969
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.018444299697875977
local_output_nid generation:  0.0028450489044189453
local_in_edges_tensor generation:  0.001531362533569336
mini_batch_src_global generation:  0.0014145374298095703
r_  generation:  0.017937898635864258
local_output_nid generation:  0.0028536319732666016
local_in_edges_tensor generation:  0.0015079975128173828
mini_batch_src_global generation:  0.0013725757598876953
r_  generation:  0.018294095993041992
local_output_nid generation:  0.0029349327087402344
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.018375396728515625
local_output_nid generation:  0.0028312206268310547
local_in_edges_tensor generation:  0.0015425682067871094
mini_batch_src_global generation:  0.0015113353729248047
r_  generation:  0.0190274715423584
local_output_nid generation:  0.0028679370880126953
local_in_edges_tensor generation:  0.0015633106231689453
mini_batch_src_global generation:  0.001558065414428711
r_  generation:  0.01864147186279297
local_output_nid generation:  0.0029456615447998047
local_in_edges_tensor generation:  0.00154876708984375
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.018504858016967773
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0015435218811035156
mini_batch_src_global generation:  0.001505136489868164
r_  generation:  0.0185244083404541
local_output_nid generation:  0.002852916717529297
local_in_edges_tensor generation:  0.0015137195587158203
mini_batch_src_global generation:  0.0015647411346435547
r_  generation:  0.018691539764404297
local_output_nid generation:  0.0028510093688964844
local_in_edges_tensor generation:  0.001462697982788086
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.018995285034179688
----------------------check_connections_block total spend ----------------------------- 0.4824371337890625
generate_one_block  0.02725982666015625
generate_one_block  0.027909517288208008
generate_one_block  0.027111053466796875
generate_one_block  0.0310819149017334
generate_one_block  0.028597593307495117
generate_one_block  0.027774810791015625
generate_one_block  0.027863502502441406
generate_one_block  0.027483701705932617
generate_one_block  0.027289152145385742
generate_one_block  0.027464628219604492
generate_one_block  0.02784109115600586
generate_one_block  0.026991844177246094
generate_one_block  0.027436017990112305
generate_one_block  0.027493000030517578
generate_one_block  0.027378320693969727
generate_one_block  0.027416229248046875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04224658012390137
gen group dst list time:  0.01848149299621582
time for parepare:  0.01960587501525879
local_output_nid generation:  0.008272409439086914
local_in_edges_tensor generation:  0.017635345458984375
mini_batch_src_global generation:  0.01900959014892578
r_  generation:  0.19403290748596191
local_output_nid generation:  0.014961004257202148
local_in_edges_tensor generation:  0.020897388458251953
mini_batch_src_global generation:  0.024905920028686523
r_  generation:  0.20668864250183105
local_output_nid generation:  0.014606952667236328
local_in_edges_tensor generation:  0.015189647674560547
mini_batch_src_global generation:  0.023827791213989258
r_  generation:  0.20473384857177734
local_output_nid generation:  0.014658451080322266
local_in_edges_tensor generation:  0.015153884887695312
mini_batch_src_global generation:  0.026574373245239258
r_  generation:  0.21061158180236816
local_output_nid generation:  0.014637231826782227
local_in_edges_tensor generation:  0.015259027481079102
mini_batch_src_global generation:  0.025918960571289062
r_  generation:  0.21681571006774902
local_output_nid generation:  0.014719724655151367
local_in_edges_tensor generation:  0.01534414291381836
mini_batch_src_global generation:  0.027981281280517578
r_  generation:  0.21427416801452637
local_output_nid generation:  0.01497030258178711
local_in_edges_tensor generation:  0.015544891357421875
mini_batch_src_global generation:  0.026838302612304688
r_  generation:  0.21883106231689453
local_output_nid generation:  0.01495981216430664
local_in_edges_tensor generation:  0.015303373336791992
mini_batch_src_global generation:  0.026465415954589844
r_  generation:  0.21372485160827637
local_output_nid generation:  0.01493215560913086
local_in_edges_tensor generation:  0.015291452407836914
mini_batch_src_global generation:  0.027059078216552734
r_  generation:  0.21458053588867188
local_output_nid generation:  0.014810800552368164
local_in_edges_tensor generation:  0.017453670501708984
mini_batch_src_global generation:  0.026839256286621094
r_  generation:  0.21536016464233398
local_output_nid generation:  0.015273809432983398
local_in_edges_tensor generation:  0.017378807067871094
mini_batch_src_global generation:  0.027065038681030273
r_  generation:  0.22108221054077148
local_output_nid generation:  0.014779329299926758
local_in_edges_tensor generation:  0.013937950134277344
mini_batch_src_global generation:  0.02668309211730957
r_  generation:  0.21401071548461914
local_output_nid generation:  0.015046119689941406
local_in_edges_tensor generation:  0.01729297637939453
mini_batch_src_global generation:  0.027405738830566406
r_  generation:  0.2203996181488037
local_output_nid generation:  0.014749765396118164
local_in_edges_tensor generation:  0.013805627822875977
mini_batch_src_global generation:  0.02715468406677246
r_  generation:  0.2157754898071289
local_output_nid generation:  0.014977693557739258
local_in_edges_tensor generation:  0.015301227569580078
mini_batch_src_global generation:  0.02765202522277832
r_  generation:  0.2212231159210205
local_output_nid generation:  0.01512455940246582
local_in_edges_tensor generation:  0.016021013259887695
mini_batch_src_global generation:  0.027324676513671875
r_  generation:  0.21867895126342773
----------------------check_connections_block total spend ----------------------------- 5.102891206741333
generate_one_block  0.28037476539611816
generate_one_block  0.284822940826416
generate_one_block  0.276292085647583
generate_one_block  0.28138208389282227
generate_one_block  0.299562931060791
generate_one_block  0.2802116870880127
generate_one_block  0.2819061279296875
generate_one_block  0.2797994613647461
generate_one_block  0.2808547019958496
generate_one_block  0.28009986877441406
generate_one_block  0.28352808952331543
generate_one_block  0.28273725509643555
generate_one_block  0.28664159774780273
generate_one_block  0.2801356315612793
generate_one_block  0.2896862030029297
generate_one_block  0.28831052780151367
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.042611122131347656
gen group dst list time:  0.0615541934967041
time for parepare:  0.018901824951171875
local_output_nid generation:  0.025916099548339844
local_in_edges_tensor generation:  0.042647361755371094
mini_batch_src_global generation:  0.05115389823913574
r_  generation:  0.48558592796325684
local_output_nid generation:  0.03139472007751465
local_in_edges_tensor generation:  0.05039477348327637
mini_batch_src_global generation:  0.056980133056640625
r_  generation:  0.4896214008331299
local_output_nid generation:  0.031192541122436523
local_in_edges_tensor generation:  0.03756856918334961
mini_batch_src_global generation:  0.06093168258666992
r_  generation:  0.49994444847106934
local_output_nid generation:  0.03061079978942871
local_in_edges_tensor generation:  0.0464022159576416
mini_batch_src_global generation:  0.05797934532165527
r_  generation:  0.5020020008087158
local_output_nid generation:  0.03080439567565918
local_in_edges_tensor generation:  0.03664660453796387
mini_batch_src_global generation:  0.058603525161743164
r_  generation:  0.5067782402038574
local_output_nid generation:  0.032535552978515625
local_in_edges_tensor generation:  0.05071830749511719
mini_batch_src_global generation:  0.05993199348449707
r_  generation:  0.5074124336242676
local_output_nid generation:  0.031386613845825195
local_in_edges_tensor generation:  0.03986334800720215
mini_batch_src_global generation:  0.05813145637512207
r_  generation:  0.5100831985473633
local_output_nid generation:  0.03130006790161133
local_in_edges_tensor generation:  0.030272245407104492
mini_batch_src_global generation:  0.05997776985168457
r_  generation:  0.5099806785583496
local_output_nid generation:  0.03137516975402832
local_in_edges_tensor generation:  0.03691697120666504
mini_batch_src_global generation:  0.061850547790527344
r_  generation:  0.5078558921813965
local_output_nid generation:  0.03189420700073242
local_in_edges_tensor generation:  0.04022789001464844
mini_batch_src_global generation:  0.05930805206298828
r_  generation:  0.50589919090271
local_output_nid generation:  0.032375335693359375
local_in_edges_tensor generation:  0.043454647064208984
mini_batch_src_global generation:  0.05912947654724121
r_  generation:  0.5117793083190918
local_output_nid generation:  0.032141923904418945
local_in_edges_tensor generation:  0.050560712814331055
mini_batch_src_global generation:  0.06683063507080078
r_  generation:  0.5067481994628906
local_output_nid generation:  0.03195834159851074
local_in_edges_tensor generation:  0.03649425506591797
mini_batch_src_global generation:  0.06554484367370605
r_  generation:  0.5241725444793701
local_output_nid generation:  0.03483462333679199
local_in_edges_tensor generation:  0.030907154083251953
mini_batch_src_global generation:  0.06097602844238281
r_  generation:  0.49935221672058105
local_output_nid generation:  0.03186821937561035
local_in_edges_tensor generation:  0.030680179595947266
mini_batch_src_global generation:  0.05963325500488281
r_  generation:  0.5091145038604736
local_output_nid generation:  0.03177022933959961
local_in_edges_tensor generation:  0.044483184814453125
mini_batch_src_global generation:  0.05965685844421387
r_  generation:  0.5093836784362793
----------------------check_connections_block total spend ----------------------------- 11.952115297317505
generate_one_block  0.6504216194152832
generate_one_block  0.654069185256958
generate_one_block  0.675792932510376
generate_one_block  0.6829183101654053
generate_one_block  0.6504480838775635
generate_one_block  0.6709988117218018
generate_one_block  0.7354907989501953
generate_one_block  0.6841893196105957
generate_one_block  0.6689803600311279
generate_one_block  0.6846957206726074
generate_one_block  0.6886920928955078
generate_one_block  0.656592607498169
generate_one_block  0.6478681564331055
generate_one_block  0.6698746681213379
generate_one_block  0.6432948112487793
generate_one_block  0.6624221801757812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0524904727935791
gen group dst list time:  0.10243105888366699
time for parepare:  0.019605636596679688
local_output_nid generation:  0.03439760208129883
local_in_edges_tensor generation:  0.05696988105773926
mini_batch_src_global generation:  0.055963754653930664
r_  generation:  0.5424981117248535
local_output_nid generation:  0.04083251953125
local_in_edges_tensor generation:  0.06586837768554688
mini_batch_src_global generation:  0.07094192504882812
r_  generation:  0.5558762550354004
local_output_nid generation:  0.043623924255371094
local_in_edges_tensor generation:  0.04316210746765137
mini_batch_src_global generation:  0.06407332420349121
r_  generation:  0.5545904636383057
local_output_nid generation:  0.04202914237976074
local_in_edges_tensor generation:  0.04246950149536133
mini_batch_src_global generation:  0.05913829803466797
r_  generation:  0.558826208114624
local_output_nid generation:  0.03997087478637695
local_in_edges_tensor generation:  0.042679786682128906
mini_batch_src_global generation:  0.06354856491088867
r_  generation:  0.5707707405090332
local_output_nid generation:  0.03997969627380371
local_in_edges_tensor generation:  0.04268074035644531
mini_batch_src_global generation:  0.05973196029663086
r_  generation:  0.5762977600097656
local_output_nid generation:  0.04036760330200195
local_in_edges_tensor generation:  0.047019004821777344
mini_batch_src_global generation:  0.061467647552490234
r_  generation:  0.5715532302856445
local_output_nid generation:  0.0398411750793457
local_in_edges_tensor generation:  0.0379023551940918
mini_batch_src_global generation:  0.06832480430603027
r_  generation:  0.5763556957244873
local_output_nid generation:  0.039835214614868164
local_in_edges_tensor generation:  0.037876129150390625
mini_batch_src_global generation:  0.06145215034484863
r_  generation:  0.5725183486938477
local_output_nid generation:  0.04005146026611328
local_in_edges_tensor generation:  0.04202985763549805
mini_batch_src_global generation:  0.06636190414428711
r_  generation:  0.5832993984222412
local_output_nid generation:  0.04107165336608887
local_in_edges_tensor generation:  0.04698634147644043
mini_batch_src_global generation:  0.06146836280822754
r_  generation:  0.5802872180938721
local_output_nid generation:  0.039972543716430664
local_in_edges_tensor generation:  0.04234910011291504
mini_batch_src_global generation:  0.06345844268798828
r_  generation:  0.5836834907531738
local_output_nid generation:  0.03998398780822754
local_in_edges_tensor generation:  0.05032920837402344
mini_batch_src_global generation:  0.06295561790466309
r_  generation:  0.5964446067810059
local_output_nid generation:  0.03972792625427246
local_in_edges_tensor generation:  0.04671049118041992
mini_batch_src_global generation:  0.07240653038024902
r_  generation:  0.5818173885345459
local_output_nid generation:  0.04189133644104004
local_in_edges_tensor generation:  0.041997432708740234
mini_batch_src_global generation:  0.07280731201171875
r_  generation:  0.5756368637084961
local_output_nid generation:  0.0397036075592041
local_in_edges_tensor generation:  0.04152083396911621
mini_batch_src_global generation:  0.06377506256103516
r_  generation:  0.577932596206665
----------------------check_connections_block total spend ----------------------------- 13.679483652114868
generate_one_block  0.704810619354248
generate_one_block  0.7091569900512695
generate_one_block  0.7012524604797363
generate_one_block  0.779066801071167
generate_one_block  0.7144932746887207
generate_one_block  0.7203500270843506
generate_one_block  0.716484546661377
generate_one_block  0.717803955078125
generate_one_block  0.6892514228820801
generate_one_block  0.6888992786407471
generate_one_block  0.7160162925720215
generate_one_block  0.7004759311676025
generate_one_block  0.6850874423980713
generate_one_block  0.686821460723877
generate_one_block  0.6868276596069336
generate_one_block  0.7141051292419434
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05145549774169922
gen group dst list time:  0.0989537239074707
time for parepare:  0.019614219665527344
local_output_nid generation:  0.036907196044921875
local_in_edges_tensor generation:  0.054929494857788086
mini_batch_src_global generation:  0.05091738700866699
r_  generation:  0.5392091274261475
local_output_nid generation:  0.0432281494140625
local_in_edges_tensor generation:  0.04323244094848633
mini_batch_src_global generation:  0.06275391578674316
r_  generation:  0.5420494079589844
local_output_nid generation:  0.04065251350402832
local_in_edges_tensor generation:  0.036635637283325195
mini_batch_src_global generation:  0.06383252143859863
r_  generation:  0.5379796028137207
local_output_nid generation:  0.04079270362854004
local_in_edges_tensor generation:  0.040314674377441406
mini_batch_src_global generation:  0.061723947525024414
r_  generation:  0.5419416427612305
local_output_nid generation:  0.04091382026672363
local_in_edges_tensor generation:  0.053095340728759766
mini_batch_src_global generation:  0.06181144714355469
r_  generation:  0.541111946105957
local_output_nid generation:  0.040616512298583984
local_in_edges_tensor generation:  0.04643607139587402
mini_batch_src_global generation:  0.06172513961791992
r_  generation:  0.5525236129760742
local_output_nid generation:  0.041228532791137695
local_in_edges_tensor generation:  0.04478907585144043
mini_batch_src_global generation:  0.06543231010437012
r_  generation:  0.5452213287353516
local_output_nid generation:  0.040052175521850586
local_in_edges_tensor generation:  0.04543876647949219
mini_batch_src_global generation:  0.061768293380737305
r_  generation:  0.5502376556396484
local_output_nid generation:  0.040581464767456055
local_in_edges_tensor generation:  0.03646969795227051
mini_batch_src_global generation:  0.06198573112487793
r_  generation:  0.5534071922302246
local_output_nid generation:  0.04098224639892578
local_in_edges_tensor generation:  0.036466360092163086
mini_batch_src_global generation:  0.06241893768310547
r_  generation:  0.5609903335571289
local_output_nid generation:  0.0403590202331543
local_in_edges_tensor generation:  0.052032470703125
mini_batch_src_global generation:  0.06604456901550293
r_  generation:  0.5592207908630371
local_output_nid generation:  0.04039740562438965
local_in_edges_tensor generation:  0.0454864501953125
mini_batch_src_global generation:  0.06162619590759277
r_  generation:  0.5732660293579102
local_output_nid generation:  0.04241132736206055
local_in_edges_tensor generation:  0.04059338569641113
mini_batch_src_global generation:  0.06573867797851562
r_  generation:  0.5523586273193359
local_output_nid generation:  0.04128527641296387
local_in_edges_tensor generation:  0.04130125045776367
mini_batch_src_global generation:  0.06215643882751465
r_  generation:  0.5582599639892578
local_output_nid generation:  0.04155445098876953
local_in_edges_tensor generation:  0.05053210258483887
mini_batch_src_global generation:  0.06573343276977539
r_  generation:  0.5568726062774658
local_output_nid generation:  0.041327476501464844
local_in_edges_tensor generation:  0.04639482498168945
mini_batch_src_global generation:  0.06308484077453613
r_  generation:  0.559180498123169
----------------------check_connections_block total spend ----------------------------- 13.28148627281189
generate_one_block  0.6871163845062256
generate_one_block  0.7074308395385742
generate_one_block  0.6775839328765869
generate_one_block  0.6824290752410889
generate_one_block  0.6782705783843994
generate_one_block  0.7060651779174805
generate_one_block  0.7695331573486328
generate_one_block  0.6951396465301514
generate_one_block  0.6898047924041748
generate_one_block  0.6889228820800781
generate_one_block  0.69207763671875
generate_one_block  0.6872992515563965
generate_one_block  0.6760082244873047
generate_one_block  0.6756439208984375
generate_one_block  0.6883490085601807
generate_one_block  0.6997151374816895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044381141662597656
gen group dst list time:  0.09424829483032227
time for parepare:  0.01957869529724121
local_output_nid generation:  0.03775453567504883
local_in_edges_tensor generation:  0.052472591400146484
mini_batch_src_global generation:  0.04673123359680176
r_  generation:  0.5019388198852539
local_output_nid generation:  0.043862104415893555
local_in_edges_tensor generation:  0.03790020942687988
mini_batch_src_global generation:  0.05852317810058594
r_  generation:  0.5041401386260986
local_output_nid generation:  0.04146885871887207
local_in_edges_tensor generation:  0.03772115707397461
mini_batch_src_global generation:  0.06055855751037598
r_  generation:  0.5046048164367676
local_output_nid generation:  0.041130781173706055
local_in_edges_tensor generation:  0.03601336479187012
mini_batch_src_global generation:  0.05860447883605957
r_  generation:  0.5038588047027588
local_output_nid generation:  0.04097104072570801
local_in_edges_tensor generation:  0.035956382751464844
mini_batch_src_global generation:  0.05898880958557129
r_  generation:  0.506148099899292
local_output_nid generation:  0.04059910774230957
local_in_edges_tensor generation:  0.040143728256225586
mini_batch_src_global generation:  0.05916190147399902
r_  generation:  0.5042831897735596
local_output_nid generation:  0.04126858711242676
local_in_edges_tensor generation:  0.03965163230895996
mini_batch_src_global generation:  0.05936002731323242
r_  generation:  0.50742506980896
local_output_nid generation:  0.04098176956176758
local_in_edges_tensor generation:  0.04021453857421875
mini_batch_src_global generation:  0.05905413627624512
r_  generation:  0.5066547393798828
local_output_nid generation:  0.040857791900634766
local_in_edges_tensor generation:  0.04018259048461914
mini_batch_src_global generation:  0.05869030952453613
r_  generation:  0.5089020729064941
local_output_nid generation:  0.04223060607910156
local_in_edges_tensor generation:  0.04479336738586426
mini_batch_src_global generation:  0.06237506866455078
r_  generation:  0.5116353034973145
local_output_nid generation:  0.04101133346557617
local_in_edges_tensor generation:  0.03590703010559082
mini_batch_src_global generation:  0.05830121040344238
r_  generation:  0.5101897716522217
local_output_nid generation:  0.04120659828186035
local_in_edges_tensor generation:  0.04231405258178711
mini_batch_src_global generation:  0.05946969985961914
r_  generation:  0.5113623142242432
local_output_nid generation:  0.041152238845825195
local_in_edges_tensor generation:  0.04507303237915039
mini_batch_src_global generation:  0.05824589729309082
r_  generation:  0.5125553607940674
local_output_nid generation:  0.0410456657409668
local_in_edges_tensor generation:  0.040625572204589844
mini_batch_src_global generation:  0.058953285217285156
r_  generation:  0.5113694667816162
local_output_nid generation:  0.0409700870513916
local_in_edges_tensor generation:  0.043941497802734375
mini_batch_src_global generation:  0.058335304260253906
r_  generation:  0.5144443511962891
local_output_nid generation:  0.040940284729003906
local_in_edges_tensor generation:  0.035631418228149414
mini_batch_src_global generation:  0.05890607833862305
r_  generation:  0.5109021663665771
----------------------check_connections_block total spend ----------------------------- 12.321638345718384
generate_one_block  0.6274847984313965
generate_one_block  0.6497676372528076
generate_one_block  0.6317133903503418
generate_one_block  0.6325361728668213
generate_one_block  0.6479034423828125
generate_one_block  0.6453385353088379
generate_one_block  0.6390371322631836
generate_one_block  0.6424684524536133
generate_one_block  0.712437629699707
generate_one_block  0.640493631362915
generate_one_block  0.6437299251556396
generate_one_block  0.6291759014129639
generate_one_block  0.626042366027832
generate_one_block  0.6266536712646484
generate_one_block  0.6541407108306885
generate_one_block  0.6280500888824463
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  56.33761477470398
block generation total time  47.97236204147339
average batch blocks generation time:  2.998272627592087
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1349949836730957  GigaBytes
Max Memory Allocated: 0.1349949836730957  GigaBytes

torch.Size([167292, 128])
torch.Size([166518, 32])
torch.Size([164165, 32])
torch.Size([156163, 32])
torch.Size([124110, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.5156421661376953  GigaBytes
Max Memory Allocated: 0.5177721977233887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.13708877563476562  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167297, 128])
torch.Size([166556, 32])
torch.Size([164192, 32])
torch.Size([156090, 32])
torch.Size([124003, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5141153335571289  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13707304000854492  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167251, 128])
torch.Size([166437, 32])
torch.Size([164048, 32])
torch.Size([155975, 32])
torch.Size([123838, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135436058044434  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13706731796264648  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167211, 128])
torch.Size([166363, 32])
torch.Size([163890, 32])
torch.Size([155319, 32])
torch.Size([123074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5090599060058594  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13706302642822266  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167271, 128])
torch.Size([166441, 32])
torch.Size([163955, 32])
torch.Size([155588, 32])
torch.Size([123295, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5093860626220703  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13708925247192383  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167242, 128])
torch.Size([166421, 32])
torch.Size([163962, 32])
torch.Size([155860, 32])
torch.Size([124043, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5138335227966309  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1370987892150879  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167240, 128])
torch.Size([166448, 32])
torch.Size([163960, 32])
torch.Size([155890, 32])
torch.Size([123755, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5138735771179199  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13707971572875977  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167264, 128])
torch.Size([166458, 32])
torch.Size([164097, 32])
torch.Size([155935, 32])
torch.Size([123509, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135459899902344  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13707494735717773  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167274, 128])
torch.Size([166474, 32])
torch.Size([163966, 32])
torch.Size([155730, 32])
torch.Size([123892, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5138664245605469  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13705921173095703  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167326, 128])
torch.Size([166518, 32])
torch.Size([164073, 32])
torch.Size([155900, 32])
torch.Size([123734, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5137567520141602  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13712739944458008  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167270, 128])
torch.Size([166494, 32])
torch.Size([164114, 32])
torch.Size([156046, 32])
torch.Size([124364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5143222808837891  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13709163665771484  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167236, 128])
torch.Size([166437, 32])
torch.Size([164031, 32])
torch.Size([155861, 32])
torch.Size([123881, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5136227607727051  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13710451126098633  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167229, 128])
torch.Size([166439, 32])
torch.Size([163864, 32])
torch.Size([155513, 32])
torch.Size([123643, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5098052024841309  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13704252243041992  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167253, 128])
torch.Size([166422, 32])
torch.Size([163892, 32])
torch.Size([155357, 32])
torch.Size([123038, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5085673332214355  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13710498809814453  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167278, 128])
torch.Size([166442, 32])
torch.Size([163957, 32])
torch.Size([155640, 32])
torch.Size([123993, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.510197639465332  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13710498809814453  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167198, 128])
torch.Size([166351, 32])
torch.Size([163937, 32])
torch.Size([155972, 32])
torch.Size([124182, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5140948295593262  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06564599275588989 |0.06973615288734436 |0.049424439668655396 |9.702146053314209e-05 |0.01517362892627716 |0.003998279571533203 |
----------------------------------------------------------pseudo_mini_loss sum 5.45753288269043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13098016
Number of first layer input nodes during this epoch:  2676132
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.2532520294189453  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.018431901931762695
random selection method range initialization spend 0.005277156829833984
time for parepare:  0.01841878890991211
local_output_nid generation:  0.0026175975799560547
local_in_edges_tensor generation:  0.005527496337890625
mini_batch_src_global generation:  0.0019745826721191406
r_  generation:  0.018999338150024414
local_output_nid generation:  0.0029261112213134766
local_in_edges_tensor generation:  0.0017719268798828125
mini_batch_src_global generation:  0.002074718475341797
r_  generation:  0.018963336944580078
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0016934871673583984
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.018756628036499023
local_output_nid generation:  0.0029006004333496094
local_in_edges_tensor generation:  0.001695394515991211
mini_batch_src_global generation:  0.0015456676483154297
r_  generation:  0.019266843795776367
local_output_nid generation:  0.0029044151306152344
local_in_edges_tensor generation:  0.0016939640045166016
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.01937556266784668
local_output_nid generation:  0.0029587745666503906
local_in_edges_tensor generation:  0.001695871353149414
mini_batch_src_global generation:  0.0015556812286376953
r_  generation:  0.01943182945251465
local_output_nid generation:  0.0029082298278808594
local_in_edges_tensor generation:  0.0016181468963623047
mini_batch_src_global generation:  0.0015804767608642578
r_  generation:  0.019596576690673828
local_output_nid generation:  0.0028612613677978516
local_in_edges_tensor generation:  0.0016636848449707031
mini_batch_src_global generation:  0.0015895366668701172
r_  generation:  0.020105361938476562
local_output_nid generation:  0.0029144287109375
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.0016186237335205078
r_  generation:  0.020239830017089844
local_output_nid generation:  0.002911090850830078
local_in_edges_tensor generation:  0.0016918182373046875
mini_batch_src_global generation:  0.0016183853149414062
r_  generation:  0.020455121994018555
local_output_nid generation:  0.0028913021087646484
local_in_edges_tensor generation:  0.0016772747039794922
mini_batch_src_global generation:  0.0016393661499023438
r_  generation:  0.020180702209472656
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0017142295837402344
mini_batch_src_global generation:  0.006387233734130859
r_  generation:  0.020866870880126953
local_output_nid generation:  0.0029230117797851562
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.0019466876983642578
r_  generation:  0.02150869369506836
local_output_nid generation:  0.0029327869415283203
local_in_edges_tensor generation:  0.0015988349914550781
mini_batch_src_global generation:  0.0018887519836425781
r_  generation:  0.021632671356201172
local_output_nid generation:  0.0029888153076171875
local_in_edges_tensor generation:  0.004143238067626953
mini_batch_src_global generation:  0.0018324851989746094
r_  generation:  0.02143239974975586
local_output_nid generation:  0.0030472278594970703
local_in_edges_tensor generation:  0.0018208026885986328
mini_batch_src_global generation:  0.0019137859344482422
r_  generation:  0.02183985710144043
----------------------check_connections_block total spend ----------------------------- 0.5406174659729004
generate_one_block  0.03124213218688965
generate_one_block  0.03414273262023926
generate_one_block  0.029800891876220703
generate_one_block  0.028109312057495117
generate_one_block  0.03084588050842285
generate_one_block  0.03064107894897461
generate_one_block  0.027519702911376953
generate_one_block  0.0280911922454834
generate_one_block  0.030866384506225586
generate_one_block  0.02861309051513672
generate_one_block  0.027885913848876953
generate_one_block  0.027443647384643555
generate_one_block  0.027106046676635742
generate_one_block  0.027253389358520508
generate_one_block  0.027668476104736328
generate_one_block  0.02821660041809082
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.039611101150512695
gen group dst list time:  0.016759634017944336
time for parepare:  0.0190427303314209
local_output_nid generation:  0.008408069610595703
local_in_edges_tensor generation:  0.018695592880249023
mini_batch_src_global generation:  0.02157735824584961
r_  generation:  0.20547890663146973
local_output_nid generation:  0.014630317687988281
local_in_edges_tensor generation:  0.019528865814208984
mini_batch_src_global generation:  0.024920225143432617
r_  generation:  0.20374011993408203
local_output_nid generation:  0.014539957046508789
local_in_edges_tensor generation:  0.015529870986938477
mini_batch_src_global generation:  0.023695707321166992
r_  generation:  0.21585655212402344
local_output_nid generation:  0.012805700302124023
local_in_edges_tensor generation:  0.02142024040222168
mini_batch_src_global generation:  0.025356054306030273
r_  generation:  0.22083473205566406
local_output_nid generation:  0.012557744979858398
local_in_edges_tensor generation:  0.019450664520263672
mini_batch_src_global generation:  0.02778935432434082
r_  generation:  0.23905658721923828
local_output_nid generation:  0.017957687377929688
local_in_edges_tensor generation:  0.02151775360107422
mini_batch_src_global generation:  0.030486345291137695
r_  generation:  0.22199487686157227
local_output_nid generation:  0.013147115707397461
local_in_edges_tensor generation:  0.01635122299194336
mini_batch_src_global generation:  0.026768922805786133
r_  generation:  0.2301628589630127
local_output_nid generation:  0.013289928436279297
local_in_edges_tensor generation:  0.01793670654296875
mini_batch_src_global generation:  0.02752518653869629
r_  generation:  0.2269902229309082
local_output_nid generation:  0.013400554656982422
local_in_edges_tensor generation:  0.0164339542388916
mini_batch_src_global generation:  0.028325557708740234
r_  generation:  0.23340940475463867
local_output_nid generation:  0.013418912887573242
local_in_edges_tensor generation:  0.012686967849731445
mini_batch_src_global generation:  0.02768230438232422
r_  generation:  0.2355811595916748
local_output_nid generation:  0.013196706771850586
local_in_edges_tensor generation:  0.016283273696899414
mini_batch_src_global generation:  0.027707338333129883
r_  generation:  0.22504663467407227
local_output_nid generation:  0.012746810913085938
local_in_edges_tensor generation:  0.012355804443359375
mini_batch_src_global generation:  0.02734541893005371
r_  generation:  0.2192704677581787
local_output_nid generation:  0.013823270797729492
local_in_edges_tensor generation:  0.024390697479248047
mini_batch_src_global generation:  0.02857494354248047
r_  generation:  0.23337697982788086
local_output_nid generation:  0.016171693801879883
local_in_edges_tensor generation:  0.01830267906188965
mini_batch_src_global generation:  0.02806401252746582
r_  generation:  0.22364020347595215
local_output_nid generation:  0.01271820068359375
local_in_edges_tensor generation:  0.012521028518676758
mini_batch_src_global generation:  0.02669358253479004
r_  generation:  0.21418237686157227
local_output_nid generation:  0.01255035400390625
local_in_edges_tensor generation:  0.014530420303344727
mini_batch_src_global generation:  0.027025461196899414
r_  generation:  0.23107004165649414
----------------------check_connections_block total spend ----------------------------- 5.296545028686523
generate_one_block  0.2983386516571045
generate_one_block  0.26992321014404297
generate_one_block  0.2870333194732666
generate_one_block  0.28287529945373535
generate_one_block  0.2863650321960449
generate_one_block  0.27506327629089355
generate_one_block  0.3074665069580078
generate_one_block  0.29146456718444824
generate_one_block  0.29230570793151855
generate_one_block  0.2886645793914795
generate_one_block  0.28699779510498047
generate_one_block  0.26756882667541504
generate_one_block  0.2779731750488281
generate_one_block  0.28140950202941895
generate_one_block  0.2855865955352783
generate_one_block  0.2776350975036621
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.052124738693237305
gen group dst list time:  0.06561636924743652
time for parepare:  0.01740121841430664
local_output_nid generation:  0.026578664779663086
local_in_edges_tensor generation:  0.05511021614074707
mini_batch_src_global generation:  0.04953932762145996
r_  generation:  0.49791765213012695
local_output_nid generation:  0.031211376190185547
local_in_edges_tensor generation:  0.05096578598022461
mini_batch_src_global generation:  0.058852434158325195
r_  generation:  0.4970426559448242
local_output_nid generation:  0.031871795654296875
local_in_edges_tensor generation:  0.037634849548339844
mini_batch_src_global generation:  0.05817365646362305
r_  generation:  0.5097322463989258
local_output_nid generation:  0.03162980079650879
local_in_edges_tensor generation:  0.046297311782836914
mini_batch_src_global generation:  0.05937933921813965
r_  generation:  0.5038087368011475
local_output_nid generation:  0.03176116943359375
local_in_edges_tensor generation:  0.08153891563415527
mini_batch_src_global generation:  0.058594465255737305
r_  generation:  0.5171136856079102
local_output_nid generation:  0.03141450881958008
local_in_edges_tensor generation:  0.03327631950378418
mini_batch_src_global generation:  0.05911755561828613
r_  generation:  0.5094988346099854
local_output_nid generation:  0.0313267707824707
local_in_edges_tensor generation:  0.03701186180114746
mini_batch_src_global generation:  0.058929443359375
r_  generation:  0.5053226947784424
local_output_nid generation:  0.03146171569824219
local_in_edges_tensor generation:  0.0449986457824707
mini_batch_src_global generation:  0.05975055694580078
r_  generation:  0.5106785297393799
local_output_nid generation:  0.03347158432006836
local_in_edges_tensor generation:  0.03979086875915527
mini_batch_src_global generation:  0.05921363830566406
r_  generation:  0.5096032619476318
local_output_nid generation:  0.03592252731323242
local_in_edges_tensor generation:  0.04849886894226074
mini_batch_src_global generation:  0.07041025161743164
r_  generation:  0.5145776271820068
local_output_nid generation:  0.03525352478027344
local_in_edges_tensor generation:  0.041901350021362305
mini_batch_src_global generation:  0.061087846755981445
r_  generation:  0.5160267353057861
local_output_nid generation:  0.03323793411254883
local_in_edges_tensor generation:  0.03752565383911133
mini_batch_src_global generation:  0.06040620803833008
r_  generation:  0.516185998916626
local_output_nid generation:  0.032804012298583984
local_in_edges_tensor generation:  0.0378880500793457
mini_batch_src_global generation:  0.058638811111450195
r_  generation:  0.5075027942657471
local_output_nid generation:  0.03291487693786621
local_in_edges_tensor generation:  0.047089338302612305
mini_batch_src_global generation:  0.06023430824279785
r_  generation:  0.5163638591766357
local_output_nid generation:  0.03281998634338379
local_in_edges_tensor generation:  0.0377197265625
mini_batch_src_global generation:  0.06138348579406738
r_  generation:  0.5054936408996582
local_output_nid generation:  0.03297138214111328
local_in_edges_tensor generation:  0.03719377517700195
mini_batch_src_global generation:  0.06331586837768555
r_  generation:  0.5088353157043457
----------------------check_connections_block total spend ----------------------------- 12.062782049179077
generate_one_block  0.6518847942352295
generate_one_block  0.6582729816436768
generate_one_block  0.6505327224731445
generate_one_block  0.6693732738494873
generate_one_block  0.6556169986724854
generate_one_block  0.6426630020141602
generate_one_block  0.6511623859405518
generate_one_block  0.6625819206237793
generate_one_block  0.7024660110473633
generate_one_block  0.65879225730896
generate_one_block  0.6375234127044678
generate_one_block  0.6495938301086426
generate_one_block  0.6520450115203857
generate_one_block  0.6792306900024414
generate_one_block  0.6517994403839111
generate_one_block  0.6464107036590576
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05148005485534668
gen group dst list time:  0.09789109230041504
time for parepare:  0.019812583923339844
local_output_nid generation:  0.03356528282165527
local_in_edges_tensor generation:  0.0634462833404541
mini_batch_src_global generation:  0.054709434509277344
r_  generation:  0.5374484062194824
local_output_nid generation:  0.04067683219909668
local_in_edges_tensor generation:  0.056746482849121094
mini_batch_src_global generation:  0.06379175186157227
r_  generation:  0.5443689823150635
local_output_nid generation:  0.03999018669128418
local_in_edges_tensor generation:  0.042356252670288086
mini_batch_src_global generation:  0.05999922752380371
r_  generation:  0.5513169765472412
local_output_nid generation:  0.0404050350189209
local_in_edges_tensor generation:  0.0410313606262207
mini_batch_src_global generation:  0.07074236869812012
r_  generation:  0.5587289333343506
local_output_nid generation:  0.04008793830871582
local_in_edges_tensor generation:  0.04209589958190918
mini_batch_src_global generation:  0.0598139762878418
r_  generation:  0.5631411075592041
local_output_nid generation:  0.037679195404052734
local_in_edges_tensor generation:  0.04073834419250488
mini_batch_src_global generation:  0.05972886085510254
r_  generation:  0.5708324909210205
local_output_nid generation:  0.037436723709106445
local_in_edges_tensor generation:  0.04213070869445801
mini_batch_src_global generation:  0.06093454360961914
r_  generation:  0.5650303363800049
local_output_nid generation:  0.03747248649597168
local_in_edges_tensor generation:  0.04141831398010254
mini_batch_src_global generation:  0.06135964393615723
r_  generation:  0.5690314769744873
local_output_nid generation:  0.03741335868835449
local_in_edges_tensor generation:  0.04230141639709473
mini_batch_src_global generation:  0.062079668045043945
r_  generation:  0.5709617137908936
local_output_nid generation:  0.037784576416015625
local_in_edges_tensor generation:  0.04150676727294922
mini_batch_src_global generation:  0.061405181884765625
r_  generation:  0.5872664451599121
local_output_nid generation:  0.037482500076293945
local_in_edges_tensor generation:  0.042268991470336914
mini_batch_src_global generation:  0.062107086181640625
r_  generation:  0.5775811672210693
local_output_nid generation:  0.037763357162475586
local_in_edges_tensor generation:  0.041483402252197266
mini_batch_src_global generation:  0.06178164482116699
r_  generation:  0.576563835144043
local_output_nid generation:  0.03812766075134277
local_in_edges_tensor generation:  0.04574012756347656
mini_batch_src_global generation:  0.06285572052001953
r_  generation:  0.5782063007354736
local_output_nid generation:  0.03755593299865723
local_in_edges_tensor generation:  0.041208744049072266
mini_batch_src_global generation:  0.0627593994140625
r_  generation:  0.5765533447265625
local_output_nid generation:  0.03749251365661621
local_in_edges_tensor generation:  0.042435646057128906
mini_batch_src_global generation:  0.06322360038757324
r_  generation:  0.5744247436523438
local_output_nid generation:  0.03765869140625
local_in_edges_tensor generation:  0.04174447059631348
mini_batch_src_global generation:  0.062391042709350586
r_  generation:  0.5709741115570068
----------------------check_connections_block total spend ----------------------------- 13.47905158996582
generate_one_block  0.7130119800567627
generate_one_block  0.7059440612792969
generate_one_block  0.6947646141052246
generate_one_block  0.7025887966156006
generate_one_block  0.6952512264251709
generate_one_block  0.6869630813598633
generate_one_block  0.7779445648193359
generate_one_block  0.7080426216125488
generate_one_block  0.7135264873504639
generate_one_block  0.6961331367492676
generate_one_block  0.6954145431518555
generate_one_block  0.69866943359375
generate_one_block  0.7095160484313965
generate_one_block  0.6874632835388184
generate_one_block  0.7075228691101074
generate_one_block  0.7080926895141602
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039904117584228516
gen group dst list time:  0.10609984397888184
time for parepare:  0.019294023513793945
local_output_nid generation:  0.03593182563781738
local_in_edges_tensor generation:  0.05850410461425781
mini_batch_src_global generation:  0.04752612113952637
r_  generation:  0.5498449802398682
local_output_nid generation:  0.04186511039733887
local_in_edges_tensor generation:  0.0479581356048584
mini_batch_src_global generation:  0.06385231018066406
r_  generation:  0.5430698394775391
local_output_nid generation:  0.040078163146972656
local_in_edges_tensor generation:  0.04257917404174805
mini_batch_src_global generation:  0.0628361701965332
r_  generation:  0.5621755123138428
local_output_nid generation:  0.0403599739074707
local_in_edges_tensor generation:  0.042827606201171875
mini_batch_src_global generation:  0.06234383583068848
r_  generation:  0.5459780693054199
local_output_nid generation:  0.04041862487792969
local_in_edges_tensor generation:  0.0428469181060791
mini_batch_src_global generation:  0.06192302703857422
r_  generation:  0.5595018863677979
local_output_nid generation:  0.040190696716308594
local_in_edges_tensor generation:  0.04302406311035156
mini_batch_src_global generation:  0.062225341796875
r_  generation:  0.5516552925109863
local_output_nid generation:  0.04033231735229492
local_in_edges_tensor generation:  0.04357600212097168
mini_batch_src_global generation:  0.06168866157531738
r_  generation:  0.5601296424865723
local_output_nid generation:  0.03995966911315918
local_in_edges_tensor generation:  0.04304027557373047
mini_batch_src_global generation:  0.06221747398376465
r_  generation:  0.5538544654846191
local_output_nid generation:  0.04010796546936035
local_in_edges_tensor generation:  0.048718929290771484
mini_batch_src_global generation:  0.06134510040283203
r_  generation:  0.5598740577697754
local_output_nid generation:  0.04011368751525879
local_in_edges_tensor generation:  0.042821645736694336
mini_batch_src_global generation:  0.06266093254089355
r_  generation:  0.5547018051147461
local_output_nid generation:  0.04586195945739746
local_in_edges_tensor generation:  0.042069435119628906
mini_batch_src_global generation:  0.06102418899536133
r_  generation:  0.5606460571289062
local_output_nid generation:  0.04010319709777832
local_in_edges_tensor generation:  0.04820895195007324
mini_batch_src_global generation:  0.06225943565368652
r_  generation:  0.564406156539917
local_output_nid generation:  0.04012179374694824
local_in_edges_tensor generation:  0.042366743087768555
mini_batch_src_global generation:  0.061919450759887695
r_  generation:  0.5649764537811279
local_output_nid generation:  0.04034137725830078
local_in_edges_tensor generation:  0.043013811111450195
mini_batch_src_global generation:  0.061478376388549805
r_  generation:  0.5700380802154541
local_output_nid generation:  0.040315866470336914
local_in_edges_tensor generation:  0.047715187072753906
mini_batch_src_global generation:  0.06180000305175781
r_  generation:  0.5618793964385986
local_output_nid generation:  0.04012322425842285
local_in_edges_tensor generation:  0.04278731346130371
mini_batch_src_global generation:  0.06236672401428223
r_  generation:  0.5688631534576416
----------------------check_connections_block total spend ----------------------------- 13.405210256576538
generate_one_block  0.6893453598022461
generate_one_block  0.6958084106445312
generate_one_block  0.6904826164245605
generate_one_block  0.6931202411651611
generate_one_block  0.697063684463501
generate_one_block  0.6863532066345215
generate_one_block  0.6928708553314209
generate_one_block  0.6902737617492676
generate_one_block  0.6970047950744629
generate_one_block  0.7689614295959473
generate_one_block  0.6922035217285156
generate_one_block  0.6967184543609619
generate_one_block  0.7125759124755859
generate_one_block  0.6890323162078857
generate_one_block  0.7033562660217285
generate_one_block  0.7062902450561523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04269123077392578
gen group dst list time:  0.09523677825927734
time for parepare:  0.01937413215637207
local_output_nid generation:  0.0371699333190918
local_in_edges_tensor generation:  0.04854440689086914
mini_batch_src_global generation:  0.04521059989929199
r_  generation:  0.5030357837677002
local_output_nid generation:  0.0436253547668457
local_in_edges_tensor generation:  0.04377126693725586
mini_batch_src_global generation:  0.05797243118286133
r_  generation:  0.5059690475463867
local_output_nid generation:  0.043407440185546875
local_in_edges_tensor generation:  0.0414128303527832
mini_batch_src_global generation:  0.05843353271484375
r_  generation:  0.509657621383667
local_output_nid generation:  0.04360556602478027
local_in_edges_tensor generation:  0.050230979919433594
mini_batch_src_global generation:  0.05853605270385742
r_  generation:  0.5095467567443848
local_output_nid generation:  0.043930768966674805
local_in_edges_tensor generation:  0.041487932205200195
mini_batch_src_global generation:  0.058249473571777344
r_  generation:  0.5147552490234375
local_output_nid generation:  0.04266667366027832
local_in_edges_tensor generation:  0.04210257530212402
mini_batch_src_global generation:  0.058866262435913086
r_  generation:  0.5087473392486572
local_output_nid generation:  0.040641069412231445
local_in_edges_tensor generation:  0.03986167907714844
mini_batch_src_global generation:  0.05790400505065918
r_  generation:  0.5217869281768799
local_output_nid generation:  0.0430448055267334
local_in_edges_tensor generation:  0.04128313064575195
mini_batch_src_global generation:  0.06227827072143555
r_  generation:  0.5177338123321533
local_output_nid generation:  0.041925668716430664
local_in_edges_tensor generation:  0.04615664482116699
mini_batch_src_global generation:  0.05829501152038574
r_  generation:  0.5220355987548828
local_output_nid generation:  0.04259490966796875
local_in_edges_tensor generation:  0.03766226768493652
mini_batch_src_global generation:  0.058155059814453125
r_  generation:  0.5152480602264404
local_output_nid generation:  0.04180908203125
local_in_edges_tensor generation:  0.04136776924133301
mini_batch_src_global generation:  0.06192517280578613
r_  generation:  0.5165088176727295
local_output_nid generation:  0.04188084602355957
local_in_edges_tensor generation:  0.043009042739868164
mini_batch_src_global generation:  0.057924509048461914
r_  generation:  0.5125551223754883
local_output_nid generation:  0.04179859161376953
local_in_edges_tensor generation:  0.04106426239013672
mini_batch_src_global generation:  0.057823896408081055
r_  generation:  0.5146565437316895
local_output_nid generation:  0.041878461837768555
local_in_edges_tensor generation:  0.04091835021972656
mini_batch_src_global generation:  0.05754852294921875
r_  generation:  0.5133883953094482
local_output_nid generation:  0.04367852210998535
local_in_edges_tensor generation:  0.04146862030029297
mini_batch_src_global generation:  0.05812239646911621
r_  generation:  0.5151102542877197
local_output_nid generation:  0.04166531562805176
local_in_edges_tensor generation:  0.04545164108276367
mini_batch_src_global generation:  0.05712270736694336
r_  generation:  0.5345869064331055
----------------------check_connections_block total spend ----------------------------- 12.500259637832642
generate_one_block  0.6364634037017822
generate_one_block  0.6456444263458252
generate_one_block  0.6357359886169434
generate_one_block  0.6393628120422363
generate_one_block  0.6420931816101074
generate_one_block  0.6297991275787354
generate_one_block  0.636988639831543
generate_one_block  0.6379311084747314
generate_one_block  0.6474745273590088
generate_one_block  0.6326093673706055
generate_one_block  0.6484684944152832
generate_one_block  0.6480696201324463
generate_one_block  0.7162833213806152
generate_one_block  0.6360697746276855
generate_one_block  0.6437087059020996
generate_one_block  0.6351420879364014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.2532520294189453  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

connection checking time:  56.7438485622406
block generation total time  47.89077568054199
average batch blocks generation time:  2.9931734800338745
block dataloader generation time/epoch 108.20484519004822
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13730287551879883  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167236, 128])
torch.Size([166428, 32])
torch.Size([164107, 32])
torch.Size([156147, 32])
torch.Size([124824, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5151605606079102  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13718652725219727  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167184, 128])
torch.Size([166376, 32])
torch.Size([164036, 32])
torch.Size([155668, 32])
torch.Size([123062, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5126509666442871  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1372232437133789  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167240, 128])
torch.Size([166415, 32])
torch.Size([163996, 32])
torch.Size([155944, 32])
torch.Size([123844, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5136814117431641  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13728046417236328  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167184, 128])
torch.Size([166408, 32])
torch.Size([164040, 32])
torch.Size([155911, 32])
torch.Size([124311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5145053863525391  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13725805282592773  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167216, 128])
torch.Size([166432, 32])
torch.Size([164057, 32])
torch.Size([155904, 32])
torch.Size([123957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5142626762390137  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13721466064453125  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167204, 128])
torch.Size([166358, 32])
torch.Size([163823, 32])
torch.Size([155474, 32])
torch.Size([123341, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.509453296661377  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13721132278442383  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167171, 128])
torch.Size([166285, 32])
torch.Size([163806, 32])
torch.Size([155624, 32])
torch.Size([123370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5094094276428223  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1372847557067871  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167126, 128])
torch.Size([166349, 32])
torch.Size([163949, 32])
torch.Size([155842, 32])
torch.Size([124159, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.514460563659668  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13730573654174805  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167213, 128])
torch.Size([166447, 32])
torch.Size([164147, 32])
torch.Size([156028, 32])
torch.Size([124562, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5152087211608887  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.137298583984375  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167165, 128])
torch.Size([166297, 32])
torch.Size([163834, 32])
torch.Size([155777, 32])
torch.Size([124655, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5147194862365723  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1372356414794922  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167234, 128])
torch.Size([166424, 32])
torch.Size([163935, 32])
torch.Size([155685, 32])
torch.Size([123690, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5139083862304688  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13719844818115234  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167245, 128])
torch.Size([166433, 32])
torch.Size([164105, 32])
torch.Size([155881, 32])
torch.Size([123397, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5127177238464355  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13724946975708008  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167211, 128])
torch.Size([166435, 32])
torch.Size([164076, 32])
torch.Size([155863, 32])
torch.Size([123809, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5138521194458008  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13723373413085938  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167237, 128])
torch.Size([166445, 32])
torch.Size([163981, 32])
torch.Size([155519, 32])
torch.Size([123622, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5096383094787598  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13715648651123047  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167233, 128])
torch.Size([166383, 32])
torch.Size([163917, 32])
torch.Size([155433, 32])
torch.Size([122708, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5083165168762207  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13723325729370117  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

torch.Size([167176, 128])
torch.Size([166362, 32])
torch.Size([163938, 32])
torch.Size([155545, 32])
torch.Size([123629, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5096745491027832  GigaBytes
Max Memory Allocated: 0.5286417007446289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06628412008285522 |0.046786144375801086 |0.006618008017539978 |9.18954610824585e-05 |0.00758148729801178 |0.002538442611694336 |
----------------------------------------------------------pseudo_mini_loss sum 4.840301990509033
Total (block generation + training)time/epoch 110.31244683265686
Training time/epoch 2.1072802543640137
Training time without block to device /epoch 1.3587019443511963
Training time without total dataloading part /epoch 0.2312006950378418
load block tensor time/epoch 1.0605459213256836
block to device time/epoch 0.7485783100128174
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13095968
Number of first layer input nodes during this epoch:  2675275
