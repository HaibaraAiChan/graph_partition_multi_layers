Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648478789.696325
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024698257446289062
random selection method range initialization spend 0.006087064743041992
time for parepare:  0.0181121826171875
local_output_nid generation:  0.00832509994506836
local_in_edges_tensor generation:  0.009232282638549805
mini_batch_src_global generation:  0.0061452388763427734
r_  generation:  0.08107900619506836
local_output_nid generation:  0.01187586784362793
local_in_edges_tensor generation:  0.006178855895996094
mini_batch_src_global generation:  0.008649826049804688
r_  generation:  0.08936715126037598
local_output_nid generation:  0.012030839920043945
local_in_edges_tensor generation:  0.006207704544067383
mini_batch_src_global generation:  0.006653547286987305
r_  generation:  0.09069299697875977
local_output_nid generation:  0.01197052001953125
local_in_edges_tensor generation:  0.006106138229370117
mini_batch_src_global generation:  0.007036447525024414
r_  generation:  0.09389805793762207
----------------------check_connections_block total spend ----------------------------- 0.5527739524841309
generate_one_block  0.10408496856689453
generate_one_block  0.10376858711242676
generate_one_block  0.1054074764251709
generate_one_block  0.10230207443237305
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.042951345443725586
gen group dst list time:  0.010658740997314453
time for parepare:  0.01974344253540039
local_output_nid generation:  0.020491838455200195
local_in_edges_tensor generation:  0.042322635650634766
mini_batch_src_global generation:  0.037978410720825195
r_  generation:  0.4088256359100342
local_output_nid generation:  0.02942633628845215
local_in_edges_tensor generation:  0.03932833671569824
mini_batch_src_global generation:  0.04982280731201172
r_  generation:  0.4300990104675293
local_output_nid generation:  0.03034663200378418
local_in_edges_tensor generation:  0.03234219551086426
mini_batch_src_global generation:  0.0502171516418457
r_  generation:  0.44585704803466797
local_output_nid generation:  0.026700735092163086
local_in_edges_tensor generation:  0.04643750190734863
mini_batch_src_global generation:  0.06775617599487305
r_  generation:  0.4299776554107666
----------------------check_connections_block total spend ----------------------------- 2.612089157104492
generate_one_block  0.5921611785888672
generate_one_block  0.559730052947998
generate_one_block  0.5502355098724365
generate_one_block  0.5687310695648193
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05869436264038086
gen group dst list time:  0.02230668067932129
time for parepare:  0.020698070526123047
local_output_nid generation:  0.03059864044189453
local_in_edges_tensor generation:  0.056400299072265625
mini_batch_src_global generation:  0.05561256408691406
r_  generation:  0.5557365417480469
local_output_nid generation:  0.04152083396911621
local_in_edges_tensor generation:  0.06317710876464844
mini_batch_src_global generation:  0.06003141403198242
r_  generation:  0.5424308776855469
local_output_nid generation:  0.03834843635559082
local_in_edges_tensor generation:  0.05129718780517578
mini_batch_src_global generation:  0.05688166618347168
r_  generation:  0.5655374526977539
local_output_nid generation:  0.03869938850402832
local_in_edges_tensor generation:  0.048766136169433594
mini_batch_src_global generation:  0.05751919746398926
r_  generation:  0.5584087371826172
----------------------check_connections_block total spend ----------------------------- 3.3425774574279785
generate_one_block  0.73197340965271
generate_one_block  0.6910374164581299
generate_one_block  0.688978910446167
generate_one_block  0.6927707195281982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04928898811340332
gen group dst list time:  0.028494834899902344
time for parepare:  0.018801450729370117
local_output_nid generation:  0.03393721580505371
local_in_edges_tensor generation:  0.05858969688415527
mini_batch_src_global generation:  0.04661369323730469
r_  generation:  0.507152795791626
local_output_nid generation:  0.03904604911804199
local_in_edges_tensor generation:  0.04722261428833008
mini_batch_src_global generation:  0.05720376968383789
r_  generation:  0.5179619789123535
local_output_nid generation:  0.04006552696228027
local_in_edges_tensor generation:  0.05508279800415039
mini_batch_src_global generation:  0.057076215744018555
r_  generation:  0.5164847373962402
local_output_nid generation:  0.03944253921508789
local_in_edges_tensor generation:  0.03969264030456543
mini_batch_src_global generation:  0.05752730369567871
r_  generation:  0.5201599597930908
----------------------check_connections_block total spend ----------------------------- 3.1392481327056885
generate_one_block  0.6449005603790283
generate_one_block  0.671273946762085
generate_one_block  0.6540050506591797
generate_one_block  0.6293206214904785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  9.09391474723816
block generation total time  7.675118446350098
average batch blocks generation time:  1.9187796115875244
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11604166030883789  GigaBytes
Max Memory Allocated: 0.11604166030883789  GigaBytes

torch.Size([166674, 128])
torch.Size([164599, 64])
torch.Size([154853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.5498256683349609  GigaBytes
Max Memory Allocated: 0.5682621002197266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.12013578414916992  GigaBytes
Max Memory Allocated: 0.596470832824707  GigaBytes

torch.Size([166642, 128])
torch.Size([164721, 64])
torch.Size([154724, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.5518770217895508  GigaBytes
Max Memory Allocated: 0.596470832824707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12107658386230469  GigaBytes
Max Memory Allocated: 0.5985441207885742  GigaBytes

torch.Size([166690, 128])
torch.Size([164757, 64])
torch.Size([155071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5521378517150879  GigaBytes
Max Memory Allocated: 0.5985441207885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12056827545166016  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

torch.Size([166620, 128])
torch.Size([164616, 64])
torch.Size([154957, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5519003868103027  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0488055944442749 |0.11001169681549072 |0.18622225522994995 |0.00011867284774780273 |0.027409255504608154 |0.00254058837890625 |
----------------------------------------------------------pseudo_mini_loss sum 5.547855377197266
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2350069
Number of first layer input nodes during this epoch:  666626
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.19751214981079102  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.017410993576049805
random selection method range initialization spend 0.005497932434082031
time for parepare:  0.018019437789916992
local_output_nid generation:  0.008813142776489258
local_in_edges_tensor generation:  0.01242685317993164
mini_batch_src_global generation:  0.006450653076171875
r_  generation:  0.08165264129638672
local_output_nid generation:  0.012017011642456055
local_in_edges_tensor generation:  0.005869150161743164
mini_batch_src_global generation:  0.008774757385253906
r_  generation:  0.08848786354064941
local_output_nid generation:  0.013685464859008789
local_in_edges_tensor generation:  0.005927562713623047
mini_batch_src_global generation:  0.006554841995239258
r_  generation:  0.09120869636535645
local_output_nid generation:  0.012052059173583984
local_in_edges_tensor generation:  0.005941867828369141
mini_batch_src_global generation:  0.0074117183685302734
r_  generation:  0.09616613388061523
----------------------check_connections_block total spend ----------------------------- 0.5658886432647705
generate_one_block  0.1085507869720459
generate_one_block  0.10377264022827148
generate_one_block  0.10355353355407715
generate_one_block  0.10495591163635254
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04167342185974121
gen group dst list time:  0.011198997497558594
time for parepare:  0.01933884620666504
local_output_nid generation:  0.020156383514404297
local_in_edges_tensor generation:  0.04366588592529297
mini_batch_src_global generation:  0.04291486740112305
r_  generation:  0.41997718811035156
local_output_nid generation:  0.027774572372436523
local_in_edges_tensor generation:  0.04116225242614746
mini_batch_src_global generation:  0.05307412147521973
r_  generation:  0.4518768787384033
local_output_nid generation:  0.03166961669921875
local_in_edges_tensor generation:  0.048136234283447266
mini_batch_src_global generation:  0.056563377380371094
r_  generation:  0.4315810203552246
local_output_nid generation:  0.028403043746948242
local_in_edges_tensor generation:  0.03556394577026367
mini_batch_src_global generation:  0.04962444305419922
r_  generation:  0.431546688079834
----------------------check_connections_block total spend ----------------------------- 2.6178932189941406
generate_one_block  0.5741574764251709
generate_one_block  0.5621843338012695
generate_one_block  0.5761306285858154
generate_one_block  0.558455228805542
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04428410530090332
gen group dst list time:  0.021401643753051758
time for parepare:  0.01908111572265625
local_output_nid generation:  0.02912759780883789
local_in_edges_tensor generation:  0.08578681945800781
mini_batch_src_global generation:  0.06569838523864746
r_  generation:  0.5436553955078125
local_output_nid generation:  0.036614179611206055
local_in_edges_tensor generation:  0.055024147033691406
mini_batch_src_global generation:  0.06701350212097168
r_  generation:  0.5479273796081543
local_output_nid generation:  0.037479400634765625
local_in_edges_tensor generation:  0.05230522155761719
mini_batch_src_global generation:  0.05874943733215332
r_  generation:  0.5759520530700684
local_output_nid generation:  0.04000377655029297
local_in_edges_tensor generation:  0.052445411682128906
mini_batch_src_global generation:  0.06577944755554199
r_  generation:  0.5636124610900879
----------------------check_connections_block total spend ----------------------------- 3.398010730743408
generate_one_block  0.6776142120361328
generate_one_block  0.6983137130737305
generate_one_block  0.693387508392334
generate_one_block  0.6914162635803223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037353515625
gen group dst list time:  0.028285741806030273
time for parepare:  0.01881551742553711
local_output_nid generation:  0.03278231620788574
local_in_edges_tensor generation:  0.05319333076477051
mini_batch_src_global generation:  0.05436086654663086
r_  generation:  0.5091965198516846
local_output_nid generation:  0.03755760192871094
local_in_edges_tensor generation:  0.05295729637145996
mini_batch_src_global generation:  0.057375431060791016
r_  generation:  0.5163784027099609
local_output_nid generation:  0.03833818435668945
local_in_edges_tensor generation:  0.03867077827453613
mini_batch_src_global generation:  0.06168794631958008
r_  generation:  0.5188076496124268
local_output_nid generation:  0.03783273696899414
local_in_edges_tensor generation:  0.03497934341430664
mini_batch_src_global generation:  0.05799150466918945
r_  generation:  0.5191495418548584
----------------------check_connections_block total spend ----------------------------- 3.1121468544006348
generate_one_block  0.637305498123169
generate_one_block  0.6491613388061523
generate_one_block  0.6544356346130371
generate_one_block  0.6778755187988281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.19751214981079102  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

connection checking time:  9.128050804138184
block generation total time  7.650437355041504
average batch blocks generation time:  1.912609338760376
block dataloader generation time/epoch 18.860681295394897
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12110519409179688  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

torch.Size([166711, 128])
torch.Size([164763, 64])
torch.Size([155030, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5518937110900879  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12050390243530273  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

torch.Size([166686, 128])
torch.Size([164682, 64])
torch.Size([154876, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5524892807006836  GigaBytes
Max Memory Allocated: 0.5990681648254395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12035751342773438  GigaBytes
Max Memory Allocated: 0.5993795394897461  GigaBytes

torch.Size([166725, 128])
torch.Size([164736, 64])
torch.Size([154878, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.550788402557373  GigaBytes
Max Memory Allocated: 0.5993795394897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.1207423210144043  GigaBytes
Max Memory Allocated: 0.5993795394897461  GigaBytes

torch.Size([166630, 128])
torch.Size([164623, 64])
torch.Size([155016, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5519709587097168  GigaBytes
Max Memory Allocated: 0.5993795394897461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046434998512268066 |0.03346896171569824 |0.005013108253479004 |0.00010371208190917969 |0.029250502586364746 |0.0017218589782714844 |
----------------------------------------------------------pseudo_mini_loss sum 4.413383960723877
Total (block generation + training)time/epoch 19.363407850265503
Training time/epoch 0.5024280548095703
Training time without block to device /epoch 0.36855220794677734
Training time without total dataloading part /epoch 0.1391911506652832
load block tensor time/epoch 0.18573999404907227
block to device time/epoch 0.13387584686279297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2350376
Number of first layer input nodes during this epoch:  666752
