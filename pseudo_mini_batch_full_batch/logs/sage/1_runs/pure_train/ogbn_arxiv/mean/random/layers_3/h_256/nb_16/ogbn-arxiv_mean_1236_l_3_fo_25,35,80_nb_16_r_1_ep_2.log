Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648443982.7312734
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0365908145904541
random selection method range initialization spend 0.0065500736236572266
time for parepare:  0.018524885177612305
local_output_nid generation:  0.0021173954010009766
local_in_edges_tensor generation:  0.004930734634399414
mini_batch_src_global generation:  0.001947641372680664
r_  generation:  0.020003318786621094
local_output_nid generation:  0.0026443004608154297
local_in_edges_tensor generation:  0.0017650127410888672
mini_batch_src_global generation:  0.002411365509033203
r_  generation:  0.019976377487182617
local_output_nid generation:  0.002874612808227539
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0015499591827392578
r_  generation:  0.021214962005615234
local_output_nid generation:  0.002950429916381836
local_in_edges_tensor generation:  0.0016548633575439453
mini_batch_src_global generation:  0.0016622543334960938
r_  generation:  0.020314931869506836
local_output_nid generation:  0.0030062198638916016
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.01915597915649414
local_output_nid generation:  0.002920389175415039
local_in_edges_tensor generation:  0.0016014575958251953
mini_batch_src_global generation:  0.0016629695892333984
r_  generation:  0.020778417587280273
local_output_nid generation:  0.0028886795043945312
local_in_edges_tensor generation:  0.001569986343383789
mini_batch_src_global generation:  0.0016160011291503906
r_  generation:  0.020496606826782227
local_output_nid generation:  0.002939462661743164
local_in_edges_tensor generation:  0.0015721321105957031
mini_batch_src_global generation:  0.0017311573028564453
r_  generation:  0.020176410675048828
local_output_nid generation:  0.0029213428497314453
local_in_edges_tensor generation:  0.001580953598022461
mini_batch_src_global generation:  0.001641988754272461
r_  generation:  0.020918607711791992
local_output_nid generation:  0.002946615219116211
local_in_edges_tensor generation:  0.0016636848449707031
mini_batch_src_global generation:  0.0017232894897460938
r_  generation:  0.020712614059448242
local_output_nid generation:  0.0029287338256835938
local_in_edges_tensor generation:  0.00156402587890625
mini_batch_src_global generation:  0.0017457008361816406
r_  generation:  0.02083563804626465
local_output_nid generation:  0.0029196739196777344
local_in_edges_tensor generation:  0.0016393661499023438
mini_batch_src_global generation:  0.0017147064208984375
r_  generation:  0.02127695083618164
local_output_nid generation:  0.002929210662841797
local_in_edges_tensor generation:  0.0015773773193359375
mini_batch_src_global generation:  0.0017659664154052734
r_  generation:  0.02091383934020996
local_output_nid generation:  0.002878427505493164
local_in_edges_tensor generation:  0.0015673637390136719
mini_batch_src_global generation:  0.0017733573913574219
r_  generation:  0.021473169326782227
local_output_nid generation:  0.002997875213623047
local_in_edges_tensor generation:  0.0016314983367919922
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.021535396575927734
local_output_nid generation:  0.002992391586303711
local_in_edges_tensor generation:  0.0016620159149169922
mini_batch_src_global generation:  0.0017135143280029297
r_  generation:  0.021203279495239258
----------------------check_connections_block total spend ----------------------------- 0.5366270542144775
generate_one_block  0.03187727928161621
generate_one_block  0.031236886978149414
generate_one_block  0.034900665283203125
generate_one_block  0.03159737586975098
generate_one_block  0.029321908950805664
generate_one_block  0.03151273727416992
generate_one_block  0.030683517456054688
generate_one_block  0.030300378799438477
generate_one_block  0.03127312660217285
generate_one_block  0.030965328216552734
generate_one_block  0.030697107315063477
generate_one_block  0.03139805793762207
generate_one_block  0.030907154083251953
generate_one_block  0.031293630599975586
generate_one_block  0.03101181983947754
generate_one_block  0.030568361282348633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04080963134765625
gen group dst list time:  0.020513534545898438
time for parepare:  0.019120454788208008
local_output_nid generation:  0.00897669792175293
local_in_edges_tensor generation:  0.02216792106628418
mini_batch_src_global generation:  0.023076534271240234
r_  generation:  0.21362590789794922
local_output_nid generation:  0.013123035430908203
local_in_edges_tensor generation:  0.022176504135131836
mini_batch_src_global generation:  0.026374340057373047
r_  generation:  0.22622060775756836
local_output_nid generation:  0.013109683990478516
local_in_edges_tensor generation:  0.018667936325073242
mini_batch_src_global generation:  0.04095888137817383
r_  generation:  0.23145723342895508
local_output_nid generation:  0.012832164764404297
local_in_edges_tensor generation:  0.018105030059814453
mini_batch_src_global generation:  0.0268552303314209
r_  generation:  0.22906017303466797
local_output_nid generation:  0.012666463851928711
local_in_edges_tensor generation:  0.01525568962097168
mini_batch_src_global generation:  0.03401374816894531
r_  generation:  0.22651124000549316
local_output_nid generation:  0.012952089309692383
local_in_edges_tensor generation:  0.016566753387451172
mini_batch_src_global generation:  0.028888940811157227
r_  generation:  0.23660564422607422
local_output_nid generation:  0.012868642807006836
local_in_edges_tensor generation:  0.017780303955078125
mini_batch_src_global generation:  0.028965234756469727
r_  generation:  0.22930502891540527
local_output_nid generation:  0.012531518936157227
local_in_edges_tensor generation:  0.015633344650268555
mini_batch_src_global generation:  0.028116703033447266
r_  generation:  0.22358441352844238
local_output_nid generation:  0.012768983840942383
local_in_edges_tensor generation:  0.018161296844482422
mini_batch_src_global generation:  0.03079962730407715
r_  generation:  0.23148298263549805
local_output_nid generation:  0.012923479080200195
local_in_edges_tensor generation:  0.014129877090454102
mini_batch_src_global generation:  0.02913498878479004
r_  generation:  0.23259258270263672
local_output_nid generation:  0.012729167938232422
local_in_edges_tensor generation:  0.016840219497680664
mini_batch_src_global generation:  0.02874588966369629
r_  generation:  0.23308444023132324
local_output_nid generation:  0.013280868530273438
local_in_edges_tensor generation:  0.01688861846923828
mini_batch_src_global generation:  0.030951738357543945
r_  generation:  0.23432612419128418
local_output_nid generation:  0.013030052185058594
local_in_edges_tensor generation:  0.018163681030273438
mini_batch_src_global generation:  0.02900099754333496
r_  generation:  0.23313522338867188
local_output_nid generation:  0.012966632843017578
local_in_edges_tensor generation:  0.016429901123046875
mini_batch_src_global generation:  0.0293731689453125
r_  generation:  0.23301005363464355
local_output_nid generation:  0.012908458709716797
local_in_edges_tensor generation:  0.016241788864135742
mini_batch_src_global generation:  0.030886411666870117
r_  generation:  0.2336130142211914
local_output_nid generation:  0.01283121109008789
local_in_edges_tensor generation:  0.014243841171264648
mini_batch_src_global generation:  0.029044628143310547
r_  generation:  0.2311716079711914
----------------------check_connections_block total spend ----------------------------- 5.465053558349609
generate_one_block  0.3119370937347412
generate_one_block  0.3061838150024414
generate_one_block  0.31449317932128906
generate_one_block  0.29967761039733887
generate_one_block  0.3077270984649658
generate_one_block  0.3137497901916504
generate_one_block  0.30077362060546875
generate_one_block  0.2919046878814697
generate_one_block  0.31060290336608887
generate_one_block  0.30359435081481934
generate_one_block  0.29972195625305176
generate_one_block  0.310168981552124
generate_one_block  0.30864477157592773
generate_one_block  0.3043215274810791
generate_one_block  0.3142249584197998
generate_one_block  0.2979300022125244
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03632330894470215
gen group dst list time:  0.06089639663696289
time for parepare:  0.019147157669067383
local_output_nid generation:  0.026047229766845703
local_in_edges_tensor generation:  0.043203115463256836
mini_batch_src_global generation:  0.043869733810424805
r_  generation:  0.4401371479034424
local_output_nid generation:  0.032002925872802734
local_in_edges_tensor generation:  0.04879570007324219
mini_batch_src_global generation:  0.053648948669433594
r_  generation:  0.45908594131469727
local_output_nid generation:  0.03133702278137207
local_in_edges_tensor generation:  0.04894566535949707
mini_batch_src_global generation:  0.05251574516296387
r_  generation:  0.45834898948669434
local_output_nid generation:  0.030971527099609375
local_in_edges_tensor generation:  0.03676867485046387
mini_batch_src_global generation:  0.055084943771362305
r_  generation:  0.455599308013916
local_output_nid generation:  0.030915260314941406
local_in_edges_tensor generation:  0.032613515853881836
mini_batch_src_global generation:  0.054440975189208984
r_  generation:  0.4642190933227539
local_output_nid generation:  0.031485557556152344
local_in_edges_tensor generation:  0.03280806541442871
mini_batch_src_global generation:  0.05534005165100098
r_  generation:  0.4616556167602539
local_output_nid generation:  0.031601667404174805
local_in_edges_tensor generation:  0.04058575630187988
mini_batch_src_global generation:  0.054596662521362305
r_  generation:  0.46253085136413574
local_output_nid generation:  0.030991792678833008
local_in_edges_tensor generation:  0.03275632858276367
mini_batch_src_global generation:  0.05559992790222168
r_  generation:  0.4574260711669922
local_output_nid generation:  0.031208038330078125
local_in_edges_tensor generation:  0.0316464900970459
mini_batch_src_global generation:  0.05517005920410156
r_  generation:  0.46387600898742676
local_output_nid generation:  0.0314183235168457
local_in_edges_tensor generation:  0.04016399383544922
mini_batch_src_global generation:  0.05531573295593262
r_  generation:  0.45723986625671387
local_output_nid generation:  0.03153085708618164
local_in_edges_tensor generation:  0.033214569091796875
mini_batch_src_global generation:  0.05457115173339844
r_  generation:  0.46295905113220215
local_output_nid generation:  0.031496286392211914
local_in_edges_tensor generation:  0.040971994400024414
mini_batch_src_global generation:  0.055633544921875
r_  generation:  0.46040892601013184
local_output_nid generation:  0.03165435791015625
local_in_edges_tensor generation:  0.04546189308166504
mini_batch_src_global generation:  0.053780555725097656
r_  generation:  0.4596531391143799
local_output_nid generation:  0.03159785270690918
local_in_edges_tensor generation:  0.03269553184509277
mini_batch_src_global generation:  0.053424835205078125
r_  generation:  0.46128320693969727
local_output_nid generation:  0.0323796272277832
local_in_edges_tensor generation:  0.04544353485107422
mini_batch_src_global generation:  0.05402112007141113
r_  generation:  0.4608924388885498
local_output_nid generation:  0.03212690353393555
local_in_edges_tensor generation:  0.03417682647705078
mini_batch_src_global generation:  0.0564272403717041
r_  generation:  0.45794200897216797
----------------------check_connections_block total spend ----------------------------- 10.927407264709473
generate_one_block  0.5820033550262451
generate_one_block  0.5880277156829834
generate_one_block  0.5984861850738525
generate_one_block  0.5899572372436523
generate_one_block  0.5754256248474121
generate_one_block  0.5978999137878418
generate_one_block  0.641197681427002
generate_one_block  0.5773167610168457
generate_one_block  0.6179020404815674
generate_one_block  0.5806441307067871
generate_one_block  0.5971620082855225
generate_one_block  0.6214995384216309
generate_one_block  0.6059918403625488
generate_one_block  0.6083893775939941
generate_one_block  0.5935556888580322
generate_one_block  0.6240229606628418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  16.392460823059082
block generation total time  14.49513840675354
average batch blocks generation time:  0.9059461504220963
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09153890609741211  GigaBytes
Max Memory Allocated: 0.09153890609741211  GigaBytes

torch.Size([154651, 128])
torch.Size([124509, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.7456064224243164  GigaBytes
Max Memory Allocated: 0.7871770858764648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 0.09299993515014648  GigaBytes
Max Memory Allocated: 0.8329787254333496  GigaBytes

torch.Size([155287, 128])
torch.Size([125207, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 0.7461423873901367  GigaBytes
Max Memory Allocated: 0.8329787254333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0955810546875 GB
    Memory Allocated: 0.0933980941772461  GigaBytes
Max Memory Allocated: 0.8336148262023926  GigaBytes

torch.Size([155404, 128])
torch.Size([125969, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.757075309753418  GigaBytes
Max Memory Allocated: 0.8336148262023926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09295177459716797  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155326, 128])
torch.Size([125064, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7445197105407715  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09292030334472656  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([154800, 128])
torch.Size([123994, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.737246036529541  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.0931096076965332  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155249, 128])
torch.Size([125149, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7497420310974121  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09307098388671875  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155284, 128])
torch.Size([125293, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7436790466308594  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.0926351547241211  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155074, 128])
torch.Size([124596, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7378940582275391  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.0931539535522461  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([154556, 128])
torch.Size([124113, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.741673469543457  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09291601181030273  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155183, 128])
torch.Size([124906, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.743077278137207  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09304618835449219  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155176, 128])
torch.Size([124765, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7409157752990723  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09311199188232422  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155486, 128])
torch.Size([125867, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7521610260009766  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09317302703857422  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155032, 128])
torch.Size([124944, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7440423965454102  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09293699264526367  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155189, 128])
torch.Size([124938, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7476620674133301  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09316349029541016  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([154943, 128])
torch.Size([124691, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7424001693725586  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09276866912841797  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155018, 128])
torch.Size([124781, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7408013343811035  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.059529468417167664 |0.034808143973350525 |0.0500747412443161 |9.994208812713623e-05 |0.009120926260948181 |0.002298116683959961 |
----------------------------------------------------------pseudo_mini_loss sum 6.26719331741333
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5210961
Number of first layer input nodes during this epoch:  2481658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.11770963668823242  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03380894660949707
random selection method range initialization spend 0.005861043930053711
time for parepare:  0.019205331802368164
local_output_nid generation:  0.0022749900817871094
local_in_edges_tensor generation:  0.01158452033996582
mini_batch_src_global generation:  0.002160787582397461
r_  generation:  0.02002096176147461
local_output_nid generation:  0.004327535629272461
local_in_edges_tensor generation:  0.0020542144775390625
mini_batch_src_global generation:  0.0027494430541992188
r_  generation:  0.02093362808227539
local_output_nid generation:  0.0029268264770507812
local_in_edges_tensor generation:  0.001748800277709961
mini_batch_src_global generation:  0.0015363693237304688
r_  generation:  0.02085399627685547
local_output_nid generation:  0.00293731689453125
local_in_edges_tensor generation:  0.0016810894012451172
mini_batch_src_global generation:  0.001580953598022461
r_  generation:  0.021077871322631836
local_output_nid generation:  0.002936840057373047
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0015516281127929688
r_  generation:  0.021477460861206055
local_output_nid generation:  0.003001689910888672
local_in_edges_tensor generation:  0.0019257068634033203
mini_batch_src_global generation:  0.0016446113586425781
r_  generation:  0.020677804946899414
local_output_nid generation:  0.0029408931732177734
local_in_edges_tensor generation:  0.0016682147979736328
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.021606922149658203
local_output_nid generation:  0.003004789352416992
local_in_edges_tensor generation:  0.0016968250274658203
mini_batch_src_global generation:  0.001592397689819336
r_  generation:  0.020929813385009766
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.0016863346099853516
mini_batch_src_global generation:  0.0016644001007080078
r_  generation:  0.021654129028320312
local_output_nid generation:  0.0029289722442626953
local_in_edges_tensor generation:  0.001714944839477539
mini_batch_src_global generation:  0.0016682147979736328
r_  generation:  0.02154374122619629
local_output_nid generation:  0.0029611587524414062
local_in_edges_tensor generation:  0.0017151832580566406
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.02147388458251953
local_output_nid generation:  0.0029554367065429688
local_in_edges_tensor generation:  0.0016932487487792969
mini_batch_src_global generation:  0.0016613006591796875
r_  generation:  0.022298574447631836
local_output_nid generation:  0.0029489994049072266
local_in_edges_tensor generation:  0.0016791820526123047
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.0220949649810791
local_output_nid generation:  0.002961874008178711
local_in_edges_tensor generation:  0.0017287731170654297
mini_batch_src_global generation:  0.0017745494842529297
r_  generation:  0.022705078125
local_output_nid generation:  0.0029442310333251953
local_in_edges_tensor generation:  0.00164794921875
mini_batch_src_global generation:  0.0017213821411132812
r_  generation:  0.021808624267578125
local_output_nid generation:  0.003031492233276367
local_in_edges_tensor generation:  0.0017321109771728516
mini_batch_src_global generation:  0.0017361640930175781
r_  generation:  0.021553516387939453
----------------------check_connections_block total spend ----------------------------- 0.5634336471557617
generate_one_block  0.030639171600341797
generate_one_block  0.03225970268249512
generate_one_block  0.031627655029296875
generate_one_block  0.03139448165893555
generate_one_block  0.03112030029296875
generate_one_block  0.0333256721496582
generate_one_block  0.03166699409484863
generate_one_block  0.03033280372619629
generate_one_block  0.03155803680419922
generate_one_block  0.03125143051147461
generate_one_block  0.03057861328125
generate_one_block  0.031100988388061523
generate_one_block  0.03156256675720215
generate_one_block  0.03301191329956055
generate_one_block  0.031133413314819336
generate_one_block  0.03136467933654785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05277538299560547
gen group dst list time:  0.019520998001098633
time for parepare:  0.021459579467773438
local_output_nid generation:  0.009534835815429688
local_in_edges_tensor generation:  0.03155016899108887
mini_batch_src_global generation:  0.02573394775390625
r_  generation:  0.22022294998168945
local_output_nid generation:  0.013773918151855469
local_in_edges_tensor generation:  0.02196025848388672
mini_batch_src_global generation:  0.027753114700317383
r_  generation:  0.2313830852508545
local_output_nid generation:  0.0135498046875
local_in_edges_tensor generation:  0.01802515983581543
mini_batch_src_global generation:  0.02707386016845703
r_  generation:  0.2329542636871338
local_output_nid generation:  0.014224052429199219
local_in_edges_tensor generation:  0.01808619499206543
mini_batch_src_global generation:  0.027739286422729492
r_  generation:  0.2356405258178711
local_output_nid generation:  0.013866186141967773
local_in_edges_tensor generation:  0.018129825592041016
mini_batch_src_global generation:  0.02852177619934082
r_  generation:  0.2386934757232666
local_output_nid generation:  0.013312339782714844
local_in_edges_tensor generation:  0.015595674514770508
mini_batch_src_global generation:  0.03195333480834961
r_  generation:  0.23836255073547363
local_output_nid generation:  0.013439178466796875
local_in_edges_tensor generation:  0.01773810386657715
mini_batch_src_global generation:  0.028809309005737305
r_  generation:  0.2393643856048584
local_output_nid generation:  0.014744043350219727
local_in_edges_tensor generation:  0.013405561447143555
mini_batch_src_global generation:  0.0286710262298584
r_  generation:  0.23215484619140625
local_output_nid generation:  0.013287544250488281
local_in_edges_tensor generation:  0.0176239013671875
mini_batch_src_global generation:  0.02905106544494629
r_  generation:  0.24123311042785645
local_output_nid generation:  0.013197183609008789
local_in_edges_tensor generation:  0.017479419708251953
mini_batch_src_global generation:  0.029776334762573242
r_  generation:  0.23753666877746582
local_output_nid generation:  0.014979124069213867
local_in_edges_tensor generation:  0.017321109771728516
mini_batch_src_global generation:  0.029245376586914062
r_  generation:  0.23782110214233398
local_output_nid generation:  0.01318216323852539
local_in_edges_tensor generation:  0.01388096809387207
mini_batch_src_global generation:  0.029640913009643555
r_  generation:  0.2410898208618164
local_output_nid generation:  0.013459444046020508
local_in_edges_tensor generation:  0.017640352249145508
mini_batch_src_global generation:  0.029813051223754883
r_  generation:  0.24248886108398438
local_output_nid generation:  0.013522624969482422
local_in_edges_tensor generation:  0.018331527709960938
mini_batch_src_global generation:  0.03003859519958496
r_  generation:  0.24289894104003906
local_output_nid generation:  0.01312565803527832
local_in_edges_tensor generation:  0.013609170913696289
mini_batch_src_global generation:  0.02952885627746582
r_  generation:  0.2342662811279297
local_output_nid generation:  0.013166666030883789
local_in_edges_tensor generation:  0.01518702507019043
mini_batch_src_global generation:  0.029705286026000977
r_  generation:  0.2384626865386963
----------------------check_connections_block total spend ----------------------------- 5.597770690917969
generate_one_block  0.32462310791015625
generate_one_block  0.31835412979125977
generate_one_block  0.3075530529022217
generate_one_block  0.3124704360961914
generate_one_block  0.3116343021392822
generate_one_block  0.3028693199157715
generate_one_block  0.34801435470581055
generate_one_block  0.2930479049682617
generate_one_block  0.31119537353515625
generate_one_block  0.307283878326416
generate_one_block  0.3008875846862793
generate_one_block  0.3116483688354492
generate_one_block  0.326521635055542
generate_one_block  0.3379182815551758
generate_one_block  0.3103024959564209
generate_one_block  0.30417394638061523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.059324026107788086
gen group dst list time:  0.07448911666870117
time for parepare:  0.01836228370666504
local_output_nid generation:  0.027350425720214844
local_in_edges_tensor generation:  0.060044288635253906
mini_batch_src_global generation:  0.04603219032287598
r_  generation:  0.4501461982727051
local_output_nid generation:  0.032587528228759766
local_in_edges_tensor generation:  0.05533194541931152
mini_batch_src_global generation:  0.05181407928466797
r_  generation:  0.46018362045288086
local_output_nid generation:  0.03597879409790039
local_in_edges_tensor generation:  0.04958319664001465
mini_batch_src_global generation:  0.05242419242858887
r_  generation:  0.4750099182128906
local_output_nid generation:  0.03531217575073242
local_in_edges_tensor generation:  0.043085575103759766
mini_batch_src_global generation:  0.052500009536743164
r_  generation:  0.45484232902526855
local_output_nid generation:  0.03376436233520508
local_in_edges_tensor generation:  0.09525537490844727
mini_batch_src_global generation:  0.0515141487121582
r_  generation:  0.47780299186706543
local_output_nid generation:  0.03237724304199219
local_in_edges_tensor generation:  0.03243422508239746
mini_batch_src_global generation:  0.05295062065124512
r_  generation:  0.463625431060791
local_output_nid generation:  0.03397321701049805
local_in_edges_tensor generation:  0.03587007522583008
mini_batch_src_global generation:  0.05214953422546387
r_  generation:  0.47550296783447266
local_output_nid generation:  0.03233742713928223
local_in_edges_tensor generation:  0.03595924377441406
mini_batch_src_global generation:  0.05311703681945801
r_  generation:  0.4622213840484619
local_output_nid generation:  0.03220510482788086
local_in_edges_tensor generation:  0.0558924674987793
mini_batch_src_global generation:  0.0531001091003418
r_  generation:  0.4901540279388428
local_output_nid generation:  0.03560185432434082
local_in_edges_tensor generation:  0.04312944412231445
mini_batch_src_global generation:  0.05553889274597168
r_  generation:  0.46200132369995117
local_output_nid generation:  0.03499293327331543
local_in_edges_tensor generation:  0.035636186599731445
mini_batch_src_global generation:  0.053164005279541016
r_  generation:  0.46906542778015137
local_output_nid generation:  0.033536434173583984
local_in_edges_tensor generation:  0.033262014389038086
mini_batch_src_global generation:  0.05300617218017578
r_  generation:  0.4586966037750244
local_output_nid generation:  0.033614397048950195
local_in_edges_tensor generation:  0.040929317474365234
mini_batch_src_global generation:  0.05156373977661133
r_  generation:  0.4634840488433838
local_output_nid generation:  0.03362107276916504
local_in_edges_tensor generation:  0.04165816307067871
mini_batch_src_global generation:  0.05430436134338379
r_  generation:  0.4731130599975586
local_output_nid generation:  0.033789634704589844
local_in_edges_tensor generation:  0.029574871063232422
mini_batch_src_global generation:  0.05222153663635254
r_  generation:  0.4730992317199707
local_output_nid generation:  0.03328680992126465
local_in_edges_tensor generation:  0.044513702392578125
mini_batch_src_global generation:  0.05259442329406738
r_  generation:  0.47222375869750977
----------------------check_connections_block total spend ----------------------------- 11.241639137268066
generate_one_block  0.5938169956207275
generate_one_block  0.5960960388183594
generate_one_block  0.5813872814178467
generate_one_block  0.5903363227844238
generate_one_block  0.5895285606384277
generate_one_block  0.5961589813232422
generate_one_block  0.6025307178497314
generate_one_block  0.5836126804351807
generate_one_block  0.624481201171875
generate_one_block  0.5886523723602295
generate_one_block  0.5852925777435303
generate_one_block  0.5813562870025635
generate_one_block  0.6015050411224365
generate_one_block  0.6071388721466064
generate_one_block  0.5771691799163818
generate_one_block  0.5744738578796387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.11770963668823242  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

connection checking time:  16.839409828186035
block generation total time  14.502035140991211
average batch blocks generation time:  0.9063771963119507
block dataloader generation time/epoch 33.69064807891846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.09486627578735352  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155246, 128])
torch.Size([125559, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0975341796875 GB
    Memory Allocated: 0.7516741752624512  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09469270706176758  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155185, 128])
torch.Size([125711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.754763126373291  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485435485839844  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155046, 128])
torch.Size([124964, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7475347518920898  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09453916549682617  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([154989, 128])
torch.Size([124956, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7494053840637207  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09485816955566406  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155341, 128])
torch.Size([125464, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.748497486114502  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09450626373291016  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155246, 128])
torch.Size([125332, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7453670501708984  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477806091308594  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155032, 128])
torch.Size([124581, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.744713306427002  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09409809112548828  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([154778, 128])
torch.Size([124180, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7384605407714844  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09477519989013672  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155214, 128])
torch.Size([125291, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7472949028015137  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09428930282592773  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([154745, 128])
torch.Size([124829, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7432150840759277  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09468650817871094  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155014, 128])
torch.Size([124935, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7442836761474609  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09441184997558594  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155028, 128])
torch.Size([124392, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7436246871948242  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.094818115234375  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155073, 128])
torch.Size([125400, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7487707138061523  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09470081329345703  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155018, 128])
torch.Size([125715, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7545313835144043  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09463310241699219  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155188, 128])
torch.Size([124759, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7417893409729004  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.09441661834716797  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

torch.Size([155240, 128])
torch.Size([124790, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0994873046875 GB
    Memory Allocated: 0.7432942390441895  GigaBytes
Max Memory Allocated: 0.8465442657470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06326287984848022 |0.015935972332954407 |0.0037713050842285156 |9.861588478088379e-05 |0.0036182701587677 |0.0031440258026123047 |
----------------------------------------------------------pseudo_mini_loss sum 3.2324512004852295
Total (block generation + training)time/epoch 35.141761302948
Training time/epoch 1.4508388042449951
Training time without block to device /epoch 1.1958632469177246
Training time without total dataloading part /epoch 0.1229550838470459
load block tensor time/epoch 1.0122060775756836
block to device time/epoch 0.2549755573272705
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5213828
Number of first layer input nodes during this epoch:  2481383
