Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648509615.2550135
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024221181869506836
random selection method range initialization spend 0.0061969757080078125
time for parepare:  0.01921868324279785
local_output_nid generation:  0.0021600723266601562
local_in_edges_tensor generation:  0.0038056373596191406
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.019128799438476562
local_output_nid generation:  0.0028493404388427734
local_in_edges_tensor generation:  0.0016679763793945312
mini_batch_src_global generation:  0.0021584033966064453
r_  generation:  0.018466949462890625
local_output_nid generation:  0.002923250198364258
local_in_edges_tensor generation:  0.0015690326690673828
mini_batch_src_global generation:  0.0013837814331054688
r_  generation:  0.018186092376708984
local_output_nid generation:  0.002941608428955078
local_in_edges_tensor generation:  0.0015568733215332031
mini_batch_src_global generation:  0.0013568401336669922
r_  generation:  0.018023252487182617
local_output_nid generation:  0.0029277801513671875
local_in_edges_tensor generation:  0.001493215560913086
mini_batch_src_global generation:  0.0013170242309570312
r_  generation:  0.018120527267456055
local_output_nid generation:  0.0029287338256835938
local_in_edges_tensor generation:  0.0015060901641845703
mini_batch_src_global generation:  0.0014159679412841797
r_  generation:  0.01911616325378418
local_output_nid generation:  0.002949237823486328
local_in_edges_tensor generation:  0.0015072822570800781
mini_batch_src_global generation:  0.0014486312866210938
r_  generation:  0.019222259521484375
local_output_nid generation:  0.0028939247131347656
local_in_edges_tensor generation:  0.001505136489868164
mini_batch_src_global generation:  0.0014526844024658203
r_  generation:  0.01905202865600586
local_output_nid generation:  0.0029151439666748047
local_in_edges_tensor generation:  0.001476287841796875
mini_batch_src_global generation:  0.0014400482177734375
r_  generation:  0.01898956298828125
local_output_nid generation:  0.0028879642486572266
local_in_edges_tensor generation:  0.00142669677734375
mini_batch_src_global generation:  0.0014729499816894531
r_  generation:  0.01927638053894043
local_output_nid generation:  0.0029234886169433594
local_in_edges_tensor generation:  0.0014662742614746094
mini_batch_src_global generation:  0.0014464855194091797
r_  generation:  0.019071578979492188
local_output_nid generation:  0.002884387969970703
local_in_edges_tensor generation:  0.0014460086822509766
mini_batch_src_global generation:  0.0014290809631347656
r_  generation:  0.018797874450683594
local_output_nid generation:  0.002898693084716797
local_in_edges_tensor generation:  0.0014920234680175781
mini_batch_src_global generation:  0.0015339851379394531
r_  generation:  0.0194394588470459
local_output_nid generation:  0.0028836727142333984
local_in_edges_tensor generation:  0.0014424324035644531
mini_batch_src_global generation:  0.001443624496459961
r_  generation:  0.018939733505249023
local_output_nid generation:  0.0029180049896240234
local_in_edges_tensor generation:  0.0014483928680419922
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.019961833953857422
local_output_nid generation:  0.0029349327087402344
local_in_edges_tensor generation:  0.0014607906341552734
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.01950669288635254
----------------------check_connections_block total spend ----------------------------- 0.49642229080200195
generate_one_block  0.027225732803344727
generate_one_block  0.02831888198852539
generate_one_block  0.02759075164794922
generate_one_block  0.029908180236816406
generate_one_block  0.027510643005371094
generate_one_block  0.027862548828125
generate_one_block  0.028354883193969727
generate_one_block  0.028305530548095703
generate_one_block  0.028057098388671875
generate_one_block  0.027759790420532227
generate_one_block  0.02738213539123535
generate_one_block  0.02706289291381836
generate_one_block  0.028081893920898438
generate_one_block  0.027165889739990234
generate_one_block  0.027873754501342773
generate_one_block  0.027744770050048828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03892326354980469
gen group dst list time:  0.018744468688964844
time for parepare:  0.018552303314208984
local_output_nid generation:  0.007955312728881836
local_in_edges_tensor generation:  0.017576217651367188
mini_batch_src_global generation:  0.02103710174560547
r_  generation:  0.19697880744934082
local_output_nid generation:  0.01203298568725586
local_in_edges_tensor generation:  0.019239425659179688
mini_batch_src_global generation:  0.025272846221923828
r_  generation:  0.20525050163269043
local_output_nid generation:  0.011549711227416992
local_in_edges_tensor generation:  0.015735149383544922
mini_batch_src_global generation:  0.028960466384887695
r_  generation:  0.20732569694519043
local_output_nid generation:  0.011482000350952148
local_in_edges_tensor generation:  0.011923551559448242
mini_batch_src_global generation:  0.02490091323852539
r_  generation:  0.20633697509765625
local_output_nid generation:  0.011536598205566406
local_in_edges_tensor generation:  0.015071630477905273
mini_batch_src_global generation:  0.03377270698547363
r_  generation:  0.21404743194580078
local_output_nid generation:  0.01162576675415039
local_in_edges_tensor generation:  0.015986919403076172
mini_batch_src_global generation:  0.02659749984741211
r_  generation:  0.21446704864501953
local_output_nid generation:  0.011775970458984375
local_in_edges_tensor generation:  0.016188859939575195
mini_batch_src_global generation:  0.02698373794555664
r_  generation:  0.21530938148498535
local_output_nid generation:  0.011731386184692383
local_in_edges_tensor generation:  0.014184713363647461
mini_batch_src_global generation:  0.027169466018676758
r_  generation:  0.21642780303955078
local_output_nid generation:  0.011800289154052734
local_in_edges_tensor generation:  0.014019250869750977
mini_batch_src_global generation:  0.027387380599975586
r_  generation:  0.2162628173828125
local_output_nid generation:  0.011749029159545898
local_in_edges_tensor generation:  0.012056827545166016
mini_batch_src_global generation:  0.027095556259155273
r_  generation:  0.21351122856140137
local_output_nid generation:  0.011754035949707031
local_in_edges_tensor generation:  0.012180089950561523
mini_batch_src_global generation:  0.026775360107421875
r_  generation:  0.21358394622802734
local_output_nid generation:  0.011449575424194336
local_in_edges_tensor generation:  0.013496875762939453
mini_batch_src_global generation:  0.02972888946533203
r_  generation:  0.20948576927185059
local_output_nid generation:  0.01210641860961914
local_in_edges_tensor generation:  0.016159772872924805
mini_batch_src_global generation:  0.027642011642456055
r_  generation:  0.22024321556091309
local_output_nid generation:  0.011433124542236328
local_in_edges_tensor generation:  0.011899709701538086
mini_batch_src_global generation:  0.026479244232177734
r_  generation:  0.20959758758544922
local_output_nid generation:  0.011858701705932617
local_in_edges_tensor generation:  0.015852928161621094
mini_batch_src_global generation:  0.028744935989379883
r_  generation:  0.22085785865783691
local_output_nid generation:  0.011659622192382812
local_in_edges_tensor generation:  0.017368078231811523
mini_batch_src_global generation:  0.027364015579223633
r_  generation:  0.21746587753295898
----------------------check_connections_block total spend ----------------------------- 5.016229152679443
generate_one_block  0.27962565422058105
generate_one_block  0.28278517723083496
generate_one_block  0.2723808288574219
generate_one_block  0.27242064476013184
generate_one_block  0.2949378490447998
generate_one_block  0.2796785831451416
generate_one_block  0.2859077453613281
generate_one_block  0.283890962600708
generate_one_block  0.2800760269165039
generate_one_block  0.2716655731201172
generate_one_block  0.27168822288513184
generate_one_block  0.2717561721801758
generate_one_block  0.2833271026611328
generate_one_block  0.26595091819763184
generate_one_block  0.28709959983825684
generate_one_block  0.2830350399017334
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03404378890991211
gen group dst list time:  0.05888009071350098
time for parepare:  0.01889944076538086
local_output_nid generation:  0.024941682815551758
local_in_edges_tensor generation:  0.04026532173156738
mini_batch_src_global generation:  0.049691200256347656
r_  generation:  0.4881119728088379
local_output_nid generation:  0.031005144119262695
local_in_edges_tensor generation:  0.04860639572143555
mini_batch_src_global generation:  0.057761430740356445
r_  generation:  0.49047112464904785
local_output_nid generation:  0.030196428298950195
local_in_edges_tensor generation:  0.03561854362487793
mini_batch_src_global generation:  0.057089805603027344
r_  generation:  0.500558614730835
local_output_nid generation:  0.030158281326293945
local_in_edges_tensor generation:  0.03459978103637695
mini_batch_src_global generation:  0.058403730392456055
r_  generation:  0.498607873916626
local_output_nid generation:  0.030489444732666016
local_in_edges_tensor generation:  0.039476633071899414
mini_batch_src_global generation:  0.05726361274719238
r_  generation:  0.49883460998535156
local_output_nid generation:  0.030411958694458008
local_in_edges_tensor generation:  0.03980064392089844
mini_batch_src_global generation:  0.058211326599121094
r_  generation:  0.4984774589538574
local_output_nid generation:  0.031203031539916992
local_in_edges_tensor generation:  0.04010891914367676
mini_batch_src_global generation:  0.05815458297729492
r_  generation:  0.5104391574859619
local_output_nid generation:  0.03096485137939453
local_in_edges_tensor generation:  0.030958890914916992
mini_batch_src_global generation:  0.058664560317993164
r_  generation:  0.5010073184967041
local_output_nid generation:  0.033765554428100586
local_in_edges_tensor generation:  0.03520560264587402
mini_batch_src_global generation:  0.05919504165649414
r_  generation:  0.5037567615509033
local_output_nid generation:  0.030670642852783203
local_in_edges_tensor generation:  0.03981137275695801
mini_batch_src_global generation:  0.058974266052246094
r_  generation:  0.5006058216094971
local_output_nid generation:  0.030936002731323242
local_in_edges_tensor generation:  0.030992746353149414
mini_batch_src_global generation:  0.05845236778259277
r_  generation:  0.5056824684143066
local_output_nid generation:  0.0313870906829834
local_in_edges_tensor generation:  0.03535580635070801
mini_batch_src_global generation:  0.05992484092712402
r_  generation:  0.49631595611572266
local_output_nid generation:  0.030618667602539062
local_in_edges_tensor generation:  0.04440808296203613
mini_batch_src_global generation:  0.05824780464172363
r_  generation:  0.5067212581634521
local_output_nid generation:  0.030577898025512695
local_in_edges_tensor generation:  0.030815839767456055
mini_batch_src_global generation:  0.058914899826049805
r_  generation:  0.4971024990081787
local_output_nid generation:  0.030715465545654297
local_in_edges_tensor generation:  0.038630008697509766
mini_batch_src_global generation:  0.05857038497924805
r_  generation:  0.505234956741333
local_output_nid generation:  0.030748844146728516
local_in_edges_tensor generation:  0.03921222686767578
mini_batch_src_global generation:  0.05925464630126953
r_  generation:  0.5030026435852051
----------------------check_connections_block total spend ----------------------------- 11.72316575050354
generate_one_block  0.6362316608428955
generate_one_block  0.6467628479003906
generate_one_block  0.6386446952819824
generate_one_block  0.6420080661773682
generate_one_block  0.6420114040374756
generate_one_block  0.6471536159515381
generate_one_block  0.7335891723632812
generate_one_block  0.6491262912750244
generate_one_block  0.6412010192871094
generate_one_block  0.6565842628479004
generate_one_block  0.6361339092254639
generate_one_block  0.6427676677703857
generate_one_block  0.6765103340148926
generate_one_block  0.6330101490020752
generate_one_block  0.6382653713226318
generate_one_block  0.6604323387145996
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05500507354736328
gen group dst list time:  0.0952901840209961
time for parepare:  0.019777297973632812
local_output_nid generation:  0.03329730033874512
local_in_edges_tensor generation:  0.07454228401184082
mini_batch_src_global generation:  0.05428171157836914
r_  generation:  0.530853271484375
local_output_nid generation:  0.03865647315979004
local_in_edges_tensor generation:  0.05666232109069824
mini_batch_src_global generation:  0.06330156326293945
r_  generation:  0.540010929107666
local_output_nid generation:  0.03766584396362305
local_in_edges_tensor generation:  0.04199814796447754
mini_batch_src_global generation:  0.05996084213256836
r_  generation:  0.5452849864959717
local_output_nid generation:  0.038079023361206055
local_in_edges_tensor generation:  0.04695868492126465
mini_batch_src_global generation:  0.05968904495239258
r_  generation:  0.5461030006408691
local_output_nid generation:  0.03786134719848633
local_in_edges_tensor generation:  0.04184865951538086
mini_batch_src_global generation:  0.058365583419799805
r_  generation:  0.5542986392974854
local_output_nid generation:  0.03780055046081543
local_in_edges_tensor generation:  0.04452252388000488
mini_batch_src_global generation:  0.05978131294250488
r_  generation:  0.5534086227416992
local_output_nid generation:  0.03774404525756836
local_in_edges_tensor generation:  0.04631614685058594
mini_batch_src_global generation:  0.05986595153808594
r_  generation:  0.5635535717010498
local_output_nid generation:  0.037850141525268555
local_in_edges_tensor generation:  0.03661036491394043
mini_batch_src_global generation:  0.06100201606750488
r_  generation:  0.5588996410369873
local_output_nid generation:  0.03788614273071289
local_in_edges_tensor generation:  0.03723311424255371
mini_batch_src_global generation:  0.060835838317871094
r_  generation:  0.5650632381439209
local_output_nid generation:  0.037993669509887695
local_in_edges_tensor generation:  0.04181957244873047
mini_batch_src_global generation:  0.06196761131286621
r_  generation:  0.5623712539672852
local_output_nid generation:  0.03813505172729492
local_in_edges_tensor generation:  0.04685068130493164
mini_batch_src_global generation:  0.06195497512817383
r_  generation:  0.5635497570037842
local_output_nid generation:  0.03795337677001953
local_in_edges_tensor generation:  0.036618709564208984
mini_batch_src_global generation:  0.06143450736999512
r_  generation:  0.5708925724029541
local_output_nid generation:  0.03795790672302246
local_in_edges_tensor generation:  0.04195523262023926
mini_batch_src_global generation:  0.06217169761657715
r_  generation:  0.5666799545288086
local_output_nid generation:  0.03805255889892578
local_in_edges_tensor generation:  0.04193520545959473
mini_batch_src_global generation:  0.062131404876708984
r_  generation:  0.5598709583282471
local_output_nid generation:  0.03803563117980957
local_in_edges_tensor generation:  0.04143381118774414
mini_batch_src_global generation:  0.06665539741516113
r_  generation:  0.5704970359802246
local_output_nid generation:  0.03800463676452637
local_in_edges_tensor generation:  0.04616999626159668
mini_batch_src_global generation:  0.06223726272583008
r_  generation:  0.5663235187530518
----------------------check_connections_block total spend ----------------------------- 13.287982940673828
generate_one_block  0.693584680557251
generate_one_block  0.7042853832244873
generate_one_block  0.6851794719696045
generate_one_block  0.7532665729522705
generate_one_block  0.703709602355957
generate_one_block  0.7020344734191895
generate_one_block  0.7040750980377197
generate_one_block  0.6994364261627197
generate_one_block  0.6827144622802734
generate_one_block  0.6885886192321777
generate_one_block  0.7150318622589111
generate_one_block  0.6889498233795166
generate_one_block  0.7193419933319092
generate_one_block  0.6823279857635498
generate_one_block  0.6897847652435303
generate_one_block  0.7120697498321533
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03986167907714844
gen group dst list time:  0.0984199047088623
time for parepare:  0.01915431022644043
local_output_nid generation:  0.03625369071960449
local_in_edges_tensor generation:  0.06306123733520508
mini_batch_src_global generation:  0.05004549026489258
r_  generation:  0.5378367900848389
local_output_nid generation:  0.041704654693603516
local_in_edges_tensor generation:  0.04701519012451172
mini_batch_src_global generation:  0.06660795211791992
r_  generation:  0.5397679805755615
local_output_nid generation:  0.04291391372680664
local_in_edges_tensor generation:  0.04357457160949707
mini_batch_src_global generation:  0.07914400100708008
r_  generation:  0.5482378005981445
local_output_nid generation:  0.04171562194824219
local_in_edges_tensor generation:  0.0428617000579834
mini_batch_src_global generation:  0.0638275146484375
r_  generation:  0.5461957454681396
local_output_nid generation:  0.04221844673156738
local_in_edges_tensor generation:  0.04153847694396973
mini_batch_src_global generation:  0.06360292434692383
r_  generation:  0.5629558563232422
local_output_nid generation:  0.04142928123474121
local_in_edges_tensor generation:  0.04600882530212402
mini_batch_src_global generation:  0.06998968124389648
r_  generation:  0.5724360942840576
local_output_nid generation:  0.04330611228942871
local_in_edges_tensor generation:  0.04028773307800293
mini_batch_src_global generation:  0.06564474105834961
r_  generation:  0.5900459289550781
local_output_nid generation:  0.043781280517578125
local_in_edges_tensor generation:  0.05787968635559082
mini_batch_src_global generation:  0.06916093826293945
r_  generation:  0.5611081123352051
local_output_nid generation:  0.04436755180358887
local_in_edges_tensor generation:  0.04903554916381836
mini_batch_src_global generation:  0.06603693962097168
r_  generation:  0.5652484893798828
local_output_nid generation:  0.04343223571777344
local_in_edges_tensor generation:  0.046327829360961914
mini_batch_src_global generation:  0.06434512138366699
r_  generation:  0.5709850788116455
local_output_nid generation:  0.043976545333862305
local_in_edges_tensor generation:  0.06287288665771484
mini_batch_src_global generation:  0.0812077522277832
r_  generation:  0.5595216751098633
local_output_nid generation:  0.041614532470703125
local_in_edges_tensor generation:  0.04183173179626465
mini_batch_src_global generation:  0.06654953956604004
r_  generation:  0.5652444362640381
local_output_nid generation:  0.04250288009643555
local_in_edges_tensor generation:  0.03818511962890625
mini_batch_src_global generation:  0.06272411346435547
r_  generation:  0.5605144500732422
local_output_nid generation:  0.041507720947265625
local_in_edges_tensor generation:  0.04321408271789551
mini_batch_src_global generation:  0.06126761436462402
r_  generation:  0.5638771057128906
local_output_nid generation:  0.04277944564819336
local_in_edges_tensor generation:  0.04037189483642578
mini_batch_src_global generation:  0.061531782150268555
r_  generation:  0.5685677528381348
local_output_nid generation:  0.04175567626953125
local_in_edges_tensor generation:  0.05176734924316406
mini_batch_src_global generation:  0.06094217300415039
r_  generation:  0.5651068687438965
----------------------check_connections_block total spend ----------------------------- 13.59395956993103
generate_one_block  0.7252795696258545
generate_one_block  0.6970031261444092
generate_one_block  0.6863899230957031
generate_one_block  0.6872122287750244
generate_one_block  0.701641321182251
generate_one_block  0.6995558738708496
generate_one_block  0.7665584087371826
generate_one_block  0.6890828609466553
generate_one_block  0.6887946128845215
generate_one_block  0.6862277984619141
generate_one_block  0.690927267074585
generate_one_block  0.6968998908996582
generate_one_block  0.688847541809082
generate_one_block  0.6807534694671631
generate_one_block  0.7021608352661133
generate_one_block  0.6982052326202393
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04639029502868652
gen group dst list time:  0.10329413414001465
time for parepare:  0.018657445907592773
local_output_nid generation:  0.03808856010437012
local_in_edges_tensor generation:  0.049961090087890625
mini_batch_src_global generation:  0.04858565330505371
r_  generation:  0.504197359085083
local_output_nid generation:  0.04351234436035156
local_in_edges_tensor generation:  0.0434725284576416
mini_batch_src_global generation:  0.0591435432434082
r_  generation:  0.5127942562103271
local_output_nid generation:  0.040935516357421875
local_in_edges_tensor generation:  0.040433645248413086
mini_batch_src_global generation:  0.06010293960571289
r_  generation:  0.5094044208526611
local_output_nid generation:  0.040513038635253906
local_in_edges_tensor generation:  0.04575467109680176
mini_batch_src_global generation:  0.06132340431213379
r_  generation:  0.5228176116943359
local_output_nid generation:  0.041086435317993164
local_in_edges_tensor generation:  0.04218125343322754
mini_batch_src_global generation:  0.06001019477844238
r_  generation:  0.5224926471710205
local_output_nid generation:  0.044161081314086914
local_in_edges_tensor generation:  0.035866737365722656
mini_batch_src_global generation:  0.06007695198059082
r_  generation:  0.5106830596923828
local_output_nid generation:  0.04175972938537598
local_in_edges_tensor generation:  0.039797067642211914
mini_batch_src_global generation:  0.06282544136047363
r_  generation:  0.5118553638458252
local_output_nid generation:  0.042109012603759766
local_in_edges_tensor generation:  0.04428744316101074
mini_batch_src_global generation:  0.05927777290344238
r_  generation:  0.5107569694519043
local_output_nid generation:  0.04229235649108887
local_in_edges_tensor generation:  0.04451155662536621
mini_batch_src_global generation:  0.06077289581298828
r_  generation:  0.5103180408477783
local_output_nid generation:  0.042023420333862305
local_in_edges_tensor generation:  0.03545689582824707
mini_batch_src_global generation:  0.05796384811401367
r_  generation:  0.5204689502716064
local_output_nid generation:  0.0420384407043457
local_in_edges_tensor generation:  0.04689192771911621
mini_batch_src_global generation:  0.0607907772064209
r_  generation:  0.5128154754638672
local_output_nid generation:  0.04198503494262695
local_in_edges_tensor generation:  0.04359698295593262
mini_batch_src_global generation:  0.05753135681152344
r_  generation:  0.5122716426849365
local_output_nid generation:  0.045978546142578125
local_in_edges_tensor generation:  0.03531599044799805
mini_batch_src_global generation:  0.0579524040222168
r_  generation:  0.5151090621948242
local_output_nid generation:  0.0419611930847168
local_in_edges_tensor generation:  0.03953814506530762
mini_batch_src_global generation:  0.05817747116088867
r_  generation:  0.5119626522064209
local_output_nid generation:  0.04207968711853027
local_in_edges_tensor generation:  0.04645586013793945
mini_batch_src_global generation:  0.057586669921875
r_  generation:  0.5169029235839844
local_output_nid generation:  0.04191231727600098
local_in_edges_tensor generation:  0.03942394256591797
mini_batch_src_global generation:  0.058455467224121094
r_  generation:  0.5140142440795898
----------------------check_connections_block total spend ----------------------------- 12.45180344581604
generate_one_block  0.6604471206665039
generate_one_block  0.6435873508453369
generate_one_block  0.6341664791107178
generate_one_block  0.6419496536254883
generate_one_block  0.6464123725891113
generate_one_block  0.6310040950775146
generate_one_block  0.6396350860595703
generate_one_block  0.6453449726104736
generate_one_block  0.7181386947631836
generate_one_block  0.6237070560455322
generate_one_block  0.6232702732086182
generate_one_block  0.6277568340301514
generate_one_block  0.6377353668212891
generate_one_block  0.627086877822876
generate_one_block  0.6524038314819336
generate_one_block  0.641554594039917
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

connection checking time:  56.07314085960388
block generation total time  47.59078049659729
average batch blocks generation time:  2.9744237810373306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13522005081176758  GigaBytes
Max Memory Allocated: 0.13522005081176758  GigaBytes

torch.Size([167147, 128])
torch.Size([166368, 64])
torch.Size([164049, 64])
torch.Size([155892, 64])
torch.Size([123973, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.8183655738830566  GigaBytes
Max Memory Allocated: 0.8261990547180176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13642072677612305  GigaBytes
Max Memory Allocated: 0.8400511741638184  GigaBytes

torch.Size([167162, 128])
torch.Size([166352, 64])
torch.Size([163999, 64])
torch.Size([155882, 64])
torch.Size([124129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8198776245117188  GigaBytes
Max Memory Allocated: 0.8400511741638184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13640594482421875  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

torch.Size([167182, 128])
torch.Size([166333, 64])
torch.Size([163812, 64])
torch.Size([155515, 64])
torch.Size([123674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8179197311401367  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1363697052001953  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

torch.Size([167196, 128])
torch.Size([166407, 64])
torch.Size([163959, 64])
torch.Size([155660, 64])
torch.Size([123019, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8175487518310547  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1363840103149414  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

torch.Size([167298, 128])
torch.Size([166505, 64])
torch.Size([164165, 64])
torch.Size([155864, 64])
torch.Size([123550, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8185796737670898  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364121437072754  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

torch.Size([167209, 128])
torch.Size([166372, 64])
torch.Size([163930, 64])
torch.Size([155669, 64])
torch.Size([123537, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8183417320251465  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364727020263672  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

torch.Size([167214, 128])
torch.Size([166337, 64])
torch.Size([163977, 64])
torch.Size([155984, 64])
torch.Size([124678, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.820462703704834  GigaBytes
Max Memory Allocated: 0.8415255546569824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13646602630615234  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167199, 128])
torch.Size([166386, 64])
torch.Size([164069, 64])
torch.Size([155921, 64])
torch.Size([124330, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8199210166931152  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364116668701172  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167234, 128])
torch.Size([166413, 64])
torch.Size([163937, 64])
torch.Size([155455, 64])
torch.Size([123343, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8182482719421387  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364126205444336  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167168, 128])
torch.Size([166317, 64])
torch.Size([163907, 64])
torch.Size([155667, 64])
torch.Size([123801, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8185210227966309  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13638544082641602  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167160, 128])
torch.Size([166353, 64])
torch.Size([163883, 64])
torch.Size([155633, 64])
torch.Size([123380, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8179845809936523  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1363835334777832  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167161, 128])
torch.Size([166340, 64])
torch.Size([163920, 64])
torch.Size([155577, 64])
torch.Size([123345, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8176736831665039  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13646221160888672  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167166, 128])
torch.Size([166312, 64])
torch.Size([163874, 64])
torch.Size([155764, 64])
torch.Size([124284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8197102546691895  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13633203506469727  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167167, 128])
torch.Size([166278, 64])
torch.Size([163859, 64])
torch.Size([155606, 64])
torch.Size([123107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.817314624786377  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13643503189086914  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167176, 128])
torch.Size([166346, 64])
torch.Size([163884, 64])
torch.Size([155573, 64])
torch.Size([123967, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.819481372833252  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13643217086791992  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167181, 128])
torch.Size([166333, 64])
torch.Size([163931, 64])
torch.Size([155625, 64])
torch.Size([123772, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8185758590698242  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05871987342834473 |0.06186816096305847 |0.04855354130268097 |9.679794311523438e-05 |0.02750818431377411 |0.0071887969970703125 |
----------------------------------------------------------pseudo_mini_loss sum 5.306817054748535
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13092073
Number of first layer input nodes during this epoch:  2675020
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.253507137298584  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.01917266845703125
random selection method range initialization spend 0.006251335144042969
time for parepare:  0.01949286460876465
local_output_nid generation:  0.002371072769165039
local_in_edges_tensor generation:  0.0064105987548828125
mini_batch_src_global generation:  0.0022454261779785156
r_  generation:  0.020642518997192383
local_output_nid generation:  0.0030210018157958984
local_in_edges_tensor generation:  0.001538991928100586
mini_batch_src_global generation:  0.0022530555725097656
r_  generation:  0.033014535903930664
local_output_nid generation:  0.004990100860595703
local_in_edges_tensor generation:  0.0024194717407226562
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.018119096755981445
local_output_nid generation:  0.004458189010620117
local_in_edges_tensor generation:  0.0019211769104003906
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.017854690551757812
local_output_nid generation:  0.004225969314575195
local_in_edges_tensor generation:  0.0018701553344726562
mini_batch_src_global generation:  0.0015408992767333984
r_  generation:  0.018548250198364258
local_output_nid generation:  0.004216909408569336
local_in_edges_tensor generation:  0.0019211769104003906
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.0186612606048584
local_output_nid generation:  0.004118919372558594
local_in_edges_tensor generation:  0.0018353462219238281
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.01881861686706543
local_output_nid generation:  0.004164934158325195
local_in_edges_tensor generation:  0.0018489360809326172
mini_batch_src_global generation:  0.0015239715576171875
r_  generation:  0.018540143966674805
local_output_nid generation:  0.0040740966796875
local_in_edges_tensor generation:  0.0017993450164794922
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.01869821548461914
local_output_nid generation:  0.004002571105957031
local_in_edges_tensor generation:  0.0018169879913330078
mini_batch_src_global generation:  0.001659393310546875
r_  generation:  0.018981218338012695
local_output_nid generation:  0.004084110260009766
local_in_edges_tensor generation:  0.0018224716186523438
mini_batch_src_global generation:  0.001634836196899414
r_  generation:  0.019255638122558594
local_output_nid generation:  0.004189014434814453
local_in_edges_tensor generation:  0.0019152164459228516
mini_batch_src_global generation:  0.001569986343383789
r_  generation:  0.01870274543762207
local_output_nid generation:  0.003936052322387695
local_in_edges_tensor generation:  0.0018336772918701172
mini_batch_src_global generation:  0.0077207088470458984
r_  generation:  0.019362926483154297
local_output_nid generation:  0.004124641418457031
local_in_edges_tensor generation:  0.0018143653869628906
mini_batch_src_global generation:  0.001642465591430664
r_  generation:  0.01923084259033203
local_output_nid generation:  0.004052639007568359
local_in_edges_tensor generation:  0.0018954277038574219
mini_batch_src_global generation:  0.0016818046569824219
r_  generation:  0.01955103874206543
local_output_nid generation:  0.004164695739746094
local_in_edges_tensor generation:  0.0018875598907470703
mini_batch_src_global generation:  0.0016956329345703125
r_  generation:  0.01958751678466797
----------------------check_connections_block total spend ----------------------------- 0.5539209842681885
generate_one_block  0.03295087814331055
generate_one_block  0.02893352508544922
generate_one_block  0.028591394424438477
generate_one_block  0.027820348739624023
generate_one_block  0.028917312622070312
generate_one_block  0.032297372817993164
generate_one_block  0.029062509536743164
generate_one_block  0.028331756591796875
generate_one_block  0.02848982810974121
generate_one_block  0.02826690673828125
generate_one_block  0.02853226661682129
generate_one_block  0.027907371520996094
generate_one_block  0.0292971134185791
generate_one_block  0.02823662757873535
generate_one_block  0.028867006301879883
generate_one_block  0.029355764389038086
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0413973331451416
gen group dst list time:  0.019561767578125
time for parepare:  0.018804311752319336
local_output_nid generation:  0.008376121520996094
local_in_edges_tensor generation:  0.027860403060913086
mini_batch_src_global generation:  0.024042129516601562
r_  generation:  0.19676709175109863
local_output_nid generation:  0.01221776008605957
local_in_edges_tensor generation:  0.019196033477783203
mini_batch_src_global generation:  0.02514028549194336
r_  generation:  0.21207737922668457
local_output_nid generation:  0.01247715950012207
local_in_edges_tensor generation:  0.017385244369506836
mini_batch_src_global generation:  0.023832082748413086
r_  generation:  0.2107691764831543
local_output_nid generation:  0.012260198593139648
local_in_edges_tensor generation:  0.013300895690917969
mini_batch_src_global generation:  0.024950504302978516
r_  generation:  0.21173381805419922
local_output_nid generation:  0.012219905853271484
local_in_edges_tensor generation:  0.017601728439331055
mini_batch_src_global generation:  0.027601957321166992
r_  generation:  0.22243523597717285
local_output_nid generation:  0.012139081954956055
local_in_edges_tensor generation:  0.01177072525024414
mini_batch_src_global generation:  0.02661299705505371
r_  generation:  0.22119903564453125
local_output_nid generation:  0.012270927429199219
local_in_edges_tensor generation:  0.012467384338378906
mini_batch_src_global generation:  0.02693796157836914
r_  generation:  0.21768641471862793
local_output_nid generation:  0.01250314712524414
local_in_edges_tensor generation:  0.013636589050292969
mini_batch_src_global generation:  0.026892900466918945
r_  generation:  0.2191181182861328
local_output_nid generation:  0.012634754180908203
local_in_edges_tensor generation:  0.014151334762573242
mini_batch_src_global generation:  0.026740074157714844
r_  generation:  0.21960902214050293
local_output_nid generation:  0.01247859001159668
local_in_edges_tensor generation:  0.012346744537353516
mini_batch_src_global generation:  0.026921987533569336
r_  generation:  0.22393178939819336
local_output_nid generation:  0.01349186897277832
local_in_edges_tensor generation:  0.0228731632232666
mini_batch_src_global generation:  0.03309488296508789
r_  generation:  0.22299718856811523
local_output_nid generation:  0.013738393783569336
local_in_edges_tensor generation:  0.016622304916381836
mini_batch_src_global generation:  0.028580904006958008
r_  generation:  0.22008419036865234
local_output_nid generation:  0.013068199157714844
local_in_edges_tensor generation:  0.015970706939697266
mini_batch_src_global generation:  0.029276609420776367
r_  generation:  0.22093749046325684
local_output_nid generation:  0.012917518615722656
local_in_edges_tensor generation:  0.012016057968139648
mini_batch_src_global generation:  0.02707052230834961
r_  generation:  0.21642470359802246
local_output_nid generation:  0.012911319732666016
local_in_edges_tensor generation:  0.012717008590698242
mini_batch_src_global generation:  0.029305696487426758
r_  generation:  0.22310519218444824
local_output_nid generation:  0.01229548454284668
local_in_edges_tensor generation:  0.015646696090698242
mini_batch_src_global generation:  0.0273745059967041
r_  generation:  0.21955156326293945
----------------------check_connections_block total spend ----------------------------- 5.16069483757019
generate_one_block  0.2830677032470703
generate_one_block  0.28407979011535645
generate_one_block  0.2909867763519287
generate_one_block  0.30713748931884766
generate_one_block  0.30275630950927734
generate_one_block  0.29245758056640625
generate_one_block  0.3129847049713135
generate_one_block  0.27976441383361816
generate_one_block  0.2770884037017822
generate_one_block  0.31274867057800293
generate_one_block  0.3004281520843506
generate_one_block  0.28316807746887207
generate_one_block  0.28671979904174805
generate_one_block  0.2901473045349121
generate_one_block  0.30532360076904297
generate_one_block  0.29785609245300293
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04809999465942383
gen group dst list time:  0.06883668899536133
time for parepare:  0.018907785415649414
local_output_nid generation:  0.025897979736328125
local_in_edges_tensor generation:  0.0574955940246582
mini_batch_src_global generation:  0.04847121238708496
r_  generation:  0.48984313011169434
local_output_nid generation:  0.03170919418334961
local_in_edges_tensor generation:  0.04919242858886719
mini_batch_src_global generation:  0.06197929382324219
r_  generation:  0.4930698871612549
local_output_nid generation:  0.031032562255859375
local_in_edges_tensor generation:  0.04068422317504883
mini_batch_src_global generation:  0.057099103927612305
r_  generation:  0.5183172225952148
local_output_nid generation:  0.03393959999084473
local_in_edges_tensor generation:  0.03152036666870117
mini_batch_src_global generation:  0.05944538116455078
r_  generation:  0.5112764835357666
local_output_nid generation:  0.031411170959472656
local_in_edges_tensor generation:  0.07950472831726074
mini_batch_src_global generation:  0.06434845924377441
r_  generation:  0.5311586856842041
local_output_nid generation:  0.03312373161315918
local_in_edges_tensor generation:  0.05124187469482422
mini_batch_src_global generation:  0.06850123405456543
r_  generation:  0.5012047290802002
local_output_nid generation:  0.032894134521484375
local_in_edges_tensor generation:  0.03799009323120117
mini_batch_src_global generation:  0.05896806716918945
r_  generation:  0.5059630870819092
local_output_nid generation:  0.03216838836669922
local_in_edges_tensor generation:  0.04515790939331055
mini_batch_src_global generation:  0.0598607063293457
r_  generation:  0.5023400783538818
local_output_nid generation:  0.03236222267150879
local_in_edges_tensor generation:  0.04479074478149414
mini_batch_src_global generation:  0.06173586845397949
r_  generation:  0.5123562812805176
local_output_nid generation:  0.03199291229248047
local_in_edges_tensor generation:  0.03152585029602051
mini_batch_src_global generation:  0.05975842475891113
r_  generation:  0.5149753093719482
local_output_nid generation:  0.03224492073059082
local_in_edges_tensor generation:  0.031867027282714844
mini_batch_src_global generation:  0.05819129943847656
r_  generation:  0.5097577571868896
local_output_nid generation:  0.03359079360961914
local_in_edges_tensor generation:  0.0455474853515625
mini_batch_src_global generation:  0.059676408767700195
r_  generation:  0.5081086158752441
local_output_nid generation:  0.03232169151306152
local_in_edges_tensor generation:  0.03366804122924805
mini_batch_src_global generation:  0.05843019485473633
r_  generation:  0.5226938724517822
local_output_nid generation:  0.03756380081176758
local_in_edges_tensor generation:  0.041004180908203125
mini_batch_src_global generation:  0.07545709609985352
r_  generation:  0.5005033016204834
local_output_nid generation:  0.03249502182006836
local_in_edges_tensor generation:  0.039489030838012695
mini_batch_src_global generation:  0.06197333335876465
r_  generation:  0.5073721408843994
local_output_nid generation:  0.03215742111206055
local_in_edges_tensor generation:  0.03889203071594238
mini_batch_src_global generation:  0.05923962593078613
r_  generation:  0.5018987655639648
----------------------check_connections_block total spend ----------------------------- 12.07958698272705
generate_one_block  0.6630804538726807
generate_one_block  0.665963888168335
generate_one_block  0.6547579765319824
generate_one_block  0.6407294273376465
generate_one_block  0.6626148223876953
generate_one_block  0.6559710502624512
generate_one_block  0.651188850402832
generate_one_block  0.6580464839935303
generate_one_block  0.685983419418335
generate_one_block  0.6403355598449707
generate_one_block  0.6523785591125488
generate_one_block  0.6578934192657471
generate_one_block  0.6619963645935059
generate_one_block  0.642655611038208
generate_one_block  0.6644563674926758
generate_one_block  0.6613559722900391
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.046180009841918945
gen group dst list time:  0.09916520118713379
time for parepare:  0.01922464370727539
local_output_nid generation:  0.03368711471557617
local_in_edges_tensor generation:  0.060834646224975586
mini_batch_src_global generation:  0.05425405502319336
r_  generation:  0.5370845794677734
local_output_nid generation:  0.04089689254760742
local_in_edges_tensor generation:  0.05531620979309082
mini_batch_src_global generation:  0.0631556510925293
r_  generation:  0.5424911975860596
local_output_nid generation:  0.04044485092163086
local_in_edges_tensor generation:  0.04062628746032715
mini_batch_src_global generation:  0.05956315994262695
r_  generation:  0.5522942543029785
local_output_nid generation:  0.04086160659790039
local_in_edges_tensor generation:  0.04085063934326172
mini_batch_src_global generation:  0.07050299644470215
r_  generation:  0.551030158996582
local_output_nid generation:  0.04000520706176758
local_in_edges_tensor generation:  0.040730953216552734
mini_batch_src_global generation:  0.05947518348693848
r_  generation:  0.5598793029785156
local_output_nid generation:  0.03793692588806152
local_in_edges_tensor generation:  0.043608665466308594
mini_batch_src_global generation:  0.05835151672363281
r_  generation:  0.5595762729644775
local_output_nid generation:  0.03821921348571777
local_in_edges_tensor generation:  0.04107785224914551
mini_batch_src_global generation:  0.05986976623535156
r_  generation:  0.5661256313323975
local_output_nid generation:  0.04020118713378906
local_in_edges_tensor generation:  0.041159629821777344
mini_batch_src_global generation:  0.06061220169067383
r_  generation:  0.5675599575042725
local_output_nid generation:  0.03792309761047363
local_in_edges_tensor generation:  0.04122591018676758
mini_batch_src_global generation:  0.06084012985229492
r_  generation:  0.5764651298522949
local_output_nid generation:  0.03804922103881836
local_in_edges_tensor generation:  0.04066896438598633
mini_batch_src_global generation:  0.06093549728393555
r_  generation:  0.5682580471038818
local_output_nid generation:  0.03783297538757324
local_in_edges_tensor generation:  0.04119277000427246
mini_batch_src_global generation:  0.06207132339477539
r_  generation:  0.5738480091094971
local_output_nid generation:  0.038049936294555664
local_in_edges_tensor generation:  0.04119277000427246
mini_batch_src_global generation:  0.06091785430908203
r_  generation:  0.5707128047943115
local_output_nid generation:  0.03799724578857422
local_in_edges_tensor generation:  0.04124021530151367
mini_batch_src_global generation:  0.06181812286376953
r_  generation:  0.5719008445739746
local_output_nid generation:  0.03815412521362305
local_in_edges_tensor generation:  0.041219234466552734
mini_batch_src_global generation:  0.06229209899902344
r_  generation:  0.5729660987854004
local_output_nid generation:  0.03779911994934082
local_in_edges_tensor generation:  0.0411837100982666
mini_batch_src_global generation:  0.062311410903930664
r_  generation:  0.5754578113555908
local_output_nid generation:  0.037847280502319336
local_in_edges_tensor generation:  0.04151344299316406
mini_batch_src_global generation:  0.062239885330200195
r_  generation:  0.5775468349456787
----------------------check_connections_block total spend ----------------------------- 13.41867470741272
generate_one_block  0.7075281143188477
generate_one_block  0.6991167068481445
generate_one_block  0.6929571628570557
generate_one_block  0.6912918090820312
generate_one_block  0.6961963176727295
generate_one_block  0.6884148120880127
generate_one_block  0.765852689743042
generate_one_block  0.7055654525756836
generate_one_block  0.690558910369873
generate_one_block  0.6989507675170898
generate_one_block  0.6932809352874756
generate_one_block  0.7143721580505371
generate_one_block  0.6973154544830322
generate_one_block  0.6962110996246338
generate_one_block  0.6900160312652588
generate_one_block  0.7030479907989502
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03744649887084961
gen group dst list time:  0.10700750350952148
time for parepare:  0.01981377601623535
local_output_nid generation:  0.03643941879272461
local_in_edges_tensor generation:  0.0516204833984375
mini_batch_src_global generation:  0.06133532524108887
r_  generation:  0.558340311050415
local_output_nid generation:  0.041869401931762695
local_in_edges_tensor generation:  0.05170774459838867
mini_batch_src_global generation:  0.0659325122833252
r_  generation:  0.5464451313018799
local_output_nid generation:  0.03972172737121582
local_in_edges_tensor generation:  0.05321812629699707
mini_batch_src_global generation:  0.06275391578674316
r_  generation:  0.5716314315795898
local_output_nid generation:  0.041744232177734375
local_in_edges_tensor generation:  0.04244089126586914
mini_batch_src_global generation:  0.0631721019744873
r_  generation:  0.5594446659088135
local_output_nid generation:  0.040909767150878906
local_in_edges_tensor generation:  0.05385613441467285
mini_batch_src_global generation:  0.07848000526428223
r_  generation:  0.6150634288787842
local_output_nid generation:  0.04276132583618164
local_in_edges_tensor generation:  0.047403812408447266
mini_batch_src_global generation:  0.06246781349182129
r_  generation:  0.5486547946929932
local_output_nid generation:  0.04207015037536621
local_in_edges_tensor generation:  0.041300296783447266
mini_batch_src_global generation:  0.06435585021972656
r_  generation:  0.5810883045196533
local_output_nid generation:  0.04406023025512695
local_in_edges_tensor generation:  0.041001081466674805
mini_batch_src_global generation:  0.06424999237060547
r_  generation:  0.5719549655914307
local_output_nid generation:  0.045528411865234375
local_in_edges_tensor generation:  0.05676722526550293
mini_batch_src_global generation:  0.07207894325256348
r_  generation:  0.5702557563781738
local_output_nid generation:  0.04165005683898926
local_in_edges_tensor generation:  0.0473175048828125
mini_batch_src_global generation:  0.06218314170837402
r_  generation:  0.5587382316589355
local_output_nid generation:  0.042333364486694336
local_in_edges_tensor generation:  0.042562007904052734
mini_batch_src_global generation:  0.06131863594055176
r_  generation:  0.5629656314849854
local_output_nid generation:  0.04163312911987305
local_in_edges_tensor generation:  0.04268336296081543
mini_batch_src_global generation:  0.0625765323638916
r_  generation:  0.562952995300293
local_output_nid generation:  0.0415804386138916
local_in_edges_tensor generation:  0.05342364311218262
mini_batch_src_global generation:  0.06946897506713867
r_  generation:  0.5798099040985107
local_output_nid generation:  0.04274272918701172
local_in_edges_tensor generation:  0.04339909553527832
mini_batch_src_global generation:  0.06083559989929199
r_  generation:  0.5673518180847168
local_output_nid generation:  0.04164624214172363
local_in_edges_tensor generation:  0.04092550277709961
mini_batch_src_global generation:  0.060573577880859375
r_  generation:  0.5863018035888672
local_output_nid generation:  0.041559696197509766
local_in_edges_tensor generation:  0.04129600524902344
mini_batch_src_global generation:  0.06231951713562012
r_  generation:  0.5664117336273193
----------------------check_connections_block total spend ----------------------------- 13.760348081588745
generate_one_block  0.6936402320861816
generate_one_block  0.6994411945343018
generate_one_block  0.7002725601196289
generate_one_block  0.7053570747375488
generate_one_block  0.7011353969573975
generate_one_block  0.707209587097168
generate_one_block  0.6951572895050049
generate_one_block  0.6986665725708008
generate_one_block  0.694551944732666
generate_one_block  0.8054344654083252
generate_one_block  0.6949982643127441
generate_one_block  0.6959543228149414
generate_one_block  0.708266019821167
generate_one_block  0.7048516273498535
generate_one_block  0.6830940246582031
generate_one_block  0.6950864791870117
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03223991394042969
gen group dst list time:  0.09250569343566895
time for parepare:  0.019578218460083008
local_output_nid generation:  0.03882241249084473
local_in_edges_tensor generation:  0.05325794219970703
mini_batch_src_global generation:  0.047942161560058594
r_  generation:  0.5052752494812012
local_output_nid generation:  0.04414939880371094
local_in_edges_tensor generation:  0.05188632011413574
mini_batch_src_global generation:  0.057590484619140625
r_  generation:  0.506340503692627
local_output_nid generation:  0.04503631591796875
local_in_edges_tensor generation:  0.04028725624084473
mini_batch_src_global generation:  0.06202411651611328
r_  generation:  0.5083701610565186
local_output_nid generation:  0.0457761287689209
local_in_edges_tensor generation:  0.046942949295043945
mini_batch_src_global generation:  0.061905860900878906
r_  generation:  0.5079460144042969
local_output_nid generation:  0.04416179656982422
local_in_edges_tensor generation:  0.04673290252685547
mini_batch_src_global generation:  0.05784773826599121
r_  generation:  0.507150411605835
local_output_nid generation:  0.04233980178833008
local_in_edges_tensor generation:  0.041889190673828125
mini_batch_src_global generation:  0.05795741081237793
r_  generation:  0.5070042610168457
local_output_nid generation:  0.04099130630493164
local_in_edges_tensor generation:  0.04007363319396973
mini_batch_src_global generation:  0.05890679359436035
r_  generation:  0.5095350742340088
local_output_nid generation:  0.04108929634094238
local_in_edges_tensor generation:  0.04510641098022461
mini_batch_src_global generation:  0.057405948638916016
r_  generation:  0.5153284072875977
local_output_nid generation:  0.04088997840881348
local_in_edges_tensor generation:  0.04270195960998535
mini_batch_src_global generation:  0.05762934684753418
r_  generation:  0.5126960277557373
local_output_nid generation:  0.04125809669494629
local_in_edges_tensor generation:  0.04165506362915039
mini_batch_src_global generation:  0.05762052536010742
r_  generation:  0.5128898620605469
local_output_nid generation:  0.042900800704956055
local_in_edges_tensor generation:  0.04478287696838379
mini_batch_src_global generation:  0.057144880294799805
r_  generation:  0.5114908218383789
local_output_nid generation:  0.04202890396118164
local_in_edges_tensor generation:  0.042415618896484375
mini_batch_src_global generation:  0.05776500701904297
r_  generation:  0.5152454376220703
local_output_nid generation:  0.04201388359069824
local_in_edges_tensor generation:  0.04542899131774902
mini_batch_src_global generation:  0.05776214599609375
r_  generation:  0.5177743434906006
local_output_nid generation:  0.0420229434967041
local_in_edges_tensor generation:  0.04044914245605469
mini_batch_src_global generation:  0.05802440643310547
r_  generation:  0.5148105621337891
local_output_nid generation:  0.041974544525146484
local_in_edges_tensor generation:  0.04053854942321777
mini_batch_src_global generation:  0.05750703811645508
r_  generation:  0.515608549118042
local_output_nid generation:  0.042192935943603516
local_in_edges_tensor generation:  0.0402073860168457
mini_batch_src_global generation:  0.05799579620361328
r_  generation:  0.5178325176239014
----------------------check_connections_block total spend ----------------------------- 12.4744291305542
generate_one_block  0.6393377780914307
generate_one_block  0.655634880065918
generate_one_block  0.6391394138336182
generate_one_block  0.6451027393341064
generate_one_block  0.6347537040710449
generate_one_block  0.6343686580657959
generate_one_block  0.6385548114776611
generate_one_block  0.6380014419555664
generate_one_block  0.637554407119751
generate_one_block  0.6347348690032959
generate_one_block  0.6392369270324707
generate_one_block  0.6351058483123779
generate_one_block  0.7119913101196289
generate_one_block  0.6496305465698242
generate_one_block  0.6480591297149658
generate_one_block  0.6253139972686768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.253507137298584  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

connection checking time:  56.893733739852905
block generation total time  48.04643702507019
average batch blocks generation time:  3.002902314066887
block dataloader generation time/epoch 108.54928469657898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13679027557373047  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167206, 128])
torch.Size([166358, 64])
torch.Size([163956, 64])
torch.Size([155787, 64])
torch.Size([123450, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8184828758239746  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13686323165893555  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167146, 128])
torch.Size([166308, 64])
torch.Size([163899, 64])
torch.Size([155811, 64])
torch.Size([124517, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8204822540283203  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13681316375732422  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167251, 128])
torch.Size([166448, 64])
torch.Size([164074, 64])
torch.Size([155654, 64])
torch.Size([123277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8183894157409668  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13677024841308594  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167230, 128])
torch.Size([166428, 64])
torch.Size([164061, 64])
torch.Size([155702, 64])
torch.Size([122484, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8175778388977051  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13686132431030273  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167244, 128])
torch.Size([166480, 64])
torch.Size([164183, 64])
torch.Size([155980, 64])
torch.Size([124163, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.820587158203125  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13680028915405273  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167154, 128])
torch.Size([166320, 64])
torch.Size([163987, 64])
torch.Size([155447, 64])
torch.Size([123231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8181195259094238  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13683223724365234  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167249, 128])
torch.Size([166485, 64])
torch.Size([164046, 64])
torch.Size([155654, 64])
torch.Size([123692, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8192214965820312  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368865966796875  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

torch.Size([167221, 128])
torch.Size([166435, 64])
torch.Size([164097, 64])
torch.Size([156177, 64])
torch.Size([124806, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8208389282226562  GigaBytes
Max Memory Allocated: 0.8424625396728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368241310119629  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167248, 128])
torch.Size([166415, 64])
torch.Size([164033, 64])
torch.Size([155759, 64])
torch.Size([123749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8191099166870117  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13680601119995117  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167236, 128])
torch.Size([166443, 64])
torch.Size([164091, 64])
torch.Size([155775, 64])
torch.Size([123357, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8187503814697266  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13680696487426758  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167211, 128])
torch.Size([166365, 64])
torch.Size([163886, 64])
torch.Size([155637, 64])
torch.Size([123585, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8186712265014648  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13683271408081055  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167214, 128])
torch.Size([166383, 64])
torch.Size([164059, 64])
torch.Size([155864, 64])
torch.Size([123750, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8191671371459961  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13686466217041016  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167149, 128])
torch.Size([166306, 64])
torch.Size([163931, 64])
torch.Size([155715, 64])
torch.Size([124348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8203201293945312  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13680410385131836  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167232, 128])
torch.Size([166404, 64])
torch.Size([164032, 64])
torch.Size([155798, 64])
torch.Size([123828, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8192205429077148  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368560791015625  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167213, 128])
torch.Size([166389, 64])
torch.Size([163959, 64])
torch.Size([155708, 64])
torch.Size([124042, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8199200630187988  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368236541748047  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

torch.Size([167176, 128])
torch.Size([166343, 64])
torch.Size([163966, 64])
torch.Size([155711, 64])
torch.Size([123659, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8191461563110352  GigaBytes
Max Memory Allocated: 0.8433675765991211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07104453444480896 |0.04086555540561676 |0.006643429398536682 |9.149312973022461e-05 |0.007503822445869446 |0.00564122200012207 |
----------------------------------------------------------pseudo_mini_loss sum 4.115498065948486
Total (block generation + training)time/epoch 110.65060186386108
Training time/epoch 2.1010348796844482
Training time without block to device /epoch 1.44718599319458
Training time without total dataloading part /epoch 0.2334611415863037
load block tensor time/epoch 1.1367125511169434
block to device time/epoch 0.6538488864898682
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13094760
Number of first layer input nodes during this epoch:  2675380
