Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648442875.9584975
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028301477432250977
random selection method range initialization spend 0.006345272064208984
time for parepare:  0.018536806106567383
local_output_nid generation:  0.008264303207397461
local_in_edges_tensor generation:  0.00981593132019043
mini_batch_src_global generation:  0.007469654083251953
r_  generation:  0.09247565269470215
local_output_nid generation:  0.011739730834960938
local_in_edges_tensor generation:  0.006232023239135742
mini_batch_src_global generation:  0.009687185287475586
r_  generation:  0.09954690933227539
local_output_nid generation:  0.011941194534301758
local_in_edges_tensor generation:  0.006316423416137695
mini_batch_src_global generation:  0.007815122604370117
r_  generation:  0.10114288330078125
local_output_nid generation:  0.01199793815612793
local_in_edges_tensor generation:  0.006311655044555664
mini_batch_src_global generation:  0.008509397506713867
r_  generation:  0.10332226753234863
----------------------check_connections_block total spend ----------------------------- 0.6087114810943604
generate_one_block  0.1140897274017334
generate_one_block  0.11701536178588867
generate_one_block  0.11657309532165527
generate_one_block  0.11807513236999512
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04543471336364746
gen group dst list time:  0.011355161666870117
time for parepare:  0.019066572189331055
local_output_nid generation:  0.01993250846862793
local_in_edges_tensor generation:  0.0483555793762207
mini_batch_src_global generation:  0.04532599449157715
r_  generation:  0.4726541042327881
local_output_nid generation:  0.026617050170898438
local_in_edges_tensor generation:  0.046956539154052734
mini_batch_src_global generation:  0.06083536148071289
r_  generation:  0.4884352684020996
local_output_nid generation:  0.0279848575592041
local_in_edges_tensor generation:  0.035134077072143555
mini_batch_src_global generation:  0.05696702003479004
r_  generation:  0.5147316455841064
local_output_nid generation:  0.028031587600708008
local_in_edges_tensor generation:  0.06538939476013184
mini_batch_src_global generation:  0.07073283195495605
r_  generation:  0.4891839027404785
----------------------check_connections_block total spend ----------------------------- 2.9646482467651367
generate_one_block  0.6680262088775635
generate_one_block  0.6653146743774414
generate_one_block  0.6516284942626953
generate_one_block  0.6360132694244385
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.057410478591918945
gen group dst list time:  0.023279905319213867
time for parepare:  0.018800020217895508
local_output_nid generation:  0.030167818069458008
local_in_edges_tensor generation:  0.07516050338745117
mini_batch_src_global generation:  0.05429720878601074
r_  generation:  0.5657367706298828
local_output_nid generation:  0.03710675239562988
local_in_edges_tensor generation:  0.05911660194396973
mini_batch_src_global generation:  0.06674528121948242
r_  generation:  0.5690412521362305
local_output_nid generation:  0.03716564178466797
local_in_edges_tensor generation:  0.054573774337768555
mini_batch_src_global generation:  0.06461286544799805
r_  generation:  0.576812744140625
local_output_nid generation:  0.04901266098022461
local_in_edges_tensor generation:  0.0492398738861084
mini_batch_src_global generation:  0.06321430206298828
r_  generation:  0.5964245796203613
----------------------check_connections_block total spend ----------------------------- 3.4980764389038086
generate_one_block  0.764211893081665
generate_one_block  0.7552988529205322
generate_one_block  0.7484261989593506
generate_one_block  0.7498133182525635
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  6.462724685668945
block generation total time  5.63873291015625
average batch blocks generation time:  1.4096832275390625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.1065216064453125  GigaBytes
Max Memory Allocated: 0.1065216064453125  GigaBytes

torch.Size([165672, 128])
torch.Size([157282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.6772570610046387  GigaBytes
Max Memory Allocated: 0.7193136215209961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4744873046875 GB
    Memory Allocated: 0.11031103134155273  GigaBytes
Max Memory Allocated: 0.7775511741638184  GigaBytes

torch.Size([165710, 128])
torch.Size([157282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.6808152198791504  GigaBytes
Max Memory Allocated: 0.7775511741638184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.11031150817871094  GigaBytes
Max Memory Allocated: 0.7821502685546875  GigaBytes

torch.Size([165691, 128])
torch.Size([157267, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.681394100189209  GigaBytes
Max Memory Allocated: 0.7821502685546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.11038637161254883  GigaBytes
Max Memory Allocated: 0.7826676368713379  GigaBytes

torch.Size([165858, 128])
torch.Size([157573, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.682530403137207  GigaBytes
Max Memory Allocated: 0.7826676368713379  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05923819541931152 |0.11743372678756714 |0.19289028644561768 |0.00015205144882202148 |0.017070233821868896 |0.005136728286743164 |
----------------------------------------------------------pseudo_mini_loss sum 5.531558036804199
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1721633
Number of first layer input nodes during this epoch:  662931
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.15460586547851562  GigaBytes
Max Memory Allocated: 0.7840433120727539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02457284927368164
random selection method range initialization spend 0.0053288936614990234
time for parepare:  0.019506216049194336
local_output_nid generation:  0.010250329971313477
local_in_edges_tensor generation:  0.010235786437988281
mini_batch_src_global generation:  0.007866859436035156
r_  generation:  0.09177422523498535
local_output_nid generation:  0.011931657791137695
local_in_edges_tensor generation:  0.0068225860595703125
mini_batch_src_global generation:  0.010243415832519531
r_  generation:  0.10338973999023438
local_output_nid generation:  0.01220250129699707
local_in_edges_tensor generation:  0.0069713592529296875
mini_batch_src_global generation:  0.008431673049926758
r_  generation:  0.1043252944946289
local_output_nid generation:  0.012042522430419922
local_in_edges_tensor generation:  0.007005929946899414
mini_batch_src_global generation:  0.009079933166503906
r_  generation:  0.10642600059509277
----------------------check_connections_block total spend ----------------------------- 0.6314406394958496
generate_one_block  0.1213836669921875
generate_one_block  0.11658930778503418
generate_one_block  0.11724519729614258
generate_one_block  0.11855506896972656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.061614036560058594
gen group dst list time:  0.014847278594970703
time for parepare:  0.023061752319335938
local_output_nid generation:  0.020447492599487305
local_in_edges_tensor generation:  0.06032991409301758
mini_batch_src_global generation:  0.05756068229675293
r_  generation:  0.48320841789245605
local_output_nid generation:  0.028342485427856445
local_in_edges_tensor generation:  0.05070662498474121
mini_batch_src_global generation:  0.06164813041687012
r_  generation:  0.4991426467895508
local_output_nid generation:  0.027991056442260742
local_in_edges_tensor generation:  0.03304743766784668
mini_batch_src_global generation:  0.056949615478515625
r_  generation:  0.49073004722595215
local_output_nid generation:  0.027469396591186523
local_in_edges_tensor generation:  0.03198838233947754
mini_batch_src_global generation:  0.05890536308288574
r_  generation:  0.5291652679443359
----------------------check_connections_block total spend ----------------------------- 2.996776580810547
generate_one_block  0.6461834907531738
generate_one_block  0.6491832733154297
generate_one_block  0.663278341293335
generate_one_block  0.6256868839263916
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043001413345336914
gen group dst list time:  0.02141404151916504
time for parepare:  0.018767118453979492
local_output_nid generation:  0.02958059310913086
local_in_edges_tensor generation:  0.06742048263549805
mini_batch_src_global generation:  0.0703277587890625
r_  generation:  0.6253042221069336
local_output_nid generation:  0.045359134674072266
local_in_edges_tensor generation:  0.06487011909484863
mini_batch_src_global generation:  0.09055089950561523
r_  generation:  0.5983498096466064
local_output_nid generation:  0.03959035873413086
local_in_edges_tensor generation:  0.05530118942260742
mini_batch_src_global generation:  0.08529853820800781
r_  generation:  0.6000180244445801
local_output_nid generation:  0.03937101364135742
local_in_edges_tensor generation:  0.05460667610168457
mini_batch_src_global generation:  0.07240152359008789
r_  generation:  0.613290548324585
----------------------check_connections_block total spend ----------------------------- 3.736426591873169
generate_one_block  0.7532844543457031
generate_one_block  0.7659206390380859
generate_one_block  0.7319555282592773
generate_one_block  0.7485165596008301
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.15460586547851562  GigaBytes
Max Memory Allocated: 0.7840433120727539  GigaBytes

connection checking time:  6.733203172683716
block generation total time  5.584009170532227
average batch blocks generation time:  1.3960022926330566
block dataloader generation time/epoch 14.4678316116333
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.11086797714233398  GigaBytes
Max Memory Allocated: 0.7840433120727539  GigaBytes

torch.Size([165726, 128])
torch.Size([157493, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.6823935508728027  GigaBytes
Max Memory Allocated: 0.7840433120727539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.11091184616088867  GigaBytes
Max Memory Allocated: 0.7840433120727539  GigaBytes

torch.Size([165742, 128])
torch.Size([157451, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.682988166809082  GigaBytes
Max Memory Allocated: 0.7840433120727539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.11070680618286133  GigaBytes
Max Memory Allocated: 0.7845845222473145  GigaBytes

torch.Size([165596, 128])
torch.Size([157030, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.6807470321655273  GigaBytes
Max Memory Allocated: 0.7845845222473145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.1109471321105957  GigaBytes
Max Memory Allocated: 0.7845845222473145  GigaBytes

torch.Size([165856, 128])
torch.Size([157666, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.6827187538146973  GigaBytes
Max Memory Allocated: 0.7845845222473145  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055229008197784424 |0.020769238471984863 |0.00494229793548584 |0.00012576580047607422 |0.010824322700500488 |0.004282474517822266 |
----------------------------------------------------------pseudo_mini_loss sum 3.5578103065490723
Total (block generation + training)time/epoch 14.852019548416138
Training time/epoch 0.38388538360595703
Training time without block to device /epoch 0.3008084297180176
Training time without total dataloading part /epoch 0.06785202026367188
load block tensor time/epoch 0.2209160327911377
block to device time/epoch 0.08307695388793945
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1722337
Number of first layer input nodes during this epoch:  662920
