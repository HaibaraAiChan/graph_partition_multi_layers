Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648441505.752519
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024413347244262695
random selection method range initialization spend 0.00572514533996582
time for parepare:  0.01885986328125
local_output_nid generation:  0.002126455307006836
local_in_edges_tensor generation:  0.00463557243347168
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.017742395401000977
local_output_nid generation:  0.0026407241821289062
local_in_edges_tensor generation:  0.0016398429870605469
mini_batch_src_global generation:  0.0020482540130615234
r_  generation:  0.017581462860107422
local_output_nid generation:  0.0027768611907958984
local_in_edges_tensor generation:  0.0015337467193603516
mini_batch_src_global generation:  0.0013747215270996094
r_  generation:  0.0179750919342041
local_output_nid generation:  0.002855062484741211
local_in_edges_tensor generation:  0.0015516281127929688
mini_batch_src_global generation:  0.0013773441314697266
r_  generation:  0.017405986785888672
local_output_nid generation:  0.002918243408203125
local_in_edges_tensor generation:  0.0014719963073730469
mini_batch_src_global generation:  0.0014185905456542969
r_  generation:  0.0178375244140625
local_output_nid generation:  0.002811431884765625
local_in_edges_tensor generation:  0.0014433860778808594
mini_batch_src_global generation:  0.0014331340789794922
r_  generation:  0.018648862838745117
local_output_nid generation:  0.0029115676879882812
local_in_edges_tensor generation:  0.0015268325805664062
mini_batch_src_global generation:  0.0015096664428710938
r_  generation:  0.019121646881103516
local_output_nid generation:  0.002964496612548828
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.019498109817504883
local_output_nid generation:  0.002864360809326172
local_in_edges_tensor generation:  0.0014529228210449219
mini_batch_src_global generation:  0.0014958381652832031
r_  generation:  0.018696069717407227
local_output_nid generation:  0.002886533737182617
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0014946460723876953
r_  generation:  0.018764257431030273
local_output_nid generation:  0.002961397171020508
local_in_edges_tensor generation:  0.001474142074584961
mini_batch_src_global generation:  0.0015223026275634766
r_  generation:  0.019114017486572266
local_output_nid generation:  0.0028579235076904297
local_in_edges_tensor generation:  0.0014843940734863281
mini_batch_src_global generation:  0.0014925003051757812
r_  generation:  0.018804311752319336
local_output_nid generation:  0.002852201461791992
local_in_edges_tensor generation:  0.001443624496459961
mini_batch_src_global generation:  0.007441520690917969
r_  generation:  0.01917719841003418
local_output_nid generation:  0.002888202667236328
local_in_edges_tensor generation:  0.0014920234680175781
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.018776416778564453
local_output_nid generation:  0.002908468246459961
local_in_edges_tensor generation:  0.001470327377319336
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.019054174423217773
local_output_nid generation:  0.0028264522552490234
local_in_edges_tensor generation:  0.0014641284942626953
mini_batch_src_global generation:  0.0015506744384765625
r_  generation:  0.019187211990356445
----------------------check_connections_block total spend ----------------------------- 0.4959127902984619
generate_one_block  0.026959657669067383
generate_one_block  0.027703523635864258
generate_one_block  0.02974867820739746
generate_one_block  0.0271761417388916
generate_one_block  0.02764606475830078
generate_one_block  0.02791118621826172
generate_one_block  0.02808690071105957
generate_one_block  0.028766632080078125
generate_one_block  0.0273284912109375
generate_one_block  0.02716803550720215
generate_one_block  0.0276947021484375
generate_one_block  0.027753114700317383
generate_one_block  0.02753472328186035
generate_one_block  0.02733445167541504
generate_one_block  0.027832508087158203
generate_one_block  0.027790069580078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03877758979797363
gen group dst list time:  0.018668651580810547
time for parepare:  0.01894974708557129
local_output_nid generation:  0.008165597915649414
local_in_edges_tensor generation:  0.01729607582092285
mini_batch_src_global generation:  0.018559932708740234
r_  generation:  0.1896517276763916
local_output_nid generation:  0.011899709701538086
local_in_edges_tensor generation:  0.018822193145751953
mini_batch_src_global generation:  0.023965835571289062
r_  generation:  0.19620013236999512
local_output_nid generation:  0.011591911315917969
local_in_edges_tensor generation:  0.015188217163085938
mini_batch_src_global generation:  0.022342205047607422
r_  generation:  0.1994915008544922
local_output_nid generation:  0.01154947280883789
local_in_edges_tensor generation:  0.01390838623046875
mini_batch_src_global generation:  0.025118112564086914
r_  generation:  0.2019033432006836
local_output_nid generation:  0.011857032775878906
local_in_edges_tensor generation:  0.015819787979125977
mini_batch_src_global generation:  0.02697157859802246
r_  generation:  0.20924067497253418
local_output_nid generation:  0.011837959289550781
local_in_edges_tensor generation:  0.012200355529785156
mini_batch_src_global generation:  0.025620222091674805
r_  generation:  0.20561909675598145
local_output_nid generation:  0.011938810348510742
local_in_edges_tensor generation:  0.012645721435546875
mini_batch_src_global generation:  0.02757859230041504
r_  generation:  0.21120810508728027
local_output_nid generation:  0.012137413024902344
local_in_edges_tensor generation:  0.014608144760131836
mini_batch_src_global generation:  0.026354551315307617
r_  generation:  0.21271395683288574
local_output_nid generation:  0.011805057525634766
local_in_edges_tensor generation:  0.014027118682861328
mini_batch_src_global generation:  0.026472091674804688
r_  generation:  0.20810961723327637
local_output_nid generation:  0.011864423751831055
local_in_edges_tensor generation:  0.013754129409790039
mini_batch_src_global generation:  0.030985355377197266
r_  generation:  0.20848345756530762
local_output_nid generation:  0.011943578720092773
local_in_edges_tensor generation:  0.014232158660888672
mini_batch_src_global generation:  0.0280001163482666
r_  generation:  0.21381807327270508
local_output_nid generation:  0.012030839920043945
local_in_edges_tensor generation:  0.014554738998413086
mini_batch_src_global generation:  0.026256799697875977
r_  generation:  0.21270155906677246
local_output_nid generation:  0.01191401481628418
local_in_edges_tensor generation:  0.014450311660766602
mini_batch_src_global generation:  0.02666497230529785
r_  generation:  0.21198415756225586
local_output_nid generation:  0.011860847473144531
local_in_edges_tensor generation:  0.014127016067504883
mini_batch_src_global generation:  0.02605414390563965
r_  generation:  0.2058577537536621
local_output_nid generation:  0.011923789978027344
local_in_edges_tensor generation:  0.01582026481628418
mini_batch_src_global generation:  0.027985334396362305
r_  generation:  0.21042943000793457
local_output_nid generation:  0.012074470520019531
local_in_edges_tensor generation:  0.014609813690185547
mini_batch_src_global generation:  0.027115345001220703
r_  generation:  0.21822094917297363
----------------------check_connections_block total spend ----------------------------- 4.902926683425903
generate_one_block  0.267411470413208
generate_one_block  0.2627241611480713
generate_one_block  0.26162290573120117
generate_one_block  0.263263463973999
generate_one_block  0.28667640686035156
generate_one_block  0.2685866355895996
generate_one_block  0.27364206314086914
generate_one_block  0.27593564987182617
generate_one_block  0.2640955448150635
generate_one_block  0.2673811912536621
generate_one_block  0.2729072570800781
generate_one_block  0.27163004875183105
generate_one_block  0.2713043689727783
generate_one_block  0.26015138626098633
generate_one_block  0.27821779251098633
generate_one_block  0.27872467041015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03226447105407715
gen group dst list time:  0.05872797966003418
time for parepare:  0.018720626831054688
local_output_nid generation:  0.025287389755249023
local_in_edges_tensor generation:  0.03933453559875488
mini_batch_src_global generation:  0.04197192192077637
r_  generation:  0.43773770332336426
local_output_nid generation:  0.03098464012145996
local_in_edges_tensor generation:  0.04753684997558594
mini_batch_src_global generation:  0.051366329193115234
r_  generation:  0.44185519218444824
local_output_nid generation:  0.030313968658447266
local_in_edges_tensor generation:  0.04242587089538574
mini_batch_src_global generation:  0.049901485443115234
r_  generation:  0.44875645637512207
local_output_nid generation:  0.03050827980041504
local_in_edges_tensor generation:  0.03570365905761719
mini_batch_src_global generation:  0.05560588836669922
r_  generation:  0.4483039379119873
local_output_nid generation:  0.030632972717285156
local_in_edges_tensor generation:  0.03161740303039551
mini_batch_src_global generation:  0.05118560791015625
r_  generation:  0.45143580436706543
local_output_nid generation:  0.030571937561035156
local_in_edges_tensor generation:  0.03383302688598633
mini_batch_src_global generation:  0.05663180351257324
r_  generation:  0.4517636299133301
local_output_nid generation:  0.030661344528198242
local_in_edges_tensor generation:  0.03567051887512207
mini_batch_src_global generation:  0.056287527084350586
r_  generation:  0.4606475830078125
local_output_nid generation:  0.030807971954345703
local_in_edges_tensor generation:  0.0438997745513916
mini_batch_src_global generation:  0.05638456344604492
r_  generation:  0.45780444145202637
local_output_nid generation:  0.03173208236694336
local_in_edges_tensor generation:  0.051583051681518555
mini_batch_src_global generation:  0.07083320617675781
r_  generation:  0.5162160396575928
local_output_nid generation:  0.03136873245239258
local_in_edges_tensor generation:  0.02948307991027832
mini_batch_src_global generation:  0.05646681785583496
r_  generation:  0.4546525478363037
local_output_nid generation:  0.030966997146606445
local_in_edges_tensor generation:  0.0368800163269043
mini_batch_src_global generation:  0.05505561828613281
r_  generation:  0.4645709991455078
local_output_nid generation:  0.03679537773132324
local_in_edges_tensor generation:  0.04214000701904297
mini_batch_src_global generation:  0.06675577163696289
r_  generation:  0.4649021625518799
local_output_nid generation:  0.03157925605773926
local_in_edges_tensor generation:  0.033531904220581055
mini_batch_src_global generation:  0.053011417388916016
r_  generation:  0.4693117141723633
local_output_nid generation:  0.03297853469848633
local_in_edges_tensor generation:  0.03341484069824219
mini_batch_src_global generation:  0.05522036552429199
r_  generation:  0.4883847236633301
local_output_nid generation:  0.03366994857788086
local_in_edges_tensor generation:  0.04035067558288574
mini_batch_src_global generation:  0.05476641654968262
r_  generation:  0.46598267555236816
local_output_nid generation:  0.03215742111206055
local_in_edges_tensor generation:  0.040468454360961914
mini_batch_src_global generation:  0.06724357604980469
r_  generation:  0.46610426902770996
----------------------check_connections_block total spend ----------------------------- 11.03395962715149
generate_one_block  0.5901086330413818
generate_one_block  0.5818028450012207
generate_one_block  0.5893259048461914
generate_one_block  0.5847649574279785
generate_one_block  0.6215000152587891
generate_one_block  0.6180939674377441
generate_one_block  0.6515717506408691
generate_one_block  0.5920853614807129
generate_one_block  0.5975544452667236
generate_one_block  0.577019214630127
generate_one_block  0.5804986953735352
generate_one_block  0.6066610813140869
generate_one_block  0.5783593654632568
generate_one_block  0.5710599422454834
generate_one_block  0.5902807712554932
generate_one_block  0.5993843078613281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  15.936886310577393
block generation total time  13.85434627532959
average batch blocks generation time:  0.8658966422080994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09002542495727539  GigaBytes
Max Memory Allocated: 0.09002542495727539  GigaBytes

torch.Size([154621, 128])
torch.Size([122633, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.4409933090209961  GigaBytes
Max Memory Allocated: 0.45858240127563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09113311767578125  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

torch.Size([154550, 128])
torch.Size([122301, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.44054174423217773  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09104633331298828  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

torch.Size([154024, 128])
torch.Size([121475, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.43910741806030273  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09108448028564453  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

torch.Size([154232, 128])
torch.Size([121909, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.43958473205566406  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09128570556640625  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

torch.Size([154535, 128])
torch.Size([122723, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4421558380126953  GigaBytes
Max Memory Allocated: 0.48013877868652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.09118080139160156  GigaBytes
Max Memory Allocated: 0.48165130615234375  GigaBytes

torch.Size([154559, 128])
torch.Size([122492, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.44116640090942383  GigaBytes
Max Memory Allocated: 0.48165130615234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.0912628173828125  GigaBytes
Max Memory Allocated: 0.48165130615234375  GigaBytes

torch.Size([154394, 128])
torch.Size([122493, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.4416623115539551  GigaBytes
Max Memory Allocated: 0.48165130615234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.0913839340209961  GigaBytes
Max Memory Allocated: 0.48165130615234375  GigaBytes

torch.Size([154513, 128])
torch.Size([122924, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 0.4445228576660156  GigaBytes
Max Memory Allocated: 0.48165130615234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.091156005859375  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154455, 128])
torch.Size([121976, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44029664993286133  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.091156005859375  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154161, 128])
torch.Size([121889, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4404926300048828  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09129142761230469  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154298, 128])
torch.Size([122452, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4413423538208008  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09130191802978516  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154542, 128])
torch.Size([123002, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4430217742919922  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09127616882324219  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154374, 128])
torch.Size([122491, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4414687156677246  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09110641479492188  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154704, 128])
torch.Size([122924, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4412670135498047  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09123992919921875  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154523, 128])
torch.Size([122490, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4416203498840332  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09134197235107422  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154534, 128])
torch.Size([123061, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44383716583251953  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03919222950935364 |0.03499878942966461 |0.050437912344932556 |9.584426879882812e-05 |0.007205158472061157 |0.003829479217529297 |
----------------------------------------------------------pseudo_mini_loss sum 5.5923943519592285
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5091282
Number of first layer input nodes during this epoch:  2471019
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.11396074295043945  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019315004348754883
random selection method range initialization spend 0.004873514175415039
time for parepare:  0.01695108413696289
local_output_nid generation:  0.002389192581176758
local_in_edges_tensor generation:  0.006159782409667969
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.01763010025024414
local_output_nid generation:  0.0027348995208740234
local_in_edges_tensor generation:  0.00168609619140625
mini_batch_src_global generation:  0.0020394325256347656
r_  generation:  0.018622159957885742
local_output_nid generation:  0.002812623977661133
local_in_edges_tensor generation:  0.0015416145324707031
mini_batch_src_global generation:  0.0013532638549804688
r_  generation:  0.018603801727294922
local_output_nid generation:  0.002848386764526367
local_in_edges_tensor generation:  0.001501321792602539
mini_batch_src_global generation:  0.0013904571533203125
r_  generation:  0.01859593391418457
local_output_nid generation:  0.0029075145721435547
local_in_edges_tensor generation:  0.001528024673461914
mini_batch_src_global generation:  0.0013723373413085938
r_  generation:  0.018575668334960938
local_output_nid generation:  0.0028982162475585938
local_in_edges_tensor generation:  0.001485586166381836
mini_batch_src_global generation:  0.0013546943664550781
r_  generation:  0.01844477653503418
local_output_nid generation:  0.002854585647583008
local_in_edges_tensor generation:  0.0014433860778808594
mini_batch_src_global generation:  0.0014405250549316406
r_  generation:  0.019565820693969727
local_output_nid generation:  0.002875089645385742
local_in_edges_tensor generation:  0.0014352798461914062
mini_batch_src_global generation:  0.0015270709991455078
r_  generation:  0.01918506622314453
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.0014929771423339844
mini_batch_src_global generation:  0.0014171600341796875
r_  generation:  0.018845796585083008
local_output_nid generation:  0.00286102294921875
local_in_edges_tensor generation:  0.0014176368713378906
mini_batch_src_global generation:  0.0014910697937011719
r_  generation:  0.01971292495727539
local_output_nid generation:  0.002868175506591797
local_in_edges_tensor generation:  0.0015082359313964844
mini_batch_src_global generation:  0.0015451908111572266
r_  generation:  0.020661354064941406
local_output_nid generation:  0.0029082298278808594
local_in_edges_tensor generation:  0.0014255046844482422
mini_batch_src_global generation:  0.0015418529510498047
r_  generation:  0.019080162048339844
local_output_nid generation:  0.002863168716430664
local_in_edges_tensor generation:  0.0014739036560058594
mini_batch_src_global generation:  0.001508474349975586
r_  generation:  0.019730567932128906
local_output_nid generation:  0.0028772354125976562
local_in_edges_tensor generation:  0.00141143798828125
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.019632816314697266
local_output_nid generation:  0.0029053688049316406
local_in_edges_tensor generation:  0.0014319419860839844
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.019112586975097656
local_output_nid generation:  0.0028951168060302734
local_in_edges_tensor generation:  0.0014472007751464844
mini_batch_src_global generation:  0.0015385150909423828
r_  generation:  0.01969122886657715
----------------------check_connections_block total spend ----------------------------- 0.5019094944000244
generate_one_block  0.03076958656311035
generate_one_block  0.028353452682495117
generate_one_block  0.028081655502319336
generate_one_block  0.027858734130859375
generate_one_block  0.027315139770507812
generate_one_block  0.029888629913330078
generate_one_block  0.028132200241088867
generate_one_block  0.027751922607421875
generate_one_block  0.029926538467407227
generate_one_block  0.027762889862060547
generate_one_block  0.027432680130004883
generate_one_block  0.027091026306152344
generate_one_block  0.030498743057250977
generate_one_block  0.028423786163330078
generate_one_block  0.027202129364013672
generate_one_block  0.02870035171508789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03533172607421875
gen group dst list time:  0.017389774322509766
time for parepare:  0.01885366439819336
local_output_nid generation:  0.008364439010620117
local_in_edges_tensor generation:  0.01746225357055664
mini_batch_src_global generation:  0.02135777473449707
r_  generation:  0.2003803253173828
local_output_nid generation:  0.012955665588378906
local_in_edges_tensor generation:  0.02454376220703125
mini_batch_src_global generation:  0.027372121810913086
r_  generation:  0.20711612701416016
local_output_nid generation:  0.013738632202148438
local_in_edges_tensor generation:  0.01742839813232422
mini_batch_src_global generation:  0.024770498275756836
r_  generation:  0.20788335800170898
local_output_nid generation:  0.01308131217956543
local_in_edges_tensor generation:  0.014299869537353516
mini_batch_src_global generation:  0.024546146392822266
r_  generation:  0.20906710624694824
local_output_nid generation:  0.012705564498901367
local_in_edges_tensor generation:  0.01401829719543457
mini_batch_src_global generation:  0.025139331817626953
r_  generation:  0.20882463455200195
local_output_nid generation:  0.012295246124267578
local_in_edges_tensor generation:  0.013665199279785156
mini_batch_src_global generation:  0.024892091751098633
r_  generation:  0.20816993713378906
local_output_nid generation:  0.012325763702392578
local_in_edges_tensor generation:  0.017043113708496094
mini_batch_src_global generation:  0.02578258514404297
r_  generation:  0.21442127227783203
local_output_nid generation:  0.012269973754882812
local_in_edges_tensor generation:  0.012818336486816406
mini_batch_src_global generation:  0.02580738067626953
r_  generation:  0.2125544548034668
local_output_nid generation:  0.012185335159301758
local_in_edges_tensor generation:  0.013053417205810547
mini_batch_src_global generation:  0.025454998016357422
r_  generation:  0.2076418399810791
local_output_nid generation:  0.012438297271728516
local_in_edges_tensor generation:  0.016171693801879883
mini_batch_src_global generation:  0.02632904052734375
r_  generation:  0.21729135513305664
local_output_nid generation:  0.012284517288208008
local_in_edges_tensor generation:  0.012511491775512695
mini_batch_src_global generation:  0.026273488998413086
r_  generation:  0.2132718563079834
local_output_nid generation:  0.012286186218261719
local_in_edges_tensor generation:  0.01356959342956543
mini_batch_src_global generation:  0.02578449249267578
r_  generation:  0.21489620208740234
local_output_nid generation:  0.012589693069458008
local_in_edges_tensor generation:  0.013821601867675781
mini_batch_src_global generation:  0.02654123306274414
r_  generation:  0.21930527687072754
local_output_nid generation:  0.012175559997558594
local_in_edges_tensor generation:  0.01574563980102539
mini_batch_src_global generation:  0.026260852813720703
r_  generation:  0.21936392784118652
local_output_nid generation:  0.012146472930908203
local_in_edges_tensor generation:  0.013832330703735352
mini_batch_src_global generation:  0.026166915893554688
r_  generation:  0.21400928497314453
local_output_nid generation:  0.012392282485961914
local_in_edges_tensor generation:  0.014016866683959961
mini_batch_src_global generation:  0.02799201011657715
r_  generation:  0.22593235969543457
----------------------check_connections_block total spend ----------------------------- 5.033567190170288
generate_one_block  0.29129743576049805
generate_one_block  0.2632780075073242
generate_one_block  0.2716939449310303
generate_one_block  0.2766251564025879
generate_one_block  0.26955103874206543
generate_one_block  0.26955080032348633
generate_one_block  0.30883264541625977
generate_one_block  0.27347326278686523
generate_one_block  0.2626347541809082
generate_one_block  0.27518391609191895
generate_one_block  0.2695322036743164
generate_one_block  0.26673078536987305
generate_one_block  0.2791786193847656
generate_one_block  0.2779567241668701
generate_one_block  0.2603635787963867
generate_one_block  0.27687644958496094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05078577995300293
gen group dst list time:  0.06650590896606445
time for parepare:  0.01808023452758789
local_output_nid generation:  0.02544999122619629
local_in_edges_tensor generation:  0.05792117118835449
mini_batch_src_global generation:  0.0443873405456543
r_  generation:  0.4378833770751953
local_output_nid generation:  0.031249523162841797
local_in_edges_tensor generation:  0.045815229415893555
mini_batch_src_global generation:  0.05040097236633301
r_  generation:  0.44647860527038574
local_output_nid generation:  0.03087782859802246
local_in_edges_tensor generation:  0.04204607009887695
mini_batch_src_global generation:  0.04970216751098633
r_  generation:  0.45868706703186035
local_output_nid generation:  0.03116893768310547
local_in_edges_tensor generation:  0.04889678955078125
mini_batch_src_global generation:  0.050722599029541016
r_  generation:  0.4518425464630127
local_output_nid generation:  0.03126072883605957
local_in_edges_tensor generation:  0.07210040092468262
mini_batch_src_global generation:  0.05073070526123047
r_  generation:  0.45978569984436035
local_output_nid generation:  0.030727148056030273
local_in_edges_tensor generation:  0.030237913131713867
mini_batch_src_global generation:  0.051685333251953125
r_  generation:  0.45658040046691895
local_output_nid generation:  0.03098607063293457
local_in_edges_tensor generation:  0.03378176689147949
mini_batch_src_global generation:  0.05446624755859375
r_  generation:  0.46160411834716797
local_output_nid generation:  0.030823469161987305
local_in_edges_tensor generation:  0.04207611083984375
mini_batch_src_global generation:  0.05212759971618652
r_  generation:  0.4591538906097412
local_output_nid generation:  0.030931711196899414
local_in_edges_tensor generation:  0.03030228614807129
mini_batch_src_global generation:  0.051816701889038086
r_  generation:  0.45803070068359375
local_output_nid generation:  0.033429622650146484
local_in_edges_tensor generation:  0.02989792823791504
mini_batch_src_global generation:  0.05538439750671387
r_  generation:  0.457275390625
local_output_nid generation:  0.031036376953125
local_in_edges_tensor generation:  0.03831195831298828
mini_batch_src_global generation:  0.05125999450683594
r_  generation:  0.46175146102905273
local_output_nid generation:  0.031038522720336914
local_in_edges_tensor generation:  0.03615236282348633
mini_batch_src_global generation:  0.05277538299560547
r_  generation:  0.45850133895874023
local_output_nid generation:  0.03193998336791992
local_in_edges_tensor generation:  0.033094167709350586
mini_batch_src_global generation:  0.05449962615966797
r_  generation:  0.4679880142211914
local_output_nid generation:  0.03190732002258301
local_in_edges_tensor generation:  0.04660630226135254
mini_batch_src_global generation:  0.05182814598083496
r_  generation:  0.477205753326416
local_output_nid generation:  0.032648563385009766
local_in_edges_tensor generation:  0.03680610656738281
mini_batch_src_global generation:  0.05440521240234375
r_  generation:  0.4631662368774414
local_output_nid generation:  0.033715009689331055
local_in_edges_tensor generation:  0.0365750789642334
mini_batch_src_global generation:  0.057669639587402344
r_  generation:  0.45834994316101074
----------------------check_connections_block total spend ----------------------------- 10.902514219284058
generate_one_block  0.5784151554107666
generate_one_block  0.5773961544036865
generate_one_block  0.5843691825866699
generate_one_block  0.5829617977142334
generate_one_block  0.5791823863983154
generate_one_block  0.5672643184661865
generate_one_block  0.5841271877288818
generate_one_block  0.586634635925293
generate_one_block  0.6066083908081055
generate_one_block  0.58467698097229
generate_one_block  0.5776093006134033
generate_one_block  0.5713071823120117
generate_one_block  0.5848712921142578
generate_one_block  0.586503267288208
generate_one_block  0.5641651153564453
generate_one_block  0.5749285221099854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.11396074295043945  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

connection checking time:  15.936081409454346
block generation total time  13.683780193328857
average batch blocks generation time:  0.8552362620830536
block dataloader generation time/epoch 31.779743671417236
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09180974960327148  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154461, 128])
torch.Size([122062, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4420194625854492  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.0916604995727539  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154356, 128])
torch.Size([121905, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44106245040893555  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.0919036865234375  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154661, 128])
torch.Size([123152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4439420700073242  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09183979034423828  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154074, 128])
torch.Size([122252, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44229936599731445  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09177970886230469  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154723, 128])
torch.Size([122807, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44155025482177734  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.0916299819946289  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154610, 128])
torch.Size([122101, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44006872177124023  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09189510345458984  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154314, 128])
torch.Size([122306, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44229698181152344  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09178924560546875  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154607, 128])
torch.Size([122406, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4422273635864258  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09163570404052734  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154273, 128])
torch.Size([121825, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.440279483795166  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09189128875732422  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154115, 128])
torch.Size([122526, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4424324035644531  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09173297882080078  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154561, 128])
torch.Size([122561, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4415159225463867  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.091705322265625  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154594, 128])
torch.Size([122384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44121503829956055  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09188365936279297  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154395, 128])
torch.Size([122665, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44254446029663086  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09183311462402344  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154827, 128])
torch.Size([122870, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44181060791015625  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09162044525146484  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154677, 128])
torch.Size([121956, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.4398984909057617  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.09189414978027344  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

torch.Size([154530, 128])
torch.Size([122995, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.44449377059936523  GigaBytes
Max Memory Allocated: 0.4842796325683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040383100509643555 |0.01567147672176361 |0.003896459937095642 |9.427964687347412e-05 |0.004528790712356567 |0.0015673637390136719 |
----------------------------------------------------------pseudo_mini_loss sum 3.559086799621582
Total (block generation + training)time/epoch 32.85196924209595
Training time/epoch 1.0719244480133057
Training time without block to device /epoch 0.8211808204650879
Training time without total dataloading part /epoch 0.1378798484802246
load block tensor time/epoch 0.6461296081542969
block to device time/epoch 0.2507436275482178
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5091530
Number of first layer input nodes during this epoch:  2471778
