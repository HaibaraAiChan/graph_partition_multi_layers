Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648438884.6925125
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026877403259277344
random selection method range initialization spend 0.0063092708587646484
time for parepare:  0.018970489501953125
local_output_nid generation:  0.004261016845703125
local_in_edges_tensor generation:  0.00544428825378418
mini_batch_src_global generation:  0.003829479217529297
r_  generation:  0.04383587837219238
local_output_nid generation:  0.0060918331146240234
local_in_edges_tensor generation:  0.0032358169555664062
mini_batch_src_global generation:  0.00495600700378418
r_  generation:  0.04612255096435547
local_output_nid generation:  0.006186962127685547
local_in_edges_tensor generation:  0.0032317638397216797
mini_batch_src_global generation:  0.003413677215576172
r_  generation:  0.04633593559265137
local_output_nid generation:  0.006122589111328125
local_in_edges_tensor generation:  0.0032913684844970703
mini_batch_src_global generation:  0.003498077392578125
r_  generation:  0.047551870346069336
local_output_nid generation:  0.00622105598449707
local_in_edges_tensor generation:  0.0033006668090820312
mini_batch_src_global generation:  0.003852367401123047
r_  generation:  0.048926591873168945
local_output_nid generation:  0.0061876773834228516
local_in_edges_tensor generation:  0.003357410430908203
mini_batch_src_global generation:  0.004023551940917969
r_  generation:  0.04885721206665039
local_output_nid generation:  0.00616145133972168
local_in_edges_tensor generation:  0.003208160400390625
mini_batch_src_global generation:  0.004119157791137695
r_  generation:  0.04899024963378906
local_output_nid generation:  0.006232738494873047
local_in_edges_tensor generation:  0.0032968521118164062
mini_batch_src_global generation:  0.003907918930053711
r_  generation:  0.04758763313293457
----------------------check_connections_block total spend ----------------------------- 0.5925436019897461
generate_one_block  0.06185603141784668
generate_one_block  0.06397056579589844
generate_one_block  0.06372547149658203
generate_one_block  0.06281685829162598
generate_one_block  0.06806564331054688
generate_one_block  0.06297183036804199
generate_one_block  0.06240224838256836
generate_one_block  0.06183123588562012
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04391932487487793
gen group dst list time:  0.01659870147705078
time for parepare:  0.01904439926147461
local_output_nid generation:  0.01438760757446289
local_in_edges_tensor generation:  0.0342259407043457
mini_batch_src_global generation:  0.03856062889099121
r_  generation:  0.37007880210876465
local_output_nid generation:  0.020572662353515625
local_in_edges_tensor generation:  0.03970503807067871
mini_batch_src_global generation:  0.04556155204772949
r_  generation:  0.398449182510376
local_output_nid generation:  0.01973104476928711
local_in_edges_tensor generation:  0.0321197509765625
mini_batch_src_global generation:  0.044463396072387695
r_  generation:  0.39973878860473633
local_output_nid generation:  0.01958942413330078
local_in_edges_tensor generation:  0.024705171585083008
mini_batch_src_global generation:  0.05145549774169922
r_  generation:  0.40468788146972656
local_output_nid generation:  0.02112436294555664
local_in_edges_tensor generation:  0.030109405517578125
mini_batch_src_global generation:  0.054740190505981445
r_  generation:  0.41150689125061035
local_output_nid generation:  0.022731781005859375
local_in_edges_tensor generation:  0.028461933135986328
mini_batch_src_global generation:  0.04814767837524414
r_  generation:  0.39004087448120117
local_output_nid generation:  0.020296573638916016
local_in_edges_tensor generation:  0.027955055236816406
mini_batch_src_global generation:  0.0468134880065918
r_  generation:  0.38629603385925293
local_output_nid generation:  0.019998550415039062
local_in_edges_tensor generation:  0.02786540985107422
mini_batch_src_global generation:  0.04624319076538086
r_  generation:  0.3838486671447754
----------------------check_connections_block total spend ----------------------------- 4.5985894203186035
generate_one_block  0.5073626041412354
generate_one_block  0.5172722339630127
generate_one_block  0.5045740604400635
generate_one_block  0.5132803916931152
generate_one_block  0.505413293838501
generate_one_block  0.5183267593383789
generate_one_block  0.49668025970458984
generate_one_block  0.49504733085632324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05104207992553711
gen group dst list time:  0.038222551345825195
time for parepare:  0.019038677215576172
local_output_nid generation:  0.02914905548095703
local_in_edges_tensor generation:  0.06818103790283203
mini_batch_src_global generation:  0.06525373458862305
r_  generation:  0.5569839477539062
local_output_nid generation:  0.03656959533691406
local_in_edges_tensor generation:  0.06598544120788574
mini_batch_src_global generation:  0.0709841251373291
r_  generation:  0.5853230953216553
local_output_nid generation:  0.040358543395996094
local_in_edges_tensor generation:  0.05450940132141113
mini_batch_src_global generation:  0.06713724136352539
r_  generation:  0.5619432926177979
local_output_nid generation:  0.03701138496398926
local_in_edges_tensor generation:  0.04372406005859375
mini_batch_src_global generation:  0.0638425350189209
r_  generation:  0.574202299118042
local_output_nid generation:  0.03760695457458496
local_in_edges_tensor generation:  0.04096579551696777
mini_batch_src_global generation:  0.06209874153137207
r_  generation:  0.5743417739868164
local_output_nid generation:  0.03783106803894043
local_in_edges_tensor generation:  0.03571438789367676
mini_batch_src_global generation:  0.06319928169250488
r_  generation:  0.5780003070831299
local_output_nid generation:  0.037139177322387695
local_in_edges_tensor generation:  0.040183067321777344
mini_batch_src_global generation:  0.06332111358642578
r_  generation:  0.5982112884521484
local_output_nid generation:  0.03715014457702637
local_in_edges_tensor generation:  0.039990901947021484
mini_batch_src_global generation:  0.06343531608581543
r_  generation:  0.5894136428833008
----------------------check_connections_block total spend ----------------------------- 6.835666179656982
generate_one_block  0.731795072555542
generate_one_block  0.757451057434082
generate_one_block  0.726006031036377
generate_one_block  0.7166986465454102
generate_one_block  0.7198755741119385
generate_one_block  0.7157790660858154
generate_one_block  0.7481341361999512
generate_one_block  0.7162044048309326
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  11.434255599975586
block generation total time  9.889900922775269
average batch blocks generation time:  1.2362376153469086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.101470947265625  GigaBytes
Max Memory Allocated: 0.101470947265625  GigaBytes

torch.Size([162424, 128])
torch.Size([145393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.22617244720458984  GigaBytes
Max Memory Allocated: 0.22868633270263672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10392284393310547  GigaBytes
Max Memory Allocated: 0.24132776260375977  GigaBytes

torch.Size([162865, 128])
torch.Size([146516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22833013534545898  GigaBytes
Max Memory Allocated: 0.24132776260375977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10408735275268555  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162467, 128])
torch.Size([145835, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22775888442993164  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10393238067626953  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162659, 128])
torch.Size([146185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22759008407592773  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10410213470458984  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162551, 128])
torch.Size([145901, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22786998748779297  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10391616821289062  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162665, 128])
torch.Size([145932, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22753667831420898  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10384845733642578  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162522, 128])
torch.Size([146084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2274489402770996  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10390806198120117  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162534, 128])
torch.Size([146019, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2262887954711914  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03853824734687805 |0.05371442437171936 |0.09639936685562134 |0.00010889768600463867 |0.009580463171005249 |0.0037567615509033203 |
----------------------------------------------------------pseudo_mini_loss sum 5.013064384460449
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057449
Number of first layer input nodes during this epoch:  1300687
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.15240001678466797  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023909568786621094
random selection method range initialization spend 0.0061686038970947266
time for parepare:  0.020352840423583984
local_output_nid generation:  0.0045223236083984375
local_in_edges_tensor generation:  0.009435892105102539
mini_batch_src_global generation:  0.004464149475097656
r_  generation:  0.04614758491516113
local_output_nid generation:  0.0060231685638427734
local_in_edges_tensor generation:  0.003197908401489258
mini_batch_src_global generation:  0.005698680877685547
r_  generation:  0.048569679260253906
local_output_nid generation:  0.006219625473022461
local_in_edges_tensor generation:  0.0034453868865966797
mini_batch_src_global generation:  0.0038836002349853516
r_  generation:  0.048254966735839844
local_output_nid generation:  0.006121397018432617
local_in_edges_tensor generation:  0.0033469200134277344
mini_batch_src_global generation:  0.004102945327758789
r_  generation:  0.04706692695617676
local_output_nid generation:  0.006188631057739258
local_in_edges_tensor generation:  0.0032575130462646484
mini_batch_src_global generation:  0.003817319869995117
r_  generation:  0.0485687255859375
local_output_nid generation:  0.006254434585571289
local_in_edges_tensor generation:  0.003401517868041992
mini_batch_src_global generation:  0.0044324398040771484
r_  generation:  0.050766706466674805
local_output_nid generation:  0.006106138229370117
local_in_edges_tensor generation:  0.003361940383911133
mini_batch_src_global generation:  0.004059314727783203
r_  generation:  0.04816842079162598
local_output_nid generation:  0.006064891815185547
local_in_edges_tensor generation:  0.003274679183959961
mini_batch_src_global generation:  0.004139423370361328
r_  generation:  0.05034899711608887
----------------------check_connections_block total spend ----------------------------- 0.6193802356719971
generate_one_block  0.06386160850524902
generate_one_block  0.06161212921142578
generate_one_block  0.06343626976013184
generate_one_block  0.06209850311279297
generate_one_block  0.06362152099609375
generate_one_block  0.06494402885437012
generate_one_block  0.06516003608703613
generate_one_block  0.06300950050354004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04175734519958496
gen group dst list time:  0.0166168212890625
time for parepare:  0.02230978012084961
local_output_nid generation:  0.014322042465209961
local_in_edges_tensor generation:  0.03627324104309082
mini_batch_src_global generation:  0.035555124282836914
r_  generation:  0.3745131492614746
local_output_nid generation:  0.021973609924316406
local_in_edges_tensor generation:  0.039659976959228516
mini_batch_src_global generation:  0.06119680404663086
r_  generation:  0.3974146842956543
local_output_nid generation:  0.02405071258544922
local_in_edges_tensor generation:  0.03330397605895996
mini_batch_src_global generation:  0.045258522033691406
r_  generation:  0.3947579860687256
local_output_nid generation:  0.02063751220703125
local_in_edges_tensor generation:  0.029889822006225586
mini_batch_src_global generation:  0.048088788986206055
r_  generation:  0.3881409168243408
local_output_nid generation:  0.02068948745727539
local_in_edges_tensor generation:  0.022246599197387695
mini_batch_src_global generation:  0.046552181243896484
r_  generation:  0.391737699508667
local_output_nid generation:  0.021605491638183594
local_in_edges_tensor generation:  0.04081130027770996
mini_batch_src_global generation:  0.04757356643676758
r_  generation:  0.4036240577697754
local_output_nid generation:  0.02208423614501953
local_in_edges_tensor generation:  0.03176116943359375
mini_batch_src_global generation:  0.06027364730834961
r_  generation:  0.39062047004699707
local_output_nid generation:  0.020177125930786133
local_in_edges_tensor generation:  0.03154635429382324
mini_batch_src_global generation:  0.047428131103515625
r_  generation:  0.4033482074737549
----------------------check_connections_block total spend ----------------------------- 4.650883674621582
generate_one_block  0.5133953094482422
generate_one_block  0.509493350982666
generate_one_block  0.4931185245513916
generate_one_block  0.5045695304870605
generate_one_block  0.5058577060699463
generate_one_block  0.5113973617553711
generate_one_block  0.5163290500640869
generate_one_block  0.5345268249511719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035996437072753906
gen group dst list time:  0.03919696807861328
time for parepare:  0.020865917205810547
local_output_nid generation:  0.029370784759521484
local_in_edges_tensor generation:  0.06734585762023926
mini_batch_src_global generation:  0.05204629898071289
r_  generation:  0.5540928840637207
local_output_nid generation:  0.03549933433532715
local_in_edges_tensor generation:  0.05544328689575195
mini_batch_src_global generation:  0.06515073776245117
r_  generation:  0.5671870708465576
local_output_nid generation:  0.03563809394836426
local_in_edges_tensor generation:  0.04629087448120117
mini_batch_src_global generation:  0.06165456771850586
r_  generation:  0.5820996761322021
local_output_nid generation:  0.03541898727416992
local_in_edges_tensor generation:  0.0464019775390625
mini_batch_src_global generation:  0.0609743595123291
r_  generation:  0.5723121166229248
local_output_nid generation:  0.03532147407531738
local_in_edges_tensor generation:  0.03623700141906738
mini_batch_src_global generation:  0.06193661689758301
r_  generation:  0.5895209312438965
local_output_nid generation:  0.03574633598327637
local_in_edges_tensor generation:  0.04034686088562012
mini_batch_src_global generation:  0.06657624244689941
r_  generation:  0.5786566734313965
local_output_nid generation:  0.036141157150268555
local_in_edges_tensor generation:  0.04571175575256348
mini_batch_src_global generation:  0.06340408325195312
r_  generation:  0.5806369781494141
local_output_nid generation:  0.03614211082458496
local_in_edges_tensor generation:  0.04553937911987305
mini_batch_src_global generation:  0.06348729133605957
r_  generation:  0.5785396099090576
----------------------check_connections_block total spend ----------------------------- 6.775624513626099
generate_one_block  0.7238988876342773
generate_one_block  0.7243309020996094
generate_one_block  0.7098062038421631
generate_one_block  0.7443504333496094
generate_one_block  0.7217302322387695
generate_one_block  0.7345376014709473
generate_one_block  0.7390317916870117
generate_one_block  0.719036340713501
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.15240001678466797  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

connection checking time:  11.42650818824768
block generation total time  9.905410051345825
average batch blocks generation time:  1.2381762564182281
block dataloader generation time/epoch 23.56098747253418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10407304763793945  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162637, 128])
torch.Size([145877, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22722768783569336  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10431671142578125  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162513, 128])
torch.Size([145804, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22786760330200195  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.1039438247680664  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162575, 128])
torch.Size([145584, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22745227813720703  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10425567626953125  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162475, 128])
torch.Size([145870, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22776269912719727  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10413551330566406  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162496, 128])
torch.Size([145727, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22776079177856445  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10436773300170898  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162647, 128])
torch.Size([145791, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2279338836669922  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10387992858886719  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162823, 128])
torch.Size([146378, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22771692276000977  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10418558120727539  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

torch.Size([162685, 128])
torch.Size([146228, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22785425186157227  GigaBytes
Max Memory Allocated: 0.24357128143310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031893253326416016 |0.017144203186035156 |0.0036202967166900635 |0.00010100007057189941 |0.0049024224281311035 |0.0020554065704345703 |
----------------------------------------------------------pseudo_mini_loss sum 4.325191020965576
Total (block generation + training)time/epoch 24.045960426330566
Training time/epoch 0.48476481437683105
Training time without block to device /epoch 0.3476111888885498
Training time without total dataloading part /epoch 0.0710451602935791
load block tensor time/epoch 0.2551460266113281
block to device time/epoch 0.13715362548828125
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3056907
Number of first layer input nodes during this epoch:  1300851
