Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648511289.8192344
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02385687828063965
random selection method range initialization spend 0.006537199020385742
time for parepare:  0.019022464752197266
local_output_nid generation:  0.0021157264709472656
local_in_edges_tensor generation:  0.0036759376525878906
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.018538475036621094
local_output_nid generation:  0.0028328895568847656
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.002081632614135742
r_  generation:  0.018352746963500977
local_output_nid generation:  0.002923250198364258
local_in_edges_tensor generation:  0.0015454292297363281
mini_batch_src_global generation:  0.0013959407806396484
r_  generation:  0.018628358840942383
local_output_nid generation:  0.0029306411743164062
local_in_edges_tensor generation:  0.0015795230865478516
mini_batch_src_global generation:  0.0014138221740722656
r_  generation:  0.018202543258666992
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0014927387237548828
mini_batch_src_global generation:  0.0013506412506103516
r_  generation:  0.018480300903320312
local_output_nid generation:  0.002888202667236328
local_in_edges_tensor generation:  0.001466512680053711
mini_batch_src_global generation:  0.001430511474609375
r_  generation:  0.019174814224243164
local_output_nid generation:  0.0030884742736816406
local_in_edges_tensor generation:  0.0015380382537841797
mini_batch_src_global generation:  0.0014622211456298828
r_  generation:  0.01938319206237793
local_output_nid generation:  0.0032062530517578125
local_in_edges_tensor generation:  0.001691579818725586
mini_batch_src_global generation:  0.0015091896057128906
r_  generation:  0.019583702087402344
local_output_nid generation:  0.0032203197479248047
local_in_edges_tensor generation:  0.0015723705291748047
mini_batch_src_global generation:  0.0015337467193603516
r_  generation:  0.019265413284301758
local_output_nid generation:  0.003091573715209961
local_in_edges_tensor generation:  0.0015668869018554688
mini_batch_src_global generation:  0.0015094280242919922
r_  generation:  0.019092082977294922
local_output_nid generation:  0.003037691116333008
local_in_edges_tensor generation:  0.0015151500701904297
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.019803524017333984
local_output_nid generation:  0.0030183792114257812
local_in_edges_tensor generation:  0.0014870166778564453
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.01958012580871582
local_output_nid generation:  0.002905130386352539
local_in_edges_tensor generation:  0.0014977455139160156
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.019558429718017578
local_output_nid generation:  0.0029299259185791016
local_in_edges_tensor generation:  0.0015115737915039062
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.01959824562072754
local_output_nid generation:  0.0029659271240234375
local_in_edges_tensor generation:  0.0015215873718261719
mini_batch_src_global generation:  0.001499176025390625
r_  generation:  0.019122600555419922
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.0014996528625488281
mini_batch_src_global generation:  0.0015223026275634766
r_  generation:  0.019295692443847656
----------------------check_connections_block total spend ----------------------------- 0.5027971267700195
generate_one_block  0.026780128479003906
generate_one_block  0.028183698654174805
generate_one_block  0.028309106826782227
generate_one_block  0.030457019805908203
generate_one_block  0.027821063995361328
generate_one_block  0.027795791625976562
generate_one_block  0.02738785743713379
generate_one_block  0.028186559677124023
generate_one_block  0.027393579483032227
generate_one_block  0.027590274810791016
generate_one_block  0.028156042098999023
generate_one_block  0.027811288833618164
generate_one_block  0.02798604965209961
generate_one_block  0.02841973304748535
generate_one_block  0.027001380920410156
generate_one_block  0.027469873428344727
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0378115177154541
gen group dst list time:  0.019232988357543945
time for parepare:  0.018642902374267578
local_output_nid generation:  0.008113384246826172
local_in_edges_tensor generation:  0.016696691513061523
mini_batch_src_global generation:  0.019756078720092773
r_  generation:  0.19504165649414062
local_output_nid generation:  0.011895418167114258
local_in_edges_tensor generation:  0.019666671752929688
mini_batch_src_global generation:  0.024712800979614258
r_  generation:  0.20009732246398926
local_output_nid generation:  0.012131452560424805
local_in_edges_tensor generation:  0.01803731918334961
mini_batch_src_global generation:  0.03313875198364258
r_  generation:  0.2144935131072998
local_output_nid generation:  0.011912822723388672
local_in_edges_tensor generation:  0.014283418655395508
mini_batch_src_global generation:  0.025411128997802734
r_  generation:  0.20922613143920898
local_output_nid generation:  0.011867523193359375
local_in_edges_tensor generation:  0.01230621337890625
mini_batch_src_global generation:  0.03377413749694824
r_  generation:  0.21532344818115234
local_output_nid generation:  0.011915922164916992
local_in_edges_tensor generation:  0.015633583068847656
mini_batch_src_global generation:  0.028116941452026367
r_  generation:  0.21615815162658691
local_output_nid generation:  0.011866331100463867
local_in_edges_tensor generation:  0.01216435432434082
mini_batch_src_global generation:  0.026414871215820312
r_  generation:  0.212263822555542
local_output_nid generation:  0.012023210525512695
local_in_edges_tensor generation:  0.016179323196411133
mini_batch_src_global generation:  0.02691197395324707
r_  generation:  0.2165517807006836
local_output_nid generation:  0.011655330657958984
local_in_edges_tensor generation:  0.012191534042358398
mini_batch_src_global generation:  0.026696205139160156
r_  generation:  0.21169185638427734
local_output_nid generation:  0.011861562728881836
local_in_edges_tensor generation:  0.013861656188964844
mini_batch_src_global generation:  0.02721571922302246
r_  generation:  0.21593952178955078
local_output_nid generation:  0.01199030876159668
local_in_edges_tensor generation:  0.019498825073242188
mini_batch_src_global generation:  0.02731156349182129
r_  generation:  0.2198338508605957
local_output_nid generation:  0.012016773223876953
local_in_edges_tensor generation:  0.0164339542388916
mini_batch_src_global generation:  0.02761530876159668
r_  generation:  0.23985052108764648
local_output_nid generation:  0.012160778045654297
local_in_edges_tensor generation:  0.017884016036987305
mini_batch_src_global generation:  0.02763819694519043
r_  generation:  0.22512364387512207
local_output_nid generation:  0.012067079544067383
local_in_edges_tensor generation:  0.015935420989990234
mini_batch_src_global generation:  0.027770280838012695
r_  generation:  0.21944761276245117
local_output_nid generation:  0.011777877807617188
local_in_edges_tensor generation:  0.01240682601928711
mini_batch_src_global generation:  0.027196407318115234
r_  generation:  0.21673059463500977
local_output_nid generation:  0.011799812316894531
local_in_edges_tensor generation:  0.01244044303894043
mini_batch_src_global generation:  0.027208805084228516
r_  generation:  0.21548819541931152
----------------------check_connections_block total spend ----------------------------- 5.086257219314575
generate_one_block  0.27652502059936523
generate_one_block  0.2735285758972168
generate_one_block  0.289074182510376
generate_one_block  0.27463698387145996
generate_one_block  0.28742408752441406
generate_one_block  0.27959656715393066
generate_one_block  0.2694723606109619
generate_one_block  0.28223323822021484
generate_one_block  0.27028775215148926
generate_one_block  0.2748262882232666
generate_one_block  0.2873098850250244
generate_one_block  0.2919473648071289
generate_one_block  0.283275842666626
generate_one_block  0.2790184020996094
generate_one_block  0.27282214164733887
generate_one_block  0.27832794189453125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.035456180572509766
gen group dst list time:  0.060028076171875
time for parepare:  0.018776893615722656
local_output_nid generation:  0.024503231048583984
local_in_edges_tensor generation:  0.04222440719604492
mini_batch_src_global generation:  0.04684281349182129
r_  generation:  0.47954320907592773
local_output_nid generation:  0.030858993530273438
local_in_edges_tensor generation:  0.05035138130187988
mini_batch_src_global generation:  0.05814862251281738
r_  generation:  0.4856712818145752
local_output_nid generation:  0.03052663803100586
local_in_edges_tensor generation:  0.041846513748168945
mini_batch_src_global generation:  0.05721306800842285
r_  generation:  0.49852538108825684
local_output_nid generation:  0.03031015396118164
local_in_edges_tensor generation:  0.036862850189208984
mini_batch_src_global generation:  0.05900454521179199
r_  generation:  0.49585890769958496
local_output_nid generation:  0.0301058292388916
local_in_edges_tensor generation:  0.03226280212402344
mini_batch_src_global generation:  0.05804157257080078
r_  generation:  0.49596476554870605
local_output_nid generation:  0.030669689178466797
local_in_edges_tensor generation:  0.03618502616882324
mini_batch_src_global generation:  0.05919027328491211
r_  generation:  0.5010693073272705
local_output_nid generation:  0.03065347671508789
local_in_edges_tensor generation:  0.03703927993774414
mini_batch_src_global generation:  0.05848956108093262
r_  generation:  0.5017197132110596
local_output_nid generation:  0.030521392822265625
local_in_edges_tensor generation:  0.041320085525512695
mini_batch_src_global generation:  0.05927610397338867
r_  generation:  0.5005507469177246
local_output_nid generation:  0.030615806579589844
local_in_edges_tensor generation:  0.03596758842468262
mini_batch_src_global generation:  0.058218955993652344
r_  generation:  0.5029606819152832
local_output_nid generation:  0.030650854110717773
local_in_edges_tensor generation:  0.03678274154663086
mini_batch_src_global generation:  0.06276512145996094
r_  generation:  0.49974775314331055
local_output_nid generation:  0.03047490119934082
local_in_edges_tensor generation:  0.03342723846435547
mini_batch_src_global generation:  0.05867743492126465
r_  generation:  0.5075607299804688
local_output_nid generation:  0.03112053871154785
local_in_edges_tensor generation:  0.0375676155090332
mini_batch_src_global generation:  0.06152844429016113
r_  generation:  0.5045762062072754
local_output_nid generation:  0.030630826950073242
local_in_edges_tensor generation:  0.04166913032531738
mini_batch_src_global generation:  0.05898308753967285
r_  generation:  0.5074949264526367
local_output_nid generation:  0.031205177307128906
local_in_edges_tensor generation:  0.03790473937988281
mini_batch_src_global generation:  0.06009387969970703
r_  generation:  0.505859375
local_output_nid generation:  0.030617713928222656
local_in_edges_tensor generation:  0.03673410415649414
mini_batch_src_global generation:  0.05878734588623047
r_  generation:  0.5109891891479492
local_output_nid generation:  0.030696392059326172
local_in_edges_tensor generation:  0.03629326820373535
mini_batch_src_global generation:  0.06278753280639648
r_  generation:  0.5067996978759766
----------------------check_connections_block total spend ----------------------------- 11.741819143295288
generate_one_block  0.6394011974334717
generate_one_block  0.6500310897827148
generate_one_block  0.6493484973907471
generate_one_block  0.643230676651001
generate_one_block  0.635322093963623
generate_one_block  0.705937385559082
generate_one_block  0.7623906135559082
generate_one_block  0.6790659427642822
generate_one_block  0.6556069850921631
generate_one_block  0.6749804019927979
generate_one_block  0.6630551815032959
generate_one_block  0.6780242919921875
generate_one_block  0.6569254398345947
generate_one_block  0.6532857418060303
generate_one_block  0.6349437236785889
generate_one_block  0.6385014057159424
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05943179130554199
gen group dst list time:  0.10396862030029297
time for parepare:  0.01985907554626465
local_output_nid generation:  0.036208152770996094
local_in_edges_tensor generation:  0.06824970245361328
mini_batch_src_global generation:  0.054657697677612305
r_  generation:  0.5484368801116943
local_output_nid generation:  0.042470693588256836
local_in_edges_tensor generation:  0.05838632583618164
mini_batch_src_global generation:  0.0697181224822998
r_  generation:  0.5425012111663818
local_output_nid generation:  0.03891277313232422
local_in_edges_tensor generation:  0.054822683334350586
mini_batch_src_global generation:  0.05943751335144043
r_  generation:  0.548823356628418
local_output_nid generation:  0.03915548324584961
local_in_edges_tensor generation:  0.04321932792663574
mini_batch_src_global generation:  0.06128120422363281
r_  generation:  0.5481777191162109
local_output_nid generation:  0.03956460952758789
local_in_edges_tensor generation:  0.04307866096496582
mini_batch_src_global generation:  0.06088829040527344
r_  generation:  0.5558359622955322
local_output_nid generation:  0.039131879806518555
local_in_edges_tensor generation:  0.04314088821411133
mini_batch_src_global generation:  0.06396961212158203
r_  generation:  0.5574362277984619
local_output_nid generation:  0.03912186622619629
local_in_edges_tensor generation:  0.046476125717163086
mini_batch_src_global generation:  0.06386542320251465
r_  generation:  0.5682082176208496
local_output_nid generation:  0.04026174545288086
local_in_edges_tensor generation:  0.04616284370422363
mini_batch_src_global generation:  0.06502604484558105
r_  generation:  0.5593686103820801
local_output_nid generation:  0.03987741470336914
local_in_edges_tensor generation:  0.04828310012817383
mini_batch_src_global generation:  0.06206512451171875
r_  generation:  0.5687904357910156
local_output_nid generation:  0.03971433639526367
local_in_edges_tensor generation:  0.044803619384765625
mini_batch_src_global generation:  0.06636548042297363
r_  generation:  0.5795078277587891
local_output_nid generation:  0.039600372314453125
local_in_edges_tensor generation:  0.057680606842041016
mini_batch_src_global generation:  0.0691981315612793
r_  generation:  0.5729517936706543
local_output_nid generation:  0.04183006286621094
local_in_edges_tensor generation:  0.0537722110748291
mini_batch_src_global generation:  0.06251406669616699
r_  generation:  0.5667717456817627
local_output_nid generation:  0.03980088233947754
local_in_edges_tensor generation:  0.0399470329284668
mini_batch_src_global generation:  0.0630948543548584
r_  generation:  0.5708940029144287
local_output_nid generation:  0.03997302055358887
local_in_edges_tensor generation:  0.04364800453186035
mini_batch_src_global generation:  0.06237292289733887
r_  generation:  0.5732169151306152
local_output_nid generation:  0.03926801681518555
local_in_edges_tensor generation:  0.03912758827209473
mini_batch_src_global generation:  0.06299424171447754
r_  generation:  0.5737285614013672
local_output_nid generation:  0.039826393127441406
local_in_edges_tensor generation:  0.04575610160827637
mini_batch_src_global generation:  0.0633394718170166
r_  generation:  0.5710833072662354
----------------------check_connections_block total spend ----------------------------- 13.565211057662964
generate_one_block  0.7126920223236084
generate_one_block  0.7079265117645264
generate_one_block  0.7234370708465576
generate_one_block  0.7725269794464111
generate_one_block  0.685905933380127
generate_one_block  0.6968674659729004
generate_one_block  0.7086951732635498
generate_one_block  0.6986534595489502
generate_one_block  0.6996963024139404
generate_one_block  0.6930770874023438
generate_one_block  0.6844658851623535
generate_one_block  0.7108039855957031
generate_one_block  0.6988415718078613
generate_one_block  0.7054121494293213
generate_one_block  0.6892449855804443
generate_one_block  0.6982040405273438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03756237030029297
gen group dst list time:  0.10664534568786621
time for parepare:  0.019269466400146484
local_output_nid generation:  0.035784006118774414
local_in_edges_tensor generation:  0.04785513877868652
mini_batch_src_global generation:  0.054070472717285156
r_  generation:  0.5364353656768799
local_output_nid generation:  0.04306221008300781
local_in_edges_tensor generation:  0.04728245735168457
mini_batch_src_global generation:  0.06317734718322754
r_  generation:  0.5395588874816895
local_output_nid generation:  0.04015183448791504
local_in_edges_tensor generation:  0.04115176200866699
mini_batch_src_global generation:  0.06474828720092773
r_  generation:  0.5381057262420654
local_output_nid generation:  0.04013681411743164
local_in_edges_tensor generation:  0.04170966148376465
mini_batch_src_global generation:  0.062311410903930664
r_  generation:  0.540158748626709
local_output_nid generation:  0.03999471664428711
local_in_edges_tensor generation:  0.041051626205444336
mini_batch_src_global generation:  0.06299996376037598
r_  generation:  0.5436050891876221
local_output_nid generation:  0.04027223587036133
local_in_edges_tensor generation:  0.041260719299316406
mini_batch_src_global generation:  0.06220412254333496
r_  generation:  0.5474705696105957
local_output_nid generation:  0.04007101058959961
local_in_edges_tensor generation:  0.041742801666259766
mini_batch_src_global generation:  0.06596922874450684
r_  generation:  0.5486929416656494
local_output_nid generation:  0.0400233268737793
local_in_edges_tensor generation:  0.04190802574157715
mini_batch_src_global generation:  0.06205320358276367
r_  generation:  0.55057692527771
local_output_nid generation:  0.043138980865478516
local_in_edges_tensor generation:  0.04637646675109863
mini_batch_src_global generation:  0.061907291412353516
r_  generation:  0.5550394058227539
local_output_nid generation:  0.04045248031616211
local_in_edges_tensor generation:  0.04110360145568848
mini_batch_src_global generation:  0.06168413162231445
r_  generation:  0.5519649982452393
local_output_nid generation:  0.03998899459838867
local_in_edges_tensor generation:  0.0410616397857666
mini_batch_src_global generation:  0.062154293060302734
r_  generation:  0.5564818382263184
local_output_nid generation:  0.04014706611633301
local_in_edges_tensor generation:  0.04627275466918945
mini_batch_src_global generation:  0.06151580810546875
r_  generation:  0.557335615158081
local_output_nid generation:  0.04088640213012695
local_in_edges_tensor generation:  0.036705732345581055
mini_batch_src_global generation:  0.061620235443115234
r_  generation:  0.5629827976226807
local_output_nid generation:  0.04043936729431152
local_in_edges_tensor generation:  0.041169166564941406
mini_batch_src_global generation:  0.07900023460388184
r_  generation:  0.5609002113342285
local_output_nid generation:  0.04049420356750488
local_in_edges_tensor generation:  0.04219627380371094
mini_batch_src_global generation:  0.06188011169433594
r_  generation:  0.559948205947876
local_output_nid generation:  0.0400698184967041
local_in_edges_tensor generation:  0.03631114959716797
mini_batch_src_global generation:  0.06212639808654785
r_  generation:  0.5561878681182861
----------------------check_connections_block total spend ----------------------------- 13.230719327926636
generate_one_block  0.7128951549530029
generate_one_block  0.7010350227355957
generate_one_block  0.6874713897705078
generate_one_block  0.6804099082946777
generate_one_block  0.7191433906555176
generate_one_block  0.6811654567718506
generate_one_block  0.7549710273742676
generate_one_block  0.6981086730957031
generate_one_block  0.6952495574951172
generate_one_block  0.6904044151306152
generate_one_block  0.7010576725006104
generate_one_block  0.6903703212738037
generate_one_block  0.6862022876739502
generate_one_block  0.6919293403625488
generate_one_block  0.6748983860015869
generate_one_block  0.6821599006652832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03534841537475586
gen group dst list time:  0.10481047630310059
time for parepare:  0.019028902053833008
local_output_nid generation:  0.03722381591796875
local_in_edges_tensor generation:  0.05630946159362793
mini_batch_src_global generation:  0.047631263732910156
r_  generation:  0.532684326171875
local_output_nid generation:  0.04356837272644043
local_in_edges_tensor generation:  0.038297176361083984
mini_batch_src_global generation:  0.05827903747558594
r_  generation:  0.5070486068725586
local_output_nid generation:  0.041115522384643555
local_in_edges_tensor generation:  0.03711128234863281
mini_batch_src_global generation:  0.05843353271484375
r_  generation:  0.5073020458221436
local_output_nid generation:  0.04051804542541504
local_in_edges_tensor generation:  0.037097930908203125
mini_batch_src_global generation:  0.059085845947265625
r_  generation:  0.5126893520355225
local_output_nid generation:  0.040650367736816406
local_in_edges_tensor generation:  0.040144920349121094
mini_batch_src_global generation:  0.06260013580322266
r_  generation:  0.5120341777801514
local_output_nid generation:  0.04099273681640625
local_in_edges_tensor generation:  0.03801560401916504
mini_batch_src_global generation:  0.0586705207824707
r_  generation:  0.5131540298461914
local_output_nid generation:  0.040587663650512695
local_in_edges_tensor generation:  0.04213666915893555
mini_batch_src_global generation:  0.0622098445892334
r_  generation:  0.5135688781738281
local_output_nid generation:  0.0417935848236084
local_in_edges_tensor generation:  0.04172325134277344
mini_batch_src_global generation:  0.058626651763916016
r_  generation:  0.5120186805725098
local_output_nid generation:  0.040645599365234375
local_in_edges_tensor generation:  0.04211258888244629
mini_batch_src_global generation:  0.06226992607116699
r_  generation:  0.5110006332397461
local_output_nid generation:  0.041002511978149414
local_in_edges_tensor generation:  0.04121661186218262
mini_batch_src_global generation:  0.058888912200927734
r_  generation:  0.5139479637145996
local_output_nid generation:  0.04054617881774902
local_in_edges_tensor generation:  0.04596519470214844
mini_batch_src_global generation:  0.058138132095336914
r_  generation:  0.5102474689483643
local_output_nid generation:  0.04051089286804199
local_in_edges_tensor generation:  0.042261600494384766
mini_batch_src_global generation:  0.0589900016784668
r_  generation:  0.5186331272125244
local_output_nid generation:  0.04078984260559082
local_in_edges_tensor generation:  0.04131793975830078
mini_batch_src_global generation:  0.0620882511138916
r_  generation:  0.5174083709716797
local_output_nid generation:  0.04091191291809082
local_in_edges_tensor generation:  0.04207754135131836
mini_batch_src_global generation:  0.05931973457336426
r_  generation:  0.5169339179992676
local_output_nid generation:  0.04069185256958008
local_in_edges_tensor generation:  0.03738689422607422
mini_batch_src_global generation:  0.05920147895812988
r_  generation:  0.5161545276641846
local_output_nid generation:  0.04079318046569824
local_in_edges_tensor generation:  0.03890347480773926
mini_batch_src_global generation:  0.05939793586730957
r_  generation:  0.5226068496704102
----------------------check_connections_block total spend ----------------------------- 12.461153030395508
generate_one_block  0.6340758800506592
generate_one_block  0.648561954498291
generate_one_block  0.6432366371154785
generate_one_block  0.648174524307251
generate_one_block  0.6401810646057129
generate_one_block  0.6433799266815186
generate_one_block  0.6427860260009766
generate_one_block  0.6440470218658447
generate_one_block  0.7130634784698486
generate_one_block  0.6460704803466797
generate_one_block  0.6405365467071533
generate_one_block  0.6460402011871338
generate_one_block  0.643202543258667
generate_one_block  0.6444339752197266
generate_one_block  0.6351668834686279
generate_one_block  0.6285502910614014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

connection checking time:  56.08515977859497
block generation total time  47.86578726768494
average batch blocks generation time:  2.9916117042303085
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13561439514160156  GigaBytes
Max Memory Allocated: 0.13561439514160156  GigaBytes

torch.Size([167268, 128])
torch.Size([166481, 128])
torch.Size([163973, 128])
torch.Size([155680, 128])
torch.Size([123607, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.5200095176696777  GigaBytes
Max Memory Allocated: 1.5375733375549316  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2947998046875 GB
    Memory Allocated: 0.13823890686035156  GigaBytes
Max Memory Allocated: 1.5591497421264648  GigaBytes

torch.Size([167297, 128])
torch.Size([166446, 128])
torch.Size([164014, 128])
torch.Size([155796, 128])
torch.Size([123607, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5218839645385742  GigaBytes
Max Memory Allocated: 1.5591497421264648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13831758499145508  GigaBytes
Max Memory Allocated: 1.5615453720092773  GigaBytes

torch.Size([167190, 128])
torch.Size([166375, 128])
torch.Size([164011, 128])
torch.Size([156198, 128])
torch.Size([124988, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5321202278137207  GigaBytes
Max Memory Allocated: 1.5615453720092773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1382308006286621  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167212, 128])
torch.Size([166360, 128])
torch.Size([163898, 128])
torch.Size([155499, 128])
torch.Size([123681, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5208683013916016  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13820219039916992  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167239, 128])
torch.Size([166431, 128])
torch.Size([163916, 128])
torch.Size([155638, 128])
torch.Size([123125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5193514823913574  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13825654983520508  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167233, 128])
torch.Size([166375, 128])
torch.Size([163905, 128])
torch.Size([155801, 128])
torch.Size([123925, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.52351713180542  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1382150650024414  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167289, 128])
torch.Size([166473, 128])
torch.Size([164002, 128])
torch.Size([155749, 128])
torch.Size([123523, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.52128267288208  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13827085494995117  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167243, 128])
torch.Size([166407, 128])
torch.Size([164007, 128])
torch.Size([156055, 128])
torch.Size([124200, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5252223014831543  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13820219039916992  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167213, 128])
torch.Size([166422, 128])
torch.Size([164032, 128])
torch.Size([156010, 128])
torch.Size([123231, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5203895568847656  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13821125030517578  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167227, 128])
torch.Size([166418, 128])
torch.Size([163904, 128])
torch.Size([155475, 128])
torch.Size([123179, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5194759368896484  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13824748992919922  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167261, 128])
torch.Size([166510, 128])
torch.Size([164080, 128])
torch.Size([155945, 128])
torch.Size([123592, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5237207412719727  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1382889747619629  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167252, 128])
torch.Size([166466, 128])
torch.Size([164041, 128])
torch.Size([155917, 128])
torch.Size([124286, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5252952575683594  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1382761001586914  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167256, 128])
torch.Size([166439, 128])
torch.Size([163941, 128])
torch.Size([155636, 128])
torch.Size([123768, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.522120475769043  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13828802108764648  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167294, 128])
torch.Size([166462, 128])
torch.Size([164022, 128])
torch.Size([156038, 128])
torch.Size([124301, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5259246826171875  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13820600509643555  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167245, 128])
torch.Size([166440, 128])
torch.Size([163940, 128])
torch.Size([155555, 128])
torch.Size([123060, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.518664836883545  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.1382274627685547  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167208, 128])
torch.Size([166340, 128])
torch.Size([163884, 128])
torch.Size([155765, 128])
torch.Size([123452, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5213723182678223  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09414643049240112 |0.06237414479255676 |0.051203981041908264 |9.325146675109863e-05 |0.017349079251289368 |0.007156848907470703 |
----------------------------------------------------------pseudo_mini_loss sum 6.155604839324951
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13095494
Number of first layer input nodes during this epoch:  2675927
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.24382781982421875  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.017843961715698242
random selection method range initialization spend 0.00543975830078125
time for parepare:  0.017914533615112305
local_output_nid generation:  0.002410888671875
local_in_edges_tensor generation:  0.004715681076049805
mini_batch_src_global generation:  0.0019626617431640625
r_  generation:  0.018480300903320312
local_output_nid generation:  0.0027818679809570312
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.0020532608032226562
r_  generation:  0.01878046989440918
local_output_nid generation:  0.0028395652770996094
local_in_edges_tensor generation:  0.0015201568603515625
mini_batch_src_global generation:  0.0014395713806152344
r_  generation:  0.01857924461364746
local_output_nid generation:  0.0029120445251464844
local_in_edges_tensor generation:  0.0015194416046142578
mini_batch_src_global generation:  0.0014955997467041016
r_  generation:  0.01891779899597168
local_output_nid generation:  0.0028848648071289062
local_in_edges_tensor generation:  0.0014264583587646484
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.01914691925048828
local_output_nid generation:  0.0029137134552001953
local_in_edges_tensor generation:  0.0014185905456542969
mini_batch_src_global generation:  0.0014770030975341797
r_  generation:  0.01862955093383789
local_output_nid generation:  0.002885580062866211
local_in_edges_tensor generation:  0.001482248306274414
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.019487380981445312
local_output_nid generation:  0.0028810501098632812
local_in_edges_tensor generation:  0.0014042854309082031
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.019960403442382812
local_output_nid generation:  0.002868175506591797
local_in_edges_tensor generation:  0.0014545917510986328
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.019181251525878906
local_output_nid generation:  0.002874135971069336
local_in_edges_tensor generation:  0.0014128684997558594
mini_batch_src_global generation:  0.0015301704406738281
r_  generation:  0.01935553550720215
local_output_nid generation:  0.0028798580169677734
local_in_edges_tensor generation:  0.0014541149139404297
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.01940321922302246
local_output_nid generation:  0.002872943878173828
local_in_edges_tensor generation:  0.0014426708221435547
mini_batch_src_global generation:  0.0015454292297363281
r_  generation:  0.018916606903076172
local_output_nid generation:  0.0028684139251708984
local_in_edges_tensor generation:  0.0014138221740722656
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.019344568252563477
local_output_nid generation:  0.002863168716430664
local_in_edges_tensor generation:  0.0013844966888427734
mini_batch_src_global generation:  0.0014872550964355469
r_  generation:  0.0196380615234375
local_output_nid generation:  0.002931833267211914
local_in_edges_tensor generation:  0.0013811588287353516
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.01899886131286621
local_output_nid generation:  0.0029764175415039062
local_in_edges_tensor generation:  0.0014853477478027344
mini_batch_src_global generation:  0.0015501976013183594
r_  generation:  0.019730091094970703
----------------------check_connections_block total spend ----------------------------- 0.5009758472442627
generate_one_block  0.030292749404907227
generate_one_block  0.02750706672668457
generate_one_block  0.027372121810913086
generate_one_block  0.03136706352233887
generate_one_block  0.02757859230041504
generate_one_block  0.02925419807434082
generate_one_block  0.028131723403930664
generate_one_block  0.02819991111755371
generate_one_block  0.02774333953857422
generate_one_block  0.02762627601623535
generate_one_block  0.02752852439880371
generate_one_block  0.02710270881652832
generate_one_block  0.027883052825927734
generate_one_block  0.027528762817382812
generate_one_block  0.027236461639404297
generate_one_block  0.028549909591674805
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03840136528015137
gen group dst list time:  0.01709127426147461
time for parepare:  0.018627166748046875
local_output_nid generation:  0.008071422576904297
local_in_edges_tensor generation:  0.02051854133605957
mini_batch_src_global generation:  0.021025896072387695
r_  generation:  0.19633746147155762
local_output_nid generation:  0.01215052604675293
local_in_edges_tensor generation:  0.019362449645996094
mini_batch_src_global generation:  0.027012348175048828
r_  generation:  0.20688581466674805
local_output_nid generation:  0.012592792510986328
local_in_edges_tensor generation:  0.015876293182373047
mini_batch_src_global generation:  0.02395343780517578
r_  generation:  0.21041345596313477
local_output_nid generation:  0.012485742568969727
local_in_edges_tensor generation:  0.017663002014160156
mini_batch_src_global generation:  0.02547478675842285
r_  generation:  0.2152843475341797
local_output_nid generation:  0.011754989624023438
local_in_edges_tensor generation:  0.014189720153808594
mini_batch_src_global generation:  0.026454687118530273
r_  generation:  0.21620821952819824
local_output_nid generation:  0.011726617813110352
local_in_edges_tensor generation:  0.012128114700317383
mini_batch_src_global generation:  0.026459932327270508
r_  generation:  0.21271014213562012
local_output_nid generation:  0.012368202209472656
local_in_edges_tensor generation:  0.01409006118774414
mini_batch_src_global generation:  0.026897430419921875
r_  generation:  0.22211074829101562
local_output_nid generation:  0.012606143951416016
local_in_edges_tensor generation:  0.014302253723144531
mini_batch_src_global generation:  0.030040502548217773
r_  generation:  0.22301435470581055
local_output_nid generation:  0.012687444686889648
local_in_edges_tensor generation:  0.012415885925292969
mini_batch_src_global generation:  0.02724623680114746
r_  generation:  0.21791720390319824
local_output_nid generation:  0.012535810470581055
local_in_edges_tensor generation:  0.014018058776855469
mini_batch_src_global generation:  0.02944803237915039
r_  generation:  0.22245407104492188
local_output_nid generation:  0.012504816055297852
local_in_edges_tensor generation:  0.017613887786865234
mini_batch_src_global generation:  0.0272829532623291
r_  generation:  0.2187190055847168
local_output_nid generation:  0.012323141098022461
local_in_edges_tensor generation:  0.012357473373413086
mini_batch_src_global generation:  0.027006149291992188
r_  generation:  0.21538877487182617
local_output_nid generation:  0.012595891952514648
local_in_edges_tensor generation:  0.012164831161499023
mini_batch_src_global generation:  0.028828859329223633
r_  generation:  0.22173476219177246
local_output_nid generation:  0.012434005737304688
local_in_edges_tensor generation:  0.01409459114074707
mini_batch_src_global generation:  0.027163267135620117
r_  generation:  0.21671390533447266
local_output_nid generation:  0.0123291015625
local_in_edges_tensor generation:  0.013829946517944336
mini_batch_src_global generation:  0.027067899703979492
r_  generation:  0.2183704376220703
local_output_nid generation:  0.013532400131225586
local_in_edges_tensor generation:  0.02197432518005371
mini_batch_src_global generation:  0.028733491897583008
r_  generation:  0.23459124565124512
----------------------check_connections_block total spend ----------------------------- 5.128592491149902
generate_one_block  0.280076265335083
generate_one_block  0.27643895149230957
generate_one_block  0.27634119987487793
generate_one_block  0.283236026763916
generate_one_block  0.2750382423400879
generate_one_block  0.2717013359069824
generate_one_block  0.3058590888977051
generate_one_block  0.2867109775543213
generate_one_block  0.2781505584716797
generate_one_block  0.28086209297180176
generate_one_block  0.30584263801574707
generate_one_block  0.2731151580810547
generate_one_block  0.28498077392578125
generate_one_block  0.2732064723968506
generate_one_block  0.31563329696655273
generate_one_block  0.3026564121246338
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.055822134017944336
gen group dst list time:  0.06634950637817383
time for parepare:  0.0175931453704834
local_output_nid generation:  0.02588677406311035
local_in_edges_tensor generation:  0.06240510940551758
mini_batch_src_global generation:  0.04967045783996582
r_  generation:  0.516014814376831
local_output_nid generation:  0.03603720664978027
local_in_edges_tensor generation:  0.05821657180786133
mini_batch_src_global generation:  0.0608677864074707
r_  generation:  0.49569201469421387
local_output_nid generation:  0.03213858604431152
local_in_edges_tensor generation:  0.04931521415710449
mini_batch_src_global generation:  0.05741429328918457
r_  generation:  0.5038390159606934
local_output_nid generation:  0.03202080726623535
local_in_edges_tensor generation:  0.038164615631103516
mini_batch_src_global generation:  0.06302094459533691
r_  generation:  0.5028727054595947
local_output_nid generation:  0.032131195068359375
local_in_edges_tensor generation:  0.11010313034057617
mini_batch_src_global generation:  0.05844473838806152
r_  generation:  0.5158865451812744
local_output_nid generation:  0.0310821533203125
local_in_edges_tensor generation:  0.03328299522399902
mini_batch_src_global generation:  0.07371783256530762
r_  generation:  0.5049426555633545
local_output_nid generation:  0.03262591361999512
local_in_edges_tensor generation:  0.05005073547363281
mini_batch_src_global generation:  0.059214115142822266
r_  generation:  0.5260765552520752
local_output_nid generation:  0.03419208526611328
local_in_edges_tensor generation:  0.05041003227233887
mini_batch_src_global generation:  0.06241488456726074
r_  generation:  0.5000498294830322
local_output_nid generation:  0.03224015235900879
local_in_edges_tensor generation:  0.03725028038024902
mini_batch_src_global generation:  0.05902218818664551
r_  generation:  0.5088057518005371
local_output_nid generation:  0.03221011161804199
local_in_edges_tensor generation:  0.036392927169799805
mini_batch_src_global generation:  0.06323647499084473
r_  generation:  0.5038671493530273
local_output_nid generation:  0.03222393989562988
local_in_edges_tensor generation:  0.030440092086791992
mini_batch_src_global generation:  0.05879855155944824
r_  generation:  0.5179171562194824
local_output_nid generation:  0.0320737361907959
local_in_edges_tensor generation:  0.038333892822265625
mini_batch_src_global generation:  0.06135225296020508
r_  generation:  0.5025966167449951
local_output_nid generation:  0.03213357925415039
local_in_edges_tensor generation:  0.03919100761413574
mini_batch_src_global generation:  0.06920862197875977
r_  generation:  0.516148567199707
local_output_nid generation:  0.03237748146057129
local_in_edges_tensor generation:  0.0388798713684082
mini_batch_src_global generation:  0.05972099304199219
r_  generation:  0.5110259056091309
local_output_nid generation:  0.03300309181213379
local_in_edges_tensor generation:  0.03305387496948242
mini_batch_src_global generation:  0.059807538986206055
r_  generation:  0.5136291980743408
local_output_nid generation:  0.03281259536743164
local_in_edges_tensor generation:  0.044223785400390625
mini_batch_src_global generation:  0.06419086456298828
r_  generation:  0.5293939113616943
----------------------check_connections_block total spend ----------------------------- 12.189488172531128
generate_one_block  0.6576437950134277
generate_one_block  0.6598448753356934
generate_one_block  0.6571023464202881
generate_one_block  0.6540806293487549
generate_one_block  0.6432697772979736
generate_one_block  0.6612846851348877
generate_one_block  0.6563718318939209
generate_one_block  0.652740478515625
generate_one_block  0.6953551769256592
generate_one_block  0.6519670486450195
generate_one_block  0.6553497314453125
generate_one_block  0.6445374488830566
generate_one_block  0.6536514759063721
generate_one_block  0.6590619087219238
generate_one_block  0.6471161842346191
generate_one_block  0.662268877029419
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04773998260498047
gen group dst list time:  0.10158681869506836
time for parepare:  0.019521474838256836
local_output_nid generation:  0.03429269790649414
local_in_edges_tensor generation:  0.06230640411376953
mini_batch_src_global generation:  0.05560874938964844
r_  generation:  0.5474822521209717
local_output_nid generation:  0.04060983657836914
local_in_edges_tensor generation:  0.05703139305114746
mini_batch_src_global generation:  0.0639345645904541
r_  generation:  0.5524945259094238
local_output_nid generation:  0.04308629035949707
local_in_edges_tensor generation:  0.04763627052307129
mini_batch_src_global generation:  0.06455492973327637
r_  generation:  0.551560640335083
local_output_nid generation:  0.04216265678405762
local_in_edges_tensor generation:  0.04266929626464844
mini_batch_src_global generation:  0.060399770736694336
r_  generation:  0.5554828643798828
local_output_nid generation:  0.04188823699951172
local_in_edges_tensor generation:  0.041988372802734375
mini_batch_src_global generation:  0.06044626235961914
r_  generation:  0.5570282936096191
local_output_nid generation:  0.038932085037231445
local_in_edges_tensor generation:  0.042386531829833984
mini_batch_src_global generation:  0.06116056442260742
r_  generation:  0.5598201751708984
local_output_nid generation:  0.03879547119140625
local_in_edges_tensor generation:  0.042479515075683594
mini_batch_src_global generation:  0.06136679649353027
r_  generation:  0.5649490356445312
local_output_nid generation:  0.03901219367980957
local_in_edges_tensor generation:  0.04286670684814453
mini_batch_src_global generation:  0.06223797798156738
r_  generation:  0.5611205101013184
local_output_nid generation:  0.03910255432128906
local_in_edges_tensor generation:  0.04349517822265625
mini_batch_src_global generation:  0.06179547309875488
r_  generation:  0.5697474479675293
local_output_nid generation:  0.03879094123840332
local_in_edges_tensor generation:  0.04293656349182129
mini_batch_src_global generation:  0.06306958198547363
r_  generation:  0.5681560039520264
local_output_nid generation:  0.03915524482727051
local_in_edges_tensor generation:  0.044100284576416016
mini_batch_src_global generation:  0.06316804885864258
r_  generation:  0.5775067806243896
local_output_nid generation:  0.03892660140991211
local_in_edges_tensor generation:  0.043109893798828125
mini_batch_src_global generation:  0.06334257125854492
r_  generation:  0.5648305416107178
local_output_nid generation:  0.039199113845825195
local_in_edges_tensor generation:  0.04356193542480469
mini_batch_src_global generation:  0.062041282653808594
r_  generation:  0.580970048904419
local_output_nid generation:  0.039015769958496094
local_in_edges_tensor generation:  0.043092966079711914
mini_batch_src_global generation:  0.06348061561584473
r_  generation:  0.5690262317657471
local_output_nid generation:  0.039122581481933594
local_in_edges_tensor generation:  0.04332423210144043
mini_batch_src_global generation:  0.06281638145446777
r_  generation:  0.573054313659668
local_output_nid generation:  0.03935861587524414
local_in_edges_tensor generation:  0.0428617000579834
mini_batch_src_global generation:  0.06407809257507324
r_  generation:  0.5675573348999023
----------------------check_connections_block total spend ----------------------------- 13.4758620262146
generate_one_block  0.7018499374389648
generate_one_block  0.6943817138671875
generate_one_block  0.6956973075866699
generate_one_block  0.6959688663482666
generate_one_block  0.7099864482879639
generate_one_block  0.6827633380889893
generate_one_block  0.7713122367858887
generate_one_block  0.6953740119934082
generate_one_block  0.7020599842071533
generate_one_block  0.7051076889038086
generate_one_block  0.7047450542449951
generate_one_block  0.6912484169006348
generate_one_block  0.7026309967041016
generate_one_block  0.7173540592193604
generate_one_block  0.6946127414703369
generate_one_block  0.7140393257141113
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04060864448547363
gen group dst list time:  0.10887503623962402
time for parepare:  0.019266128540039062
local_output_nid generation:  0.03662514686584473
local_in_edges_tensor generation:  0.05661487579345703
mini_batch_src_global generation:  0.049109458923339844
r_  generation:  0.5519001483917236
local_output_nid generation:  0.042046308517456055
local_in_edges_tensor generation:  0.05214953422546387
mini_batch_src_global generation:  0.06396222114562988
r_  generation:  0.5501046180725098
local_output_nid generation:  0.04034900665283203
local_in_edges_tensor generation:  0.0420689582824707
mini_batch_src_global generation:  0.06309175491333008
r_  generation:  0.5529990196228027
local_output_nid generation:  0.04002690315246582
local_in_edges_tensor generation:  0.04057908058166504
mini_batch_src_global generation:  0.06342935562133789
r_  generation:  0.5469970703125
local_output_nid generation:  0.040383100509643555
local_in_edges_tensor generation:  0.04168820381164551
mini_batch_src_global generation:  0.08886528015136719
r_  generation:  0.5539820194244385
local_output_nid generation:  0.0400393009185791
local_in_edges_tensor generation:  0.04152035713195801
mini_batch_src_global generation:  0.06321859359741211
r_  generation:  0.549980878829956
local_output_nid generation:  0.04002070426940918
local_in_edges_tensor generation:  0.041170358657836914
mini_batch_src_global generation:  0.08784770965576172
r_  generation:  0.5554883480072021
local_output_nid generation:  0.040978193283081055
local_in_edges_tensor generation:  0.04141640663146973
mini_batch_src_global generation:  0.0639183521270752
r_  generation:  0.5556991100311279
local_output_nid generation:  0.040375471115112305
local_in_edges_tensor generation:  0.04127359390258789
mini_batch_src_global generation:  0.06359553337097168
r_  generation:  0.5737252235412598
local_output_nid generation:  0.04098010063171387
local_in_edges_tensor generation:  0.046775102615356445
mini_batch_src_global generation:  0.06393837928771973
r_  generation:  0.5601100921630859
local_output_nid generation:  0.040480852127075195
local_in_edges_tensor generation:  0.0412752628326416
mini_batch_src_global generation:  0.06887054443359375
r_  generation:  0.5655255317687988
local_output_nid generation:  0.040526628494262695
local_in_edges_tensor generation:  0.05479145050048828
mini_batch_src_global generation:  0.0681452751159668
r_  generation:  0.5568351745605469
local_output_nid generation:  0.04052233695983887
local_in_edges_tensor generation:  0.0415349006652832
mini_batch_src_global generation:  0.06103324890136719
r_  generation:  0.561011552810669
local_output_nid generation:  0.04025006294250488
local_in_edges_tensor generation:  0.04059147834777832
mini_batch_src_global generation:  0.06251692771911621
r_  generation:  0.5673539638519287
local_output_nid generation:  0.042693138122558594
local_in_edges_tensor generation:  0.046617746353149414
mini_batch_src_global generation:  0.0664982795715332
r_  generation:  0.5606517791748047
local_output_nid generation:  0.04208993911743164
local_in_edges_tensor generation:  0.0463557243347168
mini_batch_src_global generation:  0.06105947494506836
r_  generation:  0.5616044998168945
----------------------check_connections_block total spend ----------------------------- 13.471885681152344
generate_one_block  0.6982550621032715
generate_one_block  0.7005422115325928
generate_one_block  0.7032814025878906
generate_one_block  0.7022454738616943
generate_one_block  0.6970388889312744
generate_one_block  0.7244532108306885
generate_one_block  0.6936771869659424
generate_one_block  0.6928133964538574
generate_one_block  0.6936914920806885
generate_one_block  0.7982621192932129
generate_one_block  0.6925725936889648
generate_one_block  0.6889064311981201
generate_one_block  0.6940007209777832
generate_one_block  0.7044072151184082
generate_one_block  0.6960129737854004
generate_one_block  0.693723201751709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03476667404174805
gen group dst list time:  0.09923744201660156
time for parepare:  0.019333600997924805
local_output_nid generation:  0.03809809684753418
local_in_edges_tensor generation:  0.051751136779785156
mini_batch_src_global generation:  0.045836448669433594
r_  generation:  0.506011962890625
local_output_nid generation:  0.04314899444580078
local_in_edges_tensor generation:  0.054326772689819336
mini_batch_src_global generation:  0.05759263038635254
r_  generation:  0.5086824893951416
local_output_nid generation:  0.04329800605773926
local_in_edges_tensor generation:  0.045865535736083984
mini_batch_src_global generation:  0.05777287483215332
r_  generation:  0.5060102939605713
local_output_nid generation:  0.04323291778564453
local_in_edges_tensor generation:  0.0403444766998291
mini_batch_src_global generation:  0.06201624870300293
r_  generation:  0.5148031711578369
local_output_nid generation:  0.043279409408569336
local_in_edges_tensor generation:  0.05147552490234375
mini_batch_src_global generation:  0.0622255802154541
r_  generation:  0.5039196014404297
local_output_nid generation:  0.041991472244262695
local_in_edges_tensor generation:  0.043782711029052734
mini_batch_src_global generation:  0.05734848976135254
r_  generation:  0.5132269859313965
local_output_nid generation:  0.0420987606048584
local_in_edges_tensor generation:  0.04146456718444824
mini_batch_src_global generation:  0.0577852725982666
r_  generation:  0.5086662769317627
local_output_nid generation:  0.04003143310546875
local_in_edges_tensor generation:  0.042313337326049805
mini_batch_src_global generation:  0.05792498588562012
r_  generation:  0.5110716819763184
local_output_nid generation:  0.04253220558166504
local_in_edges_tensor generation:  0.04620504379272461
mini_batch_src_global generation:  0.05844926834106445
r_  generation:  0.5123391151428223
local_output_nid generation:  0.0414578914642334
local_in_edges_tensor generation:  0.04097414016723633
mini_batch_src_global generation:  0.057578325271606445
r_  generation:  0.511563777923584
local_output_nid generation:  0.04134726524353027
local_in_edges_tensor generation:  0.04634737968444824
mini_batch_src_global generation:  0.05789613723754883
r_  generation:  0.5124239921569824
local_output_nid generation:  0.04149889945983887
local_in_edges_tensor generation:  0.041460275650024414
mini_batch_src_global generation:  0.05733466148376465
r_  generation:  0.5163376331329346
local_output_nid generation:  0.04164481163024902
local_in_edges_tensor generation:  0.041906118392944336
mini_batch_src_global generation:  0.07136368751525879
r_  generation:  0.5176465511322021
local_output_nid generation:  0.04149198532104492
local_in_edges_tensor generation:  0.04573655128479004
mini_batch_src_global generation:  0.057149648666381836
r_  generation:  0.5192389488220215
local_output_nid generation:  0.042021751403808594
local_in_edges_tensor generation:  0.04087066650390625
mini_batch_src_global generation:  0.05785250663757324
r_  generation:  0.524115800857544
local_output_nid generation:  0.041863203048706055
local_in_edges_tensor generation:  0.040871620178222656
mini_batch_src_global generation:  0.05780363082885742
r_  generation:  0.5144507884979248
----------------------check_connections_block total spend ----------------------------- 12.487823963165283
generate_one_block  0.6475121974945068
generate_one_block  0.6444530487060547
generate_one_block  0.6374692916870117
generate_one_block  0.6365954875946045
generate_one_block  0.645740270614624
generate_one_block  0.6243190765380859
generate_one_block  0.6418030261993408
generate_one_block  0.6542918682098389
generate_one_block  0.6540381908416748
generate_one_block  0.6385905742645264
generate_one_block  0.6289172172546387
generate_one_block  0.6493818759918213
generate_one_block  0.7224295139312744
generate_one_block  0.646155595779419
generate_one_block  0.629462480545044
generate_one_block  0.6510922908782959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.24382781982421875  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

connection checking time:  56.75365233421326
block generation total time  47.98676347732544
average batch blocks generation time:  2.99917271733284
block dataloader generation time/epoch 108.22881960868835
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 0.13952922821044922  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167279, 128])
torch.Size([166525, 128])
torch.Size([164127, 128])
torch.Size([155919, 128])
torch.Size([123738, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2967529296875 GB
    Memory Allocated: 1.5246343612670898  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13953590393066406  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167257, 128])
torch.Size([166461, 128])
torch.Size([164048, 128])
torch.Size([155808, 128])
torch.Size([123892, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5243735313415527  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13956165313720703  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167241, 128])
torch.Size([166450, 128])
torch.Size([164033, 128])
torch.Size([155841, 128])
torch.Size([123880, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.524268627166748  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13960647583007812  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167252, 128])
torch.Size([166463, 128])
torch.Size([164135, 128])
torch.Size([156040, 128])
torch.Size([124499, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5276823043823242  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13953638076782227  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167270, 128])
torch.Size([166489, 128])
torch.Size([164173, 128])
torch.Size([156140, 128])
torch.Size([123527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5251755714416504  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.1395258903503418  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167257, 128])
torch.Size([166454, 128])
torch.Size([164093, 128])
torch.Size([155816, 128])
torch.Size([123553, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5225763320922852  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13959217071533203  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167189, 128])
torch.Size([166406, 128])
torch.Size([164010, 128])
torch.Size([155873, 128])
torch.Size([124079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5254759788513184  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13955974578857422  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167241, 128])
torch.Size([166439, 128])
torch.Size([163990, 128])
torch.Size([155565, 128])
torch.Size([123403, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5227270126342773  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13954877853393555  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167277, 128])
torch.Size([166488, 128])
torch.Size([164038, 128])
torch.Size([155838, 128])
torch.Size([123683, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5243821144104004  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13958024978637695  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167254, 128])
torch.Size([166403, 128])
torch.Size([164034, 128])
torch.Size([155912, 128])
torch.Size([124157, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5259075164794922  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.1395702362060547  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167172, 128])
torch.Size([166369, 128])
torch.Size([164012, 128])
torch.Size([155904, 128])
torch.Size([124071, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5254836082458496  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13951826095581055  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167273, 128])
torch.Size([166480, 128])
torch.Size([164092, 128])
torch.Size([155769, 128])
torch.Size([123454, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5223445892333984  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.1395716667175293  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167192, 128])
torch.Size([166412, 128])
torch.Size([164083, 128])
torch.Size([155925, 128])
torch.Size([123889, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.525374412536621  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13953399658203125  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167269, 128])
torch.Size([166470, 128])
torch.Size([164146, 128])
torch.Size([156138, 128])
torch.Size([123978, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.525331974029541  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13947296142578125  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167173, 128])
torch.Size([166327, 128])
torch.Size([163875, 128])
torch.Size([155253, 128])
torch.Size([122309, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5171523094177246  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 0.13959836959838867  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

torch.Size([167247, 128])
torch.Size([166458, 128])
torch.Size([164084, 128])
torch.Size([156013, 128])
torch.Size([124418, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 1.5276036262512207  GigaBytes
Max Memory Allocated: 1.572227954864502  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09166789054870605 |0.045240387320518494 |0.0066072046756744385 |8.74549150466919e-05 |0.012851446866989136 |0.0053043365478515625 |
----------------------------------------------------------pseudo_mini_loss sum 4.142524242401123
Total (block generation + training)time/epoch 110.84257650375366
Training time/epoch 2.613412618637085
Training time without block to device /epoch 1.889566421508789
Training time without total dataloading part /epoch 0.3180420398712158
load block tensor time/epoch 1.4666862487792969
block to device time/epoch 0.7238461971282959
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13099130
Number of first layer input nodes during this epoch:  2675843
