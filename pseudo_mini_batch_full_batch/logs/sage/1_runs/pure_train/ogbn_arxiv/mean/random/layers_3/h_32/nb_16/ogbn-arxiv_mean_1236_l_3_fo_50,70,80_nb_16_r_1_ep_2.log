Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648438941.378946
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028357267379760742
random selection method range initialization spend 0.008215665817260742
time for parepare:  0.019676923751831055
local_output_nid generation:  0.0021588802337646484
local_in_edges_tensor generation:  0.004215717315673828
mini_batch_src_global generation:  0.002324819564819336
r_  generation:  0.02250838279724121
local_output_nid generation:  0.0028562545776367188
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.0027980804443359375
r_  generation:  0.022985458374023438
local_output_nid generation:  0.002919435501098633
local_in_edges_tensor generation:  0.0015795230865478516
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.023488283157348633
local_output_nid generation:  0.0029723644256591797
local_in_edges_tensor generation:  0.0016453266143798828
mini_batch_src_global generation:  0.0019712448120117188
r_  generation:  0.02336430549621582
local_output_nid generation:  0.0029664039611816406
local_in_edges_tensor generation:  0.0015304088592529297
mini_batch_src_global generation:  0.0019609928131103516
r_  generation:  0.021329402923583984
local_output_nid generation:  0.0029468536376953125
local_in_edges_tensor generation:  0.0015215873718261719
mini_batch_src_global generation:  0.0017979145050048828
r_  generation:  0.02221083641052246
local_output_nid generation:  0.0029516220092773438
local_in_edges_tensor generation:  0.0015916824340820312
mini_batch_src_global generation:  0.0017518997192382812
r_  generation:  0.021782398223876953
local_output_nid generation:  0.003005504608154297
local_in_edges_tensor generation:  0.0015344619750976562
mini_batch_src_global generation:  0.0017597675323486328
r_  generation:  0.02131962776184082
local_output_nid generation:  0.0029838085174560547
local_in_edges_tensor generation:  0.0015778541564941406
mini_batch_src_global generation:  0.0016965866088867188
r_  generation:  0.021844863891601562
local_output_nid generation:  0.002948760986328125
local_in_edges_tensor generation:  0.0015692710876464844
mini_batch_src_global generation:  0.0017626285552978516
r_  generation:  0.02265334129333496
local_output_nid generation:  0.003010272979736328
local_in_edges_tensor generation:  0.0015001296997070312
mini_batch_src_global generation:  0.0017635822296142578
r_  generation:  0.02190685272216797
local_output_nid generation:  0.0029451847076416016
local_in_edges_tensor generation:  0.0014996528625488281
mini_batch_src_global generation:  0.0017871856689453125
r_  generation:  0.022235870361328125
local_output_nid generation:  0.0029935836791992188
local_in_edges_tensor generation:  0.001523733139038086
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.021859407424926758
local_output_nid generation:  0.0030031204223632812
local_in_edges_tensor generation:  0.0015001296997070312
mini_batch_src_global generation:  0.001786947250366211
r_  generation:  0.02220296859741211
local_output_nid generation:  0.002956867218017578
local_in_edges_tensor generation:  0.0014929771423339844
mini_batch_src_global generation:  0.0017840862274169922
r_  generation:  0.021267414093017578
local_output_nid generation:  0.002954721450805664
local_in_edges_tensor generation:  0.0014867782592773438
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.021411657333374023
----------------------check_connections_block total spend ----------------------------- 0.5715446472167969
generate_one_block  0.03018021583557129
generate_one_block  0.03226423263549805
generate_one_block  0.03527688980102539
generate_one_block  0.03207254409790039
generate_one_block  0.031330108642578125
generate_one_block  0.03143024444580078
generate_one_block  0.03129220008850098
generate_one_block  0.03088521957397461
generate_one_block  0.03179001808166504
generate_one_block  0.03191685676574707
generate_one_block  0.030780315399169922
generate_one_block  0.031369686126708984
generate_one_block  0.0307466983795166
generate_one_block  0.03151583671569824
generate_one_block  0.030193805694580078
generate_one_block  0.030829668045043945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03973674774169922
gen group dst list time:  0.020586729049682617
time for parepare:  0.019164085388183594
local_output_nid generation:  0.009192943572998047
local_in_edges_tensor generation:  0.0219728946685791
mini_batch_src_global generation:  0.026881694793701172
r_  generation:  0.24220609664916992
local_output_nid generation:  0.014712810516357422
local_in_edges_tensor generation:  0.02532219886779785
mini_batch_src_global generation:  0.032784461975097656
r_  generation:  0.2607991695404053
local_output_nid generation:  0.014690876007080078
local_in_edges_tensor generation:  0.020866870880126953
mini_batch_src_global generation:  0.03235483169555664
r_  generation:  0.26792049407958984
local_output_nid generation:  0.014588594436645508
local_in_edges_tensor generation:  0.020704984664916992
mini_batch_src_global generation:  0.03283381462097168
r_  generation:  0.2707703113555908
local_output_nid generation:  0.014648675918579102
local_in_edges_tensor generation:  0.018079757690429688
mini_batch_src_global generation:  0.033643245697021484
r_  generation:  0.2668635845184326
local_output_nid generation:  0.01469111442565918
local_in_edges_tensor generation:  0.01803898811340332
mini_batch_src_global generation:  0.03440713882446289
r_  generation:  0.2712078094482422
local_output_nid generation:  0.014391899108886719
local_in_edges_tensor generation:  0.023227930068969727
mini_batch_src_global generation:  0.03423452377319336
r_  generation:  0.272188663482666
local_output_nid generation:  0.01443791389465332
local_in_edges_tensor generation:  0.015885353088378906
mini_batch_src_global generation:  0.034287452697753906
r_  generation:  0.265308141708374
local_output_nid generation:  0.014667034149169922
local_in_edges_tensor generation:  0.018085956573486328
mini_batch_src_global generation:  0.03444075584411621
r_  generation:  0.27031707763671875
local_output_nid generation:  0.018271684646606445
local_in_edges_tensor generation:  0.020693302154541016
mini_batch_src_global generation:  0.03494906425476074
r_  generation:  0.27494239807128906
local_output_nid generation:  0.014682769775390625
local_in_edges_tensor generation:  0.017995595932006836
mini_batch_src_global generation:  0.03484821319580078
r_  generation:  0.26694726943969727
local_output_nid generation:  0.014878511428833008
local_in_edges_tensor generation:  0.018409252166748047
mini_batch_src_global generation:  0.03710579872131348
r_  generation:  0.2737259864807129
local_output_nid generation:  0.014386653900146484
local_in_edges_tensor generation:  0.01586627960205078
mini_batch_src_global generation:  0.03439188003540039
r_  generation:  0.2673213481903076
local_output_nid generation:  0.014470815658569336
local_in_edges_tensor generation:  0.017546415328979492
mini_batch_src_global generation:  0.035001277923583984
r_  generation:  0.26843976974487305
local_output_nid generation:  0.014391422271728516
local_in_edges_tensor generation:  0.015471220016479492
mini_batch_src_global generation:  0.037149906158447266
r_  generation:  0.26755213737487793
local_output_nid generation:  0.014563322067260742
local_in_edges_tensor generation:  0.018004894256591797
mini_batch_src_global generation:  0.03444838523864746
r_  generation:  0.2662193775177002
----------------------check_connections_block total spend ----------------------------- 6.291433811187744
generate_one_block  0.34743356704711914
generate_one_block  0.36066222190856934
generate_one_block  0.37070250511169434
generate_one_block  0.3571915626525879
generate_one_block  0.36554670333862305
generate_one_block  0.35282254219055176
generate_one_block  0.35738444328308105
generate_one_block  0.34432244300842285
generate_one_block  0.3543989658355713
generate_one_block  0.36182737350463867
generate_one_block  0.3433573246002197
generate_one_block  0.35596537590026855
generate_one_block  0.3472869396209717
generate_one_block  0.34836339950561523
generate_one_block  0.3507111072540283
generate_one_block  0.34618568420410156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03954291343688965
gen group dst list time:  0.06307578086853027
time for parepare:  0.01951742172241211
local_output_nid generation:  0.026621103286743164
local_in_edges_tensor generation:  0.04197883605957031
mini_batch_src_global generation:  0.050020694732666016
r_  generation:  0.5111343860626221
local_output_nid generation:  0.035004377365112305
local_in_edges_tensor generation:  0.0518186092376709
mini_batch_src_global generation:  0.062027692794799805
r_  generation:  0.5251641273498535
local_output_nid generation:  0.034868717193603516
local_in_edges_tensor generation:  0.05170845985412598
mini_batch_src_global generation:  0.06332206726074219
r_  generation:  0.5337660312652588
local_output_nid generation:  0.035034894943237305
local_in_edges_tensor generation:  0.03824138641357422
mini_batch_src_global generation:  0.05995035171508789
r_  generation:  0.5337927341461182
local_output_nid generation:  0.034705162048339844
local_in_edges_tensor generation:  0.042633771896362305
mini_batch_src_global generation:  0.061177968978881836
r_  generation:  0.5394961833953857
local_output_nid generation:  0.034369707107543945
local_in_edges_tensor generation:  0.03332233428955078
mini_batch_src_global generation:  0.06163644790649414
r_  generation:  0.534346342086792
local_output_nid generation:  0.03441762924194336
local_in_edges_tensor generation:  0.0335235595703125
mini_batch_src_global generation:  0.06183457374572754
r_  generation:  0.5475723743438721
local_output_nid generation:  0.03477740287780762
local_in_edges_tensor generation:  0.03767275810241699
mini_batch_src_global generation:  0.06304502487182617
r_  generation:  0.5426473617553711
local_output_nid generation:  0.034500837326049805
local_in_edges_tensor generation:  0.0375673770904541
mini_batch_src_global generation:  0.06256604194641113
r_  generation:  0.5454480648040771
local_output_nid generation:  0.03475475311279297
local_in_edges_tensor generation:  0.04701519012451172
mini_batch_src_global generation:  0.06208062171936035
r_  generation:  0.5505847930908203
local_output_nid generation:  0.03500080108642578
local_in_edges_tensor generation:  0.03365516662597656
mini_batch_src_global generation:  0.06292176246643066
r_  generation:  0.5415606498718262
local_output_nid generation:  0.0343785285949707
local_in_edges_tensor generation:  0.03334450721740723
mini_batch_src_global generation:  0.06285977363586426
r_  generation:  0.5521750450134277
local_output_nid generation:  0.03528404235839844
local_in_edges_tensor generation:  0.04128122329711914
mini_batch_src_global generation:  0.06284856796264648
r_  generation:  0.5409178733825684
local_output_nid generation:  0.03450345993041992
local_in_edges_tensor generation:  0.036791086196899414
mini_batch_src_global generation:  0.062479496002197266
r_  generation:  0.5423572063446045
local_output_nid generation:  0.03471088409423828
local_in_edges_tensor generation:  0.03684401512145996
mini_batch_src_global generation:  0.06670069694519043
r_  generation:  0.5516655445098877
local_output_nid generation:  0.03400683403015137
local_in_edges_tensor generation:  0.032349586486816406
mini_batch_src_global generation:  0.06278848648071289
r_  generation:  0.5427958965301514
----------------------check_connections_block total spend ----------------------------- 12.706833124160767
generate_one_block  0.6716203689575195
generate_one_block  0.6916618347167969
generate_one_block  0.6965787410736084
generate_one_block  0.6994032859802246
generate_one_block  0.6930572986602783
generate_one_block  0.6983203887939453
generate_one_block  0.7553644180297852
generate_one_block  0.6949014663696289
generate_one_block  0.6914701461791992
generate_one_block  0.6931321620941162
generate_one_block  0.7021358013153076
generate_one_block  0.6886060237884521
generate_one_block  0.6970217227935791
generate_one_block  0.7022244930267334
generate_one_block  0.7038052082061768
generate_one_block  0.7205030918121338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  18.99826693534851
block generation total time  16.86396861076355
average batch blocks generation time:  1.0539980381727219
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09507942199707031  GigaBytes
Max Memory Allocated: 0.09507942199707031  GigaBytes

torch.Size([157293, 128])
torch.Size([129277, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.19185256958007812  GigaBytes
Max Memory Allocated: 0.19434165954589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09671449661254883  GigaBytes
Max Memory Allocated: 0.2057323455810547  GigaBytes

torch.Size([157535, 128])
torch.Size([129558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19476842880249023  GigaBytes
Max Memory Allocated: 0.2057323455810547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09784793853759766  GigaBytes
Max Memory Allocated: 0.20902347564697266  GigaBytes

torch.Size([157916, 128])
torch.Size([130862, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19623661041259766  GigaBytes
Max Memory Allocated: 0.20902347564697266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09773445129394531  GigaBytes
Max Memory Allocated: 0.2095627784729004  GigaBytes

torch.Size([158117, 128])
torch.Size([130635, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19585657119750977  GigaBytes
Max Memory Allocated: 0.2095627784729004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09765911102294922  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157873, 128])
torch.Size([130802, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19583511352539062  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09646034240722656  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157220, 128])
torch.Size([129082, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19455623626708984  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09772968292236328  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157909, 128])
torch.Size([130387, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19581174850463867  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09643793106079102  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157411, 128])
torch.Size([129622, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1935429573059082  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09764671325683594  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157839, 128])
torch.Size([130270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19576787948608398  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09674930572509766  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157592, 128])
torch.Size([130036, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1948399543762207  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09652137756347656  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157602, 128])
torch.Size([129794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19367074966430664  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09667110443115234  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157524, 128])
torch.Size([129909, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19478797912597656  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09754276275634766  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157741, 128])
torch.Size([130188, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19468975067138672  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0964651107788086  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157398, 128])
torch.Size([129628, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19364452362060547  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09639978408813477  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157489, 128])
torch.Size([129563, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19341707229614258  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0964350700378418  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157575, 128])
torch.Size([130367, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19353723526000977  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03329131007194519 |0.037962764501571655 |0.0493486225605011 |9.73045825958252e-05 |0.007018581032752991 |0.001882314682006836 |
----------------------------------------------------------pseudo_mini_loss sum 5.053394317626953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5332124
Number of first layer input nodes during this epoch:  2522034
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1385664939880371  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02124953269958496
random selection method range initialization spend 0.005520343780517578
time for parepare:  0.0173947811126709
local_output_nid generation:  0.0024416446685791016
local_in_edges_tensor generation:  0.004819393157958984
mini_batch_src_global generation:  0.0019826889038085938
r_  generation:  0.019582271575927734
local_output_nid generation:  0.002905130386352539
local_in_edges_tensor generation:  0.0017132759094238281
mini_batch_src_global generation:  0.0024261474609375
r_  generation:  0.020628929138183594
local_output_nid generation:  0.0029675960540771484
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.0015811920166015625
r_  generation:  0.020606040954589844
local_output_nid generation:  0.0029447078704833984
local_in_edges_tensor generation:  0.0016422271728515625
mini_batch_src_global generation:  0.001638174057006836
r_  generation:  0.02144455909729004
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.0015573501586914062
mini_batch_src_global generation:  0.0016281604766845703
r_  generation:  0.020985126495361328
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0015490055084228516
mini_batch_src_global generation:  0.0016853809356689453
r_  generation:  0.021837472915649414
local_output_nid generation:  0.0029120445251464844
local_in_edges_tensor generation:  0.0015211105346679688
mini_batch_src_global generation:  0.0016887187957763672
r_  generation:  0.022100210189819336
local_output_nid generation:  0.0029268264770507812
local_in_edges_tensor generation:  0.001627206802368164
mini_batch_src_global generation:  0.0017080307006835938
r_  generation:  0.021670818328857422
local_output_nid generation:  0.0030012130737304688
local_in_edges_tensor generation:  0.0015277862548828125
mini_batch_src_global generation:  0.0017156600952148438
r_  generation:  0.021668195724487305
local_output_nid generation:  0.0029137134552001953
local_in_edges_tensor generation:  0.001552581787109375
mini_batch_src_global generation:  0.00173187255859375
r_  generation:  0.022367000579833984
local_output_nid generation:  0.002890348434448242
local_in_edges_tensor generation:  0.001561880111694336
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.022235870361328125
local_output_nid generation:  0.002911806106567383
local_in_edges_tensor generation:  0.0014901161193847656
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.022235393524169922
local_output_nid generation:  0.0028891563415527344
local_in_edges_tensor generation:  0.0015120506286621094
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.021672964096069336
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0015950202941894531
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.022490501403808594
local_output_nid generation:  0.002929210662841797
local_in_edges_tensor generation:  0.00150299072265625
mini_batch_src_global generation:  0.001794576644897461
r_  generation:  0.02238941192626953
local_output_nid generation:  0.002910614013671875
local_in_edges_tensor generation:  0.001512289047241211
mini_batch_src_global generation:  0.0017695426940917969
r_  generation:  0.022281169891357422
----------------------check_connections_block total spend ----------------------------- 0.557131290435791
generate_one_block  0.03785443305969238
generate_one_block  0.030957937240600586
generate_one_block  0.03105926513671875
generate_one_block  0.03199481964111328
generate_one_block  0.031293630599975586
generate_one_block  0.03446793556213379
generate_one_block  0.03239274024963379
generate_one_block  0.03109455108642578
generate_one_block  0.03156304359436035
generate_one_block  0.03256392478942871
generate_one_block  0.03229498863220215
generate_one_block  0.03159809112548828
generate_one_block  0.031211376190185547
generate_one_block  0.0313572883605957
generate_one_block  0.03216385841369629
generate_one_block  0.03170585632324219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04466414451599121
gen group dst list time:  0.019295692443847656
time for parepare:  0.019839763641357422
local_output_nid generation:  0.009138107299804688
local_in_edges_tensor generation:  0.02663445472717285
mini_batch_src_global generation:  0.027205467224121094
r_  generation:  0.2537190914154053
local_output_nid generation:  0.013265371322631836
local_in_edges_tensor generation:  0.023638010025024414
mini_batch_src_global generation:  0.03672957420349121
r_  generation:  0.27461671829223633
local_output_nid generation:  0.016684770584106445
local_in_edges_tensor generation:  0.03397798538208008
mini_batch_src_global generation:  0.03601551055908203
r_  generation:  0.2703399658203125
local_output_nid generation:  0.014299154281616211
local_in_edges_tensor generation:  0.023050546646118164
mini_batch_src_global generation:  0.03402066230773926
r_  generation:  0.27083778381347656
local_output_nid generation:  0.013869285583496094
local_in_edges_tensor generation:  0.015434980392456055
mini_batch_src_global generation:  0.0356597900390625
r_  generation:  0.2806110382080078
local_output_nid generation:  0.013942718505859375
local_in_edges_tensor generation:  0.014143705368041992
mini_batch_src_global generation:  0.03378701210021973
r_  generation:  0.2729325294494629
local_output_nid generation:  0.013389348983764648
local_in_edges_tensor generation:  0.019371509552001953
mini_batch_src_global generation:  0.03636455535888672
r_  generation:  0.27860093116760254
local_output_nid generation:  0.013349056243896484
local_in_edges_tensor generation:  0.014299392700195312
mini_batch_src_global generation:  0.03404831886291504
r_  generation:  0.26769495010375977
local_output_nid generation:  0.013466596603393555
local_in_edges_tensor generation:  0.016212940216064453
mini_batch_src_global generation:  0.034328460693359375
r_  generation:  0.29079508781433105
local_output_nid generation:  0.016587018966674805
local_in_edges_tensor generation:  0.028745174407958984
mini_batch_src_global generation:  0.03756308555603027
r_  generation:  0.27520108222961426
local_output_nid generation:  0.01356959342956543
local_in_edges_tensor generation:  0.020558595657348633
mini_batch_src_global generation:  0.03556990623474121
r_  generation:  0.27751708030700684
local_output_nid generation:  0.013537406921386719
local_in_edges_tensor generation:  0.018835783004760742
mini_batch_src_global generation:  0.03497052192687988
r_  generation:  0.2754666805267334
local_output_nid generation:  0.013466358184814453
local_in_edges_tensor generation:  0.015240907669067383
mini_batch_src_global generation:  0.04121136665344238
r_  generation:  0.2709667682647705
local_output_nid generation:  0.01354074478149414
local_in_edges_tensor generation:  0.013916492462158203
mini_batch_src_global generation:  0.03554391860961914
r_  generation:  0.2757694721221924
local_output_nid generation:  0.013616085052490234
local_in_edges_tensor generation:  0.019120454788208008
mini_batch_src_global generation:  0.0367434024810791
r_  generation:  0.2763094902038574
local_output_nid generation:  0.013393878936767578
local_in_edges_tensor generation:  0.014273405075073242
mini_batch_src_global generation:  0.03496551513671875
r_  generation:  0.271639347076416
----------------------check_connections_block total spend ----------------------------- 6.457870006561279
generate_one_block  0.3569009304046631
generate_one_block  0.362445592880249
generate_one_block  0.3637406826019287
generate_one_block  0.3611288070678711
generate_one_block  0.3436424732208252
generate_one_block  0.35623693466186523
generate_one_block  0.39219141006469727
generate_one_block  0.34728336334228516
generate_one_block  0.3516097068786621
generate_one_block  0.35471200942993164
generate_one_block  0.37361860275268555
generate_one_block  0.35417795181274414
generate_one_block  0.3426177501678467
generate_one_block  0.34924840927124023
generate_one_block  0.3607058525085449
generate_one_block  0.3429298400878906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.057143449783325195
gen group dst list time:  0.06265521049499512
time for parepare:  0.01862955093383789
local_output_nid generation:  0.026580095291137695
local_in_edges_tensor generation:  0.07256722450256348
mini_batch_src_global generation:  0.05588364601135254
r_  generation:  0.5125603675842285
local_output_nid generation:  0.03256034851074219
local_in_edges_tensor generation:  0.0622401237487793
mini_batch_src_global generation:  0.06256937980651855
r_  generation:  0.5229740142822266
local_output_nid generation:  0.0331423282623291
local_in_edges_tensor generation:  0.04601097106933594
mini_batch_src_global generation:  0.05902981758117676
r_  generation:  0.5301806926727295
local_output_nid generation:  0.03262066841125488
local_in_edges_tensor generation:  0.04152321815490723
mini_batch_src_global generation:  0.06349372863769531
r_  generation:  0.5452268123626709
local_output_nid generation:  0.034455299377441406
local_in_edges_tensor generation:  0.10570979118347168
mini_batch_src_global generation:  0.06212806701660156
r_  generation:  0.5416932106018066
local_output_nid generation:  0.03299212455749512
local_in_edges_tensor generation:  0.04633164405822754
mini_batch_src_global generation:  0.06374335289001465
r_  generation:  0.5409748554229736
local_output_nid generation:  0.03230690956115723
local_in_edges_tensor generation:  0.03606224060058594
mini_batch_src_global generation:  0.06279897689819336
r_  generation:  0.5412144660949707
local_output_nid generation:  0.032405853271484375
local_in_edges_tensor generation:  0.040154457092285156
mini_batch_src_global generation:  0.06296777725219727
r_  generation:  0.5420336723327637
local_output_nid generation:  0.03271603584289551
local_in_edges_tensor generation:  0.04048776626586914
mini_batch_src_global generation:  0.06249094009399414
r_  generation:  0.5427794456481934
local_output_nid generation:  0.03291177749633789
local_in_edges_tensor generation:  0.045554161071777344
mini_batch_src_global generation:  0.06638240814208984
r_  generation:  0.5418977737426758
local_output_nid generation:  0.03244161605834961
local_in_edges_tensor generation:  0.03564643859863281
mini_batch_src_global generation:  0.08292317390441895
r_  generation:  0.5428519248962402
local_output_nid generation:  0.032500505447387695
local_in_edges_tensor generation:  0.03601694107055664
mini_batch_src_global generation:  0.06295108795166016
r_  generation:  0.5448193550109863
local_output_nid generation:  0.03276395797729492
local_in_edges_tensor generation:  0.04584932327270508
mini_batch_src_global generation:  0.06248164176940918
r_  generation:  0.5442025661468506
local_output_nid generation:  0.03285384178161621
local_in_edges_tensor generation:  0.04145336151123047
mini_batch_src_global generation:  0.06669378280639648
r_  generation:  0.5459494590759277
local_output_nid generation:  0.03306436538696289
local_in_edges_tensor generation:  0.04552412033081055
mini_batch_src_global generation:  0.06659650802612305
r_  generation:  0.5513207912445068
local_output_nid generation:  0.03277158737182617
local_in_edges_tensor generation:  0.03646993637084961
mini_batch_src_global generation:  0.06373333930969238
r_  generation:  0.5429413318634033
----------------------check_connections_block total spend ----------------------------- 12.930889368057251
generate_one_block  0.6942291259765625
generate_one_block  0.6973507404327393
generate_one_block  0.6772506237030029
generate_one_block  0.6848771572113037
generate_one_block  0.6816914081573486
generate_one_block  0.6931085586547852
generate_one_block  0.6719868183135986
generate_one_block  0.6804578304290771
generate_one_block  0.7178478240966797
generate_one_block  0.6825103759765625
generate_one_block  0.6830077171325684
generate_one_block  0.6838641166687012
generate_one_block  0.6934027671813965
generate_one_block  0.6905372142791748
generate_one_block  0.6958813667297363
generate_one_block  0.6816272735595703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1385664939880371  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

connection checking time:  19.38875937461853
block generation total time  16.72282123565674
average batch blocks generation time:  1.0451763272285461
block dataloader generation time/epoch 38.4262809753418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09654569625854492  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157498, 128])
torch.Size([129468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19360780715942383  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09759235382080078  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157807, 128])
torch.Size([130263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1947312355041504  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09683799743652344  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157640, 128])
torch.Size([129945, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1948719024658203  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09667062759399414  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157339, 128])
torch.Size([129713, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19477128982543945  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09662675857543945  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157589, 128])
torch.Size([129860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19378328323364258  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0977783203125  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

torch.Size([157751, 128])
torch.Size([130387, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19591999053955078  GigaBytes
Max Memory Allocated: 0.21014833450317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09681415557861328  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157562, 128])
torch.Size([130008, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19487857818603516  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09645318984985352  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157207, 128])
torch.Size([129614, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19356393814086914  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09660720825195312  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157378, 128])
torch.Size([129584, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19471073150634766  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09675788879394531  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157682, 128])
torch.Size([129919, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19495773315429688  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09688329696655273  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157629, 128])
torch.Size([129559, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19495677947998047  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09778499603271484  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157742, 128])
torch.Size([129777, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1958932876586914  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09765434265136719  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157728, 128])
torch.Size([130276, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19481563568115234  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09775161743164062  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157807, 128])
torch.Size([130261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.19589662551879883  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.0977773666381836  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157779, 128])
torch.Size([130335, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1959385871887207  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.09765911102294922  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

torch.Size([157749, 128])
torch.Size([129858, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1947927474975586  GigaBytes
Max Memory Allocated: 0.21019363403320312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030460327863693237 |0.01756282150745392 |0.0034413188695907593 |9.15229320526123e-05 |0.0037484318017959595 |0.0013463497161865234 |
----------------------------------------------------------pseudo_mini_loss sum 4.332874774932861
Total (block generation + training)time/epoch 39.340970039367676
Training time/epoch 0.9144039154052734
Training time without block to device /epoch 0.6333987712860107
Training time without total dataloading part /epoch 0.11784672737121582
load block tensor time/epoch 0.4873652458190918
block to device time/epoch 0.2810051441192627
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5330758
Number of first layer input nodes during this epoch:  2521887
