Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648493267.5091705
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025851011276245117
random selection method range initialization spend 0.007629871368408203
time for parepare:  0.01933121681213379
local_output_nid generation:  0.004288434982299805
local_in_edges_tensor generation:  0.0072612762451171875
mini_batch_src_global generation:  0.003892183303833008
r_  generation:  0.05075979232788086
local_output_nid generation:  0.00579833984375
local_in_edges_tensor generation:  0.0031719207763671875
mini_batch_src_global generation:  0.004279375076293945
r_  generation:  0.037924766540527344
local_output_nid generation:  0.005964756011962891
local_in_edges_tensor generation:  0.0032660961151123047
mini_batch_src_global generation:  0.002805948257446289
r_  generation:  0.03960585594177246
local_output_nid generation:  0.0060732364654541016
local_in_edges_tensor generation:  0.0032737255096435547
mini_batch_src_global generation:  0.003045320510864258
r_  generation:  0.0418243408203125
local_output_nid generation:  0.0061244964599609375
local_in_edges_tensor generation:  0.0031871795654296875
mini_batch_src_global generation:  0.003034830093383789
r_  generation:  0.040761470794677734
local_output_nid generation:  0.0060999393463134766
local_in_edges_tensor generation:  0.003188610076904297
mini_batch_src_global generation:  0.0034117698669433594
r_  generation:  0.042029619216918945
local_output_nid generation:  0.006106853485107422
local_in_edges_tensor generation:  0.0032951831817626953
mini_batch_src_global generation:  0.0033483505249023438
r_  generation:  0.04126381874084473
local_output_nid generation:  0.006110191345214844
local_in_edges_tensor generation:  0.0032525062561035156
mini_batch_src_global generation:  0.003349781036376953
r_  generation:  0.041799306869506836
----------------------check_connections_block total spend ----------------------------- 0.5379555225372314
generate_one_block  0.05517411231994629
generate_one_block  0.0549771785736084
generate_one_block  0.0555570125579834
generate_one_block  0.05618906021118164
generate_one_block  0.05788993835449219
generate_one_block  0.05592775344848633
generate_one_block  0.05475163459777832
generate_one_block  0.05521988868713379
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04248690605163574
gen group dst list time:  0.015285968780517578
time for parepare:  0.019130468368530273
local_output_nid generation:  0.013398408889770508
local_in_edges_tensor generation:  0.03302884101867676
mini_batch_src_global generation:  0.030611038208007812
r_  generation:  0.2979912757873535
local_output_nid generation:  0.01840066909790039
local_in_edges_tensor generation:  0.029848337173461914
mini_batch_src_global generation:  0.04072928428649902
r_  generation:  0.30960869789123535
local_output_nid generation:  0.01812458038330078
local_in_edges_tensor generation:  0.024788618087768555
mini_batch_src_global generation:  0.03966975212097168
r_  generation:  0.31403088569641113
local_output_nid generation:  0.018441200256347656
local_in_edges_tensor generation:  0.025304555892944336
mini_batch_src_global generation:  0.03707265853881836
r_  generation:  0.3191244602203369
local_output_nid generation:  0.017768144607543945
local_in_edges_tensor generation:  0.019414901733398438
mini_batch_src_global generation:  0.03844714164733887
r_  generation:  0.3121073246002197
local_output_nid generation:  0.018125057220458984
local_in_edges_tensor generation:  0.021864652633666992
mini_batch_src_global generation:  0.03830265998840332
r_  generation:  0.32433104515075684
local_output_nid generation:  0.018240928649902344
local_in_edges_tensor generation:  0.0253751277923584
mini_batch_src_global generation:  0.03811025619506836
r_  generation:  0.317138671875
local_output_nid generation:  0.017950057983398438
local_in_edges_tensor generation:  0.019565343856811523
mini_batch_src_global generation:  0.03809237480163574
r_  generation:  0.3139944076538086
----------------------check_connections_block total spend ----------------------------- 3.7151341438293457
generate_one_block  0.4120826721191406
generate_one_block  0.40943264961242676
generate_one_block  0.4113504886627197
generate_one_block  0.42206311225891113
generate_one_block  0.3990180492401123
generate_one_block  0.4282054901123047
generate_one_block  0.41263389587402344
generate_one_block  0.3987312316894531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.045072078704833984
gen group dst list time:  0.037177324295043945
time for parepare:  0.019187211990356445
local_output_nid generation:  0.028943777084350586
local_in_edges_tensor generation:  0.05067753791809082
mini_batch_src_global generation:  0.04892277717590332
r_  generation:  0.5190408229827881
local_output_nid generation:  0.034620046615600586
local_in_edges_tensor generation:  0.06382536888122559
mini_batch_src_global generation:  0.06317424774169922
r_  generation:  0.5300321578979492
local_output_nid generation:  0.036287546157836914
local_in_edges_tensor generation:  0.0531163215637207
mini_batch_src_global generation:  0.05702400207519531
r_  generation:  0.5455539226531982
local_output_nid generation:  0.03523087501525879
local_in_edges_tensor generation:  0.046450138092041016
mini_batch_src_global generation:  0.062032222747802734
r_  generation:  0.5328652858734131
local_output_nid generation:  0.03575706481933594
local_in_edges_tensor generation:  0.05305361747741699
mini_batch_src_global generation:  0.05948996543884277
r_  generation:  0.5760738849639893
local_output_nid generation:  0.038004398345947266
local_in_edges_tensor generation:  0.04100155830383301
mini_batch_src_global generation:  0.06266140937805176
r_  generation:  0.5411241054534912
local_output_nid generation:  0.03550410270690918
local_in_edges_tensor generation:  0.04819154739379883
mini_batch_src_global generation:  0.06010699272155762
r_  generation:  0.5488724708557129
local_output_nid generation:  0.035359859466552734
local_in_edges_tensor generation:  0.03815627098083496
mini_batch_src_global generation:  0.0613248348236084
r_  generation:  0.5379207134246826
----------------------check_connections_block total spend ----------------------------- 6.4623847007751465
generate_one_block  0.6855847835540771
generate_one_block  0.6808879375457764
generate_one_block  0.7116916179656982
generate_one_block  0.7040541172027588
generate_one_block  0.6755626201629639
generate_one_block  0.6782360076904297
generate_one_block  0.7213749885559082
generate_one_block  0.6913962364196777
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05486941337585449
gen group dst list time:  0.044431447982788086
time for parepare:  0.0196835994720459
local_output_nid generation:  0.034929513931274414
local_in_edges_tensor generation:  0.07780718803405762
mini_batch_src_global generation:  0.05172443389892578
r_  generation:  0.5392673015594482
local_output_nid generation:  0.04012727737426758
local_in_edges_tensor generation:  0.058965206146240234
mini_batch_src_global generation:  0.06292295455932617
r_  generation:  0.5562601089477539
local_output_nid generation:  0.03985023498535156
local_in_edges_tensor generation:  0.05940604209899902
mini_batch_src_global generation:  0.06621265411376953
r_  generation:  0.5409917831420898
local_output_nid generation:  0.03977084159851074
local_in_edges_tensor generation:  0.050013065338134766
mini_batch_src_global generation:  0.05907082557678223
r_  generation:  0.5455143451690674
local_output_nid generation:  0.03944134712219238
local_in_edges_tensor generation:  0.04116034507751465
mini_batch_src_global generation:  0.06040501594543457
r_  generation:  0.5548219680786133
local_output_nid generation:  0.03946685791015625
local_in_edges_tensor generation:  0.04037141799926758
mini_batch_src_global generation:  0.06012248992919922
r_  generation:  0.5526268482208252
local_output_nid generation:  0.039392948150634766
local_in_edges_tensor generation:  0.04921841621398926
mini_batch_src_global generation:  0.06353235244750977
r_  generation:  0.5573842525482178
local_output_nid generation:  0.0394895076751709
local_in_edges_tensor generation:  0.05009150505065918
mini_batch_src_global generation:  0.05974769592285156
r_  generation:  0.562387228012085
----------------------check_connections_block total spend ----------------------------- 6.667677402496338
generate_one_block  0.6887705326080322
generate_one_block  0.6818125247955322
generate_one_block  0.6986556053161621
generate_one_block  0.7031528949737549
generate_one_block  0.681164026260376
generate_one_block  0.6881530284881592
generate_one_block  0.7480747699737549
generate_one_block  0.7057561874389648
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033780574798583984
gen group dst list time:  0.0480804443359375
time for parepare:  0.019968032836914062
local_output_nid generation:  0.035768985748291016
local_in_edges_tensor generation:  0.05423736572265625
mini_batch_src_global generation:  0.0480959415435791
r_  generation:  0.5064992904663086
local_output_nid generation:  0.04509115219116211
local_in_edges_tensor generation:  0.045514822006225586
mini_batch_src_global generation:  0.05753731727600098
r_  generation:  0.5091283321380615
local_output_nid generation:  0.04165792465209961
local_in_edges_tensor generation:  0.03981733322143555
mini_batch_src_global generation:  0.05829453468322754
r_  generation:  0.5102925300598145
local_output_nid generation:  0.04149746894836426
local_in_edges_tensor generation:  0.038962602615356445
mini_batch_src_global generation:  0.05834150314331055
r_  generation:  0.5138568878173828
local_output_nid generation:  0.041437625885009766
local_in_edges_tensor generation:  0.03882002830505371
mini_batch_src_global generation:  0.05837821960449219
r_  generation:  0.5141301155090332
local_output_nid generation:  0.04155230522155762
local_in_edges_tensor generation:  0.03769636154174805
mini_batch_src_global generation:  0.05777454376220703
r_  generation:  0.5143606662750244
local_output_nid generation:  0.04179501533508301
local_in_edges_tensor generation:  0.039164066314697266
mini_batch_src_global generation:  0.05744123458862305
r_  generation:  0.5152170658111572
local_output_nid generation:  0.04181098937988281
local_in_edges_tensor generation:  0.040207624435424805
mini_batch_src_global generation:  0.05747818946838379
r_  generation:  0.5135788917541504
----------------------check_connections_block total spend ----------------------------- 6.188115835189819
generate_one_block  0.6495099067687988
generate_one_block  0.6351282596588135
generate_one_block  0.6452505588531494
generate_one_block  0.6392192840576172
generate_one_block  0.6514332294464111
generate_one_block  0.6412222385406494
generate_one_block  0.6393628120422363
generate_one_block  0.6842162609100342
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  23.03331208229065
block generation total time  19.623188018798828
average batch blocks generation time:  2.4528985023498535
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12637853622436523  GigaBytes
Max Memory Allocated: 0.12637853622436523  GigaBytes

torch.Size([167052, 128])
torch.Size([165824, 128])
torch.Size([161369, 128])
torch.Size([141874, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.2727489471435547  GigaBytes
Max Memory Allocated: 1.3009071350097656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.1284785270690918  GigaBytes
Max Memory Allocated: 1.3377361297607422  GigaBytes

torch.Size([166895, 128])
torch.Size([165699, 128])
torch.Size([161214, 128])
torch.Size([141690, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.273282527923584  GigaBytes
Max Memory Allocated: 1.3377361297607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12907075881958008  GigaBytes
Max Memory Allocated: 1.3377361297607422  GigaBytes

torch.Size([167025, 128])
torch.Size([165851, 128])
torch.Size([161520, 128])
torch.Size([142680, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2759194374084473  GigaBytes
Max Memory Allocated: 1.3377361297607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12923192977905273  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166983, 128])
torch.Size([165819, 128])
torch.Size([161500, 128])
torch.Size([142328, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2756624221801758  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12796640396118164  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166897, 128])
torch.Size([165619, 128])
torch.Size([161013, 128])
torch.Size([141210, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2635078430175781  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12813615798950195  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166963, 128])
torch.Size([165767, 128])
torch.Size([161332, 128])
torch.Size([141903, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.273176670074463  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12902164459228516  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166971, 128])
torch.Size([165792, 128])
torch.Size([161393, 128])
torch.Size([142262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2737469673156738  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12895774841308594  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166963, 128])
torch.Size([165829, 128])
torch.Size([161404, 128])
torch.Size([141823, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2733917236328125  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07639765739440918 |0.08338606357574463 |0.09419611096382141 |0.00010535120964050293 |0.02235233783721924 |0.0032830238342285156 |
----------------------------------------------------------pseudo_mini_loss sum 5.683206081390381
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5631501
Number of first layer input nodes during this epoch:  1335749
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.21639060974121094  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.020242929458618164
random selection method range initialization spend 0.005040884017944336
time for parepare:  0.018183231353759766
local_output_nid generation:  0.005303144454956055
local_in_edges_tensor generation:  0.0061266422271728516
mini_batch_src_global generation:  0.0034084320068359375
r_  generation:  0.03810429573059082
local_output_nid generation:  0.006545066833496094
local_in_edges_tensor generation:  0.003464221954345703
mini_batch_src_global generation:  0.0041658878326416016
r_  generation:  0.0393221378326416
local_output_nid generation:  0.0067059993743896484
local_in_edges_tensor generation:  0.0036878585815429688
mini_batch_src_global generation:  0.002785205841064453
r_  generation:  0.039972782135009766
local_output_nid generation:  0.006824970245361328
local_in_edges_tensor generation:  0.003740549087524414
mini_batch_src_global generation:  0.003043651580810547
r_  generation:  0.04144001007080078
local_output_nid generation:  0.0069315433502197266
local_in_edges_tensor generation:  0.0036933422088623047
mini_batch_src_global generation:  0.0030972957611083984
r_  generation:  0.04535245895385742
local_output_nid generation:  0.00700831413269043
local_in_edges_tensor generation:  0.003650665283203125
mini_batch_src_global generation:  0.0034284591674804688
r_  generation:  0.04395461082458496
local_output_nid generation:  0.006945610046386719
local_in_edges_tensor generation:  0.003713846206665039
mini_batch_src_global generation:  0.003360748291015625
r_  generation:  0.04252004623413086
local_output_nid generation:  0.006892204284667969
local_in_edges_tensor generation:  0.0037276744842529297
mini_batch_src_global generation:  0.0034470558166503906
r_  generation:  0.04233574867248535
----------------------check_connections_block total spend ----------------------------- 0.548349142074585
generate_one_block  0.05473971366882324
generate_one_block  0.05932784080505371
generate_one_block  0.055712223052978516
generate_one_block  0.06153059005737305
generate_one_block  0.05644869804382324
generate_one_block  0.05808210372924805
generate_one_block  0.055838823318481445
generate_one_block  0.06194949150085449
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04152321815490723
gen group dst list time:  0.01512765884399414
time for parepare:  0.021998882293701172
local_output_nid generation:  0.014181375503540039
local_in_edges_tensor generation:  0.04465794563293457
mini_batch_src_global generation:  0.03136849403381348
r_  generation:  0.30591320991516113
local_output_nid generation:  0.01892685890197754
local_in_edges_tensor generation:  0.03097391128540039
mini_batch_src_global generation:  0.03614974021911621
r_  generation:  0.3101174831390381
local_output_nid generation:  0.01915740966796875
local_in_edges_tensor generation:  0.024727582931518555
mini_batch_src_global generation:  0.03647208213806152
r_  generation:  0.31118273735046387
local_output_nid generation:  0.01948714256286621
local_in_edges_tensor generation:  0.024839162826538086
mini_batch_src_global generation:  0.03947091102600098
r_  generation:  0.3192172050476074
local_output_nid generation:  0.018507957458496094
local_in_edges_tensor generation:  0.02254629135131836
mini_batch_src_global generation:  0.04048895835876465
r_  generation:  0.32245945930480957
local_output_nid generation:  0.020876169204711914
local_in_edges_tensor generation:  0.022896766662597656
mini_batch_src_global generation:  0.04145026206970215
r_  generation:  0.329326868057251
local_output_nid generation:  0.018158435821533203
local_in_edges_tensor generation:  0.019971847534179688
mini_batch_src_global generation:  0.038495779037475586
r_  generation:  0.32490086555480957
local_output_nid generation:  0.01841568946838379
local_in_edges_tensor generation:  0.022092819213867188
mini_batch_src_global generation:  0.03899359703063965
r_  generation:  0.3257274627685547
----------------------check_connections_block total spend ----------------------------- 3.7835886478424072
generate_one_block  0.4440140724182129
generate_one_block  0.40959906578063965
generate_one_block  0.4057738780975342
generate_one_block  0.42641544342041016
generate_one_block  0.41230297088623047
generate_one_block  0.4173147678375244
generate_one_block  0.4018855094909668
generate_one_block  0.4382293224334717
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.044235944747924805
gen group dst list time:  0.03606748580932617
time for parepare:  0.019860506057739258
local_output_nid generation:  0.027965545654296875
local_in_edges_tensor generation:  0.06029319763183594
mini_batch_src_global generation:  0.05025458335876465
r_  generation:  0.5186707973480225
local_output_nid generation:  0.034130096435546875
local_in_edges_tensor generation:  0.05596303939819336
mini_batch_src_global generation:  0.0617833137512207
r_  generation:  0.5354716777801514
local_output_nid generation:  0.034598588943481445
local_in_edges_tensor generation:  0.04916691780090332
mini_batch_src_global generation:  0.06252336502075195
r_  generation:  0.5590376853942871
local_output_nid generation:  0.03673076629638672
local_in_edges_tensor generation:  0.04674792289733887
mini_batch_src_global generation:  0.06750869750976562
r_  generation:  0.5343987941741943
local_output_nid generation:  0.036301374435424805
local_in_edges_tensor generation:  0.05016303062438965
mini_batch_src_global generation:  0.05886101722717285
r_  generation:  0.5475203990936279
local_output_nid generation:  0.03573131561279297
local_in_edges_tensor generation:  0.04671645164489746
mini_batch_src_global generation:  0.06166815757751465
r_  generation:  0.5379734039306641
local_output_nid generation:  0.035932302474975586
local_in_edges_tensor generation:  0.036907196044921875
mini_batch_src_global generation:  0.06127786636352539
r_  generation:  0.5581479072570801
local_output_nid generation:  0.03578376770019531
local_in_edges_tensor generation:  0.03668403625488281
mini_batch_src_global generation:  0.06233668327331543
r_  generation:  0.5380043983459473
----------------------check_connections_block total spend ----------------------------- 6.4457011222839355
generate_one_block  0.7035231590270996
generate_one_block  0.6849515438079834
generate_one_block  0.6818854808807373
generate_one_block  0.6808879375457764
generate_one_block  0.691359281539917
generate_one_block  0.6934521198272705
generate_one_block  0.6712515354156494
generate_one_block  0.6785314083099365
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04150867462158203
gen group dst list time:  0.04780173301696777
time for parepare:  0.0192108154296875
local_output_nid generation:  0.03409266471862793
local_in_edges_tensor generation:  0.059465646743774414
mini_batch_src_global generation:  0.05425095558166504
r_  generation:  0.5372574329376221
local_output_nid generation:  0.04199504852294922
local_in_edges_tensor generation:  0.09554147720336914
mini_batch_src_global generation:  0.06137895584106445
r_  generation:  0.545172929763794
local_output_nid generation:  0.04068946838378906
local_in_edges_tensor generation:  0.05578041076660156
mini_batch_src_global generation:  0.06202578544616699
r_  generation:  0.5495784282684326
local_output_nid generation:  0.038987159729003906
local_in_edges_tensor generation:  0.04376482963562012
mini_batch_src_global generation:  0.05846977233886719
r_  generation:  0.5495710372924805
local_output_nid generation:  0.03838062286376953
local_in_edges_tensor generation:  0.05641317367553711
mini_batch_src_global generation:  0.05883669853210449
r_  generation:  0.5662863254547119
local_output_nid generation:  0.040715694427490234
local_in_edges_tensor generation:  0.04915022850036621
mini_batch_src_global generation:  0.06618738174438477
r_  generation:  0.5553185939788818
local_output_nid generation:  0.040859222412109375
local_in_edges_tensor generation:  0.04477238655090332
mini_batch_src_global generation:  0.059462547302246094
r_  generation:  0.5526392459869385
local_output_nid generation:  0.03945517539978027
local_in_edges_tensor generation:  0.04309892654418945
mini_batch_src_global generation:  0.057883262634277344
r_  generation:  0.5603199005126953
----------------------check_connections_block total spend ----------------------------- 6.677523612976074
generate_one_block  0.6821677684783936
generate_one_block  0.7045848369598389
generate_one_block  0.7110929489135742
generate_one_block  0.6768934726715088
generate_one_block  0.6969482898712158
generate_one_block  0.6820344924926758
generate_one_block  0.6756441593170166
generate_one_block  0.6858606338500977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0515437126159668
gen group dst list time:  0.05159115791320801
time for parepare:  0.01924920082092285
local_output_nid generation:  0.03495192527770996
local_in_edges_tensor generation:  0.053319454193115234
mini_batch_src_global generation:  0.04492783546447754
r_  generation:  0.5014901161193848
local_output_nid generation:  0.04012656211853027
local_in_edges_tensor generation:  0.04128551483154297
mini_batch_src_global generation:  0.05802345275878906
r_  generation:  0.5083878040313721
local_output_nid generation:  0.04046201705932617
local_in_edges_tensor generation:  0.04107069969177246
mini_batch_src_global generation:  0.058498382568359375
r_  generation:  0.5058155059814453
local_output_nid generation:  0.0403289794921875
local_in_edges_tensor generation:  0.04196619987487793
mini_batch_src_global generation:  0.0588531494140625
r_  generation:  0.5068991184234619
local_output_nid generation:  0.040010929107666016
local_in_edges_tensor generation:  0.04111456871032715
mini_batch_src_global generation:  0.05812811851501465
r_  generation:  0.5085020065307617
local_output_nid generation:  0.040374755859375
local_in_edges_tensor generation:  0.08498883247375488
mini_batch_src_global generation:  0.056786537170410156
r_  generation:  0.519040584564209
local_output_nid generation:  0.040218353271484375
local_in_edges_tensor generation:  0.045256614685058594
mini_batch_src_global generation:  0.05691957473754883
r_  generation:  0.5185089111328125
local_output_nid generation:  0.040262460708618164
local_in_edges_tensor generation:  0.04119563102722168
mini_batch_src_global generation:  0.0571436882019043
r_  generation:  0.5254759788513184
----------------------check_connections_block total spend ----------------------------- 6.226512432098389
generate_one_block  0.6589357852935791
generate_one_block  0.6509933471679688
generate_one_block  0.6502597332000732
generate_one_block  0.6492142677307129
generate_one_block  0.6421716213226318
generate_one_block  0.6287622451782227
generate_one_block  0.6348724365234375
generate_one_block  0.639500617980957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.21639060974121094  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

connection checking time:  23.133325815200806
block generation total time  19.511314153671265
average batch blocks generation time:  2.438914269208908
block dataloader generation time/epoch 45.3014919757843
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.13086509704589844  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166907, 128])
torch.Size([165735, 128])
torch.Size([161454, 128])
torch.Size([142233, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2761578559875488  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.13002967834472656  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166867, 128])
torch.Size([165644, 128])
torch.Size([161327, 128])
torch.Size([141744, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.272538661956787  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.12895631790161133  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166951, 128])
torch.Size([165792, 128])
torch.Size([161290, 128])
torch.Size([141573, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2693018913269043  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.12916088104248047  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166940, 128])
torch.Size([165754, 128])
torch.Size([161251, 128])
torch.Size([142072, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2751669883728027  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.1290898323059082  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166959, 128])
torch.Size([165741, 128])
torch.Size([161410, 128])
torch.Size([142054, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2739410400390625  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.12932348251342773  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166874, 128])
torch.Size([165590, 128])
torch.Size([161173, 128])
torch.Size([142248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2748188972473145  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.1290740966796875  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166932, 128])
torch.Size([165663, 128])
torch.Size([161107, 128])
torch.Size([141542, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2726387977600098  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.12964963912963867  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

torch.Size([166843, 128])
torch.Size([165615, 128])
torch.Size([161153, 128])
torch.Size([141761, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.273855209350586  GigaBytes
Max Memory Allocated: 1.3408904075622559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0894201397895813 |0.03411439061164856 |0.005544871091842651 |9.468197822570801e-05 |0.005943566560745239 |0.004731416702270508 |
----------------------------------------------------------pseudo_mini_loss sum 3.8717901706695557
Total (block generation + training)time/epoch 46.464839458465576
Training time/epoch 1.1631147861480713
Training time without block to device /epoch 0.8901996612548828
Training time without total dataloading part /epoch 0.0973963737487793
load block tensor time/epoch 0.7153611183166504
block to device time/epoch 0.2729151248931885
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5629118
Number of first layer input nodes during this epoch:  1335273
