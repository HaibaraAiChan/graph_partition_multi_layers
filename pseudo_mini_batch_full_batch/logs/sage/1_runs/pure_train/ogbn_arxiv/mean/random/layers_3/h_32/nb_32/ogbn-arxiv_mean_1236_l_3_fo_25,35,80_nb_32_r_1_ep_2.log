Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648438015.585279
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025302410125732422
random selection method range initialization spend 0.006223201751708984
time for parepare:  0.018941402435302734
local_output_nid generation:  0.0011141300201416016
local_in_edges_tensor generation:  0.003312826156616211
mini_batch_src_global generation:  0.0016376972198486328
r_  generation:  0.010935306549072266
local_output_nid generation:  0.0014615058898925781
local_in_edges_tensor generation:  0.0009636878967285156
mini_batch_src_global generation:  0.0015599727630615234
r_  generation:  0.009344816207885742
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.009590387344360352
local_output_nid generation:  0.0014731884002685547
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.009177207946777344
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.0008034706115722656
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.009524106979370117
local_output_nid generation:  0.001451253890991211
local_in_edges_tensor generation:  0.0007843971252441406
mini_batch_src_global generation:  0.0010118484497070312
r_  generation:  0.009811639785766602
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.009596586227416992
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.00982356071472168
local_output_nid generation:  0.0015265941619873047
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.009745359420776367
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.009714126586914062
local_output_nid generation:  0.0014460086822509766
local_in_edges_tensor generation:  0.0007836818695068359
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.010404586791992188
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.010073423385620117
local_output_nid generation:  0.0014536380767822266
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.009857177734375
local_output_nid generation:  0.0014526844024658203
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.009786128997802734
local_output_nid generation:  0.0014367103576660156
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.010129690170288086
local_output_nid generation:  0.0014858245849609375
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.009340047836303711
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007374286651611328
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.009713172912597656
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.010230302810668945
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0010499954223632812
r_  generation:  0.010001182556152344
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.01000070571899414
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007305145263671875
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.00958704948425293
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.001035928726196289
r_  generation:  0.010084390640258789
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0010216236114501953
r_  generation:  0.009598970413208008
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.010443449020385742
local_output_nid generation:  0.0014874935150146484
local_in_edges_tensor generation:  0.0007281303405761719
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009752273559570312
local_output_nid generation:  0.0014567375183105469
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.009695291519165039
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.01006460189819336
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0010213851928710938
r_  generation:  0.009934663772583008
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.0007441043853759766
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.009606122970581055
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0055277347564697266
mini_batch_src_global generation:  0.001207113265991211
r_  generation:  0.009584188461303711
local_output_nid generation:  0.001325845718383789
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.009813547134399414
local_output_nid generation:  0.001363515853881836
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.009618043899536133
----------------------check_connections_block total spend ----------------------------- 0.5343852043151855
generate_one_block  0.015491962432861328
generate_one_block  0.014490604400634766
generate_one_block  0.015292167663574219
generate_one_block  0.01482844352722168
generate_one_block  0.014929056167602539
generate_one_block  0.015181303024291992
generate_one_block  0.014518260955810547
generate_one_block  0.014991521835327148
generate_one_block  0.015024185180664062
generate_one_block  0.015071868896484375
generate_one_block  0.015034198760986328
generate_one_block  0.01471090316772461
generate_one_block  0.014809370040893555
generate_one_block  0.014670848846435547
generate_one_block  0.014959573745727539
generate_one_block  0.014043569564819336
generate_one_block  0.014827489852905273
generate_one_block  0.015125036239624023
generate_one_block  0.014780044555664062
generate_one_block  0.015020132064819336
generate_one_block  0.014204978942871094
generate_one_block  0.015028953552246094
generate_one_block  0.01436758041381836
generate_one_block  0.01546931266784668
generate_one_block  0.014445304870605469
generate_one_block  0.014343500137329102
generate_one_block  0.014719009399414062
generate_one_block  0.014673233032226562
generate_one_block  0.014358282089233398
generate_one_block  0.01424098014831543
generate_one_block  0.01502537727355957
generate_one_block  0.01431894302368164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037236690521240234
gen group dst list time:  0.023692846298217773
time for parepare:  0.018950223922729492
local_output_nid generation:  0.005188465118408203
local_in_edges_tensor generation:  0.011120080947875977
mini_batch_src_global generation:  0.013383626937866211
r_  generation:  0.13350534439086914
local_output_nid generation:  0.008801937103271484
local_in_edges_tensor generation:  0.011780738830566406
mini_batch_src_global generation:  0.016536235809326172
r_  generation:  0.13519859313964844
local_output_nid generation:  0.008930683135986328
local_in_edges_tensor generation:  0.00968027114868164
mini_batch_src_global generation:  0.016402482986450195
r_  generation:  0.1517021656036377
local_output_nid generation:  0.008742809295654297
local_in_edges_tensor generation:  0.008594512939453125
mini_batch_src_global generation:  0.016814231872558594
r_  generation:  0.14226055145263672
local_output_nid generation:  0.008965253829956055
local_in_edges_tensor generation:  0.010314464569091797
mini_batch_src_global generation:  0.0174252986907959
r_  generation:  0.14838361740112305
local_output_nid generation:  0.009206056594848633
local_in_edges_tensor generation:  0.011330366134643555
mini_batch_src_global generation:  0.01872420310974121
r_  generation:  0.15296578407287598
local_output_nid generation:  0.008925676345825195
local_in_edges_tensor generation:  0.008655548095703125
mini_batch_src_global generation:  0.01826643943786621
r_  generation:  0.14795255661010742
local_output_nid generation:  0.009092330932617188
local_in_edges_tensor generation:  0.009813070297241211
mini_batch_src_global generation:  0.019551992416381836
r_  generation:  0.15558171272277832
local_output_nid generation:  0.008991479873657227
local_in_edges_tensor generation:  0.009646415710449219
mini_batch_src_global generation:  0.01840043067932129
r_  generation:  0.16156673431396484
local_output_nid generation:  0.008911848068237305
local_in_edges_tensor generation:  0.008667945861816406
mini_batch_src_global generation:  0.020732641220092773
r_  generation:  0.1491096019744873
local_output_nid generation:  0.008781194686889648
local_in_edges_tensor generation:  0.010175228118896484
mini_batch_src_global generation:  0.022408008575439453
r_  generation:  0.15234065055847168
local_output_nid generation:  0.00888681411743164
local_in_edges_tensor generation:  0.011229515075683594
mini_batch_src_global generation:  0.01857900619506836
r_  generation:  0.15000700950622559
local_output_nid generation:  0.009003639221191406
local_in_edges_tensor generation:  0.00982356071472168
mini_batch_src_global generation:  0.0196685791015625
r_  generation:  0.15206074714660645
local_output_nid generation:  0.008868694305419922
local_in_edges_tensor generation:  0.010952472686767578
mini_batch_src_global generation:  0.018651247024536133
r_  generation:  0.15167999267578125
local_output_nid generation:  0.008911371231079102
local_in_edges_tensor generation:  0.009821176528930664
mini_batch_src_global generation:  0.019780397415161133
r_  generation:  0.15435552597045898
local_output_nid generation:  0.008618831634521484
local_in_edges_tensor generation:  0.008386611938476562
mini_batch_src_global generation:  0.018149375915527344
r_  generation:  0.144819974899292
local_output_nid generation:  0.008769750595092773
local_in_edges_tensor generation:  0.008381843566894531
mini_batch_src_global generation:  0.01809859275817871
r_  generation:  0.15285897254943848
local_output_nid generation:  0.00894784927368164
local_in_edges_tensor generation:  0.009058237075805664
mini_batch_src_global generation:  0.018790245056152344
r_  generation:  0.155440092086792
local_output_nid generation:  0.008992433547973633
local_in_edges_tensor generation:  0.011004924774169922
mini_batch_src_global generation:  0.0188446044921875
r_  generation:  0.15257811546325684
local_output_nid generation:  0.009027242660522461
local_in_edges_tensor generation:  0.011146783828735352
mini_batch_src_global generation:  0.01999640464782715
r_  generation:  0.1546924114227295
local_output_nid generation:  0.008745908737182617
local_in_edges_tensor generation:  0.008532285690307617
mini_batch_src_global generation:  0.017969369888305664
r_  generation:  0.1465919017791748
local_output_nid generation:  0.009114742279052734
local_in_edges_tensor generation:  0.008547544479370117
mini_batch_src_global generation:  0.01826190948486328
r_  generation:  0.15395593643188477
local_output_nid generation:  0.008697271347045898
local_in_edges_tensor generation:  0.008632659912109375
mini_batch_src_global generation:  0.018027305603027344
r_  generation:  0.14753103256225586
local_output_nid generation:  0.009163141250610352
local_in_edges_tensor generation:  0.00942850112915039
mini_batch_src_global generation:  0.01948237419128418
r_  generation:  0.16301655769348145
local_output_nid generation:  0.008761405944824219
local_in_edges_tensor generation:  0.009698629379272461
mini_batch_src_global generation:  0.018398523330688477
r_  generation:  0.14901471138000488
local_output_nid generation:  0.008842945098876953
local_in_edges_tensor generation:  0.008420705795288086
mini_batch_src_global generation:  0.01857447624206543
r_  generation:  0.15324759483337402
local_output_nid generation:  0.008812665939331055
local_in_edges_tensor generation:  0.00973200798034668
mini_batch_src_global generation:  0.019376277923583984
r_  generation:  0.15311622619628906
local_output_nid generation:  0.008945226669311523
local_in_edges_tensor generation:  0.010915040969848633
mini_batch_src_global generation:  0.0184633731842041
r_  generation:  0.15422463417053223
local_output_nid generation:  0.008774042129516602
local_in_edges_tensor generation:  0.00947260856628418
mini_batch_src_global generation:  0.018198013305664062
r_  generation:  0.14989328384399414
local_output_nid generation:  0.008545398712158203
local_in_edges_tensor generation:  0.008275032043457031
mini_batch_src_global generation:  0.01787090301513672
r_  generation:  0.1447453498840332
local_output_nid generation:  0.008876562118530273
local_in_edges_tensor generation:  0.008914947509765625
mini_batch_src_global generation:  0.01942133903503418
r_  generation:  0.1563425064086914
local_output_nid generation:  0.008666515350341797
local_in_edges_tensor generation:  0.008555889129638672
mini_batch_src_global generation:  0.01778244972229004
r_  generation:  0.14423012733459473
----------------------check_connections_block total spend ----------------------------- 7.109913349151611
generate_one_block  0.18780994415283203
generate_one_block  0.17863249778747559
generate_one_block  0.2187957763671875
generate_one_block  0.18625760078430176
generate_one_block  0.18901896476745605
generate_one_block  0.1967477798461914
generate_one_block  0.18692851066589355
generate_one_block  0.19045758247375488
generate_one_block  0.1886298656463623
generate_one_block  0.1840074062347412
generate_one_block  0.19276762008666992
generate_one_block  0.1885995864868164
generate_one_block  0.19057536125183105
generate_one_block  0.19076824188232422
generate_one_block  0.1915738582611084
generate_one_block  0.19999265670776367
generate_one_block  0.18218255043029785
generate_one_block  0.19383549690246582
generate_one_block  0.19068002700805664
generate_one_block  0.19451594352722168
generate_one_block  0.18244051933288574
generate_one_block  0.1890561580657959
generate_one_block  0.189469575881958
generate_one_block  0.20775580406188965
generate_one_block  0.18619441986083984
generate_one_block  0.18270349502563477
generate_one_block  0.18976569175720215
generate_one_block  0.18938136100769043
generate_one_block  0.18506789207458496
generate_one_block  0.17988038063049316
generate_one_block  0.18748903274536133
generate_one_block  0.1844325065612793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05183863639831543
gen group dst list time:  0.10579824447631836
time for parepare:  0.020188331604003906
local_output_nid generation:  0.02113962173461914
local_in_edges_tensor generation:  0.05731368064880371
mini_batch_src_global generation:  0.037371158599853516
r_  generation:  0.3950350284576416
local_output_nid generation:  0.028423786163330078
local_in_edges_tensor generation:  0.03956413269042969
mini_batch_src_global generation:  0.04552316665649414
r_  generation:  0.40012645721435547
local_output_nid generation:  0.02808213233947754
local_in_edges_tensor generation:  0.03350400924682617
mini_batch_src_global generation:  0.04535484313964844
r_  generation:  0.40750670433044434
local_output_nid generation:  0.026613235473632812
local_in_edges_tensor generation:  0.029597759246826172
mini_batch_src_global generation:  0.04677009582519531
r_  generation:  0.40190720558166504
local_output_nid generation:  0.026502609252929688
local_in_edges_tensor generation:  0.030222415924072266
mini_batch_src_global generation:  0.04987454414367676
r_  generation:  0.4076259136199951
local_output_nid generation:  0.026695728302001953
local_in_edges_tensor generation:  0.030625104904174805
mini_batch_src_global generation:  0.048131704330444336
r_  generation:  0.4110748767852783
local_output_nid generation:  0.025896549224853516
local_in_edges_tensor generation:  0.029920578002929688
mini_batch_src_global generation:  0.04773211479187012
r_  generation:  0.4050872325897217
local_output_nid generation:  0.026285886764526367
local_in_edges_tensor generation:  0.02928614616394043
mini_batch_src_global generation:  0.048125267028808594
r_  generation:  0.4056887626647949
local_output_nid generation:  0.02633833885192871
local_in_edges_tensor generation:  0.03362393379211426
mini_batch_src_global generation:  0.059790611267089844
r_  generation:  0.41006922721862793
local_output_nid generation:  0.026418685913085938
local_in_edges_tensor generation:  0.029927968978881836
mini_batch_src_global generation:  0.048660993576049805
r_  generation:  0.40717101097106934
local_output_nid generation:  0.02756047248840332
local_in_edges_tensor generation:  0.02944493293762207
mini_batch_src_global generation:  0.04810905456542969
r_  generation:  0.41608524322509766
local_output_nid generation:  0.026456117630004883
local_in_edges_tensor generation:  0.03502631187438965
mini_batch_src_global generation:  0.05103254318237305
r_  generation:  0.40602827072143555
local_output_nid generation:  0.026972055435180664
local_in_edges_tensor generation:  0.0356900691986084
mini_batch_src_global generation:  0.04809904098510742
r_  generation:  0.41941118240356445
local_output_nid generation:  0.026931285858154297
local_in_edges_tensor generation:  0.03309965133666992
mini_batch_src_global generation:  0.04780387878417969
r_  generation:  0.41205549240112305
local_output_nid generation:  0.02682948112487793
local_in_edges_tensor generation:  0.026456594467163086
mini_batch_src_global generation:  0.05028200149536133
r_  generation:  0.41467761993408203
local_output_nid generation:  0.026375770568847656
local_in_edges_tensor generation:  0.025918006896972656
mini_batch_src_global generation:  0.047539472579956055
r_  generation:  0.4062628746032715
local_output_nid generation:  0.030608654022216797
local_in_edges_tensor generation:  0.03610539436340332
mini_batch_src_global generation:  0.05731964111328125
r_  generation:  0.4145169258117676
local_output_nid generation:  0.02734518051147461
local_in_edges_tensor generation:  0.037484169006347656
mini_batch_src_global generation:  0.04861807823181152
r_  generation:  0.40871572494506836
local_output_nid generation:  0.027307510375976562
local_in_edges_tensor generation:  0.033556222915649414
mini_batch_src_global generation:  0.0469973087310791
r_  generation:  0.410297155380249
local_output_nid generation:  0.02754950523376465
local_in_edges_tensor generation:  0.03026723861694336
mini_batch_src_global generation:  0.05060911178588867
r_  generation:  0.4129607677459717
local_output_nid generation:  0.027106285095214844
local_in_edges_tensor generation:  0.02640056610107422
mini_batch_src_global generation:  0.04743075370788574
r_  generation:  0.4098846912384033
local_output_nid generation:  0.027194738388061523
local_in_edges_tensor generation:  0.026148319244384766
mini_batch_src_global generation:  0.04856753349304199
r_  generation:  0.4075484275817871
local_output_nid generation:  0.02803349494934082
local_in_edges_tensor generation:  0.029391050338745117
mini_batch_src_global generation:  0.04701542854309082
r_  generation:  0.4081442356109619
local_output_nid generation:  0.027276992797851562
local_in_edges_tensor generation:  0.03701424598693848
mini_batch_src_global generation:  0.050386905670166016
r_  generation:  0.41025233268737793
local_output_nid generation:  0.026867389678955078
local_in_edges_tensor generation:  0.026558637619018555
mini_batch_src_global generation:  0.04698491096496582
r_  generation:  0.4114389419555664
local_output_nid generation:  0.02741098403930664
local_in_edges_tensor generation:  0.02634143829345703
mini_batch_src_global generation:  0.050679922103881836
r_  generation:  0.4060664176940918
local_output_nid generation:  0.027263641357421875
local_in_edges_tensor generation:  0.032731056213378906
mini_batch_src_global generation:  0.04717755317687988
r_  generation:  0.41315722465515137
local_output_nid generation:  0.02700066566467285
local_in_edges_tensor generation:  0.026036739349365234
mini_batch_src_global generation:  0.04852867126464844
r_  generation:  0.4049360752105713
local_output_nid generation:  0.02685379981994629
local_in_edges_tensor generation:  0.02881932258605957
mini_batch_src_global generation:  0.04682803153991699
r_  generation:  0.4141559600830078
local_output_nid generation:  0.0269927978515625
local_in_edges_tensor generation:  0.0333101749420166
mini_batch_src_global generation:  0.04766249656677246
r_  generation:  0.4117166996002197
local_output_nid generation:  0.027426958084106445
local_in_edges_tensor generation:  0.0337827205657959
mini_batch_src_global generation:  0.04710245132446289
r_  generation:  0.40999937057495117
local_output_nid generation:  0.02698659896850586
local_in_edges_tensor generation:  0.025676965713500977
mini_batch_src_global generation:  0.047486066818237305
r_  generation:  0.4084165096282959
----------------------check_connections_block total spend ----------------------------- 19.35580539703369
generate_one_block  0.6146893501281738
generate_one_block  0.5219082832336426
generate_one_block  0.5332105159759521
generate_one_block  0.5229740142822266
generate_one_block  0.5334289073944092
generate_one_block  0.5713508129119873
generate_one_block  0.5262887477874756
generate_one_block  0.5363583564758301
generate_one_block  0.5379185676574707
generate_one_block  0.5312759876251221
generate_one_block  0.5463802814483643
generate_one_block  0.5276710987091064
generate_one_block  0.5329625606536865
generate_one_block  0.5387754440307617
generate_one_block  0.5823745727539062
generate_one_block  0.5223729610443115
generate_one_block  0.5378379821777344
generate_one_block  0.5366122722625732
generate_one_block  0.5285129547119141
generate_one_block  0.5475029945373535
generate_one_block  0.5315566062927246
generate_one_block  0.5327701568603516
generate_one_block  0.5400569438934326
generate_one_block  0.5473833084106445
generate_one_block  0.521165132522583
generate_one_block  0.5224592685699463
generate_one_block  0.5352625846862793
generate_one_block  0.530449390411377
generate_one_block  0.5363898277282715
generate_one_block  0.5283513069152832
generate_one_block  0.5299570560455322
generate_one_block  0.5150108337402344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  26.465718746185303
block generation total time  23.27763319015503
average batch blocks generation time:  0.7274260371923447
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08344602584838867  GigaBytes
Max Memory Allocated: 0.08344602584838867  GigaBytes

torch.Size([146448, 128])
torch.Size([102078, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.15265369415283203  GigaBytes
Max Memory Allocated: 0.15433502197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08367538452148438  GigaBytes
Max Memory Allocated: 0.16716432571411133  GigaBytes

torch.Size([146396, 128])
torch.Size([101345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15232086181640625  GigaBytes
Max Memory Allocated: 0.16716432571411133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476924896240234  GigaBytes
Max Memory Allocated: 0.16716432571411133  GigaBytes

torch.Size([146182, 128])
torch.Size([102669, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15404272079467773  GigaBytes
Max Memory Allocated: 0.16716432571411133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475685119628906  GigaBytes
Max Memory Allocated: 0.16883563995361328  GigaBytes

torch.Size([145840, 128])
torch.Size([101391, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15348529815673828  GigaBytes
Max Memory Allocated: 0.16883563995361328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.16883563995361328  GigaBytes

torch.Size([146989, 128])
torch.Size([102724, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15399551391601562  GigaBytes
Max Memory Allocated: 0.16883563995361328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476829528808594  GigaBytes
Max Memory Allocated: 0.16884136199951172  GigaBytes

torch.Size([147035, 128])
torch.Size([104634, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15468358993530273  GigaBytes
Max Memory Allocated: 0.16884136199951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475875854492188  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146691, 128])
torch.Size([102503, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15380382537841797  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146848, 128])
torch.Size([103550, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1542186737060547  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847635269165039  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146857, 128])
torch.Size([103351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15410709381103516  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146584, 128])
torch.Size([102928, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539144515991211  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476638793945312  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145917, 128])
torch.Size([102249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538558006286621  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145992, 128])
torch.Size([101725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15364694595336914  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847625732421875  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146689, 128])
torch.Size([103271, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15410423278808594  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146639, 128])
torch.Size([102804, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15393495559692383  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847635269165039  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145950, 128])
torch.Size([102662, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15397024154663086  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08367061614990234  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146049, 128])
torch.Size([101415, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15223932266235352  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475589752197266  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146463, 128])
torch.Size([102156, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15367507934570312  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146544, 128])
torch.Size([102725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539764404296875  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146361, 128])
torch.Size([102155, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15380334854125977  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146516, 128])
torch.Size([103029, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15409421920776367  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475017547607422  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146583, 128])
torch.Size([101994, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15352535247802734  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145962, 128])
torch.Size([102317, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15385103225708008  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475303649902344  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145968, 128])
torch.Size([101617, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15349435806274414  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08477020263671875  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146762, 128])
torch.Size([103437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1544499397277832  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475589752197266  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145748, 128])
torch.Size([101672, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15354490280151367  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475494384765625  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([147138, 128])
torch.Size([102915, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538376808166504  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146033, 128])
torch.Size([102164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15375947952270508  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475971221923828  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146352, 128])
torch.Size([101953, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15370702743530273  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0837717056274414  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145892, 128])
torch.Size([101179, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15240859985351562  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08370685577392578  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145956, 128])
torch.Size([101275, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15222930908203125  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475685119628906  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146877, 128])
torch.Size([102886, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15389585494995117  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08360099792480469  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146041, 128])
torch.Size([101123, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1521592140197754  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028686538338661194 |0.021967686712741852 |0.02708808332681656 |9.208172559738159e-05 |0.004898853600025177 |0.00173187255859375 |
----------------------------------------------------------pseudo_mini_loss sum 5.056028366088867
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8800368
Number of first layer input nodes during this epoch:  4684302
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.11260080337524414  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02155613899230957
random selection method range initialization spend 0.005176544189453125
time for parepare:  0.016420364379882812
local_output_nid generation:  0.0012323856353759766
local_in_edges_tensor generation:  0.00461268424987793
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.010328054428100586
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0010051727294921875
mini_batch_src_global generation:  0.0013649463653564453
r_  generation:  0.009476900100708008
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.0008172988891601562
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.009068012237548828
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0008256435394287109
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.009410619735717773
local_output_nid generation:  0.0015032291412353516
local_in_edges_tensor generation:  0.0008122920989990234
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.009795665740966797
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.001001596450805664
r_  generation:  0.009763717651367188
local_output_nid generation:  0.0014684200286865234
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0010483264923095703
r_  generation:  0.009951591491699219
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.00998830795288086
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0007913112640380859
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.009737491607666016
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.009832620620727539
local_output_nid generation:  0.0014874935150146484
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.010096073150634766
local_output_nid generation:  0.0014536380767822266
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.0010194778442382812
r_  generation:  0.010230302810668945
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0010917186737060547
r_  generation:  0.010285615921020508
local_output_nid generation:  0.0014913082122802734
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.0010275840759277344
r_  generation:  0.012621641159057617
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0007615089416503906
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.010035514831542969
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0009922981262207031
r_  generation:  0.009890556335449219
local_output_nid generation:  0.0014691352844238281
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.010153055191040039
local_output_nid generation:  0.0014843940734863281
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.010008811950683594
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.010242700576782227
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0007479190826416016
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.010442972183227539
local_output_nid generation:  0.0014677047729492188
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.0031549930572509766
r_  generation:  0.010269641876220703
local_output_nid generation:  0.0014770030975341797
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.010206937789916992
local_output_nid generation:  0.0014629364013671875
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.010498762130737305
local_output_nid generation:  0.0014765262603759766
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0010266304016113281
r_  generation:  0.010091543197631836
local_output_nid generation:  0.0014793872833251953
local_in_edges_tensor generation:  0.0008070468902587891
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.00986790657043457
local_output_nid generation:  0.0014510154724121094
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0012290477752685547
r_  generation:  0.010139226913452148
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.012897491455078125
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0010216236114501953
r_  generation:  0.010190486907958984
local_output_nid generation:  0.0014884471893310547
local_in_edges_tensor generation:  0.0007886886596679688
mini_batch_src_global generation:  0.001055002212524414
r_  generation:  0.010379791259765625
local_output_nid generation:  0.0015370845794677734
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.009932518005371094
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.010350465774536133
local_output_nid generation:  0.001478433609008789
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.00971364974975586
----------------------check_connections_block total spend ----------------------------- 0.5438082218170166
generate_one_block  0.02189803123474121
generate_one_block  0.016919612884521484
generate_one_block  0.014395952224731445
generate_one_block  0.01487112045288086
generate_one_block  0.014874696731567383
generate_one_block  0.014864921569824219
generate_one_block  0.015000581741333008
generate_one_block  0.01778554916381836
generate_one_block  0.014890670776367188
generate_one_block  0.014765739440917969
generate_one_block  0.014854669570922852
generate_one_block  0.015160083770751953
generate_one_block  0.015187501907348633
generate_one_block  0.014603137969970703
generate_one_block  0.017608642578125
generate_one_block  0.014527082443237305
generate_one_block  0.014824867248535156
generate_one_block  0.01449131965637207
generate_one_block  0.015319347381591797
generate_one_block  0.015059709548950195
generate_one_block  0.015390396118164062
generate_one_block  0.02041149139404297
generate_one_block  0.015673160552978516
generate_one_block  0.014948844909667969
generate_one_block  0.014585494995117188
generate_one_block  0.015185832977294922
generate_one_block  0.015015840530395508
generate_one_block  0.018947362899780273
generate_one_block  0.01572418212890625
generate_one_block  0.014894247055053711
generate_one_block  0.015215873718261719
generate_one_block  0.014512062072753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051137685775756836
gen group dst list time:  0.02470254898071289
time for parepare:  0.02190876007080078
local_output_nid generation:  0.005463361740112305
local_in_edges_tensor generation:  0.018514394760131836
mini_batch_src_global generation:  0.015482187271118164
r_  generation:  0.13927650451660156
local_output_nid generation:  0.008171558380126953
local_in_edges_tensor generation:  0.01338338851928711
mini_batch_src_global generation:  0.01879286766052246
r_  generation:  0.13565683364868164
local_output_nid generation:  0.008221149444580078
local_in_edges_tensor generation:  0.02932143211364746
mini_batch_src_global generation:  0.014999866485595703
r_  generation:  0.1395869255065918
local_output_nid generation:  0.00849151611328125
local_in_edges_tensor generation:  0.01023554801940918
mini_batch_src_global generation:  0.017652273178100586
r_  generation:  0.14436841011047363
local_output_nid generation:  0.008314132690429688
local_in_edges_tensor generation:  0.011606216430664062
mini_batch_src_global generation:  0.01738905906677246
r_  generation:  0.14933323860168457
local_output_nid generation:  0.008042335510253906
local_in_edges_tensor generation:  0.010535717010498047
mini_batch_src_global generation:  0.01925969123840332
r_  generation:  0.1505415439605713
local_output_nid generation:  0.008019447326660156
local_in_edges_tensor generation:  0.010456562042236328
mini_batch_src_global generation:  0.018053054809570312
r_  generation:  0.1520993709564209
local_output_nid generation:  0.00812387466430664
local_in_edges_tensor generation:  0.010619163513183594
mini_batch_src_global generation:  0.01984238624572754
r_  generation:  0.15165925025939941
local_output_nid generation:  0.00829768180847168
local_in_edges_tensor generation:  0.009032011032104492
mini_batch_src_global generation:  0.0179443359375
r_  generation:  0.14645791053771973
local_output_nid generation:  0.008403539657592773
local_in_edges_tensor generation:  0.01077890396118164
mini_batch_src_global generation:  0.022050142288208008
r_  generation:  0.14888572692871094
local_output_nid generation:  0.008681297302246094
local_in_edges_tensor generation:  0.010474920272827148
mini_batch_src_global generation:  0.020843982696533203
r_  generation:  0.15009284019470215
local_output_nid generation:  0.008605480194091797
local_in_edges_tensor generation:  0.01181793212890625
mini_batch_src_global generation:  0.018618106842041016
r_  generation:  0.15275025367736816
local_output_nid generation:  0.008760690689086914
local_in_edges_tensor generation:  0.011907339096069336
mini_batch_src_global generation:  0.021941661834716797
r_  generation:  0.157440185546875
local_output_nid generation:  0.009931802749633789
local_in_edges_tensor generation:  0.009064674377441406
mini_batch_src_global generation:  0.018805742263793945
r_  generation:  0.15245580673217773
local_output_nid generation:  0.008378982543945312
local_in_edges_tensor generation:  0.010034561157226562
mini_batch_src_global generation:  0.0184173583984375
r_  generation:  0.15838193893432617
local_output_nid generation:  0.008414268493652344
local_in_edges_tensor generation:  0.010164976119995117
mini_batch_src_global generation:  0.01804184913635254
r_  generation:  0.15225434303283691
local_output_nid generation:  0.008519887924194336
local_in_edges_tensor generation:  0.008845806121826172
mini_batch_src_global generation:  0.019243717193603516
r_  generation:  0.1526167392730713
local_output_nid generation:  0.008491754531860352
local_in_edges_tensor generation:  0.010390520095825195
mini_batch_src_global generation:  0.01839280128479004
r_  generation:  0.15232086181640625
local_output_nid generation:  0.008547782897949219
local_in_edges_tensor generation:  0.010181903839111328
mini_batch_src_global generation:  0.019742250442504883
r_  generation:  0.1566472053527832
local_output_nid generation:  0.008126497268676758
local_in_edges_tensor generation:  0.010361433029174805
mini_batch_src_global generation:  0.018820762634277344
r_  generation:  0.15381932258605957
local_output_nid generation:  0.008348941802978516
local_in_edges_tensor generation:  0.009345293045043945
mini_batch_src_global generation:  0.02053046226501465
r_  generation:  0.1570577621459961
local_output_nid generation:  0.00810694694519043
local_in_edges_tensor generation:  0.0117034912109375
mini_batch_src_global generation:  0.022209882736206055
r_  generation:  0.15412545204162598
local_output_nid generation:  0.00915217399597168
local_in_edges_tensor generation:  0.021927356719970703
mini_batch_src_global generation:  0.0244748592376709
r_  generation:  0.16369414329528809
local_output_nid generation:  0.010247468948364258
local_in_edges_tensor generation:  0.010929346084594727
mini_batch_src_global generation:  0.019143104553222656
r_  generation:  0.15485143661499023
local_output_nid generation:  0.008079051971435547
local_in_edges_tensor generation:  0.009082317352294922
mini_batch_src_global generation:  0.018154382705688477
r_  generation:  0.14720606803894043
local_output_nid generation:  0.008313894271850586
local_in_edges_tensor generation:  0.010079622268676758
mini_batch_src_global generation:  0.019977331161499023
r_  generation:  0.15523719787597656
local_output_nid generation:  0.008312463760375977
local_in_edges_tensor generation:  0.01031041145324707
mini_batch_src_global generation:  0.01874709129333496
r_  generation:  0.15404295921325684
local_output_nid generation:  0.008367061614990234
local_in_edges_tensor generation:  0.011558771133422852
mini_batch_src_global generation:  0.018724441528320312
r_  generation:  0.1542201042175293
local_output_nid generation:  0.008373498916625977
local_in_edges_tensor generation:  0.013014793395996094
mini_batch_src_global generation:  0.019953012466430664
r_  generation:  0.15697908401489258
local_output_nid generation:  0.008485555648803711
local_in_edges_tensor generation:  0.009057998657226562
mini_batch_src_global generation:  0.01884937286376953
r_  generation:  0.1522057056427002
local_output_nid generation:  0.008362531661987305
local_in_edges_tensor generation:  0.011014699935913086
mini_batch_src_global generation:  0.01988697052001953
r_  generation:  0.15532708168029785
local_output_nid generation:  0.008194446563720703
local_in_edges_tensor generation:  0.009101390838623047
mini_batch_src_global generation:  0.01860976219177246
r_  generation:  0.15123367309570312
----------------------check_connections_block total spend ----------------------------- 7.238444089889526
generate_one_block  0.19596576690673828
generate_one_block  0.17562508583068848
generate_one_block  0.18035554885864258
generate_one_block  0.18809843063354492
generate_one_block  0.20892024040222168
generate_one_block  0.19154763221740723
generate_one_block  0.20156240463256836
generate_one_block  0.19184374809265137
generate_one_block  0.1862170696258545
generate_one_block  0.18518662452697754
generate_one_block  0.18808269500732422
generate_one_block  0.19101715087890625
generate_one_block  0.19669032096862793
generate_one_block  0.18456697463989258
generate_one_block  0.1863408088684082
generate_one_block  0.18561053276062012
generate_one_block  0.19221186637878418
generate_one_block  0.18591904640197754
generate_one_block  0.18954801559448242
generate_one_block  0.22672033309936523
generate_one_block  0.19785118103027344
generate_one_block  0.19353747367858887
generate_one_block  0.18861079216003418
generate_one_block  0.18514180183410645
generate_one_block  0.18153882026672363
generate_one_block  0.19075250625610352
generate_one_block  0.1937406063079834
generate_one_block  0.1883697509765625
generate_one_block  0.19933748245239258
generate_one_block  0.18359375
generate_one_block  0.18954014778137207
generate_one_block  0.18478918075561523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05032920837402344
gen group dst list time:  0.1009221076965332
time for parepare:  0.017754554748535156
local_output_nid generation:  0.0221407413482666
local_in_edges_tensor generation:  0.05615711212158203
mini_batch_src_global generation:  0.04068326950073242
r_  generation:  0.40271782875061035
local_output_nid generation:  0.028718233108520508
local_in_edges_tensor generation:  0.04156088829040527
mini_batch_src_global generation:  0.04683971405029297
r_  generation:  0.398514986038208
local_output_nid generation:  0.028877973556518555
local_in_edges_tensor generation:  0.034470558166503906
mini_batch_src_global generation:  0.05105710029602051
r_  generation:  0.4040944576263428
local_output_nid generation:  0.02694559097290039
local_in_edges_tensor generation:  0.03115057945251465
mini_batch_src_global generation:  0.05132603645324707
r_  generation:  0.4160020351409912
local_output_nid generation:  0.02668166160583496
local_in_edges_tensor generation:  0.027625560760498047
mini_batch_src_global generation:  0.04878664016723633
r_  generation:  0.4183378219604492
local_output_nid generation:  0.027274370193481445
local_in_edges_tensor generation:  0.03875732421875
mini_batch_src_global generation:  0.04955601692199707
r_  generation:  0.4195590019226074
local_output_nid generation:  0.027194499969482422
local_in_edges_tensor generation:  0.032073974609375
mini_batch_src_global generation:  0.051193952560424805
r_  generation:  0.418407678604126
local_output_nid generation:  0.028565168380737305
local_in_edges_tensor generation:  0.031445980072021484
mini_batch_src_global generation:  0.05217146873474121
r_  generation:  0.4342653751373291
local_output_nid generation:  0.027460336685180664
local_in_edges_tensor generation:  0.03605961799621582
mini_batch_src_global generation:  0.05130577087402344
r_  generation:  0.42481184005737305
local_output_nid generation:  0.029373645782470703
local_in_edges_tensor generation:  0.035408735275268555
mini_batch_src_global generation:  0.048778533935546875
r_  generation:  0.4113197326660156
local_output_nid generation:  0.029956579208374023
local_in_edges_tensor generation:  0.036039113998413086
mini_batch_src_global generation:  0.04926300048828125
r_  generation:  0.4148902893066406
local_output_nid generation:  0.02759695053100586
local_in_edges_tensor generation:  0.027159929275512695
mini_batch_src_global generation:  0.05211520195007324
r_  generation:  0.40993404388427734
local_output_nid generation:  0.028486251831054688
local_in_edges_tensor generation:  0.03125953674316406
mini_batch_src_global generation:  0.06790590286254883
r_  generation:  0.42108154296875
local_output_nid generation:  0.027689218521118164
local_in_edges_tensor generation:  0.030400991439819336
mini_batch_src_global generation:  0.04925346374511719
r_  generation:  0.4088602066040039
local_output_nid generation:  0.027867555618286133
local_in_edges_tensor generation:  0.03165698051452637
mini_batch_src_global generation:  0.05158805847167969
r_  generation:  0.4152541160583496
local_output_nid generation:  0.027814149856567383
local_in_edges_tensor generation:  0.030625581741333008
mini_batch_src_global generation:  0.04955124855041504
r_  generation:  0.4144439697265625
local_output_nid generation:  0.027730226516723633
local_in_edges_tensor generation:  0.030928373336791992
mini_batch_src_global generation:  0.05152153968811035
r_  generation:  0.4157721996307373
local_output_nid generation:  0.0275876522064209
local_in_edges_tensor generation:  0.02860879898071289
mini_batch_src_global generation:  0.04883694648742676
r_  generation:  0.41034579277038574
local_output_nid generation:  0.02822589874267578
local_in_edges_tensor generation:  0.03123760223388672
mini_batch_src_global generation:  0.04841947555541992
r_  generation:  0.41554760932922363
local_output_nid generation:  0.0280916690826416
local_in_edges_tensor generation:  0.03490257263183594
mini_batch_src_global generation:  0.048247575759887695
r_  generation:  0.4111959934234619
local_output_nid generation:  0.028371572494506836
local_in_edges_tensor generation:  0.03512144088745117
mini_batch_src_global generation:  0.04814457893371582
r_  generation:  0.42463135719299316
local_output_nid generation:  0.0282132625579834
local_in_edges_tensor generation:  0.039017438888549805
mini_batch_src_global generation:  0.04917263984680176
r_  generation:  0.41489362716674805
local_output_nid generation:  0.028085947036743164
local_in_edges_tensor generation:  0.028275728225708008
mini_batch_src_global generation:  0.047872304916381836
r_  generation:  0.41498732566833496
local_output_nid generation:  0.02798938751220703
local_in_edges_tensor generation:  0.027330636978149414
mini_batch_src_global generation:  0.05136442184448242
r_  generation:  0.41291189193725586
local_output_nid generation:  0.028748273849487305
local_in_edges_tensor generation:  0.039170026779174805
mini_batch_src_global generation:  0.04911327362060547
r_  generation:  0.40894556045532227
local_output_nid generation:  0.028658390045166016
local_in_edges_tensor generation:  0.029270410537719727
mini_batch_src_global generation:  0.05210280418395996
r_  generation:  0.41965293884277344
local_output_nid generation:  0.028233051300048828
local_in_edges_tensor generation:  0.0289309024810791
mini_batch_src_global generation:  0.048134803771972656
r_  generation:  0.41608738899230957
local_output_nid generation:  0.028577804565429688
local_in_edges_tensor generation:  0.02958369255065918
mini_batch_src_global generation:  0.05390429496765137
r_  generation:  0.42516231536865234
local_output_nid generation:  0.02832484245300293
local_in_edges_tensor generation:  0.036102294921875
mini_batch_src_global generation:  0.06758451461791992
r_  generation:  0.43203091621398926
local_output_nid generation:  0.02947545051574707
local_in_edges_tensor generation:  0.034529685974121094
mini_batch_src_global generation:  0.04992938041687012
r_  generation:  0.4129214286804199
local_output_nid generation:  0.028084278106689453
local_in_edges_tensor generation:  0.030682086944580078
mini_batch_src_global generation:  0.048653602600097656
r_  generation:  0.4190709590911865
local_output_nid generation:  0.028025388717651367
local_in_edges_tensor generation:  0.025441408157348633
mini_batch_src_global generation:  0.05034184455871582
r_  generation:  0.4161534309387207
----------------------check_connections_block total spend ----------------------------- 19.778966188430786
generate_one_block  0.5413331985473633
generate_one_block  0.545325756072998
generate_one_block  0.5318467617034912
generate_one_block  0.5442302227020264
generate_one_block  0.6360986232757568
generate_one_block  0.5458488464355469
generate_one_block  0.5373311042785645
generate_one_block  0.5751581192016602
generate_one_block  0.5540986061096191
generate_one_block  0.5441792011260986
generate_one_block  0.5373225212097168
generate_one_block  0.5275118350982666
generate_one_block  0.550692081451416
generate_one_block  0.5200436115264893
generate_one_block  0.527238130569458
generate_one_block  0.5225865840911865
generate_one_block  0.5417594909667969
generate_one_block  0.5723147392272949
generate_one_block  0.5854299068450928
generate_one_block  0.5336434841156006
generate_one_block  0.5705835819244385
generate_one_block  0.558786153793335
generate_one_block  0.5328781604766846
generate_one_block  0.5287888050079346
generate_one_block  0.5542747974395752
generate_one_block  0.5555086135864258
generate_one_block  0.5369465351104736
generate_one_block  0.5553958415985107
generate_one_block  0.5480096340179443
generate_one_block  0.5315027236938477
generate_one_block  0.5289700031280518
generate_one_block  0.539304256439209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.11260080337524414  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

connection checking time:  27.017410278320312
block generation total time  23.623775720596313
average batch blocks generation time:  0.7382429912686348
block dataloader generation time/epoch 53.36376619338989
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485746383666992  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146147, 128])
torch.Size([102385, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15388917922973633  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08370208740234375  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145859, 128])
torch.Size([101065, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1512436866760254  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0838003158569336  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145910, 128])
torch.Size([101626, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1524338722229004  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146686, 128])
torch.Size([102805, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15401029586791992  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146366, 128])
torch.Size([102219, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15386724472045898  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485984802246094  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146420, 128])
torch.Size([102389, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15394830703735352  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486270904541016  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146234, 128])
torch.Size([102373, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539301872253418  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145950, 128])
torch.Size([102622, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15406513214111328  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146231, 128])
torch.Size([101918, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15367364883422852  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146349, 128])
torch.Size([102184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538071632385254  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146809, 128])
torch.Size([103317, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15416240692138672  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146354, 128])
torch.Size([101955, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15383338928222656  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146587, 128])
torch.Size([102997, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15430307388305664  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145992, 128])
torch.Size([101689, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1536402702331543  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146172, 128])
torch.Size([102360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15382146835327148  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0848550796508789  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146028, 128])
torch.Size([101665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15360164642333984  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146520, 128])
torch.Size([102434, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15391016006469727  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145961, 128])
torch.Size([101609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15361595153808594  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146603, 128])
torch.Size([102648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15404176712036133  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146671, 128])
torch.Size([102171, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15389394760131836  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486652374267578  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146126, 128])
torch.Size([102677, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15421533584594727  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146411, 128])
torch.Size([102557, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1540083885192871  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486366271972656  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146603, 128])
torch.Size([102368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15398311614990234  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([145808, 128])
torch.Size([101580, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15362262725830078  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08378791809082031  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146250, 128])
torch.Size([101073, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1523752212524414  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485984802246094  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146900, 128])
torch.Size([103772, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1543121337890625  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485794067382812  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146303, 128])
torch.Size([102107, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15381431579589844  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485889434814453  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146636, 128])
torch.Size([103095, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1541123390197754  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486270904541016  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146801, 128])
torch.Size([103107, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15418100357055664  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485698699951172  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146513, 128])
torch.Size([101889, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537647247314453  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146202, 128])
torch.Size([101917, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538105010986328  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485126495361328  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

torch.Size([146764, 128])
torch.Size([102357, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537642478942871  GigaBytes
Max Memory Allocated: 0.16944122314453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02351360023021698 |0.013697996735572815 |0.0034808292984962463 |9.107589721679688e-05 |0.00407245010137558 |0.0030679702758789062 |
----------------------------------------------------------pseudo_mini_loss sum 4.347618103027344
Total (block generation + training)time/epoch 54.843207120895386
Training time/epoch 1.4791407585144043
Training time without block to device /epoch 1.0408048629760742
Training time without total dataloading part /epoch 0.24768733978271484
load block tensor time/epoch 0.7524352073669434
block to device time/epoch 0.4383358955383301
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8795255
Number of first layer input nodes during this epoch:  4683166
