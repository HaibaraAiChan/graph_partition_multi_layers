Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648478062.367307
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024212121963500977
random selection method range initialization spend 0.0064280033111572266
time for parepare:  0.018622398376464844
local_output_nid generation:  0.002146482467651367
local_in_edges_tensor generation:  0.004717588424682617
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.017949581146240234
local_output_nid generation:  0.002568483352661133
local_in_edges_tensor generation:  0.0017096996307373047
mini_batch_src_global generation:  0.0021512508392333984
r_  generation:  0.017863035202026367
local_output_nid generation:  0.0027925968170166016
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.0012831687927246094
r_  generation:  0.017467737197875977
local_output_nid generation:  0.0028362274169921875
local_in_edges_tensor generation:  0.0015072822570800781
mini_batch_src_global generation:  0.0013904571533203125
r_  generation:  0.017948150634765625
local_output_nid generation:  0.002828836441040039
local_in_edges_tensor generation:  0.0015094280242919922
mini_batch_src_global generation:  0.0014274120330810547
r_  generation:  0.018177032470703125
local_output_nid generation:  0.002827167510986328
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0014455318450927734
r_  generation:  0.01821613311767578
local_output_nid generation:  0.002868175506591797
local_in_edges_tensor generation:  0.001451253890991211
mini_batch_src_global generation:  0.0015187263488769531
r_  generation:  0.018666982650756836
local_output_nid generation:  0.0028498172760009766
local_in_edges_tensor generation:  0.0015134811401367188
mini_batch_src_global generation:  0.0014834403991699219
r_  generation:  0.0189969539642334
local_output_nid generation:  0.002820730209350586
local_in_edges_tensor generation:  0.001455068588256836
mini_batch_src_global generation:  0.00140380859375
r_  generation:  0.019006967544555664
local_output_nid generation:  0.0028841495513916016
local_in_edges_tensor generation:  0.0015630722045898438
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.01903986930847168
local_output_nid generation:  0.0028209686279296875
local_in_edges_tensor generation:  0.0014624595642089844
mini_batch_src_global generation:  0.0014586448669433594
r_  generation:  0.019024133682250977
local_output_nid generation:  0.002931833267211914
local_in_edges_tensor generation:  0.001537322998046875
mini_batch_src_global generation:  0.001562356948852539
r_  generation:  0.019151687622070312
local_output_nid generation:  0.0028390884399414062
local_in_edges_tensor generation:  0.001474618911743164
mini_batch_src_global generation:  0.0014872550964355469
r_  generation:  0.018958330154418945
local_output_nid generation:  0.0029222965240478516
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.0189516544342041
local_output_nid generation:  0.0029129981994628906
local_in_edges_tensor generation:  0.0015087127685546875
mini_batch_src_global generation:  0.0015506744384765625
r_  generation:  0.018821001052856445
local_output_nid generation:  0.0028235912322998047
local_in_edges_tensor generation:  0.0015141963958740234
mini_batch_src_global generation:  0.0014848709106445312
r_  generation:  0.01948404312133789
----------------------check_connections_block total spend ----------------------------- 0.49077677726745605
generate_one_block  0.027310848236083984
generate_one_block  0.02774977684020996
generate_one_block  0.030153274536132812
generate_one_block  0.0279083251953125
generate_one_block  0.028178930282592773
generate_one_block  0.02718186378479004
generate_one_block  0.02747941017150879
generate_one_block  0.02801990509033203
generate_one_block  0.027986764907836914
generate_one_block  0.02793407440185547
generate_one_block  0.028128862380981445
generate_one_block  0.02829766273498535
generate_one_block  0.027574539184570312
generate_one_block  0.027528762817382812
generate_one_block  0.02822089195251465
generate_one_block  0.028522729873657227
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0405580997467041
gen group dst list time:  0.01880359649658203
time for parepare:  0.01886892318725586
local_output_nid generation:  0.008278608322143555
local_in_edges_tensor generation:  0.01771855354309082
mini_batch_src_global generation:  0.0198516845703125
r_  generation:  0.19557547569274902
local_output_nid generation:  0.01207876205444336
local_in_edges_tensor generation:  0.01981520652770996
mini_batch_src_global generation:  0.025243282318115234
r_  generation:  0.20231962203979492
local_output_nid generation:  0.011727333068847656
local_in_edges_tensor generation:  0.015749454498291016
mini_batch_src_global generation:  0.02409958839416504
r_  generation:  0.20780515670776367
local_output_nid generation:  0.011788129806518555
local_in_edges_tensor generation:  0.015712738037109375
mini_batch_src_global generation:  0.02655172348022461
r_  generation:  0.21027088165283203
local_output_nid generation:  0.012251138687133789
local_in_edges_tensor generation:  0.014963150024414062
mini_batch_src_global generation:  0.028305768966674805
r_  generation:  0.22023940086364746
local_output_nid generation:  0.011893749237060547
local_in_edges_tensor generation:  0.012550830841064453
mini_batch_src_global generation:  0.02881908416748047
r_  generation:  0.21046018600463867
local_output_nid generation:  0.012058258056640625
local_in_edges_tensor generation:  0.012756824493408203
mini_batch_src_global generation:  0.028632402420043945
r_  generation:  0.21355414390563965
local_output_nid generation:  0.012109041213989258
local_in_edges_tensor generation:  0.01815652847290039
mini_batch_src_global generation:  0.03271913528442383
r_  generation:  0.2173607349395752
local_output_nid generation:  0.011978626251220703
local_in_edges_tensor generation:  0.012649059295654297
mini_batch_src_global generation:  0.02781534194946289
r_  generation:  0.21395468711853027
local_output_nid generation:  0.01192617416381836
local_in_edges_tensor generation:  0.014142751693725586
mini_batch_src_global generation:  0.0274355411529541
r_  generation:  0.21667027473449707
local_output_nid generation:  0.01200103759765625
local_in_edges_tensor generation:  0.018085241317749023
mini_batch_src_global generation:  0.02769160270690918
r_  generation:  0.21653413772583008
local_output_nid generation:  0.01190638542175293
local_in_edges_tensor generation:  0.01241612434387207
mini_batch_src_global generation:  0.03337597846984863
r_  generation:  0.2199852466583252
local_output_nid generation:  0.011899471282958984
local_in_edges_tensor generation:  0.014123201370239258
mini_batch_src_global generation:  0.027575254440307617
r_  generation:  0.2157118320465088
local_output_nid generation:  0.011767148971557617
local_in_edges_tensor generation:  0.014094352722167969
mini_batch_src_global generation:  0.027283191680908203
r_  generation:  0.21277379989624023
local_output_nid generation:  0.011878728866577148
local_in_edges_tensor generation:  0.01392674446105957
mini_batch_src_global generation:  0.027692079544067383
r_  generation:  0.21591663360595703
local_output_nid generation:  0.012054920196533203
local_in_edges_tensor generation:  0.02000880241394043
mini_batch_src_global generation:  0.027773141860961914
r_  generation:  0.22171974182128906
----------------------check_connections_block total spend ----------------------------- 5.055952787399292
generate_one_block  0.28074193000793457
generate_one_block  0.27393078804016113
generate_one_block  0.2785501480102539
generate_one_block  0.2795600891113281
generate_one_block  0.30975818634033203
generate_one_block  0.26983094215393066
generate_one_block  0.2785818576812744
generate_one_block  0.2847707271575928
generate_one_block  0.27553820610046387
generate_one_block  0.28166651725769043
generate_one_block  0.2842872142791748
generate_one_block  0.2846527099609375
generate_one_block  0.27679896354675293
generate_one_block  0.2739853858947754
generate_one_block  0.2865135669708252
generate_one_block  0.29045867919921875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03461170196533203
gen group dst list time:  0.06396198272705078
time for parepare:  0.020842790603637695
local_output_nid generation:  0.025959491729736328
local_in_edges_tensor generation:  0.040001869201660156
mini_batch_src_global generation:  0.04829001426696777
r_  generation:  0.47130918502807617
local_output_nid generation:  0.030694007873535156
local_in_edges_tensor generation:  0.0481107234954834
mini_batch_src_global generation:  0.055107831954956055
r_  generation:  0.4790496826171875
local_output_nid generation:  0.030852079391479492
local_in_edges_tensor generation:  0.03592514991760254
mini_batch_src_global generation:  0.0580594539642334
r_  generation:  0.4928629398345947
local_output_nid generation:  0.03078746795654297
local_in_edges_tensor generation:  0.0428318977355957
mini_batch_src_global generation:  0.06079983711242676
r_  generation:  0.487168550491333
local_output_nid generation:  0.030802011489868164
local_in_edges_tensor generation:  0.038539886474609375
mini_batch_src_global generation:  0.05617475509643555
r_  generation:  0.49710536003112793
local_output_nid generation:  0.03120112419128418
local_in_edges_tensor generation:  0.03075265884399414
mini_batch_src_global generation:  0.05820131301879883
r_  generation:  0.49748659133911133
local_output_nid generation:  0.03129887580871582
local_in_edges_tensor generation:  0.03738141059875488
mini_batch_src_global generation:  0.05677056312561035
r_  generation:  0.4951193332672119
local_output_nid generation:  0.031583309173583984
local_in_edges_tensor generation:  0.0384368896484375
mini_batch_src_global generation:  0.05892229080200195
r_  generation:  0.4940793514251709
local_output_nid generation:  0.03174877166748047
local_in_edges_tensor generation:  0.03874707221984863
mini_batch_src_global generation:  0.058440208435058594
r_  generation:  0.49834465980529785
local_output_nid generation:  0.031404972076416016
local_in_edges_tensor generation:  0.04129672050476074
mini_batch_src_global generation:  0.06148552894592285
r_  generation:  0.4884064197540283
local_output_nid generation:  0.031548261642456055
local_in_edges_tensor generation:  0.0362095832824707
mini_batch_src_global generation:  0.05779123306274414
r_  generation:  0.49584031105041504
local_output_nid generation:  0.03502035140991211
local_in_edges_tensor generation:  0.03487062454223633
mini_batch_src_global generation:  0.06689310073852539
r_  generation:  0.48969364166259766
local_output_nid generation:  0.031881093978881836
local_in_edges_tensor generation:  0.03813815116882324
mini_batch_src_global generation:  0.05629277229309082
r_  generation:  0.4965999126434326
local_output_nid generation:  0.03202319145202637
local_in_edges_tensor generation:  0.030671119689941406
mini_batch_src_global generation:  0.05836224555969238
r_  generation:  0.4956533908843994
local_output_nid generation:  0.03414177894592285
local_in_edges_tensor generation:  0.034119367599487305
mini_batch_src_global generation:  0.05796480178833008
r_  generation:  0.498837947845459
local_output_nid generation:  0.031932830810546875
local_in_edges_tensor generation:  0.042688608169555664
mini_batch_src_global generation:  0.06125926971435547
r_  generation:  0.4907045364379883
----------------------check_connections_block total spend ----------------------------- 11.629829168319702
generate_one_block  0.630418062210083
generate_one_block  0.6192140579223633
generate_one_block  0.6427066326141357
generate_one_block  0.6367120742797852
generate_one_block  0.6440165042877197
generate_one_block  0.6332755088806152
generate_one_block  0.6819074153900146
generate_one_block  0.6474552154541016
generate_one_block  0.6393101215362549
generate_one_block  0.6364920139312744
generate_one_block  0.6360838413238525
generate_one_block  0.6387734413146973
generate_one_block  0.6344306468963623
generate_one_block  0.62264084815979
generate_one_block  0.635150671005249
generate_one_block  0.6436982154846191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04001903533935547
gen group dst list time:  0.08909296989440918
time for parepare:  0.019694089889526367
local_output_nid generation:  0.033582210540771484
local_in_edges_tensor generation:  0.05339765548706055
mini_batch_src_global generation:  0.044985055923461914
r_  generation:  0.49233174324035645
local_output_nid generation:  0.03891158103942871
local_in_edges_tensor generation:  0.03469514846801758
mini_batch_src_global generation:  0.05610060691833496
r_  generation:  0.49688029289245605
local_output_nid generation:  0.03773331642150879
local_in_edges_tensor generation:  0.04306936264038086
mini_batch_src_global generation:  0.05273914337158203
r_  generation:  0.5111675262451172
local_output_nid generation:  0.03825020790100098
local_in_edges_tensor generation:  0.037862539291381836
mini_batch_src_global generation:  0.052634477615356445
r_  generation:  0.506051778793335
local_output_nid generation:  0.03795671463012695
local_in_edges_tensor generation:  0.04381918907165527
mini_batch_src_global generation:  0.05373954772949219
r_  generation:  0.5106065273284912
local_output_nid generation:  0.03796720504760742
local_in_edges_tensor generation:  0.04372453689575195
mini_batch_src_global generation:  0.05385947227478027
r_  generation:  0.5122926235198975
local_output_nid generation:  0.03817009925842285
local_in_edges_tensor generation:  0.03545999526977539
mini_batch_src_global generation:  0.05499553680419922
r_  generation:  0.5237045288085938
local_output_nid generation:  0.037724971771240234
local_in_edges_tensor generation:  0.045706987380981445
mini_batch_src_global generation:  0.055425167083740234
r_  generation:  0.5133481025695801
local_output_nid generation:  0.03802371025085449
local_in_edges_tensor generation:  0.03859353065490723
mini_batch_src_global generation:  0.05815863609313965
r_  generation:  0.5185530185699463
local_output_nid generation:  0.038053035736083984
local_in_edges_tensor generation:  0.03931307792663574
mini_batch_src_global generation:  0.05548357963562012
r_  generation:  0.517716646194458
local_output_nid generation:  0.03806352615356445
local_in_edges_tensor generation:  0.04307103157043457
mini_batch_src_global generation:  0.05569624900817871
r_  generation:  0.5341768264770508
local_output_nid generation:  0.03804135322570801
local_in_edges_tensor generation:  0.03843975067138672
mini_batch_src_global generation:  0.05573272705078125
r_  generation:  0.5184381008148193
local_output_nid generation:  0.03842306137084961
local_in_edges_tensor generation:  0.03857874870300293
mini_batch_src_global generation:  0.05965280532836914
r_  generation:  0.5225846767425537
local_output_nid generation:  0.03795456886291504
local_in_edges_tensor generation:  0.038991451263427734
mini_batch_src_global generation:  0.05632972717285156
r_  generation:  0.5229740142822266
local_output_nid generation:  0.03809213638305664
local_in_edges_tensor generation:  0.039132118225097656
mini_batch_src_global generation:  0.06845474243164062
r_  generation:  0.5241317749023438
local_output_nid generation:  0.038088321685791016
local_in_edges_tensor generation:  0.0436246395111084
mini_batch_src_global generation:  0.05713319778442383
r_  generation:  0.5198571681976318
----------------------check_connections_block total spend ----------------------------- 12.333762168884277
generate_one_block  0.64689040184021
generate_one_block  0.7047896385192871
generate_one_block  0.6402645111083984
generate_one_block  0.6445019245147705
generate_one_block  0.6412415504455566
generate_one_block  0.6404016017913818
generate_one_block  0.6302103996276855
generate_one_block  0.6308126449584961
generate_one_block  0.6412701606750488
generate_one_block  0.6358096599578857
generate_one_block  0.6244628429412842
generate_one_block  0.6211202144622803
generate_one_block  0.631648063659668
generate_one_block  0.6510875225067139
generate_one_block  0.618384599685669
generate_one_block  0.6275584697723389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

connection checking time:  29.01954412460327
block generation total time  24.96236538887024
average batch blocks generation time:  1.56014783680439
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10663795471191406  GigaBytes
Max Memory Allocated: 0.10663795471191406  GigaBytes

torch.Size([163624, 128])
torch.Size([155475, 32])
torch.Size([123365, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.2887730598449707  GigaBytes
Max Memory Allocated: 0.2908811569213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10739850997924805  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163544, 128])
torch.Size([155293, 32])
torch.Size([122832, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2840852737426758  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10744524002075195  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163605, 128])
torch.Size([155474, 32])
torch.Size([123451, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2843456268310547  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10750532150268555  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163666, 128])
torch.Size([155460, 32])
torch.Size([123691, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28441762924194336  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10771989822387695  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163689, 128])
torch.Size([155738, 32])
torch.Size([124340, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2883157730102539  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10740804672241211  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163706, 128])
torch.Size([155621, 32])
torch.Size([123731, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2844991683959961  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10749578475952148  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163564, 128])
torch.Size([155383, 32])
torch.Size([123246, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2841653823852539  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10766839981079102  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163643, 128])
torch.Size([155630, 32])
torch.Size([124606, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.285214900970459  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10751485824584961  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163746, 128])
torch.Size([155757, 32])
torch.Size([123957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28756284713745117  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10752344131469727  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163710, 128])
torch.Size([155630, 32])
torch.Size([123877, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2846651077270508  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10760831832885742  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163626, 128])
torch.Size([155521, 32])
torch.Size([123886, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2846865653991699  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10756731033325195  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163601, 128])
torch.Size([155405, 32])
torch.Size([123649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2845001220703125  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10756063461303711  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163649, 128])
torch.Size([155409, 32])
torch.Size([123611, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2843475341796875  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10743093490600586  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163763, 128])
torch.Size([155935, 32])
torch.Size([123943, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28728246688842773  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1075282096862793  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163594, 128])
torch.Size([155354, 32])
torch.Size([123543, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28433752059936523  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10763311386108398  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163562, 128])
torch.Size([155304, 32])
torch.Size([123480, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2844581604003906  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041605010628700256 |0.04390209913253784 |0.0490398108959198 |9.997189044952393e-05 |0.011585861444473267 |0.0021905899047851562 |
----------------------------------------------------------pseudo_mini_loss sum 5.1793670654296875
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7746428
Number of first layer input nodes during this epoch:  2618292
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1678781509399414  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02260565757751465
random selection method range initialization spend 0.005734682083129883
time for parepare:  0.016782283782958984
local_output_nid generation:  0.0023915767669677734
local_in_edges_tensor generation:  0.0073392391204833984
mini_batch_src_global generation:  0.0016143321990966797
r_  generation:  0.018312692642211914
local_output_nid generation:  0.002803325653076172
local_in_edges_tensor generation:  0.0016574859619140625
mini_batch_src_global generation:  0.0021390914916992188
r_  generation:  0.021518468856811523
local_output_nid generation:  0.002936840057373047
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0013930797576904297
r_  generation:  0.018294572830200195
local_output_nid generation:  0.0028836727142333984
local_in_edges_tensor generation:  0.001501321792602539
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.018471240997314453
local_output_nid generation:  0.0029222965240478516
local_in_edges_tensor generation:  0.0014934539794921875
mini_batch_src_global generation:  0.0014338493347167969
r_  generation:  0.019176483154296875
local_output_nid generation:  0.002939462661743164
local_in_edges_tensor generation:  0.0014886856079101562
mini_batch_src_global generation:  0.0014431476593017578
r_  generation:  0.018666744232177734
local_output_nid generation:  0.0028760433197021484
local_in_edges_tensor generation:  0.0014452934265136719
mini_batch_src_global generation:  0.0015032291412353516
r_  generation:  0.019144535064697266
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.0015773773193359375
mini_batch_src_global generation:  0.0015020370483398438
r_  generation:  0.01957845687866211
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0015137195587158203
mini_batch_src_global generation:  0.0015060901641845703
r_  generation:  0.02152228355407715
local_output_nid generation:  0.00293731689453125
local_in_edges_tensor generation:  0.0014989376068115234
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.01954960823059082
local_output_nid generation:  0.002942323684692383
local_in_edges_tensor generation:  0.001459360122680664
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.0195920467376709
local_output_nid generation:  0.00298309326171875
local_in_edges_tensor generation:  0.0015192031860351562
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.019308805465698242
local_output_nid generation:  0.0029337406158447266
local_in_edges_tensor generation:  0.0014524459838867188
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.0219876766204834
local_output_nid generation:  0.002937793731689453
local_in_edges_tensor generation:  0.0014641284942626953
mini_batch_src_global generation:  0.0015091896057128906
r_  generation:  0.0196988582611084
local_output_nid generation:  0.0029497146606445312
local_in_edges_tensor generation:  0.0014538764953613281
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.019879817962646484
local_output_nid generation:  0.0029180049896240234
local_in_edges_tensor generation:  0.0014727115631103516
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.0203857421875
----------------------check_connections_block total spend ----------------------------- 0.5121254920959473
generate_one_block  0.040816307067871094
generate_one_block  0.02816629409790039
generate_one_block  0.027092933654785156
generate_one_block  0.027727127075195312
generate_one_block  0.027728796005249023
generate_one_block  0.02993297576904297
generate_one_block  0.027943134307861328
generate_one_block  0.030457496643066406
generate_one_block  0.030814409255981445
generate_one_block  0.029180049896240234
generate_one_block  0.03614950180053711
generate_one_block  0.028796672821044922
generate_one_block  0.02851724624633789
generate_one_block  0.02776503562927246
generate_one_block  0.027887344360351562
generate_one_block  0.028360605239868164
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.050406455993652344
gen group dst list time:  0.02028656005859375
time for parepare:  0.02309870719909668
local_output_nid generation:  0.011388063430786133
local_in_edges_tensor generation:  0.022175312042236328
mini_batch_src_global generation:  0.020325183868408203
r_  generation:  0.20095562934875488
local_output_nid generation:  0.016146421432495117
local_in_edges_tensor generation:  0.021163225173950195
mini_batch_src_global generation:  0.025312423706054688
r_  generation:  0.2070026397705078
local_output_nid generation:  0.015995264053344727
local_in_edges_tensor generation:  0.015473127365112305
mini_batch_src_global generation:  0.023615360260009766
r_  generation:  0.21018671989440918
local_output_nid generation:  0.015642404556274414
local_in_edges_tensor generation:  0.02140331268310547
mini_batch_src_global generation:  0.025162696838378906
r_  generation:  0.21478652954101562
local_output_nid generation:  0.015893936157226562
local_in_edges_tensor generation:  0.014162302017211914
mini_batch_src_global generation:  0.02624058723449707
r_  generation:  0.21831703186035156
local_output_nid generation:  0.016501426696777344
local_in_edges_tensor generation:  0.013725996017456055
mini_batch_src_global generation:  0.02632904052734375
r_  generation:  0.21461915969848633
local_output_nid generation:  0.016355514526367188
local_in_edges_tensor generation:  0.015473604202270508
mini_batch_src_global generation:  0.02660226821899414
r_  generation:  0.21964287757873535
local_output_nid generation:  0.016750812530517578
local_in_edges_tensor generation:  0.01948237419128418
mini_batch_src_global generation:  0.028758764266967773
r_  generation:  0.22287487983703613
local_output_nid generation:  0.016332149505615234
local_in_edges_tensor generation:  0.015280961990356445
mini_batch_src_global generation:  0.029223203659057617
r_  generation:  0.22346782684326172
local_output_nid generation:  0.0160524845123291
local_in_edges_tensor generation:  0.014041900634765625
mini_batch_src_global generation:  0.027554988861083984
r_  generation:  0.22300171852111816
local_output_nid generation:  0.01576852798461914
local_in_edges_tensor generation:  0.01367044448852539
mini_batch_src_global generation:  0.028640031814575195
r_  generation:  0.23061299324035645
local_output_nid generation:  0.015970706939697266
local_in_edges_tensor generation:  0.015283584594726562
mini_batch_src_global generation:  0.027349472045898438
r_  generation:  0.22142553329467773
local_output_nid generation:  0.015897035598754883
local_in_edges_tensor generation:  0.015577077865600586
mini_batch_src_global generation:  0.026585817337036133
r_  generation:  0.2216484546661377
local_output_nid generation:  0.01569962501525879
local_in_edges_tensor generation:  0.015319585800170898
mini_batch_src_global generation:  0.028873682022094727
r_  generation:  0.21865081787109375
local_output_nid generation:  0.01617264747619629
local_in_edges_tensor generation:  0.017271995544433594
mini_batch_src_global generation:  0.028685808181762695
r_  generation:  0.22518110275268555
local_output_nid generation:  0.016306638717651367
local_in_edges_tensor generation:  0.019496917724609375
mini_batch_src_global generation:  0.0288238525390625
r_  generation:  0.22663402557373047
----------------------check_connections_block total spend ----------------------------- 5.231809854507446
generate_one_block  0.2983722686767578
generate_one_block  0.28328824043273926
generate_one_block  0.2899892330169678
generate_one_block  0.2917046546936035
generate_one_block  0.2967212200164795
generate_one_block  0.2785677909851074
generate_one_block  0.3034789562225342
generate_one_block  0.29140186309814453
generate_one_block  0.2822127342224121
generate_one_block  0.28073549270629883
generate_one_block  0.27493762969970703
generate_one_block  0.279407262802124
generate_one_block  0.2774481773376465
generate_one_block  0.2777111530303955
generate_one_block  0.28515028953552246
generate_one_block  0.29558420181274414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0516207218170166
gen group dst list time:  0.06645655632019043
time for parepare:  0.01916980743408203
local_output_nid generation:  0.026223421096801758
local_in_edges_tensor generation:  0.05859994888305664
mini_batch_src_global generation:  0.05016899108886719
r_  generation:  0.49086666107177734
local_output_nid generation:  0.03320002555847168
local_in_edges_tensor generation:  0.05291414260864258
mini_batch_src_global generation:  0.0561985969543457
r_  generation:  0.4815399646759033
local_output_nid generation:  0.03209066390991211
local_in_edges_tensor generation:  0.03889608383178711
mini_batch_src_global generation:  0.055744171142578125
r_  generation:  0.49486398696899414
local_output_nid generation:  0.03290271759033203
local_in_edges_tensor generation:  0.04587054252624512
mini_batch_src_global generation:  0.05948019027709961
r_  generation:  0.49541807174682617
local_output_nid generation:  0.032213449478149414
local_in_edges_tensor generation:  0.09202289581298828
mini_batch_src_global generation:  0.05611443519592285
r_  generation:  0.5048460960388184
local_output_nid generation:  0.031646728515625
local_in_edges_tensor generation:  0.03346681594848633
mini_batch_src_global generation:  0.05770421028137207
r_  generation:  0.4954690933227539
local_output_nid generation:  0.03131556510925293
local_in_edges_tensor generation:  0.03273439407348633
mini_batch_src_global generation:  0.05606508255004883
r_  generation:  0.5053749084472656
local_output_nid generation:  0.031458139419555664
local_in_edges_tensor generation:  0.041535377502441406
mini_batch_src_global generation:  0.057260751724243164
r_  generation:  0.4984776973724365
local_output_nid generation:  0.03164196014404297
local_in_edges_tensor generation:  0.04142475128173828
mini_batch_src_global generation:  0.05638861656188965
r_  generation:  0.5113461017608643
local_output_nid generation:  0.03189802169799805
local_in_edges_tensor generation:  0.03732895851135254
mini_batch_src_global generation:  0.057403564453125
r_  generation:  0.5001401901245117
local_output_nid generation:  0.03129076957702637
local_in_edges_tensor generation:  0.03667807579040527
mini_batch_src_global generation:  0.056627750396728516
r_  generation:  0.5141608715057373
local_output_nid generation:  0.03155350685119629
local_in_edges_tensor generation:  0.03724169731140137
mini_batch_src_global generation:  0.05697011947631836
r_  generation:  0.49823665618896484
local_output_nid generation:  0.032303571701049805
local_in_edges_tensor generation:  0.032823801040649414
mini_batch_src_global generation:  0.05627012252807617
r_  generation:  0.5063564777374268
local_output_nid generation:  0.03175997734069824
local_in_edges_tensor generation:  0.04009556770324707
mini_batch_src_global generation:  0.060990333557128906
r_  generation:  0.49862217903137207
local_output_nid generation:  0.03157162666320801
local_in_edges_tensor generation:  0.04153895378112793
mini_batch_src_global generation:  0.05641818046569824
r_  generation:  0.5143451690673828
local_output_nid generation:  0.031873464584350586
local_in_edges_tensor generation:  0.04549837112426758
mini_batch_src_global generation:  0.05852055549621582
r_  generation:  0.5220723152160645
----------------------check_connections_block total spend ----------------------------- 11.875072240829468
generate_one_block  0.6712193489074707
generate_one_block  0.6486825942993164
generate_one_block  0.6330056190490723
generate_one_block  0.6424996852874756
generate_one_block  0.6387503147125244
generate_one_block  0.627281665802002
generate_one_block  0.664067268371582
generate_one_block  0.6491649150848389
generate_one_block  0.6693935394287109
generate_one_block  0.6325197219848633
generate_one_block  0.6226596832275391
generate_one_block  0.6490004062652588
generate_one_block  0.622246503829956
generate_one_block  0.6394588947296143
generate_one_block  0.6509227752685547
generate_one_block  0.6449265480041504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0943448543548584
gen group dst list time:  0.09746217727661133
time for parepare:  0.019141674041748047
local_output_nid generation:  0.03367781639099121
local_in_edges_tensor generation:  0.05123472213745117
mini_batch_src_global generation:  0.04463934898376465
r_  generation:  0.48842644691467285
local_output_nid generation:  0.04122495651245117
local_in_edges_tensor generation:  0.03887605667114258
mini_batch_src_global generation:  0.05586719512939453
r_  generation:  0.49063658714294434
local_output_nid generation:  0.04117941856384277
local_in_edges_tensor generation:  0.0369114875793457
mini_batch_src_global generation:  0.05338430404663086
r_  generation:  0.5032355785369873
local_output_nid generation:  0.039496421813964844
local_in_edges_tensor generation:  0.03785085678100586
mini_batch_src_global generation:  0.05293607711791992
r_  generation:  0.503807544708252
local_output_nid generation:  0.03858542442321777
local_in_edges_tensor generation:  0.04241132736206055
mini_batch_src_global generation:  0.05335116386413574
r_  generation:  0.5149967670440674
local_output_nid generation:  0.03943133354187012
local_in_edges_tensor generation:  0.05156850814819336
mini_batch_src_global generation:  0.053763389587402344
r_  generation:  0.5103533267974854
local_output_nid generation:  0.03839564323425293
local_in_edges_tensor generation:  0.03733015060424805
mini_batch_src_global generation:  0.054575443267822266
r_  generation:  0.5223650932312012
local_output_nid generation:  0.03845381736755371
local_in_edges_tensor generation:  0.04580974578857422
mini_batch_src_global generation:  0.05492234230041504
r_  generation:  0.5152926445007324
local_output_nid generation:  0.03854942321777344
local_in_edges_tensor generation:  0.04629921913146973
mini_batch_src_global generation:  0.054264068603515625
r_  generation:  0.517479658126831
local_output_nid generation:  0.03819394111633301
local_in_edges_tensor generation:  0.04569101333618164
mini_batch_src_global generation:  0.05815458297729492
r_  generation:  0.5264670848846436
local_output_nid generation:  0.03815317153930664
local_in_edges_tensor generation:  0.03954148292541504
mini_batch_src_global generation:  0.05474281311035156
r_  generation:  0.5250279903411865
local_output_nid generation:  0.03922438621520996
local_in_edges_tensor generation:  0.04867839813232422
mini_batch_src_global generation:  0.06210637092590332
r_  generation:  0.5166339874267578
local_output_nid generation:  0.03949403762817383
local_in_edges_tensor generation:  0.05068254470825195
mini_batch_src_global generation:  0.055077314376831055
r_  generation:  0.5358023643493652
local_output_nid generation:  0.04156088829040527
local_in_edges_tensor generation:  0.04593062400817871
mini_batch_src_global generation:  0.05676531791687012
r_  generation:  0.5145008563995361
local_output_nid generation:  0.039649009704589844
local_in_edges_tensor generation:  0.0461273193359375
mini_batch_src_global generation:  0.05585885047912598
r_  generation:  0.5206549167633057
local_output_nid generation:  0.03942108154296875
local_in_edges_tensor generation:  0.03737235069274902
mini_batch_src_global generation:  0.05558204650878906
r_  generation:  0.523535966873169
----------------------check_connections_block total spend ----------------------------- 12.356730699539185
generate_one_block  0.6267294883728027
generate_one_block  0.6214027404785156
generate_one_block  0.6307432651519775
generate_one_block  0.6354880332946777
generate_one_block  0.6373147964477539
generate_one_block  0.6330246925354004
generate_one_block  0.689448356628418
generate_one_block  0.6271538734436035
generate_one_block  0.624547004699707
generate_one_block  0.6264445781707764
generate_one_block  0.6198868751525879
generate_one_block  0.6245627403259277
generate_one_block  0.628852367401123
generate_one_block  0.6271827220916748
generate_one_block  0.6339523792266846
generate_one_block  0.6179723739624023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1678781509399414  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

connection checking time:  29.4636127948761
block generation total time  24.997216939926147
average batch blocks generation time:  1.5623260587453842
block dataloader generation time/epoch 57.14815545082092
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10769081115722656  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163651, 128])
torch.Size([155667, 32])
torch.Size([124073, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28792524337768555  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10760164260864258  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163576, 128])
torch.Size([155328, 32])
torch.Size([123262, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28406715393066406  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10761404037475586  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163744, 128])
torch.Size([155568, 32])
torch.Size([123577, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28437328338623047  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10775899887084961  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163727, 128])
torch.Size([155747, 32])
torch.Size([124214, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28807544708251953  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.1077570915222168  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163834, 128])
torch.Size([155789, 32])
torch.Size([124354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2880740165710449  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10755300521850586  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163776, 128])
torch.Size([155630, 32])
torch.Size([123394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28456640243530273  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10764265060424805  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163699, 128])
torch.Size([155398, 32])
torch.Size([123538, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28458166122436523  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10775232315063477  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163388, 128])
torch.Size([155329, 32])
torch.Size([124441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2852191925048828  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10769414901733398  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163520, 128])
torch.Size([155552, 32])
torch.Size([123888, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2847623825073242  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10768938064575195  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163644, 128])
torch.Size([155440, 32])
torch.Size([123996, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2848167419433594  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10759592056274414  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163507, 128])
torch.Size([155274, 32])
torch.Size([123565, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28438425064086914  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10765218734741211  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163567, 128])
torch.Size([155474, 32])
torch.Size([123914, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2847018241882324  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10756444931030273  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163572, 128])
torch.Size([155444, 32])
torch.Size([123601, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2843594551086426  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10760641098022461  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163634, 128])
torch.Size([155567, 32])
torch.Size([124031, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2845463752746582  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.1077113151550293  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163750, 128])
torch.Size([155747, 32])
torch.Size([123720, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28774356842041016  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.10778093338012695  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

torch.Size([163688, 128])
torch.Size([155584, 32])
torch.Size([124169, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.28503942489624023  GigaBytes
Max Memory Allocated: 0.301422119140625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03906078636646271 |0.024018242955207825 |0.0045735836029052734 |9.290874004364014e-05 |0.006316587328910828 |0.0037832260131835938 |
----------------------------------------------------------pseudo_mini_loss sum 4.565314769744873
Total (block generation + training)time/epoch 58.375630617141724
Training time/epoch 1.2271876335144043
Training time without block to device /epoch 0.8428957462310791
Training time without total dataloading part /epoch 0.17951250076293945
load block tensor time/epoch 0.6249725818634033
block to device time/epoch 0.3842918872833252
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7750487
Number of first layer input nodes during this epoch:  2618277
