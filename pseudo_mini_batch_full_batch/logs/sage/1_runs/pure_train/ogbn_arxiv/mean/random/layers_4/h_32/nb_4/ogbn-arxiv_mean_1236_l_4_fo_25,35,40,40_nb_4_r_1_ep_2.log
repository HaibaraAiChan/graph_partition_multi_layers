Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648477940.9228082
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02426886558532715
random selection method range initialization spend 0.0062029361724853516
time for parepare:  0.01821160316467285
local_output_nid generation:  0.008329153060913086
local_in_edges_tensor generation:  0.009023904800415039
mini_batch_src_global generation:  0.006337642669677734
r_  generation:  0.08169412612915039
local_output_nid generation:  0.011773824691772461
local_in_edges_tensor generation:  0.006089687347412109
mini_batch_src_global generation:  0.008553266525268555
r_  generation:  0.08843564987182617
local_output_nid generation:  0.01191091537475586
local_in_edges_tensor generation:  0.006219625473022461
mini_batch_src_global generation:  0.006369352340698242
r_  generation:  0.08990359306335449
local_output_nid generation:  0.011958837509155273
local_in_edges_tensor generation:  0.006216526031494141
mini_batch_src_global generation:  0.007104396820068359
r_  generation:  0.09293246269226074
----------------------check_connections_block total spend ----------------------------- 0.5507845878601074
generate_one_block  0.1028907299041748
generate_one_block  0.10279130935668945
generate_one_block  0.10312175750732422
generate_one_block  0.1032259464263916
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04372811317443848
gen group dst list time:  0.01091623306274414
time for parepare:  0.01983022689819336
local_output_nid generation:  0.020400047302246094
local_in_edges_tensor generation:  0.043488502502441406
mini_batch_src_global generation:  0.04112839698791504
r_  generation:  0.4018716812133789
local_output_nid generation:  0.029826879501342773
local_in_edges_tensor generation:  0.04160618782043457
mini_batch_src_global generation:  0.04694485664367676
r_  generation:  0.41508984565734863
local_output_nid generation:  0.03081655502319336
local_in_edges_tensor generation:  0.03778433799743652
mini_batch_src_global generation:  0.047301292419433594
r_  generation:  0.42595815658569336
local_output_nid generation:  0.03032827377319336
local_in_edges_tensor generation:  0.031699180603027344
mini_batch_src_global generation:  0.04862809181213379
r_  generation:  0.42420363426208496
----------------------check_connections_block total spend ----------------------------- 2.5058319568634033
generate_one_block  0.572580099105835
generate_one_block  0.5611190795898438
generate_one_block  0.5423953533172607
generate_one_block  0.5414903163909912
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03531837463378906
gen group dst list time:  0.020459890365600586
time for parepare:  0.019550085067749023
local_output_nid generation:  0.03133273124694824
local_in_edges_tensor generation:  0.04897141456604004
mini_batch_src_global generation:  0.05302286148071289
r_  generation:  0.5346493721008301
local_output_nid generation:  0.04239630699157715
local_in_edges_tensor generation:  0.05648994445800781
mini_batch_src_global generation:  0.060244083404541016
r_  generation:  0.5372040271759033
local_output_nid generation:  0.04264497756958008
local_in_edges_tensor generation:  0.042632341384887695
mini_batch_src_global generation:  0.056612491607666016
r_  generation:  0.5477337837219238
local_output_nid generation:  0.04346442222595215
local_in_edges_tensor generation:  0.042452096939086914
mini_batch_src_global generation:  0.057662010192871094
r_  generation:  0.5535039901733398
----------------------check_connections_block total spend ----------------------------- 3.2467291355133057
generate_one_block  0.6883275508880615
generate_one_block  0.7019319534301758
generate_one_block  0.692579984664917
generate_one_block  0.7028372287750244
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028917789459228516
gen group dst list time:  0.02320122718811035
time for parepare:  0.018841028213500977
local_output_nid generation:  0.0331730842590332
local_in_edges_tensor generation:  0.044445037841796875
mini_batch_src_global generation:  0.046015262603759766
r_  generation:  0.5130810737609863
local_output_nid generation:  0.03908348083496094
local_in_edges_tensor generation:  0.046332597732543945
mini_batch_src_global generation:  0.05665445327758789
r_  generation:  0.5129516124725342
local_output_nid generation:  0.03900742530822754
local_in_edges_tensor generation:  0.04245924949645996
mini_batch_src_global generation:  0.05718350410461426
r_  generation:  0.5168564319610596
local_output_nid generation:  0.03893589973449707
local_in_edges_tensor generation:  0.04192042350769043
mini_batch_src_global generation:  0.05759716033935547
r_  generation:  0.5196239948272705
----------------------check_connections_block total spend ----------------------------- 3.093851089477539
generate_one_block  0.6447100639343262
generate_one_block  0.6695539951324463
generate_one_block  0.646841287612915
generate_one_block  0.6476974487304688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

connection checking time:  8.846412181854248
block generation total time  7.612064361572266
average batch blocks generation time:  1.9030160903930664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11593198776245117  GigaBytes
Max Memory Allocated: 0.11593198776245117  GigaBytes

torch.Size([166674, 128])
torch.Size([164699, 32])
torch.Size([154946, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.3596506118774414  GigaBytes
Max Memory Allocated: 0.3630385398864746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.12088918685913086  GigaBytes
Max Memory Allocated: 0.3795356750488281  GigaBytes

torch.Size([166682, 128])
torch.Size([164741, 32])
torch.Size([155118, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3624382019042969  GigaBytes
Max Memory Allocated: 0.3795356750488281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.1204986572265625  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

torch.Size([166743, 128])
torch.Size([164709, 32])
torch.Size([154991, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3612184524536133  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.12115621566772461  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

torch.Size([166706, 128])
torch.Size([164701, 32])
torch.Size([154986, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3603248596191406  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03930032253265381 |0.08977627754211426 |0.18263089656829834 |0.0001226663589477539 |0.023164033889770508 |0.004955768585205078 |
----------------------------------------------------------pseudo_mini_loss sum 5.100244522094727
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351325
Number of first layer input nodes during this epoch:  666805
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.19713211059570312  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.01809835433959961
random selection method range initialization spend 0.005693912506103516
time for parepare:  0.018982887268066406
local_output_nid generation:  0.008621454238891602
local_in_edges_tensor generation:  0.009193897247314453
mini_batch_src_global generation:  0.0063245296478271484
r_  generation:  0.08037924766540527
local_output_nid generation:  0.013704776763916016
local_in_edges_tensor generation:  0.006005048751831055
mini_batch_src_global generation:  0.008137226104736328
r_  generation:  0.08634305000305176
local_output_nid generation:  0.013920783996582031
local_in_edges_tensor generation:  0.005977153778076172
mini_batch_src_global generation:  0.006284236907958984
r_  generation:  0.09155702590942383
local_output_nid generation:  0.014329195022583008
local_in_edges_tensor generation:  0.005982160568237305
mini_batch_src_global generation:  0.00719904899597168
r_  generation:  0.09151124954223633
----------------------check_connections_block total spend ----------------------------- 0.5537545680999756
generate_one_block  0.10162091255187988
generate_one_block  0.10286951065063477
generate_one_block  0.10634398460388184
generate_one_block  0.10968756675720215
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.046105384826660156
gen group dst list time:  0.011034488677978516
time for parepare:  0.019281625747680664
local_output_nid generation:  0.019662857055664062
local_in_edges_tensor generation:  0.042751312255859375
mini_batch_src_global generation:  0.0412294864654541
r_  generation:  0.42975807189941406
local_output_nid generation:  0.026417016983032227
local_in_edges_tensor generation:  0.05451250076293945
mini_batch_src_global generation:  0.058483123779296875
r_  generation:  0.41783809661865234
local_output_nid generation:  0.026825428009033203
local_in_edges_tensor generation:  0.035004615783691406
mini_batch_src_global generation:  0.04799175262451172
r_  generation:  0.4206678867340088
local_output_nid generation:  0.025967836380004883
local_in_edges_tensor generation:  0.028420209884643555
mini_batch_src_global generation:  0.04953765869140625
r_  generation:  0.422191858291626
----------------------check_connections_block total spend ----------------------------- 2.5529420375823975
generate_one_block  0.5511419773101807
generate_one_block  0.5571849346160889
generate_one_block  0.5743963718414307
generate_one_block  0.5480928421020508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.053015947341918945
gen group dst list time:  0.0209505558013916
time for parepare:  0.01878666877746582
local_output_nid generation:  0.030747652053833008
local_in_edges_tensor generation:  0.05895256996154785
mini_batch_src_global generation:  0.053578853607177734
r_  generation:  0.5385913848876953
local_output_nid generation:  0.03935122489929199
local_in_edges_tensor generation:  0.056006669998168945
mini_batch_src_global generation:  0.060221195220947266
r_  generation:  0.5626392364501953
local_output_nid generation:  0.042240142822265625
local_in_edges_tensor generation:  0.06221485137939453
mini_batch_src_global generation:  0.06834578514099121
r_  generation:  0.5562758445739746
local_output_nid generation:  0.03991436958312988
local_in_edges_tensor generation:  0.048935890197753906
mini_batch_src_global generation:  0.057511091232299805
r_  generation:  0.5676908493041992
----------------------check_connections_block total spend ----------------------------- 3.379145622253418
generate_one_block  0.7065813541412354
generate_one_block  0.7002863883972168
generate_one_block  0.6880533695220947
generate_one_block  0.7126500606536865
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04017210006713867
gen group dst list time:  0.02919936180114746
time for parepare:  0.019020795822143555
local_output_nid generation:  0.03413867950439453
local_in_edges_tensor generation:  0.059522390365600586
mini_batch_src_global generation:  0.045755863189697266
r_  generation:  0.5097508430480957
local_output_nid generation:  0.04004240036010742
local_in_edges_tensor generation:  0.05004739761352539
mini_batch_src_global generation:  0.056999921798706055
r_  generation:  0.514535665512085
local_output_nid generation:  0.03914785385131836
local_in_edges_tensor generation:  0.03882288932800293
mini_batch_src_global generation:  0.07481765747070312
r_  generation:  0.5207085609436035
local_output_nid generation:  0.04009413719177246
local_in_edges_tensor generation:  0.043576955795288086
mini_batch_src_global generation:  0.05653977394104004
r_  generation:  0.5176575183868408
----------------------check_connections_block total spend ----------------------------- 3.1320574283599854
generate_one_block  0.6369760036468506
generate_one_block  0.6438279151916504
generate_one_block  0.6457967758178711
generate_one_block  0.6588351726531982
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.19713211059570312  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

connection checking time:  9.0641450881958
block generation total time  7.623823165893555
average batch blocks generation time:  1.9059557914733887
block dataloader generation time/epoch 18.76077890396118
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.12126398086547852  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

torch.Size([166757, 128])
torch.Size([164803, 32])
torch.Size([155220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.36059141159057617  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.1212759017944336  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

torch.Size([166692, 128])
torch.Size([164770, 32])
torch.Size([155140, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.360598087310791  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12124061584472656  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

torch.Size([166686, 128])
torch.Size([164649, 32])
torch.Size([154969, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3604288101196289  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12127304077148438  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

torch.Size([166724, 128])
torch.Size([164712, 32])
torch.Size([155074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.36044788360595703  GigaBytes
Max Memory Allocated: 0.381807804107666  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.049836039543151855 |0.032373130321502686 |0.005070745944976807 |9.763240814208984e-05 |0.015492081642150879 |0.0037839412689208984 |
----------------------------------------------------------pseudo_mini_loss sum 4.501962661743164
Total (block generation + training)time/epoch 19.210263967514038
Training time/epoch 0.449169397354126
Training time without block to device /epoch 0.31967687606811523
Training time without total dataloading part /epoch 0.08642578125
load block tensor time/epoch 0.19934415817260742
block to device time/epoch 0.12949252128601074
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2352030
Number of first layer input nodes during this epoch:  666859
