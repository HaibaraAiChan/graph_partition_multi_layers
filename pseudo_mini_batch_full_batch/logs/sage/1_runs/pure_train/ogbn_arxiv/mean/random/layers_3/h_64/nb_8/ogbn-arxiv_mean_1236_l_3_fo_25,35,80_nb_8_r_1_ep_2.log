Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648439901.3070798
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02795124053955078
random selection method range initialization spend 0.0066339969635009766
time for parepare:  0.01865530014038086
local_output_nid generation:  0.004225015640258789
local_in_edges_tensor generation:  0.006623029708862305
mini_batch_src_global generation:  0.0038080215454101562
r_  generation:  0.04219174385070801
local_output_nid generation:  0.005845785140991211
local_in_edges_tensor generation:  0.0033600330352783203
mini_batch_src_global generation:  0.004952907562255859
r_  generation:  0.04370760917663574
local_output_nid generation:  0.006061553955078125
local_in_edges_tensor generation:  0.003461122512817383
mini_batch_src_global generation:  0.003330707550048828
r_  generation:  0.04442477226257324
local_output_nid generation:  0.0061223506927490234
local_in_edges_tensor generation:  0.0033690929412841797
mini_batch_src_global generation:  0.00339508056640625
r_  generation:  0.04518890380859375
local_output_nid generation:  0.0061550140380859375
local_in_edges_tensor generation:  0.003358125686645508
mini_batch_src_global generation:  0.003610849380493164
r_  generation:  0.04834771156311035
local_output_nid generation:  0.006377458572387695
local_in_edges_tensor generation:  0.0035219192504882812
mini_batch_src_global generation:  0.004090785980224609
r_  generation:  0.04837536811828613
local_output_nid generation:  0.006166696548461914
local_in_edges_tensor generation:  0.003407716751098633
mini_batch_src_global generation:  0.003865480422973633
r_  generation:  0.046831607818603516
local_output_nid generation:  0.006201505661010742
local_in_edges_tensor generation:  0.0034372806549072266
mini_batch_src_global generation:  0.0038614273071289062
r_  generation:  0.04657125473022461
----------------------check_connections_block total spend ----------------------------- 0.5786595344543457
generate_one_block  0.06179165840148926
generate_one_block  0.06199002265930176
generate_one_block  0.060613393783569336
generate_one_block  0.061307430267333984
generate_one_block  0.06536674499511719
generate_one_block  0.06271910667419434
generate_one_block  0.06080198287963867
generate_one_block  0.06191301345825195
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04158926010131836
gen group dst list time:  0.01632547378540039
time for parepare:  0.019269227981567383
local_output_nid generation:  0.014365196228027344
local_in_edges_tensor generation:  0.035295724868774414
mini_batch_src_global generation:  0.030199766159057617
r_  generation:  0.31980371475219727
local_output_nid generation:  0.019490718841552734
local_in_edges_tensor generation:  0.03257441520690918
mini_batch_src_global generation:  0.03951072692871094
r_  generation:  0.3289055824279785
local_output_nid generation:  0.0190582275390625
local_in_edges_tensor generation:  0.02650284767150879
mini_batch_src_global generation:  0.03797030448913574
r_  generation:  0.3280811309814453
local_output_nid generation:  0.019295215606689453
local_in_edges_tensor generation:  0.026128530502319336
mini_batch_src_global generation:  0.03921818733215332
r_  generation:  0.3379995822906494
local_output_nid generation:  0.01916193962097168
local_in_edges_tensor generation:  0.026526927947998047
mini_batch_src_global generation:  0.040531158447265625
r_  generation:  0.3386688232421875
local_output_nid generation:  0.019263029098510742
local_in_edges_tensor generation:  0.023978233337402344
mini_batch_src_global generation:  0.040865421295166016
r_  generation:  0.34890174865722656
local_output_nid generation:  0.01909923553466797
local_in_edges_tensor generation:  0.023499488830566406
mini_batch_src_global generation:  0.040161848068237305
r_  generation:  0.3415095806121826
local_output_nid generation:  0.019064664840698242
local_in_edges_tensor generation:  0.02407383918762207
mini_batch_src_global generation:  0.04065346717834473
r_  generation:  0.3370029926300049
----------------------check_connections_block total spend ----------------------------- 3.9546234607696533
generate_one_block  0.44347190856933594
generate_one_block  0.448772668838501
generate_one_block  0.4213435649871826
generate_one_block  0.4374380111694336
generate_one_block  0.4403672218322754
generate_one_block  0.45063304901123047
generate_one_block  0.4362144470214844
generate_one_block  0.43264245986938477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03297305107116699
gen group dst list time:  0.03642892837524414
time for parepare:  0.018870830535888672
local_output_nid generation:  0.028127670288085938
local_in_edges_tensor generation:  0.04436182975769043
mini_batch_src_global generation:  0.044922590255737305
r_  generation:  0.4804055690765381
local_output_nid generation:  0.03493523597717285
local_in_edges_tensor generation:  0.0516047477722168
mini_batch_src_global generation:  0.05508112907409668
r_  generation:  0.4876742362976074
local_output_nid generation:  0.03590583801269531
local_in_edges_tensor generation:  0.05320429801940918
mini_batch_src_global generation:  0.056342124938964844
r_  generation:  0.49098634719848633
local_output_nid generation:  0.035247087478637695
local_in_edges_tensor generation:  0.038823843002319336
mini_batch_src_global generation:  0.056275367736816406
r_  generation:  0.49558138847351074
local_output_nid generation:  0.035170555114746094
local_in_edges_tensor generation:  0.0484166145324707
mini_batch_src_global generation:  0.061634063720703125
r_  generation:  0.49290037155151367
local_output_nid generation:  0.03515458106994629
local_in_edges_tensor generation:  0.03962087631225586
mini_batch_src_global generation:  0.055267333984375
r_  generation:  0.48836421966552734
local_output_nid generation:  0.03486371040344238
local_in_edges_tensor generation:  0.041683197021484375
mini_batch_src_global generation:  0.053778648376464844
r_  generation:  0.49425482749938965
local_output_nid generation:  0.03503751754760742
local_in_edges_tensor generation:  0.03247785568237305
mini_batch_src_global generation:  0.05586576461791992
r_  generation:  0.5015771389007568
----------------------check_connections_block total spend ----------------------------- 5.904509544372559
generate_one_block  0.6170985698699951
generate_one_block  0.6211214065551758
generate_one_block  0.6064553260803223
generate_one_block  0.6221468448638916
generate_one_block  0.6171126365661621
generate_one_block  0.6210422515869141
generate_one_block  0.6328768730163574
generate_one_block  0.6081955432891846
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  9.859133005142212
block generation total time  8.456932783126831
average batch blocks generation time:  1.0571165978908539
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09733390808105469  GigaBytes
Max Memory Allocated: 0.09733390808105469  GigaBytes

torch.Size([160820, 128])
torch.Size([142903, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.30866003036499023  GigaBytes
Max Memory Allocated: 0.3216729164123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.09939861297607422  GigaBytes
Max Memory Allocated: 0.34337806701660156  GigaBytes

torch.Size([160842, 128])
torch.Size([143009, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.30890941619873047  GigaBytes
Max Memory Allocated: 0.34337806701660156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.0992588996887207  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

torch.Size([160960, 128])
torch.Size([142666, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.30765628814697266  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.0997166633605957  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

torch.Size([160956, 128])
torch.Size([143075, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.30872583389282227  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.09946823120117188  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

torch.Size([161008, 128])
torch.Size([143015, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.3085622787475586  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09963178634643555  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

torch.Size([161022, 128])
torch.Size([143394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3124370574951172  GigaBytes
Max Memory Allocated: 0.3434734344482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0991983413696289  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160834, 128])
torch.Size([142827, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3081393241882324  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09946680068969727  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160941, 128])
torch.Size([142581, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3077859878540039  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041180193424224854 |0.053432345390319824 |0.09728431701660156 |0.0001087486743927002 |0.017755746841430664 |0.0018794536590576172 |
----------------------------------------------------------pseudo_mini_loss sum 5.318201541900635
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3020116
Number of first layer input nodes during this epoch:  1287383
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.1419534683227539  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028430461883544922
random selection method range initialization spend 0.005675315856933594
time for parepare:  0.0174560546875
local_output_nid generation:  0.004369497299194336
local_in_edges_tensor generation:  0.0074825286865234375
mini_batch_src_global generation:  0.0036880970001220703
r_  generation:  0.039750099182128906
local_output_nid generation:  0.0057222843170166016
local_in_edges_tensor generation:  0.003102540969848633
mini_batch_src_global generation:  0.00613713264465332
r_  generation:  0.04160261154174805
local_output_nid generation:  0.006062030792236328
local_in_edges_tensor generation:  0.0032262802124023438
mini_batch_src_global generation:  0.0033140182495117188
r_  generation:  0.04448246955871582
local_output_nid generation:  0.00612950325012207
local_in_edges_tensor generation:  0.0033500194549560547
mini_batch_src_global generation:  0.0035238265991210938
r_  generation:  0.04510164260864258
local_output_nid generation:  0.0060884952545166016
local_in_edges_tensor generation:  0.0032660961151123047
mini_batch_src_global generation:  0.003696441650390625
r_  generation:  0.04677224159240723
local_output_nid generation:  0.006078004837036133
local_in_edges_tensor generation:  0.003420114517211914
mini_batch_src_global generation:  0.004023075103759766
r_  generation:  0.04712033271789551
local_output_nid generation:  0.0061492919921875
local_in_edges_tensor generation:  0.003501415252685547
mini_batch_src_global generation:  0.003828287124633789
r_  generation:  0.04692888259887695
local_output_nid generation:  0.00616455078125
local_in_edges_tensor generation:  0.0032711029052734375
mini_batch_src_global generation:  0.004184246063232422
r_  generation:  0.0475916862487793
----------------------check_connections_block total spend ----------------------------- 0.5712182521820068
generate_one_block  0.06295537948608398
generate_one_block  0.059223175048828125
generate_one_block  0.0614473819732666
generate_one_block  0.06235098838806152
generate_one_block  0.06275343894958496
generate_one_block  0.06287121772766113
generate_one_block  0.0641939640045166
generate_one_block  0.06365537643432617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03447151184082031
gen group dst list time:  0.016256332397460938
time for parepare:  0.01901841163635254
local_output_nid generation:  0.01441502571105957
local_in_edges_tensor generation:  0.03476715087890625
mini_batch_src_global generation:  0.03088521957397461
r_  generation:  0.31269335746765137
local_output_nid generation:  0.020139455795288086
local_in_edges_tensor generation:  0.03062605857849121
mini_batch_src_global generation:  0.0407412052154541
r_  generation:  0.3234059810638428
local_output_nid generation:  0.019353866577148438
local_in_edges_tensor generation:  0.02947402000427246
mini_batch_src_global generation:  0.038526296615600586
r_  generation:  0.3313004970550537
local_output_nid generation:  0.0196988582611084
local_in_edges_tensor generation:  0.025881528854370117
mini_batch_src_global generation:  0.043200016021728516
r_  generation:  0.33495092391967773
local_output_nid generation:  0.019649028778076172
local_in_edges_tensor generation:  0.0236208438873291
mini_batch_src_global generation:  0.04298520088195801
r_  generation:  0.34027862548828125
local_output_nid generation:  0.019522905349731445
local_in_edges_tensor generation:  0.023026704788208008
mini_batch_src_global generation:  0.04152059555053711
r_  generation:  0.3368353843688965
local_output_nid generation:  0.019269943237304688
local_in_edges_tensor generation:  0.019690752029418945
mini_batch_src_global generation:  0.04107546806335449
r_  generation:  0.3402137756347656
local_output_nid generation:  0.019685983657836914
local_in_edges_tensor generation:  0.025966167449951172
mini_batch_src_global generation:  0.04164934158325195
r_  generation:  0.3380908966064453
----------------------check_connections_block total spend ----------------------------- 3.9341509342193604
generate_one_block  0.42898106575012207
generate_one_block  0.42441630363464355
generate_one_block  0.44008898735046387
generate_one_block  0.43782997131347656
generate_one_block  0.444019079208374
generate_one_block  0.44156408309936523
generate_one_block  0.4245030879974365
generate_one_block  0.4768388271331787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037549495697021484
gen group dst list time:  0.038469552993774414
time for parepare:  0.01936507225036621
local_output_nid generation:  0.028989553451538086
local_in_edges_tensor generation:  0.06113290786743164
mini_batch_src_global generation:  0.04510664939880371
r_  generation:  0.4714162349700928
local_output_nid generation:  0.03427386283874512
local_in_edges_tensor generation:  0.049907684326171875
mini_batch_src_global generation:  0.05399918556213379
r_  generation:  0.4796452522277832
local_output_nid generation:  0.036472320556640625
local_in_edges_tensor generation:  0.04244542121887207
mini_batch_src_global generation:  0.05076909065246582
r_  generation:  0.4851245880126953
local_output_nid generation:  0.03465533256530762
local_in_edges_tensor generation:  0.038460493087768555
mini_batch_src_global generation:  0.05524110794067383
r_  generation:  0.4940183162689209
local_output_nid generation:  0.0348362922668457
local_in_edges_tensor generation:  0.04818558692932129
mini_batch_src_global generation:  0.05610489845275879
r_  generation:  0.494373083114624
local_output_nid generation:  0.03491926193237305
local_in_edges_tensor generation:  0.04548907279968262
mini_batch_src_global generation:  0.0570521354675293
r_  generation:  0.5066766738891602
local_output_nid generation:  0.03767728805541992
local_in_edges_tensor generation:  0.03448820114135742
mini_batch_src_global generation:  0.05878114700317383
r_  generation:  0.49538755416870117
local_output_nid generation:  0.03576326370239258
local_in_edges_tensor generation:  0.04593205451965332
mini_batch_src_global generation:  0.058233022689819336
r_  generation:  0.4898362159729004
----------------------check_connections_block total spend ----------------------------- 5.886398553848267
generate_one_block  0.6112329959869385
generate_one_block  0.6046257019042969
generate_one_block  0.6404106616973877
generate_one_block  0.6274936199188232
generate_one_block  0.6118910312652588
generate_one_block  0.5977973937988281
generate_one_block  0.5987520217895508
generate_one_block  0.6133954524993896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.1419534683227539  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

connection checking time:  9.820549488067627
block generation total time  8.423840284347534
average batch blocks generation time:  1.0529800355434418
block dataloader generation time/epoch 20.345414400100708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0998539924621582  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([161106, 128])
torch.Size([143168, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30882787704467773  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09948968887329102  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160713, 128])
torch.Size([142292, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30736255645751953  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.1000213623046875  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160911, 128])
torch.Size([143081, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30913734436035156  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09967803955078125  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([161044, 128])
torch.Size([143195, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30896663665771484  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09981775283813477  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160931, 128])
torch.Size([142885, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30916929244995117  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0995187759399414  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160657, 128])
torch.Size([142661, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3085780143737793  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09956598281860352  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160873, 128])
torch.Size([142814, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.308319091796875  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0998992919921875  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

torch.Size([160919, 128])
torch.Size([142937, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3092641830444336  GigaBytes
Max Memory Allocated: 0.34731483459472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04037964344024658 |0.02032172679901123 |0.004156023263931274 |0.00010919570922851562 |0.0068398118019104 |0.0018277168273925781 |
----------------------------------------------------------pseudo_mini_loss sum 4.079519748687744
Total (block generation + training)time/epoch 20.94807195663452
Training time/epoch 0.6024491786956787
Training time without block to device /epoch 0.43987536430358887
Training time without total dataloading part /epoch 0.0906679630279541
load block tensor time/epoch 0.32303714752197266
block to device time/epoch 0.16257381439208984
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019368
Number of first layer input nodes during this epoch:  1287154
