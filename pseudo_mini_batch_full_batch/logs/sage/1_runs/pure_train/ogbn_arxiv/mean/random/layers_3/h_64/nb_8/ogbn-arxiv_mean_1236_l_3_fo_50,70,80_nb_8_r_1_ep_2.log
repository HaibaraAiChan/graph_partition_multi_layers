Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648440901.0957525
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02916717529296875
random selection method range initialization spend 0.009578227996826172
time for parepare:  0.019427061080932617
local_output_nid generation:  0.004327297210693359
local_in_edges_tensor generation:  0.007193803787231445
mini_batch_src_global generation:  0.00463104248046875
r_  generation:  0.05431342124938965
local_output_nid generation:  0.005877017974853516
local_in_edges_tensor generation:  0.0032186508178710938
mini_batch_src_global generation:  0.004883289337158203
r_  generation:  0.04433035850524902
local_output_nid generation:  0.006117582321166992
local_in_edges_tensor generation:  0.0032067298889160156
mini_batch_src_global generation:  0.0033249855041503906
r_  generation:  0.04301905632019043
local_output_nid generation:  0.006037235260009766
local_in_edges_tensor generation:  0.00321197509765625
mini_batch_src_global generation:  0.0036323070526123047
r_  generation:  0.04496002197265625
local_output_nid generation:  0.0062029361724853516
local_in_edges_tensor generation:  0.003284931182861328
mini_batch_src_global generation:  0.0038573741912841797
r_  generation:  0.04630589485168457
local_output_nid generation:  0.006078481674194336
local_in_edges_tensor generation:  0.0032417774200439453
mini_batch_src_global generation:  0.004103899002075195
r_  generation:  0.04700183868408203
local_output_nid generation:  0.006131649017333984
local_in_edges_tensor generation:  0.0032892227172851562
mini_batch_src_global generation:  0.004124164581298828
r_  generation:  0.04608750343322754
local_output_nid generation:  0.006108283996582031
local_in_edges_tensor generation:  0.0032329559326171875
mini_batch_src_global generation:  0.004059553146362305
r_  generation:  0.046564579010009766
----------------------check_connections_block total spend ----------------------------- 0.5892956256866455
generate_one_block  0.06154990196228027
generate_one_block  0.06224560737609863
generate_one_block  0.06049180030822754
generate_one_block  0.06112933158874512
generate_one_block  0.06551957130432129
generate_one_block  0.06246137619018555
generate_one_block  0.060891151428222656
generate_one_block  0.06106758117675781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04285407066345215
gen group dst list time:  0.016495704650878906
time for parepare:  0.019518136978149414
local_output_nid generation:  0.014548778533935547
local_in_edges_tensor generation:  0.035913944244384766
mini_batch_src_global generation:  0.0396273136138916
r_  generation:  0.356677770614624
local_output_nid generation:  0.022121191024780273
local_in_edges_tensor generation:  0.0349276065826416
mini_batch_src_global generation:  0.05070018768310547
r_  generation:  0.36670565605163574
local_output_nid generation:  0.021571874618530273
local_in_edges_tensor generation:  0.02527022361755371
mini_batch_src_global generation:  0.04420757293701172
r_  generation:  0.36979198455810547
local_output_nid generation:  0.02188706398010254
local_in_edges_tensor generation:  0.02500772476196289
mini_batch_src_global generation:  0.048166513442993164
r_  generation:  0.3723263740539551
local_output_nid generation:  0.02198648452758789
local_in_edges_tensor generation:  0.025283098220825195
mini_batch_src_global generation:  0.04623579978942871
r_  generation:  0.37630176544189453
local_output_nid generation:  0.02193617820739746
local_in_edges_tensor generation:  0.02837514877319336
mini_batch_src_global generation:  0.046695709228515625
r_  generation:  0.383624792098999
local_output_nid generation:  0.02184295654296875
local_in_edges_tensor generation:  0.025550127029418945
mini_batch_src_global generation:  0.046352386474609375
r_  generation:  0.3821113109588623
local_output_nid generation:  0.021938800811767578
local_in_edges_tensor generation:  0.024730443954467773
mini_batch_src_global generation:  0.046694040298461914
r_  generation:  0.3757190704345703
----------------------check_connections_block total spend ----------------------------- 4.391157865524292
generate_one_block  0.4976654052734375
generate_one_block  0.5083000659942627
generate_one_block  0.48375868797302246
generate_one_block  0.49697065353393555
generate_one_block  0.49596643447875977
generate_one_block  0.5139832496643066
generate_one_block  0.48686647415161133
generate_one_block  0.4926178455352783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037113189697265625
gen group dst list time:  0.03683304786682129
time for parepare:  0.019023418426513672
local_output_nid generation:  0.02802276611328125
local_in_edges_tensor generation:  0.04680633544921875
mini_batch_src_global generation:  0.05620574951171875
r_  generation:  0.539912223815918
local_output_nid generation:  0.035048723220825195
local_in_edges_tensor generation:  0.05697345733642578
mini_batch_src_global generation:  0.06373429298400879
r_  generation:  0.5454897880554199
local_output_nid generation:  0.034845590591430664
local_in_edges_tensor generation:  0.047654151916503906
mini_batch_src_global generation:  0.0614619255065918
r_  generation:  0.5527727603912354
local_output_nid generation:  0.0349271297454834
local_in_edges_tensor generation:  0.042365074157714844
mini_batch_src_global generation:  0.0641322135925293
r_  generation:  0.5589268207550049
local_output_nid generation:  0.03515768051147461
local_in_edges_tensor generation:  0.04772591590881348
mini_batch_src_global generation:  0.06516265869140625
r_  generation:  0.5624284744262695
local_output_nid generation:  0.03509712219238281
local_in_edges_tensor generation:  0.036965131759643555
mini_batch_src_global generation:  0.062311410903930664
r_  generation:  0.5599625110626221
local_output_nid generation:  0.03509926795959473
local_in_edges_tensor generation:  0.038346290588378906
mini_batch_src_global generation:  0.06632065773010254
r_  generation:  0.565866231918335
local_output_nid generation:  0.03508281707763672
local_in_edges_tensor generation:  0.04737234115600586
mini_batch_src_global generation:  0.06258821487426758
r_  generation:  0.5612571239471436
----------------------check_connections_block total spend ----------------------------- 6.590070009231567
generate_one_block  0.708113431930542
generate_one_block  0.7180485725402832
generate_one_block  0.7126469612121582
generate_one_block  0.721285343170166
generate_one_block  0.7248694896697998
generate_one_block  0.7243409156799316
generate_one_block  0.7249205112457275
generate_one_block  0.6995820999145508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  10.98122787475586
block generation total time  9.709936141967773
average batch blocks generation time:  1.2137420177459717
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10166645050048828  GigaBytes
Max Memory Allocated: 0.10166645050048828  GigaBytes

torch.Size([162511, 128])
torch.Size([145928, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.3197054862976074  GigaBytes
Max Memory Allocated: 0.33289146423339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10391378402709961  GigaBytes
Max Memory Allocated: 0.35447263717651367  GigaBytes

torch.Size([162479, 128])
torch.Size([145917, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3202934265136719  GigaBytes
Max Memory Allocated: 0.35447263717651367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10387039184570312  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

torch.Size([162717, 128])
torch.Size([145824, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3193488121032715  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.1042938232421875  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

torch.Size([162601, 128])
torch.Size([146118, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3199448585510254  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.10399055480957031  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

torch.Size([162676, 128])
torch.Size([146056, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.3199033737182617  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10418462753295898  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

torch.Size([162649, 128])
torch.Size([146324, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32051897048950195  GigaBytes
Max Memory Allocated: 0.35483598709106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10385560989379883  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162573, 128])
torch.Size([145836, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.31972551345825195  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10410165786743164  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162679, 128])
torch.Size([145761, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3194098472595215  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03634458780288696 |0.048455774784088135 |0.09309789538383484 |9.73045825958252e-05 |0.011087417602539062 |0.003062009811401367 |
----------------------------------------------------------pseudo_mini_loss sum 5.314587593078613
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3058091
Number of first layer input nodes during this epoch:  1300885
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.15298128128051758  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02637791633605957
random selection method range initialization spend 0.006978750228881836
time for parepare:  0.017446279525756836
local_output_nid generation:  0.004336357116699219
local_in_edges_tensor generation:  0.006663799285888672
mini_batch_src_global generation:  0.0036199092864990234
r_  generation:  0.040044307708740234
local_output_nid generation:  0.005644321441650391
local_in_edges_tensor generation:  0.0032181739807128906
mini_batch_src_global generation:  0.004721641540527344
r_  generation:  0.04296588897705078
local_output_nid generation:  0.005995273590087891
local_in_edges_tensor generation:  0.0033011436462402344
mini_batch_src_global generation:  0.0033028125762939453
r_  generation:  0.044806718826293945
local_output_nid generation:  0.006037473678588867
local_in_edges_tensor generation:  0.0032339096069335938
mini_batch_src_global generation:  0.003548860549926758
r_  generation:  0.046056270599365234
local_output_nid generation:  0.006041288375854492
local_in_edges_tensor generation:  0.0031092166900634766
mini_batch_src_global generation:  0.0037889480590820312
r_  generation:  0.04698538780212402
local_output_nid generation:  0.0060732364654541016
local_in_edges_tensor generation:  0.0031571388244628906
mini_batch_src_global generation:  0.004076957702636719
r_  generation:  0.05101275444030762
local_output_nid generation:  0.005980014801025391
local_in_edges_tensor generation:  0.003323793411254883
mini_batch_src_global generation:  0.004002094268798828
r_  generation:  0.04571962356567383
local_output_nid generation:  0.0060329437255859375
local_in_edges_tensor generation:  0.0032596588134765625
mini_batch_src_global generation:  0.0040302276611328125
r_  generation:  0.04786419868469238
----------------------check_connections_block total spend ----------------------------- 0.5780069828033447
generate_one_block  0.06080961227416992
generate_one_block  0.05946087837219238
generate_one_block  0.06424665451049805
generate_one_block  0.061765432357788086
generate_one_block  0.06482863426208496
generate_one_block  0.06836533546447754
generate_one_block  0.06593894958496094
generate_one_block  0.06392884254455566
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.061284780502319336
gen group dst list time:  0.017110586166381836
time for parepare:  0.021640300750732422
local_output_nid generation:  0.014446496963500977
local_in_edges_tensor generation:  0.05078434944152832
mini_batch_src_global generation:  0.03851819038391113
r_  generation:  0.3571288585662842
local_output_nid generation:  0.019930124282836914
local_in_edges_tensor generation:  0.03394126892089844
mini_batch_src_global generation:  0.044008493423461914
r_  generation:  0.3675203323364258
local_output_nid generation:  0.019003629684448242
local_in_edges_tensor generation:  0.03207063674926758
mini_batch_src_global generation:  0.04445481300354004
r_  generation:  0.3834071159362793
local_output_nid generation:  0.019264936447143555
local_in_edges_tensor generation:  0.025158166885375977
mini_batch_src_global generation:  0.045243024826049805
r_  generation:  0.3796381950378418
local_output_nid generation:  0.019311189651489258
local_in_edges_tensor generation:  0.02864980697631836
mini_batch_src_global generation:  0.04659438133239746
r_  generation:  0.3861415386199951
local_output_nid generation:  0.019460439682006836
local_in_edges_tensor generation:  0.02567744255065918
mini_batch_src_global generation:  0.04725384712219238
r_  generation:  0.38973212242126465
local_output_nid generation:  0.019221067428588867
local_in_edges_tensor generation:  0.021686315536499023
mini_batch_src_global generation:  0.04687952995300293
r_  generation:  0.38721704483032227
local_output_nid generation:  0.019407033920288086
local_in_edges_tensor generation:  0.0305635929107666
mini_batch_src_global generation:  0.0467839241027832
r_  generation:  0.3920872211456299
----------------------check_connections_block total spend ----------------------------- 4.461625814437866
generate_one_block  0.515791654586792
generate_one_block  0.5029001235961914
generate_one_block  0.5330007076263428
generate_one_block  0.5179812908172607
generate_one_block  0.5114498138427734
generate_one_block  0.5348787307739258
generate_one_block  0.5095932483673096
generate_one_block  0.5520896911621094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043462276458740234
gen group dst list time:  0.0389409065246582
time for parepare:  0.023906707763671875
local_output_nid generation:  0.030943870544433594
local_in_edges_tensor generation:  0.07059001922607422
mini_batch_src_global generation:  0.05721926689147949
r_  generation:  0.551302433013916
local_output_nid generation:  0.035650014877319336
local_in_edges_tensor generation:  0.05638289451599121
mini_batch_src_global generation:  0.06416916847229004
r_  generation:  0.5591211318969727
local_output_nid generation:  0.03708291053771973
local_in_edges_tensor generation:  0.05658292770385742
mini_batch_src_global generation:  0.061110734939575195
r_  generation:  0.5766432285308838
local_output_nid generation:  0.036509037017822266
local_in_edges_tensor generation:  0.056336164474487305
mini_batch_src_global generation:  0.07742857933044434
r_  generation:  0.5850820541381836
local_output_nid generation:  0.038794755935668945
local_in_edges_tensor generation:  0.05095505714416504
mini_batch_src_global generation:  0.06184673309326172
r_  generation:  0.5749473571777344
local_output_nid generation:  0.03697490692138672
local_in_edges_tensor generation:  0.04122161865234375
mini_batch_src_global generation:  0.06274580955505371
r_  generation:  0.5830552577972412
local_output_nid generation:  0.03976321220397949
local_in_edges_tensor generation:  0.047600507736206055
mini_batch_src_global generation:  0.08031964302062988
r_  generation:  0.6035599708557129
local_output_nid generation:  0.0417933464050293
local_in_edges_tensor generation:  0.053783416748046875
mini_batch_src_global generation:  0.06881952285766602
r_  generation:  0.6003847122192383
----------------------check_connections_block total spend ----------------------------- 6.985746145248413
generate_one_block  0.7293868064880371
generate_one_block  0.7438838481903076
generate_one_block  0.718773365020752
generate_one_block  0.7257521152496338
generate_one_block  0.7170805931091309
generate_one_block  0.7197256088256836
generate_one_block  0.6981630325317383
generate_one_block  0.7238955497741699
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.15298128128051758  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

connection checking time:  11.44737195968628
block generation total time  9.954346179962158
average batch blocks generation time:  1.2442932724952698
block dataloader generation time/epoch 23.572057008743286
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10420465469360352  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162849, 128])
torch.Size([146236, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3198418617248535  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10411310195922852  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162554, 128])
torch.Size([145485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.31934595108032227  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10465526580810547  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162644, 128])
torch.Size([146126, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32048606872558594  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10424566268920898  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162813, 128])
torch.Size([146277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3200092315673828  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10432672500610352  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

torch.Size([162691, 128])
torch.Size([146012, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3206663131713867  GigaBytes
Max Memory Allocated: 0.35535240173339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1042470932006836  GigaBytes
Max Memory Allocated: 0.35538291931152344  GigaBytes

torch.Size([162449, 128])
torch.Size([145589, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.320314884185791  GigaBytes
Max Memory Allocated: 0.35538291931152344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10421085357666016  GigaBytes
Max Memory Allocated: 0.35538291931152344  GigaBytes

torch.Size([162608, 128])
torch.Size([145947, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.31977415084838867  GigaBytes
Max Memory Allocated: 0.35538291931152344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10442018508911133  GigaBytes
Max Memory Allocated: 0.35538291931152344  GigaBytes

torch.Size([162702, 128])
torch.Size([146001, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32070302963256836  GigaBytes
Max Memory Allocated: 0.35538291931152344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03293457627296448 |0.016099780797958374 |0.003459364175796509 |8.934736251831055e-05 |0.0068648457527160645 |0.0028820037841796875 |
----------------------------------------------------------pseudo_mini_loss sum 4.088820457458496
Total (block generation + training)time/epoch 24.076427221298218
Training time/epoch 0.5041713714599609
Training time without block to device /epoch 0.37537312507629395
Training time without total dataloading part /epoch 0.08619046211242676
load block tensor time/epoch 0.2634766101837158
block to device time/epoch 0.128798246383667
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3058202
Number of first layer input nodes during this epoch:  1301310
