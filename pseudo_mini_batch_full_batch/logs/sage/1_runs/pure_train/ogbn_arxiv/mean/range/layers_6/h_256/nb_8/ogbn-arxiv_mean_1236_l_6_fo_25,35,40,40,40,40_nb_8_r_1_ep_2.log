Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648519609.3191705
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02464747428894043
range selection method range initialization spend 0.012971162796020508
time for parepare:  0.01779460906982422
local_output_nid generation:  0.002580881118774414
local_in_edges_tensor generation:  0.004689693450927734
mini_batch_src_global generation:  0.003307819366455078
r_  generation:  0.03664565086364746
local_output_nid generation:  0.0029435157775878906
local_in_edges_tensor generation:  0.0016252994537353516
mini_batch_src_global generation:  0.004114627838134766
r_  generation:  0.03711819648742676
local_output_nid generation:  0.003006458282470703
local_in_edges_tensor generation:  0.00162506103515625
mini_batch_src_global generation:  0.002733469009399414
r_  generation:  0.03726911544799805
local_output_nid generation:  0.0031113624572753906
local_in_edges_tensor generation:  0.0016319751739501953
mini_batch_src_global generation:  0.0027964115142822266
r_  generation:  0.03881502151489258
local_output_nid generation:  0.003050088882446289
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.0030231475830078125
r_  generation:  0.039475440979003906
local_output_nid generation:  0.003063678741455078
local_in_edges_tensor generation:  0.001631021499633789
mini_batch_src_global generation:  0.003150463104248047
r_  generation:  0.04033064842224121
local_output_nid generation:  0.0030791759490966797
local_in_edges_tensor generation:  0.0016331672668457031
mini_batch_src_global generation:  0.0031630992889404297
r_  generation:  0.040671586990356445
local_output_nid generation:  0.0030808448791503906
local_in_edges_tensor generation:  0.0016283988952636719
mini_batch_src_global generation:  0.0032913684844970703
r_  generation:  0.04035377502441406
----------------------check_connections_block total spend ----------------------------- 0.4607048034667969
generate_one_block  0.05389523506164551
generate_one_block  0.05451202392578125
generate_one_block  0.05634164810180664
generate_one_block  0.055887699127197266
generate_one_block  0.05744290351867676
generate_one_block  0.05576038360595703
generate_one_block  0.056104183197021484
generate_one_block  0.05674266815185547
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.042105913162231445
gen group dst list time:  0.0151519775390625
time for parepare:  0.019850492477416992
local_output_nid generation:  0.010711908340454102
local_in_edges_tensor generation:  0.029558181762695312
mini_batch_src_global generation:  0.0291595458984375
r_  generation:  0.29586291313171387
local_output_nid generation:  0.018051624298095703
local_in_edges_tensor generation:  0.029175758361816406
mini_batch_src_global generation:  0.04035472869873047
r_  generation:  0.30823302268981934
local_output_nid generation:  0.018503665924072266
local_in_edges_tensor generation:  0.024350881576538086
mini_batch_src_global generation:  0.03672957420349121
r_  generation:  0.3074910640716553
local_output_nid generation:  0.0188295841217041
local_in_edges_tensor generation:  0.024610042572021484
mini_batch_src_global generation:  0.038238525390625
r_  generation:  0.3208901882171631
local_output_nid generation:  0.01931619644165039
local_in_edges_tensor generation:  0.01889801025390625
mini_batch_src_global generation:  0.039061784744262695
r_  generation:  0.31179380416870117
local_output_nid generation:  0.01968073844909668
local_in_edges_tensor generation:  0.021764516830444336
mini_batch_src_global generation:  0.04175376892089844
r_  generation:  0.3184185028076172
local_output_nid generation:  0.019399166107177734
local_in_edges_tensor generation:  0.02685236930847168
mini_batch_src_global generation:  0.03916215896606445
r_  generation:  0.31576085090637207
local_output_nid generation:  0.019883155822753906
local_in_edges_tensor generation:  0.027809858322143555
mini_batch_src_global generation:  0.04227423667907715
r_  generation:  0.321990966796875
----------------------check_connections_block total spend ----------------------------- 3.723299026489258
generate_one_block  0.40157008171081543
generate_one_block  0.4037609100341797
generate_one_block  0.396634578704834
generate_one_block  0.41818737983703613
generate_one_block  0.39907360076904297
generate_one_block  0.4262223243713379
generate_one_block  0.409543514251709
generate_one_block  0.421828031539917
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04073953628540039
gen group dst list time:  0.038004159927368164
time for parepare:  0.019561052322387695
local_output_nid generation:  0.02612018585205078
local_in_edges_tensor generation:  0.06813669204711914
mini_batch_src_global generation:  0.055591583251953125
r_  generation:  0.5214083194732666
local_output_nid generation:  0.03259873390197754
local_in_edges_tensor generation:  0.0601041316986084
mini_batch_src_global generation:  0.07770299911499023
r_  generation:  0.5428147315979004
local_output_nid generation:  0.03613734245300293
local_in_edges_tensor generation:  0.03931164741516113
mini_batch_src_global generation:  0.0671091079711914
r_  generation:  0.5345208644866943
local_output_nid generation:  0.03435492515563965
local_in_edges_tensor generation:  0.04165291786193848
mini_batch_src_global generation:  0.06322145462036133
r_  generation:  0.52925705909729
local_output_nid generation:  0.034955501556396484
local_in_edges_tensor generation:  0.03763270378112793
mini_batch_src_global generation:  0.06061244010925293
r_  generation:  0.5395278930664062
local_output_nid generation:  0.03550434112548828
local_in_edges_tensor generation:  0.036736488342285156
mini_batch_src_global generation:  0.06729578971862793
r_  generation:  0.52773118019104
local_output_nid generation:  0.0356907844543457
local_in_edges_tensor generation:  0.0381159782409668
mini_batch_src_global generation:  0.06095743179321289
r_  generation:  0.5433342456817627
local_output_nid generation:  0.035893917083740234
local_in_edges_tensor generation:  0.042968034744262695
mini_batch_src_global generation:  0.06421947479248047
r_  generation:  0.5305445194244385
----------------------check_connections_block total spend ----------------------------- 6.408991098403931
generate_one_block  0.6910696029663086
generate_one_block  0.6910932064056396
generate_one_block  0.6907141208648682
generate_one_block  0.6899776458740234
generate_one_block  0.6962060928344727
generate_one_block  0.6738576889038086
generate_one_block  0.7113118171691895
generate_one_block  0.689457893371582
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04876232147216797
gen group dst list time:  0.04538559913635254
time for parepare:  0.019834041595458984
local_output_nid generation:  0.030996084213256836
local_in_edges_tensor generation:  0.07236313819885254
mini_batch_src_global generation:  0.05834317207336426
r_  generation:  0.5520486831665039
local_output_nid generation:  0.03606271743774414
local_in_edges_tensor generation:  0.05843520164489746
mini_batch_src_global generation:  0.0686502456665039
r_  generation:  0.5503232479095459
local_output_nid generation:  0.036260366439819336
local_in_edges_tensor generation:  0.04436898231506348
mini_batch_src_global generation:  0.08723640441894531
r_  generation:  0.5508885383605957
local_output_nid generation:  0.038506507873535156
local_in_edges_tensor generation:  0.05307650566101074
mini_batch_src_global generation:  0.06203055381774902
r_  generation:  0.5614578723907471
local_output_nid generation:  0.03788018226623535
local_in_edges_tensor generation:  0.04636669158935547
mini_batch_src_global generation:  0.06548023223876953
r_  generation:  0.5550563335418701
local_output_nid generation:  0.03780007362365723
local_in_edges_tensor generation:  0.03549599647521973
mini_batch_src_global generation:  0.06142234802246094
r_  generation:  0.5671133995056152
local_output_nid generation:  0.03790020942687988
local_in_edges_tensor generation:  0.03525733947753906
mini_batch_src_global generation:  0.0633552074432373
r_  generation:  0.565248966217041
local_output_nid generation:  0.03784346580505371
local_in_edges_tensor generation:  0.04497361183166504
mini_batch_src_global generation:  0.0632181167602539
r_  generation:  0.5778496265411377
----------------------check_connections_block total spend ----------------------------- 6.769425392150879
generate_one_block  0.7037248611450195
generate_one_block  0.6948230266571045
generate_one_block  0.7037496566772461
generate_one_block  0.7108275890350342
generate_one_block  0.6948087215423584
generate_one_block  0.7143445014953613
generate_one_block  0.746920108795166
generate_one_block  0.6947684288024902
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07162022590637207
gen group dst list time:  0.0469670295715332
time for parepare:  0.019358396530151367
local_output_nid generation:  0.031441688537597656
local_in_edges_tensor generation:  0.0449221134185791
mini_batch_src_global generation:  0.05411243438720703
r_  generation:  0.5377407073974609
local_output_nid generation:  0.03633475303649902
local_in_edges_tensor generation:  0.03742098808288574
mini_batch_src_global generation:  0.06721878051757812
r_  generation:  0.5392105579376221
local_output_nid generation:  0.03813982009887695
local_in_edges_tensor generation:  0.03449869155883789
mini_batch_src_global generation:  0.07089042663574219
r_  generation:  0.544342041015625
local_output_nid generation:  0.038294076919555664
local_in_edges_tensor generation:  0.040134429931640625
mini_batch_src_global generation:  0.06452226638793945
r_  generation:  0.5433518886566162
local_output_nid generation:  0.03787541389465332
local_in_edges_tensor generation:  0.03968524932861328
mini_batch_src_global generation:  0.06902575492858887
r_  generation:  0.5489068031311035
local_output_nid generation:  0.03824043273925781
local_in_edges_tensor generation:  0.039925336837768555
mini_batch_src_global generation:  0.06343460083007812
r_  generation:  0.5500674247741699
local_output_nid generation:  0.03786659240722656
local_in_edges_tensor generation:  0.03926563262939453
mini_batch_src_global generation:  0.06750774383544922
r_  generation:  0.549778938293457
local_output_nid generation:  0.03819561004638672
local_in_edges_tensor generation:  0.04426884651184082
mini_batch_src_global generation:  0.06359505653381348
r_  generation:  0.5505867004394531
----------------------check_connections_block total spend ----------------------------- 6.548074007034302
generate_one_block  0.6881487369537354
generate_one_block  0.6977531909942627
generate_one_block  0.6911795139312744
generate_one_block  0.6971569061279297
generate_one_block  0.7144997119903564
generate_one_block  0.6981582641601562
generate_one_block  0.6983623504638672
generate_one_block  0.7407641410827637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.056322336196899414
gen group dst list time:  0.05000185966491699
time for parepare:  0.019339561462402344
local_output_nid generation:  0.03181886672973633
local_in_edges_tensor generation:  0.05211138725280762
mini_batch_src_global generation:  0.0517725944519043
r_  generation:  0.5194766521453857
local_output_nid generation:  0.03789806365966797
local_in_edges_tensor generation:  0.03813743591308594
mini_batch_src_global generation:  0.061171531677246094
r_  generation:  0.506260871887207
local_output_nid generation:  0.03857827186584473
local_in_edges_tensor generation:  0.0358579158782959
mini_batch_src_global generation:  0.06320548057556152
r_  generation:  0.5079240798950195
local_output_nid generation:  0.038132667541503906
local_in_edges_tensor generation:  0.0376889705657959
mini_batch_src_global generation:  0.06544375419616699
r_  generation:  0.5117051601409912
local_output_nid generation:  0.03805398941040039
local_in_edges_tensor generation:  0.035355329513549805
mini_batch_src_global generation:  0.06505942344665527
r_  generation:  0.5086925029754639
local_output_nid generation:  0.03834986686706543
local_in_edges_tensor generation:  0.04349684715270996
mini_batch_src_global generation:  0.07641005516052246
r_  generation:  0.5228126049041748
local_output_nid generation:  0.04162430763244629
local_in_edges_tensor generation:  0.0404815673828125
mini_batch_src_global generation:  0.062314510345458984
r_  generation:  0.5086100101470947
local_output_nid generation:  0.04066157341003418
local_in_edges_tensor generation:  0.03548073768615723
mini_batch_src_global generation:  0.06406140327453613
r_  generation:  0.50935959815979
----------------------check_connections_block total spend ----------------------------- 6.233858585357666
generate_one_block  0.6372795104980469
generate_one_block  0.6443684101104736
generate_one_block  0.6409659385681152
generate_one_block  0.6410253047943115
generate_one_block  0.6455130577087402
generate_one_block  0.643280029296875
generate_one_block  0.6401968002319336
generate_one_block  0.6384096145629883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

connection checking time:  29.683648109436035
block generation total time  25.231536865234375
average batch blocks generation time:  3.153942108154297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.14072132110595703  GigaBytes
Max Memory Allocated: 0.14072132110595703  GigaBytes

torch.Size([167542, 128])
torch.Size([167107, 256])
torch.Size([165894, 256])
torch.Size([161395, 256])
torch.Size([142021, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5408935546875 GB
    Memory Allocated: 2.9868407249450684  GigaBytes
Max Memory Allocated: 3.046776294708252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2303466796875 GB
    Memory Allocated: 0.1463146209716797  GigaBytes
Max Memory Allocated: 3.114865779876709  GigaBytes

torch.Size([167523, 128])
torch.Size([167066, 256])
torch.Size([165698, 256])
torch.Size([161174, 256])
torch.Size([141901, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 2.990405559539795  GigaBytes
Max Memory Allocated: 3.114865779876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 0.1464061737060547  GigaBytes
Max Memory Allocated: 3.11824893951416  GigaBytes

torch.Size([167481, 128])
torch.Size([167032, 256])
torch.Size([165710, 256])
torch.Size([161230, 256])
torch.Size([141680, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2322998046875 GB
    Memory Allocated: 2.989013195037842  GigaBytes
Max Memory Allocated: 3.11824893951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 0.1466069221496582  GigaBytes
Max Memory Allocated: 3.11824893951416  GigaBytes

torch.Size([167462, 128])
torch.Size([167014, 256])
torch.Size([165711, 256])
torch.Size([161148, 256])
torch.Size([141895, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 2.992549419403076  GigaBytes
Max Memory Allocated: 3.11824893951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 0.1464390754699707  GigaBytes
Max Memory Allocated: 3.121358871459961  GigaBytes

torch.Size([167526, 128])
torch.Size([167116, 256])
torch.Size([165899, 256])
torch.Size([161495, 256])
torch.Size([142230, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 2.9922051429748535  GigaBytes
Max Memory Allocated: 3.121358871459961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 0.1464838981628418  GigaBytes
Max Memory Allocated: 3.121358871459961  GigaBytes

torch.Size([167504, 128])
torch.Size([167067, 256])
torch.Size([165759, 256])
torch.Size([161243, 256])
torch.Size([141850, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 2.99167537689209  GigaBytes
Max Memory Allocated: 3.121358871459961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 0.14649486541748047  GigaBytes
Max Memory Allocated: 3.121358871459961  GigaBytes

torch.Size([167508, 128])
torch.Size([167122, 256])
torch.Size([165908, 256])
torch.Size([161535, 256])
torch.Size([142258, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 2.994537830352783  GigaBytes
Max Memory Allocated: 3.121358871459961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 0.14658784866333008  GigaBytes
Max Memory Allocated: 3.1236047744750977  GigaBytes

torch.Size([167566, 128])
torch.Size([167152, 256])
torch.Size([165837, 256])
torch.Size([161329, 256])
torch.Size([142190, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2342529296875 GB
    Memory Allocated: 2.997666358947754  GigaBytes
Max Memory Allocated: 3.1236047744750977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.16931292414665222 |0.09181538224220276 |0.10358390212059021 |0.00010442733764648438 |0.11360093951225281 |0.008398771286010742 |
----------------------------------------------------------pseudo_mini_loss sum 6.281429290771484
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6972889
Number of first layer input nodes during this epoch:  1340112
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.2362060546875 GB
    Memory Allocated: 0.2639622688293457  GigaBytes
Max Memory Allocated: 3.127737522125244  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.019069433212280273
range selection method range initialization spend 0.011600971221923828
time for parepare:  0.017461299896240234
local_output_nid generation:  0.0026521682739257812
local_in_edges_tensor generation:  0.006346225738525391
mini_batch_src_global generation:  0.0035827159881591797
r_  generation:  0.03725552558898926
local_output_nid generation:  0.0031082630157470703
local_in_edges_tensor generation:  0.0017058849334716797
mini_batch_src_global generation:  0.004378318786621094
r_  generation:  0.03972458839416504
local_output_nid generation:  0.0032644271850585938
local_in_edges_tensor generation:  0.0017125606536865234
mini_batch_src_global generation:  0.003020048141479492
r_  generation:  0.040242910385131836
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.003014802932739258
r_  generation:  0.04049062728881836
local_output_nid generation:  0.0031812191009521484
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.0030870437622070312
r_  generation:  0.0416259765625
local_output_nid generation:  0.0032761096954345703
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0032417774200439453
r_  generation:  0.04232072830200195
local_output_nid generation:  0.003221273422241211
local_in_edges_tensor generation:  0.0017554759979248047
mini_batch_src_global generation:  0.00331878662109375
r_  generation:  0.04112577438354492
local_output_nid generation:  0.0031723976135253906
local_in_edges_tensor generation:  0.0017142295837402344
mini_batch_src_global generation:  0.003290891647338867
r_  generation:  0.04137015342712402
----------------------check_connections_block total spend ----------------------------- 0.4827136993408203
generate_one_block  0.05297350883483887
generate_one_block  0.05509471893310547
generate_one_block  0.05532050132751465
generate_one_block  0.05464625358581543
generate_one_block  0.05443406105041504
generate_one_block  0.05533742904663086
generate_one_block  0.05446910858154297
generate_one_block  0.05755472183227539
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03954935073852539
gen group dst list time:  0.013776540756225586
time for parepare:  0.01960897445678711
local_output_nid generation:  0.010316610336303711
local_in_edges_tensor generation:  0.027541160583496094
mini_batch_src_global generation:  0.029419898986816406
r_  generation:  0.2956726551055908
local_output_nid generation:  0.015842437744140625
local_in_edges_tensor generation:  0.026974916458129883
mini_batch_src_global generation:  0.03800201416015625
r_  generation:  0.3113126754760742
local_output_nid generation:  0.01651620864868164
local_in_edges_tensor generation:  0.022576093673706055
mini_batch_src_global generation:  0.0400083065032959
r_  generation:  0.32297182083129883
local_output_nid generation:  0.01741194725036621
local_in_edges_tensor generation:  0.016711711883544922
mini_batch_src_global generation:  0.03845334053039551
r_  generation:  0.31661128997802734
local_output_nid generation:  0.0176088809967041
local_in_edges_tensor generation:  0.019492626190185547
mini_batch_src_global generation:  0.03946828842163086
r_  generation:  0.3203086853027344
local_output_nid generation:  0.01691126823425293
local_in_edges_tensor generation:  0.02482295036315918
mini_batch_src_global generation:  0.03965926170349121
r_  generation:  0.32430338859558105
local_output_nid generation:  0.01685929298400879
local_in_edges_tensor generation:  0.022292613983154297
mini_batch_src_global generation:  0.03953814506530762
r_  generation:  0.3270406723022461
local_output_nid generation:  0.0171816349029541
local_in_edges_tensor generation:  0.019784212112426758
mini_batch_src_global generation:  0.0401914119720459
r_  generation:  0.3227534294128418
----------------------check_connections_block total spend ----------------------------- 3.7310447692871094
generate_one_block  0.4108469486236572
generate_one_block  0.41410183906555176
generate_one_block  0.41469788551330566
generate_one_block  0.41172218322753906
generate_one_block  0.4242873191833496
generate_one_block  0.4127964973449707
generate_one_block  0.40996503829956055
generate_one_block  0.4349100589752197
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04614448547363281
gen group dst list time:  0.037142038345336914
time for parepare:  0.018494129180908203
local_output_nid generation:  0.0257415771484375
local_in_edges_tensor generation:  0.05949544906616211
mini_batch_src_global generation:  0.05164051055908203
r_  generation:  0.52978515625
local_output_nid generation:  0.03230881690979004
local_in_edges_tensor generation:  0.05127835273742676
mini_batch_src_global generation:  0.06283378601074219
r_  generation:  0.5364181995391846
local_output_nid generation:  0.03232526779174805
local_in_edges_tensor generation:  0.03780078887939453
mini_batch_src_global generation:  0.0631554126739502
r_  generation:  0.5462958812713623
local_output_nid generation:  0.032994985580444336
local_in_edges_tensor generation:  0.03825187683105469
mini_batch_src_global generation:  0.06264019012451172
r_  generation:  0.5438323020935059
local_output_nid generation:  0.0335240364074707
local_in_edges_tensor generation:  0.03795027732849121
mini_batch_src_global generation:  0.06510710716247559
r_  generation:  0.5611343383789062
local_output_nid generation:  0.03533530235290527
local_in_edges_tensor generation:  0.04448199272155762
mini_batch_src_global generation:  0.06378388404846191
r_  generation:  0.5638918876647949
local_output_nid generation:  0.03720450401306152
local_in_edges_tensor generation:  0.04602336883544922
mini_batch_src_global generation:  0.07130813598632812
r_  generation:  0.5543301105499268
local_output_nid generation:  0.03512454032897949
local_in_edges_tensor generation:  0.0434727668762207
mini_batch_src_global generation:  0.06435036659240723
r_  generation:  0.5426244735717773
----------------------check_connections_block total spend ----------------------------- 6.4821250438690186
generate_one_block  0.6826324462890625
generate_one_block  0.6839182376861572
generate_one_block  0.6990625858306885
generate_one_block  0.7004270553588867
generate_one_block  0.6882143020629883
generate_one_block  0.6902155876159668
generate_one_block  0.683936595916748
generate_one_block  0.6885583400726318
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.045374155044555664
gen group dst list time:  0.04899764060974121
time for parepare:  0.019344806671142578
local_output_nid generation:  0.03032708168029785
local_in_edges_tensor generation:  0.061150550842285156
mini_batch_src_global generation:  0.05330395698547363
r_  generation:  0.5499622821807861
local_output_nid generation:  0.03867220878601074
local_in_edges_tensor generation:  0.09014081954956055
mini_batch_src_global generation:  0.06793618202209473
r_  generation:  0.5569605827331543
local_output_nid generation:  0.03789877891540527
local_in_edges_tensor generation:  0.0464482307434082
mini_batch_src_global generation:  0.07074522972106934
r_  generation:  0.5572891235351562
local_output_nid generation:  0.03790593147277832
local_in_edges_tensor generation:  0.0533447265625
mini_batch_src_global generation:  0.06165456771850586
r_  generation:  0.56418776512146
local_output_nid generation:  0.040459394454956055
local_in_edges_tensor generation:  0.03734874725341797
mini_batch_src_global generation:  0.06307244300842285
r_  generation:  0.5622940063476562
local_output_nid generation:  0.03758955001831055
local_in_edges_tensor generation:  0.050052642822265625
mini_batch_src_global generation:  0.07675647735595703
r_  generation:  0.573845386505127
local_output_nid generation:  0.0405423641204834
local_in_edges_tensor generation:  0.057642221450805664
mini_batch_src_global generation:  0.06780624389648438
r_  generation:  0.5712449550628662
local_output_nid generation:  0.038773536682128906
local_in_edges_tensor generation:  0.03979778289794922
mini_batch_src_global generation:  0.06424927711486816
r_  generation:  0.5754241943359375
----------------------check_connections_block total spend ----------------------------- 6.85237717628479
generate_one_block  0.693821907043457
generate_one_block  0.7017052173614502
generate_one_block  0.7191975116729736
generate_one_block  0.70975661277771
generate_one_block  0.7003092765808105
generate_one_block  0.7232015132904053
generate_one_block  0.712505578994751
generate_one_block  0.6962845325469971
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04163837432861328
gen group dst list time:  0.053053855895996094
time for parepare:  0.019173622131347656
local_output_nid generation:  0.031766653060913086
local_in_edges_tensor generation:  0.04549074172973633
mini_batch_src_global generation:  0.051427602767944336
r_  generation:  0.5445435047149658
local_output_nid generation:  0.03765988349914551
local_in_edges_tensor generation:  0.050568580627441406
mini_batch_src_global generation:  0.06551909446716309
r_  generation:  0.5576107501983643
local_output_nid generation:  0.03805971145629883
local_in_edges_tensor generation:  0.04018855094909668
mini_batch_src_global generation:  0.06529974937438965
r_  generation:  0.5517270565032959
local_output_nid generation:  0.03861594200134277
local_in_edges_tensor generation:  0.04532504081726074
mini_batch_src_global generation:  0.06567859649658203
r_  generation:  0.55377197265625
local_output_nid generation:  0.038506507873535156
local_in_edges_tensor generation:  0.0351102352142334
mini_batch_src_global generation:  0.06550049781799316
r_  generation:  0.5557510852813721
local_output_nid generation:  0.03924727439880371
local_in_edges_tensor generation:  0.0803685188293457
mini_batch_src_global generation:  0.06458163261413574
r_  generation:  0.5531330108642578
local_output_nid generation:  0.03945493698120117
local_in_edges_tensor generation:  0.05015707015991211
mini_batch_src_global generation:  0.0649101734161377
r_  generation:  0.5532169342041016
local_output_nid generation:  0.03921914100646973
local_in_edges_tensor generation:  0.03579902648925781
mini_batch_src_global generation:  0.0647580623626709
r_  generation:  0.5538969039916992
----------------------check_connections_block total spend ----------------------------- 6.68137264251709
generate_one_block  0.6803796291351318
generate_one_block  0.7045767307281494
generate_one_block  0.6973671913146973
generate_one_block  0.7022316455841064
generate_one_block  0.6828563213348389
generate_one_block  0.693798303604126
generate_one_block  0.6989049911499023
generate_one_block  0.6839587688446045
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04312252998352051
gen group dst list time:  0.051529884338378906
time for parepare:  0.019493579864501953
local_output_nid generation:  0.0333099365234375
local_in_edges_tensor generation:  0.043750762939453125
mini_batch_src_global generation:  0.04748821258544922
r_  generation:  0.5067994594573975
local_output_nid generation:  0.04042768478393555
local_in_edges_tensor generation:  0.0344085693359375
mini_batch_src_global generation:  0.05968618392944336
r_  generation:  0.5115299224853516
local_output_nid generation:  0.04078483581542969
local_in_edges_tensor generation:  0.04532337188720703
mini_batch_src_global generation:  0.05989527702331543
r_  generation:  0.5100438594818115
local_output_nid generation:  0.03849196434020996
local_in_edges_tensor generation:  0.04738473892211914
mini_batch_src_global generation:  0.060491323471069336
r_  generation:  0.5143575668334961
local_output_nid generation:  0.038839101791381836
local_in_edges_tensor generation:  0.04010176658630371
mini_batch_src_global generation:  0.0627753734588623
r_  generation:  0.5106754302978516
local_output_nid generation:  0.03886127471923828
local_in_edges_tensor generation:  0.03717303276062012
mini_batch_src_global generation:  0.07927751541137695
r_  generation:  0.5307354927062988
local_output_nid generation:  0.04111123085021973
local_in_edges_tensor generation:  0.04321575164794922
mini_batch_src_global generation:  0.06144309043884277
r_  generation:  0.5170321464538574
local_output_nid generation:  0.03995394706726074
local_in_edges_tensor generation:  0.03972363471984863
mini_batch_src_global generation:  0.060015201568603516
r_  generation:  0.5152075290679932
----------------------check_connections_block total spend ----------------------------- 6.271033525466919
generate_one_block  0.6718695163726807
generate_one_block  0.6621475219726562
generate_one_block  0.6459319591522217
generate_one_block  0.6466982364654541
generate_one_block  0.6324713230133057
generate_one_block  0.647118091583252
generate_one_block  0.6518948078155518
generate_one_block  0.6318702697753906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.2362060546875 GB
    Memory Allocated: 0.2639622688293457  GigaBytes
Max Memory Allocated: 3.127737522125244  GigaBytes

connection checking time:  30.017953157424927
block generation total time  25.241150379180908
average batch blocks generation time:  3.1551437973976135
block dataloader generation time/epoch 58.07046914100647
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2362060546875 GB
    Memory Allocated: 0.15102052688598633  GigaBytes
Max Memory Allocated: 3.127737522125244  GigaBytes

torch.Size([167525, 128])
torch.Size([167095, 256])
torch.Size([165872, 256])
torch.Size([161528, 256])
torch.Size([142340, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2362060546875 GB
    Memory Allocated: 3.0016722679138184  GigaBytes
Max Memory Allocated: 3.127737522125244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.1510634422302246  GigaBytes
Max Memory Allocated: 3.1299877166748047  GigaBytes

torch.Size([167557, 128])
torch.Size([167100, 256])
torch.Size([165731, 256])
torch.Size([161183, 256])
torch.Size([141508, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 2.9935121536254883  GigaBytes
Max Memory Allocated: 3.1299877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.1509861946105957  GigaBytes
Max Memory Allocated: 3.1299877166748047  GigaBytes

torch.Size([167541, 128])
torch.Size([167096, 256])
torch.Size([165871, 256])
torch.Size([161383, 256])
torch.Size([142438, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 3.004239559173584  GigaBytes
Max Memory Allocated: 3.1299877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.15102815628051758  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

torch.Size([167569, 128])
torch.Size([167116, 256])
torch.Size([165801, 256])
torch.Size([161300, 256])
torch.Size([141930, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 2.995039463043213  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.15099859237670898  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

torch.Size([167492, 128])
torch.Size([167020, 256])
torch.Size([165724, 256])
torch.Size([161247, 256])
torch.Size([142046, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 2.995347499847412  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.1510772705078125  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

torch.Size([167489, 128])
torch.Size([167030, 256])
torch.Size([165773, 256])
torch.Size([161508, 256])
torch.Size([142337, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 3.0036096572875977  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.15107250213623047  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

torch.Size([167525, 128])
torch.Size([167091, 256])
torch.Size([165837, 256])
torch.Size([161477, 256])
torch.Size([142322, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 2.9988040924072266  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 0.15106678009033203  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

torch.Size([167479, 128])
torch.Size([167007, 256])
torch.Size([165716, 256])
torch.Size([161229, 256])
torch.Size([141898, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2381591796875 GB
    Memory Allocated: 2.995722770690918  GigaBytes
Max Memory Allocated: 3.134019374847412  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2556963562965393 |0.051541686058044434 |0.006796896457672119 |9.736418724060059e-05 |0.008863359689712524 |0.005751848220825195 |
----------------------------------------------------------pseudo_mini_loss sum 3.778289794921875
Total (block generation + training)time/epoch 60.92217946052551
Training time/epoch 2.851422071456909
Training time without block to device /epoch 2.4390885829925537
Training time without total dataloading part /epoch 0.13181281089782715
load block tensor time/epoch 2.0455708503723145
block to device time/epoch 0.41233348846435547
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6974089
Number of first layer input nodes during this epoch:  1340177
