Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648453043.2583573
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02813267707824707
range selection method range initialization spend 0.01344609260559082
time for parepare:  0.01806640625
local_output_nid generation:  0.0013508796691894531
local_in_edges_tensor generation:  0.0039882659912109375
mini_batch_src_global generation:  0.001928567886352539
r_  generation:  0.0200803279876709
local_output_nid generation:  0.001432657241821289
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.0024285316467285156
r_  generation:  0.020476818084716797
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0015304088592529297
r_  generation:  0.01962590217590332
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.001527547836303711
r_  generation:  0.020221948623657227
local_output_nid generation:  0.0014929771423339844
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0015096664428710938
r_  generation:  0.020780324935913086
local_output_nid generation:  0.0014958381652832031
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.02117443084716797
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0017044544219970703
r_  generation:  0.0213925838470459
local_output_nid generation:  0.0015039443969726562
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.001665353775024414
r_  generation:  0.020508289337158203
local_output_nid generation:  0.0014994144439697266
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.001651763916015625
r_  generation:  0.02115488052368164
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0016391277313232422
r_  generation:  0.021059274673461914
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.000858306884765625
mini_batch_src_global generation:  0.0017621517181396484
r_  generation:  0.021461963653564453
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0017383098602294922
r_  generation:  0.02156233787536621
local_output_nid generation:  0.001514434814453125
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021729230880737305
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0017223358154296875
r_  generation:  0.021193742752075195
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.0017282962799072266
r_  generation:  0.02192854881286621
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0018076896667480469
r_  generation:  0.02196478843688965
----------------------check_connections_block total spend ----------------------------- 0.4976818561553955
generate_one_block  0.030062437057495117
generate_one_block  0.03211617469787598
generate_one_block  0.03175616264343262
generate_one_block  0.031023025512695312
generate_one_block  0.03128838539123535
generate_one_block  0.03110504150390625
generate_one_block  0.031524658203125
generate_one_block  0.030341625213623047
generate_one_block  0.03126168251037598
generate_one_block  0.030821800231933594
generate_one_block  0.031047821044921875
generate_one_block  0.0319361686706543
generate_one_block  0.03185558319091797
generate_one_block  0.03156280517578125
generate_one_block  0.031851768493652344
generate_one_block  0.031966209411621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04312252998352051
gen group dst list time:  0.020636796951293945
time for parepare:  0.01929330825805664
local_output_nid generation:  0.007379055023193359
local_in_edges_tensor generation:  0.018253803253173828
mini_batch_src_global generation:  0.02524542808532715
r_  generation:  0.2491006851196289
local_output_nid generation:  0.011316299438476562
local_in_edges_tensor generation:  0.02354264259338379
mini_batch_src_global generation:  0.03277397155761719
r_  generation:  0.2646808624267578
local_output_nid generation:  0.011255025863647461
local_in_edges_tensor generation:  0.020708560943603516
mini_batch_src_global generation:  0.030477523803710938
r_  generation:  0.2558741569519043
local_output_nid generation:  0.011731386184692383
local_in_edges_tensor generation:  0.015037298202514648
mini_batch_src_global generation:  0.03180527687072754
r_  generation:  0.26527857780456543
local_output_nid generation:  0.012038707733154297
local_in_edges_tensor generation:  0.018786907196044922
mini_batch_src_global generation:  0.03269839286804199
r_  generation:  0.26862382888793945
local_output_nid generation:  0.01202392578125
local_in_edges_tensor generation:  0.019021034240722656
mini_batch_src_global generation:  0.03342390060424805
r_  generation:  0.26917028427124023
local_output_nid generation:  0.012266874313354492
local_in_edges_tensor generation:  0.019872665405273438
mini_batch_src_global generation:  0.036301612854003906
r_  generation:  0.28052330017089844
local_output_nid generation:  0.012052297592163086
local_in_edges_tensor generation:  0.014417171478271484
mini_batch_src_global generation:  0.03365039825439453
r_  generation:  0.26368260383605957
local_output_nid generation:  0.012236833572387695
local_in_edges_tensor generation:  0.014865398406982422
mini_batch_src_global generation:  0.0343017578125
r_  generation:  0.26967287063598633
local_output_nid generation:  0.012254953384399414
local_in_edges_tensor generation:  0.017017602920532227
mini_batch_src_global generation:  0.03428792953491211
r_  generation:  0.27229952812194824
local_output_nid generation:  0.012292623519897461
local_in_edges_tensor generation:  0.019838571548461914
mini_batch_src_global generation:  0.034226417541503906
r_  generation:  0.27446675300598145
local_output_nid generation:  0.012559175491333008
local_in_edges_tensor generation:  0.02003312110900879
mini_batch_src_global generation:  0.034749507904052734
r_  generation:  0.2737245559692383
local_output_nid generation:  0.012339115142822266
local_in_edges_tensor generation:  0.015233516693115234
mini_batch_src_global generation:  0.03446507453918457
r_  generation:  0.27654218673706055
local_output_nid generation:  0.01242375373840332
local_in_edges_tensor generation:  0.01715373992919922
mini_batch_src_global generation:  0.03451871871948242
r_  generation:  0.27090978622436523
local_output_nid generation:  0.012425899505615234
local_in_edges_tensor generation:  0.01750493049621582
mini_batch_src_global generation:  0.03638315200805664
r_  generation:  0.2741966247558594
local_output_nid generation:  0.012495040893554688
local_in_edges_tensor generation:  0.020090579986572266
mini_batch_src_global generation:  0.03538966178894043
r_  generation:  0.27380943298339844
----------------------check_connections_block total spend ----------------------------- 6.260604619979858
generate_one_block  0.3558928966522217
generate_one_block  0.3664095401763916
generate_one_block  0.34806203842163086
generate_one_block  0.3491196632385254
generate_one_block  0.37142324447631836
generate_one_block  0.35637998580932617
generate_one_block  0.37064242362976074
generate_one_block  0.3446657657623291
generate_one_block  0.3510866165161133
generate_one_block  0.3536858558654785
generate_one_block  0.3595542907714844
generate_one_block  0.366701602935791
generate_one_block  0.35715723037719727
generate_one_block  0.35503268241882324
generate_one_block  0.36801600456237793
generate_one_block  0.36126065254211426
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041335105895996094
gen group dst list time:  0.06271982192993164
time for parepare:  0.01911759376525879
local_output_nid generation:  0.02543783187866211
local_in_edges_tensor generation:  0.045246124267578125
mini_batch_src_global generation:  0.05137157440185547
r_  generation:  0.5254387855529785
local_output_nid generation:  0.03167581558227539
local_in_edges_tensor generation:  0.05302858352661133
mini_batch_src_global generation:  0.062020301818847656
r_  generation:  0.5259695053100586
local_output_nid generation:  0.031690359115600586
local_in_edges_tensor generation:  0.038854122161865234
mini_batch_src_global generation:  0.05859708786010742
r_  generation:  0.5321166515350342
local_output_nid generation:  0.031794071197509766
local_in_edges_tensor generation:  0.03936195373535156
mini_batch_src_global generation:  0.059516191482543945
r_  generation:  0.5378189086914062
local_output_nid generation:  0.032257795333862305
local_in_edges_tensor generation:  0.056688785552978516
mini_batch_src_global generation:  0.06624484062194824
r_  generation:  0.5445096492767334
local_output_nid generation:  0.03337860107421875
local_in_edges_tensor generation:  0.03689932823181152
mini_batch_src_global generation:  0.0606536865234375
r_  generation:  0.5420567989349365
local_output_nid generation:  0.032061100006103516
local_in_edges_tensor generation:  0.03561663627624512
mini_batch_src_global generation:  0.06121635437011719
r_  generation:  0.5444772243499756
local_output_nid generation:  0.032521963119506836
local_in_edges_tensor generation:  0.040575265884399414
mini_batch_src_global generation:  0.06979012489318848
r_  generation:  0.5495917797088623
local_output_nid generation:  0.03287148475646973
local_in_edges_tensor generation:  0.03912782669067383
mini_batch_src_global generation:  0.07179570198059082
r_  generation:  0.5447132587432861
local_output_nid generation:  0.03273344039916992
local_in_edges_tensor generation:  0.04291653633117676
mini_batch_src_global generation:  0.06567907333374023
r_  generation:  0.5628581047058105
local_output_nid generation:  0.035170555114746094
local_in_edges_tensor generation:  0.042452096939086914
mini_batch_src_global generation:  0.06226396560668945
r_  generation:  0.5520000457763672
local_output_nid generation:  0.0341644287109375
local_in_edges_tensor generation:  0.036785125732421875
mini_batch_src_global generation:  0.06379985809326172
r_  generation:  0.5521731376647949
local_output_nid generation:  0.03370237350463867
local_in_edges_tensor generation:  0.03084397315979004
mini_batch_src_global generation:  0.06266021728515625
r_  generation:  0.5510501861572266
local_output_nid generation:  0.033629655838012695
local_in_edges_tensor generation:  0.03679656982421875
mini_batch_src_global generation:  0.06253457069396973
r_  generation:  0.5513560771942139
local_output_nid generation:  0.03351235389709473
local_in_edges_tensor generation:  0.035361289978027344
mini_batch_src_global generation:  0.0658109188079834
r_  generation:  0.5502767562866211
local_output_nid generation:  0.03346562385559082
local_in_edges_tensor generation:  0.036782026290893555
mini_batch_src_global generation:  0.07906866073608398
r_  generation:  0.546396017074585
----------------------check_connections_block total spend ----------------------------- 12.874766111373901
generate_one_block  0.7113723754882812
generate_one_block  0.7109761238098145
generate_one_block  0.6890518665313721
generate_one_block  0.6726467609405518
generate_one_block  0.695702314376831
generate_one_block  0.682166337966919
generate_one_block  0.7456445693969727
generate_one_block  0.6745491027832031
generate_one_block  0.6857709884643555
generate_one_block  0.6930336952209473
generate_one_block  0.7060060501098633
generate_one_block  0.6880936622619629
generate_one_block  0.69382643699646
generate_one_block  0.6756665706634521
generate_one_block  0.675839900970459
generate_one_block  0.6902472972869873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  19.13537073135376
block generation total time  16.825684547424316
average batch blocks generation time:  1.0516052842140198
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09701299667358398  GigaBytes
Max Memory Allocated: 0.09701299667358398  GigaBytes

torch.Size([157699, 128])
torch.Size([130018, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.769629955291748  GigaBytes
Max Memory Allocated: 0.8108744621276855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 0.09829330444335938  GigaBytes
Max Memory Allocated: 0.8563227653503418  GigaBytes

torch.Size([157512, 128])
torch.Size([129736, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 0.7756600379943848  GigaBytes
Max Memory Allocated: 0.8563227653503418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09900951385498047  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157783, 128])
torch.Size([129794, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.7660007476806641  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.09805965423583984  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157632, 128])
torch.Size([130096, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7714910507202148  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.0991373062133789  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157980, 128])
torch.Size([130503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7767343521118164  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09808158874511719  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157550, 128])
torch.Size([129789, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7705373764038086  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09833621978759766  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157674, 128])
torch.Size([129932, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7757463455200195  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09788656234741211  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157359, 128])
torch.Size([129568, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7650361061096191  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09803247451782227  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157465, 128])
torch.Size([129772, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.768669605255127  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09816551208496094  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157842, 128])
torch.Size([130188, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7710819244384766  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09807968139648438  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157472, 128])
torch.Size([129921, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7700204849243164  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09810543060302734  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157324, 128])
torch.Size([130016, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7723388671875  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09814071655273438  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157500, 128])
torch.Size([129590, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7692413330078125  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09804964065551758  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157451, 128])
torch.Size([129701, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7690587043762207  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09821605682373047  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157662, 128])
torch.Size([129993, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7718625068664551  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09811639785766602  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157385, 128])
torch.Size([129869, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.7707457542419434  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06538158655166626 |0.038530007004737854 |0.04963204264640808 |9.629130363464355e-05 |0.009091809391975403 |0.0016891956329345703 |
----------------------------------------------------------pseudo_mini_loss sum 6.288272380828857
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5329652
Number of first layer input nodes during this epoch:  2521290
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.12847614288330078  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023298263549804688
range selection method range initialization spend 0.011469125747680664
time for parepare:  0.01682257652282715
local_output_nid generation:  0.0013492107391357422
local_in_edges_tensor generation:  0.00687098503112793
mini_batch_src_global generation:  0.002073526382446289
r_  generation:  0.020331382751464844
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0024383068084716797
r_  generation:  0.021025896072387695
local_output_nid generation:  0.001589059829711914
local_in_edges_tensor generation:  0.0010235309600830078
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.021599769592285156
local_output_nid generation:  0.0016741752624511719
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0015518665313720703
r_  generation:  0.02073192596435547
local_output_nid generation:  0.0015981197357177734
local_in_edges_tensor generation:  0.000934600830078125
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.021002531051635742
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0016138553619384766
r_  generation:  0.021301984786987305
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.005358695983886719
r_  generation:  0.021772146224975586
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0015985965728759766
r_  generation:  0.021088600158691406
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0016560554504394531
r_  generation:  0.021496057510375977
local_output_nid generation:  0.0016160011291503906
local_in_edges_tensor generation:  0.0009102821350097656
mini_batch_src_global generation:  0.0016777515411376953
r_  generation:  0.022146940231323242
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0016901493072509766
r_  generation:  0.02193593978881836
local_output_nid generation:  0.001550436019897461
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0016810894012451172
r_  generation:  0.0222165584564209
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0009374618530273438
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.022811412811279297
local_output_nid generation:  0.00153350830078125
local_in_edges_tensor generation:  0.0011055469512939453
mini_batch_src_global generation:  0.0019497871398925781
r_  generation:  0.022675275802612305
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0010190010070800781
mini_batch_src_global generation:  0.0017421245574951172
r_  generation:  0.02252364158630371
local_output_nid generation:  0.0015354156494140625
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0017027854919433594
r_  generation:  0.022457361221313477
----------------------check_connections_block total spend ----------------------------- 0.5176331996917725
generate_one_block  0.044306278228759766
generate_one_block  0.032289981842041016
generate_one_block  0.03223991394042969
generate_one_block  0.03072381019592285
generate_one_block  0.031076669692993164
generate_one_block  0.032921791076660156
generate_one_block  0.031461238861083984
generate_one_block  0.030056238174438477
generate_one_block  0.03113555908203125
generate_one_block  0.03204917907714844
generate_one_block  0.03086996078491211
generate_one_block  0.03227877616882324
generate_one_block  0.03190779685974121
generate_one_block  0.03194713592529297
generate_one_block  0.03169131278991699
generate_one_block  0.03201580047607422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04124116897583008
gen group dst list time:  0.0191953182220459
time for parepare:  0.018897294998168945
local_output_nid generation:  0.007306575775146484
local_in_edges_tensor generation:  0.02148890495300293
mini_batch_src_global generation:  0.027273178100585938
r_  generation:  0.25447559356689453
local_output_nid generation:  0.011098384857177734
local_in_edges_tensor generation:  0.0222625732421875
mini_batch_src_global generation:  0.032477617263793945
r_  generation:  0.25878286361694336
local_output_nid generation:  0.012022972106933594
local_in_edges_tensor generation:  0.01822042465209961
mini_batch_src_global generation:  0.03179287910461426
r_  generation:  0.2674882411956787
local_output_nid generation:  0.01206827163696289
local_in_edges_tensor generation:  0.017922401428222656
mini_batch_src_global generation:  0.03188347816467285
r_  generation:  0.2612721920013428
local_output_nid generation:  0.012008428573608398
local_in_edges_tensor generation:  0.015966415405273438
mini_batch_src_global generation:  0.03386974334716797
r_  generation:  0.26567840576171875
local_output_nid generation:  0.011941671371459961
local_in_edges_tensor generation:  0.02046823501586914
mini_batch_src_global generation:  0.03758573532104492
r_  generation:  0.2667391300201416
local_output_nid generation:  0.012000799179077148
local_in_edges_tensor generation:  0.013386964797973633
mini_batch_src_global generation:  0.0350642204284668
r_  generation:  0.26955437660217285
local_output_nid generation:  0.011830329895019531
local_in_edges_tensor generation:  0.013602018356323242
mini_batch_src_global generation:  0.03590989112854004
r_  generation:  0.2622411251068115
local_output_nid generation:  0.01202249526977539
local_in_edges_tensor generation:  0.013407468795776367
mini_batch_src_global generation:  0.03533148765563965
r_  generation:  0.26749253273010254
local_output_nid generation:  0.012362003326416016
local_in_edges_tensor generation:  0.01867985725402832
mini_batch_src_global generation:  0.034537553787231445
r_  generation:  0.2727663516998291
local_output_nid generation:  0.012008190155029297
local_in_edges_tensor generation:  0.015712976455688477
mini_batch_src_global generation:  0.03386235237121582
r_  generation:  0.26406049728393555
local_output_nid generation:  0.012408971786499023
local_in_edges_tensor generation:  0.016509532928466797
mini_batch_src_global generation:  0.03665781021118164
r_  generation:  0.2701082229614258
local_output_nid generation:  0.012462854385375977
local_in_edges_tensor generation:  0.018845081329345703
mini_batch_src_global generation:  0.03727149963378906
r_  generation:  0.27693629264831543
local_output_nid generation:  0.012315034866333008
local_in_edges_tensor generation:  0.01605391502380371
mini_batch_src_global generation:  0.03811144828796387
r_  generation:  0.2723712921142578
local_output_nid generation:  0.012404918670654297
local_in_edges_tensor generation:  0.014091968536376953
mini_batch_src_global generation:  0.03499245643615723
r_  generation:  0.2747647762298584
local_output_nid generation:  0.012212514877319336
local_in_edges_tensor generation:  0.014162540435791016
mini_batch_src_global generation:  0.03846120834350586
r_  generation:  0.2692253589630127
----------------------check_connections_block total spend ----------------------------- 6.223254442214966
generate_one_block  0.3592686653137207
generate_one_block  0.35489773750305176
generate_one_block  0.3596987724304199
generate_one_block  0.3445258140563965
generate_one_block  0.3561084270477295
generate_one_block  0.353776216506958
generate_one_block  0.4255235195159912
generate_one_block  0.3428792953491211
generate_one_block  0.347639799118042
generate_one_block  0.3654658794403076
generate_one_block  0.37639570236206055
generate_one_block  0.3672776222229004
generate_one_block  0.3792576789855957
generate_one_block  0.3680117130279541
generate_one_block  0.37355804443359375
generate_one_block  0.3509030342102051
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.11841678619384766
gen group dst list time:  0.07346034049987793
time for parepare:  0.018468856811523438
local_output_nid generation:  0.025356292724609375
local_in_edges_tensor generation:  0.0571136474609375
mini_batch_src_global generation:  0.053740739822387695
r_  generation:  0.5382254123687744
local_output_nid generation:  0.03425908088684082
local_in_edges_tensor generation:  0.05497264862060547
mini_batch_src_global generation:  0.06595182418823242
r_  generation:  0.5291800498962402
local_output_nid generation:  0.03245854377746582
local_in_edges_tensor generation:  0.038544654846191406
mini_batch_src_global generation:  0.059168338775634766
r_  generation:  0.5308399200439453
local_output_nid generation:  0.03241252899169922
local_in_edges_tensor generation:  0.04071331024169922
mini_batch_src_global generation:  0.05929374694824219
r_  generation:  0.5331680774688721
local_output_nid generation:  0.03276467323303223
local_in_edges_tensor generation:  0.09209275245666504
mini_batch_src_global generation:  0.06773114204406738
r_  generation:  0.547795295715332
local_output_nid generation:  0.03171968460083008
local_in_edges_tensor generation:  0.031720876693725586
mini_batch_src_global generation:  0.0667111873626709
r_  generation:  0.5395960807800293
local_output_nid generation:  0.0319516658782959
local_in_edges_tensor generation:  0.03630399703979492
mini_batch_src_global generation:  0.06559967994689941
r_  generation:  0.5459094047546387
local_output_nid generation:  0.032236576080322266
local_in_edges_tensor generation:  0.03169584274291992
mini_batch_src_global generation:  0.06144976615905762
r_  generation:  0.5474696159362793
local_output_nid generation:  0.033005475997924805
local_in_edges_tensor generation:  0.04581499099731445
mini_batch_src_global generation:  0.06231284141540527
r_  generation:  0.5630600452423096
local_output_nid generation:  0.03358125686645508
local_in_edges_tensor generation:  0.05170321464538574
mini_batch_src_global generation:  0.07078981399536133
r_  generation:  0.5469386577606201
local_output_nid generation:  0.03369879722595215
local_in_edges_tensor generation:  0.037850379943847656
mini_batch_src_global generation:  0.06394004821777344
r_  generation:  0.5437846183776855
local_output_nid generation:  0.0333552360534668
local_in_edges_tensor generation:  0.03158283233642578
mini_batch_src_global generation:  0.0608978271484375
r_  generation:  0.5397756099700928
local_output_nid generation:  0.0334169864654541
local_in_edges_tensor generation:  0.05023074150085449
mini_batch_src_global generation:  0.062020301818847656
r_  generation:  0.5417366027832031
local_output_nid generation:  0.03344273567199707
local_in_edges_tensor generation:  0.0310516357421875
mini_batch_src_global generation:  0.061530113220214844
r_  generation:  0.5505058765411377
local_output_nid generation:  0.03303122520446777
local_in_edges_tensor generation:  0.035692453384399414
mini_batch_src_global generation:  0.0614771842956543
r_  generation:  0.5508749485015869
local_output_nid generation:  0.03321027755737305
local_in_edges_tensor generation:  0.035959720611572266
mini_batch_src_global generation:  0.06136608123779297
r_  generation:  0.5539560317993164
----------------------check_connections_block total spend ----------------------------- 12.869832992553711
generate_one_block  0.6890718936920166
generate_one_block  0.7005572319030762
generate_one_block  0.6866943836212158
generate_one_block  0.6915280818939209
generate_one_block  0.7033967971801758
generate_one_block  0.7008395195007324
generate_one_block  0.6874616146087646
generate_one_block  0.6880121231079102
generate_one_block  0.7264397144317627
generate_one_block  0.7013096809387207
generate_one_block  0.6708204746246338
generate_one_block  0.6779177188873291
generate_one_block  0.7097561359405518
generate_one_block  0.679656982421875
generate_one_block  0.6886751651763916
generate_one_block  0.6848008632659912
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.12847614288330078  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

connection checking time:  19.093087434768677
block generation total time  16.912126302719116
average batch blocks generation time:  1.0570078939199448
block dataloader generation time/epoch 38.43984127044678
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 0.09988069534301758  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

torch.Size([157596, 128])
torch.Size([129983, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7763638496398926  GigaBytes
Max Memory Allocated: 0.8646726608276367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09983396530151367  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157625, 128])
torch.Size([129755, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725734710693359  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09980010986328125  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157326, 128])
torch.Size([129525, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7752981185913086  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09971284866333008  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157571, 128])
torch.Size([129860, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7711820602416992  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10073661804199219  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157853, 128])
torch.Size([130091, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7757987976074219  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09959077835083008  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157313, 128])
torch.Size([129568, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7695345878601074  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.0996713638305664  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157348, 128])
torch.Size([129375, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7696957588195801  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09965181350708008  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157757, 128])
torch.Size([129620, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7653646469116211  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10069656372070312  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157747, 128])
torch.Size([129933, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7707529067993164  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09997940063476562  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

torch.Size([157886, 128])
torch.Size([130788, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7812442779541016  GigaBytes
Max Memory Allocated: 0.8650522232055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09946680068969727  GigaBytes
Max Memory Allocated: 0.8701810836791992  GigaBytes

torch.Size([157293, 128])
torch.Size([129209, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7648715972900391  GigaBytes
Max Memory Allocated: 0.8701810836791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09962701797485352  GigaBytes
Max Memory Allocated: 0.8701810836791992  GigaBytes

torch.Size([157239, 128])
torch.Size([129745, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7731404304504395  GigaBytes
Max Memory Allocated: 0.8701810836791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.10094928741455078  GigaBytes
Max Memory Allocated: 0.8701810836791992  GigaBytes

torch.Size([157773, 128])
torch.Size([130693, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7819070816040039  GigaBytes
Max Memory Allocated: 0.8701810836791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09974956512451172  GigaBytes
Max Memory Allocated: 0.8707795143127441  GigaBytes

torch.Size([157448, 128])
torch.Size([129685, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7721395492553711  GigaBytes
Max Memory Allocated: 0.8707795143127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09976816177368164  GigaBytes
Max Memory Allocated: 0.8707795143127441  GigaBytes

torch.Size([157379, 128])
torch.Size([129646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.7725133895874023  GigaBytes
Max Memory Allocated: 0.8707795143127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.09964179992675781  GigaBytes
Max Memory Allocated: 0.8707795143127441  GigaBytes

torch.Size([157426, 128])
torch.Size([129795, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6658935546875 GB
    Memory Allocated: 0.770237922668457  GigaBytes
Max Memory Allocated: 0.8707795143127441  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06379951536655426 |0.016444623470306396 |0.003753289580345154 |9.69916582107544e-05 |0.005114108324050903 |0.0017414093017578125 |
----------------------------------------------------------pseudo_mini_loss sum 3.240302085876465
Total (block generation + training)time/epoch 39.93374562263489
Training time/epoch 1.4936187267303467
Training time without block to device /epoch 1.2305047512054443
Training time without total dataloading part /epoch 0.1451716423034668
load block tensor time/epoch 1.0207922458648682
block to device time/epoch 0.26311397552490234
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5328255
Number of first layer input nodes during this epoch:  2520580
