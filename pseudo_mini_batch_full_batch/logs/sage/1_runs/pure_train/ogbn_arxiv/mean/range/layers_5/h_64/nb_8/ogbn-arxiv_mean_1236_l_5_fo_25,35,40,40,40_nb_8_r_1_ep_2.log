Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648497092.9164424
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024898529052734375
range selection method range initialization spend 0.013513326644897461
time for parepare:  0.017948389053344727
local_output_nid generation:  0.003066539764404297
local_in_edges_tensor generation:  0.00458979606628418
mini_batch_src_global generation:  0.003331899642944336
r_  generation:  0.038394927978515625
local_output_nid generation:  0.0032494068145751953
local_in_edges_tensor generation:  0.0016222000122070312
mini_batch_src_global generation:  0.00402522087097168
r_  generation:  0.03900909423828125
local_output_nid generation:  0.0033969879150390625
local_in_edges_tensor generation:  0.0016162395477294922
mini_batch_src_global generation:  0.002814054489135742
r_  generation:  0.03959298133850098
local_output_nid generation:  0.0033805370330810547
local_in_edges_tensor generation:  0.001611948013305664
mini_batch_src_global generation:  0.0028090476989746094
r_  generation:  0.0407872200012207
local_output_nid generation:  0.0034759044647216797
local_in_edges_tensor generation:  0.0016260147094726562
mini_batch_src_global generation:  0.002845287322998047
r_  generation:  0.04112744331359863
local_output_nid generation:  0.0033540725708007812
local_in_edges_tensor generation:  0.0016961097717285156
mini_batch_src_global generation:  0.003177165985107422
r_  generation:  0.04136204719543457
local_output_nid generation:  0.0034296512603759766
local_in_edges_tensor generation:  0.0016353130340576172
mini_batch_src_global generation:  0.0030221939086914062
r_  generation:  0.04138588905334473
local_output_nid generation:  0.003534555435180664
local_in_edges_tensor generation:  0.0016107559204101562
mini_batch_src_global generation:  0.003062009811401367
r_  generation:  0.04195380210876465
----------------------check_connections_block total spend ----------------------------- 0.47617149353027344
generate_one_block  0.05512690544128418
generate_one_block  0.05517578125
generate_one_block  0.05535626411437988
generate_one_block  0.05488109588623047
generate_one_block  0.057413578033447266
generate_one_block  0.05445218086242676
generate_one_block  0.05443263053894043
generate_one_block  0.0546419620513916
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.041829824447631836
gen group dst list time:  0.015022516250610352
time for parepare:  0.01891469955444336
local_output_nid generation:  0.01073765754699707
local_in_edges_tensor generation:  0.029962778091430664
mini_batch_src_global generation:  0.030938148498535156
r_  generation:  0.2999856472015381
local_output_nid generation:  0.016063451766967773
local_in_edges_tensor generation:  0.028041839599609375
mini_batch_src_global generation:  0.036772966384887695
r_  generation:  0.309295654296875
local_output_nid generation:  0.016185283660888672
local_in_edges_tensor generation:  0.023289203643798828
mini_batch_src_global generation:  0.03602790832519531
r_  generation:  0.31968116760253906
local_output_nid generation:  0.016269683837890625
local_in_edges_tensor generation:  0.020618915557861328
mini_batch_src_global generation:  0.03678727149963379
r_  generation:  0.31548190116882324
local_output_nid generation:  0.016722917556762695
local_in_edges_tensor generation:  0.020621776580810547
mini_batch_src_global generation:  0.039943695068359375
r_  generation:  0.3190767765045166
local_output_nid generation:  0.016590595245361328
local_in_edges_tensor generation:  0.024030208587646484
mini_batch_src_global generation:  0.038279056549072266
r_  generation:  0.32006335258483887
local_output_nid generation:  0.016697406768798828
local_in_edges_tensor generation:  0.01819467544555664
mini_batch_src_global generation:  0.038431644439697266
r_  generation:  0.3185882568359375
local_output_nid generation:  0.01670384407043457
local_in_edges_tensor generation:  0.02105116844177246
mini_batch_src_global generation:  0.03779458999633789
r_  generation:  0.3173971176147461
----------------------check_connections_block total spend ----------------------------- 3.681074857711792
generate_one_block  0.41196107864379883
generate_one_block  0.419569730758667
generate_one_block  0.4139399528503418
generate_one_block  0.4046058654785156
generate_one_block  0.41489124298095703
generate_one_block  0.4199950695037842
generate_one_block  0.39923858642578125
generate_one_block  0.41013479232788086
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041236162185668945
gen group dst list time:  0.03712821006774902
time for parepare:  0.019153118133544922
local_output_nid generation:  0.026050090789794922
local_in_edges_tensor generation:  0.042774200439453125
mini_batch_src_global generation:  0.05339670181274414
r_  generation:  0.5330958366394043
local_output_nid generation:  0.03188896179199219
local_in_edges_tensor generation:  0.05839967727661133
mini_batch_src_global generation:  0.08427667617797852
r_  generation:  0.5360949039459229
local_output_nid generation:  0.03356528282165527
local_in_edges_tensor generation:  0.04715847969055176
mini_batch_src_global generation:  0.06276535987854004
r_  generation:  0.545785665512085
local_output_nid generation:  0.03911542892456055
local_in_edges_tensor generation:  0.04147219657897949
mini_batch_src_global generation:  0.0737149715423584
r_  generation:  0.537764310836792
local_output_nid generation:  0.03390145301818848
local_in_edges_tensor generation:  0.037073612213134766
mini_batch_src_global generation:  0.05989217758178711
r_  generation:  0.5637283325195312
local_output_nid generation:  0.03399348258972168
local_in_edges_tensor generation:  0.03690314292907715
mini_batch_src_global generation:  0.062436819076538086
r_  generation:  0.542147159576416
local_output_nid generation:  0.03419899940490723
local_in_edges_tensor generation:  0.03744029998779297
mini_batch_src_global generation:  0.0639352798461914
r_  generation:  0.5523810386657715
local_output_nid generation:  0.034377336502075195
local_in_edges_tensor generation:  0.0331873893737793
mini_batch_src_global generation:  0.06499767303466797
r_  generation:  0.5427296161651611
----------------------check_connections_block total spend ----------------------------- 6.444284915924072
generate_one_block  0.7036571502685547
generate_one_block  0.6894469261169434
generate_one_block  0.6895911693572998
generate_one_block  0.6765449047088623
generate_one_block  0.6913268566131592
generate_one_block  0.7157881259918213
generate_one_block  0.6933314800262451
generate_one_block  0.6735260486602783
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06407737731933594
gen group dst list time:  0.04583430290222168
time for parepare:  0.019185781478881836
local_output_nid generation:  0.030918598175048828
local_in_edges_tensor generation:  0.06163167953491211
mini_batch_src_global generation:  0.050131797790527344
r_  generation:  0.542851448059082
local_output_nid generation:  0.03659629821777344
local_in_edges_tensor generation:  0.05605816841125488
mini_batch_src_global generation:  0.06572818756103516
r_  generation:  0.5434842109680176
local_output_nid generation:  0.03659796714782715
local_in_edges_tensor generation:  0.04709315299987793
mini_batch_src_global generation:  0.06597638130187988
r_  generation:  0.5501277446746826
local_output_nid generation:  0.0369110107421875
local_in_edges_tensor generation:  0.04214191436767578
mini_batch_src_global generation:  0.05890488624572754
r_  generation:  0.5509448051452637
local_output_nid generation:  0.03704214096069336
local_in_edges_tensor generation:  0.03764176368713379
mini_batch_src_global generation:  0.05975222587585449
r_  generation:  0.5587618350982666
local_output_nid generation:  0.03795456886291504
local_in_edges_tensor generation:  0.05339455604553223
mini_batch_src_global generation:  0.05929994583129883
r_  generation:  0.5528960227966309
local_output_nid generation:  0.037366390228271484
local_in_edges_tensor generation:  0.05036425590515137
mini_batch_src_global generation:  0.06315183639526367
r_  generation:  0.5629298686981201
local_output_nid generation:  0.037735700607299805
local_in_edges_tensor generation:  0.04110002517700195
mini_batch_src_global generation:  0.05937600135803223
r_  generation:  0.5801918506622314
----------------------check_connections_block total spend ----------------------------- 6.628036022186279
generate_one_block  0.7078139781951904
generate_one_block  0.7091586589813232
generate_one_block  0.6917569637298584
generate_one_block  0.6937787532806396
generate_one_block  0.6940567493438721
generate_one_block  0.6831655502319336
generate_one_block  0.7430329322814941
generate_one_block  0.6897602081298828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049701690673828125
gen group dst list time:  0.047476768493652344
time for parepare:  0.018976449966430664
local_output_nid generation:  0.03168344497680664
local_in_edges_tensor generation:  0.04458117485046387
mini_batch_src_global generation:  0.046129703521728516
r_  generation:  0.5003881454467773
local_output_nid generation:  0.03717637062072754
local_in_edges_tensor generation:  0.038034677505493164
mini_batch_src_global generation:  0.05902528762817383
r_  generation:  0.5161120891571045
local_output_nid generation:  0.037331581115722656
local_in_edges_tensor generation:  0.037262916564941406
mini_batch_src_global generation:  0.05865764617919922
r_  generation:  0.5075690746307373
local_output_nid generation:  0.037817955017089844
local_in_edges_tensor generation:  0.03858041763305664
mini_batch_src_global generation:  0.05957388877868652
r_  generation:  0.5184125900268555
local_output_nid generation:  0.03799295425415039
local_in_edges_tensor generation:  0.03771519660949707
mini_batch_src_global generation:  0.058258056640625
r_  generation:  0.5159323215484619
local_output_nid generation:  0.03799080848693848
local_in_edges_tensor generation:  0.04302215576171875
mini_batch_src_global generation:  0.058051347732543945
r_  generation:  0.5215785503387451
local_output_nid generation:  0.037979841232299805
local_in_edges_tensor generation:  0.04378700256347656
mini_batch_src_global generation:  0.06096649169921875
r_  generation:  0.5289504528045654
local_output_nid generation:  0.038221120834350586
local_in_edges_tensor generation:  0.035581350326538086
mini_batch_src_global generation:  0.05767202377319336
r_  generation:  0.5200831890106201
----------------------check_connections_block total spend ----------------------------- 6.161682605743408
generate_one_block  0.6526296138763428
generate_one_block  0.6449224948883057
generate_one_block  0.6429851055145264
generate_one_block  0.6306858062744141
generate_one_block  0.6355841159820557
generate_one_block  0.6316440105438232
generate_one_block  0.639944314956665
generate_one_block  0.6923732757568359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

connection checking time:  22.91507840156555
block generation total time  19.610841512680054
average batch blocks generation time:  2.4513551890850067
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12614965438842773  GigaBytes
Max Memory Allocated: 0.12614965438842773  GigaBytes

torch.Size([167054, 128])
torch.Size([165925, 64])
torch.Size([161590, 64])
torch.Size([142457, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.6891674995422363  GigaBytes
Max Memory Allocated: 0.7018823623657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 0.1278376579284668  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([167019, 128])
torch.Size([165832, 64])
torch.Size([161343, 64])
torch.Size([141887, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 0.6873297691345215  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1284923553466797  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([167043, 128])
torch.Size([165890, 64])
torch.Size([161611, 64])
torch.Size([142336, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6891789436340332  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12728023529052734  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166953, 128])
torch.Size([165685, 64])
torch.Size([161176, 64])
torch.Size([141669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6855020523071289  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12853145599365234  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([167014, 128])
torch.Size([165759, 64])
torch.Size([161433, 64])
torch.Size([142360, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6887640953063965  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12830305099487305  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166869, 128])
torch.Size([165636, 64])
torch.Size([161272, 64])
torch.Size([141796, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.686676025390625  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12839365005493164  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166988, 128])
torch.Size([165753, 64])
torch.Size([161290, 64])
torch.Size([141973, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6877250671386719  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12741518020629883  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166966, 128])
torch.Size([165688, 64])
torch.Size([161246, 64])
torch.Size([141727, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6862034797668457  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06438514590263367 |0.07634568214416504 |0.09307783842086792 |0.00010570883750915527 |0.014293372631072998 |0.0032668113708496094 |
----------------------------------------------------------pseudo_mini_loss sum 5.511471748352051
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5632284
Number of first layer input nodes during this epoch:  1335906
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.22600650787353516  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.021428585052490234
range selection method range initialization spend 0.012128114700317383
time for parepare:  0.017048358917236328
local_output_nid generation:  0.003126859664916992
local_in_edges_tensor generation:  0.004896402359008789
mini_batch_src_global generation:  0.0036284923553466797
r_  generation:  0.03960824012756348
local_output_nid generation:  0.0037653446197509766
local_in_edges_tensor generation:  0.0018973350524902344
mini_batch_src_global generation:  0.004195690155029297
r_  generation:  0.04059195518493652
local_output_nid generation:  0.00610804557800293
local_in_edges_tensor generation:  0.002025127410888672
mini_batch_src_global generation:  0.0028481483459472656
r_  generation:  0.04071235656738281
local_output_nid generation:  0.003838777542114258
local_in_edges_tensor generation:  0.0017371177673339844
mini_batch_src_global generation:  0.0028667449951171875
r_  generation:  0.041559696197509766
local_output_nid generation:  0.0037508010864257812
local_in_edges_tensor generation:  0.0018014907836914062
mini_batch_src_global generation:  0.003000020980834961
r_  generation:  0.04164886474609375
local_output_nid generation:  0.003767251968383789
local_in_edges_tensor generation:  0.0017948150634765625
mini_batch_src_global generation:  0.003194093704223633
r_  generation:  0.043053627014160156
local_output_nid generation:  0.003776073455810547
local_in_edges_tensor generation:  0.0018520355224609375
mini_batch_src_global generation:  0.0032553672790527344
r_  generation:  0.04214358329772949
local_output_nid generation:  0.003763437271118164
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.003174304962158203
r_  generation:  0.0420687198638916
----------------------check_connections_block total spend ----------------------------- 0.5036659240722656
generate_one_block  0.0644218921661377
generate_one_block  0.05578804016113281
generate_one_block  0.05462145805358887
generate_one_block  0.05476236343383789
generate_one_block  0.054160118103027344
generate_one_block  0.05487060546875
generate_one_block  0.056032657623291016
generate_one_block  0.057749032974243164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04372119903564453
gen group dst list time:  0.014422893524169922
time for parepare:  0.0198214054107666
local_output_nid generation:  0.01068878173828125
local_in_edges_tensor generation:  0.03668618202209473
mini_batch_src_global generation:  0.030804157257080078
r_  generation:  0.29976439476013184
local_output_nid generation:  0.019042015075683594
local_in_edges_tensor generation:  0.029894590377807617
mini_batch_src_global generation:  0.04093003273010254
r_  generation:  0.31410670280456543
local_output_nid generation:  0.020681381225585938
local_in_edges_tensor generation:  0.029134750366210938
mini_batch_src_global generation:  0.036185264587402344
r_  generation:  0.32240915298461914
local_output_nid generation:  0.02100658416748047
local_in_edges_tensor generation:  0.019061565399169922
mini_batch_src_global generation:  0.038349151611328125
r_  generation:  0.32373857498168945
local_output_nid generation:  0.020549774169921875
local_in_edges_tensor generation:  0.018660545349121094
mini_batch_src_global generation:  0.037491798400878906
r_  generation:  0.3211557865142822
local_output_nid generation:  0.020653724670410156
local_in_edges_tensor generation:  0.024559736251831055
mini_batch_src_global generation:  0.04251265525817871
r_  generation:  0.3306901454925537
local_output_nid generation:  0.020574331283569336
local_in_edges_tensor generation:  0.03385353088378906
mini_batch_src_global generation:  0.044434547424316406
r_  generation:  0.32479095458984375
local_output_nid generation:  0.017720460891723633
local_in_edges_tensor generation:  0.02173018455505371
mini_batch_src_global generation:  0.03960919380187988
r_  generation:  0.3258242607116699
----------------------check_connections_block total spend ----------------------------- 3.8231911659240723
generate_one_block  0.4235341548919678
generate_one_block  0.41684389114379883
generate_one_block  0.4143681526184082
generate_one_block  0.4040687084197998
generate_one_block  0.4106171131134033
generate_one_block  0.41176867485046387
generate_one_block  0.41715192794799805
generate_one_block  0.44859766960144043
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043082237243652344
gen group dst list time:  0.03960227966308594
time for parepare:  0.02034616470336914
local_output_nid generation:  0.026263952255249023
local_in_edges_tensor generation:  0.062428951263427734
mini_batch_src_global generation:  0.04879188537597656
r_  generation:  0.5343499183654785
local_output_nid generation:  0.032677412033081055
local_in_edges_tensor generation:  0.05219697952270508
mini_batch_src_global generation:  0.060799598693847656
r_  generation:  0.5389142036437988
local_output_nid generation:  0.03281235694885254
local_in_edges_tensor generation:  0.042760372161865234
mini_batch_src_global generation:  0.056191205978393555
r_  generation:  0.550966739654541
local_output_nid generation:  0.04455137252807617
local_in_edges_tensor generation:  0.037557363510131836
mini_batch_src_global generation:  0.060303449630737305
r_  generation:  0.5355064868927002
local_output_nid generation:  0.03631138801574707
local_in_edges_tensor generation:  0.03351926803588867
mini_batch_src_global generation:  0.0621945858001709
r_  generation:  0.5575788021087646
local_output_nid generation:  0.033702850341796875
local_in_edges_tensor generation:  0.03587841987609863
mini_batch_src_global generation:  0.06120181083679199
r_  generation:  0.5471482276916504
local_output_nid generation:  0.03342032432556152
local_in_edges_tensor generation:  0.04589438438415527
mini_batch_src_global generation:  0.05903792381286621
r_  generation:  0.555687665939331
local_output_nid generation:  0.033652305603027344
local_in_edges_tensor generation:  0.0477747917175293
mini_batch_src_global generation:  0.06170153617858887
r_  generation:  0.5548923015594482
----------------------check_connections_block total spend ----------------------------- 6.425625324249268
generate_one_block  0.6788434982299805
generate_one_block  0.6914210319519043
generate_one_block  0.686793327331543
generate_one_block  0.6785557270050049
generate_one_block  0.6935622692108154
generate_one_block  0.7063288688659668
generate_one_block  0.6952247619628906
generate_one_block  0.693535327911377
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05008363723754883
gen group dst list time:  0.05325913429260254
time for parepare:  0.019099712371826172
local_output_nid generation:  0.031073808670043945
local_in_edges_tensor generation:  0.06144118309020996
mini_batch_src_global generation:  0.053148746490478516
r_  generation:  0.5471494197845459
local_output_nid generation:  0.038446903228759766
local_in_edges_tensor generation:  0.08713293075561523
mini_batch_src_global generation:  0.06263995170593262
r_  generation:  0.5515470504760742
local_output_nid generation:  0.036984920501708984
local_in_edges_tensor generation:  0.05122685432434082
mini_batch_src_global generation:  0.0626075267791748
r_  generation:  0.5554511547088623
local_output_nid generation:  0.036947011947631836
local_in_edges_tensor generation:  0.041104793548583984
mini_batch_src_global generation:  0.058209896087646484
r_  generation:  0.5535738468170166
local_output_nid generation:  0.03707122802734375
local_in_edges_tensor generation:  0.04036259651184082
mini_batch_src_global generation:  0.059273481369018555
r_  generation:  0.5697226524353027
local_output_nid generation:  0.037235260009765625
local_in_edges_tensor generation:  0.0514674186706543
mini_batch_src_global generation:  0.0591428279876709
r_  generation:  0.5763919353485107
local_output_nid generation:  0.037247419357299805
local_in_edges_tensor generation:  0.03585410118103027
mini_batch_src_global generation:  0.059575557708740234
r_  generation:  0.5676794052124023
local_output_nid generation:  0.03738713264465332
local_in_edges_tensor generation:  0.03889894485473633
mini_batch_src_global generation:  0.06292271614074707
r_  generation:  0.5673222541809082
----------------------check_connections_block total spend ----------------------------- 6.688758134841919
generate_one_block  0.6910223960876465
generate_one_block  0.6908175945281982
generate_one_block  0.7012653350830078
generate_one_block  0.6942784786224365
generate_one_block  0.693683385848999
generate_one_block  0.6985406875610352
generate_one_block  0.6780338287353516
generate_one_block  0.6936755180358887
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03232598304748535
gen group dst list time:  0.04736900329589844
time for parepare:  0.0191495418548584
local_output_nid generation:  0.03134036064147949
local_in_edges_tensor generation:  0.04673027992248535
mini_batch_src_global generation:  0.04533576965332031
r_  generation:  0.5093638896942139
local_output_nid generation:  0.037355661392211914
local_in_edges_tensor generation:  0.035205841064453125
mini_batch_src_global generation:  0.058028221130371094
r_  generation:  0.5147819519042969
local_output_nid generation:  0.03813290596008301
local_in_edges_tensor generation:  0.037570953369140625
mini_batch_src_global generation:  0.0588223934173584
r_  generation:  0.5157203674316406
local_output_nid generation:  0.03817319869995117
local_in_edges_tensor generation:  0.03626823425292969
mini_batch_src_global generation:  0.05908489227294922
r_  generation:  0.5172595977783203
local_output_nid generation:  0.03989529609680176
local_in_edges_tensor generation:  0.03957653045654297
mini_batch_src_global generation:  0.0587620735168457
r_  generation:  0.517460823059082
local_output_nid generation:  0.03875875473022461
local_in_edges_tensor generation:  0.0767202377319336
mini_batch_src_global generation:  0.05799984931945801
r_  generation:  0.5208249092102051
local_output_nid generation:  0.03921771049499512
local_in_edges_tensor generation:  0.037186384201049805
mini_batch_src_global generation:  0.05779004096984863
r_  generation:  0.5175831317901611
local_output_nid generation:  0.03934669494628906
local_in_edges_tensor generation:  0.040299415588378906
mini_batch_src_global generation:  0.057587385177612305
r_  generation:  0.5328466892242432
----------------------check_connections_block total spend ----------------------------- 6.222811222076416
generate_one_block  0.6395833492279053
generate_one_block  0.6460497379302979
generate_one_block  0.6474514007568359
generate_one_block  0.6587333679199219
generate_one_block  0.652362585067749
generate_one_block  0.6416170597076416
generate_one_block  0.6443557739257812
generate_one_block  0.6603543758392334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.22600650787353516  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

connection checking time:  23.160385847091675
block generation total time  19.603039979934692
average batch blocks generation time:  2.4503799974918365
block dataloader generation time/epoch 45.41132044792175
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12882232666015625  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166964, 128])
torch.Size([165730, 64])
torch.Size([161312, 64])
torch.Size([141894, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6884164810180664  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12892484664916992  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166940, 128])
torch.Size([165665, 64])
torch.Size([161287, 64])
torch.Size([142134, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.688687801361084  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1289081573486328  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166907, 128])
torch.Size([165684, 64])
torch.Size([161375, 64])
torch.Size([142336, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6892952919006348  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12859821319580078  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166961, 128])
torch.Size([165734, 64])
torch.Size([161360, 64])
torch.Size([141919, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6869935989379883  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12872982025146484  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166957, 128])
torch.Size([165777, 64])
torch.Size([161327, 64])
torch.Size([141894, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6883869171142578  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12877464294433594  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166982, 128])
torch.Size([165747, 64])
torch.Size([161439, 64])
torch.Size([141904, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6878867149353027  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12891769409179688  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([166918, 128])
torch.Size([165691, 64])
torch.Size([161293, 64])
torch.Size([141961, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6887049674987793  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.12869930267333984  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

torch.Size([167056, 128])
torch.Size([165881, 64])
torch.Size([161497, 64])
torch.Size([141983, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.6874785423278809  GigaBytes
Max Memory Allocated: 0.7211446762084961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06676757335662842 |0.04433980584144592 |0.005619853734970093 |9.757280349731445e-05 |0.006503403186798096 |0.004869699478149414 |
----------------------------------------------------------pseudo_mini_loss sum 4.437187194824219
Total (block generation + training)time/epoch 46.45872783660889
Training time/epoch 1.047084093093872
Training time without block to device /epoch 0.6923656463623047
Training time without total dataloading part /epoch 0.10263633728027344
load block tensor time/epoch 0.5341405868530273
block to device time/epoch 0.3547184467315674
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5631559
Number of first layer input nodes during this epoch:  1335685
