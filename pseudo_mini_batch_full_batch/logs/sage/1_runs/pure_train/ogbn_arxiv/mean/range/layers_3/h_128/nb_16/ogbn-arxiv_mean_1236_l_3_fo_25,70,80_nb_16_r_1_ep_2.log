Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648450501.471667
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02683734893798828
range selection method range initialization spend 0.017367839813232422
time for parepare:  0.018178224563598633
local_output_nid generation:  0.0013203620910644531
local_in_edges_tensor generation:  0.0037047863006591797
mini_batch_src_global generation:  0.002295255661010742
r_  generation:  0.022412776947021484
local_output_nid generation:  0.001554727554321289
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0027184486389160156
r_  generation:  0.020900726318359375
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.020959138870239258
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0015568733215332031
r_  generation:  0.020452499389648438
local_output_nid generation:  0.0015287399291992188
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0015592575073242188
r_  generation:  0.02233266830444336
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.001936197280883789
r_  generation:  0.023165464401245117
local_output_nid generation:  0.0015187263488769531
local_in_edges_tensor generation:  0.0008945465087890625
mini_batch_src_global generation:  0.0020461082458496094
r_  generation:  0.025122404098510742
local_output_nid generation:  0.001516580581665039
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.002029895782470703
r_  generation:  0.0237271785736084
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0021102428436279297
r_  generation:  0.02424454689025879
local_output_nid generation:  0.001569986343383789
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0021288394927978516
r_  generation:  0.023885488510131836
local_output_nid generation:  0.0015442371368408203
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0021424293518066406
r_  generation:  0.02445363998413086
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.002127408981323242
r_  generation:  0.024308443069458008
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0020956993103027344
r_  generation:  0.022056102752685547
local_output_nid generation:  0.001588582992553711
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.022287845611572266
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0017895698547363281
r_  generation:  0.022406339645385742
local_output_nid generation:  0.0015153884887695312
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0017898082733154297
r_  generation:  0.021918058395385742
----------------------check_connections_block total spend ----------------------------- 0.5418572425842285
generate_one_block  0.02946782112121582
generate_one_block  0.031656742095947266
generate_one_block  0.033507347106933594
generate_one_block  0.030940532684326172
generate_one_block  0.030775785446166992
generate_one_block  0.03109145164489746
generate_one_block  0.03242850303649902
generate_one_block  0.030873537063598633
generate_one_block  0.03167891502380371
generate_one_block  0.031208038330078125
generate_one_block  0.0322117805480957
generate_one_block  0.031830787658691406
generate_one_block  0.031383514404296875
generate_one_block  0.03143596649169922
generate_one_block  0.03189206123352051
generate_one_block  0.031067371368408203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039827823638916016
gen group dst list time:  0.020757675170898438
time for parepare:  0.01920342445373535
local_output_nid generation:  0.0071468353271484375
local_in_edges_tensor generation:  0.01766681671142578
mini_batch_src_global generation:  0.026947021484375
r_  generation:  0.2446146011352539
local_output_nid generation:  0.01099085807800293
local_in_edges_tensor generation:  0.021640539169311523
mini_batch_src_global generation:  0.0316164493560791
r_  generation:  0.25535130500793457
local_output_nid generation:  0.011440038681030273
local_in_edges_tensor generation:  0.015436410903930664
mini_batch_src_global generation:  0.032291412353515625
r_  generation:  0.26702237129211426
local_output_nid generation:  0.011527538299560547
local_in_edges_tensor generation:  0.01529073715209961
mini_batch_src_global generation:  0.032475948333740234
r_  generation:  0.2641470432281494
local_output_nid generation:  0.011830806732177734
local_in_edges_tensor generation:  0.017589807510375977
mini_batch_src_global generation:  0.033722877502441406
r_  generation:  0.26638174057006836
local_output_nid generation:  0.01193547248840332
local_in_edges_tensor generation:  0.01547551155090332
mini_batch_src_global generation:  0.03432130813598633
r_  generation:  0.26525211334228516
local_output_nid generation:  0.012370824813842773
local_in_edges_tensor generation:  0.018710613250732422
mini_batch_src_global generation:  0.03479790687561035
r_  generation:  0.2787594795227051
local_output_nid generation:  0.012109041213989258
local_in_edges_tensor generation:  0.015799283981323242
mini_batch_src_global generation:  0.03470802307128906
r_  generation:  0.26695847511291504
local_output_nid generation:  0.012566804885864258
local_in_edges_tensor generation:  0.01398015022277832
mini_batch_src_global generation:  0.034882545471191406
r_  generation:  0.27637386322021484
local_output_nid generation:  0.012292146682739258
local_in_edges_tensor generation:  0.013653755187988281
mini_batch_src_global generation:  0.037366628646850586
r_  generation:  0.27405643463134766
local_output_nid generation:  0.01275777816772461
local_in_edges_tensor generation:  0.018481969833374023
mini_batch_src_global generation:  0.03524017333984375
r_  generation:  0.278759241104126
local_output_nid generation:  0.012428760528564453
local_in_edges_tensor generation:  0.02092266082763672
mini_batch_src_global generation:  0.03475666046142578
r_  generation:  0.2732813358306885
local_output_nid generation:  0.012292861938476562
local_in_edges_tensor generation:  0.013713598251342773
mini_batch_src_global generation:  0.03425908088684082
r_  generation:  0.2714388370513916
local_output_nid generation:  0.012543201446533203
local_in_edges_tensor generation:  0.016283273696899414
mini_batch_src_global generation:  0.034844398498535156
r_  generation:  0.2722756862640381
local_output_nid generation:  0.0125732421875
local_in_edges_tensor generation:  0.020969629287719727
mini_batch_src_global generation:  0.040088653564453125
r_  generation:  0.2743687629699707
local_output_nid generation:  0.012282371520996094
local_in_edges_tensor generation:  0.013952016830444336
mini_batch_src_global generation:  0.0345461368560791
r_  generation:  0.2683756351470947
----------------------check_connections_block total spend ----------------------------- 6.242645263671875
generate_one_block  0.34389805793762207
generate_one_block  0.346386194229126
generate_one_block  0.3586902618408203
generate_one_block  0.3466181755065918
generate_one_block  0.3637819290161133
generate_one_block  0.3522365093231201
generate_one_block  0.36634325981140137
generate_one_block  0.3415970802307129
generate_one_block  0.3629117012023926
generate_one_block  0.3529927730560303
generate_one_block  0.36472535133361816
generate_one_block  0.34984874725341797
generate_one_block  0.3514726161956787
generate_one_block  0.35460710525512695
generate_one_block  0.3683958053588867
generate_one_block  0.34172558784484863
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03426241874694824
gen group dst list time:  0.06231331825256348
time for parepare:  0.019100189208984375
local_output_nid generation:  0.02529311180114746
local_in_edges_tensor generation:  0.038152456283569336
mini_batch_src_global generation:  0.04573178291320801
r_  generation:  0.45240354537963867
local_output_nid generation:  0.031005382537841797
local_in_edges_tensor generation:  0.045236825942993164
mini_batch_src_global generation:  0.05273604393005371
r_  generation:  0.4609541893005371
local_output_nid generation:  0.031106233596801758
local_in_edges_tensor generation:  0.040862083435058594
mini_batch_src_global generation:  0.05103349685668945
r_  generation:  0.4680912494659424
local_output_nid generation:  0.03129935264587402
local_in_edges_tensor generation:  0.030015945434570312
mini_batch_src_global generation:  0.05208015441894531
r_  generation:  0.46643710136413574
local_output_nid generation:  0.03162050247192383
local_in_edges_tensor generation:  0.03380417823791504
mini_batch_src_global generation:  0.05598115921020508
r_  generation:  0.4754929542541504
local_output_nid generation:  0.03159213066101074
local_in_edges_tensor generation:  0.030129432678222656
mini_batch_src_global generation:  0.05338239669799805
r_  generation:  0.47210073471069336
local_output_nid generation:  0.03179931640625
local_in_edges_tensor generation:  0.03401803970336914
mini_batch_src_global generation:  0.053490400314331055
r_  generation:  0.47554636001586914
local_output_nid generation:  0.03161740303039551
local_in_edges_tensor generation:  0.030126571655273438
mini_batch_src_global generation:  0.05418801307678223
r_  generation:  0.4798734188079834
local_output_nid generation:  0.0321955680847168
local_in_edges_tensor generation:  0.03846025466918945
mini_batch_src_global generation:  0.053318023681640625
r_  generation:  0.4791381359100342
local_output_nid generation:  0.031862497329711914
local_in_edges_tensor generation:  0.03410744667053223
mini_batch_src_global generation:  0.05449199676513672
r_  generation:  0.4772336483001709
local_output_nid generation:  0.03217315673828125
local_in_edges_tensor generation:  0.04193305969238281
mini_batch_src_global generation:  0.05438041687011719
r_  generation:  0.4832432270050049
local_output_nid generation:  0.032334327697753906
local_in_edges_tensor generation:  0.030423879623413086
mini_batch_src_global generation:  0.05475783348083496
r_  generation:  0.4749915599822998
local_output_nid generation:  0.03256058692932129
local_in_edges_tensor generation:  0.03032374382019043
mini_batch_src_global generation:  0.05358242988586426
r_  generation:  0.4771583080291748
local_output_nid generation:  0.032067298889160156
local_in_edges_tensor generation:  0.03417539596557617
mini_batch_src_global generation:  0.05457949638366699
r_  generation:  0.47911763191223145
local_output_nid generation:  0.0322723388671875
local_in_edges_tensor generation:  0.03405928611755371
mini_batch_src_global generation:  0.05422782897949219
r_  generation:  0.4813225269317627
local_output_nid generation:  0.03233146667480469
local_in_edges_tensor generation:  0.03092789649963379
mini_batch_src_global generation:  0.054926156997680664
r_  generation:  0.48080897331237793
----------------------check_connections_block total spend ----------------------------- 11.190623760223389
generate_one_block  0.5920746326446533
generate_one_block  0.5970644950866699
generate_one_block  0.6010034084320068
generate_one_block  0.5865063667297363
generate_one_block  0.588202953338623
generate_one_block  0.5913140773773193
generate_one_block  0.6479887962341309
generate_one_block  0.601067066192627
generate_one_block  0.6163356304168701
generate_one_block  0.6039457321166992
generate_one_block  0.6171000003814697
generate_one_block  0.5864665508270264
generate_one_block  0.5959300994873047
generate_one_block  0.6071457862854004
generate_one_block  0.5970299243927002
generate_one_block  0.588026762008667
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  17.433269023895264
block generation total time  15.283433437347412
average batch blocks generation time:  0.9552145898342133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09248828887939453  GigaBytes
Max Memory Allocated: 0.09248828887939453  GigaBytes

torch.Size([156623, 128])
torch.Size([129560, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.47010087966918945  GigaBytes
Max Memory Allocated: 0.48940610885620117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.09467315673828125  GigaBytes
Max Memory Allocated: 0.5128488540649414  GigaBytes

torch.Size([156904, 128])
torch.Size([129983, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47116518020629883  GigaBytes
Max Memory Allocated: 0.5128488540649414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09487390518188477  GigaBytes
Max Memory Allocated: 0.5139355659484863  GigaBytes

torch.Size([156849, 128])
torch.Size([129978, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.473388671875  GigaBytes
Max Memory Allocated: 0.5139355659484863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09455299377441406  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

torch.Size([156746, 128])
torch.Size([129364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47084999084472656  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09451580047607422  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

torch.Size([156454, 128])
torch.Size([129324, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47084617614746094  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09454727172851562  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

torch.Size([156532, 128])
torch.Size([129260, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47118520736694336  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.0950627326965332  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

torch.Size([156955, 128])
torch.Size([130258, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4764137268066406  GigaBytes
Max Memory Allocated: 0.5170993804931641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.0946035385131836  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156710, 128])
torch.Size([128923, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.46677589416503906  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09509134292602539  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([157159, 128])
torch.Size([130461, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47411394119262695  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09478044509887695  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156955, 128])
torch.Size([129909, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4714207649230957  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09520959854125977  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([157337, 128])
torch.Size([130878, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4752011299133301  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09475994110107422  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156788, 128])
torch.Size([130053, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4734029769897461  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09473085403442383  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156779, 128])
torch.Size([129865, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47179698944091797  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09488201141357422  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156990, 128])
torch.Size([130325, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47325992584228516  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09486722946166992  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156873, 128])
torch.Size([130021, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4729428291320801  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09469795227050781  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156968, 128])
torch.Size([129995, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4709901809692383  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03965809941291809 |0.03493659198284149 |0.04959838092327118 |9.705126285552979e-05 |0.007460311055183411 |0.003757476806640625 |
----------------------------------------------------------pseudo_mini_loss sum 5.622796058654785
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5317327
Number of first layer input nodes during this epoch:  2509622
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.12185335159301758  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02079010009765625
range selection method range initialization spend 0.011559009552001953
time for parepare:  0.017376422882080078
local_output_nid generation:  0.0013828277587890625
local_in_edges_tensor generation:  0.004118680953979492
mini_batch_src_global generation:  0.0023577213287353516
r_  generation:  0.02501201629638672
local_output_nid generation:  0.0034019947052001953
local_in_edges_tensor generation:  0.0042362213134765625
mini_batch_src_global generation:  0.011462211608886719
r_  generation:  0.022705793380737305
local_output_nid generation:  0.0016713142395019531
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0015988349914550781
r_  generation:  0.0429692268371582
local_output_nid generation:  0.002595663070678711
local_in_edges_tensor generation:  0.0013682842254638672
mini_batch_src_global generation:  0.002347230911254883
r_  generation:  0.022382259368896484
local_output_nid generation:  0.0017981529235839844
local_in_edges_tensor generation:  0.0011670589447021484
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.021262168884277344
local_output_nid generation:  0.001672506332397461
local_in_edges_tensor generation:  0.000986337661743164
mini_batch_src_global generation:  0.0016245841979980469
r_  generation:  0.021513700485229492
local_output_nid generation:  0.0016682147979736328
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.001695394515991211
r_  generation:  0.0218045711517334
local_output_nid generation:  0.0016634464263916016
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0016798973083496094
r_  generation:  0.0216519832611084
local_output_nid generation:  0.0017020702362060547
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.0017096996307373047
r_  generation:  0.022422313690185547
local_output_nid generation:  0.0016283988952636719
local_in_edges_tensor generation:  0.0008940696716308594
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.022362470626831055
local_output_nid generation:  0.001626729965209961
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.022935867309570312
local_output_nid generation:  0.0016753673553466797
local_in_edges_tensor generation:  0.0009455680847167969
mini_batch_src_global generation:  0.0017647743225097656
r_  generation:  0.022027254104614258
local_output_nid generation:  0.0016450881958007812
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0017921924591064453
r_  generation:  0.02293682098388672
local_output_nid generation:  0.0016942024230957031
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0017952919006347656
r_  generation:  0.022406578063964844
local_output_nid generation:  0.0016641616821289062
local_in_edges_tensor generation:  0.0015833377838134766
mini_batch_src_global generation:  0.0019497871398925781
r_  generation:  0.02239704132080078
local_output_nid generation:  0.0016548633575439453
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0018146038055419922
r_  generation:  0.022150278091430664
----------------------check_connections_block total spend ----------------------------- 0.5761561393737793
generate_one_block  0.03693509101867676
generate_one_block  0.031115055084228516
generate_one_block  0.03149819374084473
generate_one_block  0.03182220458984375
generate_one_block  0.0310056209564209
generate_one_block  0.03287196159362793
generate_one_block  0.030858516693115234
generate_one_block  0.03142714500427246
generate_one_block  0.03249478340148926
generate_one_block  0.03203320503234863
generate_one_block  0.032025814056396484
generate_one_block  0.03146028518676758
generate_one_block  0.03257489204406738
generate_one_block  0.031929969787597656
generate_one_block  0.03181743621826172
generate_one_block  0.03179740905761719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05446815490722656
gen group dst list time:  0.02187347412109375
time for parepare:  0.01927018165588379
local_output_nid generation:  0.00696563720703125
local_in_edges_tensor generation:  0.0329897403717041
mini_batch_src_global generation:  0.024325132369995117
r_  generation:  0.24294304847717285
local_output_nid generation:  0.011010408401489258
local_in_edges_tensor generation:  0.024189233779907227
mini_batch_src_global generation:  0.031942129135131836
r_  generation:  0.2605583667755127
local_output_nid generation:  0.012099027633666992
local_in_edges_tensor generation:  0.017969846725463867
mini_batch_src_global generation:  0.03404951095581055
r_  generation:  0.2703075408935547
local_output_nid generation:  0.012004613876342773
local_in_edges_tensor generation:  0.01821613311767578
mini_batch_src_global generation:  0.03278851509094238
r_  generation:  0.26816439628601074
local_output_nid generation:  0.01207423210144043
local_in_edges_tensor generation:  0.01581597328186035
mini_batch_src_global generation:  0.03371548652648926
r_  generation:  0.26901698112487793
local_output_nid generation:  0.012014389038085938
local_in_edges_tensor generation:  0.016010522842407227
mini_batch_src_global generation:  0.03403472900390625
r_  generation:  0.2728869915008545
local_output_nid generation:  0.012051820755004883
local_in_edges_tensor generation:  0.015825271606445312
mini_batch_src_global generation:  0.03403878211975098
r_  generation:  0.27497243881225586
local_output_nid generation:  0.01320958137512207
local_in_edges_tensor generation:  0.025102853775024414
mini_batch_src_global generation:  0.03749871253967285
r_  generation:  0.2850465774536133
local_output_nid generation:  0.01923084259033203
local_in_edges_tensor generation:  0.020580291748046875
mini_batch_src_global generation:  0.0413057804107666
r_  generation:  0.2774381637573242
local_output_nid generation:  0.012814521789550781
local_in_edges_tensor generation:  0.018172740936279297
mini_batch_src_global generation:  0.03483748435974121
r_  generation:  0.27422618865966797
local_output_nid generation:  0.01296377182006836
local_in_edges_tensor generation:  0.016384601593017578
mini_batch_src_global generation:  0.036947011947631836
r_  generation:  0.2913501262664795
local_output_nid generation:  0.012600183486938477
local_in_edges_tensor generation:  0.014215469360351562
mini_batch_src_global generation:  0.03505086898803711
r_  generation:  0.2734801769256592
local_output_nid generation:  0.01286768913269043
local_in_edges_tensor generation:  0.0160067081451416
mini_batch_src_global generation:  0.03702354431152344
r_  generation:  0.276965856552124
local_output_nid generation:  0.012903690338134766
local_in_edges_tensor generation:  0.01674818992614746
mini_batch_src_global generation:  0.03702545166015625
r_  generation:  0.2773447036743164
local_output_nid generation:  0.012912988662719727
local_in_edges_tensor generation:  0.019550323486328125
mini_batch_src_global generation:  0.03528928756713867
r_  generation:  0.284649133682251
local_output_nid generation:  0.012731790542602539
local_in_edges_tensor generation:  0.014012813568115234
mini_batch_src_global generation:  0.03512263298034668
r_  generation:  0.274477481842041
----------------------check_connections_block total spend ----------------------------- 6.3864052295684814
generate_one_block  0.34537792205810547
generate_one_block  0.37464404106140137
generate_one_block  0.3628809452056885
generate_one_block  0.3645508289337158
generate_one_block  0.35405731201171875
generate_one_block  0.3508439064025879
generate_one_block  0.37297844886779785
generate_one_block  0.3564469814300537
generate_one_block  0.3731245994567871
generate_one_block  0.3523213863372803
generate_one_block  0.35845184326171875
generate_one_block  0.34806060791015625
generate_one_block  0.35573625564575195
generate_one_block  0.359619140625
generate_one_block  0.3658781051635742
generate_one_block  0.34262704849243164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045522451400756836
gen group dst list time:  0.06929826736450195
time for parepare:  0.019028425216674805
local_output_nid generation:  0.025540590286254883
local_in_edges_tensor generation:  0.053954362869262695
mini_batch_src_global generation:  0.04709768295288086
r_  generation:  0.45459651947021484
local_output_nid generation:  0.030476093292236328
local_in_edges_tensor generation:  0.0470428466796875
mini_batch_src_global generation:  0.05195975303649902
r_  generation:  0.4645419120788574
local_output_nid generation:  0.030780315399169922
local_in_edges_tensor generation:  0.03882122039794922
mini_batch_src_global generation:  0.05062150955200195
r_  generation:  0.4649038314819336
local_output_nid generation:  0.031003713607788086
local_in_edges_tensor generation:  0.03446388244628906
mini_batch_src_global generation:  0.05105853080749512
r_  generation:  0.4705169200897217
local_output_nid generation:  0.0314791202545166
local_in_edges_tensor generation:  0.09823489189147949
mini_batch_src_global generation:  0.051758527755737305
r_  generation:  0.4743382930755615
local_output_nid generation:  0.03231668472290039
local_in_edges_tensor generation:  0.0458524227142334
mini_batch_src_global generation:  0.07230949401855469
r_  generation:  0.4658946990966797
local_output_nid generation:  0.033486127853393555
local_in_edges_tensor generation:  0.033117055892944336
mini_batch_src_global generation:  0.05880427360534668
r_  generation:  0.4653286933898926
local_output_nid generation:  0.03220343589782715
local_in_edges_tensor generation:  0.03450441360473633
mini_batch_src_global generation:  0.05639934539794922
r_  generation:  0.47310638427734375
local_output_nid generation:  0.03242611885070801
local_in_edges_tensor generation:  0.031737327575683594
mini_batch_src_global generation:  0.05606722831726074
r_  generation:  0.4709792137145996
local_output_nid generation:  0.03248023986816406
local_in_edges_tensor generation:  0.04268693923950195
mini_batch_src_global generation:  0.0562129020690918
r_  generation:  0.47077441215515137
local_output_nid generation:  0.03271627426147461
local_in_edges_tensor generation:  0.031081438064575195
mini_batch_src_global generation:  0.05429196357727051
r_  generation:  0.4747593402862549
local_output_nid generation:  0.032594919204711914
local_in_edges_tensor generation:  0.03156256675720215
mini_batch_src_global generation:  0.05390501022338867
r_  generation:  0.4765942096710205
local_output_nid generation:  0.03241872787475586
local_in_edges_tensor generation:  0.030731201171875
mini_batch_src_global generation:  0.05423116683959961
r_  generation:  0.4891541004180908
local_output_nid generation:  0.03264737129211426
local_in_edges_tensor generation:  0.035704851150512695
mini_batch_src_global generation:  0.053640127182006836
r_  generation:  0.4763913154602051
local_output_nid generation:  0.032814741134643555
local_in_edges_tensor generation:  0.03912067413330078
mini_batch_src_global generation:  0.05304837226867676
r_  generation:  0.47855234146118164
local_output_nid generation:  0.03261208534240723
local_in_edges_tensor generation:  0.03080916404724121
mini_batch_src_global generation:  0.05364584922790527
r_  generation:  0.4736366271972656
----------------------check_connections_block total spend ----------------------------- 11.300610542297363
generate_one_block  0.5933833122253418
generate_one_block  0.5907971858978271
generate_one_block  0.5984375476837158
generate_one_block  0.5977203845977783
generate_one_block  0.5933496952056885
generate_one_block  0.610816478729248
generate_one_block  0.593289852142334
generate_one_block  0.5975563526153564
generate_one_block  0.6354098320007324
generate_one_block  0.6072404384613037
generate_one_block  0.5958864688873291
generate_one_block  0.5930771827697754
generate_one_block  0.5870108604431152
generate_one_block  0.5855071544647217
generate_one_block  0.6044273376464844
generate_one_block  0.5846445560455322
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.12185335159301758  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

connection checking time:  17.687015771865845
block generation total time  15.306154012680054
average batch blocks generation time:  0.9566346257925034
block dataloader generation time/epoch 35.35065054893494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09506797790527344  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156803, 128])
torch.Size([129730, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4711775779724121  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09512042999267578  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156610, 128])
torch.Size([129238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4713292121887207  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.0955052375793457  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156961, 128])
torch.Size([130135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.4738888740539551  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09530067443847656  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156746, 128])
torch.Size([129714, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.47266149520874023  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.09519147872924805  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156635, 128])
torch.Size([129370, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.47186994552612305  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09530115127563477  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156761, 128])
torch.Size([129729, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.471926212310791  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09516382217407227  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156721, 128])
torch.Size([129124, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4715390205383301  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09526538848876953  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156900, 128])
torch.Size([130006, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.47248172760009766  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09550857543945312  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156994, 128])
torch.Size([130414, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4745650291442871  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09543657302856445  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([157043, 128])
torch.Size([130495, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.47385168075561523  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.0956578254699707  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([157311, 128])
torch.Size([130740, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4750494956970215  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09528493881225586  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156849, 128])
torch.Size([129831, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4723167419433594  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.0953211784362793  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156667, 128])
torch.Size([129764, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.47406530380249023  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09535408020019531  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156688, 128])
torch.Size([129826, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.47393035888671875  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09561586380004883  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([157073, 128])
torch.Size([130412, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.47429847717285156  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.09517145156860352  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

torch.Size([156613, 128])
torch.Size([129599, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4719510078430176  GigaBytes
Max Memory Allocated: 0.5209569931030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042513519525527954 |0.014864757657051086 |0.0033593475818634033 |8.921325206756592e-05 |0.00369398295879364 |0.0017919540405273438 |
----------------------------------------------------------pseudo_mini_loss sum 3.579651355743408
Total (block generation + training)time/epoch 36.420936584472656
Training time/epoch 1.0700032711029053
Training time without block to device /epoch 0.8321671485900879
Training time without total dataloading part /epoch 0.1160726547241211
load block tensor time/epoch 0.6802163124084473
block to device time/epoch 0.23783612251281738
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5317260
Number of first layer input nodes during this epoch:  2509375
