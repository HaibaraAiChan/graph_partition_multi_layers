Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648482321.9068031
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02489447593688965
range selection method range initialization spend 0.01335763931274414
time for parepare:  0.017740488052368164
local_output_nid generation:  0.0013251304626464844
local_in_edges_tensor generation:  0.003926992416381836
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.01833319664001465
local_output_nid generation:  0.001434326171875
local_in_edges_tensor generation:  0.0009183883666992188
mini_batch_src_global generation:  0.002012014389038086
r_  generation:  0.017432212829589844
local_output_nid generation:  0.0016086101531982422
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0013103485107421875
r_  generation:  0.01744842529296875
local_output_nid generation:  0.0015735626220703125
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.0012216567993164062
r_  generation:  0.01726365089416504
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0013659000396728516
r_  generation:  0.018223285675048828
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.0012917518615722656
r_  generation:  0.018213510513305664
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008389949798583984
mini_batch_src_global generation:  0.0014355182647705078
r_  generation:  0.018613100051879883
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0012793540954589844
r_  generation:  0.018180131912231445
local_output_nid generation:  0.001500844955444336
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.001420736312866211
r_  generation:  0.01891636848449707
local_output_nid generation:  0.001519918441772461
local_in_edges_tensor generation:  0.0008053779602050781
mini_batch_src_global generation:  0.0013544559478759766
r_  generation:  0.01829051971435547
local_output_nid generation:  0.0015461444854736328
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0014638900756835938
r_  generation:  0.01860952377319336
local_output_nid generation:  0.0015392303466796875
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.001489400863647461
r_  generation:  0.019232749938964844
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.0014886856079101562
r_  generation:  0.018463850021362305
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0008180141448974609
mini_batch_src_global generation:  0.001354217529296875
r_  generation:  0.0184171199798584
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.0015180110931396484
r_  generation:  0.01942276954650879
local_output_nid generation:  0.0014889240264892578
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0014264583587646484
r_  generation:  0.018827438354492188
----------------------check_connections_block total spend ----------------------------- 0.4416499137878418
generate_one_block  0.02681708335876465
generate_one_block  0.027674198150634766
generate_one_block  0.029378414154052734
generate_one_block  0.027538537979125977
generate_one_block  0.02791738510131836
generate_one_block  0.02719902992248535
generate_one_block  0.027508258819580078
generate_one_block  0.02744913101196289
generate_one_block  0.02824854850769043
generate_one_block  0.02732563018798828
generate_one_block  0.02738213539123535
generate_one_block  0.02814030647277832
generate_one_block  0.027308940887451172
generate_one_block  0.02734518051147461
generate_one_block  0.028402328491210938
generate_one_block  0.0275115966796875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04024481773376465
gen group dst list time:  0.018835067749023438
time for parepare:  0.01879429817199707
local_output_nid generation:  0.00643610954284668
local_in_edges_tensor generation:  0.01745009422302246
mini_batch_src_global generation:  0.02136707305908203
r_  generation:  0.19429516792297363
local_output_nid generation:  0.009762287139892578
local_in_edges_tensor generation:  0.017630815505981445
mini_batch_src_global generation:  0.024871349334716797
r_  generation:  0.20145583152770996
local_output_nid generation:  0.010296821594238281
local_in_edges_tensor generation:  0.013091087341308594
mini_batch_src_global generation:  0.024478435516357422
r_  generation:  0.20686125755310059
local_output_nid generation:  0.010350704193115234
local_in_edges_tensor generation:  0.01669621467590332
mini_batch_src_global generation:  0.027759552001953125
r_  generation:  0.21132135391235352
local_output_nid generation:  0.01069188117980957
local_in_edges_tensor generation:  0.01526021957397461
mini_batch_src_global generation:  0.02623295783996582
r_  generation:  0.21787357330322266
local_output_nid generation:  0.010930776596069336
local_in_edges_tensor generation:  0.011803150177001953
mini_batch_src_global generation:  0.03468608856201172
r_  generation:  0.21767187118530273
local_output_nid generation:  0.010891914367675781
local_in_edges_tensor generation:  0.012108564376831055
mini_batch_src_global generation:  0.026463031768798828
r_  generation:  0.21748971939086914
local_output_nid generation:  0.010971784591674805
local_in_edges_tensor generation:  0.01491856575012207
mini_batch_src_global generation:  0.02756214141845703
r_  generation:  0.21678996086120605
local_output_nid generation:  0.011172294616699219
local_in_edges_tensor generation:  0.016979694366455078
mini_batch_src_global generation:  0.027321577072143555
r_  generation:  0.21794342994689941
local_output_nid generation:  0.010946989059448242
local_in_edges_tensor generation:  0.012181520462036133
mini_batch_src_global generation:  0.027531862258911133
r_  generation:  0.21611595153808594
local_output_nid generation:  0.011016845703125
local_in_edges_tensor generation:  0.011990547180175781
mini_batch_src_global generation:  0.026717424392700195
r_  generation:  0.21375155448913574
local_output_nid generation:  0.011225461959838867
local_in_edges_tensor generation:  0.019381999969482422
mini_batch_src_global generation:  0.029476404190063477
r_  generation:  0.22713589668273926
local_output_nid generation:  0.01097416877746582
local_in_edges_tensor generation:  0.01177072525024414
mini_batch_src_global generation:  0.027046918869018555
r_  generation:  0.21214985847473145
local_output_nid generation:  0.011044979095458984
local_in_edges_tensor generation:  0.012102842330932617
mini_batch_src_global generation:  0.026972055435180664
r_  generation:  0.21363186836242676
local_output_nid generation:  0.011284589767456055
local_in_edges_tensor generation:  0.01544046401977539
mini_batch_src_global generation:  0.02949690818786621
r_  generation:  0.22541093826293945
local_output_nid generation:  0.011090517044067383
local_in_edges_tensor generation:  0.011841058731079102
mini_batch_src_global generation:  0.028084516525268555
r_  generation:  0.2128438949584961
----------------------check_connections_block total spend ----------------------------- 5.024142026901245
generate_one_block  0.2788267135620117
generate_one_block  0.27689123153686523
generate_one_block  0.2805194854736328
generate_one_block  0.2764768600463867
generate_one_block  0.30249810218811035
generate_one_block  0.2751462459564209
generate_one_block  0.2796323299407959
generate_one_block  0.2843799591064453
generate_one_block  0.28823304176330566
generate_one_block  0.2803761959075928
generate_one_block  0.2707040309906006
generate_one_block  0.29183220863342285
generate_one_block  0.268862247467041
generate_one_block  0.27465057373046875
generate_one_block  0.29523348808288574
generate_one_block  0.27246642112731934
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0394594669342041
gen group dst list time:  0.05925559997558594
time for parepare:  0.019287109375
local_output_nid generation:  0.02346038818359375
local_in_edges_tensor generation:  0.03895711898803711
mini_batch_src_global generation:  0.04661083221435547
r_  generation:  0.47031712532043457
local_output_nid generation:  0.03254079818725586
local_in_edges_tensor generation:  0.049385786056518555
mini_batch_src_global generation:  0.0561070442199707
r_  generation:  0.47908973693847656
local_output_nid generation:  0.03261876106262207
local_in_edges_tensor generation:  0.04950881004333496
mini_batch_src_global generation:  0.05544400215148926
r_  generation:  0.4923076629638672
local_output_nid generation:  0.03106689453125
local_in_edges_tensor generation:  0.05051255226135254
mini_batch_src_global generation:  0.06138253211975098
r_  generation:  0.4848330020904541
local_output_nid generation:  0.030504465103149414
local_in_edges_tensor generation:  0.04210066795349121
mini_batch_src_global generation:  0.05656862258911133
r_  generation:  0.4912087917327881
local_output_nid generation:  0.030250072479248047
local_in_edges_tensor generation:  0.02944469451904297
mini_batch_src_global generation:  0.058852195739746094
r_  generation:  0.4941749572753906
local_output_nid generation:  0.03026604652404785
local_in_edges_tensor generation:  0.03911232948303223
mini_batch_src_global generation:  0.06534886360168457
r_  generation:  0.489818811416626
local_output_nid generation:  0.0302426815032959
local_in_edges_tensor generation:  0.041176795959472656
mini_batch_src_global generation:  0.06498456001281738
r_  generation:  0.4858126640319824
local_output_nid generation:  0.030102252960205078
local_in_edges_tensor generation:  0.03197836875915527
mini_batch_src_global generation:  0.05632281303405762
r_  generation:  0.5076198577880859
local_output_nid generation:  0.030230045318603516
local_in_edges_tensor generation:  0.03355574607849121
mini_batch_src_global generation:  0.057817697525024414
r_  generation:  0.48511266708374023
local_output_nid generation:  0.030069351196289062
local_in_edges_tensor generation:  0.0339970588684082
mini_batch_src_global generation:  0.05780291557312012
r_  generation:  0.4911789894104004
local_output_nid generation:  0.030234575271606445
local_in_edges_tensor generation:  0.030126571655273438
mini_batch_src_global generation:  0.06137990951538086
r_  generation:  0.48951148986816406
local_output_nid generation:  0.031951904296875
local_in_edges_tensor generation:  0.030163288116455078
mini_batch_src_global generation:  0.05688595771789551
r_  generation:  0.4874579906463623
local_output_nid generation:  0.031438589096069336
local_in_edges_tensor generation:  0.034847259521484375
mini_batch_src_global generation:  0.05742669105529785
r_  generation:  0.48656296730041504
local_output_nid generation:  0.03335165977478027
local_in_edges_tensor generation:  0.03963923454284668
mini_batch_src_global generation:  0.0566713809967041
r_  generation:  0.49771666526794434
local_output_nid generation:  0.0308074951171875
local_in_edges_tensor generation:  0.030716896057128906
mini_batch_src_global generation:  0.0645589828491211
r_  generation:  0.4880256652832031
----------------------check_connections_block total spend ----------------------------- 11.540366411209106
generate_one_block  0.632220983505249
generate_one_block  0.6341629028320312
generate_one_block  0.6551730632781982
generate_one_block  0.636474609375
generate_one_block  0.6376044750213623
generate_one_block  0.6321461200714111
generate_one_block  0.6746416091918945
generate_one_block  0.6348645687103271
generate_one_block  0.6263093948364258
generate_one_block  0.6276431083679199
generate_one_block  0.6243727207183838
generate_one_block  0.6328480243682861
generate_one_block  0.622769832611084
generate_one_block  0.6270833015441895
generate_one_block  0.6388099193572998
generate_one_block  0.6178667545318604
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07531619071960449
gen group dst list time:  0.0854489803314209
time for parepare:  0.019833087921142578
local_output_nid generation:  0.031392812728881836
local_in_edges_tensor generation:  0.044091224670410156
mini_batch_src_global generation:  0.04436540603637695
r_  generation:  0.49738144874572754
local_output_nid generation:  0.03818988800048828
local_in_edges_tensor generation:  0.03925800323486328
mini_batch_src_global generation:  0.0560154914855957
r_  generation:  0.515798807144165
local_output_nid generation:  0.03691434860229492
local_in_edges_tensor generation:  0.03869438171386719
mini_batch_src_global generation:  0.053864240646362305
r_  generation:  0.5128264427185059
local_output_nid generation:  0.036711692810058594
local_in_edges_tensor generation:  0.04097342491149902
mini_batch_src_global generation:  0.05320096015930176
r_  generation:  0.5065584182739258
local_output_nid generation:  0.03684425354003906
local_in_edges_tensor generation:  0.045330047607421875
mini_batch_src_global generation:  0.05395650863647461
r_  generation:  0.5134902000427246
local_output_nid generation:  0.03721261024475098
local_in_edges_tensor generation:  0.04363417625427246
mini_batch_src_global generation:  0.053600311279296875
r_  generation:  0.5134220123291016
local_output_nid generation:  0.03829526901245117
local_in_edges_tensor generation:  0.03886580467224121
mini_batch_src_global generation:  0.05407142639160156
r_  generation:  0.5221033096313477
local_output_nid generation:  0.03676915168762207
local_in_edges_tensor generation:  0.0418851375579834
mini_batch_src_global generation:  0.07612895965576172
r_  generation:  0.5184543132781982
local_output_nid generation:  0.04003262519836426
local_in_edges_tensor generation:  0.04447150230407715
mini_batch_src_global generation:  0.06160140037536621
r_  generation:  0.5149986743927002
local_output_nid generation:  0.03842902183532715
local_in_edges_tensor generation:  0.04026651382446289
mini_batch_src_global generation:  0.055228233337402344
r_  generation:  0.5172638893127441
local_output_nid generation:  0.03844308853149414
local_in_edges_tensor generation:  0.04382157325744629
mini_batch_src_global generation:  0.05573320388793945
r_  generation:  0.5289351940155029
local_output_nid generation:  0.03863930702209473
local_in_edges_tensor generation:  0.03946042060852051
mini_batch_src_global generation:  0.05591559410095215
r_  generation:  0.5137887001037598
local_output_nid generation:  0.03887462615966797
local_in_edges_tensor generation:  0.042998552322387695
mini_batch_src_global generation:  0.05895829200744629
r_  generation:  0.518258810043335
local_output_nid generation:  0.038811683654785156
local_in_edges_tensor generation:  0.04503464698791504
mini_batch_src_global generation:  0.0556793212890625
r_  generation:  0.514225959777832
local_output_nid generation:  0.038579702377319336
local_in_edges_tensor generation:  0.043387413024902344
mini_batch_src_global generation:  0.05561113357543945
r_  generation:  0.5170383453369141
local_output_nid generation:  0.03847789764404297
local_in_edges_tensor generation:  0.03492999076843262
mini_batch_src_global generation:  0.054903507232666016
r_  generation:  0.5157976150512695
----------------------check_connections_block total spend ----------------------------- 12.366477966308594
generate_one_block  0.6501643657684326
generate_one_block  0.7059075832366943
generate_one_block  0.6352620124816895
generate_one_block  0.6436586380004883
generate_one_block  0.6266818046569824
generate_one_block  0.6277990341186523
generate_one_block  0.6248929500579834
generate_one_block  0.6359214782714844
generate_one_block  0.6209366321563721
generate_one_block  0.619434118270874
generate_one_block  0.635603666305542
generate_one_block  0.6262943744659424
generate_one_block  0.6314847469329834
generate_one_block  0.6362683773040771
generate_one_block  0.6453843116760254
generate_one_block  0.618297815322876
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  28.930986404418945
block generation total time  24.835712432861328
average batch blocks generation time:  1.552232027053833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10671710968017578  GigaBytes
Max Memory Allocated: 0.10671710968017578  GigaBytes

torch.Size([163613, 128])
torch.Size([155252, 64])
torch.Size([123146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.4270963668823242  GigaBytes
Max Memory Allocated: 0.4348320960998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.10797643661499023  GigaBytes
Max Memory Allocated: 0.44879817962646484  GigaBytes

torch.Size([163620, 128])
torch.Size([155372, 64])
torch.Size([123854, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.4273195266723633  GigaBytes
Max Memory Allocated: 0.44879817962646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.1079869270324707  GigaBytes
Max Memory Allocated: 0.4496579170227051  GigaBytes

torch.Size([163643, 128])
torch.Size([155627, 64])
torch.Size([123913, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.4277515411376953  GigaBytes
Max Memory Allocated: 0.4496579170227051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.10797643661499023  GigaBytes
Max Memory Allocated: 0.44977807998657227  GigaBytes

torch.Size([163670, 128])
torch.Size([155733, 64])
torch.Size([123899, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.42758750915527344  GigaBytes
Max Memory Allocated: 0.44977807998657227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10805845260620117  GigaBytes
Max Memory Allocated: 0.4498286247253418  GigaBytes

torch.Size([163747, 128])
torch.Size([155916, 64])
torch.Size([124745, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4294610023498535  GigaBytes
Max Memory Allocated: 0.4498286247253418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10796022415161133  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163647, 128])
torch.Size([155644, 64])
torch.Size([124085, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4277200698852539  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10802316665649414  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163761, 128])
torch.Size([155709, 64])
torch.Size([123706, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4276561737060547  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10802507400512695  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163689, 128])
torch.Size([155719, 64])
torch.Size([124455, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4285745620727539  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1080327033996582  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163575, 128])
torch.Size([155368, 64])
torch.Size([123418, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4275212287902832  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10799551010131836  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163611, 128])
torch.Size([155471, 64])
torch.Size([123623, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4271550178527832  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10792684555053711  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163748, 128])
torch.Size([155641, 64])
torch.Size([123694, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42710399627685547  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10814905166625977  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163629, 128])
torch.Size([155456, 64])
torch.Size([123719, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42848920822143555  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1078639030456543  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163657, 128])
torch.Size([155421, 64])
torch.Size([122987, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4263467788696289  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1079401969909668  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163723, 128])
torch.Size([155691, 64])
torch.Size([124370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4278383255004883  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10813665390014648  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163836, 128])
torch.Size([155660, 64])
torch.Size([123925, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4286928176879883  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10793828964233398  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163522, 128])
torch.Size([155104, 64])
torch.Size([123017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4264411926269531  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04254227876663208 |0.04166637361049652 |0.04790352284908295 |9.381771087646484e-05 |0.0189649760723114 |0.002810955047607422 |
----------------------------------------------------------pseudo_mini_loss sum 5.648468017578125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7748990
Number of first layer input nodes during this epoch:  2618691
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1679973602294922  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.043349504470825195
range selection method range initialization spend 0.014237403869628906
time for parepare:  0.016176939010620117
local_output_nid generation:  0.00139617919921875
local_in_edges_tensor generation:  0.006363868713378906
mini_batch_src_global generation:  0.0015993118286132812
r_  generation:  0.01882457733154297
local_output_nid generation:  0.0016057491302490234
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0020880699157714844
r_  generation:  0.018444538116455078
local_output_nid generation:  0.0017681121826171875
local_in_edges_tensor generation:  0.0009970664978027344
mini_batch_src_global generation:  0.001409769058227539
r_  generation:  0.018514156341552734
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0013115406036376953
r_  generation:  0.018118858337402344
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.0013937950134277344
r_  generation:  0.018465518951416016
local_output_nid generation:  0.0016486644744873047
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0014348030090332031
r_  generation:  0.01997065544128418
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.001264810562133789
mini_batch_src_global generation:  0.002651214599609375
r_  generation:  0.01981353759765625
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0010569095611572266
mini_batch_src_global generation:  0.0014350414276123047
r_  generation:  0.018611669540405273
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0010528564453125
mini_batch_src_global generation:  0.0014600753784179688
r_  generation:  0.018608570098876953
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.01931452751159668
local_output_nid generation:  0.0016753673553466797
local_in_edges_tensor generation:  0.001028299331665039
mini_batch_src_global generation:  0.0015187263488769531
r_  generation:  0.019463300704956055
local_output_nid generation:  0.0016984939575195312
local_in_edges_tensor generation:  0.0010972023010253906
mini_batch_src_global generation:  0.0015006065368652344
r_  generation:  0.018723726272583008
local_output_nid generation:  0.0016791820526123047
local_in_edges_tensor generation:  0.001054525375366211
mini_batch_src_global generation:  0.0014140605926513672
r_  generation:  0.01846170425415039
local_output_nid generation:  0.0016705989837646484
local_in_edges_tensor generation:  0.0010280609130859375
mini_batch_src_global generation:  0.0014624595642089844
r_  generation:  0.021484851837158203
local_output_nid generation:  0.0016889572143554688
local_in_edges_tensor generation:  0.001207113265991211
mini_batch_src_global generation:  0.001497507095336914
r_  generation:  0.019387483596801758
local_output_nid generation:  0.0017421245574951172
local_in_edges_tensor generation:  0.0010342597961425781
mini_batch_src_global generation:  0.0014872550964355469
r_  generation:  0.01942753791809082
----------------------check_connections_block total spend ----------------------------- 0.48285460472106934
generate_one_block  0.028141260147094727
generate_one_block  0.028223276138305664
generate_one_block  0.027710676193237305
generate_one_block  0.02742290496826172
generate_one_block  0.02740001678466797
generate_one_block  0.03063654899597168
generate_one_block  0.027971744537353516
generate_one_block  0.02756977081298828
generate_one_block  0.02723979949951172
generate_one_block  0.027725696563720703
generate_one_block  0.028312206268310547
generate_one_block  0.026887893676757812
generate_one_block  0.027013778686523438
generate_one_block  0.028016328811645508
generate_one_block  0.02826070785522461
generate_one_block  0.02849864959716797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.046814918518066406
gen group dst list time:  0.01677680015563965
time for parepare:  0.021411418914794922
local_output_nid generation:  0.006573200225830078
local_in_edges_tensor generation:  0.029131174087524414
mini_batch_src_global generation:  0.021079540252685547
r_  generation:  0.20228075981140137
local_output_nid generation:  0.009998083114624023
local_in_edges_tensor generation:  0.019022464752197266
mini_batch_src_global generation:  0.025242328643798828
r_  generation:  0.2053840160369873
local_output_nid generation:  0.01024937629699707
local_in_edges_tensor generation:  0.01581096649169922
mini_batch_src_global generation:  0.024298667907714844
r_  generation:  0.21124267578125
local_output_nid generation:  0.010732412338256836
local_in_edges_tensor generation:  0.013798713684082031
mini_batch_src_global generation:  0.024912357330322266
r_  generation:  0.20746684074401855
local_output_nid generation:  0.011373281478881836
local_in_edges_tensor generation:  0.014197826385498047
mini_batch_src_global generation:  0.027166128158569336
r_  generation:  0.21318435668945312
local_output_nid generation:  0.011642217636108398
local_in_edges_tensor generation:  0.018173933029174805
mini_batch_src_global generation:  0.026949405670166016
r_  generation:  0.21716570854187012
local_output_nid generation:  0.011542081832885742
local_in_edges_tensor generation:  0.012459754943847656
mini_batch_src_global generation:  0.02987074851989746
r_  generation:  0.2145533561706543
local_output_nid generation:  0.011592388153076172
local_in_edges_tensor generation:  0.014183282852172852
mini_batch_src_global generation:  0.029297828674316406
r_  generation:  0.21496963500976562
local_output_nid generation:  0.01166534423828125
local_in_edges_tensor generation:  0.014292001724243164
mini_batch_src_global generation:  0.026734590530395508
r_  generation:  0.21313047409057617
local_output_nid generation:  0.011096715927124023
local_in_edges_tensor generation:  0.016261816024780273
mini_batch_src_global generation:  0.027019262313842773
r_  generation:  0.21802759170532227
local_output_nid generation:  0.011048555374145508
local_in_edges_tensor generation:  0.014873743057250977
mini_batch_src_global generation:  0.028625011444091797
r_  generation:  0.21833372116088867
local_output_nid generation:  0.010905027389526367
local_in_edges_tensor generation:  0.012593984603881836
mini_batch_src_global generation:  0.02904987335205078
r_  generation:  0.21419143676757812
local_output_nid generation:  0.010855913162231445
local_in_edges_tensor generation:  0.014200210571289062
mini_batch_src_global generation:  0.026850223541259766
r_  generation:  0.21262526512145996
local_output_nid generation:  0.011128425598144531
local_in_edges_tensor generation:  0.019877195358276367
mini_batch_src_global generation:  0.027485370635986328
r_  generation:  0.217604398727417
local_output_nid generation:  0.01108098030090332
local_in_edges_tensor generation:  0.01650547981262207
mini_batch_src_global generation:  0.027056217193603516
r_  generation:  0.21680450439453125
local_output_nid generation:  0.011300086975097656
local_in_edges_tensor generation:  0.016494274139404297
mini_batch_src_global generation:  0.027480602264404297
r_  generation:  0.22269177436828613
----------------------check_connections_block total spend ----------------------------- 5.05408239364624
generate_one_block  0.28672003746032715
generate_one_block  0.27214598655700684
generate_one_block  0.27741193771362305
generate_one_block  0.27313971519470215
generate_one_block  0.27236080169677734
generate_one_block  0.28484082221984863
generate_one_block  0.2988162040710449
generate_one_block  0.26913976669311523
generate_one_block  0.2740774154663086
generate_one_block  0.27422046661376953
generate_one_block  0.2798604965209961
generate_one_block  0.2729158401489258
generate_one_block  0.2723665237426758
generate_one_block  0.28267979621887207
generate_one_block  0.27306222915649414
generate_one_block  0.2877941131591797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04545927047729492
gen group dst list time:  0.05905508995056152
time for parepare:  0.0165402889251709
local_output_nid generation:  0.023868799209594727
local_in_edges_tensor generation:  0.04174089431762695
mini_batch_src_global generation:  0.0477452278137207
r_  generation:  0.5075135231018066
local_output_nid generation:  0.028966903686523438
local_in_edges_tensor generation:  0.04731917381286621
mini_batch_src_global generation:  0.055998802185058594
r_  generation:  0.47971105575561523
local_output_nid generation:  0.029242753982543945
local_in_edges_tensor generation:  0.034874677658081055
mini_batch_src_global generation:  0.05850028991699219
r_  generation:  0.48722386360168457
local_output_nid generation:  0.029571533203125
local_in_edges_tensor generation:  0.034951210021972656
mini_batch_src_global generation:  0.05681943893432617
r_  generation:  0.4838392734527588
local_output_nid generation:  0.029580354690551758
local_in_edges_tensor generation:  0.07226395606994629
mini_batch_src_global generation:  0.056696176528930664
r_  generation:  0.494373083114624
local_output_nid generation:  0.02971172332763672
local_in_edges_tensor generation:  0.03854084014892578
mini_batch_src_global generation:  0.057157039642333984
r_  generation:  0.489915132522583
local_output_nid generation:  0.029639244079589844
local_in_edges_tensor generation:  0.03964829444885254
mini_batch_src_global generation:  0.05651450157165527
r_  generation:  0.495603084564209
local_output_nid generation:  0.029901981353759766
local_in_edges_tensor generation:  0.03362679481506348
mini_batch_src_global generation:  0.05765795707702637
r_  generation:  0.49249911308288574
local_output_nid generation:  0.029926538467407227
local_in_edges_tensor generation:  0.03477740287780762
mini_batch_src_global generation:  0.05648660659790039
r_  generation:  0.49060988426208496
local_output_nid generation:  0.030126094818115234
local_in_edges_tensor generation:  0.04267239570617676
mini_batch_src_global generation:  0.05688810348510742
r_  generation:  0.4868903160095215
local_output_nid generation:  0.02998208999633789
local_in_edges_tensor generation:  0.03088998794555664
mini_batch_src_global generation:  0.05646395683288574
r_  generation:  0.4943721294403076
local_output_nid generation:  0.029924631118774414
local_in_edges_tensor generation:  0.03532552719116211
mini_batch_src_global generation:  0.061191558837890625
r_  generation:  0.4883241653442383
local_output_nid generation:  0.029625415802001953
local_in_edges_tensor generation:  0.030321121215820312
mini_batch_src_global generation:  0.05619382858276367
r_  generation:  0.49382615089416504
local_output_nid generation:  0.029932737350463867
local_in_edges_tensor generation:  0.03481578826904297
mini_batch_src_global generation:  0.062186479568481445
r_  generation:  0.489210844039917
local_output_nid generation:  0.029758214950561523
local_in_edges_tensor generation:  0.03497457504272461
mini_batch_src_global generation:  0.058797359466552734
r_  generation:  0.49704551696777344
local_output_nid generation:  0.03040337562561035
local_in_edges_tensor generation:  0.044023990631103516
mini_batch_src_global generation:  0.061940908432006836
r_  generation:  0.492631196975708
----------------------check_connections_block total spend ----------------------------- 11.564900159835815
generate_one_block  0.620070219039917
generate_one_block  0.6243140697479248
generate_one_block  0.6372873783111572
generate_one_block  0.6191394329071045
generate_one_block  0.6287894248962402
generate_one_block  0.6282196044921875
generate_one_block  0.6287298202514648
generate_one_block  0.6176676750183105
generate_one_block  0.659296989440918
generate_one_block  0.6298089027404785
generate_one_block  0.6196856498718262
generate_one_block  0.6293377876281738
generate_one_block  0.6232137680053711
generate_one_block  0.639333963394165
generate_one_block  0.6395041942596436
generate_one_block  0.6435236930847168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047124624252319336
gen group dst list time:  0.09204626083374023
time for parepare:  0.019898176193237305
local_output_nid generation:  0.032354116439819336
local_in_edges_tensor generation:  0.05322146415710449
mini_batch_src_global generation:  0.04777264595031738
r_  generation:  0.487856388092041
local_output_nid generation:  0.03839707374572754
local_in_edges_tensor generation:  0.03529095649719238
mini_batch_src_global generation:  0.058339834213256836
r_  generation:  0.49504828453063965
local_output_nid generation:  0.038645267486572266
local_in_edges_tensor generation:  0.037542104721069336
mini_batch_src_global generation:  0.056458473205566406
r_  generation:  0.502784252166748
local_output_nid generation:  0.03751206398010254
local_in_edges_tensor generation:  0.03841352462768555
mini_batch_src_global generation:  0.0557711124420166
r_  generation:  0.5004310607910156
local_output_nid generation:  0.03635430335998535
local_in_edges_tensor generation:  0.036004066467285156
mini_batch_src_global generation:  0.05617809295654297
r_  generation:  0.5070452690124512
local_output_nid generation:  0.036672353744506836
local_in_edges_tensor generation:  0.04069256782531738
mini_batch_src_global generation:  0.05650830268859863
r_  generation:  0.5103309154510498
local_output_nid generation:  0.0368349552154541
local_in_edges_tensor generation:  0.04578351974487305
mini_batch_src_global generation:  0.05907177925109863
r_  generation:  0.5155627727508545
local_output_nid generation:  0.03701496124267578
local_in_edges_tensor generation:  0.040868282318115234
mini_batch_src_global generation:  0.057791709899902344
r_  generation:  0.5089361667633057
local_output_nid generation:  0.03730440139770508
local_in_edges_tensor generation:  0.04628944396972656
mini_batch_src_global generation:  0.05723428726196289
r_  generation:  0.5188095569610596
local_output_nid generation:  0.03689908981323242
local_in_edges_tensor generation:  0.04802274703979492
mini_batch_src_global generation:  0.06763815879821777
r_  generation:  0.5129938125610352
local_output_nid generation:  0.03676152229309082
local_in_edges_tensor generation:  0.04424238204956055
mini_batch_src_global generation:  0.058411598205566406
r_  generation:  0.5140507221221924
local_output_nid generation:  0.0369868278503418
local_in_edges_tensor generation:  0.04567909240722656
mini_batch_src_global generation:  0.0580596923828125
r_  generation:  0.5229079723358154
local_output_nid generation:  0.04006481170654297
local_in_edges_tensor generation:  0.037134408950805664
mini_batch_src_global generation:  0.06414675712585449
r_  generation:  0.5145289897918701
local_output_nid generation:  0.037935495376586914
local_in_edges_tensor generation:  0.04078841209411621
mini_batch_src_global generation:  0.057900428771972656
r_  generation:  0.5162508487701416
local_output_nid generation:  0.03780674934387207
local_in_edges_tensor generation:  0.03696870803833008
mini_batch_src_global generation:  0.058220624923706055
r_  generation:  0.5175735950469971
local_output_nid generation:  0.03804302215576172
local_in_edges_tensor generation:  0.04574847221374512
mini_batch_src_global generation:  0.05800747871398926
r_  generation:  0.5229105949401855
----------------------check_connections_block total spend ----------------------------- 12.28499460220337
generate_one_block  0.6323564052581787
generate_one_block  0.6361355781555176
generate_one_block  0.6366744041442871
generate_one_block  0.631382942199707
generate_one_block  0.6358931064605713
generate_one_block  0.6286265850067139
generate_one_block  0.7062680721282959
generate_one_block  0.6234996318817139
generate_one_block  0.6360046863555908
generate_one_block  0.6381227970123291
generate_one_block  0.6207313537597656
generate_one_block  0.623525857925415
generate_one_block  0.6312851905822754
generate_one_block  0.6283576488494873
generate_one_block  0.6332113742828369
generate_one_block  0.6304831504821777
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1679973602294922  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

connection checking time:  28.903977155685425
block generation total time  24.71203351020813
average batch blocks generation time:  1.5445020943880081
block dataloader generation time/epoch 56.15742611885071
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1084280014038086  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

torch.Size([163744, 128])
torch.Size([155926, 64])
torch.Size([124734, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4305548667907715  GigaBytes
Max Memory Allocated: 0.45147132873535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.1082921028137207  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163508, 128])
torch.Size([155280, 64])
torch.Size([123154, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4270467758178711  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10836172103881836  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163729, 128])
torch.Size([155772, 64])
torch.Size([124173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42894697189331055  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10822153091430664  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163673, 128])
torch.Size([155741, 64])
torch.Size([123559, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.427401065826416  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10826253890991211  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163593, 128])
torch.Size([155390, 64])
torch.Size([123125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.42701053619384766  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.10840940475463867  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163533, 128])
torch.Size([155453, 64])
torch.Size([123867, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0897216796875 GB
    Memory Allocated: 0.4289436340332031  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1083383560180664  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163907, 128])
torch.Size([155837, 64])
torch.Size([123647, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.42807912826538086  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10824346542358398  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163590, 128])
torch.Size([155323, 64])
torch.Size([123472, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4271531105041504  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10825967788696289  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163763, 128])
torch.Size([155676, 64])
torch.Size([123685, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4277229309082031  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10824346542358398  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163683, 128])
torch.Size([155773, 64])
torch.Size([124003, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42833757400512695  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10833215713500977  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163517, 128])
torch.Size([155113, 64])
torch.Size([123267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42746639251708984  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10822820663452148  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163750, 128])
torch.Size([155521, 64])
torch.Size([123671, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42736101150512695  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10816621780395508  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163570, 128])
torch.Size([155300, 64])
torch.Size([122904, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4265570640563965  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10832738876342773  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163758, 128])
torch.Size([155542, 64])
torch.Size([123971, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4281802177429199  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10830354690551758  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163621, 128])
torch.Size([155583, 64])
torch.Size([123842, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.4280061721801758  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.10837793350219727  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

torch.Size([163729, 128])
torch.Size([155669, 64])
torch.Size([124136, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.42889881134033203  GigaBytes
Max Memory Allocated: 0.4520106315612793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04518325626850128 |0.02287273108959198 |0.004576832056045532 |8.884072303771973e-05 |0.0076062679290771484 |0.0019023418426513672 |
----------------------------------------------------------pseudo_mini_loss sum 4.444986820220947
Total (block generation + training)time/epoch 57.48962426185608
Training time/epoch 1.3319168090820312
Training time without block to device /epoch 0.9659531116485596
Training time without total dataloading part /epoch 0.19825339317321777
load block tensor time/epoch 0.7229321002960205
block to device time/epoch 0.3659636974334717
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7748743
Number of first layer input nodes during this epoch:  2618668
