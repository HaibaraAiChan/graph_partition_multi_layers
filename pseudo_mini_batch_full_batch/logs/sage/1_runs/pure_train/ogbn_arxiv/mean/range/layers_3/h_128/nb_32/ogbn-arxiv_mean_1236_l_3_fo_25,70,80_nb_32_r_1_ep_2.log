Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648450582.80392
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024467945098876953
range selection method range initialization spend 0.013847827911376953
time for parepare:  0.01781940460205078
local_output_nid generation:  0.000720977783203125
local_in_edges_tensor generation:  0.0028374195098876953
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.010691404342651367
local_output_nid generation:  0.0008504390716552734
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.009430408477783203
local_output_nid generation:  0.0008187294006347656
local_in_edges_tensor generation:  0.0005328655242919922
mini_batch_src_global generation:  0.0009539127349853516
r_  generation:  0.009234189987182617
local_output_nid generation:  0.0008234977722167969
local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.00092315673828125
r_  generation:  0.009264230728149414
local_output_nid generation:  0.0007901191711425781
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0009322166442871094
r_  generation:  0.009389162063598633
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009505748748779297
r_  generation:  0.009629964828491211
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.009776830673217773
local_output_nid generation:  0.0007703304290771484
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0008687973022460938
r_  generation:  0.009033441543579102
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0008804798126220703
r_  generation:  0.009307384490966797
local_output_nid generation:  0.0007915496826171875
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0009379386901855469
r_  generation:  0.009532451629638672
local_output_nid generation:  0.0007729530334472656
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009826183319091797
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.00092315673828125
r_  generation:  0.009477853775024414
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.010238885879516602
local_output_nid generation:  0.00077056884765625
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0009891986846923828
r_  generation:  0.01020050048828125
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0009477138519287109
r_  generation:  0.009744405746459961
local_output_nid generation:  0.0007596015930175781
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.001004934310913086
r_  generation:  0.009690046310424805
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0009715557098388672
r_  generation:  0.011765718460083008
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0005307197570800781
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010338306427001953
local_output_nid generation:  0.0008058547973632812
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0009570121765136719
r_  generation:  0.00964212417602539
local_output_nid generation:  0.0007708072662353516
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.0010941028594970703
r_  generation:  0.010118246078491211
local_output_nid generation:  0.0007717609405517578
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0010867118835449219
r_  generation:  0.010310173034667969
local_output_nid generation:  0.0007755756378173828
local_in_edges_tensor generation:  0.0004634857177734375
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.010157585144042969
local_output_nid generation:  0.0007731914520263672
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.00998830795288086
local_output_nid generation:  0.0007798671722412109
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.010046958923339844
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.009758949279785156
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0009918212890625
r_  generation:  0.009982585906982422
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.00046515464782714844
mini_batch_src_global generation:  0.0009953975677490234
r_  generation:  0.009971380233764648
local_output_nid generation:  0.0007646083831787109
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.0101318359375
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.00046539306640625
mini_batch_src_global generation:  0.0009980201721191406
r_  generation:  0.010073423385620117
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.004259586334228516
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010310888290405273
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.010078191757202148
local_output_nid generation:  0.0008170604705810547
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.009831666946411133
----------------------check_connections_block total spend ----------------------------- 0.4872562885284424
generate_one_block  0.014856338500976562
generate_one_block  0.014594316482543945
generate_one_block  0.014368057250976562
generate_one_block  0.014752864837646484
generate_one_block  0.014750957489013672
generate_one_block  0.015049457550048828
generate_one_block  0.015028953552246094
generate_one_block  0.013879537582397461
generate_one_block  0.0142364501953125
generate_one_block  0.015053510665893555
generate_one_block  0.014863967895507812
generate_one_block  0.01416015625
generate_one_block  0.015341520309448242
generate_one_block  0.015294551849365234
generate_one_block  0.014413118362426758
generate_one_block  0.0144195556640625
generate_one_block  0.015955448150634766
generate_one_block  0.015487194061279297
generate_one_block  0.014960289001464844
generate_one_block  0.015154600143432617
generate_one_block  0.015060663223266602
generate_one_block  0.01496267318725586
generate_one_block  0.014562129974365234
generate_one_block  0.01505136489868164
generate_one_block  0.014214515686035156
generate_one_block  0.0149993896484375
generate_one_block  0.014676570892333984
generate_one_block  0.014821290969848633
generate_one_block  0.015150308609008789
generate_one_block  0.0151824951171875
generate_one_block  0.014734745025634766
generate_one_block  0.01443934440612793
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04218244552612305
gen group dst list time:  0.024268627166748047
time for parepare:  0.01909637451171875
local_output_nid generation:  0.004130840301513672
local_in_edges_tensor generation:  0.012709856033325195
mini_batch_src_global generation:  0.01591014862060547
r_  generation:  0.1562345027923584
local_output_nid generation:  0.007067680358886719
local_in_edges_tensor generation:  0.011365413665771484
mini_batch_src_global generation:  0.020218372344970703
r_  generation:  0.16172456741333008
local_output_nid generation:  0.006811380386352539
local_in_edges_tensor generation:  0.011363506317138672
mini_batch_src_global generation:  0.01884174346923828
r_  generation:  0.16745257377624512
local_output_nid generation:  0.00719904899597168
local_in_edges_tensor generation:  0.014812469482421875
mini_batch_src_global generation:  0.020209074020385742
r_  generation:  0.18071365356445312
local_output_nid generation:  0.00806117057800293
local_in_edges_tensor generation:  0.017779827117919922
mini_batch_src_global generation:  0.023152828216552734
r_  generation:  0.17724609375
local_output_nid generation:  0.008442163467407227
local_in_edges_tensor generation:  0.012448549270629883
mini_batch_src_global generation:  0.023685693740844727
r_  generation:  0.18134427070617676
local_output_nid generation:  0.007924079895019531
local_in_edges_tensor generation:  0.01284646987915039
mini_batch_src_global generation:  0.022095441818237305
r_  generation:  0.17684054374694824
local_output_nid generation:  0.007489442825317383
local_in_edges_tensor generation:  0.009151935577392578
mini_batch_src_global generation:  0.02121424674987793
r_  generation:  0.16634559631347656
local_output_nid generation:  0.007613420486450195
local_in_edges_tensor generation:  0.009389400482177734
mini_batch_src_global generation:  0.021922826766967773
r_  generation:  0.17476987838745117
local_output_nid generation:  0.0078012943267822266
local_in_edges_tensor generation:  0.011200428009033203
mini_batch_src_global generation:  0.02262282371520996
r_  generation:  0.17937660217285156
local_output_nid generation:  0.007915973663330078
local_in_edges_tensor generation:  0.011313915252685547
mini_batch_src_global generation:  0.024260282516479492
r_  generation:  0.17991232872009277
local_output_nid generation:  0.007505178451538086
local_in_edges_tensor generation:  0.009201526641845703
mini_batch_src_global generation:  0.021680355072021484
r_  generation:  0.1694025993347168
local_output_nid generation:  0.008149862289428711
local_in_edges_tensor generation:  0.011336326599121094
mini_batch_src_global generation:  0.024487018585205078
r_  generation:  0.1861569881439209
local_output_nid generation:  0.008183717727661133
local_in_edges_tensor generation:  0.013217926025390625
mini_batch_src_global generation:  0.023779630661010742
r_  generation:  0.18591070175170898
local_output_nid generation:  0.007932186126708984
local_in_edges_tensor generation:  0.011054039001464844
mini_batch_src_global generation:  0.022762775421142578
r_  generation:  0.17511916160583496
local_output_nid generation:  0.007893800735473633
local_in_edges_tensor generation:  0.009550809860229492
mini_batch_src_global generation:  0.022530078887939453
r_  generation:  0.17604398727416992
local_output_nid generation:  0.008618354797363281
local_in_edges_tensor generation:  0.013947725296020508
mini_batch_src_global generation:  0.024374961853027344
r_  generation:  0.19208765029907227
local_output_nid generation:  0.007761955261230469
local_in_edges_tensor generation:  0.009458065032958984
mini_batch_src_global generation:  0.022597312927246094
r_  generation:  0.17313218116760254
local_output_nid generation:  0.007822990417480469
local_in_edges_tensor generation:  0.009447097778320312
mini_batch_src_global generation:  0.021924734115600586
r_  generation:  0.17789006233215332
local_output_nid generation:  0.008230447769165039
local_in_edges_tensor generation:  0.012629270553588867
mini_batch_src_global generation:  0.023043155670166016
r_  generation:  0.18411493301391602
local_output_nid generation:  0.008236169815063477
local_in_edges_tensor generation:  0.011507987976074219
mini_batch_src_global generation:  0.023782730102539062
r_  generation:  0.18436813354492188
local_output_nid generation:  0.008178234100341797
local_in_edges_tensor generation:  0.011510610580444336
mini_batch_src_global generation:  0.02339911460876465
r_  generation:  0.18490839004516602
local_output_nid generation:  0.008082389831542969
local_in_edges_tensor generation:  0.009680986404418945
mini_batch_src_global generation:  0.02248096466064453
r_  generation:  0.17586636543273926
local_output_nid generation:  0.008220195770263672
local_in_edges_tensor generation:  0.011470556259155273
mini_batch_src_global generation:  0.024275779724121094
r_  generation:  0.2092571258544922
local_output_nid generation:  0.00940704345703125
local_in_edges_tensor generation:  0.009555816650390625
mini_batch_src_global generation:  0.029941558837890625
r_  generation:  0.17891979217529297
local_output_nid generation:  0.008390426635742188
local_in_edges_tensor generation:  0.011468648910522461
mini_batch_src_global generation:  0.027080535888671875
r_  generation:  0.1881716251373291
local_output_nid generation:  0.00825810432434082
local_in_edges_tensor generation:  0.01140594482421875
mini_batch_src_global generation:  0.025563716888427734
r_  generation:  0.1844475269317627
local_output_nid generation:  0.008224964141845703
local_in_edges_tensor generation:  0.012656211853027344
mini_batch_src_global generation:  0.023670434951782227
r_  generation:  0.18703627586364746
local_output_nid generation:  0.00819087028503418
local_in_edges_tensor generation:  0.014497518539428711
mini_batch_src_global generation:  0.024879932403564453
r_  generation:  0.199293851852417
local_output_nid generation:  0.011171579360961914
local_in_edges_tensor generation:  0.021750926971435547
mini_batch_src_global generation:  0.026575565338134766
r_  generation:  0.18572640419006348
local_output_nid generation:  0.00787043571472168
local_in_edges_tensor generation:  0.012375354766845703
mini_batch_src_global generation:  0.023666858673095703
r_  generation:  0.18234562873840332
local_output_nid generation:  0.007813453674316406
local_in_edges_tensor generation:  0.010503053665161133
mini_batch_src_global generation:  0.022348642349243164
r_  generation:  0.23624157905578613
----------------------check_connections_block total spend ----------------------------- 8.56226634979248
generate_one_block  0.2468247413635254
generate_one_block  0.2299354076385498
generate_one_block  0.25631093978881836
generate_one_block  0.26293158531188965
generate_one_block  0.2317187786102295
generate_one_block  0.2362537384033203
generate_one_block  0.24107575416564941
generate_one_block  0.21860146522521973
generate_one_block  0.2184441089630127
generate_one_block  0.23340058326721191
generate_one_block  0.25400686264038086
generate_one_block  0.21203255653381348
generate_one_block  0.24043846130371094
generate_one_block  0.23914885520935059
generate_one_block  0.22562408447265625
generate_one_block  0.26333141326904297
generate_one_block  0.25691699981689453
generate_one_block  0.2221531867980957
generate_one_block  0.22016477584838867
generate_one_block  0.23709416389465332
generate_one_block  0.2410411834716797
generate_one_block  0.2352311611175537
generate_one_block  0.22224164009094238
generate_one_block  0.23012042045593262
generate_one_block  0.22018814086914062
generate_one_block  0.23894643783569336
generate_one_block  0.22601723670959473
generate_one_block  0.23066234588623047
generate_one_block  0.23719143867492676
generate_one_block  0.23946022987365723
generate_one_block  0.2192850112915039
generate_one_block  0.22067594528198242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0368802547454834
gen group dst list time:  0.114776611328125
time for parepare:  0.020745277404785156
local_output_nid generation:  0.025345563888549805
local_in_edges_tensor generation:  0.0554051399230957
mini_batch_src_global generation:  0.04298543930053711
r_  generation:  0.41141581535339355
local_output_nid generation:  0.028491973876953125
local_in_edges_tensor generation:  0.040926456451416016
mini_batch_src_global generation:  0.0489048957824707
r_  generation:  0.4205358028411865
local_output_nid generation:  0.028586626052856445
local_in_edges_tensor generation:  0.029647111892700195
mini_batch_src_global generation:  0.04855179786682129
r_  generation:  0.4304053783416748
local_output_nid generation:  0.0273590087890625
local_in_edges_tensor generation:  0.041397809982299805
mini_batch_src_global generation:  0.05026984214782715
r_  generation:  0.44454002380371094
local_output_nid generation:  0.027258872985839844
local_in_edges_tensor generation:  0.03099203109741211
mini_batch_src_global generation:  0.052430152893066406
r_  generation:  0.4331052303314209
local_output_nid generation:  0.02767491340637207
local_in_edges_tensor generation:  0.039875030517578125
mini_batch_src_global generation:  0.05306673049926758
r_  generation:  0.43129396438598633
local_output_nid generation:  0.02904677391052246
local_in_edges_tensor generation:  0.026275157928466797
mini_batch_src_global generation:  0.05016899108886719
r_  generation:  0.43181300163269043
local_output_nid generation:  0.028421640396118164
local_in_edges_tensor generation:  0.026596546173095703
mini_batch_src_global generation:  0.05041933059692383
r_  generation:  0.4295618534088135
local_output_nid generation:  0.0280458927154541
local_in_edges_tensor generation:  0.03354692459106445
mini_batch_src_global generation:  0.04995155334472656
r_  generation:  0.43056154251098633
local_output_nid generation:  0.02860403060913086
local_in_edges_tensor generation:  0.03414463996887207
mini_batch_src_global generation:  0.050501108169555664
r_  generation:  0.4395473003387451
local_output_nid generation:  0.028662443161010742
local_in_edges_tensor generation:  0.03409862518310547
mini_batch_src_global generation:  0.05046367645263672
r_  generation:  0.43627333641052246
local_output_nid generation:  0.028130292892456055
local_in_edges_tensor generation:  0.02600264549255371
mini_batch_src_global generation:  0.050165653228759766
r_  generation:  0.4291572570800781
local_output_nid generation:  0.02884697914123535
local_in_edges_tensor generation:  0.034372806549072266
mini_batch_src_global generation:  0.05335283279418945
r_  generation:  0.43956446647644043
local_output_nid generation:  0.02886199951171875
local_in_edges_tensor generation:  0.030155420303344727
mini_batch_src_global generation:  0.059494972229003906
r_  generation:  0.44233012199401855
local_output_nid generation:  0.029299497604370117
local_in_edges_tensor generation:  0.03091144561767578
mini_batch_src_global generation:  0.05073213577270508
r_  generation:  0.43615055084228516
local_output_nid generation:  0.028810501098632812
local_in_edges_tensor generation:  0.026338815689086914
mini_batch_src_global generation:  0.05044889450073242
r_  generation:  0.44090747833251953
local_output_nid generation:  0.029442548751831055
local_in_edges_tensor generation:  0.04155850410461426
mini_batch_src_global generation:  0.06113767623901367
r_  generation:  0.46103787422180176
local_output_nid generation:  0.031036376953125
local_in_edges_tensor generation:  0.030903100967407227
mini_batch_src_global generation:  0.05336356163024902
r_  generation:  0.433635950088501
local_output_nid generation:  0.028546810150146484
local_in_edges_tensor generation:  0.02900552749633789
mini_batch_src_global generation:  0.056822776794433594
r_  generation:  0.4383985996246338
local_output_nid generation:  0.029286861419677734
local_in_edges_tensor generation:  0.038216590881347656
mini_batch_src_global generation:  0.050490617752075195
r_  generation:  0.4389505386352539
local_output_nid generation:  0.029067516326904297
local_in_edges_tensor generation:  0.033888816833496094
mini_batch_src_global generation:  0.050364017486572266
r_  generation:  0.44558262825012207
local_output_nid generation:  0.028744220733642578
local_in_edges_tensor generation:  0.026314735412597656
mini_batch_src_global generation:  0.05061697959899902
r_  generation:  0.4385039806365967
local_output_nid generation:  0.028937816619873047
local_in_edges_tensor generation:  0.027059555053710938
mini_batch_src_global generation:  0.050005435943603516
r_  generation:  0.4369490146636963
local_output_nid generation:  0.028670310974121094
local_in_edges_tensor generation:  0.02987813949584961
mini_batch_src_global generation:  0.05098247528076172
r_  generation:  0.43825864791870117
local_output_nid generation:  0.0284273624420166
local_in_edges_tensor generation:  0.030088424682617188
mini_batch_src_global generation:  0.050072669982910156
r_  generation:  0.43890857696533203
local_output_nid generation:  0.028601884841918945
local_in_edges_tensor generation:  0.029931068420410156
mini_batch_src_global generation:  0.05060887336730957
r_  generation:  0.43650174140930176
local_output_nid generation:  0.0287322998046875
local_in_edges_tensor generation:  0.03402352333068848
mini_batch_src_global generation:  0.05022263526916504
r_  generation:  0.4382321834564209
local_output_nid generation:  0.028953075408935547
local_in_edges_tensor generation:  0.03424263000488281
mini_batch_src_global generation:  0.053327083587646484
r_  generation:  0.4392235279083252
local_output_nid generation:  0.028684377670288086
local_in_edges_tensor generation:  0.026413917541503906
mini_batch_src_global generation:  0.050223588943481445
r_  generation:  0.4381749629974365
local_output_nid generation:  0.028842687606811523
local_in_edges_tensor generation:  0.03022456169128418
mini_batch_src_global generation:  0.05054330825805664
r_  generation:  0.43776893615722656
local_output_nid generation:  0.02900862693786621
local_in_edges_tensor generation:  0.03426980972290039
mini_batch_src_global generation:  0.050353050231933594
r_  generation:  0.44376444816589355
local_output_nid generation:  0.028697729110717773
local_in_edges_tensor generation:  0.026320457458496094
mini_batch_src_global generation:  0.07442188262939453
r_  generation:  0.43856120109558105
----------------------check_connections_block total spend ----------------------------- 20.695774793624878
generate_one_block  0.6477324962615967
generate_one_block  0.5601093769073486
generate_one_block  0.5494601726531982
generate_one_block  0.5597455501556396
generate_one_block  0.5512914657592773
generate_one_block  0.5567319393157959
generate_one_block  0.5473189353942871
generate_one_block  0.5602216720581055
generate_one_block  0.5561964511871338
generate_one_block  0.5634288787841797
generate_one_block  0.5507876873016357
generate_one_block  0.5354688167572021
generate_one_block  0.5769519805908203
generate_one_block  0.5614519119262695
generate_one_block  0.5408236980438232
generate_one_block  0.5416474342346191
generate_one_block  0.5672893524169922
generate_one_block  0.5439965724945068
generate_one_block  0.5429282188415527
generate_one_block  0.5635244846343994
generate_one_block  0.578524112701416
generate_one_block  0.5481927394866943
generate_one_block  0.5419340133666992
generate_one_block  0.5550658702850342
generate_one_block  0.5447089672088623
generate_one_block  0.5499107837677002
generate_one_block  0.5524895191192627
generate_one_block  0.5583961009979248
generate_one_block  0.5511050224304199
generate_one_block  0.5551214218139648
generate_one_block  0.5528035163879395
generate_one_block  0.5487511157989502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  29.25804114341736
block generation total time  25.321579933166504
average batch blocks generation time:  0.7912993729114532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08531427383422852  GigaBytes
Max Memory Allocated: 0.08531427383422852  GigaBytes

torch.Size([148538, 128])
torch.Size([109769, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7069091796875 GB
    Memory Allocated: 0.37790489196777344  GigaBytes
Max Memory Allocated: 0.3890647888183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08587646484375  GigaBytes
Max Memory Allocated: 0.4352855682373047  GigaBytes

torch.Size([148342, 128])
torch.Size([109244, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.3777427673339844  GigaBytes
Max Memory Allocated: 0.4352855682373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08603429794311523  GigaBytes
Max Memory Allocated: 0.4352855682373047  GigaBytes

torch.Size([148729, 128])
torch.Size([109483, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.3779025077819824  GigaBytes
Max Memory Allocated: 0.4352855682373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08622360229492188  GigaBytes
Max Memory Allocated: 0.4353666305541992  GigaBytes

torch.Size([148702, 128])
torch.Size([110181, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.37917089462280273  GigaBytes
Max Memory Allocated: 0.4353666305541992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08616256713867188  GigaBytes
Max Memory Allocated: 0.4360666275024414  GigaBytes

torch.Size([148638, 128])
torch.Size([109272, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.37860631942749023  GigaBytes
Max Memory Allocated: 0.4360666275024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08648538589477539  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

torch.Size([148963, 128])
torch.Size([110348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.38028526306152344  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.0863199234008789  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

torch.Size([148940, 128])
torch.Size([109621, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.37939882278442383  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08594131469726562  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

torch.Size([148720, 128])
torch.Size([108872, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.37561511993408203  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08567333221435547  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

torch.Size([148026, 128])
torch.Size([108225, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.3717226982116699  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08623313903808594  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

torch.Size([148516, 128])
torch.Size([110028, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.37902116775512695  GigaBytes
Max Memory Allocated: 0.4362936019897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08640909194946289  GigaBytes
Max Memory Allocated: 0.4363260269165039  GigaBytes

torch.Size([148867, 128])
torch.Size([109996, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.3795962333679199  GigaBytes
Max Memory Allocated: 0.4363260269165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08553886413574219  GigaBytes
Max Memory Allocated: 0.4363260269165039  GigaBytes

torch.Size([148056, 128])
torch.Size([107834, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.36997318267822266  GigaBytes
Max Memory Allocated: 0.4363260269165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.08672952651977539  GigaBytes
Max Memory Allocated: 0.4363260269165039  GigaBytes

torch.Size([149353, 128])
torch.Size([110746, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.3816971778869629  GigaBytes
Max Memory Allocated: 0.4363260269165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.08674144744873047  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

torch.Size([149324, 128])
torch.Size([110527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.3810749053955078  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.08594131469726562  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

torch.Size([148464, 128])
torch.Size([108298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.3733229637145996  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.08601188659667969  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

torch.Size([148526, 128])
torch.Size([108864, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.37787914276123047  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.08706235885620117  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

torch.Size([149319, 128])
torch.Size([111916, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3868746757507324  GigaBytes
Max Memory Allocated: 0.4367194175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08588552474975586  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148531, 128])
torch.Size([109076, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37606239318847656  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08598613739013672  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148586, 128])
torch.Size([108948, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3764476776123047  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08665990829467773  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149323, 128])
torch.Size([110876, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3814053535461426  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08668136596679688  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149194, 128])
torch.Size([110393, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3808565139770508  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.0864267349243164  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148868, 128])
torch.Size([110466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3805098533630371  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08624696731567383  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148921, 128])
torch.Size([109938, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3785114288330078  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08654975891113281  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149174, 128])
torch.Size([110519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.38056230545043945  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.0859837532043457  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148529, 128])
torch.Size([109432, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37789106369018555  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08626365661621094  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148626, 128])
torch.Size([109438, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3791012763977051  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08634090423583984  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148970, 128])
torch.Size([110088, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3792557716369629  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08633995056152344  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148832, 128])
torch.Size([110332, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37959957122802734  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08619451522827148  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148503, 128])
torch.Size([109483, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37906885147094727  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08623743057250977  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148575, 128])
torch.Size([109763, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37938404083251953  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08642721176147461  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149335, 128])
torch.Size([110335, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37850475311279297  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08604955673217773  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148637, 128])
torch.Size([109279, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37795162200927734  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029309675097465515 |0.02257101982831955 |0.02691192924976349 |9.576231241226196e-05 |0.004553735256195068 |0.002056598663330078 |
----------------------------------------------------------pseudo_mini_loss sum 5.632503032684326
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9111215
Number of first layer input nodes during this epoch:  4760627
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.10655355453491211  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.07755422592163086
range selection method range initialization spend 0.015313148498535156
time for parepare:  0.01725316047668457
local_output_nid generation:  0.0007252693176269531
local_in_edges_tensor generation:  0.005814313888549805
mini_batch_src_global generation:  0.001806497573852539
r_  generation:  0.011548757553100586
local_output_nid generation:  0.0008509159088134766
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0014889240264892578
r_  generation:  0.01007533073425293
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.000949859619140625
r_  generation:  0.009434700012207031
local_output_nid generation:  0.0007905960083007812
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.0009648799896240234
r_  generation:  0.00933218002319336
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009162425994873047
r_  generation:  0.009749889373779297
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.009785890579223633
local_output_nid generation:  0.0007796287536621094
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.00095367431640625
r_  generation:  0.010022163391113281
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.009765386581420898
local_output_nid generation:  0.0007512569427490234
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.0009653568267822266
r_  generation:  0.01010584831237793
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0009579658508300781
r_  generation:  0.009600639343261719
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0009522438049316406
r_  generation:  0.009916305541992188
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009734630584716797
r_  generation:  0.010049819946289062
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.00974583625793457
local_output_nid generation:  0.0007853507995605469
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009663105010986328
r_  generation:  0.009907722473144531
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0009665489196777344
r_  generation:  0.009923458099365234
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.009778499603271484
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.000989675521850586
r_  generation:  0.010298013687133789
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0009937286376953125
r_  generation:  0.010144948959350586
local_output_nid generation:  0.0007672309875488281
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.010120391845703125
local_output_nid generation:  0.0007722377777099609
local_in_edges_tensor generation:  0.0005125999450683594
mini_batch_src_global generation:  0.0011739730834960938
r_  generation:  0.010202884674072266
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.009895086288452148
local_output_nid generation:  0.00077056884765625
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.010433197021484375
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0010066032409667969
r_  generation:  0.009814023971557617
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.001033782958984375
r_  generation:  0.010190010070800781
local_output_nid generation:  0.0007696151733398438
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0010464191436767578
r_  generation:  0.01051187515258789
local_output_nid generation:  0.0007619857788085938
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0010287761688232422
r_  generation:  0.010006189346313477
local_output_nid generation:  0.0007789134979248047
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.001041412353515625
r_  generation:  0.010281085968017578
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.009992122650146484
local_output_nid generation:  0.0007669925689697266
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0010440349578857422
r_  generation:  0.010530471801757812
local_output_nid generation:  0.0007719993591308594
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.009987115859985352
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.00046539306640625
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.00998234748840332
local_output_nid generation:  0.0007727146148681641
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0009984970092773438
r_  generation:  0.010228872299194336
----------------------check_connections_block total spend ----------------------------- 0.4918830394744873
generate_one_block  0.01460576057434082
generate_one_block  0.01666712760925293
generate_one_block  0.014406204223632812
generate_one_block  0.01445150375366211
generate_one_block  0.014774084091186523
generate_one_block  0.014834880828857422
generate_one_block  0.0146942138671875
generate_one_block  0.014679431915283203
generate_one_block  0.014867544174194336
generate_one_block  0.014096736907958984
generate_one_block  0.014455556869506836
generate_one_block  0.014892339706420898
generate_one_block  0.014276266098022461
generate_one_block  0.014637231826782227
generate_one_block  0.014465808868408203
generate_one_block  0.01453852653503418
generate_one_block  0.015002250671386719
generate_one_block  0.01488351821899414
generate_one_block  0.014549970626831055
generate_one_block  0.01499795913696289
generate_one_block  0.014492988586425781
generate_one_block  0.015179157257080078
generate_one_block  0.014353752136230469
generate_one_block  0.015038251876831055
generate_one_block  0.015429019927978516
generate_one_block  0.014739274978637695
generate_one_block  0.01503443717956543
generate_one_block  0.014522552490234375
generate_one_block  0.015211820602416992
generate_one_block  0.014534473419189453
generate_one_block  0.014534473419189453
generate_one_block  0.014651060104370117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03637814521789551
gen group dst list time:  0.02394390106201172
time for parepare:  0.018978118896484375
local_output_nid generation:  0.00405430793762207
local_in_edges_tensor generation:  0.015258312225341797
mini_batch_src_global generation:  0.017811059951782227
r_  generation:  0.156494140625
local_output_nid generation:  0.006631612777709961
local_in_edges_tensor generation:  0.013785839080810547
mini_batch_src_global generation:  0.020369529724121094
r_  generation:  0.1621079444885254
local_output_nid generation:  0.006642341613769531
local_in_edges_tensor generation:  0.029073238372802734
mini_batch_src_global generation:  0.02023911476135254
r_  generation:  0.16534781455993652
local_output_nid generation:  0.007104635238647461
local_in_edges_tensor generation:  0.009639501571655273
mini_batch_src_global generation:  0.020127534866333008
r_  generation:  0.17069435119628906
local_output_nid generation:  0.007572174072265625
local_in_edges_tensor generation:  0.011410236358642578
mini_batch_src_global generation:  0.02151632308959961
r_  generation:  0.17738080024719238
local_output_nid generation:  0.007704973220825195
local_in_edges_tensor generation:  0.008575916290283203
mini_batch_src_global generation:  0.02218484878540039
r_  generation:  0.17938876152038574
local_output_nid generation:  0.007481098175048828
local_in_edges_tensor generation:  0.01119542121887207
mini_batch_src_global generation:  0.022424936294555664
r_  generation:  0.1795339584350586
local_output_nid generation:  0.0073010921478271484
local_in_edges_tensor generation:  0.010051250457763672
mini_batch_src_global generation:  0.0224301815032959
r_  generation:  0.17734503746032715
local_output_nid generation:  0.007605075836181641
local_in_edges_tensor generation:  0.011844396591186523
mini_batch_src_global generation:  0.023786067962646484
r_  generation:  0.18172955513000488
local_output_nid generation:  0.007582426071166992
local_in_edges_tensor generation:  0.00980830192565918
mini_batch_src_global generation:  0.021738767623901367
r_  generation:  0.17138099670410156
local_output_nid generation:  0.0078008174896240234
local_in_edges_tensor generation:  0.008642196655273438
mini_batch_src_global generation:  0.02581787109375
r_  generation:  0.1775646209716797
local_output_nid generation:  0.007962703704833984
local_in_edges_tensor generation:  0.01039266586303711
mini_batch_src_global generation:  0.026428937911987305
r_  generation:  0.18232202529907227
local_output_nid generation:  0.0077648162841796875
local_in_edges_tensor generation:  0.008729934692382812
mini_batch_src_global generation:  0.022309541702270508
r_  generation:  0.1778569221496582
local_output_nid generation:  0.008066892623901367
local_in_edges_tensor generation:  0.01061105728149414
mini_batch_src_global generation:  0.023982763290405273
r_  generation:  0.1794888973236084
local_output_nid generation:  0.008007526397705078
local_in_edges_tensor generation:  0.010519742965698242
mini_batch_src_global generation:  0.022093772888183594
r_  generation:  0.17699980735778809
local_output_nid generation:  0.008055686950683594
local_in_edges_tensor generation:  0.014476776123046875
mini_batch_src_global generation:  0.02324080467224121
r_  generation:  0.18148326873779297
local_output_nid generation:  0.008281707763671875
local_in_edges_tensor generation:  0.01231074333190918
mini_batch_src_global generation:  0.02373504638671875
r_  generation:  0.18732166290283203
local_output_nid generation:  0.00810551643371582
local_in_edges_tensor generation:  0.009001970291137695
mini_batch_src_global generation:  0.02292633056640625
r_  generation:  0.1882948875427246
local_output_nid generation:  0.008010149002075195
local_in_edges_tensor generation:  0.009066104888916016
mini_batch_src_global generation:  0.02527165412902832
r_  generation:  0.18143177032470703
local_output_nid generation:  0.007908344268798828
local_in_edges_tensor generation:  0.012081146240234375
mini_batch_src_global generation:  0.024309635162353516
r_  generation:  0.1851177215576172
local_output_nid generation:  0.007685184478759766
local_in_edges_tensor generation:  0.009071588516235352
mini_batch_src_global generation:  0.022761106491088867
r_  generation:  0.18270039558410645
local_output_nid generation:  0.007924079895019531
local_in_edges_tensor generation:  0.011213302612304688
mini_batch_src_global generation:  0.024836063385009766
r_  generation:  0.18447422981262207
local_output_nid generation:  0.009979724884033203
local_in_edges_tensor generation:  0.008816957473754883
mini_batch_src_global generation:  0.022044658660888672
r_  generation:  0.17972755432128906
local_output_nid generation:  0.007792949676513672
local_in_edges_tensor generation:  0.010991096496582031
mini_batch_src_global generation:  0.024367809295654297
r_  generation:  0.18538331985473633
local_output_nid generation:  0.007897615432739258
local_in_edges_tensor generation:  0.014039278030395508
mini_batch_src_global generation:  0.023589134216308594
r_  generation:  0.18613815307617188
local_output_nid generation:  0.007684946060180664
local_in_edges_tensor generation:  0.009096622467041016
mini_batch_src_global generation:  0.0236055850982666
r_  generation:  0.18344712257385254
local_output_nid generation:  0.008856773376464844
local_in_edges_tensor generation:  0.015818119049072266
mini_batch_src_global generation:  0.02426457405090332
r_  generation:  0.19597959518432617
local_output_nid generation:  0.007745981216430664
local_in_edges_tensor generation:  0.012116193771362305
mini_batch_src_global generation:  0.024161100387573242
r_  generation:  0.1897878646850586
local_output_nid generation:  0.010167121887207031
local_in_edges_tensor generation:  0.013643264770507812
mini_batch_src_global generation:  0.02376413345336914
r_  generation:  0.1885209083557129
local_output_nid generation:  0.007994890213012695
local_in_edges_tensor generation:  0.010818958282470703
mini_batch_src_global generation:  0.023412466049194336
r_  generation:  0.18135452270507812
local_output_nid generation:  0.007908821105957031
local_in_edges_tensor generation:  0.009021997451782227
mini_batch_src_global generation:  0.02222728729248047
r_  generation:  0.17692041397094727
local_output_nid generation:  0.008051872253417969
local_in_edges_tensor generation:  0.009135723114013672
mini_batch_src_global generation:  0.0244748592376709
r_  generation:  0.1842517852783203
----------------------check_connections_block total spend ----------------------------- 8.436121702194214
generate_one_block  0.21846890449523926
generate_one_block  0.2198467254638672
generate_one_block  0.22269439697265625
generate_one_block  0.2229757308959961
generate_one_block  0.2453305721282959
generate_one_block  0.24029159545898438
generate_one_block  0.25089526176452637
generate_one_block  0.2203226089477539
generate_one_block  0.23463225364685059
generate_one_block  0.21634316444396973
generate_one_block  0.23827075958251953
generate_one_block  0.22784876823425293
generate_one_block  0.22033143043518066
generate_one_block  0.22709250450134277
generate_one_block  0.2209329605102539
generate_one_block  0.23392963409423828
generate_one_block  0.25334763526916504
generate_one_block  0.231583833694458
generate_one_block  0.2283163070678711
generate_one_block  0.26672792434692383
generate_one_block  0.22404074668884277
generate_one_block  0.23617005348205566
generate_one_block  0.2171320915222168
generate_one_block  0.2365097999572754
generate_one_block  0.23758625984191895
generate_one_block  0.2231435775756836
generate_one_block  0.23531007766723633
generate_one_block  0.22124385833740234
generate_one_block  0.23678255081176758
generate_one_block  0.23027443885803223
generate_one_block  0.2417278289794922
generate_one_block  0.23769044876098633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052483558654785156
gen group dst list time:  0.10863065719604492
time for parepare:  0.01756572723388672
local_output_nid generation:  0.02285027503967285
local_in_edges_tensor generation:  0.05887341499328613
mini_batch_src_global generation:  0.03829455375671387
r_  generation:  0.4352402687072754
local_output_nid generation:  0.03374600410461426
local_in_edges_tensor generation:  0.04954862594604492
mini_batch_src_global generation:  0.05053853988647461
r_  generation:  0.4259049892425537
local_output_nid generation:  0.028926610946655273
local_in_edges_tensor generation:  0.03869915008544922
mini_batch_src_global generation:  0.047948598861694336
r_  generation:  0.4242246150970459
local_output_nid generation:  0.0285184383392334
local_in_edges_tensor generation:  0.03653454780578613
mini_batch_src_global generation:  0.04933524131774902
r_  generation:  0.42659521102905273
local_output_nid generation:  0.02895951271057129
local_in_edges_tensor generation:  0.03257036209106445
mini_batch_src_global generation:  0.053084373474121094
r_  generation:  0.4323852062225342
local_output_nid generation:  0.028872251510620117
local_in_edges_tensor generation:  0.04034280776977539
mini_batch_src_global generation:  0.06279468536376953
r_  generation:  0.4357914924621582
local_output_nid generation:  0.028569459915161133
local_in_edges_tensor generation:  0.04127621650695801
mini_batch_src_global generation:  0.050878286361694336
r_  generation:  0.4367177486419678
local_output_nid generation:  0.03136134147644043
local_in_edges_tensor generation:  0.041075706481933594
mini_batch_src_global generation:  0.051332950592041016
r_  generation:  0.45728635787963867
local_output_nid generation:  0.0325167179107666
local_in_edges_tensor generation:  0.03905677795410156
mini_batch_src_global generation:  0.055208444595336914
r_  generation:  0.43704986572265625
local_output_nid generation:  0.02905130386352539
local_in_edges_tensor generation:  0.03340649604797363
mini_batch_src_global generation:  0.05225634574890137
r_  generation:  0.43187379837036133
local_output_nid generation:  0.029474735260009766
local_in_edges_tensor generation:  0.027040958404541016
mini_batch_src_global generation:  0.05392646789550781
r_  generation:  0.43558597564697266
local_output_nid generation:  0.029521465301513672
local_in_edges_tensor generation:  0.037194013595581055
mini_batch_src_global generation:  0.05080556869506836
r_  generation:  0.45014452934265137
local_output_nid generation:  0.028949737548828125
local_in_edges_tensor generation:  0.027034759521484375
mini_batch_src_global generation:  0.05079054832458496
r_  generation:  0.43404126167297363
local_output_nid generation:  0.02949833869934082
local_in_edges_tensor generation:  0.027493953704833984
mini_batch_src_global generation:  0.05056619644165039
r_  generation:  0.43582868576049805
local_output_nid generation:  0.029114484786987305
local_in_edges_tensor generation:  0.04119420051574707
mini_batch_src_global generation:  0.050073862075805664
r_  generation:  0.43596744537353516
local_output_nid generation:  0.02955484390258789
local_in_edges_tensor generation:  0.0350031852722168
mini_batch_src_global generation:  0.05511474609375
r_  generation:  0.4431459903717041
local_output_nid generation:  0.030436992645263672
local_in_edges_tensor generation:  0.03900790214538574
mini_batch_src_global generation:  0.05336952209472656
r_  generation:  0.456981897354126
local_output_nid generation:  0.0317080020904541
local_in_edges_tensor generation:  0.03523612022399902
mini_batch_src_global generation:  0.052893877029418945
r_  generation:  0.4320378303527832
local_output_nid generation:  0.029404163360595703
local_in_edges_tensor generation:  0.03057265281677246
mini_batch_src_global generation:  0.05255722999572754
r_  generation:  0.4343435764312744
local_output_nid generation:  0.029822826385498047
local_in_edges_tensor generation:  0.04037761688232422
mini_batch_src_global generation:  0.05066514015197754
r_  generation:  0.43959689140319824
local_output_nid generation:  0.029483556747436523
local_in_edges_tensor generation:  0.026184558868408203
mini_batch_src_global generation:  0.05040860176086426
r_  generation:  0.4403238296508789
local_output_nid generation:  0.029715299606323242
local_in_edges_tensor generation:  0.02736639976501465
mini_batch_src_global generation:  0.05264544486999512
r_  generation:  0.43808627128601074
local_output_nid generation:  0.029191970825195312
local_in_edges_tensor generation:  0.031075239181518555
mini_batch_src_global generation:  0.06957030296325684
r_  generation:  0.44065022468566895
local_output_nid generation:  0.029370546340942383
local_in_edges_tensor generation:  0.030259132385253906
mini_batch_src_global generation:  0.05412697792053223
r_  generation:  0.43689632415771484
local_output_nid generation:  0.029287338256835938
local_in_edges_tensor generation:  0.030609846115112305
mini_batch_src_global generation:  0.05047011375427246
r_  generation:  0.4393749237060547
local_output_nid generation:  0.029546260833740234
local_in_edges_tensor generation:  0.02720355987548828
mini_batch_src_global generation:  0.051744699478149414
r_  generation:  0.4364030361175537
local_output_nid generation:  0.029245853424072266
local_in_edges_tensor generation:  0.033852338790893555
mini_batch_src_global generation:  0.053308963775634766
r_  generation:  0.4439406394958496
local_output_nid generation:  0.02933478355407715
local_in_edges_tensor generation:  0.027261018753051758
mini_batch_src_global generation:  0.052080392837524414
r_  generation:  0.4357876777648926
local_output_nid generation:  0.029453039169311523
local_in_edges_tensor generation:  0.03050851821899414
mini_batch_src_global generation:  0.05365490913391113
r_  generation:  0.44351696968078613
local_output_nid generation:  0.029169797897338867
local_in_edges_tensor generation:  0.03547167778015137
mini_batch_src_global generation:  0.051863908767700195
r_  generation:  0.4371304512023926
local_output_nid generation:  0.029299020767211914
local_in_edges_tensor generation:  0.0311737060546875
mini_batch_src_global generation:  0.05042290687561035
r_  generation:  0.43557310104370117
local_output_nid generation:  0.02910017967224121
local_in_edges_tensor generation:  0.03444409370422363
mini_batch_src_global generation:  0.051248788833618164
r_  generation:  0.4393942356109619
----------------------check_connections_block total spend ----------------------------- 20.883846282958984
generate_one_block  0.5558059215545654
generate_one_block  0.5547022819519043
generate_one_block  0.5555539131164551
generate_one_block  0.5650768280029297
generate_one_block  0.6897108554840088
generate_one_block  0.5641050338745117
generate_one_block  0.5451366901397705
generate_one_block  0.5700027942657471
generate_one_block  0.5540692806243896
generate_one_block  0.5471491813659668
generate_one_block  0.5513603687286377
generate_one_block  0.5598065853118896
generate_one_block  0.5507845878601074
generate_one_block  0.5588595867156982
generate_one_block  0.558516263961792
generate_one_block  0.5811877250671387
generate_one_block  0.565319299697876
generate_one_block  0.5436949729919434
generate_one_block  0.5495035648345947
generate_one_block  0.5709743499755859
generate_one_block  0.5533280372619629
generate_one_block  0.5666351318359375
generate_one_block  0.5439262390136719
generate_one_block  0.5479748249053955
generate_one_block  0.5817432403564453
generate_one_block  0.5571928024291992
generate_one_block  0.5591509342193604
generate_one_block  0.5511000156402588
generate_one_block  0.5582642555236816
generate_one_block  0.5578422546386719
generate_one_block  0.5567591190338135
generate_one_block  0.623661994934082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.10655355453491211  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

connection checking time:  29.3199679851532
block generation total time  25.46669363975525
average batch blocks generation time:  0.7958341762423515
block dataloader generation time/epoch 57.429033517837524
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08657264709472656  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148925, 128])
torch.Size([109198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37627220153808594  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08654642105102539  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148581, 128])
torch.Size([108928, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37836265563964844  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08661603927612305  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148639, 128])
torch.Size([109068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37848854064941406  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08675527572631836  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148849, 128])
torch.Size([109091, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3786907196044922  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08695125579833984  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148840, 128])
torch.Size([110047, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37996912002563477  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08698654174804688  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148970, 128])
torch.Size([110103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3797769546508789  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08663511276245117  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148395, 128])
torch.Size([109075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3792119026184082  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.0868215560913086  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148816, 128])
torch.Size([109749, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37897253036499023  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08674478530883789  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148419, 128])
torch.Size([109540, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37990427017211914  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08631038665771484  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148266, 128])
torch.Size([108534, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37244558334350586  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08670520782470703  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148612, 128])
torch.Size([109287, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3787083625793457  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08686542510986328  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148840, 128])
torch.Size([109819, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37932348251342773  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08638525009155273  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148213, 128])
torch.Size([108692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37818384170532227  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08684062957763672  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148940, 128])
torch.Size([109678, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37933778762817383  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08668184280395508  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148759, 128])
torch.Size([109646, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3790903091430664  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08714151382446289  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149343, 128])
torch.Size([110430, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37980222702026367  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08712053298950195  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149041, 128])
torch.Size([110735, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.38150644302368164  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08677244186401367  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148819, 128])
torch.Size([109404, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37950992584228516  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08690595626831055  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149129, 128])
torch.Size([110189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37949609756469727  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08731555938720703  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149486, 128])
torch.Size([111385, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3826751708984375  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08692026138305664  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149019, 128])
torch.Size([109972, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37970638275146484  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08731985092163086  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149365, 128])
torch.Size([111243, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.38309192657470703  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08662605285644531  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148768, 128])
torch.Size([108960, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3784346580505371  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08699274063110352  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148929, 128])
torch.Size([110285, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3804435729980469  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.0869283676147461  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148714, 128])
torch.Size([109944, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3814878463745117  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08681583404541016  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148772, 128])
torch.Size([109836, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37911510467529297  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.0869755744934082  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148699, 128])
torch.Size([110465, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3813962936401367  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.086761474609375  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148764, 128])
torch.Size([109708, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3788580894470215  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08695363998413086  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148689, 128])
torch.Size([109659, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.38054943084716797  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08700799942016602  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([149183, 128])
torch.Size([109826, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.37944841384887695  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08673954010009766  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148862, 128])
torch.Size([109683, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3787074089050293  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.08670902252197266  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

torch.Size([148484, 128])
torch.Size([109602, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.3793449401855469  GigaBytes
Max Memory Allocated: 0.4411754608154297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024984829127788544 |0.012365348637104034 |0.003446042537689209 |9.01445746421814e-05 |0.0032799914479255676 |0.0030999183654785156 |
----------------------------------------------------------pseudo_mini_loss sum 3.596106767654419
Total (block generation + training)time/epoch 58.8954553604126
Training time/epoch 1.46598219871521
Training time without block to device /epoch 1.0702910423278809
Training time without total dataloading part /epoch 0.22121763229370117
load block tensor time/epoch 0.7995145320892334
block to device time/epoch 0.3956911563873291
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9112797
Number of first layer input nodes during this epoch:  4762130
