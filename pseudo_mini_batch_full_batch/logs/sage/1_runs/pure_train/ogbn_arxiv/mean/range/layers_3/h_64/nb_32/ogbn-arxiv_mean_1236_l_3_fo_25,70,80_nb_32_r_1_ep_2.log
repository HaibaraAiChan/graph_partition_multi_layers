Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648448573.275975
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02703571319580078
range selection method range initialization spend 0.013966083526611328
time for parepare:  0.018256664276123047
local_output_nid generation:  0.0006968975067138672
local_in_edges_tensor generation:  0.003690958023071289
mini_batch_src_global generation:  0.0015645027160644531
r_  generation:  0.011145591735839844
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0006260871887207031
mini_batch_src_global generation:  0.0015704631805419922
r_  generation:  0.01003885269165039
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0005567073822021484
mini_batch_src_global generation:  0.0010235309600830078
r_  generation:  0.009419441223144531
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.0005064010620117188
mini_batch_src_global generation:  0.0009257793426513672
r_  generation:  0.009270429611206055
local_output_nid generation:  0.0007655620574951172
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0008578300476074219
r_  generation:  0.008748531341552734
local_output_nid generation:  0.0007624626159667969
local_in_edges_tensor generation:  0.0005171298980712891
mini_batch_src_global generation:  0.0010218620300292969
r_  generation:  0.009249210357666016
local_output_nid generation:  0.0007424354553222656
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0009219646453857422
r_  generation:  0.009719610214233398
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.0005223751068115234
mini_batch_src_global generation:  0.0008971691131591797
r_  generation:  0.009696006774902344
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0009107589721679688
r_  generation:  0.009479045867919922
local_output_nid generation:  0.0007486343383789062
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.0009419918060302734
r_  generation:  0.009889364242553711
local_output_nid generation:  0.0007448196411132812
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0009605884552001953
r_  generation:  0.009996414184570312
local_output_nid generation:  0.0007669925689697266
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0010156631469726562
r_  generation:  0.010183572769165039
local_output_nid generation:  0.0007894039154052734
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.009973526000976562
local_output_nid generation:  0.0007808208465576172
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0010037422180175781
r_  generation:  0.009846687316894531
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.00102996826171875
r_  generation:  0.010416030883789062
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.0005097389221191406
mini_batch_src_global generation:  0.0010662078857421875
r_  generation:  0.01019597053527832
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.010494232177734375
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0010807514190673828
r_  generation:  0.010427474975585938
local_output_nid generation:  0.0007665157318115234
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.001026153564453125
r_  generation:  0.010061025619506836
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0010631084442138672
r_  generation:  0.010339498519897461
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0010106563568115234
r_  generation:  0.010220050811767578
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0009615421295166016
r_  generation:  0.00958395004272461
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0009765625
r_  generation:  0.010075807571411133
local_output_nid generation:  0.0007550716400146484
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.009996891021728516
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.009993791580200195
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.010152578353881836
local_output_nid generation:  0.0007452964782714844
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.010043859481811523
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.01013636589050293
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0009832382202148438
r_  generation:  0.009730100631713867
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.004269599914550781
mini_batch_src_global generation:  0.0011820793151855469
r_  generation:  0.010149955749511719
local_output_nid generation:  0.0008184909820556641
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0010676383972167969
r_  generation:  0.010018110275268555
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.009976863861083984
----------------------check_connections_block total spend ----------------------------- 0.4902195930480957
generate_one_block  0.015767812728881836
generate_one_block  0.01557469367980957
generate_one_block  0.014823675155639648
generate_one_block  0.014674663543701172
generate_one_block  0.01382899284362793
generate_one_block  0.014426708221435547
generate_one_block  0.014683008193969727
generate_one_block  0.014556884765625
generate_one_block  0.014489173889160156
generate_one_block  0.015325784683227539
generate_one_block  0.01483607292175293
generate_one_block  0.015176057815551758
generate_one_block  0.014760017395019531
generate_one_block  0.014799118041992188
generate_one_block  0.015542984008789062
generate_one_block  0.015115976333618164
generate_one_block  0.015278816223144531
generate_one_block  0.015295267105102539
generate_one_block  0.015027999877929688
generate_one_block  0.01539468765258789
generate_one_block  0.015286445617675781
generate_one_block  0.014344930648803711
generate_one_block  0.015058279037475586
generate_one_block  0.01456308364868164
generate_one_block  0.014805078506469727
generate_one_block  0.014880657196044922
generate_one_block  0.014914274215698242
generate_one_block  0.015240669250488281
generate_one_block  0.014682769775390625
generate_one_block  0.014924049377441406
generate_one_block  0.015121221542358398
generate_one_block  0.014698028564453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043303489685058594
gen group dst list time:  0.023938894271850586
time for parepare:  0.01981806755065918
local_output_nid generation:  0.004439115524291992
local_in_edges_tensor generation:  0.012696027755737305
mini_batch_src_global generation:  0.016620159149169922
r_  generation:  0.16205286979675293
local_output_nid generation:  0.008657693862915039
local_in_edges_tensor generation:  0.014779329299926758
mini_batch_src_global generation:  0.023463010787963867
r_  generation:  0.17524981498718262
local_output_nid generation:  0.008502006530761719
local_in_edges_tensor generation:  0.011532783508300781
mini_batch_src_global generation:  0.020298004150390625
r_  generation:  0.1756727695465088
local_output_nid generation:  0.008616924285888672
local_in_edges_tensor generation:  0.011413812637329102
mini_batch_src_global generation:  0.02049708366394043
r_  generation:  0.17538952827453613
local_output_nid generation:  0.008427143096923828
local_in_edges_tensor generation:  0.008454322814941406
mini_batch_src_global generation:  0.020509958267211914
r_  generation:  0.16639947891235352
local_output_nid generation:  0.008646011352539062
local_in_edges_tensor generation:  0.009907245635986328
mini_batch_src_global generation:  0.02410411834716797
r_  generation:  0.17963671684265137
local_output_nid generation:  0.009353160858154297
local_in_edges_tensor generation:  0.024094820022583008
mini_batch_src_global generation:  0.026041507720947266
r_  generation:  0.17890000343322754
local_output_nid generation:  0.00832056999206543
local_in_edges_tensor generation:  0.011617183685302734
mini_batch_src_global generation:  0.021761655807495117
r_  generation:  0.17219281196594238
local_output_nid generation:  0.007607698440551758
local_in_edges_tensor generation:  0.010338068008422852
mini_batch_src_global generation:  0.022011518478393555
r_  generation:  0.17516374588012695
local_output_nid generation:  0.0077860355377197266
local_in_edges_tensor generation:  0.012052536010742188
mini_batch_src_global generation:  0.02280902862548828
r_  generation:  0.1791064739227295
local_output_nid generation:  0.007818460464477539
local_in_edges_tensor generation:  0.010206222534179688
mini_batch_src_global generation:  0.02250981330871582
r_  generation:  0.17757606506347656
local_output_nid generation:  0.007859468460083008
local_in_edges_tensor generation:  0.011893033981323242
mini_batch_src_global generation:  0.024903059005737305
r_  generation:  0.1824178695678711
local_output_nid generation:  0.007739067077636719
local_in_edges_tensor generation:  0.011771440505981445
mini_batch_src_global generation:  0.02290511131286621
r_  generation:  0.1784532070159912
local_output_nid generation:  0.007795810699462891
local_in_edges_tensor generation:  0.008776187896728516
mini_batch_src_global generation:  0.022842884063720703
r_  generation:  0.1777188777923584
local_output_nid generation:  0.00819087028503418
local_in_edges_tensor generation:  0.012182474136352539
mini_batch_src_global generation:  0.02381134033203125
r_  generation:  0.1895756721496582
local_output_nid generation:  0.007934093475341797
local_in_edges_tensor generation:  0.011863470077514648
mini_batch_src_global generation:  0.03976702690124512
r_  generation:  0.18303704261779785
local_output_nid generation:  0.00816202163696289
local_in_edges_tensor generation:  0.008744955062866211
mini_batch_src_global generation:  0.023492097854614258
r_  generation:  0.18019580841064453
local_output_nid generation:  0.008174419403076172
local_in_edges_tensor generation:  0.010333061218261719
mini_batch_src_global generation:  0.023482084274291992
r_  generation:  0.1856217384338379
local_output_nid generation:  0.008027791976928711
local_in_edges_tensor generation:  0.010426044464111328
mini_batch_src_global generation:  0.023345470428466797
r_  generation:  0.17984867095947266
local_output_nid generation:  0.008161067962646484
local_in_edges_tensor generation:  0.010422229766845703
mini_batch_src_global generation:  0.02359151840209961
r_  generation:  0.18313884735107422
local_output_nid generation:  0.00810384750366211
local_in_edges_tensor generation:  0.010470151901245117
mini_batch_src_global generation:  0.022872209548950195
r_  generation:  0.1831352710723877
local_output_nid generation:  0.007651329040527344
local_in_edges_tensor generation:  0.008697271347045898
mini_batch_src_global generation:  0.02226734161376953
r_  generation:  0.1715857982635498
local_output_nid generation:  0.008088827133178711
local_in_edges_tensor generation:  0.010024070739746094
mini_batch_src_global generation:  0.023820877075195312
r_  generation:  0.17897844314575195
local_output_nid generation:  0.008037805557250977
local_in_edges_tensor generation:  0.008774757385253906
mini_batch_src_global generation:  0.02251744270324707
r_  generation:  0.17551088333129883
local_output_nid generation:  0.007935523986816406
local_in_edges_tensor generation:  0.00990748405456543
mini_batch_src_global generation:  0.02242422103881836
r_  generation:  0.1774120330810547
local_output_nid generation:  0.008015632629394531
local_in_edges_tensor generation:  0.013343572616577148
mini_batch_src_global generation:  0.02370166778564453
r_  generation:  0.18042874336242676
local_output_nid generation:  0.008002042770385742
local_in_edges_tensor generation:  0.010332584381103516
mini_batch_src_global generation:  0.023304462432861328
r_  generation:  0.18343424797058105
local_output_nid generation:  0.00823974609375
local_in_edges_tensor generation:  0.011739969253540039
mini_batch_src_global generation:  0.023546934127807617
r_  generation:  0.18377423286437988
local_output_nid generation:  0.007837295532226562
local_in_edges_tensor generation:  0.00881052017211914
mini_batch_src_global generation:  0.022580385208129883
r_  generation:  0.1806943416595459
local_output_nid generation:  0.008008956909179688
local_in_edges_tensor generation:  0.008986473083496094
mini_batch_src_global generation:  0.022837400436401367
r_  generation:  0.1777629852294922
local_output_nid generation:  0.008083343505859375
local_in_edges_tensor generation:  0.011853218078613281
mini_batch_src_global generation:  0.021992206573486328
r_  generation:  0.17821168899536133
local_output_nid generation:  0.008066654205322266
local_in_edges_tensor generation:  0.011819601058959961
mini_batch_src_global generation:  0.024146080017089844
r_  generation:  0.18019866943359375
----------------------check_connections_block total spend ----------------------------- 8.399123668670654
generate_one_block  0.2409684658050537
generate_one_block  0.24859189987182617
generate_one_block  0.2622528076171875
generate_one_block  0.23572659492492676
generate_one_block  0.21740126609802246
generate_one_block  0.22170066833496094
generate_one_block  0.22749590873718262
generate_one_block  0.22271966934204102
generate_one_block  0.2246565818786621
generate_one_block  0.23054885864257812
generate_one_block  0.2273573875427246
generate_one_block  0.23923063278198242
generate_one_block  0.22783780097961426
generate_one_block  0.22688817977905273
generate_one_block  0.243011474609375
generate_one_block  0.2664053440093994
generate_one_block  0.22858858108520508
generate_one_block  0.23822593688964844
generate_one_block  0.2278435230255127
generate_one_block  0.2434680461883545
generate_one_block  0.26209402084350586
generate_one_block  0.24862360954284668
generate_one_block  0.22385263442993164
generate_one_block  0.22023439407348633
generate_one_block  0.22474122047424316
generate_one_block  0.23049092292785645
generate_one_block  0.23655271530151367
generate_one_block  0.23930048942565918
generate_one_block  0.22705960273742676
generate_one_block  0.22388410568237305
generate_one_block  0.22247314453125
generate_one_block  0.22585415840148926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08208250999450684
gen group dst list time:  0.11328744888305664
time for parepare:  0.020580053329467773
local_output_nid generation:  0.02175283432006836
local_in_edges_tensor generation:  0.05309343338012695
mini_batch_src_global generation:  0.03902387619018555
r_  generation:  0.4081900119781494
local_output_nid generation:  0.028649330139160156
local_in_edges_tensor generation:  0.04291725158691406
mini_batch_src_global generation:  0.04883742332458496
r_  generation:  0.4227640628814697
local_output_nid generation:  0.027667760848999023
local_in_edges_tensor generation:  0.03516960144042969
mini_batch_src_global generation:  0.04760098457336426
r_  generation:  0.4306929111480713
local_output_nid generation:  0.026818275451660156
local_in_edges_tensor generation:  0.031296730041503906
mini_batch_src_global generation:  0.048682451248168945
r_  generation:  0.42859888076782227
local_output_nid generation:  0.026851892471313477
local_in_edges_tensor generation:  0.03138279914855957
mini_batch_src_global generation:  0.05375957489013672
r_  generation:  0.43904590606689453
local_output_nid generation:  0.026834487915039062
local_in_edges_tensor generation:  0.03142571449279785
mini_batch_src_global generation:  0.04965710639953613
r_  generation:  0.42789340019226074
local_output_nid generation:  0.027210235595703125
local_in_edges_tensor generation:  0.03189873695373535
mini_batch_src_global generation:  0.05309700965881348
r_  generation:  0.4509141445159912
local_output_nid generation:  0.027156829833984375
local_in_edges_tensor generation:  0.03927779197692871
mini_batch_src_global generation:  0.05043315887451172
r_  generation:  0.429227352142334
local_output_nid generation:  0.027327775955200195
local_in_edges_tensor generation:  0.028494596481323242
mini_batch_src_global generation:  0.0503382682800293
r_  generation:  0.4409792423248291
local_output_nid generation:  0.027539491653442383
local_in_edges_tensor generation:  0.03230762481689453
mini_batch_src_global generation:  0.05103635787963867
r_  generation:  0.44928526878356934
local_output_nid generation:  0.02885293960571289
local_in_edges_tensor generation:  0.03418874740600586
mini_batch_src_global generation:  0.05552029609680176
r_  generation:  0.44156575202941895
local_output_nid generation:  0.0281679630279541
local_in_edges_tensor generation:  0.0356745719909668
mini_batch_src_global generation:  0.05327177047729492
r_  generation:  0.46448707580566406
local_output_nid generation:  0.027971744537353516
local_in_edges_tensor generation:  0.04265451431274414
mini_batch_src_global generation:  0.05767416954040527
r_  generation:  0.43857526779174805
local_output_nid generation:  0.02772688865661621
local_in_edges_tensor generation:  0.032683610916137695
mini_batch_src_global generation:  0.05055427551269531
r_  generation:  0.44046735763549805
local_output_nid generation:  0.030417680740356445
local_in_edges_tensor generation:  0.031857967376708984
mini_batch_src_global generation:  0.051459312438964844
r_  generation:  0.44278478622436523
local_output_nid generation:  0.02825307846069336
local_in_edges_tensor generation:  0.029194355010986328
mini_batch_src_global generation:  0.05079793930053711
r_  generation:  0.43458080291748047
local_output_nid generation:  0.02892756462097168
local_in_edges_tensor generation:  0.032402753829956055
mini_batch_src_global generation:  0.052842140197753906
r_  generation:  0.44156789779663086
local_output_nid generation:  0.028942346572875977
local_in_edges_tensor generation:  0.03631711006164551
mini_batch_src_global generation:  0.05007505416870117
r_  generation:  0.4357130527496338
local_output_nid generation:  0.02910161018371582
local_in_edges_tensor generation:  0.032230377197265625
mini_batch_src_global generation:  0.04984283447265625
r_  generation:  0.44075942039489746
local_output_nid generation:  0.02885723114013672
local_in_edges_tensor generation:  0.03229236602783203
mini_batch_src_global generation:  0.05304312705993652
r_  generation:  0.4385249614715576
local_output_nid generation:  0.0285031795501709
local_in_edges_tensor generation:  0.031926631927490234
mini_batch_src_global generation:  0.05302906036376953
r_  generation:  0.44176411628723145
local_output_nid generation:  0.028044939041137695
local_in_edges_tensor generation:  0.029308319091796875
mini_batch_src_global generation:  0.05056047439575195
r_  generation:  0.4354081153869629
local_output_nid generation:  0.028394460678100586
local_in_edges_tensor generation:  0.028298616409301758
mini_batch_src_global generation:  0.050630807876586914
r_  generation:  0.43598318099975586
local_output_nid generation:  0.02832198143005371
local_in_edges_tensor generation:  0.028401613235473633
mini_batch_src_global generation:  0.05069398880004883
r_  generation:  0.43407201766967773
local_output_nid generation:  0.028419017791748047
local_in_edges_tensor generation:  0.03974485397338867
mini_batch_src_global generation:  0.049878597259521484
r_  generation:  0.44290614128112793
local_output_nid generation:  0.028484821319580078
local_in_edges_tensor generation:  0.03625345230102539
mini_batch_src_global generation:  0.04958796501159668
r_  generation:  0.4460182189941406
local_output_nid generation:  0.02849602699279785
local_in_edges_tensor generation:  0.03608274459838867
mini_batch_src_global generation:  0.0503239631652832
r_  generation:  0.44220614433288574
local_output_nid generation:  0.02881479263305664
local_in_edges_tensor generation:  0.03638887405395508
mini_batch_src_global generation:  0.05030536651611328
r_  generation:  0.44527554512023926
local_output_nid generation:  0.02833390235900879
local_in_edges_tensor generation:  0.028142452239990234
mini_batch_src_global generation:  0.05027318000793457
r_  generation:  0.43384599685668945
local_output_nid generation:  0.028825044631958008
local_in_edges_tensor generation:  0.028502225875854492
mini_batch_src_global generation:  0.050401926040649414
r_  generation:  0.4528834819793701
local_output_nid generation:  0.028474807739257812
local_in_edges_tensor generation:  0.03955388069152832
mini_batch_src_global generation:  0.050261735916137695
r_  generation:  0.4404928684234619
local_output_nid generation:  0.028618574142456055
local_in_edges_tensor generation:  0.03205084800720215
mini_batch_src_global generation:  0.050670623779296875
r_  generation:  0.4427173137664795
----------------------check_connections_block total spend ----------------------------- 20.738651752471924
generate_one_block  0.6496987342834473
generate_one_block  0.5651142597198486
generate_one_block  0.5458908081054688
generate_one_block  0.5444755554199219
generate_one_block  0.5620346069335938
generate_one_block  0.5502743721008301
generate_one_block  0.5630583763122559
generate_one_block  0.5513501167297363
generate_one_block  0.5630109310150146
generate_one_block  0.5610592365264893
generate_one_block  0.5439467430114746
generate_one_block  0.5658793449401855
generate_one_block  0.5561442375183105
generate_one_block  0.5542433261871338
generate_one_block  0.5693650245666504
generate_one_block  0.5574047565460205
generate_one_block  0.5557539463043213
generate_one_block  0.5663321018218994
generate_one_block  0.5545697212219238
generate_one_block  0.5546970367431641
generate_one_block  0.572761058807373
generate_one_block  0.5400183200836182
generate_one_block  0.5431194305419922
generate_one_block  0.5405957698822021
generate_one_block  0.5461561679840088
generate_one_block  0.5587489604949951
generate_one_block  0.5582351684570312
generate_one_block  0.562328577041626
generate_one_block  0.542428731918335
generate_one_block  0.5456619262695312
generate_one_block  0.5553324222564697
generate_one_block  0.5581717491149902
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  29.137775421142578
block generation total time  25.343942165374756
average batch blocks generation time:  0.7919981926679611
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08528947830200195  GigaBytes
Max Memory Allocated: 0.08528947830200195  GigaBytes

torch.Size([148624, 128])
torch.Size([110108, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5369873046875 GB
    Memory Allocated: 0.21486186981201172  GigaBytes
Max Memory Allocated: 0.22015953063964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08614921569824219  GigaBytes
Max Memory Allocated: 0.2441086769104004  GigaBytes

torch.Size([148708, 128])
torch.Size([110462, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21618986129760742  GigaBytes
Max Memory Allocated: 0.2441086769104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08571529388427734  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148298, 128])
torch.Size([109243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2132396697998047  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08590269088745117  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([149017, 128])
torch.Size([109284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2132735252380371  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08546066284179688  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148676, 128])
torch.Size([108540, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21122312545776367  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08556795120239258  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148617, 128])
torch.Size([108700, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2119274139404297  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08609867095947266  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([149270, 128])
torch.Size([110450, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21455001831054688  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0856623649597168  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148603, 128])
torch.Size([109439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21307897567749023  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08569526672363281  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148544, 128])
torch.Size([109558, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21327543258666992  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08608341217041016  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148972, 128])
torch.Size([110305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21448612213134766  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08571338653564453  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([148492, 128])
torch.Size([109304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21309661865234375  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08635425567626953  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

torch.Size([149250, 128])
torch.Size([110944, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21927738189697266  GigaBytes
Max Memory Allocated: 0.24557828903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08600282669067383  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([148993, 128])
torch.Size([109635, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21363210678100586  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08589553833007812  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([148822, 128])
torch.Size([109678, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21378135681152344  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08610391616821289  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([148629, 128])
torch.Size([110317, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21586275100708008  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0859994888305664  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([148788, 128])
torch.Size([109525, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21402692794799805  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08625602722167969  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([149316, 128])
torch.Size([110545, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21530532836914062  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08612251281738281  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([148804, 128])
torch.Size([110217, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21588706970214844  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08606386184692383  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([149047, 128])
torch.Size([110062, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21457815170288086  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0863652229309082  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

torch.Size([149409, 128])
torch.Size([110753, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21941280364990234  GigaBytes
Max Memory Allocated: 0.25013113021850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0859842300415039  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148616, 128])
torch.Size([110291, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21479272842407227  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08535528182983398  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148129, 128])
torch.Size([108209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21122360229492188  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08565664291381836  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148355, 128])
torch.Size([108856, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2127370834350586  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08555078506469727  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148355, 128])
torch.Size([109055, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2128000259399414  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08588695526123047  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148948, 128])
torch.Size([109412, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21347427368164062  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08579301834106445  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148509, 128])
torch.Size([109527, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21361637115478516  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08595943450927734  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148686, 128])
torch.Size([109839, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21390008926391602  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08624887466430664  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149211, 128])
torch.Size([110719, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21821165084838867  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08559942245483398  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148465, 128])
torch.Size([108363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2117471694946289  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08593225479125977  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148915, 128])
torch.Size([109649, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21367216110229492  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08578729629516602  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148799, 128])
torch.Size([109505, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21350383758544922  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08580589294433594  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148640, 128])
torch.Size([109410, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21353960037231445  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026995912194252014 |0.023627392947673798 |0.026340752840042114 |0.00010100007057189941 |0.006006799638271332 |0.0019483566284179688 |
----------------------------------------------------------pseudo_mini_loss sum 5.35180139541626
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9109844
Number of first layer input nodes during this epoch:  4760507
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.11660099029541016  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02847123146057129
range selection method range initialization spend 0.012847185134887695
time for parepare:  0.018423080444335938
local_output_nid generation:  0.0007288455963134766
local_in_edges_tensor generation:  0.008803844451904297
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.009853601455688477
local_output_nid generation:  0.0009589195251464844
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.010555744171142578
local_output_nid generation:  0.001012563705444336
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0010802745819091797
r_  generation:  0.009495735168457031
local_output_nid generation:  0.0009512901306152344
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0010263919830322266
r_  generation:  0.009645462036132812
local_output_nid generation:  0.0009474754333496094
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.010010004043579102
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.0006780624389648438
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.010000467300415039
local_output_nid generation:  0.0009644031524658203
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0009713172912597656
r_  generation:  0.009911060333251953
local_output_nid generation:  0.0008897781372070312
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.000993490219116211
r_  generation:  0.010339021682739258
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.001043558120727539
r_  generation:  0.00987553596496582
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0010290145874023438
r_  generation:  0.010429620742797852
local_output_nid generation:  0.0008940696716308594
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.001024007797241211
r_  generation:  0.009652853012084961
local_output_nid generation:  0.0008666515350341797
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.0009911060333251953
r_  generation:  0.010378599166870117
local_output_nid generation:  0.0008885860443115234
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.01014566421508789
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.000978708267211914
r_  generation:  0.009713888168334961
local_output_nid generation:  0.0008821487426757812
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0010080337524414062
r_  generation:  0.010192155838012695
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0005135536193847656
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.010126352310180664
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0010149478912353516
r_  generation:  0.010211944580078125
local_output_nid generation:  0.0009031295776367188
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0011067390441894531
r_  generation:  0.011093616485595703
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.00404810905456543
r_  generation:  0.010066747665405273
local_output_nid generation:  0.0008859634399414062
local_in_edges_tensor generation:  0.0005393028259277344
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.009755134582519531
local_output_nid generation:  0.0008769035339355469
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.010730266571044922
local_output_nid generation:  0.0008616447448730469
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.010472536087036133
local_output_nid generation:  0.0008492469787597656
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.001039743423461914
r_  generation:  0.010199308395385742
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.009796857833862305
local_output_nid generation:  0.0008330345153808594
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.010568618774414062
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.0010211467742919922
r_  generation:  0.010357379913330078
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.009989738464355469
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.00995182991027832
local_output_nid generation:  0.0008406639099121094
local_in_edges_tensor generation:  0.00046443939208984375
mini_batch_src_global generation:  0.0009539127349853516
r_  generation:  0.009675741195678711
local_output_nid generation:  0.0008623600006103516
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.0010547637939453125
r_  generation:  0.010195493698120117
local_output_nid generation:  0.0008530616760253906
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.010056734085083008
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.01027226448059082
----------------------check_connections_block total spend ----------------------------- 0.5100827217102051
generate_one_block  0.023181438446044922
generate_one_block  0.017197132110595703
generate_one_block  0.015159368515014648
generate_one_block  0.014929056167602539
generate_one_block  0.015239953994750977
generate_one_block  0.014779806137084961
generate_one_block  0.014646530151367188
generate_one_block  0.014965057373046875
generate_one_block  0.014651298522949219
generate_one_block  0.015358209609985352
generate_one_block  0.014354467391967773
generate_one_block  0.015306472778320312
generate_one_block  0.017008304595947266
generate_one_block  0.014260292053222656
generate_one_block  0.015205860137939453
generate_one_block  0.014793872833251953
generate_one_block  0.014961481094360352
generate_one_block  0.015555620193481445
generate_one_block  0.014667749404907227
generate_one_block  0.01419520378112793
generate_one_block  0.015274286270141602
generate_one_block  0.015129804611206055
generate_one_block  0.015093564987182617
generate_one_block  0.01440286636352539
generate_one_block  0.015239715576171875
generate_one_block  0.01726531982421875
generate_one_block  0.014766931533813477
generate_one_block  0.014568567276000977
generate_one_block  0.014060735702514648
generate_one_block  0.015576839447021484
generate_one_block  0.015092134475708008
generate_one_block  0.014673709869384766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07205963134765625
gen group dst list time:  0.025147676467895508
time for parepare:  0.020606040954589844
local_output_nid generation:  0.0047168731689453125
local_in_edges_tensor generation:  0.021813154220581055
mini_batch_src_global generation:  0.016717910766601562
r_  generation:  0.17712926864624023
local_output_nid generation:  0.00930643081665039
local_in_edges_tensor generation:  0.016500234603881836
mini_batch_src_global generation:  0.024024486541748047
r_  generation:  0.17923951148986816
local_output_nid generation:  0.008496522903442383
local_in_edges_tensor generation:  0.037224531173706055
mini_batch_src_global generation:  0.022029399871826172
r_  generation:  0.179337739944458
local_output_nid generation:  0.009134531021118164
local_in_edges_tensor generation:  0.013975143432617188
mini_batch_src_global generation:  0.02196955680847168
r_  generation:  0.18616080284118652
local_output_nid generation:  0.009500980377197266
local_in_edges_tensor generation:  0.011163711547851562
mini_batch_src_global generation:  0.024369239807128906
r_  generation:  0.18892931938171387
local_output_nid generation:  0.009447574615478516
local_in_edges_tensor generation:  0.013226747512817383
mini_batch_src_global generation:  0.025233745574951172
r_  generation:  0.18900775909423828
local_output_nid generation:  0.009212017059326172
local_in_edges_tensor generation:  0.009522199630737305
mini_batch_src_global generation:  0.02407550811767578
r_  generation:  0.18884849548339844
local_output_nid generation:  0.010404825210571289
local_in_edges_tensor generation:  0.023912668228149414
mini_batch_src_global generation:  0.026991844177246094
r_  generation:  0.19841504096984863
local_output_nid generation:  0.010474443435668945
local_in_edges_tensor generation:  0.011925935745239258
mini_batch_src_global generation:  0.02557086944580078
r_  generation:  0.1873478889465332
local_output_nid generation:  0.010257959365844727
local_in_edges_tensor generation:  0.011757373809814453
mini_batch_src_global generation:  0.02619194984436035
r_  generation:  0.1938467025756836
local_output_nid generation:  0.00993657112121582
local_in_edges_tensor generation:  0.011125564575195312
mini_batch_src_global generation:  0.024559497833251953
r_  generation:  0.18851208686828613
local_output_nid generation:  0.010447502136230469
local_in_edges_tensor generation:  0.01118779182434082
mini_batch_src_global generation:  0.025800228118896484
r_  generation:  0.18755078315734863
local_output_nid generation:  0.00981283187866211
local_in_edges_tensor generation:  0.012442350387573242
mini_batch_src_global generation:  0.024805068969726562
r_  generation:  0.18985533714294434
local_output_nid generation:  0.009949445724487305
local_in_edges_tensor generation:  0.009311914443969727
mini_batch_src_global generation:  0.025057315826416016
r_  generation:  0.18319416046142578
local_output_nid generation:  0.010371208190917969
local_in_edges_tensor generation:  0.011283159255981445
mini_batch_src_global generation:  0.026540756225585938
r_  generation:  0.19406509399414062
local_output_nid generation:  0.010429620742797852
local_in_edges_tensor generation:  0.011166810989379883
mini_batch_src_global generation:  0.026295900344848633
r_  generation:  0.19262361526489258
local_output_nid generation:  0.010628223419189453
local_in_edges_tensor generation:  0.01518392562866211
mini_batch_src_global generation:  0.026031970977783203
r_  generation:  0.19326043128967285
local_output_nid generation:  0.011804819107055664
local_in_edges_tensor generation:  0.023211956024169922
mini_batch_src_global generation:  0.048830509185791016
r_  generation:  0.1879568099975586
local_output_nid generation:  0.01272892951965332
local_in_edges_tensor generation:  0.01106572151184082
mini_batch_src_global generation:  0.0242006778717041
r_  generation:  0.18007755279541016
local_output_nid generation:  0.007832527160644531
local_in_edges_tensor generation:  0.009471654891967773
mini_batch_src_global generation:  0.022012948989868164
r_  generation:  0.17547965049743652
local_output_nid generation:  0.008277654647827148
local_in_edges_tensor generation:  0.010806560516357422
mini_batch_src_global generation:  0.02476334571838379
r_  generation:  0.21985507011413574
local_output_nid generation:  0.008249998092651367
local_in_edges_tensor generation:  0.01191568374633789
mini_batch_src_global generation:  0.023729324340820312
r_  generation:  0.18702292442321777
local_output_nid generation:  0.008309125900268555
local_in_edges_tensor generation:  0.012089014053344727
mini_batch_src_global generation:  0.023490190505981445
r_  generation:  0.18392324447631836
local_output_nid generation:  0.007927656173706055
local_in_edges_tensor generation:  0.00851750373840332
mini_batch_src_global generation:  0.022390127182006836
r_  generation:  0.17406105995178223
local_output_nid generation:  0.00822901725769043
local_in_edges_tensor generation:  0.00891256332397461
mini_batch_src_global generation:  0.023381710052490234
r_  generation:  0.18620944023132324
local_output_nid generation:  0.008147001266479492
local_in_edges_tensor generation:  0.011977910995483398
mini_batch_src_global generation:  0.024441957473754883
r_  generation:  0.18853473663330078
local_output_nid generation:  0.00807332992553711
local_in_edges_tensor generation:  0.010244131088256836
mini_batch_src_global generation:  0.023052453994750977
r_  generation:  0.18398284912109375
local_output_nid generation:  0.008044719696044922
local_in_edges_tensor generation:  0.009512662887573242
mini_batch_src_global generation:  0.024327516555786133
r_  generation:  0.1945343017578125
local_output_nid generation:  0.010992050170898438
local_in_edges_tensor generation:  0.01714801788330078
mini_batch_src_global generation:  0.023394346237182617
r_  generation:  0.17602849006652832
local_output_nid generation:  0.008288383483886719
local_in_edges_tensor generation:  0.012640237808227539
mini_batch_src_global generation:  0.024567365646362305
r_  generation:  0.18616271018981934
local_output_nid generation:  0.008205652236938477
local_in_edges_tensor generation:  0.0133514404296875
mini_batch_src_global generation:  0.024401426315307617
r_  generation:  0.19361305236816406
local_output_nid generation:  0.008048534393310547
local_in_edges_tensor generation:  0.010235786437988281
mini_batch_src_global generation:  0.022655248641967773
r_  generation:  0.18710613250732422
----------------------check_connections_block total spend ----------------------------- 8.96700382232666
generate_one_block  0.22889971733093262
generate_one_block  0.23061037063598633
generate_one_block  0.23485469818115234
generate_one_block  0.22775721549987793
generate_one_block  0.24589848518371582
generate_one_block  0.23117280006408691
generate_one_block  0.23374438285827637
generate_one_block  0.23286724090576172
generate_one_block  0.22241473197937012
generate_one_block  0.23299789428710938
generate_one_block  0.2184462547302246
generate_one_block  0.22856640815734863
generate_one_block  0.2294292449951172
generate_one_block  0.21836590766906738
generate_one_block  0.23264312744140625
generate_one_block  0.24277067184448242
generate_one_block  0.23546600341796875
generate_one_block  0.23185181617736816
generate_one_block  0.22521018981933594
generate_one_block  0.25510334968566895
generate_one_block  0.24107146263122559
generate_one_block  0.24698162078857422
generate_one_block  0.23424553871154785
generate_one_block  0.21865129470825195
generate_one_block  0.23565196990966797
generate_one_block  0.2258586883544922
generate_one_block  0.2296311855316162
generate_one_block  0.2269132137298584
generate_one_block  0.22173786163330078
generate_one_block  0.24034762382507324
generate_one_block  0.23351240158081055
generate_one_block  0.22809243202209473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04592466354370117
gen group dst list time:  0.11520814895629883
time for parepare:  0.017796993255615234
local_output_nid generation:  0.023116111755371094
local_in_edges_tensor generation:  0.05492854118347168
mini_batch_src_global generation:  0.041678667068481445
r_  generation:  0.4198791980743408
local_output_nid generation:  0.02865290641784668
local_in_edges_tensor generation:  0.04314064979553223
mini_batch_src_global generation:  0.05176711082458496
r_  generation:  0.4314446449279785
local_output_nid generation:  0.028261899948120117
local_in_edges_tensor generation:  0.03233218193054199
mini_batch_src_global generation:  0.048040151596069336
r_  generation:  0.4343233108520508
local_output_nid generation:  0.027608394622802734
local_in_edges_tensor generation:  0.03127264976501465
mini_batch_src_global generation:  0.051674604415893555
r_  generation:  0.432750940322876
local_output_nid generation:  0.027629613876342773
local_in_edges_tensor generation:  0.028339147567749023
mini_batch_src_global generation:  0.04993128776550293
r_  generation:  0.43665146827697754
local_output_nid generation:  0.027609825134277344
local_in_edges_tensor generation:  0.03178238868713379
mini_batch_src_global generation:  0.05028486251831055
r_  generation:  0.4428582191467285
local_output_nid generation:  0.027585983276367188
local_in_edges_tensor generation:  0.031716108322143555
mini_batch_src_global generation:  0.05022168159484863
r_  generation:  0.4346127510070801
local_output_nid generation:  0.0279996395111084
local_in_edges_tensor generation:  0.03699898719787598
mini_batch_src_global generation:  0.05008745193481445
r_  generation:  0.43396759033203125
local_output_nid generation:  0.029453039169311523
local_in_edges_tensor generation:  0.02984023094177246
mini_batch_src_global generation:  0.05071139335632324
r_  generation:  0.4349658489227295
local_output_nid generation:  0.027895689010620117
local_in_edges_tensor generation:  0.03157973289489746
mini_batch_src_global generation:  0.05054163932800293
r_  generation:  0.4385828971862793
local_output_nid generation:  0.027877330780029297
local_in_edges_tensor generation:  0.03524899482727051
mini_batch_src_global generation:  0.05135655403137207
r_  generation:  0.4339935779571533
local_output_nid generation:  0.029726505279541016
local_in_edges_tensor generation:  0.04012441635131836
mini_batch_src_global generation:  0.050514936447143555
r_  generation:  0.4402790069580078
local_output_nid generation:  0.028348445892333984
local_in_edges_tensor generation:  0.03847336769104004
mini_batch_src_global generation:  0.05072903633117676
r_  generation:  0.4330410957336426
local_output_nid generation:  0.032456159591674805
local_in_edges_tensor generation:  0.03646993637084961
mini_batch_src_global generation:  0.06673741340637207
r_  generation:  0.43817806243896484
local_output_nid generation:  0.02830028533935547
local_in_edges_tensor generation:  0.033660173416137695
mini_batch_src_global generation:  0.05361747741699219
r_  generation:  0.4474959373474121
local_output_nid generation:  0.030129432678222656
local_in_edges_tensor generation:  0.04001021385192871
mini_batch_src_global generation:  0.05014204978942871
r_  generation:  0.4397315979003906
local_output_nid generation:  0.029339313507080078
local_in_edges_tensor generation:  0.03335094451904297
mini_batch_src_global generation:  0.05435442924499512
r_  generation:  0.43710923194885254
local_output_nid generation:  0.029003143310546875
local_in_edges_tensor generation:  0.031984567642211914
mini_batch_src_global generation:  0.05068159103393555
r_  generation:  0.4368128776550293
local_output_nid generation:  0.028841018676757812
local_in_edges_tensor generation:  0.02827763557434082
mini_batch_src_global generation:  0.05056023597717285
r_  generation:  0.4360170364379883
local_output_nid generation:  0.028680086135864258
local_in_edges_tensor generation:  0.028240203857421875
mini_batch_src_global generation:  0.0500483512878418
r_  generation:  0.4348785877227783
local_output_nid generation:  0.02866649627685547
local_in_edges_tensor generation:  0.02766251564025879
mini_batch_src_global generation:  0.05085563659667969
r_  generation:  0.44756269454956055
local_output_nid generation:  0.029193401336669922
local_in_edges_tensor generation:  0.04354095458984375
mini_batch_src_global generation:  0.05381178855895996
r_  generation:  0.43697190284729004
local_output_nid generation:  0.029692888259887695
local_in_edges_tensor generation:  0.03537344932556152
mini_batch_src_global generation:  0.050370216369628906
r_  generation:  0.4411129951477051
local_output_nid generation:  0.02906513214111328
local_in_edges_tensor generation:  0.029238224029541016
mini_batch_src_global generation:  0.051168203353881836
r_  generation:  0.434206485748291
local_output_nid generation:  0.028800487518310547
local_in_edges_tensor generation:  0.02826404571533203
mini_batch_src_global generation:  0.05366969108581543
r_  generation:  0.4377272129058838
local_output_nid generation:  0.029035091400146484
local_in_edges_tensor generation:  0.03977084159851074
mini_batch_src_global generation:  0.050615787506103516
r_  generation:  0.4352555274963379
local_output_nid generation:  0.028962135314941406
local_in_edges_tensor generation:  0.02980208396911621
mini_batch_src_global generation:  0.060643672943115234
r_  generation:  0.43719005584716797
local_output_nid generation:  0.02916407585144043
local_in_edges_tensor generation:  0.028235197067260742
mini_batch_src_global generation:  0.05051779747009277
r_  generation:  0.4405996799468994
local_output_nid generation:  0.02986311912536621
local_in_edges_tensor generation:  0.03471994400024414
mini_batch_src_global generation:  0.05093717575073242
r_  generation:  0.436694860458374
local_output_nid generation:  0.029320716857910156
local_in_edges_tensor generation:  0.03752946853637695
mini_batch_src_global generation:  0.0562434196472168
r_  generation:  0.4429779052734375
local_output_nid generation:  0.0297243595123291
local_in_edges_tensor generation:  0.03406977653503418
mini_batch_src_global generation:  0.07791566848754883
r_  generation:  0.4479553699493408
local_output_nid generation:  0.030254840850830078
local_in_edges_tensor generation:  0.030671119689941406
mini_batch_src_global generation:  0.052042245864868164
r_  generation:  0.4380934238433838
----------------------check_connections_block total spend ----------------------------- 20.830032348632812
generate_one_block  0.5669329166412354
generate_one_block  0.5631654262542725
generate_one_block  0.551262617111206
generate_one_block  0.5590407848358154
generate_one_block  0.6905965805053711
generate_one_block  0.5550754070281982
generate_one_block  0.5465643405914307
generate_one_block  0.5687448978424072
generate_one_block  0.5445330142974854
generate_one_block  0.5572021007537842
generate_one_block  0.5503430366516113
generate_one_block  0.5645606517791748
generate_one_block  0.5634627342224121
generate_one_block  0.5428252220153809
generate_one_block  0.5598671436309814
generate_one_block  0.5547585487365723
generate_one_block  0.5603125095367432
generate_one_block  0.5832102298736572
generate_one_block  0.5461440086364746
generate_one_block  0.5445029735565186
generate_one_block  0.5583035945892334
generate_one_block  0.5766294002532959
generate_one_block  0.5652406215667725
generate_one_block  0.6147124767303467
generate_one_block  0.5816504955291748
generate_one_block  0.5979719161987305
generate_one_block  0.5511865615844727
generate_one_block  0.543673038482666
generate_one_block  0.5465025901794434
generate_one_block  0.5693812370300293
generate_one_block  0.5851273536682129
generate_one_block  0.5649080276489258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.11660099029541016  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

connection checking time:  29.797036170959473
block generation total time  25.550158262252808
average batch blocks generation time:  0.7984424456954002
block dataloader generation time/epoch 58.02104306221008
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08625650405883789  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149260, 128])
torch.Size([110233, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21416997909545898  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08621597290039062  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148880, 128])
torch.Size([110028, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21451950073242188  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08609962463378906  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148746, 128])
torch.Size([109309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21352434158325195  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08612680435180664  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148733, 128])
torch.Size([109853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21419334411621094  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08626174926757812  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148856, 128])
torch.Size([110391, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21519756317138672  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08605384826660156  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148544, 128])
torch.Size([109646, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21384048461914062  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0858454704284668  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148343, 128])
torch.Size([108934, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21269559860229492  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08623218536376953  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148792, 128])
torch.Size([109956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21471500396728516  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08606672286987305  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148833, 128])
torch.Size([109532, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21380901336669922  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08614730834960938  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148558, 128])
torch.Size([109920, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21571636199951172  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0857381820678711  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148334, 128])
torch.Size([108852, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21231460571289062  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08646821975708008  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149449, 128])
torch.Size([110718, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21813106536865234  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08621644973754883  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149001, 128])
torch.Size([109868, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21361064910888672  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.0855417251586914  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148084, 128])
torch.Size([108491, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21189498901367188  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08611392974853516  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148670, 128])
torch.Size([109934, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21445131301879883  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08600378036499023  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148447, 128])
torch.Size([109686, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2138843536376953  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08636808395385742  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149021, 128])
torch.Size([110331, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21492433547973633  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08642339706420898  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149097, 128])
torch.Size([110309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21633195877075195  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08582115173339844  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148154, 128])
torch.Size([109182, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2132277488708496  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08586359024047852  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148665, 128])
torch.Size([108735, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21211004257202148  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08591508865356445  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([148021, 128])
torch.Size([109157, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21467304229736328  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08656167984008789  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

torch.Size([149229, 128])
torch.Size([110763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21947526931762695  GigaBytes
Max Memory Allocated: 0.25021934509277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08646011352539062  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([149148, 128])
torch.Size([110467, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2163686752319336  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08597564697265625  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148856, 128])
torch.Size([109311, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21318387985229492  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08637094497680664  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148927, 128])
torch.Size([110069, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21605539321899414  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08611917495727539  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148751, 128])
torch.Size([110142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21448373794555664  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08602046966552734  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148550, 128])
torch.Size([108853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21326684951782227  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08613157272338867  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([149021, 128])
torch.Size([109600, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21377897262573242  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08568096160888672  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148460, 128])
torch.Size([108862, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2119302749633789  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08654403686523438  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([149250, 128])
torch.Size([110431, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.21647071838378906  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08612203598022461  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148739, 128])
torch.Size([110220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2145538330078125  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.08613061904907227  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

torch.Size([148787, 128])
torch.Size([109501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.2137608528137207  GigaBytes
Max Memory Allocated: 0.25031471252441406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02720644325017929 |0.017605334520339966 |0.0035713836550712585 |9.25213098526001e-05 |0.004249267280101776 |0.0030167102813720703 |
----------------------------------------------------------pseudo_mini_loss sum 4.111828327178955
Total (block generation + training)time/epoch 59.757221937179565
Training time/epoch 1.7358574867248535
Training time without block to device /epoch 1.1724867820739746
Training time without total dataloading part /epoch 0.2562382221221924
load block tensor time/epoch 0.8706061840057373
block to device time/epoch 0.5633707046508789
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9111418
Number of first layer input nodes during this epoch:  4760206
