Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648449933.9095585
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027967453002929688
range selection method range initialization spend 0.013357877731323242
time for parepare:  0.018037796020507812
local_output_nid generation:  0.005263090133666992
local_in_edges_tensor generation:  0.00654292106628418
mini_batch_src_global generation:  0.00719451904296875
r_  generation:  0.08825564384460449
local_output_nid generation:  0.006059885025024414
local_in_edges_tensor generation:  0.003103971481323242
mini_batch_src_global generation:  0.009446382522583008
r_  generation:  0.09569931030273438
local_output_nid generation:  0.0060100555419921875
local_in_edges_tensor generation:  0.003242969512939453
mini_batch_src_global generation:  0.00758671760559082
r_  generation:  0.10176491737365723
local_output_nid generation:  0.006162405014038086
local_in_edges_tensor generation:  0.0033130645751953125
mini_batch_src_global generation:  0.008215904235839844
r_  generation:  0.10304403305053711
----------------------check_connections_block total spend ----------------------------- 0.5556654930114746
generate_one_block  0.11405181884765625
generate_one_block  0.11528182029724121
generate_one_block  0.11750292778015137
generate_one_block  0.11548256874084473
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04094576835632324
gen group dst list time:  0.012096405029296875
time for parepare:  0.018834590911865234
local_output_nid generation:  0.014731645584106445
local_in_edges_tensor generation:  0.03853654861450195
mini_batch_src_global generation:  0.04197883605957031
r_  generation:  0.41868162155151367
local_output_nid generation:  0.022748470306396484
local_in_edges_tensor generation:  0.041400909423828125
mini_batch_src_global generation:  0.04986929893493652
r_  generation:  0.4368746280670166
local_output_nid generation:  0.023699522018432617
local_in_edges_tensor generation:  0.03550887107849121
mini_batch_src_global generation:  0.0498659610748291
r_  generation:  0.43912601470947266
local_output_nid generation:  0.02406787872314453
local_in_edges_tensor generation:  0.031189680099487305
mini_batch_src_global generation:  0.050737857818603516
r_  generation:  0.43759989738464355
----------------------check_connections_block total spend ----------------------------- 2.5446665287017822
generate_one_block  0.5824015140533447
generate_one_block  0.5754621028900146
generate_one_block  0.5748579502105713
generate_one_block  0.5628855228424072
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029666423797607422
gen group dst list time:  0.021387577056884766
time for parepare:  0.019004344940185547
local_output_nid generation:  0.0238192081451416
local_in_edges_tensor generation:  0.04102206230163574
mini_batch_src_global generation:  0.04460334777832031
r_  generation:  0.5005393028259277
local_output_nid generation:  0.03336453437805176
local_in_edges_tensor generation:  0.05051541328430176
mini_batch_src_global generation:  0.05562186241149902
r_  generation:  0.5090663433074951
local_output_nid generation:  0.03408241271972656
local_in_edges_tensor generation:  0.0472412109375
mini_batch_src_global generation:  0.05516529083251953
r_  generation:  0.5078654289245605
local_output_nid generation:  0.034664154052734375
local_in_edges_tensor generation:  0.033911705017089844
mini_batch_src_global generation:  0.05173134803771973
r_  generation:  0.5155954360961914
----------------------check_connections_block total spend ----------------------------- 2.9908053874969482
generate_one_block  0.6344330310821533
generate_one_block  0.6410927772521973
generate_one_block  0.6579136848449707
generate_one_block  0.6269493103027344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  5.5354719161987305
block generation total time  4.8559958934783936
average batch blocks generation time:  1.2139989733695984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.1023569107055664  GigaBytes
Max Memory Allocated: 0.1023569107055664  GigaBytes

torch.Size([164532, 128])
torch.Size([155643, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0838623046875 GB
    Memory Allocated: 0.6666555404663086  GigaBytes
Max Memory Allocated: 0.7086467742919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4588623046875 GB
    Memory Allocated: 0.10700845718383789  GigaBytes
Max Memory Allocated: 0.7671561241149902  GigaBytes

torch.Size([164581, 128])
torch.Size([155497, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4588623046875 GB
    Memory Allocated: 0.669558048248291  GigaBytes
Max Memory Allocated: 0.7671561241149902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4608154296875 GB
    Memory Allocated: 0.10659074783325195  GigaBytes
Max Memory Allocated: 0.7707171440124512  GigaBytes

torch.Size([164622, 128])
torch.Size([155692, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7674560546875 GB
    Memory Allocated: 0.6696467399597168  GigaBytes
Max Memory Allocated: 0.7707171440124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.10634660720825195  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

torch.Size([164538, 128])
torch.Size([155450, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.6675119400024414  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04205697774887085 |0.08449018001556396 |0.18231159448623657 |0.00011235475540161133 |0.017391562461853027 |0.0016057491302490234 |
----------------------------------------------------------pseudo_mini_loss sum 5.5318193435668945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1709768
Number of first layer input nodes during this epoch:  658273
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.14453887939453125  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026332378387451172
range selection method range initialization spend 0.016395092010498047
time for parepare:  0.017271757125854492
local_output_nid generation:  0.005212068557739258
local_in_edges_tensor generation:  0.00584864616394043
mini_batch_src_global generation:  0.007277488708496094
r_  generation:  0.0928950309753418
local_output_nid generation:  0.006289243698120117
local_in_edges_tensor generation:  0.005322456359863281
mini_batch_src_global generation:  0.011241436004638672
r_  generation:  0.10554671287536621
local_output_nid generation:  0.00778961181640625
local_in_edges_tensor generation:  0.005553245544433594
mini_batch_src_global generation:  0.008280515670776367
r_  generation:  0.10307431221008301
local_output_nid generation:  0.006532907485961914
local_in_edges_tensor generation:  0.00452113151550293
mini_batch_src_global generation:  0.008666038513183594
r_  generation:  0.10570645332336426
----------------------check_connections_block total spend ----------------------------- 0.594796895980835
generate_one_block  0.11740636825561523
generate_one_block  0.12104916572570801
generate_one_block  0.11766934394836426
generate_one_block  0.11896443367004395
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06340289115905762
gen group dst list time:  0.012197494506835938
time for parepare:  0.02094864845275879
local_output_nid generation:  0.01531362533569336
local_in_edges_tensor generation:  0.05011773109436035
mini_batch_src_global generation:  0.043196916580200195
r_  generation:  0.4201962947845459
local_output_nid generation:  0.0225830078125
local_in_edges_tensor generation:  0.039697885513305664
mini_batch_src_global generation:  0.049597740173339844
r_  generation:  0.42752623558044434
local_output_nid generation:  0.02340865135192871
local_in_edges_tensor generation:  0.03710746765136719
mini_batch_src_global generation:  0.049307823181152344
r_  generation:  0.44664430618286133
local_output_nid generation:  0.02374577522277832
local_in_edges_tensor generation:  0.02965831756591797
mini_batch_src_global generation:  0.05380725860595703
r_  generation:  0.4441828727722168
----------------------check_connections_block total spend ----------------------------- 2.568924903869629
generate_one_block  0.572368860244751
generate_one_block  0.5603241920471191
generate_one_block  0.6212735176086426
generate_one_block  0.5770144462585449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04622292518615723
gen group dst list time:  0.02488255500793457
time for parepare:  0.020534038543701172
local_output_nid generation:  0.02359151840209961
local_in_edges_tensor generation:  0.0555872917175293
mini_batch_src_global generation:  0.045301198959350586
r_  generation:  0.49204540252685547
local_output_nid generation:  0.032492637634277344
local_in_edges_tensor generation:  0.06061387062072754
mini_batch_src_global generation:  0.05604052543640137
r_  generation:  0.5038518905639648
local_output_nid generation:  0.03328251838684082
local_in_edges_tensor generation:  0.04647231101989746
mini_batch_src_global generation:  0.05723166465759277
r_  generation:  0.5137989521026611
local_output_nid generation:  0.033918142318725586
local_in_edges_tensor generation:  0.04041457176208496
mini_batch_src_global generation:  0.052405595779418945
r_  generation:  0.5349001884460449
----------------------check_connections_block total spend ----------------------------- 3.0445775985717773
generate_one_block  0.6670095920562744
generate_one_block  0.6556601524353027
generate_one_block  0.6546421051025391
generate_one_block  0.6422450542449951
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.14453887939453125  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

connection checking time:  5.613502502441406
block generation total time  4.950537919998169
average batch blocks generation time:  1.2376344799995422
block dataloader generation time/epoch 12.591652154922485
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.1068577766418457  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

torch.Size([164484, 128])
torch.Size([155582, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.6675724983215332  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.1068425178527832  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

torch.Size([164554, 128])
torch.Size([155462, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.6668787002563477  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.10707998275756836  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

torch.Size([164770, 128])
torch.Size([156214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.6724987030029297  GigaBytes
Max Memory Allocated: 0.7710380554199219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.10697078704833984  GigaBytes
Max Memory Allocated: 0.7744941711425781  GigaBytes

torch.Size([164521, 128])
torch.Size([155572, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.6689310073852539  GigaBytes
Max Memory Allocated: 0.7744941711425781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0452113151550293 |0.024418354034423828 |0.00456082820892334 |0.00011157989501953125 |0.009744346141815186 |0.0024805068969726562 |
----------------------------------------------------------pseudo_mini_loss sum 3.5597591400146484
Total (block generation + training)time/epoch 12.966761112213135
Training time/epoch 0.37489843368530273
Training time without block to device /epoch 0.2772250175476074
Training time without total dataloading part /epoch 0.06014752388000488
load block tensor time/epoch 0.1808452606201172
block to device time/epoch 0.09767341613769531
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1710608
Number of first layer input nodes during this epoch:  658329
