Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648448088.4286947
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027501821517944336
range selection method range initialization spend 0.013061761856079102
time for parepare:  0.018373727798461914
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0039010047912597656
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.010244131088256836
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.0005643367767333984
mini_batch_src_global generation:  0.0015282630920410156
r_  generation:  0.00998234748840332
local_output_nid generation:  0.0007390975952148438
local_in_edges_tensor generation:  0.0005133152008056641
mini_batch_src_global generation:  0.0009818077087402344
r_  generation:  0.009339094161987305
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0005247592926025391
mini_batch_src_global generation:  0.0009267330169677734
r_  generation:  0.009251832962036133
local_output_nid generation:  0.00074005126953125
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0008740425109863281
r_  generation:  0.008871316909790039
local_output_nid generation:  0.0007519721984863281
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0008745193481445312
r_  generation:  0.009220600128173828
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0005216598510742188
mini_batch_src_global generation:  0.0009448528289794922
r_  generation:  0.009540081024169922
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.009496212005615234
local_output_nid generation:  0.0007586479187011719
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0009374618530273438
r_  generation:  0.009557485580444336
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.009818077087402344
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009684562683105469
r_  generation:  0.009969234466552734
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.010100841522216797
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.009733915328979492
local_output_nid generation:  0.0007636547088623047
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0009703636169433594
r_  generation:  0.009827136993408203
local_output_nid generation:  0.0007538795471191406
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.010157585144042969
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0010123252868652344
r_  generation:  0.010346651077270508
local_output_nid generation:  0.0007822513580322266
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0010313987731933594
r_  generation:  0.010269641876220703
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0005362033843994141
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.01034402847290039
local_output_nid generation:  0.0007874965667724609
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.009928464889526367
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.010290384292602539
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.010035991668701172
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.009508132934570312
local_output_nid generation:  0.0007593631744384766
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.009801626205444336
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.009744405746459961
local_output_nid generation:  0.0007615089416503906
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0010273456573486328
r_  generation:  0.009980201721191406
local_output_nid generation:  0.0007555484771728516
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.001001596450805664
r_  generation:  0.009905815124511719
local_output_nid generation:  0.0007669925689697266
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.009930133819580078
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0010228157043457031
r_  generation:  0.010048389434814453
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.0004603862762451172
mini_batch_src_global generation:  0.0009758472442626953
r_  generation:  0.009862661361694336
local_output_nid generation:  0.0007741451263427734
local_in_edges_tensor generation:  0.004242897033691406
mini_batch_src_global generation:  0.0012099742889404297
r_  generation:  0.010124444961547852
local_output_nid generation:  0.0008151531219482422
local_in_edges_tensor generation:  0.0005254745483398438
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.010025739669799805
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.010042667388916016
----------------------check_connections_block total spend ----------------------------- 0.48601841926574707
generate_one_block  0.015703201293945312
generate_one_block  0.01549220085144043
generate_one_block  0.014771461486816406
generate_one_block  0.014523983001708984
generate_one_block  0.013805627822875977
generate_one_block  0.01429605484008789
generate_one_block  0.014680147171020508
generate_one_block  0.014410257339477539
generate_one_block  0.014452457427978516
generate_one_block  0.015230417251586914
generate_one_block  0.01491999626159668
generate_one_block  0.015178918838500977
generate_one_block  0.014899730682373047
generate_one_block  0.014750003814697266
generate_one_block  0.015259265899658203
generate_one_block  0.015020370483398438
generate_one_block  0.0152435302734375
generate_one_block  0.01536107063293457
generate_one_block  0.014945507049560547
generate_one_block  0.01522517204284668
generate_one_block  0.015113353729248047
generate_one_block  0.014163494110107422
generate_one_block  0.01479482650756836
generate_one_block  0.014493942260742188
generate_one_block  0.014697551727294922
generate_one_block  0.014947652816772461
generate_one_block  0.014880895614624023
generate_one_block  0.015030384063720703
generate_one_block  0.014535665512084961
generate_one_block  0.014734745025634766
generate_one_block  0.01494908332824707
generate_one_block  0.014601707458496094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04007244110107422
gen group dst list time:  0.023227691650390625
time for parepare:  0.019934415817260742
local_output_nid generation:  0.0045318603515625
local_in_edges_tensor generation:  0.01279449462890625
mini_batch_src_global generation:  0.013486623764038086
r_  generation:  0.13451194763183594
local_output_nid generation:  0.008678913116455078
local_in_edges_tensor generation:  0.01228189468383789
mini_batch_src_global generation:  0.018508195877075195
r_  generation:  0.1451106071472168
local_output_nid generation:  0.008342266082763672
local_in_edges_tensor generation:  0.010811567306518555
mini_batch_src_global generation:  0.015173912048339844
r_  generation:  0.14211320877075195
local_output_nid generation:  0.008586645126342773
local_in_edges_tensor generation:  0.009700536727905273
mini_batch_src_global generation:  0.01561117172241211
r_  generation:  0.14863324165344238
local_output_nid generation:  0.008490800857543945
local_in_edges_tensor generation:  0.009730815887451172
mini_batch_src_global generation:  0.01579880714416504
r_  generation:  0.1366274356842041
local_output_nid generation:  0.008796215057373047
local_in_edges_tensor generation:  0.009975671768188477
mini_batch_src_global generation:  0.016909122467041016
r_  generation:  0.14213299751281738
local_output_nid generation:  0.009185552597045898
local_in_edges_tensor generation:  0.012590408325195312
mini_batch_src_global generation:  0.0176851749420166
r_  generation:  0.14527153968811035
local_output_nid generation:  0.009145736694335938
local_in_edges_tensor generation:  0.00879359245300293
mini_batch_src_global generation:  0.01765131950378418
r_  generation:  0.14731502532958984
local_output_nid generation:  0.009159326553344727
local_in_edges_tensor generation:  0.009038448333740234
mini_batch_src_global generation:  0.018517732620239258
r_  generation:  0.14599061012268066
local_output_nid generation:  0.0094146728515625
local_in_edges_tensor generation:  0.011589288711547852
mini_batch_src_global generation:  0.017950773239135742
r_  generation:  0.14969801902770996
local_output_nid generation:  0.009366035461425781
local_in_edges_tensor generation:  0.009244680404663086
mini_batch_src_global generation:  0.0180361270904541
r_  generation:  0.1473090648651123
local_output_nid generation:  0.009643793106079102
local_in_edges_tensor generation:  0.01224970817565918
mini_batch_src_global generation:  0.01974654197692871
r_  generation:  0.15166282653808594
local_output_nid generation:  0.009478569030761719
local_in_edges_tensor generation:  0.009704828262329102
mini_batch_src_global generation:  0.0180966854095459
r_  generation:  0.14682507514953613
local_output_nid generation:  0.009552955627441406
local_in_edges_tensor generation:  0.010370969772338867
mini_batch_src_global generation:  0.018541574478149414
r_  generation:  0.14661717414855957
local_output_nid generation:  0.009788751602172852
local_in_edges_tensor generation:  0.012431144714355469
mini_batch_src_global generation:  0.01917099952697754
r_  generation:  0.1570892333984375
local_output_nid generation:  0.009717941284179688
local_in_edges_tensor generation:  0.011903762817382812
mini_batch_src_global generation:  0.018630027770996094
r_  generation:  0.1507556438446045
local_output_nid generation:  0.00984501838684082
local_in_edges_tensor generation:  0.009424686431884766
mini_batch_src_global generation:  0.018801212310791016
r_  generation:  0.1551799774169922
local_output_nid generation:  0.00983285903930664
local_in_edges_tensor generation:  0.009721994400024414
mini_batch_src_global generation:  0.018970012664794922
r_  generation:  0.1541748046875
local_output_nid generation:  0.009819984436035156
local_in_edges_tensor generation:  0.009537696838378906
mini_batch_src_global generation:  0.018352031707763672
r_  generation:  0.15378952026367188
local_output_nid generation:  0.010003089904785156
local_in_edges_tensor generation:  0.009755849838256836
mini_batch_src_global generation:  0.018551349639892578
r_  generation:  0.1551837921142578
local_output_nid generation:  0.009849071502685547
local_in_edges_tensor generation:  0.011032342910766602
mini_batch_src_global generation:  0.018646240234375
r_  generation:  0.1533045768737793
local_output_nid generation:  0.00941777229309082
local_in_edges_tensor generation:  0.009358644485473633
mini_batch_src_global generation:  0.017797470092773438
r_  generation:  0.14636588096618652
local_output_nid generation:  0.009678840637207031
local_in_edges_tensor generation:  0.010635137557983398
mini_batch_src_global generation:  0.0179903507232666
r_  generation:  0.15079283714294434
local_output_nid generation:  0.009641647338867188
local_in_edges_tensor generation:  0.011586666107177734
mini_batch_src_global generation:  0.018126249313354492
r_  generation:  0.14904308319091797
local_output_nid generation:  0.009693145751953125
local_in_edges_tensor generation:  0.011578559875488281
mini_batch_src_global generation:  0.017757892608642578
r_  generation:  0.15004944801330566
local_output_nid generation:  0.009820938110351562
local_in_edges_tensor generation:  0.011000633239746094
mini_batch_src_global generation:  0.01861715316772461
r_  generation:  0.1548473834991455
local_output_nid generation:  0.009780645370483398
local_in_edges_tensor generation:  0.010729312896728516
mini_batch_src_global generation:  0.019165515899658203
r_  generation:  0.15397119522094727
local_output_nid generation:  0.009897708892822266
local_in_edges_tensor generation:  0.010932207107543945
mini_batch_src_global generation:  0.018579483032226562
r_  generation:  0.15349245071411133
local_output_nid generation:  0.009592056274414062
local_in_edges_tensor generation:  0.010657787322998047
mini_batch_src_global generation:  0.01806950569152832
r_  generation:  0.14834904670715332
local_output_nid generation:  0.009873151779174805
local_in_edges_tensor generation:  0.010888099670410156
mini_batch_src_global generation:  0.019498586654663086
r_  generation:  0.14985895156860352
local_output_nid generation:  0.009790897369384766
local_in_edges_tensor generation:  0.00925588607788086
mini_batch_src_global generation:  0.017696857452392578
r_  generation:  0.14831876754760742
local_output_nid generation:  0.009716987609863281
local_in_edges_tensor generation:  0.011412858963012695
mini_batch_src_global generation:  0.01912093162536621
r_  generation:  0.15116500854492188
----------------------check_connections_block total spend ----------------------------- 7.109041929244995
generate_one_block  0.19216513633728027
generate_one_block  0.19540095329284668
generate_one_block  0.2149982452392578
generate_one_block  0.18427681922912598
generate_one_block  0.17612648010253906
generate_one_block  0.18468475341796875
generate_one_block  0.1879260540008545
generate_one_block  0.18431472778320312
generate_one_block  0.1864476203918457
generate_one_block  0.19231939315795898
generate_one_block  0.1883833408355713
generate_one_block  0.1963346004486084
generate_one_block  0.1884138584136963
generate_one_block  0.18680143356323242
generate_one_block  0.19949746131896973
generate_one_block  0.218919038772583
generate_one_block  0.19213342666625977
generate_one_block  0.19569921493530273
generate_one_block  0.187760591506958
generate_one_block  0.19652771949768066
generate_one_block  0.19333124160766602
generate_one_block  0.18157744407653809
generate_one_block  0.18520569801330566
generate_one_block  0.18731093406677246
generate_one_block  0.186387300491333
generate_one_block  0.19214129447937012
generate_one_block  0.19422316551208496
generate_one_block  0.1942291259765625
generate_one_block  0.18439054489135742
generate_one_block  0.18694186210632324
generate_one_block  0.18564891815185547
generate_one_block  0.19071245193481445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03770589828491211
gen group dst list time:  0.0952751636505127
time for parepare:  0.019162416458129883
local_output_nid generation:  0.02073073387145996
local_in_edges_tensor generation:  0.03600144386291504
mini_batch_src_global generation:  0.038297176361083984
r_  generation:  0.3955216407775879
local_output_nid generation:  0.027674436569213867
local_in_edges_tensor generation:  0.04152250289916992
mini_batch_src_global generation:  0.05022621154785156
r_  generation:  0.4063405990600586
local_output_nid generation:  0.027344703674316406
local_in_edges_tensor generation:  0.03139042854309082
mini_batch_src_global generation:  0.0468144416809082
r_  generation:  0.4041440486907959
local_output_nid generation:  0.026111125946044922
local_in_edges_tensor generation:  0.027485370635986328
mini_batch_src_global generation:  0.04793405532836914
r_  generation:  0.4054701328277588
local_output_nid generation:  0.02559971809387207
local_in_edges_tensor generation:  0.033705711364746094
mini_batch_src_global generation:  0.04756522178649902
r_  generation:  0.40548229217529297
local_output_nid generation:  0.025979995727539062
local_in_edges_tensor generation:  0.030955791473388672
mini_batch_src_global generation:  0.0511782169342041
r_  generation:  0.4100625514984131
local_output_nid generation:  0.026526927947998047
local_in_edges_tensor generation:  0.035227060317993164
mini_batch_src_global generation:  0.04794573783874512
r_  generation:  0.4222376346588135
local_output_nid generation:  0.026376962661743164
local_in_edges_tensor generation:  0.0283200740814209
mini_batch_src_global generation:  0.04939723014831543
r_  generation:  0.41198205947875977
local_output_nid generation:  0.026596784591674805
local_in_edges_tensor generation:  0.0270998477935791
mini_batch_src_global generation:  0.048326730728149414
r_  generation:  0.4175689220428467
local_output_nid generation:  0.026634693145751953
local_in_edges_tensor generation:  0.0360715389251709
mini_batch_src_global generation:  0.04976153373718262
r_  generation:  0.4149808883666992
local_output_nid generation:  0.02632880210876465
local_in_edges_tensor generation:  0.03191375732421875
mini_batch_src_global generation:  0.051905155181884766
r_  generation:  0.4138340950012207
local_output_nid generation:  0.02655196189880371
local_in_edges_tensor generation:  0.0390925407409668
mini_batch_src_global generation:  0.053908586502075195
r_  generation:  0.41461849212646484
local_output_nid generation:  0.026192903518676758
local_in_edges_tensor generation:  0.03007340431213379
mini_batch_src_global generation:  0.048845529556274414
r_  generation:  0.4095332622528076
local_output_nid generation:  0.026496410369873047
local_in_edges_tensor generation:  0.025470256805419922
mini_batch_src_global generation:  0.04962611198425293
r_  generation:  0.4094431400299072
local_output_nid generation:  0.02658843994140625
local_in_edges_tensor generation:  0.03204822540283203
mini_batch_src_global generation:  0.048789024353027344
r_  generation:  0.4163186550140381
local_output_nid generation:  0.026511430740356445
local_in_edges_tensor generation:  0.036817312240600586
mini_batch_src_global generation:  0.04904651641845703
r_  generation:  0.41271471977233887
local_output_nid generation:  0.02662968635559082
local_in_edges_tensor generation:  0.025842905044555664
mini_batch_src_global generation:  0.0482180118560791
r_  generation:  0.41819095611572266
local_output_nid generation:  0.027397871017456055
local_in_edges_tensor generation:  0.034598350524902344
mini_batch_src_global generation:  0.05224204063415527
r_  generation:  0.41296911239624023
local_output_nid generation:  0.026728391647338867
local_in_edges_tensor generation:  0.025966405868530273
mini_batch_src_global generation:  0.04837822914123535
r_  generation:  0.41212916374206543
local_output_nid generation:  0.027139902114868164
local_in_edges_tensor generation:  0.029225826263427734
mini_batch_src_global generation:  0.04926180839538574
r_  generation:  0.4133620262145996
local_output_nid generation:  0.030714988708496094
local_in_edges_tensor generation:  0.037111759185791016
mini_batch_src_global generation:  0.052294254302978516
r_  generation:  0.4195218086242676
local_output_nid generation:  0.02605915069580078
local_in_edges_tensor generation:  0.03301072120666504
mini_batch_src_global generation:  0.04880166053771973
r_  generation:  0.4069805145263672
local_output_nid generation:  0.02651357650756836
local_in_edges_tensor generation:  0.025783061981201172
mini_batch_src_global generation:  0.05093550682067871
r_  generation:  0.41100382804870605
local_output_nid generation:  0.0263214111328125
local_in_edges_tensor generation:  0.028901338577270508
mini_batch_src_global generation:  0.048410654067993164
r_  generation:  0.42046642303466797
local_output_nid generation:  0.02875041961669922
local_in_edges_tensor generation:  0.03272747993469238
mini_batch_src_global generation:  0.04868197441101074
r_  generation:  0.4096071720123291
local_output_nid generation:  0.027243614196777344
local_in_edges_tensor generation:  0.02533102035522461
mini_batch_src_global generation:  0.05158567428588867
r_  generation:  0.4124584197998047
local_output_nid generation:  0.027106523513793945
local_in_edges_tensor generation:  0.02951979637145996
mini_batch_src_global generation:  0.048630475997924805
r_  generation:  0.414151668548584
local_output_nid generation:  0.02776336669921875
local_in_edges_tensor generation:  0.029135942459106445
mini_batch_src_global generation:  0.04976487159729004
r_  generation:  0.4125349521636963
local_output_nid generation:  0.02673625946044922
local_in_edges_tensor generation:  0.032575130462646484
mini_batch_src_global generation:  0.04797697067260742
r_  generation:  0.40999436378479004
local_output_nid generation:  0.02800893783569336
local_in_edges_tensor generation:  0.029430866241455078
mini_batch_src_global generation:  0.052251577377319336
r_  generation:  0.4150717258453369
local_output_nid generation:  0.027618408203125
local_in_edges_tensor generation:  0.025626659393310547
mini_batch_src_global generation:  0.048471689224243164
r_  generation:  0.41579389572143555
local_output_nid generation:  0.027962207794189453
local_in_edges_tensor generation:  0.03062605857849121
mini_batch_src_global generation:  0.05188727378845215
r_  generation:  0.41002964973449707
----------------------check_connections_block total spend ----------------------------- 19.51768183708191
generate_one_block  0.628303050994873
generate_one_block  0.5495724678039551
generate_one_block  0.5539913177490234
generate_one_block  0.5577352046966553
generate_one_block  0.5304584503173828
generate_one_block  0.5255789756774902
generate_one_block  0.5352339744567871
generate_one_block  0.5370147228240967
generate_one_block  0.5528864860534668
generate_one_block  0.5535159111022949
generate_one_block  0.5435278415679932
generate_one_block  0.55702805519104
generate_one_block  0.5331170558929443
generate_one_block  0.5521304607391357
generate_one_block  0.5449140071868896
generate_one_block  0.5678608417510986
generate_one_block  0.5352823734283447
generate_one_block  0.5383186340332031
generate_one_block  0.5312025547027588
generate_one_block  0.5324816703796387
generate_one_block  0.5476787090301514
generate_one_block  0.5381166934967041
generate_one_block  0.5254697799682617
generate_one_block  0.5188486576080322
generate_one_block  0.5260109901428223
generate_one_block  0.5364525318145752
generate_one_block  0.5385503768920898
generate_one_block  0.5460081100463867
generate_one_block  0.5172865390777588
generate_one_block  0.5230867862701416
generate_one_block  0.5238864421844482
generate_one_block  0.5355474948883057
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  26.626723766326904
block generation total time  23.448328018188477
average batch blocks generation time:  0.7327602505683899
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08352041244506836  GigaBytes
Max Memory Allocated: 0.08352041244506836  GigaBytes

torch.Size([146104, 128])
torch.Size([102688, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.20834112167358398  GigaBytes
Max Memory Allocated: 0.2136387825012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0843362808227539  GigaBytes
Max Memory Allocated: 0.2351064682006836  GigaBytes

torch.Size([146266, 128])
torch.Size([103316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20938682556152344  GigaBytes
Max Memory Allocated: 0.2351064682006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0840616226196289  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

torch.Size([145848, 128])
torch.Size([101753, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20576953887939453  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08391952514648438  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

torch.Size([146293, 128])
torch.Size([101578, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2056264877319336  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08364295959472656  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

torch.Size([146081, 128])
torch.Size([100702, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20232868194580078  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08380603790283203  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

torch.Size([145961, 128])
torch.Size([101068, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20394372940063477  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08399772644042969  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

torch.Size([146662, 128])
torch.Size([102709, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20917415618896484  GigaBytes
Max Memory Allocated: 0.2354888916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08386707305908203  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146085, 128])
torch.Size([101669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20456790924072266  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08395099639892578  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145974, 128])
torch.Size([101966, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20488643646240234  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841379165649414  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146422, 128])
torch.Size([102958, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20919513702392578  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08397960662841797  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145971, 128])
torch.Size([101780, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20579290390014648  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08427715301513672  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146654, 128])
torch.Size([103743, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2088794708251953  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08400821685791016  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146324, 128])
torch.Size([102067, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20599937438964844  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08401203155517578  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146325, 128])
torch.Size([102193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20609521865844727  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08429145812988281  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146040, 128])
torch.Size([103023, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2090320587158203  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08413410186767578  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146316, 128])
torch.Size([102265, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20569515228271484  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08413887023925781  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146668, 128])
torch.Size([102983, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20898199081420898  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842447280883789  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146136, 128])
torch.Size([103025, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20905685424804688  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08407306671142578  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146617, 128])
torch.Size([102634, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20879507064819336  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08417797088623047  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146830, 128])
torch.Size([103204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091364860534668  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841817855834961  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145991, 128])
torch.Size([102843, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20886993408203125  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08383846282958984  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145599, 128])
torch.Size([100707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20354223251342773  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.083984375  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145610, 128])
torch.Size([101368, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2054920196533203  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08389472961425781  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145886, 128])
torch.Size([101495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20456933975219727  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08394813537597656  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146400, 128])
torch.Size([101821, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20581436157226562  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08406925201416016  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145983, 128])
torch.Size([102132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20543479919433594  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08410072326660156  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146070, 128])
torch.Size([101985, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20594120025634766  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08414745330810547  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146597, 128])
torch.Size([103243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2088298797607422  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08386516571044922  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([145941, 128])
torch.Size([100816, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2038102149963379  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08400535583496094  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146423, 128])
torch.Size([102273, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20615339279174805  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08393478393554688  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146190, 128])
torch.Size([102072, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20600032806396484  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08400344848632812  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146147, 128])
torch.Size([101961, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20592403411865234  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030674919486045837 |0.022129736840724945 |0.026578813791275024 |8.937716484069824e-05 |0.004655122756958008 |0.0016252994537353516 |
----------------------------------------------------------pseudo_mini_loss sum 5.370059967041016
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8787993
Number of first layer input nodes during this epoch:  4678414
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.11257600784301758  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022823095321655273
range selection method range initialization spend 0.011577367782592773
time for parepare:  0.016932010650634766
local_output_nid generation:  0.0007326602935791016
local_in_edges_tensor generation:  0.0046617984771728516
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.009900569915771484
local_output_nid generation:  0.0008308887481689453
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.001537322998046875
r_  generation:  0.009793281555175781
local_output_nid generation:  0.0007793903350830078
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.009534597396850586
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.0010111331939697266
r_  generation:  0.009582281112670898
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.009836196899414062
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.00991964340209961
local_output_nid generation:  0.0007865428924560547
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0009708404541015625
r_  generation:  0.010065793991088867
local_output_nid generation:  0.0007722377777099609
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0009763240814208984
r_  generation:  0.01011514663696289
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009431838989257812
r_  generation:  0.009804010391235352
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.010182619094848633
local_output_nid generation:  0.0008053779602050781
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0009565353393554688
r_  generation:  0.009451627731323242
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0004673004150390625
mini_batch_src_global generation:  0.0009412765502929688
r_  generation:  0.010062932968139648
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0009322166442871094
r_  generation:  0.009746789932250977
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0009675025939941406
r_  generation:  0.009522676467895508
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.009998321533203125
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.010034561157226562
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.00103759765625
r_  generation:  0.009939908981323242
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0009877681732177734
r_  generation:  0.01017904281616211
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.0004742145538330078
mini_batch_src_global generation:  0.0009636878967285156
r_  generation:  0.009847879409790039
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0009593963623046875
r_  generation:  0.009457826614379883
local_output_nid generation:  0.0007808208465576172
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.010155439376831055
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.010353803634643555
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0005130767822265625
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.010080099105834961
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0009572505950927734
r_  generation:  0.009779691696166992
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.010040760040283203
local_output_nid generation:  0.0007672309875488281
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.009899139404296875
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.00046372413635253906
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.009936809539794922
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0009927749633789062
r_  generation:  0.009729146957397461
local_output_nid generation:  0.0007684230804443359
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.0009617805480957031
r_  generation:  0.009607076644897461
local_output_nid generation:  0.0008234977722167969
local_in_edges_tensor generation:  0.0005211830139160156
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.009977340698242188
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0030372142791748047
r_  generation:  0.010138511657714844
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0006420612335205078
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.009783744812011719
----------------------check_connections_block total spend ----------------------------- 0.48534584045410156
generate_one_block  0.015314579010009766
generate_one_block  0.016710996627807617
generate_one_block  0.014533758163452148
generate_one_block  0.014791727066040039
generate_one_block  0.015063285827636719
generate_one_block  0.014620304107666016
generate_one_block  0.014618158340454102
generate_one_block  0.015010356903076172
generate_one_block  0.014679670333862305
generate_one_block  0.015226125717163086
generate_one_block  0.014008045196533203
generate_one_block  0.015086174011230469
generate_one_block  0.014316558837890625
generate_one_block  0.014040946960449219
generate_one_block  0.01495504379272461
generate_one_block  0.014786243438720703
generate_one_block  0.014960050582885742
generate_one_block  0.015366792678833008
generate_one_block  0.014633655548095703
generate_one_block  0.01413726806640625
generate_one_block  0.015442848205566406
generate_one_block  0.015245199203491211
generate_one_block  0.015007734298706055
generate_one_block  0.014183998107910156
generate_one_block  0.014956235885620117
generate_one_block  0.014595270156860352
generate_one_block  0.01455235481262207
generate_one_block  0.014423370361328125
generate_one_block  0.013921022415161133
generate_one_block  0.01528787612915039
generate_one_block  0.014917850494384766
generate_one_block  0.014669418334960938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040250301361083984
gen group dst list time:  0.021499156951904297
time for parepare:  0.018810510635375977
local_output_nid generation:  0.004156351089477539
local_in_edges_tensor generation:  0.014865636825561523
mini_batch_src_global generation:  0.013350963592529297
r_  generation:  0.1293025016784668
local_output_nid generation:  0.00667572021484375
local_in_edges_tensor generation:  0.011784076690673828
mini_batch_src_global generation:  0.018218517303466797
r_  generation:  0.1396656036376953
local_output_nid generation:  0.006624937057495117
local_in_edges_tensor generation:  0.02867722511291504
mini_batch_src_global generation:  0.015772581100463867
r_  generation:  0.14202642440795898
local_output_nid generation:  0.0071070194244384766
local_in_edges_tensor generation:  0.009800434112548828
mini_batch_src_global generation:  0.016476869583129883
r_  generation:  0.14562201499938965
local_output_nid generation:  0.007597684860229492
local_in_edges_tensor generation:  0.009754180908203125
mini_batch_src_global generation:  0.017403364181518555
r_  generation:  0.15015077590942383
local_output_nid generation:  0.0075991153717041016
local_in_edges_tensor generation:  0.007858514785766602
mini_batch_src_global generation:  0.01779341697692871
r_  generation:  0.14934873580932617
local_output_nid generation:  0.007345676422119141
local_in_edges_tensor generation:  0.007447481155395508
mini_batch_src_global generation:  0.017751216888427734
r_  generation:  0.14519405364990234
local_output_nid generation:  0.0074481964111328125
local_in_edges_tensor generation:  0.008569002151489258
mini_batch_src_global generation:  0.018654823303222656
r_  generation:  0.15149712562561035
local_output_nid generation:  0.00750422477722168
local_in_edges_tensor generation:  0.00767064094543457
mini_batch_src_global generation:  0.0182802677154541
r_  generation:  0.14772367477416992
local_output_nid generation:  0.007915019989013672
local_in_edges_tensor generation:  0.009873390197753906
mini_batch_src_global generation:  0.018979787826538086
r_  generation:  0.1515824794769287
local_output_nid generation:  0.007696866989135742
local_in_edges_tensor generation:  0.007671356201171875
mini_batch_src_global generation:  0.017906665802001953
r_  generation:  0.14587068557739258
local_output_nid generation:  0.008025169372558594
local_in_edges_tensor generation:  0.009628534317016602
mini_batch_src_global generation:  0.0192410945892334
r_  generation:  0.1518537998199463
local_output_nid generation:  0.007873296737670898
local_in_edges_tensor generation:  0.009806632995605469
mini_batch_src_global generation:  0.020117998123168945
r_  generation:  0.14830470085144043
local_output_nid generation:  0.007783651351928711
local_in_edges_tensor generation:  0.0076634883880615234
mini_batch_src_global generation:  0.02047133445739746
r_  generation:  0.14594793319702148
local_output_nid generation:  0.008051872253417969
local_in_edges_tensor generation:  0.007660388946533203
mini_batch_src_global generation:  0.018277883529663086
r_  generation:  0.1521139144897461
local_output_nid generation:  0.008031129837036133
local_in_edges_tensor generation:  0.009257316589355469
mini_batch_src_global generation:  0.019814729690551758
r_  generation:  0.1512436866760254
local_output_nid generation:  0.008118867874145508
local_in_edges_tensor generation:  0.010576486587524414
mini_batch_src_global generation:  0.018683433532714844
r_  generation:  0.1538379192352295
local_output_nid generation:  0.008307695388793945
local_in_edges_tensor generation:  0.008210182189941406
mini_batch_src_global generation:  0.020397186279296875
r_  generation:  0.15363216400146484
local_output_nid generation:  0.00800180435180664
local_in_edges_tensor generation:  0.008288860321044922
mini_batch_src_global generation:  0.01851487159729004
r_  generation:  0.15247654914855957
local_output_nid generation:  0.0073931217193603516
local_in_edges_tensor generation:  0.007606983184814453
mini_batch_src_global generation:  0.018442392349243164
r_  generation:  0.1457366943359375
local_output_nid generation:  0.0078046321868896484
local_in_edges_tensor generation:  0.009970903396606445
mini_batch_src_global generation:  0.019967317581176758
r_  generation:  0.15585994720458984
local_output_nid generation:  0.007793426513671875
local_in_edges_tensor generation:  0.009585857391357422
mini_batch_src_global generation:  0.01918315887451172
r_  generation:  0.154463529586792
local_output_nid generation:  0.007771968841552734
local_in_edges_tensor generation:  0.009394168853759766
mini_batch_src_global generation:  0.018932104110717773
r_  generation:  0.15584945678710938
local_output_nid generation:  0.007445335388183594
local_in_edges_tensor generation:  0.00888371467590332
mini_batch_src_global generation:  0.021914958953857422
r_  generation:  0.14610052108764648
local_output_nid generation:  0.007881879806518555
local_in_edges_tensor generation:  0.010404109954833984
mini_batch_src_global generation:  0.018779993057250977
r_  generation:  0.1580517292022705
local_output_nid generation:  0.007750034332275391
local_in_edges_tensor generation:  0.009369611740112305
mini_batch_src_global generation:  0.02150702476501465
r_  generation:  0.1508777141571045
local_output_nid generation:  0.00764155387878418
local_in_edges_tensor generation:  0.00810551643371582
mini_batch_src_global generation:  0.021758317947387695
r_  generation:  0.15468144416809082
local_output_nid generation:  0.007641315460205078
local_in_edges_tensor generation:  0.008940935134887695
mini_batch_src_global generation:  0.018387556076049805
r_  generation:  0.14847993850708008
local_output_nid generation:  0.007422447204589844
local_in_edges_tensor generation:  0.008816242218017578
mini_batch_src_global generation:  0.017343759536743164
r_  generation:  0.1456143856048584
local_output_nid generation:  0.007842063903808594
local_in_edges_tensor generation:  0.00800180435180664
mini_batch_src_global generation:  0.020043611526489258
r_  generation:  0.15545368194580078
local_output_nid generation:  0.007720232009887695
local_in_edges_tensor generation:  0.010419130325317383
mini_batch_src_global generation:  0.021114826202392578
r_  generation:  0.15366673469543457
local_output_nid generation:  0.007677316665649414
local_in_edges_tensor generation:  0.01033639907836914
mini_batch_src_global generation:  0.022311925888061523
r_  generation:  0.15415716171264648
----------------------check_connections_block total spend ----------------------------- 7.089275121688843
generate_one_block  0.18439555168151855
generate_one_block  0.19320154190063477
generate_one_block  0.18611741065979004
generate_one_block  0.18732857704162598
generate_one_block  0.20363140106201172
generate_one_block  0.18595337867736816
generate_one_block  0.18361616134643555
generate_one_block  0.19012236595153809
generate_one_block  0.18474745750427246
generate_one_block  0.18998980522155762
generate_one_block  0.18287062644958496
generate_one_block  0.18513727188110352
generate_one_block  0.183638334274292
generate_one_block  0.18019580841064453
generate_one_block  0.1872262954711914
generate_one_block  0.1883382797241211
generate_one_block  0.18944621086120605
generate_one_block  0.1929318904876709
generate_one_block  0.18641901016235352
generate_one_block  0.20957636833190918
generate_one_block  0.19591665267944336
generate_one_block  0.1964406967163086
generate_one_block  0.19406461715698242
generate_one_block  0.17942070960998535
generate_one_block  0.19544768333435059
generate_one_block  0.1855154037475586
generate_one_block  0.1889820098876953
generate_one_block  0.1809372901916504
generate_one_block  0.1784367561340332
generate_one_block  0.19661235809326172
generate_one_block  0.18699932098388672
generate_one_block  0.1885676383972168
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.09333014488220215
gen group dst list time:  0.09529662132263184
time for parepare:  0.017058849334716797
local_output_nid generation:  0.02030158042907715
local_in_edges_tensor generation:  0.05237698554992676
mini_batch_src_global generation:  0.039764404296875
r_  generation:  0.39481568336486816
local_output_nid generation:  0.02747201919555664
local_in_edges_tensor generation:  0.03916192054748535
mini_batch_src_global generation:  0.05086088180541992
r_  generation:  0.39824962615966797
local_output_nid generation:  0.027039766311645508
local_in_edges_tensor generation:  0.029433012008666992
mini_batch_src_global generation:  0.04889512062072754
r_  generation:  0.4005579948425293
local_output_nid generation:  0.025716781616210938
local_in_edges_tensor generation:  0.02848505973815918
mini_batch_src_global generation:  0.06456375122070312
r_  generation:  0.4270186424255371
local_output_nid generation:  0.026102304458618164
local_in_edges_tensor generation:  0.03161478042602539
mini_batch_src_global generation:  0.051779985427856445
r_  generation:  0.40998029708862305
local_output_nid generation:  0.02602553367614746
local_in_edges_tensor generation:  0.02820563316345215
mini_batch_src_global generation:  0.04890894889831543
r_  generation:  0.40578532218933105
local_output_nid generation:  0.02602410316467285
local_in_edges_tensor generation:  0.025008201599121094
mini_batch_src_global generation:  0.04885458946228027
r_  generation:  0.4043877124786377
local_output_nid generation:  0.02673482894897461
local_in_edges_tensor generation:  0.03265881538391113
mini_batch_src_global generation:  0.048627376556396484
r_  generation:  0.41085219383239746
local_output_nid generation:  0.0271759033203125
local_in_edges_tensor generation:  0.031090974807739258
mini_batch_src_global generation:  0.04845786094665527
r_  generation:  0.40482401847839355
local_output_nid generation:  0.026433944702148438
local_in_edges_tensor generation:  0.028814315795898438
mini_batch_src_global generation:  0.05135083198547363
r_  generation:  0.40487027168273926
local_output_nid generation:  0.026216506958007812
local_in_edges_tensor generation:  0.02523493766784668
mini_batch_src_global generation:  0.0483856201171875
r_  generation:  0.40540218353271484
local_output_nid generation:  0.02664017677307129
local_in_edges_tensor generation:  0.02923130989074707
mini_batch_src_global generation:  0.05639457702636719
r_  generation:  0.41300272941589355
local_output_nid generation:  0.026566028594970703
local_in_edges_tensor generation:  0.03382372856140137
mini_batch_src_global generation:  0.05061817169189453
r_  generation:  0.4099102020263672
local_output_nid generation:  0.026697874069213867
local_in_edges_tensor generation:  0.02629709243774414
mini_batch_src_global generation:  0.04937028884887695
r_  generation:  0.4029262065887451
local_output_nid generation:  0.026468753814697266
local_in_edges_tensor generation:  0.032366037368774414
mini_batch_src_global generation:  0.04804348945617676
r_  generation:  0.4239823818206787
local_output_nid generation:  0.029371023178100586
local_in_edges_tensor generation:  0.03301119804382324
mini_batch_src_global generation:  0.04940533638000488
r_  generation:  0.40564608573913574
local_output_nid generation:  0.027199745178222656
local_in_edges_tensor generation:  0.028733253479003906
mini_batch_src_global generation:  0.048750877380371094
r_  generation:  0.4187774658203125
local_output_nid generation:  0.02727818489074707
local_in_edges_tensor generation:  0.03626441955566406
mini_batch_src_global generation:  0.04854607582092285
r_  generation:  0.41293811798095703
local_output_nid generation:  0.027069091796875
local_in_edges_tensor generation:  0.025257349014282227
mini_batch_src_global generation:  0.04834747314453125
r_  generation:  0.41030216217041016
local_output_nid generation:  0.026898622512817383
local_in_edges_tensor generation:  0.02529120445251465
mini_batch_src_global generation:  0.04824423789978027
r_  generation:  0.40476536750793457
local_output_nid generation:  0.02704620361328125
local_in_edges_tensor generation:  0.025425195693969727
mini_batch_src_global generation:  0.05112767219543457
r_  generation:  0.40871500968933105
local_output_nid generation:  0.02728748321533203
local_in_edges_tensor generation:  0.036267995834350586
mini_batch_src_global generation:  0.04799222946166992
r_  generation:  0.41259312629699707
local_output_nid generation:  0.027182579040527344
local_in_edges_tensor generation:  0.033156394958496094
mini_batch_src_global generation:  0.04871845245361328
r_  generation:  0.41094255447387695
local_output_nid generation:  0.0269010066986084
local_in_edges_tensor generation:  0.02559375762939453
mini_batch_src_global generation:  0.047983646392822266
r_  generation:  0.40345263481140137
local_output_nid generation:  0.02722454071044922
local_in_edges_tensor generation:  0.02514481544494629
mini_batch_src_global generation:  0.04769635200500488
r_  generation:  0.40991806983947754
local_output_nid generation:  0.027289152145385742
local_in_edges_tensor generation:  0.032289743423461914
mini_batch_src_global generation:  0.04830336570739746
r_  generation:  0.41079163551330566
local_output_nid generation:  0.026857852935791016
local_in_edges_tensor generation:  0.025591135025024414
mini_batch_src_global generation:  0.04833412170410156
r_  generation:  0.406907320022583
local_output_nid generation:  0.026998281478881836
local_in_edges_tensor generation:  0.025578737258911133
mini_batch_src_global generation:  0.0486299991607666
r_  generation:  0.40665364265441895
local_output_nid generation:  0.026999711990356445
local_in_edges_tensor generation:  0.031990766525268555
mini_batch_src_global generation:  0.047533273696899414
r_  generation:  0.41640758514404297
local_output_nid generation:  0.027251005172729492
local_in_edges_tensor generation:  0.033158302307128906
mini_batch_src_global generation:  0.04843544960021973
r_  generation:  0.4090290069580078
local_output_nid generation:  0.02722024917602539
local_in_edges_tensor generation:  0.0289914608001709
mini_batch_src_global generation:  0.04809427261352539
r_  generation:  0.40991806983947754
local_output_nid generation:  0.02693963050842285
local_in_edges_tensor generation:  0.028844356536865234
mini_batch_src_global generation:  0.04914212226867676
r_  generation:  0.4080617427825928
----------------------check_connections_block total spend ----------------------------- 19.384844541549683
generate_one_block  0.5315506458282471
generate_one_block  0.5333638191223145
generate_one_block  0.5242404937744141
generate_one_block  0.5412828922271729
generate_one_block  0.6202964782714844
generate_one_block  0.5187199115753174
generate_one_block  0.5168285369873047
generate_one_block  0.5425238609313965
generate_one_block  0.5171749591827393
generate_one_block  0.5303332805633545
generate_one_block  0.5195248126983643
generate_one_block  0.5493395328521729
generate_one_block  0.5281598567962646
generate_one_block  0.5116322040557861
generate_one_block  0.5353634357452393
generate_one_block  0.5316481590270996
generate_one_block  0.525562047958374
generate_one_block  0.5318140983581543
generate_one_block  0.5217616558074951
generate_one_block  0.5139198303222656
generate_one_block  0.5302906036376953
generate_one_block  0.5362808704376221
generate_one_block  0.5381999015808105
generate_one_block  0.5145227909088135
generate_one_block  0.531132698059082
generate_one_block  0.5316531658172607
generate_one_block  0.5254595279693604
generate_one_block  0.5179774761199951
generate_one_block  0.5174939632415771
generate_one_block  0.5479869842529297
generate_one_block  0.5277457237243652
generate_one_block  0.5203092098236084
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.11257600784301758  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

connection checking time:  26.474119663238525
block generation total time  23.026318311691284
average batch blocks generation time:  0.7195724472403526
block dataloader generation time/epoch 51.901609897613525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0841212272644043  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

torch.Size([146647, 128])
torch.Size([102483, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20819854736328125  GigaBytes
Max Memory Allocated: 0.23550701141357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08432197570800781  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146320, 128])
torch.Size([102889, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20942163467407227  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08423614501953125  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146028, 128])
torch.Size([101784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20600652694702148  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08428955078125  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146159, 128])
torch.Size([102612, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20941400527954102  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08440017700195312  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146369, 128])
torch.Size([103355, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20919275283813477  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08427047729492188  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145943, 128])
torch.Size([101980, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20615911483764648  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08415985107421875  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145674, 128])
torch.Size([101245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2045292854309082  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08438968658447266  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146229, 128])
torch.Size([102716, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091069221496582  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08416557312011719  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146358, 128])
torch.Size([101891, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20610380172729492  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08436107635498047  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145894, 128])
torch.Size([102503, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20929193496704102  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08408927917480469  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145695, 128])
torch.Size([101289, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2044215202331543  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08427810668945312  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146771, 128])
torch.Size([103236, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20943021774291992  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842142105102539  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146369, 128])
torch.Size([102166, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2051243782043457  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08402824401855469  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145523, 128])
torch.Size([101012, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20413923263549805  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08431434631347656  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146187, 128])
torch.Size([102693, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20897579193115234  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0843057632446289  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145876, 128])
torch.Size([102472, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20940256118774414  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08434391021728516  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146474, 128])
torch.Size([102718, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20894145965576172  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08441448211669922  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146564, 128])
torch.Size([103099, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20934438705444336  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842742919921875  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145576, 128])
torch.Size([102025, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20619916915893555  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08404731750488281  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145898, 128])
torch.Size([101052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2040719985961914  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08445167541503906  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145582, 128])
torch.Size([102245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20643186569213867  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08445930480957031  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146640, 128])
torch.Size([103473, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20911455154418945  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08442497253417969  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146502, 128])
torch.Size([103299, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20905303955078125  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08405590057373047  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146114, 128])
torch.Size([101548, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20455217361450195  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08440685272216797  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146218, 128])
torch.Size([102648, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20940017700195312  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842885971069336  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146229, 128])
torch.Size([102827, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20941686630249023  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08426475524902344  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146010, 128])
torch.Size([101478, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20580005645751953  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08411502838134766  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146238, 128])
torch.Size([101777, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20494794845581055  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08395576477050781  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([145703, 128])
torch.Size([101012, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20292234420776367  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.08444499969482422  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146590, 128])
torch.Size([103070, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2091846466064453  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842752456665039  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146144, 128])
torch.Size([102695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.20941781997680664  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0842437744140625  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

torch.Size([146210, 128])
torch.Size([102050, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2062077522277832  GigaBytes
Max Memory Allocated: 0.23610210418701172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025252409279346466 |0.015300646424293518 |0.0035223960876464844 |8.94889235496521e-05 |0.003788203001022339 |0.0014104843139648438 |
----------------------------------------------------------pseudo_mini_loss sum 4.104079723358154
Total (block generation + training)time/epoch 53.483545780181885
Training time/epoch 1.5817193984985352
Training time without block to device /epoch 1.0920987129211426
Training time without total dataloading part /epoch 0.23821330070495605
load block tensor time/epoch 0.8080770969390869
block to device time/epoch 0.4896206855773926
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8790076
Number of first layer input nodes during this epoch:  4676734
