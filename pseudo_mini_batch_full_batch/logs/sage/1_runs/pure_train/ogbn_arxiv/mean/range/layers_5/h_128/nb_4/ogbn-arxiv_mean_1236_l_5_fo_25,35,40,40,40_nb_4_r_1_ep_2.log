Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648498296.3042982
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02498650550842285
range selection method range initialization spend 0.013309478759765625
time for parepare:  0.017905473709106445
local_output_nid generation:  0.005298614501953125
local_in_edges_tensor generation:  0.0061626434326171875
mini_batch_src_global generation:  0.0065805912017822266
r_  generation:  0.08441400527954102
local_output_nid generation:  0.006005287170410156
local_in_edges_tensor generation:  0.003011465072631836
mini_batch_src_global generation:  0.008428812026977539
r_  generation:  0.08889508247375488
local_output_nid generation:  0.006392240524291992
local_in_edges_tensor generation:  0.003086566925048828
mini_batch_src_global generation:  0.006212472915649414
r_  generation:  0.08802056312561035
local_output_nid generation:  0.006120920181274414
local_in_edges_tensor generation:  0.0030832290649414062
mini_batch_src_global generation:  0.006609201431274414
r_  generation:  0.09222722053527832
----------------------check_connections_block total spend ----------------------------- 0.5077059268951416
generate_one_block  0.10192298889160156
generate_one_block  0.10337686538696289
generate_one_block  0.1023564338684082
generate_one_block  0.10256028175354004
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.040627241134643555
gen group dst list time:  0.011095046997070312
time for parepare:  0.019092082977294922
local_output_nid generation:  0.014828681945800781
local_in_edges_tensor generation:  0.03812408447265625
mini_batch_src_global generation:  0.03805971145629883
r_  generation:  0.40650320053100586
local_output_nid generation:  0.02160334587097168
local_in_edges_tensor generation:  0.03916501998901367
mini_batch_src_global generation:  0.04790377616882324
r_  generation:  0.41492652893066406
local_output_nid generation:  0.022214412689208984
local_in_edges_tensor generation:  0.03182101249694824
mini_batch_src_global generation:  0.04763388633728027
r_  generation:  0.4264500141143799
local_output_nid generation:  0.02274346351623535
local_in_edges_tensor generation:  0.028353214263916016
mini_batch_src_global generation:  0.04912924766540527
r_  generation:  0.422210693359375
----------------------check_connections_block total spend ----------------------------- 2.452012062072754
generate_one_block  0.58530592918396
generate_one_block  0.5594010353088379
generate_one_block  0.5395805835723877
generate_one_block  0.5360643863677979
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0375676155090332
gen group dst list time:  0.020635604858398438
time for parepare:  0.01944565773010254
local_output_nid generation:  0.024599790573120117
local_in_edges_tensor generation:  0.05126166343688965
mini_batch_src_global generation:  0.05418539047241211
r_  generation:  0.5399947166442871
local_output_nid generation:  0.0321805477142334
local_in_edges_tensor generation:  0.04885530471801758
mini_batch_src_global generation:  0.062349796295166016
r_  generation:  0.5435407161712646
local_output_nid generation:  0.033202171325683594
local_in_edges_tensor generation:  0.03968238830566406
mini_batch_src_global generation:  0.05674028396606445
r_  generation:  0.5570807456970215
local_output_nid generation:  0.03331160545349121
local_in_edges_tensor generation:  0.03970670700073242
mini_batch_src_global generation:  0.059031009674072266
r_  generation:  0.5797901153564453
----------------------check_connections_block total spend ----------------------------- 3.246511936187744
generate_one_block  0.7270894050598145
generate_one_block  0.7245287895202637
generate_one_block  0.7104446887969971
generate_one_block  0.7099688053131104
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03067159652709961
gen group dst list time:  0.023606300354003906
time for parepare:  0.018790483474731445
local_output_nid generation:  0.027690649032592773
local_in_edges_tensor generation:  0.04098701477050781
mini_batch_src_global generation:  0.04999518394470215
r_  generation:  0.548973560333252
local_output_nid generation:  0.03462338447570801
local_in_edges_tensor generation:  0.0480494499206543
mini_batch_src_global generation:  0.061516761779785156
r_  generation:  0.5483617782592773
local_output_nid generation:  0.03536415100097656
local_in_edges_tensor generation:  0.040235042572021484
mini_batch_src_global generation:  0.065277099609375
r_  generation:  0.5582952499389648
local_output_nid generation:  0.03884172439575195
local_in_edges_tensor generation:  0.03943753242492676
mini_batch_src_global generation:  0.06189107894897461
r_  generation:  0.5489585399627686
----------------------check_connections_block total spend ----------------------------- 3.2543909549713135
generate_one_block  0.6936233043670654
generate_one_block  0.6996681690216064
generate_one_block  0.70050048828125
generate_one_block  0.6974794864654541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028172969818115234
gen group dst list time:  0.024098634719848633
time for parepare:  0.019193172454833984
local_output_nid generation:  0.0277099609375
local_in_edges_tensor generation:  0.038678646087646484
mini_batch_src_global generation:  0.049044132232666016
r_  generation:  0.5073063373565674
local_output_nid generation:  0.035058021545410156
local_in_edges_tensor generation:  0.05048775672912598
mini_batch_src_global generation:  0.05745267868041992
r_  generation:  0.5119767189025879
local_output_nid generation:  0.03697848320007324
local_in_edges_tensor generation:  0.0383143424987793
mini_batch_src_global generation:  0.05808305740356445
r_  generation:  0.5111913681030273
local_output_nid generation:  0.03951454162597656
local_in_edges_tensor generation:  0.04786229133605957
mini_batch_src_global generation:  0.0575251579284668
r_  generation:  0.5171306133270264
----------------------check_connections_block total spend ----------------------------- 3.075148582458496
generate_one_block  0.6514492034912109
generate_one_block  0.6561839580535889
generate_one_block  0.649388313293457
generate_one_block  0.6453037261962891
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  12.028063535690308
block generation total time  10.48598027229309
average batch blocks generation time:  2.6214950680732727
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12983465194702148  GigaBytes
Max Memory Allocated: 0.12983465194702148  GigaBytes

torch.Size([167438, 128])
torch.Size([166880, 128])
torch.Size([164871, 128])
torch.Size([155099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 1.388390064239502  GigaBytes
Max Memory Allocated: 1.4282684326171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.13487911224365234  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

torch.Size([167410, 128])
torch.Size([166824, 128])
torch.Size([164825, 128])
torch.Size([155016, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.3881077766418457  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.13474607467651367  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

torch.Size([167409, 128])
torch.Size([166830, 128])
torch.Size([164798, 128])
torch.Size([154852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.3882050514221191  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.1351008415222168  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

torch.Size([167379, 128])
torch.Size([166822, 128])
torch.Size([164750, 128])
torch.Size([154911, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.388169288635254  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07076656818389893 |0.11191201210021973 |0.18427205085754395 |0.00013518333435058594 |0.025555074214935303 |0.006162405014038086 |
----------------------------------------------------------pseudo_mini_loss sum 5.587349891662598
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021754
Number of first layer input nodes during this epoch:  669636
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.22823333740234375  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02502918243408203
range selection method range initialization spend 0.011015892028808594
time for parepare:  0.0177762508392334
local_output_nid generation:  0.0053064823150634766
local_in_edges_tensor generation:  0.0061991214752197266
mini_batch_src_global generation:  0.006543397903442383
r_  generation:  0.08356046676635742
local_output_nid generation:  0.006026506423950195
local_in_edges_tensor generation:  0.0033028125762939453
mini_batch_src_global generation:  0.00843954086303711
r_  generation:  0.09089303016662598
local_output_nid generation:  0.0061762332916259766
local_in_edges_tensor generation:  0.0031447410583496094
mini_batch_src_global generation:  0.006411075592041016
r_  generation:  0.09306454658508301
local_output_nid generation:  0.006150245666503906
local_in_edges_tensor generation:  0.003174304962158203
mini_batch_src_global generation:  0.007051706314086914
r_  generation:  0.09528589248657227
----------------------check_connections_block total spend ----------------------------- 0.5205626487731934
generate_one_block  0.11313700675964355
generate_one_block  0.11167073249816895
generate_one_block  0.10514187812805176
generate_one_block  0.11097431182861328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05611157417297363
gen group dst list time:  0.010831594467163086
time for parepare:  0.0209505558013916
local_output_nid generation:  0.015607118606567383
local_in_edges_tensor generation:  0.0517730712890625
mini_batch_src_global generation:  0.03881025314331055
r_  generation:  0.4126927852630615
local_output_nid generation:  0.021714210510253906
local_in_edges_tensor generation:  0.03808021545410156
mini_batch_src_global generation:  0.04799389839172363
r_  generation:  0.4259023666381836
local_output_nid generation:  0.022191524505615234
local_in_edges_tensor generation:  0.03223872184753418
mini_batch_src_global generation:  0.04826974868774414
r_  generation:  0.436953067779541
local_output_nid generation:  0.022680044174194336
local_in_edges_tensor generation:  0.024558305740356445
mini_batch_src_global generation:  0.0501856803894043
r_  generation:  0.43384504318237305
----------------------check_connections_block total spend ----------------------------- 2.5074355602264404
generate_one_block  0.5606822967529297
generate_one_block  0.5585815906524658
generate_one_block  0.5737571716308594
generate_one_block  0.5458567142486572
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.053867340087890625
gen group dst list time:  0.02091073989868164
time for parepare:  0.01939845085144043
local_output_nid generation:  0.024203062057495117
local_in_edges_tensor generation:  0.05037212371826172
mini_batch_src_global generation:  0.050415992736816406
r_  generation:  0.5552427768707275
local_output_nid generation:  0.03434443473815918
local_in_edges_tensor generation:  0.06644463539123535
mini_batch_src_global generation:  0.0756080150604248
r_  generation:  0.555194616317749
local_output_nid generation:  0.0350949764251709
local_in_edges_tensor generation:  0.04729294776916504
mini_batch_src_global generation:  0.05682969093322754
r_  generation:  0.5736007690429688
local_output_nid generation:  0.0356748104095459
local_in_edges_tensor generation:  0.034943342208862305
mini_batch_src_global generation:  0.06024432182312012
r_  generation:  0.5708634853363037
----------------------check_connections_block total spend ----------------------------- 3.346151113510132
generate_one_block  0.740105152130127
generate_one_block  0.7201673984527588
generate_one_block  0.7180373668670654
generate_one_block  0.7231905460357666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05963635444641113
gen group dst list time:  0.02617335319519043
time for parepare:  0.018534421920776367
local_output_nid generation:  0.02745652198791504
local_in_edges_tensor generation:  0.04901719093322754
mini_batch_src_global generation:  0.05337953567504883
r_  generation:  0.5453488826751709
local_output_nid generation:  0.0367124080657959
local_in_edges_tensor generation:  0.05252981185913086
mini_batch_src_global generation:  0.06207704544067383
r_  generation:  0.5496387481689453
local_output_nid generation:  0.035906314849853516
local_in_edges_tensor generation:  0.041140079498291016
mini_batch_src_global generation:  0.07752370834350586
r_  generation:  0.5820982456207275
local_output_nid generation:  0.03646707534790039
local_in_edges_tensor generation:  0.04342532157897949
mini_batch_src_global generation:  0.06516337394714355
r_  generation:  0.5856153964996338
----------------------check_connections_block total spend ----------------------------- 3.385603904724121
generate_one_block  0.7359733581542969
generate_one_block  0.7263929843902588
generate_one_block  0.7398407459259033
generate_one_block  0.7405650615692139
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04023551940917969
gen group dst list time:  0.025038957595825195
time for parepare:  0.019689321517944336
local_output_nid generation:  0.028216838836669922
local_in_edges_tensor generation:  0.05173063278198242
mini_batch_src_global generation:  0.045543670654296875
r_  generation:  0.5226485729217529
local_output_nid generation:  0.036012887954711914
local_in_edges_tensor generation:  0.052690744400024414
mini_batch_src_global generation:  0.05766558647155762
r_  generation:  0.5207688808441162
local_output_nid generation:  0.03700089454650879
local_in_edges_tensor generation:  0.044196367263793945
mini_batch_src_global generation:  0.05816149711608887
r_  generation:  0.5224471092224121
local_output_nid generation:  0.036920785903930664
local_in_edges_tensor generation:  0.03994345664978027
mini_batch_src_global generation:  0.05841779708862305
r_  generation:  0.5266964435577393
----------------------check_connections_block total spend ----------------------------- 3.1393299102783203
generate_one_block  0.6655604839324951
generate_one_block  0.6753849983215332
generate_one_block  0.672105073928833
generate_one_block  0.6456410884857178
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.22823333740234375  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

connection checking time:  12.378520488739014
block generation total time  10.741842031478882
average batch blocks generation time:  2.6854605078697205
block dataloader generation time/epoch 25.468782901763916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.1360177993774414  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

torch.Size([167459, 128])
torch.Size([166880, 128])
torch.Size([164795, 128])
torch.Size([154839, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.3890089988708496  GigaBytes
Max Memory Allocated: 1.4845728874206543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.1359100341796875  GigaBytes
Max Memory Allocated: 1.4847540855407715  GigaBytes

torch.Size([167434, 128])
torch.Size([166867, 128])
torch.Size([164854, 128])
torch.Size([154990, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.3891263008117676  GigaBytes
Max Memory Allocated: 1.4847540855407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.13594722747802734  GigaBytes
Max Memory Allocated: 1.484865665435791  GigaBytes

torch.Size([167519, 128])
torch.Size([166969, 128])
torch.Size([164977, 128])
torch.Size([155294, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.3894343376159668  GigaBytes
Max Memory Allocated: 1.484865665435791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.13583850860595703  GigaBytes
Max Memory Allocated: 1.4851560592651367  GigaBytes

torch.Size([167438, 128])
torch.Size([166842, 128])
torch.Size([164729, 128])
torch.Size([154747, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.3883275985717773  GigaBytes
Max Memory Allocated: 1.4851560592651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07681465148925781 |0.04494565725326538 |0.0064002275466918945 |0.00010025501251220703 |0.023936808109283447 |0.003058195114135742 |
----------------------------------------------------------pseudo_mini_loss sum 3.869196891784668
Total (block generation + training)time/epoch 26.163919925689697
Training time/epoch 0.6948096752166748
Training time without block to device /epoch 0.5150270462036133
Training time without total dataloading part /epoch 0.12480735778808594
load block tensor time/epoch 0.30725860595703125
block to device time/epoch 0.17978262901306152
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3022128
Number of first layer input nodes during this epoch:  669850
