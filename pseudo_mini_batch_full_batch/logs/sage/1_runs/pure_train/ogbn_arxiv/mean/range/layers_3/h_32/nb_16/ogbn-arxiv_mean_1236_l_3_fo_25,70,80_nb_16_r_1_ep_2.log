Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446486.0334735
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027605533599853516
range selection method range initialization spend 0.013536691665649414
time for parepare:  0.018081188201904297
local_output_nid generation:  0.0013422966003417969
local_in_edges_tensor generation:  0.0041387081146240234
mini_batch_src_global generation:  0.001963376998901367
r_  generation:  0.020542144775390625
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.002498149871826172
r_  generation:  0.020674943923950195
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.019663095474243164
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.020460128784179688
local_output_nid generation:  0.001537322998046875
local_in_edges_tensor generation:  0.0009682178497314453
mini_batch_src_global generation:  0.0015876293182373047
r_  generation:  0.02087092399597168
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0008759498596191406
mini_batch_src_global generation:  0.0016295909881591797
r_  generation:  0.021025419235229492
local_output_nid generation:  0.0015163421630859375
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.001722574234008789
r_  generation:  0.021618127822875977
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0016508102416992188
r_  generation:  0.020157337188720703
local_output_nid generation:  0.0015342235565185547
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.02071857452392578
local_output_nid generation:  0.0015261173248291016
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0016698837280273438
r_  generation:  0.02124190330505371
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0017294883728027344
r_  generation:  0.021066904067993164
local_output_nid generation:  0.0015909671783447266
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.02176976203918457
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0017066001892089844
r_  generation:  0.022062301635742188
local_output_nid generation:  0.0015761852264404297
local_in_edges_tensor generation:  0.0009107589721679688
mini_batch_src_global generation:  0.0017170906066894531
r_  generation:  0.021584272384643555
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.02192974090576172
local_output_nid generation:  0.0015511512756347656
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.021965742111206055
----------------------check_connections_block total spend ----------------------------- 0.4994313716888428
generate_one_block  0.030629873275756836
generate_one_block  0.03185224533081055
generate_one_block  0.032148122787475586
generate_one_block  0.03112006187438965
generate_one_block  0.03151273727416992
generate_one_block  0.031606435775756836
generate_one_block  0.03199338912963867
generate_one_block  0.029630661010742188
generate_one_block  0.030199766159057617
generate_one_block  0.030285358428955078
generate_one_block  0.031028270721435547
generate_one_block  0.03190279006958008
generate_one_block  0.03219199180603027
generate_one_block  0.03147077560424805
generate_one_block  0.03203082084655762
generate_one_block  0.031939029693603516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04298830032348633
gen group dst list time:  0.020555973052978516
time for parepare:  0.019906282424926758
local_output_nid generation:  0.0073854923248291016
local_in_edges_tensor generation:  0.020056962966918945
mini_batch_src_global generation:  0.025149106979370117
r_  generation:  0.2549104690551758
local_output_nid generation:  0.01370549201965332
local_in_edges_tensor generation:  0.023426055908203125
mini_batch_src_global generation:  0.03334784507751465
r_  generation:  0.2693910598754883
local_output_nid generation:  0.014060020446777344
local_in_edges_tensor generation:  0.020628690719604492
mini_batch_src_global generation:  0.030849456787109375
r_  generation:  0.2635483741760254
local_output_nid generation:  0.014690637588500977
local_in_edges_tensor generation:  0.01630377769470215
mini_batch_src_global generation:  0.03237342834472656
r_  generation:  0.26801133155822754
local_output_nid generation:  0.015388727188110352
local_in_edges_tensor generation:  0.0194394588470459
mini_batch_src_global generation:  0.043154239654541016
r_  generation:  0.2776601314544678
local_output_nid generation:  0.015573263168334961
local_in_edges_tensor generation:  0.01927971839904785
mini_batch_src_global generation:  0.034224510192871094
r_  generation:  0.26952219009399414
local_output_nid generation:  0.015734195709228516
local_in_edges_tensor generation:  0.01708078384399414
mini_batch_src_global generation:  0.042029380798339844
r_  generation:  0.27759552001953125
local_output_nid generation:  0.014874458312988281
local_in_edges_tensor generation:  0.013981342315673828
mini_batch_src_global generation:  0.03340268135070801
r_  generation:  0.2564687728881836
local_output_nid generation:  0.015307188034057617
local_in_edges_tensor generation:  0.013750076293945312
mini_batch_src_global generation:  0.04607510566711426
r_  generation:  0.26521944999694824
local_output_nid generation:  0.01533818244934082
local_in_edges_tensor generation:  0.015321969985961914
mini_batch_src_global generation:  0.0358271598815918
r_  generation:  0.2706272602081299
local_output_nid generation:  0.015328645706176758
local_in_edges_tensor generation:  0.014087438583374023
mini_batch_src_global generation:  0.03341531753540039
r_  generation:  0.26580095291137695
local_output_nid generation:  0.015549182891845703
local_in_edges_tensor generation:  0.017008066177368164
mini_batch_src_global generation:  0.034954071044921875
r_  generation:  0.2783689498901367
local_output_nid generation:  0.015805721282958984
local_in_edges_tensor generation:  0.02196049690246582
mini_batch_src_global generation:  0.034508466720581055
r_  generation:  0.27487635612487793
local_output_nid generation:  0.015578985214233398
local_in_edges_tensor generation:  0.017003774642944336
mini_batch_src_global generation:  0.03435683250427246
r_  generation:  0.2736082077026367
local_output_nid generation:  0.01598978042602539
local_in_edges_tensor generation:  0.014529228210449219
mini_batch_src_global generation:  0.03545331954956055
r_  generation:  0.2792985439300537
local_output_nid generation:  0.01575303077697754
local_in_edges_tensor generation:  0.01915907859802246
mini_batch_src_global generation:  0.0348665714263916
r_  generation:  0.2740042209625244
----------------------check_connections_block total spend ----------------------------- 6.345359802246094
generate_one_block  0.3568568229675293
generate_one_block  0.36115574836730957
generate_one_block  0.347501277923584
generate_one_block  0.35555148124694824
generate_one_block  0.37253355979919434
generate_one_block  0.35832929611206055
generate_one_block  0.3617684841156006
generate_one_block  0.33632564544677734
generate_one_block  0.3417074680328369
generate_one_block  0.3541829586029053
generate_one_block  0.3446085453033447
generate_one_block  0.3634347915649414
generate_one_block  0.35645103454589844
generate_one_block  0.3570125102996826
generate_one_block  0.3676414489746094
generate_one_block  0.35778212547302246
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03621077537536621
gen group dst list time:  0.06230425834655762
time for parepare:  0.019380807876586914
local_output_nid generation:  0.024420499801635742
local_in_edges_tensor generation:  0.039910316467285156
mini_batch_src_global generation:  0.043309688568115234
r_  generation:  0.4503357410430908
local_output_nid generation:  0.030446290969848633
local_in_edges_tensor generation:  0.04839515686035156
mini_batch_src_global generation:  0.05239248275756836
r_  generation:  0.4594714641571045
local_output_nid generation:  0.03074502944946289
local_in_edges_tensor generation:  0.04017782211303711
mini_batch_src_global generation:  0.05412554740905762
r_  generation:  0.4678645133972168
local_output_nid generation:  0.03130173683166504
local_in_edges_tensor generation:  0.03551840782165527
mini_batch_src_global generation:  0.0676412582397461
r_  generation:  0.47103285789489746
local_output_nid generation:  0.032535552978515625
local_in_edges_tensor generation:  0.04562115669250488
mini_batch_src_global generation:  0.07767176628112793
r_  generation:  0.48586416244506836
local_output_nid generation:  0.034403324127197266
local_in_edges_tensor generation:  0.043555259704589844
mini_batch_src_global generation:  0.05576324462890625
r_  generation:  0.47758913040161133
local_output_nid generation:  0.03234696388244629
local_in_edges_tensor generation:  0.03383040428161621
mini_batch_src_global generation:  0.0570368766784668
r_  generation:  0.47733211517333984
local_output_nid generation:  0.03246259689331055
local_in_edges_tensor generation:  0.029338836669921875
mini_batch_src_global generation:  0.05309033393859863
r_  generation:  0.475492000579834
local_output_nid generation:  0.03203630447387695
local_in_edges_tensor generation:  0.030954837799072266
mini_batch_src_global generation:  0.05364203453063965
r_  generation:  0.4741647243499756
local_output_nid generation:  0.03256821632385254
local_in_edges_tensor generation:  0.0376279354095459
mini_batch_src_global generation:  0.056603431701660156
r_  generation:  0.4766111373901367
local_output_nid generation:  0.03259706497192383
local_in_edges_tensor generation:  0.033120155334472656
mini_batch_src_global generation:  0.05452871322631836
r_  generation:  0.47872447967529297
local_output_nid generation:  0.032723188400268555
local_in_edges_tensor generation:  0.037587881088256836
mini_batch_src_global generation:  0.053995609283447266
r_  generation:  0.488295316696167
local_output_nid generation:  0.03344321250915527
local_in_edges_tensor generation:  0.03997445106506348
mini_batch_src_global generation:  0.053911447525024414
r_  generation:  0.47939634323120117
local_output_nid generation:  0.03295278549194336
local_in_edges_tensor generation:  0.03340911865234375
mini_batch_src_global generation:  0.05415153503417969
r_  generation:  0.49681997299194336
local_output_nid generation:  0.032492637634277344
local_in_edges_tensor generation:  0.04075121879577637
mini_batch_src_global generation:  0.06331849098205566
r_  generation:  0.4813423156738281
local_output_nid generation:  0.03354668617248535
local_in_edges_tensor generation:  0.038739919662475586
mini_batch_src_global generation:  0.05360603332519531
r_  generation:  0.4777660369873047
----------------------check_connections_block total spend ----------------------------- 11.361023426055908
generate_one_block  0.615537166595459
generate_one_block  0.6092872619628906
generate_one_block  0.5978434085845947
generate_one_block  0.6078019142150879
generate_one_block  0.6033759117126465
generate_one_block  0.6032171249389648
generate_one_block  0.6498556137084961
generate_one_block  0.5790026187896729
generate_one_block  0.5800004005432129
generate_one_block  0.5867388248443604
generate_one_block  0.6046273708343506
generate_one_block  0.5983257293701172
generate_one_block  0.5980863571166992
generate_one_block  0.5902457237243652
generate_one_block  0.5902340412139893
generate_one_block  0.5813286304473877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  17.706383228302002
block generation total time  15.28835129737854
average batch blocks generation time:  0.9555219560861588
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09253787994384766  GigaBytes
Max Memory Allocated: 0.09253787994384766  GigaBytes

torch.Size([156807, 128])
torch.Size([129453, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.18880510330200195  GigaBytes
Max Memory Allocated: 0.1914043426513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09448957443237305  GigaBytes
Max Memory Allocated: 0.20178461074829102  GigaBytes

torch.Size([156893, 128])
torch.Size([130312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1896228790283203  GigaBytes
Max Memory Allocated: 0.20178461074829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09421491622924805  GigaBytes
Max Memory Allocated: 0.2030620574951172  GigaBytes

torch.Size([156901, 128])
torch.Size([129924, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1883397102355957  GigaBytes
Max Memory Allocated: 0.2030620574951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09430456161499023  GigaBytes
Max Memory Allocated: 0.2030620574951172  GigaBytes

torch.Size([156957, 128])
torch.Size([129646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18889617919921875  GigaBytes
Max Memory Allocated: 0.2030620574951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09446287155151367  GigaBytes
Max Memory Allocated: 0.2030806541442871  GigaBytes

torch.Size([156935, 128])
torch.Size([130130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18942928314208984  GigaBytes
Max Memory Allocated: 0.2030806541442871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09462928771972656  GigaBytes
Max Memory Allocated: 0.2030806541442871  GigaBytes

torch.Size([157332, 128])
torch.Size([130486, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1895465850830078  GigaBytes
Max Memory Allocated: 0.2030806541442871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09452342987060547  GigaBytes
Max Memory Allocated: 0.20308876037597656  GigaBytes

torch.Size([156818, 128])
torch.Size([130352, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18977069854736328  GigaBytes
Max Memory Allocated: 0.20308876037597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09386682510375977  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156649, 128])
torch.Size([128892, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18803739547729492  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09382486343383789  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156351, 128])
torch.Size([129135, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18831110000610352  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09434795379638672  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([157108, 128])
torch.Size([130091, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18875598907470703  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09421873092651367  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([157017, 128])
torch.Size([130017, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18874073028564453  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09459400177001953  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([157086, 128])
torch.Size([130501, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1896381378173828  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09431600570678711  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156697, 128])
torch.Size([130422, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1892380714416504  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.0943460464477539  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156796, 128])
torch.Size([129921, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18901634216308594  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09439277648925781  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156848, 128])
torch.Size([130289, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.189483642578125  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09438467025756836  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156789, 128])
torch.Size([129797, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18918132781982422  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03047347068786621 |0.036266669631004333 |0.0491793155670166 |0.00011143088340759277 |0.008300423622131348 |0.0019311904907226562 |
----------------------------------------------------------pseudo_mini_loss sum 5.052455902099609
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5320566
Number of first layer input nodes during this epoch:  2509984
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1319565773010254  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02633380889892578
range selection method range initialization spend 0.015866756439208984
time for parepare:  0.01854705810546875
local_output_nid generation:  0.0013670921325683594
local_in_edges_tensor generation:  0.008915185928344727
mini_batch_src_global generation:  0.0019860267639160156
r_  generation:  0.019742250442504883
local_output_nid generation:  0.0017726421356201172
local_in_edges_tensor generation:  0.0010478496551513672
mini_batch_src_global generation:  0.0023941993713378906
r_  generation:  0.021036624908447266
local_output_nid generation:  0.0018122196197509766
local_in_edges_tensor generation:  0.0009462833404541016
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.02204442024230957
local_output_nid generation:  0.0019114017486572266
local_in_edges_tensor generation:  0.001039743423461914
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.02118372917175293
local_output_nid generation:  0.0019044876098632812
local_in_edges_tensor generation:  0.0009427070617675781
mini_batch_src_global generation:  0.0016295909881591797
r_  generation:  0.023476839065551758
local_output_nid generation:  0.0019047260284423828
local_in_edges_tensor generation:  0.001195669174194336
mini_batch_src_global generation:  0.0020155906677246094
r_  generation:  0.04644513130187988
local_output_nid generation:  0.0026967525482177734
local_in_edges_tensor generation:  0.0017313957214355469
mini_batch_src_global generation:  0.002345561981201172
r_  generation:  0.022488117218017578
local_output_nid generation:  0.0018932819366455078
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.02106189727783203
local_output_nid generation:  0.0018086433410644531
local_in_edges_tensor generation:  0.001003265380859375
mini_batch_src_global generation:  0.001605987548828125
r_  generation:  0.021307945251464844
local_output_nid generation:  0.001827239990234375
local_in_edges_tensor generation:  0.0009682178497314453
mini_batch_src_global generation:  0.0017163753509521484
r_  generation:  0.022186756134033203
local_output_nid generation:  0.0017936229705810547
local_in_edges_tensor generation:  0.0009653568267822266
mini_batch_src_global generation:  0.001695871353149414
r_  generation:  0.024410724639892578
local_output_nid generation:  0.0018146038055419922
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.002129793167114258
r_  generation:  0.02279376983642578
local_output_nid generation:  0.0018489360809326172
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.001783132553100586
r_  generation:  0.023195981979370117
local_output_nid generation:  0.0019211769104003906
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0018248558044433594
r_  generation:  0.02342391014099121
local_output_nid generation:  0.0018677711486816406
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0017898082733154297
r_  generation:  0.022498607635498047
local_output_nid generation:  0.0018699169158935547
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0017578601837158203
r_  generation:  0.02322530746459961
----------------------check_connections_block total spend ----------------------------- 0.5675058364868164
generate_one_block  0.03036785125732422
generate_one_block  0.03138422966003418
generate_one_block  0.03163719177246094
generate_one_block  0.03161025047302246
generate_one_block  0.032491445541381836
generate_one_block  0.03387784957885742
generate_one_block  0.03190493583679199
generate_one_block  0.030500173568725586
generate_one_block  0.03171062469482422
generate_one_block  0.0324554443359375
generate_one_block  0.03157448768615723
generate_one_block  0.032706499099731445
generate_one_block  0.03255605697631836
generate_one_block  0.03300786018371582
generate_one_block  0.03209185600280762
generate_one_block  0.03306126594543457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05077028274536133
gen group dst list time:  0.01979851722717285
time for parepare:  0.02039647102355957
local_output_nid generation:  0.00725245475769043
local_in_edges_tensor generation:  0.029673099517822266
mini_batch_src_global generation:  0.026194095611572266
r_  generation:  0.2491893768310547
local_output_nid generation:  0.01406240463256836
local_in_edges_tensor generation:  0.022792816162109375
mini_batch_src_global generation:  0.03177189826965332
r_  generation:  0.25756335258483887
local_output_nid generation:  0.015515565872192383
local_in_edges_tensor generation:  0.02316141128540039
mini_batch_src_global generation:  0.030723094940185547
r_  generation:  0.2652723789215088
local_output_nid generation:  0.015668392181396484
local_in_edges_tensor generation:  0.01389455795288086
mini_batch_src_global generation:  0.03393959999084473
r_  generation:  0.26749587059020996
local_output_nid generation:  0.016016721725463867
local_in_edges_tensor generation:  0.019188404083251953
mini_batch_src_global generation:  0.033165931701660156
r_  generation:  0.28145861625671387
local_output_nid generation:  0.015758037567138672
local_in_edges_tensor generation:  0.01722097396850586
mini_batch_src_global generation:  0.03370237350463867
r_  generation:  0.27672243118286133
local_output_nid generation:  0.01593494415283203
local_in_edges_tensor generation:  0.014730691909790039
mini_batch_src_global generation:  0.04026031494140625
r_  generation:  0.28263139724731445
local_output_nid generation:  0.0157012939453125
local_in_edges_tensor generation:  0.014089584350585938
mini_batch_src_global generation:  0.036837100982666016
r_  generation:  0.27567219734191895
local_output_nid generation:  0.016185998916625977
local_in_edges_tensor generation:  0.014803171157836914
mini_batch_src_global generation:  0.03395342826843262
r_  generation:  0.27165889739990234
local_output_nid generation:  0.016389131546020508
local_in_edges_tensor generation:  0.018975019454956055
mini_batch_src_global generation:  0.03499007225036621
r_  generation:  0.30027103424072266
local_output_nid generation:  0.01678776741027832
local_in_edges_tensor generation:  0.026059627532958984
mini_batch_src_global generation:  0.03706502914428711
r_  generation:  0.2713773250579834
local_output_nid generation:  0.01517486572265625
local_in_edges_tensor generation:  0.020493268966674805
mini_batch_src_global generation:  0.03649783134460449
r_  generation:  0.2898573875427246
local_output_nid generation:  0.017639875411987305
local_in_edges_tensor generation:  0.014287948608398438
mini_batch_src_global generation:  0.03487706184387207
r_  generation:  0.2774538993835449
local_output_nid generation:  0.01343393325805664
local_in_edges_tensor generation:  0.018547534942626953
mini_batch_src_global generation:  0.0373079776763916
r_  generation:  0.2814669609069824
local_output_nid generation:  0.012891530990600586
local_in_edges_tensor generation:  0.02272963523864746
mini_batch_src_global generation:  0.03564882278442383
r_  generation:  0.2812387943267822
local_output_nid generation:  0.014037609100341797
local_in_edges_tensor generation:  0.029445171356201172
mini_batch_src_global generation:  0.04320645332336426
r_  generation:  0.2777092456817627
----------------------check_connections_block total spend ----------------------------- 6.490768671035767
generate_one_block  0.3541910648345947
generate_one_block  0.3559708595275879
generate_one_block  0.3494436740875244
generate_one_block  0.36658406257629395
generate_one_block  0.35616016387939453
generate_one_block  0.3492894172668457
generate_one_block  0.4283332824707031
generate_one_block  0.35189390182495117
generate_one_block  0.4060380458831787
generate_one_block  0.3656952381134033
generate_one_block  0.3506500720977783
generate_one_block  0.36456918716430664
generate_one_block  0.3762996196746826
generate_one_block  0.3731119632720947
generate_one_block  0.3584601879119873
generate_one_block  0.35752224922180176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042398929595947266
gen group dst list time:  0.07378458976745605
time for parepare:  0.0214841365814209
local_output_nid generation:  0.025875329971313477
local_in_edges_tensor generation:  0.05651283264160156
mini_batch_src_global generation:  0.043018341064453125
r_  generation:  0.4726560115814209
local_output_nid generation:  0.03566408157348633
local_in_edges_tensor generation:  0.04890727996826172
mini_batch_src_global generation:  0.057846784591674805
r_  generation:  0.4658162593841553
local_output_nid generation:  0.0325312614440918
local_in_edges_tensor generation:  0.03863883018493652
mini_batch_src_global generation:  0.051125288009643555
r_  generation:  0.47104763984680176
local_output_nid generation:  0.03263497352600098
local_in_edges_tensor generation:  0.03389477729797363
mini_batch_src_global generation:  0.054947614669799805
r_  generation:  0.47107934951782227
local_output_nid generation:  0.033116817474365234
local_in_edges_tensor generation:  0.08684778213500977
mini_batch_src_global generation:  0.05564260482788086
r_  generation:  0.4779791831970215
local_output_nid generation:  0.031816959381103516
local_in_edges_tensor generation:  0.03839468955993652
mini_batch_src_global generation:  0.054833173751831055
r_  generation:  0.48599672317504883
local_output_nid generation:  0.032048702239990234
local_in_edges_tensor generation:  0.03084278106689453
mini_batch_src_global generation:  0.053664445877075195
r_  generation:  0.48413968086242676
local_output_nid generation:  0.032021284103393555
local_in_edges_tensor generation:  0.032766103744506836
mini_batch_src_global generation:  0.05310320854187012
r_  generation:  0.4783802032470703
local_output_nid generation:  0.03253579139709473
local_in_edges_tensor generation:  0.033670663833618164
mini_batch_src_global generation:  0.05370211601257324
r_  generation:  0.4815659523010254
local_output_nid generation:  0.032224178314208984
local_in_edges_tensor generation:  0.04242682456970215
mini_batch_src_global generation:  0.05312395095825195
r_  generation:  0.4841337203979492
local_output_nid generation:  0.03290510177612305
local_in_edges_tensor generation:  0.041822195053100586
mini_batch_src_global generation:  0.05295896530151367
r_  generation:  0.4868626594543457
local_output_nid generation:  0.03340744972229004
local_in_edges_tensor generation:  0.03765106201171875
mini_batch_src_global generation:  0.05787539482116699
r_  generation:  0.5016229152679443
local_output_nid generation:  0.03796219825744629
local_in_edges_tensor generation:  0.0395662784576416
mini_batch_src_global generation:  0.061693668365478516
r_  generation:  0.4811055660247803
local_output_nid generation:  0.03402209281921387
local_in_edges_tensor generation:  0.03824186325073242
mini_batch_src_global generation:  0.05376124382019043
r_  generation:  0.48257946968078613
local_output_nid generation:  0.03355145454406738
local_in_edges_tensor generation:  0.04328131675720215
mini_batch_src_global generation:  0.0534360408782959
r_  generation:  0.4968233108520508
local_output_nid generation:  0.03391289710998535
local_in_edges_tensor generation:  0.03336381912231445
mini_batch_src_global generation:  0.05414938926696777
r_  generation:  0.4892098903656006
----------------------check_connections_block total spend ----------------------------- 11.489798545837402
generate_one_block  0.5969088077545166
generate_one_block  0.5855276584625244
generate_one_block  0.5932497978210449
generate_one_block  0.5966775417327881
generate_one_block  0.5997865200042725
generate_one_block  0.6108417510986328
generate_one_block  0.5896964073181152
generate_one_block  0.5839371681213379
generate_one_block  0.6321225166320801
generate_one_block  0.6162185668945312
generate_one_block  0.597764253616333
generate_one_block  0.6003048419952393
generate_one_block  0.5886597633361816
generate_one_block  0.6138627529144287
generate_one_block  0.626826286315918
generate_one_block  0.6047565937042236
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1319565773010254  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

connection checking time:  17.98056721687317
block generation total time  15.501354217529297
average batch blocks generation time:  0.968834638595581
block dataloader generation time/epoch 35.864120960235596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09406566619873047  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156457, 128])
torch.Size([129073, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18822956085205078  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09435129165649414  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156891, 128])
torch.Size([130115, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18874216079711914  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09422111511230469  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156654, 128])
torch.Size([129398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1885514259338379  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09444713592529297  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([157024, 128])
torch.Size([129841, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18909835815429688  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.0945134162902832  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156965, 128])
torch.Size([130238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1895008087158203  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09440755844116211  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156961, 128])
torch.Size([130077, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1891775131225586  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09444141387939453  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156814, 128])
torch.Size([129680, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18895530700683594  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09412240982055664  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156677, 128])
torch.Size([129119, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18805360794067383  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09429931640625  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156836, 128])
torch.Size([130132, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1885819435119629  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09452056884765625  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156804, 128])
torch.Size([129719, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.1893453598022461  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09443187713623047  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([157000, 128])
torch.Size([129969, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18912124633789062  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.0945138931274414  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156752, 128])
torch.Size([129921, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18953418731689453  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09428787231445312  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([156484, 128])
torch.Size([129692, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18917560577392578  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09467887878417969  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

torch.Size([157018, 128])
torch.Size([130576, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18998479843139648  GigaBytes
Max Memory Allocated: 0.2032628059387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.09460639953613281  GigaBytes
Max Memory Allocated: 0.20336389541625977  GigaBytes

torch.Size([157136, 128])
torch.Size([130859, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18955659866333008  GigaBytes
Max Memory Allocated: 0.20336389541625977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.0944814682006836  GigaBytes
Max Memory Allocated: 0.20336389541625977  GigaBytes

torch.Size([156890, 128])
torch.Size([130374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.18949317932128906  GigaBytes
Max Memory Allocated: 0.20336389541625977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028388872742652893 |0.018412157893180847 |0.0034459829330444336 |9.259581565856934e-05 |0.00406309962272644 |0.0028388500213623047 |
----------------------------------------------------------pseudo_mini_loss sum 4.326460361480713
Total (block generation + training)time/epoch 36.764309883117676
Training time/epoch 0.8998880386352539
Training time without block to device /epoch 0.6052935123443604
Training time without total dataloading part /epoch 0.1244657039642334
load block tensor time/epoch 0.4542219638824463
block to device time/epoch 0.29459452629089355
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5318351
Number of first layer input nodes during this epoch:  2509363
