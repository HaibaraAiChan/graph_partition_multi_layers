Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648450448.6152327
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02710747718811035
range selection method range initialization spend 0.013218164443969727
time for parepare:  0.01781439781188965
local_output_nid generation:  0.002686738967895508
local_in_edges_tensor generation:  0.00494074821472168
mini_batch_src_global generation:  0.0036003589630126953
r_  generation:  0.040064096450805664
local_output_nid generation:  0.003103494644165039
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.004392385482788086
r_  generation:  0.04261326789855957
local_output_nid generation:  0.0032143592834472656
local_in_edges_tensor generation:  0.0016820430755615234
mini_batch_src_global generation:  0.0032041072845458984
r_  generation:  0.04309439659118652
local_output_nid generation:  0.0031664371490478516
local_in_edges_tensor generation:  0.0017511844635009766
mini_batch_src_global generation:  0.0032148361206054688
r_  generation:  0.0454254150390625
local_output_nid generation:  0.003220796585083008
local_in_edges_tensor generation:  0.0017375946044921875
mini_batch_src_global generation:  0.0033502578735351562
r_  generation:  0.04571104049682617
local_output_nid generation:  0.003238677978515625
local_in_edges_tensor generation:  0.001737356185913086
mini_batch_src_global generation:  0.0036840438842773438
r_  generation:  0.04675698280334473
local_output_nid generation:  0.0031435489654541016
local_in_edges_tensor generation:  0.0017910003662109375
mini_batch_src_global generation:  0.003601551055908203
r_  generation:  0.045990943908691406
local_output_nid generation:  0.0032105445861816406
local_in_edges_tensor generation:  0.0017690658569335938
mini_batch_src_global generation:  0.003595590591430664
r_  generation:  0.04669904708862305
----------------------check_connections_block total spend ----------------------------- 0.519176721572876
generate_one_block  0.060935020446777344
generate_one_block  0.06165456771850586
generate_one_block  0.060622215270996094
generate_one_block  0.061867475509643555
generate_one_block  0.0644693374633789
generate_one_block  0.06277036666870117
generate_one_block  0.06192588806152344
generate_one_block  0.06252765655517578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044330596923828125
gen group dst list time:  0.01624011993408203
time for parepare:  0.0198209285736084
local_output_nid generation:  0.011521339416503906
local_in_edges_tensor generation:  0.03188943862915039
mini_batch_src_global generation:  0.03367018699645996
r_  generation:  0.35148000717163086
local_output_nid generation:  0.018468856811523438
local_in_edges_tensor generation:  0.03300356864929199
mini_batch_src_global generation:  0.04392647743225098
r_  generation:  0.37100887298583984
local_output_nid generation:  0.01861262321472168
local_in_edges_tensor generation:  0.02343916893005371
mini_batch_src_global generation:  0.04406619071960449
r_  generation:  0.3732302188873291
local_output_nid generation:  0.019557952880859375
local_in_edges_tensor generation:  0.02744603157043457
mini_batch_src_global generation:  0.04600381851196289
r_  generation:  0.3830375671386719
local_output_nid generation:  0.019835710525512695
local_in_edges_tensor generation:  0.030900001525878906
mini_batch_src_global generation:  0.04649925231933594
r_  generation:  0.37999391555786133
local_output_nid generation:  0.02012920379638672
local_in_edges_tensor generation:  0.028297901153564453
mini_batch_src_global generation:  0.05103158950805664
r_  generation:  0.3844606876373291
local_output_nid generation:  0.019960641860961914
local_in_edges_tensor generation:  0.0207364559173584
mini_batch_src_global generation:  0.04670286178588867
r_  generation:  0.38464856147766113
local_output_nid generation:  0.019856929779052734
local_in_edges_tensor generation:  0.02416229248046875
mini_batch_src_global generation:  0.04654526710510254
r_  generation:  0.3777198791503906
----------------------check_connections_block total spend ----------------------------- 4.382605314254761
generate_one_block  0.4905691146850586
generate_one_block  0.4976966381072998
generate_one_block  0.5001449584960938
generate_one_block  0.5015373229980469
generate_one_block  0.5048706531524658
generate_one_block  0.5203282833099365
generate_one_block  0.4933152198791504
generate_one_block  0.49884867668151855
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032225608825683594
gen group dst list time:  0.037090301513671875
time for parepare:  0.018859386444091797
local_output_nid generation:  0.025719165802001953
local_in_edges_tensor generation:  0.04096269607543945
mini_batch_src_global generation:  0.046976327896118164
r_  generation:  0.4761991500854492
local_output_nid generation:  0.032869815826416016
local_in_edges_tensor generation:  0.05033063888549805
mini_batch_src_global generation:  0.054320573806762695
r_  generation:  0.48436927795410156
local_output_nid generation:  0.033365488052368164
local_in_edges_tensor generation:  0.040505409240722656
mini_batch_src_global generation:  0.05509209632873535
r_  generation:  0.49159789085388184
local_output_nid generation:  0.034108638763427734
local_in_edges_tensor generation:  0.041770219802856445
mini_batch_src_global generation:  0.05620217323303223
r_  generation:  0.500967264175415
local_output_nid generation:  0.03517007827758789
local_in_edges_tensor generation:  0.05450272560119629
mini_batch_src_global generation:  0.05489802360534668
r_  generation:  0.4962632656097412
local_output_nid generation:  0.03522610664367676
local_in_edges_tensor generation:  0.03963470458984375
mini_batch_src_global generation:  0.05765342712402344
r_  generation:  0.5006487369537354
local_output_nid generation:  0.03523874282836914
local_in_edges_tensor generation:  0.03821611404418945
mini_batch_src_global generation:  0.05844926834106445
r_  generation:  0.49573588371276855
local_output_nid generation:  0.041696786880493164
local_in_edges_tensor generation:  0.04123663902282715
mini_batch_src_global generation:  0.06911396980285645
r_  generation:  0.4973773956298828
----------------------check_connections_block total spend ----------------------------- 5.921861410140991
generate_one_block  0.6196699142456055
generate_one_block  0.6207880973815918
generate_one_block  0.621431827545166
generate_one_block  0.6230528354644775
generate_one_block  0.6254324913024902
generate_one_block  0.63555908203125
generate_one_block  0.6449780464172363
generate_one_block  0.6239593029022217
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  10.304466724395752
block generation total time  9.02218246459961
average batch blocks generation time:  1.1277728080749512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09963226318359375  GigaBytes
Max Memory Allocated: 0.09963226318359375  GigaBytes

torch.Size([161920, 128])
torch.Size([145816, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.5736379623413086  GigaBytes
Max Memory Allocated: 0.6040639877319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10251855850219727  GigaBytes
Max Memory Allocated: 0.6434154510498047  GigaBytes

torch.Size([162049, 128])
torch.Size([145878, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5746245384216309  GigaBytes
Max Memory Allocated: 0.6434154510498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.1025848388671875  GigaBytes
Max Memory Allocated: 0.6445150375366211  GigaBytes

torch.Size([162028, 128])
torch.Size([145520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.5742578506469727  GigaBytes
Max Memory Allocated: 0.6445150375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.10275459289550781  GigaBytes
Max Memory Allocated: 0.6445150375366211  GigaBytes

torch.Size([162293, 128])
torch.Size([145796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.5758833885192871  GigaBytes
Max Memory Allocated: 0.6445150375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10243988037109375  GigaBytes
Max Memory Allocated: 0.6449403762817383  GigaBytes

torch.Size([162286, 128])
torch.Size([146150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5752158164978027  GigaBytes
Max Memory Allocated: 0.6449403762817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10275554656982422  GigaBytes
Max Memory Allocated: 0.6449403762817383  GigaBytes

torch.Size([162356, 128])
torch.Size([146442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5775275230407715  GigaBytes
Max Memory Allocated: 0.6449403762817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10260248184204102  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162044, 128])
torch.Size([145901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5752506256103516  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10244083404541016  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162092, 128])
torch.Size([145826, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5750932693481445  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043022215366363525 |0.055791258811950684 |0.09682902693748474 |0.00010839104652404785 |0.01352962851524353 |0.001897573471069336 |
----------------------------------------------------------pseudo_mini_loss sum 5.5846757888793945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3053074
Number of first layer input nodes during this epoch:  1297068
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.13645029067993164  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02749800682067871
range selection method range initialization spend 0.011612653732299805
time for parepare:  0.01801776885986328
local_output_nid generation:  0.004292964935302734
local_in_edges_tensor generation:  0.007643222808837891
mini_batch_src_global generation:  0.003637075424194336
r_  generation:  0.04082798957824707
local_output_nid generation:  0.003608226776123047
local_in_edges_tensor generation:  0.0017333030700683594
mini_batch_src_global generation:  0.004791259765625
r_  generation:  0.04604339599609375
local_output_nid generation:  0.003673553466796875
local_in_edges_tensor generation:  0.0017173290252685547
mini_batch_src_global generation:  0.0032265186309814453
r_  generation:  0.04455685615539551
local_output_nid generation:  0.003661632537841797
local_in_edges_tensor generation:  0.0017461776733398438
mini_batch_src_global generation:  0.0033273696899414062
r_  generation:  0.045778751373291016
local_output_nid generation:  0.0036880970001220703
local_in_edges_tensor generation:  0.00174713134765625
mini_batch_src_global generation:  0.0036182403564453125
r_  generation:  0.0495753288269043
local_output_nid generation:  0.0037479400634765625
local_in_edges_tensor generation:  0.001734018325805664
mini_batch_src_global generation:  0.0039103031158447266
r_  generation:  0.04857301712036133
local_output_nid generation:  0.0037190914154052734
local_in_edges_tensor generation:  0.001741647720336914
mini_batch_src_global generation:  0.0038595199584960938
r_  generation:  0.048696279525756836
local_output_nid generation:  0.003719329833984375
local_in_edges_tensor generation:  0.00173187255859375
mini_batch_src_global generation:  0.004012346267700195
r_  generation:  0.04781079292297363
----------------------check_connections_block total spend ----------------------------- 0.5493972301483154
generate_one_block  0.05970025062561035
generate_one_block  0.06542444229125977
generate_one_block  0.062174320220947266
generate_one_block  0.06503987312316895
generate_one_block  0.06742215156555176
generate_one_block  0.0634617805480957
generate_one_block  0.07018661499023438
generate_one_block  0.06332516670227051
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04500460624694824
gen group dst list time:  0.016527891159057617
time for parepare:  0.018950462341308594
local_output_nid generation:  0.011165618896484375
local_in_edges_tensor generation:  0.035895586013793945
mini_batch_src_global generation:  0.037628889083862305
r_  generation:  0.3705461025238037
local_output_nid generation:  0.02065873146057129
local_in_edges_tensor generation:  0.03760957717895508
mini_batch_src_global generation:  0.046070098876953125
r_  generation:  0.37055230140686035
local_output_nid generation:  0.018394947052001953
local_in_edges_tensor generation:  0.02853107452392578
mini_batch_src_global generation:  0.044677019119262695
r_  generation:  0.3770022392272949
local_output_nid generation:  0.018597841262817383
local_in_edges_tensor generation:  0.02253866195678711
mini_batch_src_global generation:  0.04496169090270996
r_  generation:  0.3773512840270996
local_output_nid generation:  0.01901412010192871
local_in_edges_tensor generation:  0.02341151237487793
mini_batch_src_global generation:  0.046668052673339844
r_  generation:  0.37990736961364746
local_output_nid generation:  0.01907825469970703
local_in_edges_tensor generation:  0.026471376419067383
mini_batch_src_global generation:  0.047362565994262695
r_  generation:  0.3876829147338867
local_output_nid generation:  0.01912236213684082
local_in_edges_tensor generation:  0.023279666900634766
mini_batch_src_global generation:  0.04682326316833496
r_  generation:  0.39795827865600586
local_output_nid generation:  0.0190887451171875
local_in_edges_tensor generation:  0.029565811157226562
mini_batch_src_global generation:  0.046677350997924805
r_  generation:  0.384213924407959
----------------------check_connections_block total spend ----------------------------- 4.445214748382568
generate_one_block  0.5012662410736084
generate_one_block  0.5173451900482178
generate_one_block  0.5029511451721191
generate_one_block  0.49283552169799805
generate_one_block  0.5177383422851562
generate_one_block  0.5125992298126221
generate_one_block  0.5246930122375488
generate_one_block  0.5321266651153564
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04601788520812988
gen group dst list time:  0.03768324851989746
time for parepare:  0.02091503143310547
local_output_nid generation:  0.0256960391998291
local_in_edges_tensor generation:  0.04719734191894531
mini_batch_src_global generation:  0.04783916473388672
r_  generation:  0.486100435256958
local_output_nid generation:  0.03491473197937012
local_in_edges_tensor generation:  0.05561208724975586
mini_batch_src_global generation:  0.05546450614929199
r_  generation:  0.50028395652771
local_output_nid generation:  0.03347134590148926
local_in_edges_tensor generation:  0.04594135284423828
mini_batch_src_global generation:  0.06584811210632324
r_  generation:  0.4938790798187256
local_output_nid generation:  0.037165164947509766
local_in_edges_tensor generation:  0.042110443115234375
mini_batch_src_global generation:  0.05367326736450195
r_  generation:  0.4952418804168701
local_output_nid generation:  0.03595089912414551
local_in_edges_tensor generation:  0.050684213638305664
mini_batch_src_global generation:  0.05326676368713379
r_  generation:  0.5000393390655518
local_output_nid generation:  0.03516221046447754
local_in_edges_tensor generation:  0.03729557991027832
mini_batch_src_global generation:  0.05426812171936035
r_  generation:  0.514768123626709
local_output_nid generation:  0.035241127014160156
local_in_edges_tensor generation:  0.03342604637145996
mini_batch_src_global generation:  0.054968833923339844
r_  generation:  0.5027554035186768
local_output_nid generation:  0.03519487380981445
local_in_edges_tensor generation:  0.036806344985961914
mini_batch_src_global generation:  0.05900406837463379
r_  generation:  0.5054435729980469
----------------------check_connections_block total spend ----------------------------- 5.972344875335693
generate_one_block  0.6245946884155273
generate_one_block  0.624403715133667
generate_one_block  0.6083481311798096
generate_one_block  0.6211385726928711
generate_one_block  0.6279373168945312
generate_one_block  0.62803053855896
generate_one_block  0.6167702674865723
generate_one_block  0.6267304420471191
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.13645029067993164  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

connection checking time:  10.417559623718262
block generation total time  9.079509019851685
average batch blocks generation time:  1.1349386274814606
block dataloader generation time/epoch 21.62030291557312
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10302305221557617  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162183, 128])
torch.Size([145937, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5742855072021484  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10328531265258789  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162042, 128])
torch.Size([145820, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.575993537902832  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10290241241455078  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162042, 128])
torch.Size([145323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5714597702026367  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.1031794548034668  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162242, 128])
torch.Size([145880, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5759077072143555  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10327720642089844  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162397, 128])
torch.Size([146333, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5771169662475586  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10320663452148438  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162360, 128])
torch.Size([146223, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5766286849975586  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10281229019165039  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162013, 128])
torch.Size([145439, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5759830474853516  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10296487808227539  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

torch.Size([162288, 128])
torch.Size([146105, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5758323669433594  GigaBytes
Max Memory Allocated: 0.6483979225158691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05154046416282654 |0.018182992935180664 |0.003642559051513672 |9.229779243469238e-05 |0.003751099109649658 |0.00228118896484375 |
----------------------------------------------------------pseudo_mini_loss sum 3.580042600631714
Total (block generation + training)time/epoch 22.274328470230103
Training time/epoch 0.6538219451904297
Training time without block to device /epoch 0.5083580017089844
Training time without total dataloading part /epoch 0.06216883659362793
load block tensor time/epoch 0.4123237133026123
block to device time/epoch 0.1454639434814453
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3053073
Number of first layer input nodes during this epoch:  1297567
