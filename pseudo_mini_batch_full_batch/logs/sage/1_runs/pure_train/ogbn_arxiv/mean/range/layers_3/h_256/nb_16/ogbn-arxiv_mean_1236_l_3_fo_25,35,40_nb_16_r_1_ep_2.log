Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648451568.6757839
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024370431900024414
range selection method range initialization spend 0.013773441314697266
time for parepare:  0.017796754837036133
local_output_nid generation:  0.0013456344604492188
local_in_edges_tensor generation:  0.003093242645263672
mini_batch_src_global generation:  0.00173187255859375
r_  generation:  0.018329620361328125
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0020809173583984375
r_  generation:  0.01862168312072754
local_output_nid generation:  0.0015115737915039062
local_in_edges_tensor generation:  0.0008361339569091797
mini_batch_src_global generation:  0.0013070106506347656
r_  generation:  0.018054962158203125
local_output_nid generation:  0.0015239715576171875
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0013055801391601562
r_  generation:  0.018503427505493164
local_output_nid generation:  0.0014872550964355469
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.001312255859375
r_  generation:  0.018593788146972656
local_output_nid generation:  0.0015003681182861328
local_in_edges_tensor generation:  0.0008292198181152344
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.018677473068237305
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.0014107227325439453
r_  generation:  0.019083738327026367
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0014183521270751953
r_  generation:  0.01871633529663086
local_output_nid generation:  0.0015006065368652344
local_in_edges_tensor generation:  0.0008225440979003906
mini_batch_src_global generation:  0.0013928413391113281
r_  generation:  0.01901721954345703
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0014033317565917969
r_  generation:  0.01890873908996582
local_output_nid generation:  0.001489400863647461
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.019067764282226562
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.0014495849609375
r_  generation:  0.019553184509277344
local_output_nid generation:  0.0015048980712890625
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0014603137969970703
r_  generation:  0.01928544044494629
local_output_nid generation:  0.001523733139038086
local_in_edges_tensor generation:  0.0008370876312255859
mini_batch_src_global generation:  0.0014774799346923828
r_  generation:  0.01902008056640625
local_output_nid generation:  0.0015285015106201172
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0014743804931640625
r_  generation:  0.019530534744262695
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.019326210021972656
----------------------check_connections_block total spend ----------------------------- 0.4503927230834961
generate_one_block  0.026563405990600586
generate_one_block  0.028575658798217773
generate_one_block  0.02897810935974121
generate_one_block  0.027554988861083984
generate_one_block  0.027902603149414062
generate_one_block  0.027842283248901367
generate_one_block  0.027870655059814453
generate_one_block  0.027057170867919922
generate_one_block  0.027668237686157227
generate_one_block  0.02731800079345703
generate_one_block  0.027840375900268555
generate_one_block  0.028535842895507812
generate_one_block  0.027605295181274414
generate_one_block  0.027689695358276367
generate_one_block  0.02750682830810547
generate_one_block  0.028035879135131836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03756546974182129
gen group dst list time:  0.01876544952392578
time for parepare:  0.018932580947875977
local_output_nid generation:  0.006666898727416992
local_in_edges_tensor generation:  0.014998674392700195
mini_batch_src_global generation:  0.018657684326171875
r_  generation:  0.18851041793823242
local_output_nid generation:  0.009971380233764648
local_in_edges_tensor generation:  0.01755237579345703
mini_batch_src_global generation:  0.024447202682495117
r_  generation:  0.20054960250854492
local_output_nid generation:  0.010040760040283203
local_in_edges_tensor generation:  0.014178276062011719
mini_batch_src_global generation:  0.022626638412475586
r_  generation:  0.1948232650756836
local_output_nid generation:  0.010384559631347656
local_in_edges_tensor generation:  0.01268458366394043
mini_batch_src_global generation:  0.023859500885009766
r_  generation:  0.20231389999389648
local_output_nid generation:  0.0106658935546875
local_in_edges_tensor generation:  0.013112306594848633
mini_batch_src_global generation:  0.028547286987304688
r_  generation:  0.20564889907836914
local_output_nid generation:  0.010704517364501953
local_in_edges_tensor generation:  0.014774322509765625
mini_batch_src_global generation:  0.025551557540893555
r_  generation:  0.20751452445983887
local_output_nid generation:  0.01074075698852539
local_in_edges_tensor generation:  0.013301610946655273
mini_batch_src_global generation:  0.027502059936523438
r_  generation:  0.20961976051330566
local_output_nid generation:  0.010719776153564453
local_in_edges_tensor generation:  0.011477470397949219
mini_batch_src_global generation:  0.025686264038085938
r_  generation:  0.2042851448059082
local_output_nid generation:  0.01081228256225586
local_in_edges_tensor generation:  0.012325763702392578
mini_batch_src_global generation:  0.025684595108032227
r_  generation:  0.20503497123718262
local_output_nid generation:  0.010944604873657227
local_in_edges_tensor generation:  0.014792680740356445
mini_batch_src_global generation:  0.025504350662231445
r_  generation:  0.2047429084777832
local_output_nid generation:  0.01098012924194336
local_in_edges_tensor generation:  0.015227556228637695
mini_batch_src_global generation:  0.02734208106994629
r_  generation:  0.20688509941101074
local_output_nid generation:  0.011240243911743164
local_in_edges_tensor generation:  0.015302181243896484
mini_batch_src_global generation:  0.026294231414794922
r_  generation:  0.21284890174865723
local_output_nid generation:  0.011167526245117188
local_in_edges_tensor generation:  0.013567209243774414
mini_batch_src_global generation:  0.026301145553588867
r_  generation:  0.2112891674041748
local_output_nid generation:  0.011164188385009766
local_in_edges_tensor generation:  0.011726140975952148
mini_batch_src_global generation:  0.026198387145996094
r_  generation:  0.2085587978363037
local_output_nid generation:  0.011203527450561523
local_in_edges_tensor generation:  0.013154745101928711
mini_batch_src_global generation:  0.027616262435913086
r_  generation:  0.20982599258422852
local_output_nid generation:  0.011121511459350586
local_in_edges_tensor generation:  0.015309333801269531
mini_batch_src_global generation:  0.027667999267578125
r_  generation:  0.21041321754455566
----------------------check_connections_block total spend ----------------------------- 4.828601121902466
generate_one_block  0.2676422595977783
generate_one_block  0.26993799209594727
generate_one_block  0.25980162620544434
generate_one_block  0.26702237129211426
generate_one_block  0.2796051502227783
generate_one_block  0.2659482955932617
generate_one_block  0.27214527130126953
generate_one_block  0.262134313583374
generate_one_block  0.2641463279724121
generate_one_block  0.2630276679992676
generate_one_block  0.2702043056488037
generate_one_block  0.276731014251709
generate_one_block  0.2664756774902344
generate_one_block  0.2659876346588135
generate_one_block  0.27451348304748535
generate_one_block  0.27001476287841797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034818172454833984
gen group dst list time:  0.05842161178588867
time for parepare:  0.018616914749145508
local_output_nid generation:  0.02318716049194336
local_in_edges_tensor generation:  0.03608107566833496
mini_batch_src_global generation:  0.04034757614135742
r_  generation:  0.4337425231933594
local_output_nid generation:  0.028830528259277344
local_in_edges_tensor generation:  0.04464459419250488
mini_batch_src_global generation:  0.0506594181060791
r_  generation:  0.44563794136047363
local_output_nid generation:  0.028755903244018555
local_in_edges_tensor generation:  0.037396907806396484
mini_batch_src_global generation:  0.04915285110473633
r_  generation:  0.4440913200378418
local_output_nid generation:  0.028734445571899414
local_in_edges_tensor generation:  0.033233642578125
mini_batch_src_global generation:  0.0512087345123291
r_  generation:  0.4519224166870117
local_output_nid generation:  0.02883625030517578
local_in_edges_tensor generation:  0.041687726974487305
mini_batch_src_global generation:  0.054225921630859375
r_  generation:  0.44965457916259766
local_output_nid generation:  0.029125690460205078
local_in_edges_tensor generation:  0.02993941307067871
mini_batch_src_global generation:  0.05208706855773926
r_  generation:  0.4534282684326172
local_output_nid generation:  0.029094457626342773
local_in_edges_tensor generation:  0.029430627822875977
mini_batch_src_global generation:  0.0513768196105957
r_  generation:  0.4558982849121094
local_output_nid generation:  0.02934122085571289
local_in_edges_tensor generation:  0.029651641845703125
mini_batch_src_global generation:  0.05223679542541504
r_  generation:  0.4540386199951172
local_output_nid generation:  0.029180049896240234
local_in_edges_tensor generation:  0.03330349922180176
mini_batch_src_global generation:  0.05165600776672363
r_  generation:  0.45151543617248535
local_output_nid generation:  0.029775619506835938
local_in_edges_tensor generation:  0.04190850257873535
mini_batch_src_global generation:  0.05171656608581543
r_  generation:  0.45795750617980957
local_output_nid generation:  0.029473066329956055
local_in_edges_tensor generation:  0.037886619567871094
mini_batch_src_global generation:  0.051007747650146484
r_  generation:  0.4527280330657959
local_output_nid generation:  0.029581069946289062
local_in_edges_tensor generation:  0.033974647521972656
mini_batch_src_global generation:  0.053009986877441406
r_  generation:  0.45578646659851074
local_output_nid generation:  0.02965831756591797
local_in_edges_tensor generation:  0.02980947494506836
mini_batch_src_global generation:  0.05157017707824707
r_  generation:  0.45613932609558105
local_output_nid generation:  0.030494213104248047
local_in_edges_tensor generation:  0.03358268737792969
mini_batch_src_global generation:  0.056382179260253906
r_  generation:  0.45450735092163086
local_output_nid generation:  0.029582738876342773
local_in_edges_tensor generation:  0.03027200698852539
mini_batch_src_global generation:  0.05139279365539551
r_  generation:  0.45275330543518066
local_output_nid generation:  0.029668569564819336
local_in_edges_tensor generation:  0.03400278091430664
mini_batch_src_global generation:  0.05548238754272461
r_  generation:  0.4583108425140381
----------------------check_connections_block total spend ----------------------------- 10.631045818328857
generate_one_block  0.5636703968048096
generate_one_block  0.5808007717132568
generate_one_block  0.5593242645263672
generate_one_block  0.576772928237915
generate_one_block  0.5904529094696045
generate_one_block  0.5727615356445312
generate_one_block  0.6265673637390137
generate_one_block  0.5695846080780029
generate_one_block  0.5610647201538086
generate_one_block  0.5717408657073975
generate_one_block  0.5878660678863525
generate_one_block  0.5860023498535156
generate_one_block  0.5660033226013184
generate_one_block  0.590172290802002
generate_one_block  0.5634715557098389
generate_one_block  0.5923600196838379
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  15.459646940231323
block generation total time  13.553954124450684
average batch blocks generation time:  0.8471221327781677
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09061193466186523  GigaBytes
Max Memory Allocated: 0.09061193466186523  GigaBytes

torch.Size([154617, 128])
torch.Size([122675, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.7155365943908691  GigaBytes
Max Memory Allocated: 0.7527928352355957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.09177160263061523  GigaBytes
Max Memory Allocated: 0.7940654754638672  GigaBytes

torch.Size([154345, 128])
torch.Size([122274, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.7183842658996582  GigaBytes
Max Memory Allocated: 0.7940654754638672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.092132568359375  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154549, 128])
torch.Size([122028, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.7135591506958008  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.09167718887329102  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154567, 128])
torch.Size([122498, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.714911937713623  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 0.09227943420410156  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154811, 128])
torch.Size([122984, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 0.7183918952941895  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0916290283203125  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154368, 128])
torch.Size([122304, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7157406806945801  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.0923919677734375  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154473, 128])
torch.Size([122547, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.717933177947998  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09145832061767578  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154158, 128])
torch.Size([122032, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.71319580078125  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09218692779541016  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154296, 128])
torch.Size([121991, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7152528762817383  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09172630310058594  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154690, 128])
torch.Size([122475, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.714235782623291  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09227371215820312  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154355, 128])
torch.Size([122428, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7163639068603516  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09178447723388672  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

torch.Size([154302, 128])
torch.Size([122939, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7216095924377441  GigaBytes
Max Memory Allocated: 0.7980680465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09229755401611328  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154314, 128])
torch.Size([122087, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7161707878112793  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09166097640991211  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154367, 128])
torch.Size([122526, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7155055999755859  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09228038787841797  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154354, 128])
torch.Size([122309, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7165155410766602  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.09170913696289062  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154316, 128])
torch.Size([122513, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 0.7159061431884766  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05977129936218262 |0.03340315818786621 |0.049497902393341064 |9.958446025848389e-05 |0.007003068923950195 |0.0023903846740722656 |
----------------------------------------------------------pseudo_mini_loss sum 6.25314474105835
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5090842
Number of first layer input nodes during this epoch:  2470882
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11529397964477539  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020935535430908203
range selection method range initialization spend 0.01143026351928711
time for parepare:  0.01643061637878418
local_output_nid generation:  0.0013549327850341797
local_in_edges_tensor generation:  0.0072329044342041016
mini_batch_src_global generation:  0.0017876625061035156
r_  generation:  0.017812728881835938
local_output_nid generation:  0.0015163421630859375
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.002072572708129883
r_  generation:  0.018311500549316406
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.0013508796691894531
r_  generation:  0.018860816955566406
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0008456707000732422
mini_batch_src_global generation:  0.0013310909271240234
r_  generation:  0.01815032958984375
local_output_nid generation:  0.0015554428100585938
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0013303756713867188
r_  generation:  0.0184018611907959
local_output_nid generation:  0.0014939308166503906
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.0013968944549560547
r_  generation:  0.018507003784179688
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0008487701416015625
mini_batch_src_global generation:  0.0014324188232421875
r_  generation:  0.01894235610961914
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0008194446563720703
mini_batch_src_global generation:  0.0014176368713378906
r_  generation:  0.018471717834472656
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.001378774642944336
r_  generation:  0.01894545555114746
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.019480228424072266
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.000823974609375
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.019204378128051758
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.001474618911743164
r_  generation:  0.019332170486450195
local_output_nid generation:  0.0015187263488769531
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.0014951229095458984
r_  generation:  0.019609451293945312
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.019707202911376953
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.019477128982543945
local_output_nid generation:  0.0014545917510986328
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0014696121215820312
r_  generation:  0.01921844482421875
----------------------check_connections_block total spend ----------------------------- 0.45604920387268066
generate_one_block  0.03151965141296387
generate_one_block  0.028136491775512695
generate_one_block  0.02844405174255371
generate_one_block  0.02730250358581543
generate_one_block  0.027622699737548828
generate_one_block  0.029447555541992188
generate_one_block  0.027634382247924805
generate_one_block  0.026944398880004883
generate_one_block  0.02723217010498047
generate_one_block  0.0280916690826416
generate_one_block  0.027551651000976562
generate_one_block  0.028108596801757812
generate_one_block  0.028078556060791016
generate_one_block  0.028629541397094727
generate_one_block  0.02826237678527832
generate_one_block  0.0283052921295166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03383207321166992
gen group dst list time:  0.017466068267822266
time for parepare:  0.020435571670532227
local_output_nid generation:  0.006564617156982422
local_in_edges_tensor generation:  0.02046966552734375
mini_batch_src_global generation:  0.01894688606262207
r_  generation:  0.19683504104614258
local_output_nid generation:  0.010828256607055664
local_in_edges_tensor generation:  0.018122196197509766
mini_batch_src_global generation:  0.0240328311920166
r_  generation:  0.20299148559570312
local_output_nid generation:  0.011516809463500977
local_in_edges_tensor generation:  0.015096426010131836
mini_batch_src_global generation:  0.023410558700561523
r_  generation:  0.2067279815673828
local_output_nid generation:  0.014889001846313477
local_in_edges_tensor generation:  0.015320539474487305
mini_batch_src_global generation:  0.02404165267944336
r_  generation:  0.20912647247314453
local_output_nid generation:  0.011670589447021484
local_in_edges_tensor generation:  0.013416051864624023
mini_batch_src_global generation:  0.02499103546142578
r_  generation:  0.21179842948913574
local_output_nid generation:  0.01630234718322754
local_in_edges_tensor generation:  0.02972245216369629
mini_batch_src_global generation:  0.03348970413208008
r_  generation:  0.21072959899902344
local_output_nid generation:  0.012462139129638672
local_in_edges_tensor generation:  0.014839887619018555
mini_batch_src_global generation:  0.025485992431640625
r_  generation:  0.20682024955749512
local_output_nid generation:  0.011244535446166992
local_in_edges_tensor generation:  0.012850761413574219
mini_batch_src_global generation:  0.025282621383666992
r_  generation:  0.2048492431640625
local_output_nid generation:  0.01136922836303711
local_in_edges_tensor generation:  0.01304173469543457
mini_batch_src_global generation:  0.025812625885009766
r_  generation:  0.20886635780334473
local_output_nid generation:  0.011641263961791992
local_in_edges_tensor generation:  0.015227317810058594
mini_batch_src_global generation:  0.027614831924438477
r_  generation:  0.21273136138916016
local_output_nid generation:  0.011429786682128906
local_in_edges_tensor generation:  0.011512041091918945
mini_batch_src_global generation:  0.025702953338623047
r_  generation:  0.2062060832977295
local_output_nid generation:  0.011681795120239258
local_in_edges_tensor generation:  0.013103723526000977
mini_batch_src_global generation:  0.02764296531677246
r_  generation:  0.21276569366455078
local_output_nid generation:  0.011778831481933594
local_in_edges_tensor generation:  0.015302658081054688
mini_batch_src_global generation:  0.026631593704223633
r_  generation:  0.2152843475341797
local_output_nid generation:  0.011676549911499023
local_in_edges_tensor generation:  0.015311717987060547
mini_batch_src_global generation:  0.02677774429321289
r_  generation:  0.2129065990447998
local_output_nid generation:  0.011801004409790039
local_in_edges_tensor generation:  0.011537313461303711
mini_batch_src_global generation:  0.026592493057250977
r_  generation:  0.21657943725585938
local_output_nid generation:  0.011590957641601562
local_in_edges_tensor generation:  0.013156414031982422
mini_batch_src_global generation:  0.026624441146850586
r_  generation:  0.21180963516235352
----------------------check_connections_block total spend ----------------------------- 4.955437898635864
generate_one_block  0.2788529396057129
generate_one_block  0.27077412605285645
generate_one_block  0.2912108898162842
generate_one_block  0.26804137229919434
generate_one_block  0.27077221870422363
generate_one_block  0.2688121795654297
generate_one_block  0.28777647018432617
generate_one_block  0.2628297805786133
generate_one_block  0.26888513565063477
generate_one_block  0.26891326904296875
generate_one_block  0.26505541801452637
generate_one_block  0.2795734405517578
generate_one_block  0.27729272842407227
generate_one_block  0.27420854568481445
generate_one_block  0.2740633487701416
generate_one_block  0.2684056758880615
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05067586898803711
gen group dst list time:  0.06614923477172852
time for parepare:  0.018216609954833984
local_output_nid generation:  0.024194955825805664
local_in_edges_tensor generation:  0.05390357971191406
mini_batch_src_global generation:  0.04409050941467285
r_  generation:  0.4384176731109619
local_output_nid generation:  0.029137134552001953
local_in_edges_tensor generation:  0.04472804069519043
mini_batch_src_global generation:  0.051155805587768555
r_  generation:  0.4469895362854004
local_output_nid generation:  0.02905893325805664
local_in_edges_tensor generation:  0.03272652626037598
mini_batch_src_global generation:  0.05043482780456543
r_  generation:  0.4623291492462158
local_output_nid generation:  0.029773473739624023
local_in_edges_tensor generation:  0.04103803634643555
mini_batch_src_global generation:  0.05160164833068848
r_  generation:  0.44980835914611816
local_output_nid generation:  0.02978515625
local_in_edges_tensor generation:  0.0747213363647461
mini_batch_src_global generation:  0.05115985870361328
r_  generation:  0.45385146141052246
local_output_nid generation:  0.029992103576660156
local_in_edges_tensor generation:  0.029626846313476562
mini_batch_src_global generation:  0.052118539810180664
r_  generation:  0.4526400566101074
local_output_nid generation:  0.030072450637817383
local_in_edges_tensor generation:  0.033867835998535156
mini_batch_src_global generation:  0.05208849906921387
r_  generation:  0.4588155746459961
local_output_nid generation:  0.029794931411743164
local_in_edges_tensor generation:  0.037065744400024414
mini_batch_src_global generation:  0.052120208740234375
r_  generation:  0.4537670612335205
local_output_nid generation:  0.030125141143798828
local_in_edges_tensor generation:  0.0334324836730957
mini_batch_src_global generation:  0.05150175094604492
r_  generation:  0.4630765914916992
local_output_nid generation:  0.030305862426757812
local_in_edges_tensor generation:  0.037326812744140625
mini_batch_src_global generation:  0.052962303161621094
r_  generation:  0.4544520378112793
local_output_nid generation:  0.03371405601501465
local_in_edges_tensor generation:  0.03950190544128418
mini_batch_src_global generation:  0.05223488807678223
r_  generation:  0.45914316177368164
local_output_nid generation:  0.03042888641357422
local_in_edges_tensor generation:  0.033095359802246094
mini_batch_src_global generation:  0.05222463607788086
r_  generation:  0.4560072422027588
local_output_nid generation:  0.03072214126586914
local_in_edges_tensor generation:  0.04418826103210449
mini_batch_src_global generation:  0.05329632759094238
r_  generation:  0.4838747978210449
local_output_nid generation:  0.032372236251831055
local_in_edges_tensor generation:  0.03756403923034668
mini_batch_src_global generation:  0.05504918098449707
r_  generation:  0.4592583179473877
local_output_nid generation:  0.0321044921875
local_in_edges_tensor generation:  0.03759622573852539
mini_batch_src_global generation:  0.05247235298156738
r_  generation:  0.4611380100250244
local_output_nid generation:  0.03150010108947754
local_in_edges_tensor generation:  0.03357839584350586
mini_batch_src_global generation:  0.05571746826171875
r_  generation:  0.45609092712402344
----------------------check_connections_block total spend ----------------------------- 10.854408025741577
generate_one_block  0.5785284042358398
generate_one_block  0.5768325328826904
generate_one_block  0.5822463035583496
generate_one_block  0.5971555709838867
generate_one_block  0.5718498229980469
generate_one_block  0.5877258777618408
generate_one_block  0.5902228355407715
generate_one_block  0.595076322555542
generate_one_block  0.6217899322509766
generate_one_block  0.60125732421875
generate_one_block  0.5667431354522705
generate_one_block  0.5680806636810303
generate_one_block  0.5975098609924316
generate_one_block  0.5745794773101807
generate_one_block  0.5984141826629639
generate_one_block  0.5832314491271973
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.11529397964477539  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

connection checking time:  15.809845924377441
block generation total time  13.766711235046387
average batch blocks generation time:  0.8604194521903992
block dataloader generation time/epoch 31.697219610214233
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.09397459030151367  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154475, 128])
torch.Size([122549, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1717529296875 GB
    Memory Allocated: 0.7197027206420898  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0933384895324707  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154465, 128])
torch.Size([122112, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7170519828796387  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09399890899658203  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154151, 128])
torch.Size([122114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7205257415771484  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09335708618164062  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154552, 128])
torch.Size([122521, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7166757583618164  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384441375732422  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154820, 128])
torch.Size([122558, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7177534103393555  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.0931696891784668  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154217, 128])
torch.Size([121946, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7162885665893555  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384632110595703  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154254, 128])
torch.Size([121922, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7161293029785156  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09319543838500977  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154607, 128])
torch.Size([121980, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7138075828552246  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09384727478027344  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154653, 128])
torch.Size([122507, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7169923782348633  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09360504150390625  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154868, 128])
torch.Size([123426, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7227377891540527  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09374046325683594  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154198, 128])
torch.Size([121624, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7115907669067383  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09322023391723633  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154195, 128])
torch.Size([122353, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7188453674316406  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09406471252441406  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154733, 128])
torch.Size([123295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7222800254821777  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09332990646362305  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154359, 128])
torch.Size([122180, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7179708480834961  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.093963623046875  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154311, 128])
torch.Size([122347, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7192487716674805  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.09328079223632812  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

torch.Size([154404, 128])
torch.Size([122487, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1737060546875 GB
    Memory Allocated: 0.7159104347229004  GigaBytes
Max Memory Allocated: 0.8024506568908691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.058721646666526794 |0.02045343816280365 |0.004045411944389343 |0.00010368227958679199 |0.0050780028104782104 |0.002877473831176758 |
----------------------------------------------------------pseudo_mini_loss sum 3.2537198066711426
Total (block generation + training)time/epoch 33.17131447792053
Training time/epoch 1.473813533782959
Training time without block to device /epoch 1.1465585231781006
Training time without total dataloading part /epoch 0.1505110263824463
load block tensor time/epoch 0.9395463466644287
block to device time/epoch 0.3272550106048584
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5090328
Number of first layer input nodes during this epoch:  2471262
