Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648483049.9393737
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024936676025390625
range selection method range initialization spend 0.01725625991821289
time for parepare:  0.017824172973632812
local_output_nid generation:  0.005172252655029297
local_in_edges_tensor generation:  0.005453824996948242
mini_batch_src_global generation:  0.007750749588012695
r_  generation:  0.08858466148376465
local_output_nid generation:  0.0059795379638671875
local_in_edges_tensor generation:  0.0030198097229003906
mini_batch_src_global generation:  0.008746623992919922
r_  generation:  0.08886361122131348
local_output_nid generation:  0.005994558334350586
local_in_edges_tensor generation:  0.0029747486114501953
mini_batch_src_global generation:  0.00643467903137207
r_  generation:  0.08980798721313477
local_output_nid generation:  0.006032228469848633
local_in_edges_tensor generation:  0.003044605255126953
mini_batch_src_global generation:  0.00695037841796875
r_  generation:  0.09235143661499023
----------------------check_connections_block total spend ----------------------------- 0.5170538425445557
generate_one_block  0.10056781768798828
generate_one_block  0.10115385055541992
generate_one_block  0.10322093963623047
generate_one_block  0.10185003280639648
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03772306442260742
gen group dst list time:  0.011393070220947266
time for parepare:  0.019122838973999023
local_output_nid generation:  0.014512300491333008
local_in_edges_tensor generation:  0.035086631774902344
mini_batch_src_global generation:  0.03761863708496094
r_  generation:  0.4048328399658203
local_output_nid generation:  0.021426677703857422
local_in_edges_tensor generation:  0.03708195686340332
mini_batch_src_global generation:  0.04830145835876465
r_  generation:  0.41861939430236816
local_output_nid generation:  0.022142887115478516
local_in_edges_tensor generation:  0.030268430709838867
mini_batch_src_global generation:  0.05066061019897461
r_  generation:  0.42360472679138184
local_output_nid generation:  0.02316117286682129
local_in_edges_tensor generation:  0.02632594108581543
mini_batch_src_global generation:  0.04915356636047363
r_  generation:  0.42519140243530273
----------------------check_connections_block total spend ----------------------------- 2.439626932144165
generate_one_block  0.5533089637756348
generate_one_block  0.5353422164916992
generate_one_block  0.5441122055053711
generate_one_block  0.5399160385131836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03338313102722168
gen group dst list time:  0.02096271514892578
time for parepare:  0.01874256134033203
local_output_nid generation:  0.023365020751953125
local_in_edges_tensor generation:  0.03933119773864746
mini_batch_src_global generation:  0.04843640327453613
r_  generation:  0.5285820960998535
local_output_nid generation:  0.03577089309692383
local_in_edges_tensor generation:  0.051145315170288086
mini_batch_src_global generation:  0.06020641326904297
r_  generation:  0.5367043018341064
local_output_nid generation:  0.03370547294616699
local_in_edges_tensor generation:  0.03732633590698242
mini_batch_src_global generation:  0.05575847625732422
r_  generation:  0.5475354194641113
local_output_nid generation:  0.034177303314208984
local_in_edges_tensor generation:  0.03728985786437988
mini_batch_src_global generation:  0.05648994445800781
r_  generation:  0.5535297393798828
----------------------check_connections_block total spend ----------------------------- 3.1580281257629395
generate_one_block  0.6869921684265137
generate_one_block  0.6856472492218018
generate_one_block  0.6796696186065674
generate_one_block  0.6769819259643555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025011301040649414
gen group dst list time:  0.023538827896118164
time for parepare:  0.018365144729614258
local_output_nid generation:  0.026778697967529297
local_in_edges_tensor generation:  0.035028696060180664
mini_batch_src_global generation:  0.044382333755493164
r_  generation:  0.5055217742919922
local_output_nid generation:  0.034639596939086914
local_in_edges_tensor generation:  0.05055570602416992
mini_batch_src_global generation:  0.06012988090515137
r_  generation:  0.5110502243041992
local_output_nid generation:  0.03546333312988281
local_in_edges_tensor generation:  0.03738594055175781
mini_batch_src_global generation:  0.05727577209472656
r_  generation:  0.5128026008605957
local_output_nid generation:  0.03584003448486328
local_in_edges_tensor generation:  0.03734469413757324
mini_batch_src_global generation:  0.060526132583618164
r_  generation:  0.523693323135376
----------------------check_connections_block total spend ----------------------------- 3.038224935531616
generate_one_block  0.6253032684326172
generate_one_block  0.6551668643951416
generate_one_block  0.6294231414794922
generate_one_block  0.6399896144866943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

connection checking time:  8.63587999343872
block generation total time  7.451853275299072
average batch blocks generation time:  1.862963318824768
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11632013320922852  GigaBytes
Max Memory Allocated: 0.11632013320922852  GigaBytes

torch.Size([166739, 128])
torch.Size([164821, 128])
torch.Size([155138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 1.018803596496582  GigaBytes
Max Memory Allocated: 1.0587058067321777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.12015390396118164  GigaBytes
Max Memory Allocated: 1.1145868301391602  GigaBytes

torch.Size([166633, 128])
torch.Size([164664, 128])
torch.Size([154996, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.019007682800293  GigaBytes
Max Memory Allocated: 1.1145868301391602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.12113428115844727  GigaBytes
Max Memory Allocated: 1.1146659851074219  GigaBytes

torch.Size([166657, 128])
torch.Size([164696, 128])
torch.Size([154925, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.020108699798584  GigaBytes
Max Memory Allocated: 1.1146659851074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.12158584594726562  GigaBytes
Max Memory Allocated: 1.1158452033996582  GigaBytes

torch.Size([166671, 128])
torch.Size([164645, 128])
torch.Size([154851, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.020362377166748  GigaBytes
Max Memory Allocated: 1.1158452033996582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06201624870300293 |0.08817183971405029 |0.17907410860061646 |0.0001214146614074707 |0.017845571041107178 |0.004842042922973633 |
----------------------------------------------------------pseudo_mini_loss sum 5.732250690460205
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351099
Number of first layer input nodes during this epoch:  666700
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.18709278106689453  GigaBytes
Max Memory Allocated: 1.115880012512207  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.019168853759765625
range selection method range initialization spend 0.01178598403930664
time for parepare:  0.017288923263549805
local_output_nid generation:  0.005112171173095703
local_in_edges_tensor generation:  0.006195068359375
mini_batch_src_global generation:  0.006607770919799805
r_  generation:  0.08079099655151367
local_output_nid generation:  0.006071805953979492
local_in_edges_tensor generation:  0.003016233444213867
mini_batch_src_global generation:  0.008502006530761719
r_  generation:  0.08685588836669922
local_output_nid generation:  0.006063699722290039
local_in_edges_tensor generation:  0.0030455589294433594
mini_batch_src_global generation:  0.0064313411712646484
r_  generation:  0.08954906463623047
local_output_nid generation:  0.006167888641357422
local_in_edges_tensor generation:  0.0030052661895751953
mini_batch_src_global generation:  0.006839752197265625
r_  generation:  0.09079694747924805
----------------------check_connections_block total spend ----------------------------- 0.5034289360046387
generate_one_block  0.09986329078674316
generate_one_block  0.10226178169250488
generate_one_block  0.10236287117004395
generate_one_block  0.1025855541229248
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04032301902770996
gen group dst list time:  0.01107335090637207
time for parepare:  0.019164562225341797
local_output_nid generation:  0.014459848403930664
local_in_edges_tensor generation:  0.03836679458618164
mini_batch_src_global generation:  0.03891301155090332
r_  generation:  0.4054396152496338
local_output_nid generation:  0.02187943458557129
local_in_edges_tensor generation:  0.03806638717651367
mini_batch_src_global generation:  0.04830431938171387
r_  generation:  0.4223928451538086
local_output_nid generation:  0.022565841674804688
local_in_edges_tensor generation:  0.03129005432128906
mini_batch_src_global generation:  0.04830288887023926
r_  generation:  0.42099499702453613
local_output_nid generation:  0.022953033447265625
local_in_edges_tensor generation:  0.027518272399902344
mini_batch_src_global generation:  0.04974055290222168
r_  generation:  0.43005847930908203
----------------------check_connections_block total spend ----------------------------- 2.4610440731048584
generate_one_block  0.5497922897338867
generate_one_block  0.5442523956298828
generate_one_block  0.5560920238494873
generate_one_block  0.5372154712677002
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038877010345458984
gen group dst list time:  0.020928382873535156
time for parepare:  0.018756628036499023
local_output_nid generation:  0.023910045623779297
local_in_edges_tensor generation:  0.041899681091308594
mini_batch_src_global generation:  0.0492405891418457
r_  generation:  0.5295696258544922
local_output_nid generation:  0.032647132873535156
local_in_edges_tensor generation:  0.05243372917175293
mini_batch_src_global generation:  0.06090211868286133
r_  generation:  0.5456061363220215
local_output_nid generation:  0.03329133987426758
local_in_edges_tensor generation:  0.04846477508544922
mini_batch_src_global generation:  0.05645251274108887
r_  generation:  0.552238941192627
local_output_nid generation:  0.033562421798706055
local_in_edges_tensor generation:  0.04856514930725098
mini_batch_src_global generation:  0.05526089668273926
r_  generation:  0.552844762802124
----------------------check_connections_block total spend ----------------------------- 3.194791078567505
generate_one_block  0.674760103225708
generate_one_block  0.6697266101837158
generate_one_block  0.6853840351104736
generate_one_block  0.6927130222320557
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022992372512817383
gen group dst list time:  0.023383617401123047
time for parepare:  0.018665552139282227
local_output_nid generation:  0.02684307098388672
local_in_edges_tensor generation:  0.035558223724365234
mini_batch_src_global generation:  0.04488563537597656
r_  generation:  0.513573169708252
local_output_nid generation:  0.035178184509277344
local_in_edges_tensor generation:  0.03630995750427246
mini_batch_src_global generation:  0.056606292724609375
r_  generation:  0.5144362449645996
local_output_nid generation:  0.03627824783325195
local_in_edges_tensor generation:  0.040184736251831055
mini_batch_src_global generation:  0.05748414993286133
r_  generation:  0.5113120079040527
local_output_nid generation:  0.03608417510986328
local_in_edges_tensor generation:  0.03748059272766113
mini_batch_src_global generation:  0.056847572326660156
r_  generation:  0.5131328105926514
----------------------check_connections_block total spend ----------------------------- 3.023487091064453
generate_one_block  0.6405148506164551
generate_one_block  0.6448972225189209
generate_one_block  0.6373188495635986
generate_one_block  0.6641819477081299
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.18709278106689453  GigaBytes
Max Memory Allocated: 1.115880012512207  GigaBytes

connection checking time:  8.679322242736816
block generation total time  7.496848821640015
average batch blocks generation time:  1.8742122054100037
block dataloader generation time/epoch 18.117702960968018
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 0.1219487190246582  GigaBytes
Max Memory Allocated: 1.115880012512207  GigaBytes

torch.Size([166683, 128])
torch.Size([164670, 128])
torch.Size([154930, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.020895004272461  GigaBytes
Max Memory Allocated: 1.115880012512207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.12240457534790039  GigaBytes
Max Memory Allocated: 1.1166667938232422  GigaBytes

torch.Size([166709, 128])
torch.Size([164783, 128])
torch.Size([155003, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.0215039253234863  GigaBytes
Max Memory Allocated: 1.1166667938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.12194967269897461  GigaBytes
Max Memory Allocated: 1.1170473098754883  GigaBytes

torch.Size([166726, 128])
torch.Size([164750, 128])
torch.Size([155081, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.0209112167358398  GigaBytes
Max Memory Allocated: 1.1170473098754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 0.12140321731567383  GigaBytes
Max Memory Allocated: 1.1170473098754883  GigaBytes

torch.Size([166698, 128])
torch.Size([164804, 128])
torch.Size([155168, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7752685546875 GB
    Memory Allocated: 1.0204849243164062  GigaBytes
Max Memory Allocated: 1.1170473098754883  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07651251554489136 |0.026811957359313965 |0.004471480846405029 |8.988380432128906e-05 |0.0049904584884643555 |0.003869771957397461 |
----------------------------------------------------------pseudo_mini_loss sum 3.732509136199951
Total (block generation + training)time/epoch 18.631070852279663
Training time/epoch 0.5132043361663818
Training time without block to device /epoch 0.405956506729126
Training time without total dataloading part /epoch 0.042077064514160156
load block tensor time/epoch 0.30605006217956543
block to device time/epoch 0.10724782943725586
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2350918
Number of first layer input nodes during this epoch:  666816
