Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648483095.7701406
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02394556999206543
range selection method range initialization spend 0.013850212097167969
time for parepare:  0.01783585548400879
local_output_nid generation:  0.0026710033416748047
local_in_edges_tensor generation:  0.004441261291503906
mini_batch_src_global generation:  0.003487825393676758
r_  generation:  0.03854227066040039
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0016510486602783203
mini_batch_src_global generation:  0.004264116287231445
r_  generation:  0.03853631019592285
local_output_nid generation:  0.003103017807006836
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.0026922225952148438
r_  generation:  0.039603233337402344
local_output_nid generation:  0.0030875205993652344
local_in_edges_tensor generation:  0.001638650894165039
mini_batch_src_global generation:  0.002847909927368164
r_  generation:  0.04012894630432129
local_output_nid generation:  0.0030977725982666016
local_in_edges_tensor generation:  0.0016393661499023438
mini_batch_src_global generation:  0.0029497146606445312
r_  generation:  0.04074287414550781
local_output_nid generation:  0.0031003952026367188
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.0031621456146240234
r_  generation:  0.0428311824798584
local_output_nid generation:  0.003137826919555664
local_in_edges_tensor generation:  0.0016360282897949219
mini_batch_src_global generation:  0.0031740665435791016
r_  generation:  0.04207897186279297
local_output_nid generation:  0.003159761428833008
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.00319671630859375
r_  generation:  0.04150032997131348
----------------------check_connections_block total spend ----------------------------- 0.47783732414245605
generate_one_block  0.05518484115600586
generate_one_block  0.05481696128845215
generate_one_block  0.055498600006103516
generate_one_block  0.05492854118347168
generate_one_block  0.05620455741882324
generate_one_block  0.05610299110412598
generate_one_block  0.05533313751220703
generate_one_block  0.05494070053100586
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04011225700378418
gen group dst list time:  0.015615224838256836
time for parepare:  0.019147396087646484
local_output_nid generation:  0.010741710662841797
local_in_edges_tensor generation:  0.02655506134033203
mini_batch_src_global generation:  0.028543949127197266
r_  generation:  0.30059099197387695
local_output_nid generation:  0.0157620906829834
local_in_edges_tensor generation:  0.02834177017211914
mini_batch_src_global generation:  0.03618454933166504
r_  generation:  0.3064305782318115
local_output_nid generation:  0.01617598533630371
local_in_edges_tensor generation:  0.02067089080810547
mini_batch_src_global generation:  0.03839397430419922
r_  generation:  0.3134453296661377
local_output_nid generation:  0.016332387924194336
local_in_edges_tensor generation:  0.024623870849609375
mini_batch_src_global generation:  0.03764939308166504
r_  generation:  0.3175036907196045
local_output_nid generation:  0.01645803451538086
local_in_edges_tensor generation:  0.018729686737060547
mini_batch_src_global generation:  0.038729190826416016
r_  generation:  0.31531524658203125
local_output_nid generation:  0.01689887046813965
local_in_edges_tensor generation:  0.024588823318481445
mini_batch_src_global generation:  0.03868675231933594
r_  generation:  0.32773590087890625
local_output_nid generation:  0.01675701141357422
local_in_edges_tensor generation:  0.027762413024902344
mini_batch_src_global generation:  0.03849673271179199
r_  generation:  0.3238370418548584
local_output_nid generation:  0.01812887191772461
local_in_edges_tensor generation:  0.033835649490356445
mini_batch_src_global generation:  0.042844533920288086
r_  generation:  0.3295934200286865
----------------------check_connections_block total spend ----------------------------- 3.763651132583618
generate_one_block  0.4239203929901123
generate_one_block  0.40573811531066895
generate_one_block  0.41142821311950684
generate_one_block  0.4144752025604248
generate_one_block  0.4044766426086426
generate_one_block  0.4553558826446533
generate_one_block  0.40436434745788574
generate_one_block  0.4089934825897217
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051197052001953125
gen group dst list time:  0.03643345832824707
time for parepare:  0.019405364990234375
local_output_nid generation:  0.02547001838684082
local_in_edges_tensor generation:  0.06379818916320801
mini_batch_src_global generation:  0.04915642738342285
r_  generation:  0.5269291400909424
local_output_nid generation:  0.031919002532958984
local_in_edges_tensor generation:  0.05356621742248535
mini_batch_src_global generation:  0.06007647514343262
r_  generation:  0.549854040145874
local_output_nid generation:  0.03686785697937012
local_in_edges_tensor generation:  0.051668405532836914
mini_batch_src_global generation:  0.06482219696044922
r_  generation:  0.5313894748687744
local_output_nid generation:  0.03408694267272949
local_in_edges_tensor generation:  0.04333162307739258
mini_batch_src_global generation:  0.05884838104248047
r_  generation:  0.5202267169952393
local_output_nid generation:  0.034533023834228516
local_in_edges_tensor generation:  0.03526473045349121
mini_batch_src_global generation:  0.05844473838806152
r_  generation:  0.5351850986480713
local_output_nid generation:  0.0348210334777832
local_in_edges_tensor generation:  0.04274344444274902
mini_batch_src_global generation:  0.05985569953918457
r_  generation:  0.5298659801483154
local_output_nid generation:  0.03481030464172363
local_in_edges_tensor generation:  0.04711127281188965
mini_batch_src_global generation:  0.05703282356262207
r_  generation:  0.5479409694671631
local_output_nid generation:  0.03481864929199219
local_in_edges_tensor generation:  0.04005098342895508
mini_batch_src_global generation:  0.061453819274902344
r_  generation:  0.5556857585906982
----------------------check_connections_block total spend ----------------------------- 6.3994598388671875
generate_one_block  0.6932690143585205
generate_one_block  0.6681206226348877
generate_one_block  0.6664283275604248
generate_one_block  0.6822266578674316
generate_one_block  0.6509151458740234
generate_one_block  0.6957159042358398
generate_one_block  0.6928369998931885
generate_one_block  0.6625099182128906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04905438423156738
gen group dst list time:  0.04821062088012695
time for parepare:  0.01948070526123047
local_output_nid generation:  0.03103494644165039
local_in_edges_tensor generation:  0.06010580062866211
mini_batch_src_global generation:  0.04852724075317383
r_  generation:  0.5023655891418457
local_output_nid generation:  0.03925967216491699
local_in_edges_tensor generation:  0.04707694053649902
mini_batch_src_global generation:  0.05873537063598633
r_  generation:  0.5157384872436523
local_output_nid generation:  0.03805255889892578
local_in_edges_tensor generation:  0.04337906837463379
mini_batch_src_global generation:  0.05623030662536621
r_  generation:  0.5037193298339844
local_output_nid generation:  0.04293417930603027
local_in_edges_tensor generation:  0.03575587272644043
mini_batch_src_global generation:  0.05407381057739258
r_  generation:  0.5128123760223389
local_output_nid generation:  0.03848600387573242
local_in_edges_tensor generation:  0.03720259666442871
mini_batch_src_global generation:  0.05434536933898926
r_  generation:  0.5104525089263916
local_output_nid generation:  0.038455963134765625
local_in_edges_tensor generation:  0.04455256462097168
mini_batch_src_global generation:  0.054045915603637695
r_  generation:  0.5173165798187256
local_output_nid generation:  0.03869318962097168
local_in_edges_tensor generation:  0.039754629135131836
mini_batch_src_global generation:  0.0576479434967041
r_  generation:  0.5187828540802002
local_output_nid generation:  0.03895235061645508
local_in_edges_tensor generation:  0.039481401443481445
mini_batch_src_global generation:  0.05356860160827637
r_  generation:  0.5237295627593994
----------------------check_connections_block total spend ----------------------------- 6.163470268249512
generate_one_block  0.6639275550842285
generate_one_block  0.6446692943572998
generate_one_block  0.6608588695526123
generate_one_block  0.6480979919433594
generate_one_block  0.6426284313201904
generate_one_block  0.6449387073516846
generate_one_block  0.6965749263763428
generate_one_block  0.6230764389038086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

connection checking time:  16.326581239700317
block generation total time  13.96554708480835
average batch blocks generation time:  1.7456933856010437
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11150169372558594  GigaBytes
Max Memory Allocated: 0.11150169372558594  GigaBytes

torch.Size([165513, 128])
torch.Size([161178, 128])
torch.Size([142341, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3123779296875 GB
    Memory Allocated: 0.907534122467041  GigaBytes
Max Memory Allocated: 0.9364171028137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11371517181396484  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165469, 128])
torch.Size([161122, 128])
torch.Size([141786, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9052653312683105  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11441707611083984  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165480, 128])
torch.Size([161193, 128])
torch.Size([142196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9081683158874512  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11378860473632812  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165367, 128])
torch.Size([160950, 128])
torch.Size([141906, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9065537452697754  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11335897445678711  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165507, 128])
torch.Size([161121, 128])
torch.Size([141796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9042119979858398  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11397409439086914  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165434, 128])
torch.Size([161179, 128])
torch.Size([142192, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9073476791381836  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11385440826416016  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165573, 128])
torch.Size([161323, 128])
torch.Size([142143, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9077138900756836  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11349105834960938  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165476, 128])
torch.Size([161002, 128])
torch.Size([141737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.906531810760498  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05527058243751526 |0.06642740964889526 |0.09616047143936157 |0.00010469555854797363 |0.0199928879737854 |0.00508570671081543 |
----------------------------------------------------------pseudo_mini_loss sum 5.8074421882629395
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292406
Number of first layer input nodes during this epoch:  1323819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.17061805725097656  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.020785808563232422
range selection method range initialization spend 0.011515378952026367
time for parepare:  0.01675105094909668
local_output_nid generation:  0.0027158260345458984
local_in_edges_tensor generation:  0.006923675537109375
mini_batch_src_global generation:  0.0033185482025146484
r_  generation:  0.038923025131225586
local_output_nid generation:  0.0031578540802001953
local_in_edges_tensor generation:  0.0016448497772216797
mini_batch_src_global generation:  0.004048585891723633
r_  generation:  0.03922414779663086
local_output_nid generation:  0.0031626224517822266
local_in_edges_tensor generation:  0.0016341209411621094
mini_batch_src_global generation:  0.002766132354736328
r_  generation:  0.04305672645568848
local_output_nid generation:  0.0031538009643554688
local_in_edges_tensor generation:  0.0015876293182373047
mini_batch_src_global generation:  0.002870798110961914
r_  generation:  0.04030346870422363
local_output_nid generation:  0.0031108856201171875
local_in_edges_tensor generation:  0.0015954971313476562
mini_batch_src_global generation:  0.0028874874114990234
r_  generation:  0.040719032287597656
local_output_nid generation:  0.003100872039794922
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.003116130828857422
r_  generation:  0.0414276123046875
local_output_nid generation:  0.0030808448791503906
local_in_edges_tensor generation:  0.0016429424285888672
mini_batch_src_global generation:  0.0031423568725585938
r_  generation:  0.041219472885131836
local_output_nid generation:  0.003117084503173828
local_in_edges_tensor generation:  0.0015823841094970703
mini_batch_src_global generation:  0.0031290054321289062
r_  generation:  0.041043758392333984
----------------------check_connections_block total spend ----------------------------- 0.4804041385650635
generate_one_block  0.05688643455505371
generate_one_block  0.05401611328125
generate_one_block  0.05454826354980469
generate_one_block  0.05638456344604492
generate_one_block  0.054071903228759766
generate_one_block  0.05760073661804199
generate_one_block  0.057473182678222656
generate_one_block  0.05379343032836914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04095792770385742
gen group dst list time:  0.014650821685791016
time for parepare:  0.02374100685119629
local_output_nid generation:  0.011564493179321289
local_in_edges_tensor generation:  0.046004295349121094
mini_batch_src_global generation:  0.029523849487304688
r_  generation:  0.3108208179473877
local_output_nid generation:  0.01814866065979004
local_in_edges_tensor generation:  0.030722618103027344
mini_batch_src_global generation:  0.03704500198364258
r_  generation:  0.3104691505432129
local_output_nid generation:  0.016727685928344727
local_in_edges_tensor generation:  0.023891687393188477
mini_batch_src_global generation:  0.03633856773376465
r_  generation:  0.3145604133605957
local_output_nid generation:  0.016680002212524414
local_in_edges_tensor generation:  0.017963647842407227
mini_batch_src_global generation:  0.036971092224121094
r_  generation:  0.3267691135406494
local_output_nid generation:  0.016942739486694336
local_in_edges_tensor generation:  0.01992034912109375
mini_batch_src_global generation:  0.03784608840942383
r_  generation:  0.3188009262084961
local_output_nid generation:  0.017302513122558594
local_in_edges_tensor generation:  0.02908921241760254
mini_batch_src_global generation:  0.0385594367980957
r_  generation:  0.325819730758667
local_output_nid generation:  0.017433643341064453
local_in_edges_tensor generation:  0.02420949935913086
mini_batch_src_global generation:  0.038309335708618164
r_  generation:  0.3234236240386963
local_output_nid generation:  0.018024206161499023
local_in_edges_tensor generation:  0.02156805992126465
mini_batch_src_global generation:  0.038788557052612305
r_  generation:  0.33243894577026367
----------------------check_connections_block total spend ----------------------------- 3.8066861629486084
generate_one_block  0.4231274127960205
generate_one_block  0.4224064350128174
generate_one_block  0.4244699478149414
generate_one_block  0.4059879779815674
generate_one_block  0.4191734790802002
generate_one_block  0.41164207458496094
generate_one_block  0.4163033962249756
generate_one_block  0.4230830669403076
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04636216163635254
gen group dst list time:  0.03644156455993652
time for parepare:  0.019469261169433594
local_output_nid generation:  0.02610325813293457
local_in_edges_tensor generation:  0.0539088249206543
mini_batch_src_global generation:  0.0479891300201416
r_  generation:  0.5111970901489258
local_output_nid generation:  0.032622337341308594
local_in_edges_tensor generation:  0.05031442642211914
mini_batch_src_global generation:  0.05913496017456055
r_  generation:  0.5207304954528809
local_output_nid generation:  0.03372812271118164
local_in_edges_tensor generation:  0.04309535026550293
mini_batch_src_global generation:  0.05550026893615723
r_  generation:  0.539729118347168
local_output_nid generation:  0.034793853759765625
local_in_edges_tensor generation:  0.05073881149291992
mini_batch_src_global generation:  0.06149578094482422
r_  generation:  0.5438323020935059
local_output_nid generation:  0.03795766830444336
local_in_edges_tensor generation:  0.0403597354888916
mini_batch_src_global generation:  0.06611037254333496
r_  generation:  0.5361812114715576
local_output_nid generation:  0.03620028495788574
local_in_edges_tensor generation:  0.03706479072570801
mini_batch_src_global generation:  0.06148791313171387
r_  generation:  0.5235519409179688
local_output_nid generation:  0.03548097610473633
local_in_edges_tensor generation:  0.04259967803955078
mini_batch_src_global generation:  0.05773138999938965
r_  generation:  0.5476946830749512
local_output_nid generation:  0.03586554527282715
local_in_edges_tensor generation:  0.032802581787109375
mini_batch_src_global generation:  0.059529781341552734
r_  generation:  0.5288879871368408
----------------------check_connections_block total spend ----------------------------- 6.30427622795105
generate_one_block  0.6607542037963867
generate_one_block  0.6731209754943848
generate_one_block  0.6656291484832764
generate_one_block  0.6586766242980957
generate_one_block  0.6668858528137207
generate_one_block  0.66507887840271
generate_one_block  0.6652352809906006
generate_one_block  0.6565737724304199
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03748440742492676
gen group dst list time:  0.052564144134521484
time for parepare:  0.02001047134399414
local_output_nid generation:  0.03251504898071289
local_in_edges_tensor generation:  0.04560279846191406
mini_batch_src_global generation:  0.06139254570007324
r_  generation:  0.548372745513916
local_output_nid generation:  0.03831648826599121
local_in_edges_tensor generation:  0.05728578567504883
mini_batch_src_global generation:  0.06728172302246094
r_  generation:  0.5088984966278076
local_output_nid generation:  0.03933906555175781
local_in_edges_tensor generation:  0.04643702507019043
mini_batch_src_global generation:  0.062357425689697266
r_  generation:  0.5314099788665771
local_output_nid generation:  0.042212724685668945
local_in_edges_tensor generation:  0.03842496871948242
mini_batch_src_global generation:  0.056197166442871094
r_  generation:  0.5256764888763428
local_output_nid generation:  0.03915905952453613
local_in_edges_tensor generation:  0.04417276382446289
mini_batch_src_global generation:  0.05483889579772949
r_  generation:  0.5247375965118408
local_output_nid generation:  0.043854713439941406
local_in_edges_tensor generation:  0.04160475730895996
mini_batch_src_global generation:  0.0550229549407959
r_  generation:  0.5151309967041016
local_output_nid generation:  0.03999805450439453
local_in_edges_tensor generation:  0.0393221378326416
mini_batch_src_global generation:  0.05900454521179199
r_  generation:  0.5362257957458496
local_output_nid generation:  0.041684627532958984
local_in_edges_tensor generation:  0.043148040771484375
mini_batch_src_global generation:  0.05965018272399902
r_  generation:  0.5384883880615234
----------------------check_connections_block total spend ----------------------------- 6.446502447128296
generate_one_block  0.6453211307525635
generate_one_block  0.6512634754180908
generate_one_block  0.6582803726196289
generate_one_block  0.6420729160308838
generate_one_block  0.6471216678619385
generate_one_block  0.6302871704101562
generate_one_block  0.6473190784454346
generate_one_block  0.6311876773834229
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.17061805725097656  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

connection checking time:  16.557464838027954
block generation total time  13.811002016067505
average batch blocks generation time:  1.726375252008438
block dataloader generation time/epoch 32.613215923309326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.11474227905273438  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165579, 128])
torch.Size([161290, 128])
torch.Size([142323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.9079627990722656  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11473894119262695  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165578, 128])
torch.Size([161211, 128])
torch.Size([141921, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9082474708557129  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11439228057861328  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165574, 128])
torch.Size([161231, 128])
torch.Size([142017, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9080877304077148  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11467933654785156  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165661, 128])
torch.Size([161294, 128])
torch.Size([141716, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9047751426696777  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11463737487792969  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165607, 128])
torch.Size([161306, 128])
torch.Size([141912, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9060945510864258  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11436080932617188  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165540, 128])
torch.Size([161122, 128])
torch.Size([141933, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9081435203552246  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11476325988769531  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165619, 128])
torch.Size([161440, 128])
torch.Size([142435, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9083771705627441  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.11454296112060547  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

torch.Size([165489, 128])
torch.Size([161205, 128])
torch.Size([141830, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7440185546875 GB
    Memory Allocated: 0.9063205718994141  GigaBytes
Max Memory Allocated: 0.9733061790466309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06424510478973389 |0.027465730905532837 |0.0048933327198028564 |9.211897850036621e-05 |0.009692192077636719 |0.0022084712982177734 |
----------------------------------------------------------pseudo_mini_loss sum 3.766709089279175
Total (block generation + training)time/epoch 33.52370476722717
Training time/epoch 0.9101858139038086
Training time without block to device /epoch 0.6904599666595459
Training time without total dataloading part /epoch 0.1196296215057373
load block tensor time/epoch 0.5139608383178711
block to device time/epoch 0.2197258472442627
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4293081
Number of first layer input nodes during this epoch:  1324647
