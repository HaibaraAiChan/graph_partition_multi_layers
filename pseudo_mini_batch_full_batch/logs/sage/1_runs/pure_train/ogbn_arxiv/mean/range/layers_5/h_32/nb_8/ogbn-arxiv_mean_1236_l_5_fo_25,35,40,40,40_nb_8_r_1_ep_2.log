Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648495827.658902
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02516484260559082
range selection method range initialization spend 0.013324260711669922
time for parepare:  0.017882108688354492
local_output_nid generation:  0.002611398696899414
local_in_edges_tensor generation:  0.004538536071777344
mini_batch_src_global generation:  0.003297090530395508
r_  generation:  0.03774070739746094
local_output_nid generation:  0.0030202865600585938
local_in_edges_tensor generation:  0.0016531944274902344
mini_batch_src_global generation:  0.004180431365966797
r_  generation:  0.03937053680419922
local_output_nid generation:  0.0030765533447265625
local_in_edges_tensor generation:  0.0016350746154785156
mini_batch_src_global generation:  0.0027670860290527344
r_  generation:  0.039606332778930664
local_output_nid generation:  0.003092527389526367
local_in_edges_tensor generation:  0.001687765121459961
mini_batch_src_global generation:  0.002815723419189453
r_  generation:  0.03970479965209961
local_output_nid generation:  0.003160715103149414
local_in_edges_tensor generation:  0.0016074180603027344
mini_batch_src_global generation:  0.0029397010803222656
r_  generation:  0.04123830795288086
local_output_nid generation:  0.0031440258026123047
local_in_edges_tensor generation:  0.0016782283782958984
mini_batch_src_global generation:  0.003037691116333008
r_  generation:  0.04054760932922363
local_output_nid generation:  0.0030999183654785156
local_in_edges_tensor generation:  0.0016455650329589844
mini_batch_src_global generation:  0.003031015396118164
r_  generation:  0.04043936729431152
local_output_nid generation:  0.0031316280364990234
local_in_edges_tensor generation:  0.0016112327575683594
mini_batch_src_global generation:  0.002997875213623047
r_  generation:  0.04137277603149414
----------------------check_connections_block total spend ----------------------------- 0.4697709083557129
generate_one_block  0.053495168685913086
generate_one_block  0.055373191833496094
generate_one_block  0.05548834800720215
generate_one_block  0.054555654525756836
generate_one_block  0.05714154243469238
generate_one_block  0.054349422454833984
generate_one_block  0.05421018600463867
generate_one_block  0.05442380905151367
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04185819625854492
gen group dst list time:  0.01511383056640625
time for parepare:  0.019396305084228516
local_output_nid generation:  0.010600805282592773
local_in_edges_tensor generation:  0.031087875366210938
mini_batch_src_global generation:  0.02776646614074707
r_  generation:  0.29816532135009766
local_output_nid generation:  0.01604151725769043
local_in_edges_tensor generation:  0.02777862548828125
mini_batch_src_global generation:  0.038750410079956055
r_  generation:  0.32672739028930664
local_output_nid generation:  0.016280412673950195
local_in_edges_tensor generation:  0.023718595504760742
mini_batch_src_global generation:  0.04873919486999512
r_  generation:  0.32842040061950684
local_output_nid generation:  0.01628279685974121
local_in_edges_tensor generation:  0.018239974975585938
mini_batch_src_global generation:  0.03770732879638672
r_  generation:  0.3202993869781494
local_output_nid generation:  0.016858816146850586
local_in_edges_tensor generation:  0.020470380783081055
mini_batch_src_global generation:  0.04022073745727539
r_  generation:  0.32407474517822266
local_output_nid generation:  0.01679539680480957
local_in_edges_tensor generation:  0.018236637115478516
mini_batch_src_global generation:  0.038610219955444336
r_  generation:  0.3308982849121094
local_output_nid generation:  0.016910314559936523
local_in_edges_tensor generation:  0.020869970321655273
mini_batch_src_global generation:  0.038548946380615234
r_  generation:  0.3288850784301758
local_output_nid generation:  0.016985416412353516
local_in_edges_tensor generation:  0.021443843841552734
mini_batch_src_global generation:  0.03838849067687988
r_  generation:  0.32262206077575684
----------------------check_connections_block total spend ----------------------------- 3.7537176609039307
generate_one_block  0.4049801826477051
generate_one_block  0.4118077754974365
generate_one_block  0.4191100597381592
generate_one_block  0.39687061309814453
generate_one_block  0.4067819118499756
generate_one_block  0.42150402069091797
generate_one_block  0.40416669845581055
generate_one_block  0.4067387580871582
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03703451156616211
gen group dst list time:  0.03557562828063965
time for parepare:  0.019058704376220703
local_output_nid generation:  0.02478957176208496
local_in_edges_tensor generation:  0.0422208309173584
mini_batch_src_global generation:  0.0500948429107666
r_  generation:  0.5473251342773438
local_output_nid generation:  0.03211069107055664
local_in_edges_tensor generation:  0.04964113235473633
mini_batch_src_global generation:  0.06144833564758301
r_  generation:  0.5477604866027832
local_output_nid generation:  0.03309035301208496
local_in_edges_tensor generation:  0.047654151916503906
mini_batch_src_global generation:  0.059710025787353516
r_  generation:  0.5552186965942383
local_output_nid generation:  0.03410696983337402
local_in_edges_tensor generation:  0.05063605308532715
mini_batch_src_global generation:  0.06365466117858887
r_  generation:  0.5462312698364258
local_output_nid generation:  0.03428149223327637
local_in_edges_tensor generation:  0.04415440559387207
mini_batch_src_global generation:  0.06282329559326172
r_  generation:  0.5541393756866455
local_output_nid generation:  0.033890485763549805
local_in_edges_tensor generation:  0.04103899002075195
mini_batch_src_global generation:  0.06083846092224121
r_  generation:  0.5625138282775879
local_output_nid generation:  0.03615880012512207
local_in_edges_tensor generation:  0.03696584701538086
mini_batch_src_global generation:  0.06449413299560547
r_  generation:  0.5610418319702148
local_output_nid generation:  0.03420901298522949
local_in_edges_tensor generation:  0.036104440689086914
mini_batch_src_global generation:  0.061490774154663086
r_  generation:  0.5570507049560547
----------------------check_connections_block total spend ----------------------------- 6.50551962852478
generate_one_block  0.6826884746551514
generate_one_block  0.6934752464294434
generate_one_block  0.6918351650238037
generate_one_block  0.6650505065917969
generate_one_block  0.6669845581054688
generate_one_block  0.7257578372955322
generate_one_block  0.6898715496063232
generate_one_block  0.6885280609130859
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05296444892883301
gen group dst list time:  0.044812679290771484
time for parepare:  0.019091129302978516
local_output_nid generation:  0.030080080032348633
local_in_edges_tensor generation:  0.06428837776184082
mini_batch_src_global generation:  0.05442404747009277
r_  generation:  0.5397326946258545
local_output_nid generation:  0.03644108772277832
local_in_edges_tensor generation:  0.05568552017211914
mini_batch_src_global generation:  0.06167316436767578
r_  generation:  0.5580558776855469
local_output_nid generation:  0.03709840774536133
local_in_edges_tensor generation:  0.046911001205444336
mini_batch_src_global generation:  0.06190299987792969
r_  generation:  0.562049150466919
local_output_nid generation:  0.03715395927429199
local_in_edges_tensor generation:  0.042691946029663086
mini_batch_src_global generation:  0.06000256538391113
r_  generation:  0.5640194416046143
local_output_nid generation:  0.03774595260620117
local_in_edges_tensor generation:  0.041532278060913086
mini_batch_src_global generation:  0.06289935111999512
r_  generation:  0.5540683269500732
local_output_nid generation:  0.03740549087524414
local_in_edges_tensor generation:  0.04917287826538086
mini_batch_src_global generation:  0.059571027755737305
r_  generation:  0.5551574230194092
local_output_nid generation:  0.04184460639953613
local_in_edges_tensor generation:  0.041718482971191406
mini_batch_src_global generation:  0.05948591232299805
r_  generation:  0.5625360012054443
local_output_nid generation:  0.03750157356262207
local_in_edges_tensor generation:  0.037297725677490234
mini_batch_src_global generation:  0.05940818786621094
r_  generation:  0.571319580078125
----------------------check_connections_block total spend ----------------------------- 6.636027574539185
generate_one_block  0.6849875450134277
generate_one_block  0.7195477485656738
generate_one_block  0.7073731422424316
generate_one_block  0.6886968612670898
generate_one_block  0.7045276165008545
generate_one_block  0.708294153213501
generate_one_block  0.7499690055847168
generate_one_block  0.7030487060546875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06405282020568848
gen group dst list time:  0.050473690032958984
time for parepare:  0.019339799880981445
local_output_nid generation:  0.03206944465637207
local_in_edges_tensor generation:  0.06988358497619629
mini_batch_src_global generation:  0.04832768440246582
r_  generation:  0.5187361240386963
local_output_nid generation:  0.03794598579406738
local_in_edges_tensor generation:  0.04008173942565918
mini_batch_src_global generation:  0.06626558303833008
r_  generation:  0.5300085544586182
local_output_nid generation:  0.03800630569458008
local_in_edges_tensor generation:  0.03423166275024414
mini_batch_src_global generation:  0.06126546859741211
r_  generation:  0.514782190322876
local_output_nid generation:  0.03834390640258789
local_in_edges_tensor generation:  0.03674030303955078
mini_batch_src_global generation:  0.06048107147216797
r_  generation:  0.5279481410980225
local_output_nid generation:  0.038611650466918945
local_in_edges_tensor generation:  0.03460192680358887
mini_batch_src_global generation:  0.06130814552307129
r_  generation:  0.5272011756896973
local_output_nid generation:  0.038694143295288086
local_in_edges_tensor generation:  0.03975534439086914
mini_batch_src_global generation:  0.05970311164855957
r_  generation:  0.5277493000030518
local_output_nid generation:  0.03825783729553223
local_in_edges_tensor generation:  0.04110550880432129
mini_batch_src_global generation:  0.05855727195739746
r_  generation:  0.5157477855682373
local_output_nid generation:  0.0386505126953125
local_in_edges_tensor generation:  0.041200876235961914
mini_batch_src_global generation:  0.057477474212646484
r_  generation:  0.531611442565918
----------------------check_connections_block total spend ----------------------------- 6.274551630020142
generate_one_block  0.6344246864318848
generate_one_block  0.6426999568939209
generate_one_block  0.6524102687835693
generate_one_block  0.6478207111358643
generate_one_block  0.6502745151519775
generate_one_block  0.6387925148010254
generate_one_block  0.6374950408935547
generate_one_block  0.6816573143005371
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

connection checking time:  23.169816493988037
block generation total time  19.62817120552063
average batch blocks generation time:  2.4535214006900787
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12581872940063477  GigaBytes
Max Memory Allocated: 0.12581872940063477  GigaBytes

torch.Size([166968, 128])
torch.Size([165769, 32])
torch.Size([161409, 32])
torch.Size([142150, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.4371147155761719  GigaBytes
Max Memory Allocated: 0.4402894973754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.12729310989379883  GigaBytes
Max Memory Allocated: 0.45191526412963867  GigaBytes

torch.Size([166908, 128])
torch.Size([165676, 32])
torch.Size([161362, 32])
torch.Size([142526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4388890266418457  GigaBytes
Max Memory Allocated: 0.45191526412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.1273331642150879  GigaBytes
Max Memory Allocated: 0.4519972801208496  GigaBytes

torch.Size([166931, 128])
torch.Size([165727, 32])
torch.Size([161549, 32])
torch.Size([142628, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.4390878677368164  GigaBytes
Max Memory Allocated: 0.4519972801208496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12705135345458984  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([167015, 128])
torch.Size([165789, 32])
torch.Size([161296, 32])
torch.Size([141557, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4378929138183594  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.127166748046875  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166994, 128])
torch.Size([165807, 32])
torch.Size([161539, 32])
torch.Size([142022, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43842601776123047  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12716102600097656  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([167003, 128])
torch.Size([165844, 32])
torch.Size([161502, 32])
torch.Size([141941, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43828535079956055  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12713193893432617  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166976, 128])
torch.Size([165756, 32])
torch.Size([161479, 32])
torch.Size([142231, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4382505416870117  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12712526321411133  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166959, 128])
torch.Size([165711, 32])
torch.Size([161122, 32])
torch.Size([141769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43804025650024414  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05504515767097473 |0.0794447660446167 |0.09696710109710693 |0.00010707974433898926 |0.017985522747039795 |0.0031785964965820312 |
----------------------------------------------------------pseudo_mini_loss sum 4.98797082901001
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5633360
Number of first layer input nodes during this epoch:  1335754
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.22530412673950195  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.01911640167236328
range selection method range initialization spend 0.011582374572753906
time for parepare:  0.01685357093811035
local_output_nid generation:  0.0028035640716552734
local_in_edges_tensor generation:  0.003851175308227539
mini_batch_src_global generation:  0.003325223922729492
r_  generation:  0.037172794342041016
local_output_nid generation:  0.003620624542236328
local_in_edges_tensor generation:  0.0016603469848632812
mini_batch_src_global generation:  0.004141092300415039
r_  generation:  0.03896832466125488
local_output_nid generation:  0.0038030147552490234
local_in_edges_tensor generation:  0.0016584396362304688
mini_batch_src_global generation:  0.0028047561645507812
r_  generation:  0.03980255126953125
local_output_nid generation:  0.0035963058471679688
local_in_edges_tensor generation:  0.0017087459564208984
mini_batch_src_global generation:  0.0028808116912841797
r_  generation:  0.04126143455505371
local_output_nid generation:  0.003663778305053711
local_in_edges_tensor generation:  0.0016446113586425781
mini_batch_src_global generation:  0.0029251575469970703
r_  generation:  0.04099392890930176
local_output_nid generation:  0.0037338733673095703
local_in_edges_tensor generation:  0.0016608238220214844
mini_batch_src_global generation:  0.0030908584594726562
r_  generation:  0.04175305366516113
local_output_nid generation:  0.003721475601196289
local_in_edges_tensor generation:  0.0017697811126708984
mini_batch_src_global generation:  0.003123760223388672
r_  generation:  0.04217100143432617
local_output_nid generation:  0.003656148910522461
local_in_edges_tensor generation:  0.0016891956329345703
mini_batch_src_global generation:  0.003201723098754883
r_  generation:  0.04245615005493164
----------------------check_connections_block total spend ----------------------------- 0.480419397354126
generate_one_block  0.05690884590148926
generate_one_block  0.05511116981506348
generate_one_block  0.05809378623962402
generate_one_block  0.05536699295043945
generate_one_block  0.057281494140625
generate_one_block  0.055672645568847656
generate_one_block  0.05647754669189453
generate_one_block  0.06143593788146973
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05085873603820801
gen group dst list time:  0.015809297561645508
time for parepare:  0.02260279655456543
local_output_nid generation:  0.012900829315185547
local_in_edges_tensor generation:  0.04086589813232422
mini_batch_src_global generation:  0.030748844146728516
r_  generation:  0.3067641258239746
local_output_nid generation:  0.01915431022644043
local_in_edges_tensor generation:  0.028386831283569336
mini_batch_src_global generation:  0.04162168502807617
r_  generation:  0.3181617259979248
local_output_nid generation:  0.02068185806274414
local_in_edges_tensor generation:  0.023732423782348633
mini_batch_src_global generation:  0.03583836555480957
r_  generation:  0.32564330101013184
local_output_nid generation:  0.020746707916259766
local_in_edges_tensor generation:  0.02259039878845215
mini_batch_src_global generation:  0.03792071342468262
r_  generation:  0.32946038246154785
local_output_nid generation:  0.020330429077148438
local_in_edges_tensor generation:  0.017930984497070312
mini_batch_src_global generation:  0.037494659423828125
r_  generation:  0.3249795436859131
local_output_nid generation:  0.020899057388305664
local_in_edges_tensor generation:  0.02432560920715332
mini_batch_src_global generation:  0.038706064224243164
r_  generation:  0.3328723907470703
local_output_nid generation:  0.02111220359802246
local_in_edges_tensor generation:  0.027415752410888672
mini_batch_src_global generation:  0.04023241996765137
r_  generation:  0.3466768264770508
local_output_nid generation:  0.02166295051574707
local_in_edges_tensor generation:  0.022002458572387695
mini_batch_src_global generation:  0.03867626190185547
r_  generation:  0.33862805366516113
----------------------check_connections_block total spend ----------------------------- 3.8524911403656006
generate_one_block  0.4125559329986572
generate_one_block  0.4162740707397461
generate_one_block  0.42017698287963867
generate_one_block  0.4073455333709717
generate_one_block  0.404773473739624
generate_one_block  0.44095683097839355
generate_one_block  0.42166876792907715
generate_one_block  0.4600639343261719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.049906253814697266
gen group dst list time:  0.03869915008544922
time for parepare:  0.018312931060791016
local_output_nid generation:  0.02680063247680664
local_in_edges_tensor generation:  0.07900571823120117
mini_batch_src_global generation:  0.053888559341430664
r_  generation:  0.5405242443084717
local_output_nid generation:  0.03311491012573242
local_in_edges_tensor generation:  0.05178046226501465
mini_batch_src_global generation:  0.06084156036376953
r_  generation:  0.5535521507263184
local_output_nid generation:  0.036135196685791016
local_in_edges_tensor generation:  0.043196678161621094
mini_batch_src_global generation:  0.056386470794677734
r_  generation:  0.5677618980407715
local_output_nid generation:  0.03444981575012207
local_in_edges_tensor generation:  0.040999412536621094
mini_batch_src_global generation:  0.0609738826751709
r_  generation:  0.5700531005859375
local_output_nid generation:  0.034372806549072266
local_in_edges_tensor generation:  0.04176068305969238
mini_batch_src_global generation:  0.05905652046203613
r_  generation:  0.5734961032867432
local_output_nid generation:  0.03570842742919922
local_in_edges_tensor generation:  0.05942893028259277
mini_batch_src_global generation:  0.07872486114501953
r_  generation:  0.5620167255401611
local_output_nid generation:  0.03872084617614746
local_in_edges_tensor generation:  0.04960799217224121
mini_batch_src_global generation:  0.06679773330688477
r_  generation:  0.5710883140563965
local_output_nid generation:  0.035887718200683594
local_in_edges_tensor generation:  0.03660297393798828
mini_batch_src_global generation:  0.06282925605773926
r_  generation:  0.5636594295501709
----------------------check_connections_block total spend ----------------------------- 6.651372909545898
generate_one_block  0.6790413856506348
generate_one_block  0.6917319297790527
generate_one_block  0.7039473056793213
generate_one_block  0.7022242546081543
generate_one_block  0.6697885990142822
generate_one_block  0.6983659267425537
generate_one_block  0.7130265235900879
generate_one_block  0.6880600452423096
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04819440841674805
gen group dst list time:  0.053347110748291016
time for parepare:  0.019042253494262695
local_output_nid generation:  0.031561851501464844
local_in_edges_tensor generation:  0.05763816833496094
mini_batch_src_global generation:  0.05303478240966797
r_  generation:  0.5437355041503906
local_output_nid generation:  0.03923749923706055
local_in_edges_tensor generation:  0.08682727813720703
mini_batch_src_global generation:  0.06126689910888672
r_  generation:  0.5641703605651855
local_output_nid generation:  0.03781390190124512
local_in_edges_tensor generation:  0.04073762893676758
mini_batch_src_global generation:  0.0616455078125
r_  generation:  0.5620453357696533
local_output_nid generation:  0.03768467903137207
local_in_edges_tensor generation:  0.040697574615478516
mini_batch_src_global generation:  0.060449838638305664
r_  generation:  0.5747439861297607
local_output_nid generation:  0.03798866271972656
local_in_edges_tensor generation:  0.04027700424194336
mini_batch_src_global generation:  0.06435489654541016
r_  generation:  0.5868420600891113
local_output_nid generation:  0.03819727897644043
local_in_edges_tensor generation:  0.04352545738220215
mini_batch_src_global generation:  0.06491541862487793
r_  generation:  0.6064298152923584
local_output_nid generation:  0.03799295425415039
local_in_edges_tensor generation:  0.050511837005615234
mini_batch_src_global generation:  0.06209897994995117
r_  generation:  0.5944766998291016
local_output_nid generation:  0.038376569747924805
local_in_edges_tensor generation:  0.0374598503112793
mini_batch_src_global generation:  0.05994153022766113
r_  generation:  0.6135821342468262
----------------------check_connections_block total spend ----------------------------- 6.879140853881836
generate_one_block  0.7177700996398926
generate_one_block  0.7287323474884033
generate_one_block  0.7369318008422852
generate_one_block  0.7353382110595703
generate_one_block  0.7244668006896973
generate_one_block  0.7335295677185059
generate_one_block  0.7278940677642822
generate_one_block  0.7051537036895752
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045372724533081055
gen group dst list time:  0.05995917320251465
time for parepare:  0.018714189529418945
local_output_nid generation:  0.03378438949584961
local_in_edges_tensor generation:  0.05406999588012695
mini_batch_src_global generation:  0.04824256896972656
r_  generation:  0.5316598415374756
local_output_nid generation:  0.03896522521972656
local_in_edges_tensor generation:  0.03358912467956543
mini_batch_src_global generation:  0.057805776596069336
r_  generation:  0.5280599594116211
local_output_nid generation:  0.039130449295043945
local_in_edges_tensor generation:  0.03641653060913086
mini_batch_src_global generation:  0.058220624923706055
r_  generation:  0.5270161628723145
local_output_nid generation:  0.03908729553222656
local_in_edges_tensor generation:  0.03691720962524414
mini_batch_src_global generation:  0.05900454521179199
r_  generation:  0.5270640850067139
local_output_nid generation:  0.03922533988952637
local_in_edges_tensor generation:  0.034763336181640625
mini_batch_src_global generation:  0.059120893478393555
r_  generation:  0.5276045799255371
local_output_nid generation:  0.0391535758972168
local_in_edges_tensor generation:  0.07500338554382324
mini_batch_src_global generation:  0.056992292404174805
r_  generation:  0.5550167560577393
local_output_nid generation:  0.04033398628234863
local_in_edges_tensor generation:  0.0438997745513916
mini_batch_src_global generation:  0.057001590728759766
r_  generation:  0.5311501026153564
local_output_nid generation:  0.03963446617126465
local_in_edges_tensor generation:  0.03876543045043945
mini_batch_src_global generation:  0.05691981315612793
r_  generation:  0.5224740505218506
----------------------check_connections_block total spend ----------------------------- 6.3476245403289795
generate_one_block  0.6398191452026367
generate_one_block  0.6466498374938965
generate_one_block  0.6399812698364258
generate_one_block  0.6397676467895508
generate_one_block  0.6433260440826416
generate_one_block  0.6443126201629639
generate_one_block  0.6377639770507812
generate_one_block  0.6424267292022705
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.22530412673950195  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

connection checking time:  23.730629444122314
block generation total time  19.873865365982056
average batch blocks generation time:  2.484233170747757
block dataloader generation time/epoch 46.21067452430725
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12725257873535156  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([167043, 128])
torch.Size([165874, 32])
torch.Size([161544, 32])
torch.Size([142469, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43839359283447266  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.1272730827331543  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166970, 128])
torch.Size([165763, 32])
torch.Size([161388, 32])
torch.Size([141941, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43848228454589844  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.1273055076599121  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166932, 128])
torch.Size([165719, 32])
torch.Size([161435, 32])
torch.Size([142477, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43858909606933594  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.1272907257080078  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166982, 128])
torch.Size([165760, 32])
torch.Size([161413, 32])
torch.Size([142167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43854808807373047  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12711715698242188  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166931, 128])
torch.Size([165653, 32])
torch.Size([161213, 32])
torch.Size([141579, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43676328659057617  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12739276885986328  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166983, 128])
torch.Size([165854, 32])
torch.Size([161538, 32])
torch.Size([142366, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.43872547149658203  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.12734127044677734  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166941, 128])
torch.Size([165738, 32])
torch.Size([161483, 32])
torch.Size([142167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4386105537414551  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.1273484230041504  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

torch.Size([166937, 128])
torch.Size([165710, 32])
torch.Size([161196, 32])
torch.Size([142214, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.4386930465698242  GigaBytes
Max Memory Allocated: 0.4523129463195801  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05588960647583008 |0.03653326630592346 |0.005707293748855591 |9.66191291809082e-05 |0.012154936790466309 |0.004949331283569336 |
----------------------------------------------------------pseudo_mini_loss sum 4.307668209075928
Total (block generation + training)time/epoch 47.14397859573364
Training time/epoch 0.9330730438232422
Training time without block to device /epoch 0.6408069133758545
Training time without total dataloading part /epoch 0.1486201286315918
load block tensor time/epoch 0.4471168518066406
block to device time/epoch 0.2922661304473877
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5633493
Number of first layer input nodes during this epoch:  1335719
