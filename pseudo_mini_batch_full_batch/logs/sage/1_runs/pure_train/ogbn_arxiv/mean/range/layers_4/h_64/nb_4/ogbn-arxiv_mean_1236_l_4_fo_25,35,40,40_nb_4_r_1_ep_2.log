Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648482200.9235277
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023329734802246094
range selection method range initialization spend 0.013929128646850586
time for parepare:  0.017848968505859375
local_output_nid generation:  0.0052416324615478516
local_in_edges_tensor generation:  0.005572795867919922
mini_batch_src_global generation:  0.006578683853149414
r_  generation:  0.08280754089355469
local_output_nid generation:  0.0060007572174072266
local_in_edges_tensor generation:  0.003040313720703125
mini_batch_src_global generation:  0.008649826049804688
r_  generation:  0.08930587768554688
local_output_nid generation:  0.006094694137573242
local_in_edges_tensor generation:  0.0030257701873779297
mini_batch_src_global generation:  0.006523609161376953
r_  generation:  0.08977961540222168
local_output_nid generation:  0.006043434143066406
local_in_edges_tensor generation:  0.003008127212524414
mini_batch_src_global generation:  0.006894588470458984
r_  generation:  0.0919792652130127
----------------------check_connections_block total spend ----------------------------- 0.5098493099212646
generate_one_block  0.10078978538513184
generate_one_block  0.10317468643188477
generate_one_block  0.10315799713134766
generate_one_block  0.10252976417541504
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03816509246826172
gen group dst list time:  0.011473417282104492
time for parepare:  0.019166946411132812
local_output_nid generation:  0.015245199203491211
local_in_edges_tensor generation:  0.03673887252807617
mini_batch_src_global generation:  0.041517019271850586
r_  generation:  0.40981435775756836
local_output_nid generation:  0.02194356918334961
local_in_edges_tensor generation:  0.037627220153808594
mini_batch_src_global generation:  0.05035591125488281
r_  generation:  0.428983211517334
local_output_nid generation:  0.024026155471801758
local_in_edges_tensor generation:  0.030787229537963867
mini_batch_src_global generation:  0.04833197593688965
r_  generation:  0.4360072612762451
local_output_nid generation:  0.023776769638061523
local_in_edges_tensor generation:  0.0424656867980957
mini_batch_src_global generation:  0.06356549263000488
r_  generation:  0.4222559928894043
----------------------check_connections_block total spend ----------------------------- 2.5197150707244873
generate_one_block  0.593656063079834
generate_one_block  0.6016278266906738
generate_one_block  0.5492241382598877
generate_one_block  0.5516395568847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03792905807495117
gen group dst list time:  0.024394989013671875
time for parepare:  0.01968860626220703
local_output_nid generation:  0.025394439697265625
local_in_edges_tensor generation:  0.06227421760559082
mini_batch_src_global generation:  0.05272865295410156
r_  generation:  0.5276684761047363
local_output_nid generation:  0.033472537994384766
local_in_edges_tensor generation:  0.05046701431274414
mini_batch_src_global generation:  0.06065034866333008
r_  generation:  0.5532534122467041
local_output_nid generation:  0.03408169746398926
local_in_edges_tensor generation:  0.03818774223327637
mini_batch_src_global generation:  0.056876420974731445
r_  generation:  0.5507805347442627
local_output_nid generation:  0.034348487854003906
local_in_edges_tensor generation:  0.03357529640197754
mini_batch_src_global generation:  0.056387901306152344
r_  generation:  0.5526278018951416
----------------------check_connections_block total spend ----------------------------- 3.2093093395233154
generate_one_block  0.7121167182922363
generate_one_block  0.7109932899475098
generate_one_block  0.7044813632965088
generate_one_block  0.6887459754943848
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03831768035888672
gen group dst list time:  0.028882503509521484
time for parepare:  0.01904439926147461
local_output_nid generation:  0.027709245681762695
local_in_edges_tensor generation:  0.05361342430114746
mini_batch_src_global generation:  0.045708656311035156
r_  generation:  0.5060150623321533
local_output_nid generation:  0.03511834144592285
local_in_edges_tensor generation:  0.05112862586975098
mini_batch_src_global generation:  0.06911206245422363
r_  generation:  0.5145590305328369
local_output_nid generation:  0.036252737045288086
local_in_edges_tensor generation:  0.03862619400024414
mini_batch_src_global generation:  0.060593366622924805
r_  generation:  0.5129227638244629
local_output_nid generation:  0.037052154541015625
local_in_edges_tensor generation:  0.03893136978149414
mini_batch_src_global generation:  0.05844449996948242
r_  generation:  0.5232152938842773
----------------------check_connections_block total spend ----------------------------- 3.0925681591033936
generate_one_block  0.6682825088500977
generate_one_block  0.6776478290557861
generate_one_block  0.6568992137908936
generate_one_block  0.6437351703643799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  8.821592569351196
block generation total time  7.759049654006958
average batch blocks generation time:  1.9397624135017395
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11605310440063477  GigaBytes
Max Memory Allocated: 0.11605310440063477  GigaBytes

torch.Size([166708, 128])
torch.Size([164679, 64])
torch.Size([154836, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.5500826835632324  GigaBytes
Max Memory Allocated: 0.568544864654541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.12018632888793945  GigaBytes
Max Memory Allocated: 0.5968174934387207  GigaBytes

torch.Size([166688, 128])
torch.Size([164796, 64])
torch.Size([155257, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.5526256561279297  GigaBytes
Max Memory Allocated: 0.5968174934387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12105846405029297  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

torch.Size([166653, 128])
torch.Size([164668, 64])
torch.Size([154910, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5515556335449219  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12034368515014648  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

torch.Size([166668, 128])
torch.Size([164634, 64])
torch.Size([154743, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5513272285461426  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061512649059295654 |0.10867375135421753 |0.1873767375946045 |0.0001239180564880371 |0.018528878688812256 |0.00494384765625 |
----------------------------------------------------------pseudo_mini_loss sum 5.541940689086914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2350359
Number of first layer input nodes during this epoch:  666717
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.19747495651245117  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02137470245361328
range selection method range initialization spend 0.011913776397705078
time for parepare:  0.01704573631286621
local_output_nid generation:  0.00521087646484375
local_in_edges_tensor generation:  0.006872415542602539
mini_batch_src_global generation:  0.006615638732910156
r_  generation:  0.0803828239440918
local_output_nid generation:  0.006049156188964844
local_in_edges_tensor generation:  0.0030584335327148438
mini_batch_src_global generation:  0.010288476943969727
r_  generation:  0.08705282211303711
local_output_nid generation:  0.006072282791137695
local_in_edges_tensor generation:  0.0030770301818847656
mini_batch_src_global generation:  0.0065271854400634766
r_  generation:  0.08882308006286621
local_output_nid generation:  0.006074666976928711
local_in_edges_tensor generation:  0.0030357837677001953
mini_batch_src_global generation:  0.007661581039428711
r_  generation:  0.09167647361755371
----------------------check_connections_block total spend ----------------------------- 0.5060603618621826
generate_one_block  0.10412001609802246
generate_one_block  0.10174393653869629
generate_one_block  0.10132241249084473
generate_one_block  0.10466480255126953
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.040358781814575195
gen group dst list time:  0.011193037033081055
time for parepare:  0.01926112174987793
local_output_nid generation:  0.014842033386230469
local_in_edges_tensor generation:  0.03665661811828613
mini_batch_src_global generation:  0.04158186912536621
r_  generation:  0.40889430046081543
local_output_nid generation:  0.02194809913635254
local_in_edges_tensor generation:  0.03615164756774902
mini_batch_src_global generation:  0.04772758483886719
r_  generation:  0.41320204734802246
local_output_nid generation:  0.02354907989501953
local_in_edges_tensor generation:  0.03069305419921875
mini_batch_src_global generation:  0.04774212837219238
r_  generation:  0.4231903553009033
local_output_nid generation:  0.023724794387817383
local_in_edges_tensor generation:  0.026250839233398438
mini_batch_src_global generation:  0.051804542541503906
r_  generation:  0.4245436191558838
----------------------check_connections_block total spend ----------------------------- 2.4469985961914062
generate_one_block  0.5452187061309814
generate_one_block  0.5461547374725342
generate_one_block  0.5581240653991699
generate_one_block  0.5420835018157959
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0318453311920166
gen group dst list time:  0.02100205421447754
time for parepare:  0.021987438201904297
local_output_nid generation:  0.023865938186645508
local_in_edges_tensor generation:  0.04002809524536133
mini_batch_src_global generation:  0.05191397666931152
r_  generation:  0.5266978740692139
local_output_nid generation:  0.03319859504699707
local_in_edges_tensor generation:  0.0507357120513916
mini_batch_src_global generation:  0.06004142761230469
r_  generation:  0.5358319282531738
local_output_nid generation:  0.03450965881347656
local_in_edges_tensor generation:  0.0403139591217041
mini_batch_src_global generation:  0.05629587173461914
r_  generation:  0.547337532043457
local_output_nid generation:  0.03539848327636719
local_in_edges_tensor generation:  0.03788185119628906
mini_batch_src_global generation:  0.05686211585998535
r_  generation:  0.5475013256072998
----------------------check_connections_block total spend ----------------------------- 3.1568236351013184
generate_one_block  0.6767575740814209
generate_one_block  0.6841039657592773
generate_one_block  0.6905229091644287
generate_one_block  0.681938886642456
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03449130058288574
gen group dst list time:  0.025134801864624023
time for parepare:  0.019008398056030273
local_output_nid generation:  0.02835536003112793
local_in_edges_tensor generation:  0.038342952728271484
mini_batch_src_global generation:  0.04542708396911621
r_  generation:  0.5127930641174316
local_output_nid generation:  0.035306692123413086
local_in_edges_tensor generation:  0.0508580207824707
mini_batch_src_global generation:  0.05752968788146973
r_  generation:  0.509655237197876
local_output_nid generation:  0.03550601005554199
local_in_edges_tensor generation:  0.04062652587890625
mini_batch_src_global generation:  0.05777454376220703
r_  generation:  0.515688419342041
local_output_nid generation:  0.03584742546081543
local_in_edges_tensor generation:  0.04779648780822754
mini_batch_src_global generation:  0.05914640426635742
r_  generation:  0.520078182220459
----------------------check_connections_block total spend ----------------------------- 3.0706863403320312
generate_one_block  0.6686210632324219
generate_one_block  0.6527097225189209
generate_one_block  0.6341736316680908
generate_one_block  0.6595001220703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.19747495651245117  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

connection checking time:  8.674508571624756
block generation total time  7.5399088859558105
average batch blocks generation time:  1.8849772214889526
block dataloader generation time/epoch 18.199503660202026
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12109088897705078  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

torch.Size([166691, 128])
torch.Size([164760, 64])
torch.Size([155239, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5528445243835449  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.1204686164855957  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

torch.Size([166736, 128])
torch.Size([164860, 64])
torch.Size([155018, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5524306297302246  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.1213388442993164  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

torch.Size([166721, 128])
torch.Size([164742, 64])
torch.Size([155250, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5522909164428711  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.12079858779907227  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

torch.Size([166646, 128])
torch.Size([164684, 64])
torch.Size([154871, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5519280433654785  GigaBytes
Max Memory Allocated: 0.5996589660644531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.049547553062438965 |0.029980719089508057 |0.0050547122955322266 |9.906291961669922e-05 |0.018244624137878418 |0.003888368606567383 |
----------------------------------------------------------pseudo_mini_loss sum 4.409486770629883
Total (block generation + training)time/epoch 18.65481209754944
Training time/epoch 0.4550285339355469
Training time without block to device /epoch 0.33510565757751465
Training time without total dataloading part /epoch 0.09748196601867676
load block tensor time/epoch 0.19819021224975586
block to device time/epoch 0.11992287635803223
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2352193
Number of first layer input nodes during this epoch:  666794
