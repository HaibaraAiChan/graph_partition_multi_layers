Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446006.5715942
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027089595794677734
range selection method range initialization spend 0.013677597045898438
time for parepare:  0.018224477767944336
local_output_nid generation:  0.0013270378112792969
local_in_edges_tensor generation:  0.0041201114654541016
mini_batch_src_global generation:  0.0019376277923583984
r_  generation:  0.020667314529418945
local_output_nid generation:  0.0014247894287109375
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0024945735931396484
r_  generation:  0.02050614356994629
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0015811920166015625
r_  generation:  0.019985437393188477
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0015223026275634766
r_  generation:  0.02032947540283203
local_output_nid generation:  0.0015134811401367188
local_in_edges_tensor generation:  0.0008690357208251953
mini_batch_src_global generation:  0.0016183853149414062
r_  generation:  0.020789146423339844
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0016410350799560547
r_  generation:  0.02103424072265625
local_output_nid generation:  0.0015287399291992188
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0017070770263671875
r_  generation:  0.021619081497192383
local_output_nid generation:  0.0015270709991455078
local_in_edges_tensor generation:  0.0008649826049804688
mini_batch_src_global generation:  0.0016064643859863281
r_  generation:  0.020173072814941406
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0015974044799804688
r_  generation:  0.020519256591796875
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0016944408416748047
r_  generation:  0.020644664764404297
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0017042160034179688
r_  generation:  0.02083277702331543
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009045600891113281
mini_batch_src_global generation:  0.0017056465148925781
r_  generation:  0.021576881408691406
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0017507076263427734
r_  generation:  0.021565675735473633
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0016977787017822266
r_  generation:  0.021244287490844727
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.0017285346984863281
r_  generation:  0.02147364616394043
local_output_nid generation:  0.0015459060668945312
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017614364624023438
r_  generation:  0.021857500076293945
----------------------check_connections_block total spend ----------------------------- 0.496936559677124
generate_one_block  0.030614376068115234
generate_one_block  0.031625986099243164
generate_one_block  0.03211665153503418
generate_one_block  0.03099846839904785
generate_one_block  0.03183579444885254
generate_one_block  0.031542062759399414
generate_one_block  0.03149056434631348
generate_one_block  0.02954554557800293
generate_one_block  0.030252933502197266
generate_one_block  0.030343055725097656
generate_one_block  0.030575990676879883
generate_one_block  0.03144359588623047
generate_one_block  0.031343936920166016
generate_one_block  0.03122854232788086
generate_one_block  0.03202080726623535
generate_one_block  0.03184032440185547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038277387619018555
gen group dst list time:  0.020784378051757812
time for parepare:  0.019724607467651367
local_output_nid generation:  0.00723576545715332
local_in_edges_tensor generation:  0.01933765411376953
mini_batch_src_global generation:  0.022771120071411133
r_  generation:  0.21502947807312012
local_output_nid generation:  0.013248920440673828
local_in_edges_tensor generation:  0.02117300033569336
mini_batch_src_global generation:  0.027904748916625977
r_  generation:  0.22565007209777832
local_output_nid generation:  0.013406515121459961
local_in_edges_tensor generation:  0.015778064727783203
mini_batch_src_global generation:  0.02635359764099121
r_  generation:  0.22235512733459473
local_output_nid generation:  0.013900995254516602
local_in_edges_tensor generation:  0.01561737060546875
mini_batch_src_global generation:  0.028667211532592773
r_  generation:  0.22572064399719238
local_output_nid generation:  0.014223098754882812
local_in_edges_tensor generation:  0.01677250862121582
mini_batch_src_global generation:  0.0287778377532959
r_  generation:  0.2363131046295166
local_output_nid generation:  0.01424407958984375
local_in_edges_tensor generation:  0.018015623092651367
mini_batch_src_global generation:  0.029035568237304688
r_  generation:  0.23322153091430664
local_output_nid generation:  0.01441335678100586
local_in_edges_tensor generation:  0.01687169075012207
mini_batch_src_global generation:  0.0303804874420166
r_  generation:  0.23810338973999023
local_output_nid generation:  0.013964653015136719
local_in_edges_tensor generation:  0.01516270637512207
mini_batch_src_global generation:  0.028645992279052734
r_  generation:  0.22127175331115723
local_output_nid generation:  0.014302253723144531
local_in_edges_tensor generation:  0.013976812362670898
mini_batch_src_global generation:  0.028551816940307617
r_  generation:  0.22635698318481445
local_output_nid generation:  0.014293909072875977
local_in_edges_tensor generation:  0.01990675926208496
mini_batch_src_global generation:  0.02871227264404297
r_  generation:  0.22928643226623535
local_output_nid generation:  0.014325857162475586
local_in_edges_tensor generation:  0.015909671783447266
mini_batch_src_global generation:  0.028588056564331055
r_  generation:  0.2316596508026123
local_output_nid generation:  0.014673471450805664
local_in_edges_tensor generation:  0.01875138282775879
mini_batch_src_global generation:  0.03161478042602539
r_  generation:  0.23741412162780762
local_output_nid generation:  0.014601469039916992
local_in_edges_tensor generation:  0.016276121139526367
mini_batch_src_global generation:  0.029645442962646484
r_  generation:  0.23549866676330566
local_output_nid generation:  0.014606237411499023
local_in_edges_tensor generation:  0.01428842544555664
mini_batch_src_global generation:  0.03018331527709961
r_  generation:  0.23664522171020508
local_output_nid generation:  0.014862775802612305
local_in_edges_tensor generation:  0.014827489852905273
mini_batch_src_global generation:  0.029685497283935547
r_  generation:  0.23704099655151367
local_output_nid generation:  0.014672994613647461
local_in_edges_tensor generation:  0.01688838005065918
mini_batch_src_global generation:  0.029841184616088867
r_  generation:  0.23669838905334473
----------------------check_connections_block total spend ----------------------------- 5.46884298324585
generate_one_block  0.3074476718902588
generate_one_block  0.3110790252685547
generate_one_block  0.29689836502075195
generate_one_block  0.30173516273498535
generate_one_block  0.32393956184387207
generate_one_block  0.30957603454589844
generate_one_block  0.3163487911224365
generate_one_block  0.28574371337890625
generate_one_block  0.29069972038269043
generate_one_block  0.3008992671966553
generate_one_block  0.2989189624786377
generate_one_block  0.3132627010345459
generate_one_block  0.31002068519592285
generate_one_block  0.3090038299560547
generate_one_block  0.3166787624359131
generate_one_block  0.31211185455322266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036536455154418945
gen group dst list time:  0.06016826629638672
time for parepare:  0.018910884857177734
local_output_nid generation:  0.023681640625
local_in_edges_tensor generation:  0.03804445266723633
mini_batch_src_global generation:  0.04200005531311035
r_  generation:  0.4395484924316406
local_output_nid generation:  0.03005695343017578
local_in_edges_tensor generation:  0.04491543769836426
mini_batch_src_global generation:  0.051331520080566406
r_  generation:  0.44940853118896484
local_output_nid generation:  0.029907703399658203
local_in_edges_tensor generation:  0.038231849670410156
mini_batch_src_global generation:  0.05048656463623047
r_  generation:  0.4522676467895508
local_output_nid generation:  0.03025364875793457
local_in_edges_tensor generation:  0.03377485275268555
mini_batch_src_global generation:  0.05196189880371094
r_  generation:  0.45084214210510254
local_output_nid generation:  0.03024578094482422
local_in_edges_tensor generation:  0.04197978973388672
mini_batch_src_global generation:  0.05152177810668945
r_  generation:  0.4607841968536377
local_output_nid generation:  0.030277252197265625
local_in_edges_tensor generation:  0.03499484062194824
mini_batch_src_global generation:  0.05344390869140625
r_  generation:  0.4565463066101074
local_output_nid generation:  0.030628681182861328
local_in_edges_tensor generation:  0.0341799259185791
mini_batch_src_global generation:  0.055542945861816406
r_  generation:  0.46320176124572754
local_output_nid generation:  0.02994847297668457
local_in_edges_tensor generation:  0.0302731990814209
mini_batch_src_global generation:  0.05300641059875488
r_  generation:  0.45564770698547363
local_output_nid generation:  0.030077695846557617
local_in_edges_tensor generation:  0.03811383247375488
mini_batch_src_global generation:  0.055063486099243164
r_  generation:  0.45969390869140625
local_output_nid generation:  0.03062295913696289
local_in_edges_tensor generation:  0.04576826095581055
mini_batch_src_global generation:  0.05256056785583496
r_  generation:  0.4518404006958008
local_output_nid generation:  0.030283689498901367
local_in_edges_tensor generation:  0.03493332862854004
mini_batch_src_global generation:  0.0520014762878418
r_  generation:  0.46295952796936035
local_output_nid generation:  0.030860185623168945
local_in_edges_tensor generation:  0.03891754150390625
mini_batch_src_global generation:  0.052895307540893555
r_  generation:  0.45518064498901367
local_output_nid generation:  0.030585050582885742
local_in_edges_tensor generation:  0.0387876033782959
mini_batch_src_global generation:  0.05199718475341797
r_  generation:  0.46172070503234863
local_output_nid generation:  0.03038763999938965
local_in_edges_tensor generation:  0.03023052215576172
mini_batch_src_global generation:  0.05418825149536133
r_  generation:  0.4599287509918213
local_output_nid generation:  0.030667543411254883
local_in_edges_tensor generation:  0.029996156692504883
mini_batch_src_global generation:  0.05547666549682617
r_  generation:  0.4626002311706543
local_output_nid generation:  0.030488014221191406
local_in_edges_tensor generation:  0.031423330307006836
mini_batch_src_global generation:  0.05382490158081055
r_  generation:  0.455153226852417
----------------------check_connections_block total spend ----------------------------- 10.796424627304077
generate_one_block  0.5768141746520996
generate_one_block  0.5868978500366211
generate_one_block  0.5803565979003906
generate_one_block  0.5903151035308838
generate_one_block  0.5879647731781006
generate_one_block  0.5881166458129883
generate_one_block  0.627305269241333
generate_one_block  0.5785541534423828
generate_one_block  0.5748739242553711
generate_one_block  0.5769851207733154
generate_one_block  0.5974211692810059
generate_one_block  0.5930655002593994
generate_one_block  0.5874102115631104
generate_one_block  0.58255934715271
generate_one_block  0.5864579677581787
generate_one_block  0.5865507125854492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  16.265267610549927
block generation total time  14.306012630462646
average batch blocks generation time:  0.8941257894039154
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09070158004760742  GigaBytes
Max Memory Allocated: 0.09070158004760742  GigaBytes

torch.Size([154994, 128])
torch.Size([124420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.18630504608154297  GigaBytes
Max Memory Allocated: 0.18969440460205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09176063537597656  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155077, 128])
torch.Size([125230, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18703413009643555  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09150218963623047  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155035, 128])
torch.Size([124920, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18529081344604492  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09154033660888672  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154994, 128])
torch.Size([124457, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1844792366027832  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09170341491699219  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154937, 128])
torch.Size([125034, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18592309951782227  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09170913696289062  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155472, 128])
torch.Size([125445, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18589448928833008  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0918436050415039  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155083, 128])
torch.Size([125563, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18715429306030273  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09124755859375  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154762, 128])
torch.Size([123698, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18219757080078125  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09134578704833984  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154493, 128])
torch.Size([124105, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18277502059936523  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09151172637939453  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155175, 128])
torch.Size([124782, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18424558639526367  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09145259857177734  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155121, 128])
torch.Size([124944, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1850905418395996  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09176826477050781  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155173, 128])
torch.Size([125354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1869649887084961  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09168243408203125  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154834, 128])
torch.Size([125336, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18593263626098633  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0916595458984375  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154951, 128])
torch.Size([124864, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18573284149169922  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09168815612792969  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155005, 128])
torch.Size([125285, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1859731674194336  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0916900634765625  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154927, 128])
torch.Size([124690, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18584012985229492  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032373517751693726 |0.0354723185300827 |0.049501508474349976 |0.00010019540786743164 |0.006476253271102905 |0.0019872188568115234 |
----------------------------------------------------------pseudo_mini_loss sum 5.047900199890137
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209173
Number of first layer input nodes during this epoch:  2480033
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.12735795974731445  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02727508544921875
range selection method range initialization spend 0.01143503189086914
time for parepare:  0.0167386531829834
local_output_nid generation:  0.00135040283203125
local_in_edges_tensor generation:  0.007180690765380859
mini_batch_src_global generation:  0.001980304718017578
r_  generation:  0.019233226776123047
local_output_nid generation:  0.0015616416931152344
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0024094581604003906
r_  generation:  0.020287275314331055
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0015289783477783203
r_  generation:  0.020470857620239258
local_output_nid generation:  0.0016791820526123047
local_in_edges_tensor generation:  0.0009479522705078125
mini_batch_src_global generation:  0.0014715194702148438
r_  generation:  0.0213015079498291
local_output_nid generation:  0.0016393661499023438
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.001680135726928711
r_  generation:  0.021665096282958984
local_output_nid generation:  0.0016429424285888672
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017209053039550781
r_  generation:  0.021557092666625977
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.021620750427246094
local_output_nid generation:  0.0015354156494140625
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.001638174057006836
r_  generation:  0.021150588989257812
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008924007415771484
mini_batch_src_global generation:  0.0016694068908691406
r_  generation:  0.021489381790161133
local_output_nid generation:  0.0016269683837890625
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022154569625854492
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0009374618530273438
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.0218505859375
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0017993450164794922
r_  generation:  0.024414777755737305
local_output_nid generation:  0.0015528202056884766
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0017902851104736328
r_  generation:  0.021914243698120117
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0012128353118896484
mini_batch_src_global generation:  0.0018475055694580078
r_  generation:  0.022743701934814453
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0018105506896972656
r_  generation:  0.022077322006225586
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.001863241195678711
r_  generation:  0.02258777618408203
----------------------check_connections_block total spend ----------------------------- 0.5157294273376465
generate_one_block  0.03363370895385742
generate_one_block  0.031124114990234375
generate_one_block  0.0307466983795166
generate_one_block  0.031131744384765625
generate_one_block  0.032405853271484375
generate_one_block  0.0336301326751709
generate_one_block  0.03153204917907715
generate_one_block  0.03058934211730957
generate_one_block  0.033576011657714844
generate_one_block  0.03201699256896973
generate_one_block  0.031594276428222656
generate_one_block  0.03275918960571289
generate_one_block  0.031922340393066406
generate_one_block  0.03277778625488281
generate_one_block  0.03467702865600586
generate_one_block  0.03252863883972168
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03632998466491699
gen group dst list time:  0.019331932067871094
time for parepare:  0.02240133285522461
local_output_nid generation:  0.007019519805908203
local_in_edges_tensor generation:  0.020376205444335938
mini_batch_src_global generation:  0.022074460983276367
r_  generation:  0.2268073558807373
local_output_nid generation:  0.012469053268432617
local_in_edges_tensor generation:  0.026474475860595703
mini_batch_src_global generation:  0.02863764762878418
r_  generation:  0.22271299362182617
local_output_nid generation:  0.013281106948852539
local_in_edges_tensor generation:  0.01507711410522461
mini_batch_src_global generation:  0.027603626251220703
r_  generation:  0.22806119918823242
local_output_nid generation:  0.012474298477172852
local_in_edges_tensor generation:  0.01853013038635254
mini_batch_src_global generation:  0.029370546340942383
r_  generation:  0.24424958229064941
local_output_nid generation:  0.012883663177490234
local_in_edges_tensor generation:  0.01675128936767578
mini_batch_src_global generation:  0.028855323791503906
r_  generation:  0.23566365242004395
local_output_nid generation:  0.012659788131713867
local_in_edges_tensor generation:  0.012598037719726562
mini_batch_src_global generation:  0.029123306274414062
r_  generation:  0.2332596778869629
local_output_nid generation:  0.012691974639892578
local_in_edges_tensor generation:  0.014378070831298828
mini_batch_src_global generation:  0.029407739639282227
r_  generation:  0.2367560863494873
local_output_nid generation:  0.015184402465820312
local_in_edges_tensor generation:  0.014901399612426758
mini_batch_src_global generation:  0.030042648315429688
r_  generation:  0.24252986907958984
local_output_nid generation:  0.014698505401611328
local_in_edges_tensor generation:  0.020670175552368164
mini_batch_src_global generation:  0.030942678451538086
r_  generation:  0.23532414436340332
local_output_nid generation:  0.012951374053955078
local_in_edges_tensor generation:  0.017885684967041016
mini_batch_src_global generation:  0.03008413314819336
r_  generation:  0.2436356544494629
local_output_nid generation:  0.012813568115234375
local_in_edges_tensor generation:  0.01525115966796875
mini_batch_src_global generation:  0.029750585556030273
r_  generation:  0.23569250106811523
local_output_nid generation:  0.013001680374145508
local_in_edges_tensor generation:  0.03032708168029785
mini_batch_src_global generation:  0.030132770538330078
r_  generation:  0.23972320556640625
local_output_nid generation:  0.013201713562011719
local_in_edges_tensor generation:  0.015419721603393555
mini_batch_src_global generation:  0.030034780502319336
r_  generation:  0.2380537986755371
local_output_nid generation:  0.013211488723754883
local_in_edges_tensor generation:  0.015311717987060547
mini_batch_src_global generation:  0.03201460838317871
r_  generation:  0.24441099166870117
local_output_nid generation:  0.013071775436401367
local_in_edges_tensor generation:  0.013174772262573242
mini_batch_src_global generation:  0.02973008155822754
r_  generation:  0.24168062210083008
local_output_nid generation:  0.013901233673095703
local_in_edges_tensor generation:  0.01601243019104004
mini_batch_src_global generation:  0.030374765396118164
r_  generation:  0.2461860179901123
----------------------check_connections_block total spend ----------------------------- 5.619234323501587
generate_one_block  0.3260786533355713
generate_one_block  0.30199527740478516
generate_one_block  0.3051285743713379
generate_one_block  0.3033328056335449
generate_one_block  0.31046342849731445
generate_one_block  0.3079838752746582
generate_one_block  0.33402442932128906
generate_one_block  0.2937040328979492
generate_one_block  0.2992274761199951
generate_one_block  0.32717204093933105
generate_one_block  0.29811620712280273
generate_one_block  0.3116614818572998
generate_one_block  0.31337642669677734
generate_one_block  0.31629061698913574
generate_one_block  0.31781649589538574
generate_one_block  0.30441713333129883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046021461486816406
gen group dst list time:  0.060739755630493164
time for parepare:  0.01820826530456543
local_output_nid generation:  0.02388167381286621
local_in_edges_tensor generation:  0.04356217384338379
mini_batch_src_global generation:  0.044168949127197266
r_  generation:  0.4403095245361328
local_output_nid generation:  0.029595136642456055
local_in_edges_tensor generation:  0.04575324058532715
mini_batch_src_global generation:  0.05064654350280762
r_  generation:  0.4500312805175781
local_output_nid generation:  0.030446529388427734
local_in_edges_tensor generation:  0.04212665557861328
mini_batch_src_global generation:  0.049904584884643555
r_  generation:  0.4600179195404053
local_output_nid generation:  0.032413482666015625
local_in_edges_tensor generation:  0.037430763244628906
mini_batch_src_global generation:  0.05463051795959473
r_  generation:  0.4549524784088135
local_output_nid generation:  0.03135800361633301
local_in_edges_tensor generation:  0.09134554862976074
mini_batch_src_global generation:  0.051000356674194336
r_  generation:  0.46572303771972656
local_output_nid generation:  0.030314922332763672
local_in_edges_tensor generation:  0.03323793411254883
mini_batch_src_global generation:  0.053664445877075195
r_  generation:  0.4701964855194092
local_output_nid generation:  0.031166553497314453
local_in_edges_tensor generation:  0.0392155647277832
mini_batch_src_global generation:  0.0540316104888916
r_  generation:  0.4741806983947754
local_output_nid generation:  0.033516883850097656
local_in_edges_tensor generation:  0.03542828559875488
mini_batch_src_global generation:  0.05592823028564453
r_  generation:  0.4584324359893799
local_output_nid generation:  0.03191256523132324
local_in_edges_tensor generation:  0.03346991539001465
mini_batch_src_global generation:  0.0516815185546875
r_  generation:  0.46305298805236816
local_output_nid generation:  0.03166627883911133
local_in_edges_tensor generation:  0.04105830192565918
mini_batch_src_global generation:  0.05578255653381348
r_  generation:  0.4577813148498535
local_output_nid generation:  0.031950950622558594
local_in_edges_tensor generation:  0.035016775131225586
mini_batch_src_global generation:  0.05225419998168945
r_  generation:  0.46349287033081055
local_output_nid generation:  0.04346418380737305
local_in_edges_tensor generation:  0.034754037857055664
mini_batch_src_global generation:  0.055791616439819336
r_  generation:  0.4577066898345947
local_output_nid generation:  0.03180193901062012
local_in_edges_tensor generation:  0.03820300102233887
mini_batch_src_global generation:  0.052221059799194336
r_  generation:  0.4643223285675049
local_output_nid generation:  0.032224178314208984
local_in_edges_tensor generation:  0.038870811462402344
mini_batch_src_global generation:  0.05657649040222168
r_  generation:  0.4621305465698242
local_output_nid generation:  0.032080650329589844
local_in_edges_tensor generation:  0.03502845764160156
mini_batch_src_global generation:  0.052803993225097656
r_  generation:  0.47063207626342773
local_output_nid generation:  0.03201484680175781
local_in_edges_tensor generation:  0.03482770919799805
mini_batch_src_global generation:  0.05788373947143555
r_  generation:  0.4684004783630371
----------------------check_connections_block total spend ----------------------------- 11.04697322845459
generate_one_block  0.5988292694091797
generate_one_block  0.5973632335662842
generate_one_block  0.5891919136047363
generate_one_block  0.5957446098327637
generate_one_block  0.5958428382873535
generate_one_block  0.5876481533050537
generate_one_block  0.5808360576629639
generate_one_block  0.5775883197784424
generate_one_block  0.6202592849731445
generate_one_block  0.6082193851470947
generate_one_block  0.5962255001068115
generate_one_block  0.5939962863922119
generate_one_block  0.5870370864868164
generate_one_block  0.5995593070983887
generate_one_block  0.5968396663665771
generate_one_block  0.5843706130981445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.12735795974731445  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

connection checking time:  16.666207551956177
block generation total time  14.480340480804443
average batch blocks generation time:  0.9050212800502777
block dataloader generation time/epoch 33.39804434776306
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09152936935424805  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154627, 128])
torch.Size([124053, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18293428421020508  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0916280746459961  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155054, 128])
torch.Size([125008, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1854085922241211  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09159278869628906  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154933, 128])
torch.Size([124364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18442487716674805  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0916604995727539  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155178, 128])
torch.Size([124806, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1854720115661621  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09176445007324219  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155118, 128])
torch.Size([125323, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18600177764892578  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09167957305908203  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155163, 128])
torch.Size([125073, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.185699462890625  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09171199798583984  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155000, 128])
torch.Size([124506, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18465948104858398  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09147930145263672  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154866, 128])
torch.Size([123975, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18258953094482422  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09159469604492188  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155083, 128])
torch.Size([125099, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18541336059570312  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09180450439453125  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154978, 128])
torch.Size([124858, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18596220016479492  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09165382385253906  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155322, 128])
torch.Size([124885, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18557405471801758  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09184741973876953  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154852, 128])
torch.Size([124933, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18714523315429688  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09175968170166016  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([154713, 128])
torch.Size([124786, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18590784072875977  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.09191417694091797  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155219, 128])
torch.Size([125657, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18730688095092773  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0918130874633789  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155371, 128])
torch.Size([126124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.18605327606201172  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.0917825698852539  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

torch.Size([155171, 128])
torch.Size([125555, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1860361099243164  GigaBytes
Max Memory Allocated: 0.19840049743652344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030596017837524414 |0.012598276138305664 |0.003383249044418335 |9.074807167053223e-05 |0.003858610987663269 |0.0014750957489013672 |
----------------------------------------------------------pseudo_mini_loss sum 4.336475849151611
Total (block generation + training)time/epoch 34.2359824180603
Training time/epoch 0.8377242088317871
Training time without block to device /epoch 0.6361517906188965
Training time without total dataloading part /epoch 0.11879682540893555
load block tensor time/epoch 0.4895362854003906
block to device time/epoch 0.20157241821289062
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5209871
Number of first layer input nodes during this epoch:  2480648
