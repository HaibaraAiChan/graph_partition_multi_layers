Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648514450.6049836
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02423238754272461
range selection method range initialization spend 0.013352394104003906
time for parepare:  0.017855167388916016
local_output_nid generation:  0.010459661483764648
local_in_edges_tensor generation:  0.010052204132080078
mini_batch_src_global generation:  0.013612985610961914
r_  generation:  0.16746044158935547
local_output_nid generation:  0.011936187744140625
local_in_edges_tensor generation:  0.010596513748168945
mini_batch_src_global generation:  0.017025232315063477
r_  generation:  0.17960858345031738
----------------------check_connections_block total spend ----------------------------- 0.5064959526062012
generate_one_block  0.19767498970031738
generate_one_block  0.2025601863861084
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04119133949279785
gen group dst list time:  0.007350444793701172
time for parepare:  0.01989459991455078
local_output_nid generation:  0.016958236694335938
local_in_edges_tensor generation:  0.04268026351928711
mini_batch_src_global generation:  0.049449920654296875
r_  generation:  0.49771714210510254
local_output_nid generation:  0.029143095016479492
local_in_edges_tensor generation:  0.04549860954284668
mini_batch_src_global generation:  0.057625532150268555
r_  generation:  0.5126838684082031
----------------------check_connections_block total spend ----------------------------- 1.4892616271972656
generate_one_block  0.6434650421142578
generate_one_block  0.655686616897583
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.037305355072021484
gen group dst list time:  0.011620521545410156
time for parepare:  0.019599199295043945
local_output_nid generation:  0.022273778915405273
local_in_edges_tensor generation:  0.044144392013549805
mini_batch_src_global generation:  0.050405025482177734
r_  generation:  0.561044454574585
local_output_nid generation:  0.03487038612365723
local_in_edges_tensor generation:  0.050160884857177734
mini_batch_src_global generation:  0.0626223087310791
r_  generation:  0.567720890045166
----------------------check_connections_block total spend ----------------------------- 1.6587333679199219
generate_one_block  0.7359440326690674
generate_one_block  0.7277395725250244
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03156280517578125
gen group dst list time:  0.012104272842407227
time for parepare:  0.0194704532623291
local_output_nid generation:  0.02371954917907715
local_in_edges_tensor generation:  0.042266130447387695
mini_batch_src_global generation:  0.055294036865234375
r_  generation:  0.5585086345672607
local_output_nid generation:  0.03563642501831055
local_in_edges_tensor generation:  0.054663896560668945
mini_batch_src_global generation:  0.0631251335144043
r_  generation:  0.5694913864135742
----------------------check_connections_block total spend ----------------------------- 1.6756436824798584
generate_one_block  0.7146096229553223
generate_one_block  0.7258336544036865
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02905869483947754
gen group dst list time:  0.01262354850769043
time for parepare:  0.019518613815307617
local_output_nid generation:  0.02478337287902832
local_in_edges_tensor generation:  0.03677630424499512
mini_batch_src_global generation:  0.04972100257873535
r_  generation:  0.5456299781799316
local_output_nid generation:  0.036194562911987305
local_in_edges_tensor generation:  0.03183317184448242
mini_batch_src_global generation:  0.06369638442993164
r_  generation:  0.5627021789550781
----------------------check_connections_block total spend ----------------------------- 1.6235990524291992
generate_one_block  0.6984670162200928
generate_one_block  0.7123470306396484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027066946029663086
gen group dst list time:  0.012740850448608398
time for parepare:  0.018949508666992188
local_output_nid generation:  0.02374577522277832
local_in_edges_tensor generation:  0.03493046760559082
mini_batch_src_global generation:  0.04558610916137695
r_  generation:  0.5155816078186035
local_output_nid generation:  0.032003164291381836
local_in_edges_tensor generation:  0.03044891357421875
mini_batch_src_global generation:  0.061318397521972656
r_  generation:  0.5279297828674316
----------------------check_connections_block total spend ----------------------------- 1.5283043384552002
generate_one_block  0.6415059566497803
generate_one_block  0.6519560813903809
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  7.975542068481445
block generation total time  6.907554626464844
average batch blocks generation time:  3.453777313232422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.14706134796142578  GigaBytes
Max Memory Allocated: 0.14706134796142578  GigaBytes

torch.Size([168054, 128])
torch.Size([167911, 32])
torch.Size([167605, 32])
torch.Size([166761, 32])
torch.Size([162867, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.6242427825927734  GigaBytes
Max Memory Allocated: 0.6310186386108398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.15572547912597656  GigaBytes
Max Memory Allocated: 0.6476683616638184  GigaBytes

torch.Size([168042, 128])
torch.Size([167916, 32])
torch.Size([167614, 32])
torch.Size([166791, 32])
torch.Size([162957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.6279211044311523  GigaBytes
Max Memory Allocated: 0.6476683616638184  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03995954990386963 |0.18221068382263184 |0.3408515453338623 |0.00013113021850585938 |0.04781973361968994 |0.0071485042572021484 |
----------------------------------------------------------pseudo_mini_loss sum 5.201621055603027
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1935968
Number of first layer input nodes during this epoch:  336096
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2980380058288574  GigaBytes
Max Memory Allocated: 0.6514320373535156  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02099776268005371
range selection method range initialization spend 0.011584997177124023
time for parepare:  0.017070531845092773
local_output_nid generation:  0.010431766510009766
local_in_edges_tensor generation:  0.009247064590454102
mini_batch_src_global generation:  0.012730598449707031
r_  generation:  0.1703355312347412
local_output_nid generation:  0.011631965637207031
local_in_edges_tensor generation:  0.00993490219116211
mini_batch_src_global generation:  0.016561508178710938
r_  generation:  0.1755056381225586
----------------------check_connections_block total spend ----------------------------- 0.5015933513641357
generate_one_block  0.20061135292053223
generate_one_block  0.20025086402893066
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.041388511657714844
gen group dst list time:  0.006946563720703125
time for parepare:  0.0199887752532959
local_output_nid generation:  0.017705917358398438
local_in_edges_tensor generation:  0.04290056228637695
mini_batch_src_global generation:  0.046705007553100586
r_  generation:  0.499737024307251
local_output_nid generation:  0.025307655334472656
local_in_edges_tensor generation:  0.04520392417907715
mini_batch_src_global generation:  0.057715654373168945
r_  generation:  0.5187673568725586
----------------------check_connections_block total spend ----------------------------- 1.4942781925201416
generate_one_block  0.6484811305999756
generate_one_block  0.6536388397216797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03559279441833496
gen group dst list time:  0.011468172073364258
time for parepare:  0.019523143768310547
local_output_nid generation:  0.021164655685424805
local_in_edges_tensor generation:  0.039786577224731445
mini_batch_src_global generation:  0.054164886474609375
r_  generation:  0.5624730587005615
local_output_nid generation:  0.03426980972290039
local_in_edges_tensor generation:  0.05267500877380371
mini_batch_src_global generation:  0.06297016143798828
r_  generation:  0.5730576515197754
----------------------check_connections_block total spend ----------------------------- 1.6686997413635254
generate_one_block  0.7345795631408691
generate_one_block  0.7380361557006836
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.036963701248168945
gen group dst list time:  0.011972188949584961
time for parepare:  0.02007150650024414
local_output_nid generation:  0.02343583106994629
local_in_edges_tensor generation:  0.04531407356262207
mini_batch_src_global generation:  0.04988408088684082
r_  generation:  0.5576460361480713
local_output_nid generation:  0.035195350646972656
local_in_edges_tensor generation:  0.05192375183105469
mini_batch_src_global generation:  0.0651235580444336
r_  generation:  0.5724802017211914
----------------------check_connections_block total spend ----------------------------- 1.6759371757507324
generate_one_block  0.7373170852661133
generate_one_block  0.7246036529541016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029262542724609375
gen group dst list time:  0.012248039245605469
time for parepare:  0.019253969192504883
local_output_nid generation:  0.0230100154876709
local_in_edges_tensor generation:  0.038454294204711914
mini_batch_src_global generation:  0.050014495849609375
r_  generation:  0.5700147151947021
local_output_nid generation:  0.032469987869262695
local_in_edges_tensor generation:  0.03762698173522949
mini_batch_src_global generation:  0.06696319580078125
r_  generation:  0.5775291919708252
----------------------check_connections_block total spend ----------------------------- 1.6759424209594727
generate_one_block  0.7112836837768555
generate_one_block  0.7073969841003418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04676246643066406
gen group dst list time:  0.012488603591918945
time for parepare:  0.019034624099731445
local_output_nid generation:  0.024790287017822266
local_in_edges_tensor generation:  0.04647326469421387
mini_batch_src_global generation:  0.04611921310424805
r_  generation:  0.5136528015136719
local_output_nid generation:  0.03586888313293457
local_in_edges_tensor generation:  0.04078340530395508
mini_batch_src_global generation:  0.06404876708984375
r_  generation:  0.5150008201599121
----------------------check_connections_block total spend ----------------------------- 1.5448362827301025
generate_one_block  0.6419415473937988
generate_one_block  0.6555721759796143
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2980380058288574  GigaBytes
Max Memory Allocated: 0.6514320373535156  GigaBytes

connection checking time:  8.059693813323975
block generation total time  6.952850818634033
average batch blocks generation time:  3.4764254093170166
block dataloader generation time/epoch 17.23840594291687
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.15622282028198242  GigaBytes
Max Memory Allocated: 0.6514320373535156  GigaBytes

torch.Size([167980, 128])
torch.Size([167842, 32])
torch.Size([167548, 32])
torch.Size([166730, 32])
torch.Size([162865, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.6284627914428711  GigaBytes
Max Memory Allocated: 0.6514320373535156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.1558070182800293  GigaBytes
Max Memory Allocated: 0.6519942283630371  GigaBytes

torch.Size([168024, 128])
torch.Size([167874, 32])
torch.Size([167580, 32])
torch.Size([166735, 32])
torch.Size([162831, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.6276483535766602  GigaBytes
Max Memory Allocated: 0.6519942283630371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07792842388153076 |0.05978214740753174 |0.007146120071411133 |0.00010454654693603516 |0.008642077445983887 |0.005696773529052734 |
----------------------------------------------------------pseudo_mini_loss sum 4.6830244064331055
Total (block generation + training)time/epoch 17.612128257751465
Training time/epoch 0.373441219329834
Training time without block to device /epoch 0.2538769245147705
Training time without total dataloading part /epoch 0.037482261657714844
load block tensor time/epoch 0.15585684776306152
block to device time/epoch 0.11956429481506348
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1935276
Number of first layer input nodes during this epoch:  336004
