Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446949.5015066
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026210546493530273
range selection method range initialization spend 0.013971090316772461
time for parepare:  0.01804828643798828
local_output_nid generation:  0.0031366348266601562
local_in_edges_tensor generation:  0.004348278045654297
mini_batch_src_global generation:  0.0038957595825195312
r_  generation:  0.04351806640625
local_output_nid generation:  0.0035352706909179688
local_in_edges_tensor generation:  0.0016937255859375
mini_batch_src_global generation:  0.0047190189361572266
r_  generation:  0.04418182373046875
local_output_nid generation:  0.003542661666870117
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.0033566951751708984
r_  generation:  0.04678797721862793
local_output_nid generation:  0.003662109375
local_in_edges_tensor generation:  0.0017049312591552734
mini_batch_src_global generation:  0.0033845901489257812
r_  generation:  0.04635190963745117
local_output_nid generation:  0.0035691261291503906
local_in_edges_tensor generation:  0.0016949176788330078
mini_batch_src_global generation:  0.0036246776580810547
r_  generation:  0.04750204086303711
local_output_nid generation:  0.003586292266845703
local_in_edges_tensor generation:  0.0017049312591552734
mini_batch_src_global generation:  0.0037200450897216797
r_  generation:  0.0475764274597168
local_output_nid generation:  0.0035796165466308594
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.0037250518798828125
r_  generation:  0.04849982261657715
local_output_nid generation:  0.0036237239837646484
local_in_edges_tensor generation:  0.0016796588897705078
mini_batch_src_global generation:  0.0038514137268066406
r_  generation:  0.049082040786743164
----------------------check_connections_block total spend ----------------------------- 0.5439200401306152
generate_one_block  0.061298370361328125
generate_one_block  0.06186079978942871
generate_one_block  0.06267404556274414
generate_one_block  0.06100940704345703
generate_one_block  0.06349396705627441
generate_one_block  0.06188774108886719
generate_one_block  0.06216239929199219
generate_one_block  0.06289172172546387
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04096722602844238
gen group dst list time:  0.016780376434326172
time for parepare:  0.019806623458862305
local_output_nid generation:  0.011384963989257812
local_in_edges_tensor generation:  0.03138875961303711
mini_batch_src_global generation:  0.035393714904785156
r_  generation:  0.358731746673584
local_output_nid generation:  0.01818394660949707
local_in_edges_tensor generation:  0.031990766525268555
mini_batch_src_global generation:  0.04485750198364258
r_  generation:  0.37415099143981934
local_output_nid generation:  0.018657445907592773
local_in_edges_tensor generation:  0.02945566177368164
mini_batch_src_global generation:  0.04446578025817871
r_  generation:  0.3981459140777588
local_output_nid generation:  0.019988059997558594
local_in_edges_tensor generation:  0.036658287048339844
mini_batch_src_global generation:  0.049471378326416016
r_  generation:  0.37662649154663086
local_output_nid generation:  0.019411087036132812
local_in_edges_tensor generation:  0.026368379592895508
mini_batch_src_global generation:  0.04559683799743652
r_  generation:  0.37659668922424316
local_output_nid generation:  0.01972484588623047
local_in_edges_tensor generation:  0.030197858810424805
mini_batch_src_global generation:  0.04659128189086914
r_  generation:  0.38391995429992676
local_output_nid generation:  0.01986527442932129
local_in_edges_tensor generation:  0.023279666900634766
mini_batch_src_global generation:  0.04693412780761719
r_  generation:  0.3973371982574463
local_output_nid generation:  0.02252817153930664
local_in_edges_tensor generation:  0.030427932739257812
mini_batch_src_global generation:  0.04746842384338379
r_  generation:  0.38503503799438477
----------------------check_connections_block total spend ----------------------------- 4.461653470993042
generate_one_block  0.4935591220855713
generate_one_block  0.4854271411895752
generate_one_block  0.5013823509216309
generate_one_block  0.4907846450805664
generate_one_block  0.4810645580291748
generate_one_block  0.5102651119232178
generate_one_block  0.5132763385772705
generate_one_block  0.5040879249572754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.051613807678222656
gen group dst list time:  0.042079925537109375
time for parepare:  0.026612520217895508
local_output_nid generation:  0.026046037673950195
local_in_edges_tensor generation:  0.0650942325592041
mini_batch_src_global generation:  0.05284309387207031
r_  generation:  0.5723991394042969
local_output_nid generation:  0.03780078887939453
local_in_edges_tensor generation:  0.06481599807739258
mini_batch_src_global generation:  0.06537985801696777
r_  generation:  0.5683333873748779
local_output_nid generation:  0.035008907318115234
local_in_edges_tensor generation:  0.05929136276245117
mini_batch_src_global generation:  0.06171894073486328
r_  generation:  0.5860080718994141
local_output_nid generation:  0.03993678092956543
local_in_edges_tensor generation:  0.04862236976623535
mini_batch_src_global generation:  0.06824350357055664
r_  generation:  0.5612022876739502
local_output_nid generation:  0.03547334671020508
local_in_edges_tensor generation:  0.052350759506225586
mini_batch_src_global generation:  0.06209278106689453
r_  generation:  0.5848879814147949
local_output_nid generation:  0.03639698028564453
local_in_edges_tensor generation:  0.04422760009765625
mini_batch_src_global generation:  0.06189274787902832
r_  generation:  0.5809938907623291
local_output_nid generation:  0.03760385513305664
local_in_edges_tensor generation:  0.05725431442260742
mini_batch_src_global generation:  0.06675434112548828
r_  generation:  0.6001796722412109
local_output_nid generation:  0.03810739517211914
local_in_edges_tensor generation:  0.04825925827026367
mini_batch_src_global generation:  0.07235527038574219
r_  generation:  0.5712804794311523
----------------------check_connections_block total spend ----------------------------- 6.909583568572998
generate_one_block  0.7301974296569824
generate_one_block  0.728884220123291
generate_one_block  0.7451028823852539
generate_one_block  0.707327127456665
generate_one_block  0.7054376602172852
generate_one_block  0.7291779518127441
generate_one_block  0.7666311264038086
generate_one_block  0.7359154224395752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  11.37123703956604
block generation total time  9.828521013259888
average batch blocks generation time:  1.228565126657486
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10158348083496094  GigaBytes
Max Memory Allocated: 0.10158348083496094  GigaBytes

torch.Size([162548, 128])
torch.Size([145890, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.2279057502746582  GigaBytes
Max Memory Allocated: 0.23004531860351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10363054275512695  GigaBytes
Max Memory Allocated: 0.24233675003051758  GigaBytes

torch.Size([162733, 128])
torch.Size([146163, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22740554809570312  GigaBytes
Max Memory Allocated: 0.24233675003051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10409832000732422  GigaBytes
Max Memory Allocated: 0.24233675003051758  GigaBytes

torch.Size([162744, 128])
torch.Size([146114, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2280120849609375  GigaBytes
Max Memory Allocated: 0.24233675003051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10382366180419922  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162555, 128])
torch.Size([145692, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22746038436889648  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10395431518554688  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162458, 128])
torch.Size([145578, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22727727890014648  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.1038064956665039  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162710, 128])
torch.Size([146148, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2279186248779297  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.1040182113647461  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162533, 128])
torch.Size([146035, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2280254364013672  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10392475128173828  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162589, 128])
torch.Size([145738, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22761964797973633  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033019185066223145 |0.05835598707199097 |0.09573197364807129 |0.00010901689529418945 |0.011580288410186768 |0.003989458084106445 |
----------------------------------------------------------pseudo_mini_loss sum 5.037511348724365
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057421
Number of first layer input nodes during this epoch:  1300870
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.15297842025756836  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023015975952148438
range selection method range initialization spend 0.011476278305053711
time for parepare:  0.017271995544433594
local_output_nid generation:  0.0030946731567382812
local_in_edges_tensor generation:  0.006227016448974609
mini_batch_src_global generation:  0.0036258697509765625
r_  generation:  0.041400909423828125
local_output_nid generation:  0.0035300254821777344
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.004669666290283203
r_  generation:  0.043740272521972656
local_output_nid generation:  0.00345611572265625
local_in_edges_tensor generation:  0.0017600059509277344
mini_batch_src_global generation:  0.0032286643981933594
r_  generation:  0.046317100524902344
local_output_nid generation:  0.003539562225341797
local_in_edges_tensor generation:  0.00170135498046875
mini_batch_src_global generation:  0.003300905227661133
r_  generation:  0.045447587966918945
local_output_nid generation:  0.0035636425018310547
local_in_edges_tensor generation:  0.0017261505126953125
mini_batch_src_global generation:  0.0034668445587158203
r_  generation:  0.04667353630065918
local_output_nid generation:  0.0035381317138671875
local_in_edges_tensor generation:  0.0017495155334472656
mini_batch_src_global generation:  0.0038161277770996094
r_  generation:  0.04810953140258789
local_output_nid generation:  0.0035648345947265625
local_in_edges_tensor generation:  0.0017631053924560547
mini_batch_src_global generation:  0.0037903785705566406
r_  generation:  0.04926586151123047
local_output_nid generation:  0.0036187171936035156
local_in_edges_tensor generation:  0.0018084049224853516
mini_batch_src_global generation:  0.0037870407104492188
r_  generation:  0.04886817932128906
----------------------check_connections_block total spend ----------------------------- 0.5402960777282715
generate_one_block  0.06362056732177734
generate_one_block  0.06041097640991211
generate_one_block  0.06361985206604004
generate_one_block  0.06070542335510254
generate_one_block  0.062187910079956055
generate_one_block  0.06485342979431152
generate_one_block  0.06620597839355469
generate_one_block  0.06554889678955078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0433349609375
gen group dst list time:  0.016517162322998047
time for parepare:  0.022263526916503906
local_output_nid generation:  0.011028051376342773
local_in_edges_tensor generation:  0.03302192687988281
mini_batch_src_global generation:  0.037578582763671875
r_  generation:  0.36768198013305664
local_output_nid generation:  0.01831793785095215
local_in_edges_tensor generation:  0.03756427764892578
mini_batch_src_global generation:  0.05029010772705078
r_  generation:  0.39176249504089355
local_output_nid generation:  0.020731687545776367
local_in_edges_tensor generation:  0.03394651412963867
mini_batch_src_global generation:  0.05044364929199219
r_  generation:  0.38213038444519043
local_output_nid generation:  0.018311738967895508
local_in_edges_tensor generation:  0.02388143539428711
mini_batch_src_global generation:  0.045262813568115234
r_  generation:  0.38024067878723145
local_output_nid generation:  0.01876378059387207
local_in_edges_tensor generation:  0.02374124526977539
mini_batch_src_global generation:  0.04921746253967285
r_  generation:  0.3881099224090576
local_output_nid generation:  0.021136999130249023
local_in_edges_tensor generation:  0.030199289321899414
mini_batch_src_global generation:  0.04718589782714844
r_  generation:  0.4136934280395508
local_output_nid generation:  0.021975278854370117
local_in_edges_tensor generation:  0.0329585075378418
mini_batch_src_global generation:  0.04993796348571777
r_  generation:  0.390411376953125
local_output_nid generation:  0.019014835357666016
local_in_edges_tensor generation:  0.02907252311706543
mini_batch_src_global generation:  0.04704785346984863
r_  generation:  0.3911600112915039
----------------------check_connections_block total spend ----------------------------- 4.557568788528442
generate_one_block  0.5106711387634277
generate_one_block  0.5199337005615234
generate_one_block  0.504035472869873
generate_one_block  0.498856782913208
generate_one_block  0.5036993026733398
generate_one_block  0.5024030208587646
generate_one_block  0.5137374401092529
generate_one_block  0.5446145534515381
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05257773399353027
gen group dst list time:  0.042032718658447266
time for parepare:  0.019432783126831055
local_output_nid generation:  0.02529454231262207
local_in_edges_tensor generation:  0.06619524955749512
mini_batch_src_global generation:  0.05579352378845215
r_  generation:  0.545947790145874
local_output_nid generation:  0.03257489204406738
local_in_edges_tensor generation:  0.05359840393066406
mini_batch_src_global generation:  0.06340408325195312
r_  generation:  0.5514636039733887
local_output_nid generation:  0.03296971321105957
local_in_edges_tensor generation:  0.04044795036315918
mini_batch_src_global generation:  0.061357975006103516
r_  generation:  0.5635242462158203
local_output_nid generation:  0.03363752365112305
local_in_edges_tensor generation:  0.03494834899902344
mini_batch_src_global generation:  0.06044197082519531
r_  generation:  0.5792379379272461
local_output_nid generation:  0.033747196197509766
local_in_edges_tensor generation:  0.035491228103637695
mini_batch_src_global generation:  0.06160449981689453
r_  generation:  0.5718998908996582
local_output_nid generation:  0.034380435943603516
local_in_edges_tensor generation:  0.050435543060302734
mini_batch_src_global generation:  0.062061309814453125
r_  generation:  0.5691566467285156
local_output_nid generation:  0.033711910247802734
local_in_edges_tensor generation:  0.03574371337890625
mini_batch_src_global generation:  0.06328129768371582
r_  generation:  0.575836181640625
local_output_nid generation:  0.03450655937194824
local_in_edges_tensor generation:  0.04044842720031738
mini_batch_src_global generation:  0.06281399726867676
r_  generation:  0.5752949714660645
----------------------check_connections_block total spend ----------------------------- 6.648303508758545
generate_one_block  0.7084901332855225
generate_one_block  0.7106270790100098
generate_one_block  0.7198443412780762
generate_one_block  0.7048182487487793
generate_one_block  0.7163584232330322
generate_one_block  0.7385718822479248
generate_one_block  0.7280902862548828
generate_one_block  0.7220125198364258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.15297842025756836  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

connection checking time:  11.205872297286987
block generation total time  9.846764326095581
average batch blocks generation time:  1.2308455407619476
block dataloader generation time/epoch 23.20904302597046
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10390186309814453  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162558, 128])
torch.Size([145722, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2274479866027832  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10329484939575195  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162619, 128])
torch.Size([145914, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22771978378295898  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10381698608398438  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162668, 128])
torch.Size([146172, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22800827026367188  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10382461547851562  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162448, 128])
torch.Size([145528, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22600221633911133  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10348320007324219  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

torch.Size([162573, 128])
torch.Size([145617, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22780895233154297  GigaBytes
Max Memory Allocated: 0.24258661270141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10372161865234375  GigaBytes
Max Memory Allocated: 0.2426462173461914  GigaBytes

torch.Size([162612, 128])
torch.Size([146029, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22805452346801758  GigaBytes
Max Memory Allocated: 0.2426462173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10399532318115234  GigaBytes
Max Memory Allocated: 0.24288558959960938  GigaBytes

torch.Size([162585, 128])
torch.Size([146080, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.2279052734375  GigaBytes
Max Memory Allocated: 0.24288558959960938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.10400199890136719  GigaBytes
Max Memory Allocated: 0.24288654327392578  GigaBytes

torch.Size([162763, 128])
torch.Size([146668, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.22826719284057617  GigaBytes
Max Memory Allocated: 0.24288654327392578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03036591410636902 |0.01764705777168274 |0.003605455160140991 |9.229779243469238e-05 |0.006070137023925781 |0.002905130386352539 |
----------------------------------------------------------pseudo_mini_loss sum 4.318633079528809
Total (block generation + training)time/epoch 23.684410333633423
Training time/epoch 0.47507548332214355
Training time without block to device /epoch 0.33389902114868164
Training time without total dataloading part /epoch 0.08104825019836426
load block tensor time/epoch 0.24292731285095215
block to device time/epoch 0.14117646217346191
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057769
Number of first layer input nodes during this epoch:  1300826
