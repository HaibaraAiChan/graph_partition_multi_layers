Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648499622.6640472
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.026076316833496094
range selection method range initialization spend 0.016761302947998047
time for parepare:  0.017838716506958008
local_output_nid generation:  0.002625703811645508
local_in_edges_tensor generation:  0.0046117305755615234
mini_batch_src_global generation:  0.0038328170776367188
r_  generation:  0.05184292793273926
local_output_nid generation:  0.003015279769897461
local_in_edges_tensor generation:  0.0016989707946777344
mini_batch_src_global generation:  0.004112958908081055
r_  generation:  0.038274526596069336
local_output_nid generation:  0.003143787384033203
local_in_edges_tensor generation:  0.0016269683837890625
mini_batch_src_global generation:  0.0027222633361816406
r_  generation:  0.03930377960205078
local_output_nid generation:  0.003137350082397461
local_in_edges_tensor generation:  0.001692056655883789
mini_batch_src_global generation:  0.0029175281524658203
r_  generation:  0.03951287269592285
local_output_nid generation:  0.003173828125
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0029408931732177734
r_  generation:  0.04117703437805176
local_output_nid generation:  0.003121614456176758
local_in_edges_tensor generation:  0.0016546249389648438
mini_batch_src_global generation:  0.0031137466430664062
r_  generation:  0.04022502899169922
local_output_nid generation:  0.003177165985107422
local_in_edges_tensor generation:  0.001695394515991211
mini_batch_src_global generation:  0.0030999183654785156
r_  generation:  0.04049324989318848
local_output_nid generation:  0.0031042098999023438
local_in_edges_tensor generation:  0.0016491413116455078
mini_batch_src_global generation:  0.003155231475830078
r_  generation:  0.0411221981048584
----------------------check_connections_block total spend ----------------------------- 0.4847526550292969
generate_one_block  0.054486989974975586
generate_one_block  0.054885149002075195
generate_one_block  0.055068016052246094
generate_one_block  0.05501604080200195
generate_one_block  0.057256460189819336
generate_one_block  0.054444074630737305
generate_one_block  0.05421853065490723
generate_one_block  0.05478549003601074
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.042247772216796875
gen group dst list time:  0.015070438385009766
time for parepare:  0.018828153610229492
local_output_nid generation:  0.010529279708862305
local_in_edges_tensor generation:  0.029502153396606445
mini_batch_src_global generation:  0.027869462966918945
r_  generation:  0.296875
local_output_nid generation:  0.01577472686767578
local_in_edges_tensor generation:  0.027739524841308594
mini_batch_src_global generation:  0.03665351867675781
r_  generation:  0.30811262130737305
local_output_nid generation:  0.01604485511779785
local_in_edges_tensor generation:  0.026152849197387695
mini_batch_src_global generation:  0.039351463317871094
r_  generation:  0.31989526748657227
local_output_nid generation:  0.016316652297973633
local_in_edges_tensor generation:  0.017806053161621094
mini_batch_src_global generation:  0.03680133819580078
r_  generation:  0.3087794780731201
local_output_nid generation:  0.016787290573120117
local_in_edges_tensor generation:  0.01847076416015625
mini_batch_src_global generation:  0.04038548469543457
r_  generation:  0.3169069290161133
local_output_nid generation:  0.016779184341430664
local_in_edges_tensor generation:  0.020892620086669922
mini_batch_src_global generation:  0.038695335388183594
r_  generation:  0.31562042236328125
local_output_nid generation:  0.02021956443786621
local_in_edges_tensor generation:  0.02133011817932129
mini_batch_src_global generation:  0.04149174690246582
r_  generation:  0.31696391105651855
local_output_nid generation:  0.01695394515991211
local_in_edges_tensor generation:  0.023656368255615234
mini_batch_src_global generation:  0.038130760192871094
r_  generation:  0.32128024101257324
----------------------check_connections_block total spend ----------------------------- 3.678079843521118
generate_one_block  0.40988588333129883
generate_one_block  0.41405367851257324
generate_one_block  0.4162750244140625
generate_one_block  0.3990485668182373
generate_one_block  0.41629457473754883
generate_one_block  0.413463830947876
generate_one_block  0.41237330436706543
generate_one_block  0.4205942153930664
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03696322441101074
gen group dst list time:  0.035788536071777344
time for parepare:  0.019185304641723633
local_output_nid generation:  0.02532649040222168
local_in_edges_tensor generation:  0.04269218444824219
mini_batch_src_global generation:  0.054171085357666016
r_  generation:  0.5302691459655762
local_output_nid generation:  0.0323331356048584
local_in_edges_tensor generation:  0.05129551887512207
mini_batch_src_global generation:  0.06037425994873047
r_  generation:  0.5338761806488037
local_output_nid generation:  0.03252530097961426
local_in_edges_tensor generation:  0.04332756996154785
mini_batch_src_global generation:  0.05884218215942383
r_  generation:  0.5449671745300293
local_output_nid generation:  0.033667564392089844
local_in_edges_tensor generation:  0.03439474105834961
mini_batch_src_global generation:  0.08454179763793945
r_  generation:  0.5461921691894531
local_output_nid generation:  0.034809112548828125
local_in_edges_tensor generation:  0.04614424705505371
mini_batch_src_global generation:  0.05845808982849121
r_  generation:  0.5556786060333252
local_output_nid generation:  0.0337672233581543
local_in_edges_tensor generation:  0.05524897575378418
mini_batch_src_global generation:  0.06988358497619629
r_  generation:  0.559274435043335
local_output_nid generation:  0.03648853302001953
local_in_edges_tensor generation:  0.03794288635253906
mini_batch_src_global generation:  0.06443953514099121
r_  generation:  0.5474295616149902
local_output_nid generation:  0.03600311279296875
local_in_edges_tensor generation:  0.03789067268371582
mini_batch_src_global generation:  0.06542468070983887
r_  generation:  0.5413997173309326
----------------------check_connections_block total spend ----------------------------- 6.4479100704193115
generate_one_block  0.6742420196533203
generate_one_block  0.6999073028564453
generate_one_block  0.6876931190490723
generate_one_block  0.6737523078918457
generate_one_block  0.6935176849365234
generate_one_block  0.7215275764465332
generate_one_block  0.6791403293609619
generate_one_block  0.6937072277069092
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05433964729309082
gen group dst list time:  0.04601001739501953
time for parepare:  0.019148826599121094
local_output_nid generation:  0.029972314834594727
local_in_edges_tensor generation:  0.06484556198120117
mini_batch_src_global generation:  0.054056644439697266
r_  generation:  0.5367770195007324
local_output_nid generation:  0.03612637519836426
local_in_edges_tensor generation:  0.05568289756774902
mini_batch_src_global generation:  0.06265997886657715
r_  generation:  0.5459327697753906
local_output_nid generation:  0.03628182411193848
local_in_edges_tensor generation:  0.04225873947143555
mini_batch_src_global generation:  0.06248044967651367
r_  generation:  0.5488584041595459
local_output_nid generation:  0.03638267517089844
local_in_edges_tensor generation:  0.04797220230102539
mini_batch_src_global generation:  0.05896329879760742
r_  generation:  0.5668714046478271
local_output_nid generation:  0.03670501708984375
local_in_edges_tensor generation:  0.04787302017211914
mini_batch_src_global generation:  0.060529470443725586
r_  generation:  0.5493652820587158
local_output_nid generation:  0.036681413650512695
local_in_edges_tensor generation:  0.04334068298339844
mini_batch_src_global generation:  0.06032299995422363
r_  generation:  0.5581667423248291
local_output_nid generation:  0.03697943687438965
local_in_edges_tensor generation:  0.0379335880279541
mini_batch_src_global generation:  0.05904030799865723
r_  generation:  0.5552723407745361
local_output_nid generation:  0.036791086196899414
local_in_edges_tensor generation:  0.04262685775756836
mini_batch_src_global generation:  0.06380772590637207
r_  generation:  0.5710880756378174
----------------------check_connections_block total spend ----------------------------- 6.605033874511719
generate_one_block  0.6954014301300049
generate_one_block  0.6994614601135254
generate_one_block  0.6953036785125732
generate_one_block  0.7171459197998047
generate_one_block  0.6958763599395752
generate_one_block  0.7051236629486084
generate_one_block  0.7317979335784912
generate_one_block  0.6865684986114502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04056978225708008
gen group dst list time:  0.05085897445678711
time for parepare:  0.01970529556274414
local_output_nid generation:  0.03238534927368164
local_in_edges_tensor generation:  0.0488889217376709
mini_batch_src_global generation:  0.04838109016418457
r_  generation:  0.5096156597137451
local_output_nid generation:  0.03708910942077637
local_in_edges_tensor generation:  0.040363311767578125
mini_batch_src_global generation:  0.058087825775146484
r_  generation:  0.5100233554840088
local_output_nid generation:  0.040313005447387695
local_in_edges_tensor generation:  0.04257035255432129
mini_batch_src_global generation:  0.06133747100830078
r_  generation:  0.5127315521240234
local_output_nid generation:  0.03824973106384277
local_in_edges_tensor generation:  0.043463945388793945
mini_batch_src_global generation:  0.0590519905090332
r_  generation:  0.5131030082702637
local_output_nid generation:  0.03820204734802246
local_in_edges_tensor generation:  0.03565716743469238
mini_batch_src_global generation:  0.06763315200805664
r_  generation:  0.5137200355529785
local_output_nid generation:  0.04044198989868164
local_in_edges_tensor generation:  0.03690481185913086
mini_batch_src_global generation:  0.056761980056762695
r_  generation:  0.5166735649108887
local_output_nid generation:  0.039168357849121094
local_in_edges_tensor generation:  0.03786635398864746
mini_batch_src_global generation:  0.05827903747558594
r_  generation:  0.5134637355804443
local_output_nid generation:  0.03921079635620117
local_in_edges_tensor generation:  0.03892993927001953
mini_batch_src_global generation:  0.057161808013916016
r_  generation:  0.519967794418335
----------------------check_connections_block total spend ----------------------------- 6.175403833389282
generate_one_block  0.6279301643371582
generate_one_block  0.6443562507629395
generate_one_block  0.6407372951507568
generate_one_block  0.6634624004364014
generate_one_block  0.6399075984954834
generate_one_block  0.6362476348876953
generate_one_block  0.631481409072876
generate_one_block  0.6882240772247314
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

connection checking time:  22.90642762184143
block generation total time  19.624502420425415
average batch blocks generation time:  2.453062802553177
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.1276402473449707  GigaBytes
Max Memory Allocated: 0.1276402473449707  GigaBytes

torch.Size([167030, 128])
torch.Size([165840, 256])
torch.Size([161498, 256])
torch.Size([142120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7987060546875 GB
    Memory Allocated: 2.281928062438965  GigaBytes
Max Memory Allocated: 2.3422231674194336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 0.1316242218017578  GigaBytes
Max Memory Allocated: 2.410816192626953  GigaBytes

torch.Size([166841, 128])
torch.Size([165624, 256])
torch.Size([161267, 256])
torch.Size([142012, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.281132221221924  GigaBytes
Max Memory Allocated: 2.410816192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.13170623779296875  GigaBytes
Max Memory Allocated: 2.410816192626953  GigaBytes

torch.Size([166973, 128])
torch.Size([165742, 256])
torch.Size([161367, 256])
torch.Size([142037, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.283102512359619  GigaBytes
Max Memory Allocated: 2.410816192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.13175058364868164  GigaBytes
Max Memory Allocated: 2.4124693870544434  GigaBytes

torch.Size([166968, 128])
torch.Size([165845, 256])
torch.Size([161357, 256])
torch.Size([141815, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.2788686752319336  GigaBytes
Max Memory Allocated: 2.4124693870544434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 0.13108444213867188  GigaBytes
Max Memory Allocated: 2.4124693870544434  GigaBytes

torch.Size([166981, 128])
torch.Size([165820, 256])
torch.Size([161477, 256])
torch.Size([142373, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4881591796875 GB
    Memory Allocated: 2.288633346557617  GigaBytes
Max Memory Allocated: 2.4124693870544434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.13180065155029297  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166971, 128])
torch.Size([165868, 256])
torch.Size([161503, 256])
torch.Size([141989, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 2.279507637023926  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.1310129165649414  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166925, 128])
torch.Size([165720, 256])
torch.Size([161229, 256])
torch.Size([141851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 2.2800121307373047  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.1316542625427246  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166969, 128])
torch.Size([165789, 256])
torch.Size([161413, 256])
torch.Size([142226, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 2.2825050354003906  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13400018215179443 |0.07300311326980591 |0.10041537880897522 |0.00010907649993896484 |0.062423110008239746 |0.003146648406982422 |
----------------------------------------------------------pseudo_mini_loss sum 6.040450572967529
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5631940
Number of first layer input nodes during this epoch:  1335658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.21785449981689453  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.029387235641479492
range selection method range initialization spend 0.011778593063354492
time for parepare:  0.01702880859375
local_output_nid generation:  0.0027015209197998047
local_in_edges_tensor generation:  0.011590003967285156
mini_batch_src_global generation:  0.0035152435302734375
r_  generation:  0.03616809844970703
local_output_nid generation:  0.003124237060546875
local_in_edges_tensor generation:  0.001678466796875
mini_batch_src_global generation:  0.004172801971435547
r_  generation:  0.039053916931152344
local_output_nid generation:  0.0032265186309814453
local_in_edges_tensor generation:  0.0017902851104736328
mini_batch_src_global generation:  0.0027971267700195312
r_  generation:  0.039526939392089844
local_output_nid generation:  0.0032341480255126953
local_in_edges_tensor generation:  0.001714468002319336
mini_batch_src_global generation:  0.00287628173828125
r_  generation:  0.04053688049316406
local_output_nid generation:  0.003193378448486328
local_in_edges_tensor generation:  0.0016977787017822266
mini_batch_src_global generation:  0.0030171871185302734
r_  generation:  0.041053056716918945
local_output_nid generation:  0.003177165985107422
local_in_edges_tensor generation:  0.0017018318176269531
mini_batch_src_global generation:  0.003152608871459961
r_  generation:  0.041461944580078125
local_output_nid generation:  0.0033011436462402344
local_in_edges_tensor generation:  0.0017404556274414062
mini_batch_src_global generation:  0.003179311752319336
r_  generation:  0.04186558723449707
local_output_nid generation:  0.003224611282348633
local_in_edges_tensor generation:  0.0017199516296386719
mini_batch_src_global generation:  0.003217458724975586
r_  generation:  0.041895389556884766
----------------------check_connections_block total spend ----------------------------- 0.48238325119018555
generate_one_block  0.05250120162963867
generate_one_block  0.054733991622924805
generate_one_block  0.054421186447143555
generate_one_block  0.054123878479003906
generate_one_block  0.05422377586364746
generate_one_block  0.054822444915771484
generate_one_block  0.055745601654052734
generate_one_block  0.057497262954711914
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04972028732299805
gen group dst list time:  0.01400899887084961
time for parepare:  0.01880335807800293
local_output_nid generation:  0.010254383087158203
local_in_edges_tensor generation:  0.03182578086853027
mini_batch_src_global generation:  0.02836441993713379
r_  generation:  0.2981109619140625
local_output_nid generation:  0.015370845794677734
local_in_edges_tensor generation:  0.0276639461517334
mini_batch_src_global generation:  0.03656601905822754
r_  generation:  0.31043028831481934
local_output_nid generation:  0.016649723052978516
local_in_edges_tensor generation:  0.02221536636352539
mini_batch_src_global generation:  0.0361788272857666
r_  generation:  0.3235654830932617
local_output_nid generation:  0.017232656478881836
local_in_edges_tensor generation:  0.020061016082763672
mini_batch_src_global generation:  0.04076433181762695
r_  generation:  0.3168337345123291
local_output_nid generation:  0.016434907913208008
local_in_edges_tensor generation:  0.019790172576904297
mini_batch_src_global generation:  0.04048013687133789
r_  generation:  0.32091569900512695
local_output_nid generation:  0.01643204689025879
local_in_edges_tensor generation:  0.019625186920166016
mini_batch_src_global generation:  0.037944793701171875
r_  generation:  0.3189876079559326
local_output_nid generation:  0.01670217514038086
local_in_edges_tensor generation:  0.02051067352294922
mini_batch_src_global generation:  0.0431056022644043
r_  generation:  0.3230588436126709
local_output_nid generation:  0.01934671401977539
local_in_edges_tensor generation:  0.020276546478271484
mini_batch_src_global generation:  0.04101920127868652
r_  generation:  0.3274989128112793
----------------------check_connections_block total spend ----------------------------- 3.7067337036132812
generate_one_block  0.4082624912261963
generate_one_block  0.4148366451263428
generate_one_block  0.4126851558685303
generate_one_block  0.4060513973236084
generate_one_block  0.4206554889678955
generate_one_block  0.40407371520996094
generate_one_block  0.4152345657348633
generate_one_block  0.453502893447876
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.046202659606933594
gen group dst list time:  0.03685355186462402
time for parepare:  0.019031047821044922
local_output_nid generation:  0.026157617568969727
local_in_edges_tensor generation:  0.05694389343261719
mini_batch_src_global generation:  0.053063154220581055
r_  generation:  0.5276713371276855
local_output_nid generation:  0.032393693923950195
local_in_edges_tensor generation:  0.05122208595275879
mini_batch_src_global generation:  0.06093287467956543
r_  generation:  0.5396461486816406
local_output_nid generation:  0.03289961814880371
local_in_edges_tensor generation:  0.03748011589050293
mini_batch_src_global generation:  0.05726909637451172
r_  generation:  0.5517539978027344
local_output_nid generation:  0.033989906311035156
local_in_edges_tensor generation:  0.037920475006103516
mini_batch_src_global generation:  0.0804131031036377
r_  generation:  0.5512387752532959
local_output_nid generation:  0.03485822677612305
local_in_edges_tensor generation:  0.051538944244384766
mini_batch_src_global generation:  0.06622958183288574
r_  generation:  0.5646286010742188
local_output_nid generation:  0.036041259765625
local_in_edges_tensor generation:  0.04141044616699219
mini_batch_src_global generation:  0.060884952545166016
r_  generation:  0.5468153953552246
local_output_nid generation:  0.0353851318359375
local_in_edges_tensor generation:  0.043694496154785156
mini_batch_src_global generation:  0.06292152404785156
r_  generation:  0.5601611137390137
local_output_nid generation:  0.0355532169342041
local_in_edges_tensor generation:  0.03817009925842285
mini_batch_src_global generation:  0.06196022033691406
r_  generation:  0.5656263828277588
----------------------check_connections_block total spend ----------------------------- 6.522502183914185
generate_one_block  0.7124576568603516
generate_one_block  0.7153949737548828
generate_one_block  0.6805999279022217
generate_one_block  0.6944527626037598
generate_one_block  0.6733131408691406
generate_one_block  0.6780900955200195
generate_one_block  0.6960816383361816
generate_one_block  0.7043514251708984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04863905906677246
gen group dst list time:  0.055544376373291016
time for parepare:  0.019634246826171875
local_output_nid generation:  0.031621456146240234
local_in_edges_tensor generation:  0.05904865264892578
mini_batch_src_global generation:  0.05547952651977539
r_  generation:  0.5385279655456543
local_output_nid generation:  0.0380702018737793
local_in_edges_tensor generation:  0.08688926696777344
mini_batch_src_global generation:  0.06163907051086426
r_  generation:  0.5468358993530273
local_output_nid generation:  0.036910295486450195
local_in_edges_tensor generation:  0.04154849052429199
mini_batch_src_global generation:  0.062486886978149414
r_  generation:  0.5471911430358887
local_output_nid generation:  0.037114620208740234
local_in_edges_tensor generation:  0.050801992416381836
mini_batch_src_global generation:  0.05865311622619629
r_  generation:  0.5530579090118408
local_output_nid generation:  0.03718113899230957
local_in_edges_tensor generation:  0.04614067077636719
mini_batch_src_global generation:  0.05863046646118164
r_  generation:  0.5558826923370361
local_output_nid generation:  0.03722834587097168
local_in_edges_tensor generation:  0.03688478469848633
mini_batch_src_global generation:  0.05867433547973633
r_  generation:  0.5573310852050781
local_output_nid generation:  0.03769350051879883
local_in_edges_tensor generation:  0.04185652732849121
mini_batch_src_global generation:  0.05926513671875
r_  generation:  0.5556912422180176
local_output_nid generation:  0.03731250762939453
local_in_edges_tensor generation:  0.04725360870361328
mini_batch_src_global generation:  0.058298349380493164
r_  generation:  0.5606439113616943
----------------------check_connections_block total spend ----------------------------- 6.623571157455444
generate_one_block  0.6957850456237793
generate_one_block  0.6761875152587891
generate_one_block  0.6820478439331055
generate_one_block  0.7024128437042236
generate_one_block  0.6926860809326172
generate_one_block  0.6841504573822021
generate_one_block  0.6892843246459961
generate_one_block  0.6830751895904541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04598712921142578
gen group dst list time:  0.05124473571777344
time for parepare:  0.01929759979248047
local_output_nid generation:  0.03307199478149414
local_in_edges_tensor generation:  0.055797576904296875
mini_batch_src_global generation:  0.0456690788269043
r_  generation:  0.506366491317749
local_output_nid generation:  0.03991103172302246
local_in_edges_tensor generation:  0.03462505340576172
mini_batch_src_global generation:  0.05721783638000488
r_  generation:  0.5087051391601562
local_output_nid generation:  0.039710044860839844
local_in_edges_tensor generation:  0.03649306297302246
mini_batch_src_global generation:  0.058121681213378906
r_  generation:  0.5081000328063965
local_output_nid generation:  0.038362741470336914
local_in_edges_tensor generation:  0.0351557731628418
mini_batch_src_global generation:  0.05830717086791992
r_  generation:  0.5135006904602051
local_output_nid generation:  0.03840327262878418
local_in_edges_tensor generation:  0.041773080825805664
mini_batch_src_global generation:  0.06560111045837402
r_  generation:  0.5320050716400146
local_output_nid generation:  0.04207777976989746
local_in_edges_tensor generation:  0.08872342109680176
mini_batch_src_global generation:  0.06046915054321289
r_  generation:  0.5227067470550537
local_output_nid generation:  0.0393214225769043
local_in_edges_tensor generation:  0.04551243782043457
mini_batch_src_global generation:  0.0577855110168457
r_  generation:  0.5296509265899658
local_output_nid generation:  0.03919792175292969
local_in_edges_tensor generation:  0.042557477951049805
mini_batch_src_global generation:  0.05820298194885254
r_  generation:  0.5229828357696533
----------------------check_connections_block total spend ----------------------------- 6.293019771575928
generate_one_block  0.6426811218261719
generate_one_block  0.6433932781219482
generate_one_block  0.6441211700439453
generate_one_block  0.6478092670440674
generate_one_block  0.6468374729156494
generate_one_block  0.6523785591125488
generate_one_block  0.6404688358306885
generate_one_block  0.6274185180664062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.21785449981689453  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

connection checking time:  23.145826816558838
block generation total time  19.540781497955322
average batch blocks generation time:  2.4425976872444153
block dataloader generation time/epoch 45.262293100357056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 0.1341543197631836  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166915, 128])
torch.Size([165667, 256])
torch.Size([161216, 256])
torch.Size([142388, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4901123046875 GB
    Memory Allocated: 2.288600444793701  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.135406494140625  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166918, 128])
torch.Size([165731, 256])
torch.Size([161270, 256])
torch.Size([141862, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.285541534423828  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13452577590942383  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166851, 128])
torch.Size([165567, 256])
torch.Size([161170, 256])
torch.Size([141840, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.2832789421081543  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13564443588256836  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166984, 128])
torch.Size([165810, 256])
torch.Size([161452, 256])
torch.Size([142083, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.2858662605285645  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13564825057983398  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166998, 128])
torch.Size([165801, 256])
torch.Size([161326, 256])
torch.Size([141821, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.28477144241333  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13558483123779297  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166928, 128])
torch.Size([165722, 256])
torch.Size([161233, 256])
torch.Size([141545, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.281200885772705  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.13463878631591797  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

torch.Size([166933, 128])
torch.Size([165768, 256])
torch.Size([161491, 256])
torch.Size([142398, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.2922840118408203  GigaBytes
Max Memory Allocated: 2.4181437492370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 0.1352405548095703  GigaBytes
Max Memory Allocated: 2.4220170974731445  GigaBytes

torch.Size([166949, 128])
torch.Size([165698, 256])
torch.Size([161231, 256])
torch.Size([141882, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 2.2848029136657715  GigaBytes
Max Memory Allocated: 2.4220170974731445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18838730454444885 |0.03389468789100647 |0.005576133728027344 |9.655952453613281e-05 |0.007198035717010498 |0.004694700241088867 |
----------------------------------------------------------pseudo_mini_loss sum 3.528806686401367
Total (block generation + training)time/epoch 47.342467069625854
Training time/epoch 2.0799624919891357
Training time without block to device /epoch 1.808804988861084
Training time without total dataloading part /epoch 0.10766053199768066
load block tensor time/epoch 1.5070984363555908
block to device time/epoch 0.27115750312805176
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5630565
Number of first layer input nodes during this epoch:  1335476
