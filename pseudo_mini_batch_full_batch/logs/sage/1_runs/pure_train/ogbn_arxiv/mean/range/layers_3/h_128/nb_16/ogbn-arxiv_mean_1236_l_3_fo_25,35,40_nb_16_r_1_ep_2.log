Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648449557.8603387
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024878501892089844
range selection method range initialization spend 0.01343083381652832
time for parepare:  0.017924070358276367
local_output_nid generation:  0.0013587474822998047
local_in_edges_tensor generation:  0.003912925720214844
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.017647981643676758
local_output_nid generation:  0.0014467239379882812
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.002130270004272461
r_  generation:  0.018090009689331055
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0008475780487060547
mini_batch_src_global generation:  0.0013628005981445312
r_  generation:  0.017949581146240234
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.0013823509216308594
r_  generation:  0.017650842666625977
local_output_nid generation:  0.0014889240264892578
local_in_edges_tensor generation:  0.0008487701416015625
mini_batch_src_global generation:  0.0012407302856445312
r_  generation:  0.01776862144470215
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.0013911724090576172
r_  generation:  0.018334388732910156
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0008463859558105469
mini_batch_src_global generation:  0.0013844966888427734
r_  generation:  0.019115924835205078
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0008573532104492188
mini_batch_src_global generation:  0.0014238357543945312
r_  generation:  0.018701791763305664
local_output_nid generation:  0.0014948844909667969
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.01868128776550293
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.001466989517211914
r_  generation:  0.018811464309692383
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0013897418975830078
r_  generation:  0.01920771598815918
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.001542806625366211
r_  generation:  0.019013166427612305
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0008187294006347656
mini_batch_src_global generation:  0.001493215560913086
r_  generation:  0.019010066986083984
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0014734268188476562
r_  generation:  0.019397735595703125
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.001531839370727539
r_  generation:  0.01931023597717285
local_output_nid generation:  0.0015091896057128906
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0015900135040283203
r_  generation:  0.018877506256103516
----------------------check_connections_block total spend ----------------------------- 0.4470653533935547
generate_one_block  0.026176929473876953
generate_one_block  0.027224063873291016
generate_one_block  0.029570817947387695
generate_one_block  0.027337074279785156
generate_one_block  0.02703571319580078
generate_one_block  0.027579307556152344
generate_one_block  0.02839803695678711
generate_one_block  0.027427196502685547
generate_one_block  0.0279843807220459
generate_one_block  0.02765631675720215
generate_one_block  0.02786111831665039
generate_one_block  0.028102874755859375
generate_one_block  0.027858495712280273
generate_one_block  0.028214454650878906
generate_one_block  0.028293848037719727
generate_one_block  0.027501583099365234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04034829139709473
gen group dst list time:  0.01892256736755371
time for parepare:  0.018801212310791016
local_output_nid generation:  0.006411552429199219
local_in_edges_tensor generation:  0.015197515487670898
mini_batch_src_global generation:  0.018476247787475586
r_  generation:  0.18674731254577637
local_output_nid generation:  0.009903669357299805
local_in_edges_tensor generation:  0.017702579498291016
mini_batch_src_global generation:  0.02509593963623047
r_  generation:  0.1924891471862793
local_output_nid generation:  0.010287046432495117
local_in_edges_tensor generation:  0.012571334838867188
mini_batch_src_global generation:  0.024817228317260742
r_  generation:  0.20482683181762695
local_output_nid generation:  0.010399103164672852
local_in_edges_tensor generation:  0.013088703155517578
mini_batch_src_global generation:  0.0243833065032959
r_  generation:  0.2016003131866455
local_output_nid generation:  0.010518789291381836
local_in_edges_tensor generation:  0.01312255859375
mini_batch_src_global generation:  0.02489638328552246
r_  generation:  0.20563030242919922
local_output_nid generation:  0.010808467864990234
local_in_edges_tensor generation:  0.013042449951171875
mini_batch_src_global generation:  0.02587270736694336
r_  generation:  0.20602035522460938
local_output_nid generation:  0.011141538619995117
local_in_edges_tensor generation:  0.015512704849243164
mini_batch_src_global generation:  0.030424833297729492
r_  generation:  0.21392321586608887
local_output_nid generation:  0.010788440704345703
local_in_edges_tensor generation:  0.011757612228393555
mini_batch_src_global generation:  0.02608966827392578
r_  generation:  0.20428848266601562
local_output_nid generation:  0.01117849349975586
local_in_edges_tensor generation:  0.012980222702026367
mini_batch_src_global generation:  0.03255963325500488
r_  generation:  0.21422028541564941
local_output_nid generation:  0.011041641235351562
local_in_edges_tensor generation:  0.015097618103027344
mini_batch_src_global generation:  0.02895832061767578
r_  generation:  0.2083117961883545
local_output_nid generation:  0.011263608932495117
local_in_edges_tensor generation:  0.013603448867797852
mini_batch_src_global generation:  0.0282745361328125
r_  generation:  0.21262359619140625
local_output_nid generation:  0.011227846145629883
local_in_edges_tensor generation:  0.015429973602294922
mini_batch_src_global generation:  0.02631664276123047
r_  generation:  0.20781326293945312
local_output_nid generation:  0.01112818717956543
local_in_edges_tensor generation:  0.013538122177124023
mini_batch_src_global generation:  0.028047800064086914
r_  generation:  0.21164631843566895
local_output_nid generation:  0.011317014694213867
local_in_edges_tensor generation:  0.013338565826416016
mini_batch_src_global generation:  0.026463985443115234
r_  generation:  0.208878755569458
local_output_nid generation:  0.011329412460327148
local_in_edges_tensor generation:  0.01373600959777832
mini_batch_src_global generation:  0.02850961685180664
r_  generation:  0.21617674827575684
local_output_nid generation:  0.011178255081176758
local_in_edges_tensor generation:  0.012027978897094727
mini_batch_src_global generation:  0.026126623153686523
r_  generation:  0.2104945182800293
----------------------check_connections_block total spend ----------------------------- 4.872607231140137
generate_one_block  0.2627699375152588
generate_one_block  0.25826573371887207
generate_one_block  0.2694971561431885
generate_one_block  0.2653965950012207
generate_one_block  0.2792239189147949
generate_one_block  0.26674890518188477
generate_one_block  0.28082895278930664
generate_one_block  0.26053309440612793
generate_one_block  0.2769334316253662
generate_one_block  0.26731324195861816
generate_one_block  0.27464962005615234
generate_one_block  0.2662522792816162
generate_one_block  0.2689385414123535
generate_one_block  0.27039551734924316
generate_one_block  0.2857522964477539
generate_one_block  0.26235127449035645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035643815994262695
gen group dst list time:  0.05874514579772949
time for parepare:  0.018923044204711914
local_output_nid generation:  0.023723125457763672
local_in_edges_tensor generation:  0.037732839584350586
mini_batch_src_global generation:  0.04125237464904785
r_  generation:  0.42943882942199707
local_output_nid generation:  0.02910470962524414
local_in_edges_tensor generation:  0.04643607139587402
mini_batch_src_global generation:  0.05048370361328125
r_  generation:  0.4395942687988281
local_output_nid generation:  0.029230833053588867
local_in_edges_tensor generation:  0.04210972785949707
mini_batch_src_global generation:  0.04983091354370117
r_  generation:  0.44479799270629883
local_output_nid generation:  0.02950739860534668
local_in_edges_tensor generation:  0.030788421630859375
mini_batch_src_global generation:  0.054502248764038086
r_  generation:  0.4468352794647217
local_output_nid generation:  0.029516220092773438
local_in_edges_tensor generation:  0.041826725006103516
mini_batch_src_global generation:  0.05222797393798828
r_  generation:  0.4561500549316406
local_output_nid generation:  0.030660629272460938
local_in_edges_tensor generation:  0.04378700256347656
mini_batch_src_global generation:  0.07272553443908691
r_  generation:  0.4487311840057373
local_output_nid generation:  0.0319066047668457
local_in_edges_tensor generation:  0.04088854789733887
mini_batch_src_global generation:  0.054929256439208984
r_  generation:  0.4562530517578125
local_output_nid generation:  0.03049612045288086
local_in_edges_tensor generation:  0.03498387336730957
mini_batch_src_global generation:  0.05312228202819824
r_  generation:  0.44843578338623047
local_output_nid generation:  0.031188011169433594
local_in_edges_tensor generation:  0.02899169921875
mini_batch_src_global generation:  0.05236649513244629
r_  generation:  0.4561126232147217
local_output_nid generation:  0.030792236328125
local_in_edges_tensor generation:  0.0400080680847168
mini_batch_src_global generation:  0.052455902099609375
r_  generation:  0.4527130126953125
local_output_nid generation:  0.03129744529724121
local_in_edges_tensor generation:  0.0325624942779541
mini_batch_src_global generation:  0.05267691612243652
r_  generation:  0.4588789939880371
local_output_nid generation:  0.030964374542236328
local_in_edges_tensor generation:  0.031467437744140625
mini_batch_src_global generation:  0.055229902267456055
r_  generation:  0.4464600086212158
local_output_nid generation:  0.030884265899658203
local_in_edges_tensor generation:  0.03243732452392578
mini_batch_src_global generation:  0.054976701736450195
r_  generation:  0.4565277099609375
local_output_nid generation:  0.031103849411010742
local_in_edges_tensor generation:  0.032097816467285156
mini_batch_src_global generation:  0.05330228805541992
r_  generation:  0.47039246559143066
local_output_nid generation:  0.0314483642578125
local_in_edges_tensor generation:  0.03660845756530762
mini_batch_src_global generation:  0.05382680892944336
r_  generation:  0.4561600685119629
local_output_nid generation:  0.032073020935058594
local_in_edges_tensor generation:  0.034088134765625
mini_batch_src_global generation:  0.060892581939697266
r_  generation:  0.4506998062133789
----------------------check_connections_block total spend ----------------------------- 10.744511127471924
generate_one_block  0.5828857421875
generate_one_block  0.5804712772369385
generate_one_block  0.5845143795013428
generate_one_block  0.584846019744873
generate_one_block  0.575782060623169
generate_one_block  0.5756340026855469
generate_one_block  0.6467101573944092
generate_one_block  0.5605261325836182
generate_one_block  0.5723190307617188
generate_one_block  0.5753092765808105
generate_one_block  0.5827221870422363
generate_one_block  0.5615203380584717
generate_one_block  0.5756778717041016
generate_one_block  0.5796146392822266
generate_one_block  0.5865545272827148
generate_one_block  0.5623071193695068
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  15.61711835861206
block generation total time  13.603245258331299
average batch blocks generation time:  0.8502028286457062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08990144729614258  GigaBytes
Max Memory Allocated: 0.08990144729614258  GigaBytes

torch.Size([154098, 128])
torch.Size([121760, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.4393014907836914  GigaBytes
Max Memory Allocated: 0.4570436477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.09107208251953125  GigaBytes
Max Memory Allocated: 0.47890186309814453  GigaBytes

torch.Size([154472, 128])
torch.Size([122436, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.43995141983032227  GigaBytes
Max Memory Allocated: 0.47890186309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.09129810333251953  GigaBytes
Max Memory Allocated: 0.47890186309814453  GigaBytes

torch.Size([154442, 128])
torch.Size([122734, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.44190120697021484  GigaBytes
Max Memory Allocated: 0.47890186309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.09108448028564453  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

torch.Size([154312, 128])
torch.Size([121689, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.44001150131225586  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.0911417007446289  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

torch.Size([154029, 128])
torch.Size([121793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.44011449813842773  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.09113597869873047  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

torch.Size([154193, 128])
torch.Size([121917, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.44040822982788086  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.09138679504394531  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

torch.Size([154552, 128])
torch.Size([122832, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.443540096282959  GigaBytes
Max Memory Allocated: 0.481264591217041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.0910787582397461  GigaBytes
Max Memory Allocated: 0.4835944175720215  GigaBytes

torch.Size([154258, 128])
torch.Size([121331, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.43980836868286133  GigaBytes
Max Memory Allocated: 0.4835944175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0272216796875 GB
    Memory Allocated: 0.09134769439697266  GigaBytes
Max Memory Allocated: 0.4835944175720215  GigaBytes

torch.Size([154663, 128])
torch.Size([122905, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2713623046875 GB
    Memory Allocated: 0.4440903663635254  GigaBytes
Max Memory Allocated: 0.4835944175720215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09117603302001953  GigaBytes
Max Memory Allocated: 0.48366308212280273  GigaBytes

torch.Size([154477, 128])
torch.Size([122244, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4404025077819824  GigaBytes
Max Memory Allocated: 0.48366308212280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09135150909423828  GigaBytes
Max Memory Allocated: 0.48366308212280273  GigaBytes

torch.Size([154928, 128])
torch.Size([123331, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4443788528442383  GigaBytes
Max Memory Allocated: 0.48366308212280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09117889404296875  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154256, 128])
torch.Size([122313, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44141387939453125  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09121894836425781  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154386, 128])
torch.Size([122334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.441072940826416  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0912618637084961  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154554, 128])
torch.Size([122857, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44207286834716797  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09134292602539062  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154496, 128])
torch.Size([122793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.442263126373291  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0911407470703125  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154568, 128])
torch.Size([122438, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4402122497558594  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039549678564071655 |0.036204054951667786 |0.05025254189968109 |9.803473949432373e-05 |0.008108705282211304 |0.0017952919006347656 |
----------------------------------------------------------pseudo_mini_loss sum 5.58066987991333
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5089135
Number of first layer input nodes during this epoch:  2470684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.11340188980102539  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02149176597595215
range selection method range initialization spend 0.011453628540039062
time for parepare:  0.016606569290161133
local_output_nid generation:  0.0013778209686279297
local_in_edges_tensor generation:  0.0039865970611572266
mini_batch_src_global generation:  0.0016956329345703125
r_  generation:  0.017459630966186523
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0009398460388183594
mini_batch_src_global generation:  0.0019571781158447266
r_  generation:  0.01809072494506836
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.001355886459350586
r_  generation:  0.01851963996887207
local_output_nid generation:  0.0015523433685302734
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0013203620910644531
r_  generation:  0.018498897552490234
local_output_nid generation:  0.0015082359313964844
local_in_edges_tensor generation:  0.0008463859558105469
mini_batch_src_global generation:  0.0013680458068847656
r_  generation:  0.018562793731689453
local_output_nid generation:  0.0015368461608886719
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.018692731857299805
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0014111995697021484
r_  generation:  0.0189208984375
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0008504390716552734
mini_batch_src_global generation:  0.0014181137084960938
r_  generation:  0.01910400390625
local_output_nid generation:  0.0015263557434082031
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0014185905456542969
r_  generation:  0.02797245979309082
local_output_nid generation:  0.0019221305847167969
local_in_edges_tensor generation:  0.001016855239868164
mini_batch_src_global generation:  0.0016512870788574219
r_  generation:  0.036011457443237305
local_output_nid generation:  0.0017242431640625
local_in_edges_tensor generation:  0.0009164810180664062
mini_batch_src_global generation:  0.0015251636505126953
r_  generation:  0.020218849182128906
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0014679431915283203
r_  generation:  0.019867897033691406
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0015575885772705078
r_  generation:  0.019710063934326172
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0015382766723632812
r_  generation:  0.019740819931030273
local_output_nid generation:  0.0015010833740234375
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0014951229095458984
r_  generation:  0.019409656524658203
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.0008172988891601562
mini_batch_src_global generation:  0.0015420913696289062
r_  generation:  0.01948237419128418
----------------------check_connections_block total spend ----------------------------- 0.4936850070953369
generate_one_block  0.030496835708618164
generate_one_block  0.027395248413085938
generate_one_block  0.02805328369140625
generate_one_block  0.028057575225830078
generate_one_block  0.027723312377929688
generate_one_block  0.02950882911682129
generate_one_block  0.027252912521362305
generate_one_block  0.04948019981384277
generate_one_block  0.028797626495361328
generate_one_block  0.02818608283996582
generate_one_block  0.02780604362487793
generate_one_block  0.027613162994384766
generate_one_block  0.028128385543823242
generate_one_block  0.027891159057617188
generate_one_block  0.027509450912475586
generate_one_block  0.028184175491333008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033283233642578125
gen group dst list time:  0.017409801483154297
time for parepare:  0.018774986267089844
local_output_nid generation:  0.00629878044128418
local_in_edges_tensor generation:  0.014872312545776367
mini_batch_src_global generation:  0.018737316131591797
r_  generation:  0.18848609924316406
local_output_nid generation:  0.009844779968261719
local_in_edges_tensor generation:  0.017243146896362305
mini_batch_src_global generation:  0.02707815170288086
r_  generation:  0.20229840278625488
local_output_nid generation:  0.011640787124633789
local_in_edges_tensor generation:  0.02078413963317871
mini_batch_src_global generation:  0.025327205657958984
r_  generation:  0.21572566032409668
local_output_nid generation:  0.012413740158081055
local_in_edges_tensor generation:  0.016882658004760742
mini_batch_src_global generation:  0.02712082862854004
r_  generation:  0.20966267585754395
local_output_nid generation:  0.011017084121704102
local_in_edges_tensor generation:  0.01325535774230957
mini_batch_src_global generation:  0.02530074119567871
r_  generation:  0.2138674259185791
local_output_nid generation:  0.011045217514038086
local_in_edges_tensor generation:  0.013399839401245117
mini_batch_src_global generation:  0.025436878204345703
r_  generation:  0.21905755996704102
local_output_nid generation:  0.011068105697631836
local_in_edges_tensor generation:  0.012996435165405273
mini_batch_src_global generation:  0.02530074119567871
r_  generation:  0.21319127082824707
local_output_nid generation:  0.011340856552124023
local_in_edges_tensor generation:  0.013527393341064453
mini_batch_src_global generation:  0.02711772918701172
r_  generation:  0.2139580249786377
local_output_nid generation:  0.01152348518371582
local_in_edges_tensor generation:  0.011733293533325195
mini_batch_src_global generation:  0.028160810470581055
r_  generation:  0.215834379196167
local_output_nid generation:  0.011594772338867188
local_in_edges_tensor generation:  0.01395726203918457
mini_batch_src_global generation:  0.02646017074584961
r_  generation:  0.2172396183013916
local_output_nid generation:  0.011792898178100586
local_in_edges_tensor generation:  0.015540599822998047
mini_batch_src_global generation:  0.026519298553466797
r_  generation:  0.2142014503479004
local_output_nid generation:  0.011475324630737305
local_in_edges_tensor generation:  0.01160883903503418
mini_batch_src_global generation:  0.026381254196166992
r_  generation:  0.2124013900756836
local_output_nid generation:  0.012457132339477539
local_in_edges_tensor generation:  0.022974014282226562
mini_batch_src_global generation:  0.0344853401184082
r_  generation:  0.21854233741760254
local_output_nid generation:  0.01260828971862793
local_in_edges_tensor generation:  0.01635575294494629
mini_batch_src_global generation:  0.027948617935180664
r_  generation:  0.2173020839691162
local_output_nid generation:  0.011562108993530273
local_in_edges_tensor generation:  0.01341557502746582
mini_batch_src_global generation:  0.02653193473815918
r_  generation:  0.21546268463134766
local_output_nid generation:  0.011620759963989258
local_in_edges_tensor generation:  0.011663675308227539
mini_batch_src_global generation:  0.02662181854248047
r_  generation:  0.21342134475708008
----------------------check_connections_block total spend ----------------------------- 5.039664030075073
generate_one_block  0.27048683166503906
generate_one_block  0.2769484519958496
generate_one_block  0.292022705078125
generate_one_block  0.2741882801055908
generate_one_block  0.294675350189209
generate_one_block  0.2695143222808838
generate_one_block  0.2910947799682617
generate_one_block  0.2691762447357178
generate_one_block  0.2717585563659668
generate_one_block  0.27387332916259766
generate_one_block  0.2778937816619873
generate_one_block  0.2700681686401367
generate_one_block  0.2860381603240967
generate_one_block  0.27446460723876953
generate_one_block  0.2828342914581299
generate_one_block  0.27176642417907715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047177791595458984
gen group dst list time:  0.06443357467651367
time for parepare:  0.02047133445739746
local_output_nid generation:  0.02429819107055664
local_in_edges_tensor generation:  0.11677265167236328
mini_batch_src_global generation:  0.06162571907043457
r_  generation:  0.44759654998779297
local_output_nid generation:  0.031557321548461914
local_in_edges_tensor generation:  0.04437541961669922
mini_batch_src_global generation:  0.05453157424926758
r_  generation:  0.44277381896972656
local_output_nid generation:  0.030251026153564453
local_in_edges_tensor generation:  0.036602020263671875
mini_batch_src_global generation:  0.051946401596069336
r_  generation:  0.45011091232299805
local_output_nid generation:  0.030428647994995117
local_in_edges_tensor generation:  0.040122270584106445
mini_batch_src_global generation:  0.05336260795593262
r_  generation:  0.4498293399810791
local_output_nid generation:  0.030906200408935547
local_in_edges_tensor generation:  0.0803685188293457
mini_batch_src_global generation:  0.05350661277770996
r_  generation:  0.45660948753356934
local_output_nid generation:  0.029934167861938477
local_in_edges_tensor generation:  0.03262972831726074
mini_batch_src_global generation:  0.05436515808105469
r_  generation:  0.46143221855163574
local_output_nid generation:  0.02968120574951172
local_in_edges_tensor generation:  0.028622865676879883
mini_batch_src_global generation:  0.05417013168334961
r_  generation:  0.4573540687561035
local_output_nid generation:  0.030169010162353516
local_in_edges_tensor generation:  0.03269338607788086
mini_batch_src_global generation:  0.05443120002746582
r_  generation:  0.4623692035675049
local_output_nid generation:  0.030344247817993164
local_in_edges_tensor generation:  0.04119992256164551
mini_batch_src_global generation:  0.05370020866394043
r_  generation:  0.461397647857666
local_output_nid generation:  0.030360937118530273
local_in_edges_tensor generation:  0.04021811485290527
mini_batch_src_global generation:  0.05502057075500488
r_  generation:  0.4685847759246826
local_output_nid generation:  0.031572818756103516
local_in_edges_tensor generation:  0.0432734489440918
mini_batch_src_global generation:  0.05684542655944824
r_  generation:  0.4817378520965576
local_output_nid generation:  0.03246712684631348
local_in_edges_tensor generation:  0.03740525245666504
mini_batch_src_global generation:  0.05893278121948242
r_  generation:  0.4604053497314453
local_output_nid generation:  0.032796382904052734
local_in_edges_tensor generation:  0.03664803504943848
mini_batch_src_global generation:  0.05681800842285156
r_  generation:  0.46277618408203125
local_output_nid generation:  0.03125905990600586
local_in_edges_tensor generation:  0.03687334060668945
mini_batch_src_global generation:  0.05604052543640137
r_  generation:  0.45718860626220703
local_output_nid generation:  0.03155994415283203
local_in_edges_tensor generation:  0.03312325477600098
mini_batch_src_global generation:  0.052300214767456055
r_  generation:  0.46228742599487305
local_output_nid generation:  0.03127717971801758
local_in_edges_tensor generation:  0.029160261154174805
mini_batch_src_global generation:  0.05498218536376953
r_  generation:  0.4611349105834961
----------------------check_connections_block total spend ----------------------------- 11.043242931365967
generate_one_block  0.5780389308929443
generate_one_block  0.5683801174163818
generate_one_block  0.5926167964935303
generate_one_block  0.6011073589324951
generate_one_block  0.5783419609069824
generate_one_block  0.5755009651184082
generate_one_block  0.5669598579406738
generate_one_block  0.5781209468841553
generate_one_block  0.6198008060455322
generate_one_block  0.586228609085083
generate_one_block  0.5770585536956787
generate_one_block  0.5722179412841797
generate_one_block  0.5696477890014648
generate_one_block  0.5803341865539551
generate_one_block  0.6025295257568359
generate_one_block  0.5651423931121826
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.11340188980102539  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

connection checking time:  16.08290696144104
block generation total time  13.758831024169922
average batch blocks generation time:  0.8599269390106201
block dataloader generation time/epoch 31.952179431915283
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09161520004272461  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154465, 128])
torch.Size([122117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4403705596923828  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09161663055419922  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154178, 128])
torch.Size([121443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4402017593383789  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09190559387207031  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154557, 128])
torch.Size([122790, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44292497634887695  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09182357788085938  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154413, 128])
torch.Size([122443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4418478012084961  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09175968170166016  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154281, 128])
torch.Size([121940, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4411187171936035  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09175872802734375  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154213, 128])
torch.Size([122079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4407930374145508  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0915994644165039  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154242, 128])
torch.Size([121418, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4402732849121094  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09174156188964844  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154503, 128])
torch.Size([122529, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4415860176086426  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09179878234863281  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154556, 128])
torch.Size([122802, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44210052490234375  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09186935424804688  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

torch.Size([154669, 128])
torch.Size([123132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4445061683654785  GigaBytes
Max Memory Allocated: 0.48398637771606445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09189701080322266  GigaBytes
Max Memory Allocated: 0.4841346740722656  GigaBytes

torch.Size([154906, 128])
torch.Size([123403, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44573020935058594  GigaBytes
Max Memory Allocated: 0.4841346740722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09170341491699219  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

torch.Size([154410, 128])
torch.Size([122229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44121217727661133  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09182357788085938  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

torch.Size([154180, 128])
torch.Size([122202, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.44263553619384766  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09184551239013672  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

torch.Size([154299, 128])
torch.Size([122272, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.442594051361084  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0918722152709961  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

torch.Size([154548, 128])
torch.Size([122898, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4433917999267578  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.09175968170166016  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

torch.Size([154202, 128])
torch.Size([122170, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4413270950317383  GigaBytes
Max Memory Allocated: 0.48566389083862305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0375472754240036 |0.012873828411102295 |0.0038904547691345215 |9.682774543762207e-05 |0.004108741879463196 |0.0018088817596435547 |
----------------------------------------------------------pseudo_mini_loss sum 3.573397397994995
Total (block generation + training)time/epoch 32.92633390426636
Training time/epoch 0.973870038986206
Training time without block to device /epoch 0.7678887844085693
Training time without total dataloading part /epoch 0.13134527206420898
load block tensor time/epoch 0.6007564067840576
block to device time/epoch 0.20598125457763672
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5089604
Number of first layer input nodes during this epoch:  2470622
