Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648499561.9282901
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024791717529296875
range selection method range initialization spend 0.01325082778930664
time for parepare:  0.017713546752929688
local_output_nid generation:  0.005214691162109375
local_in_edges_tensor generation:  0.006243705749511719
mini_batch_src_global generation:  0.006472110748291016
r_  generation:  0.08253979682922363
local_output_nid generation:  0.0059316158294677734
local_in_edges_tensor generation:  0.003013134002685547
mini_batch_src_global generation:  0.008325815200805664
r_  generation:  0.08906817436218262
local_output_nid generation:  0.006014823913574219
local_in_edges_tensor generation:  0.003098726272583008
mini_batch_src_global generation:  0.006255388259887695
r_  generation:  0.0888519287109375
local_output_nid generation:  0.006063938140869141
local_in_edges_tensor generation:  0.0029935836791992188
mini_batch_src_global generation:  0.006743669509887695
r_  generation:  0.09242725372314453
----------------------check_connections_block total spend ----------------------------- 0.5060214996337891
generate_one_block  0.10149884223937988
generate_one_block  0.1025998592376709
generate_one_block  0.1014549732208252
generate_one_block  0.10143589973449707
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.041974544525146484
gen group dst list time:  0.011116981506347656
time for parepare:  0.018877029418945312
local_output_nid generation:  0.014603137969970703
local_in_edges_tensor generation:  0.036811113357543945
mini_batch_src_global generation:  0.04115939140319824
r_  generation:  0.4056229591369629
local_output_nid generation:  0.021370887756347656
local_in_edges_tensor generation:  0.03610801696777344
mini_batch_src_global generation:  0.04697775840759277
r_  generation:  0.41837048530578613
local_output_nid generation:  0.022283554077148438
local_in_edges_tensor generation:  0.0343625545501709
mini_batch_src_global generation:  0.04769158363342285
r_  generation:  0.42855358123779297
local_output_nid generation:  0.022563934326171875
local_in_edges_tensor generation:  0.026868820190429688
mini_batch_src_global generation:  0.04951834678649902
r_  generation:  0.4228334426879883
----------------------check_connections_block total spend ----------------------------- 2.4507648944854736
generate_one_block  0.5644950866699219
generate_one_block  0.5351827144622803
generate_one_block  0.5503325462341309
generate_one_block  0.5468287467956543
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.037114858627319336
gen group dst list time:  0.020388126373291016
time for parepare:  0.01952075958251953
local_output_nid generation:  0.024999380111694336
local_in_edges_tensor generation:  0.051810264587402344
mini_batch_src_global generation:  0.05440688133239746
r_  generation:  0.5499799251556396
local_output_nid generation:  0.0360722541809082
local_in_edges_tensor generation:  0.053365468978881836
mini_batch_src_global generation:  0.06243419647216797
r_  generation:  0.5587482452392578
local_output_nid generation:  0.037523746490478516
local_in_edges_tensor generation:  0.04903054237365723
mini_batch_src_global generation:  0.05699563026428223
r_  generation:  0.5703151226043701
local_output_nid generation:  0.038496971130371094
local_in_edges_tensor generation:  0.0358729362487793
mini_batch_src_global generation:  0.05965113639831543
r_  generation:  0.5635292530059814
----------------------check_connections_block total spend ----------------------------- 3.292745590209961
generate_one_block  0.7079010009765625
generate_one_block  0.7047123908996582
generate_one_block  0.708113431930542
generate_one_block  0.6985485553741455
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.054390668869018555
gen group dst list time:  0.025345325469970703
time for parepare:  0.02198624610900879
local_output_nid generation:  0.02802109718322754
local_in_edges_tensor generation:  0.04089069366455078
mini_batch_src_global generation:  0.050560951232910156
r_  generation:  0.542816162109375
local_output_nid generation:  0.03499794006347656
local_in_edges_tensor generation:  0.056433677673339844
mini_batch_src_global generation:  0.0626974105834961
r_  generation:  0.5466129779815674
local_output_nid generation:  0.03890728950500488
local_in_edges_tensor generation:  0.0534665584564209
mini_batch_src_global generation:  0.06374955177307129
r_  generation:  0.550222635269165
local_output_nid generation:  0.035973548889160156
local_in_edges_tensor generation:  0.05049777030944824
mini_batch_src_global generation:  0.08402085304260254
r_  generation:  0.5465347766876221
----------------------check_connections_block total spend ----------------------------- 3.315809965133667
generate_one_block  0.7008965015411377
generate_one_block  0.6984777450561523
generate_one_block  0.6948482990264893
generate_one_block  0.6992642879486084
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05905318260192871
gen group dst list time:  0.024982929229736328
time for parepare:  0.019187450408935547
local_output_nid generation:  0.02872776985168457
local_in_edges_tensor generation:  0.05435371398925781
mini_batch_src_global generation:  0.04909086227416992
r_  generation:  0.5043294429779053
local_output_nid generation:  0.03592109680175781
local_in_edges_tensor generation:  0.03403162956237793
mini_batch_src_global generation:  0.057314395904541016
r_  generation:  0.508392333984375
local_output_nid generation:  0.03652477264404297
local_in_edges_tensor generation:  0.038613319396972656
mini_batch_src_global generation:  0.05801892280578613
r_  generation:  0.5086669921875
local_output_nid generation:  0.036948442459106445
local_in_edges_tensor generation:  0.03989815711975098
mini_batch_src_global generation:  0.05790543556213379
r_  generation:  0.5145254135131836
----------------------check_connections_block total spend ----------------------------- 3.0488674640655518
generate_one_block  0.6503546237945557
generate_one_block  0.6442596912384033
generate_one_block  0.642899751663208
generate_one_block  0.6450681686401367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

connection checking time:  12.108187913894653
block generation total time  10.392183542251587
average batch blocks generation time:  2.5980458855628967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13104915618896484  GigaBytes
Max Memory Allocated: 0.13104915618896484  GigaBytes

torch.Size([167486, 128])
torch.Size([166898, 256])
torch.Size([164896, 256])
torch.Size([155069, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0838623046875 GB
    Memory Allocated: 2.5041794776916504  GigaBytes
Max Memory Allocated: 2.5917816162109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1444091796875 GB
    Memory Allocated: 0.13677263259887695  GigaBytes
Max Memory Allocated: 2.695948600769043  GigaBytes

torch.Size([167463, 128])
torch.Size([166915, 256])
torch.Size([164866, 256])
torch.Size([155076, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1444091796875 GB
    Memory Allocated: 2.5075950622558594  GigaBytes
Max Memory Allocated: 2.695948600769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.13686513900756836  GigaBytes
Max Memory Allocated: 2.699345588684082  GigaBytes

torch.Size([167476, 128])
torch.Size([166929, 256])
torch.Size([164949, 256])
torch.Size([155242, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 2.5123391151428223  GigaBytes
Max Memory Allocated: 2.699345588684082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 0.1367635726928711  GigaBytes
Max Memory Allocated: 2.705160140991211  GigaBytes

torch.Size([167476, 128])
torch.Size([166966, 256])
torch.Size([164908, 256])
torch.Size([154889, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1463623046875 GB
    Memory Allocated: 2.507535934448242  GigaBytes
Max Memory Allocated: 2.705160140991211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05854439735412598 |0.11495804786682129 |0.19626128673553467 |0.00012445449829101562 |0.18128323554992676 |0.006961345672607422 |
----------------------------------------------------------pseudo_mini_loss sum 5.932659149169922
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3022695
Number of first layer input nodes during this epoch:  669901
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 0.23093938827514648  GigaBytes
Max Memory Allocated: 2.705160140991211  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.030241727828979492
range selection method range initialization spend 0.01159524917602539
time for parepare:  0.017148256301879883
local_output_nid generation:  0.005156278610229492
local_in_edges_tensor generation:  0.013976097106933594
mini_batch_src_global generation:  0.006673574447631836
r_  generation:  0.08204388618469238
local_output_nid generation:  0.006000995635986328
local_in_edges_tensor generation:  0.003097057342529297
mini_batch_src_global generation:  0.00923013687133789
r_  generation:  0.08529973030090332
local_output_nid generation:  0.006084918975830078
local_in_edges_tensor generation:  0.003131866455078125
mini_batch_src_global generation:  0.006354093551635742
r_  generation:  0.09028053283691406
local_output_nid generation:  0.006251811981201172
local_in_edges_tensor generation:  0.003065824508666992
mini_batch_src_global generation:  0.0069200992584228516
r_  generation:  0.09194374084472656
----------------------check_connections_block total spend ----------------------------- 0.5135443210601807
generate_one_block  0.11639928817749023
generate_one_block  0.1004636287689209
generate_one_block  0.10253763198852539
generate_one_block  0.10196542739868164
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04665827751159668
gen group dst list time:  0.010967731475830078
time for parepare:  0.019891738891601562
local_output_nid generation:  0.016240358352661133
local_in_edges_tensor generation:  0.04051709175109863
mini_batch_src_global generation:  0.03947162628173828
r_  generation:  0.42029476165771484
local_output_nid generation:  0.021673917770385742
local_in_edges_tensor generation:  0.037168264389038086
mini_batch_src_global generation:  0.048887014389038086
r_  generation:  0.4149758815765381
local_output_nid generation:  0.02162647247314453
local_in_edges_tensor generation:  0.030636072158813477
mini_batch_src_global generation:  0.04815244674682617
r_  generation:  0.4238128662109375
local_output_nid generation:  0.02221536636352539
local_in_edges_tensor generation:  0.030480623245239258
mini_batch_src_global generation:  0.04915189743041992
r_  generation:  0.42757654190063477
----------------------check_connections_block total spend ----------------------------- 2.473336696624756
generate_one_block  0.5700151920318604
generate_one_block  0.5491597652435303
generate_one_block  0.5672786235809326
generate_one_block  0.5566282272338867
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03762197494506836
gen group dst list time:  0.020583629608154297
time for parepare:  0.018474578857421875
local_output_nid generation:  0.02335643768310547
local_in_edges_tensor generation:  0.054207801818847656
mini_batch_src_global generation:  0.05023646354675293
r_  generation:  0.5385699272155762
local_output_nid generation:  0.031946420669555664
local_in_edges_tensor generation:  0.05214953422546387
mini_batch_src_global generation:  0.06299591064453125
r_  generation:  0.5470418930053711
local_output_nid generation:  0.03239321708679199
local_in_edges_tensor generation:  0.038129568099975586
mini_batch_src_global generation:  0.05818986892700195
r_  generation:  0.5670239925384521
local_output_nid generation:  0.03423357009887695
local_in_edges_tensor generation:  0.04933452606201172
mini_batch_src_global generation:  0.06419038772583008
r_  generation:  0.577476978302002
----------------------check_connections_block total spend ----------------------------- 3.2789297103881836
generate_one_block  0.7191259860992432
generate_one_block  0.6993720531463623
generate_one_block  0.7044098377227783
generate_one_block  0.7086572647094727
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04993033409118652
gen group dst list time:  0.02682781219482422
time for parepare:  0.018486499786376953
local_output_nid generation:  0.02773737907409668
local_in_edges_tensor generation:  0.05893349647521973
mini_batch_src_global generation:  0.04913616180419922
r_  generation:  0.5406525135040283
local_output_nid generation:  0.03390002250671387
local_in_edges_tensor generation:  0.04946088790893555
mini_batch_src_global generation:  0.06255412101745605
r_  generation:  0.5416393280029297
local_output_nid generation:  0.03450751304626465
local_in_edges_tensor generation:  0.04434561729431152
mini_batch_src_global generation:  0.06310319900512695
r_  generation:  0.5462050437927246
local_output_nid generation:  0.03443121910095215
local_in_edges_tensor generation:  0.05084991455078125
mini_batch_src_global generation:  0.06142377853393555
r_  generation:  0.5590610504150391
----------------------check_connections_block total spend ----------------------------- 3.2626571655273438
generate_one_block  0.6874129772186279
generate_one_block  0.6994788646697998
generate_one_block  0.6942782402038574
generate_one_block  0.7011926174163818
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03967857360839844
gen group dst list time:  0.025293588638305664
time for parepare:  0.019145727157592773
local_output_nid generation:  0.027527809143066406
local_in_edges_tensor generation:  0.04535818099975586
mini_batch_src_global generation:  0.04591035842895508
r_  generation:  0.5057764053344727
local_output_nid generation:  0.03508114814758301
local_in_edges_tensor generation:  0.0422368049621582
mini_batch_src_global generation:  0.05815911293029785
r_  generation:  0.5245938301086426
local_output_nid generation:  0.03893327713012695
local_in_edges_tensor generation:  0.03903603553771973
mini_batch_src_global generation:  0.061393022537231445
r_  generation:  0.5111117362976074
local_output_nid generation:  0.03730034828186035
local_in_edges_tensor generation:  0.03942084312438965
mini_batch_src_global generation:  0.05808854103088379
r_  generation:  0.5183053016662598
----------------------check_connections_block total spend ----------------------------- 3.077040672302246
generate_one_block  0.6366941928863525
generate_one_block  0.6436116695404053
generate_one_block  0.6424951553344727
generate_one_block  0.641594648361206
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 0.23093938827514648  GigaBytes
Max Memory Allocated: 2.705160140991211  GigaBytes

connection checking time:  12.09196424484253
block generation total time  10.42140531539917
average batch blocks generation time:  2.6053513288497925
block dataloader generation time/epoch 24.933936834335327
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 0.1403980255126953  GigaBytes
Max Memory Allocated: 2.705160140991211  GigaBytes

torch.Size([167480, 128])
torch.Size([166929, 256])
torch.Size([164887, 256])
torch.Size([155256, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1483154296875 GB
    Memory Allocated: 2.515904426574707  GigaBytes
Max Memory Allocated: 2.705160140991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.14034271240234375  GigaBytes
Max Memory Allocated: 2.708864688873291  GigaBytes

torch.Size([167432, 128])
torch.Size([166875, 256])
torch.Size([164890, 256])
torch.Size([154922, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 2.507420063018799  GigaBytes
Max Memory Allocated: 2.708864688873291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.14032411575317383  GigaBytes
Max Memory Allocated: 2.708864688873291  GigaBytes

torch.Size([167470, 128])
torch.Size([166946, 256])
torch.Size([164838, 256])
torch.Size([154851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 2.506380558013916  GigaBytes
Max Memory Allocated: 2.708864688873291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 0.14041757583618164  GigaBytes
Max Memory Allocated: 2.708864688873291  GigaBytes

torch.Size([167415, 128])
torch.Size([166853, 256])
torch.Size([164839, 256])
torch.Size([155009, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1502685546875 GB
    Memory Allocated: 2.503748893737793  GigaBytes
Max Memory Allocated: 2.708864688873291  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.19820630550384521 |0.04296201467514038 |0.005622446537017822 |9.530782699584961e-05 |0.0064092278480529785 |0.004938840866088867 |
----------------------------------------------------------pseudo_mini_loss sum 3.528066396713257
Total (block generation + training)time/epoch 26.17245602607727
Training time/epoch 1.2382445335388184
Training time without block to device /epoch 1.0663964748382568
Training time without total dataloading part /epoch 0.05344676971435547
load block tensor time/epoch 0.7928252220153809
block to device time/epoch 0.17184805870056152
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3022064
Number of first layer input nodes during this epoch:  669797
