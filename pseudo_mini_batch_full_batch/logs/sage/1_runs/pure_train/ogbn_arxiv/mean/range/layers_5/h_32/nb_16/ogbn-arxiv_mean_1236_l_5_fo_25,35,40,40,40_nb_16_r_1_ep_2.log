Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648495929.8267996
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024666786193847656
range selection method range initialization spend 0.013173580169677734
time for parepare:  0.017813920974731445
local_output_nid generation:  0.0014426708221435547
local_in_edges_tensor generation:  0.003973722457885742
mini_batch_src_global generation:  0.0017125606536865234
r_  generation:  0.017736196517944336
local_output_nid generation:  0.0014030933380126953
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0020208358764648438
r_  generation:  0.017096757888793945
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0013432502746582031
r_  generation:  0.018017053604125977
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0013387203216552734
r_  generation:  0.017887592315673828
local_output_nid generation:  0.0015194416046142578
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.0015697479248046875
r_  generation:  0.01816868782043457
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0009350776672363281
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.020242691040039062
local_output_nid generation:  0.0017561912536621094
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0014467239379882812
r_  generation:  0.018756866455078125
local_output_nid generation:  0.0016658306121826172
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0013267993927001953
r_  generation:  0.018809795379638672
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.018696308135986328
local_output_nid generation:  0.0015249252319335938
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.018540143966674805
local_output_nid generation:  0.0015194416046142578
local_in_edges_tensor generation:  0.0008361339569091797
mini_batch_src_global generation:  0.0014033317565917969
r_  generation:  0.018782615661621094
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.001552581787109375
r_  generation:  0.0186309814453125
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0013813972473144531
r_  generation:  0.01841878890991211
local_output_nid generation:  0.0014810562133789062
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.018645048141479492
local_output_nid generation:  0.0015392303466796875
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.018311738967895508
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0014123916625976562
r_  generation:  0.018850326538085938
----------------------check_connections_block total spend ----------------------------- 0.4460756778717041
generate_one_block  0.02707529067993164
generate_one_block  0.027079343795776367
generate_one_block  0.028087139129638672
generate_one_block  0.029412269592285156
generate_one_block  0.02778029441833496
generate_one_block  0.028199195861816406
generate_one_block  0.02729058265686035
generate_one_block  0.027145862579345703
generate_one_block  0.02792191505432129
generate_one_block  0.02716207504272461
generate_one_block  0.027307987213134766
generate_one_block  0.027567386627197266
generate_one_block  0.027496337890625
generate_one_block  0.02695298194885254
generate_one_block  0.0265047550201416
generate_one_block  0.027516841888427734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04161882400512695
gen group dst list time:  0.0186307430267334
time for parepare:  0.018926143646240234
local_output_nid generation:  0.006699085235595703
local_in_edges_tensor generation:  0.015951871871948242
mini_batch_src_global generation:  0.019576072692871094
r_  generation:  0.19910407066345215
local_output_nid generation:  0.009999990463256836
local_in_edges_tensor generation:  0.018183469772338867
mini_batch_src_global generation:  0.024515867233276367
r_  generation:  0.20435762405395508
local_output_nid generation:  0.010524749755859375
local_in_edges_tensor generation:  0.015103816986083984
mini_batch_src_global generation:  0.026064634323120117
r_  generation:  0.2177586555480957
local_output_nid generation:  0.01062631607055664
local_in_edges_tensor generation:  0.015306234359741211
mini_batch_src_global generation:  0.02532219886779785
r_  generation:  0.22206544876098633
local_output_nid generation:  0.010786056518554688
local_in_edges_tensor generation:  0.013948202133178711
mini_batch_src_global generation:  0.027017593383789062
r_  generation:  0.22473835945129395
local_output_nid generation:  0.011270999908447266
local_in_edges_tensor generation:  0.013771772384643555
mini_batch_src_global generation:  0.027715682983398438
r_  generation:  0.23742151260375977
local_output_nid generation:  0.011747360229492188
local_in_edges_tensor generation:  0.027935028076171875
mini_batch_src_global generation:  0.03707265853881836
r_  generation:  0.21302556991577148
local_output_nid generation:  0.012201070785522461
local_in_edges_tensor generation:  0.014734268188476562
mini_batch_src_global generation:  0.02729487419128418
r_  generation:  0.21391677856445312
local_output_nid generation:  0.011732101440429688
local_in_edges_tensor generation:  0.015786409378051758
mini_batch_src_global generation:  0.027485132217407227
r_  generation:  0.21925997734069824
local_output_nid generation:  0.011617660522460938
local_in_edges_tensor generation:  0.015326499938964844
mini_batch_src_global generation:  0.027765512466430664
r_  generation:  0.21713685989379883
local_output_nid generation:  0.011589288711547852
local_in_edges_tensor generation:  0.013295412063598633
mini_batch_src_global generation:  0.02716374397277832
r_  generation:  0.21698307991027832
local_output_nid generation:  0.011636018753051758
local_in_edges_tensor generation:  0.015391111373901367
mini_batch_src_global generation:  0.027907133102416992
r_  generation:  0.22094130516052246
local_output_nid generation:  0.011667490005493164
local_in_edges_tensor generation:  0.013280391693115234
mini_batch_src_global generation:  0.027840852737426758
r_  generation:  0.22201848030090332
local_output_nid generation:  0.011443853378295898
local_in_edges_tensor generation:  0.011707305908203125
mini_batch_src_global generation:  0.027180910110473633
r_  generation:  0.21464872360229492
local_output_nid generation:  0.011468648910522461
local_in_edges_tensor generation:  0.014846324920654297
mini_batch_src_global generation:  0.02751779556274414
r_  generation:  0.21501612663269043
local_output_nid generation:  0.011832952499389648
local_in_edges_tensor generation:  0.015751123428344727
mini_batch_src_global generation:  0.027519941329956055
r_  generation:  0.22091412544250488
----------------------check_connections_block total spend ----------------------------- 5.1533043384552
generate_one_block  0.28919124603271484
generate_one_block  0.2880387306213379
generate_one_block  0.29573941230773926
generate_one_block  0.29580044746398926
generate_one_block  0.3298025131225586
generate_one_block  0.30933332443237305
generate_one_block  0.2921924591064453
generate_one_block  0.3145310878753662
generate_one_block  0.2876880168914795
generate_one_block  0.2879030704498291
generate_one_block  0.2777132987976074
generate_one_block  0.29101133346557617
generate_one_block  0.27681946754455566
generate_one_block  0.2848238945007324
generate_one_block  0.2891051769256592
generate_one_block  0.2891535758972168
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.12874770164489746
gen group dst list time:  0.0688939094543457
time for parepare:  0.018885135650634766
local_output_nid generation:  0.023726463317871094
local_in_edges_tensor generation:  0.048749685287475586
mini_batch_src_global generation:  0.05171513557434082
r_  generation:  0.4863893985748291
local_output_nid generation:  0.029338598251342773
local_in_edges_tensor generation:  0.04781293869018555
mini_batch_src_global generation:  0.059975385665893555
r_  generation:  0.4957704544067383
local_output_nid generation:  0.029372215270996094
local_in_edges_tensor generation:  0.04447793960571289
mini_batch_src_global generation:  0.058568477630615234
r_  generation:  0.5011348724365234
local_output_nid generation:  0.02950263023376465
local_in_edges_tensor generation:  0.040044546127319336
mini_batch_src_global generation:  0.06006360054016113
r_  generation:  0.49785828590393066
local_output_nid generation:  0.029787778854370117
local_in_edges_tensor generation:  0.03995776176452637
mini_batch_src_global generation:  0.06442427635192871
r_  generation:  0.5066637992858887
local_output_nid generation:  0.0301055908203125
local_in_edges_tensor generation:  0.040374040603637695
mini_batch_src_global generation:  0.07394194602966309
r_  generation:  0.5029795169830322
local_output_nid generation:  0.02962470054626465
local_in_edges_tensor generation:  0.030775785446166992
mini_batch_src_global generation:  0.060648441314697266
r_  generation:  0.5115711688995361
local_output_nid generation:  0.03100132942199707
local_in_edges_tensor generation:  0.034352779388427734
mini_batch_src_global generation:  0.06305813789367676
r_  generation:  0.519777774810791
local_output_nid generation:  0.03014683723449707
local_in_edges_tensor generation:  0.03890633583068848
mini_batch_src_global generation:  0.06417322158813477
r_  generation:  0.532536506652832
local_output_nid generation:  0.031028270721435547
local_in_edges_tensor generation:  0.04493117332458496
mini_batch_src_global generation:  0.06186985969543457
r_  generation:  0.5045881271362305
local_output_nid generation:  0.03314089775085449
local_in_edges_tensor generation:  0.037927865982055664
mini_batch_src_global generation:  0.060185909271240234
r_  generation:  0.5102477073669434
local_output_nid generation:  0.03133726119995117
local_in_edges_tensor generation:  0.040429115295410156
mini_batch_src_global generation:  0.05930328369140625
r_  generation:  0.5178217887878418
local_output_nid generation:  0.031859397888183594
local_in_edges_tensor generation:  0.0410459041595459
mini_batch_src_global generation:  0.05872082710266113
r_  generation:  0.516472339630127
local_output_nid generation:  0.03113389015197754
local_in_edges_tensor generation:  0.03124403953552246
mini_batch_src_global generation:  0.05920767784118652
r_  generation:  0.5075564384460449
local_output_nid generation:  0.03112959861755371
local_in_edges_tensor generation:  0.045174598693847656
mini_batch_src_global generation:  0.05832934379577637
r_  generation:  0.5283915996551514
local_output_nid generation:  0.031193971633911133
local_in_edges_tensor generation:  0.049401044845581055
mini_batch_src_global generation:  0.05874061584472656
r_  generation:  0.5039520263671875
----------------------check_connections_block total spend ----------------------------- 11.976112127304077
generate_one_block  0.6471128463745117
generate_one_block  0.654932975769043
generate_one_block  0.6495332717895508
generate_one_block  0.6656410694122314
generate_one_block  0.6724343299865723
generate_one_block  0.651587724685669
generate_one_block  0.6833651065826416
generate_one_block  0.6297798156738281
generate_one_block  0.6508698463439941
generate_one_block  0.6543183326721191
generate_one_block  0.6423561573028564
generate_one_block  0.6488192081451416
generate_one_block  0.651747465133667
generate_one_block  0.6460409164428711
generate_one_block  0.645258903503418
generate_one_block  0.6691792011260986
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036911964416503906
gen group dst list time:  0.09621644020080566
time for parepare:  0.019546985626220703
local_output_nid generation:  0.03159618377685547
local_in_edges_tensor generation:  0.06499290466308594
mini_batch_src_global generation:  0.05303668975830078
r_  generation:  0.5340521335601807
local_output_nid generation:  0.036992788314819336
local_in_edges_tensor generation:  0.05441880226135254
mini_batch_src_global generation:  0.061661481857299805
r_  generation:  0.5302083492279053
local_output_nid generation:  0.036245107650756836
local_in_edges_tensor generation:  0.04582333564758301
mini_batch_src_global generation:  0.057959794998168945
r_  generation:  0.5344719886779785
local_output_nid generation:  0.03602886199951172
local_in_edges_tensor generation:  0.03534674644470215
mini_batch_src_global generation:  0.05800580978393555
r_  generation:  0.5390453338623047
local_output_nid generation:  0.03624320030212402
local_in_edges_tensor generation:  0.039780616760253906
mini_batch_src_global generation:  0.05803513526916504
r_  generation:  0.5487115383148193
local_output_nid generation:  0.03640127182006836
local_in_edges_tensor generation:  0.04584050178527832
mini_batch_src_global generation:  0.06093096733093262
r_  generation:  0.550187349319458
local_output_nid generation:  0.03632688522338867
local_in_edges_tensor generation:  0.035614728927612305
mini_batch_src_global generation:  0.05836296081542969
r_  generation:  0.5524413585662842
local_output_nid generation:  0.03661012649536133
local_in_edges_tensor generation:  0.03555917739868164
mini_batch_src_global generation:  0.0589594841003418
r_  generation:  0.5493912696838379
local_output_nid generation:  0.036551475524902344
local_in_edges_tensor generation:  0.05466580390930176
mini_batch_src_global generation:  0.059403419494628906
r_  generation:  0.5578835010528564
local_output_nid generation:  0.03663969039916992
local_in_edges_tensor generation:  0.05031585693359375
mini_batch_src_global generation:  0.05892825126647949
r_  generation:  0.5568008422851562
local_output_nid generation:  0.03652691841125488
local_in_edges_tensor generation:  0.03572416305541992
mini_batch_src_global generation:  0.05932879447937012
r_  generation:  0.5578463077545166
local_output_nid generation:  0.036806583404541016
local_in_edges_tensor generation:  0.035828590393066406
mini_batch_src_global generation:  0.05938363075256348
r_  generation:  0.5745813846588135
local_output_nid generation:  0.03666806221008301
local_in_edges_tensor generation:  0.05057072639465332
mini_batch_src_global generation:  0.06030154228210449
r_  generation:  0.5602884292602539
local_output_nid generation:  0.03699183464050293
local_in_edges_tensor generation:  0.03575587272644043
mini_batch_src_global generation:  0.059607744216918945
r_  generation:  0.5571582317352295
local_output_nid generation:  0.036566734313964844
local_in_edges_tensor generation:  0.03576207160949707
mini_batch_src_global generation:  0.06055331230163574
r_  generation:  0.5678706169128418
local_output_nid generation:  0.037220001220703125
local_in_edges_tensor generation:  0.03605175018310547
mini_batch_src_global generation:  0.05980110168457031
r_  generation:  0.560765266418457
----------------------check_connections_block total spend ----------------------------- 13.116734743118286
generate_one_block  0.6740834712982178
generate_one_block  0.6683225631713867
generate_one_block  0.7633576393127441
generate_one_block  0.6702525615692139
generate_one_block  0.6678609848022461
generate_one_block  0.693983793258667
generate_one_block  0.6832664012908936
generate_one_block  0.6654641628265381
generate_one_block  0.6737003326416016
generate_one_block  0.6870269775390625
generate_one_block  0.6756768226623535
generate_one_block  0.6733465194702148
generate_one_block  0.6838119029998779
generate_one_block  0.665658712387085
generate_one_block  0.6715853214263916
generate_one_block  0.6813948154449463
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03129863739013672
gen group dst list time:  0.09762406349182129
time for parepare:  0.018938302993774414
local_output_nid generation:  0.03417086601257324
local_in_edges_tensor generation:  0.04050421714782715
mini_batch_src_global generation:  0.04450678825378418
r_  generation:  0.5011153221130371
local_output_nid generation:  0.04006838798522949
local_in_edges_tensor generation:  0.03355050086975098
mini_batch_src_global generation:  0.05721926689147949
r_  generation:  0.5051412582397461
local_output_nid generation:  0.03853178024291992
local_in_edges_tensor generation:  0.03616809844970703
mini_batch_src_global generation:  0.058260202407836914
r_  generation:  0.5088655948638916
local_output_nid generation:  0.03862118721008301
local_in_edges_tensor generation:  0.0339055061340332
mini_batch_src_global generation:  0.05694222450256348
r_  generation:  0.5128283500671387
local_output_nid generation:  0.038675785064697266
local_in_edges_tensor generation:  0.03418087959289551
mini_batch_src_global generation:  0.05685114860534668
r_  generation:  0.5121109485626221
local_output_nid generation:  0.03967618942260742
local_in_edges_tensor generation:  0.04350137710571289
mini_batch_src_global generation:  0.05698132514953613
r_  generation:  0.5226719379425049
local_output_nid generation:  0.038808584213256836
local_in_edges_tensor generation:  0.043639421463012695
mini_batch_src_global generation:  0.057584285736083984
r_  generation:  0.5174448490142822
local_output_nid generation:  0.03888845443725586
local_in_edges_tensor generation:  0.04299044609069824
mini_batch_src_global generation:  0.056462764739990234
r_  generation:  0.5198016166687012
local_output_nid generation:  0.038918256759643555
local_in_edges_tensor generation:  0.042913198471069336
mini_batch_src_global generation:  0.05694890022277832
r_  generation:  0.5180270671844482
local_output_nid generation:  0.04227399826049805
local_in_edges_tensor generation:  0.03853893280029297
mini_batch_src_global generation:  0.05667448043823242
r_  generation:  0.5214579105377197
local_output_nid generation:  0.03907322883605957
local_in_edges_tensor generation:  0.03834986686706543
mini_batch_src_global generation:  0.057054996490478516
r_  generation:  0.519813060760498
local_output_nid generation:  0.03912687301635742
local_in_edges_tensor generation:  0.038655996322631836
mini_batch_src_global generation:  0.05652809143066406
r_  generation:  0.5218255519866943
local_output_nid generation:  0.0397188663482666
local_in_edges_tensor generation:  0.04400157928466797
mini_batch_src_global generation:  0.057290077209472656
r_  generation:  0.520519495010376
local_output_nid generation:  0.039811134338378906
local_in_edges_tensor generation:  0.03836178779602051
mini_batch_src_global generation:  0.05658125877380371
r_  generation:  0.5204257965087891
local_output_nid generation:  0.0395970344543457
local_in_edges_tensor generation:  0.038474321365356445
mini_batch_src_global generation:  0.05744624137878418
r_  generation:  0.5209684371948242
local_output_nid generation:  0.03927803039550781
local_in_edges_tensor generation:  0.04776191711425781
mini_batch_src_global generation:  0.060185909271240234
r_  generation:  0.5226006507873535
----------------------check_connections_block total spend ----------------------------- 12.395039796829224
generate_one_block  0.6439034938812256
generate_one_block  0.6315608024597168
generate_one_block  0.6322429180145264
generate_one_block  0.6261403560638428
generate_one_block  0.7267868518829346
generate_one_block  0.6386091709136963
generate_one_block  0.683490514755249
generate_one_block  0.6392133235931396
generate_one_block  0.6455328464508057
generate_one_block  0.6770353317260742
generate_one_block  0.6477482318878174
generate_one_block  0.6461188793182373
generate_one_block  0.6656978130340576
generate_one_block  0.6505551338195801
generate_one_block  0.6483738422393799
generate_one_block  0.6705493927001953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

connection checking time:  42.64119100570679
block generation total time  36.53417611122131
average batch blocks generation time:  2.283386006951332
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12173032760620117  GigaBytes
Max Memory Allocated: 0.12173032760620117  GigaBytes

torch.Size([166291, 128])
torch.Size([163998, 32])
torch.Size([155835, 32])
torch.Size([124296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.4042787551879883  GigaBytes
Max Memory Allocated: 0.40641069412231445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12317419052124023  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166296, 128])
torch.Size([164048, 32])
torch.Size([155904, 32])
torch.Size([123927, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4000215530395508  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12328863143920898  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166249, 128])
torch.Size([163964, 32])
torch.Size([155973, 32])
torch.Size([124400, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40158843994140625  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1233363151550293  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166236, 128])
torch.Size([163854, 32])
torch.Size([155628, 32])
torch.Size([123809, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39737510681152344  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12332725524902344  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166279, 128])
torch.Size([163917, 32])
torch.Size([155880, 32])
torch.Size([124322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40163278579711914  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12335920333862305  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166254, 128])
torch.Size([164043, 32])
torch.Size([156061, 32])
torch.Size([124505, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4021162986755371  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12317609786987305  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166389, 128])
torch.Size([164039, 32])
torch.Size([155752, 32])
torch.Size([123224, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3998889923095703  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1231851577758789  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166290, 128])
torch.Size([163887, 32])
torch.Size([155676, 32])
torch.Size([123072, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39968204498291016  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12330389022827148  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166431, 128])
torch.Size([164103, 32])
torch.Size([155956, 32])
torch.Size([124101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4015007019042969  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12325572967529297  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166301, 128])
torch.Size([163999, 32])
torch.Size([155982, 32])
torch.Size([123677, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4010486602783203  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12320423126220703  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166320, 128])
torch.Size([163992, 32])
torch.Size([155886, 32])
torch.Size([123748, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40016794204711914  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1233377456665039  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166308, 128])
torch.Size([163995, 32])
torch.Size([155828, 32])
torch.Size([123861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4013032913208008  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12329912185668945  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166347, 128])
torch.Size([164061, 32])
torch.Size([156148, 32])
torch.Size([124559, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4015960693359375  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12317991256713867  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166227, 128])
torch.Size([163850, 32])
torch.Size([155693, 32])
torch.Size([123321, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3996462821960449  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12316465377807617  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166320, 128])
torch.Size([163891, 32])
torch.Size([155397, 32])
torch.Size([122768, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3955354690551758  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1232914924621582  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166259, 128])
torch.Size([163916, 32])
torch.Size([155736, 32])
torch.Size([123880, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40120935440063477  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056337371468544006 |0.05966690182685852 |0.04963789880275726 |0.0001004934310913086 |0.013476267457008362 |0.006520509719848633 |
----------------------------------------------------------pseudo_mini_loss sum 5.031968116760254
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10420337
Number of first layer input nodes during this epoch:  2660797
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.2109231948852539  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024205684661865234
range selection method range initialization spend 0.01151132583618164
time for parepare:  0.017076969146728516
local_output_nid generation:  0.0013890266418457031
local_in_edges_tensor generation:  0.004622220993041992
mini_batch_src_global generation:  0.003695249557495117
r_  generation:  0.023770809173583984
local_output_nid generation:  0.001844167709350586
local_in_edges_tensor generation:  0.0010540485382080078
mini_batch_src_global generation:  0.0023145675659179688
r_  generation:  0.01984095573425293
local_output_nid generation:  0.00183868408203125
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.018290281295776367
local_output_nid generation:  0.0018656253814697266
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0015184879302978516
r_  generation:  0.01849365234375
local_output_nid generation:  0.0018913745880126953
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0015139579772949219
r_  generation:  0.01937413215637207
local_output_nid generation:  0.001857757568359375
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.018408775329589844
local_output_nid generation:  0.001840829849243164
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0015454292297363281
r_  generation:  0.019151926040649414
local_output_nid generation:  0.00182342529296875
local_in_edges_tensor generation:  0.0008759498596191406
mini_batch_src_global generation:  0.0015332698822021484
r_  generation:  0.019059419631958008
local_output_nid generation:  0.001728057861328125
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0015456676483154297
r_  generation:  0.018707990646362305
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.001508951187133789
r_  generation:  0.01882195472717285
local_output_nid generation:  0.0019409656524658203
local_in_edges_tensor generation:  0.0009996891021728516
mini_batch_src_global generation:  0.0015652179718017578
r_  generation:  0.01938319206237793
local_output_nid generation:  0.0018453598022460938
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0016036033630371094
r_  generation:  0.019245386123657227
local_output_nid generation:  0.0018024444580078125
local_in_edges_tensor generation:  0.0009338855743408203
mini_batch_src_global generation:  0.0015361309051513672
r_  generation:  0.019222736358642578
local_output_nid generation:  0.0017931461334228516
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.001538991928100586
r_  generation:  0.018948793411254883
local_output_nid generation:  0.0018031597137451172
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.019481182098388672
local_output_nid generation:  0.0018033981323242188
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.00160980224609375
r_  generation:  0.019336462020874023
----------------------check_connections_block total spend ----------------------------- 0.47756409645080566
generate_one_block  0.03265070915222168
generate_one_block  0.02896571159362793
generate_one_block  0.028364896774291992
generate_one_block  0.028435468673706055
generate_one_block  0.029146432876586914
generate_one_block  0.030655384063720703
generate_one_block  0.028761625289916992
generate_one_block  0.02903914451599121
generate_one_block  0.02834320068359375
generate_one_block  0.027755260467529297
generate_one_block  0.02859210968017578
generate_one_block  0.028736352920532227
generate_one_block  0.02938055992126465
generate_one_block  0.028563499450683594
generate_one_block  0.02908945083618164
generate_one_block  0.0290677547454834
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04038691520690918
gen group dst list time:  0.01921701431274414
time for parepare:  0.02062845230102539
local_output_nid generation:  0.007290840148925781
local_in_edges_tensor generation:  0.01769733428955078
mini_batch_src_global generation:  0.02041482925415039
r_  generation:  0.23130226135253906
local_output_nid generation:  0.014878511428833008
local_in_edges_tensor generation:  0.02033686637878418
mini_batch_src_global generation:  0.02852916717529297
r_  generation:  0.2203841209411621
local_output_nid generation:  0.013077735900878906
local_in_edges_tensor generation:  0.016480684280395508
mini_batch_src_global generation:  0.027235984802246094
r_  generation:  0.22735810279846191
local_output_nid generation:  0.013616085052490234
local_in_edges_tensor generation:  0.01483774185180664
mini_batch_src_global generation:  0.027016162872314453
r_  generation:  0.22804617881774902
local_output_nid generation:  0.013824224472045898
local_in_edges_tensor generation:  0.015122175216674805
mini_batch_src_global generation:  0.0284881591796875
r_  generation:  0.23810625076293945
local_output_nid generation:  0.014096975326538086
local_in_edges_tensor generation:  0.029801130294799805
mini_batch_src_global generation:  0.04406309127807617
r_  generation:  0.21947216987609863
local_output_nid generation:  0.01615452766418457
local_in_edges_tensor generation:  0.01474618911743164
mini_batch_src_global generation:  0.026734113693237305
r_  generation:  0.22178888320922852
local_output_nid generation:  0.012408733367919922
local_in_edges_tensor generation:  0.015776395797729492
mini_batch_src_global generation:  0.027358293533325195
r_  generation:  0.2316148281097412
local_output_nid generation:  0.012219429016113281
local_in_edges_tensor generation:  0.013401985168457031
mini_batch_src_global generation:  0.02698230743408203
r_  generation:  0.2226390838623047
local_output_nid generation:  0.011904716491699219
local_in_edges_tensor generation:  0.011274576187133789
mini_batch_src_global generation:  0.02644038200378418
r_  generation:  0.21141314506530762
local_output_nid generation:  0.012414216995239258
local_in_edges_tensor generation:  0.015213489532470703
mini_batch_src_global generation:  0.02693939208984375
r_  generation:  0.23043370246887207
local_output_nid generation:  0.01220846176147461
local_in_edges_tensor generation:  0.015430450439453125
mini_batch_src_global generation:  0.030298709869384766
r_  generation:  0.22435903549194336
local_output_nid generation:  0.013646841049194336
local_in_edges_tensor generation:  0.019449234008789062
mini_batch_src_global generation:  0.029461145401000977
r_  generation:  0.23996496200561523
local_output_nid generation:  0.014565706253051758
local_in_edges_tensor generation:  0.015868425369262695
mini_batch_src_global generation:  0.03177046775817871
r_  generation:  0.2162625789642334
local_output_nid generation:  0.011861562728881836
local_in_edges_tensor generation:  0.015282630920410156
mini_batch_src_global generation:  0.029547691345214844
r_  generation:  0.2226877212524414
local_output_nid generation:  0.011611700057983398
local_in_edges_tensor generation:  0.013318061828613281
mini_batch_src_global generation:  0.0279538631439209
r_  generation:  0.2290174961090088
----------------------check_connections_block total spend ----------------------------- 5.367994546890259
generate_one_block  0.2884855270385742
generate_one_block  0.2755722999572754
generate_one_block  0.2802693843841553
generate_one_block  0.28797268867492676
generate_one_block  0.28515625
generate_one_block  0.2722892761230469
generate_one_block  0.3060464859008789
generate_one_block  0.29418015480041504
generate_one_block  0.28255653381347656
generate_one_block  0.2730085849761963
generate_one_block  0.28482484817504883
generate_one_block  0.2836165428161621
generate_one_block  0.29146790504455566
generate_one_block  0.2782933712005615
generate_one_block  0.2991774082183838
generate_one_block  0.2757444381713867
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05050086975097656
gen group dst list time:  0.06781482696533203
time for parepare:  0.017726898193359375
local_output_nid generation:  0.02428269386291504
local_in_edges_tensor generation:  0.05627250671386719
mini_batch_src_global generation:  0.050134897232055664
r_  generation:  0.4882025718688965
local_output_nid generation:  0.02963995933532715
local_in_edges_tensor generation:  0.047722578048706055
mini_batch_src_global generation:  0.05821394920349121
r_  generation:  0.5073750019073486
local_output_nid generation:  0.030643939971923828
local_in_edges_tensor generation:  0.03560590744018555
mini_batch_src_global generation:  0.06087970733642578
r_  generation:  0.513279914855957
local_output_nid generation:  0.03032708168029785
local_in_edges_tensor generation:  0.040112972259521484
mini_batch_src_global generation:  0.05908036231994629
r_  generation:  0.5050804615020752
local_output_nid generation:  0.030485153198242188
local_in_edges_tensor generation:  0.07860946655273438
mini_batch_src_global generation:  0.06188607215881348
r_  generation:  0.5106089115142822
local_output_nid generation:  0.030303239822387695
local_in_edges_tensor generation:  0.03427314758300781
mini_batch_src_global generation:  0.05943727493286133
r_  generation:  0.5037064552307129
local_output_nid generation:  0.030271530151367188
local_in_edges_tensor generation:  0.030919313430786133
mini_batch_src_global generation:  0.05917024612426758
r_  generation:  0.5158121585845947
local_output_nid generation:  0.03181314468383789
local_in_edges_tensor generation:  0.038985490798950195
mini_batch_src_global generation:  0.059700727462768555
r_  generation:  0.5086321830749512
local_output_nid generation:  0.031095504760742188
local_in_edges_tensor generation:  0.04382896423339844
mini_batch_src_global generation:  0.06488251686096191
r_  generation:  0.5250797271728516
local_output_nid generation:  0.03313326835632324
local_in_edges_tensor generation:  0.03756904602050781
mini_batch_src_global generation:  0.06156325340270996
r_  generation:  0.5002000331878662
local_output_nid generation:  0.03292655944824219
local_in_edges_tensor generation:  0.04043102264404297
mini_batch_src_global generation:  0.058927297592163086
r_  generation:  0.5134484767913818
local_output_nid generation:  0.0315709114074707
local_in_edges_tensor generation:  0.03576922416687012
mini_batch_src_global generation:  0.059998273849487305
r_  generation:  0.5054020881652832
local_output_nid generation:  0.031632184982299805
local_in_edges_tensor generation:  0.04512643814086914
mini_batch_src_global generation:  0.05852913856506348
r_  generation:  0.5063955783843994
local_output_nid generation:  0.032034873962402344
local_in_edges_tensor generation:  0.03135967254638672
mini_batch_src_global generation:  0.05996537208557129
r_  generation:  0.5018525123596191
local_output_nid generation:  0.03248453140258789
local_in_edges_tensor generation:  0.03171873092651367
mini_batch_src_global generation:  0.05914473533630371
r_  generation:  0.5152277946472168
local_output_nid generation:  0.03263068199157715
local_in_edges_tensor generation:  0.03606534004211426
mini_batch_src_global generation:  0.06044816970825195
r_  generation:  0.5014533996582031
----------------------check_connections_block total spend ----------------------------- 11.983917474746704
generate_one_block  0.6562871932983398
generate_one_block  0.6505999565124512
generate_one_block  0.6626503467559814
generate_one_block  0.6447978019714355
generate_one_block  0.6599905490875244
generate_one_block  0.6331696510314941
generate_one_block  0.6483063697814941
generate_one_block  0.6578874588012695
generate_one_block  0.6788325309753418
generate_one_block  0.6282370090484619
generate_one_block  0.6598677635192871
generate_one_block  0.6501603126525879
generate_one_block  0.6567320823669434
generate_one_block  0.6314988136291504
generate_one_block  0.6444029808044434
generate_one_block  0.6544420719146729
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04279351234436035
gen group dst list time:  0.08832430839538574
time for parepare:  0.019193410873413086
local_output_nid generation:  0.03179287910461426
local_in_edges_tensor generation:  0.06358861923217773
mini_batch_src_global generation:  0.05231285095214844
r_  generation:  0.530860185623169
local_output_nid generation:  0.03868913650512695
local_in_edges_tensor generation:  0.0568850040435791
mini_batch_src_global generation:  0.06095004081726074
r_  generation:  0.540813684463501
local_output_nid generation:  0.03906702995300293
local_in_edges_tensor generation:  0.04102325439453125
mini_batch_src_global generation:  0.058358192443847656
r_  generation:  0.5393726825714111
local_output_nid generation:  0.03969073295593262
local_in_edges_tensor generation:  0.04707932472229004
mini_batch_src_global generation:  0.05838441848754883
r_  generation:  0.5385754108428955
local_output_nid generation:  0.03724551200866699
local_in_edges_tensor generation:  0.04586982727050781
mini_batch_src_global generation:  0.05826592445373535
r_  generation:  0.5446212291717529
local_output_nid generation:  0.037346601486206055
local_in_edges_tensor generation:  0.042724609375
mini_batch_src_global generation:  0.057771921157836914
r_  generation:  0.548757791519165
local_output_nid generation:  0.03731131553649902
local_in_edges_tensor generation:  0.04568886756896973
mini_batch_src_global generation:  0.057581424713134766
r_  generation:  0.5500717163085938
local_output_nid generation:  0.03905534744262695
local_in_edges_tensor generation:  0.04445910453796387
mini_batch_src_global generation:  0.05877399444580078
r_  generation:  0.5551273822784424
local_output_nid generation:  0.03764009475708008
local_in_edges_tensor generation:  0.046211957931518555
mini_batch_src_global generation:  0.0589752197265625
r_  generation:  0.5607767105102539
local_output_nid generation:  0.037667274475097656
local_in_edges_tensor generation:  0.04410099983215332
mini_batch_src_global generation:  0.06472468376159668
r_  generation:  0.555992603302002
local_output_nid generation:  0.0377507209777832
local_in_edges_tensor generation:  0.04414010047912598
mini_batch_src_global generation:  0.058969974517822266
r_  generation:  0.5650699138641357
local_output_nid generation:  0.03844881057739258
local_in_edges_tensor generation:  0.0543973445892334
mini_batch_src_global generation:  0.06818127632141113
r_  generation:  0.5678646564483643
local_output_nid generation:  0.03896903991699219
local_in_edges_tensor generation:  0.04296469688415527
mini_batch_src_global generation:  0.06011366844177246
r_  generation:  0.5709083080291748
local_output_nid generation:  0.04074358940124512
local_in_edges_tensor generation:  0.05581212043762207
mini_batch_src_global generation:  0.060418128967285156
r_  generation:  0.5609879493713379
local_output_nid generation:  0.03874659538269043
local_in_edges_tensor generation:  0.04720020294189453
mini_batch_src_global generation:  0.06054806709289551
r_  generation:  0.5598585605621338
local_output_nid generation:  0.03970146179199219
local_in_edges_tensor generation:  0.038138628005981445
mini_batch_src_global generation:  0.06087827682495117
r_  generation:  0.5600519180297852
----------------------check_connections_block total spend ----------------------------- 13.258849143981934
generate_one_block  0.6776123046875
generate_one_block  0.696282148361206
generate_one_block  0.6695704460144043
generate_one_block  0.6786582469940186
generate_one_block  0.6666791439056396
generate_one_block  0.6811666488647461
generate_one_block  0.766127347946167
generate_one_block  0.6896030902862549
generate_one_block  0.699601411819458
generate_one_block  0.6662495136260986
generate_one_block  0.6949408054351807
generate_one_block  0.6906270980834961
generate_one_block  0.6647303104400635
generate_one_block  0.6717908382415771
generate_one_block  0.6740124225616455
generate_one_block  0.6787493228912354
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04985547065734863
gen group dst list time:  0.09248757362365723
time for parepare:  0.019794464111328125
local_output_nid generation:  0.033769845962524414
local_in_edges_tensor generation:  0.05780363082885742
mini_batch_src_global generation:  0.04453611373901367
r_  generation:  0.5071473121643066
local_output_nid generation:  0.040268898010253906
local_in_edges_tensor generation:  0.035218000411987305
mini_batch_src_global generation:  0.05819129943847656
r_  generation:  0.5125229358673096
local_output_nid generation:  0.0387265682220459
local_in_edges_tensor generation:  0.03588747978210449
mini_batch_src_global generation:  0.05773186683654785
r_  generation:  0.5078794956207275
local_output_nid generation:  0.03919100761413574
local_in_edges_tensor generation:  0.036577701568603516
mini_batch_src_global generation:  0.05699014663696289
r_  generation:  0.5256657600402832
local_output_nid generation:  0.03924441337585449
local_in_edges_tensor generation:  0.03625965118408203
mini_batch_src_global generation:  0.056897640228271484
r_  generation:  0.5098915100097656
local_output_nid generation:  0.03911447525024414
local_in_edges_tensor generation:  0.03595566749572754
mini_batch_src_global generation:  0.05698418617248535
r_  generation:  0.509129524230957
local_output_nid generation:  0.039518117904663086
local_in_edges_tensor generation:  0.03636002540588379
mini_batch_src_global generation:  0.05670571327209473
r_  generation:  0.5149145126342773
local_output_nid generation:  0.039565086364746094
local_in_edges_tensor generation:  0.044763803482055664
mini_batch_src_global generation:  0.057160139083862305
r_  generation:  0.5179123878479004
local_output_nid generation:  0.03979611396789551
local_in_edges_tensor generation:  0.04062819480895996
mini_batch_src_global generation:  0.057421207427978516
r_  generation:  0.5203707218170166
local_output_nid generation:  0.03990578651428223
local_in_edges_tensor generation:  0.041208505630493164
mini_batch_src_global generation:  0.056442975997924805
r_  generation:  0.5209414958953857
local_output_nid generation:  0.03986930847167969
local_in_edges_tensor generation:  0.04515647888183594
mini_batch_src_global generation:  0.05647015571594238
r_  generation:  0.5240478515625
local_output_nid generation:  0.04014897346496582
local_in_edges_tensor generation:  0.04928159713745117
mini_batch_src_global generation:  0.05669593811035156
r_  generation:  0.5227713584899902
local_output_nid generation:  0.039774179458618164
local_in_edges_tensor generation:  0.04505610466003418
mini_batch_src_global generation:  0.05649518966674805
r_  generation:  0.527489185333252
local_output_nid generation:  0.0397031307220459
local_in_edges_tensor generation:  0.04028201103210449
mini_batch_src_global generation:  0.05638861656188965
r_  generation:  0.5301041603088379
local_output_nid generation:  0.04018712043762207
local_in_edges_tensor generation:  0.042349815368652344
mini_batch_src_global generation:  0.05682635307312012
r_  generation:  0.5217766761779785
local_output_nid generation:  0.03991127014160156
local_in_edges_tensor generation:  0.04505181312561035
mini_batch_src_global generation:  0.056972503662109375
r_  generation:  0.5366463661193848
----------------------check_connections_block total spend ----------------------------- 12.485133409500122
generate_one_block  0.6399140357971191
generate_one_block  0.6557841300964355
generate_one_block  0.6433448791503906
generate_one_block  0.6445293426513672
generate_one_block  0.64249587059021
generate_one_block  0.6409876346588135
generate_one_block  0.6446435451507568
generate_one_block  0.640963077545166
generate_one_block  0.6515984535217285
generate_one_block  0.7334773540496826
generate_one_block  0.6403753757476807
generate_one_block  0.6453988552093506
generate_one_block  0.638559103012085
generate_one_block  0.6470918655395508
generate_one_block  0.6445732116699219
generate_one_block  0.6444883346557617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.2109231948852539  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

connection checking time:  43.09589457511902
block generation total time  36.341150760650635
average batch blocks generation time:  2.2713219225406647
block dataloader generation time/epoch 82.47584438323975
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12338447570800781  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166267, 128])
torch.Size([163932, 32])
torch.Size([155826, 32])
torch.Size([123789, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40107202529907227  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12336397171020508  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166224, 128])
torch.Size([163970, 32])
torch.Size([155986, 32])
torch.Size([123741, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40044307708740234  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12337589263916016  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166203, 128])
torch.Size([163830, 32])
torch.Size([155743, 32])
torch.Size([123737, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4002847671508789  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12338495254516602  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166159, 128])
torch.Size([163830, 32])
torch.Size([155658, 32])
torch.Size([123314, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40089845657348633  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12346363067626953  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166079, 128])
torch.Size([163713, 32])
torch.Size([155737, 32])
torch.Size([124231, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4015340805053711  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12329626083374023  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166126, 128])
torch.Size([163801, 32])
torch.Size([155547, 32])
torch.Size([122993, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3956947326660156  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12337207794189453  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166210, 128])
torch.Size([163830, 32])
torch.Size([155700, 32])
torch.Size([123653, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4003300666809082  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12344694137573242  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166162, 128])
torch.Size([163756, 32])
torch.Size([155704, 32])
torch.Size([124018, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40141963958740234  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12340927124023438  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166128, 128])
torch.Size([163778, 32])
torch.Size([155800, 32])
torch.Size([123898, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40105295181274414  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12320184707641602  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166177, 128])
torch.Size([163734, 32])
torch.Size([155362, 32])
torch.Size([122603, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39531993865966797  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1234278678894043  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166217, 128])
torch.Size([163884, 32])
torch.Size([155791, 32])
torch.Size([123900, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40138959884643555  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12343788146972656  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166201, 128])
torch.Size([163943, 32])
torch.Size([155851, 32])
torch.Size([123713, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.40119218826293945  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1234889030456543  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166117, 128])
torch.Size([163720, 32])
torch.Size([155629, 32])
torch.Size([123908, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39750051498413086  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12337350845336914  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166245, 128])
torch.Size([163919, 32])
torch.Size([155796, 32])
torch.Size([123760, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.4001808166503906  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12347650527954102  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166078, 128])
torch.Size([163657, 32])
torch.Size([155551, 32])
torch.Size([124040, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.39745187759399414  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.12340736389160156  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

torch.Size([166168, 128])
torch.Size([163745, 32])
torch.Size([155558, 32])
torch.Size([123904, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.3971238136291504  GigaBytes
Max Memory Allocated: 0.4175848960876465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05668047070503235 |0.03568005561828613 |0.005487516522407532 |9.115040302276611e-05 |0.004708811640739441 |0.0022630691528320312 |
----------------------------------------------------------pseudo_mini_loss sum 4.321199893951416
Total (block generation + training)time/epoch 84.173987865448
Training time/epoch 1.6979246139526367
Training time without block to device /epoch 1.1270437240600586
Training time without total dataloading part /epoch 0.16686272621154785
load block tensor time/epoch 0.9068875312805176
block to device time/epoch 0.5708808898925781
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10411963
Number of first layer input nodes during this epoch:  2658761
