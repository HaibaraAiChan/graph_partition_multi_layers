Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648445622.8428895
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024672508239746094
range selection method range initialization spend 0.01291346549987793
time for parepare:  0.018064498901367188
local_output_nid generation:  0.0006937980651855469
local_in_edges_tensor generation:  0.003561258316040039
mini_batch_src_global generation:  0.001291513442993164
r_  generation:  0.008254528045654297
local_output_nid generation:  0.0006940364837646484
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.0075969696044921875
local_output_nid generation:  0.0007021427154541016
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.0008280277252197266
r_  generation:  0.007802009582519531
local_output_nid generation:  0.0007021427154541016
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0008013248443603516
r_  generation:  0.0076639652252197266
local_output_nid generation:  0.00069427490234375
local_in_edges_tensor generation:  0.0004553794860839844
mini_batch_src_global generation:  0.0008606910705566406
r_  generation:  0.007707118988037109
local_output_nid generation:  0.0007224082946777344
local_in_edges_tensor generation:  0.00045037269592285156
mini_batch_src_global generation:  0.0007722377777099609
r_  generation:  0.007565021514892578
local_output_nid generation:  0.000705718994140625
local_in_edges_tensor generation:  0.0004584789276123047
mini_batch_src_global generation:  0.0008027553558349609
r_  generation:  0.007899761199951172
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0007865428924560547
r_  generation:  0.008038759231567383
local_output_nid generation:  0.0006985664367675781
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0008144378662109375
r_  generation:  0.007991790771484375
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.007957220077514648
local_output_nid generation:  0.0007343292236328125
local_in_edges_tensor generation:  0.0004558563232421875
mini_batch_src_global generation:  0.0008149147033691406
r_  generation:  0.007952213287353516
local_output_nid generation:  0.0007231235504150391
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0008130073547363281
r_  generation:  0.00812983512878418
local_output_nid generation:  0.0007300376892089844
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0008256435394287109
r_  generation:  0.008136987686157227
local_output_nid generation:  0.0007312297821044922
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0008149147033691406
r_  generation:  0.008175373077392578
local_output_nid generation:  0.0007257461547851562
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.0007798671722412109
r_  generation:  0.007549762725830078
local_output_nid generation:  0.0007276535034179688
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0007898807525634766
r_  generation:  0.007932424545288086
local_output_nid generation:  0.000713348388671875
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0008056163787841797
r_  generation:  0.00800013542175293
local_output_nid generation:  0.0007228851318359375
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0007843971252441406
r_  generation:  0.007761716842651367
local_output_nid generation:  0.000728607177734375
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.007988691329956055
local_output_nid generation:  0.0007104873657226562
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0007798671722412109
r_  generation:  0.007753133773803711
local_output_nid generation:  0.0007107257843017578
local_in_edges_tensor generation:  0.000446319580078125
mini_batch_src_global generation:  0.000789642333984375
r_  generation:  0.007853507995605469
local_output_nid generation:  0.0006997585296630859
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.0008087158203125
r_  generation:  0.007963895797729492
local_output_nid generation:  0.0007112026214599609
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0008122920989990234
r_  generation:  0.008119344711303711
local_output_nid generation:  0.0007188320159912109
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.008320093154907227
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0008456707000732422
r_  generation:  0.00813603401184082
local_output_nid generation:  0.0007152557373046875
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0008273124694824219
r_  generation:  0.008063793182373047
local_output_nid generation:  0.0007276535034179688
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0008108615875244141
r_  generation:  0.00779271125793457
local_output_nid generation:  0.0007214546203613281
local_in_edges_tensor generation:  0.000446319580078125
mini_batch_src_global generation:  0.00083160400390625
r_  generation:  0.00825047492980957
local_output_nid generation:  0.0007228851318359375
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0008585453033447266
r_  generation:  0.008344650268554688
local_output_nid generation:  0.000720977783203125
local_in_edges_tensor generation:  0.0040433406829833984
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.008316993713378906
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.008297920227050781
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0009059906005859375
r_  generation:  0.008434295654296875
----------------------check_connections_block total spend ----------------------------- 0.4097480773925781
generate_one_block  0.013837099075317383
generate_one_block  0.013396024703979492
generate_one_block  0.013365983963012695
generate_one_block  0.013106584548950195
generate_one_block  0.013134479522705078
generate_one_block  0.012838125228881836
generate_one_block  0.013280868530273438
generate_one_block  0.013018369674682617
generate_one_block  0.013232946395874023
generate_one_block  0.013212203979492188
generate_one_block  0.013157844543457031
generate_one_block  0.013075590133666992
generate_one_block  0.013142585754394531
generate_one_block  0.013290882110595703
generate_one_block  0.012188196182250977
generate_one_block  0.01286625862121582
generate_one_block  0.01286458969116211
generate_one_block  0.012529134750366211
generate_one_block  0.013184070587158203
generate_one_block  0.0124969482421875
generate_one_block  0.012747526168823242
generate_one_block  0.017032861709594727
generate_one_block  0.0167083740234375
generate_one_block  0.013075590133666992
generate_one_block  0.013068914413452148
generate_one_block  0.012981414794921875
generate_one_block  0.012713909149169922
generate_one_block  0.013145208358764648
generate_one_block  0.013290643692016602
generate_one_block  0.013035058975219727
generate_one_block  0.013379812240600586
generate_one_block  0.013291358947753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0487825870513916
gen group dst list time:  0.020613908767700195
time for parepare:  0.01890707015991211
local_output_nid generation:  0.0037491321563720703
local_in_edges_tensor generation:  0.011526107788085938
mini_batch_src_global generation:  0.011518001556396484
r_  generation:  0.11594033241271973
local_output_nid generation:  0.006031036376953125
local_in_edges_tensor generation:  0.009631633758544922
mini_batch_src_global generation:  0.014259099960327148
r_  generation:  0.12048172950744629
local_output_nid generation:  0.006538867950439453
local_in_edges_tensor generation:  0.007966279983520508
mini_batch_src_global generation:  0.013244152069091797
r_  generation:  0.12613987922668457
local_output_nid generation:  0.006145954132080078
local_in_edges_tensor generation:  0.00800466537475586
mini_batch_src_global generation:  0.013741731643676758
r_  generation:  0.1264200210571289
local_output_nid generation:  0.006331205368041992
local_in_edges_tensor generation:  0.006988048553466797
mini_batch_src_global generation:  0.01476430892944336
r_  generation:  0.12805628776550293
local_output_nid generation:  0.006327390670776367
local_in_edges_tensor generation:  0.007950305938720703
mini_batch_src_global generation:  0.014482736587524414
r_  generation:  0.12291264533996582
local_output_nid generation:  0.00651097297668457
local_in_edges_tensor generation:  0.009378910064697266
mini_batch_src_global generation:  0.01587224006652832
r_  generation:  0.1266803741455078
local_output_nid generation:  0.006483316421508789
local_in_edges_tensor generation:  0.0071926116943359375
mini_batch_src_global generation:  0.014987707138061523
r_  generation:  0.1282958984375
local_output_nid generation:  0.0066547393798828125
local_in_edges_tensor generation:  0.009263992309570312
mini_batch_src_global generation:  0.015494823455810547
r_  generation:  0.13208603858947754
local_output_nid generation:  0.006582975387573242
local_in_edges_tensor generation:  0.0073359012603759766
mini_batch_src_global generation:  0.01523447036743164
r_  generation:  0.13019514083862305
local_output_nid generation:  0.006677865982055664
local_in_edges_tensor generation:  0.007586956024169922
mini_batch_src_global generation:  0.015327692031860352
r_  generation:  0.13201475143432617
local_output_nid generation:  0.006768703460693359
local_in_edges_tensor generation:  0.00982666015625
mini_batch_src_global generation:  0.015645265579223633
r_  generation:  0.1329808235168457
local_output_nid generation:  0.0068094730377197266
local_in_edges_tensor generation:  0.007823467254638672
mini_batch_src_global generation:  0.01599597930908203
r_  generation:  0.1335587501525879
local_output_nid generation:  0.006890058517456055
local_in_edges_tensor generation:  0.009192228317260742
mini_batch_src_global generation:  0.02517414093017578
r_  generation:  0.13389372825622559
local_output_nid generation:  0.0064051151275634766
local_in_edges_tensor generation:  0.007115364074707031
mini_batch_src_global generation:  0.014866352081298828
r_  generation:  0.12313199043273926
local_output_nid generation:  0.006658315658569336
local_in_edges_tensor generation:  0.0075719356536865234
mini_batch_src_global generation:  0.021345853805541992
r_  generation:  0.12999558448791504
local_output_nid generation:  0.006746053695678711
local_in_edges_tensor generation:  0.008880138397216797
mini_batch_src_global generation:  0.016758203506469727
r_  generation:  0.12994933128356934
local_output_nid generation:  0.006644010543823242
local_in_edges_tensor generation:  0.0072116851806640625
mini_batch_src_global generation:  0.015478134155273438
r_  generation:  0.1266038417816162
local_output_nid generation:  0.006823062896728516
local_in_edges_tensor generation:  0.008448362350463867
mini_batch_src_global generation:  0.015685319900512695
r_  generation:  0.12985491752624512
local_output_nid generation:  0.006578683853149414
local_in_edges_tensor generation:  0.007401466369628906
mini_batch_src_global generation:  0.01953744888305664
r_  generation:  0.1267838478088379
local_output_nid generation:  0.006663799285888672
local_in_edges_tensor generation:  0.009232044219970703
mini_batch_src_global generation:  0.018308639526367188
r_  generation:  0.1270766258239746
local_output_nid generation:  0.006790637969970703
local_in_edges_tensor generation:  0.00856328010559082
mini_batch_src_global generation:  0.01667046546936035
r_  generation:  0.13208556175231934
local_output_nid generation:  0.006910562515258789
local_in_edges_tensor generation:  0.009619474411010742
mini_batch_src_global generation:  0.016494274139404297
r_  generation:  0.13243699073791504
local_output_nid generation:  0.006928920745849609
local_in_edges_tensor generation:  0.008006811141967773
mini_batch_src_global generation:  0.01608133316040039
r_  generation:  0.13404011726379395
local_output_nid generation:  0.0069408416748046875
local_in_edges_tensor generation:  0.01040792465209961
mini_batch_src_global generation:  0.016614437103271484
r_  generation:  0.1360328197479248
local_output_nid generation:  0.006912946701049805
local_in_edges_tensor generation:  0.007635354995727539
mini_batch_src_global generation:  0.015764951705932617
r_  generation:  0.13056278228759766
local_output_nid generation:  0.006722450256347656
local_in_edges_tensor generation:  0.008486747741699219
mini_batch_src_global generation:  0.015872478485107422
r_  generation:  0.12979722023010254
local_output_nid generation:  0.006899833679199219
local_in_edges_tensor generation:  0.010616540908813477
mini_batch_src_global generation:  0.016260623931884766
r_  generation:  0.13410425186157227
local_output_nid generation:  0.007196664810180664
local_in_edges_tensor generation:  0.009944677352905273
mini_batch_src_global generation:  0.0165255069732666
r_  generation:  0.13602113723754883
local_output_nid generation:  0.006963968276977539
local_in_edges_tensor generation:  0.009800910949707031
mini_batch_src_global generation:  0.016408920288085938
r_  generation:  0.13412690162658691
local_output_nid generation:  0.006940603256225586
local_in_edges_tensor generation:  0.0077855587005615234
mini_batch_src_global generation:  0.015883684158325195
r_  generation:  0.13562631607055664
local_output_nid generation:  0.007878541946411133
local_in_edges_tensor generation:  0.008089780807495117
mini_batch_src_global generation:  0.01781773567199707
r_  generation:  0.1356806755065918
----------------------check_connections_block total spend ----------------------------- 6.1679394245147705
generate_one_block  0.16660070419311523
generate_one_block  0.1576087474822998
generate_one_block  0.19022774696350098
generate_one_block  0.1777346134185791
generate_one_block  0.16426920890808105
generate_one_block  0.15783429145812988
generate_one_block  0.16228842735290527
generate_one_block  0.16250014305114746
generate_one_block  0.16818737983703613
generate_one_block  0.161271333694458
generate_one_block  0.1643209457397461
generate_one_block  0.16564083099365234
generate_one_block  0.17104387283325195
generate_one_block  0.1685504913330078
generate_one_block  0.14928555488586426
generate_one_block  0.18610596656799316
generate_one_block  0.16103696823120117
generate_one_block  0.15546798706054688
generate_one_block  0.16360712051391602
generate_one_block  0.15700173377990723
generate_one_block  0.15776610374450684
generate_one_block  0.16266608238220215
generate_one_block  0.1681225299835205
generate_one_block  0.16836285591125488
generate_one_block  0.17024779319763184
generate_one_block  0.15953278541564941
generate_one_block  0.1588730812072754
generate_one_block  0.16666769981384277
generate_one_block  0.17829656600952148
generate_one_block  0.16777372360229492
generate_one_block  0.16456913948059082
generate_one_block  0.17168331146240234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06466436386108398
gen group dst list time:  0.1020820140838623
time for parepare:  0.021678924560546875
local_output_nid generation:  0.020739078521728516
local_in_edges_tensor generation:  0.04279923439025879
mini_batch_src_global generation:  0.05462765693664551
r_  generation:  0.3800382614135742
local_output_nid generation:  0.02765941619873047
local_in_edges_tensor generation:  0.04147791862487793
mini_batch_src_global generation:  0.044524192810058594
r_  generation:  0.3874685764312744
local_output_nid generation:  0.026977062225341797
local_in_edges_tensor generation:  0.03731989860534668
mini_batch_src_global generation:  0.047577857971191406
r_  generation:  0.39421963691711426
local_output_nid generation:  0.025674104690551758
local_in_edges_tensor generation:  0.02985358238220215
mini_batch_src_global generation:  0.04691028594970703
r_  generation:  0.3965325355529785
local_output_nid generation:  0.02552938461303711
local_in_edges_tensor generation:  0.029653310775756836
mini_batch_src_global generation:  0.04948902130126953
r_  generation:  0.3929893970489502
local_output_nid generation:  0.02540111541748047
local_in_edges_tensor generation:  0.026468515396118164
mini_batch_src_global generation:  0.04623770713806152
r_  generation:  0.3921232223510742
local_output_nid generation:  0.025342702865600586
local_in_edges_tensor generation:  0.02672100067138672
mini_batch_src_global generation:  0.04725527763366699
r_  generation:  0.39219141006469727
local_output_nid generation:  0.02534317970275879
local_in_edges_tensor generation:  0.030533313751220703
mini_batch_src_global generation:  0.060465097427368164
r_  generation:  0.39284563064575195
local_output_nid generation:  0.02575826644897461
local_in_edges_tensor generation:  0.038019657135009766
mini_batch_src_global generation:  0.0523679256439209
r_  generation:  0.4048457145690918
local_output_nid generation:  0.026749849319458008
local_in_edges_tensor generation:  0.02988886833190918
mini_batch_src_global generation:  0.06551003456115723
r_  generation:  0.4013330936431885
local_output_nid generation:  0.028395891189575195
local_in_edges_tensor generation:  0.03328657150268555
mini_batch_src_global generation:  0.05125284194946289
r_  generation:  0.39486193656921387
local_output_nid generation:  0.02610492706298828
local_in_edges_tensor generation:  0.03511810302734375
mini_batch_src_global generation:  0.04711103439331055
r_  generation:  0.398237943649292
local_output_nid generation:  0.026027441024780273
local_in_edges_tensor generation:  0.035120487213134766
mini_batch_src_global generation:  0.047403573989868164
r_  generation:  0.4005777835845947
local_output_nid generation:  0.026597023010253906
local_in_edges_tensor generation:  0.03013134002685547
mini_batch_src_global generation:  0.04743218421936035
r_  generation:  0.3996570110321045
local_output_nid generation:  0.025521278381347656
local_in_edges_tensor generation:  0.02605128288269043
mini_batch_src_global generation:  0.04618191719055176
r_  generation:  0.3876469135284424
local_output_nid generation:  0.02572345733642578
local_in_edges_tensor generation:  0.02982807159423828
mini_batch_src_global generation:  0.04687237739562988
r_  generation:  0.3967123031616211
local_output_nid generation:  0.02583003044128418
local_in_edges_tensor generation:  0.034473419189453125
mini_batch_src_global generation:  0.04647254943847656
r_  generation:  0.3964860439300537
local_output_nid generation:  0.02604985237121582
local_in_edges_tensor generation:  0.026694774627685547
mini_batch_src_global generation:  0.047154903411865234
r_  generation:  0.39489078521728516
local_output_nid generation:  0.02602386474609375
local_in_edges_tensor generation:  0.03787636756896973
mini_batch_src_global generation:  0.04710245132446289
r_  generation:  0.395845890045166
local_output_nid generation:  0.025792837142944336
local_in_edges_tensor generation:  0.037973880767822266
mini_batch_src_global generation:  0.04657769203186035
r_  generation:  0.39386868476867676
local_output_nid generation:  0.025937318801879883
local_in_edges_tensor generation:  0.024962902069091797
mini_batch_src_global generation:  0.04654288291931152
r_  generation:  0.39522671699523926
local_output_nid generation:  0.026129484176635742
local_in_edges_tensor generation:  0.028239727020263672
mini_batch_src_global generation:  0.04689764976501465
r_  generation:  0.39865994453430176
local_output_nid generation:  0.02616286277770996
local_in_edges_tensor generation:  0.02857518196105957
mini_batch_src_global generation:  0.0468449592590332
r_  generation:  0.40784287452697754
local_output_nid generation:  0.02702188491821289
local_in_edges_tensor generation:  0.028933286666870117
mini_batch_src_global generation:  0.05037403106689453
r_  generation:  0.40003204345703125
local_output_nid generation:  0.026404142379760742
local_in_edges_tensor generation:  0.024809598922729492
mini_batch_src_global generation:  0.050032854080200195
r_  generation:  0.40413522720336914
local_output_nid generation:  0.02637648582458496
local_in_edges_tensor generation:  0.024977684020996094
mini_batch_src_global generation:  0.047815561294555664
r_  generation:  0.3934817314147949
local_output_nid generation:  0.02601146697998047
local_in_edges_tensor generation:  0.024016141891479492
mini_batch_src_global generation:  0.04945254325866699
r_  generation:  0.39734339714050293
local_output_nid generation:  0.026411056518554688
local_in_edges_tensor generation:  0.03161001205444336
mini_batch_src_global generation:  0.0467073917388916
r_  generation:  0.40085744857788086
local_output_nid generation:  0.026409626007080078
local_in_edges_tensor generation:  0.0330660343170166
mini_batch_src_global generation:  0.049671173095703125
r_  generation:  0.40299487113952637
local_output_nid generation:  0.026350021362304688
local_in_edges_tensor generation:  0.02436685562133789
mini_batch_src_global generation:  0.04758906364440918
r_  generation:  0.3984255790710449
local_output_nid generation:  0.02624034881591797
local_in_edges_tensor generation:  0.02493882179260254
mini_batch_src_global generation:  0.04730653762817383
r_  generation:  0.39990663528442383
local_output_nid generation:  0.026256799697875977
local_in_edges_tensor generation:  0.031334638595581055
mini_batch_src_global generation:  0.04728984832763672
r_  generation:  0.3977210521697998
----------------------check_connections_block total spend ----------------------------- 18.899585723876953
generate_one_block  0.6007797718048096
generate_one_block  0.5144393444061279
generate_one_block  0.5213921070098877
generate_one_block  0.508126974105835
generate_one_block  0.5106170177459717
generate_one_block  0.4987812042236328
generate_one_block  0.5053274631500244
generate_one_block  0.5140523910522461
generate_one_block  0.5229318141937256
generate_one_block  0.5039234161376953
generate_one_block  0.5063328742980957
generate_one_block  0.5115361213684082
generate_one_block  0.514453649520874
generate_one_block  0.5168612003326416
generate_one_block  0.4904515743255615
generate_one_block  0.5027856826782227
generate_one_block  0.5104610919952393
generate_one_block  0.5101113319396973
generate_one_block  0.5105228424072266
generate_one_block  0.5001537799835205
generate_one_block  0.5168681144714355
generate_one_block  0.513817310333252
generate_one_block  0.5208592414855957
generate_one_block  0.5232076644897461
generate_one_block  0.5283377170562744
generate_one_block  0.5015439987182617
generate_one_block  0.49892711639404297
generate_one_block  0.5069952011108398
generate_one_block  0.5193963050842285
generate_one_block  0.5105340480804443
generate_one_block  0.5045053958892822
generate_one_block  0.5139784812927246
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  25.067525148391724
block generation total time  21.738157987594604
average batch blocks generation time:  0.6793174371123314
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08274030685424805  GigaBytes
Max Memory Allocated: 0.08274030685424805  GigaBytes

torch.Size([145426, 128])
torch.Size([99040, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.14943408966064453  GigaBytes
Max Memory Allocated: 0.15085792541503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08183956146240234  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145052, 128])
torch.Size([97835, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1465015411376953  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08331584930419922  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([146359, 128])
torch.Size([100339, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1503582000732422  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0821084976196289  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145132, 128])
torch.Size([98643, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14784908294677734  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08321475982666016  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145701, 128])
torch.Size([99476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15005111694335938  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08300304412841797  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145474, 128])
torch.Size([98655, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14776945114135742  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08314323425292969  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145641, 128])
torch.Size([99190, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14899635314941406  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0820474624633789  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145324, 128])
torch.Size([98015, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14678287506103516  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08231830596923828  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145230, 128])
torch.Size([100030, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1492762565612793  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08203840255737305  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145139, 128])
torch.Size([98734, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1468524932861328  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08321285247802734  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145835, 128])
torch.Size([99137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1499490737915039  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08327674865722656  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145706, 128])
torch.Size([99732, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1501178741455078  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0823659896850586  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145350, 128])
torch.Size([99739, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.149261474609375  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08334922790527344  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([146017, 128])
torch.Size([100189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15036821365356445  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08272743225097656  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145594, 128])
torch.Size([97375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14636850357055664  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0819711685180664  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145008, 128])
torch.Size([98701, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14767932891845703  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08205556869506836  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145211, 128])
torch.Size([98875, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14696836471557617  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08195018768310547  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145356, 128])
torch.Size([98742, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1467604637145996  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08199262619018555  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145041, 128])
torch.Size([98538, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1468186378479004  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08185529708862305  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145097, 128])
torch.Size([97973, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14641857147216797  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08300304412841797  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145674, 128])
torch.Size([98406, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14777278900146484  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08311748504638672  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145415, 128])
torch.Size([98918, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14796686172485352  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08326530456542969  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145519, 128])
torch.Size([99285, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15000581741333008  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08329296112060547  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145632, 128])
torch.Size([99773, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1501154899597168  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08336925506591797  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145798, 128])
torch.Size([100332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15040922164916992  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08195304870605469  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145150, 128])
torch.Size([98706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14683008193969727  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08205795288085938  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145320, 128])
torch.Size([98128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14671707153320312  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08327960968017578  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145435, 128])
torch.Size([99558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1500868797302246  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08331108093261719  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145531, 128])
torch.Size([99763, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15022659301757812  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08327484130859375  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145556, 128])
torch.Size([99574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1500988006591797  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0821084976196289  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145176, 128])
torch.Size([98884, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14794683456420898  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08330345153808594  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145802, 128])
torch.Size([99619, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1501636505126953  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02904912829399109 |0.018486596643924713 |0.02586819976568222 |9.100884199142456e-05 |0.004683159291744232 |0.0016906261444091797 |
----------------------------------------------------------pseudo_mini_loss sum 5.023825645446777
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8576576
Number of first layer input nodes during this epoch:  4654701
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.11184501647949219  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022275447845458984
range selection method range initialization spend 0.011432886123657227
time for parepare:  0.015866994857788086
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.007653713226318359
mini_batch_src_global generation:  0.0012128353118896484
r_  generation:  0.00835108757019043
local_output_nid generation:  0.0008363723754882812
local_in_edges_tensor generation:  0.0005755424499511719
mini_batch_src_global generation:  0.0010879039764404297
r_  generation:  0.008166313171386719
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.000904083251953125
r_  generation:  0.007563114166259766
local_output_nid generation:  0.0007941722869873047
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0008106231689453125
r_  generation:  0.007735729217529297
local_output_nid generation:  0.0007827281951904297
local_in_edges_tensor generation:  0.0004534721374511719
mini_batch_src_global generation:  0.0007812976837158203
r_  generation:  0.00791478157043457
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0004611015319824219
mini_batch_src_global generation:  0.00079345703125
r_  generation:  0.0077991485595703125
local_output_nid generation:  0.0007715225219726562
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0008027553558349609
r_  generation:  0.008022308349609375
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0007958412170410156
r_  generation:  0.00800323486328125
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.0004520416259765625
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.008162498474121094
local_output_nid generation:  0.0007503032684326172
local_in_edges_tensor generation:  0.00045990943908691406
mini_batch_src_global generation:  0.0008344650268554688
r_  generation:  0.008357524871826172
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.0008237361907958984
r_  generation:  0.008399486541748047
local_output_nid generation:  0.0007615089416503906
local_in_edges_tensor generation:  0.0004620552062988281
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.0081787109375
local_output_nid generation:  0.0007321834564208984
local_in_edges_tensor generation:  0.0004673004150390625
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.011776924133300781
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0008308887481689453
r_  generation:  0.008107423782348633
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.0004527568817138672
mini_batch_src_global generation:  0.0008246898651123047
r_  generation:  0.008025169372558594
local_output_nid generation:  0.0007522106170654297
local_in_edges_tensor generation:  0.0004603862762451172
mini_batch_src_global generation:  0.0008218288421630859
r_  generation:  0.007986068725585938
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0004527568817138672
mini_batch_src_global generation:  0.0008013248443603516
r_  generation:  0.007834672927856445
local_output_nid generation:  0.0007350444793701172
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0008268356323242188
r_  generation:  0.008260488510131836
local_output_nid generation:  0.0007312297821044922
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0008099079132080078
r_  generation:  0.008112668991088867
local_output_nid generation:  0.0007319450378417969
local_in_edges_tensor generation:  0.0004494190216064453
mini_batch_src_global generation:  0.0008399486541748047
r_  generation:  0.008471488952636719
local_output_nid generation:  0.0007319450378417969
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.0008349418640136719
r_  generation:  0.008181333541870117
local_output_nid generation:  0.0007379055023193359
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.000827789306640625
r_  generation:  0.00822305679321289
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.0004630088806152344
mini_batch_src_global generation:  0.0008425712585449219
r_  generation:  0.008208036422729492
local_output_nid generation:  0.0007297992706298828
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.008589506149291992
local_output_nid generation:  0.0007307529449462891
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.008339643478393555
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0008513927459716797
r_  generation:  0.008281946182250977
local_output_nid generation:  0.0007460117340087891
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0008902549743652344
r_  generation:  0.009207963943481445
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.008318662643432617
local_output_nid generation:  0.0007486343383789062
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.0008568763732910156
r_  generation:  0.008297204971313477
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.0008366107940673828
r_  generation:  0.01077890396118164
local_output_nid generation:  0.0007331371307373047
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.008076190948486328
local_output_nid generation:  0.0007357597351074219
local_in_edges_tensor generation:  0.00044465065002441406
mini_batch_src_global generation:  0.0008378028869628906
r_  generation:  0.00831294059753418
----------------------check_connections_block total spend ----------------------------- 0.42583465576171875
generate_one_block  0.013230085372924805
generate_one_block  0.014513015747070312
generate_one_block  0.012786865234375
generate_one_block  0.012760162353515625
generate_one_block  0.012870550155639648
generate_one_block  0.015196561813354492
generate_one_block  0.012865781784057617
generate_one_block  0.012995481491088867
generate_one_block  0.013176918029785156
generate_one_block  0.013401031494140625
generate_one_block  0.012922048568725586
generate_one_block  0.013143062591552734
generate_one_block  0.013054132461547852
generate_one_block  0.015522956848144531
generate_one_block  0.012585163116455078
generate_one_block  0.012616395950317383
generate_one_block  0.01255655288696289
generate_one_block  0.013318300247192383
generate_one_block  0.012817859649658203
generate_one_block  0.013399124145507812
generate_one_block  0.012864828109741211
generate_one_block  0.01573038101196289
generate_one_block  0.013031721115112305
generate_one_block  0.013510704040527344
generate_one_block  0.013185739517211914
generate_one_block  0.012961864471435547
generate_one_block  0.013525247573852539
generate_one_block  0.013241291046142578
generate_one_block  0.017456769943237305
generate_one_block  0.013498067855834961
generate_one_block  0.013016223907470703
generate_one_block  0.013142824172973633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04950737953186035
gen group dst list time:  0.020961999893188477
time for parepare:  0.021558284759521484
local_output_nid generation:  0.003991603851318359
local_in_edges_tensor generation:  0.02262282371520996
mini_batch_src_global generation:  0.010996580123901367
r_  generation:  0.11888313293457031
local_output_nid generation:  0.006184577941894531
local_in_edges_tensor generation:  0.01125025749206543
mini_batch_src_global generation:  0.014328479766845703
r_  generation:  0.12247586250305176
local_output_nid generation:  0.00629734992980957
local_in_edges_tensor generation:  0.02635359764099121
mini_batch_src_global generation:  0.013872385025024414
r_  generation:  0.12634563446044922
local_output_nid generation:  0.006313800811767578
local_in_edges_tensor generation:  0.00925755500793457
mini_batch_src_global generation:  0.013794898986816406
r_  generation:  0.12761521339416504
local_output_nid generation:  0.006589412689208984
local_in_edges_tensor generation:  0.008453607559204102
mini_batch_src_global generation:  0.014316558837890625
r_  generation:  0.1304314136505127
local_output_nid generation:  0.006789684295654297
local_in_edges_tensor generation:  0.008318185806274414
mini_batch_src_global generation:  0.01495814323425293
r_  generation:  0.1305241584777832
local_output_nid generation:  0.0069386959075927734
local_in_edges_tensor generation:  0.007715702056884766
mini_batch_src_global generation:  0.016109466552734375
r_  generation:  0.13135194778442383
local_output_nid generation:  0.0069963932037353516
local_in_edges_tensor generation:  0.009800195693969727
mini_batch_src_global generation:  0.015606164932250977
r_  generation:  0.1317591667175293
local_output_nid generation:  0.008263587951660156
local_in_edges_tensor generation:  0.01006460189819336
mini_batch_src_global generation:  0.015955209732055664
r_  generation:  0.13300561904907227
local_output_nid generation:  0.0069217681884765625
local_in_edges_tensor generation:  0.01387476921081543
mini_batch_src_global generation:  0.017299652099609375
r_  generation:  0.13471603393554688
local_output_nid generation:  0.006941556930541992
local_in_edges_tensor generation:  0.007836103439331055
mini_batch_src_global generation:  0.02164316177368164
r_  generation:  0.12947678565979004
local_output_nid generation:  0.007073640823364258
local_in_edges_tensor generation:  0.007927656173706055
mini_batch_src_global generation:  0.016042709350585938
r_  generation:  0.13352417945861816
local_output_nid generation:  0.007353782653808594
local_in_edges_tensor generation:  0.01129603385925293
mini_batch_src_global generation:  0.016455888748168945
r_  generation:  0.1353893280029297
local_output_nid generation:  0.007248640060424805
local_in_edges_tensor generation:  0.008155345916748047
mini_batch_src_global generation:  0.018867015838623047
r_  generation:  0.13295292854309082
local_output_nid generation:  0.007083415985107422
local_in_edges_tensor generation:  0.008870363235473633
mini_batch_src_global generation:  0.015385627746582031
r_  generation:  0.12956857681274414
local_output_nid generation:  0.007193088531494141
local_in_edges_tensor generation:  0.008966684341430664
mini_batch_src_global generation:  0.015549421310424805
r_  generation:  0.13165664672851562
local_output_nid generation:  0.008201837539672852
local_in_edges_tensor generation:  0.011900663375854492
mini_batch_src_global generation:  0.021431684494018555
r_  generation:  0.13491606712341309
local_output_nid generation:  0.008530378341674805
local_in_edges_tensor generation:  0.013764142990112305
mini_batch_src_global generation:  0.017520666122436523
r_  generation:  0.1372823715209961
local_output_nid generation:  0.007493734359741211
local_in_edges_tensor generation:  0.009031534194946289
mini_batch_src_global generation:  0.01616382598876953
r_  generation:  0.13682937622070312
local_output_nid generation:  0.008026123046875
local_in_edges_tensor generation:  0.011448860168457031
mini_batch_src_global generation:  0.02012181282043457
r_  generation:  0.14044809341430664
local_output_nid generation:  0.007498025894165039
local_in_edges_tensor generation:  0.008228778839111328
mini_batch_src_global generation:  0.01597142219543457
r_  generation:  0.13385319709777832
local_output_nid generation:  0.007331371307373047
local_in_edges_tensor generation:  0.007915496826171875
mini_batch_src_global generation:  0.034375905990600586
r_  generation:  0.1361255645751953
local_output_nid generation:  0.007176876068115234
local_in_edges_tensor generation:  0.009257078170776367
mini_batch_src_global generation:  0.016915082931518555
r_  generation:  0.13737130165100098
local_output_nid generation:  0.007258176803588867
local_in_edges_tensor generation:  0.012869596481323242
mini_batch_src_global generation:  0.01691126823425293
r_  generation:  0.13856244087219238
local_output_nid generation:  0.007375478744506836
local_in_edges_tensor generation:  0.011490821838378906
mini_batch_src_global generation:  0.016646146774291992
r_  generation:  0.14054107666015625
local_output_nid generation:  0.014893770217895508
local_in_edges_tensor generation:  0.008330821990966797
mini_batch_src_global generation:  0.01636958122253418
r_  generation:  0.13492465019226074
local_output_nid generation:  0.007491350173950195
local_in_edges_tensor generation:  0.009416818618774414
mini_batch_src_global generation:  0.017605304718017578
r_  generation:  0.1497054100036621
local_output_nid generation:  0.008637428283691406
local_in_edges_tensor generation:  0.017389297485351562
mini_batch_src_global generation:  0.017865419387817383
r_  generation:  0.13821792602539062
local_output_nid generation:  0.00733637809753418
local_in_edges_tensor generation:  0.00772547721862793
mini_batch_src_global generation:  0.016318798065185547
r_  generation:  0.1468496322631836
local_output_nid generation:  0.009296178817749023
local_in_edges_tensor generation:  0.01708507537841797
mini_batch_src_global generation:  0.017897605895996094
r_  generation:  0.13781499862670898
local_output_nid generation:  0.007142305374145508
local_in_edges_tensor generation:  0.008854389190673828
mini_batch_src_global generation:  0.016608476638793945
r_  generation:  0.13653278350830078
local_output_nid generation:  0.0072443485260009766
local_in_edges_tensor generation:  0.00778651237487793
mini_batch_src_global generation:  0.015850543975830078
r_  generation:  0.13602709770202637
----------------------check_connections_block total spend ----------------------------- 6.479032039642334
generate_one_block  0.16647744178771973
generate_one_block  0.15525579452514648
generate_one_block  0.1631004810333252
generate_one_block  0.16309165954589844
generate_one_block  0.1780400276184082
generate_one_block  0.16016221046447754
generate_one_block  0.16234517097473145
generate_one_block  0.16311860084533691
generate_one_block  0.16956090927124023
generate_one_block  0.1727161407470703
generate_one_block  0.1595757007598877
generate_one_block  0.16414713859558105
generate_one_block  0.18210482597351074
generate_one_block  0.1604776382446289
generate_one_block  0.1566312313079834
generate_one_block  0.161407470703125
generate_one_block  0.16023850440979004
generate_one_block  0.1724565029144287
generate_one_block  0.16436076164245605
generate_one_block  0.20291781425476074
generate_one_block  0.16120481491088867
generate_one_block  0.16231536865234375
generate_one_block  0.16771817207336426
generate_one_block  0.17298245429992676
generate_one_block  0.17075109481811523
generate_one_block  0.16231393814086914
generate_one_block  0.1734757423400879
generate_one_block  0.1721346378326416
generate_one_block  0.164475679397583
generate_one_block  0.16301608085632324
generate_one_block  0.16031551361083984
generate_one_block  0.16870903968811035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04750847816467285
gen group dst list time:  0.0993344783782959
time for parepare:  0.01957082748413086
local_output_nid generation:  0.020702123641967773
local_in_edges_tensor generation:  0.04325413703918457
mini_batch_src_global generation:  0.03518939018249512
r_  generation:  0.3814716339111328
local_output_nid generation:  0.03128695487976074
local_in_edges_tensor generation:  0.04124617576599121
mini_batch_src_global generation:  0.05386471748352051
r_  generation:  0.3872201442718506
local_output_nid generation:  0.02667236328125
local_in_edges_tensor generation:  0.034293174743652344
mini_batch_src_global generation:  0.048021793365478516
r_  generation:  0.39926838874816895
local_output_nid generation:  0.02709650993347168
local_in_edges_tensor generation:  0.03280186653137207
mini_batch_src_global generation:  0.04714798927307129
r_  generation:  0.39522886276245117
local_output_nid generation:  0.026393651962280273
local_in_edges_tensor generation:  0.029045581817626953
mini_batch_src_global generation:  0.05012011528015137
r_  generation:  0.3960099220275879
local_output_nid generation:  0.025697946548461914
local_in_edges_tensor generation:  0.025880813598632812
mini_batch_src_global generation:  0.04727053642272949
r_  generation:  0.39166879653930664
local_output_nid generation:  0.025808095932006836
local_in_edges_tensor generation:  0.03159642219543457
mini_batch_src_global generation:  0.049686431884765625
r_  generation:  0.4038124084472656
local_output_nid generation:  0.026014089584350586
local_in_edges_tensor generation:  0.03248476982116699
mini_batch_src_global generation:  0.04757285118103027
r_  generation:  0.3941917419433594
local_output_nid generation:  0.026227474212646484
local_in_edges_tensor generation:  0.03275871276855469
mini_batch_src_global generation:  0.04732537269592285
r_  generation:  0.4023909568786621
local_output_nid generation:  0.026548385620117188
local_in_edges_tensor generation:  0.029905319213867188
mini_batch_src_global generation:  0.04806852340698242
r_  generation:  0.40879273414611816
local_output_nid generation:  0.026274681091308594
local_in_edges_tensor generation:  0.026338577270507812
mini_batch_src_global generation:  0.04732394218444824
r_  generation:  0.39748525619506836
local_output_nid generation:  0.026232481002807617
local_in_edges_tensor generation:  0.025249481201171875
mini_batch_src_global generation:  0.04748368263244629
r_  generation:  0.4105827808380127
local_output_nid generation:  0.026256799697875977
local_in_edges_tensor generation:  0.02980947494506836
mini_batch_src_global generation:  0.04727959632873535
r_  generation:  0.4049839973449707
local_output_nid generation:  0.026300430297851562
local_in_edges_tensor generation:  0.025992155075073242
mini_batch_src_global generation:  0.04780840873718262
r_  generation:  0.40040040016174316
local_output_nid generation:  0.025890350341796875
local_in_edges_tensor generation:  0.025705337524414062
mini_batch_src_global generation:  0.046553611755371094
r_  generation:  0.39659786224365234
local_output_nid generation:  0.02616739273071289
local_in_edges_tensor generation:  0.03255128860473633
mini_batch_src_global generation:  0.04680943489074707
r_  generation:  0.39541053771972656
local_output_nid generation:  0.026368141174316406
local_in_edges_tensor generation:  0.029876232147216797
mini_batch_src_global generation:  0.046614646911621094
r_  generation:  0.40025854110717773
local_output_nid generation:  0.026700735092163086
local_in_edges_tensor generation:  0.029328107833862305
mini_batch_src_global generation:  0.04998779296875
r_  generation:  0.4083249568939209
local_output_nid generation:  0.02658557891845703
local_in_edges_tensor generation:  0.03298616409301758
mini_batch_src_global generation:  0.04700303077697754
r_  generation:  0.4017634391784668
local_output_nid generation:  0.026804447174072266
local_in_edges_tensor generation:  0.03000783920288086
mini_batch_src_global generation:  0.050437211990356445
r_  generation:  0.4080359935760498
local_output_nid generation:  0.02625250816345215
local_in_edges_tensor generation:  0.03540539741516113
mini_batch_src_global generation:  0.04707741737365723
r_  generation:  0.3992743492126465
local_output_nid generation:  0.026366472244262695
local_in_edges_tensor generation:  0.025847434997558594
mini_batch_src_global generation:  0.047838449478149414
r_  generation:  0.4022810459136963
local_output_nid generation:  0.026547908782958984
local_in_edges_tensor generation:  0.03303790092468262
mini_batch_src_global generation:  0.04960894584655762
r_  generation:  0.4051377773284912
local_output_nid generation:  0.02658843994140625
local_in_edges_tensor generation:  0.03356480598449707
mini_batch_src_global generation:  0.04717135429382324
r_  generation:  0.40526700019836426
local_output_nid generation:  0.026872873306274414
local_in_edges_tensor generation:  0.03300118446350098
mini_batch_src_global generation:  0.046823740005493164
r_  generation:  0.40308427810668945
local_output_nid generation:  0.026717662811279297
local_in_edges_tensor generation:  0.02646017074584961
mini_batch_src_global generation:  0.04725289344787598
r_  generation:  0.4029512405395508
local_output_nid generation:  0.027652263641357422
local_in_edges_tensor generation:  0.029400110244750977
mini_batch_src_global generation:  0.04753828048706055
r_  generation:  0.40789103507995605
local_output_nid generation:  0.026859045028686523
local_in_edges_tensor generation:  0.0403444766998291
mini_batch_src_global generation:  0.04717445373535156
r_  generation:  0.40088486671447754
local_output_nid generation:  0.026834487915039062
local_in_edges_tensor generation:  0.029685497283935547
mini_batch_src_global generation:  0.049088239669799805
r_  generation:  0.40692591667175293
local_output_nid generation:  0.026885509490966797
local_in_edges_tensor generation:  0.02638840675354004
mini_batch_src_global generation:  0.047278404235839844
r_  generation:  0.4000709056854248
local_output_nid generation:  0.02688765525817871
local_in_edges_tensor generation:  0.027365446090698242
mini_batch_src_global generation:  0.04697847366333008
r_  generation:  0.4055793285369873
local_output_nid generation:  0.026685476303100586
local_in_edges_tensor generation:  0.027926206588745117
mini_batch_src_global generation:  0.04717206954956055
r_  generation:  0.3976573944091797
----------------------check_connections_block total spend ----------------------------- 18.994344472885132
generate_one_block  0.5133779048919678
generate_one_block  0.5150172710418701
generate_one_block  0.5303997993469238
generate_one_block  0.5150716304779053
generate_one_block  0.6234002113342285
generate_one_block  0.5054054260253906
generate_one_block  0.5151407718658447
generate_one_block  0.5195496082305908
generate_one_block  0.5195040702819824
generate_one_block  0.5238673686981201
generate_one_block  0.5037705898284912
generate_one_block  0.5094895362854004
generate_one_block  0.5345108509063721
generate_one_block  0.5023980140686035
generate_one_block  0.546400785446167
generate_one_block  0.5360658168792725
generate_one_block  0.5379316806793213
generate_one_block  0.5283167362213135
generate_one_block  0.5449182987213135
generate_one_block  0.5448455810546875
generate_one_block  0.5174174308776855
generate_one_block  0.5307176113128662
generate_one_block  0.5182087421417236
generate_one_block  0.5475635528564453
generate_one_block  0.5560288429260254
generate_one_block  0.517141580581665
generate_one_block  0.5282266139984131
generate_one_block  0.5340883731842041
generate_one_block  0.5247173309326172
generate_one_block  0.5129094123840332
generate_one_block  0.5230867862701416
generate_one_block  0.516211748123169
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.11184501647949219  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

connection checking time:  25.473376512527466
block generation total time  22.233298540115356
average batch blocks generation time:  0.6947905793786049
block dataloader generation time/epoch 50.06313705444336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08190250396728516  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([144881, 128])
torch.Size([98100, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14654970169067383  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08172082901000977  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([144769, 128])
torch.Size([97496, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14621400833129883  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.082275390625  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145402, 128])
torch.Size([99243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14802885055541992  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08316993713378906  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145683, 128])
torch.Size([98940, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14797592163085938  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08320236206054688  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145533, 128])
torch.Size([99011, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14809465408325195  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08202362060546875  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145190, 128])
torch.Size([98018, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14668798446655273  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08209705352783203  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145122, 128])
torch.Size([98342, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14684104919433594  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08324241638183594  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145838, 128])
torch.Size([98872, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14803743362426758  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08234739303588867  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145289, 128])
torch.Size([99523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1491246223449707  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08342170715332031  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145830, 128])
torch.Size([100343, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1504974365234375  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08315753936767578  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145623, 128])
torch.Size([99048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1480846405029297  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08210945129394531  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([144944, 128])
torch.Size([98697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14788436889648438  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08342647552490234  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145697, 128])
torch.Size([99993, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15034198760986328  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.0821828842163086  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145306, 128])
torch.Size([98663, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14694929122924805  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08185958862304688  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145026, 128])
torch.Size([97559, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1463785171508789  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08217191696166992  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145343, 128])
torch.Size([98514, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14687442779541016  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08308982849121094  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145547, 128])
torch.Size([98927, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14788436889648438  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08236503601074219  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145390, 128])
torch.Size([99670, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1492476463317871  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08328819274902344  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145419, 128])
torch.Size([99121, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1490468978881836  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08353900909423828  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145779, 128])
torch.Size([100270, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1506505012512207  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08319759368896484  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145579, 128])
torch.Size([98740, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14803552627563477  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08325672149658203  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145423, 128])
torch.Size([98958, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14909076690673828  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08331871032714844  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145692, 128])
torch.Size([99069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1491403579711914  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08244895935058594  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145368, 128])
torch.Size([99647, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14935016632080078  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08239984512329102  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145315, 128])
torch.Size([99584, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14925336837768555  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08222293853759766  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145308, 128])
torch.Size([98891, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14712858200073242  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08346080780029297  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145816, 128])
torch.Size([99760, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1504354476928711  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08347702026367188  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([145991, 128])
torch.Size([100617, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15062713623046875  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08338451385498047  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

torch.Size([146026, 128])
torch.Size([100667, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.1504988670349121  GigaBytes
Max Memory Allocated: 0.1646885871887207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08328723907470703  GigaBytes
Max Memory Allocated: 0.16508150100708008  GigaBytes

torch.Size([145663, 128])
torch.Size([99265, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.15006351470947266  GigaBytes
Max Memory Allocated: 0.16508150100708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08321571350097656  GigaBytes
Max Memory Allocated: 0.16508150100708008  GigaBytes

torch.Size([145528, 128])
torch.Size([99309, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14906024932861328  GigaBytes
Max Memory Allocated: 0.16508150100708008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.08318328857421875  GigaBytes
Max Memory Allocated: 0.16508150100708008  GigaBytes

torch.Size([145520, 128])
torch.Size([98495, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.14802122116088867  GigaBytes
Max Memory Allocated: 0.16508150100708008  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025005772709846497 |0.011979058384895325 |0.003373265266418457 |8.963793516159058e-05 |0.0038893967866897583 |0.003130674362182617 |
----------------------------------------------------------pseudo_mini_loss sum 4.3254618644714355
Total (block generation + training)time/epoch 51.52511024475098
Training time/epoch 1.461684226989746
Training time without block to device /epoch 1.0783543586730957
Training time without total dataloading part /epoch 0.2384042739868164
load block tensor time/epoch 0.8001847267150879
block to device time/epoch 0.3833298683166504
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8577221
Number of first layer input nodes during this epoch:  4654840
