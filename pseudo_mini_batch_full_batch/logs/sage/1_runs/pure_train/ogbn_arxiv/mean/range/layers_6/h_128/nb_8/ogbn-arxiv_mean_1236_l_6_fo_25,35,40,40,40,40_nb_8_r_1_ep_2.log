Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648517922.1134684
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024598360061645508
range selection method range initialization spend 0.012853860855102539
time for parepare:  0.017854928970336914
local_output_nid generation:  0.002624988555908203
local_in_edges_tensor generation:  0.004606008529663086
mini_batch_src_global generation:  0.0030851364135742188
r_  generation:  0.03612518310546875
local_output_nid generation:  0.0030715465545654297
local_in_edges_tensor generation:  0.0016183853149414062
mini_batch_src_global generation:  0.003997087478637695
r_  generation:  0.0370945930480957
local_output_nid generation:  0.0030679702758789062
local_in_edges_tensor generation:  0.0016694068908691406
mini_batch_src_global generation:  0.0026187896728515625
r_  generation:  0.037404537200927734
local_output_nid generation:  0.003110170364379883
local_in_edges_tensor generation:  0.0016155242919921875
mini_batch_src_global generation:  0.0028922557830810547
r_  generation:  0.039581298828125
local_output_nid generation:  0.003086566925048828
local_in_edges_tensor generation:  0.0017757415771484375
mini_batch_src_global generation:  0.0028662681579589844
r_  generation:  0.03962230682373047
local_output_nid generation:  0.0031256675720214844
local_in_edges_tensor generation:  0.0015778541564941406
mini_batch_src_global generation:  0.002974271774291992
r_  generation:  0.04028129577636719
local_output_nid generation:  0.0031328201293945312
local_in_edges_tensor generation:  0.0016651153564453125
mini_batch_src_global generation:  0.002936840057373047
r_  generation:  0.040312767028808594
local_output_nid generation:  0.00311279296875
local_in_edges_tensor generation:  0.0016360282897949219
mini_batch_src_global generation:  0.003070354461669922
r_  generation:  0.04079580307006836
----------------------check_connections_block total spend ----------------------------- 0.45943474769592285
generate_one_block  0.05486488342285156
generate_one_block  0.05451488494873047
generate_one_block  0.05359315872192383
generate_one_block  0.05493783950805664
generate_one_block  0.05612587928771973
generate_one_block  0.05390429496765137
generate_one_block  0.05525660514831543
generate_one_block  0.05511951446533203
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04272198677062988
gen group dst list time:  0.014946699142456055
time for parepare:  0.019587039947509766
local_output_nid generation:  0.010669708251953125
local_in_edges_tensor generation:  0.028872013092041016
mini_batch_src_global generation:  0.02777385711669922
r_  generation:  0.29480910301208496
local_output_nid generation:  0.01860952377319336
local_in_edges_tensor generation:  0.02955150604248047
mini_batch_src_global generation:  0.03634524345397949
r_  generation:  0.31054210662841797
local_output_nid generation:  0.019303083419799805
local_in_edges_tensor generation:  0.019684553146362305
mini_batch_src_global generation:  0.03556418418884277
r_  generation:  0.30639100074768066
local_output_nid generation:  0.019745826721191406
local_in_edges_tensor generation:  0.022455930709838867
mini_batch_src_global generation:  0.03933596611022949
r_  generation:  0.31610608100891113
local_output_nid generation:  0.020014286041259766
local_in_edges_tensor generation:  0.02015852928161621
mini_batch_src_global generation:  0.0374903678894043
r_  generation:  0.3124690055847168
local_output_nid generation:  0.02037811279296875
local_in_edges_tensor generation:  0.025185108184814453
mini_batch_src_global generation:  0.0379796028137207
r_  generation:  0.3127286434173584
local_output_nid generation:  0.020459413528442383
local_in_edges_tensor generation:  0.02579975128173828
mini_batch_src_global generation:  0.04071664810180664
r_  generation:  0.3204641342163086
local_output_nid generation:  0.020514965057373047
local_in_edges_tensor generation:  0.028330087661743164
mini_batch_src_global generation:  0.0390164852142334
r_  generation:  0.32584047317504883
----------------------check_connections_block total spend ----------------------------- 3.7007532119750977
generate_one_block  0.4139268398284912
generate_one_block  0.41512489318847656
generate_one_block  0.4046158790588379
generate_one_block  0.41279006004333496
generate_one_block  0.40603017807006836
generate_one_block  0.4156308174133301
generate_one_block  0.4242384433746338
generate_one_block  0.4166100025177002
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03734850883483887
gen group dst list time:  0.03577566146850586
time for parepare:  0.0188753604888916
local_output_nid generation:  0.02569413185119629
local_in_edges_tensor generation:  0.048128366470336914
mini_batch_src_global generation:  0.04943084716796875
r_  generation:  0.5207018852233887
local_output_nid generation:  0.03170156478881836
local_in_edges_tensor generation:  0.051687002182006836
mini_batch_src_global generation:  0.06045961380004883
r_  generation:  0.5227947235107422
local_output_nid generation:  0.03256416320800781
local_in_edges_tensor generation:  0.03807783126831055
mini_batch_src_global generation:  0.057123661041259766
r_  generation:  0.5454022884368896
local_output_nid generation:  0.03317594528198242
local_in_edges_tensor generation:  0.03890514373779297
mini_batch_src_global generation:  0.0604093074798584
r_  generation:  0.5280187129974365
local_output_nid generation:  0.033297061920166016
local_in_edges_tensor generation:  0.039710044860839844
mini_batch_src_global generation:  0.06241178512573242
r_  generation:  0.5431287288665771
local_output_nid generation:  0.03330540657043457
local_in_edges_tensor generation:  0.03466510772705078
mini_batch_src_global generation:  0.06157231330871582
r_  generation:  0.5366871356964111
local_output_nid generation:  0.03335094451904297
local_in_edges_tensor generation:  0.0433349609375
mini_batch_src_global generation:  0.06053900718688965
r_  generation:  0.5512564182281494
local_output_nid generation:  0.03308725357055664
local_in_edges_tensor generation:  0.04358530044555664
mini_batch_src_global generation:  0.061501264572143555
r_  generation:  0.5325102806091309
----------------------check_connections_block total spend ----------------------------- 6.292760133743286
generate_one_block  0.6730442047119141
generate_one_block  0.6772458553314209
generate_one_block  0.6715922355651855
generate_one_block  0.6772148609161377
generate_one_block  0.6859982013702393
generate_one_block  0.6950440406799316
generate_one_block  0.7241067886352539
generate_one_block  0.6684753894805908
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04336714744567871
gen group dst list time:  0.04444551467895508
time for parepare:  0.01951003074645996
local_output_nid generation:  0.031096220016479492
local_in_edges_tensor generation:  0.04624438285827637
mini_batch_src_global generation:  0.050638675689697266
r_  generation:  0.5529086589813232
local_output_nid generation:  0.0374302864074707
local_in_edges_tensor generation:  0.05605769157409668
mini_batch_src_global generation:  0.06529927253723145
r_  generation:  0.5487837791442871
local_output_nid generation:  0.0363469123840332
local_in_edges_tensor generation:  0.04073357582092285
mini_batch_src_global generation:  0.06275653839111328
r_  generation:  0.5547471046447754
local_output_nid generation:  0.03822135925292969
local_in_edges_tensor generation:  0.04129195213317871
mini_batch_src_global generation:  0.060434579849243164
r_  generation:  0.5589172840118408
local_output_nid generation:  0.03716444969177246
local_in_edges_tensor generation:  0.0491328239440918
mini_batch_src_global generation:  0.06399273872375488
r_  generation:  0.5628392696380615
local_output_nid generation:  0.03717446327209473
local_in_edges_tensor generation:  0.034631967544555664
mini_batch_src_global generation:  0.060599327087402344
r_  generation:  0.5669121742248535
local_output_nid generation:  0.03778529167175293
local_in_edges_tensor generation:  0.03797793388366699
mini_batch_src_global generation:  0.06141257286071777
r_  generation:  0.5667760372161865
local_output_nid generation:  0.037477970123291016
local_in_edges_tensor generation:  0.03643369674682617
mini_batch_src_global generation:  0.06131744384765625
r_  generation:  0.5757803916931152
----------------------check_connections_block total spend ----------------------------- 6.657069444656372
generate_one_block  0.7072384357452393
generate_one_block  0.7314691543579102
generate_one_block  0.7202742099761963
generate_one_block  0.7473652362823486
generate_one_block  0.7216618061065674
generate_one_block  0.7047293186187744
generate_one_block  0.7583217620849609
generate_one_block  0.7150731086730957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05057549476623535
gen group dst list time:  0.05471324920654297
time for parepare:  0.01923084259033203
local_output_nid generation:  0.03210783004760742
local_in_edges_tensor generation:  0.06734704971313477
mini_batch_src_global generation:  0.05010104179382324
r_  generation:  0.5362710952758789
local_output_nid generation:  0.03716397285461426
local_in_edges_tensor generation:  0.0531771183013916
mini_batch_src_global generation:  0.06314277648925781
r_  generation:  0.5443789958953857
local_output_nid generation:  0.037305355072021484
local_in_edges_tensor generation:  0.04009389877319336
mini_batch_src_global generation:  0.06636333465576172
r_  generation:  0.5419726371765137
local_output_nid generation:  0.03787088394165039
local_in_edges_tensor generation:  0.04427051544189453
mini_batch_src_global generation:  0.06284403800964355
r_  generation:  0.5462501049041748
local_output_nid generation:  0.03791332244873047
local_in_edges_tensor generation:  0.041303396224975586
mini_batch_src_global generation:  0.06328272819519043
r_  generation:  0.5435292720794678
local_output_nid generation:  0.038298606872558594
local_in_edges_tensor generation:  0.03487372398376465
mini_batch_src_global generation:  0.06242680549621582
r_  generation:  0.5477204322814941
local_output_nid generation:  0.03835320472717285
local_in_edges_tensor generation:  0.040575504302978516
mini_batch_src_global generation:  0.06207871437072754
r_  generation:  0.5482854843139648
local_output_nid generation:  0.03855729103088379
local_in_edges_tensor generation:  0.040238142013549805
mini_batch_src_global generation:  0.062491416931152344
r_  generation:  0.5544822216033936
----------------------check_connections_block total spend ----------------------------- 6.550174951553345
generate_one_block  0.6867084503173828
generate_one_block  0.6967463493347168
generate_one_block  0.691859245300293
generate_one_block  0.6943955421447754
generate_one_block  0.6947438716888428
generate_one_block  0.6779122352600098
generate_one_block  0.6772723197937012
generate_one_block  0.7431232929229736
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05835604667663574
gen group dst list time:  0.04899263381958008
time for parepare:  0.019547462463378906
local_output_nid generation:  0.03227376937866211
local_in_edges_tensor generation:  0.04938101768493652
mini_batch_src_global generation:  0.04615950584411621
r_  generation:  0.49741482734680176
local_output_nid generation:  0.03853917121887207
local_in_edges_tensor generation:  0.03495931625366211
mini_batch_src_global generation:  0.05758523941040039
r_  generation:  0.5037007331848145
local_output_nid generation:  0.03804636001586914
local_in_edges_tensor generation:  0.036356449127197266
mini_batch_src_global generation:  0.05892658233642578
r_  generation:  0.5024495124816895
local_output_nid generation:  0.03803515434265137
local_in_edges_tensor generation:  0.036702632904052734
mini_batch_src_global generation:  0.060667991638183594
r_  generation:  0.5071816444396973
local_output_nid generation:  0.03809022903442383
local_in_edges_tensor generation:  0.04041433334350586
mini_batch_src_global generation:  0.0581362247467041
r_  generation:  0.5059075355529785
local_output_nid generation:  0.03825545310974121
local_in_edges_tensor generation:  0.04079890251159668
mini_batch_src_global generation:  0.05800294876098633
r_  generation:  0.5155775547027588
local_output_nid generation:  0.03813934326171875
local_in_edges_tensor generation:  0.04561591148376465
mini_batch_src_global generation:  0.05805516242980957
r_  generation:  0.5104174613952637
local_output_nid generation:  0.038321495056152344
local_in_edges_tensor generation:  0.04475665092468262
mini_batch_src_global generation:  0.058429718017578125
r_  generation:  0.5074541568756104
----------------------check_connections_block total spend ----------------------------- 6.10844612121582
generate_one_block  0.6437416076660156
generate_one_block  0.6488349437713623
generate_one_block  0.6390960216522217
generate_one_block  0.646831750869751
generate_one_block  0.639136552810669
generate_one_block  0.6337099075317383
generate_one_block  0.6414752006530762
generate_one_block  0.6539452075958252
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

connection checking time:  29.30920386314392
block generation total time  25.297354221343994
average batch blocks generation time:  3.1621692776679993
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.1391887664794922  GigaBytes
Max Memory Allocated: 0.1391887664794922  GigaBytes

torch.Size([167521, 128])
torch.Size([167055, 128])
torch.Size([165770, 128])
torch.Size([161379, 128])
torch.Size([142209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.6397337913513184  GigaBytes
Max Memory Allocated: 1.6686444282531738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5838623046875 GB
    Memory Allocated: 0.14305877685546875  GigaBytes
Max Memory Allocated: 1.7054872512817383  GigaBytes

torch.Size([167535, 128])
torch.Size([167115, 128])
torch.Size([165860, 128])
torch.Size([161355, 128])
torch.Size([142106, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5838623046875 GB
    Memory Allocated: 1.6427717208862305  GigaBytes
Max Memory Allocated: 1.7054872512817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14316415786743164  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

torch.Size([167538, 128])
torch.Size([167071, 128])
torch.Size([165812, 128])
torch.Size([161383, 128])
torch.Size([142057, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6435422897338867  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14296245574951172  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

torch.Size([167532, 128])
torch.Size([167128, 128])
torch.Size([165841, 128])
torch.Size([161349, 128])
torch.Size([141873, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6423358917236328  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14313459396362305  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

torch.Size([167487, 128])
torch.Size([167074, 128])
torch.Size([165819, 128])
torch.Size([161427, 128])
torch.Size([142276, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6404986381530762  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.1428365707397461  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

torch.Size([167499, 128])
torch.Size([167043, 128])
torch.Size([165790, 128])
torch.Size([161362, 128])
torch.Size([142038, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6386933326721191  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14337825775146484  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

torch.Size([167458, 128])
torch.Size([166989, 128])
torch.Size([165740, 128])
torch.Size([161328, 128])
torch.Size([142338, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6453123092651367  GigaBytes
Max Memory Allocated: 1.7077207565307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14304256439208984  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167513, 128])
torch.Size([167047, 128])
torch.Size([165733, 128])
torch.Size([161197, 128])
torch.Size([141759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6428871154785156  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07934707403182983 |0.08575224876403809 |0.09555530548095703 |0.00010782480239868164 |0.04098266363143921 |0.0035092830657958984 |
----------------------------------------------------------pseudo_mini_loss sum 6.065149307250977
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6973322
Number of first layer input nodes during this epoch:  1340083
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.2567329406738281  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.018793106079101562
range selection method range initialization spend 0.011424064636230469
time for parepare:  0.017665624618530273
local_output_nid generation:  0.0026688575744628906
local_in_edges_tensor generation:  0.00484466552734375
mini_batch_src_global generation:  0.003435373306274414
r_  generation:  0.03765678405761719
local_output_nid generation:  0.0030014514923095703
local_in_edges_tensor generation:  0.0016467571258544922
mini_batch_src_global generation:  0.004209756851196289
r_  generation:  0.0389101505279541
local_output_nid generation:  0.0031061172485351562
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.002787351608276367
r_  generation:  0.040369510650634766
local_output_nid generation:  0.003221750259399414
local_in_edges_tensor generation:  0.001748800277709961
mini_batch_src_global generation:  0.0029342174530029297
r_  generation:  0.04140067100524902
local_output_nid generation:  0.003222942352294922
local_in_edges_tensor generation:  0.0016913414001464844
mini_batch_src_global generation:  0.0030515193939208984
r_  generation:  0.04168248176574707
local_output_nid generation:  0.0032570362091064453
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.0031812191009521484
r_  generation:  0.042189598083496094
local_output_nid generation:  0.0032205581665039062
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.003203153610229492
r_  generation:  0.04214119911193848
local_output_nid generation:  0.003206491470336914
local_in_edges_tensor generation:  0.0017158985137939453
mini_batch_src_global generation:  0.003153562545776367
r_  generation:  0.04128146171569824
----------------------check_connections_block total spend ----------------------------- 0.4806339740753174
generate_one_block  0.053510189056396484
generate_one_block  0.054529428482055664
generate_one_block  0.0546259880065918
generate_one_block  0.055726051330566406
generate_one_block  0.055695533752441406
generate_one_block  0.05568885803222656
generate_one_block  0.056108951568603516
generate_one_block  0.057741403579711914
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03963303565979004
gen group dst list time:  0.013832569122314453
time for parepare:  0.01913738250732422
local_output_nid generation:  0.010500669479370117
local_in_edges_tensor generation:  0.026155948638916016
mini_batch_src_global generation:  0.02821516990661621
r_  generation:  0.29453229904174805
local_output_nid generation:  0.01601099967956543
local_in_edges_tensor generation:  0.02799201011657715
mini_batch_src_global generation:  0.03611946105957031
r_  generation:  0.30483531951904297
local_output_nid generation:  0.01651167869567871
local_in_edges_tensor generation:  0.0228879451751709
mini_batch_src_global generation:  0.0381627082824707
r_  generation:  0.31464409828186035
local_output_nid generation:  0.017322540283203125
local_in_edges_tensor generation:  0.02061605453491211
mini_batch_src_global generation:  0.037615299224853516
r_  generation:  0.3206346035003662
local_output_nid generation:  0.01766657829284668
local_in_edges_tensor generation:  0.023757219314575195
mini_batch_src_global generation:  0.03797554969787598
r_  generation:  0.31939172744750977
local_output_nid generation:  0.016896963119506836
local_in_edges_tensor generation:  0.020954132080078125
mini_batch_src_global generation:  0.0385589599609375
r_  generation:  0.31729793548583984
local_output_nid generation:  0.016807079315185547
local_in_edges_tensor generation:  0.021057844161987305
mini_batch_src_global generation:  0.04253244400024414
r_  generation:  0.324307918548584
local_output_nid generation:  0.019097089767456055
local_in_edges_tensor generation:  0.021147727966308594
mini_batch_src_global generation:  0.03911781311035156
r_  generation:  0.32616424560546875
----------------------check_connections_block total spend ----------------------------- 3.6894538402557373
generate_one_block  0.41895222663879395
generate_one_block  0.401810884475708
generate_one_block  0.40813231468200684
generate_one_block  0.4132344722747803
generate_one_block  0.4238736629486084
generate_one_block  0.4035024642944336
generate_one_block  0.41993117332458496
generate_one_block  0.443681001663208
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.12422895431518555
gen group dst list time:  0.04168868064880371
time for parepare:  0.018902301788330078
local_output_nid generation:  0.025988101959228516
local_in_edges_tensor generation:  0.060922861099243164
mini_batch_src_global generation:  0.048688650131225586
r_  generation:  0.5341625213623047
local_output_nid generation:  0.03256034851074219
local_in_edges_tensor generation:  0.05228614807128906
mini_batch_src_global generation:  0.060625314712524414
r_  generation:  0.5349791049957275
local_output_nid generation:  0.03449392318725586
local_in_edges_tensor generation:  0.049742698669433594
mini_batch_src_global generation:  0.057492733001708984
r_  generation:  0.568976640701294
local_output_nid generation:  0.036789655685424805
local_in_edges_tensor generation:  0.043092966079711914
mini_batch_src_global generation:  0.06596541404724121
r_  generation:  0.5345742702484131
local_output_nid generation:  0.0346217155456543
local_in_edges_tensor generation:  0.04340243339538574
mini_batch_src_global generation:  0.0612637996673584
r_  generation:  0.5495154857635498
local_output_nid generation:  0.03503561019897461
local_in_edges_tensor generation:  0.03849530220031738
mini_batch_src_global generation:  0.061746835708618164
r_  generation:  0.5419752597808838
local_output_nid generation:  0.034911394119262695
local_in_edges_tensor generation:  0.03874945640563965
mini_batch_src_global generation:  0.06359481811523438
r_  generation:  0.5650544166564941
local_output_nid generation:  0.03494620323181152
local_in_edges_tensor generation:  0.04375767707824707
mini_batch_src_global generation:  0.06119585037231445
r_  generation:  0.542198657989502
----------------------check_connections_block total spend ----------------------------- 6.454050779342651
generate_one_block  0.7033262252807617
generate_one_block  0.691561222076416
generate_one_block  0.697615385055542
generate_one_block  0.6764442920684814
generate_one_block  0.6817984580993652
generate_one_block  0.684380292892456
generate_one_block  0.7011725902557373
generate_one_block  0.6951792240142822
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.042768239974975586
gen group dst list time:  0.0489349365234375
time for parepare:  0.01941227912902832
local_output_nid generation:  0.03134560585021973
local_in_edges_tensor generation:  0.0641627311706543
mini_batch_src_global generation:  0.05489325523376465
r_  generation:  0.5737676620483398
local_output_nid generation:  0.0398106575012207
local_in_edges_tensor generation:  0.09232521057128906
mini_batch_src_global generation:  0.06880950927734375
r_  generation:  0.5597803592681885
local_output_nid generation:  0.040314674377441406
local_in_edges_tensor generation:  0.04866480827331543
mini_batch_src_global generation:  0.06320476531982422
r_  generation:  0.565424919128418
local_output_nid generation:  0.038168907165527344
local_in_edges_tensor generation:  0.040543556213378906
mini_batch_src_global generation:  0.06052255630493164
r_  generation:  0.5636835098266602
local_output_nid generation:  0.03760933876037598
local_in_edges_tensor generation:  0.04012632369995117
mini_batch_src_global generation:  0.06103372573852539
r_  generation:  0.5701134204864502
local_output_nid generation:  0.0373537540435791
local_in_edges_tensor generation:  0.04033207893371582
mini_batch_src_global generation:  0.0611271858215332
r_  generation:  0.5699334144592285
local_output_nid generation:  0.03771781921386719
local_in_edges_tensor generation:  0.04559016227722168
mini_batch_src_global generation:  0.06432747840881348
r_  generation:  0.5755844116210938
local_output_nid generation:  0.037737131118774414
local_in_edges_tensor generation:  0.04042625427246094
mini_batch_src_global generation:  0.06197929382324219
r_  generation:  0.5727512836456299
----------------------check_connections_block total spend ----------------------------- 6.82655930519104
generate_one_block  0.7069542407989502
generate_one_block  0.7059953212738037
generate_one_block  0.7240924835205078
generate_one_block  0.6971468925476074
generate_one_block  0.6941006183624268
generate_one_block  0.6984195709228516
generate_one_block  0.7120211124420166
generate_one_block  0.708646297454834
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03550386428833008
gen group dst list time:  0.052229881286621094
time for parepare:  0.018868446350097656
local_output_nid generation:  0.032520294189453125
local_in_edges_tensor generation:  0.05148196220397949
mini_batch_src_global generation:  0.04914450645446777
r_  generation:  0.5457851886749268
local_output_nid generation:  0.03736758232116699
local_in_edges_tensor generation:  0.03630232810974121
mini_batch_src_global generation:  0.06260299682617188
r_  generation:  0.541752815246582
local_output_nid generation:  0.03780937194824219
local_in_edges_tensor generation:  0.036684274673461914
mini_batch_src_global generation:  0.06322526931762695
r_  generation:  0.5531260967254639
local_output_nid generation:  0.03953957557678223
local_in_edges_tensor generation:  0.04644131660461426
mini_batch_src_global generation:  0.06480288505554199
r_  generation:  0.5478639602661133
local_output_nid generation:  0.038469552993774414
local_in_edges_tensor generation:  0.036780595779418945
mini_batch_src_global generation:  0.06299495697021484
r_  generation:  0.550539493560791
local_output_nid generation:  0.03871464729309082
local_in_edges_tensor generation:  0.0847163200378418
mini_batch_src_global generation:  0.06179404258728027
r_  generation:  0.5477676391601562
local_output_nid generation:  0.03872847557067871
local_in_edges_tensor generation:  0.04403042793273926
mini_batch_src_global generation:  0.06221747398376465
r_  generation:  0.5578577518463135
local_output_nid generation:  0.038739919662475586
local_in_edges_tensor generation:  0.04419350624084473
mini_batch_src_global generation:  0.062162160873413086
r_  generation:  0.56662917137146
----------------------check_connections_block total spend ----------------------------- 6.63134241104126
generate_one_block  0.7048728466033936
generate_one_block  0.7085609436035156
generate_one_block  0.7041449546813965
generate_one_block  0.6962900161743164
generate_one_block  0.6841869354248047
generate_one_block  0.7137374877929688
generate_one_block  0.7012059688568115
generate_one_block  0.6857960224151611
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03434443473815918
gen group dst list time:  0.05355405807495117
time for parepare:  0.01919412612915039
local_output_nid generation:  0.032381534576416016
local_in_edges_tensor generation:  0.04461526870727539
mini_batch_src_global generation:  0.04759716987609863
r_  generation:  0.5053572654724121
local_output_nid generation:  0.04007768630981445
local_in_edges_tensor generation:  0.037107229232788086
mini_batch_src_global generation:  0.05755114555358887
r_  generation:  0.5101423263549805
local_output_nid generation:  0.040471553802490234
local_in_edges_tensor generation:  0.04369044303894043
mini_batch_src_global generation:  0.05801105499267578
r_  generation:  0.5204269886016846
local_output_nid generation:  0.03854227066040039
local_in_edges_tensor generation:  0.03548908233642578
mini_batch_src_global generation:  0.05846881866455078
r_  generation:  0.5157713890075684
local_output_nid generation:  0.0384371280670166
local_in_edges_tensor generation:  0.03968524932861328
mini_batch_src_global generation:  0.06193947792053223
r_  generation:  0.5257446765899658
local_output_nid generation:  0.038767099380493164
local_in_edges_tensor generation:  0.04464149475097656
mini_batch_src_global generation:  0.05840134620666504
r_  generation:  0.5136423110961914
local_output_nid generation:  0.03931260108947754
local_in_edges_tensor generation:  0.04892134666442871
mini_batch_src_global generation:  0.05904436111450195
r_  generation:  0.5145039558410645
local_output_nid generation:  0.038759708404541016
local_in_edges_tensor generation:  0.03683733940124512
mini_batch_src_global generation:  0.05790972709655762
r_  generation:  0.5166041851043701
----------------------check_connections_block total spend ----------------------------- 6.1982738971710205
generate_one_block  0.6577696800231934
generate_one_block  0.6428070068359375
generate_one_block  0.6591067314147949
generate_one_block  0.6363048553466797
generate_one_block  0.6491053104400635
generate_one_block  0.6577224731445312
generate_one_block  0.6525728702545166
generate_one_block  0.6394062042236328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.2567329406738281  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

connection checking time:  29.79968023300171
block generation total time  25.305562734603882
average batch blocks generation time:  3.1631953418254852
block dataloader generation time/epoch 57.97171401977539
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 0.14453887939453125  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167470, 128])
torch.Size([167020, 128])
torch.Size([165773, 128])
torch.Size([161399, 128])
torch.Size([142074, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5858154296875 GB
    Memory Allocated: 1.6451449394226074  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.1442399024963379  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167512, 128])
torch.Size([167050, 128])
torch.Size([165743, 128])
torch.Size([161210, 128])
torch.Size([141902, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.6440472602844238  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.14452219009399414  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167524, 128])
torch.Size([167103, 128])
torch.Size([165862, 128])
torch.Size([161495, 128])
torch.Size([142126, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.6453227996826172  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.14432382583618164  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167455, 128])
torch.Size([167012, 128])
torch.Size([165754, 128])
torch.Size([161266, 128])
torch.Size([141633, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.6443748474121094  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.14452123641967773  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167484, 128])
torch.Size([167044, 128])
torch.Size([165798, 128])
torch.Size([161493, 128])
torch.Size([142146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.645275592803955  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.14423608779907227  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167508, 128])
torch.Size([167075, 128])
torch.Size([165840, 128])
torch.Size([161320, 128])
torch.Size([141920, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.643538475036621  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.14464187622070312  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

torch.Size([167501, 128])
torch.Size([167080, 128])
torch.Size([165890, 128])
torch.Size([161445, 128])
torch.Size([142300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.6498117446899414  GigaBytes
Max Memory Allocated: 1.7097063064575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 0.14426803588867188  GigaBytes
Max Memory Allocated: 1.7140460014343262  GigaBytes

torch.Size([167510, 128])
torch.Size([167073, 128])
torch.Size([165779, 128])
torch.Size([161404, 128])
torch.Size([142072, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5877685546875 GB
    Memory Allocated: 1.6444926261901855  GigaBytes
Max Memory Allocated: 1.7140460014343262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10834816098213196 |0.04465869069099426 |0.0067099034786224365 |9.363889694213867e-05 |0.00860026478767395 |0.0034520626068115234 |
----------------------------------------------------------pseudo_mini_loss sum 4.1453657150268555
Total (block generation + training)time/epoch 59.42701745033264
Training time/epoch 1.454962968826294
Training time without block to device /epoch 1.0976934432983398
Training time without total dataloading part /epoch 0.12668251991271973
load block tensor time/epoch 0.8667852878570557
block to device time/epoch 0.3572695255279541
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6973672
Number of first layer input nodes during this epoch:  1339964
