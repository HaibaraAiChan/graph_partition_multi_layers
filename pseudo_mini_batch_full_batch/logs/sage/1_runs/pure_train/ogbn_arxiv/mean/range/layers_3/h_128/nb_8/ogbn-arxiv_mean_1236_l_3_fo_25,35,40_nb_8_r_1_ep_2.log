Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648449508.393203
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02362370491027832
range selection method range initialization spend 0.013875722885131836
time for parepare:  0.01818990707397461
local_output_nid generation:  0.002603769302368164
local_in_edges_tensor generation:  0.0040895938873291016
mini_batch_src_global generation:  0.003232717514038086
r_  generation:  0.03745079040527344
local_output_nid generation:  0.0030333995819091797
local_in_edges_tensor generation:  0.001611948013305664
mini_batch_src_global generation:  0.004120349884033203
r_  generation:  0.039101600646972656
local_output_nid generation:  0.0031964778900146484
local_in_edges_tensor generation:  0.0015954971313476562
mini_batch_src_global generation:  0.0027620792388916016
r_  generation:  0.040108680725097656
local_output_nid generation:  0.0031011104583740234
local_in_edges_tensor generation:  0.0016226768493652344
mini_batch_src_global generation:  0.0029141902923583984
r_  generation:  0.04126906394958496
local_output_nid generation:  0.003120899200439453
local_in_edges_tensor generation:  0.001600027084350586
mini_batch_src_global generation:  0.007085561752319336
r_  generation:  0.04593229293823242
local_output_nid generation:  0.0037717819213867188
local_in_edges_tensor generation:  0.0017998218536376953
mini_batch_src_global generation:  0.0035283565521240234
r_  generation:  0.04378843307495117
local_output_nid generation:  0.0037424564361572266
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.0034258365631103516
r_  generation:  0.04331803321838379
local_output_nid generation:  0.00371551513671875
local_in_edges_tensor generation:  0.0018019676208496094
mini_batch_src_global generation:  0.0034499168395996094
r_  generation:  0.042670488357543945
----------------------check_connections_block total spend ----------------------------- 0.5004897117614746
generate_one_block  0.05638766288757324
generate_one_block  0.05701613426208496
generate_one_block  0.05696415901184082
generate_one_block  0.057420969009399414
generate_one_block  0.06070446968078613
generate_one_block  0.0579833984375
generate_one_block  0.05745530128479004
generate_one_block  0.057676076889038086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04049205780029297
gen group dst list time:  0.015633106231689453
time for parepare:  0.020585298538208008
local_output_nid generation:  0.011527299880981445
local_in_edges_tensor generation:  0.02966904640197754
mini_batch_src_global generation:  0.029099464416503906
r_  generation:  0.28392481803894043
local_output_nid generation:  0.019990205764770508
local_in_edges_tensor generation:  0.02970409393310547
mini_batch_src_global generation:  0.034685373306274414
r_  generation:  0.3091747760772705
local_output_nid generation:  0.02079606056213379
local_in_edges_tensor generation:  0.033173561096191406
mini_batch_src_global generation:  0.034780025482177734
r_  generation:  0.3161966800689697
local_output_nid generation:  0.026569604873657227
local_in_edges_tensor generation:  0.023153305053710938
mini_batch_src_global generation:  0.03853869438171387
r_  generation:  0.3417630195617676
local_output_nid generation:  0.02597212791442871
local_in_edges_tensor generation:  0.03269243240356445
mini_batch_src_global generation:  0.06876301765441895
r_  generation:  0.3312959671020508
local_output_nid generation:  0.023361921310424805
local_in_edges_tensor generation:  0.039099693298339844
mini_batch_src_global generation:  0.0581514835357666
r_  generation:  0.31687474250793457
local_output_nid generation:  0.019690513610839844
local_in_edges_tensor generation:  0.02153158187866211
mini_batch_src_global generation:  0.039380788803100586
r_  generation:  0.3126096725463867
local_output_nid generation:  0.019547700881958008
local_in_edges_tensor generation:  0.020684242248535156
mini_batch_src_global generation:  0.04198098182678223
r_  generation:  0.3126828670501709
----------------------check_connections_block total spend ----------------------------- 3.8870909214019775
generate_one_block  0.39607930183410645
generate_one_block  0.40320706367492676
generate_one_block  0.4100301265716553
generate_one_block  0.4138305187225342
generate_one_block  0.3991851806640625
generate_one_block  0.44994282722473145
generate_one_block  0.4277188777923584
generate_one_block  0.40627431869506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04071998596191406
gen group dst list time:  0.044153690338134766
time for parepare:  0.019339561462402344
local_output_nid generation:  0.02588176727294922
local_in_edges_tensor generation:  0.05440497398376465
mini_batch_src_global generation:  0.048937082290649414
r_  generation:  0.4698648452758789
local_output_nid generation:  0.03161501884460449
local_in_edges_tensor generation:  0.047238826751708984
mini_batch_src_global generation:  0.05369424819946289
r_  generation:  0.47602319717407227
local_output_nid generation:  0.03228330612182617
local_in_edges_tensor generation:  0.03426408767700195
mini_batch_src_global generation:  0.0510709285736084
r_  generation:  0.4857978820800781
local_output_nid generation:  0.03278923034667969
local_in_edges_tensor generation:  0.03472018241882324
mini_batch_src_global generation:  0.057155609130859375
r_  generation:  0.48165059089660645
local_output_nid generation:  0.033303022384643555
local_in_edges_tensor generation:  0.043653249740600586
mini_batch_src_global generation:  0.05266523361206055
r_  generation:  0.5067145824432373
local_output_nid generation:  0.03359651565551758
local_in_edges_tensor generation:  0.03527498245239258
mini_batch_src_global generation:  0.05850863456726074
r_  generation:  0.4953596591949463
local_output_nid generation:  0.03507113456726074
local_in_edges_tensor generation:  0.05214715003967285
mini_batch_src_global generation:  0.06927251815795898
r_  generation:  0.49987077713012695
local_output_nid generation:  0.03721761703491211
local_in_edges_tensor generation:  0.037663936614990234
mini_batch_src_global generation:  0.056096553802490234
r_  generation:  0.48909640312194824
----------------------check_connections_block total spend ----------------------------- 5.831426382064819
generate_one_block  0.6167066097259521
generate_one_block  0.6202013492584229
generate_one_block  0.6008710861206055
generate_one_block  0.618598222732544
generate_one_block  0.6242778301239014
generate_one_block  0.6352870464324951
generate_one_block  0.637603759765625
generate_one_block  0.6223337650299072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  9.718517303466797
block generation total time  8.282147884368896
average batch blocks generation time:  1.035268485546112
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09560346603393555  GigaBytes
Max Memory Allocated: 0.09560346603393555  GigaBytes

torch.Size([160303, 128])
torch.Size([141025, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.5414338111877441  GigaBytes
Max Memory Allocated: 0.5691123008728027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.09835386276245117  GigaBytes
Max Memory Allocated: 0.6046099662780762  GigaBytes

torch.Size([160348, 128])
torch.Size([141086, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5460467338562012  GigaBytes
Max Memory Allocated: 0.6046099662780762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09833908081054688  GigaBytes
Max Memory Allocated: 0.6108670234680176  GigaBytes

torch.Size([160395, 128])
torch.Size([140806, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.54290771484375  GigaBytes
Max Memory Allocated: 0.6108670234680176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.0985260009765625  GigaBytes
Max Memory Allocated: 0.6108670234680176  GigaBytes

torch.Size([160599, 128])
torch.Size([141014, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5456218719482422  GigaBytes
Max Memory Allocated: 0.6108670234680176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09854841232299805  GigaBytes
Max Memory Allocated: 0.6113400459289551  GigaBytes

torch.Size([160624, 128])
torch.Size([141300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.546694278717041  GigaBytes
Max Memory Allocated: 0.6113400459289551  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09859371185302734  GigaBytes
Max Memory Allocated: 0.6115412712097168  GigaBytes

torch.Size([160709, 128])
torch.Size([141841, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5519771575927734  GigaBytes
Max Memory Allocated: 0.6115412712097168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09839487075805664  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160394, 128])
torch.Size([141129, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5456924438476562  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09853363037109375  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160521, 128])
torch.Size([141176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5464267730712891  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041266679763793945 |0.05840522050857544 |0.09598952531814575 |0.0001061856746673584 |0.01265639066696167 |0.002241849899291992 |
----------------------------------------------------------pseudo_mini_loss sum 5.556775093078613
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2955818
Number of first layer input nodes during this epoch:  1283893
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12749910354614258  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019098997116088867
range selection method range initialization spend 0.011491537094116211
time for parepare:  0.017037630081176758
local_output_nid generation:  0.0026497840881347656
local_in_edges_tensor generation:  0.006700038909912109
mini_batch_src_global generation:  0.0032265186309814453
r_  generation:  0.03607654571533203
local_output_nid generation:  0.0031080245971679688
local_in_edges_tensor generation:  0.0015821456909179688
mini_batch_src_global generation:  0.004095554351806641
r_  generation:  0.03925347328186035
local_output_nid generation:  0.0031197071075439453
local_in_edges_tensor generation:  0.0015974044799804688
mini_batch_src_global generation:  0.002740144729614258
r_  generation:  0.039505720138549805
local_output_nid generation:  0.0031549930572509766
local_in_edges_tensor generation:  0.0015933513641357422
mini_batch_src_global generation:  0.0028450489044189453
r_  generation:  0.040008544921875
local_output_nid generation:  0.003100872039794922
local_in_edges_tensor generation:  0.0015974044799804688
mini_batch_src_global generation:  0.0030374526977539062
r_  generation:  0.042168617248535156
local_output_nid generation:  0.003113985061645508
local_in_edges_tensor generation:  0.0016345977783203125
mini_batch_src_global generation:  0.0031838417053222656
r_  generation:  0.042427778244018555
local_output_nid generation:  0.0031354427337646484
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.0032553672790527344
r_  generation:  0.04269218444824219
local_output_nid generation:  0.003111600875854492
local_in_edges_tensor generation:  0.0016095638275146484
mini_batch_src_global generation:  0.003242969512939453
r_  generation:  0.04219341278076172
----------------------check_connections_block total spend ----------------------------- 0.4776029586791992
generate_one_block  0.05171322822570801
generate_one_block  0.05437326431274414
generate_one_block  0.05357956886291504
generate_one_block  0.05406785011291504
generate_one_block  0.055298566818237305
generate_one_block  0.05460023880004883
generate_one_block  0.05785965919494629
generate_one_block  0.054619789123535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03895926475524902
gen group dst list time:  0.015233993530273438
time for parepare:  0.019814014434814453
local_output_nid generation:  0.010623455047607422
local_in_edges_tensor generation:  0.027302026748657227
mini_batch_src_global generation:  0.026738643646240234
r_  generation:  0.2823333740234375
local_output_nid generation:  0.017091751098632812
local_in_edges_tensor generation:  0.02593374252319336
mini_batch_src_global generation:  0.035463571548461914
r_  generation:  0.3026151657104492
local_output_nid generation:  0.01785731315612793
local_in_edges_tensor generation:  0.024129152297973633
mini_batch_src_global generation:  0.03453874588012695
r_  generation:  0.3041994571685791
local_output_nid generation:  0.01804041862487793
local_in_edges_tensor generation:  0.019986867904663086
mini_batch_src_global generation:  0.03609204292297363
r_  generation:  0.30654025077819824
local_output_nid generation:  0.02083611488342285
local_in_edges_tensor generation:  0.022123098373413086
mini_batch_src_global generation:  0.036902427673339844
r_  generation:  0.3167381286621094
local_output_nid generation:  0.018566131591796875
local_in_edges_tensor generation:  0.019577741622924805
mini_batch_src_global generation:  0.037438154220581055
r_  generation:  0.31963038444519043
local_output_nid generation:  0.018420696258544922
local_in_edges_tensor generation:  0.019479751586914062
mini_batch_src_global generation:  0.04307699203491211
r_  generation:  0.3328216075897217
local_output_nid generation:  0.019718647003173828
local_in_edges_tensor generation:  0.030322790145874023
mini_batch_src_global generation:  0.04048037528991699
r_  generation:  0.3141775131225586
----------------------check_connections_block total spend ----------------------------- 3.652650833129883
generate_one_block  0.40547752380371094
generate_one_block  0.4018442630767822
generate_one_block  0.4005086421966553
generate_one_block  0.40154075622558594
generate_one_block  0.39606213569641113
generate_one_block  0.40147876739501953
generate_one_block  0.4053986072540283
generate_one_block  0.4256706237792969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07297778129577637
gen group dst list time:  0.03713393211364746
time for parepare:  0.01893305778503418
local_output_nid generation:  0.025537967681884766
local_in_edges_tensor generation:  0.057514190673828125
mini_batch_src_global generation:  0.04453921318054199
r_  generation:  0.4718897342681885
local_output_nid generation:  0.03282022476196289
local_in_edges_tensor generation:  0.049164533615112305
mini_batch_src_global generation:  0.05460762977600098
r_  generation:  0.4803035259246826
local_output_nid generation:  0.03393864631652832
local_in_edges_tensor generation:  0.05332469940185547
mini_batch_src_global generation:  0.05140233039855957
r_  generation:  0.5050065517425537
local_output_nid generation:  0.03443503379821777
local_in_edges_tensor generation:  0.04124736785888672
mini_batch_src_global generation:  0.058484554290771484
r_  generation:  0.48702096939086914
local_output_nid generation:  0.03742098808288574
local_in_edges_tensor generation:  0.04667544364929199
mini_batch_src_global generation:  0.05909109115600586
r_  generation:  0.4936702251434326
local_output_nid generation:  0.035658836364746094
local_in_edges_tensor generation:  0.04228401184082031
mini_batch_src_global generation:  0.054561614990234375
r_  generation:  0.48661255836486816
local_output_nid generation:  0.035276174545288086
local_in_edges_tensor generation:  0.03319096565246582
mini_batch_src_global generation:  0.05369925498962402
r_  generation:  0.49634695053100586
local_output_nid generation:  0.03582167625427246
local_in_edges_tensor generation:  0.033652305603027344
mini_batch_src_global generation:  0.05584287643432617
r_  generation:  0.4992353916168213
----------------------check_connections_block total spend ----------------------------- 5.857863664627075
generate_one_block  0.6130542755126953
generate_one_block  0.6213819980621338
generate_one_block  0.6169965267181396
generate_one_block  0.6105694770812988
generate_one_block  0.6179409027099609
generate_one_block  0.6215002536773682
generate_one_block  0.6045527458190918
generate_one_block  0.6042957305908203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.12749910354614258  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

connection checking time:  9.510514497756958
block generation total time  8.148273229598999
average batch blocks generation time:  1.0185341536998749
block dataloader generation time/epoch 19.591689825057983
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09880781173706055  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160427, 128])
torch.Size([141103, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5425496101379395  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.09897947311401367  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160310, 128])
torch.Size([141192, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.5464944839477539  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09887409210205078  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160297, 128])
torch.Size([140609, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5425019264221191  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09892034530639648  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160530, 128])
torch.Size([140954, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5435409545898438  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.0997934341430664  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

torch.Size([160645, 128])
torch.Size([141610, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5525913238525391  GigaBytes
Max Memory Allocated: 0.6166949272155762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.1000823974609375  GigaBytes
Max Memory Allocated: 0.6177129745483398  GigaBytes

torch.Size([160695, 128])
torch.Size([141717, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5524492263793945  GigaBytes
Max Memory Allocated: 0.6177129745483398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09892129898071289  GigaBytes
Max Memory Allocated: 0.6177129745483398  GigaBytes

torch.Size([160258, 128])
torch.Size([140577, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5451345443725586  GigaBytes
Max Memory Allocated: 0.6177129745483398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.09907674789428711  GigaBytes
Max Memory Allocated: 0.6177129745483398  GigaBytes

torch.Size([160541, 128])
torch.Size([141313, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.5512337684631348  GigaBytes
Max Memory Allocated: 0.6177129745483398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04887273907661438 |0.017912209033966064 |0.0035525262355804443 |9.182095527648926e-05 |0.003895670175552368 |0.0014545917510986328 |
----------------------------------------------------------pseudo_mini_loss sum 3.569063663482666
Total (block generation + training)time/epoch 20.220948219299316
Training time/epoch 0.6289815902709961
Training time without block to device /epoch 0.4856839179992676
Training time without total dataloading part /epoch 0.06177473068237305
load block tensor time/epoch 0.39098191261291504
block to device time/epoch 0.14329767227172852
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2955252
Number of first layer input nodes during this epoch:  1283703
