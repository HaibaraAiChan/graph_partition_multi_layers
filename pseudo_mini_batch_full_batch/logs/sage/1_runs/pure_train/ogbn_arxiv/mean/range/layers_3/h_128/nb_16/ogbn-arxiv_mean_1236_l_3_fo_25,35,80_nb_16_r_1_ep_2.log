Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648450018.748468
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027458906173706055
range selection method range initialization spend 0.013453960418701172
time for parepare:  0.01785731315612793
local_output_nid generation:  0.00138092041015625
local_in_edges_tensor generation:  0.00406646728515625
mini_batch_src_global generation:  0.0019266605377197266
r_  generation:  0.019364118576049805
local_output_nid generation:  0.001435995101928711
local_in_edges_tensor generation:  0.0009255409240722656
mini_batch_src_global generation:  0.0023860931396484375
r_  generation:  0.019937753677368164
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.001604318618774414
r_  generation:  0.020025014877319336
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.001710653305053711
r_  generation:  0.019411087036132812
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0015871524810791016
r_  generation:  0.019534587860107422
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0008504390716552734
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.02056741714477539
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0017192363739013672
r_  generation:  0.021653413772583008
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0008561611175537109
mini_batch_src_global generation:  0.0017161369323730469
r_  generation:  0.020534515380859375
local_output_nid generation:  0.0016164779663085938
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0016510486602783203
r_  generation:  0.021188020706176758
local_output_nid generation:  0.0015149116516113281
local_in_edges_tensor generation:  0.0008933544158935547
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.021004199981689453
local_output_nid generation:  0.0015168190002441406
local_in_edges_tensor generation:  0.0008487701416015625
mini_batch_src_global generation:  0.0017619132995605469
r_  generation:  0.02118825912475586
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0017859935760498047
r_  generation:  0.021413087844848633
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0017430782318115234
r_  generation:  0.020975589752197266
local_output_nid generation:  0.0015377998352050781
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.02157115936279297
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.02147841453552246
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0017931461334228516
r_  generation:  0.02100658416748047
----------------------check_connections_block total spend ----------------------------- 0.49215197563171387
generate_one_block  0.02960824966430664
generate_one_block  0.030810117721557617
generate_one_block  0.03290414810180664
generate_one_block  0.030627965927124023
generate_one_block  0.030423402786254883
generate_one_block  0.030662059783935547
generate_one_block  0.03215503692626953
generate_one_block  0.030459880828857422
generate_one_block  0.031066417694091797
generate_one_block  0.030982017517089844
generate_one_block  0.031975507736206055
generate_one_block  0.0316469669342041
generate_one_block  0.030617475509643555
generate_one_block  0.0312647819519043
generate_one_block  0.03171992301940918
generate_one_block  0.030766963958740234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03960537910461426
gen group dst list time:  0.020722389221191406
time for parepare:  0.01951909065246582
local_output_nid generation:  0.007036685943603516
local_in_edges_tensor generation:  0.018469810485839844
mini_batch_src_global generation:  0.022709131240844727
r_  generation:  0.20900249481201172
local_output_nid generation:  0.010877847671508789
local_in_edges_tensor generation:  0.019196033477783203
mini_batch_src_global generation:  0.027019500732421875
r_  generation:  0.22011852264404297
local_output_nid generation:  0.011387825012207031
local_in_edges_tensor generation:  0.016390562057495117
mini_batch_src_global generation:  0.027442455291748047
r_  generation:  0.23077392578125
local_output_nid generation:  0.011395931243896484
local_in_edges_tensor generation:  0.01607823371887207
mini_batch_src_global generation:  0.02734065055847168
r_  generation:  0.22159457206726074
local_output_nid generation:  0.011565923690795898
local_in_edges_tensor generation:  0.012168407440185547
mini_batch_src_global generation:  0.02816152572631836
r_  generation:  0.23072600364685059
local_output_nid generation:  0.011753559112548828
local_in_edges_tensor generation:  0.016639232635498047
mini_batch_src_global generation:  0.028629302978515625
r_  generation:  0.22817063331604004
local_output_nid generation:  0.012177228927612305
local_in_edges_tensor generation:  0.01901555061340332
mini_batch_src_global generation:  0.030106782913208008
r_  generation:  0.23983049392700195
local_output_nid generation:  0.011886358261108398
local_in_edges_tensor generation:  0.0127105712890625
mini_batch_src_global generation:  0.029472827911376953
r_  generation:  0.2331688404083252
local_output_nid generation:  0.012357950210571289
local_in_edges_tensor generation:  0.014775276184082031
mini_batch_src_global generation:  0.030523061752319336
r_  generation:  0.24250531196594238
local_output_nid generation:  0.012003421783447266
local_in_edges_tensor generation:  0.014959573745727539
mini_batch_src_global generation:  0.030420780181884766
r_  generation:  0.23431158065795898
local_output_nid generation:  0.012460470199584961
local_in_edges_tensor generation:  0.019245624542236328
mini_batch_src_global generation:  0.03257417678833008
r_  generation:  0.2451930046081543
local_output_nid generation:  0.012355327606201172
local_in_edges_tensor generation:  0.013720512390136719
mini_batch_src_global generation:  0.030633211135864258
r_  generation:  0.2349863052368164
local_output_nid generation:  0.012285947799682617
local_in_edges_tensor generation:  0.012896537780761719
mini_batch_src_global generation:  0.030257225036621094
r_  generation:  0.23819565773010254
local_output_nid generation:  0.012519598007202148
local_in_edges_tensor generation:  0.014737606048583984
mini_batch_src_global generation:  0.030004024505615234
r_  generation:  0.23688077926635742
local_output_nid generation:  0.012439966201782227
local_in_edges_tensor generation:  0.013580322265625
mini_batch_src_global generation:  0.03208303451538086
r_  generation:  0.23764586448669434
local_output_nid generation:  0.012129068374633789
local_in_edges_tensor generation:  0.013321876525878906
mini_batch_src_global generation:  0.030267715454101562
r_  generation:  0.23189353942871094
----------------------check_connections_block total spend ----------------------------- 5.46323823928833
generate_one_block  0.30092549324035645
generate_one_block  0.2977917194366455
generate_one_block  0.3100464344024658
generate_one_block  0.29506468772888184
generate_one_block  0.3154933452606201
generate_one_block  0.2993931770324707
generate_one_block  0.3184840679168701
generate_one_block  0.3019590377807617
generate_one_block  0.31345272064208984
generate_one_block  0.3037714958190918
generate_one_block  0.31477928161621094
generate_one_block  0.3035438060760498
generate_one_block  0.3036792278289795
generate_one_block  0.3104424476623535
generate_one_block  0.31661534309387207
generate_one_block  0.2949090003967285
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03655648231506348
gen group dst list time:  0.060593605041503906
time for parepare:  0.018796682357788086
local_output_nid generation:  0.023461103439331055
local_in_edges_tensor generation:  0.038637638092041016
mini_batch_src_global generation:  0.04214978218078613
r_  generation:  0.43559956550598145
local_output_nid generation:  0.029415607452392578
local_in_edges_tensor generation:  0.046068668365478516
mini_batch_src_global generation:  0.05213761329650879
r_  generation:  0.4489903450012207
local_output_nid generation:  0.02915191650390625
local_in_edges_tensor generation:  0.042841196060180664
mini_batch_src_global generation:  0.05418825149536133
r_  generation:  0.45004892349243164
local_output_nid generation:  0.029897212982177734
local_in_edges_tensor generation:  0.031733036041259766
mini_batch_src_global generation:  0.05413484573364258
r_  generation:  0.4511075019836426
local_output_nid generation:  0.02987957000732422
local_in_edges_tensor generation:  0.031445980072021484
mini_batch_src_global generation:  0.05339479446411133
r_  generation:  0.4676041603088379
local_output_nid generation:  0.03025078773498535
local_in_edges_tensor generation:  0.0385286808013916
mini_batch_src_global generation:  0.05403947830200195
r_  generation:  0.4528968334197998
local_output_nid generation:  0.03020167350769043
local_in_edges_tensor generation:  0.039841413497924805
mini_batch_src_global generation:  0.05627870559692383
r_  generation:  0.4597814083099365
local_output_nid generation:  0.029711484909057617
local_in_edges_tensor generation:  0.0316770076751709
mini_batch_src_global generation:  0.05377006530761719
r_  generation:  0.46755480766296387
local_output_nid generation:  0.030496835708618164
local_in_edges_tensor generation:  0.03193545341491699
mini_batch_src_global generation:  0.05439019203186035
r_  generation:  0.4645092487335205
local_output_nid generation:  0.030580997467041016
local_in_edges_tensor generation:  0.043365478515625
mini_batch_src_global generation:  0.05406665802001953
r_  generation:  0.45685911178588867
local_output_nid generation:  0.030513286590576172
local_in_edges_tensor generation:  0.035225629806518555
mini_batch_src_global generation:  0.05651450157165527
r_  generation:  0.4811098575592041
local_output_nid generation:  0.030351638793945312
local_in_edges_tensor generation:  0.032370567321777344
mini_batch_src_global generation:  0.054662466049194336
r_  generation:  0.4628784656524658
local_output_nid generation:  0.030134201049804688
local_in_edges_tensor generation:  0.0351870059967041
mini_batch_src_global generation:  0.05389547348022461
r_  generation:  0.46042943000793457
local_output_nid generation:  0.030172109603881836
local_in_edges_tensor generation:  0.04002952575683594
mini_batch_src_global generation:  0.05705118179321289
r_  generation:  0.4709587097167969
local_output_nid generation:  0.03062748908996582
local_in_edges_tensor generation:  0.04338884353637695
mini_batch_src_global generation:  0.05395078659057617
r_  generation:  0.4734218120574951
local_output_nid generation:  0.030415773391723633
local_in_edges_tensor generation:  0.031780242919921875
mini_batch_src_global generation:  0.05494499206542969
r_  generation:  0.4605579376220703
----------------------check_connections_block total spend ----------------------------- 10.91693115234375
generate_one_block  0.5820505619049072
generate_one_block  0.5738766193389893
generate_one_block  0.5843949317932129
generate_one_block  0.5762038230895996
generate_one_block  0.5835285186767578
generate_one_block  0.5874752998352051
generate_one_block  0.6280713081359863
generate_one_block  0.5708723068237305
generate_one_block  0.5911502838134766
generate_one_block  0.594475269317627
generate_one_block  0.6026270389556885
generate_one_block  0.6151375770568848
generate_one_block  0.6056208610534668
generate_one_block  0.5983667373657227
generate_one_block  0.6132156848907471
generate_one_block  0.599327802658081
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  16.38016939163208
block generation total time  14.406745910644531
average batch blocks generation time:  0.9004216194152832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09074640274047852  GigaBytes
Max Memory Allocated: 0.09074640274047852  GigaBytes

torch.Size([154803, 128])
torch.Size([124456, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.45356130599975586  GigaBytes
Max Memory Allocated: 0.4728665351867676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.091949462890625  GigaBytes
Max Memory Allocated: 0.4963092803955078  GigaBytes

torch.Size([155083, 128])
torch.Size([124974, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4591031074523926  GigaBytes
Max Memory Allocated: 0.4963092803955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09216499328613281  GigaBytes
Max Memory Allocated: 0.5018534660339355  GigaBytes

torch.Size([155064, 128])
torch.Size([125202, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46240711212158203  GigaBytes
Max Memory Allocated: 0.5018534660339355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09186363220214844  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

torch.Size([154879, 128])
torch.Size([124137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.45330142974853516  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09199905395507812  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

torch.Size([154655, 128])
torch.Size([124364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4540877342224121  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09198379516601562  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

torch.Size([154820, 128])
torch.Size([124430, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4544029235839844  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09228897094726562  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

torch.Size([155238, 128])
torch.Size([125435, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4651756286621094  GigaBytes
Max Memory Allocated: 0.5061087608337402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09192752838134766  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154829, 128])
torch.Size([123916, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.45302581787109375  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09223747253417969  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155310, 128])
torch.Size([125579, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4640226364135742  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09203243255615234  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155136, 128])
torch.Size([124884, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.456451416015625  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09232139587402344  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155586, 128])
torch.Size([126069, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.464876651763916  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09208869934082031  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155107, 128])
torch.Size([125176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46249866485595703  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09205913543701172  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154968, 128])
torch.Size([124697, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.45652198791503906  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.0921316146850586  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155183, 128])
torch.Size([125452, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46232032775878906  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09217262268066406  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155101, 128])
torch.Size([125069, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46204042434692383  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09195327758789062  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155219, 128])
torch.Size([124986, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.458984375  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03862778842449188 |0.03444761037826538 |0.050270646810531616 |9.566545486450195e-05 |0.008710920810699463 |0.0022056102752685547 |
----------------------------------------------------------pseudo_mini_loss sum 5.61915922164917
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209228
Number of first layer input nodes during this epoch:  2480981
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11572504043579102  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024288654327392578
range selection method range initialization spend 0.011395692825317383
time for parepare:  0.019368410110473633
local_output_nid generation:  0.001394510269165039
local_in_edges_tensor generation:  0.03148674964904785
mini_batch_src_global generation:  0.0033621788024902344
r_  generation:  0.020242929458618164
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0009906291961669922
mini_batch_src_global generation:  0.002375364303588867
r_  generation:  0.020246505737304688
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0009443759918212891
mini_batch_src_global generation:  0.0015833377838134766
r_  generation:  0.0205838680267334
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0009484291076660156
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.020832300186157227
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0015869140625
r_  generation:  0.020568370819091797
local_output_nid generation:  0.0015594959259033203
local_in_edges_tensor generation:  0.0009276866912841797
mini_batch_src_global generation:  0.0016493797302246094
r_  generation:  0.0211946964263916
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.021210432052612305
local_output_nid generation:  0.0015406608581542969
local_in_edges_tensor generation:  0.0009596347808837891
mini_batch_src_global generation:  0.0016486644744873047
r_  generation:  0.021279096603393555
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0016808509826660156
r_  generation:  0.022237300872802734
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.001708984375
r_  generation:  0.0221560001373291
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009303092956542969
mini_batch_src_global generation:  0.0017693042755126953
r_  generation:  0.021859407424926758
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.001752614974975586
r_  generation:  0.021979331970214844
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009059906005859375
mini_batch_src_global generation:  0.0017423629760742188
r_  generation:  0.022441387176513672
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0017516613006591797
r_  generation:  0.022158384323120117
local_output_nid generation:  0.001535177230834961
local_in_edges_tensor generation:  0.0009014606475830078
mini_batch_src_global generation:  0.0017971992492675781
r_  generation:  0.021961212158203125
local_output_nid generation:  0.0015206336975097656
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0017638206481933594
r_  generation:  0.021792888641357422
----------------------check_connections_block total spend ----------------------------- 0.5398294925689697
generate_one_block  0.029644012451171875
generate_one_block  0.030962467193603516
generate_one_block  0.03169703483581543
generate_one_block  0.03181910514831543
generate_one_block  0.031220674514770508
generate_one_block  0.03278350830078125
generate_one_block  0.03095388412475586
generate_one_block  0.03135347366333008
generate_one_block  0.032198190689086914
generate_one_block  0.032073259353637695
generate_one_block  0.03157687187194824
generate_one_block  0.03141593933105469
generate_one_block  0.03265500068664551
generate_one_block  0.03213691711425781
generate_one_block  0.032067298889160156
generate_one_block  0.03190326690673828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03554821014404297
gen group dst list time:  0.019405841827392578
time for parepare:  0.019277334213256836
local_output_nid generation:  0.007320404052734375
local_in_edges_tensor generation:  0.02546405792236328
mini_batch_src_global generation:  0.02244091033935547
r_  generation:  0.20466017723083496
local_output_nid generation:  0.010955810546875
local_in_edges_tensor generation:  0.01955723762512207
mini_batch_src_global generation:  0.026993274688720703
r_  generation:  0.2175602912902832
local_output_nid generation:  0.012053728103637695
local_in_edges_tensor generation:  0.016671419143676758
mini_batch_src_global generation:  0.028826475143432617
r_  generation:  0.23081684112548828
local_output_nid generation:  0.0119476318359375
local_in_edges_tensor generation:  0.014732122421264648
mini_batch_src_global generation:  0.02815699577331543
r_  generation:  0.2297966480255127
local_output_nid generation:  0.011956214904785156
local_in_edges_tensor generation:  0.014766931533813477
mini_batch_src_global generation:  0.028802156448364258
r_  generation:  0.23005962371826172
local_output_nid generation:  0.011867761611938477
local_in_edges_tensor generation:  0.01522684097290039
mini_batch_src_global generation:  0.03169083595275879
r_  generation:  0.23122310638427734
local_output_nid generation:  0.011869668960571289
local_in_edges_tensor generation:  0.015259981155395508
mini_batch_src_global generation:  0.029163360595703125
r_  generation:  0.23178362846374512
local_output_nid generation:  0.013689279556274414
local_in_edges_tensor generation:  0.017368316650390625
mini_batch_src_global generation:  0.03079509735107422
r_  generation:  0.23270463943481445
local_output_nid generation:  0.012363195419311523
local_in_edges_tensor generation:  0.015115022659301758
mini_batch_src_global generation:  0.030158042907714844
r_  generation:  0.23633313179016113
local_output_nid generation:  0.012326717376708984
local_in_edges_tensor generation:  0.017638683319091797
mini_batch_src_global generation:  0.030179738998413086
r_  generation:  0.2385115623474121
local_output_nid generation:  0.014034271240234375
local_in_edges_tensor generation:  0.01743292808532715
mini_batch_src_global generation:  0.0299837589263916
r_  generation:  0.23737001419067383
local_output_nid generation:  0.012151002883911133
local_in_edges_tensor generation:  0.013703584671020508
mini_batch_src_global generation:  0.030094146728515625
r_  generation:  0.2342376708984375
local_output_nid generation:  0.012356042861938477
local_in_edges_tensor generation:  0.015669584274291992
mini_batch_src_global generation:  0.030201435089111328
r_  generation:  0.23744487762451172
local_output_nid generation:  0.015096664428710938
local_in_edges_tensor generation:  0.01756739616394043
mini_batch_src_global generation:  0.030232667922973633
r_  generation:  0.240675687789917
local_output_nid generation:  0.012506246566772461
local_in_edges_tensor generation:  0.020055055618286133
mini_batch_src_global generation:  0.03254246711730957
r_  generation:  0.24004626274108887
local_output_nid generation:  0.012234926223754883
local_in_edges_tensor generation:  0.013547658920288086
mini_batch_src_global generation:  0.030182838439941406
r_  generation:  0.23520708084106445
----------------------check_connections_block total spend ----------------------------- 5.484335422515869
generate_one_block  0.3162240982055664
generate_one_block  0.3043663501739502
generate_one_block  0.30824899673461914
generate_one_block  0.30703020095825195
generate_one_block  0.30627965927124023
generate_one_block  0.3167533874511719
generate_one_block  0.3260841369628906
generate_one_block  0.29839372634887695
generate_one_block  0.3105907440185547
generate_one_block  0.30655622482299805
generate_one_block  0.3091561794281006
generate_one_block  0.2945718765258789
generate_one_block  0.30714869499206543
generate_one_block  0.30904173851013184
generate_one_block  0.31374192237854004
generate_one_block  0.2956218719482422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07396078109741211
gen group dst list time:  0.06676435470581055
time for parepare:  0.02032184600830078
local_output_nid generation:  0.02405714988708496
local_in_edges_tensor generation:  0.06258940696716309
mini_batch_src_global generation:  0.0449070930480957
r_  generation:  0.4443185329437256
local_output_nid generation:  0.032186031341552734
local_in_edges_tensor generation:  0.04581761360168457
mini_batch_src_global generation:  0.052133798599243164
r_  generation:  0.4420003890991211
local_output_nid generation:  0.031128406524658203
local_in_edges_tensor generation:  0.0422823429107666
mini_batch_src_global generation:  0.0536801815032959
r_  generation:  0.4546043872833252
local_output_nid generation:  0.030759096145629883
local_in_edges_tensor generation:  0.03478670120239258
mini_batch_src_global generation:  0.05278468132019043
r_  generation:  0.45154881477355957
local_output_nid generation:  0.031157970428466797
local_in_edges_tensor generation:  0.0838620662689209
mini_batch_src_global generation:  0.05266928672790527
r_  generation:  0.46666955947875977
local_output_nid generation:  0.0304410457611084
local_in_edges_tensor generation:  0.034642934799194336
mini_batch_src_global generation:  0.056665658950805664
r_  generation:  0.4615755081176758
local_output_nid generation:  0.030460834503173828
local_in_edges_tensor generation:  0.031027555465698242
mini_batch_src_global generation:  0.0531461238861084
r_  generation:  0.46224546432495117
local_output_nid generation:  0.030803203582763672
local_in_edges_tensor generation:  0.03527665138244629
mini_batch_src_global generation:  0.057123422622680664
r_  generation:  0.45714521408081055
local_output_nid generation:  0.03093886375427246
local_in_edges_tensor generation:  0.041965484619140625
mini_batch_src_global generation:  0.056183815002441406
r_  generation:  0.46246910095214844
local_output_nid generation:  0.030993938446044922
local_in_edges_tensor generation:  0.04331207275390625
mini_batch_src_global generation:  0.05413246154785156
r_  generation:  0.4598815441131592
local_output_nid generation:  0.03135180473327637
local_in_edges_tensor generation:  0.03305816650390625
mini_batch_src_global generation:  0.05711102485656738
r_  generation:  0.4694383144378662
local_output_nid generation:  0.030994653701782227
local_in_edges_tensor generation:  0.03144049644470215
mini_batch_src_global generation:  0.05408167839050293
r_  generation:  0.45795273780822754
local_output_nid generation:  0.030823945999145508
local_in_edges_tensor generation:  0.03063368797302246
mini_batch_src_global generation:  0.05356144905090332
r_  generation:  0.4665029048919678
local_output_nid generation:  0.03103351593017578
local_in_edges_tensor generation:  0.038848161697387695
mini_batch_src_global generation:  0.05648350715637207
r_  generation:  0.459888219833374
local_output_nid generation:  0.03221869468688965
local_in_edges_tensor generation:  0.04523611068725586
mini_batch_src_global generation:  0.056644439697265625
r_  generation:  0.4644942283630371
local_output_nid generation:  0.03086709976196289
local_in_edges_tensor generation:  0.03177499771118164
mini_batch_src_global generation:  0.0548555850982666
r_  generation:  0.46740293502807617
----------------------check_connections_block total spend ----------------------------- 11.003082036972046
generate_one_block  0.588878870010376
generate_one_block  0.585747480392456
generate_one_block  0.5875051021575928
generate_one_block  0.5801761150360107
generate_one_block  0.5875985622406006
generate_one_block  0.5921945571899414
generate_one_block  0.5716216564178467
generate_one_block  0.5894577503204346
generate_one_block  0.6279294490814209
generate_one_block  0.5992794036865234
generate_one_block  0.5806491374969482
generate_one_block  0.5673232078552246
generate_one_block  0.5801997184753418
generate_one_block  0.5873093605041504
generate_one_block  0.5844721794128418
generate_one_block  0.5755786895751953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11572504043579102  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

connection checking time:  16.487417459487915
block generation total time  14.315731048583984
average batch blocks generation time:  0.894733190536499
block dataloader generation time/epoch 33.09294390678406
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09236574172973633  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154852, 128])
torch.Size([124287, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.45384883880615234  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.0924978256225586  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154729, 128])
torch.Size([124099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4538850784301758  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09275627136230469  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155057, 128])
torch.Size([125121, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4628772735595703  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09264373779296875  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154768, 128])
torch.Size([124526, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.45711660385131836  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09258079528808594  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154838, 128])
torch.Size([124367, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4559764862060547  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09261131286621094  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154848, 128])
torch.Size([124625, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4565305709838867  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.0924844741821289  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154788, 128])
torch.Size([124095, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4539976119995117  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09255599975585938  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155000, 128])
torch.Size([124989, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46050453186035156  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09273910522460938  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155188, 128])
torch.Size([125605, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4635133743286133  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09268760681152344  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155193, 128])
torch.Size([125650, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46297121047973633  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09275436401367188  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155323, 128])
torch.Size([125811, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.46378564834594727  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09256839752197266  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154909, 128])
torch.Size([124743, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4560718536376953  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.0926971435546875  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154830, 128])
torch.Size([124737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4589376449584961  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09270381927490234  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154789, 128])
torch.Size([124599, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.458432674407959  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09278678894042969  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([155086, 128])
torch.Size([125356, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4641585350036621  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.09256935119628906  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

torch.Size([154737, 128])
torch.Size([124515, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4553561210632324  GigaBytes
Max Memory Allocated: 0.509678840637207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040564388036727905 |0.012777507305145264 |0.0035379528999328613 |9.132921695709229e-05 |0.0036324113607406616 |0.0014355182647705078 |
----------------------------------------------------------pseudo_mini_loss sum 3.582223892211914
Total (block generation + training)time/epoch 34.10121417045593
Training time/epoch 1.0079891681671143
Training time without block to device /epoch 0.80354905128479
Training time without total dataloading part /epoch 0.11762261390686035
load block tensor time/epoch 0.6490302085876465
block to device time/epoch 0.20444011688232422
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5205642
Number of first layer input nodes during this epoch:  2478935
