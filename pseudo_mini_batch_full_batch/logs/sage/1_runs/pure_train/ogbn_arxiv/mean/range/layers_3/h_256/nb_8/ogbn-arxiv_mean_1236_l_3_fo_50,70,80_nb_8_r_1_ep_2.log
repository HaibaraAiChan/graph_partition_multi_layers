Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648452986.396023
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02815413475036621
range selection method range initialization spend 0.017244338989257812
time for parepare:  0.017880916595458984
local_output_nid generation:  0.0027036666870117188
local_in_edges_tensor generation:  0.004228115081787109
mini_batch_src_global generation:  0.003844022750854492
r_  generation:  0.04361701011657715
local_output_nid generation:  0.0032606124877929688
local_in_edges_tensor generation:  0.001707315444946289
mini_batch_src_global generation:  0.0047435760498046875
r_  generation:  0.044795989990234375
local_output_nid generation:  0.0032033920288085938
local_in_edges_tensor generation:  0.0017845630645751953
mini_batch_src_global generation:  0.003217935562133789
r_  generation:  0.0457761287689209
local_output_nid generation:  0.0032482147216796875
local_in_edges_tensor generation:  0.0017139911651611328
mini_batch_src_global generation:  0.003326416015625
r_  generation:  0.04634237289428711
local_output_nid generation:  0.003221273422241211
local_in_edges_tensor generation:  0.0017113685607910156
mini_batch_src_global generation:  0.0035114288330078125
r_  generation:  0.04737997055053711
local_output_nid generation:  0.00325775146484375
local_in_edges_tensor generation:  0.0017118453979492188
mini_batch_src_global generation:  0.0038521289825439453
r_  generation:  0.04776763916015625
local_output_nid generation:  0.003246784210205078
local_in_edges_tensor generation:  0.0017235279083251953
mini_batch_src_global generation:  0.003856658935546875
r_  generation:  0.04815816879272461
local_output_nid generation:  0.003245115280151367
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.0038270950317382812
r_  generation:  0.04876375198364258
----------------------check_connections_block total spend ----------------------------- 0.5403501987457275
generate_one_block  0.06174015998840332
generate_one_block  0.06202292442321777
generate_one_block  0.06270098686218262
generate_one_block  0.06225013732910156
generate_one_block  0.06441473960876465
generate_one_block  0.06287431716918945
generate_one_block  0.06256961822509766
generate_one_block  0.06312847137451172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041573524475097656
gen group dst list time:  0.016594648361206055
time for parepare:  0.019019126892089844
local_output_nid generation:  0.01149129867553711
local_in_edges_tensor generation:  0.031241178512573242
mini_batch_src_global generation:  0.037836313247680664
r_  generation:  0.3595719337463379
local_output_nid generation:  0.017417192459106445
local_in_edges_tensor generation:  0.0355229377746582
mini_batch_src_global generation:  0.04494881629943848
r_  generation:  0.37970852851867676
local_output_nid generation:  0.017619848251342773
local_in_edges_tensor generation:  0.02926015853881836
mini_batch_src_global generation:  0.04408097267150879
r_  generation:  0.38240838050842285
local_output_nid generation:  0.022145748138427734
local_in_edges_tensor generation:  0.026296615600585938
mini_batch_src_global generation:  0.04881930351257324
r_  generation:  0.404294490814209
local_output_nid generation:  0.020970821380615234
local_in_edges_tensor generation:  0.03342270851135254
mini_batch_src_global generation:  0.049546003341674805
r_  generation:  0.3781256675720215
local_output_nid generation:  0.019225597381591797
local_in_edges_tensor generation:  0.027342796325683594
mini_batch_src_global generation:  0.0495142936706543
r_  generation:  0.3834054470062256
local_output_nid generation:  0.019336462020874023
local_in_edges_tensor generation:  0.022989749908447266
mini_batch_src_global generation:  0.04654502868652344
r_  generation:  0.3811831474304199
local_output_nid generation:  0.019244670867919922
local_in_edges_tensor generation:  0.022838592529296875
mini_batch_src_global generation:  0.04723477363586426
r_  generation:  0.3860485553741455
----------------------check_connections_block total spend ----------------------------- 4.47277307510376
generate_one_block  0.5470261573791504
generate_one_block  0.5044872760772705
generate_one_block  0.5017077922821045
generate_one_block  0.5087597370147705
generate_one_block  0.4933359622955322
generate_one_block  0.5220229625701904
generate_one_block  0.5038478374481201
generate_one_block  0.4993610382080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04369616508483887
gen group dst list time:  0.0408940315246582
time for parepare:  0.020049333572387695
local_output_nid generation:  0.02731800079345703
local_in_edges_tensor generation:  0.06585073471069336
mini_batch_src_global generation:  0.05555438995361328
r_  generation:  0.5598001480102539
local_output_nid generation:  0.0357213020324707
local_in_edges_tensor generation:  0.054042816162109375
mini_batch_src_global generation:  0.06439733505249023
r_  generation:  0.5496327877044678
local_output_nid generation:  0.035448312759399414
local_in_edges_tensor generation:  0.04623556137084961
mini_batch_src_global generation:  0.06145119667053223
r_  generation:  0.5567305088043213
local_output_nid generation:  0.03560447692871094
local_in_edges_tensor generation:  0.038255929946899414
mini_batch_src_global generation:  0.06087779998779297
r_  generation:  0.5574655532836914
local_output_nid generation:  0.03600955009460449
local_in_edges_tensor generation:  0.04827117919921875
mini_batch_src_global generation:  0.06230473518371582
r_  generation:  0.5636196136474609
local_output_nid generation:  0.0358576774597168
local_in_edges_tensor generation:  0.03374743461608887
mini_batch_src_global generation:  0.06251049041748047
r_  generation:  0.5791194438934326
local_output_nid generation:  0.03570151329040527
local_in_edges_tensor generation:  0.036905527114868164
mini_batch_src_global generation:  0.06342744827270508
r_  generation:  0.572542667388916
local_output_nid generation:  0.03726816177368164
local_in_edges_tensor generation:  0.048158884048461914
mini_batch_src_global generation:  0.06390023231506348
r_  generation:  0.5965423583984375
----------------------check_connections_block total spend ----------------------------- 6.726495742797852
generate_one_block  0.7307033538818359
generate_one_block  0.7226083278656006
generate_one_block  0.718785285949707
generate_one_block  0.7158136367797852
generate_one_block  0.7240891456604004
generate_one_block  0.7031669616699219
generate_one_block  0.7390389442443848
generate_one_block  0.7236063480377197
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  11.199268817901611
block generation total time  9.858360767364502
average batch blocks generation time:  1.2322950959205627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10234451293945312  GigaBytes
Max Memory Allocated: 0.10234451293945312  GigaBytes

torch.Size([162495, 128])
torch.Size([145780, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.9521212577819824  GigaBytes
Max Memory Allocated: 1.0181665420532227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 0.10455846786499023  GigaBytes
Max Memory Allocated: 1.0926074981689453  GigaBytes

torch.Size([162772, 128])
torch.Size([146335, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8709716796875 GB
    Memory Allocated: 0.9516048431396484  GigaBytes
Max Memory Allocated: 1.0926074981689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10563850402832031  GigaBytes
Max Memory Allocated: 1.0926074981689453  GigaBytes

torch.Size([162668, 128])
torch.Size([146030, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9560084342956543  GigaBytes
Max Memory Allocated: 1.0926074981689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10427284240722656  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

torch.Size([162648, 128])
torch.Size([146019, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9532108306884766  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10530281066894531  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

torch.Size([162779, 128])
torch.Size([146291, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9534149169921875  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10496330261230469  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

torch.Size([162346, 128])
torch.Size([145798, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9528384208679199  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10523319244384766  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

torch.Size([162487, 128])
torch.Size([145731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.9522428512573242  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.10498952865600586  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

torch.Size([162579, 128])
torch.Size([145961, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.952845573425293  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06622400879859924 |0.05365794897079468 |0.09896987676620483 |0.00010907649993896484 |0.01280859112739563 |0.0019152164459228516 |
----------------------------------------------------------pseudo_mini_loss sum 6.219301700592041
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057885
Number of first layer input nodes during this epoch:  1300774
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1415572166442871  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02078080177307129
range selection method range initialization spend 0.01150822639465332
time for parepare:  0.020801067352294922
local_output_nid generation:  0.002653360366821289
local_in_edges_tensor generation:  0.00781559944152832
mini_batch_src_global generation:  0.003926277160644531
r_  generation:  0.0433347225189209
local_output_nid generation:  0.003490447998046875
local_in_edges_tensor generation:  0.0016911029815673828
mini_batch_src_global generation:  0.004751682281494141
r_  generation:  0.046744585037231445
local_output_nid generation:  0.003498554229736328
local_in_edges_tensor generation:  0.001813650131225586
mini_batch_src_global generation:  0.0033140182495117188
r_  generation:  0.04512667655944824
local_output_nid generation:  0.006852149963378906
local_in_edges_tensor generation:  0.001764059066772461
mini_batch_src_global generation:  0.0033676624298095703
r_  generation:  0.045072078704833984
local_output_nid generation:  0.0036394596099853516
local_in_edges_tensor generation:  0.0018112659454345703
mini_batch_src_global generation:  0.003492593765258789
r_  generation:  0.049817800521850586
local_output_nid generation:  0.0036020278930664062
local_in_edges_tensor generation:  0.0017023086547851562
mini_batch_src_global generation:  0.003752470016479492
r_  generation:  0.04779553413391113
local_output_nid generation:  0.003679037094116211
local_in_edges_tensor generation:  0.001697540283203125
mini_batch_src_global generation:  0.0037784576416015625
r_  generation:  0.0502164363861084
local_output_nid generation:  0.003588438034057617
local_in_edges_tensor generation:  0.0026068687438964844
mini_batch_src_global generation:  0.004100799560546875
r_  generation:  0.05370783805847168
----------------------check_connections_block total spend ----------------------------- 0.5722849369049072
generate_one_block  0.06124544143676758
generate_one_block  0.06739974021911621
generate_one_block  0.062001943588256836
generate_one_block  0.06165957450866699
generate_one_block  0.06256103515625
generate_one_block  0.06311678886413574
generate_one_block  0.06669831275939941
generate_one_block  0.06324315071105957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05282115936279297
gen group dst list time:  0.016554832458496094
time for parepare:  0.018952131271362305
local_output_nid generation:  0.011329889297485352
local_in_edges_tensor generation:  0.050312042236328125
mini_batch_src_global generation:  0.03571820259094238
r_  generation:  0.3629477024078369
local_output_nid generation:  0.017342805862426758
local_in_edges_tensor generation:  0.03313612937927246
mini_batch_src_global generation:  0.04537487030029297
r_  generation:  0.3732485771179199
local_output_nid generation:  0.017172813415527344
local_in_edges_tensor generation:  0.027495384216308594
mini_batch_src_global generation:  0.04380178451538086
r_  generation:  0.37071847915649414
local_output_nid generation:  0.01735854148864746
local_in_edges_tensor generation:  0.02378106117248535
mini_batch_src_global generation:  0.045175790786743164
r_  generation:  0.3717076778411865
local_output_nid generation:  0.017957448959350586
local_in_edges_tensor generation:  0.023494958877563477
mini_batch_src_global generation:  0.04868674278259277
r_  generation:  0.38516736030578613
local_output_nid generation:  0.017844200134277344
local_in_edges_tensor generation:  0.027785062789916992
mini_batch_src_global generation:  0.04921722412109375
r_  generation:  0.3800630569458008
local_output_nid generation:  0.018202781677246094
local_in_edges_tensor generation:  0.024678468704223633
mini_batch_src_global generation:  0.05010581016540527
r_  generation:  0.3972480297088623
local_output_nid generation:  0.020051956176757812
local_in_edges_tensor generation:  0.027365922927856445
mini_batch_src_global generation:  0.0468745231628418
r_  generation:  0.39078855514526367
----------------------check_connections_block total spend ----------------------------- 4.426440715789795
generate_one_block  0.5365467071533203
generate_one_block  0.5101404190063477
generate_one_block  0.49312639236450195
generate_one_block  0.49506354331970215
generate_one_block  0.5176472663879395
generate_one_block  0.49429869651794434
generate_one_block  0.5078740119934082
generate_one_block  0.537996768951416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07692170143127441
gen group dst list time:  0.03839826583862305
time for parepare:  0.019733667373657227
local_output_nid generation:  0.02680182456970215
local_in_edges_tensor generation:  0.05256962776184082
mini_batch_src_global generation:  0.05516624450683594
r_  generation:  0.5465810298919678
local_output_nid generation:  0.034534454345703125
local_in_edges_tensor generation:  0.06154203414916992
mini_batch_src_global generation:  0.06473612785339355
r_  generation:  0.5686116218566895
local_output_nid generation:  0.03745889663696289
local_in_edges_tensor generation:  0.04534149169921875
mini_batch_src_global generation:  0.06424355506896973
r_  generation:  0.5605463981628418
local_output_nid generation:  0.03579878807067871
local_in_edges_tensor generation:  0.04272794723510742
mini_batch_src_global generation:  0.06015777587890625
r_  generation:  0.5632448196411133
local_output_nid generation:  0.036165714263916016
local_in_edges_tensor generation:  0.045784711837768555
mini_batch_src_global generation:  0.06151890754699707
r_  generation:  0.564244270324707
local_output_nid generation:  0.036449432373046875
local_in_edges_tensor generation:  0.040821075439453125
mini_batch_src_global generation:  0.06433439254760742
r_  generation:  0.5665316581726074
local_output_nid generation:  0.03614449501037598
local_in_edges_tensor generation:  0.04057455062866211
mini_batch_src_global generation:  0.06948995590209961
r_  generation:  0.5744085311889648
local_output_nid generation:  0.03625750541687012
local_in_edges_tensor generation:  0.05901622772216797
mini_batch_src_global generation:  0.06229734420776367
r_  generation:  0.573432445526123
----------------------check_connections_block total spend ----------------------------- 6.735036134719849
generate_one_block  0.7228288650512695
generate_one_block  0.7200047969818115
generate_one_block  0.7020630836486816
generate_one_block  0.7088265419006348
generate_one_block  0.7200677394866943
generate_one_block  0.6961612701416016
generate_one_block  0.7189681529998779
generate_one_block  0.723980188369751
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1415572166442871  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

connection checking time:  11.161476850509644
block generation total time  9.805594444274902
average batch blocks generation time:  1.2256993055343628
block dataloader generation time/epoch 23.183350086212158
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0115966796875 GB
    Memory Allocated: 0.1072397232055664  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

torch.Size([162634, 128])
torch.Size([145997, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9570035934448242  GigaBytes
Max Memory Allocated: 1.0963282585144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10581445693969727  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162436, 128])
torch.Size([145740, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9538111686706543  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10677671432495117  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162544, 128])
torch.Size([145860, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534449577331543  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10649776458740234  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162596, 128])
torch.Size([145630, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9484620094299316  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10686397552490234  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162813, 128])
torch.Size([146342, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9570670127868652  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10625743865966797  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162366, 128])
torch.Size([145539, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9515800476074219  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.10707855224609375  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162608, 128])
torch.Size([146005, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.956545352935791  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.1058187484741211  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

torch.Size([162449, 128])
torch.Size([145746, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0135498046875 GB
    Memory Allocated: 0.9534039497375488  GigaBytes
Max Memory Allocated: 1.098085880279541  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0765690803527832 |0.016932517290115356 |0.003772258758544922 |9.047985076904297e-05 |0.00867551565170288 |0.0018362998962402344 |
----------------------------------------------------------pseudo_mini_loss sum 3.248859167098999
Total (block generation + training)time/epoch 24.11343479156494
Training time/epoch 0.9297885894775391
Training time without block to device /epoch 0.7943284511566162
Training time without total dataloading part /epoch 0.102142333984375
load block tensor time/epoch 0.6125526428222656
block to device time/epoch 0.13546013832092285
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3056732
Number of first layer input nodes during this epoch:  1300446
