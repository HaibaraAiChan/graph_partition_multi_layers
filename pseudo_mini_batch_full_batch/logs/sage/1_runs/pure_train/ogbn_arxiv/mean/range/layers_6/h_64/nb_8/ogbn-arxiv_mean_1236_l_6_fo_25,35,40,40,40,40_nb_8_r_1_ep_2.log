Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648516246.1466842
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024306297302246094
range selection method range initialization spend 0.013070344924926758
time for parepare:  0.017908811569213867
local_output_nid generation:  0.0026242733001708984
local_in_edges_tensor generation:  0.004529714584350586
mini_batch_src_global generation:  0.0031554698944091797
r_  generation:  0.03700709342956543
local_output_nid generation:  0.002965688705444336
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.003962993621826172
r_  generation:  0.03777813911437988
local_output_nid generation:  0.0030357837677001953
local_in_edges_tensor generation:  0.0016407966613769531
mini_batch_src_global generation:  0.0027151107788085938
r_  generation:  0.039107561111450195
local_output_nid generation:  0.0030951499938964844
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.0027396678924560547
r_  generation:  0.03996920585632324
local_output_nid generation:  0.0030984878540039062
local_in_edges_tensor generation:  0.001600503921508789
mini_batch_src_global generation:  0.0028040409088134766
r_  generation:  0.04053044319152832
local_output_nid generation:  0.0031452178955078125
local_in_edges_tensor generation:  0.0016665458679199219
mini_batch_src_global generation:  0.0030143260955810547
r_  generation:  0.04146099090576172
local_output_nid generation:  0.0031130313873291016
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.0030231475830078125
r_  generation:  0.04138326644897461
local_output_nid generation:  0.0031278133392333984
local_in_edges_tensor generation:  0.001619577407836914
mini_batch_src_global generation:  0.003049612045288086
r_  generation:  0.041594505310058594
----------------------check_connections_block total spend ----------------------------- 0.4677295684814453
generate_one_block  0.05415773391723633
generate_one_block  0.054575204849243164
generate_one_block  0.0552976131439209
generate_one_block  0.05454850196838379
generate_one_block  0.05664992332458496
generate_one_block  0.054790496826171875
generate_one_block  0.05495858192443848
generate_one_block  0.05457019805908203
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0426480770111084
gen group dst list time:  0.015012264251708984
time for parepare:  0.019856691360473633
local_output_nid generation:  0.010486602783203125
local_in_edges_tensor generation:  0.030110836029052734
mini_batch_src_global generation:  0.031061649322509766
r_  generation:  0.2963106632232666
local_output_nid generation:  0.01860952377319336
local_in_edges_tensor generation:  0.028872013092041016
mini_batch_src_global generation:  0.0358738899230957
r_  generation:  0.3035004138946533
local_output_nid generation:  0.019449472427368164
local_in_edges_tensor generation:  0.02740621566772461
mini_batch_src_global generation:  0.03606867790222168
r_  generation:  0.313218355178833
local_output_nid generation:  0.019877195358276367
local_in_edges_tensor generation:  0.02217411994934082
mini_batch_src_global generation:  0.04006528854370117
r_  generation:  0.31102585792541504
local_output_nid generation:  0.020475149154663086
local_in_edges_tensor generation:  0.019546985626220703
mini_batch_src_global generation:  0.03737068176269531
r_  generation:  0.31568121910095215
local_output_nid generation:  0.02042412757873535
local_in_edges_tensor generation:  0.01948094367980957
mini_batch_src_global generation:  0.03848385810852051
r_  generation:  0.3173079490661621
local_output_nid generation:  0.020427942276000977
local_in_edges_tensor generation:  0.024671554565429688
mini_batch_src_global generation:  0.037801504135131836
r_  generation:  0.31612682342529297
local_output_nid generation:  0.02096247673034668
local_in_edges_tensor generation:  0.022181034088134766
mini_batch_src_global generation:  0.04115581512451172
r_  generation:  0.32241296768188477
----------------------check_connections_block total spend ----------------------------- 3.695096492767334
generate_one_block  0.4115571975708008
generate_one_block  0.4072906970977783
generate_one_block  0.41364550590515137
generate_one_block  0.41265106201171875
generate_one_block  0.4110279083251953
generate_one_block  0.4262080192565918
generate_one_block  0.4085872173309326
generate_one_block  0.4135091304779053
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03730154037475586
gen group dst list time:  0.03545975685119629
time for parepare:  0.019176483154296875
local_output_nid generation:  0.02537846565246582
local_in_edges_tensor generation:  0.04313921928405762
mini_batch_src_global generation:  0.0495450496673584
r_  generation:  0.529062032699585
local_output_nid generation:  0.03180742263793945
local_in_edges_tensor generation:  0.05277729034423828
mini_batch_src_global generation:  0.06034207344055176
r_  generation:  0.5283145904541016
local_output_nid generation:  0.03258156776428223
local_in_edges_tensor generation:  0.03990054130554199
mini_batch_src_global generation:  0.06087136268615723
r_  generation:  0.5432419776916504
local_output_nid generation:  0.03313493728637695
local_in_edges_tensor generation:  0.04499340057373047
mini_batch_src_global generation:  0.0611569881439209
r_  generation:  0.5360324382781982
local_output_nid generation:  0.03351163864135742
local_in_edges_tensor generation:  0.03432273864746094
mini_batch_src_global generation:  0.059064626693725586
r_  generation:  0.5493483543395996
local_output_nid generation:  0.03363299369812012
local_in_edges_tensor generation:  0.03554797172546387
mini_batch_src_global generation:  0.0621953010559082
r_  generation:  0.5394320487976074
local_output_nid generation:  0.033349037170410156
local_in_edges_tensor generation:  0.04021906852722168
mini_batch_src_global generation:  0.059677839279174805
r_  generation:  0.5502643585205078
local_output_nid generation:  0.033618927001953125
local_in_edges_tensor generation:  0.04881024360656738
mini_batch_src_global generation:  0.06503963470458984
r_  generation:  0.5409455299377441
----------------------check_connections_block total spend ----------------------------- 6.338439464569092
generate_one_block  0.677483320236206
generate_one_block  0.6721112728118896
generate_one_block  0.6912248134613037
generate_one_block  0.6871252059936523
generate_one_block  0.6868681907653809
generate_one_block  0.6881110668182373
generate_one_block  0.7085723876953125
generate_one_block  0.6909384727478027
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03558349609375
gen group dst list time:  0.04449939727783203
time for parepare:  0.01916360855102539
local_output_nid generation:  0.031046628952026367
local_in_edges_tensor generation:  0.04622960090637207
mini_batch_src_global generation:  0.05517292022705078
r_  generation:  0.5549161434173584
local_output_nid generation:  0.03684711456298828
local_in_edges_tensor generation:  0.053151845932006836
mini_batch_src_global generation:  0.0643007755279541
r_  generation:  0.5541791915893555
local_output_nid generation:  0.036808013916015625
local_in_edges_tensor generation:  0.039702415466308594
mini_batch_src_global generation:  0.06484413146972656
r_  generation:  0.5638225078582764
local_output_nid generation:  0.03737473487854004
local_in_edges_tensor generation:  0.04014468193054199
mini_batch_src_global generation:  0.06165051460266113
r_  generation:  0.5600111484527588
local_output_nid generation:  0.037546634674072266
local_in_edges_tensor generation:  0.05406045913696289
mini_batch_src_global generation:  0.060393571853637695
r_  generation:  0.5682291984558105
local_output_nid generation:  0.03758740425109863
local_in_edges_tensor generation:  0.0363774299621582
mini_batch_src_global generation:  0.0613858699798584
r_  generation:  0.5697791576385498
local_output_nid generation:  0.03748202323913574
local_in_edges_tensor generation:  0.05807614326477051
mini_batch_src_global generation:  0.062186241149902344
r_  generation:  0.5658953189849854
local_output_nid generation:  0.03901100158691406
local_in_edges_tensor generation:  0.04184150695800781
mini_batch_src_global generation:  0.061997175216674805
r_  generation:  0.579526424407959
----------------------check_connections_block total spend ----------------------------- 6.712825298309326
generate_one_block  0.704819917678833
generate_one_block  0.7082676887512207
generate_one_block  0.7114546298980713
generate_one_block  0.7141842842102051
generate_one_block  0.7382044792175293
generate_one_block  0.7370424270629883
generate_one_block  0.7550003528594971
generate_one_block  0.7345411777496338
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05299019813537598
gen group dst list time:  0.055054664611816406
time for parepare:  0.019533634185791016
local_output_nid generation:  0.03302145004272461
local_in_edges_tensor generation:  0.06418156623840332
mini_batch_src_global generation:  0.0508885383605957
r_  generation:  0.5606026649475098
local_output_nid generation:  0.038945913314819336
local_in_edges_tensor generation:  0.051615238189697266
mini_batch_src_global generation:  0.06306266784667969
r_  generation:  0.5561091899871826
local_output_nid generation:  0.03969311714172363
local_in_edges_tensor generation:  0.0537869930267334
mini_batch_src_global generation:  0.06417393684387207
r_  generation:  0.5699586868286133
local_output_nid generation:  0.04196310043334961
local_in_edges_tensor generation:  0.05340147018432617
mini_batch_src_global generation:  0.06580233573913574
r_  generation:  0.5549709796905518
local_output_nid generation:  0.0398256778717041
local_in_edges_tensor generation:  0.04445171356201172
mini_batch_src_global generation:  0.06282925605773926
r_  generation:  0.5728976726531982
local_output_nid generation:  0.04026198387145996
local_in_edges_tensor generation:  0.04158186912536621
mini_batch_src_global generation:  0.06297779083251953
r_  generation:  0.5582165718078613
local_output_nid generation:  0.04115581512451172
local_in_edges_tensor generation:  0.0445866584777832
mini_batch_src_global generation:  0.06259322166442871
r_  generation:  0.5592436790466309
local_output_nid generation:  0.04049944877624512
local_in_edges_tensor generation:  0.050386667251586914
mini_batch_src_global generation:  0.06218099594116211
r_  generation:  0.5570027828216553
----------------------check_connections_block total spend ----------------------------- 6.7556421756744385
generate_one_block  0.7225637435913086
generate_one_block  0.7040977478027344
generate_one_block  0.7077414989471436
generate_one_block  0.7200009822845459
generate_one_block  0.7063682079315186
generate_one_block  0.7023131847381592
generate_one_block  0.7082321643829346
generate_one_block  0.7447905540466309
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05543041229248047
gen group dst list time:  0.049071550369262695
time for parepare:  0.019467830657958984
local_output_nid generation:  0.03386712074279785
local_in_edges_tensor generation:  0.044553279876708984
mini_batch_src_global generation:  0.04552459716796875
r_  generation:  0.5083479881286621
local_output_nid generation:  0.0397031307220459
local_in_edges_tensor generation:  0.034848690032958984
mini_batch_src_global generation:  0.058045148849487305
r_  generation:  0.5143930912017822
local_output_nid generation:  0.03820610046386719
local_in_edges_tensor generation:  0.042693138122558594
mini_batch_src_global generation:  0.05846858024597168
r_  generation:  0.5175795555114746
local_output_nid generation:  0.03844261169433594
local_in_edges_tensor generation:  0.03894400596618652
mini_batch_src_global generation:  0.05874514579772949
r_  generation:  0.5159268379211426
local_output_nid generation:  0.03859424591064453
local_in_edges_tensor generation:  0.03826713562011719
mini_batch_src_global generation:  0.05922055244445801
r_  generation:  0.5176699161529541
local_output_nid generation:  0.03895711898803711
local_in_edges_tensor generation:  0.044678449630737305
mini_batch_src_global generation:  0.059767961502075195
r_  generation:  0.5351274013519287
local_output_nid generation:  0.042670488357543945
local_in_edges_tensor generation:  0.04321551322937012
mini_batch_src_global generation:  0.0630486011505127
r_  generation:  0.5116608142852783
local_output_nid generation:  0.04034256935119629
local_in_edges_tensor generation:  0.040474653244018555
mini_batch_src_global generation:  0.06062483787536621
r_  generation:  0.5134108066558838
----------------------check_connections_block total spend ----------------------------- 6.2268149852752686
generate_one_block  0.6359739303588867
generate_one_block  0.6449410915374756
generate_one_block  0.6487550735473633
generate_one_block  0.6434836387634277
generate_one_block  0.6503632068634033
generate_one_block  0.6369564533233643
generate_one_block  0.6410133838653564
generate_one_block  0.6450767517089844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

connection checking time:  29.72881841659546
block generation total time  25.473098039627075
average batch blocks generation time:  3.1841372549533844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.1387186050415039  GigaBytes
Max Memory Allocated: 0.1387186050415039  GigaBytes

torch.Size([167525, 128])
torch.Size([167061, 64])
torch.Size([165768, 64])
torch.Size([161466, 64])
torch.Size([142071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.8843259811401367  GigaBytes
Max Memory Allocated: 0.8961844444274902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.1425642967224121  GigaBytes
Max Memory Allocated: 0.9160113334655762  GigaBytes

torch.Size([167532, 128])
torch.Size([167081, 64])
torch.Size([165796, 64])
torch.Size([161340, 64])
torch.Size([141800, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5819091796875 GB
    Memory Allocated: 0.8840136528015137  GigaBytes
Max Memory Allocated: 0.9160113334655762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14223337173461914  GigaBytes
Max Memory Allocated: 0.9160113334655762  GigaBytes

torch.Size([167483, 128])
torch.Size([167064, 64])
torch.Size([165782, 64])
torch.Size([161289, 64])
torch.Size([141905, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8875317573547363  GigaBytes
Max Memory Allocated: 0.9160113334655762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14204645156860352  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167527, 128])
torch.Size([167070, 64])
torch.Size([165802, 64])
torch.Size([161420, 64])
torch.Size([142079, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.883552074432373  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14261102676391602  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167530, 128])
torch.Size([167069, 64])
torch.Size([165742, 64])
torch.Size([161498, 64])
torch.Size([142260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8850183486938477  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14264440536499023  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167518, 128])
torch.Size([167054, 64])
torch.Size([165694, 64])
torch.Size([161298, 64])
torch.Size([141790, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8854641914367676  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14203643798828125  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167561, 128])
torch.Size([167099, 64])
torch.Size([165815, 64])
torch.Size([161464, 64])
torch.Size([142053, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8841629028320312  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14216232299804688  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167512, 128])
torch.Size([167072, 64])
torch.Size([165770, 64])
torch.Size([161242, 64])
torch.Size([141976, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8838009834289551  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07340872287750244 |0.09295594692230225 |0.09325674176216125 |0.00010535120964050293 |0.026002556085586548 |0.004334688186645508 |
----------------------------------------------------------pseudo_mini_loss sum 5.237739562988281
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6972516
Number of first layer input nodes during this epoch:  1340188
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.26662635803222656  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.023066997528076172
range selection method range initialization spend 0.011490345001220703
time for parepare:  0.01566290855407715
local_output_nid generation:  0.0025577545166015625
local_in_edges_tensor generation:  0.007052183151245117
mini_batch_src_global generation:  0.003227710723876953
r_  generation:  0.038111209869384766
local_output_nid generation:  0.0031235218048095703
local_in_edges_tensor generation:  0.0015833377838134766
mini_batch_src_global generation:  0.006772756576538086
r_  generation:  0.03998374938964844
local_output_nid generation:  0.003153562545776367
local_in_edges_tensor generation:  0.001745462417602539
mini_batch_src_global generation:  0.0028297901153564453
r_  generation:  0.039423465728759766
local_output_nid generation:  0.003279447555541992
local_in_edges_tensor generation:  0.0017197132110595703
mini_batch_src_global generation:  0.0029213428497314453
r_  generation:  0.04013943672180176
local_output_nid generation:  0.0031778812408447266
local_in_edges_tensor generation:  0.001722574234008789
mini_batch_src_global generation:  0.003068685531616211
r_  generation:  0.04491782188415527
local_output_nid generation:  0.003196239471435547
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.003333568572998047
r_  generation:  0.04235696792602539
local_output_nid generation:  0.0031681060791015625
local_in_edges_tensor generation:  0.0016963481903076172
mini_batch_src_global generation:  0.003252744674682617
r_  generation:  0.04532146453857422
local_output_nid generation:  0.003297090530395508
local_in_edges_tensor generation:  0.0016410350799560547
mini_batch_src_global generation:  0.003164529800415039
r_  generation:  0.04192185401916504
----------------------check_connections_block total spend ----------------------------- 0.4921538829803467
generate_one_block  0.054695844650268555
generate_one_block  0.05414319038391113
generate_one_block  0.05372262001037598
generate_one_block  0.05362391471862793
generate_one_block  0.05517888069152832
generate_one_block  0.0591738224029541
generate_one_block  0.05537009239196777
generate_one_block  0.06153678894042969
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.05055594444274902
gen group dst list time:  0.014721155166625977
time for parepare:  0.021059513092041016
local_output_nid generation:  0.016649961471557617
local_in_edges_tensor generation:  0.04771566390991211
mini_batch_src_global generation:  0.03047490119934082
r_  generation:  0.29993462562561035
local_output_nid generation:  0.01682448387145996
local_in_edges_tensor generation:  0.0296018123626709
mini_batch_src_global generation:  0.03611040115356445
r_  generation:  0.31125712394714355
local_output_nid generation:  0.01712322235107422
local_in_edges_tensor generation:  0.021420955657958984
mini_batch_src_global generation:  0.03631782531738281
r_  generation:  0.31519365310668945
local_output_nid generation:  0.01777791976928711
local_in_edges_tensor generation:  0.024309873580932617
mini_batch_src_global generation:  0.036826372146606445
r_  generation:  0.3165755271911621
local_output_nid generation:  0.018168210983276367
local_in_edges_tensor generation:  0.024340152740478516
mini_batch_src_global generation:  0.03778219223022461
r_  generation:  0.3207511901855469
local_output_nid generation:  0.017304420471191406
local_in_edges_tensor generation:  0.024195432662963867
mini_batch_src_global generation:  0.03882718086242676
r_  generation:  0.32312655448913574
local_output_nid generation:  0.017548561096191406
local_in_edges_tensor generation:  0.022072315216064453
mini_batch_src_global generation:  0.040574073791503906
r_  generation:  0.33799266815185547
local_output_nid generation:  0.017476320266723633
local_in_edges_tensor generation:  0.021724462509155273
mini_batch_src_global generation:  0.03925013542175293
r_  generation:  0.32575416564941406
----------------------check_connections_block total spend ----------------------------- 3.7736778259277344
generate_one_block  0.4097297191619873
generate_one_block  0.41046619415283203
generate_one_block  0.40894412994384766
generate_one_block  0.41954541206359863
generate_one_block  0.42195796966552734
generate_one_block  0.4122648239135742
generate_one_block  0.40027928352355957
generate_one_block  0.4388422966003418
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.050904035568237305
gen group dst list time:  0.03675127029418945
time for parepare:  0.021573543548583984
local_output_nid generation:  0.026479005813598633
local_in_edges_tensor generation:  0.05900168418884277
mini_batch_src_global generation:  0.052985429763793945
r_  generation:  0.5220766067504883
local_output_nid generation:  0.032233238220214844
local_in_edges_tensor generation:  0.05184292793273926
mini_batch_src_global generation:  0.06152153015136719
r_  generation:  0.5434563159942627
local_output_nid generation:  0.033113718032836914
local_in_edges_tensor generation:  0.038268327713012695
mini_batch_src_global generation:  0.060288190841674805
r_  generation:  0.5483992099761963
local_output_nid generation:  0.03327512741088867
local_in_edges_tensor generation:  0.037589073181152344
mini_batch_src_global generation:  0.06041908264160156
r_  generation:  0.5409088134765625
local_output_nid generation:  0.033727169036865234
local_in_edges_tensor generation:  0.03800463676452637
mini_batch_src_global generation:  0.059577226638793945
r_  generation:  0.5670089721679688
local_output_nid generation:  0.03366494178771973
local_in_edges_tensor generation:  0.04309558868408203
mini_batch_src_global generation:  0.06100821495056152
r_  generation:  0.549445629119873
local_output_nid generation:  0.035561561584472656
local_in_edges_tensor generation:  0.050563812255859375
mini_batch_src_global generation:  0.060334205627441406
r_  generation:  0.5887348651885986
local_output_nid generation:  0.03747820854187012
local_in_edges_tensor generation:  0.045201778411865234
mini_batch_src_global generation:  0.06861162185668945
r_  generation:  0.5404555797576904
----------------------check_connections_block total spend ----------------------------- 6.4987452030181885
generate_one_block  0.685694694519043
generate_one_block  0.6933989524841309
generate_one_block  0.6846272945404053
generate_one_block  0.6857879161834717
generate_one_block  0.69207763671875
generate_one_block  0.6912767887115479
generate_one_block  0.693403959274292
generate_one_block  0.6889805793762207
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.041965484619140625
gen group dst list time:  0.04992222785949707
time for parepare:  0.01897740364074707
local_output_nid generation:  0.030796527862548828
local_in_edges_tensor generation:  0.0636439323425293
mini_batch_src_global generation:  0.05083322525024414
r_  generation:  0.5606300830841064
local_output_nid generation:  0.038382530212402344
local_in_edges_tensor generation:  0.09043312072753906
mini_batch_src_global generation:  0.06420564651489258
r_  generation:  0.5671396255493164
local_output_nid generation:  0.038127899169921875
local_in_edges_tensor generation:  0.045821428298950195
mini_batch_src_global generation:  0.06753873825073242
r_  generation:  0.5627710819244385
local_output_nid generation:  0.0386202335357666
local_in_edges_tensor generation:  0.047955989837646484
mini_batch_src_global generation:  0.060349225997924805
r_  generation:  0.5810036659240723
local_output_nid generation:  0.037903785705566406
local_in_edges_tensor generation:  0.04707932472229004
mini_batch_src_global generation:  0.06451773643493652
r_  generation:  0.5655207633972168
local_output_nid generation:  0.03859448432922363
local_in_edges_tensor generation:  0.04499387741088867
mini_batch_src_global generation:  0.07513737678527832
r_  generation:  0.5862195491790771
local_output_nid generation:  0.0401310920715332
local_in_edges_tensor generation:  0.05057859420776367
mini_batch_src_global generation:  0.06514906883239746
r_  generation:  0.5676143169403076
local_output_nid generation:  0.03877854347229004
local_in_edges_tensor generation:  0.04245305061340332
mini_batch_src_global generation:  0.06819438934326172
r_  generation:  0.5749506950378418
----------------------check_connections_block total spend ----------------------------- 6.886173963546753
generate_one_block  0.7197659015655518
generate_one_block  0.7084167003631592
generate_one_block  0.706336259841919
generate_one_block  0.7097644805908203
generate_one_block  0.7123007774353027
generate_one_block  0.7160320281982422
generate_one_block  0.7128381729125977
generate_one_block  0.70835280418396
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044055938720703125
gen group dst list time:  0.05334281921386719
time for parepare:  0.018613338470458984
local_output_nid generation:  0.031775474548339844
local_in_edges_tensor generation:  0.0502316951751709
mini_batch_src_global generation:  0.050420284271240234
r_  generation:  0.5547754764556885
local_output_nid generation:  0.03721141815185547
local_in_edges_tensor generation:  0.0424649715423584
mini_batch_src_global generation:  0.06289887428283691
r_  generation:  0.5480921268463135
local_output_nid generation:  0.03813004493713379
local_in_edges_tensor generation:  0.03697347640991211
mini_batch_src_global generation:  0.0631568431854248
r_  generation:  0.5518577098846436
local_output_nid generation:  0.03865790367126465
local_in_edges_tensor generation:  0.03770732879638672
mini_batch_src_global generation:  0.06354951858520508
r_  generation:  0.5498161315917969
local_output_nid generation:  0.03890585899353027
local_in_edges_tensor generation:  0.03686380386352539
mini_batch_src_global generation:  0.06306052207946777
r_  generation:  0.5543091297149658
local_output_nid generation:  0.039170265197753906
local_in_edges_tensor generation:  0.0806119441986084
mini_batch_src_global generation:  0.0625307559967041
r_  generation:  0.5512430667877197
local_output_nid generation:  0.03899788856506348
local_in_edges_tensor generation:  0.041655540466308594
mini_batch_src_global generation:  0.06603026390075684
r_  generation:  0.5554330348968506
local_output_nid generation:  0.040058135986328125
local_in_edges_tensor generation:  0.03753399848937988
mini_batch_src_global generation:  0.06177687644958496
r_  generation:  0.5562095642089844
----------------------check_connections_block total spend ----------------------------- 6.6231162548065186
generate_one_block  0.6851305961608887
generate_one_block  0.7059075832366943
generate_one_block  0.6926612854003906
generate_one_block  0.6878759860992432
generate_one_block  0.6978647708892822
generate_one_block  0.6992099285125732
generate_one_block  0.6893322467803955
generate_one_block  0.7011492252349854
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04134392738342285
gen group dst list time:  0.04837536811828613
time for parepare:  0.019023895263671875
local_output_nid generation:  0.03249549865722656
local_in_edges_tensor generation:  0.041552066802978516
mini_batch_src_global generation:  0.04938673973083496
r_  generation:  0.5086667537689209
local_output_nid generation:  0.03986930847167969
local_in_edges_tensor generation:  0.04277157783508301
mini_batch_src_global generation:  0.058331966400146484
r_  generation:  0.514887809753418
local_output_nid generation:  0.040924072265625
local_in_edges_tensor generation:  0.036048173904418945
mini_batch_src_global generation:  0.06901121139526367
r_  generation:  0.5201263427734375
local_output_nid generation:  0.04077410697937012
local_in_edges_tensor generation:  0.046921491622924805
mini_batch_src_global generation:  0.05921030044555664
r_  generation:  0.5198757648468018
local_output_nid generation:  0.039552927017211914
local_in_edges_tensor generation:  0.041170358657836914
mini_batch_src_global generation:  0.06180930137634277
r_  generation:  0.522545337677002
local_output_nid generation:  0.040001630783081055
local_in_edges_tensor generation:  0.039170026779174805
mini_batch_src_global generation:  0.05913662910461426
r_  generation:  0.5134930610656738
local_output_nid generation:  0.04276323318481445
local_in_edges_tensor generation:  0.03548002243041992
mini_batch_src_global generation:  0.059191226959228516
r_  generation:  0.5147783756256104
local_output_nid generation:  0.03963184356689453
local_in_edges_tensor generation:  0.04731607437133789
mini_batch_src_global generation:  0.05836153030395508
r_  generation:  0.5180103778839111
----------------------check_connections_block total spend ----------------------------- 6.2405104637146
generate_one_block  0.6780903339385986
generate_one_block  0.6382739543914795
generate_one_block  0.6379077434539795
generate_one_block  0.6479048728942871
generate_one_block  0.6440212726593018
generate_one_block  0.6463088989257812
generate_one_block  0.6383616924285889
generate_one_block  0.6430678367614746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.26662635803222656  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

connection checking time:  30.022223711013794
block generation total time  25.264153003692627
average batch blocks generation time:  3.1580191254615784
block dataloader generation time/epoch 58.15683722496033
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14300823211669922  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167550, 128])
torch.Size([167169, 64])
torch.Size([165930, 64])
torch.Size([161544, 64])
torch.Size([142297, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8852581977844238  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14304876327514648  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167513, 128])
torch.Size([167083, 64])
torch.Size([165806, 64])
torch.Size([161348, 64])
torch.Size([142007, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8865323066711426  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14239788055419922  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167497, 128])
torch.Size([167041, 64])
torch.Size([165787, 64])
torch.Size([161383, 64])
torch.Size([141905, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8837580680847168  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14240169525146484  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167529, 128])
torch.Size([167111, 64])
torch.Size([165802, 64])
torch.Size([161324, 64])
torch.Size([141540, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8858370780944824  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1425647735595703  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167540, 128])
torch.Size([167113, 64])
torch.Size([165856, 64])
torch.Size([161343, 64])
torch.Size([141697, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.884002685546875  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.1430950164794922  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167531, 128])
torch.Size([167110, 64])
torch.Size([165827, 64])
torch.Size([161406, 64])
torch.Size([141979, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8855361938476562  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14306306838989258  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167524, 128])
torch.Size([167103, 64])
torch.Size([165878, 64])
torch.Size([161570, 64])
torch.Size([142805, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8868904113769531  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.14307785034179688  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

torch.Size([167518, 128])
torch.Size([167130, 64])
torch.Size([165907, 64])
torch.Size([161543, 64])
torch.Size([142480, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 0.8862862586975098  GigaBytes
Max Memory Allocated: 0.9193944931030273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08180126547813416 |0.05053943395614624 |0.0069190263748168945 |9.325146675109863e-05 |0.006814450025558472 |0.005763053894042969 |
----------------------------------------------------------pseudo_mini_loss sum 4.107876777648926
Total (block generation + training)time/epoch 59.40392088890076
Training time/epoch 1.2467155456542969
Training time without block to device /epoch 0.842400074005127
Training time without total dataloading part /epoch 0.11637687683105469
load block tensor time/epoch 0.6544101238250732
block to device time/epoch 0.4043154716491699
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6974807
Number of first layer input nodes during this epoch:  1340202
