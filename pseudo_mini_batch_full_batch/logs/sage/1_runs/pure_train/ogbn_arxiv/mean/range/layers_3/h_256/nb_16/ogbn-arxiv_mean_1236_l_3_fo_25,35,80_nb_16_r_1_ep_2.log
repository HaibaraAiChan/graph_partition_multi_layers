Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648452031.4383538
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027406930923461914
range selection method range initialization spend 0.013532161712646484
time for parepare:  0.0180816650390625
local_output_nid generation:  0.0013918876647949219
local_in_edges_tensor generation:  0.004183769226074219
mini_batch_src_global generation:  0.0019366741180419922
r_  generation:  0.019960641860961914
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0023610591888427734
r_  generation:  0.020543336868286133
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.0015480518341064453
r_  generation:  0.02007579803466797
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.001474142074584961
r_  generation:  0.020054340362548828
local_output_nid generation:  0.0015170574188232422
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.020430564880371094
local_output_nid generation:  0.0015342235565185547
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0016934871673583984
r_  generation:  0.020995616912841797
local_output_nid generation:  0.001580953598022461
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.021351337432861328
local_output_nid generation:  0.0015442371368408203
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0017118453979492188
r_  generation:  0.020624160766601562
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0016520023345947266
r_  generation:  0.020977258682250977
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.0008413791656494141
mini_batch_src_global generation:  0.0016596317291259766
r_  generation:  0.020818471908569336
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017490386962890625
r_  generation:  0.021301984786987305
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0017719268798828125
r_  generation:  0.02155303955078125
local_output_nid generation:  0.0015392303466796875
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0017766952514648438
r_  generation:  0.021600008010864258
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0017747879028320312
r_  generation:  0.021376848220825195
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0018041133880615234
r_  generation:  0.021537303924560547
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0018568038940429688
r_  generation:  0.02188563346862793
----------------------check_connections_block total spend ----------------------------- 0.49782538414001465
generate_one_block  0.030317068099975586
generate_one_block  0.031922340393066406
generate_one_block  0.03183579444885254
generate_one_block  0.031263113021850586
generate_one_block  0.03151345252990723
generate_one_block  0.0313417911529541
generate_one_block  0.03147292137145996
generate_one_block  0.030297040939331055
generate_one_block  0.03112339973449707
generate_one_block  0.03058600425720215
generate_one_block  0.031174659729003906
generate_one_block  0.03173828125
generate_one_block  0.03150653839111328
generate_one_block  0.03078007698059082
generate_one_block  0.031261444091796875
generate_one_block  0.031259775161743164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038980722427368164
gen group dst list time:  0.020531415939331055
time for parepare:  0.02029895782470703
local_output_nid generation:  0.00733184814453125
local_in_edges_tensor generation:  0.021384239196777344
mini_batch_src_global generation:  0.021002531051635742
r_  generation:  0.21369266510009766
local_output_nid generation:  0.013948440551757812
local_in_edges_tensor generation:  0.020720243453979492
mini_batch_src_global generation:  0.029675960540771484
r_  generation:  0.23129510879516602
local_output_nid generation:  0.014406442642211914
local_in_edges_tensor generation:  0.01621103286743164
mini_batch_src_global generation:  0.025894641876220703
r_  generation:  0.223069429397583
local_output_nid generation:  0.015108108520507812
local_in_edges_tensor generation:  0.015017271041870117
mini_batch_src_global generation:  0.027748823165893555
r_  generation:  0.2310798168182373
local_output_nid generation:  0.015468835830688477
local_in_edges_tensor generation:  0.017555952072143555
mini_batch_src_global generation:  0.028336048126220703
r_  generation:  0.2374250888824463
local_output_nid generation:  0.015239953994750977
local_in_edges_tensor generation:  0.01712489128112793
mini_batch_src_global generation:  0.028972625732421875
r_  generation:  0.23273944854736328
local_output_nid generation:  0.015740633010864258
local_in_edges_tensor generation:  0.013927459716796875
mini_batch_src_global generation:  0.03192782402038574
r_  generation:  0.23672890663146973
local_output_nid generation:  0.015572309494018555
local_in_edges_tensor generation:  0.013370037078857422
mini_batch_src_global generation:  0.02901482582092285
r_  generation:  0.2310342788696289
local_output_nid generation:  0.01568913459777832
local_in_edges_tensor generation:  0.015563488006591797
mini_batch_src_global generation:  0.029726266860961914
r_  generation:  0.23383259773254395
local_output_nid generation:  0.015558481216430664
local_in_edges_tensor generation:  0.01721048355102539
mini_batch_src_global generation:  0.02926158905029297
r_  generation:  0.2326035499572754
local_output_nid generation:  0.01599264144897461
local_in_edges_tensor generation:  0.015534639358520508
mini_batch_src_global generation:  0.03135967254638672
r_  generation:  0.23801350593566895
local_output_nid generation:  0.016118288040161133
local_in_edges_tensor generation:  0.0160675048828125
mini_batch_src_global generation:  0.030077695846557617
r_  generation:  0.23708105087280273
local_output_nid generation:  0.015942096710205078
local_in_edges_tensor generation:  0.017220258712768555
mini_batch_src_global generation:  0.029996633529663086
r_  generation:  0.23642706871032715
local_output_nid generation:  0.015820741653442383
local_in_edges_tensor generation:  0.015995264053344727
mini_batch_src_global generation:  0.029632568359375
r_  generation:  0.23146510124206543
local_output_nid generation:  0.01612257957458496
local_in_edges_tensor generation:  0.015465259552001953
mini_batch_src_global generation:  0.03167080879211426
r_  generation:  0.23658108711242676
local_output_nid generation:  0.015940189361572266
local_in_edges_tensor generation:  0.013588190078735352
mini_batch_src_global generation:  0.030297040939331055
r_  generation:  0.23606586456298828
----------------------check_connections_block total spend ----------------------------- 5.5301806926727295
generate_one_block  0.3094327449798584
generate_one_block  0.31438159942626953
generate_one_block  0.29872918128967285
generate_one_block  0.30159997940063477
generate_one_block  0.3222332000732422
generate_one_block  0.3047816753387451
generate_one_block  0.31731200218200684
generate_one_block  0.2995908260345459
generate_one_block  0.30259060859680176
generate_one_block  0.3017878532409668
generate_one_block  0.3048880100250244
generate_one_block  0.31315159797668457
generate_one_block  0.3102600574493408
generate_one_block  0.3046450614929199
generate_one_block  0.316028356552124
generate_one_block  0.31226515769958496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036766767501831055
gen group dst list time:  0.06078338623046875
time for parepare:  0.01913595199584961
local_output_nid generation:  0.023941516876220703
local_in_edges_tensor generation:  0.0387113094329834
mini_batch_src_global generation:  0.046964168548583984
r_  generation:  0.44054436683654785
local_output_nid generation:  0.029657363891601562
local_in_edges_tensor generation:  0.04694652557373047
mini_batch_src_global generation:  0.052025556564331055
r_  generation:  0.4471142292022705
local_output_nid generation:  0.02946186065673828
local_in_edges_tensor generation:  0.03214073181152344
mini_batch_src_global generation:  0.05268120765686035
r_  generation:  0.4502084255218506
local_output_nid generation:  0.029639482498168945
local_in_edges_tensor generation:  0.034827470779418945
mini_batch_src_global generation:  0.05225348472595215
r_  generation:  0.4523932933807373
local_output_nid generation:  0.02998065948486328
local_in_edges_tensor generation:  0.04439806938171387
mini_batch_src_global generation:  0.05198812484741211
r_  generation:  0.4644956588745117
local_output_nid generation:  0.029874801635742188
local_in_edges_tensor generation:  0.031871795654296875
mini_batch_src_global generation:  0.053395748138427734
r_  generation:  0.45464038848876953
local_output_nid generation:  0.030416011810302734
local_in_edges_tensor generation:  0.03587794303894043
mini_batch_src_global generation:  0.05622410774230957
r_  generation:  0.46149468421936035
local_output_nid generation:  0.029976367950439453
local_in_edges_tensor generation:  0.03584623336791992
mini_batch_src_global generation:  0.05366802215576172
r_  generation:  0.45626378059387207
local_output_nid generation:  0.029994487762451172
local_in_edges_tensor generation:  0.03360295295715332
mini_batch_src_global generation:  0.05326366424560547
r_  generation:  0.46034693717956543
local_output_nid generation:  0.03043675422668457
local_in_edges_tensor generation:  0.0411376953125
mini_batch_src_global generation:  0.05649971961975098
r_  generation:  0.4570951461791992
local_output_nid generation:  0.03086090087890625
local_in_edges_tensor generation:  0.04022216796875
mini_batch_src_global generation:  0.052506446838378906
r_  generation:  0.46671295166015625
local_output_nid generation:  0.03106236457824707
local_in_edges_tensor generation:  0.04036879539489746
mini_batch_src_global generation:  0.05324244499206543
r_  generation:  0.4586360454559326
local_output_nid generation:  0.030799150466918945
local_in_edges_tensor generation:  0.03249788284301758
mini_batch_src_global generation:  0.0522456169128418
r_  generation:  0.4633157253265381
local_output_nid generation:  0.031058788299560547
local_in_edges_tensor generation:  0.03172492980957031
mini_batch_src_global generation:  0.05317521095275879
r_  generation:  0.46147775650024414
local_output_nid generation:  0.0306398868560791
local_in_edges_tensor generation:  0.03588223457336426
mini_batch_src_global generation:  0.05262351036071777
r_  generation:  0.4638025760650635
local_output_nid generation:  0.030577659606933594
local_in_edges_tensor generation:  0.0398554801940918
mini_batch_src_global generation:  0.05609583854675293
r_  generation:  0.4565296173095703
----------------------check_connections_block total spend ----------------------------- 10.850593090057373
generate_one_block  0.603069543838501
generate_one_block  0.6002805233001709
generate_one_block  0.5727291107177734
generate_one_block  0.5853309631347656
generate_one_block  0.5886282920837402
generate_one_block  0.5790646076202393
generate_one_block  0.6400389671325684
generate_one_block  0.5887851715087891
generate_one_block  0.5867881774902344
generate_one_block  0.5820178985595703
generate_one_block  0.5989201068878174
generate_one_block  0.5902972221374512
generate_one_block  0.576228141784668
generate_one_block  0.5932936668395996
generate_one_block  0.584099292755127
generate_one_block  0.5855300426483154
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  16.380773782730103
block generation total time  14.388779640197754
average batch blocks generation time:  0.8992987275123596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09144353866577148  GigaBytes
Max Memory Allocated: 0.09144353866577148  GigaBytes

torch.Size([155102, 128])
torch.Size([124994, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2010498046875 GB
    Memory Allocated: 0.7444276809692383  GigaBytes
Max Memory Allocated: 0.7855949401855469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.09293985366821289  GigaBytes
Max Memory Allocated: 0.8309659957885742  GigaBytes

torch.Size([154909, 128])
torch.Size([124687, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.747584342956543  GigaBytes
Max Memory Allocated: 0.8309659957885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09296703338623047  GigaBytes
Max Memory Allocated: 0.8365764617919922  GigaBytes

torch.Size([155118, 128])
torch.Size([124609, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7379779815673828  GigaBytes
Max Memory Allocated: 0.8365764617919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09277868270874023  GigaBytes
Max Memory Allocated: 0.8365764617919922  GigaBytes

torch.Size([155095, 128])
torch.Size([124852, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7412929534912109  GigaBytes
Max Memory Allocated: 0.8365764617919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09312820434570312  GigaBytes
Max Memory Allocated: 0.8365764617919922  GigaBytes

torch.Size([155374, 128])
torch.Size([125386, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7491164207458496  GigaBytes
Max Memory Allocated: 0.8365764617919922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09273338317871094  GigaBytes
Max Memory Allocated: 0.8377423286437988  GigaBytes

torch.Size([154900, 128])
torch.Size([124754, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7425765991210938  GigaBytes
Max Memory Allocated: 0.8377423286437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09329795837402344  GigaBytes
Max Memory Allocated: 0.8377423286437988  GigaBytes

torch.Size([155022, 128])
torch.Size([125103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7498202323913574  GigaBytes
Max Memory Allocated: 0.8377423286437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09254598617553711  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154683, 128])
torch.Size([124522, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7379131317138672  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09307479858398438  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154789, 128])
torch.Size([124605, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7415366172790527  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09287881851196289  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155305, 128])
torch.Size([125232, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7425861358642578  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.0931253433227539  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154797, 128])
torch.Size([124774, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7421746253967285  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.0927286148071289  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154628, 128])
torch.Size([124962, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7451820373535156  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09315109252929688  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154883, 128])
torch.Size([124459, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7414155006408691  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09272193908691406  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154874, 128])
torch.Size([124742, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7411432266235352  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09314441680908203  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155022, 128])
torch.Size([124862, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7437195777893066  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.09278392791748047  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154776, 128])
torch.Size([124799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 0.7428402900695801  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06283137202262878 |0.035691022872924805 |0.051222801208496094 |9.341537952423096e-05 |0.007284268736839294 |0.002712249755859375 |
----------------------------------------------------------pseudo_mini_loss sum 6.271303653717041
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5206507
Number of first layer input nodes during this epoch:  2479277
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.11798715591430664  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025802135467529297
range selection method range initialization spend 0.011545896530151367
time for parepare:  0.018287181854248047
local_output_nid generation:  0.0014090538024902344
local_in_edges_tensor generation:  0.007674455642700195
mini_batch_src_global generation:  0.0020456314086914062
r_  generation:  0.020105600357055664
local_output_nid generation:  0.001672506332397461
local_in_edges_tensor generation:  0.0009658336639404297
mini_batch_src_global generation:  0.002486705780029297
r_  generation:  0.020837783813476562
local_output_nid generation:  0.0017271041870117188
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0017039775848388672
r_  generation:  0.021471500396728516
local_output_nid generation:  0.0017979145050048828
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0016598701477050781
r_  generation:  0.02064061164855957
local_output_nid generation:  0.0017285346984863281
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.001567840576171875
r_  generation:  0.02132415771484375
local_output_nid generation:  0.0017857551574707031
local_in_edges_tensor generation:  0.0009906291961669922
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.02125859260559082
local_output_nid generation:  0.0017466545104980469
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.001743316650390625
r_  generation:  0.021755456924438477
local_output_nid generation:  0.0017292499542236328
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0016891956329345703
r_  generation:  0.02076864242553711
local_output_nid generation:  0.0017085075378417969
local_in_edges_tensor generation:  0.003601551055908203
mini_batch_src_global generation:  0.0017573833465576172
r_  generation:  0.021497011184692383
local_output_nid generation:  0.001689910888671875
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.0017735958099365234
r_  generation:  0.02239680290222168
local_output_nid generation:  0.0017540454864501953
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0017590522766113281
r_  generation:  0.02147531509399414
local_output_nid generation:  0.001720428466796875
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.001806497573852539
r_  generation:  0.022034883499145508
local_output_nid generation:  0.001768350601196289
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0018291473388671875
r_  generation:  0.022274494171142578
local_output_nid generation:  0.0016999244689941406
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0018925666809082031
r_  generation:  0.022459983825683594
local_output_nid generation:  0.0017037391662597656
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.0018553733825683594
r_  generation:  0.02228999137878418
local_output_nid generation:  0.0017385482788085938
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0018115043640136719
r_  generation:  0.022349834442138672
----------------------check_connections_block total spend ----------------------------- 0.5212612152099609
generate_one_block  0.03973889350891113
generate_one_block  0.03261899948120117
generate_one_block  0.03269529342651367
generate_one_block  0.03122687339782715
generate_one_block  0.03191065788269043
generate_one_block  0.03345203399658203
generate_one_block  0.031777143478393555
generate_one_block  0.03077864646911621
generate_one_block  0.031469106674194336
generate_one_block  0.03271603584289551
generate_one_block  0.03139638900756836
generate_one_block  0.03199481964111328
generate_one_block  0.0325624942779541
generate_one_block  0.03276228904724121
generate_one_block  0.03186488151550293
generate_one_block  0.03158307075500488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0389857292175293
gen group dst list time:  0.0195772647857666
time for parepare:  0.019763946533203125
local_output_nid generation:  0.007622957229614258
local_in_edges_tensor generation:  0.0228426456451416
mini_batch_src_global generation:  0.023723840713500977
r_  generation:  0.21859264373779297
local_output_nid generation:  0.01156759262084961
local_in_edges_tensor generation:  0.02102971076965332
mini_batch_src_global generation:  0.02793097496032715
r_  generation:  0.2277359962463379
local_output_nid generation:  0.012398242950439453
local_in_edges_tensor generation:  0.019227027893066406
mini_batch_src_global generation:  0.02918553352355957
r_  generation:  0.23581933975219727
local_output_nid generation:  0.011894464492797852
local_in_edges_tensor generation:  0.01329660415649414
mini_batch_src_global generation:  0.028116226196289062
r_  generation:  0.2306227684020996
local_output_nid generation:  0.012322425842285156
local_in_edges_tensor generation:  0.017290115356445312
mini_batch_src_global generation:  0.02890157699584961
r_  generation:  0.23154759407043457
local_output_nid generation:  0.012138843536376953
local_in_edges_tensor generation:  0.015747785568237305
mini_batch_src_global generation:  0.03109455108642578
r_  generation:  0.23249244689941406
local_output_nid generation:  0.012217283248901367
local_in_edges_tensor generation:  0.016071319580078125
mini_batch_src_global generation:  0.03128767013549805
r_  generation:  0.23401856422424316
local_output_nid generation:  0.01209402084350586
local_in_edges_tensor generation:  0.01421046257019043
mini_batch_src_global generation:  0.0295717716217041
r_  generation:  0.23097705841064453
local_output_nid generation:  0.01230311393737793
local_in_edges_tensor generation:  0.01349782943725586
mini_batch_src_global generation:  0.03137516975402832
r_  generation:  0.23357033729553223
local_output_nid generation:  0.012710809707641602
local_in_edges_tensor generation:  0.016510486602783203
mini_batch_src_global generation:  0.031874656677246094
r_  generation:  0.24019098281860352
local_output_nid generation:  0.012267589569091797
local_in_edges_tensor generation:  0.013991117477416992
mini_batch_src_global generation:  0.029729604721069336
r_  generation:  0.2380383014678955
local_output_nid generation:  0.012618064880371094
local_in_edges_tensor generation:  0.015845060348510742
mini_batch_src_global generation:  0.03017139434814453
r_  generation:  0.24076366424560547
local_output_nid generation:  0.01278543472290039
local_in_edges_tensor generation:  0.018997669219970703
mini_batch_src_global generation:  0.03202033042907715
r_  generation:  0.24260830879211426
local_output_nid generation:  0.012633800506591797
local_in_edges_tensor generation:  0.014333963394165039
mini_batch_src_global generation:  0.031003952026367188
r_  generation:  0.2395796775817871
local_output_nid generation:  0.012769937515258789
local_in_edges_tensor generation:  0.01622939109802246
mini_batch_src_global generation:  0.03302431106567383
r_  generation:  0.2420506477355957
local_output_nid generation:  0.013793468475341797
local_in_edges_tensor generation:  0.019376039505004883
mini_batch_src_global generation:  0.03225231170654297
r_  generation:  0.25648927688598633
----------------------check_connections_block total spend ----------------------------- 5.586984395980835
generate_one_block  0.3211038112640381
generate_one_block  0.30811119079589844
generate_one_block  0.3415098190307617
generate_one_block  0.3005554676055908
generate_one_block  0.2999262809753418
generate_one_block  0.3012092113494873
generate_one_block  0.3356361389160156
generate_one_block  0.2965056896209717
generate_one_block  0.30086350440979004
generate_one_block  0.3205728530883789
generate_one_block  0.3060264587402344
generate_one_block  0.31897664070129395
generate_one_block  0.3185441493988037
generate_one_block  0.30376338958740234
generate_one_block  0.3229098320007324
generate_one_block  0.30466485023498535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045359134674072266
gen group dst list time:  0.06820201873779297
time for parepare:  0.019028902053833008
local_output_nid generation:  0.025074481964111328
local_in_edges_tensor generation:  0.06941962242126465
mini_batch_src_global generation:  0.04645037651062012
r_  generation:  0.44929957389831543
local_output_nid generation:  0.029937267303466797
local_in_edges_tensor generation:  0.04346489906311035
mini_batch_src_global generation:  0.05756020545959473
r_  generation:  0.4508371353149414
local_output_nid generation:  0.03016972541809082
local_in_edges_tensor generation:  0.032256364822387695
mini_batch_src_global generation:  0.0522770881652832
r_  generation:  0.464810848236084
local_output_nid generation:  0.03045177459716797
local_in_edges_tensor generation:  0.031990766525268555
mini_batch_src_global generation:  0.05665397644042969
r_  generation:  0.45685338973999023
local_output_nid generation:  0.030813217163085938
local_in_edges_tensor generation:  0.07907772064208984
mini_batch_src_global generation:  0.0526127815246582
r_  generation:  0.46614837646484375
local_output_nid generation:  0.031017303466796875
local_in_edges_tensor generation:  0.02805638313293457
mini_batch_src_global generation:  0.0553131103515625
r_  generation:  0.4637186527252197
local_output_nid generation:  0.03566789627075195
local_in_edges_tensor generation:  0.040319204330444336
mini_batch_src_global generation:  0.054314374923706055
r_  generation:  0.4737403392791748
local_output_nid generation:  0.03141975402832031
local_in_edges_tensor generation:  0.029822826385498047
mini_batch_src_global generation:  0.05795145034790039
r_  generation:  0.46659207344055176
local_output_nid generation:  0.03144431114196777
local_in_edges_tensor generation:  0.03638601303100586
mini_batch_src_global generation:  0.057425737380981445
r_  generation:  0.49562549591064453
local_output_nid generation:  0.03358197212219238
local_in_edges_tensor generation:  0.04353523254394531
mini_batch_src_global generation:  0.05809617042541504
r_  generation:  0.4711785316467285
local_output_nid generation:  0.03315615653991699
local_in_edges_tensor generation:  0.03196287155151367
mini_batch_src_global generation:  0.054198265075683594
r_  generation:  0.47098636627197266
local_output_nid generation:  0.0326993465423584
local_in_edges_tensor generation:  0.03405165672302246
mini_batch_src_global generation:  0.05783271789550781
r_  generation:  0.4652974605560303
local_output_nid generation:  0.03268265724182129
local_in_edges_tensor generation:  0.04118847846984863
mini_batch_src_global generation:  0.053511619567871094
r_  generation:  0.471510648727417
local_output_nid generation:  0.032096147537231445
local_in_edges_tensor generation:  0.0375368595123291
mini_batch_src_global generation:  0.05400228500366211
r_  generation:  0.46498966217041016
local_output_nid generation:  0.03261280059814453
local_in_edges_tensor generation:  0.03211164474487305
mini_batch_src_global generation:  0.05310392379760742
r_  generation:  0.469135046005249
local_output_nid generation:  0.032423973083496094
local_in_edges_tensor generation:  0.032254695892333984
mini_batch_src_global generation:  0.05483436584472656
r_  generation:  0.4639627933502197
----------------------check_connections_block total spend ----------------------------- 11.142563343048096
generate_one_block  0.584324836730957
generate_one_block  0.5839087963104248
generate_one_block  0.5810973644256592
generate_one_block  0.6278245449066162
generate_one_block  0.6305830478668213
generate_one_block  0.5863842964172363
generate_one_block  0.5872728824615479
generate_one_block  0.5804634094238281
generate_one_block  0.6535861492156982
generate_one_block  0.6147651672363281
generate_one_block  0.5955286026000977
generate_one_block  0.6027226448059082
generate_one_block  0.5969929695129395
generate_one_block  0.5831327438354492
generate_one_block  0.5764026641845703
generate_one_block  0.5851571559906006
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.11798715591430664  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

connection checking time:  16.72954773902893
block generation total time  14.57102656364441
average batch blocks generation time:  0.9106891602277756
block dataloader generation time/epoch 33.586310625076294
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.09485864639282227  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155021, 128])
torch.Size([124956, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.7496719360351562  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.0945286750793457  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155049, 128])
torch.Size([124883, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.7450919151306152  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.09488677978515625  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154736, 128])
torch.Size([124582, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.7492833137512207  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.0944223403930664  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155038, 128])
torch.Size([124849, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.7430648803710938  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.09471702575683594  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155292, 128])
torch.Size([125162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.7459869384765625  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.09428977966308594  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154782, 128])
torch.Size([124450, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.741002082824707  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09474945068359375  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([154819, 128])
torch.Size([124468, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7426900863647461  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09434747695922852  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155215, 128])
torch.Size([124583, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7384357452392578  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09465885162353516  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155214, 128])
torch.Size([125001, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7441806793212891  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09471702575683594  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

torch.Size([155362, 128])
torch.Size([125846, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7537598609924316  GigaBytes
Max Memory Allocated: 0.8385791778564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.0945587158203125  GigaBytes
Max Memory Allocated: 0.8427205085754395  GigaBytes

torch.Size([154700, 128])
torch.Size([123977, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7384524345397949  GigaBytes
Max Memory Allocated: 0.8427205085754395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09431171417236328  GigaBytes
Max Memory Allocated: 0.8427205085754395  GigaBytes

torch.Size([154710, 128])
torch.Size([124736, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7451047897338867  GigaBytes
Max Memory Allocated: 0.8427205085754395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09492778778076172  GigaBytes
Max Memory Allocated: 0.8427205085754395  GigaBytes

torch.Size([155268, 128])
torch.Size([125866, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7539534568786621  GigaBytes
Max Memory Allocated: 0.8427205085754395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09445571899414062  GigaBytes
Max Memory Allocated: 0.842768669128418  GigaBytes

torch.Size([154944, 128])
torch.Size([124815, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7447247505187988  GigaBytes
Max Memory Allocated: 0.842768669128418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09482765197753906  GigaBytes
Max Memory Allocated: 0.842768669128418  GigaBytes

torch.Size([154836, 128])
torch.Size([124667, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.744936466217041  GigaBytes
Max Memory Allocated: 0.842768669128418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.09440898895263672  GigaBytes
Max Memory Allocated: 0.842768669128418  GigaBytes

torch.Size([154982, 128])
torch.Size([124927, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6229248046875 GB
    Memory Allocated: 0.7428679466247559  GigaBytes
Max Memory Allocated: 0.842768669128418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.059590861201286316 |0.015154138207435608 |0.0038008838891983032 |8.846819400787354e-05 |0.006434977054595947 |0.0019757747650146484 |
----------------------------------------------------------pseudo_mini_loss sum 3.2648675441741943
Total (block generation + training)time/epoch 35.01163673400879
Training time/epoch 1.4251317977905273
Training time without block to device /epoch 1.1826655864715576
Training time without total dataloading part /epoch 0.16716504096984863
load block tensor time/epoch 0.953453779220581
block to device time/epoch 0.24246621131896973
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5208103
Number of first layer input nodes during this epoch:  2479968
