Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648449011.510795
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025088071823120117
range selection method range initialization spend 0.013872623443603516
time for parepare:  0.017887353897094727
local_output_nid generation:  0.0013175010681152344
local_in_edges_tensor generation:  0.0032968521118164062
mini_batch_src_global generation:  0.002076864242553711
r_  generation:  0.0216829776763916
local_output_nid generation:  0.0015475749969482422
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0023567676544189453
r_  generation:  0.020444869995117188
local_output_nid generation:  0.0015327930450439453
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0014538764953613281
r_  generation:  0.019811153411865234
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.001500844955444336
r_  generation:  0.020177602767944336
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0015192031860351562
r_  generation:  0.02099919319152832
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0008673667907714844
mini_batch_src_global generation:  0.0016071796417236328
r_  generation:  0.02136397361755371
local_output_nid generation:  0.001542806625366211
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0016450881958007812
r_  generation:  0.02127385139465332
local_output_nid generation:  0.00153350830078125
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0016663074493408203
r_  generation:  0.02216339111328125
local_output_nid generation:  0.0015387535095214844
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.001714944839477539
r_  generation:  0.022685527801513672
local_output_nid generation:  0.0015556812286376953
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.0017142295837402344
r_  generation:  0.022058963775634766
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0016744136810302734
r_  generation:  0.021422624588012695
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0016751289367675781
r_  generation:  0.02149176597595215
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0016667842864990234
r_  generation:  0.02169203758239746
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0016841888427734375
r_  generation:  0.02180004119873047
local_output_nid generation:  0.0015277862548828125
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0017192363739013672
r_  generation:  0.021445035934448242
local_output_nid generation:  0.0015170574188232422
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0017037391662597656
r_  generation:  0.021597623825073242
----------------------check_connections_block total spend ----------------------------- 0.5035734176635742
generate_one_block  0.03087162971496582
generate_one_block  0.03125476837158203
generate_one_block  0.03114151954650879
generate_one_block  0.030929088592529297
generate_one_block  0.03111410140991211
generate_one_block  0.031520843505859375
generate_one_block  0.0312802791595459
generate_one_block  0.03198885917663574
generate_one_block  0.032285213470458984
generate_one_block  0.03202533721923828
generate_one_block  0.031181812286376953
generate_one_block  0.03083205223083496
generate_one_block  0.031371116638183594
generate_one_block  0.03143143653869629
generate_one_block  0.030602216720581055
generate_one_block  0.031276702880859375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03884601593017578
gen group dst list time:  0.02075362205505371
time for parepare:  0.019071102142333984
local_output_nid generation:  0.007534503936767578
local_in_edges_tensor generation:  0.018595218658447266
mini_batch_src_global generation:  0.026249170303344727
r_  generation:  0.2523832321166992
local_output_nid generation:  0.011545896530151367
local_in_edges_tensor generation:  0.021522998809814453
mini_batch_src_global generation:  0.03173708915710449
r_  generation:  0.25510501861572266
local_output_nid generation:  0.011507272720336914
local_in_edges_tensor generation:  0.019084930419921875
mini_batch_src_global generation:  0.03622102737426758
r_  generation:  0.24985122680664062
local_output_nid generation:  0.012043476104736328
local_in_edges_tensor generation:  0.017439842224121094
mini_batch_src_global generation:  0.034813880920410156
r_  generation:  0.2588679790496826
local_output_nid generation:  0.01239776611328125
local_in_edges_tensor generation:  0.020261526107788086
mini_batch_src_global generation:  0.03297257423400879
r_  generation:  0.26407480239868164
local_output_nid generation:  0.012689828872680664
local_in_edges_tensor generation:  0.013565301895141602
mini_batch_src_global generation:  0.0358586311340332
r_  generation:  0.26836204528808594
local_output_nid generation:  0.01279306411743164
local_in_edges_tensor generation:  0.013562679290771484
mini_batch_src_global generation:  0.03383755683898926
r_  generation:  0.2669663429260254
local_output_nid generation:  0.01284027099609375
local_in_edges_tensor generation:  0.013767004013061523
mini_batch_src_global generation:  0.03520774841308594
r_  generation:  0.2764437198638916
local_output_nid generation:  0.01293492317199707
local_in_edges_tensor generation:  0.018165111541748047
mini_batch_src_global generation:  0.03486800193786621
r_  generation:  0.2710556983947754
local_output_nid generation:  0.013072729110717773
local_in_edges_tensor generation:  0.013916492462158203
mini_batch_src_global generation:  0.03498673439025879
r_  generation:  0.2767512798309326
local_output_nid generation:  0.012910127639770508
local_in_edges_tensor generation:  0.01828598976135254
mini_batch_src_global generation:  0.03419804573059082
r_  generation:  0.270796537399292
local_output_nid generation:  0.01283121109008789
local_in_edges_tensor generation:  0.01813983917236328
mini_batch_src_global generation:  0.03393816947937012
r_  generation:  0.26743364334106445
local_output_nid generation:  0.012956857681274414
local_in_edges_tensor generation:  0.01341557502746582
mini_batch_src_global generation:  0.034399986267089844
r_  generation:  0.26897287368774414
local_output_nid generation:  0.012911558151245117
local_in_edges_tensor generation:  0.016486167907714844
mini_batch_src_global generation:  0.03536725044250488
r_  generation:  0.27429819107055664
local_output_nid generation:  0.012740612030029297
local_in_edges_tensor generation:  0.015743017196655273
mini_batch_src_global generation:  0.03430962562561035
r_  generation:  0.26647305488586426
local_output_nid generation:  0.013029813766479492
local_in_edges_tensor generation:  0.01860785484313965
mini_batch_src_global generation:  0.03400611877441406
r_  generation:  0.27266979217529297
----------------------check_connections_block total spend ----------------------------- 6.2070252895355225
generate_one_block  0.35168910026550293
generate_one_block  0.3516077995300293
generate_one_block  0.33625197410583496
generate_one_block  0.344188928604126
generate_one_block  0.3662681579589844
generate_one_block  0.3552224636077881
generate_one_block  0.3515615463256836
generate_one_block  0.3680150508880615
generate_one_block  0.3596506118774414
generate_one_block  0.35701560974121094
generate_one_block  0.3531625270843506
generate_one_block  0.34657955169677734
generate_one_block  0.3526949882507324
generate_one_block  0.3637218475341797
generate_one_block  0.35546875
generate_one_block  0.34970688819885254
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05603337287902832
gen group dst list time:  0.06897878646850586
time for parepare:  0.018938302993774414
local_output_nid generation:  0.024774551391601562
local_in_edges_tensor generation:  0.07324957847595215
mini_batch_src_global generation:  0.053894996643066406
r_  generation:  0.5422971248626709
local_output_nid generation:  0.035082101821899414
local_in_edges_tensor generation:  0.06065535545349121
mini_batch_src_global generation:  0.07556486129760742
r_  generation:  0.5337333679199219
local_output_nid generation:  0.031800270080566406
local_in_edges_tensor generation:  0.04236268997192383
mini_batch_src_global generation:  0.06414175033569336
r_  generation:  0.5429081916809082
local_output_nid generation:  0.03385734558105469
local_in_edges_tensor generation:  0.055442094802856445
mini_batch_src_global generation:  0.0717780590057373
r_  generation:  0.5443835258483887
local_output_nid generation:  0.03345489501953125
local_in_edges_tensor generation:  0.04139852523803711
mini_batch_src_global generation:  0.06343865394592285
r_  generation:  0.554257869720459
local_output_nid generation:  0.033010244369506836
local_in_edges_tensor generation:  0.03857588768005371
mini_batch_src_global generation:  0.0638282299041748
r_  generation:  0.5465624332427979
local_output_nid generation:  0.03318047523498535
local_in_edges_tensor generation:  0.049024343490600586
mini_batch_src_global generation:  0.0644989013671875
r_  generation:  0.5519287586212158
local_output_nid generation:  0.034302473068237305
local_in_edges_tensor generation:  0.04140973091125488
mini_batch_src_global generation:  0.06457638740539551
r_  generation:  0.5673277378082275
local_output_nid generation:  0.03507113456726074
local_in_edges_tensor generation:  0.042024850845336914
mini_batch_src_global generation:  0.07045364379882812
r_  generation:  0.545318603515625
local_output_nid generation:  0.03319716453552246
local_in_edges_tensor generation:  0.03852987289428711
mini_batch_src_global generation:  0.06462240219116211
r_  generation:  0.5524773597717285
local_output_nid generation:  0.03302335739135742
local_in_edges_tensor generation:  0.031044721603393555
mini_batch_src_global generation:  0.0652153491973877
r_  generation:  0.5558285713195801
local_output_nid generation:  0.03294801712036133
local_in_edges_tensor generation:  0.03218245506286621
mini_batch_src_global generation:  0.06491708755493164
r_  generation:  0.5452651977539062
local_output_nid generation:  0.03363323211669922
local_in_edges_tensor generation:  0.03612709045410156
mini_batch_src_global generation:  0.0696103572845459
r_  generation:  0.5448248386383057
local_output_nid generation:  0.03341412544250488
local_in_edges_tensor generation:  0.04884219169616699
mini_batch_src_global generation:  0.06516051292419434
r_  generation:  0.5436017513275146
local_output_nid generation:  0.03383374214172363
local_in_edges_tensor generation:  0.03164076805114746
mini_batch_src_global generation:  0.06587052345275879
r_  generation:  0.5438768863677979
local_output_nid generation:  0.033026695251464844
local_in_edges_tensor generation:  0.03666257858276367
mini_batch_src_global generation:  0.07087850570678711
r_  generation:  0.5648782253265381
----------------------check_connections_block total spend ----------------------------- 13.025020360946655
generate_one_block  0.7013874053955078
generate_one_block  0.6962234973907471
generate_one_block  0.6887102127075195
generate_one_block  0.700192928314209
generate_one_block  0.7045700550079346
generate_one_block  0.6970176696777344
generate_one_block  0.7641987800598145
generate_one_block  0.6794054508209229
generate_one_block  0.6917939186096191
generate_one_block  0.6968958377838135
generate_one_block  0.6790082454681396
generate_one_block  0.6723916530609131
generate_one_block  0.7047920227050781
generate_one_block  0.7043159008026123
generate_one_block  0.6743652820587158
generate_one_block  0.6952202320098877
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  19.232045650482178
block generation total time  16.813294887542725
average batch blocks generation time:  1.0508309304714203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09517955780029297  GigaBytes
Max Memory Allocated: 0.09517955780029297  GigaBytes

torch.Size([157331, 128])
torch.Size([130030, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.26772212982177734  GigaBytes
Max Memory Allocated: 0.2766547203063965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09685039520263672  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157698, 128])
torch.Size([129783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26699066162109375  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09653091430664062  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157702, 128])
torch.Size([129375, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.265195369720459  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09678268432617188  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157739, 128])
torch.Size([130357, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2668628692626953  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09569597244262695  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157299, 128])
torch.Size([129736, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26587677001953125  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09586954116821289  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157449, 128])
torch.Size([130027, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26662397384643555  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09689807891845703  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157700, 128])
torch.Size([130124, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.267458438873291  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09595251083374023  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157391, 128])
torch.Size([129481, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.266939640045166  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0960073471069336  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157618, 128])
torch.Size([129952, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2673501968383789  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09702205657958984  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

torch.Size([157773, 128])
torch.Size([130582, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2685551643371582  GigaBytes
Max Memory Allocated: 0.2903752326965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0957951545715332  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157407, 128])
torch.Size([129793, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26614856719970703  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09563636779785156  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157358, 128])
torch.Size([129329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26561975479125977  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09689712524414062  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157710, 128])
torch.Size([130067, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2673335075378418  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09592580795288086  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157493, 128])
torch.Size([130112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26662731170654297  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09567499160766602  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157459, 128])
torch.Size([129317, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2654991149902344  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09683418273925781  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157779, 128])
torch.Size([130135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2672901153564453  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033173009753227234 |0.03894403576850891 |0.049078568816185 |0.00010101497173309326 |0.009691908955574036 |0.0036962032318115234 |
----------------------------------------------------------pseudo_mini_loss sum 5.349620342254639
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5329390
Number of first layer input nodes during this epoch:  2520906
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.1389331817626953  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021741628646850586
range selection method range initialization spend 0.012872695922851562
time for parepare:  0.018027305603027344
local_output_nid generation:  0.0013360977172851562
local_in_edges_tensor generation:  0.004555225372314453
mini_batch_src_global generation:  0.0037992000579833984
r_  generation:  0.02301621437072754
local_output_nid generation:  0.003179788589477539
local_in_edges_tensor generation:  0.0019683837890625
mini_batch_src_global generation:  0.0051310062408447266
r_  generation:  0.023940086364746094
local_output_nid generation:  0.0016062259674072266
local_in_edges_tensor generation:  0.0010223388671875
mini_batch_src_global generation:  0.0019228458404541016
r_  generation:  0.023480892181396484
local_output_nid generation:  0.0017299652099609375
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0019207000732421875
r_  generation:  0.02098679542541504
local_output_nid generation:  0.0017533302307128906
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0015752315521240234
r_  generation:  0.02138972282409668
local_output_nid generation:  0.001745462417602539
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0016512870788574219
r_  generation:  0.021251440048217773
local_output_nid generation:  0.001735687255859375
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.001600503921508789
r_  generation:  0.022971153259277344
local_output_nid generation:  0.001783132553100586
local_in_edges_tensor generation:  0.00090789794921875
mini_batch_src_global generation:  0.004283428192138672
r_  generation:  0.023932218551635742
local_output_nid generation:  0.0018227100372314453
local_in_edges_tensor generation:  0.0009548664093017578
mini_batch_src_global generation:  0.0020477771759033203
r_  generation:  0.022576332092285156
local_output_nid generation:  0.0018110275268554688
local_in_edges_tensor generation:  0.0008983612060546875
mini_batch_src_global generation:  0.0016863346099853516
r_  generation:  0.02117776870727539
local_output_nid generation:  0.0017864704132080078
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.010220527648925781
r_  generation:  0.02276897430419922
local_output_nid generation:  0.001811981201171875
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.02367544174194336
local_output_nid generation:  0.0017855167388916016
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0021216869354248047
r_  generation:  0.02333545684814453
local_output_nid generation:  0.001806497573852539
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0017862319946289062
r_  generation:  0.024076461791992188
local_output_nid generation:  0.0018146038055419922
local_in_edges_tensor generation:  0.0009317398071289062
mini_batch_src_global generation:  0.002137422561645508
r_  generation:  0.023856401443481445
local_output_nid generation:  0.0018088817596435547
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.002344846725463867
r_  generation:  0.02413773536682129
----------------------check_connections_block total spend ----------------------------- 0.5742099285125732
generate_one_block  0.03391909599304199
generate_one_block  0.030887365341186523
generate_one_block  0.03177309036254883
generate_one_block  0.031989097595214844
generate_one_block  0.0324254035949707
generate_one_block  0.05525517463684082
generate_one_block  0.03175973892211914
generate_one_block  0.03197503089904785
generate_one_block  0.03609037399291992
generate_one_block  0.03073573112487793
generate_one_block  0.03296661376953125
generate_one_block  0.03135943412780762
generate_one_block  0.03218388557434082
generate_one_block  0.03144383430480957
generate_one_block  0.0312349796295166
generate_one_block  0.03217339515686035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04047369956970215
gen group dst list time:  0.01918649673461914
time for parepare:  0.019139766693115234
local_output_nid generation:  0.0076444149017333984
local_in_edges_tensor generation:  0.024319171905517578
mini_batch_src_global generation:  0.024670124053955078
r_  generation:  0.2499847412109375
local_output_nid generation:  0.01117253303527832
local_in_edges_tensor generation:  0.0248260498046875
mini_batch_src_global generation:  0.03448319435119629
r_  generation:  0.28004884719848633
local_output_nid generation:  0.014773368835449219
local_in_edges_tensor generation:  0.027419328689575195
mini_batch_src_global generation:  0.03518843650817871
r_  generation:  0.2694542407989502
local_output_nid generation:  0.01276254653930664
local_in_edges_tensor generation:  0.013504743576049805
mini_batch_src_global generation:  0.03460407257080078
r_  generation:  0.2794356346130371
local_output_nid generation:  0.012590885162353516
local_in_edges_tensor generation:  0.0178225040435791
mini_batch_src_global generation:  0.03362774848937988
r_  generation:  0.27006983757019043
local_output_nid generation:  0.012803792953491211
local_in_edges_tensor generation:  0.01586174964904785
mini_batch_src_global generation:  0.03379702568054199
r_  generation:  0.26925206184387207
local_output_nid generation:  0.012367725372314453
local_in_edges_tensor generation:  0.015409469604492188
mini_batch_src_global generation:  0.03345990180969238
r_  generation:  0.3298943042755127
local_output_nid generation:  0.012552976608276367
local_in_edges_tensor generation:  0.020769596099853516
mini_batch_src_global generation:  0.037377119064331055
r_  generation:  0.29578733444213867
local_output_nid generation:  0.016082286834716797
local_in_edges_tensor generation:  0.025591373443603516
mini_batch_src_global generation:  0.0368807315826416
r_  generation:  0.27739572525024414
local_output_nid generation:  0.012483358383178711
local_in_edges_tensor generation:  0.017926692962646484
mini_batch_src_global generation:  0.034587860107421875
r_  generation:  0.26975226402282715
local_output_nid generation:  0.01286005973815918
local_in_edges_tensor generation:  0.018572568893432617
mini_batch_src_global generation:  0.03490424156188965
r_  generation:  0.28267574310302734
local_output_nid generation:  0.012730121612548828
local_in_edges_tensor generation:  0.014096498489379883
mini_batch_src_global generation:  0.034760475158691406
r_  generation:  0.2743227481842041
local_output_nid generation:  0.012896060943603516
local_in_edges_tensor generation:  0.015949010848999023
mini_batch_src_global generation:  0.03497600555419922
r_  generation:  0.2953646183013916
local_output_nid generation:  0.015386819839477539
local_in_edges_tensor generation:  0.025721311569213867
mini_batch_src_global generation:  0.03608441352844238
r_  generation:  0.26906299591064453
local_output_nid generation:  0.013108015060424805
local_in_edges_tensor generation:  0.017008304595947266
mini_batch_src_global generation:  0.036035776138305664
r_  generation:  0.27106428146362305
local_output_nid generation:  0.013268470764160156
local_in_edges_tensor generation:  0.01629018783569336
mini_batch_src_global generation:  0.03436732292175293
r_  generation:  0.273958683013916
----------------------check_connections_block total spend ----------------------------- 6.502926588058472
generate_one_block  0.3668546676635742
generate_one_block  0.359816312789917
generate_one_block  0.35918116569519043
generate_one_block  0.35794782638549805
generate_one_block  0.35641980171203613
generate_one_block  0.3461434841156006
generate_one_block  0.3849527835845947
generate_one_block  0.3717203140258789
generate_one_block  0.3670227527618408
generate_one_block  0.3456902503967285
generate_one_block  0.36696887016296387
generate_one_block  0.34641098976135254
generate_one_block  0.36074042320251465
generate_one_block  0.35115838050842285
generate_one_block  0.3435046672821045
generate_one_block  0.3649599552154541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042886972427368164
gen group dst list time:  0.06751799583435059
time for parepare:  0.017942428588867188
local_output_nid generation:  0.025563716888427734
local_in_edges_tensor generation:  0.05403542518615723
mini_batch_src_global generation:  0.05048847198486328
r_  generation:  0.515906572341919
local_output_nid generation:  0.03052067756652832
local_in_edges_tensor generation:  0.049039602279663086
mini_batch_src_global generation:  0.062377214431762695
r_  generation:  0.5221900939941406
local_output_nid generation:  0.03126692771911621
local_in_edges_tensor generation:  0.04063558578491211
mini_batch_src_global generation:  0.06231284141540527
r_  generation:  0.5437273979187012
local_output_nid generation:  0.031468868255615234
local_in_edges_tensor generation:  0.03182625770568848
mini_batch_src_global generation:  0.059325456619262695
r_  generation:  0.5380544662475586
local_output_nid generation:  0.03140830993652344
local_in_edges_tensor generation:  0.07583189010620117
mini_batch_src_global generation:  0.06122875213623047
r_  generation:  0.5407917499542236
local_output_nid generation:  0.03158402442932129
local_in_edges_tensor generation:  0.0354459285736084
mini_batch_src_global generation:  0.061029672622680664
r_  generation:  0.5413799285888672
local_output_nid generation:  0.03157520294189453
local_in_edges_tensor generation:  0.035698652267456055
mini_batch_src_global generation:  0.06189703941345215
r_  generation:  0.5423934459686279
local_output_nid generation:  0.03180217742919922
local_in_edges_tensor generation:  0.046872615814208984
mini_batch_src_global generation:  0.061391353607177734
r_  generation:  0.5470490455627441
local_output_nid generation:  0.03362560272216797
local_in_edges_tensor generation:  0.04108834266662598
mini_batch_src_global generation:  0.06166386604309082
r_  generation:  0.5499424934387207
local_output_nid generation:  0.032423973083496094
local_in_edges_tensor generation:  0.03625154495239258
mini_batch_src_global generation:  0.06431198120117188
r_  generation:  0.5616273880004883
local_output_nid generation:  0.03307342529296875
local_in_edges_tensor generation:  0.04340338706970215
mini_batch_src_global generation:  0.06681561470031738
r_  generation:  0.5525774955749512
local_output_nid generation:  0.03507804870605469
local_in_edges_tensor generation:  0.04075264930725098
mini_batch_src_global generation:  0.06464076042175293
r_  generation:  0.5456783771514893
local_output_nid generation:  0.033530473709106445
local_in_edges_tensor generation:  0.03653097152709961
mini_batch_src_global generation:  0.06289553642272949
r_  generation:  0.5429091453552246
local_output_nid generation:  0.03319907188415527
local_in_edges_tensor generation:  0.031225204467773438
mini_batch_src_global generation:  0.061986684799194336
r_  generation:  0.5472769737243652
local_output_nid generation:  0.033278703689575195
local_in_edges_tensor generation:  0.031394243240356445
mini_batch_src_global generation:  0.06267738342285156
r_  generation:  0.5427062511444092
local_output_nid generation:  0.03351902961730957
local_in_edges_tensor generation:  0.04119420051574707
mini_batch_src_global generation:  0.061182260513305664
r_  generation:  0.5482232570648193
----------------------check_connections_block total spend ----------------------------- 12.758226871490479
generate_one_block  0.687694787979126
generate_one_block  0.6892390251159668
generate_one_block  0.6945364475250244
generate_one_block  0.6887497901916504
generate_one_block  0.6882951259613037
generate_one_block  0.6864404678344727
generate_one_block  0.6885225772857666
generate_one_block  0.6924242973327637
generate_one_block  0.7387337684631348
generate_one_block  0.6736698150634766
generate_one_block  0.6771371364593506
generate_one_block  0.696169376373291
generate_one_block  0.7043735980987549
generate_one_block  0.673940896987915
generate_one_block  0.6754565238952637
generate_one_block  0.6815111637115479
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.1389331817626953  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

connection checking time:  19.26115345954895
block generation total time  16.78638744354248
average batch blocks generation time:  1.049149215221405
block dataloader generation time/epoch 38.446483850479126
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09608840942382812  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157663, 128])
torch.Size([130226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2663860321044922  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0971689224243164  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157822, 128])
torch.Size([130141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2675628662109375  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09620189666748047  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157574, 128])
torch.Size([130314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.267397403717041  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09609603881835938  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157556, 128])
torch.Size([129754, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2666745185852051  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.0960850715637207  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157537, 128])
torch.Size([130127, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26694202423095703  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09598970413208008  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157611, 128])
torch.Size([129763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26610231399536133  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09594869613647461  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157637, 128])
torch.Size([129570, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26549816131591797  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09606790542602539  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157393, 128])
torch.Size([130031, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26692724227905273  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09724044799804688  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157720, 128])
torch.Size([130296, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2684745788574219  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09595060348510742  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157477, 128])
torch.Size([129507, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26583337783813477  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09624147415161133  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157477, 128])
torch.Size([129809, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26772069931030273  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09707164764404297  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157718, 128])
torch.Size([130312, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2672238349914551  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09627056121826172  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157676, 128])
torch.Size([130375, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.2677016258239746  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09585285186767578  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157440, 128])
torch.Size([129094, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26549720764160156  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09603643417358398  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157695, 128])
torch.Size([129872, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26607179641723633  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.09612131118774414  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

torch.Size([157693, 128])
torch.Size([130031, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.26663732528686523  GigaBytes
Max Memory Allocated: 0.29053497314453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03091670572757721 |0.014345794916152954 |0.003544449806213379 |9.365379810333252e-05 |0.00565706193447113 |0.0019099712371826172 |
----------------------------------------------------------pseudo_mini_loss sum 4.095203399658203
Total (block generation + training)time/epoch 39.3522253036499
Training time/epoch 0.9054172039031982
Training time without block to device /epoch 0.675884485244751
Training time without total dataloading part /epoch 0.15063261985778809
load block tensor time/epoch 0.49466729164123535
block to device time/epoch 0.22953271865844727
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5331753
Number of first layer input nodes during this epoch:  2521689
