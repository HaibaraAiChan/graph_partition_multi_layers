Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648498356.5011349
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024137020111083984
range selection method range initialization spend 0.01381063461303711
time for parepare:  0.017688274383544922
local_output_nid generation:  0.0026504993438720703
local_in_edges_tensor generation:  0.003936052322387695
mini_batch_src_global generation:  0.0033054351806640625
r_  generation:  0.038135528564453125
local_output_nid generation:  0.0031099319458007812
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.004160404205322266
r_  generation:  0.039337158203125
local_output_nid generation:  0.0031435489654541016
local_in_edges_tensor generation:  0.0016171932220458984
mini_batch_src_global generation:  0.0026979446411132812
r_  generation:  0.04015660285949707
local_output_nid generation:  0.003162384033203125
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.002958059310913086
r_  generation:  0.04128313064575195
local_output_nid generation:  0.0031125545501708984
local_in_edges_tensor generation:  0.0016243457794189453
mini_batch_src_global generation:  0.002967357635498047
r_  generation:  0.0413966178894043
local_output_nid generation:  0.003097057342529297
local_in_edges_tensor generation:  0.0016133785247802734
mini_batch_src_global generation:  0.003160715103149414
r_  generation:  0.04154348373413086
local_output_nid generation:  0.003116130828857422
local_in_edges_tensor generation:  0.0016207695007324219
mini_batch_src_global generation:  0.003111124038696289
r_  generation:  0.04179716110229492
local_output_nid generation:  0.0031414031982421875
local_in_edges_tensor generation:  0.0016558170318603516
mini_batch_src_global generation:  0.003183603286743164
r_  generation:  0.042345285415649414
----------------------check_connections_block total spend ----------------------------- 0.47756361961364746
generate_one_block  0.05397152900695801
generate_one_block  0.0560908317565918
generate_one_block  0.055719614028930664
generate_one_block  0.056180715560913086
generate_one_block  0.0575406551361084
generate_one_block  0.05469512939453125
generate_one_block  0.05446434020996094
generate_one_block  0.05573725700378418
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04010438919067383
gen group dst list time:  0.015352725982666016
time for parepare:  0.019072771072387695
local_output_nid generation:  0.010484933853149414
local_in_edges_tensor generation:  0.028492212295532227
mini_batch_src_global generation:  0.031099319458007812
r_  generation:  0.2933790683746338
local_output_nid generation:  0.016565799713134766
local_in_edges_tensor generation:  0.027968883514404297
mini_batch_src_global generation:  0.03975319862365723
r_  generation:  0.33445024490356445
local_output_nid generation:  0.01939535140991211
local_in_edges_tensor generation:  0.02391815185546875
mini_batch_src_global generation:  0.036855220794677734
r_  generation:  0.32137632369995117
local_output_nid generation:  0.017198801040649414
local_in_edges_tensor generation:  0.021296262741088867
mini_batch_src_global generation:  0.04386329650878906
r_  generation:  0.3351707458496094
local_output_nid generation:  0.018084049224853516
local_in_edges_tensor generation:  0.03607034683227539
mini_batch_src_global generation:  0.04817700386047363
r_  generation:  0.3236393928527832
local_output_nid generation:  0.018410682678222656
local_in_edges_tensor generation:  0.022199392318725586
mini_batch_src_global generation:  0.041614532470703125
r_  generation:  0.3425729274749756
local_output_nid generation:  0.01816105842590332
local_in_edges_tensor generation:  0.020052433013916016
mini_batch_src_global generation:  0.039086103439331055
r_  generation:  0.33801984786987305
local_output_nid generation:  0.0204317569732666
local_in_edges_tensor generation:  0.030920028686523438
mini_batch_src_global generation:  0.04000043869018555
r_  generation:  0.32387590408325195
----------------------check_connections_block total spend ----------------------------- 3.8508689403533936
generate_one_block  0.41100645065307617
generate_one_block  0.43726229667663574
generate_one_block  0.42308640480041504
generate_one_block  0.4167611598968506
generate_one_block  0.41280579566955566
generate_one_block  0.437699556350708
generate_one_block  0.40731382369995117
generate_one_block  0.40549516677856445
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05042624473571777
gen group dst list time:  0.040103912353515625
time for parepare:  0.019570112228393555
local_output_nid generation:  0.026202917098999023
local_in_edges_tensor generation:  0.06607317924499512
mini_batch_src_global generation:  0.04982781410217285
r_  generation:  0.5224697589874268
local_output_nid generation:  0.031668663024902344
local_in_edges_tensor generation:  0.05175900459289551
mini_batch_src_global generation:  0.06290245056152344
r_  generation:  0.5466673374176025
local_output_nid generation:  0.03282952308654785
local_in_edges_tensor generation:  0.037993431091308594
mini_batch_src_global generation:  0.06104588508605957
r_  generation:  0.5470786094665527
local_output_nid generation:  0.03362584114074707
local_in_edges_tensor generation:  0.03951883316040039
mini_batch_src_global generation:  0.06106686592102051
r_  generation:  0.5398647785186768
local_output_nid generation:  0.033443450927734375
local_in_edges_tensor generation:  0.04256606101989746
mini_batch_src_global generation:  0.0595395565032959
r_  generation:  0.5585520267486572
local_output_nid generation:  0.03483271598815918
local_in_edges_tensor generation:  0.04183840751647949
mini_batch_src_global generation:  0.06143951416015625
r_  generation:  0.5583994388580322
local_output_nid generation:  0.0338444709777832
local_in_edges_tensor generation:  0.04626798629760742
mini_batch_src_global generation:  0.06959986686706543
r_  generation:  0.5696847438812256
local_output_nid generation:  0.037096261978149414
local_in_edges_tensor generation:  0.04349017143249512
mini_batch_src_global generation:  0.06211256980895996
r_  generation:  0.5445208549499512
----------------------check_connections_block total spend ----------------------------- 6.462091445922852
generate_one_block  0.6824550628662109
generate_one_block  0.6907320022583008
generate_one_block  0.6861686706542969
generate_one_block  0.6944711208343506
generate_one_block  0.6773862838745117
generate_one_block  0.7221577167510986
generate_one_block  0.695868968963623
generate_one_block  0.6797776222229004
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04795074462890625
gen group dst list time:  0.04511666297912598
time for parepare:  0.019026994705200195
local_output_nid generation:  0.030295848846435547
local_in_edges_tensor generation:  0.06122565269470215
mini_batch_src_global generation:  0.050438642501831055
r_  generation:  0.537724494934082
local_output_nid generation:  0.036041975021362305
local_in_edges_tensor generation:  0.05524015426635742
mini_batch_src_global generation:  0.06243753433227539
r_  generation:  0.5395331382751465
local_output_nid generation:  0.036718130111694336
local_in_edges_tensor generation:  0.040808916091918945
mini_batch_src_global generation:  0.06266450881958008
r_  generation:  0.5488579273223877
local_output_nid generation:  0.037290334701538086
local_in_edges_tensor generation:  0.043745994567871094
mini_batch_src_global generation:  0.06365442276000977
r_  generation:  0.5524601936340332
local_output_nid generation:  0.03722214698791504
local_in_edges_tensor generation:  0.04125380516052246
mini_batch_src_global generation:  0.06024742126464844
r_  generation:  0.5510852336883545
local_output_nid generation:  0.039154767990112305
local_in_edges_tensor generation:  0.03631281852722168
mini_batch_src_global generation:  0.060070037841796875
r_  generation:  0.5517206192016602
local_output_nid generation:  0.0379338264465332
local_in_edges_tensor generation:  0.04439401626586914
mini_batch_src_global generation:  0.06075620651245117
r_  generation:  0.5612123012542725
local_output_nid generation:  0.038222551345825195
local_in_edges_tensor generation:  0.04627513885498047
mini_batch_src_global generation:  0.059456825256347656
r_  generation:  0.561539888381958
----------------------check_connections_block total spend ----------------------------- 6.563913583755493
generate_one_block  0.7026257514953613
generate_one_block  0.697080135345459
generate_one_block  0.7070953845977783
generate_one_block  0.6892766952514648
generate_one_block  0.6992087364196777
generate_one_block  0.6841185092926025
generate_one_block  0.7397170066833496
generate_one_block  0.7091996669769287
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04990577697753906
gen group dst list time:  0.04788327217102051
time for parepare:  0.01956486701965332
local_output_nid generation:  0.03258633613586426
local_in_edges_tensor generation:  0.044217824935913086
mini_batch_src_global generation:  0.04581570625305176
r_  generation:  0.5118284225463867
local_output_nid generation:  0.03726673126220703
local_in_edges_tensor generation:  0.038968563079833984
mini_batch_src_global generation:  0.0583796501159668
r_  generation:  0.5188841819763184
local_output_nid generation:  0.03824329376220703
local_in_edges_tensor generation:  0.034269094467163086
mini_batch_src_global generation:  0.0586390495300293
r_  generation:  0.5179531574249268
local_output_nid generation:  0.03860068321228027
local_in_edges_tensor generation:  0.034679412841796875
mini_batch_src_global generation:  0.05952143669128418
r_  generation:  0.5212445259094238
local_output_nid generation:  0.0386052131652832
local_in_edges_tensor generation:  0.03857254981994629
mini_batch_src_global generation:  0.06279325485229492
r_  generation:  0.5222868919372559
local_output_nid generation:  0.0387723445892334
local_in_edges_tensor generation:  0.03451681137084961
mini_batch_src_global generation:  0.06891655921936035
r_  generation:  0.5226342678070068
local_output_nid generation:  0.03877758979797363
local_in_edges_tensor generation:  0.04282236099243164
mini_batch_src_global generation:  0.058938026428222656
r_  generation:  0.5210907459259033
local_output_nid generation:  0.040093421936035156
local_in_edges_tensor generation:  0.04264044761657715
mini_batch_src_global generation:  0.058609724044799805
r_  generation:  0.5249969959259033
----------------------check_connections_block total spend ----------------------------- 6.228316307067871
generate_one_block  0.6387152671813965
generate_one_block  0.6455395221710205
generate_one_block  0.6666254997253418
generate_one_block  0.6427083015441895
generate_one_block  0.6464002132415771
generate_one_block  0.640326738357544
generate_one_block  0.6392853260040283
generate_one_block  0.7006185054779053
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  23.10519027709961
block generation total time  19.728989362716675
average batch blocks generation time:  2.4661236703395844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1263103485107422  GigaBytes
Max Memory Allocated: 0.1263103485107422  GigaBytes

torch.Size([167023, 128])
torch.Size([165841, 128])
torch.Size([161461, 128])
torch.Size([142395, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.2730402946472168  GigaBytes
Max Memory Allocated: 1.3014163970947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12911367416381836  GigaBytes
Max Memory Allocated: 1.338244915008545  GigaBytes

torch.Size([166984, 128])
torch.Size([165757, 128])
torch.Size([161425, 128])
torch.Size([142001, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.275526523590088  GigaBytes
Max Memory Allocated: 1.338244915008545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12798070907592773  GigaBytes
Max Memory Allocated: 1.3396315574645996  GigaBytes

torch.Size([166898, 128])
torch.Size([165624, 128])
torch.Size([161209, 128])
torch.Size([141924, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2721457481384277  GigaBytes
Max Memory Allocated: 1.3396315574645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.1291790008544922  GigaBytes
Max Memory Allocated: 1.3396315574645996  GigaBytes

torch.Size([166946, 128])
torch.Size([165739, 128])
torch.Size([161366, 128])
torch.Size([142112, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.276620864868164  GigaBytes
Max Memory Allocated: 1.3396315574645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12990474700927734  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166954, 128])
torch.Size([165738, 128])
torch.Size([161324, 128])
torch.Size([141736, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2744169235229492  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.1290268898010254  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166920, 128])
torch.Size([165674, 128])
torch.Size([161329, 128])
torch.Size([141808, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.2712669372558594  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.12795209884643555  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166871, 128])
torch.Size([165583, 128])
torch.Size([161058, 128])
torch.Size([141651, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.268122673034668  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.1290302276611328  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166957, 128])
torch.Size([165759, 128])
torch.Size([161438, 128])
torch.Size([142046, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.275475025177002  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08183291554450989 |0.08342942595481873 |0.09288215637207031 |0.00011178851127624512 |0.014893114566802979 |0.0032515525817871094 |
----------------------------------------------------------pseudo_mini_loss sum 5.686882972717285
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5630421
Number of first layer input nodes during this epoch:  1335553
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.21607065200805664  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0190737247467041
range selection method range initialization spend 0.011580228805541992
time for parepare:  0.018237590789794922
local_output_nid generation:  0.002767801284790039
local_in_edges_tensor generation:  0.007662296295166016
mini_batch_src_global generation:  0.003340482711791992
r_  generation:  0.037808895111083984
local_output_nid generation:  0.003174304962158203
local_in_edges_tensor generation:  0.0017080307006835938
mini_batch_src_global generation:  0.004096031188964844
r_  generation:  0.03858208656311035
local_output_nid generation:  0.0032432079315185547
local_in_edges_tensor generation:  0.001760721206665039
mini_batch_src_global generation:  0.002874612808227539
r_  generation:  0.04033946990966797
local_output_nid generation:  0.003265857696533203
local_in_edges_tensor generation:  0.001783609390258789
mini_batch_src_global generation:  0.0028810501098632812
r_  generation:  0.0402827262878418
local_output_nid generation:  0.0032579898834228516
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.0030291080474853516
r_  generation:  0.04196286201477051
local_output_nid generation:  0.0031881332397460938
local_in_edges_tensor generation:  0.0017173290252685547
mini_batch_src_global generation:  0.0032248497009277344
r_  generation:  0.04166913032531738
local_output_nid generation:  0.003211498260498047
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0031626224517822266
r_  generation:  0.04219675064086914
local_output_nid generation:  0.003178119659423828
local_in_edges_tensor generation:  0.0017077922821044922
mini_batch_src_global generation:  0.0030989646911621094
r_  generation:  0.041184186935424805
----------------------check_connections_block total spend ----------------------------- 0.4826474189758301
generate_one_block  0.054325103759765625
generate_one_block  0.05460858345031738
generate_one_block  0.05503535270690918
generate_one_block  0.054654836654663086
generate_one_block  0.055365800857543945
generate_one_block  0.05555272102355957
generate_one_block  0.05467700958251953
generate_one_block  0.05720114707946777
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03933882713317871
gen group dst list time:  0.014535903930664062
time for parepare:  0.020091772079467773
local_output_nid generation:  0.010921001434326172
local_in_edges_tensor generation:  0.03032374382019043
mini_batch_src_global generation:  0.030661821365356445
r_  generation:  0.30315732955932617
local_output_nid generation:  0.019121408462524414
local_in_edges_tensor generation:  0.027771472930908203
mini_batch_src_global generation:  0.03666281700134277
r_  generation:  0.31267881393432617
local_output_nid generation:  0.02125072479248047
local_in_edges_tensor generation:  0.023217201232910156
mini_batch_src_global generation:  0.036346435546875
r_  generation:  0.32390379905700684
local_output_nid generation:  0.02090001106262207
local_in_edges_tensor generation:  0.023828506469726562
mini_batch_src_global generation:  0.037439823150634766
r_  generation:  0.32270216941833496
local_output_nid generation:  0.02301478385925293
local_in_edges_tensor generation:  0.02044200897216797
mini_batch_src_global generation:  0.04076528549194336
r_  generation:  0.3308558464050293
local_output_nid generation:  0.02089667320251465
local_in_edges_tensor generation:  0.023380041122436523
mini_batch_src_global generation:  0.04068899154663086
r_  generation:  0.32968568801879883
local_output_nid generation:  0.020419597625732422
local_in_edges_tensor generation:  0.021555185317993164
mini_batch_src_global generation:  0.038556575775146484
r_  generation:  0.346785306930542
local_output_nid generation:  0.020277976989746094
local_in_edges_tensor generation:  0.030027151107788086
mini_batch_src_global generation:  0.0449068546295166
r_  generation:  0.31978750228881836
----------------------check_connections_block total spend ----------------------------- 3.830129861831665
generate_one_block  0.41990208625793457
generate_one_block  0.4150722026824951
generate_one_block  0.414017915725708
generate_one_block  0.40270161628723145
generate_one_block  0.41872501373291016
generate_one_block  0.44419288635253906
generate_one_block  0.41967201232910156
generate_one_block  0.4378492832183838
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05423998832702637
gen group dst list time:  0.03765439987182617
time for parepare:  0.019989013671875
local_output_nid generation:  0.027506589889526367
local_in_edges_tensor generation:  0.06381630897521973
mini_batch_src_global generation:  0.05365252494812012
r_  generation:  0.5257539749145508
local_output_nid generation:  0.03297853469848633
local_in_edges_tensor generation:  0.0527186393737793
mini_batch_src_global generation:  0.06164240837097168
r_  generation:  0.5300085544586182
local_output_nid generation:  0.03348517417907715
local_in_edges_tensor generation:  0.04517221450805664
mini_batch_src_global generation:  0.057108163833618164
r_  generation:  0.5433413982391357
local_output_nid generation:  0.03597235679626465
local_in_edges_tensor generation:  0.03982686996459961
mini_batch_src_global generation:  0.06185340881347656
r_  generation:  0.5494551658630371
local_output_nid generation:  0.03415703773498535
local_in_edges_tensor generation:  0.05191445350646973
mini_batch_src_global generation:  0.059102773666381836
r_  generation:  0.5513155460357666
local_output_nid generation:  0.034243106842041016
local_in_edges_tensor generation:  0.03676652908325195
mini_batch_src_global generation:  0.06256771087646484
r_  generation:  0.5571775436401367
local_output_nid generation:  0.0364987850189209
local_in_edges_tensor generation:  0.05331850051879883
mini_batch_src_global generation:  0.07284927368164062
r_  generation:  0.5541024208068848
local_output_nid generation:  0.03608393669128418
local_in_edges_tensor generation:  0.04425978660583496
mini_batch_src_global generation:  0.06220507621765137
r_  generation:  0.5335659980773926
----------------------check_connections_block total spend ----------------------------- 6.448132514953613
generate_one_block  0.6780595779418945
generate_one_block  0.6898825168609619
generate_one_block  0.6908979415893555
generate_one_block  0.7129063606262207
generate_one_block  0.7009451389312744
generate_one_block  0.6936280727386475
generate_one_block  0.6948413848876953
generate_one_block  0.666924238204956
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05560898780822754
gen group dst list time:  0.05057072639465332
time for parepare:  0.01874852180480957
local_output_nid generation:  0.03146958351135254
local_in_edges_tensor generation:  0.0658564567565918
mini_batch_src_global generation:  0.0505070686340332
r_  generation:  0.5440495014190674
local_output_nid generation:  0.03998303413391113
local_in_edges_tensor generation:  0.0974268913269043
mini_batch_src_global generation:  0.062413692474365234
r_  generation:  0.5465984344482422
local_output_nid generation:  0.03675985336303711
local_in_edges_tensor generation:  0.05517911911010742
mini_batch_src_global generation:  0.06596612930297852
r_  generation:  0.5594849586486816
local_output_nid generation:  0.039197683334350586
local_in_edges_tensor generation:  0.05047416687011719
mini_batch_src_global generation:  0.059021711349487305
r_  generation:  0.5498690605163574
local_output_nid generation:  0.038600921630859375
local_in_edges_tensor generation:  0.05365753173828125
mini_batch_src_global generation:  0.059056758880615234
r_  generation:  0.5527951717376709
local_output_nid generation:  0.03870034217834473
local_in_edges_tensor generation:  0.04848623275756836
mini_batch_src_global generation:  0.05923819541931152
r_  generation:  0.556401252746582
local_output_nid generation:  0.039370059967041016
local_in_edges_tensor generation:  0.03920412063598633
mini_batch_src_global generation:  0.06038951873779297
r_  generation:  0.5598101615905762
local_output_nid generation:  0.03886580467224121
local_in_edges_tensor generation:  0.043677330017089844
mini_batch_src_global generation:  0.0596005916595459
r_  generation:  0.5578060150146484
----------------------check_connections_block total spend ----------------------------- 6.719891309738159
generate_one_block  0.6884644031524658
generate_one_block  0.6854078769683838
generate_one_block  0.696713924407959
generate_one_block  0.6959934234619141
generate_one_block  0.688499927520752
generate_one_block  0.6913778781890869
generate_one_block  0.6772885322570801
generate_one_block  0.6740524768829346
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04254627227783203
gen group dst list time:  0.05291104316711426
time for parepare:  0.01953864097595215
local_output_nid generation:  0.03470039367675781
local_in_edges_tensor generation:  0.05007123947143555
mini_batch_src_global generation:  0.04563570022583008
r_  generation:  0.5017600059509277
local_output_nid generation:  0.037799835205078125
local_in_edges_tensor generation:  0.03323531150817871
mini_batch_src_global generation:  0.056815147399902344
r_  generation:  0.5123848915100098
local_output_nid generation:  0.038604736328125
local_in_edges_tensor generation:  0.03401994705200195
mini_batch_src_global generation:  0.05729174613952637
r_  generation:  0.5157971382141113
local_output_nid generation:  0.03870820999145508
local_in_edges_tensor generation:  0.03691363334655762
mini_batch_src_global generation:  0.05741763114929199
r_  generation:  0.517225980758667
local_output_nid generation:  0.04094219207763672
local_in_edges_tensor generation:  0.043747901916503906
mini_batch_src_global generation:  0.0578007698059082
r_  generation:  0.5214896202087402
local_output_nid generation:  0.03959512710571289
local_in_edges_tensor generation:  0.08443260192871094
mini_batch_src_global generation:  0.07326269149780273
r_  generation:  0.5137255191802979
local_output_nid generation:  0.042249441146850586
local_in_edges_tensor generation:  0.04339742660522461
mini_batch_src_global generation:  0.06454610824584961
r_  generation:  0.5149519443511963
local_output_nid generation:  0.04079270362854004
local_in_edges_tensor generation:  0.04428863525390625
mini_batch_src_global generation:  0.057592153549194336
r_  generation:  0.514397144317627
----------------------check_connections_block total spend ----------------------------- 6.251569509506226
generate_one_block  0.6319589614868164
generate_one_block  0.6505396366119385
generate_one_block  0.6499271392822266
generate_one_block  0.6587762832641602
generate_one_block  0.6466691493988037
generate_one_block  0.6386842727661133
generate_one_block  0.6419680118560791
generate_one_block  0.6334700584411621
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.21607065200805664  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

connection checking time:  23.249723196029663
block generation total time  19.550010204315186
average batch blocks generation time:  2.443751275539398
block dataloader generation time/epoch 45.39669442176819
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 0.13040733337402344  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166912, 128])
torch.Size([165678, 128])
torch.Size([161260, 128])
torch.Size([141918, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2030029296875 GB
    Memory Allocated: 1.275463581085205  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.1301136016845703  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166971, 128])
torch.Size([165715, 128])
torch.Size([161208, 128])
torch.Size([141811, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2759852409362793  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.13058137893676758  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166936, 128])
torch.Size([165807, 128])
torch.Size([161375, 128])
torch.Size([142196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.276167869567871  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.1300516128540039  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166962, 128])
torch.Size([165812, 128])
torch.Size([161537, 128])
torch.Size([142271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.276853084564209  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.13055658340454102  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([167039, 128])
torch.Size([165877, 128])
torch.Size([161477, 128])
torch.Size([142539, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2764978408813477  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.13010692596435547  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166978, 128])
torch.Size([165824, 128])
torch.Size([161558, 128])
torch.Size([142249, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2769432067871094  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.12907934188842773  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166998, 128])
torch.Size([165816, 128])
torch.Size([161346, 128])
torch.Size([142011, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.273881435394287  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 0.12896251678466797  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

torch.Size([166902, 128])
torch.Size([165618, 128])
torch.Size([161131, 128])
torch.Size([141297, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2049560546875 GB
    Memory Allocated: 1.2649378776550293  GigaBytes
Max Memory Allocated: 1.3418192863464355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07887911796569824 |0.03996732831001282 |0.005796879529953003 |0.00010353326797485352 |0.013383328914642334 |0.002383708953857422 |
----------------------------------------------------------pseudo_mini_loss sum 3.873356342315674
Total (block generation + training)time/epoch 46.58547616004944
Training time/epoch 1.1885616779327393
Training time without block to device /epoch 0.8688230514526367
Training time without total dataloading part /epoch 0.15665364265441895
load block tensor time/epoch 0.6310329437255859
block to device time/epoch 0.31973862648010254
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5631742
Number of first layer input nodes during this epoch:  1335698
