Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648519534.0312316
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024828433990478516
range selection method range initialization spend 0.01726222038269043
time for parepare:  0.01780223846435547
local_output_nid generation:  0.005598545074462891
local_in_edges_tensor generation:  0.0055713653564453125
mini_batch_src_global generation:  0.007699251174926758
r_  generation:  0.08308982849121094
local_output_nid generation:  0.006477832794189453
local_in_edges_tensor generation:  0.0030531883239746094
mini_batch_src_global generation:  0.008589506149291992
r_  generation:  0.09066963195800781
local_output_nid generation:  0.006751060485839844
local_in_edges_tensor generation:  0.0030901432037353516
mini_batch_src_global generation:  0.006394386291503906
r_  generation:  0.09155440330505371
local_output_nid generation:  0.006617546081542969
local_in_edges_tensor generation:  0.0030231475830078125
mini_batch_src_global generation:  0.007064104080200195
r_  generation:  0.09381580352783203
----------------------check_connections_block total spend ----------------------------- 0.5191900730133057
generate_one_block  0.10053014755249023
generate_one_block  0.10230302810668945
generate_one_block  0.1025698184967041
generate_one_block  0.10384726524353027
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03805851936340332
gen group dst list time:  0.01250147819519043
time for parepare:  0.028627395629882812
local_output_nid generation:  0.016563892364501953
local_in_edges_tensor generation:  0.036901235580444336
mini_batch_src_global generation:  0.04265737533569336
r_  generation:  0.4494020938873291
local_output_nid generation:  0.029335498809814453
local_in_edges_tensor generation:  0.04271864891052246
mini_batch_src_global generation:  0.04898715019226074
r_  generation:  0.45250654220581055
local_output_nid generation:  0.032113075256347656
local_in_edges_tensor generation:  0.03573179244995117
mini_batch_src_global generation:  0.05323171615600586
r_  generation:  0.5520744323730469
local_output_nid generation:  0.034069061279296875
local_in_edges_tensor generation:  0.05825471878051758
mini_batch_src_global generation:  0.06584286689758301
r_  generation:  0.43173813819885254
----------------------check_connections_block total spend ----------------------------- 2.789672374725342
generate_one_block  0.5912301540374756
generate_one_block  0.5654916763305664
generate_one_block  0.5562887191772461
generate_one_block  0.5471608638763428
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04665112495422363
gen group dst list time:  0.021335124969482422
time for parepare:  0.019057512283325195
local_output_nid generation:  0.04205894470214844
local_in_edges_tensor generation:  0.05388927459716797
mini_batch_src_global generation:  0.05404257774353027
r_  generation:  0.5523607730865479
local_output_nid generation:  0.039774417877197266
local_in_edges_tensor generation:  0.058110952377319336
mini_batch_src_global generation:  0.07631492614746094
r_  generation:  0.5461080074310303
local_output_nid generation:  0.03484320640563965
local_in_edges_tensor generation:  0.050823211669921875
mini_batch_src_global generation:  0.057062387466430664
r_  generation:  0.5639567375183105
local_output_nid generation:  0.034859418869018555
local_in_edges_tensor generation:  0.03852128982543945
mini_batch_src_global generation:  0.06283330917358398
r_  generation:  0.5575239658355713
----------------------check_connections_block total spend ----------------------------- 3.3275668621063232
generate_one_block  0.6990423202514648
generate_one_block  0.6954305171966553
generate_one_block  0.7447962760925293
generate_one_block  0.7102575302124023
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04066896438598633
gen group dst list time:  0.02662944793701172
time for parepare:  0.01963353157043457
local_output_nid generation:  0.03476572036743164
local_in_edges_tensor generation:  0.0588688850402832
mini_batch_src_global generation:  0.054993391036987305
r_  generation:  0.5641789436340332
local_output_nid generation:  0.038327693939208984
local_in_edges_tensor generation:  0.054592132568359375
mini_batch_src_global generation:  0.07703924179077148
r_  generation:  0.5660128593444824
local_output_nid generation:  0.03772687911987305
local_in_edges_tensor generation:  0.05222034454345703
mini_batch_src_global generation:  0.06437230110168457
r_  generation:  0.5699212551116943
local_output_nid generation:  0.037494659423828125
local_in_edges_tensor generation:  0.04607415199279785
mini_batch_src_global generation:  0.06390690803527832
r_  generation:  0.5647168159484863
----------------------check_connections_block total spend ----------------------------- 3.4097864627838135
generate_one_block  0.7152070999145508
generate_one_block  0.7264423370361328
generate_one_block  0.7122256755828857
generate_one_block  0.721921443939209
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06139779090881348
gen group dst list time:  0.024916410446166992
time for parepare:  0.019114971160888672
local_output_nid generation:  0.027883291244506836
local_in_edges_tensor generation:  0.046035051345825195
mini_batch_src_global generation:  0.04998064041137695
r_  generation:  0.5399863719940186
local_output_nid generation:  0.0354459285736084
local_in_edges_tensor generation:  0.035608530044555664
mini_batch_src_global generation:  0.06331658363342285
r_  generation:  0.5479803085327148
local_output_nid generation:  0.036139726638793945
local_in_edges_tensor generation:  0.03644680976867676
mini_batch_src_global generation:  0.06396627426147461
r_  generation:  0.5519073009490967
local_output_nid generation:  0.03653740882873535
local_in_edges_tensor generation:  0.03712654113769531
mini_batch_src_global generation:  0.06374669075012207
r_  generation:  0.5530774593353271
----------------------check_connections_block total spend ----------------------------- 3.2468881607055664
generate_one_block  0.6926188468933105
generate_one_block  0.6816835403442383
generate_one_block  0.6941177845001221
generate_one_block  0.6985592842102051
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03726911544799805
gen group dst list time:  0.027437448501586914
time for parepare:  0.02248239517211914
local_output_nid generation:  0.030879974365234375
local_in_edges_tensor generation:  0.03970813751220703
mini_batch_src_global generation:  0.04577922821044922
r_  generation:  0.5096468925476074
local_output_nid generation:  0.03546452522277832
local_in_edges_tensor generation:  0.04957175254821777
mini_batch_src_global generation:  0.0587010383605957
r_  generation:  0.5126500129699707
local_output_nid generation:  0.03980207443237305
local_in_edges_tensor generation:  0.05072617530822754
mini_batch_src_global generation:  0.05945467948913574
r_  generation:  0.5124797821044922
local_output_nid generation:  0.03668689727783203
local_in_edges_tensor generation:  0.056467294692993164
mini_batch_src_global generation:  0.07041072845458984
r_  generation:  0.5207366943359375
----------------------check_connections_block total spend ----------------------------- 3.135526657104492
generate_one_block  0.6581540107727051
generate_one_block  0.6824808120727539
generate_one_block  0.6623997688293457
generate_one_block  0.670426607131958
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

connection checking time:  15.909440517425537
block generation total time  13.4259352684021
average batch blocks generation time:  3.356483817100525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2440185546875 GB
    Memory Allocated: 0.14445829391479492  GigaBytes
Max Memory Allocated: 0.14445829391479492  GigaBytes

torch.Size([167791, 128])
torch.Size([167529, 256])
torch.Size([166891, 256])
torch.Size([164747, 256])
torch.Size([154819, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8065185546875 GB
    Memory Allocated: 3.203683376312256  GigaBytes
Max Memory Allocated: 3.2913918495178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 0.15164756774902344  GigaBytes
Max Memory Allocated: 3.394652843475342  GigaBytes

torch.Size([167765, 128])
torch.Size([167493, 256])
torch.Size([166828, 256])
torch.Size([164677, 256])
torch.Size([154799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 3.212728977203369  GigaBytes
Max Memory Allocated: 3.394652843475342  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.15202903747558594  GigaBytes
Max Memory Allocated: 3.405628204345703  GigaBytes

torch.Size([167764, 128])
torch.Size([167505, 256])
torch.Size([166887, 256])
torch.Size([164750, 256])
torch.Size([154946, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 3.2085299491882324  GigaBytes
Max Memory Allocated: 3.405628204345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.1531820297241211  GigaBytes
Max Memory Allocated: 3.405628204345703  GigaBytes

torch.Size([167761, 128])
torch.Size([167528, 256])
torch.Size([166938, 256])
torch.Size([164899, 256])
torch.Size([155204, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 3.224738597869873  GigaBytes
Max Memory Allocated: 3.405628204345703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18373751640319824 |0.1393004059791565 |0.19164055585861206 |0.0001176595687866211 |0.06912195682525635 |0.003692150115966797 |
----------------------------------------------------------pseudo_mini_loss sum 6.144949913024902
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3692901
Number of first layer input nodes during this epoch:  671081
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 0.2769594192504883  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.03437471389770508
range selection method range initialization spend 0.014764547348022461
time for parepare:  0.016655683517456055
local_output_nid generation:  0.005592823028564453
local_in_edges_tensor generation:  0.005919218063354492
mini_batch_src_global generation:  0.006498098373413086
r_  generation:  0.08305811882019043
local_output_nid generation:  0.006823539733886719
local_in_edges_tensor generation:  0.0030913352966308594
mini_batch_src_global generation:  0.008636474609375
r_  generation:  0.0897672176361084
local_output_nid generation:  0.00747370719909668
local_in_edges_tensor generation:  0.00471186637878418
mini_batch_src_global generation:  0.012053489685058594
r_  generation:  0.09551835060119629
local_output_nid generation:  0.007322788238525391
local_in_edges_tensor generation:  0.003918170928955078
mini_batch_src_global generation:  0.006996870040893555
r_  generation:  0.09480834007263184
----------------------check_connections_block total spend ----------------------------- 0.5451672077178955
generate_one_block  0.10160398483276367
generate_one_block  0.10367560386657715
generate_one_block  0.10277104377746582
generate_one_block  0.10497307777404785
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0482327938079834
gen group dst list time:  0.010960817337036133
time for parepare:  0.02094578742980957
local_output_nid generation:  0.014595985412597656
local_in_edges_tensor generation:  0.04566550254821777
mini_batch_src_global generation:  0.0408172607421875
r_  generation:  0.4119710922241211
local_output_nid generation:  0.02184772491455078
local_in_edges_tensor generation:  0.040622711181640625
mini_batch_src_global generation:  0.04758858680725098
r_  generation:  0.4243135452270508
local_output_nid generation:  0.022208690643310547
local_in_edges_tensor generation:  0.03186750411987305
mini_batch_src_global generation:  0.04918813705444336
r_  generation:  0.42499804496765137
local_output_nid generation:  0.022144556045532227
local_in_edges_tensor generation:  0.024790048599243164
mini_batch_src_global generation:  0.05463552474975586
r_  generation:  0.43651843070983887
----------------------check_connections_block total spend ----------------------------- 2.4896342754364014
generate_one_block  0.5630881786346436
generate_one_block  0.5564308166503906
generate_one_block  0.5693869590759277
generate_one_block  0.5452239513397217
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04554605484008789
gen group dst list time:  0.021017074584960938
time for parepare:  0.01908588409423828
local_output_nid generation:  0.023649215698242188
local_in_edges_tensor generation:  0.05918574333190918
mini_batch_src_global generation:  0.05342578887939453
r_  generation:  0.5369508266448975
local_output_nid generation:  0.03373575210571289
local_in_edges_tensor generation:  0.05279064178466797
mini_batch_src_global generation:  0.0665748119354248
r_  generation:  0.54732346534729
local_output_nid generation:  0.03496861457824707
local_in_edges_tensor generation:  0.04402351379394531
mini_batch_src_global generation:  0.05652451515197754
r_  generation:  0.5585131645202637
local_output_nid generation:  0.034325599670410156
local_in_edges_tensor generation:  0.0420231819152832
mini_batch_src_global generation:  0.05864310264587402
r_  generation:  0.5794994831085205
----------------------check_connections_block total spend ----------------------------- 3.31587553024292
generate_one_block  0.7039799690246582
generate_one_block  0.7119607925415039
generate_one_block  0.6950366497039795
generate_one_block  0.6988680362701416
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04199957847595215
gen group dst list time:  0.026673078536987305
time for parepare:  0.0187075138092041
local_output_nid generation:  0.02795124053955078
local_in_edges_tensor generation:  0.051767587661743164
mini_batch_src_global generation:  0.050902605056762695
r_  generation:  0.5536990165710449
local_output_nid generation:  0.035086631774902344
local_in_edges_tensor generation:  0.05550956726074219
mini_batch_src_global generation:  0.0633554458618164
r_  generation:  0.5629470348358154
local_output_nid generation:  0.03505563735961914
local_in_edges_tensor generation:  0.04192018508911133
mini_batch_src_global generation:  0.09433388710021973
r_  generation:  0.5912389755249023
local_output_nid generation:  0.037754058837890625
local_in_edges_tensor generation:  0.06852126121520996
mini_batch_src_global generation:  0.07045912742614746
r_  generation:  0.5845515727996826
----------------------check_connections_block total spend ----------------------------- 3.504225730895996
generate_one_block  0.7242081165313721
generate_one_block  0.7100212574005127
generate_one_block  0.7183516025543213
generate_one_block  0.7646963596343994
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04765033721923828
gen group dst list time:  0.027127504348754883
time for parepare:  0.021497249603271484
local_output_nid generation:  0.029956340789794922
local_in_edges_tensor generation:  0.05152606964111328
mini_batch_src_global generation:  0.052298545837402344
r_  generation:  0.5658867359161377
local_output_nid generation:  0.04005932807922363
local_in_edges_tensor generation:  0.046048641204833984
mini_batch_src_global generation:  0.06515717506408691
r_  generation:  0.5496699810028076
local_output_nid generation:  0.03798651695251465
local_in_edges_tensor generation:  0.0427248477935791
mini_batch_src_global generation:  0.06410026550292969
r_  generation:  0.5514988899230957
local_output_nid generation:  0.038430213928222656
local_in_edges_tensor generation:  0.03838753700256348
mini_batch_src_global generation:  0.06335592269897461
r_  generation:  0.554044246673584
----------------------check_connections_block total spend ----------------------------- 3.3154993057250977
generate_one_block  0.6910781860351562
generate_one_block  0.7005820274353027
generate_one_block  0.6925039291381836
generate_one_block  0.6927874088287354
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.043741464614868164
gen group dst list time:  0.024524927139282227
time for parepare:  0.01896071434020996
local_output_nid generation:  0.029326915740966797
local_in_edges_tensor generation:  0.04605436325073242
mini_batch_src_global generation:  0.04589223861694336
r_  generation:  0.5118484497070312
local_output_nid generation:  0.03679037094116211
local_in_edges_tensor generation:  0.03618192672729492
mini_batch_src_global generation:  0.058207035064697266
r_  generation:  0.521082878112793
local_output_nid generation:  0.03642916679382324
local_in_edges_tensor generation:  0.04232668876647949
mini_batch_src_global generation:  0.05831456184387207
r_  generation:  0.5214853286743164
local_output_nid generation:  0.03809809684753418
local_in_edges_tensor generation:  0.04186391830444336
mini_batch_src_global generation:  0.06173110008239746
r_  generation:  0.5217845439910889
----------------------check_connections_block total spend ----------------------------- 3.1193959712982178
generate_one_block  0.6549561023712158
generate_one_block  0.6657388210296631
generate_one_block  0.6390204429626465
generate_one_block  0.6986725330352783
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 0.2769594192504883  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

connection checking time:  15.744630813598633
block generation total time  13.396592140197754
average batch blocks generation time:  3.3491480350494385
block dataloader generation time/epoch 31.746318817138672
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 0.15773582458496094  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

torch.Size([167784, 128])
torch.Size([167553, 256])
torch.Size([166951, 256])
torch.Size([164913, 256])
torch.Size([154910, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 3.2231950759887695  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 0.15624332427978516  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

torch.Size([167781, 128])
torch.Size([167556, 256])
torch.Size([166947, 256])
torch.Size([164859, 256])
torch.Size([155172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 3.2230443954467773  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 0.1577444076538086  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

torch.Size([167743, 128])
torch.Size([167497, 256])
torch.Size([166867, 256])
torch.Size([164851, 256])
torch.Size([155191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 3.220031261444092  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 0.15618515014648438  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

torch.Size([167783, 128])
torch.Size([167547, 256])
torch.Size([166932, 256])
torch.Size([164909, 256])
torch.Size([155121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5565185546875 GB
    Memory Allocated: 3.2268619537353516  GigaBytes
Max Memory Allocated: 3.417954921722412  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18129867315292358 |0.05761522054672241 |0.013380587100982666 |0.00010126829147338867 |0.06974190473556519 |0.005659580230712891 |
----------------------------------------------------------pseudo_mini_loss sum 3.797280788421631
Total (block generation + training)time/epoch 33.325342416763306
Training time/epoch 1.578725814819336
Training time without block to device /epoch 1.3482649326324463
Training time without total dataloading part /epoch 0.33855462074279785
load block tensor time/epoch 0.7251946926116943
block to device time/epoch 0.23046088218688965
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3694241
Number of first layer input nodes during this epoch:  671091
