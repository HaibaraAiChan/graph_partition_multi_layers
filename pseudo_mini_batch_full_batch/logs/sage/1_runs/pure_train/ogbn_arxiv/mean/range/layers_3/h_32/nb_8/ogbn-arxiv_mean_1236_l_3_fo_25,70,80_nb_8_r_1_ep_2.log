Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446433.4088125
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02735447883605957
range selection method range initialization spend 0.013389348983764648
time for parepare:  0.01796698570251465
local_output_nid generation:  0.0026357173919677734
local_in_edges_tensor generation:  0.004994630813598633
mini_batch_src_global generation:  0.0037391185760498047
r_  generation:  0.04183602333068848
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.00165557861328125
mini_batch_src_global generation:  0.004564762115478516
r_  generation:  0.0422666072845459
local_output_nid generation:  0.0031082630157470703
local_in_edges_tensor generation:  0.0016674995422363281
mini_batch_src_global generation:  0.003145933151245117
r_  generation:  0.0451810359954834
local_output_nid generation:  0.0031163692474365234
local_in_edges_tensor generation:  0.0017282962799072266
mini_batch_src_global generation:  0.00658726692199707
r_  generation:  0.044141292572021484
local_output_nid generation:  0.0031287670135498047
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0033969879150390625
r_  generation:  0.04472088813781738
local_output_nid generation:  0.003107309341430664
local_in_edges_tensor generation:  0.0016865730285644531
mini_batch_src_global generation:  0.0035893917083740234
r_  generation:  0.046036720275878906
local_output_nid generation:  0.0031189918518066406
local_in_edges_tensor generation:  0.0017676353454589844
mini_batch_src_global generation:  0.0038433074951171875
r_  generation:  0.04610157012939453
local_output_nid generation:  0.0030975341796875
local_in_edges_tensor generation:  0.001667022705078125
mini_batch_src_global generation:  0.0037882328033447266
r_  generation:  0.047461748123168945
----------------------check_connections_block total spend ----------------------------- 0.5241787433624268
generate_one_block  0.06180405616760254
generate_one_block  0.06128239631652832
generate_one_block  0.062113285064697266
generate_one_block  0.06046748161315918
generate_one_block  0.06239485740661621
generate_one_block  0.06100916862487793
generate_one_block  0.061652183532714844
generate_one_block  0.06218266487121582
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0429532527923584
gen group dst list time:  0.016210317611694336
time for parepare:  0.01972651481628418
local_output_nid generation:  0.011107206344604492
local_in_edges_tensor generation:  0.03426647186279297
mini_batch_src_global generation:  0.03581666946411133
r_  generation:  0.35672950744628906
local_output_nid generation:  0.018689393997192383
local_in_edges_tensor generation:  0.032621145248413086
mini_batch_src_global generation:  0.04566073417663574
r_  generation:  0.36678266525268555
local_output_nid generation:  0.02023005485534668
local_in_edges_tensor generation:  0.031101465225219727
mini_batch_src_global generation:  0.04366302490234375
r_  generation:  0.37960314750671387
local_output_nid generation:  0.020306825637817383
local_in_edges_tensor generation:  0.02110743522644043
mini_batch_src_global generation:  0.044899702072143555
r_  generation:  0.3707442283630371
local_output_nid generation:  0.020507335662841797
local_in_edges_tensor generation:  0.02024388313293457
mini_batch_src_global generation:  0.04531979560852051
r_  generation:  0.373828649520874
local_output_nid generation:  0.020978689193725586
local_in_edges_tensor generation:  0.023224830627441406
mini_batch_src_global generation:  0.04649996757507324
r_  generation:  0.3880035877227783
local_output_nid generation:  0.020969867706298828
local_in_edges_tensor generation:  0.030539274215698242
mini_batch_src_global generation:  0.046631574630737305
r_  generation:  0.39008235931396484
local_output_nid generation:  0.021238327026367188
local_in_edges_tensor generation:  0.024769067764282227
mini_batch_src_global generation:  0.04749345779418945
r_  generation:  0.38309741020202637
----------------------check_connections_block total spend ----------------------------- 4.385807752609253
generate_one_block  0.5027561187744141
generate_one_block  0.5026419162750244
generate_one_block  0.5118389129638672
generate_one_block  0.5004370212554932
generate_one_block  0.4839611053466797
generate_one_block  0.5112807750701904
generate_one_block  0.5088260173797607
generate_one_block  0.5040326118469238
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031946659088134766
gen group dst list time:  0.03692030906677246
time for parepare:  0.019553661346435547
local_output_nid generation:  0.025732040405273438
local_in_edges_tensor generation:  0.04094958305358887
mini_batch_src_global generation:  0.04384303092956543
r_  generation:  0.47706174850463867
local_output_nid generation:  0.03614330291748047
local_in_edges_tensor generation:  0.05028367042541504
mini_batch_src_global generation:  0.055253028869628906
r_  generation:  0.48343658447265625
local_output_nid generation:  0.037256717681884766
local_in_edges_tensor generation:  0.04709482192993164
mini_batch_src_global generation:  0.054631948471069336
r_  generation:  0.48565173149108887
local_output_nid generation:  0.037534236907958984
local_in_edges_tensor generation:  0.034509897232055664
mini_batch_src_global generation:  0.05227303504943848
r_  generation:  0.4893643856048584
local_output_nid generation:  0.0379185676574707
local_in_edges_tensor generation:  0.03450202941894531
mini_batch_src_global generation:  0.05321383476257324
r_  generation:  0.49542689323425293
local_output_nid generation:  0.03840279579162598
local_in_edges_tensor generation:  0.04174041748046875
mini_batch_src_global generation:  0.057272911071777344
r_  generation:  0.4979064464569092
local_output_nid generation:  0.03804159164428711
local_in_edges_tensor generation:  0.037873029708862305
mini_batch_src_global generation:  0.054084062576293945
r_  generation:  0.5036575794219971
local_output_nid generation:  0.0391850471496582
local_in_edges_tensor generation:  0.03525376319885254
mini_batch_src_global generation:  0.054589033126831055
r_  generation:  0.49797987937927246
----------------------check_connections_block total spend ----------------------------- 5.859721422195435
generate_one_block  0.612006664276123
generate_one_block  0.6324005126953125
generate_one_block  0.6239604949951172
generate_one_block  0.6107075214385986
generate_one_block  0.604053258895874
generate_one_block  0.6275568008422852
generate_one_block  0.6473922729492188
generate_one_block  0.6133010387420654
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  10.245529174804688
block generation total time  8.997153043746948
average batch blocks generation time:  1.1246441304683685
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.0996551513671875  GigaBytes
Max Memory Allocated: 0.0996551513671875  GigaBytes

torch.Size([162043, 128])
torch.Size([145882, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.22350311279296875  GigaBytes
Max Memory Allocated: 0.22554254531860352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10166501998901367  GigaBytes
Max Memory Allocated: 0.23821544647216797  GigaBytes

torch.Size([162324, 128])
torch.Size([146232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22391033172607422  GigaBytes
Max Memory Allocated: 0.23821544647216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1020669937133789  GigaBytes
Max Memory Allocated: 0.2384943962097168  GigaBytes

torch.Size([162366, 128])
torch.Size([146142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22375965118408203  GigaBytes
Max Memory Allocated: 0.2384943962097168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10188770294189453  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

torch.Size([162142, 128])
torch.Size([145747, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22336769104003906  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10190773010253906  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

torch.Size([162060, 128])
torch.Size([145714, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22222661972045898  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10223627090454102  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

torch.Size([162349, 128])
torch.Size([146161, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22346162796020508  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10204696655273438  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

torch.Size([162131, 128])
torch.Size([146101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22376394271850586  GigaBytes
Max Memory Allocated: 0.23874330520629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1019887924194336  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

torch.Size([162214, 128])
torch.Size([145689, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22367191314697266  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03400680422782898 |0.047596275806427 |0.09322312474250793 |0.00010547041893005371 |0.01134103536605835 |0.0019655227661132812 |
----------------------------------------------------------pseudo_mini_loss sum 5.0336594581604
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3054623
Number of first layer input nodes during this epoch:  1297629
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.14755964279174805  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.031153202056884766
range selection method range initialization spend 0.011106014251708984
time for parepare:  0.017413854598999023
local_output_nid generation:  0.0027658939361572266
local_in_edges_tensor generation:  0.00481104850769043
mini_batch_src_global generation:  0.003618001937866211
r_  generation:  0.03992938995361328
local_output_nid generation:  0.0030493736267089844
local_in_edges_tensor generation:  0.0018246173858642578
mini_batch_src_global generation:  0.0045909881591796875
r_  generation:  0.04303455352783203
local_output_nid generation:  0.0031499862670898438
local_in_edges_tensor generation:  0.0017938613891601562
mini_batch_src_global generation:  0.0032939910888671875
r_  generation:  0.045102596282958984
local_output_nid generation:  0.0031800270080566406
local_in_edges_tensor generation:  0.0017845630645751953
mini_batch_src_global generation:  0.003374814987182617
r_  generation:  0.04560518264770508
local_output_nid generation:  0.003194570541381836
local_in_edges_tensor generation:  0.0018107891082763672
mini_batch_src_global generation:  0.0034983158111572266
r_  generation:  0.04658818244934082
local_output_nid generation:  0.0060002803802490234
local_in_edges_tensor generation:  0.0018470287322998047
mini_batch_src_global generation:  0.003794431686401367
r_  generation:  0.04893660545349121
local_output_nid generation:  0.003142118453979492
local_in_edges_tensor generation:  0.001798868179321289
mini_batch_src_global generation:  0.003862142562866211
r_  generation:  0.05143594741821289
local_output_nid generation:  0.003193378448486328
local_in_edges_tensor generation:  0.0018432140350341797
mini_batch_src_global generation:  0.003702402114868164
r_  generation:  0.048134565353393555
----------------------check_connections_block total spend ----------------------------- 0.5424175262451172
generate_one_block  0.06830573081970215
generate_one_block  0.06952714920043945
generate_one_block  0.06683754920959473
generate_one_block  0.06190633773803711
generate_one_block  0.0651698112487793
generate_one_block  0.06331205368041992
generate_one_block  0.06806468963623047
generate_one_block  0.06314373016357422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.08999037742614746
gen group dst list time:  0.0162808895111084
time for parepare:  0.019153356552124023
local_output_nid generation:  0.011425256729125977
local_in_edges_tensor generation:  0.05565690994262695
mini_batch_src_global generation:  0.038707733154296875
r_  generation:  0.35648083686828613
local_output_nid generation:  0.017256498336791992
local_in_edges_tensor generation:  0.03357076644897461
mini_batch_src_global generation:  0.047452688217163086
r_  generation:  0.36705970764160156
local_output_nid generation:  0.017229080200195312
local_in_edges_tensor generation:  0.029239654541015625
mini_batch_src_global generation:  0.044213294982910156
r_  generation:  0.3733401298522949
local_output_nid generation:  0.01753520965576172
local_in_edges_tensor generation:  0.025567293167114258
mini_batch_src_global generation:  0.045719146728515625
r_  generation:  0.3808572292327881
local_output_nid generation:  0.017865896224975586
local_in_edges_tensor generation:  0.024554014205932617
mini_batch_src_global generation:  0.04932427406311035
r_  generation:  0.3807837963104248
local_output_nid generation:  0.018193960189819336
local_in_edges_tensor generation:  0.028987884521484375
mini_batch_src_global generation:  0.0471041202545166
r_  generation:  0.3901388645172119
local_output_nid generation:  0.01823735237121582
local_in_edges_tensor generation:  0.026229381561279297
mini_batch_src_global generation:  0.04701352119445801
r_  generation:  0.3872358798980713
local_output_nid generation:  0.018324613571166992
local_in_edges_tensor generation:  0.025227785110473633
mini_batch_src_global generation:  0.04709911346435547
r_  generation:  0.39321446418762207
----------------------check_connections_block total spend ----------------------------- 4.437882423400879
generate_one_block  0.5030863285064697
generate_one_block  0.5191724300384521
generate_one_block  0.5044958591461182
generate_one_block  0.4947695732116699
generate_one_block  0.5332763195037842
generate_one_block  0.52113938331604
generate_one_block  0.5178513526916504
generate_one_block  0.5477511882781982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04597616195678711
gen group dst list time:  0.03911852836608887
time for parepare:  0.019552230834960938
local_output_nid generation:  0.025885343551635742
local_in_edges_tensor generation:  0.06438446044921875
mini_batch_src_global generation:  0.04833817481994629
r_  generation:  0.4861445426940918
local_output_nid generation:  0.03581523895263672
local_in_edges_tensor generation:  0.04782843589782715
mini_batch_src_global generation:  0.054941415786743164
r_  generation:  0.5159275531768799
local_output_nid generation:  0.038407325744628906
local_in_edges_tensor generation:  0.05773520469665527
mini_batch_src_global generation:  0.05872678756713867
r_  generation:  0.49378299713134766
local_output_nid generation:  0.035666465759277344
local_in_edges_tensor generation:  0.039215803146362305
mini_batch_src_global generation:  0.05373334884643555
r_  generation:  0.49819207191467285
local_output_nid generation:  0.0355989933013916
local_in_edges_tensor generation:  0.03614521026611328
mini_batch_src_global generation:  0.054023027420043945
r_  generation:  0.49840712547302246
local_output_nid generation:  0.03552055358886719
local_in_edges_tensor generation:  0.04868888854980469
mini_batch_src_global generation:  0.05391526222229004
r_  generation:  0.5174310207366943
local_output_nid generation:  0.03585243225097656
local_in_edges_tensor generation:  0.0324094295501709
mini_batch_src_global generation:  0.054421424865722656
r_  generation:  0.5054121017456055
local_output_nid generation:  0.037972450256347656
local_in_edges_tensor generation:  0.04007530212402344
mini_batch_src_global generation:  0.05796670913696289
r_  generation:  0.5083456039428711
----------------------check_connections_block total spend ----------------------------- 6.023050308227539
generate_one_block  0.6399033069610596
generate_one_block  0.6171560287475586
generate_one_block  0.6311323642730713
generate_one_block  0.6133089065551758
generate_one_block  0.6147608757019043
generate_one_block  0.627854585647583
generate_one_block  0.6409180164337158
generate_one_block  0.6245777606964111
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.14755964279174805  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

connection checking time:  10.460932731628418
block generation total time  9.151154279708862
average batch blocks generation time:  1.1438942849636078
block dataloader generation time/epoch 21.82951593399048
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1019277572631836  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

torch.Size([162120, 128])
torch.Size([145716, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22251558303833008  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10223245620727539  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

torch.Size([162221, 128])
torch.Size([145930, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22327232360839844  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1022195816040039  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

torch.Size([162208, 128])
torch.Size([146191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22376489639282227  GigaBytes
Max Memory Allocated: 0.23875856399536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1018686294555664  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

torch.Size([162040, 128])
torch.Size([145430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22243738174438477  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10232734680175781  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

torch.Size([162110, 128])
torch.Size([145568, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22329282760620117  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10222148895263672  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

torch.Size([162216, 128])
torch.Size([146043, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.2237868309020996  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.10214519500732422  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

torch.Size([162149, 128])
torch.Size([145980, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22399330139160156  GigaBytes
Max Memory Allocated: 0.23882150650024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.1020364761352539  GigaBytes
Max Memory Allocated: 0.23907470703125  GigaBytes

torch.Size([162318, 128])
torch.Size([146617, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.22408151626586914  GigaBytes
Max Memory Allocated: 0.23907470703125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03329738974571228 |0.015346646308898926 |0.0036876797676086426 |9.000301361083984e-05 |0.004209071397781372 |0.002907991409301758 |
----------------------------------------------------------pseudo_mini_loss sum 4.324470520019531
Total (block generation + training)time/epoch 22.307542085647583
Training time/epoch 0.4777393341064453
Training time without block to device /epoch 0.3549661636352539
Training time without total dataloading part /epoch 0.0668020248413086
load block tensor time/epoch 0.26637911796569824
block to device time/epoch 0.1227731704711914
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3054046
Number of first layer input nodes during this epoch:  1297382
