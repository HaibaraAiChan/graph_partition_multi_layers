Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648445955.9521668
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026419878005981445
range selection method range initialization spend 0.013070106506347656
time for parepare:  0.017986536026000977
local_output_nid generation:  0.002661466598510742
local_in_edges_tensor generation:  0.00499725341796875
mini_batch_src_global generation:  0.0037212371826171875
r_  generation:  0.04146122932434082
local_output_nid generation:  0.0030307769775390625
local_in_edges_tensor generation:  0.0016434192657470703
mini_batch_src_global generation:  0.0047037601470947266
r_  generation:  0.04163932800292969
local_output_nid generation:  0.003151416778564453
local_in_edges_tensor generation:  0.001695871353149414
mini_batch_src_global generation:  0.0030922889709472656
r_  generation:  0.042913198471069336
local_output_nid generation:  0.0031528472900390625
local_in_edges_tensor generation:  0.0017194747924804688
mini_batch_src_global generation:  0.003313302993774414
r_  generation:  0.04428577423095703
local_output_nid generation:  0.003164529800415039
local_in_edges_tensor generation:  0.0016522407531738281
mini_batch_src_global generation:  0.003343820571899414
r_  generation:  0.04449820518493652
local_output_nid generation:  0.0031516551971435547
local_in_edges_tensor generation:  0.0016889572143554688
mini_batch_src_global generation:  0.0034761428833007812
r_  generation:  0.04524707794189453
local_output_nid generation:  0.0031099319458007812
local_in_edges_tensor generation:  0.001678466796875
mini_batch_src_global generation:  0.0036482810974121094
r_  generation:  0.046286821365356445
local_output_nid generation:  0.0031371116638183594
local_in_edges_tensor generation:  0.0016829967498779297
mini_batch_src_global generation:  0.0036759376525878906
r_  generation:  0.04674053192138672
----------------------check_connections_block total spend ----------------------------- 0.5152933597564697
generate_one_block  0.061879634857177734
generate_one_block  0.06134343147277832
generate_one_block  0.06281805038452148
generate_one_block  0.06142425537109375
generate_one_block  0.06307697296142578
generate_one_block  0.0618443489074707
generate_one_block  0.06192755699157715
generate_one_block  0.06256461143493652
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039069175720214844
gen group dst list time:  0.016307830810546875
time for parepare:  0.019585132598876953
local_output_nid generation:  0.011388778686523438
local_in_edges_tensor generation:  0.029810190200805664
mini_batch_src_global generation:  0.0330042839050293
r_  generation:  0.3237922191619873
local_output_nid generation:  0.020148515701293945
local_in_edges_tensor generation:  0.029648303985595703
mini_batch_src_global generation:  0.03828573226928711
r_  generation:  0.3226938247680664
local_output_nid generation:  0.021194934844970703
local_in_edges_tensor generation:  0.02813863754272461
mini_batch_src_global generation:  0.03784942626953125
r_  generation:  0.33415699005126953
local_output_nid generation:  0.021441936492919922
local_in_edges_tensor generation:  0.019369125366210938
mini_batch_src_global generation:  0.05527448654174805
r_  generation:  0.3349032402038574
local_output_nid generation:  0.02211618423461914
local_in_edges_tensor generation:  0.01907181739807129
mini_batch_src_global generation:  0.03985595703125
r_  generation:  0.33778834342956543
local_output_nid generation:  0.022230863571166992
local_in_edges_tensor generation:  0.02519679069519043
mini_batch_src_global generation:  0.04314780235290527
r_  generation:  0.34207749366760254
local_output_nid generation:  0.022470951080322266
local_in_edges_tensor generation:  0.026067256927490234
mini_batch_src_global generation:  0.04100847244262695
r_  generation:  0.3370795249938965
local_output_nid generation:  0.02254319190979004
local_in_edges_tensor generation:  0.025557279586791992
mini_batch_src_global generation:  0.041805267333984375
r_  generation:  0.334094762802124
----------------------check_connections_block total spend ----------------------------- 3.9521424770355225
generate_one_block  0.43525242805480957
generate_one_block  0.4324026107788086
generate_one_block  0.44321393966674805
generate_one_block  0.43846607208251953
generate_one_block  0.42218947410583496
generate_one_block  0.45770764350891113
generate_one_block  0.44248414039611816
generate_one_block  0.4388465881347656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03199887275695801
gen group dst list time:  0.03748655319213867
time for parepare:  0.021006345748901367
local_output_nid generation:  0.026700973510742188
local_in_edges_tensor generation:  0.04049992561340332
mini_batch_src_global generation:  0.04626345634460449
r_  generation:  0.46546387672424316
local_output_nid generation:  0.036454200744628906
local_in_edges_tensor generation:  0.05031180381774902
mini_batch_src_global generation:  0.05370736122131348
r_  generation:  0.47810959815979004
local_output_nid generation:  0.03791999816894531
local_in_edges_tensor generation:  0.042253732681274414
mini_batch_src_global generation:  0.051035404205322266
r_  generation:  0.4870748519897461
local_output_nid generation:  0.03855729103088379
local_in_edges_tensor generation:  0.03836202621459961
mini_batch_src_global generation:  0.05413317680358887
r_  generation:  0.4904458522796631
local_output_nid generation:  0.03876972198486328
local_in_edges_tensor generation:  0.0342104434967041
mini_batch_src_global generation:  0.05316638946533203
r_  generation:  0.49280810356140137
local_output_nid generation:  0.038583993911743164
local_in_edges_tensor generation:  0.03517913818359375
mini_batch_src_global generation:  0.05815887451171875
r_  generation:  0.4900169372558594
local_output_nid generation:  0.03869891166687012
local_in_edges_tensor generation:  0.043132781982421875
mini_batch_src_global generation:  0.05358004570007324
r_  generation:  0.5034949779510498
local_output_nid generation:  0.03479814529418945
local_in_edges_tensor generation:  0.04818463325500488
mini_batch_src_global generation:  0.05771064758300781
r_  generation:  0.4892127513885498
----------------------check_connections_block total spend ----------------------------- 5.825648307800293
generate_one_block  0.6273984909057617
generate_one_block  0.626821756362915
generate_one_block  0.6343610286712646
generate_one_block  0.6205110549926758
generate_one_block  0.6224863529205322
generate_one_block  0.6278460025787354
generate_one_block  0.654728889465332
generate_one_block  0.6066164970397949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  9.777790784835815
block generation total time  8.531332969665527
average batch blocks generation time:  1.066416621208191
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09725522994995117  GigaBytes
Max Memory Allocated: 0.09725522994995117  GigaBytes

torch.Size([160789, 128])
torch.Size([142866, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.21859073638916016  GigaBytes
Max Memory Allocated: 0.22111988067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09854793548583984  GigaBytes
Max Memory Allocated: 0.23379230499267578  GigaBytes

torch.Size([161017, 128])
torch.Size([143017, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2175130844116211  GigaBytes
Max Memory Allocated: 0.23379230499267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09955120086669922  GigaBytes
Max Memory Allocated: 0.23379230499267578  GigaBytes

torch.Size([161114, 128])
torch.Size([143168, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.22028255462646484  GigaBytes
Max Memory Allocated: 0.23379230499267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09852790832519531  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160931, 128])
torch.Size([142809, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2181081771850586  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09890174865722656  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160775, 128])
torch.Size([142588, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21780109405517578  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.0996255874633789  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160966, 128])
torch.Size([143009, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2197260856628418  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09863758087158203  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160885, 128])
torch.Size([143061, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21863985061645508  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09908151626586914  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160868, 128])
torch.Size([142574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21969127655029297  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04079461097717285 |0.0559099018573761 |0.0969853401184082 |0.00010526180267333984 |0.011452823877334595 |0.0018622875213623047 |
----------------------------------------------------------pseudo_mini_loss sum 5.030546188354492
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3019738
Number of first layer input nodes during this epoch:  1287345
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.14324045181274414  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028726816177368164
range selection method range initialization spend 0.011209249496459961
time for parepare:  0.018669605255126953
local_output_nid generation:  0.002702951431274414
local_in_edges_tensor generation:  0.006106138229370117
mini_batch_src_global generation:  0.003634214401245117
r_  generation:  0.0403134822845459
local_output_nid generation:  0.0034325122833251953
local_in_edges_tensor generation:  0.001705169677734375
mini_batch_src_global generation:  0.00464177131652832
r_  generation:  0.04321789741516113
local_output_nid generation:  0.0035791397094726562
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0032329559326171875
r_  generation:  0.04816722869873047
local_output_nid generation:  0.00372314453125
local_in_edges_tensor generation:  0.0017600059509277344
mini_batch_src_global generation:  0.0034003257751464844
r_  generation:  0.045403480529785156
local_output_nid generation:  0.0036954879760742188
local_in_edges_tensor generation:  0.0017521381378173828
mini_batch_src_global generation:  0.004921436309814453
r_  generation:  0.04678821563720703
local_output_nid generation:  0.003702402114868164
local_in_edges_tensor generation:  0.0017552375793457031
mini_batch_src_global generation:  0.003740549087524414
r_  generation:  0.04986405372619629
local_output_nid generation:  0.0037109851837158203
local_in_edges_tensor generation:  0.0018029212951660156
mini_batch_src_global generation:  0.0038843154907226562
r_  generation:  0.04873180389404297
local_output_nid generation:  0.0037572383880615234
local_in_edges_tensor generation:  0.0017859935760498047
mini_batch_src_global generation:  0.003902435302734375
r_  generation:  0.047556161880493164
----------------------check_connections_block total spend ----------------------------- 0.5442314147949219
generate_one_block  0.06495046615600586
generate_one_block  0.06302571296691895
generate_one_block  0.06351757049560547
generate_one_block  0.06296443939208984
generate_one_block  0.06362318992614746
generate_one_block  0.06518769264221191
generate_one_block  0.0671229362487793
generate_one_block  0.06384706497192383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04087471961975098
gen group dst list time:  0.016327857971191406
time for parepare:  0.018999576568603516
local_output_nid generation:  0.011731624603271484
local_in_edges_tensor generation:  0.03070378303527832
mini_batch_src_global generation:  0.03250861167907715
r_  generation:  0.3249247074127197
local_output_nid generation:  0.020880460739135742
local_in_edges_tensor generation:  0.029176950454711914
mini_batch_src_global generation:  0.038477420806884766
r_  generation:  0.35277891159057617
local_output_nid generation:  0.021785974502563477
local_in_edges_tensor generation:  0.03245949745178223
mini_batch_src_global generation:  0.0415341854095459
r_  generation:  0.3468148708343506
local_output_nid generation:  0.018538236618041992
local_in_edges_tensor generation:  0.025167226791381836
mini_batch_src_global generation:  0.04048728942871094
r_  generation:  0.33071231842041016
local_output_nid generation:  0.01875615119934082
local_in_edges_tensor generation:  0.024395465850830078
mini_batch_src_global generation:  0.043032169342041016
r_  generation:  0.33592653274536133
local_output_nid generation:  0.019126176834106445
local_in_edges_tensor generation:  0.02453160285949707
mini_batch_src_global generation:  0.04136991500854492
r_  generation:  0.36215972900390625
local_output_nid generation:  0.021521568298339844
local_in_edges_tensor generation:  0.031193971633911133
mini_batch_src_global generation:  0.049753665924072266
r_  generation:  0.3412911891937256
local_output_nid generation:  0.018839120864868164
local_in_edges_tensor generation:  0.02609848976135254
mini_batch_src_global generation:  0.04215836524963379
r_  generation:  0.3484969139099121
----------------------check_connections_block total spend ----------------------------- 4.080240249633789
generate_one_block  0.46240925788879395
generate_one_block  0.44113588333129883
generate_one_block  0.43851375579833984
generate_one_block  0.4251689910888672
generate_one_block  0.4418151378631592
generate_one_block  0.4556429386138916
generate_one_block  0.44908881187438965
generate_one_block  0.46713876724243164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04545021057128906
gen group dst list time:  0.0377960205078125
time for parepare:  0.01964712142944336
local_output_nid generation:  0.02473735809326172
local_in_edges_tensor generation:  0.057193756103515625
mini_batch_src_global generation:  0.04429054260253906
r_  generation:  0.4680149555206299
local_output_nid generation:  0.0312809944152832
local_in_edges_tensor generation:  0.04817366600036621
mini_batch_src_global generation:  0.05341601371765137
r_  generation:  0.48076701164245605
local_output_nid generation:  0.031777143478393555
local_in_edges_tensor generation:  0.04069161415100098
mini_batch_src_global generation:  0.05053210258483887
r_  generation:  0.49692535400390625
local_output_nid generation:  0.0323793888092041
local_in_edges_tensor generation:  0.031792402267456055
mini_batch_src_global generation:  0.05256319046020508
r_  generation:  0.48355603218078613
local_output_nid generation:  0.03272294998168945
local_in_edges_tensor generation:  0.03194618225097656
mini_batch_src_global generation:  0.05185365676879883
r_  generation:  0.4975738525390625
local_output_nid generation:  0.03284168243408203
local_in_edges_tensor generation:  0.0408482551574707
mini_batch_src_global generation:  0.05385541915893555
r_  generation:  0.48434901237487793
local_output_nid generation:  0.03342556953430176
local_in_edges_tensor generation:  0.04110217094421387
mini_batch_src_global generation:  0.052435874938964844
r_  generation:  0.4955592155456543
local_output_nid generation:  0.037143707275390625
local_in_edges_tensor generation:  0.04075789451599121
mini_batch_src_global generation:  0.05447220802307129
r_  generation:  0.4888486862182617
----------------------check_connections_block total spend ----------------------------- 5.773576498031616
generate_one_block  0.6223719120025635
generate_one_block  0.6189382076263428
generate_one_block  0.624030351638794
generate_one_block  0.6310203075408936
generate_one_block  0.6157510280609131
generate_one_block  0.6152231693267822
generate_one_block  0.6139504909515381
generate_one_block  0.6305384635925293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.14324045181274414  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

connection checking time:  9.853816747665405
block generation total time  8.552737474441528
average batch blocks generation time:  1.069092184305191
block dataloader generation time/epoch 20.492642402648926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09944915771484375  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160795, 128])
torch.Size([142694, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2172555923461914  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09996843338012695  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160987, 128])
torch.Size([142905, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2179112434387207  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09920549392700195  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160934, 128])
torch.Size([143197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2187824249267578  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.0991058349609375  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160686, 128])
torch.Size([142254, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2182607650756836  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09964179992675781  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160748, 128])
torch.Size([142533, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2196063995361328  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09871625900268555  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160890, 128])
torch.Size([142975, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21869564056396484  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09924125671386719  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([160871, 128])
torch.Size([142947, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21907758712768555  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.09927701950073242  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

torch.Size([161033, 128])
torch.Size([143623, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.21996116638183594  GigaBytes
Max Memory Allocated: 0.2348928451538086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03910079598426819 |0.016937255859375 |0.0038190484046936035 |9.268522262573242e-05 |0.004407227039337158 |0.0018417835235595703 |
----------------------------------------------------------pseudo_mini_loss sum 4.321284770965576
Total (block generation + training)time/epoch 21.03060007095337
Training time/epoch 0.5377593040466309
Training time without block to device /epoch 0.40226125717163086
Training time without total dataloading part /epoch 0.06839346885681152
load block tensor time/epoch 0.3128063678741455
block to device time/epoch 0.135498046875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019445
Number of first layer input nodes during this epoch:  1286944
