Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446083.0878413
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028569936752319336
range selection method range initialization spend 0.013430356979370117
time for parepare:  0.018316030502319336
local_output_nid generation:  0.0007009506225585938
local_in_edges_tensor generation:  0.0035905838012695312
mini_batch_src_global generation:  0.0014607906341552734
r_  generation:  0.010181903839111328
local_output_nid generation:  0.000732421875
local_in_edges_tensor generation:  0.0005941390991210938
mini_batch_src_global generation:  0.0014188289642333984
r_  generation:  0.009462118148803711
local_output_nid generation:  0.0007143020629882812
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0009546279907226562
r_  generation:  0.009471893310546875
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.009382247924804688
local_output_nid generation:  0.0007376670837402344
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008957386016845703
r_  generation:  0.009426116943359375
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0008983612060546875
r_  generation:  0.009056806564331055
local_output_nid generation:  0.0007398128509521484
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0009195804595947266
r_  generation:  0.009671688079833984
local_output_nid generation:  0.0007402896881103516
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.009837865829467773
local_output_nid generation:  0.0008068084716796875
local_in_edges_tensor generation:  0.0005064010620117188
mini_batch_src_global generation:  0.0010046958923339844
r_  generation:  0.009799718856811523
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0009660720825195312
r_  generation:  0.009597539901733398
local_output_nid generation:  0.0007450580596923828
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.00984501838684082
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0010051727294921875
r_  generation:  0.009923696517944336
local_output_nid generation:  0.0007507801055908203
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.010107755661010742
local_output_nid generation:  0.0007646083831787109
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0010085105895996094
r_  generation:  0.009979963302612305
local_output_nid generation:  0.0007753372192382812
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0009503364562988281
r_  generation:  0.009119510650634766
local_output_nid generation:  0.0007619857788085938
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0009875297546386719
r_  generation:  0.009560346603393555
local_output_nid generation:  0.0007634162902832031
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0009753704071044922
r_  generation:  0.009746313095092773
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0009207725524902344
r_  generation:  0.009665489196777344
local_output_nid generation:  0.0007472038269042969
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0010921955108642578
r_  generation:  0.009890317916870117
local_output_nid generation:  0.0007410049438476562
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0009677410125732422
r_  generation:  0.009427309036254883
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0009646415710449219
r_  generation:  0.009692907333374023
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0010209083557128906
r_  generation:  0.00971078872680664
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.009935855865478516
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.000518798828125
mini_batch_src_global generation:  0.0010120868682861328
r_  generation:  0.010147333145141602
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.010087251663208008
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009881734848022461
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.009696483612060547
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.010325431823730469
local_output_nid generation:  0.0007762908935546875
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.010047197341918945
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0041656494140625
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.010134696960449219
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.010148048400878906
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.010132551193237305
----------------------check_connections_block total spend ----------------------------- 0.48262572288513184
generate_one_block  0.015407323837280273
generate_one_block  0.014861822128295898
generate_one_block  0.01530146598815918
generate_one_block  0.014883041381835938
generate_one_block  0.014729499816894531
generate_one_block  0.014109611511230469
generate_one_block  0.014640331268310547
generate_one_block  0.014898300170898438
generate_one_block  0.015350818634033203
generate_one_block  0.014911651611328125
generate_one_block  0.014858245849609375
generate_one_block  0.014909029006958008
generate_one_block  0.015053272247314453
generate_one_block  0.014996051788330078
generate_one_block  0.01374506950378418
generate_one_block  0.014497518539428711
generate_one_block  0.014791488647460938
generate_one_block  0.01413869857788086
generate_one_block  0.01491093635559082
generate_one_block  0.014163017272949219
generate_one_block  0.014505147933959961
generate_one_block  0.014571666717529297
generate_one_block  0.014979124069213867
generate_one_block  0.01501917839050293
generate_one_block  0.015068292617797852
generate_one_block  0.014658927917480469
generate_one_block  0.014396905899047852
generate_one_block  0.01514577865600586
generate_one_block  0.01509857177734375
generate_one_block  0.014887809753417969
generate_one_block  0.01505422592163086
generate_one_block  0.015112876892089844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04251265525817871
gen group dst list time:  0.023693561553955078
time for parepare:  0.019510269165039062
local_output_nid generation:  0.004233360290527344
local_in_edges_tensor generation:  0.012577533721923828
mini_batch_src_global generation:  0.013444662094116211
r_  generation:  0.13195252418518066
local_output_nid generation:  0.007046222686767578
local_in_edges_tensor generation:  0.011679410934448242
mini_batch_src_global generation:  0.016824722290039062
r_  generation:  0.1389017105102539
local_output_nid generation:  0.0072040557861328125
local_in_edges_tensor generation:  0.00975179672241211
mini_batch_src_global generation:  0.016231060028076172
r_  generation:  0.14609360694885254
local_output_nid generation:  0.006998300552368164
local_in_edges_tensor generation:  0.011091947555541992
mini_batch_src_global generation:  0.016930818557739258
r_  generation:  0.14348387718200684
local_output_nid generation:  0.00708770751953125
local_in_edges_tensor generation:  0.00978851318359375
mini_batch_src_global generation:  0.016925811767578125
r_  generation:  0.14567089080810547
local_output_nid generation:  0.007014751434326172
local_in_edges_tensor generation:  0.00841522216796875
mini_batch_src_global generation:  0.016684293746948242
r_  generation:  0.13825392723083496
local_output_nid generation:  0.0072803497314453125
local_in_edges_tensor generation:  0.008610010147094727
mini_batch_src_global generation:  0.018332242965698242
r_  generation:  0.1452500820159912
local_output_nid generation:  0.007338047027587891
local_in_edges_tensor generation:  0.008808374404907227
mini_batch_src_global generation:  0.018965959548950195
r_  generation:  0.14824247360229492
local_output_nid generation:  0.007550716400146484
local_in_edges_tensor generation:  0.011826038360595703
mini_batch_src_global generation:  0.018447160720825195
r_  generation:  0.15114140510559082
local_output_nid generation:  0.007418155670166016
local_in_edges_tensor generation:  0.010032176971435547
mini_batch_src_global generation:  0.018384218215942383
r_  generation:  0.14672017097473145
local_output_nid generation:  0.0074329376220703125
local_in_edges_tensor generation:  0.010279655456542969
mini_batch_src_global generation:  0.01790785789489746
r_  generation:  0.14792466163635254
local_output_nid generation:  0.007577657699584961
local_in_edges_tensor generation:  0.010327339172363281
mini_batch_src_global generation:  0.01964092254638672
r_  generation:  0.15019512176513672
local_output_nid generation:  0.007649421691894531
local_in_edges_tensor generation:  0.010634899139404297
mini_batch_src_global generation:  0.019010066986083984
r_  generation:  0.1528329849243164
local_output_nid generation:  0.0076868534088134766
local_in_edges_tensor generation:  0.011813163757324219
mini_batch_src_global generation:  0.018551349639892578
r_  generation:  0.1524803638458252
local_output_nid generation:  0.007080078125
local_in_edges_tensor generation:  0.008533477783203125
mini_batch_src_global generation:  0.01688098907470703
r_  generation:  0.1365971565246582
local_output_nid generation:  0.0074617862701416016
local_in_edges_tensor generation:  0.01025390625
mini_batch_src_global generation:  0.01873493194580078
r_  generation:  0.14818120002746582
local_output_nid generation:  0.007566928863525391
local_in_edges_tensor generation:  0.010242462158203125
mini_batch_src_global generation:  0.018015623092651367
r_  generation:  0.14771008491516113
local_output_nid generation:  0.007345438003540039
local_in_edges_tensor generation:  0.012502908706665039
mini_batch_src_global generation:  0.01757502555847168
r_  generation:  0.1426229476928711
local_output_nid generation:  0.007642030715942383
local_in_edges_tensor generation:  0.011071443557739258
mini_batch_src_global generation:  0.018266916275024414
r_  generation:  0.15113544464111328
local_output_nid generation:  0.007399797439575195
local_in_edges_tensor generation:  0.010220766067504883
mini_batch_src_global generation:  0.018015146255493164
r_  generation:  0.14785170555114746
local_output_nid generation:  0.007460594177246094
local_in_edges_tensor generation:  0.010144710540771484
mini_batch_src_global generation:  0.01791095733642578
r_  generation:  0.1455538272857666
local_output_nid generation:  0.007539987564086914
local_in_edges_tensor generation:  0.010357141494750977
mini_batch_src_global generation:  0.01865673065185547
r_  generation:  0.1484088897705078
local_output_nid generation:  0.0076410770416259766
local_in_edges_tensor generation:  0.01175069808959961
mini_batch_src_global generation:  0.01974320411682129
r_  generation:  0.15184712409973145
local_output_nid generation:  0.007816553115844727
local_in_edges_tensor generation:  0.010791540145874023
mini_batch_src_global generation:  0.020309925079345703
r_  generation:  0.15585708618164062
local_output_nid generation:  0.00780177116394043
local_in_edges_tensor generation:  0.011917352676391602
mini_batch_src_global generation:  0.019138813018798828
r_  generation:  0.15608716011047363
local_output_nid generation:  0.007610797882080078
local_in_edges_tensor generation:  0.009444236755371094
mini_batch_src_global generation:  0.018994808197021484
r_  generation:  0.14871978759765625
local_output_nid generation:  0.007550716400146484
local_in_edges_tensor generation:  0.009153127670288086
mini_batch_src_global generation:  0.021872282028198242
r_  generation:  0.15059232711791992
local_output_nid generation:  0.007778644561767578
local_in_edges_tensor generation:  0.01087498664855957
mini_batch_src_global generation:  0.019129514694213867
r_  generation:  0.1564326286315918
local_output_nid generation:  0.007880210876464844
local_in_edges_tensor generation:  0.010715007781982422
mini_batch_src_global generation:  0.018835067749023438
r_  generation:  0.15240859985351562
local_output_nid generation:  0.007847070693969727
local_in_edges_tensor generation:  0.010807514190673828
mini_batch_src_global generation:  0.018726825714111328
r_  generation:  0.15467262268066406
local_output_nid generation:  0.007669925689697266
local_in_edges_tensor generation:  0.009402751922607422
mini_batch_src_global generation:  0.018812179565429688
r_  generation:  0.1544640064239502
local_output_nid generation:  0.0077707767486572266
local_in_edges_tensor generation:  0.011888504028320312
mini_batch_src_global generation:  0.01921820640563965
r_  generation:  0.15598082542419434
----------------------check_connections_block total spend ----------------------------- 7.0290398597717285
generate_one_block  0.19042325019836426
generate_one_block  0.1848921775817871
generate_one_block  0.21518898010253906
generate_one_block  0.1931138038635254
generate_one_block  0.1869807243347168
generate_one_block  0.17676615715026855
generate_one_block  0.18364357948303223
generate_one_block  0.187347412109375
generate_one_block  0.19521141052246094
generate_one_block  0.18494129180908203
generate_one_block  0.1881701946258545
generate_one_block  0.19364523887634277
generate_one_block  0.1964397430419922
generate_one_block  0.1967179775238037
generate_one_block  0.16910219192504883
generate_one_block  0.20691895484924316
generate_one_block  0.1862173080444336
generate_one_block  0.18001580238342285
generate_one_block  0.18976545333862305
generate_one_block  0.18407416343688965
generate_one_block  0.1819911003112793
generate_one_block  0.18578624725341797
generate_one_block  0.19296693801879883
generate_one_block  0.19728779792785645
generate_one_block  0.20163869857788086
generate_one_block  0.18346381187438965
generate_one_block  0.18597817420959473
generate_one_block  0.19802427291870117
generate_one_block  0.19302654266357422
generate_one_block  0.19290924072265625
generate_one_block  0.19072437286376953
generate_one_block  0.19713997840881348
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03621268272399902
gen group dst list time:  0.09465980529785156
time for parepare:  0.018915653228759766
local_output_nid generation:  0.020254135131835938
local_in_edges_tensor generation:  0.03476238250732422
mini_batch_src_global generation:  0.0372622013092041
r_  generation:  0.3896968364715576
local_output_nid generation:  0.026828289031982422
local_in_edges_tensor generation:  0.0400698184967041
mini_batch_src_global generation:  0.04642224311828613
r_  generation:  0.39615488052368164
local_output_nid generation:  0.02744460105895996
local_in_edges_tensor generation:  0.037702322006225586
mini_batch_src_global generation:  0.046852827072143555
r_  generation:  0.40713071823120117
local_output_nid generation:  0.02568364143371582
local_in_edges_tensor generation:  0.029894113540649414
mini_batch_src_global generation:  0.048319339752197266
r_  generation:  0.40850353240966797
local_output_nid generation:  0.026019573211669922
local_in_edges_tensor generation:  0.029975414276123047
mini_batch_src_global generation:  0.048079729080200195
r_  generation:  0.40911197662353516
local_output_nid generation:  0.025620222091674805
local_in_edges_tensor generation:  0.029859066009521484
mini_batch_src_global generation:  0.04825115203857422
r_  generation:  0.3992624282836914
local_output_nid generation:  0.02587890625
local_in_edges_tensor generation:  0.030602455139160156
mini_batch_src_global generation:  0.048024654388427734
r_  generation:  0.40601277351379395
local_output_nid generation:  0.025704383850097656
local_in_edges_tensor generation:  0.030074119567871094
mini_batch_src_global generation:  0.0477452278137207
r_  generation:  0.4062519073486328
local_output_nid generation:  0.026232481002807617
local_in_edges_tensor generation:  0.03818535804748535
mini_batch_src_global generation:  0.047943830490112305
r_  generation:  0.4134955406188965
local_output_nid generation:  0.026195287704467773
local_in_edges_tensor generation:  0.030313730239868164
mini_batch_src_global generation:  0.04851055145263672
r_  generation:  0.40789365768432617
local_output_nid generation:  0.02621769905090332
local_in_edges_tensor generation:  0.02818012237548828
mini_batch_src_global generation:  0.04817914962768555
r_  generation:  0.41115522384643555
local_output_nid generation:  0.02636122703552246
local_in_edges_tensor generation:  0.030696868896484375
mini_batch_src_global generation:  0.048330068588256836
r_  generation:  0.40999770164489746
local_output_nid generation:  0.026244640350341797
local_in_edges_tensor generation:  0.03426337242126465
mini_batch_src_global generation:  0.05109357833862305
r_  generation:  0.4100759029388428
local_output_nid generation:  0.02651810646057129
local_in_edges_tensor generation:  0.03400540351867676
mini_batch_src_global generation:  0.04808521270751953
r_  generation:  0.4169008731842041
local_output_nid generation:  0.026149272918701172
local_in_edges_tensor generation:  0.026712656021118164
mini_batch_src_global generation:  0.04856276512145996
r_  generation:  0.40100860595703125
local_output_nid generation:  0.026076555252075195
local_in_edges_tensor generation:  0.02649211883544922
mini_batch_src_global generation:  0.04803299903869629
r_  generation:  0.40920162200927734
local_output_nid generation:  0.026252031326293945
local_in_edges_tensor generation:  0.03055548667907715
mini_batch_src_global generation:  0.04869794845581055
r_  generation:  0.4097459316253662
local_output_nid generation:  0.026127099990844727
local_in_edges_tensor generation:  0.030228137969970703
mini_batch_src_global generation:  0.04816436767578125
r_  generation:  0.40656232833862305
local_output_nid generation:  0.02604961395263672
local_in_edges_tensor generation:  0.044687747955322266
mini_batch_src_global generation:  0.048383474349975586
r_  generation:  0.4108145236968994
local_output_nid generation:  0.025903940200805664
local_in_edges_tensor generation:  0.02873063087463379
mini_batch_src_global generation:  0.04847097396850586
r_  generation:  0.405179500579834
local_output_nid generation:  0.026100635528564453
local_in_edges_tensor generation:  0.025002002716064453
mini_batch_src_global generation:  0.04826974868774414
r_  generation:  0.40953803062438965
local_output_nid generation:  0.026212692260742188
local_in_edges_tensor generation:  0.029196739196777344
mini_batch_src_global generation:  0.04795122146606445
r_  generation:  0.4077107906341553
local_output_nid generation:  0.026351451873779297
local_in_edges_tensor generation:  0.03899550437927246
mini_batch_src_global generation:  0.04802536964416504
r_  generation:  0.41071009635925293
local_output_nid generation:  0.02646493911743164
local_in_edges_tensor generation:  0.02515244483947754
mini_batch_src_global generation:  0.04921531677246094
r_  generation:  0.4130439758300781
local_output_nid generation:  0.02745652198791504
local_in_edges_tensor generation:  0.026238441467285156
mini_batch_src_global generation:  0.04848599433898926
r_  generation:  0.4152250289916992
local_output_nid generation:  0.026358366012573242
local_in_edges_tensor generation:  0.029099225997924805
mini_batch_src_global generation:  0.0483858585357666
r_  generation:  0.4037802219390869
local_output_nid generation:  0.026137590408325195
local_in_edges_tensor generation:  0.028785228729248047
mini_batch_src_global generation:  0.05092883110046387
r_  generation:  0.40814971923828125
local_output_nid generation:  0.026563644409179688
local_in_edges_tensor generation:  0.03264045715332031
mini_batch_src_global generation:  0.048337459564208984
r_  generation:  0.4158198833465576
local_output_nid generation:  0.026342153549194336
local_in_edges_tensor generation:  0.02978372573852539
mini_batch_src_global generation:  0.05048799514770508
r_  generation:  0.4103968143463135
local_output_nid generation:  0.026458740234375
local_in_edges_tensor generation:  0.025580406188964844
mini_batch_src_global generation:  0.049172401428222656
r_  generation:  0.40892696380615234
local_output_nid generation:  0.026314496994018555
local_in_edges_tensor generation:  0.028678417205810547
mini_batch_src_global generation:  0.04889702796936035
r_  generation:  0.4359245300292969
local_output_nid generation:  0.027384042739868164
local_in_edges_tensor generation:  0.03352975845336914
mini_batch_src_global generation:  0.049098968505859375
r_  generation:  0.4098031520843506
----------------------check_connections_block total spend ----------------------------- 19.346471309661865
generate_one_block  0.6196496486663818
generate_one_block  0.5321643352508545
generate_one_block  0.5418484210968018
generate_one_block  0.5288345813751221
generate_one_block  0.5305929183959961
generate_one_block  0.517564058303833
generate_one_block  0.5419466495513916
generate_one_block  0.5403616428375244
generate_one_block  0.5573093891143799
generate_one_block  0.5248677730560303
generate_one_block  0.5313339233398438
generate_one_block  0.5381612777709961
generate_one_block  0.5486550331115723
generate_one_block  0.5389556884765625
generate_one_block  0.5070774555206299
generate_one_block  0.5196783542633057
generate_one_block  0.5208673477172852
generate_one_block  0.5169467926025391
generate_one_block  0.5364861488342285
generate_one_block  0.5253314971923828
generate_one_block  0.5336406230926514
generate_one_block  0.5433506965637207
generate_one_block  0.5405774116516113
generate_one_block  0.5421745777130127
generate_one_block  0.5387523174285889
generate_one_block  0.517822265625
generate_one_block  0.5259685516357422
generate_one_block  0.5447261333465576
generate_one_block  0.5302765369415283
generate_one_block  0.5289771556854248
generate_one_block  0.5235390663146973
generate_one_block  0.5357685089111328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  26.375511169433594
block generation total time  23.214719772338867
average batch blocks generation time:  0.7254599928855896
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08347463607788086  GigaBytes
Max Memory Allocated: 0.08347463607788086  GigaBytes

torch.Size([146215, 128])
torch.Size([102165, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.1528921127319336  GigaBytes
Max Memory Allocated: 0.15462160110473633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475971221923828  GigaBytes
Max Memory Allocated: 0.16715240478515625  GigaBytes

torch.Size([145903, 128])
torch.Size([101630, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15359926223754883  GigaBytes
Max Memory Allocated: 0.16715240478515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476638793945312  GigaBytes
Max Memory Allocated: 0.16750812530517578  GigaBytes

torch.Size([147106, 128])
torch.Size([103891, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15439224243164062  GigaBytes
Max Memory Allocated: 0.16750812530517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145794, 128])
torch.Size([101801, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15369319915771484  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475971221923828  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146412, 128])
torch.Size([102582, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538710594177246  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08359909057617188  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146070, 128])
torch.Size([101213, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15215349197387695  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475875854492188  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146212, 128])
torch.Size([101938, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1536397933959961  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145960, 128])
torch.Size([101304, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15349626541137695  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476829528808594  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145906, 128])
torch.Size([103423, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1542525291442871  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475875854492188  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145979, 128])
torch.Size([101744, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15356683731079102  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847616195678711  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146531, 128])
torch.Size([102097, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15374231338500977  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847625732421875  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146693, 128])
torch.Size([103136, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15407609939575195  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145931, 128])
torch.Size([102659, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15404272079467773  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146666, 128])
torch.Size([103332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15416812896728516  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08337211608886719  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146314, 128])
torch.Size([100470, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1505904197692871  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475589752197266  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145788, 128])
torch.Size([101716, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15353822708129883  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475780487060547  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146008, 128])
torch.Size([101857, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1536273956298828  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08366203308105469  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146167, 128])
torch.Size([101982, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1524057388305664  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476066589355469  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146023, 128])
torch.Size([102055, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15373516082763672  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475017547607422  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145949, 128])
torch.Size([101447, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15339136123657227  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08373451232910156  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146456, 128])
torch.Size([101662, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15246009826660156  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475589752197266  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146014, 128])
torch.Size([101964, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15361261367797852  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847625732421875  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146187, 128])
torch.Size([102597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539020538330078  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146462, 128])
torch.Size([103047, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15407752990722656  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146551, 128])
torch.Size([103761, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15428495407104492  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475780487060547  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146037, 128])
torch.Size([102163, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1536874771118164  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08475399017333984  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146007, 128])
torch.Size([101481, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1535019874572754  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476734161376953  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146297, 128])
torch.Size([103378, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15418052673339844  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476448059082031  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146080, 128])
torch.Size([102422, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538858413696289  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847635269165039  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146391, 128])
torch.Size([102811, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15398263931274414  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0847625732421875  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145919, 128])
torch.Size([101888, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15368223190307617  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08476543426513672  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146525, 128])
torch.Size([102813, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15403127670288086  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027664504945278168 |0.02208714932203293 |0.02664843201637268 |0.00010148435831069946 |0.004163503646850586 |0.0017223358154296875 |
----------------------------------------------------------pseudo_mini_loss sum 5.057990074157715
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8790979
Number of first layer input nodes during this epoch:  4678553
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.11441755294799805  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024505138397216797
range selection method range initialization spend 0.011539697647094727
time for parepare:  0.017511606216430664
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.006688117980957031
mini_batch_src_global generation:  0.001615285873413086
r_  generation:  0.010027170181274414
local_output_nid generation:  0.0008416175842285156
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.009984970092773438
local_output_nid generation:  0.0007915496826171875
local_in_edges_tensor generation:  0.0005257129669189453
mini_batch_src_global generation:  0.0010700225830078125
r_  generation:  0.012020349502563477
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.0009250640869140625
r_  generation:  0.009451627731323242
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0009360313415527344
r_  generation:  0.009473323822021484
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0009522438049316406
r_  generation:  0.009676694869995117
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0009310245513916016
r_  generation:  0.010014057159423828
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.0005254745483398438
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.009697437286376953
local_output_nid generation:  0.0007581710815429688
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.010152339935302734
local_output_nid generation:  0.0007710456848144531
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0009980201721191406
r_  generation:  0.010076284408569336
local_output_nid generation:  0.0007975101470947266
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.010032415390014648
local_output_nid generation:  0.0007662773132324219
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.010210514068603516
local_output_nid generation:  0.0007784366607666016
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.010117053985595703
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.00046563148498535156
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.009858846664428711
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.0009472370147705078
r_  generation:  0.00961923599243164
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0004639625549316406
mini_batch_src_global generation:  0.0009918212890625
r_  generation:  0.009669065475463867
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.009599447250366211
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.0005109310150146484
mini_batch_src_global generation:  0.0009932518005371094
r_  generation:  0.012827634811401367
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.009812116622924805
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.001020669937133789
r_  generation:  0.01025390625
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.009877204895019531
local_output_nid generation:  0.0007693767547607422
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.010410308837890625
local_output_nid generation:  0.0007762908935546875
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0010030269622802734
r_  generation:  0.01021122932434082
local_output_nid generation:  0.0007731914520263672
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.010622739791870117
local_output_nid generation:  0.0007841587066650391
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.010082244873046875
local_output_nid generation:  0.0007762908935546875
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.001013040542602539
r_  generation:  0.010061025619506836
local_output_nid generation:  0.0007765293121337891
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.01029062271118164
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.010478973388671875
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.010654449462890625
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.00046563148498535156
mini_batch_src_global generation:  0.0010120868682861328
r_  generation:  0.00998544692993164
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0010194778442382812
r_  generation:  0.010070085525512695
local_output_nid generation:  0.0007665157318115234
local_in_edges_tensor generation:  0.0005025863647460938
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.012811660766601562
----------------------check_connections_block total spend ----------------------------- 0.49869799613952637
generate_one_block  0.029806852340698242
generate_one_block  0.01647496223449707
generate_one_block  0.014730215072631836
generate_one_block  0.014482736587524414
generate_one_block  0.014652490615844727
generate_one_block  0.014519929885864258
generate_one_block  0.014673471450805664
generate_one_block  0.014891386032104492
generate_one_block  0.015075445175170898
generate_one_block  0.015084266662597656
generate_one_block  0.014599323272705078
generate_one_block  0.017339229583740234
generate_one_block  0.014958858489990234
generate_one_block  0.01448678970336914
generate_one_block  0.014048099517822266
generate_one_block  0.014336824417114258
generate_one_block  0.014158487319946289
generate_one_block  0.015032052993774414
generate_one_block  0.014412164688110352
generate_one_block  0.015453815460205078
generate_one_block  0.014681577682495117
generate_one_block  0.014864921569824219
generate_one_block  0.015146732330322266
generate_one_block  0.015412569046020508
generate_one_block  0.014920949935913086
generate_one_block  0.014771699905395508
generate_one_block  0.015590906143188477
generate_one_block  0.015253543853759766
generate_one_block  0.015239953994750977
generate_one_block  0.01479792594909668
generate_one_block  0.014974832534790039
generate_one_block  0.015303373336791992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038759708404541016
gen group dst list time:  0.021512985229492188
time for parepare:  0.01917409896850586
local_output_nid generation:  0.0041196346282958984
local_in_edges_tensor generation:  0.017048358917236328
mini_batch_src_global generation:  0.013481378555297852
r_  generation:  0.13208842277526855
local_output_nid generation:  0.006501436233520508
local_in_edges_tensor generation:  0.011887550354003906
mini_batch_src_global generation:  0.019547224044799805
r_  generation:  0.1358928680419922
local_output_nid generation:  0.006987571716308594
local_in_edges_tensor generation:  0.03082418441772461
mini_batch_src_global generation:  0.01570868492126465
r_  generation:  0.1426677703857422
local_output_nid generation:  0.0073413848876953125
local_in_edges_tensor generation:  0.011959075927734375
mini_batch_src_global generation:  0.016345977783203125
r_  generation:  0.1427299976348877
local_output_nid generation:  0.007802248001098633
local_in_edges_tensor generation:  0.01192331314086914
mini_batch_src_global generation:  0.01732158660888672
r_  generation:  0.14447259902954102
local_output_nid generation:  0.010706901550292969
local_in_edges_tensor generation:  0.010291576385498047
mini_batch_src_global generation:  0.018126964569091797
r_  generation:  0.15321922302246094
local_output_nid generation:  0.007470369338989258
local_in_edges_tensor generation:  0.010056257247924805
mini_batch_src_global generation:  0.017888784408569336
r_  generation:  0.1517014503479004
local_output_nid generation:  0.0073277950286865234
local_in_edges_tensor generation:  0.00910496711730957
mini_batch_src_global generation:  0.018244504928588867
r_  generation:  0.1491711139678955
local_output_nid generation:  0.007743358612060547
local_in_edges_tensor generation:  0.010423660278320312
mini_batch_src_global generation:  0.01873493194580078
r_  generation:  0.15934276580810547
local_output_nid generation:  0.007891416549682617
local_in_edges_tensor generation:  0.009196758270263672
mini_batch_src_global generation:  0.018468856811523438
r_  generation:  0.15483617782592773
local_output_nid generation:  0.007876157760620117
local_in_edges_tensor generation:  0.00774383544921875
mini_batch_src_global generation:  0.017888307571411133
r_  generation:  0.1558835506439209
local_output_nid generation:  0.008079290390014648
local_in_edges_tensor generation:  0.008886098861694336
mini_batch_src_global generation:  0.020007848739624023
r_  generation:  0.15162301063537598
local_output_nid generation:  0.008249759674072266
local_in_edges_tensor generation:  0.011818170547485352
mini_batch_src_global generation:  0.01917099952697754
r_  generation:  0.15633177757263184
local_output_nid generation:  0.008962154388427734
local_in_edges_tensor generation:  0.014461278915405273
mini_batch_src_global generation:  0.02214813232421875
r_  generation:  0.1529233455657959
local_output_nid generation:  0.007930994033813477
local_in_edges_tensor generation:  0.010309457778930664
mini_batch_src_global generation:  0.026499271392822266
r_  generation:  0.14932489395141602
local_output_nid generation:  0.009213685989379883
local_in_edges_tensor generation:  0.008626461029052734
mini_batch_src_global generation:  0.020392656326293945
r_  generation:  0.1491999626159668
local_output_nid generation:  0.00836944580078125
local_in_edges_tensor generation:  0.008123397827148438
mini_batch_src_global generation:  0.018307924270629883
r_  generation:  0.14992594718933105
local_output_nid generation:  0.008663177490234375
local_in_edges_tensor generation:  0.010441303253173828
mini_batch_src_global generation:  0.019611835479736328
r_  generation:  0.15326189994812012
local_output_nid generation:  0.008311033248901367
local_in_edges_tensor generation:  0.00787210464477539
mini_batch_src_global generation:  0.01861858367919922
r_  generation:  0.16137957572937012
local_output_nid generation:  0.008639812469482422
local_in_edges_tensor generation:  0.010425329208374023
mini_batch_src_global generation:  0.01940298080444336
r_  generation:  0.15994763374328613
local_output_nid generation:  0.007982254028320312
local_in_edges_tensor generation:  0.00820302963256836
mini_batch_src_global generation:  0.018865108489990234
r_  generation:  0.15089774131774902
local_output_nid generation:  0.008132696151733398
local_in_edges_tensor generation:  0.00866842269897461
mini_batch_src_global generation:  0.023266077041625977
r_  generation:  0.15282201766967773
local_output_nid generation:  0.008098840713500977
local_in_edges_tensor generation:  0.010489702224731445
mini_batch_src_global generation:  0.02606034278869629
r_  generation:  0.15615177154541016
local_output_nid generation:  0.00824284553527832
local_in_edges_tensor generation:  0.010838508605957031
mini_batch_src_global generation:  0.02164745330810547
r_  generation:  0.16384363174438477
local_output_nid generation:  0.009227752685546875
local_in_edges_tensor generation:  0.018608808517456055
mini_batch_src_global generation:  0.02019333839416504
r_  generation:  0.15676259994506836
local_output_nid generation:  0.008110523223876953
local_in_edges_tensor generation:  0.010360956192016602
mini_batch_src_global generation:  0.018604278564453125
r_  generation:  0.1579113006591797
local_output_nid generation:  0.010142326354980469
local_in_edges_tensor generation:  0.008383035659790039
mini_batch_src_global generation:  0.020089149475097656
r_  generation:  0.15925073623657227
local_output_nid generation:  0.008209705352783203
local_in_edges_tensor generation:  0.010713577270507812
mini_batch_src_global generation:  0.01906108856201172
r_  generation:  0.15818333625793457
local_output_nid generation:  0.008149147033691406
local_in_edges_tensor generation:  0.009535789489746094
mini_batch_src_global generation:  0.019063949584960938
r_  generation:  0.15392684936523438
local_output_nid generation:  0.00796818733215332
local_in_edges_tensor generation:  0.008161544799804688
mini_batch_src_global generation:  0.018564939498901367
r_  generation:  0.15457510948181152
local_output_nid generation:  0.008021831512451172
local_in_edges_tensor generation:  0.008098602294921875
mini_batch_src_global generation:  0.01843404769897461
r_  generation:  0.15445995330810547
local_output_nid generation:  0.008160591125488281
local_in_edges_tensor generation:  0.009964466094970703
mini_batch_src_global generation:  0.018651485443115234
r_  generation:  0.15506720542907715
----------------------check_connections_block total spend ----------------------------- 7.270158767700195
generate_one_block  0.1915600299835205
generate_one_block  0.18357324600219727
generate_one_block  0.18714046478271484
generate_one_block  0.18335795402526855
generate_one_block  0.20851874351501465
generate_one_block  0.18727970123291016
generate_one_block  0.18634247779846191
generate_one_block  0.18552088737487793
generate_one_block  0.192124605178833
generate_one_block  0.18564176559448242
generate_one_block  0.18606877326965332
generate_one_block  0.1991879940032959
generate_one_block  0.199537992477417
generate_one_block  0.18800616264343262
generate_one_block  0.18244552612304688
generate_one_block  0.1835765838623047
generate_one_block  0.18106818199157715
generate_one_block  0.18835687637329102
generate_one_block  0.1863110065460205
generate_one_block  0.23613667488098145
generate_one_block  0.18735790252685547
generate_one_block  0.19148564338684082
generate_one_block  0.19103479385375977
generate_one_block  0.1975860595703125
generate_one_block  0.19528675079345703
generate_one_block  0.19100475311279297
generate_one_block  0.20221662521362305
generate_one_block  0.20124578475952148
generate_one_block  0.19304490089416504
generate_one_block  0.18970465660095215
generate_one_block  0.18642497062683105
generate_one_block  0.19580650329589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04584217071533203
gen group dst list time:  0.10755538940429688
time for parepare:  0.017615556716918945
local_output_nid generation:  0.020993947982788086
local_in_edges_tensor generation:  0.05634570121765137
mini_batch_src_global generation:  0.039255619049072266
r_  generation:  0.39272403717041016
local_output_nid generation:  0.026758432388305664
local_in_edges_tensor generation:  0.04011106491088867
mini_batch_src_global generation:  0.04638528823852539
r_  generation:  0.40074777603149414
local_output_nid generation:  0.027103185653686523
local_in_edges_tensor generation:  0.037601470947265625
mini_batch_src_global generation:  0.05006766319274902
r_  generation:  0.41024231910705566
local_output_nid generation:  0.025850534439086914
local_in_edges_tensor generation:  0.027281999588012695
mini_batch_src_global generation:  0.05007529258728027
r_  generation:  0.4069061279296875
local_output_nid generation:  0.025888681411743164
local_in_edges_tensor generation:  0.028571367263793945
mini_batch_src_global generation:  0.058415889739990234
r_  generation:  0.4164419174194336
local_output_nid generation:  0.025751352310180664
local_in_edges_tensor generation:  0.03400278091430664
mini_batch_src_global generation:  0.0479888916015625
r_  generation:  0.40877246856689453
local_output_nid generation:  0.02605462074279785
local_in_edges_tensor generation:  0.030688047409057617
mini_batch_src_global generation:  0.04755258560180664
r_  generation:  0.4176449775695801
local_output_nid generation:  0.026293039321899414
local_in_edges_tensor generation:  0.03428506851196289
mini_batch_src_global generation:  0.04800152778625488
r_  generation:  0.4110102653503418
local_output_nid generation:  0.026229381561279297
local_in_edges_tensor generation:  0.034447431564331055
mini_batch_src_global generation:  0.0477144718170166
r_  generation:  0.4257473945617676
local_output_nid generation:  0.026643753051757812
local_in_edges_tensor generation:  0.03485369682312012
mini_batch_src_global generation:  0.04888796806335449
r_  generation:  0.4174997806549072
local_output_nid generation:  0.026453256607055664
local_in_edges_tensor generation:  0.02723217010498047
mini_batch_src_global generation:  0.04809236526489258
r_  generation:  0.41426944732666016
local_output_nid generation:  0.02657628059387207
local_in_edges_tensor generation:  0.03077220916748047
mini_batch_src_global generation:  0.051398277282714844
r_  generation:  0.4136312007904053
local_output_nid generation:  0.02628302574157715
local_in_edges_tensor generation:  0.03830122947692871
mini_batch_src_global generation:  0.04796910285949707
r_  generation:  0.4226222038269043
local_output_nid generation:  0.02642059326171875
local_in_edges_tensor generation:  0.027831554412841797
mini_batch_src_global generation:  0.04941272735595703
r_  generation:  0.4114410877227783
local_output_nid generation:  0.025989055633544922
local_in_edges_tensor generation:  0.027005672454833984
mini_batch_src_global generation:  0.04755759239196777
r_  generation:  0.41100192070007324
local_output_nid generation:  0.02628922462463379
local_in_edges_tensor generation:  0.027169466018676758
mini_batch_src_global generation:  0.05149722099304199
r_  generation:  0.4207749366760254
local_output_nid generation:  0.026384830474853516
local_in_edges_tensor generation:  0.02727484703063965
mini_batch_src_global generation:  0.04770088195800781
r_  generation:  0.41444945335388184
local_output_nid generation:  0.026488304138183594
local_in_edges_tensor generation:  0.03450727462768555
mini_batch_src_global generation:  0.051180362701416016
r_  generation:  0.4199337959289551
local_output_nid generation:  0.02631378173828125
local_in_edges_tensor generation:  0.030272960662841797
mini_batch_src_global generation:  0.048151493072509766
r_  generation:  0.414776086807251
local_output_nid generation:  0.02650165557861328
local_in_edges_tensor generation:  0.03879189491271973
mini_batch_src_global generation:  0.04895949363708496
r_  generation:  0.4252035617828369
local_output_nid generation:  0.02637004852294922
local_in_edges_tensor generation:  0.027377605438232422
mini_batch_src_global generation:  0.04782891273498535
r_  generation:  0.41777729988098145
local_output_nid generation:  0.02655339241027832
local_in_edges_tensor generation:  0.027732372283935547
mini_batch_src_global generation:  0.04855704307556152
r_  generation:  0.4176170825958252
local_output_nid generation:  0.026624441146850586
local_in_edges_tensor generation:  0.03549838066101074
mini_batch_src_global generation:  0.04843759536743164
r_  generation:  0.42261242866516113
local_output_nid generation:  0.026625633239746094
local_in_edges_tensor generation:  0.04118847846984863
mini_batch_src_global generation:  0.049752235412597656
r_  generation:  0.418973445892334
local_output_nid generation:  0.026866912841796875
local_in_edges_tensor generation:  0.04006028175354004
mini_batch_src_global generation:  0.04793119430541992
r_  generation:  0.4208981990814209
local_output_nid generation:  0.026716232299804688
local_in_edges_tensor generation:  0.027637004852294922
mini_batch_src_global generation:  0.048375606536865234
r_  generation:  0.4177825450897217
local_output_nid generation:  0.02716994285583496
local_in_edges_tensor generation:  0.02782130241394043
mini_batch_src_global generation:  0.05083107948303223
r_  generation:  0.42604851722717285
local_output_nid generation:  0.02809906005859375
local_in_edges_tensor generation:  0.038872718811035156
mini_batch_src_global generation:  0.048625946044921875
r_  generation:  0.42381763458251953
local_output_nid generation:  0.027124643325805664
local_in_edges_tensor generation:  0.03557276725769043
mini_batch_src_global generation:  0.05051231384277344
r_  generation:  0.4257354736328125
local_output_nid generation:  0.026798486709594727
local_in_edges_tensor generation:  0.027840614318847656
mini_batch_src_global generation:  0.04885721206665039
r_  generation:  0.41745471954345703
local_output_nid generation:  0.027017593383789062
local_in_edges_tensor generation:  0.02747511863708496
mini_batch_src_global generation:  0.048197031021118164
r_  generation:  0.42662882804870605
local_output_nid generation:  0.026889324188232422
local_in_edges_tensor generation:  0.02762913703918457
mini_batch_src_global generation:  0.04835152626037598
r_  generation:  0.4166896343231201
----------------------check_connections_block total spend ----------------------------- 19.672337770462036
generate_one_block  0.5253620147705078
generate_one_block  0.5193736553192139
generate_one_block  0.5436437129974365
generate_one_block  0.5288689136505127
generate_one_block  0.6093378067016602
generate_one_block  0.5253636837005615
generate_one_block  0.533266544342041
generate_one_block  0.5268383026123047
generate_one_block  0.5439889430999756
generate_one_block  0.5423438549041748
generate_one_block  0.5194962024688721
generate_one_block  0.5227558612823486
generate_one_block  0.5421843528747559
generate_one_block  0.518761157989502
generate_one_block  0.5153207778930664
generate_one_block  0.5207393169403076
generate_one_block  0.5316183567047119
generate_one_block  0.5384714603424072
generate_one_block  0.526012659072876
generate_one_block  0.5485997200012207
generate_one_block  0.5204722881317139
generate_one_block  0.5203936100006104
generate_one_block  0.5404984951019287
generate_one_block  0.5440402030944824
generate_one_block  0.5541360378265381
generate_one_block  0.5214793682098389
generate_one_block  0.5788228511810303
generate_one_block  0.5967273712158203
generate_one_block  0.5703611373901367
generate_one_block  0.550703763961792
generate_one_block  0.5475094318389893
generate_one_block  0.5414564609527588
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.11441755294799805  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

connection checking time:  26.94249653816223
block generation total time  23.412903308868408
average batch blocks generation time:  0.7316532284021378
block dataloader generation time/epoch 52.87291193008423
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08382558822631836  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145616, 128])
torch.Size([101030, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1524043083190918  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08379745483398438  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145592, 128])
torch.Size([100966, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15236473083496094  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0848541259765625  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146223, 128])
torch.Size([102418, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15385723114013672  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485221862792969  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146661, 128])
torch.Size([102164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537027359008789  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485698699951172  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146217, 128])
torch.Size([101871, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15369224548339844  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146154, 128])
torch.Size([101596, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15366172790527344  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485698699951172  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146020, 128])
torch.Size([101602, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15363454818725586  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485603332519531  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146556, 128])
torch.Size([101697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15361738204956055  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486557006835938  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146232, 128])
torch.Size([102693, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15406417846679688  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146649, 128])
torch.Size([103254, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15415477752685547  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0838613510131836  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146544, 128])
torch.Size([101998, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15272188186645508  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145787, 128])
torch.Size([102124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1538848876953125  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486270904541016  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146507, 128])
torch.Size([102961, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1541423797607422  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0848541259765625  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146116, 128])
torch.Size([101665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15364694595336914  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08367729187011719  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145530, 128])
torch.Size([100157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15095806121826172  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485126495361328  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146117, 128])
torch.Size([101435, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15351629257202148  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0837850570678711  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146416, 128])
torch.Size([102057, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1525588035583496  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146113, 128])
torch.Size([102577, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15399885177612305  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0848541259765625  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146031, 128])
torch.Size([101769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15364933013916016  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.084869384765625  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146504, 128])
torch.Size([103510, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15442419052124023  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485698699951172  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146328, 128])
torch.Size([101887, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1537003517150879  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485984802246094  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146293, 128])
torch.Size([102321, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15388154983520508  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486080169677734  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146408, 128])
torch.Size([102397, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15393495559692383  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.0848703384399414  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146456, 128])
torch.Size([103227, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1543431282043457  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([145923, 128])
torch.Size([102478, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15401840209960938  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486175537109375  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146130, 128])
torch.Size([102296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15391969680786133  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08487129211425781  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146656, 128])
torch.Size([103155, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1544041633605957  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486461639404297  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

torch.Size([146797, 128])
torch.Size([103590, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15436267852783203  GigaBytes
Max Memory Allocated: 0.1692042350769043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486557006835938  GigaBytes
Max Memory Allocated: 0.169219970703125  GigaBytes

torch.Size([146777, 128])
torch.Size([104269, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15449237823486328  GigaBytes
Max Memory Allocated: 0.169219970703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485698699951172  GigaBytes
Max Memory Allocated: 0.1694340705871582  GigaBytes

torch.Size([146590, 128])
torch.Size([102683, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15395832061767578  GigaBytes
Max Memory Allocated: 0.1694340705871582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08485984802246094  GigaBytes
Max Memory Allocated: 0.1694340705871582  GigaBytes

torch.Size([146589, 128])
torch.Size([103004, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.15407800674438477  GigaBytes
Max Memory Allocated: 0.1694340705871582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.08486366271972656  GigaBytes
Max Memory Allocated: 0.1694340705871582  GigaBytes

torch.Size([146475, 128])
torch.Size([102493, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5565185546875 GB
    Memory Allocated: 0.1539902687072754  GigaBytes
Max Memory Allocated: 0.1694340705871582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028616823256015778 |0.01443733274936676 |0.003748856484889984 |9.378045797348022e-05 |0.004107654094696045 |0.0019135475158691406 |
----------------------------------------------------------pseudo_mini_loss sum 4.342334747314453
Total (block generation + training)time/epoch 54.55066204071045
Training time/epoch 1.6774392127990723
Training time without block to device /epoch 1.215444564819336
Training time without total dataloading part /epoch 0.25632286071777344
load block tensor time/epoch 0.9157383441925049
block to device time/epoch 0.46199464797973633
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8793382
Number of first layer input nodes during this epoch:  4681007
