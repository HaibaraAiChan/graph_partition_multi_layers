Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648448011.5139236
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027233362197875977
range selection method range initialization spend 0.013541460037231445
time for parepare:  0.018075227737426758
local_output_nid generation:  0.0013337135314941406
local_in_edges_tensor generation:  0.0041468143463134766
mini_batch_src_global generation:  0.001958608627319336
r_  generation:  0.020769357681274414
local_output_nid generation:  0.0014352798461914062
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.002390623092651367
r_  generation:  0.020099639892578125
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0009133815765380859
mini_batch_src_global generation:  0.0014801025390625
r_  generation:  0.018942832946777344
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.020015239715576172
local_output_nid generation:  0.0014815330505371094
local_in_edges_tensor generation:  0.0008711814880371094
mini_batch_src_global generation:  0.0015876293182373047
r_  generation:  0.020598888397216797
local_output_nid generation:  0.0015358924865722656
local_in_edges_tensor generation:  0.0009174346923828125
mini_batch_src_global generation:  0.0016982555389404297
r_  generation:  0.021050691604614258
local_output_nid generation:  0.001495361328125
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0017352104187011719
r_  generation:  0.020968914031982422
local_output_nid generation:  0.0015392303466796875
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0016934871673583984
r_  generation:  0.021648883819580078
local_output_nid generation:  0.0015048980712890625
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0017118453979492188
r_  generation:  0.02190423011779785
local_output_nid generation:  0.0014986991882324219
local_in_edges_tensor generation:  0.0009005069732666016
mini_batch_src_global generation:  0.001756429672241211
r_  generation:  0.0220491886138916
local_output_nid generation:  0.0015077590942382812
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0017371177673339844
r_  generation:  0.02128124237060547
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0017306804656982422
r_  generation:  0.021615982055664062
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.00171661376953125
r_  generation:  0.02166461944580078
local_output_nid generation:  0.001501321792602539
local_in_edges_tensor generation:  0.0008630752563476562
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.02196788787841797
local_output_nid generation:  0.00150299072265625
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.0213167667388916
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0017199516296386719
r_  generation:  0.021613597869873047
----------------------check_connections_block total spend ----------------------------- 0.5001332759857178
generate_one_block  0.03126835823059082
generate_one_block  0.031488656997680664
generate_one_block  0.031220674514770508
generate_one_block  0.03061389923095703
generate_one_block  0.030838966369628906
generate_one_block  0.031319618225097656
generate_one_block  0.031044960021972656
generate_one_block  0.03213691711425781
generate_one_block  0.032115936279296875
generate_one_block  0.031481266021728516
generate_one_block  0.030808210372924805
generate_one_block  0.030968666076660156
generate_one_block  0.030957937240600586
generate_one_block  0.03162074089050293
generate_one_block  0.030936717987060547
generate_one_block  0.0308380126953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03871631622314453
gen group dst list time:  0.02051687240600586
time for parepare:  0.020130157470703125
local_output_nid generation:  0.007590055465698242
local_in_edges_tensor generation:  0.02069377899169922
mini_batch_src_global generation:  0.021114349365234375
r_  generation:  0.21675443649291992
local_output_nid generation:  0.013705253601074219
local_in_edges_tensor generation:  0.02035212516784668
mini_batch_src_global generation:  0.026879310607910156
r_  generation:  0.22245502471923828
local_output_nid generation:  0.014326810836791992
local_in_edges_tensor generation:  0.018958568572998047
mini_batch_src_global generation:  0.02572941780090332
r_  generation:  0.2170853614807129
local_output_nid generation:  0.015035867691040039
local_in_edges_tensor generation:  0.015739917755126953
mini_batch_src_global generation:  0.027112722396850586
r_  generation:  0.22499537467956543
local_output_nid generation:  0.015269756317138672
local_in_edges_tensor generation:  0.01956772804260254
mini_batch_src_global generation:  0.028307676315307617
r_  generation:  0.23347997665405273
local_output_nid generation:  0.01593303680419922
local_in_edges_tensor generation:  0.018158912658691406
mini_batch_src_global generation:  0.0289456844329834
r_  generation:  0.23422789573669434
local_output_nid generation:  0.015964508056640625
local_in_edges_tensor generation:  0.01642584800720215
mini_batch_src_global generation:  0.029447078704833984
r_  generation:  0.23264360427856445
local_output_nid generation:  0.016135215759277344
local_in_edges_tensor generation:  0.01638507843017578
mini_batch_src_global generation:  0.031348228454589844
r_  generation:  0.23809385299682617
local_output_nid generation:  0.016373634338378906
local_in_edges_tensor generation:  0.014200210571289062
mini_batch_src_global generation:  0.029992103576660156
r_  generation:  0.23695778846740723
local_output_nid generation:  0.01651787757873535
local_in_edges_tensor generation:  0.016813993453979492
mini_batch_src_global generation:  0.029773473739624023
r_  generation:  0.24318337440490723
local_output_nid generation:  0.01617574691772461
local_in_edges_tensor generation:  0.018078088760375977
mini_batch_src_global generation:  0.029489994049072266
r_  generation:  0.24145936965942383
local_output_nid generation:  0.01620006561279297
local_in_edges_tensor generation:  0.014112234115600586
mini_batch_src_global generation:  0.02985692024230957
r_  generation:  0.2378857135772705
local_output_nid generation:  0.016431331634521484
local_in_edges_tensor generation:  0.015882492065429688
mini_batch_src_global generation:  0.030077457427978516
r_  generation:  0.23540401458740234
local_output_nid generation:  0.01626443862915039
local_in_edges_tensor generation:  0.02062368392944336
mini_batch_src_global generation:  0.029549837112426758
r_  generation:  0.23794198036193848
local_output_nid generation:  0.016277790069580078
local_in_edges_tensor generation:  0.01615428924560547
mini_batch_src_global generation:  0.029216527938842773
r_  generation:  0.23221063613891602
local_output_nid generation:  0.01628398895263672
local_in_edges_tensor generation:  0.01603388786315918
mini_batch_src_global generation:  0.0290377140045166
r_  generation:  0.2335822582244873
----------------------check_connections_block total spend ----------------------------- 5.53378438949585
generate_one_block  0.3230319023132324
generate_one_block  0.3070383071899414
generate_one_block  0.28874921798706055
generate_one_block  0.30180811882019043
generate_one_block  0.3210139274597168
generate_one_block  0.31336259841918945
generate_one_block  0.3079700469970703
generate_one_block  0.3189699649810791
generate_one_block  0.31242990493774414
generate_one_block  0.30730247497558594
generate_one_block  0.3012096881866455
generate_one_block  0.29775571823120117
generate_one_block  0.30460143089294434
generate_one_block  0.3179318904876709
generate_one_block  0.3031916618347168
generate_one_block  0.29859113693237305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03707122802734375
gen group dst list time:  0.060714006423950195
time for parepare:  0.019103527069091797
local_output_nid generation:  0.02396249771118164
local_in_edges_tensor generation:  0.03946352005004883
mini_batch_src_global generation:  0.04551982879638672
r_  generation:  0.440645694732666
local_output_nid generation:  0.029810428619384766
local_in_edges_tensor generation:  0.0451967716217041
mini_batch_src_global generation:  0.05079793930053711
r_  generation:  0.45442891120910645
local_output_nid generation:  0.029145002365112305
local_in_edges_tensor generation:  0.03439903259277344
mini_batch_src_global generation:  0.05103802680969238
r_  generation:  0.45567917823791504
local_output_nid generation:  0.030346393585205078
local_in_edges_tensor generation:  0.03825497627258301
mini_batch_src_global generation:  0.05512261390686035
r_  generation:  0.45646166801452637
local_output_nid generation:  0.030205965042114258
local_in_edges_tensor generation:  0.031103849411010742
mini_batch_src_global generation:  0.05495119094848633
r_  generation:  0.46625638008117676
local_output_nid generation:  0.030391216278076172
local_in_edges_tensor generation:  0.03502464294433594
mini_batch_src_global generation:  0.05666232109069824
r_  generation:  0.4588930606842041
local_output_nid generation:  0.030681371688842773
local_in_edges_tensor generation:  0.03475594520568848
mini_batch_src_global generation:  0.05279374122619629
r_  generation:  0.4708106517791748
local_output_nid generation:  0.03055596351623535
local_in_edges_tensor generation:  0.03413224220275879
mini_batch_src_global generation:  0.05341601371765137
r_  generation:  0.4654867649078369
local_output_nid generation:  0.030528545379638672
local_in_edges_tensor generation:  0.034792423248291016
mini_batch_src_global generation:  0.05303072929382324
r_  generation:  0.4734616279602051
local_output_nid generation:  0.03102731704711914
local_in_edges_tensor generation:  0.03993868827819824
mini_batch_src_global generation:  0.053153038024902344
r_  generation:  0.46295976638793945
local_output_nid generation:  0.03052353858947754
local_in_edges_tensor generation:  0.03049445152282715
mini_batch_src_global generation:  0.05235409736633301
r_  generation:  0.48139095306396484
local_output_nid generation:  0.030562162399291992
local_in_edges_tensor generation:  0.03199911117553711
mini_batch_src_global generation:  0.05290699005126953
r_  generation:  0.4684154987335205
local_output_nid generation:  0.031190156936645508
local_in_edges_tensor generation:  0.03211021423339844
mini_batch_src_global generation:  0.0557408332824707
r_  generation:  0.4718959331512451
local_output_nid generation:  0.03108668327331543
local_in_edges_tensor generation:  0.03483915328979492
mini_batch_src_global generation:  0.052901268005371094
r_  generation:  0.46758055686950684
local_output_nid generation:  0.030988454818725586
local_in_edges_tensor generation:  0.037825584411621094
mini_batch_src_global generation:  0.0545499324798584
r_  generation:  0.4667167663574219
local_output_nid generation:  0.03122878074645996
local_in_edges_tensor generation:  0.03663229942321777
mini_batch_src_global generation:  0.05613565444946289
r_  generation:  0.4644007682800293
----------------------check_connections_block total spend ----------------------------- 10.9559006690979
generate_one_block  0.5933640003204346
generate_one_block  0.5955030918121338
generate_one_block  0.5805971622467041
generate_one_block  0.6051294803619385
generate_one_block  0.6066913604736328
generate_one_block  0.598823070526123
generate_one_block  0.6450052261352539
generate_one_block  0.6112093925476074
generate_one_block  0.5935063362121582
generate_one_block  0.6039309501647949
generate_one_block  0.585031270980835
generate_one_block  0.5795173645019531
generate_one_block  0.5956921577453613
generate_one_block  0.5994014739990234
generate_one_block  0.5779857635498047
generate_one_block  0.58331298828125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  16.48968505859375
block generation total time  14.479659080505371
average batch blocks generation time:  0.9049786925315857
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09093523025512695  GigaBytes
Max Memory Allocated: 0.09093523025512695  GigaBytes

torch.Size([154799, 128])
torch.Size([125318, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.2568511962890625  GigaBytes
Max Memory Allocated: 0.26636314392089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09168148040771484  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155045, 128])
torch.Size([124723, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2535061836242676  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09139060974121094  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155088, 128])
torch.Size([124140, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25033044815063477  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09163284301757812  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155143, 128])
torch.Size([125288, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2538943290710449  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09171295166015625  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154831, 128])
torch.Size([124752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25359249114990234  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09179878234863281  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154920, 128])
torch.Size([125030, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2538127899169922  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09173202514648438  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155146, 128])
torch.Size([125264, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25372791290283203  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.0918893814086914  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154902, 128])
torch.Size([124688, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2552061080932617  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09187030792236328  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155078, 128])
torch.Size([125169, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25490760803222656  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09185218811035156  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155291, 128])
torch.Size([125767, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2551565170288086  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09172821044921875  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154888, 128])
torch.Size([124688, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25299072265625  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09161949157714844  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154773, 128])
torch.Size([124276, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25217676162719727  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09173870086669922  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155221, 128])
torch.Size([125124, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.254122257232666  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09183216094970703  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155002, 128])
torch.Size([125206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2544260025024414  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09161376953125  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154902, 128])
torch.Size([124407, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2520637512207031  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09168815612792969  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155169, 128])
torch.Size([125115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25412940979003906  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035060226917266846 |0.0335545539855957 |0.05046342313289642 |9.576976299285889e-05 |0.00945320725440979 |0.0036971569061279297 |
----------------------------------------------------------pseudo_mini_loss sum 5.342296123504639
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209457
Number of first layer input nodes during this epoch:  2480198
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.12721729278564453  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02624821662902832
range selection method range initialization spend 0.011373281478881836
time for parepare:  0.016399145126342773
local_output_nid generation:  0.0013768672943115234
local_in_edges_tensor generation:  0.008501052856445312
mini_batch_src_global generation:  0.0019345283508300781
r_  generation:  0.019347667694091797
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0009920597076416016
mini_batch_src_global generation:  0.002390623092651367
r_  generation:  0.020517587661743164
local_output_nid generation:  0.0015444755554199219
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0015816688537597656
r_  generation:  0.020723342895507812
local_output_nid generation:  0.0015833377838134766
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0015664100646972656
r_  generation:  0.020996570587158203
local_output_nid generation:  0.0016071796417236328
local_in_edges_tensor generation:  0.0009503364562988281
mini_batch_src_global generation:  0.0016131401062011719
r_  generation:  0.021209239959716797
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0016849040985107422
r_  generation:  0.020909786224365234
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.02072739601135254
local_output_nid generation:  0.0030052661895751953
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.0016770362854003906
r_  generation:  0.02179265022277832
local_output_nid generation:  0.001592397689819336
local_in_edges_tensor generation:  0.0008962154388427734
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.02205967903137207
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.0009000301361083984
mini_batch_src_global generation:  0.0016646385192871094
r_  generation:  0.021073579788208008
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.022301673889160156
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0009455680847167969
mini_batch_src_global generation:  0.0017445087432861328
r_  generation:  0.02167367935180664
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.0018002986907958984
r_  generation:  0.02173757553100586
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.0010266304016113281
mini_batch_src_global generation:  0.001695871353149414
r_  generation:  0.022110462188720703
local_output_nid generation:  0.0015077590942382812
local_in_edges_tensor generation:  0.0008535385131835938
mini_batch_src_global generation:  0.0017254352569580078
r_  generation:  0.02127218246459961
local_output_nid generation:  0.0015480518341064453
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0017933845520019531
r_  generation:  0.021897077560424805
----------------------check_connections_block total spend ----------------------------- 0.5088353157043457
generate_one_block  0.035268306732177734
generate_one_block  0.03147006034851074
generate_one_block  0.031579017639160156
generate_one_block  0.03205275535583496
generate_one_block  0.032361507415771484
generate_one_block  0.03288745880126953
generate_one_block  0.03087329864501953
generate_one_block  0.03228259086608887
generate_one_block  0.03326988220214844
generate_one_block  0.030586719512939453
generate_one_block  0.032439231872558594
generate_one_block  0.03181028366088867
generate_one_block  0.03193187713623047
generate_one_block  0.03156900405883789
generate_one_block  0.030832290649414062
generate_one_block  0.032488346099853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0398099422454834
gen group dst list time:  0.019149065017700195
time for parepare:  0.01895880699157715
local_output_nid generation:  0.007277727127075195
local_in_edges_tensor generation:  0.01851654052734375
mini_batch_src_global generation:  0.02094578742980957
r_  generation:  0.21086955070495605
local_output_nid generation:  0.011063098907470703
local_in_edges_tensor generation:  0.019700288772583008
mini_batch_src_global generation:  0.029056549072265625
r_  generation:  0.22274112701416016
local_output_nid generation:  0.012122869491577148
local_in_edges_tensor generation:  0.01623821258544922
mini_batch_src_global generation:  0.028380632400512695
r_  generation:  0.2275230884552002
local_output_nid generation:  0.011939764022827148
local_in_edges_tensor generation:  0.013985157012939453
mini_batch_src_global generation:  0.02789616584777832
r_  generation:  0.2274637222290039
local_output_nid generation:  0.011797428131103516
local_in_edges_tensor generation:  0.014241456985473633
mini_batch_src_global generation:  0.028474092483520508
r_  generation:  0.23064589500427246
local_output_nid generation:  0.01207113265991211
local_in_edges_tensor generation:  0.016195297241210938
mini_batch_src_global generation:  0.02829909324645996
r_  generation:  0.22853493690490723
local_output_nid generation:  0.011792898178100586
local_in_edges_tensor generation:  0.014190673828125
mini_batch_src_global generation:  0.028273344039916992
r_  generation:  0.23065805435180664
local_output_nid generation:  0.012213468551635742
local_in_edges_tensor generation:  0.01656174659729004
mini_batch_src_global generation:  0.03316140174865723
r_  generation:  0.2401878833770752
local_output_nid generation:  0.01235342025756836
local_in_edges_tensor generation:  0.02009749412536621
mini_batch_src_global generation:  0.029848814010620117
r_  generation:  0.24050688743591309
local_output_nid generation:  0.012100934982299805
local_in_edges_tensor generation:  0.012586355209350586
mini_batch_src_global generation:  0.0293886661529541
r_  generation:  0.2528369426727295
local_output_nid generation:  0.015651941299438477
local_in_edges_tensor generation:  0.025263071060180664
mini_batch_src_global generation:  0.04252743721008301
r_  generation:  0.2444002628326416
local_output_nid generation:  0.012474536895751953
local_in_edges_tensor generation:  0.016553401947021484
mini_batch_src_global generation:  0.029950857162475586
r_  generation:  0.24649739265441895
local_output_nid generation:  0.012831926345825195
local_in_edges_tensor generation:  0.012927055358886719
mini_batch_src_global generation:  0.029718399047851562
r_  generation:  0.23909401893615723
local_output_nid generation:  0.012486457824707031
local_in_edges_tensor generation:  0.014423608779907227
mini_batch_src_global generation:  0.02936577796936035
r_  generation:  0.2333393096923828
local_output_nid generation:  0.012928009033203125
local_in_edges_tensor generation:  0.014836788177490234
mini_batch_src_global generation:  0.02910447120666504
r_  generation:  0.24048185348510742
local_output_nid generation:  0.013702869415283203
local_in_edges_tensor generation:  0.02459120750427246
mini_batch_src_global generation:  0.03277897834777832
r_  generation:  0.2439112663269043
----------------------check_connections_block total spend ----------------------------- 5.564593553543091
generate_one_block  0.3167428970336914
generate_one_block  0.30080223083496094
generate_one_block  0.3139476776123047
generate_one_block  0.3174009323120117
generate_one_block  0.30700063705444336
generate_one_block  0.2935159206390381
generate_one_block  0.32268428802490234
generate_one_block  0.30954813957214355
generate_one_block  0.31722402572631836
generate_one_block  0.3052067756652832
generate_one_block  0.3224771022796631
generate_one_block  0.30692267417907715
generate_one_block  0.3157229423522949
generate_one_block  0.2987792491912842
generate_one_block  0.29860806465148926
generate_one_block  0.3063170909881592
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04669761657714844
gen group dst list time:  0.06831145286560059
time for parepare:  0.019874095916748047
local_output_nid generation:  0.0248110294342041
local_in_edges_tensor generation:  0.052109718322753906
mini_batch_src_global generation:  0.044554948806762695
r_  generation:  0.4398627281188965
local_output_nid generation:  0.029820680618286133
local_in_edges_tensor generation:  0.04672956466674805
mini_batch_src_global generation:  0.05176115036010742
r_  generation:  0.4484386444091797
local_output_nid generation:  0.02996659278869629
local_in_edges_tensor generation:  0.03971552848815918
mini_batch_src_global generation:  0.05008220672607422
r_  generation:  0.46039509773254395
local_output_nid generation:  0.030783891677856445
local_in_edges_tensor generation:  0.03489398956298828
mini_batch_src_global generation:  0.054096221923828125
r_  generation:  0.4486260414123535
local_output_nid generation:  0.030477285385131836
local_in_edges_tensor generation:  0.07807779312133789
mini_batch_src_global generation:  0.05214238166809082
r_  generation:  0.4577524662017822
local_output_nid generation:  0.0315096378326416
local_in_edges_tensor generation:  0.041532039642333984
mini_batch_src_global generation:  0.0590214729309082
r_  generation:  0.4720954895019531
local_output_nid generation:  0.03267359733581543
local_in_edges_tensor generation:  0.0383152961730957
mini_batch_src_global generation:  0.0524601936340332
r_  generation:  0.4646308422088623
local_output_nid generation:  0.03254079818725586
local_in_edges_tensor generation:  0.0421605110168457
mini_batch_src_global generation:  0.05276370048522949
r_  generation:  0.45836901664733887
local_output_nid generation:  0.031723737716674805
local_in_edges_tensor generation:  0.043491363525390625
mini_batch_src_global generation:  0.05138659477233887
r_  generation:  0.4632129669189453
local_output_nid generation:  0.03145313262939453
local_in_edges_tensor generation:  0.031928300857543945
mini_batch_src_global generation:  0.05261874198913574
r_  generation:  0.45682430267333984
local_output_nid generation:  0.03176474571228027
local_in_edges_tensor generation:  0.03568124771118164
mini_batch_src_global generation:  0.052453041076660156
r_  generation:  0.46031951904296875
local_output_nid generation:  0.03129911422729492
local_in_edges_tensor generation:  0.043909549713134766
mini_batch_src_global generation:  0.052956342697143555
r_  generation:  0.45676398277282715
local_output_nid generation:  0.032034873962402344
local_in_edges_tensor generation:  0.039911508560180664
mini_batch_src_global generation:  0.05195212364196777
r_  generation:  0.46422910690307617
local_output_nid generation:  0.03153228759765625
local_in_edges_tensor generation:  0.03148698806762695
mini_batch_src_global generation:  0.06468033790588379
r_  generation:  0.4518711566925049
local_output_nid generation:  0.031920671463012695
local_in_edges_tensor generation:  0.031648874282836914
mini_batch_src_global generation:  0.052442073822021484
r_  generation:  0.4677853584289551
local_output_nid generation:  0.03189849853515625
local_in_edges_tensor generation:  0.04754328727722168
mini_batch_src_global generation:  0.05224156379699707
r_  generation:  0.4580662250518799
----------------------check_connections_block total spend ----------------------------- 10.971110343933105
generate_one_block  0.5826880931854248
generate_one_block  0.587146520614624
generate_one_block  0.5848560333251953
generate_one_block  0.5821621417999268
generate_one_block  0.5794689655303955
generate_one_block  0.5707006454467773
generate_one_block  0.5806803703308105
generate_one_block  0.6023967266082764
generate_one_block  0.6184492111206055
generate_one_block  0.583275318145752
generate_one_block  0.594529390335083
generate_one_block  0.5815231800079346
generate_one_block  0.5913779735565186
generate_one_block  0.5702192783355713
generate_one_block  0.570850133895874
generate_one_block  0.6152422428131104
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.12721729278564453  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

connection checking time:  16.535703897476196
block generation total time  14.348466873168945
average batch blocks generation time:  0.8967791795730591
block dataloader generation time/epoch 33.18727993965149
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09191179275512695  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155013, 128])
torch.Size([125260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2542729377746582  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09195327758789062  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155147, 128])
torch.Size([124835, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25397157669067383  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09206390380859375  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154861, 128])
torch.Size([125208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2546114921569824  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09197235107421875  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154801, 128])
torch.Size([124564, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2534184455871582  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09195899963378906  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154874, 128])
torch.Size([125055, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2540102005004883  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.0918569564819336  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155036, 128])
torch.Size([124745, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2529335021972656  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.091796875  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154914, 128])
torch.Size([124367, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25191259384155273  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09202098846435547  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154969, 128])
torch.Size([125073, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2546100616455078  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09204483032226562  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155115, 128])
torch.Size([125277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25495195388793945  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09188461303710938  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154868, 128])
torch.Size([124451, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25257253646850586  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.0921487808227539  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155084, 128])
torch.Size([124990, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2559680938720703  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09192276000976562  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155122, 128])
torch.Size([125185, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2534933090209961  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09211254119873047  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155127, 128])
torch.Size([125607, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2562713623046875  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.0917959213256836  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([154717, 128])
torch.Size([123863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2516188621520996  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09186935424804688  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155138, 128])
torch.Size([124707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.25289011001586914  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.09194278717041016  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

torch.Size([155080, 128])
torch.Size([125050, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7772216796875 GB
    Memory Allocated: 0.2536931037902832  GigaBytes
Max Memory Allocated: 0.28008365631103516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03342744708061218 |0.014548540115356445 |0.0033961087465286255 |8.994340896606445e-05 |0.0036905407905578613 |0.001386880874633789 |
----------------------------------------------------------pseudo_mini_loss sum 4.097050189971924
Total (block generation + training)time/epoch 34.101388931274414
Training time/epoch 0.9138088226318359
Training time without block to device /epoch 0.6810321807861328
Training time without total dataloading part /epoch 0.11621236801147461
load block tensor time/epoch 0.5348391532897949
block to device time/epoch 0.23277664184570312
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5208721
Number of first layer input nodes during this epoch:  2479866
