Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648514695.0290222
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024988889694213867
range selection method range initialization spend 0.013136148452758789
time for parepare:  0.017850637435913086
local_output_nid generation:  0.0013725757598876953
local_in_edges_tensor generation:  0.003940582275390625
mini_batch_src_global generation:  0.0016891956329345703
r_  generation:  0.017306089401245117
local_output_nid generation:  0.0013842582702636719
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0020952224731445312
r_  generation:  0.017006635665893555
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0008542537689208984
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.01749444007873535
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008759498596191406
mini_batch_src_global generation:  0.001190185546875
r_  generation:  0.01711750030517578
local_output_nid generation:  0.0015347003936767578
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0013954639434814453
r_  generation:  0.017415761947631836
local_output_nid generation:  0.001508951187133789
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.0013270378112792969
r_  generation:  0.0178830623626709
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008893013000488281
mini_batch_src_global generation:  0.001421213150024414
r_  generation:  0.018260478973388672
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0013709068298339844
r_  generation:  0.018094301223754883
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0008161067962646484
mini_batch_src_global generation:  0.0014460086822509766
r_  generation:  0.018734455108642578
local_output_nid generation:  0.0015482902526855469
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0013623237609863281
r_  generation:  0.018903255462646484
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.001531839370727539
r_  generation:  0.019579410552978516
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0008699893951416016
mini_batch_src_global generation:  0.0015077590942382812
r_  generation:  0.018664121627807617
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0008227825164794922
mini_batch_src_global generation:  0.001477956771850586
r_  generation:  0.018604278564453125
local_output_nid generation:  0.0015442371368408203
local_in_edges_tensor generation:  0.0008509159088134766
mini_batch_src_global generation:  0.0015213489532470703
r_  generation:  0.019075632095336914
local_output_nid generation:  0.0015041828155517578
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0013332366943359375
r_  generation:  0.01830267906188965
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0008113384246826172
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.018541574478149414
----------------------check_connections_block total spend ----------------------------- 0.43899059295654297
generate_one_block  0.026781082153320312
generate_one_block  0.027401447296142578
generate_one_block  0.0271909236907959
generate_one_block  0.028632402420043945
generate_one_block  0.02706623077392578
generate_one_block  0.026984214782714844
generate_one_block  0.027029037475585938
generate_one_block  0.027360200881958008
generate_one_block  0.02772045135498047
generate_one_block  0.027837753295898438
generate_one_block  0.027542591094970703
generate_one_block  0.027178525924682617
generate_one_block  0.027161836624145508
generate_one_block  0.028005361557006836
generate_one_block  0.026436567306518555
generate_one_block  0.027147531509399414
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04187917709350586
gen group dst list time:  0.01850104331970215
time for parepare:  0.01975274085998535
local_output_nid generation:  0.006669282913208008
local_in_edges_tensor generation:  0.015928983688354492
mini_batch_src_global generation:  0.019464731216430664
r_  generation:  0.19986820220947266
local_output_nid generation:  0.011886358261108398
local_in_edges_tensor generation:  0.01934075355529785
mini_batch_src_global generation:  0.025432825088500977
r_  generation:  0.20331811904907227
local_output_nid generation:  0.012439489364624023
local_in_edges_tensor generation:  0.01801896095275879
mini_batch_src_global generation:  0.0241544246673584
r_  generation:  0.21264338493347168
local_output_nid generation:  0.012547731399536133
local_in_edges_tensor generation:  0.014212846755981445
mini_batch_src_global generation:  0.025287389755249023
r_  generation:  0.21104001998901367
local_output_nid generation:  0.012849092483520508
local_in_edges_tensor generation:  0.012618064880371094
mini_batch_src_global generation:  0.02592611312866211
r_  generation:  0.2091522216796875
local_output_nid generation:  0.013057470321655273
local_in_edges_tensor generation:  0.01609349250793457
mini_batch_src_global generation:  0.026416301727294922
r_  generation:  0.2093956470489502
local_output_nid generation:  0.013353824615478516
local_in_edges_tensor generation:  0.016481876373291016
mini_batch_src_global generation:  0.026035070419311523
r_  generation:  0.22058892250061035
local_output_nid generation:  0.01338505744934082
local_in_edges_tensor generation:  0.014893054962158203
mini_batch_src_global generation:  0.02701854705810547
r_  generation:  0.21229028701782227
local_output_nid generation:  0.013657093048095703
local_in_edges_tensor generation:  0.01885986328125
mini_batch_src_global generation:  0.028655052185058594
r_  generation:  0.21907663345336914
local_output_nid generation:  0.013663291931152344
local_in_edges_tensor generation:  0.01862168312072754
mini_batch_src_global generation:  0.027039051055908203
r_  generation:  0.2196810245513916
local_output_nid generation:  0.013808727264404297
local_in_edges_tensor generation:  0.015380620956420898
mini_batch_src_global generation:  0.02765965461730957
r_  generation:  0.22082829475402832
local_output_nid generation:  0.013654708862304688
local_in_edges_tensor generation:  0.013448238372802734
mini_batch_src_global generation:  0.027324199676513672
r_  generation:  0.21749329566955566
local_output_nid generation:  0.013848066329956055
local_in_edges_tensor generation:  0.015366077423095703
mini_batch_src_global generation:  0.027351856231689453
r_  generation:  0.22150206565856934
local_output_nid generation:  0.01391744613647461
local_in_edges_tensor generation:  0.017170190811157227
mini_batch_src_global generation:  0.027571916580200195
r_  generation:  0.21805572509765625
local_output_nid generation:  0.013701677322387695
local_in_edges_tensor generation:  0.013159513473510742
mini_batch_src_global generation:  0.02705979347229004
r_  generation:  0.2162632942199707
local_output_nid generation:  0.013806819915771484
local_in_edges_tensor generation:  0.013514518737792969
mini_batch_src_global generation:  0.0274810791015625
r_  generation:  0.21878480911254883
----------------------check_connections_block total spend ----------------------------- 5.086770296096802
generate_one_block  0.2864646911621094
generate_one_block  0.27527451515197754
generate_one_block  0.2908632755279541
generate_one_block  0.2798647880554199
generate_one_block  0.295490026473999
generate_one_block  0.2761101722717285
generate_one_block  0.283128023147583
generate_one_block  0.2784907817840576
generate_one_block  0.28542280197143555
generate_one_block  0.28916096687316895
generate_one_block  0.28556132316589355
generate_one_block  0.2781565189361572
generate_one_block  0.28427863121032715
generate_one_block  0.28198909759521484
generate_one_block  0.27071237564086914
generate_one_block  0.28150510787963867
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04597878456115723
gen group dst list time:  0.06148815155029297
time for parepare:  0.019350767135620117
local_output_nid generation:  0.02353835105895996
local_in_edges_tensor generation:  0.04069638252258301
mini_batch_src_global generation:  0.04972267150878906
r_  generation:  0.4866981506347656
local_output_nid generation:  0.029244422912597656
local_in_edges_tensor generation:  0.05388665199279785
mini_batch_src_global generation:  0.057385921478271484
r_  generation:  0.49993467330932617
local_output_nid generation:  0.03070998191833496
local_in_edges_tensor generation:  0.0527491569519043
mini_batch_src_global generation:  0.057704925537109375
r_  generation:  0.5288865566253662
local_output_nid generation:  0.031099319458007812
local_in_edges_tensor generation:  0.04610276222229004
mini_batch_src_global generation:  0.061429738998413086
r_  generation:  0.5294468402862549
local_output_nid generation:  0.03038763999938965
local_in_edges_tensor generation:  0.04125237464904785
mini_batch_src_global generation:  0.05983924865722656
r_  generation:  0.5254271030426025
local_output_nid generation:  0.03349947929382324
local_in_edges_tensor generation:  0.035710811614990234
mini_batch_src_global generation:  0.07265210151672363
r_  generation:  0.5013442039489746
local_output_nid generation:  0.03081345558166504
local_in_edges_tensor generation:  0.038163185119628906
mini_batch_src_global generation:  0.061127424240112305
r_  generation:  0.5039925575256348
local_output_nid generation:  0.030811786651611328
local_in_edges_tensor generation:  0.030736207962036133
mini_batch_src_global generation:  0.0587611198425293
r_  generation:  0.5003767013549805
local_output_nid generation:  0.030574560165405273
local_in_edges_tensor generation:  0.03569626808166504
mini_batch_src_global generation:  0.058142662048339844
r_  generation:  0.5172436237335205
local_output_nid generation:  0.03103327751159668
local_in_edges_tensor generation:  0.0350034236907959
mini_batch_src_global generation:  0.05963492393493652
r_  generation:  0.5106661319732666
local_output_nid generation:  0.03124833106994629
local_in_edges_tensor generation:  0.0350494384765625
mini_batch_src_global generation:  0.059438467025756836
r_  generation:  0.5223345756530762
local_output_nid generation:  0.03147268295288086
local_in_edges_tensor generation:  0.03618907928466797
mini_batch_src_global generation:  0.05847668647766113
r_  generation:  0.5092577934265137
local_output_nid generation:  0.03186941146850586
local_in_edges_tensor generation:  0.040860891342163086
mini_batch_src_global generation:  0.0577845573425293
r_  generation:  0.5170257091522217
local_output_nid generation:  0.032769203186035156
local_in_edges_tensor generation:  0.04202890396118164
mini_batch_src_global generation:  0.059027671813964844
r_  generation:  0.5158429145812988
local_output_nid generation:  0.030978679656982422
local_in_edges_tensor generation:  0.03890061378479004
mini_batch_src_global generation:  0.05841946601867676
r_  generation:  0.5259709358215332
local_output_nid generation:  0.033127546310424805
local_in_edges_tensor generation:  0.048819780349731445
mini_batch_src_global generation:  0.058734893798828125
r_  generation:  0.5032172203063965
----------------------check_connections_block total spend ----------------------------- 12.07968544960022
generate_one_block  0.6579103469848633
generate_one_block  0.6611909866333008
generate_one_block  0.6764357089996338
generate_one_block  0.6574575901031494
generate_one_block  0.6469156742095947
generate_one_block  0.6450552940368652
generate_one_block  0.7115554809570312
generate_one_block  0.6412956714630127
generate_one_block  0.6608932018280029
generate_one_block  0.656123161315918
generate_one_block  0.6384949684143066
generate_one_block  0.644500732421875
generate_one_block  0.661200761795044
generate_one_block  0.67734694480896
generate_one_block  0.6663382053375244
generate_one_block  0.6569957733154297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.1174461841583252
gen group dst list time:  0.1035614013671875
time for parepare:  0.019533872604370117
local_output_nid generation:  0.03164315223693848
local_in_edges_tensor generation:  0.05151963233947754
mini_batch_src_global generation:  0.05393695831298828
r_  generation:  0.5497267246246338
local_output_nid generation:  0.03704023361206055
local_in_edges_tensor generation:  0.05806875228881836
mini_batch_src_global generation:  0.06334042549133301
r_  generation:  0.5526614189147949
local_output_nid generation:  0.0372624397277832
local_in_edges_tensor generation:  0.05751633644104004
mini_batch_src_global generation:  0.05849051475524902
r_  generation:  0.5698742866516113
local_output_nid generation:  0.03948259353637695
local_in_edges_tensor generation:  0.055522918701171875
mini_batch_src_global generation:  0.06736016273498535
r_  generation:  0.5523269176483154
local_output_nid generation:  0.038399696350097656
local_in_edges_tensor generation:  0.04909062385559082
mini_batch_src_global generation:  0.062470436096191406
r_  generation:  0.56089186668396
local_output_nid generation:  0.038085222244262695
local_in_edges_tensor generation:  0.03607344627380371
mini_batch_src_global generation:  0.0606226921081543
r_  generation:  0.5724358558654785
local_output_nid generation:  0.038720130920410156
local_in_edges_tensor generation:  0.038179636001586914
mini_batch_src_global generation:  0.060396671295166016
r_  generation:  0.5728075504302979
local_output_nid generation:  0.03813791275024414
local_in_edges_tensor generation:  0.046098947525024414
mini_batch_src_global generation:  0.06119942665100098
r_  generation:  0.5631177425384521
local_output_nid generation:  0.0395512580871582
local_in_edges_tensor generation:  0.04339194297790527
mini_batch_src_global generation:  0.06593203544616699
r_  generation:  0.5720899105072021
local_output_nid generation:  0.0410919189453125
local_in_edges_tensor generation:  0.0553743839263916
mini_batch_src_global generation:  0.06402373313903809
r_  generation:  0.5837748050689697
local_output_nid generation:  0.040694236755371094
local_in_edges_tensor generation:  0.04519915580749512
mini_batch_src_global generation:  0.06838703155517578
r_  generation:  0.5698199272155762
local_output_nid generation:  0.03903841972351074
local_in_edges_tensor generation:  0.042708635330200195
mini_batch_src_global generation:  0.06277894973754883
r_  generation:  0.5683188438415527
local_output_nid generation:  0.03840517997741699
local_in_edges_tensor generation:  0.0424647331237793
mini_batch_src_global generation:  0.060999155044555664
r_  generation:  0.5694031715393066
local_output_nid generation:  0.03875088691711426
local_in_edges_tensor generation:  0.04495048522949219
mini_batch_src_global generation:  0.062082767486572266
r_  generation:  0.567936897277832
local_output_nid generation:  0.03864622116088867
local_in_edges_tensor generation:  0.034865617752075195
mini_batch_src_global generation:  0.06288623809814453
r_  generation:  0.5719401836395264
local_output_nid generation:  0.03868532180786133
local_in_edges_tensor generation:  0.03440523147583008
mini_batch_src_global generation:  0.06294989585876465
r_  generation:  0.5687160491943359
----------------------check_connections_block total spend ----------------------------- 13.567640781402588
generate_one_block  0.6939013004302979
generate_one_block  0.715458869934082
generate_one_block  0.6954953670501709
generate_one_block  0.79453444480896
generate_one_block  0.7085957527160645
generate_one_block  0.688361406326294
generate_one_block  0.701603889465332
generate_one_block  0.7136406898498535
generate_one_block  0.7076377868652344
generate_one_block  0.7092735767364502
generate_one_block  0.7064592838287354
generate_one_block  0.7116079330444336
generate_one_block  0.7016394138336182
generate_one_block  0.7077586650848389
generate_one_block  0.6980805397033691
generate_one_block  0.6896917819976807
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.039197444915771484
gen group dst list time:  0.10547327995300293
time for parepare:  0.019318103790283203
local_output_nid generation:  0.034856557846069336
local_in_edges_tensor generation:  0.056148529052734375
mini_batch_src_global generation:  0.04920625686645508
r_  generation:  0.5513877868652344
local_output_nid generation:  0.0406031608581543
local_in_edges_tensor generation:  0.03674650192260742
mini_batch_src_global generation:  0.06248974800109863
r_  generation:  0.5554599761962891
local_output_nid generation:  0.03911232948303223
local_in_edges_tensor generation:  0.03578901290893555
mini_batch_src_global generation:  0.06321978569030762
r_  generation:  0.5546092987060547
local_output_nid generation:  0.03903651237487793
local_in_edges_tensor generation:  0.03540778160095215
mini_batch_src_global generation:  0.061292171478271484
r_  generation:  0.5459272861480713
local_output_nid generation:  0.0393824577331543
local_in_edges_tensor generation:  0.03584432601928711
mini_batch_src_global generation:  0.06174612045288086
r_  generation:  0.5486042499542236
local_output_nid generation:  0.03943014144897461
local_in_edges_tensor generation:  0.0406804084777832
mini_batch_src_global generation:  0.06167721748352051
r_  generation:  0.5468006134033203
local_output_nid generation:  0.03934502601623535
local_in_edges_tensor generation:  0.04015803337097168
mini_batch_src_global generation:  0.06548953056335449
r_  generation:  0.5508847236633301
local_output_nid generation:  0.03928041458129883
local_in_edges_tensor generation:  0.03611040115356445
mini_batch_src_global generation:  0.06281137466430664
r_  generation:  0.5503129959106445
local_output_nid generation:  0.03933978080749512
local_in_edges_tensor generation:  0.044915199279785156
mini_batch_src_global generation:  0.06096959114074707
r_  generation:  0.5551929473876953
local_output_nid generation:  0.03973865509033203
local_in_edges_tensor generation:  0.040296077728271484
mini_batch_src_global generation:  0.06542563438415527
r_  generation:  0.5546834468841553
local_output_nid generation:  0.03957033157348633
local_in_edges_tensor generation:  0.036104440689086914
mini_batch_src_global generation:  0.0615687370300293
r_  generation:  0.5558798313140869
local_output_nid generation:  0.041027069091796875
local_in_edges_tensor generation:  0.0454716682434082
mini_batch_src_global generation:  0.06561398506164551
r_  generation:  0.5525054931640625
local_output_nid generation:  0.03991341590881348
local_in_edges_tensor generation:  0.03586530685424805
mini_batch_src_global generation:  0.06195545196533203
r_  generation:  0.5558454990386963
local_output_nid generation:  0.039846181869506836
local_in_edges_tensor generation:  0.040699005126953125
mini_batch_src_global generation:  0.061402082443237305
r_  generation:  0.5578558444976807
local_output_nid generation:  0.040274858474731445
local_in_edges_tensor generation:  0.045532941818237305
mini_batch_src_global generation:  0.061293840408325195
r_  generation:  0.5593385696411133
local_output_nid generation:  0.04001140594482422
local_in_edges_tensor generation:  0.0397028923034668
mini_batch_src_global generation:  0.06523656845092773
r_  generation:  0.5603680610656738
----------------------check_connections_block total spend ----------------------------- 13.197897911071777
generate_one_block  0.7098333835601807
generate_one_block  0.7048423290252686
generate_one_block  0.6921670436859131
generate_one_block  0.6903331279754639
generate_one_block  0.6972365379333496
generate_one_block  0.6812796592712402
generate_one_block  0.7420384883880615
generate_one_block  0.7007794380187988
generate_one_block  0.6937294006347656
generate_one_block  0.6992347240447998
generate_one_block  0.6900742053985596
generate_one_block  0.7221314907073975
generate_one_block  0.6858978271484375
generate_one_block  0.6987578868865967
generate_one_block  0.6919560432434082
generate_one_block  0.6804039478302002
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04077911376953125
gen group dst list time:  0.10899829864501953
time for parepare:  0.019379377365112305
local_output_nid generation:  0.0355532169342041
local_in_edges_tensor generation:  0.04669356346130371
mini_batch_src_global generation:  0.047386884689331055
r_  generation:  0.5022475719451904
local_output_nid generation:  0.04175853729248047
local_in_edges_tensor generation:  0.03695869445800781
mini_batch_src_global generation:  0.05760478973388672
r_  generation:  0.5102338790893555
local_output_nid generation:  0.03980278968811035
local_in_edges_tensor generation:  0.04337787628173828
mini_batch_src_global generation:  0.06141328811645508
r_  generation:  0.5058305263519287
local_output_nid generation:  0.03934073448181152
local_in_edges_tensor generation:  0.04386472702026367
mini_batch_src_global generation:  0.06083250045776367
r_  generation:  0.5066797733306885
local_output_nid generation:  0.03956341743469238
local_in_edges_tensor generation:  0.0391538143157959
mini_batch_src_global generation:  0.08198761940002441
r_  generation:  0.5128202438354492
local_output_nid generation:  0.03953099250793457
local_in_edges_tensor generation:  0.03441190719604492
mini_batch_src_global generation:  0.061550140380859375
r_  generation:  0.5142343044281006
local_output_nid generation:  0.03946995735168457
local_in_edges_tensor generation:  0.039465904235839844
mini_batch_src_global generation:  0.061774253845214844
r_  generation:  0.5093557834625244
local_output_nid generation:  0.0406186580657959
local_in_edges_tensor generation:  0.036278724670410156
mini_batch_src_global generation:  0.05800175666809082
r_  generation:  0.517927885055542
local_output_nid generation:  0.04053187370300293
local_in_edges_tensor generation:  0.044605255126953125
mini_batch_src_global generation:  0.06068706512451172
r_  generation:  0.5139031410217285
local_output_nid generation:  0.04050254821777344
local_in_edges_tensor generation:  0.045182228088378906
mini_batch_src_global generation:  0.058187246322631836
r_  generation:  0.5166399478912354
local_output_nid generation:  0.04040813446044922
local_in_edges_tensor generation:  0.041394710540771484
mini_batch_src_global generation:  0.06052350997924805
r_  generation:  0.5197761058807373
local_output_nid generation:  0.04063916206359863
local_in_edges_tensor generation:  0.050083160400390625
mini_batch_src_global generation:  0.07579565048217773
r_  generation:  0.5192611217498779
local_output_nid generation:  0.04316115379333496
local_in_edges_tensor generation:  0.0404515266418457
mini_batch_src_global generation:  0.05879926681518555
r_  generation:  0.5130112171173096
local_output_nid generation:  0.04166674613952637
local_in_edges_tensor generation:  0.03560924530029297
mini_batch_src_global generation:  0.06225776672363281
r_  generation:  0.5120234489440918
local_output_nid generation:  0.04163932800292969
local_in_edges_tensor generation:  0.03527951240539551
mini_batch_src_global generation:  0.05884146690368652
r_  generation:  0.5146818161010742
local_output_nid generation:  0.04163098335266113
local_in_edges_tensor generation:  0.035459041595458984
mini_batch_src_global generation:  0.0655066967010498
r_  generation:  0.5128564834594727
----------------------check_connections_block total spend ----------------------------- 12.488012313842773
generate_one_block  0.6484766006469727
generate_one_block  0.6543715000152588
generate_one_block  0.6469976902008057
generate_one_block  0.6465673446655273
generate_one_block  0.6367478370666504
generate_one_block  0.642815113067627
generate_one_block  0.6691052913665771
generate_one_block  0.6371328830718994
generate_one_block  0.7282195091247559
generate_one_block  0.6568629741668701
generate_one_block  0.6370832920074463
generate_one_block  0.6542372703552246
generate_one_block  0.6268630027770996
generate_one_block  0.6445419788360596
generate_one_block  0.6267454624176025
generate_one_block  0.6286935806274414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  56.42000675201416
block generation total time  47.99208116531372
average batch blocks generation time:  2.9995050728321075
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13507366180419922  GigaBytes
Max Memory Allocated: 0.13507366180419922  GigaBytes

torch.Size([167149, 128])
torch.Size([166346, 32])
torch.Size([163883, 32])
torch.Size([155651, 32])
torch.Size([123640, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.5153641700744629  GigaBytes
Max Memory Allocated: 0.5175027847290039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.13707447052001953  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167193, 128])
torch.Size([166416, 32])
torch.Size([164085, 32])
torch.Size([155882, 32])
torch.Size([123545, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5136857032775879  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13712787628173828  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167251, 128])
torch.Size([166430, 32])
torch.Size([163996, 32])
torch.Size([155673, 32])
torch.Size([124161, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5142374038696289  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1370859146118164  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167225, 128])
torch.Size([166489, 32])
torch.Size([164176, 32])
torch.Size([155947, 32])
torch.Size([123959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5137510299682617  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1370835304260254  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167222, 128])
torch.Size([166446, 32])
torch.Size([164144, 32])
torch.Size([156109, 32])
torch.Size([123974, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5136857032775879  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13705158233642578  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167223, 128])
torch.Size([166415, 32])
torch.Size([163879, 32])
torch.Size([155413, 32])
torch.Size([123437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5087771415710449  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13708066940307617  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167209, 128])
torch.Size([166417, 32])
torch.Size([164003, 32])
torch.Size([155856, 32])
torch.Size([123818, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5137119293212891  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1370716094970703  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167204, 128])
torch.Size([166376, 32])
torch.Size([163921, 32])
torch.Size([155754, 32])
torch.Size([123704, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135784149169922  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13712072372436523  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167229, 128])
torch.Size([166416, 32])
torch.Size([164089, 32])
torch.Size([155864, 32])
torch.Size([123799, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.514106273651123  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13712596893310547  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167275, 128])
torch.Size([166473, 32])
torch.Size([164100, 32])
torch.Size([155897, 32])
torch.Size([124301, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5144815444946289  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13711833953857422  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167203, 128])
torch.Size([166451, 32])
torch.Size([164071, 32])
torch.Size([155888, 32])
torch.Size([124167, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5142688751220703  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13709402084350586  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167312, 128])
torch.Size([166526, 32])
torch.Size([164106, 32])
torch.Size([155785, 32])
torch.Size([123804, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5139007568359375  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13713407516479492  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167263, 128])
torch.Size([166418, 32])
torch.Size([164054, 32])
torch.Size([155881, 32])
torch.Size([124490, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5143294334411621  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1371150016784668  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167260, 128])
torch.Size([166459, 32])
torch.Size([164106, 32])
torch.Size([156143, 32])
torch.Size([124222, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5141253471374512  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1370224952697754  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167177, 128])
torch.Size([166305, 32])
torch.Size([163839, 32])
torch.Size([155430, 32])
torch.Size([122861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5081677436828613  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1370677947998047  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167203, 128])
torch.Size([166388, 32])
torch.Size([163932, 32])
torch.Size([155548, 32])
torch.Size([123151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5093445777893066  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05819039046764374 |0.06796571612358093 |0.0506083220243454 |0.00010156631469726562 |0.024023190140724182 |0.00758671760559082 |
----------------------------------------------------------pseudo_mini_loss sum 5.462177753448486
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13097932
Number of first layer input nodes during this epoch:  2675598
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.25309038162231445  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02002239227294922
range selection method range initialization spend 0.011767148971557617
time for parepare:  0.017301559448242188
local_output_nid generation:  0.0014314651489257812
local_in_edges_tensor generation:  0.0072021484375
mini_batch_src_global generation:  0.0018229484558105469
r_  generation:  0.017917871475219727
local_output_nid generation:  0.0015342235565185547
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0021047592163085938
r_  generation:  0.019503116607666016
local_output_nid generation:  0.001561880111694336
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0015463829040527344
r_  generation:  0.019227027893066406
local_output_nid generation:  0.0015659332275390625
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.018565893173217773
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0015285015106201172
r_  generation:  0.019181251525878906
local_output_nid generation:  0.0015227794647216797
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.01906728744506836
local_output_nid generation:  0.00150299072265625
local_in_edges_tensor generation:  0.0008509159088134766
mini_batch_src_global generation:  0.0015184879302978516
r_  generation:  0.01926422119140625
local_output_nid generation:  0.0015094280242919922
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0015294551849365234
r_  generation:  0.01935601234436035
local_output_nid generation:  0.0015327930450439453
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0015053749084472656
r_  generation:  0.019678115844726562
local_output_nid generation:  0.0015032291412353516
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.019234657287597656
local_output_nid generation:  0.0015196800231933594
local_in_edges_tensor generation:  0.0008571147918701172
mini_batch_src_global generation:  0.0014903545379638672
r_  generation:  0.019287586212158203
local_output_nid generation:  0.0015454292297363281
local_in_edges_tensor generation:  0.0008561611175537109
mini_batch_src_global generation:  0.0014734268188476562
r_  generation:  0.018887758255004883
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.001434326171875
r_  generation:  0.01887798309326172
local_output_nid generation:  0.0014958381652832031
local_in_edges_tensor generation:  0.0008368492126464844
mini_batch_src_global generation:  0.0015249252319335938
r_  generation:  0.018945932388305664
local_output_nid generation:  0.0015614032745361328
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.018868207931518555
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008623600006103516
mini_batch_src_global generation:  0.0014696121215820312
r_  generation:  0.019096851348876953
----------------------check_connections_block total spend ----------------------------- 0.4602470397949219
generate_one_block  0.026527881622314453
generate_one_block  0.028324365615844727
generate_one_block  0.028300046920776367
generate_one_block  0.02740001678466797
generate_one_block  0.028063058853149414
generate_one_block  0.029405832290649414
generate_one_block  0.027810096740722656
generate_one_block  0.027738094329833984
generate_one_block  0.027965068817138672
generate_one_block  0.027898788452148438
generate_one_block  0.027894020080566406
generate_one_block  0.028815031051635742
generate_one_block  0.029387950897216797
generate_one_block  0.02894139289855957
generate_one_block  0.02886962890625
generate_one_block  0.028373241424560547
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03806328773498535
gen group dst list time:  0.01677680015563965
time for parepare:  0.019008398056030273
local_output_nid generation:  0.0063822269439697266
local_in_edges_tensor generation:  0.018490076065063477
mini_batch_src_global generation:  0.020737886428833008
r_  generation:  0.1965184211730957
local_output_nid generation:  0.010207891464233398
local_in_edges_tensor generation:  0.018091678619384766
mini_batch_src_global generation:  0.024849653244018555
r_  generation:  0.20915722846984863
local_output_nid generation:  0.010691642761230469
local_in_edges_tensor generation:  0.016689538955688477
mini_batch_src_global generation:  0.02645587921142578
r_  generation:  0.22095155715942383
local_output_nid generation:  0.011223554611206055
local_in_edges_tensor generation:  0.011324167251586914
mini_batch_src_global generation:  0.025159358978271484
r_  generation:  0.21569299697875977
local_output_nid generation:  0.011314868927001953
local_in_edges_tensor generation:  0.011317253112792969
mini_batch_src_global generation:  0.0265195369720459
r_  generation:  0.2213914394378662
local_output_nid generation:  0.010954141616821289
local_in_edges_tensor generation:  0.012604236602783203
mini_batch_src_global generation:  0.02650594711303711
r_  generation:  0.22047758102416992
local_output_nid generation:  0.011657953262329102
local_in_edges_tensor generation:  0.013346433639526367
mini_batch_src_global generation:  0.026950597763061523
r_  generation:  0.22195744514465332
local_output_nid generation:  0.011780261993408203
local_in_edges_tensor generation:  0.016904592514038086
mini_batch_src_global generation:  0.0269622802734375
r_  generation:  0.2218639850616455
local_output_nid generation:  0.011945724487304688
local_in_edges_tensor generation:  0.013241291046142578
mini_batch_src_global generation:  0.029090404510498047
r_  generation:  0.22480487823486328
local_output_nid generation:  0.012018442153930664
local_in_edges_tensor generation:  0.011509895324707031
mini_batch_src_global generation:  0.028444528579711914
r_  generation:  0.22235321998596191
local_output_nid generation:  0.011997699737548828
local_in_edges_tensor generation:  0.012932538986206055
mini_batch_src_global generation:  0.02696371078491211
r_  generation:  0.22182512283325195
local_output_nid generation:  0.011762857437133789
local_in_edges_tensor generation:  0.01588606834411621
mini_batch_src_global generation:  0.02684473991394043
r_  generation:  0.2203831672668457
local_output_nid generation:  0.011974096298217773
local_in_edges_tensor generation:  0.015076637268066406
mini_batch_src_global generation:  0.026767730712890625
r_  generation:  0.22021150588989258
local_output_nid generation:  0.012002706527709961
local_in_edges_tensor generation:  0.015285968780517578
mini_batch_src_global generation:  0.029369831085205078
r_  generation:  0.22463512420654297
local_output_nid generation:  0.011926651000976562
local_in_edges_tensor generation:  0.011833906173706055
mini_batch_src_global generation:  0.026515483856201172
r_  generation:  0.21935486793518066
local_output_nid generation:  0.011800527572631836
local_in_edges_tensor generation:  0.013054370880126953
mini_batch_src_global generation:  0.029139041900634766
r_  generation:  0.22283935546875
----------------------check_connections_block total spend ----------------------------- 5.125060796737671
generate_one_block  0.28075385093688965
generate_one_block  0.2780478000640869
generate_one_block  0.29145050048828125
generate_one_block  0.2795579433441162
generate_one_block  0.28823208808898926
generate_one_block  0.2853870391845703
generate_one_block  0.31108903884887695
generate_one_block  0.27711057662963867
generate_one_block  0.2836735248565674
generate_one_block  0.27596306800842285
generate_one_block  0.27601170539855957
generate_one_block  0.274428129196167
generate_one_block  0.2964181900024414
generate_one_block  0.3022940158843994
generate_one_block  0.2952449321746826
generate_one_block  0.2985496520996094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05095863342285156
gen group dst list time:  0.06824254989624023
time for parepare:  0.017420530319213867
local_output_nid generation:  0.02405858039855957
local_in_edges_tensor generation:  0.055974483489990234
mini_batch_src_global generation:  0.045484066009521484
r_  generation:  0.4929237365722656
local_output_nid generation:  0.029192447662353516
local_in_edges_tensor generation:  0.04819464683532715
mini_batch_src_global generation:  0.05913996696472168
r_  generation:  0.49074697494506836
local_output_nid generation:  0.029458999633789062
local_in_edges_tensor generation:  0.04860711097717285
mini_batch_src_global generation:  0.05778670310974121
r_  generation:  0.5159990787506104
local_output_nid generation:  0.033167362213134766
local_in_edges_tensor generation:  0.03169584274291992
mini_batch_src_global generation:  0.05943775177001953
r_  generation:  0.5066046714782715
local_output_nid generation:  0.030090808868408203
local_in_edges_tensor generation:  0.07818245887756348
mini_batch_src_global generation:  0.0649569034576416
r_  generation:  0.5140001773834229
local_output_nid generation:  0.03154730796813965
local_in_edges_tensor generation:  0.04665637016296387
mini_batch_src_global generation:  0.060074806213378906
r_  generation:  0.5231962203979492
local_output_nid generation:  0.03327822685241699
local_in_edges_tensor generation:  0.04100918769836426
mini_batch_src_global generation:  0.061982154846191406
r_  generation:  0.5084202289581299
local_output_nid generation:  0.03151249885559082
local_in_edges_tensor generation:  0.03745603561401367
mini_batch_src_global generation:  0.059546709060668945
r_  generation:  0.5163626670837402
local_output_nid generation:  0.03182077407836914
local_in_edges_tensor generation:  0.04049086570739746
mini_batch_src_global generation:  0.05809473991394043
r_  generation:  0.5177164077758789
local_output_nid generation:  0.031141281127929688
local_in_edges_tensor generation:  0.036507606506347656
mini_batch_src_global generation:  0.059456586837768555
r_  generation:  0.5058517456054688
local_output_nid generation:  0.031226634979248047
local_in_edges_tensor generation:  0.03562521934509277
mini_batch_src_global generation:  0.058274269104003906
r_  generation:  0.5081517696380615
local_output_nid generation:  0.03138923645019531
local_in_edges_tensor generation:  0.039849281311035156
mini_batch_src_global generation:  0.061646223068237305
r_  generation:  0.5089311599731445
local_output_nid generation:  0.03214550018310547
local_in_edges_tensor generation:  0.046924591064453125
mini_batch_src_global generation:  0.059769630432128906
r_  generation:  0.5196633338928223
local_output_nid generation:  0.03243064880371094
local_in_edges_tensor generation:  0.04274463653564453
mini_batch_src_global generation:  0.06017446517944336
r_  generation:  0.4963860511779785
local_output_nid generation:  0.03100752830505371
local_in_edges_tensor generation:  0.03604865074157715
mini_batch_src_global generation:  0.057520389556884766
r_  generation:  0.5070431232452393
local_output_nid generation:  0.030963897705078125
local_in_edges_tensor generation:  0.02991175651550293
mini_batch_src_global generation:  0.06041550636291504
r_  generation:  0.5087361335754395
----------------------check_connections_block total spend ----------------------------- 12.046100616455078
generate_one_block  0.6473886966705322
generate_one_block  0.6518728733062744
generate_one_block  0.6595745086669922
generate_one_block  0.6533653736114502
generate_one_block  0.6564199924468994
generate_one_block  0.6587140560150146
generate_one_block  0.648892879486084
generate_one_block  0.6450963020324707
generate_one_block  0.6844189167022705
generate_one_block  0.6441709995269775
generate_one_block  0.6579234600067139
generate_one_block  0.6577110290527344
generate_one_block  0.6487267017364502
generate_one_block  0.6552526950836182
generate_one_block  0.640336275100708
generate_one_block  0.6491284370422363
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05182504653930664
gen group dst list time:  0.09817671775817871
time for parepare:  0.019276857376098633
local_output_nid generation:  0.0313572883605957
local_in_edges_tensor generation:  0.06069517135620117
mini_batch_src_global generation:  0.05430936813354492
r_  generation:  0.556159257888794
local_output_nid generation:  0.03832364082336426
local_in_edges_tensor generation:  0.05562257766723633
mini_batch_src_global generation:  0.06272149085998535
r_  generation:  0.54494309425354
local_output_nid generation:  0.038277387619018555
local_in_edges_tensor generation:  0.04260063171386719
mini_batch_src_global generation:  0.05905437469482422
r_  generation:  0.5507431030273438
local_output_nid generation:  0.038759469985961914
local_in_edges_tensor generation:  0.041105031967163086
mini_batch_src_global generation:  0.05962681770324707
r_  generation:  0.5554361343383789
local_output_nid generation:  0.049877166748046875
local_in_edges_tensor generation:  0.041135549545288086
mini_batch_src_global generation:  0.05840444564819336
r_  generation:  0.5595259666442871
local_output_nid generation:  0.03616070747375488
local_in_edges_tensor generation:  0.042031288146972656
mini_batch_src_global generation:  0.0593874454498291
r_  generation:  0.5627250671386719
local_output_nid generation:  0.03611922264099121
local_in_edges_tensor generation:  0.042087554931640625
mini_batch_src_global generation:  0.06036972999572754
r_  generation:  0.5663256645202637
local_output_nid generation:  0.03621721267700195
local_in_edges_tensor generation:  0.041315317153930664
mini_batch_src_global generation:  0.05996417999267578
r_  generation:  0.5682740211486816
local_output_nid generation:  0.03605818748474121
local_in_edges_tensor generation:  0.042101144790649414
mini_batch_src_global generation:  0.0611114501953125
r_  generation:  0.5658566951751709
local_output_nid generation:  0.03663945198059082
local_in_edges_tensor generation:  0.041864633560180664
mini_batch_src_global generation:  0.061292409896850586
r_  generation:  0.5761573314666748
local_output_nid generation:  0.03739500045776367
local_in_edges_tensor generation:  0.04425501823425293
mini_batch_src_global generation:  0.06229352951049805
r_  generation:  0.5663161277770996
local_output_nid generation:  0.03643393516540527
local_in_edges_tensor generation:  0.04251980781555176
mini_batch_src_global generation:  0.0619509220123291
r_  generation:  0.5721232891082764
local_output_nid generation:  0.03644704818725586
local_in_edges_tensor generation:  0.0424952507019043
mini_batch_src_global generation:  0.06096172332763672
r_  generation:  0.5692534446716309
local_output_nid generation:  0.0367434024810791
local_in_edges_tensor generation:  0.0420224666595459
mini_batch_src_global generation:  0.06166982650756836
r_  generation:  0.5782303810119629
local_output_nid generation:  0.03697776794433594
local_in_edges_tensor generation:  0.044165849685668945
mini_batch_src_global generation:  0.06500959396362305
r_  generation:  0.5690178871154785
local_output_nid generation:  0.036789894104003906
local_in_edges_tensor generation:  0.04192209243774414
mini_batch_src_global generation:  0.061979055404663086
r_  generation:  0.5769476890563965
----------------------check_connections_block total spend ----------------------------- 13.412434101104736
generate_one_block  0.6836583614349365
generate_one_block  0.6935281753540039
generate_one_block  0.6924138069152832
generate_one_block  0.6944494247436523
generate_one_block  0.6828517913818359
generate_one_block  0.690509557723999
generate_one_block  0.7807114124298096
generate_one_block  0.6955969333648682
generate_one_block  0.7054200172424316
generate_one_block  0.6866381168365479
generate_one_block  0.695824384689331
generate_one_block  0.6898813247680664
generate_one_block  0.6982421875
generate_one_block  0.6914167404174805
generate_one_block  0.6906726360321045
generate_one_block  0.7008926868438721
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044003963470458984
gen group dst list time:  0.10648989677429199
time for parepare:  0.018984556198120117
local_output_nid generation:  0.03347158432006836
local_in_edges_tensor generation:  0.047102928161621094
mini_batch_src_global generation:  0.048116445541381836
r_  generation:  0.5668320655822754
local_output_nid generation:  0.03982424736022949
local_in_edges_tensor generation:  0.044760704040527344
mini_batch_src_global generation:  0.0630803108215332
r_  generation:  0.5402214527130127
local_output_nid generation:  0.03822636604309082
local_in_edges_tensor generation:  0.03960251808166504
mini_batch_src_global generation:  0.061362504959106445
r_  generation:  0.5509350299835205
local_output_nid generation:  0.03875398635864258
local_in_edges_tensor generation:  0.04070138931274414
mini_batch_src_global generation:  0.06233549118041992
r_  generation:  0.5476348400115967
local_output_nid generation:  0.03864479064941406
local_in_edges_tensor generation:  0.0399477481842041
mini_batch_src_global generation:  0.06038498878479004
r_  generation:  0.5582606792449951
local_output_nid generation:  0.03881382942199707
local_in_edges_tensor generation:  0.04078841209411621
mini_batch_src_global generation:  0.06173396110534668
r_  generation:  0.5482628345489502
local_output_nid generation:  0.03910708427429199
local_in_edges_tensor generation:  0.04017448425292969
mini_batch_src_global generation:  0.06048917770385742
r_  generation:  0.5586683750152588
local_output_nid generation:  0.03889274597167969
local_in_edges_tensor generation:  0.04082465171813965
mini_batch_src_global generation:  0.06174325942993164
r_  generation:  0.5491406917572021
local_output_nid generation:  0.03894972801208496
local_in_edges_tensor generation:  0.045961618423461914
mini_batch_src_global generation:  0.06103086471557617
r_  generation:  0.5565731525421143
local_output_nid generation:  0.0388796329498291
local_in_edges_tensor generation:  0.04076504707336426
mini_batch_src_global generation:  0.06165194511413574
r_  generation:  0.5556793212890625
local_output_nid generation:  0.039072513580322266
local_in_edges_tensor generation:  0.041443824768066406
mini_batch_src_global generation:  0.0605616569519043
r_  generation:  0.5528531074523926
local_output_nid generation:  0.03931164741516113
local_in_edges_tensor generation:  0.04615664482116699
mini_batch_src_global generation:  0.06198382377624512
r_  generation:  0.5524365901947021
local_output_nid generation:  0.0395357608795166
local_in_edges_tensor generation:  0.042095184326171875
mini_batch_src_global generation:  0.06737112998962402
r_  generation:  0.5540657043457031
local_output_nid generation:  0.039412498474121094
local_in_edges_tensor generation:  0.03586721420288086
mini_batch_src_global generation:  0.061342477798461914
r_  generation:  0.5572855472564697
local_output_nid generation:  0.04162430763244629
local_in_edges_tensor generation:  0.045588016510009766
mini_batch_src_global generation:  0.060665130615234375
r_  generation:  0.5602152347564697
local_output_nid generation:  0.0393519401550293
local_in_edges_tensor generation:  0.0460665225982666
mini_batch_src_global generation:  0.062408447265625
r_  generation:  0.5644369125366211
----------------------check_connections_block total spend ----------------------------- 13.261175870895386
generate_one_block  0.6851201057434082
generate_one_block  0.6935741901397705
generate_one_block  0.6927011013031006
generate_one_block  0.6863448619842529
generate_one_block  0.6966145038604736
generate_one_block  0.703094482421875
generate_one_block  0.6979677677154541
generate_one_block  0.6866271495819092
generate_one_block  0.6989495754241943
generate_one_block  0.7528550624847412
generate_one_block  0.6815094947814941
generate_one_block  0.6904506683349609
generate_one_block  0.7097890377044678
generate_one_block  0.6818482875823975
generate_one_block  0.6901471614837646
generate_one_block  0.7028698921203613
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0666656494140625
gen group dst list time:  0.10646653175354004
time for parepare:  0.020290374755859375
local_output_nid generation:  0.03465151786804199
local_in_edges_tensor generation:  0.04507327079772949
mini_batch_src_global generation:  0.04473686218261719
r_  generation:  0.5003330707550049
local_output_nid generation:  0.04071354866027832
local_in_edges_tensor generation:  0.0348048210144043
mini_batch_src_global generation:  0.057346343994140625
r_  generation:  0.5036211013793945
local_output_nid generation:  0.04129672050476074
local_in_edges_tensor generation:  0.03674173355102539
mini_batch_src_global generation:  0.05856585502624512
r_  generation:  0.5032908916473389
local_output_nid generation:  0.04166388511657715
local_in_edges_tensor generation:  0.036632537841796875
mini_batch_src_global generation:  0.06353497505187988
r_  generation:  0.5057270526885986
local_output_nid generation:  0.04203224182128906
local_in_edges_tensor generation:  0.038964033126831055
mini_batch_src_global generation:  0.05865025520324707
r_  generation:  0.5020859241485596
local_output_nid generation:  0.040617942810058594
local_in_edges_tensor generation:  0.03870368003845215
mini_batch_src_global generation:  0.061261892318725586
r_  generation:  0.5050773620605469
local_output_nid generation:  0.03921318054199219
local_in_edges_tensor generation:  0.038655757904052734
mini_batch_src_global generation:  0.05763816833496094
r_  generation:  0.5041403770446777
local_output_nid generation:  0.039449453353881836
local_in_edges_tensor generation:  0.03830409049987793
mini_batch_src_global generation:  0.0765080451965332
r_  generation:  0.5066454410552979
local_output_nid generation:  0.03942513465881348
local_in_edges_tensor generation:  0.039129018783569336
mini_batch_src_global generation:  0.05769920349121094
r_  generation:  0.511918306350708
local_output_nid generation:  0.03935098648071289
local_in_edges_tensor generation:  0.0435795783996582
mini_batch_src_global generation:  0.05754542350769043
r_  generation:  0.5111651420593262
local_output_nid generation:  0.03988313674926758
local_in_edges_tensor generation:  0.038947105407714844
mini_batch_src_global generation:  0.05757951736450195
r_  generation:  0.5101113319396973
local_output_nid generation:  0.04005742073059082
local_in_edges_tensor generation:  0.03868269920349121
mini_batch_src_global generation:  0.05755615234375
r_  generation:  0.5111443996429443
local_output_nid generation:  0.03979802131652832
local_in_edges_tensor generation:  0.03908061981201172
mini_batch_src_global generation:  0.057631492614746094
r_  generation:  0.5154938697814941
local_output_nid generation:  0.03962373733520508
local_in_edges_tensor generation:  0.04374122619628906
mini_batch_src_global generation:  0.05753803253173828
r_  generation:  0.5136575698852539
local_output_nid generation:  0.040987491607666016
local_in_edges_tensor generation:  0.041869163513183594
mini_batch_src_global generation:  0.059514760971069336
r_  generation:  0.5103182792663574
local_output_nid generation:  0.040122032165527344
local_in_edges_tensor generation:  0.043569087982177734
mini_batch_src_global generation:  0.0576324462890625
r_  generation:  0.5238449573516846
----------------------check_connections_block total spend ----------------------------- 12.308852910995483
generate_one_block  0.6474931240081787
generate_one_block  0.6573824882507324
generate_one_block  0.6379067897796631
generate_one_block  0.6382794380187988
generate_one_block  0.6358778476715088
generate_one_block  0.6362967491149902
generate_one_block  0.6485791206359863
generate_one_block  0.6490383148193359
generate_one_block  0.6421995162963867
generate_one_block  0.6404569149017334
generate_one_block  0.6295208930969238
generate_one_block  0.6467432975769043
generate_one_block  0.7416567802429199
generate_one_block  0.6283309459686279
generate_one_block  0.646928071975708
generate_one_block  0.6386330127716064
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.25309038162231445  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

connection checking time:  56.153624296188354
block generation total time  47.74169945716858
average batch blocks generation time:  2.983856216073036
block dataloader generation time/epoch 107.47747373580933
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13722610473632812  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167164, 128])
torch.Size([166320, 32])
torch.Size([163863, 32])
torch.Size([155571, 32])
torch.Size([123311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5093955993652344  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13728046417236328  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167240, 128])
torch.Size([166476, 32])
torch.Size([164069, 32])
torch.Size([155839, 32])
torch.Size([124277, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5145368576049805  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13731002807617188  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167185, 128])
torch.Size([166360, 32])
torch.Size([163977, 32])
torch.Size([155742, 32])
torch.Size([124161, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5147619247436523  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13723468780517578  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167188, 128])
torch.Size([166394, 32])
torch.Size([164080, 32])
torch.Size([155920, 32])
torch.Size([124023, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5140013694763184  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1372509002685547  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167154, 128])
torch.Size([166274, 32])
torch.Size([163779, 32])
torch.Size([155366, 32])
torch.Size([123879, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5100235939025879  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13724565505981445  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167202, 128])
torch.Size([166381, 32])
torch.Size([163939, 32])
torch.Size([155949, 32])
torch.Size([124074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5140624046325684  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13724565505981445  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167243, 128])
torch.Size([166410, 32])
torch.Size([163999, 32])
torch.Size([155809, 32])
torch.Size([123908, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5142683982849121  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13724994659423828  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167241, 128])
torch.Size([166404, 32])
torch.Size([164011, 32])
torch.Size([155909, 32])
torch.Size([124007, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5141611099243164  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13727474212646484  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167245, 128])
torch.Size([166422, 32])
torch.Size([164043, 32])
torch.Size([155886, 32])
torch.Size([124003, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5144367218017578  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1372218132019043  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167193, 128])
torch.Size([166410, 32])
torch.Size([164043, 32])
torch.Size([155849, 32])
torch.Size([123829, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5140142440795898  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13721704483032227  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167143, 128])
torch.Size([166296, 32])
torch.Size([163919, 32])
torch.Size([155783, 32])
torch.Size([123577, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135970115661621  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13721036911010742  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167188, 128])
torch.Size([166375, 32])
torch.Size([163959, 32])
torch.Size([155805, 32])
torch.Size([123622, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135092735290527  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13723993301391602  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167272, 128])
torch.Size([166499, 32])
torch.Size([164234, 32])
torch.Size([156025, 32])
torch.Size([123836, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5138435363769531  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.1372370719909668  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167145, 128])
torch.Size([166270, 32])
torch.Size([163863, 32])
torch.Size([155656, 32])
torch.Size([123764, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135817527770996  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13719749450683594  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167276, 128])
torch.Size([166476, 32])
torch.Size([164079, 32])
torch.Size([155817, 32])
torch.Size([123234, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5127768516540527  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.13723087310791016  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

torch.Size([167175, 128])
torch.Size([166357, 32])
torch.Size([164007, 32])
torch.Size([155816, 32])
torch.Size([123375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.5135464668273926  GigaBytes
Max Memory Allocated: 0.5283894538879395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06540985405445099 |0.04756297171115875 |0.006663024425506592 |9.323656558990479e-05 |0.00708925724029541 |0.0036287307739257812 |
----------------------------------------------------------pseudo_mini_loss sum 4.821199893951416
Total (block generation + training)time/epoch 109.57845735549927
Training time/epoch 2.100644588470459
Training time without block to device /epoch 1.339637041091919
Training time without total dataloading part /epoch 0.2251570224761963
load block tensor time/epoch 1.0465576648712158
block to device time/epoch 0.76100754737854
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13096320
Number of first layer input nodes during this epoch:  2675254
