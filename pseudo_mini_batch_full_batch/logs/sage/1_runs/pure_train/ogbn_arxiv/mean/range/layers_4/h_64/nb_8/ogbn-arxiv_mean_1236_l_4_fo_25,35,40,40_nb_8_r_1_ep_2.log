Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648482247.4839032
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024262666702270508
range selection method range initialization spend 0.017394542694091797
time for parepare:  0.017667770385742188
local_output_nid generation:  0.0027256011962890625
local_in_edges_tensor generation:  0.004305601119995117
mini_batch_src_global generation:  0.0039136409759521484
r_  generation:  0.03973221778869629
local_output_nid generation:  0.0032176971435546875
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.004199504852294922
r_  generation:  0.038945674896240234
local_output_nid generation:  0.0031821727752685547
local_in_edges_tensor generation:  0.0015981197357177734
mini_batch_src_global generation:  0.002749919891357422
r_  generation:  0.04040837287902832
local_output_nid generation:  0.0032608509063720703
local_in_edges_tensor generation:  0.0016083717346191406
mini_batch_src_global generation:  0.002858400344848633
r_  generation:  0.04058098793029785
local_output_nid generation:  0.0032567977905273438
local_in_edges_tensor generation:  0.0015943050384521484
mini_batch_src_global generation:  0.0029611587524414062
r_  generation:  0.041388511657714844
local_output_nid generation:  0.0032405853271484375
local_in_edges_tensor generation:  0.0016179084777832031
mini_batch_src_global generation:  0.0032405853271484375
r_  generation:  0.04237246513366699
local_output_nid generation:  0.003233194351196289
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.003129243850708008
r_  generation:  0.041181087493896484
local_output_nid generation:  0.003253459930419922
local_in_edges_tensor generation:  0.001603841781616211
mini_batch_src_global generation:  0.0032219886779785156
r_  generation:  0.04268479347229004
----------------------check_connections_block total spend ----------------------------- 0.48165273666381836
generate_one_block  0.052980661392211914
generate_one_block  0.05481839179992676
generate_one_block  0.05520153045654297
generate_one_block  0.054788827896118164
generate_one_block  0.05699419975280762
generate_one_block  0.05514407157897949
generate_one_block  0.053961753845214844
generate_one_block  0.05504751205444336
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03898119926452637
gen group dst list time:  0.015385866165161133
time for parepare:  0.019040346145629883
local_output_nid generation:  0.010404825210571289
local_in_edges_tensor generation:  0.028699636459350586
mini_batch_src_global generation:  0.028182268142700195
r_  generation:  0.29471421241760254
local_output_nid generation:  0.015449762344360352
local_in_edges_tensor generation:  0.026517152786254883
mini_batch_src_global generation:  0.036046504974365234
r_  generation:  0.3051884174346924
local_output_nid generation:  0.015794038772583008
local_in_edges_tensor generation:  0.021637678146362305
mini_batch_src_global generation:  0.04331803321838379
r_  generation:  0.3089728355407715
local_output_nid generation:  0.016264915466308594
local_in_edges_tensor generation:  0.022324085235595703
mini_batch_src_global generation:  0.03744149208068848
r_  generation:  0.31915807723999023
local_output_nid generation:  0.016608238220214844
local_in_edges_tensor generation:  0.02561330795288086
mini_batch_src_global generation:  0.03801369667053223
r_  generation:  0.31670475006103516
local_output_nid generation:  0.016452789306640625
local_in_edges_tensor generation:  0.016726970672607422
mini_batch_src_global generation:  0.038442134857177734
r_  generation:  0.3206465244293213
local_output_nid generation:  0.016460895538330078
local_in_edges_tensor generation:  0.016785383224487305
mini_batch_src_global generation:  0.03799772262573242
r_  generation:  0.31255531311035156
local_output_nid generation:  0.016648054122924805
local_in_edges_tensor generation:  0.01688098907470703
mini_batch_src_global generation:  0.04038667678833008
r_  generation:  0.3192143440246582
----------------------check_connections_block total spend ----------------------------- 3.6456120014190674
generate_one_block  0.39810872077941895
generate_one_block  0.4041597843170166
generate_one_block  0.40447115898132324
generate_one_block  0.40703797340393066
generate_one_block  0.4076995849609375
generate_one_block  0.41336631774902344
generate_one_block  0.388974666595459
generate_one_block  0.39992666244506836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03711724281311035
gen group dst list time:  0.03575897216796875
time for parepare:  0.018913745880126953
local_output_nid generation:  0.024401426315307617
local_in_edges_tensor generation:  0.03899836540222168
mini_batch_src_global generation:  0.0467987060546875
r_  generation:  0.506617546081543
local_output_nid generation:  0.0317080020904541
local_in_edges_tensor generation:  0.04940438270568848
mini_batch_src_global generation:  0.05915474891662598
r_  generation:  0.5362238883972168
local_output_nid generation:  0.03264164924621582
local_in_edges_tensor generation:  0.044417619705200195
mini_batch_src_global generation:  0.05871129035949707
r_  generation:  0.5439238548278809
local_output_nid generation:  0.032807111740112305
local_in_edges_tensor generation:  0.041472434997558594
mini_batch_src_global generation:  0.058297157287597656
r_  generation:  0.5406033992767334
local_output_nid generation:  0.0329442024230957
local_in_edges_tensor generation:  0.03152155876159668
mini_batch_src_global generation:  0.05756497383117676
r_  generation:  0.5512359142303467
local_output_nid generation:  0.03318357467651367
local_in_edges_tensor generation:  0.0319216251373291
mini_batch_src_global generation:  0.05981302261352539
r_  generation:  0.5400192737579346
local_output_nid generation:  0.03303813934326172
local_in_edges_tensor generation:  0.03637862205505371
mini_batch_src_global generation:  0.05792045593261719
r_  generation:  0.5522141456604004
local_output_nid generation:  0.03307652473449707
local_in_edges_tensor generation:  0.0361790657043457
mini_batch_src_global generation:  0.05948209762573242
r_  generation:  0.5249435901641846
----------------------check_connections_block total spend ----------------------------- 6.241862773895264
generate_one_block  0.6458053588867188
generate_one_block  0.6644585132598877
generate_one_block  0.667963981628418
generate_one_block  0.6580178737640381
generate_one_block  0.6445038318634033
generate_one_block  0.6599040031433105
generate_one_block  0.678347110748291
generate_one_block  0.6566994190216064
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028923988342285156
gen group dst list time:  0.0455470085144043
time for parepare:  0.02090167999267578
local_output_nid generation:  0.031219959259033203
local_in_edges_tensor generation:  0.05137038230895996
mini_batch_src_global generation:  0.0523378849029541
r_  generation:  0.5050253868103027
local_output_nid generation:  0.036473751068115234
local_in_edges_tensor generation:  0.05306577682495117
mini_batch_src_global generation:  0.06091761589050293
r_  generation:  0.5184147357940674
local_output_nid generation:  0.03956460952758789
local_in_edges_tensor generation:  0.047425031661987305
mini_batch_src_global generation:  0.05905628204345703
r_  generation:  0.5071842670440674
local_output_nid generation:  0.03792548179626465
local_in_edges_tensor generation:  0.038269996643066406
mini_batch_src_global generation:  0.05444693565368652
r_  generation:  0.5107882022857666
local_output_nid generation:  0.03825521469116211
local_in_edges_tensor generation:  0.0379178524017334
mini_batch_src_global generation:  0.05459284782409668
r_  generation:  0.5117464065551758
local_output_nid generation:  0.0380091667175293
local_in_edges_tensor generation:  0.04268193244934082
mini_batch_src_global generation:  0.054262638092041016
r_  generation:  0.5190010070800781
local_output_nid generation:  0.03837943077087402
local_in_edges_tensor generation:  0.03847622871398926
mini_batch_src_global generation:  0.05467653274536133
r_  generation:  0.5351583957672119
local_output_nid generation:  0.03806495666503906
local_in_edges_tensor generation:  0.043039560317993164
mini_batch_src_global generation:  0.055212974548339844
r_  generation:  0.5392806529998779
----------------------check_connections_block total spend ----------------------------- 6.199395656585693
generate_one_block  0.6508810520172119
generate_one_block  0.6405799388885498
generate_one_block  0.6385045051574707
generate_one_block  0.625474214553833
generate_one_block  0.6295757293701172
generate_one_block  0.6306471824645996
generate_one_block  0.6685945987701416
generate_one_block  0.6319043636322021
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

connection checking time:  16.086870431900024
block generation total time  13.615606546401978
average batch blocks generation time:  1.7019508183002472
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11117124557495117  GigaBytes
Max Memory Allocated: 0.11117124557495117  GigaBytes

torch.Size([165604, 128])
torch.Size([161156, 64])
torch.Size([141720, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.48865461349487305  GigaBytes
Max Memory Allocated: 0.501347541809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.11306381225585938  GigaBytes
Max Memory Allocated: 0.5202975273132324  GigaBytes

torch.Size([165512, 128])
torch.Size([161259, 64])
torch.Size([142142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.49035120010375977  GigaBytes
Max Memory Allocated: 0.5202975273132324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11335611343383789  GigaBytes
Max Memory Allocated: 0.5220003128051758  GigaBytes

torch.Size([165542, 128])
torch.Size([161371, 64])
torch.Size([142576, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.49036550521850586  GigaBytes
Max Memory Allocated: 0.5220003128051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11343717575073242  GigaBytes
Max Memory Allocated: 0.5220003128051758  GigaBytes

torch.Size([165546, 128])
torch.Size([161352, 64])
torch.Size([142506, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4915151596069336  GigaBytes
Max Memory Allocated: 0.5220003128051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11342525482177734  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165448, 128])
torch.Size([161108, 64])
torch.Size([141949, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.49016618728637695  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.1133565902709961  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165507, 128])
torch.Size([161104, 64])
torch.Size([141824, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4893026351928711  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11316299438476562  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165467, 128])
torch.Size([161071, 64])
torch.Size([141681, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.48900938034057617  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11297750473022461  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165499, 128])
torch.Size([161009, 64])
torch.Size([141514, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4886651039123535  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05577045679092407 |0.06260889768600464 |0.09653881192207336 |0.00010332465171813965 |0.01061508059501648 |0.002479076385498047 |
----------------------------------------------------------pseudo_mini_loss sum 5.591457366943359
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292608
Number of first layer input nodes during this epoch:  1324125
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.18188095092773438  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.01997208595275879
range selection method range initialization spend 0.011646747589111328
time for parepare:  0.01664113998413086
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.008479118347167969
mini_batch_src_global generation:  0.0035190582275390625
r_  generation:  0.03780865669250488
local_output_nid generation:  0.003252267837524414
local_in_edges_tensor generation:  0.0016226768493652344
mini_batch_src_global generation:  0.006652116775512695
r_  generation:  0.038405418395996094
local_output_nid generation:  0.003196239471435547
local_in_edges_tensor generation:  0.0017032623291015625
mini_batch_src_global generation:  0.0027396678924560547
r_  generation:  0.03966236114501953
local_output_nid generation:  0.0032279491424560547
local_in_edges_tensor generation:  0.004351139068603516
mini_batch_src_global generation:  0.0028738975524902344
r_  generation:  0.04063701629638672
local_output_nid generation:  0.003344297409057617
local_in_edges_tensor generation:  0.0016026496887207031
mini_batch_src_global generation:  0.0029571056365966797
r_  generation:  0.044304609298706055
local_output_nid generation:  0.0032491683959960938
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.0031080245971679688
r_  generation:  0.041335344314575195
local_output_nid generation:  0.0032012462615966797
local_in_edges_tensor generation:  0.0016088485717773438
mini_batch_src_global generation:  0.003055095672607422
r_  generation:  0.04607963562011719
local_output_nid generation:  0.0036721229553222656
local_in_edges_tensor generation:  0.002528667449951172
mini_batch_src_global generation:  0.0038084983825683594
r_  generation:  0.04335355758666992
----------------------check_connections_block total spend ----------------------------- 0.4975309371948242
generate_one_block  0.05857348442077637
generate_one_block  0.0545954704284668
generate_one_block  0.05634045600891113
generate_one_block  0.05493044853210449
generate_one_block  0.05539393424987793
generate_one_block  0.05503726005554199
generate_one_block  0.05799984931945801
generate_one_block  0.056444406509399414
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05056929588317871
gen group dst list time:  0.015099287033081055
time for parepare:  0.021093130111694336
local_output_nid generation:  0.010659933090209961
local_in_edges_tensor generation:  0.03312087059020996
mini_batch_src_global generation:  0.028493404388427734
r_  generation:  0.3026266098022461
local_output_nid generation:  0.01589035987854004
local_in_edges_tensor generation:  0.02776169776916504
mini_batch_src_global generation:  0.036529541015625
r_  generation:  0.30939531326293945
local_output_nid generation:  0.016087770462036133
local_in_edges_tensor generation:  0.02086806297302246
mini_batch_src_global generation:  0.038637638092041016
r_  generation:  0.31432080268859863
local_output_nid generation:  0.015938520431518555
local_in_edges_tensor generation:  0.0176088809967041
mini_batch_src_global generation:  0.03753256797790527
r_  generation:  0.31358790397644043
local_output_nid generation:  0.016376733779907227
local_in_edges_tensor generation:  0.023302793502807617
mini_batch_src_global generation:  0.04051351547241211
r_  generation:  0.3166999816894531
local_output_nid generation:  0.01671576499938965
local_in_edges_tensor generation:  0.020755767822265625
mini_batch_src_global generation:  0.03845548629760742
r_  generation:  0.32302260398864746
local_output_nid generation:  0.016716480255126953
local_in_edges_tensor generation:  0.02110886573791504
mini_batch_src_global generation:  0.0384063720703125
r_  generation:  0.32587552070617676
local_output_nid generation:  0.01702880859375
local_in_edges_tensor generation:  0.02422022819519043
mini_batch_src_global generation:  0.04107189178466797
r_  generation:  0.3246147632598877
----------------------check_connections_block total spend ----------------------------- 3.70163893699646
generate_one_block  0.4178593158721924
generate_one_block  0.40775442123413086
generate_one_block  0.4118506908416748
generate_one_block  0.4028770923614502
generate_one_block  0.4059782028198242
generate_one_block  0.41815614700317383
generate_one_block  0.41051292419433594
generate_one_block  0.44278430938720703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04292130470275879
gen group dst list time:  0.03719353675842285
time for parepare:  0.018767833709716797
local_output_nid generation:  0.02492070198059082
local_in_edges_tensor generation:  0.07102775573730469
mini_batch_src_global generation:  0.051624298095703125
r_  generation:  0.5127253532409668
local_output_nid generation:  0.03199172019958496
local_in_edges_tensor generation:  0.05009055137634277
mini_batch_src_global generation:  0.05904793739318848
r_  generation:  0.52117919921875
local_output_nid generation:  0.0320897102355957
local_in_edges_tensor generation:  0.03635811805725098
mini_batch_src_global generation:  0.05546998977661133
r_  generation:  0.536266565322876
local_output_nid generation:  0.03430294990539551
local_in_edges_tensor generation:  0.044763803482055664
mini_batch_src_global generation:  0.058890581130981445
r_  generation:  0.5513784885406494
local_output_nid generation:  0.03638887405395508
local_in_edges_tensor generation:  0.044489145278930664
mini_batch_src_global generation:  0.06485939025878906
r_  generation:  0.5392978191375732
local_output_nid generation:  0.03446054458618164
local_in_edges_tensor generation:  0.03703761100769043
mini_batch_src_global generation:  0.05922818183898926
r_  generation:  0.5276412963867188
local_output_nid generation:  0.03458237648010254
local_in_edges_tensor generation:  0.03705143928527832
mini_batch_src_global generation:  0.05722451210021973
r_  generation:  0.5412228107452393
local_output_nid generation:  0.03480243682861328
local_in_edges_tensor generation:  0.04211306571960449
mini_batch_src_global generation:  0.06224322319030762
r_  generation:  0.5302848815917969
----------------------check_connections_block total spend ----------------------------- 6.318838596343994
generate_one_block  0.688683032989502
generate_one_block  0.6813051700592041
generate_one_block  0.672088623046875
generate_one_block  0.6754398345947266
generate_one_block  0.672703742980957
generate_one_block  0.6719455718994141
generate_one_block  0.6795957088470459
generate_one_block  0.6935999393463135
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029528141021728516
gen group dst list time:  0.05359935760498047
time for parepare:  0.01898026466369629
local_output_nid generation:  0.030850887298583984
local_in_edges_tensor generation:  0.05272960662841797
mini_batch_src_global generation:  0.04563117027282715
r_  generation:  0.5373072624206543
local_output_nid generation:  0.0377044677734375
local_in_edges_tensor generation:  0.03655099868774414
mini_batch_src_global generation:  0.05642890930175781
r_  generation:  0.5088915824890137
local_output_nid generation:  0.03661036491394043
local_in_edges_tensor generation:  0.042806148529052734
mini_batch_src_global generation:  0.05895709991455078
r_  generation:  0.5071773529052734
local_output_nid generation:  0.03714323043823242
local_in_edges_tensor generation:  0.04271960258483887
mini_batch_src_global generation:  0.059465646743774414
r_  generation:  0.5196340084075928
local_output_nid generation:  0.037583351135253906
local_in_edges_tensor generation:  0.0381932258605957
mini_batch_src_global generation:  0.05396890640258789
r_  generation:  0.5178656578063965
local_output_nid generation:  0.0375368595123291
local_in_edges_tensor generation:  0.034691810607910156
mini_batch_src_global generation:  0.05415678024291992
r_  generation:  0.525824785232544
local_output_nid generation:  0.037709712982177734
local_in_edges_tensor generation:  0.043250083923339844
mini_batch_src_global generation:  0.055049896240234375
r_  generation:  0.518998384475708
local_output_nid generation:  0.03746652603149414
local_in_edges_tensor generation:  0.04258918762207031
mini_batch_src_global generation:  0.053699493408203125
r_  generation:  0.5276141166687012
----------------------check_connections_block total spend ----------------------------- 6.179607629776001
generate_one_block  0.6315698623657227
generate_one_block  0.6421244144439697
generate_one_block  0.631403923034668
generate_one_block  0.6326308250427246
generate_one_block  0.6396732330322266
generate_one_block  0.6328928470611572
generate_one_block  0.6352403163909912
generate_one_block  0.6452758312225342
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.18188095092773438  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

connection checking time:  16.200085163116455
block generation total time  13.843945980072021
average batch blocks generation time:  1.7304932475090027
block dataloader generation time/epoch 32.3019700050354
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11369895935058594  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165497, 128])
torch.Size([161198, 64])
torch.Size([141962, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4904026985168457  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11363744735717773  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165574, 128])
torch.Size([161328, 64])
torch.Size([142303, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.49120473861694336  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11372089385986328  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165455, 128])
torch.Size([161095, 64])
torch.Size([141777, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4903268814086914  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11358642578125  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165569, 128])
torch.Size([161236, 64])
torch.Size([141874, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.48911619186401367  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11360836029052734  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165557, 128])
torch.Size([161257, 64])
torch.Size([142258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.491335391998291  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11368417739868164  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165534, 128])
torch.Size([161053, 64])
torch.Size([141838, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4896392822265625  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11356258392333984  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165515, 128])
torch.Size([161115, 64])
torch.Size([141808, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4888648986816406  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.11369943618774414  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

torch.Size([165530, 128])
torch.Size([161195, 64])
torch.Size([142176, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.4914369583129883  GigaBytes
Max Memory Allocated: 0.5233597755432129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055860161781311035 |0.025553137063980103 |0.004665672779083252 |9.53972339630127e-05 |0.004585474729537964 |0.003828287124633789 |
----------------------------------------------------------pseudo_mini_loss sum 4.434129238128662
Total (block generation + training)time/epoch 33.0713894367218
Training time/epoch 0.7691237926483154
Training time without block to device /epoch 0.5646986961364746
Training time without total dataloading part /epoch 0.07860064506530762
load block tensor time/epoch 0.4468812942504883
block to device time/epoch 0.20442509651184082
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4292985
Number of first layer input nodes during this epoch:  1324231
