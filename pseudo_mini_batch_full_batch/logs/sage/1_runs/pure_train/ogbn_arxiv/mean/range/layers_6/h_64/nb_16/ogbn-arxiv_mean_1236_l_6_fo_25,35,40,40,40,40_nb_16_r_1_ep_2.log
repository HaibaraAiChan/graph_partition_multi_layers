Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648516373.6352122
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02418208122253418
range selection method range initialization spend 0.012760400772094727
time for parepare:  0.01775193214416504
local_output_nid generation:  0.0013208389282226562
local_in_edges_tensor generation:  0.003994464874267578
mini_batch_src_global generation:  0.0016865730285644531
r_  generation:  0.016839027404785156
local_output_nid generation:  0.0013895034790039062
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.0018241405487060547
r_  generation:  0.01650381088256836
local_output_nid generation:  0.0014202594757080078
local_in_edges_tensor generation:  0.0008428096771240234
mini_batch_src_global generation:  0.00128936767578125
r_  generation:  0.016638755798339844
local_output_nid generation:  0.0014541149139404297
local_in_edges_tensor generation:  0.0008170604705810547
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.016758441925048828
local_output_nid generation:  0.001486063003540039
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.01689624786376953
local_output_nid generation:  0.001466512680053711
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0013866424560546875
r_  generation:  0.017796039581298828
local_output_nid generation:  0.0014867782592773438
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.001325368881225586
r_  generation:  0.017377138137817383
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0007987022399902344
mini_batch_src_global generation:  0.001390218734741211
r_  generation:  0.017493247985839844
local_output_nid generation:  0.0014889240264892578
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0014140605926513672
r_  generation:  0.017342090606689453
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0008127689361572266
mini_batch_src_global generation:  0.0012819766998291016
r_  generation:  0.017964839935302734
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0014209747314453125
r_  generation:  0.017841339111328125
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.0013451576232910156
r_  generation:  0.017711162567138672
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0008389949798583984
mini_batch_src_global generation:  0.001432180404663086
r_  generation:  0.018157243728637695
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0012710094451904297
r_  generation:  0.017914295196533203
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0014362335205078125
r_  generation:  0.017831802368164062
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0013096332550048828
r_  generation:  0.017908811569213867
----------------------check_connections_block total spend ----------------------------- 0.42218637466430664
generate_one_block  0.026905059814453125
generate_one_block  0.025977611541748047
generate_one_block  0.025951385498046875
generate_one_block  0.02744770050048828
generate_one_block  0.026409149169921875
generate_one_block  0.02654290199279785
generate_one_block  0.02555394172668457
generate_one_block  0.025964975357055664
generate_one_block  0.026030540466308594
generate_one_block  0.026137113571166992
generate_one_block  0.026276588439941406
generate_one_block  0.027080774307250977
generate_one_block  0.026736736297607422
generate_one_block  0.027665376663208008
generate_one_block  0.026529550552368164
generate_one_block  0.027103900909423828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04058122634887695
gen group dst list time:  0.018323421478271484
time for parepare:  0.01951909065246582
local_output_nid generation:  0.006591320037841797
local_in_edges_tensor generation:  0.017963409423828125
mini_batch_src_global generation:  0.01936507225036621
r_  generation:  0.19684600830078125
local_output_nid generation:  0.012354612350463867
local_in_edges_tensor generation:  0.019588232040405273
mini_batch_src_global generation:  0.024518251419067383
r_  generation:  0.20392847061157227
local_output_nid generation:  0.012716293334960938
local_in_edges_tensor generation:  0.016420841217041016
mini_batch_src_global generation:  0.023708581924438477
r_  generation:  0.21103906631469727
local_output_nid generation:  0.012988090515136719
local_in_edges_tensor generation:  0.01677703857421875
mini_batch_src_global generation:  0.025009870529174805
r_  generation:  0.20757651329040527
local_output_nid generation:  0.013480901718139648
local_in_edges_tensor generation:  0.018936872482299805
mini_batch_src_global generation:  0.026133060455322266
r_  generation:  0.2166602611541748
local_output_nid generation:  0.013834953308105469
local_in_edges_tensor generation:  0.019315481185913086
mini_batch_src_global generation:  0.02682805061340332
r_  generation:  0.22210288047790527
local_output_nid generation:  0.013839960098266602
local_in_edges_tensor generation:  0.013640880584716797
mini_batch_src_global generation:  0.026733875274658203
r_  generation:  0.21108317375183105
local_output_nid generation:  0.01405024528503418
local_in_edges_tensor generation:  0.01374959945678711
mini_batch_src_global generation:  0.02829718589782715
r_  generation:  0.21600580215454102
local_output_nid generation:  0.013941764831542969
local_in_edges_tensor generation:  0.01349186897277832
mini_batch_src_global generation:  0.026775121688842773
r_  generation:  0.21958565711975098
local_output_nid generation:  0.014142751693725586
local_in_edges_tensor generation:  0.015370845794677734
mini_batch_src_global generation:  0.026459217071533203
r_  generation:  0.21487689018249512
local_output_nid generation:  0.014196157455444336
local_in_edges_tensor generation:  0.021477460861206055
mini_batch_src_global generation:  0.026867151260375977
r_  generation:  0.22249555587768555
local_output_nid generation:  0.013956785202026367
local_in_edges_tensor generation:  0.01424098014831543
mini_batch_src_global generation:  0.02983689308166504
r_  generation:  0.218186616897583
local_output_nid generation:  0.014419317245483398
local_in_edges_tensor generation:  0.014138221740722656
mini_batch_src_global generation:  0.026676416397094727
r_  generation:  0.21495938301086426
local_output_nid generation:  0.014285802841186523
local_in_edges_tensor generation:  0.017618656158447266
mini_batch_src_global generation:  0.02700328826904297
r_  generation:  0.21868324279785156
local_output_nid generation:  0.014147758483886719
local_in_edges_tensor generation:  0.01592254638671875
mini_batch_src_global generation:  0.02701425552368164
r_  generation:  0.22087836265563965
local_output_nid generation:  0.014396429061889648
local_in_edges_tensor generation:  0.017851591110229492
mini_batch_src_global generation:  0.02726292610168457
r_  generation:  0.21731925010681152
----------------------check_connections_block total spend ----------------------------- 5.111435174942017
generate_one_block  0.2808244228363037
generate_one_block  0.2818174362182617
generate_one_block  0.27673816680908203
generate_one_block  0.271869421005249
generate_one_block  0.3066062927246094
generate_one_block  0.28654909133911133
generate_one_block  0.2720353603363037
generate_one_block  0.2769336700439453
generate_one_block  0.2748067378997803
generate_one_block  0.281660795211792
generate_one_block  0.2938675880432129
generate_one_block  0.27286314964294434
generate_one_block  0.27448534965515137
generate_one_block  0.28754568099975586
generate_one_block  0.27701234817504883
generate_one_block  0.2891976833343506
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.037450313568115234
gen group dst list time:  0.05886673927307129
time for parepare:  0.019315719604492188
local_output_nid generation:  0.023802757263183594
local_in_edges_tensor generation:  0.04112076759338379
mini_batch_src_global generation:  0.05010104179382324
r_  generation:  0.4815254211425781
local_output_nid generation:  0.029598236083984375
local_in_edges_tensor generation:  0.048367977142333984
mini_batch_src_global generation:  0.05901598930358887
r_  generation:  0.49314451217651367
local_output_nid generation:  0.0301513671875
local_in_edges_tensor generation:  0.049758195877075195
mini_batch_src_global generation:  0.05627727508544922
r_  generation:  0.49870920181274414
local_output_nid generation:  0.030606985092163086
local_in_edges_tensor generation:  0.03769326210021973
mini_batch_src_global generation:  0.05816793441772461
r_  generation:  0.4876391887664795
local_output_nid generation:  0.033644676208496094
local_in_edges_tensor generation:  0.04112863540649414
mini_batch_src_global generation:  0.0635676383972168
r_  generation:  0.49739599227905273
local_output_nid generation:  0.03024911880493164
local_in_edges_tensor generation:  0.03707385063171387
mini_batch_src_global generation:  0.060645103454589844
r_  generation:  0.5093722343444824
local_output_nid generation:  0.03072643280029297
local_in_edges_tensor generation:  0.033158302307128906
mini_batch_src_global generation:  0.058035850524902344
r_  generation:  0.5045804977416992
local_output_nid generation:  0.03324294090270996
local_in_edges_tensor generation:  0.04209613800048828
mini_batch_src_global generation:  0.05858302116394043
r_  generation:  0.49677062034606934
local_output_nid generation:  0.03160834312438965
local_in_edges_tensor generation:  0.034517526626586914
mini_batch_src_global generation:  0.05839347839355469
r_  generation:  0.5033242702484131
local_output_nid generation:  0.03179025650024414
local_in_edges_tensor generation:  0.03391695022583008
mini_batch_src_global generation:  0.05900168418884277
r_  generation:  0.49860429763793945
local_output_nid generation:  0.03165793418884277
local_in_edges_tensor generation:  0.04683184623718262
mini_batch_src_global generation:  0.05943727493286133
r_  generation:  0.5006296634674072
local_output_nid generation:  0.031351327896118164
local_in_edges_tensor generation:  0.02896714210510254
mini_batch_src_global generation:  0.06673264503479004
r_  generation:  0.4962136745452881
local_output_nid generation:  0.031302452087402344
local_in_edges_tensor generation:  0.029963970184326172
mini_batch_src_global generation:  0.05832052230834961
r_  generation:  0.5031354427337646
local_output_nid generation:  0.031551361083984375
local_in_edges_tensor generation:  0.03983783721923828
mini_batch_src_global generation:  0.058632612228393555
r_  generation:  0.49737095832824707
local_output_nid generation:  0.031280517578125
local_in_edges_tensor generation:  0.0338749885559082
mini_batch_src_global generation:  0.05842018127441406
r_  generation:  0.5102188587188721
local_output_nid generation:  0.032210588455200195
local_in_edges_tensor generation:  0.04064583778381348
mini_batch_src_global generation:  0.05967831611633301
r_  generation:  0.5058393478393555
----------------------check_connections_block total spend ----------------------------- 11.779110670089722
generate_one_block  0.6742784976959229
generate_one_block  0.664942741394043
generate_one_block  0.6599266529083252
generate_one_block  0.6368999481201172
generate_one_block  0.6986067295074463
generate_one_block  0.6513502597808838
generate_one_block  0.7369015216827393
generate_one_block  0.6712191104888916
generate_one_block  0.688697338104248
generate_one_block  0.6728911399841309
generate_one_block  0.6499860286712646
generate_one_block  0.64823317527771
generate_one_block  0.6580655574798584
generate_one_block  0.6479208469390869
generate_one_block  0.6456177234649658
generate_one_block  0.6684491634368896
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.08378815650939941
gen group dst list time:  0.10449504852294922
time for parepare:  0.019538164138793945
local_output_nid generation:  0.03236579895019531
local_in_edges_tensor generation:  0.0577850341796875
mini_batch_src_global generation:  0.056313276290893555
r_  generation:  0.5400278568267822
local_output_nid generation:  0.038962364196777344
local_in_edges_tensor generation:  0.055612802505493164
mini_batch_src_global generation:  0.06681180000305176
r_  generation:  0.5441739559173584
local_output_nid generation:  0.039598941802978516
local_in_edges_tensor generation:  0.04635119438171387
mini_batch_src_global generation:  0.06103324890136719
r_  generation:  0.5577418804168701
local_output_nid generation:  0.03956437110900879
local_in_edges_tensor generation:  0.03652644157409668
mini_batch_src_global generation:  0.061186790466308594
r_  generation:  0.5611979961395264
local_output_nid generation:  0.04895281791687012
local_in_edges_tensor generation:  0.04101967811584473
mini_batch_src_global generation:  0.06098794937133789
r_  generation:  0.5639407634735107
local_output_nid generation:  0.03876304626464844
local_in_edges_tensor generation:  0.041023969650268555
mini_batch_src_global generation:  0.0625298023223877
r_  generation:  0.591639518737793
local_output_nid generation:  0.03992724418640137
local_in_edges_tensor generation:  0.05063295364379883
mini_batch_src_global generation:  0.06201577186584473
r_  generation:  0.5665807723999023
local_output_nid generation:  0.03830695152282715
local_in_edges_tensor generation:  0.03740215301513672
mini_batch_src_global generation:  0.06182217597961426
r_  generation:  0.5604269504547119
local_output_nid generation:  0.038247108459472656
local_in_edges_tensor generation:  0.044492244720458984
mini_batch_src_global generation:  0.060938358306884766
r_  generation:  0.570340633392334
local_output_nid generation:  0.03886604309082031
local_in_edges_tensor generation:  0.049685001373291016
mini_batch_src_global generation:  0.06142616271972656
r_  generation:  0.5611047744750977
local_output_nid generation:  0.03862404823303223
local_in_edges_tensor generation:  0.03738594055175781
mini_batch_src_global generation:  0.061693429946899414
r_  generation:  0.5711460113525391
local_output_nid generation:  0.03876233100891113
local_in_edges_tensor generation:  0.039611101150512695
mini_batch_src_global generation:  0.06780743598937988
r_  generation:  0.5818917751312256
local_output_nid generation:  0.03857874870300293
local_in_edges_tensor generation:  0.04452157020568848
mini_batch_src_global generation:  0.06797099113464355
r_  generation:  0.5745551586151123
local_output_nid generation:  0.040596961975097656
local_in_edges_tensor generation:  0.0446319580078125
mini_batch_src_global generation:  0.0625917911529541
r_  generation:  0.5644445419311523
local_output_nid generation:  0.03864479064941406
local_in_edges_tensor generation:  0.04687929153442383
mini_batch_src_global generation:  0.06280112266540527
r_  generation:  0.5707955360412598
local_output_nid generation:  0.038695335388183594
local_in_edges_tensor generation:  0.04146885871887207
mini_batch_src_global generation:  0.0626993179321289
r_  generation:  0.564856767654419
----------------------check_connections_block total spend ----------------------------- 13.492035865783691
generate_one_block  0.693713903427124
generate_one_block  0.7074892520904541
generate_one_block  0.7025284767150879
generate_one_block  0.784257173538208
generate_one_block  0.6925737857818604
generate_one_block  0.6906161308288574
generate_one_block  0.7154405117034912
generate_one_block  0.6822781562805176
generate_one_block  0.6920952796936035
generate_one_block  0.7163317203521729
generate_one_block  0.6855058670043945
generate_one_block  0.6919617652893066
generate_one_block  0.6814398765563965
generate_one_block  0.7108154296875
generate_one_block  0.705040693283081
generate_one_block  0.6992344856262207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042549848556518555
gen group dst list time:  0.09897446632385254
time for parepare:  0.01907491683959961
local_output_nid generation:  0.03481340408325195
local_in_edges_tensor generation:  0.05967569351196289
mini_batch_src_global generation:  0.05174899101257324
r_  generation:  0.5380663871765137
local_output_nid generation:  0.04122161865234375
local_in_edges_tensor generation:  0.04506659507751465
mini_batch_src_global generation:  0.06275629997253418
r_  generation:  0.539278507232666
local_output_nid generation:  0.03859734535217285
local_in_edges_tensor generation:  0.04043269157409668
mini_batch_src_global generation:  0.06286859512329102
r_  generation:  0.5523717403411865
local_output_nid generation:  0.03929710388183594
local_in_edges_tensor generation:  0.0402371883392334
mini_batch_src_global generation:  0.06678628921508789
r_  generation:  0.544231653213501
local_output_nid generation:  0.03843569755554199
local_in_edges_tensor generation:  0.04011797904968262
mini_batch_src_global generation:  0.061846256256103516
r_  generation:  0.5481669902801514
local_output_nid generation:  0.04086041450500488
local_in_edges_tensor generation:  0.04012274742126465
mini_batch_src_global generation:  0.06185507774353027
r_  generation:  0.5466187000274658
local_output_nid generation:  0.0399019718170166
local_in_edges_tensor generation:  0.04049849510192871
mini_batch_src_global generation:  0.06126880645751953
r_  generation:  0.5501770973205566
local_output_nid generation:  0.03992319107055664
local_in_edges_tensor generation:  0.04573559761047363
mini_batch_src_global generation:  0.06146526336669922
r_  generation:  0.5484509468078613
local_output_nid generation:  0.0401003360748291
local_in_edges_tensor generation:  0.0403742790222168
mini_batch_src_global generation:  0.06469869613647461
r_  generation:  0.5512263774871826
local_output_nid generation:  0.0402219295501709
local_in_edges_tensor generation:  0.045267581939697266
mini_batch_src_global generation:  0.06432318687438965
r_  generation:  0.5655844211578369
local_output_nid generation:  0.04038643836975098
local_in_edges_tensor generation:  0.046115875244140625
mini_batch_src_global generation:  0.061692237854003906
r_  generation:  0.5530352592468262
local_output_nid generation:  0.04030323028564453
local_in_edges_tensor generation:  0.03575253486633301
mini_batch_src_global generation:  0.06167411804199219
r_  generation:  0.5540454387664795
local_output_nid generation:  0.04005074501037598
local_in_edges_tensor generation:  0.0361332893371582
mini_batch_src_global generation:  0.06189465522766113
r_  generation:  0.5591514110565186
local_output_nid generation:  0.04027390480041504
local_in_edges_tensor generation:  0.04583120346069336
mini_batch_src_global generation:  0.061010122299194336
r_  generation:  0.5570790767669678
local_output_nid generation:  0.04018688201904297
local_in_edges_tensor generation:  0.050169944763183594
mini_batch_src_global generation:  0.06812667846679688
r_  generation:  0.5571548938751221
local_output_nid generation:  0.040154457092285156
local_in_edges_tensor generation:  0.03648638725280762
mini_batch_src_global generation:  0.06195950508117676
r_  generation:  0.5600485801696777
----------------------check_connections_block total spend ----------------------------- 13.22843050956726
generate_one_block  0.6834368705749512
generate_one_block  0.6814064979553223
generate_one_block  0.7095375061035156
generate_one_block  0.7129569053649902
generate_one_block  0.6759936809539795
generate_one_block  0.6736202239990234
generate_one_block  0.755561351776123
generate_one_block  0.6855266094207764
generate_one_block  0.6778266429901123
generate_one_block  0.6976151466369629
generate_one_block  0.6981174945831299
generate_one_block  0.6915903091430664
generate_one_block  0.6780514717102051
generate_one_block  0.7117314338684082
generate_one_block  0.6952314376831055
generate_one_block  0.6814548969268799
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03938579559326172
gen group dst list time:  0.1084902286529541
time for parepare:  0.019051551818847656
local_output_nid generation:  0.034772634506225586
local_in_edges_tensor generation:  0.05229926109313965
mini_batch_src_global generation:  0.04543042182922363
r_  generation:  0.498960018157959
local_output_nid generation:  0.041353702545166016
local_in_edges_tensor generation:  0.0391387939453125
mini_batch_src_global generation:  0.05776619911193848
r_  generation:  0.5036280155181885
local_output_nid generation:  0.03964805603027344
local_in_edges_tensor generation:  0.03550124168395996
mini_batch_src_global generation:  0.05890369415283203
r_  generation:  0.512995719909668
local_output_nid generation:  0.039340972900390625
local_in_edges_tensor generation:  0.035778045654296875
mini_batch_src_global generation:  0.05762481689453125
r_  generation:  0.5060520172119141
local_output_nid generation:  0.03963518142700195
local_in_edges_tensor generation:  0.03565859794616699
mini_batch_src_global generation:  0.05800676345825195
r_  generation:  0.5059285163879395
local_output_nid generation:  0.03979802131652832
local_in_edges_tensor generation:  0.035689592361450195
mini_batch_src_global generation:  0.05839681625366211
r_  generation:  0.5097806453704834
local_output_nid generation:  0.03988456726074219
local_in_edges_tensor generation:  0.04468417167663574
mini_batch_src_global generation:  0.0572667121887207
r_  generation:  0.5062787532806396
local_output_nid generation:  0.039678335189819336
local_in_edges_tensor generation:  0.03636622428894043
mini_batch_src_global generation:  0.058357954025268555
r_  generation:  0.5096664428710938
local_output_nid generation:  0.04005122184753418
local_in_edges_tensor generation:  0.04023170471191406
mini_batch_src_global generation:  0.05782747268676758
r_  generation:  0.5152978897094727
local_output_nid generation:  0.04015827178955078
local_in_edges_tensor generation:  0.04773378372192383
mini_batch_src_global generation:  0.05842924118041992
r_  generation:  0.5124673843383789
local_output_nid generation:  0.040404558181762695
local_in_edges_tensor generation:  0.045533180236816406
mini_batch_src_global generation:  0.057668447494506836
r_  generation:  0.5140385627746582
local_output_nid generation:  0.040221214294433594
local_in_edges_tensor generation:  0.036087751388549805
mini_batch_src_global generation:  0.058302879333496094
r_  generation:  0.5138018131256104
local_output_nid generation:  0.0401463508605957
local_in_edges_tensor generation:  0.03637528419494629
mini_batch_src_global generation:  0.06119728088378906
r_  generation:  0.5136899948120117
local_output_nid generation:  0.040085554122924805
local_in_edges_tensor generation:  0.04524517059326172
mini_batch_src_global generation:  0.05788779258728027
r_  generation:  0.5143296718597412
local_output_nid generation:  0.04038071632385254
local_in_edges_tensor generation:  0.04542279243469238
mini_batch_src_global generation:  0.05790877342224121
r_  generation:  0.5160682201385498
local_output_nid generation:  0.04040026664733887
local_in_edges_tensor generation:  0.03644824028015137
mini_batch_src_global generation:  0.05816912651062012
r_  generation:  0.5158200263977051
----------------------check_connections_block total spend ----------------------------- 12.329024076461792
generate_one_block  0.6344954967498779
generate_one_block  0.6392526626586914
generate_one_block  0.6441724300384521
generate_one_block  0.6389801502227783
generate_one_block  0.6307740211486816
generate_one_block  0.6418173313140869
generate_one_block  0.6506924629211426
generate_one_block  0.6292474269866943
generate_one_block  0.7005636692047119
generate_one_block  0.651193380355835
generate_one_block  0.640512228012085
generate_one_block  0.6290237903594971
generate_one_block  0.6416959762573242
generate_one_block  0.6539559364318848
generate_one_block  0.6562910079956055
generate_one_block  0.6297578811645508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

connection checking time:  55.94003629684448
block generation total time  47.85220646858215
average batch blocks generation time:  2.9907629042863846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1351933479309082  GigaBytes
Max Memory Allocated: 0.1351933479309082  GigaBytes

torch.Size([167259, 128])
torch.Size([166451, 64])
torch.Size([163963, 64])
torch.Size([155787, 64])
torch.Size([123517, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.8171124458312988  GigaBytes
Max Memory Allocated: 0.8248028755187988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13643407821655273  GigaBytes
Max Memory Allocated: 0.8391842842102051  GigaBytes

torch.Size([167266, 128])
torch.Size([166423, 64])
torch.Size([164074, 64])
torch.Size([156011, 64])
torch.Size([124104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8193817138671875  GigaBytes
Max Memory Allocated: 0.8391842842102051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364445686340332  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167252, 128])
torch.Size([166483, 64])
torch.Size([164106, 64])
torch.Size([155787, 64])
torch.Size([124105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8192763328552246  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13638067245483398  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167249, 128])
torch.Size([166441, 64])
torch.Size([164074, 64])
torch.Size([155858, 64])
torch.Size([123560, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8184266090393066  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364307403564453  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167204, 128])
torch.Size([166392, 64])
torch.Size([163930, 64])
torch.Size([155741, 64])
torch.Size([123820, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8190784454345703  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364121437072754  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167242, 128])
torch.Size([166432, 64])
torch.Size([163907, 64])
torch.Size([155248, 64])
torch.Size([123300, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8179068565368652  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13640308380126953  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167274, 128])
torch.Size([166485, 64])
torch.Size([164194, 64])
torch.Size([156040, 64])
torch.Size([123920, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8192410469055176  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13642501831054688  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167229, 128])
torch.Size([166386, 64])
torch.Size([163962, 64])
torch.Size([155773, 64])
torch.Size([123963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8190960884094238  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1364126205444336  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167222, 128])
torch.Size([166405, 64])
torch.Size([163914, 64])
torch.Size([155709, 64])
torch.Size([123878, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.8185110092163086  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.13641929626464844  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167237, 128])
torch.Size([166447, 64])
torch.Size([164093, 64])
torch.Size([156092, 64])
torch.Size([123997, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8197751045227051  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13643550872802734  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167243, 128])
torch.Size([166402, 64])
torch.Size([163952, 64])
torch.Size([155665, 64])
torch.Size([123950, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.819298267364502  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13640260696411133  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167225, 128])
torch.Size([166400, 64])
torch.Size([163958, 64])
torch.Size([155696, 64])
torch.Size([123298, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8178906440734863  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13638925552368164  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167255, 128])
torch.Size([166391, 64])
torch.Size([163945, 64])
torch.Size([155580, 64])
torch.Size([123449, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8183145523071289  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1364450454711914  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

torch.Size([167282, 128])
torch.Size([166474, 64])
torch.Size([164127, 64])
torch.Size([155999, 64])
torch.Size([124053, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8197312355041504  GigaBytes
Max Memory Allocated: 0.8416538238525391  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13641977310180664  GigaBytes
Max Memory Allocated: 0.841742992401123  GigaBytes

torch.Size([167276, 128])
torch.Size([166446, 64])
torch.Size([164092, 64])
torch.Size([155833, 64])
torch.Size([123953, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8190312385559082  GigaBytes
Max Memory Allocated: 0.841742992401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13644981384277344  GigaBytes
Max Memory Allocated: 0.841742992401123  GigaBytes

torch.Size([167268, 128])
torch.Size([166470, 64])
torch.Size([164108, 64])
torch.Size([155882, 64])
torch.Size([124331, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8199310302734375  GigaBytes
Max Memory Allocated: 0.841742992401123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0732015073299408 |0.0680350810289383 |0.048749834299087524 |9.645521640777588e-05 |0.02020987868309021 |0.007189035415649414 |
----------------------------------------------------------pseudo_mini_loss sum 5.3113861083984375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13097849
Number of first layer input nodes during this epoch:  2675983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.25421953201293945  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.018778324127197266
range selection method range initialization spend 0.01158905029296875
time for parepare:  0.01726222038269043
local_output_nid generation:  0.0013887882232666016
local_in_edges_tensor generation:  0.006606578826904297
mini_batch_src_global generation:  0.0019199848175048828
r_  generation:  0.0203704833984375
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.0019750595092773438
r_  generation:  0.0188448429107666
local_output_nid generation:  0.0015265941619873047
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0014390945434570312
r_  generation:  0.01881098747253418
local_output_nid generation:  0.0016522407531738281
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0014569759368896484
r_  generation:  0.018979310989379883
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0008666515350341797
mini_batch_src_global generation:  0.001420736312866211
r_  generation:  0.01884913444519043
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.001459360122680664
r_  generation:  0.018644332885742188
local_output_nid generation:  0.0015206336975097656
local_in_edges_tensor generation:  0.0008225440979003906
mini_batch_src_global generation:  0.0014476776123046875
r_  generation:  0.019253015518188477
local_output_nid generation:  0.001569509506225586
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.001462697982788086
r_  generation:  0.019188642501831055
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.01924896240234375
local_output_nid generation:  0.0015189647674560547
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0015196800231933594
r_  generation:  0.01963949203491211
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0008327960968017578
mini_batch_src_global generation:  0.0015087127685546875
r_  generation:  0.01938462257385254
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.0015261173248291016
r_  generation:  0.019668102264404297
local_output_nid generation:  0.0015568733215332031
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.01972365379333496
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.019520998001098633
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0015196800231933594
r_  generation:  0.019658327102661133
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.0015010833740234375
r_  generation:  0.019066810607910156
----------------------check_connections_block total spend ----------------------------- 0.4629800319671631
generate_one_block  0.030387401580810547
generate_one_block  0.02745509147644043
generate_one_block  0.027359485626220703
generate_one_block  0.02754688262939453
generate_one_block  0.027776241302490234
generate_one_block  0.02892589569091797
generate_one_block  0.027582645416259766
generate_one_block  0.02755570411682129
generate_one_block  0.02785801887512207
generate_one_block  0.027920007705688477
generate_one_block  0.0275728702545166
generate_one_block  0.028084278106689453
generate_one_block  0.02846050262451172
generate_one_block  0.02798938751220703
generate_one_block  0.028591156005859375
generate_one_block  0.02781987190246582
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.038208961486816406
gen group dst list time:  0.016590595245361328
time for parepare:  0.018702983856201172
local_output_nid generation:  0.0064334869384765625
local_in_edges_tensor generation:  0.016777515411376953
mini_batch_src_global generation:  0.021043777465820312
r_  generation:  0.20196986198425293
local_output_nid generation:  0.01001596450805664
local_in_edges_tensor generation:  0.01719522476196289
mini_batch_src_global generation:  0.024576663970947266
r_  generation:  0.20676732063293457
local_output_nid generation:  0.010904550552368164
local_in_edges_tensor generation:  0.016278743743896484
mini_batch_src_global generation:  0.023905038833618164
r_  generation:  0.21795988082885742
local_output_nid generation:  0.011124610900878906
local_in_edges_tensor generation:  0.01611018180847168
mini_batch_src_global generation:  0.024959802627563477
r_  generation:  0.2155163288116455
local_output_nid generation:  0.011205911636352539
local_in_edges_tensor generation:  0.014546632766723633
mini_batch_src_global generation:  0.026258468627929688
r_  generation:  0.21863222122192383
local_output_nid generation:  0.010864973068237305
local_in_edges_tensor generation:  0.010770082473754883
mini_batch_src_global generation:  0.026274681091308594
r_  generation:  0.215531587600708
local_output_nid generation:  0.011596202850341797
local_in_edges_tensor generation:  0.01107931137084961
mini_batch_src_global generation:  0.02651357650756836
r_  generation:  0.21960663795471191
local_output_nid generation:  0.011658668518066406
local_in_edges_tensor generation:  0.01139521598815918
mini_batch_src_global generation:  0.0271451473236084
r_  generation:  0.21654701232910156
local_output_nid generation:  0.011867284774780273
local_in_edges_tensor generation:  0.014110565185546875
mini_batch_src_global generation:  0.027213335037231445
r_  generation:  0.2234046459197998
local_output_nid generation:  0.011965274810791016
local_in_edges_tensor generation:  0.01699376106262207
mini_batch_src_global generation:  0.027809858322143555
r_  generation:  0.2223522663116455
local_output_nid generation:  0.011900186538696289
local_in_edges_tensor generation:  0.011701822280883789
mini_batch_src_global generation:  0.02944660186767578
r_  generation:  0.2217552661895752
local_output_nid generation:  0.012054204940795898
local_in_edges_tensor generation:  0.015325307846069336
mini_batch_src_global generation:  0.029431819915771484
r_  generation:  0.21782541275024414
local_output_nid generation:  0.014825105667114258
local_in_edges_tensor generation:  0.019219636917114258
mini_batch_src_global generation:  0.028876304626464844
r_  generation:  0.22542595863342285
local_output_nid generation:  0.01321268081665039
local_in_edges_tensor generation:  0.01406240463256836
mini_batch_src_global generation:  0.0315244197845459
r_  generation:  0.22760224342346191
local_output_nid generation:  0.013242721557617188
local_in_edges_tensor generation:  0.014983415603637695
mini_batch_src_global generation:  0.029096126556396484
r_  generation:  0.22555303573608398
local_output_nid generation:  0.011722326278686523
local_in_edges_tensor generation:  0.012874603271484375
mini_batch_src_global generation:  0.02721428871154785
r_  generation:  0.2211000919342041
----------------------check_connections_block total spend ----------------------------- 5.147932291030884
generate_one_block  0.28057074546813965
generate_one_block  0.27254271507263184
generate_one_block  0.2809922695159912
generate_one_block  0.27956223487854004
generate_one_block  0.2827451229095459
generate_one_block  0.27140092849731445
generate_one_block  0.3029491901397705
generate_one_block  0.2800939083099365
generate_one_block  0.2855839729309082
generate_one_block  0.31032538414001465
generate_one_block  0.2926299571990967
generate_one_block  0.2832214832305908
generate_one_block  0.29610347747802734
generate_one_block  0.2864530086517334
generate_one_block  0.2795581817626953
generate_one_block  0.2752525806427002
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.08080697059631348
gen group dst list time:  0.06811738014221191
time for parepare:  0.017805814743041992
local_output_nid generation:  0.024245500564575195
local_in_edges_tensor generation:  0.059581756591796875
mini_batch_src_global generation:  0.046819448471069336
r_  generation:  0.5023455619812012
local_output_nid generation:  0.029335737228393555
local_in_edges_tensor generation:  0.049405574798583984
mini_batch_src_global generation:  0.05879688262939453
r_  generation:  0.4990062713623047
local_output_nid generation:  0.030242919921875
local_in_edges_tensor generation:  0.03980278968811035
mini_batch_src_global generation:  0.060904502868652344
r_  generation:  0.524616003036499
local_output_nid generation:  0.03373599052429199
local_in_edges_tensor generation:  0.04959583282470703
mini_batch_src_global generation:  0.06384658813476562
r_  generation:  0.49547386169433594
local_output_nid generation:  0.03118157386779785
local_in_edges_tensor generation:  0.1003108024597168
mini_batch_src_global generation:  0.06134533882141113
r_  generation:  0.5028190612792969
local_output_nid generation:  0.030039548873901367
local_in_edges_tensor generation:  0.035288095474243164
mini_batch_src_global generation:  0.06201744079589844
r_  generation:  0.49901366233825684
local_output_nid generation:  0.030153989791870117
local_in_edges_tensor generation:  0.03185296058654785
mini_batch_src_global generation:  0.05967307090759277
r_  generation:  0.5139284133911133
local_output_nid generation:  0.030117511749267578
local_in_edges_tensor generation:  0.03581118583679199
mini_batch_src_global generation:  0.0601348876953125
r_  generation:  0.5008480548858643
local_output_nid generation:  0.030494213104248047
local_in_edges_tensor generation:  0.03676128387451172
mini_batch_src_global generation:  0.07742190361022949
r_  generation:  0.5098874568939209
local_output_nid generation:  0.030457496643066406
local_in_edges_tensor generation:  0.0457453727722168
mini_batch_src_global generation:  0.059763431549072266
r_  generation:  0.5024068355560303
local_output_nid generation:  0.030522584915161133
local_in_edges_tensor generation:  0.05457115173339844
mini_batch_src_global generation:  0.05898690223693848
r_  generation:  0.5125768184661865
local_output_nid generation:  0.032103776931762695
local_in_edges_tensor generation:  0.038446903228759766
mini_batch_src_global generation:  0.062200069427490234
r_  generation:  0.5222909450531006
local_output_nid generation:  0.03406810760498047
local_in_edges_tensor generation:  0.03903079032897949
mini_batch_src_global generation:  0.0644068717956543
r_  generation:  0.5066878795623779
local_output_nid generation:  0.03156709671020508
local_in_edges_tensor generation:  0.030608177185058594
mini_batch_src_global generation:  0.06015443801879883
r_  generation:  0.501197099685669
local_output_nid generation:  0.031713247299194336
local_in_edges_tensor generation:  0.03418135643005371
mini_batch_src_global generation:  0.06253886222839355
r_  generation:  0.506659984588623
local_output_nid generation:  0.031641244888305664
local_in_edges_tensor generation:  0.038726091384887695
mini_batch_src_global generation:  0.05936479568481445
r_  generation:  0.4991626739501953
----------------------check_connections_block total spend ----------------------------- 12.051227807998657
generate_one_block  0.6555583477020264
generate_one_block  0.6518874168395996
generate_one_block  0.661898136138916
generate_one_block  0.6550135612487793
generate_one_block  0.6585533618927002
generate_one_block  0.6429975032806396
generate_one_block  0.6372485160827637
generate_one_block  0.6439707279205322
generate_one_block  0.691380500793457
generate_one_block  0.6628332138061523
generate_one_block  0.6537189483642578
generate_one_block  0.6605639457702637
generate_one_block  0.6861100196838379
generate_one_block  0.6481955051422119
generate_one_block  0.6541149616241455
generate_one_block  0.6561272144317627
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.045577049255371094
gen group dst list time:  0.0973973274230957
time for parepare:  0.019123077392578125
local_output_nid generation:  0.03159594535827637
local_in_edges_tensor generation:  0.06222796440124512
mini_batch_src_global generation:  0.05432558059692383
r_  generation:  0.5390970706939697
local_output_nid generation:  0.038411617279052734
local_in_edges_tensor generation:  0.05591773986816406
mini_batch_src_global generation:  0.0625312328338623
r_  generation:  0.5435621738433838
local_output_nid generation:  0.03890705108642578
local_in_edges_tensor generation:  0.04088854789733887
mini_batch_src_global generation:  0.058647871017456055
r_  generation:  0.5557188987731934
local_output_nid generation:  0.039057254791259766
local_in_edges_tensor generation:  0.04127359390258789
mini_batch_src_global generation:  0.0584101676940918
r_  generation:  0.5556366443634033
local_output_nid generation:  0.03883647918701172
local_in_edges_tensor generation:  0.0413813591003418
mini_batch_src_global generation:  0.058702945709228516
r_  generation:  0.5605719089508057
local_output_nid generation:  0.03681349754333496
local_in_edges_tensor generation:  0.04118800163269043
mini_batch_src_global generation:  0.05957436561584473
r_  generation:  0.5596480369567871
local_output_nid generation:  0.036431074142456055
local_in_edges_tensor generation:  0.041512250900268555
mini_batch_src_global generation:  0.06048989295959473
r_  generation:  0.5615007877349854
local_output_nid generation:  0.03675270080566406
local_in_edges_tensor generation:  0.04181385040283203
mini_batch_src_global generation:  0.06071877479553223
r_  generation:  0.5602192878723145
local_output_nid generation:  0.037087440490722656
local_in_edges_tensor generation:  0.04188084602355957
mini_batch_src_global generation:  0.06132793426513672
r_  generation:  0.5673971176147461
local_output_nid generation:  0.03689932823181152
local_in_edges_tensor generation:  0.041787147521972656
mini_batch_src_global generation:  0.061814069747924805
r_  generation:  0.5643095970153809
local_output_nid generation:  0.036989688873291016
local_in_edges_tensor generation:  0.041664838790893555
mini_batch_src_global generation:  0.06170511245727539
r_  generation:  0.5687799453735352
local_output_nid generation:  0.03702235221862793
local_in_edges_tensor generation:  0.04185080528259277
mini_batch_src_global generation:  0.06152772903442383
r_  generation:  0.5698347091674805
local_output_nid generation:  0.03697943687438965
local_in_edges_tensor generation:  0.04202723503112793
mini_batch_src_global generation:  0.06178450584411621
r_  generation:  0.5678756237030029
local_output_nid generation:  0.037082672119140625
local_in_edges_tensor generation:  0.04382586479187012
mini_batch_src_global generation:  0.062422990798950195
r_  generation:  0.5646259784698486
local_output_nid generation:  0.03711414337158203
local_in_edges_tensor generation:  0.041304826736450195
mini_batch_src_global generation:  0.0626840591430664
r_  generation:  0.5708134174346924
local_output_nid generation:  0.03699827194213867
local_in_edges_tensor generation:  0.04195451736450195
mini_batch_src_global generation:  0.06252789497375488
r_  generation:  0.5676126480102539
----------------------check_connections_block total spend ----------------------------- 13.35334587097168
generate_one_block  0.7279744148254395
generate_one_block  0.6990063190460205
generate_one_block  0.6971454620361328
generate_one_block  0.692535400390625
generate_one_block  0.6920301914215088
generate_one_block  0.691519021987915
generate_one_block  0.7686047554016113
generate_one_block  0.7479937076568604
generate_one_block  0.7147278785705566
generate_one_block  0.7237541675567627
generate_one_block  0.7183644771575928
generate_one_block  0.7082431316375732
generate_one_block  0.7308971881866455
generate_one_block  0.7019202709197998
generate_one_block  0.7120628356933594
generate_one_block  0.719855785369873
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05214834213256836
gen group dst list time:  0.11765837669372559
time for parepare:  0.019529104232788086
local_output_nid generation:  0.036237239837646484
local_in_edges_tensor generation:  0.05194234848022461
mini_batch_src_global generation:  0.05172467231750488
r_  generation:  0.551081657409668
local_output_nid generation:  0.04166054725646973
local_in_edges_tensor generation:  0.04051828384399414
mini_batch_src_global generation:  0.06538510322570801
r_  generation:  0.5433840751647949
local_output_nid generation:  0.03995966911315918
local_in_edges_tensor generation:  0.03834962844848633
mini_batch_src_global generation:  0.06455278396606445
r_  generation:  0.552030086517334
local_output_nid generation:  0.0402064323425293
local_in_edges_tensor generation:  0.04033041000366211
mini_batch_src_global generation:  0.06221342086791992
r_  generation:  0.5462448596954346
local_output_nid generation:  0.04019498825073242
local_in_edges_tensor generation:  0.0399165153503418
mini_batch_src_global generation:  0.06116318702697754
r_  generation:  0.5651857852935791
local_output_nid generation:  0.04302692413330078
local_in_edges_tensor generation:  0.04045867919921875
mini_batch_src_global generation:  0.0617828369140625
r_  generation:  0.5561642646789551
local_output_nid generation:  0.039414405822753906
local_in_edges_tensor generation:  0.040174245834350586
mini_batch_src_global generation:  0.06148958206176758
r_  generation:  0.5635435581207275
local_output_nid generation:  0.039214134216308594
local_in_edges_tensor generation:  0.04040861129760742
mini_batch_src_global generation:  0.0617215633392334
r_  generation:  0.5581836700439453
local_output_nid generation:  0.04048728942871094
local_in_edges_tensor generation:  0.0409092903137207
mini_batch_src_global generation:  0.06129598617553711
r_  generation:  0.5660250186920166
local_output_nid generation:  0.04120659828186035
local_in_edges_tensor generation:  0.04106712341308594
mini_batch_src_global generation:  0.061783790588378906
r_  generation:  0.562493085861206
local_output_nid generation:  0.04019618034362793
local_in_edges_tensor generation:  0.040488481521606445
mini_batch_src_global generation:  0.0608668327331543
r_  generation:  0.5690910816192627
local_output_nid generation:  0.04029655456542969
local_in_edges_tensor generation:  0.04601478576660156
mini_batch_src_global generation:  0.06242179870605469
r_  generation:  0.5671365261077881
local_output_nid generation:  0.040192604064941406
local_in_edges_tensor generation:  0.048854827880859375
mini_batch_src_global generation:  0.06156015396118164
r_  generation:  0.5782966613769531
local_output_nid generation:  0.04302835464477539
local_in_edges_tensor generation:  0.051500797271728516
mini_batch_src_global generation:  0.062200069427490234
r_  generation:  0.5598268508911133
local_output_nid generation:  0.04133796691894531
local_in_edges_tensor generation:  0.04080009460449219
mini_batch_src_global generation:  0.06134200096130371
r_  generation:  0.5599353313446045
local_output_nid generation:  0.04113006591796875
local_in_edges_tensor generation:  0.03999686241149902
mini_batch_src_global generation:  0.06235766410827637
r_  generation:  0.5577926635742188
----------------------check_connections_block total spend ----------------------------- 13.407275676727295
generate_one_block  0.6952250003814697
generate_one_block  0.7053678035736084
generate_one_block  0.7073144912719727
generate_one_block  0.6980576515197754
generate_one_block  0.7050540447235107
generate_one_block  0.6963789463043213
generate_one_block  0.7010707855224609
generate_one_block  0.6950650215148926
generate_one_block  0.6988956928253174
generate_one_block  0.7929608821868896
generate_one_block  0.6949491500854492
generate_one_block  0.6959872245788574
generate_one_block  0.7009408473968506
generate_one_block  0.6953880786895752
generate_one_block  0.6963293552398682
generate_one_block  0.7116270065307617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05247807502746582
gen group dst list time:  0.11081409454345703
time for parepare:  0.02034783363342285
local_output_nid generation:  0.03662919998168945
local_in_edges_tensor generation:  0.047560930252075195
mini_batch_src_global generation:  0.047327518463134766
r_  generation:  0.5063879489898682
local_output_nid generation:  0.0425107479095459
local_in_edges_tensor generation:  0.04022550582885742
mini_batch_src_global generation:  0.0576016902923584
r_  generation:  0.5098347663879395
local_output_nid generation:  0.042240142822265625
local_in_edges_tensor generation:  0.038976192474365234
mini_batch_src_global generation:  0.05813264846801758
r_  generation:  0.5103025436401367
local_output_nid generation:  0.04260730743408203
local_in_edges_tensor generation:  0.03937268257141113
mini_batch_src_global generation:  0.05848336219787598
r_  generation:  0.5134074687957764
local_output_nid generation:  0.04280996322631836
local_in_edges_tensor generation:  0.03907275199890137
mini_batch_src_global generation:  0.05843234062194824
r_  generation:  0.5107207298278809
local_output_nid generation:  0.04168963432312012
local_in_edges_tensor generation:  0.03868389129638672
mini_batch_src_global generation:  0.0581204891204834
r_  generation:  0.5124874114990234
local_output_nid generation:  0.039972543716430664
local_in_edges_tensor generation:  0.03972744941711426
mini_batch_src_global generation:  0.05750894546508789
r_  generation:  0.5137989521026611
local_output_nid generation:  0.04007077217102051
local_in_edges_tensor generation:  0.039237260818481445
mini_batch_src_global generation:  0.05821061134338379
r_  generation:  0.5230886936187744
local_output_nid generation:  0.04024648666381836
local_in_edges_tensor generation:  0.04389190673828125
mini_batch_src_global generation:  0.05720257759094238
r_  generation:  0.5111613273620605
local_output_nid generation:  0.04043745994567871
local_in_edges_tensor generation:  0.041948556900024414
mini_batch_src_global generation:  0.057634830474853516
r_  generation:  0.5138356685638428
local_output_nid generation:  0.04016685485839844
local_in_edges_tensor generation:  0.0395817756652832
mini_batch_src_global generation:  0.057771921157836914
r_  generation:  0.5138754844665527
local_output_nid generation:  0.04016423225402832
local_in_edges_tensor generation:  0.04357552528381348
mini_batch_src_global generation:  0.05721926689147949
r_  generation:  0.5135939121246338
local_output_nid generation:  0.040366411209106445
local_in_edges_tensor generation:  0.03967714309692383
mini_batch_src_global generation:  0.0579679012298584
r_  generation:  0.52408766746521
local_output_nid generation:  0.04041242599487305
local_in_edges_tensor generation:  0.03912639617919922
mini_batch_src_global generation:  0.057469844818115234
r_  generation:  0.5192797183990479
local_output_nid generation:  0.04066967964172363
local_in_edges_tensor generation:  0.04437613487243652
mini_batch_src_global generation:  0.05710768699645996
r_  generation:  0.5207839012145996
local_output_nid generation:  0.04062056541442871
local_in_edges_tensor generation:  0.04364466667175293
mini_batch_src_global generation:  0.05803108215332031
r_  generation:  0.5189390182495117
----------------------check_connections_block total spend ----------------------------- 12.433835983276367
generate_one_block  0.6488096714019775
generate_one_block  0.637460470199585
generate_one_block  0.6406965255737305
generate_one_block  0.6369364261627197
generate_one_block  0.6414794921875
generate_one_block  0.6371581554412842
generate_one_block  0.6475350856781006
generate_one_block  0.6470184326171875
generate_one_block  0.6456336975097656
generate_one_block  0.6541106700897217
generate_one_block  0.648282527923584
generate_one_block  0.6524930000305176
generate_one_block  0.7124738693237305
generate_one_block  0.6341991424560547
generate_one_block  0.6572928428649902
generate_one_block  0.6402249336242676
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.25421953201293945  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

connection checking time:  56.39361763000488
block generation total time  48.19920897483826
average batch blocks generation time:  3.012450560927391
block dataloader generation time/epoch 108.19114851951599
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13684511184692383  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167223, 128])
torch.Size([166367, 64])
torch.Size([163993, 64])
torch.Size([155800, 64])
torch.Size([124260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8197379112243652  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13679885864257812  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167281, 128])
torch.Size([166505, 64])
torch.Size([164182, 64])
torch.Size([156005, 64])
torch.Size([123695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8192653656005859  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368417739868164  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167168, 128])
torch.Size([166324, 64])
torch.Size([163914, 64])
torch.Size([155864, 64])
torch.Size([123999, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.819765567779541  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13684511184692383  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167301, 128])
torch.Size([166502, 64])
torch.Size([164133, 64])
torch.Size([155787, 64])
torch.Size([123686, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8194074630737305  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368556022644043  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167174, 128])
torch.Size([166353, 64])
torch.Size([163845, 64])
torch.Size([155521, 64])
torch.Size([124116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8194608688354492  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13679790496826172  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167181, 128])
torch.Size([166395, 64])
torch.Size([164038, 64])
torch.Size([155773, 64])
torch.Size([123489, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8185906410217285  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1367812156677246  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167215, 128])
torch.Size([166386, 64])
torch.Size([163887, 64])
torch.Size([155486, 64])
torch.Size([123205, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.818270206451416  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13679218292236328  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167216, 128])
torch.Size([166412, 64])
torch.Size([163918, 64])
torch.Size([155484, 64])
torch.Size([122894, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8176383972167969  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13682270050048828  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167270, 128])
torch.Size([166431, 64])
torch.Size([164009, 64])
torch.Size([155598, 64])
torch.Size([123747, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8191714286804199  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13684320449829102  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167189, 128])
torch.Size([166402, 64])
torch.Size([163966, 64])
torch.Size([155521, 64])
torch.Size([123670, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8189706802368164  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368427276611328  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167276, 128])
torch.Size([166471, 64])
torch.Size([164077, 64])
torch.Size([155783, 64])
torch.Size([123731, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8191709518432617  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368389129638672  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167233, 128])
torch.Size([166450, 64])
torch.Size([164083, 64])
torch.Size([155969, 64])
torch.Size([123841, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8201022148132324  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13688039779663086  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

torch.Size([167268, 128])
torch.Size([166461, 64])
torch.Size([164118, 64])
torch.Size([155929, 64])
torch.Size([124863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.821446418762207  GigaBytes
Max Memory Allocated: 0.8420314788818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.13681793212890625  GigaBytes
Max Memory Allocated: 0.8432836532592773  GigaBytes

torch.Size([167207, 128])
torch.Size([166413, 64])
torch.Size([164024, 64])
torch.Size([155871, 64])
torch.Size([124130, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8197722434997559  GigaBytes
Max Memory Allocated: 0.8432836532592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368565559387207  GigaBytes
Max Memory Allocated: 0.8432836532592773  GigaBytes

torch.Size([167210, 128])
torch.Size([166448, 64])
torch.Size([164040, 64])
torch.Size([155890, 64])
torch.Size([124233, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8202929496765137  GigaBytes
Max Memory Allocated: 0.8432836532592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.1368393898010254  GigaBytes
Max Memory Allocated: 0.8432836532592773  GigaBytes

torch.Size([167257, 128])
torch.Size([166467, 64])
torch.Size([164101, 64])
torch.Size([155870, 64])
torch.Size([123898, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 0.8193340301513672  GigaBytes
Max Memory Allocated: 0.8432836532592773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07333476841449738 |0.04728753864765167 |0.006628543138504028 |8.910894393920898e-05 |0.011443659663200378 |0.005600690841674805 |
----------------------------------------------------------pseudo_mini_loss sum 4.10435676574707
Total (block generation + training)time/epoch 110.49404621124268
Training time/epoch 2.3026723861694336
Training time without block to device /epoch 1.5460717678070068
Training time without total dataloading part /epoch 0.29618167877197266
load block tensor time/epoch 1.173356294631958
block to device time/epoch 0.7566006183624268
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13097346
Number of first layer input nodes during this epoch:  2675669
