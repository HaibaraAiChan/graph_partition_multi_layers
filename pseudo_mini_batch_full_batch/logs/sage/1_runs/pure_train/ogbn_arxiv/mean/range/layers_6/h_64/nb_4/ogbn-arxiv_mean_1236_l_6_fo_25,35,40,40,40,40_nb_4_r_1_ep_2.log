Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648516172.9118876
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024244070053100586
range selection method range initialization spend 0.013448953628540039
time for parepare:  0.01776123046875
local_output_nid generation:  0.005209207534790039
local_in_edges_tensor generation:  0.006045341491699219
mini_batch_src_global generation:  0.006397247314453125
r_  generation:  0.08262062072753906
local_output_nid generation:  0.0061092376708984375
local_in_edges_tensor generation:  0.003008604049682617
mini_batch_src_global generation:  0.00885462760925293
r_  generation:  0.0893867015838623
local_output_nid generation:  0.006104469299316406
local_in_edges_tensor generation:  0.0030286312103271484
mini_batch_src_global generation:  0.006635189056396484
r_  generation:  0.08933401107788086
local_output_nid generation:  0.006160259246826172
local_in_edges_tensor generation:  0.0031218528747558594
mini_batch_src_global generation:  0.007097959518432617
r_  generation:  0.09176349639892578
----------------------check_connections_block total spend ----------------------------- 0.5091128349304199
generate_one_block  0.10123419761657715
generate_one_block  0.10322403907775879
generate_one_block  0.1036062240600586
generate_one_block  0.10382795333862305
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04029679298400879
gen group dst list time:  0.011223077774047852
time for parepare:  0.019617319107055664
local_output_nid generation:  0.014780998229980469
local_in_edges_tensor generation:  0.037163734436035156
mini_batch_src_global generation:  0.042157888412475586
r_  generation:  0.41490697860717773
local_output_nid generation:  0.023471355438232422
local_in_edges_tensor generation:  0.040366411209106445
mini_batch_src_global generation:  0.04781603813171387
r_  generation:  0.42842864990234375
local_output_nid generation:  0.024824142456054688
local_in_edges_tensor generation:  0.034445762634277344
mini_batch_src_global generation:  0.048215389251708984
r_  generation:  0.45558714866638184
local_output_nid generation:  0.027013778686523438
local_in_edges_tensor generation:  0.04116106033325195
mini_batch_src_global generation:  0.05943012237548828
r_  generation:  0.42507147789001465
----------------------check_connections_block total spend ----------------------------- 2.559983253479004
generate_one_block  0.5773324966430664
generate_one_block  0.5567667484283447
generate_one_block  0.5547149181365967
generate_one_block  0.5558586120605469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0545353889465332
gen group dst list time:  0.020912885665893555
time for parepare:  0.0193941593170166
local_output_nid generation:  0.024019241333007812
local_in_edges_tensor generation:  0.056856393814086914
mini_batch_src_global generation:  0.050438642501831055
r_  generation:  0.5390489101409912
local_output_nid generation:  0.03272438049316406
local_in_edges_tensor generation:  0.05343031883239746
mini_batch_src_global generation:  0.062098026275634766
r_  generation:  0.5471186637878418
local_output_nid generation:  0.033519744873046875
local_in_edges_tensor generation:  0.04453468322753906
mini_batch_src_global generation:  0.05691123008728027
r_  generation:  0.5600714683532715
local_output_nid generation:  0.03393816947937012
local_in_edges_tensor generation:  0.04571986198425293
mini_batch_src_global generation:  0.059836387634277344
r_  generation:  0.5559444427490234
----------------------check_connections_block total spend ----------------------------- 3.247929096221924
generate_one_block  0.7100121974945068
generate_one_block  0.7169208526611328
generate_one_block  0.7146668434143066
generate_one_block  0.7498500347137451
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06439471244812012
gen group dst list time:  0.03141331672668457
time for parepare:  0.018924951553344727
local_output_nid generation:  0.029274463653564453
local_in_edges_tensor generation:  0.05919504165649414
mini_batch_src_global generation:  0.053957223892211914
r_  generation:  0.5571765899658203
local_output_nid generation:  0.03571200370788574
local_in_edges_tensor generation:  0.06168675422668457
mini_batch_src_global generation:  0.07662248611450195
r_  generation:  0.5605976581573486
local_output_nid generation:  0.03919219970703125
local_in_edges_tensor generation:  0.048555612564086914
mini_batch_src_global generation:  0.06431078910827637
r_  generation:  0.5632071495056152
local_output_nid generation:  0.03969454765319824
local_in_edges_tensor generation:  0.042516469955444336
mini_batch_src_global generation:  0.06333136558532715
r_  generation:  0.567389726638794
----------------------check_connections_block total spend ----------------------------- 3.4028801918029785
generate_one_block  0.7145290374755859
generate_one_block  0.7368617057800293
generate_one_block  0.7199361324310303
generate_one_block  0.717139482498169
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.046204566955566406
gen group dst list time:  0.02523970603942871
time for parepare:  0.019216060638427734
local_output_nid generation:  0.028970718383789062
local_in_edges_tensor generation:  0.04826855659484863
mini_batch_src_global generation:  0.051846981048583984
r_  generation:  0.5482790470123291
local_output_nid generation:  0.03702497482299805
local_in_edges_tensor generation:  0.03877544403076172
mini_batch_src_global generation:  0.06281185150146484
r_  generation:  0.5498740673065186
local_output_nid generation:  0.03624439239501953
local_in_edges_tensor generation:  0.03700709342956543
mini_batch_src_global generation:  0.06392931938171387
r_  generation:  0.5502510070800781
local_output_nid generation:  0.03669285774230957
local_in_edges_tensor generation:  0.04656243324279785
mini_batch_src_global generation:  0.06586956977844238
r_  generation:  0.565887451171875
----------------------check_connections_block total spend ----------------------------- 3.3244054317474365
generate_one_block  0.6953959465026855
generate_one_block  0.6993241310119629
generate_one_block  0.6936872005462646
generate_one_block  0.6997723579406738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04309868812561035
gen group dst list time:  0.027354717254638672
time for parepare:  0.01916027069091797
local_output_nid generation:  0.03039860725402832
local_in_edges_tensor generation:  0.04298830032348633
mini_batch_src_global generation:  0.048653364181518555
r_  generation:  0.5438661575317383
local_output_nid generation:  0.036623477935791016
local_in_edges_tensor generation:  0.04167056083679199
mini_batch_src_global generation:  0.05870199203491211
r_  generation:  0.5178844928741455
local_output_nid generation:  0.03720974922180176
local_in_edges_tensor generation:  0.03825116157531738
mini_batch_src_global generation:  0.06288576126098633
r_  generation:  0.5278241634368896
local_output_nid generation:  0.03727459907531738
local_in_edges_tensor generation:  0.046859025955200195
mini_batch_src_global generation:  0.05785799026489258
r_  generation:  0.5195813179016113
----------------------check_connections_block total spend ----------------------------- 3.1452724933624268
generate_one_block  0.6395838260650635
generate_one_block  0.6690881252288818
generate_one_block  0.6465847492218018
generate_one_block  0.6580657958984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00021409988403320312  GigaBytes
Max Memory Allocated: 0.00021409988403320312  GigaBytes

connection checking time:  15.68047046661377
block generation total time  13.426091194152832
average batch blocks generation time:  3.356522798538208
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.14241790771484375  GigaBytes
Max Memory Allocated: 0.14241790771484375  GigaBytes

torch.Size([167809, 128])
torch.Size([167577, 64])
torch.Size([166958, 64])
torch.Size([164855, 64])
torch.Size([154917, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3397216796875 GB
    Memory Allocated: 0.9443798065185547  GigaBytes
Max Memory Allocated: 0.9633030891418457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.1490645408630371  GigaBytes
Max Memory Allocated: 0.991114616394043  GigaBytes

torch.Size([167742, 128])
torch.Size([167532, 64])
torch.Size([166946, 64])
torch.Size([164846, 64])
torch.Size([154927, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9485592842102051  GigaBytes
Max Memory Allocated: 0.991114616394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14902830123901367  GigaBytes
Max Memory Allocated: 0.9947443008422852  GigaBytes

torch.Size([167784, 128])
torch.Size([167549, 64])
torch.Size([166880, 64])
torch.Size([164848, 64])
torch.Size([155106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9486279487609863  GigaBytes
Max Memory Allocated: 0.9947443008422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.14902973175048828  GigaBytes
Max Memory Allocated: 0.9948177337646484  GigaBytes

torch.Size([167780, 128])
torch.Size([167560, 64])
torch.Size([166946, 64])
torch.Size([164793, 64])
torch.Size([154902, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9484038352966309  GigaBytes
Max Memory Allocated: 0.9948177337646484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06631702184677124 |0.136493980884552 |0.18621933460235596 |0.00012308359146118164 |0.029076755046844482 |0.004384756088256836 |
----------------------------------------------------------pseudo_mini_loss sum 5.134243011474609
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3693906
Number of first layer input nodes during this epoch:  671115
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.2814650535583496  GigaBytes
Max Memory Allocated: 0.9948177337646484  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.020093202590942383
range selection method range initialization spend 0.011336803436279297
time for parepare:  0.0173337459564209
local_output_nid generation:  0.005392551422119141
local_in_edges_tensor generation:  0.005217075347900391
mini_batch_src_global generation:  0.006470203399658203
r_  generation:  0.08263349533081055
local_output_nid generation:  0.0060117244720458984
local_in_edges_tensor generation:  0.0031528472900390625
mini_batch_src_global generation:  0.008466243743896484
r_  generation:  0.0868525505065918
local_output_nid generation:  0.006202220916748047
local_in_edges_tensor generation:  0.0030510425567626953
mini_batch_src_global generation:  0.009388923645019531
r_  generation:  0.09230232238769531
local_output_nid generation:  0.006663322448730469
local_in_edges_tensor generation:  0.004841804504394531
mini_batch_src_global generation:  0.008975744247436523
r_  generation:  0.10375022888183594
----------------------check_connections_block total spend ----------------------------- 0.5343039035797119
generate_one_block  0.10182428359985352
generate_one_block  0.10356020927429199
generate_one_block  0.10499978065490723
generate_one_block  0.10304450988769531
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.049742937088012695
gen group dst list time:  0.010760784149169922
time for parepare:  0.020869731903076172
local_output_nid generation:  0.014775991439819336
local_in_edges_tensor generation:  0.04387092590332031
mini_batch_src_global generation:  0.041628360748291016
r_  generation:  0.4058082103729248
local_output_nid generation:  0.023100614547729492
local_in_edges_tensor generation:  0.03775596618652344
mini_batch_src_global generation:  0.04926943778991699
r_  generation:  0.41838741302490234
local_output_nid generation:  0.02221822738647461
local_in_edges_tensor generation:  0.03497767448425293
mini_batch_src_global generation:  0.04945802688598633
r_  generation:  0.4249382019042969
local_output_nid generation:  0.023037433624267578
local_in_edges_tensor generation:  0.028385639190673828
mini_batch_src_global generation:  0.049411773681640625
r_  generation:  0.4257786273956299
----------------------check_connections_block total spend ----------------------------- 2.4734926223754883
generate_one_block  0.5650439262390137
generate_one_block  0.545595645904541
generate_one_block  0.5861079692840576
generate_one_block  0.5564863681793213
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.043184757232666016
gen group dst list time:  0.023787736892700195
time for parepare:  0.02016615867614746
local_output_nid generation:  0.024123668670654297
local_in_edges_tensor generation:  0.05294013023376465
mini_batch_src_global generation:  0.05064201354980469
r_  generation:  0.5418875217437744
local_output_nid generation:  0.03247547149658203
local_in_edges_tensor generation:  0.053457021713256836
mini_batch_src_global generation:  0.06270313262939453
r_  generation:  0.5469396114349365
local_output_nid generation:  0.04400777816772461
local_in_edges_tensor generation:  0.03920102119445801
mini_batch_src_global generation:  0.05720186233520508
r_  generation:  0.562577486038208
local_output_nid generation:  0.03567814826965332
local_in_edges_tensor generation:  0.04401397705078125
mini_batch_src_global generation:  0.060173988342285156
r_  generation:  0.5611870288848877
----------------------check_connections_block total spend ----------------------------- 3.266386032104492
generate_one_block  0.7005934715270996
generate_one_block  0.716414213180542
generate_one_block  0.7086596488952637
generate_one_block  0.7046990394592285
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.045907020568847656
gen group dst list time:  0.028145313262939453
time for parepare:  0.0186917781829834
local_output_nid generation:  0.028047800064086914
local_in_edges_tensor generation:  0.052358150482177734
mini_batch_src_global generation:  0.05458950996398926
r_  generation:  0.5547647476196289
local_output_nid generation:  0.03608393669128418
local_in_edges_tensor generation:  0.05408143997192383
mini_batch_src_global generation:  0.06644892692565918
r_  generation:  0.5679917335510254
local_output_nid generation:  0.035654306411743164
local_in_edges_tensor generation:  0.04114222526550293
mini_batch_src_global generation:  0.0649111270904541
r_  generation:  0.5661916732788086
local_output_nid generation:  0.03570699691772461
local_in_edges_tensor generation:  0.04025006294250488
mini_batch_src_global generation:  0.0627446174621582
r_  generation:  0.572728157043457
----------------------check_connections_block total spend ----------------------------- 3.3466739654541016
generate_one_block  0.7181699275970459
generate_one_block  0.7192020416259766
generate_one_block  0.7072615623474121
generate_one_block  0.7360973358154297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045148611068725586
gen group dst list time:  0.025448322296142578
time for parepare:  0.02028822898864746
local_output_nid generation:  0.02899336814880371
local_in_edges_tensor generation:  0.04401063919067383
mini_batch_src_global generation:  0.049729108810424805
r_  generation:  0.5582938194274902
local_output_nid generation:  0.03769087791442871
local_in_edges_tensor generation:  0.04595637321472168
mini_batch_src_global generation:  0.06957626342773438
r_  generation:  0.558527946472168
local_output_nid generation:  0.040093421936035156
local_in_edges_tensor generation:  0.04081082344055176
mini_batch_src_global generation:  0.06389975547790527
r_  generation:  0.5597782135009766
local_output_nid generation:  0.0384669303894043
local_in_edges_tensor generation:  0.05016636848449707
mini_batch_src_global generation:  0.0633080005645752
r_  generation:  0.5558149814605713
----------------------check_connections_block total spend ----------------------------- 3.328688859939575
generate_one_block  0.6906337738037109
generate_one_block  0.6917924880981445
generate_one_block  0.7014050483703613
generate_one_block  0.7158041000366211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03634381294250488
gen group dst list time:  0.024989604949951172
time for parepare:  0.019280195236206055
local_output_nid generation:  0.0293424129486084
local_in_edges_tensor generation:  0.045639991760253906
mini_batch_src_global generation:  0.04543042182922363
r_  generation:  0.511225700378418
local_output_nid generation:  0.03925514221191406
local_in_edges_tensor generation:  0.04761314392089844
mini_batch_src_global generation:  0.06335973739624023
r_  generation:  0.5243396759033203
local_output_nid generation:  0.03851056098937988
local_in_edges_tensor generation:  0.043549537658691406
mini_batch_src_global generation:  0.06704545021057129
r_  generation:  0.5154328346252441
local_output_nid generation:  0.03945803642272949
local_in_edges_tensor generation:  0.03577709197998047
mini_batch_src_global generation:  0.06244993209838867
r_  generation:  0.5245435237884521
----------------------check_connections_block total spend ----------------------------- 3.1269609928131104
generate_one_block  0.6605546474456787
generate_one_block  0.664323091506958
generate_one_block  0.6495747566223145
generate_one_block  0.6921844482421875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.2814650535583496  GigaBytes
Max Memory Allocated: 0.9948177337646484  GigaBytes

connection checking time:  15.542202472686768
block generation total time  13.430603504180908
average batch blocks generation time:  3.357650876045227
block dataloader generation time/epoch 31.4987370967865
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.1494312286376953  GigaBytes
Max Memory Allocated: 0.9948177337646484  GigaBytes

torch.Size([167811, 128])
torch.Size([167596, 64])
torch.Size([167034, 64])
torch.Size([164955, 64])
torch.Size([155029, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.9490261077880859  GigaBytes
Max Memory Allocated: 0.9948177337646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.14942026138305664  GigaBytes
Max Memory Allocated: 0.9950308799743652  GigaBytes

torch.Size([167759, 128])
torch.Size([167539, 64])
torch.Size([166960, 64])
torch.Size([164827, 64])
torch.Size([154876, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.948333740234375  GigaBytes
Max Memory Allocated: 0.9950308799743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.14944982528686523  GigaBytes
Max Memory Allocated: 0.9950308799743652  GigaBytes

torch.Size([167805, 128])
torch.Size([167591, 64])
torch.Size([166938, 64])
torch.Size([164709, 64])
torch.Size([154669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.9486608505249023  GigaBytes
Max Memory Allocated: 0.9950308799743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.1494436264038086  GigaBytes
Max Memory Allocated: 0.9950308799743652  GigaBytes

torch.Size([167806, 128])
torch.Size([167592, 64])
torch.Size([166999, 64])
torch.Size([164900, 64])
torch.Size([155503, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6619873046875 GB
    Memory Allocated: 0.9498076438903809  GigaBytes
Max Memory Allocated: 0.9950308799743652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08583956956863403 |0.05852973461151123 |0.00719374418258667 |9.781122207641602e-05 |0.0074460506439208984 |0.002495288848876953 |
----------------------------------------------------------pseudo_mini_loss sum 4.060540676116943
Total (block generation + training)time/epoch 32.21427345275879
Training time/epoch 0.7153260707855225
Training time without block to device /epoch 0.48120713233947754
Training time without total dataloading part /epoch 0.06144571304321289
load block tensor time/epoch 0.34335827827453613
block to device time/epoch 0.23411893844604492
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3694377
Number of first layer input nodes during this epoch:  671181
