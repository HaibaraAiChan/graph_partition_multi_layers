Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648449968.027076
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027109146118164062
range selection method range initialization spend 0.013019800186157227
time for parepare:  0.018036365509033203
local_output_nid generation:  0.002633810043334961
local_in_edges_tensor generation:  0.005063772201538086
mini_batch_src_global generation:  0.003500699996948242
r_  generation:  0.04029083251953125
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.00177001953125
mini_batch_src_global generation:  0.004450321197509766
r_  generation:  0.04234814643859863
local_output_nid generation:  0.0031766891479492188
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.0030422210693359375
r_  generation:  0.043182373046875
local_output_nid generation:  0.003147125244140625
local_in_edges_tensor generation:  0.0017559528350830078
mini_batch_src_global generation:  0.003400564193725586
r_  generation:  0.04463791847229004
local_output_nid generation:  0.0031273365020751953
local_in_edges_tensor generation:  0.001712799072265625
mini_batch_src_global generation:  0.0033693313598632812
r_  generation:  0.04531383514404297
local_output_nid generation:  0.0033168792724609375
local_in_edges_tensor generation:  0.0017511844635009766
mini_batch_src_global generation:  0.0037517547607421875
r_  generation:  0.04709792137145996
local_output_nid generation:  0.003145456314086914
local_in_edges_tensor generation:  0.001772165298461914
mini_batch_src_global generation:  0.0035936832427978516
r_  generation:  0.045247793197631836
local_output_nid generation:  0.0031614303588867188
local_in_edges_tensor generation:  0.00168609619140625
mini_batch_src_global generation:  0.003409147262573242
r_  generation:  0.045981407165527344
----------------------check_connections_block total spend ----------------------------- 0.515141487121582
generate_one_block  0.0633857250213623
generate_one_block  0.06406712532043457
generate_one_block  0.06263160705566406
generate_one_block  0.06418371200561523
generate_one_block  0.06665277481079102
generate_one_block  0.06447982788085938
generate_one_block  0.06320452690124512
generate_one_block  0.06375527381896973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03976869583129883
gen group dst list time:  0.016121387481689453
time for parepare:  0.021084308624267578
local_output_nid generation:  0.01170659065246582
local_in_edges_tensor generation:  0.029907703399658203
mini_batch_src_global generation:  0.032625675201416016
r_  generation:  0.3100404739379883
local_output_nid generation:  0.020563602447509766
local_in_edges_tensor generation:  0.030796527862548828
mini_batch_src_global generation:  0.0371241569519043
r_  generation:  0.32172369956970215
local_output_nid generation:  0.021407127380371094
local_in_edges_tensor generation:  0.0252687931060791
mini_batch_src_global generation:  0.037036895751953125
r_  generation:  0.3334085941314697
local_output_nid generation:  0.022121667861938477
local_in_edges_tensor generation:  0.022653579711914062
mini_batch_src_global generation:  0.041553497314453125
r_  generation:  0.33289074897766113
local_output_nid generation:  0.02212381362915039
local_in_edges_tensor generation:  0.02599477767944336
mini_batch_src_global generation:  0.039197444915771484
r_  generation:  0.33465576171875
local_output_nid generation:  0.023066997528076172
local_in_edges_tensor generation:  0.0261385440826416
mini_batch_src_global generation:  0.04009580612182617
r_  generation:  0.3474845886230469
local_output_nid generation:  0.022602558135986328
local_in_edges_tensor generation:  0.02114415168762207
mini_batch_src_global generation:  0.039864540100097656
r_  generation:  0.3397634029388428
local_output_nid generation:  0.022681236267089844
local_in_edges_tensor generation:  0.020306110382080078
mini_batch_src_global generation:  0.040109872817993164
r_  generation:  0.33881115913391113
----------------------check_connections_block total spend ----------------------------- 3.9322080612182617
generate_one_block  0.4307899475097656
generate_one_block  0.44635844230651855
generate_one_block  0.4304473400115967
generate_one_block  0.4472203254699707
generate_one_block  0.44321298599243164
generate_one_block  0.4624500274658203
generate_one_block  0.4335362911224365
generate_one_block  0.44533514976501465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0334622859954834
gen group dst list time:  0.039235591888427734
time for parepare:  0.019491910934448242
local_output_nid generation:  0.024797439575195312
local_in_edges_tensor generation:  0.04211115837097168
mini_batch_src_global generation:  0.04337882995605469
r_  generation:  0.47197914123535156
local_output_nid generation:  0.03201627731323242
local_in_edges_tensor generation:  0.051223039627075195
mini_batch_src_global generation:  0.05379343032836914
r_  generation:  0.47757911682128906
local_output_nid generation:  0.03273320198059082
local_in_edges_tensor generation:  0.038910627365112305
mini_batch_src_global generation:  0.05092501640319824
r_  generation:  0.496046781539917
local_output_nid generation:  0.03314495086669922
local_in_edges_tensor generation:  0.04330086708068848
mini_batch_src_global generation:  0.05422687530517578
r_  generation:  0.4915919303894043
local_output_nid generation:  0.03392958641052246
local_in_edges_tensor generation:  0.04749274253845215
mini_batch_src_global generation:  0.05256795883178711
r_  generation:  0.5007538795471191
local_output_nid generation:  0.03369331359863281
local_in_edges_tensor generation:  0.0402834415435791
mini_batch_src_global generation:  0.05518078804016113
r_  generation:  0.4929690361022949
local_output_nid generation:  0.033509016036987305
local_in_edges_tensor generation:  0.03412032127380371
mini_batch_src_global generation:  0.05451822280883789
r_  generation:  0.49842000007629395
local_output_nid generation:  0.0336301326751709
local_in_edges_tensor generation:  0.0353548526763916
mini_batch_src_global generation:  0.05508923530578613
r_  generation:  0.4881093502044678
----------------------check_connections_block total spend ----------------------------- 5.808352947235107
generate_one_block  0.617253303527832
generate_one_block  0.6161067485809326
generate_one_block  0.6133179664611816
generate_one_block  0.6287760734558105
generate_one_block  0.6279811859130859
generate_one_block  0.6220002174377441
generate_one_block  0.6339967250823975
generate_one_block  0.6133782863616943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  9.74056100845337
block generation total time  8.512161016464233
average batch blocks generation time:  1.0640201270580292
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09744405746459961  GigaBytes
Max Memory Allocated: 0.09744405746459961  GigaBytes

torch.Size([160747, 128])
torch.Size([142825, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.5631895065307617  GigaBytes
Max Memory Allocated: 0.5926418304443359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.10048389434814453  GigaBytes
Max Memory Allocated: 0.6325244903564453  GigaBytes

torch.Size([160798, 128])
torch.Size([142820, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.5630245208740234  GigaBytes
Max Memory Allocated: 0.6325244903564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.10016584396362305  GigaBytes
Max Memory Allocated: 0.6326336860656738  GigaBytes

torch.Size([160730, 128])
torch.Size([142490, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.5623207092285156  GigaBytes
Max Memory Allocated: 0.6326336860656738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.09993410110473633  GigaBytes
Max Memory Allocated: 0.6326336860656738  GigaBytes

torch.Size([161000, 128])
torch.Size([142735, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2791748046875 GB
    Memory Allocated: 0.5633978843688965  GigaBytes
Max Memory Allocated: 0.6326336860656738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09981346130371094  GigaBytes
Max Memory Allocated: 0.6333036422729492  GigaBytes

torch.Size([161037, 128])
torch.Size([143062, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.5628290176391602  GigaBytes
Max Memory Allocated: 0.6333036422729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.09979534149169922  GigaBytes
Max Memory Allocated: 0.6333036422729492  GigaBytes

torch.Size([161181, 128])
torch.Size([143619, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.565485954284668  GigaBytes
Max Memory Allocated: 0.6333036422729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.09961223602294922  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160773, 128])
torch.Size([142833, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5626635551452637  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.09950876235961914  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160883, 128])
torch.Size([142850, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5629806518554688  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04285937547683716 |0.047472864389419556 |0.09230855107307434 |0.00010436773300170898 |0.010607779026031494 |0.0035457611083984375 |
----------------------------------------------------------pseudo_mini_loss sum 5.606119155883789
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3018838
Number of first layer input nodes during this epoch:  1287149
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.13042068481445312  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027899503707885742
range selection method range initialization spend 0.010844945907592773
time for parepare:  0.017512083053588867
local_output_nid generation:  0.002649068832397461
local_in_edges_tensor generation:  0.009130477905273438
mini_batch_src_global generation:  0.0037758350372314453
r_  generation:  0.03996872901916504
local_output_nid generation:  0.0031316280364990234
local_in_edges_tensor generation:  0.0016832351684570312
mini_batch_src_global generation:  0.004650115966796875
r_  generation:  0.04318428039550781
local_output_nid generation:  0.003161907196044922
local_in_edges_tensor generation:  0.0016829967498779297
mini_batch_src_global generation:  0.003209352493286133
r_  generation:  0.04326820373535156
local_output_nid generation:  0.0032303333282470703
local_in_edges_tensor generation:  0.0017175674438476562
mini_batch_src_global generation:  0.0032958984375
r_  generation:  0.045256614685058594
local_output_nid generation:  0.003183603286743164
local_in_edges_tensor generation:  0.0018956661224365234
mini_batch_src_global generation:  0.0036067962646484375
r_  generation:  0.049713850021362305
local_output_nid generation:  0.0032112598419189453
local_in_edges_tensor generation:  0.0017940998077392578
mini_batch_src_global generation:  0.0036287307739257812
r_  generation:  0.05024433135986328
local_output_nid generation:  0.0033469200134277344
local_in_edges_tensor generation:  0.0017185211181640625
mini_batch_src_global generation:  0.00371551513671875
r_  generation:  0.04742836952209473
local_output_nid generation:  0.003171682357788086
local_in_edges_tensor generation:  0.0017712116241455078
mini_batch_src_global generation:  0.0037326812744140625
r_  generation:  0.04718422889709473
----------------------check_connections_block total spend ----------------------------- 0.5409224033355713
generate_one_block  0.06401729583740234
generate_one_block  0.061691999435424805
generate_one_block  0.06177401542663574
generate_one_block  0.06110501289367676
generate_one_block  0.06304454803466797
generate_one_block  0.06289100646972656
generate_one_block  0.06561708450317383
generate_one_block  0.06361842155456543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04150390625
gen group dst list time:  0.016155719757080078
time for parepare:  0.01910543441772461
local_output_nid generation:  0.010689973831176758
local_in_edges_tensor generation:  0.032982587814331055
mini_batch_src_global generation:  0.03238272666931152
r_  generation:  0.3075063228607178
local_output_nid generation:  0.017174243927001953
local_in_edges_tensor generation:  0.03123927116394043
mini_batch_src_global generation:  0.03939366340637207
r_  generation:  0.32923340797424316
local_output_nid generation:  0.01700139045715332
local_in_edges_tensor generation:  0.027747631072998047
mini_batch_src_global generation:  0.03805708885192871
r_  generation:  0.3322782516479492
local_output_nid generation:  0.017733335494995117
local_in_edges_tensor generation:  0.019034385681152344
mini_batch_src_global generation:  0.03927254676818848
r_  generation:  0.33197617530822754
local_output_nid generation:  0.018129348754882812
local_in_edges_tensor generation:  0.022711753845214844
mini_batch_src_global generation:  0.04301762580871582
r_  generation:  0.3402562141418457
local_output_nid generation:  0.018026351928710938
local_in_edges_tensor generation:  0.024217844009399414
mini_batch_src_global generation:  0.040483713150024414
r_  generation:  0.34467148780822754
local_output_nid generation:  0.018248558044433594
local_in_edges_tensor generation:  0.022928476333618164
mini_batch_src_global generation:  0.041060686111450195
r_  generation:  0.34251952171325684
local_output_nid generation:  0.018027544021606445
local_in_edges_tensor generation:  0.022963523864746094
mini_batch_src_global generation:  0.04076552391052246
r_  generation:  0.3404245376586914
----------------------check_connections_block total spend ----------------------------- 3.9154860973358154
generate_one_block  0.4290902614593506
generate_one_block  0.4681410789489746
generate_one_block  0.4422588348388672
generate_one_block  0.43821024894714355
generate_one_block  0.46768975257873535
generate_one_block  0.4542379379272461
generate_one_block  0.4393312931060791
generate_one_block  0.4710428714752197
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034482717514038086
gen group dst list time:  0.03639864921569824
time for parepare:  0.02130293846130371
local_output_nid generation:  0.02497076988220215
local_in_edges_tensor generation:  0.06278586387634277
mini_batch_src_global generation:  0.0446171760559082
r_  generation:  0.47492384910583496
local_output_nid generation:  0.032477617263793945
local_in_edges_tensor generation:  0.04679560661315918
mini_batch_src_global generation:  0.05813026428222656
r_  generation:  0.4836597442626953
local_output_nid generation:  0.03356671333312988
local_in_edges_tensor generation:  0.04539632797241211
mini_batch_src_global generation:  0.07795119285583496
r_  generation:  0.5151846408843994
local_output_nid generation:  0.0377349853515625
local_in_edges_tensor generation:  0.0457911491394043
mini_batch_src_global generation:  0.05496406555175781
r_  generation:  0.489809513092041
local_output_nid generation:  0.035327911376953125
local_in_edges_tensor generation:  0.04349231719970703
mini_batch_src_global generation:  0.05301189422607422
r_  generation:  0.4986541271209717
local_output_nid generation:  0.03522634506225586
local_in_edges_tensor generation:  0.035433053970336914
mini_batch_src_global generation:  0.0556488037109375
r_  generation:  0.49038243293762207
local_output_nid generation:  0.037184715270996094
local_in_edges_tensor generation:  0.03238821029663086
mini_batch_src_global generation:  0.05440402030944824
r_  generation:  0.5139179229736328
local_output_nid generation:  0.035097599029541016
local_in_edges_tensor generation:  0.03251767158508301
mini_batch_src_global generation:  0.05801558494567871
r_  generation:  0.49960923194885254
----------------------check_connections_block total spend ----------------------------- 5.9736647605896
generate_one_block  0.6534383296966553
generate_one_block  0.6284894943237305
generate_one_block  0.6199822425842285
generate_one_block  0.6312382221221924
generate_one_block  0.6319835186004639
generate_one_block  0.629082202911377
generate_one_block  0.6111328601837158
generate_one_block  0.6278820037841797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.13042068481445312  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

connection checking time:  9.889150857925415
block generation total time  8.64323115348816
average batch blocks generation time:  1.08040389418602
block dataloader generation time/epoch 20.626131534576416
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.09993171691894531  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160813, 128])
torch.Size([142669, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5635347366333008  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10016489028930664  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160692, 128])
torch.Size([142850, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5632190704345703  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.1002035140991211  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160793, 128])
torch.Size([142323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5632734298706055  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.1008291244506836  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160968, 128])
torch.Size([142876, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.56292724609375  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10079240798950195  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([161161, 128])
torch.Size([143381, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.565239429473877  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10046815872192383  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([161082, 128])
torch.Size([143403, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5647592544555664  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.1002955436706543  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160726, 128])
torch.Size([142358, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5641098022460938  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.10033607482910156  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

torch.Size([160985, 128])
torch.Size([143081, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 0.5641531944274902  GigaBytes
Max Memory Allocated: 0.6362643241882324  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05388084053993225 |0.02035003900527954 |0.0035770833492279053 |9.068846702575684e-05 |0.003602534532546997 |0.0013186931610107422 |
----------------------------------------------------------pseudo_mini_loss sum 3.581434488296509
Total (block generation + training)time/epoch 21.313998460769653
Training time/epoch 0.687568187713623
Training time without block to device /epoch 0.5247678756713867
Training time without total dataloading part /epoch 0.059481143951416016
load block tensor time/epoch 0.431046724319458
block to device time/epoch 0.16280031204223633
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3018933
Number of first layer input nodes during this epoch:  1287220
