Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648453131.76679
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02704620361328125
range selection method range initialization spend 0.013928651809692383
time for parepare:  0.01805400848388672
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0028285980224609375
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.012722969055175781
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0006399154663085938
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.00974130630493164
local_output_nid generation:  0.0007929801940917969
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.0009851455688476562
r_  generation:  0.009432315826416016
local_output_nid generation:  0.0008287429809570312
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.00958561897277832
local_output_nid generation:  0.0007882118225097656
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009801387786865234
r_  generation:  0.009124755859375
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0008893013000488281
r_  generation:  0.009156465530395508
local_output_nid generation:  0.0008099079132080078
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.009640932083129883
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.00970458984375
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0009360313415527344
r_  generation:  0.009690046310424805
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0009572505950927734
r_  generation:  0.009822368621826172
local_output_nid generation:  0.000782012939453125
local_in_edges_tensor generation:  0.0004987716674804688
mini_batch_src_global generation:  0.0009725093841552734
r_  generation:  0.009914636611938477
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0005033016204833984
mini_batch_src_global generation:  0.0009615421295166016
r_  generation:  0.010084390640258789
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.009928703308105469
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0010595321655273438
r_  generation:  0.01018834114074707
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.0009458065032958984
r_  generation:  0.009578466415405273
local_output_nid generation:  0.0007712841033935547
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.009939908981323242
local_output_nid generation:  0.0007691383361816406
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.01033639907836914
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.01006174087524414
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0004887580871582031
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.009854555130004883
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.009878396987915039
local_output_nid generation:  0.0007781982421875
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.010068655014038086
local_output_nid generation:  0.0007646083831787109
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.010037422180175781
local_output_nid generation:  0.0007567405700683594
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.010379314422607422
local_output_nid generation:  0.0007784366607666016
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.010074138641357422
local_output_nid generation:  0.0007727146148681641
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009980201721191406
r_  generation:  0.01006174087524414
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.010360956192016602
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.009888172149658203
local_output_nid generation:  0.0008454322814941406
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.010292291641235352
local_output_nid generation:  0.0007586479187011719
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.010171175003051758
local_output_nid generation:  0.0007734298706054688
local_in_edges_tensor generation:  0.004485130310058594
mini_batch_src_global generation:  0.0012104511260986328
r_  generation:  0.010262250900268555
local_output_nid generation:  0.0008256435394287109
local_in_edges_tensor generation:  0.0005156993865966797
mini_batch_src_global generation:  0.0010576248168945312
r_  generation:  0.01013040542602539
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0010852813720703125
r_  generation:  0.010383129119873047
----------------------check_connections_block total spend ----------------------------- 0.491901159286499
generate_one_block  0.015299797058105469
generate_one_block  0.015058040618896484
generate_one_block  0.01531839370727539
generate_one_block  0.015199899673461914
generate_one_block  0.014686346054077148
generate_one_block  0.014325141906738281
generate_one_block  0.014766454696655273
generate_one_block  0.015041112899780273
generate_one_block  0.014908075332641602
generate_one_block  0.015230655670166016
generate_one_block  0.014729499816894531
generate_one_block  0.0150299072265625
generate_one_block  0.014774084091186523
generate_one_block  0.01545572280883789
generate_one_block  0.014243364334106445
generate_one_block  0.014838218688964844
generate_one_block  0.015149116516113281
generate_one_block  0.015152454376220703
generate_one_block  0.014851570129394531
generate_one_block  0.014722108840942383
generate_one_block  0.014925479888916016
generate_one_block  0.01497960090637207
generate_one_block  0.01544642448425293
generate_one_block  0.014953136444091797
generate_one_block  0.014942169189453125
generate_one_block  0.014945745468139648
generate_one_block  0.01465916633605957
generate_one_block  0.015012025833129883
generate_one_block  0.015300512313842773
generate_one_block  0.01499629020690918
generate_one_block  0.015227079391479492
generate_one_block  0.015260457992553711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041852474212646484
gen group dst list time:  0.02400660514831543
time for parepare:  0.01965618133544922
local_output_nid generation:  0.004312276840209961
local_in_edges_tensor generation:  0.011711597442626953
mini_batch_src_global generation:  0.016199350357055664
r_  generation:  0.1569974422454834
local_output_nid generation:  0.008010387420654297
local_in_edges_tensor generation:  0.014358758926391602
mini_batch_src_global generation:  0.022327423095703125
r_  generation:  0.16858983039855957
local_output_nid generation:  0.008373260498046875
local_in_edges_tensor generation:  0.012064695358276367
mini_batch_src_global generation:  0.020536422729492188
r_  generation:  0.18171358108520508
local_output_nid generation:  0.008220195770263672
local_in_edges_tensor generation:  0.012241601943969727
mini_batch_src_global generation:  0.020612478256225586
r_  generation:  0.1734611988067627
local_output_nid generation:  0.008278846740722656
local_in_edges_tensor generation:  0.010401725769042969
mini_batch_src_global generation:  0.021300077438354492
r_  generation:  0.17539644241333008
local_output_nid generation:  0.008248567581176758
local_in_edges_tensor generation:  0.008590221405029297
mini_batch_src_global generation:  0.0211484432220459
r_  generation:  0.17332696914672852
local_output_nid generation:  0.008663415908813477
local_in_edges_tensor generation:  0.009443283081054688
mini_batch_src_global generation:  0.02292799949645996
r_  generation:  0.17817401885986328
local_output_nid generation:  0.00870370864868164
local_in_edges_tensor generation:  0.011902809143066406
mini_batch_src_global generation:  0.02196955680847168
r_  generation:  0.1784510612487793
local_output_nid generation:  0.008834600448608398
local_in_edges_tensor generation:  0.012204647064208984
mini_batch_src_global generation:  0.022145509719848633
r_  generation:  0.1802535057067871
local_output_nid generation:  0.009649038314819336
local_in_edges_tensor generation:  0.0177457332611084
mini_batch_src_global generation:  0.024381637573242188
r_  generation:  0.19312357902526855
local_output_nid generation:  0.010836124420166016
local_in_edges_tensor generation:  0.013948678970336914
mini_batch_src_global generation:  0.022373199462890625
r_  generation:  0.17923784255981445
local_output_nid generation:  0.023283958435058594
local_in_edges_tensor generation:  0.014379739761352539
mini_batch_src_global generation:  0.02275252342224121
r_  generation:  0.18313121795654297
local_output_nid generation:  0.009072065353393555
local_in_edges_tensor generation:  0.025902986526489258
mini_batch_src_global generation:  0.0236663818359375
r_  generation:  0.1945328712463379
local_output_nid generation:  0.011132955551147461
local_in_edges_tensor generation:  0.014308929443359375
mini_batch_src_global generation:  0.023885250091552734
r_  generation:  0.18520283699035645
local_output_nid generation:  0.0077457427978515625
local_in_edges_tensor generation:  0.011141538619995117
mini_batch_src_global generation:  0.022511005401611328
r_  generation:  0.17600750923156738
local_output_nid generation:  0.007851362228393555
local_in_edges_tensor generation:  0.009983539581298828
mini_batch_src_global generation:  0.022639989852905273
r_  generation:  0.17849373817443848
local_output_nid generation:  0.007990837097167969
local_in_edges_tensor generation:  0.010364770889282227
mini_batch_src_global generation:  0.02286076545715332
r_  generation:  0.18013978004455566
local_output_nid generation:  0.00789022445678711
local_in_edges_tensor generation:  0.008704662322998047
mini_batch_src_global generation:  0.022576332092285156
r_  generation:  0.17674732208251953
local_output_nid generation:  0.0077893733978271484
local_in_edges_tensor generation:  0.008636236190795898
mini_batch_src_global generation:  0.022314071655273438
r_  generation:  0.17552947998046875
local_output_nid generation:  0.007876873016357422
local_in_edges_tensor generation:  0.008818626403808594
mini_batch_src_global generation:  0.022384166717529297
r_  generation:  0.1772456169128418
local_output_nid generation:  0.007791996002197266
local_in_edges_tensor generation:  0.011688947677612305
mini_batch_src_global generation:  0.022930622100830078
r_  generation:  0.18122553825378418
local_output_nid generation:  0.008013010025024414
local_in_edges_tensor generation:  0.01036381721496582
mini_batch_src_global generation:  0.0229032039642334
r_  generation:  0.17926573753356934
local_output_nid generation:  0.00807332992553711
local_in_edges_tensor generation:  0.011861801147460938
mini_batch_src_global generation:  0.023143291473388672
r_  generation:  0.18224620819091797
local_output_nid generation:  0.007930278778076172
local_in_edges_tensor generation:  0.010292291641235352
mini_batch_src_global generation:  0.02298259735107422
r_  generation:  0.1824812889099121
local_output_nid generation:  0.008023500442504883
local_in_edges_tensor generation:  0.008786201477050781
mini_batch_src_global generation:  0.023183345794677734
r_  generation:  0.18268084526062012
local_output_nid generation:  0.007942676544189453
local_in_edges_tensor generation:  0.01051783561706543
mini_batch_src_global generation:  0.022987842559814453
r_  generation:  0.1947183609008789
local_output_nid generation:  0.007834196090698242
local_in_edges_tensor generation:  0.008763313293457031
mini_batch_src_global generation:  0.02218937873840332
r_  generation:  0.17996764183044434
local_output_nid generation:  0.007992267608642578
local_in_edges_tensor generation:  0.00911855697631836
mini_batch_src_global generation:  0.024856090545654297
r_  generation:  0.19719743728637695
local_output_nid generation:  0.01085972785949707
local_in_edges_tensor generation:  0.019933223724365234
mini_batch_src_global generation:  0.025783300399780273
r_  generation:  0.18506789207458496
local_output_nid generation:  0.008030414581298828
local_in_edges_tensor generation:  0.011630535125732422
mini_batch_src_global generation:  0.02276444435119629
r_  generation:  0.18106293678283691
local_output_nid generation:  0.0080108642578125
local_in_edges_tensor generation:  0.010184526443481445
mini_batch_src_global generation:  0.02283024787902832
r_  generation:  0.18429350852966309
local_output_nid generation:  0.008149147033691406
local_in_edges_tensor generation:  0.011842489242553711
mini_batch_src_global generation:  0.024576663970947266
r_  generation:  0.18330740928649902
----------------------check_connections_block total spend ----------------------------- 8.497281551361084
generate_one_block  0.2339930534362793
generate_one_block  0.2377336025238037
generate_one_block  0.26753687858581543
generate_one_block  0.228240966796875
generate_one_block  0.22365117073059082
generate_one_block  0.21725749969482422
generate_one_block  0.22541284561157227
generate_one_block  0.22916436195373535
generate_one_block  0.22948670387268066
generate_one_block  0.22197270393371582
generate_one_block  0.22274518013000488
generate_one_block  0.23707175254821777
generate_one_block  0.2781102657318115
generate_one_block  0.24556732177734375
generate_one_block  0.22727298736572266
generate_one_block  0.25716590881347656
generate_one_block  0.22799253463745117
generate_one_block  0.22352337837219238
generate_one_block  0.21748614311218262
generate_one_block  0.22580909729003906
generate_one_block  0.22970032691955566
generate_one_block  0.22547698020935059
generate_one_block  0.23184895515441895
generate_one_block  0.23340630531311035
generate_one_block  0.22896361351013184
generate_one_block  0.22686386108398438
generate_one_block  0.21600890159606934
generate_one_block  0.22717547416687012
generate_one_block  0.2334904670715332
generate_one_block  0.2286224365234375
generate_one_block  0.24811911582946777
generate_one_block  0.2416698932647705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07845473289489746
gen group dst list time:  0.11793208122253418
time for parepare:  0.021644115447998047
local_output_nid generation:  0.022304534912109375
local_in_edges_tensor generation:  0.05995893478393555
mini_batch_src_global generation:  0.050234317779541016
r_  generation:  0.4731123447418213
local_output_nid generation:  0.030400753021240234
local_in_edges_tensor generation:  0.04811382293701172
mini_batch_src_global generation:  0.05815482139587402
r_  generation:  0.49186182022094727
local_output_nid generation:  0.02975916862487793
local_in_edges_tensor generation:  0.04306507110595703
mini_batch_src_global generation:  0.05650949478149414
r_  generation:  0.49413561820983887
local_output_nid generation:  0.02780318260192871
local_in_edges_tensor generation:  0.03033924102783203
mini_batch_src_global generation:  0.057466983795166016
r_  generation:  0.48407459259033203
local_output_nid generation:  0.027805089950561523
local_in_edges_tensor generation:  0.0340580940246582
mini_batch_src_global generation:  0.05782628059387207
r_  generation:  0.5046646595001221
local_output_nid generation:  0.02798938751220703
local_in_edges_tensor generation:  0.034242868423461914
mini_batch_src_global generation:  0.05845451354980469
r_  generation:  0.5057039260864258
local_output_nid generation:  0.029345989227294922
local_in_edges_tensor generation:  0.03691244125366211
mini_batch_src_global generation:  0.07647132873535156
r_  generation:  0.5037462711334229
local_output_nid generation:  0.0306546688079834
local_in_edges_tensor generation:  0.04444456100463867
mini_batch_src_global generation:  0.0610661506652832
r_  generation:  0.5126919746398926
local_output_nid generation:  0.028696060180664062
local_in_edges_tensor generation:  0.044173479080200195
mini_batch_src_global generation:  0.060266971588134766
r_  generation:  0.5173435211181641
local_output_nid generation:  0.03321266174316406
local_in_edges_tensor generation:  0.05474972724914551
mini_batch_src_global generation:  0.07535624504089355
r_  generation:  0.49763989448547363
local_output_nid generation:  0.02843308448791504
local_in_edges_tensor generation:  0.03726482391357422
mini_batch_src_global generation:  0.059060096740722656
r_  generation:  0.49498844146728516
local_output_nid generation:  0.028525352478027344
local_in_edges_tensor generation:  0.054651737213134766
mini_batch_src_global generation:  0.058709144592285156
r_  generation:  0.49628686904907227
local_output_nid generation:  0.029151439666748047
local_in_edges_tensor generation:  0.036606788635253906
mini_batch_src_global generation:  0.05856466293334961
r_  generation:  0.5044021606445312
local_output_nid generation:  0.02906632423400879
local_in_edges_tensor generation:  0.04480385780334473
mini_batch_src_global generation:  0.06151127815246582
r_  generation:  0.4986248016357422
local_output_nid generation:  0.02973628044128418
local_in_edges_tensor generation:  0.03557872772216797
mini_batch_src_global generation:  0.058037757873535156
r_  generation:  0.49393510818481445
local_output_nid generation:  0.02858591079711914
local_in_edges_tensor generation:  0.03231215476989746
mini_batch_src_global generation:  0.058510780334472656
r_  generation:  0.5153014659881592
local_output_nid generation:  0.028990507125854492
local_in_edges_tensor generation:  0.03773331642150879
mini_batch_src_global generation:  0.05760025978088379
r_  generation:  0.5011405944824219
local_output_nid generation:  0.029427289962768555
local_in_edges_tensor generation:  0.0350339412689209
mini_batch_src_global generation:  0.05937671661376953
r_  generation:  0.5000836849212646
local_output_nid generation:  0.028350114822387695
local_in_edges_tensor generation:  0.03207564353942871
mini_batch_src_global generation:  0.06146383285522461
r_  generation:  0.5248410701751709
local_output_nid generation:  0.03138995170593262
local_in_edges_tensor generation:  0.03894400596618652
mini_batch_src_global generation:  0.06416440010070801
r_  generation:  0.49809861183166504
local_output_nid generation:  0.029359817504882812
local_in_edges_tensor generation:  0.038039207458496094
mini_batch_src_global generation:  0.058719635009765625
r_  generation:  0.5044379234313965
local_output_nid generation:  0.02877187728881836
local_in_edges_tensor generation:  0.02848219871520996
mini_batch_src_global generation:  0.05894970893859863
r_  generation:  0.4965987205505371
local_output_nid generation:  0.02929377555847168
local_in_edges_tensor generation:  0.03276371955871582
mini_batch_src_global generation:  0.062441110610961914
r_  generation:  0.5023372173309326
local_output_nid generation:  0.029027223587036133
local_in_edges_tensor generation:  0.04122734069824219
mini_batch_src_global generation:  0.060479164123535156
r_  generation:  0.5023410320281982
local_output_nid generation:  0.028650999069213867
local_in_edges_tensor generation:  0.029517412185668945
mini_batch_src_global generation:  0.05942273139953613
r_  generation:  0.5040919780731201
local_output_nid generation:  0.0296478271484375
local_in_edges_tensor generation:  0.03440093994140625
mini_batch_src_global generation:  0.05904221534729004
r_  generation:  0.49724268913269043
local_output_nid generation:  0.029024124145507812
local_in_edges_tensor generation:  0.033304452896118164
mini_batch_src_global generation:  0.05920004844665527
r_  generation:  0.500002384185791
local_output_nid generation:  0.02884674072265625
local_in_edges_tensor generation:  0.03724098205566406
mini_batch_src_global generation:  0.058722734451293945
r_  generation:  0.5149703025817871
local_output_nid generation:  0.032150983810424805
local_in_edges_tensor generation:  0.04299592971801758
mini_batch_src_global generation:  0.066650390625
r_  generation:  0.5035557746887207
local_output_nid generation:  0.02888631820678711
local_in_edges_tensor generation:  0.0330967903137207
mini_batch_src_global generation:  0.05931401252746582
r_  generation:  0.4924025535583496
local_output_nid generation:  0.028677940368652344
local_in_edges_tensor generation:  0.027978181838989258
mini_batch_src_global generation:  0.058716773986816406
r_  generation:  0.5028867721557617
local_output_nid generation:  0.028847217559814453
local_in_edges_tensor generation:  0.04535627365112305
mini_batch_src_global generation:  0.05861520767211914
r_  generation:  0.49443650245666504
----------------------check_connections_block total spend ----------------------------- 23.671193599700928
generate_one_block  0.7485010623931885
generate_one_block  0.6581125259399414
generate_one_block  0.6456458568572998
generate_one_block  0.629427433013916
generate_one_block  0.6393520832061768
generate_one_block  0.6438055038452148
generate_one_block  0.6626009941101074
generate_one_block  0.6576316356658936
generate_one_block  0.6451692581176758
generate_one_block  0.657860279083252
generate_one_block  0.6545004844665527
generate_one_block  0.6430835723876953
generate_one_block  0.6465840339660645
generate_one_block  0.6532015800476074
generate_one_block  0.6260395050048828
generate_one_block  0.6439816951751709
generate_one_block  0.6494414806365967
generate_one_block  0.6493275165557861
generate_one_block  0.6451382637023926
generate_one_block  0.6562070846557617
generate_one_block  0.6851506233215332
generate_one_block  0.6340351104736328
generate_one_block  0.6565406322479248
generate_one_block  0.651273250579834
generate_one_block  0.6547608375549316
generate_one_block  0.6314501762390137
generate_one_block  0.6441898345947266
generate_one_block  0.6391067504882812
generate_one_block  0.6476173400878906
generate_one_block  0.6372997760772705
generate_one_block  0.6505951881408691
generate_one_block  0.6527843475341797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  32.16847515106201
block generation total time  28.2889564037323
average batch blocks generation time:  0.8840298876166344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0892033576965332  GigaBytes
Max Memory Allocated: 0.0892033576965332  GigaBytes

torch.Size([149950, 128])
torch.Size([109228, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.6038360595703125  GigaBytes
Max Memory Allocated: 0.6276311874389648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 0.09029102325439453  GigaBytes
Max Memory Allocated: 0.7111039161682129  GigaBytes

torch.Size([150788, 128])
torch.Size([110519, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 0.6095499992370605  GigaBytes
Max Memory Allocated: 0.7111039161682129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0908651351928711  GigaBytes
Max Memory Allocated: 0.7192087173461914  GigaBytes

torch.Size([150422, 128])
torch.Size([110765, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7655029296875 GB
    Memory Allocated: 0.6146788597106934  GigaBytes
Max Memory Allocated: 0.7192087173461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08961963653564453  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

torch.Size([149658, 128])
torch.Size([108932, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6043295860290527  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09053516387939453  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

torch.Size([150212, 128])
torch.Size([109932, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6086759567260742  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08986854553222656  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

torch.Size([150572, 128])
torch.Size([109436, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6013603210449219  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09048080444335938  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

torch.Size([150526, 128])
torch.Size([109973, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6092839241027832  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08985567092895508  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

torch.Size([150187, 128])
torch.Size([109463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6055021286010742  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09060287475585938  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

torch.Size([151054, 128])
torch.Size([110983, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6130828857421875  GigaBytes
Max Memory Allocated: 0.7202835083007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08988523483276367  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150247, 128])
torch.Size([109752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6091523170471191  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09045028686523438  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149885, 128])
torch.Size([109132, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.604485034942627  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08988571166992188  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150124, 128])
torch.Size([109989, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6100330352783203  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09054374694824219  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149647, 128])
torch.Size([108572, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6025199890136719  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09029817581176758  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150575, 128])
torch.Size([110782, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6141676902770996  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09039783477783203  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149967, 128])
torch.Size([109241, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6021037101745605  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08986282348632812  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150166, 128])
torch.Size([109427, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.605349063873291  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09060096740722656  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150028, 128])
torch.Size([109739, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6108202934265137  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08977794647216797  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150076, 128])
torch.Size([109351, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6051044464111328  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09043216705322266  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150669, 128])
torch.Size([109707, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6074943542480469  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09014892578125  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150756, 128])
torch.Size([110089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6092424392700195  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09062767028808594  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150568, 128])
torch.Size([110354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6093778610229492  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08989334106445312  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150242, 128])
torch.Size([109536, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6059384346008301  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09072494506835938  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150365, 128])
torch.Size([110422, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6124024391174316  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09004831314086914  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150295, 128])
torch.Size([110228, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6094989776611328  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09060955047607422  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149841, 128])
torch.Size([109197, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6057119369506836  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09005165100097656  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150396, 128])
torch.Size([109702, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6091194152832031  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09039878845214844  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150639, 128])
torch.Size([109788, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6076827049255371  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08976507186889648  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149771, 128])
torch.Size([109443, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6058549880981445  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.09064579010009766  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150799, 128])
torch.Size([110561, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6109142303466797  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.08973455429077148  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149899, 128])
torch.Size([109593, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6094851493835449  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.0906057357788086  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149831, 128])
torch.Size([109575, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6087031364440918  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.0899057388305664  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([149954, 128])
torch.Size([109851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8748779296875 GB
    Memory Allocated: 0.6107821464538574  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.049970924854278564 |0.027074873447418213 |0.025686971843242645 |9.609758853912354e-05 |0.006362393498420715 |0.004993438720703125 |
----------------------------------------------------------pseudo_mini_loss sum 6.307061672210693
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9161001
Number of first layer input nodes during this epoch:  4808109
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.11323976516723633  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01975703239440918
range selection method range initialization spend 0.011783123016357422
time for parepare:  0.017519712448120117
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.007470846176147461
mini_batch_src_global generation:  0.0016469955444335938
r_  generation:  0.010134458541870117
local_output_nid generation:  0.0008304119110107422
local_in_edges_tensor generation:  0.0006284713745117188
mini_batch_src_global generation:  0.0014829635620117188
r_  generation:  0.010607481002807617
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0005738735198974609
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.009169578552246094
local_output_nid generation:  0.0008890628814697266
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0010037422180175781
r_  generation:  0.010253667831420898
local_output_nid generation:  0.0007970333099365234
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.0009560585021972656
r_  generation:  0.009785175323486328
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.010386943817138672
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.009701728820800781
local_output_nid generation:  0.0007841587066650391
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.009744644165039062
local_output_nid generation:  0.00077056884765625
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.009854316711425781
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0009531974792480469
r_  generation:  0.00984334945678711
local_output_nid generation:  0.0008008480072021484
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0009484291076660156
r_  generation:  0.009899616241455078
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.0004742145538330078
mini_batch_src_global generation:  0.0009417533874511719
r_  generation:  0.009830236434936523
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0009446144104003906
r_  generation:  0.009926080703735352
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.010108232498168945
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0009012222290039062
r_  generation:  0.009240865707397461
local_output_nid generation:  0.0007829666137695312
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0009710788726806641
r_  generation:  0.010253190994262695
local_output_nid generation:  0.000759124755859375
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0010335445404052734
r_  generation:  0.010146379470825195
local_output_nid generation:  0.0007624626159667969
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0009393692016601562
r_  generation:  0.009542226791381836
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009596347808837891
r_  generation:  0.009962320327758789
local_output_nid generation:  0.0007605552673339844
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0009963512420654297
r_  generation:  0.01016688346862793
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.009524822235107422
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.010093927383422852
local_output_nid generation:  0.0007634162902832031
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.009923696517944336
local_output_nid generation:  0.0007412433624267578
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0010046958923339844
r_  generation:  0.013001680374145508
local_output_nid generation:  0.0007827281951904297
local_in_edges_tensor generation:  0.0005509853363037109
mini_batch_src_global generation:  0.0010268688201904297
r_  generation:  0.010001897811889648
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.010228395462036133
local_output_nid generation:  0.0007658004760742188
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0009722709655761719
r_  generation:  0.009976863861083984
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0010306835174560547
r_  generation:  0.011104583740234375
local_output_nid generation:  0.0007784366607666016
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.001093149185180664
r_  generation:  0.010317087173461914
local_output_nid generation:  0.0007715225219726562
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0010333061218261719
r_  generation:  0.010115861892700195
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.010329961776733398
local_output_nid generation:  0.0007708072662353516
local_in_edges_tensor generation:  0.0004978179931640625
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.010069608688354492
----------------------check_connections_block total spend ----------------------------- 0.4948451519012451
generate_one_block  0.019116878509521484
generate_one_block  0.017104387283325195
generate_one_block  0.014313936233520508
generate_one_block  0.015665531158447266
generate_one_block  0.014629364013671875
generate_one_block  0.015704870223999023
generate_one_block  0.014509916305541992
generate_one_block  0.014531850814819336
generate_one_block  0.014606952667236328
generate_one_block  0.014678001403808594
generate_one_block  0.014789581298828125
generate_one_block  0.014632701873779297
generate_one_block  0.014905691146850586
generate_one_block  0.01511240005493164
generate_one_block  0.013474702835083008
generate_one_block  0.015076637268066406
generate_one_block  0.015455484390258789
generate_one_block  0.013869047164916992
generate_one_block  0.014739990234375
generate_one_block  0.01557469367980957
generate_one_block  0.01411294937133789
generate_one_block  0.014975309371948242
generate_one_block  0.015382766723632812
generate_one_block  0.015106439590454102
generate_one_block  0.014956474304199219
generate_one_block  0.01511383056640625
generate_one_block  0.014698266983032227
generate_one_block  0.015437126159667969
generate_one_block  0.015541553497314453
generate_one_block  0.014521121978759766
generate_one_block  0.014307498931884766
generate_one_block  0.015034914016723633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04385828971862793
gen group dst list time:  0.021570920944213867
time for parepare:  0.019048690795898438
local_output_nid generation:  0.004173755645751953
local_in_edges_tensor generation:  0.016283512115478516
mini_batch_src_global generation:  0.016567230224609375
r_  generation:  0.15973567962646484
local_output_nid generation:  0.006876468658447266
local_in_edges_tensor generation:  0.014247655868530273
mini_batch_src_global generation:  0.022721290588378906
r_  generation:  0.1687612533569336
local_output_nid generation:  0.006650686264038086
local_in_edges_tensor generation:  0.030876636505126953
mini_batch_src_global generation:  0.01888132095336914
r_  generation:  0.161543607711792
local_output_nid generation:  0.007543087005615234
local_in_edges_tensor generation:  0.010219335556030273
mini_batch_src_global generation:  0.02266526222229004
r_  generation:  0.17981934547424316
local_output_nid generation:  0.007579803466796875
local_in_edges_tensor generation:  0.009810924530029297
mini_batch_src_global generation:  0.021282672882080078
r_  generation:  0.1730053424835205
local_output_nid generation:  0.007948637008666992
local_in_edges_tensor generation:  0.011850118637084961
mini_batch_src_global generation:  0.022707462310791016
r_  generation:  0.18465471267700195
local_output_nid generation:  0.0073719024658203125
local_in_edges_tensor generation:  0.008461952209472656
mini_batch_src_global generation:  0.021794557571411133
r_  generation:  0.1757221221923828
local_output_nid generation:  0.007440805435180664
local_in_edges_tensor generation:  0.009760141372680664
mini_batch_src_global generation:  0.022110700607299805
r_  generation:  0.1784496307373047
local_output_nid generation:  0.007935047149658203
local_in_edges_tensor generation:  0.01137399673461914
mini_batch_src_global generation:  0.021918535232543945
r_  generation:  0.1782090663909912
local_output_nid generation:  0.007926464080810547
local_in_edges_tensor generation:  0.008437156677246094
mini_batch_src_global generation:  0.022106409072875977
r_  generation:  0.17728304862976074
local_output_nid generation:  0.0095367431640625
local_in_edges_tensor generation:  0.01164865493774414
mini_batch_src_global generation:  0.022536277770996094
r_  generation:  0.17919254302978516
local_output_nid generation:  0.007966279983520508
local_in_edges_tensor generation:  0.009859085083007812
mini_batch_src_global generation:  0.02234339714050293
r_  generation:  0.18050694465637207
local_output_nid generation:  0.010429620742797852
local_in_edges_tensor generation:  0.01168203353881836
mini_batch_src_global generation:  0.022631406784057617
r_  generation:  0.18088769912719727
local_output_nid generation:  0.00809168815612793
local_in_edges_tensor generation:  0.010164499282836914
mini_batch_src_global generation:  0.02436041831970215
r_  generation:  0.18222713470458984
local_output_nid generation:  0.007497310638427734
local_in_edges_tensor generation:  0.010299444198608398
mini_batch_src_global generation:  0.020994186401367188
r_  generation:  0.17053580284118652
local_output_nid generation:  0.009584188461303711
local_in_edges_tensor generation:  0.009035348892211914
mini_batch_src_global generation:  0.024103164672851562
r_  generation:  0.18457484245300293
local_output_nid generation:  0.008337974548339844
local_in_edges_tensor generation:  0.021584749221801758
mini_batch_src_global generation:  0.0334620475769043
r_  generation:  0.18398547172546387
local_output_nid generation:  0.008995532989501953
local_in_edges_tensor generation:  0.009611129760742188
mini_batch_src_global generation:  0.021932363510131836
r_  generation:  0.17252230644226074
local_output_nid generation:  0.008542299270629883
local_in_edges_tensor generation:  0.011507511138916016
mini_batch_src_global generation:  0.023908138275146484
r_  generation:  0.19494342803955078
local_output_nid generation:  0.008325576782226562
local_in_edges_tensor generation:  0.011959075927734375
mini_batch_src_global generation:  0.028308391571044922
r_  generation:  0.19474029541015625
local_output_nid generation:  0.008821487426757812
local_in_edges_tensor generation:  0.01021265983581543
mini_batch_src_global generation:  0.022703170776367188
r_  generation:  0.18724799156188965
local_output_nid generation:  0.01009368896484375
local_in_edges_tensor generation:  0.017252445220947266
mini_batch_src_global generation:  0.023354768753051758
r_  generation:  0.17746758460998535
local_output_nid generation:  0.008055686950683594
local_in_edges_tensor generation:  0.011613845825195312
mini_batch_src_global generation:  0.02427840232849121
r_  generation:  0.1786353588104248
local_output_nid generation:  0.00803518295288086
local_in_edges_tensor generation:  0.010355472564697266
mini_batch_src_global generation:  0.022466659545898438
r_  generation:  0.17921757698059082
local_output_nid generation:  0.008039474487304688
local_in_edges_tensor generation:  0.01191854476928711
mini_batch_src_global generation:  0.023395776748657227
r_  generation:  0.18283629417419434
local_output_nid generation:  0.008263349533081055
local_in_edges_tensor generation:  0.011926889419555664
mini_batch_src_global generation:  0.023583173751831055
r_  generation:  0.18315482139587402
local_output_nid generation:  0.007900714874267578
local_in_edges_tensor generation:  0.010123252868652344
mini_batch_src_global generation:  0.022727489471435547
r_  generation:  0.1791365146636963
local_output_nid generation:  0.008301496505737305
local_in_edges_tensor generation:  0.010776281356811523
mini_batch_src_global generation:  0.02478766441345215
r_  generation:  0.1857590675354004
local_output_nid generation:  0.008197307586669922
local_in_edges_tensor generation:  0.008992433547973633
mini_batch_src_global generation:  0.02337503433227539
r_  generation:  0.18106532096862793
local_output_nid generation:  0.008043766021728516
local_in_edges_tensor generation:  0.009798765182495117
mini_batch_src_global generation:  0.02293539047241211
r_  generation:  0.1804981231689453
local_output_nid generation:  0.007772922515869141
local_in_edges_tensor generation:  0.009762048721313477
mini_batch_src_global generation:  0.022338390350341797
r_  generation:  0.17980742454528809
local_output_nid generation:  0.008022546768188477
local_in_edges_tensor generation:  0.008716821670532227
mini_batch_src_global generation:  0.0227048397064209
r_  generation:  0.18732976913452148
----------------------check_connections_block total spend ----------------------------- 8.448713779449463
generate_one_block  0.24674582481384277
generate_one_block  0.2346799373626709
generate_one_block  0.22368621826171875
generate_one_block  0.24356341361999512
generate_one_block  0.23859763145446777
generate_one_block  0.23997139930725098
generate_one_block  0.21805882453918457
generate_one_block  0.22472476959228516
generate_one_block  0.22159981727600098
generate_one_block  0.22346234321594238
generate_one_block  0.22552728652954102
generate_one_block  0.22282147407531738
generate_one_block  0.2286090850830078
generate_one_block  0.2517707347869873
generate_one_block  0.21337103843688965
generate_one_block  0.2364192008972168
generate_one_block  0.23887014389038086
generate_one_block  0.21511411666870117
generate_one_block  0.22708988189697266
generate_one_block  0.26891469955444336
generate_one_block  0.21641302108764648
generate_one_block  0.22080636024475098
generate_one_block  0.22772622108459473
generate_one_block  0.22804021835327148
generate_one_block  0.23784613609313965
generate_one_block  0.23305702209472656
generate_one_block  0.2199726104736328
generate_one_block  0.24527835845947266
generate_one_block  0.2475895881652832
generate_one_block  0.2309105396270752
generate_one_block  0.22956442832946777
generate_one_block  0.22613000869750977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.09807300567626953
gen group dst list time:  0.1142418384552002
time for parepare:  0.0192105770111084
local_output_nid generation:  0.0230252742767334
local_in_edges_tensor generation:  0.06712508201599121
mini_batch_src_global generation:  0.0466005802154541
r_  generation:  0.4836766719818115
local_output_nid generation:  0.031284332275390625
local_in_edges_tensor generation:  0.04921555519104004
mini_batch_src_global generation:  0.05841660499572754
r_  generation:  0.4844846725463867
local_output_nid generation:  0.028891801834106445
local_in_edges_tensor generation:  0.0345156192779541
mini_batch_src_global generation:  0.05654716491699219
r_  generation:  0.4875352382659912
local_output_nid generation:  0.028027772903442383
local_in_edges_tensor generation:  0.03481912612915039
mini_batch_src_global generation:  0.061177730560302734
r_  generation:  0.49567484855651855
local_output_nid generation:  0.028197526931762695
local_in_edges_tensor generation:  0.030514955520629883
mini_batch_src_global generation:  0.05816292762756348
r_  generation:  0.5057649612426758
local_output_nid generation:  0.027966737747192383
local_in_edges_tensor generation:  0.030397653579711914
mini_batch_src_global generation:  0.06727361679077148
r_  generation:  0.4983828067779541
local_output_nid generation:  0.028571128845214844
local_in_edges_tensor generation:  0.03914356231689453
mini_batch_src_global generation:  0.06115412712097168
r_  generation:  0.5314686298370361
local_output_nid generation:  0.030730009078979492
local_in_edges_tensor generation:  0.05301356315612793
mini_batch_src_global generation:  0.06406617164611816
r_  generation:  0.49352097511291504
local_output_nid generation:  0.029209375381469727
local_in_edges_tensor generation:  0.03822731971740723
mini_batch_src_global generation:  0.05798840522766113
r_  generation:  0.49510860443115234
local_output_nid generation:  0.028343677520751953
local_in_edges_tensor generation:  0.03315234184265137
mini_batch_src_global generation:  0.058864593505859375
r_  generation:  0.4909474849700928
local_output_nid generation:  0.028705596923828125
local_in_edges_tensor generation:  0.035398006439208984
mini_batch_src_global generation:  0.061702728271484375
r_  generation:  0.49669456481933594
local_output_nid generation:  0.02863788604736328
local_in_edges_tensor generation:  0.03531479835510254
mini_batch_src_global generation:  0.06238889694213867
r_  generation:  0.489457368850708
local_output_nid generation:  0.02826714515686035
local_in_edges_tensor generation:  0.031209945678710938
mini_batch_src_global generation:  0.05854940414428711
r_  generation:  0.49294042587280273
local_output_nid generation:  0.02853703498840332
local_in_edges_tensor generation:  0.03500080108642578
mini_batch_src_global generation:  0.08523821830749512
r_  generation:  0.501561164855957
local_output_nid generation:  0.03215432167053223
local_in_edges_tensor generation:  0.030728816986083984
mini_batch_src_global generation:  0.058565616607666016
r_  generation:  0.49804115295410156
local_output_nid generation:  0.02946639060974121
local_in_edges_tensor generation:  0.047821760177612305
mini_batch_src_global generation:  0.06346368789672852
r_  generation:  0.49675512313842773
local_output_nid generation:  0.02894425392150879
local_in_edges_tensor generation:  0.037293195724487305
mini_batch_src_global generation:  0.0582275390625
r_  generation:  0.49687767028808594
local_output_nid generation:  0.028449535369873047
local_in_edges_tensor generation:  0.02812480926513672
mini_batch_src_global generation:  0.06015753746032715
r_  generation:  0.5004079341888428
local_output_nid generation:  0.028796911239624023
local_in_edges_tensor generation:  0.036849021911621094
mini_batch_src_global generation:  0.07986640930175781
r_  generation:  0.5091564655303955
local_output_nid generation:  0.030381202697753906
local_in_edges_tensor generation:  0.03840780258178711
mini_batch_src_global generation:  0.059782981872558594
r_  generation:  0.49483394622802734
local_output_nid generation:  0.028443098068237305
local_in_edges_tensor generation:  0.033506155014038086
mini_batch_src_global generation:  0.058167219161987305
r_  generation:  0.49560070037841797
local_output_nid generation:  0.028813838958740234
local_in_edges_tensor generation:  0.0326991081237793
mini_batch_src_global generation:  0.0597081184387207
r_  generation:  0.5058779716491699
local_output_nid generation:  0.029519081115722656
local_in_edges_tensor generation:  0.032357215881347656
mini_batch_src_global generation:  0.058290719985961914
r_  generation:  0.5005314350128174
local_output_nid generation:  0.02976703643798828
local_in_edges_tensor generation:  0.04034733772277832
mini_batch_src_global generation:  0.06014680862426758
r_  generation:  0.49288058280944824
local_output_nid generation:  0.028880596160888672
local_in_edges_tensor generation:  0.032001495361328125
mini_batch_src_global generation:  0.05865740776062012
r_  generation:  0.4991164207458496
local_output_nid generation:  0.028858661651611328
local_in_edges_tensor generation:  0.03243827819824219
mini_batch_src_global generation:  0.05954313278198242
r_  generation:  0.49465322494506836
local_output_nid generation:  0.028552532196044922
local_in_edges_tensor generation:  0.03894352912902832
mini_batch_src_global generation:  0.058271169662475586
r_  generation:  0.5186364650726318
local_output_nid generation:  0.030469417572021484
local_in_edges_tensor generation:  0.04015779495239258
mini_batch_src_global generation:  0.06764411926269531
r_  generation:  0.4991297721862793
local_output_nid generation:  0.02944779396057129
local_in_edges_tensor generation:  0.039611101150512695
mini_batch_src_global generation:  0.05876660346984863
r_  generation:  0.49645185470581055
local_output_nid generation:  0.028515100479125977
local_in_edges_tensor generation:  0.03264927864074707
mini_batch_src_global generation:  0.059937238693237305
r_  generation:  0.49334096908569336
local_output_nid generation:  0.02892303466796875
local_in_edges_tensor generation:  0.03207039833068848
mini_batch_src_global generation:  0.05845904350280762
r_  generation:  0.5021529197692871
local_output_nid generation:  0.028890132904052734
local_in_edges_tensor generation:  0.03304123878479004
mini_batch_src_global generation:  0.05937480926513672
r_  generation:  0.5027971267700195
----------------------check_connections_block total spend ----------------------------- 23.511739015579224
generate_one_block  0.6636219024658203
generate_one_block  0.665259838104248
generate_one_block  0.6396689414978027
generate_one_block  0.6483478546142578
generate_one_block  0.7549686431884766
generate_one_block  0.6492033004760742
generate_one_block  0.6646242141723633
generate_one_block  0.649378776550293
generate_one_block  0.6398155689239502
generate_one_block  0.6406888961791992
generate_one_block  0.6399471759796143
generate_one_block  0.6514554023742676
generate_one_block  0.6546928882598877
generate_one_block  0.6523447036743164
generate_one_block  0.6337032318115234
generate_one_block  0.6567535400390625
generate_one_block  0.6480197906494141
generate_one_block  0.6377160549163818
generate_one_block  0.669201135635376
generate_one_block  0.6503527164459229
generate_one_block  0.6315133571624756
generate_one_block  0.6306767463684082
generate_one_block  0.6449761390686035
generate_one_block  0.6517319679260254
generate_one_block  0.6980974674224854
generate_one_block  0.668748140335083
generate_one_block  0.6314013004302979
generate_one_block  0.6437971591949463
generate_one_block  0.6578402519226074
generate_one_block  0.6371822357177734
generate_one_block  0.6378040313720703
generate_one_block  0.6555125713348389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.11323976516723633  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

connection checking time:  31.960452795028687
block generation total time  28.305978298187256
average batch blocks generation time:  0.8845618218183517
block dataloader generation time/epoch 62.896881103515625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09220361709594727  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150283, 128])
torch.Size([109841, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6116065979003906  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0916290283203125  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150046, 128])
torch.Size([109995, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6125550270080566  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09192657470703125  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150309, 128])
torch.Size([109088, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6017584800720215  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09194421768188477  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

torch.Size([150389, 128])
torch.Size([110296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6177992820739746  GigaBytes
Max Memory Allocated: 0.7207331657409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09209156036376953  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150258, 128])
torch.Size([109219, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6060595512390137  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09149408340454102  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([149501, 128])
torch.Size([109538, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6128091812133789  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09208106994628906  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150111, 128])
torch.Size([109287, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.605656623840332  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09181451797485352  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150691, 128])
torch.Size([110382, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6111583709716797  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0921335220336914  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150467, 128])
torch.Size([109859, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6104979515075684  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09158468246459961  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150369, 128])
torch.Size([109477, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6074838638305664  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0921630859375  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150274, 128])
torch.Size([109725, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6110162734985352  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09146404266357422  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150108, 128])
torch.Size([109633, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.609734058380127  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09087324142456055  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([148967, 128])
torch.Size([108330, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6014704704284668  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09180259704589844  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150552, 128])
torch.Size([110012, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6115555763244629  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09167337417602539  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150393, 128])
torch.Size([108308, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.5950069427490234  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09176349639892578  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150412, 128])
torch.Size([110061, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6123418807983398  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09221458435058594  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150502, 128])
torch.Size([109888, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6133437156677246  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09116744995117188  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150094, 128])
torch.Size([108794, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.5994358062744141  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0922861099243164  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150778, 128])
torch.Size([110689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6141986846923828  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09177923202514648  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150547, 128])
torch.Size([110436, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6130523681640625  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09194183349609375  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([149962, 128])
torch.Size([108517, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.5993084907531738  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09128618240356445  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([149835, 128])
torch.Size([109510, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6075077056884766  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09220409393310547  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150559, 128])
torch.Size([110110, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6121091842651367  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09132146835327148  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([149783, 128])
torch.Size([109517, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6083617210388184  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09238624572753906  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150249, 128])
torch.Size([110431, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6127872467041016  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09189271926879883  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

torch.Size([150611, 128])
torch.Size([110996, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6156220436096191  GigaBytes
Max Memory Allocated: 0.7211265563964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09210872650146484  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

torch.Size([149909, 128])
torch.Size([109191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6054387092590332  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09174728393554688  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

torch.Size([150106, 128])
torch.Size([110542, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6144137382507324  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0923166275024414  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

torch.Size([150254, 128])
torch.Size([110257, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6133322715759277  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.09148597717285156  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

torch.Size([150044, 128])
torch.Size([109141, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6059823036193848  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0920572280883789  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

torch.Size([150012, 128])
torch.Size([109463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6047782897949219  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.0915837287902832  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

torch.Size([150289, 128])
torch.Size([109788, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 0.6112589836120605  GigaBytes
Max Memory Allocated: 0.7232913970947266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.048857659101486206 |0.016555309295654297 |0.003641553223133087 |9.252876043319702e-05 |0.003960013389587402 |0.001458883285522461 |
----------------------------------------------------------pseudo_mini_loss sum 3.2340006828308105
Total (block generation + training)time/epoch 65.31161403656006
Training time/epoch 2.414463520050049
Training time without block to device /epoch 1.8846936225891113
Training time without total dataloading part /epoch 0.24766993522644043
load block tensor time/epoch 1.5634450912475586
block to device time/epoch 0.5297698974609375
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9156509
Number of first layer input nodes during this epoch:  4806664
