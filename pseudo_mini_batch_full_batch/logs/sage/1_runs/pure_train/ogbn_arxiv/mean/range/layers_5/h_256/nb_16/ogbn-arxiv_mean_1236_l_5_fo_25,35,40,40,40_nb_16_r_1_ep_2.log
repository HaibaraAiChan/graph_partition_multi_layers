Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648499725.79924
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024631738662719727
range selection method range initialization spend 0.013567447662353516
time for parepare:  0.01803755760192871
local_output_nid generation:  0.0013463497161865234
local_in_edges_tensor generation:  0.0037415027618408203
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.017894506454467773
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0020835399627685547
r_  generation:  0.01809072494506836
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.001430511474609375
r_  generation:  0.018241167068481445
local_output_nid generation:  0.0015246868133544922
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.001352548599243164
r_  generation:  0.01724839210510254
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.018015384674072266
local_output_nid generation:  0.0014421939849853516
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.0013098716735839844
r_  generation:  0.018629789352416992
local_output_nid generation:  0.001447439193725586
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.0014812946319580078
r_  generation:  0.01869058609008789
local_output_nid generation:  0.0014660358428955078
local_in_edges_tensor generation:  0.0008370876312255859
mini_batch_src_global generation:  0.0013208389282226562
r_  generation:  0.018499135971069336
local_output_nid generation:  0.001501321792602539
local_in_edges_tensor generation:  0.0008075237274169922
mini_batch_src_global generation:  0.0014345645904541016
r_  generation:  0.018795013427734375
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0008332729339599609
mini_batch_src_global generation:  0.0013980865478515625
r_  generation:  0.018950223922729492
local_output_nid generation:  0.001485586166381836
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.01896524429321289
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0013818740844726562
r_  generation:  0.018424510955810547
local_output_nid generation:  0.0014925003051757812
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.018671512603759766
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0008304119110107422
mini_batch_src_global generation:  0.0015060901641845703
r_  generation:  0.019024372100830078
local_output_nid generation:  0.0015270709991455078
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.019008636474609375
local_output_nid generation:  0.00148773193359375
local_in_edges_tensor generation:  0.0008206367492675781
mini_batch_src_global generation:  0.0015692710876464844
r_  generation:  0.018675565719604492
----------------------check_connections_block total spend ----------------------------- 0.44475769996643066
generate_one_block  0.027029037475585938
generate_one_block  0.027617692947387695
generate_one_block  0.027585983276367188
generate_one_block  0.028482913970947266
generate_one_block  0.027701139450073242
generate_one_block  0.027468204498291016
generate_one_block  0.027109146118164062
generate_one_block  0.027355670928955078
generate_one_block  0.02767205238342285
generate_one_block  0.028565406799316406
generate_one_block  0.028630971908569336
generate_one_block  0.02744603157043457
generate_one_block  0.027515649795532227
generate_one_block  0.028081417083740234
generate_one_block  0.027826309204101562
generate_one_block  0.02744770050048828
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.041996002197265625
gen group dst list time:  0.018616914749145508
time for parepare:  0.019720077514648438
local_output_nid generation:  0.0068264007568359375
local_in_edges_tensor generation:  0.014847755432128906
mini_batch_src_global generation:  0.01916670799255371
r_  generation:  0.19810104370117188
local_output_nid generation:  0.012439727783203125
local_in_edges_tensor generation:  0.019385337829589844
mini_batch_src_global generation:  0.024719715118408203
r_  generation:  0.20868229866027832
local_output_nid generation:  0.012912750244140625
local_in_edges_tensor generation:  0.016316652297973633
mini_batch_src_global generation:  0.024136781692504883
r_  generation:  0.2124037742614746
local_output_nid generation:  0.013176202774047852
local_in_edges_tensor generation:  0.012658119201660156
mini_batch_src_global generation:  0.024848222732543945
r_  generation:  0.21145915985107422
local_output_nid generation:  0.013454675674438477
local_in_edges_tensor generation:  0.01448512077331543
mini_batch_src_global generation:  0.025958776473999023
r_  generation:  0.21939325332641602
local_output_nid generation:  0.013434886932373047
local_in_edges_tensor generation:  0.01654052734375
mini_batch_src_global generation:  0.030168533325195312
r_  generation:  0.2159104347229004
local_output_nid generation:  0.013647079467773438
local_in_edges_tensor generation:  0.012996673583984375
mini_batch_src_global generation:  0.026441574096679688
r_  generation:  0.2149183750152588
local_output_nid generation:  0.013583660125732422
local_in_edges_tensor generation:  0.01504206657409668
mini_batch_src_global generation:  0.027039051055908203
r_  generation:  0.21383285522460938
local_output_nid generation:  0.014095067977905273
local_in_edges_tensor generation:  0.018509864807128906
mini_batch_src_global generation:  0.027194976806640625
r_  generation:  0.21979665756225586
local_output_nid generation:  0.014152288436889648
local_in_edges_tensor generation:  0.015343427658081055
mini_batch_src_global generation:  0.027681827545166016
r_  generation:  0.2207186222076416
local_output_nid generation:  0.014059305191040039
local_in_edges_tensor generation:  0.016849517822265625
mini_batch_src_global generation:  0.027254581451416016
r_  generation:  0.22138476371765137
local_output_nid generation:  0.013798713684082031
local_in_edges_tensor generation:  0.012845516204833984
mini_batch_src_global generation:  0.02730107307434082
r_  generation:  0.2189476490020752
local_output_nid generation:  0.014347314834594727
local_in_edges_tensor generation:  0.01347661018371582
mini_batch_src_global generation:  0.029044628143310547
r_  generation:  0.22263836860656738
local_output_nid generation:  0.014093637466430664
local_in_edges_tensor generation:  0.016675472259521484
mini_batch_src_global generation:  0.02768087387084961
r_  generation:  0.21951770782470703
local_output_nid generation:  0.014264583587646484
local_in_edges_tensor generation:  0.016788721084594727
mini_batch_src_global generation:  0.029411792755126953
r_  generation:  0.2256181240081787
local_output_nid generation:  0.014019489288330078
local_in_edges_tensor generation:  0.013418197631835938
mini_batch_src_global generation:  0.02760791778564453
r_  generation:  0.2156529426574707
----------------------check_connections_block total spend ----------------------------- 5.125572681427002
generate_one_block  0.28142213821411133
generate_one_block  0.28504371643066406
generate_one_block  0.28278589248657227
generate_one_block  0.2737419605255127
generate_one_block  0.305711030960083
generate_one_block  0.2792634963989258
generate_one_block  0.27925705909729004
generate_one_block  0.2773311138153076
generate_one_block  0.28925180435180664
generate_one_block  0.28910088539123535
generate_one_block  0.2794764041900635
generate_one_block  0.27066993713378906
generate_one_block  0.2856786251068115
generate_one_block  0.2775404453277588
generate_one_block  0.2978174686431885
generate_one_block  0.27835726737976074
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0403749942779541
gen group dst list time:  0.05977368354797363
time for parepare:  0.01939988136291504
local_output_nid generation:  0.024396896362304688
local_in_edges_tensor generation:  0.04036259651184082
mini_batch_src_global generation:  0.047222137451171875
r_  generation:  0.4870128631591797
local_output_nid generation:  0.03420877456665039
local_in_edges_tensor generation:  0.0485079288482666
mini_batch_src_global generation:  0.05780911445617676
r_  generation:  0.4911994934082031
local_output_nid generation:  0.03468894958496094
local_in_edges_tensor generation:  0.04082918167114258
mini_batch_src_global generation:  0.056319236755371094
r_  generation:  0.5031225681304932
local_output_nid generation:  0.035022735595703125
local_in_edges_tensor generation:  0.03138256072998047
mini_batch_src_global generation:  0.05937838554382324
r_  generation:  0.503103494644165
local_output_nid generation:  0.035333871841430664
local_in_edges_tensor generation:  0.04525876045227051
mini_batch_src_global generation:  0.05898880958557129
r_  generation:  0.5088510513305664
local_output_nid generation:  0.03545880317687988
local_in_edges_tensor generation:  0.0321505069732666
mini_batch_src_global generation:  0.06302165985107422
r_  generation:  0.5075430870056152
local_output_nid generation:  0.03555440902709961
local_in_edges_tensor generation:  0.03193521499633789
mini_batch_src_global generation:  0.05917668342590332
r_  generation:  0.5124311447143555
local_output_nid generation:  0.03516674041748047
local_in_edges_tensor generation:  0.03583526611328125
mini_batch_src_global generation:  0.06045389175415039
r_  generation:  0.5112271308898926
local_output_nid generation:  0.035689353942871094
local_in_edges_tensor generation:  0.036043643951416016
mini_batch_src_global generation:  0.06293320655822754
r_  generation:  0.5142414569854736
local_output_nid generation:  0.03606247901916504
local_in_edges_tensor generation:  0.04254794120788574
mini_batch_src_global generation:  0.05991077423095703
r_  generation:  0.506596565246582
local_output_nid generation:  0.035437822341918945
local_in_edges_tensor generation:  0.03168129920959473
mini_batch_src_global generation:  0.05943608283996582
r_  generation:  0.5162584781646729
local_output_nid generation:  0.03540444374084473
local_in_edges_tensor generation:  0.03715634346008301
mini_batch_src_global generation:  0.061089277267456055
r_  generation:  0.5036807060241699
local_output_nid generation:  0.03575706481933594
local_in_edges_tensor generation:  0.04579639434814453
mini_batch_src_global generation:  0.058385372161865234
r_  generation:  0.5126316547393799
local_output_nid generation:  0.03581666946411133
local_in_edges_tensor generation:  0.031481027603149414
mini_batch_src_global generation:  0.05968332290649414
r_  generation:  0.5011672973632812
local_output_nid generation:  0.03144121170043945
local_in_edges_tensor generation:  0.04265904426574707
mini_batch_src_global generation:  0.06248807907104492
r_  generation:  0.509486198425293
local_output_nid generation:  0.030795812606811523
local_in_edges_tensor generation:  0.030315160751342773
mini_batch_src_global generation:  0.05993962287902832
r_  generation:  0.504908561706543
----------------------check_connections_block total spend ----------------------------- 11.922976016998291
generate_one_block  0.6469407081604004
generate_one_block  0.6571333408355713
generate_one_block  0.6636385917663574
generate_one_block  0.6420176029205322
generate_one_block  0.6624696254730225
generate_one_block  0.6568388938903809
generate_one_block  0.699293851852417
generate_one_block  0.6460425853729248
generate_one_block  0.6756143569946289
generate_one_block  0.6609339714050293
generate_one_block  0.6537735462188721
generate_one_block  0.6413815021514893
generate_one_block  0.6800358295440674
generate_one_block  0.6363873481750488
generate_one_block  0.6597895622253418
generate_one_block  0.6345140933990479
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.079681396484375
gen group dst list time:  0.09529423713684082
time for parepare:  0.019509077072143555
local_output_nid generation:  0.030926227569580078
local_in_edges_tensor generation:  0.07754659652709961
mini_batch_src_global generation:  0.050269365310668945
r_  generation:  0.527313232421875
local_output_nid generation:  0.03739333152770996
local_in_edges_tensor generation:  0.05415964126586914
mini_batch_src_global generation:  0.06728911399841309
r_  generation:  0.5311093330383301
local_output_nid generation:  0.03636431694030762
local_in_edges_tensor generation:  0.04054403305053711
mini_batch_src_global generation:  0.0625300407409668
r_  generation:  0.5352370738983154
local_output_nid generation:  0.0374598503112793
local_in_edges_tensor generation:  0.049358367919921875
mini_batch_src_global generation:  0.05843091011047363
r_  generation:  0.551030158996582
local_output_nid generation:  0.03767108917236328
local_in_edges_tensor generation:  0.05282139778137207
mini_batch_src_global generation:  0.06490540504455566
r_  generation:  0.5435929298400879
local_output_nid generation:  0.039374351501464844
local_in_edges_tensor generation:  0.051271677017211914
mini_batch_src_global generation:  0.05844402313232422
r_  generation:  0.5457336902618408
local_output_nid generation:  0.038268327713012695
local_in_edges_tensor generation:  0.03872370719909668
mini_batch_src_global generation:  0.059259891510009766
r_  generation:  0.546536922454834
local_output_nid generation:  0.03804922103881836
local_in_edges_tensor generation:  0.049698591232299805
mini_batch_src_global generation:  0.05947756767272949
r_  generation:  0.5493671894073486
local_output_nid generation:  0.03808403015136719
local_in_edges_tensor generation:  0.04568767547607422
mini_batch_src_global generation:  0.060334205627441406
r_  generation:  0.553229808807373
local_output_nid generation:  0.04057049751281738
local_in_edges_tensor generation:  0.039820194244384766
mini_batch_src_global generation:  0.06168198585510254
r_  generation:  0.5553932189941406
local_output_nid generation:  0.03840279579162598
local_in_edges_tensor generation:  0.04072308540344238
mini_batch_src_global generation:  0.06409859657287598
r_  generation:  0.5530731678009033
local_output_nid generation:  0.03837299346923828
local_in_edges_tensor generation:  0.04085040092468262
mini_batch_src_global generation:  0.060379981994628906
r_  generation:  0.5527288913726807
local_output_nid generation:  0.038187265396118164
local_in_edges_tensor generation:  0.040972232818603516
mini_batch_src_global generation:  0.06435370445251465
r_  generation:  0.5572633743286133
local_output_nid generation:  0.038977861404418945
local_in_edges_tensor generation:  0.03632402420043945
mini_batch_src_global generation:  0.06147933006286621
r_  generation:  0.5515851974487305
local_output_nid generation:  0.038306474685668945
local_in_edges_tensor generation:  0.03666377067565918
mini_batch_src_global generation:  0.060977935791015625
r_  generation:  0.554419994354248
local_output_nid generation:  0.038813114166259766
local_in_edges_tensor generation:  0.04065537452697754
mini_batch_src_global generation:  0.061183929443359375
r_  generation:  0.5635387897491455
----------------------check_connections_block total spend ----------------------------- 13.152027606964111
generate_one_block  0.6817913055419922
generate_one_block  0.685326337814331
generate_one_block  0.7522733211517334
generate_one_block  0.6859316825866699
generate_one_block  0.6936547756195068
generate_one_block  0.6667506694793701
generate_one_block  0.6652803421020508
generate_one_block  0.6902370452880859
generate_one_block  0.694563627243042
generate_one_block  0.6742489337921143
generate_one_block  0.6901407241821289
generate_one_block  0.687431812286377
generate_one_block  0.6888093948364258
generate_one_block  0.6764516830444336
generate_one_block  0.6725313663482666
generate_one_block  0.6973891258239746
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03986096382141113
gen group dst list time:  0.09614968299865723
time for parepare:  0.019481658935546875
local_output_nid generation:  0.03523421287536621
local_in_edges_tensor generation:  0.0456538200378418
mini_batch_src_global generation:  0.04603862762451172
r_  generation:  0.49603962898254395
local_output_nid generation:  0.040222883224487305
local_in_edges_tensor generation:  0.03324723243713379
mini_batch_src_global generation:  0.057447195053100586
r_  generation:  0.5046515464782715
local_output_nid generation:  0.03834056854248047
local_in_edges_tensor generation:  0.034096479415893555
mini_batch_src_global generation:  0.05784916877746582
r_  generation:  0.5027101039886475
local_output_nid generation:  0.0388181209564209
local_in_edges_tensor generation:  0.03418564796447754
mini_batch_src_global generation:  0.05650472640991211
r_  generation:  0.4999117851257324
local_output_nid generation:  0.03879380226135254
local_in_edges_tensor generation:  0.03987264633178711
mini_batch_src_global generation:  0.05716848373413086
r_  generation:  0.5062940120697021
local_output_nid generation:  0.03883862495422363
local_in_edges_tensor generation:  0.038411855697631836
mini_batch_src_global generation:  0.057804107666015625
r_  generation:  0.5114333629608154
local_output_nid generation:  0.03873920440673828
local_in_edges_tensor generation:  0.040093421936035156
mini_batch_src_global generation:  0.05730152130126953
r_  generation:  0.505962610244751
local_output_nid generation:  0.03917288780212402
local_in_edges_tensor generation:  0.048185110092163086
mini_batch_src_global generation:  0.056478261947631836
r_  generation:  0.514162540435791
local_output_nid generation:  0.03952765464782715
local_in_edges_tensor generation:  0.04313969612121582
mini_batch_src_global generation:  0.05743741989135742
r_  generation:  0.5094525814056396
local_output_nid generation:  0.03942728042602539
local_in_edges_tensor generation:  0.03509163856506348
mini_batch_src_global generation:  0.05700993537902832
r_  generation:  0.5204489231109619
local_output_nid generation:  0.039415836334228516
local_in_edges_tensor generation:  0.04050278663635254
mini_batch_src_global generation:  0.07788491249084473
r_  generation:  0.5091772079467773
local_output_nid generation:  0.03953385353088379
local_in_edges_tensor generation:  0.0477142333984375
mini_batch_src_global generation:  0.05677604675292969
r_  generation:  0.508840799331665
local_output_nid generation:  0.03941202163696289
local_in_edges_tensor generation:  0.04771995544433594
mini_batch_src_global generation:  0.05681777000427246
r_  generation:  0.5160977840423584
local_output_nid generation:  0.03941035270690918
local_in_edges_tensor generation:  0.03413248062133789
mini_batch_src_global generation:  0.056787967681884766
r_  generation:  0.5144450664520264
local_output_nid generation:  0.03943634033203125
local_in_edges_tensor generation:  0.037145137786865234
mini_batch_src_global generation:  0.05683135986328125
r_  generation:  0.5165188312530518
local_output_nid generation:  0.039698123931884766
local_in_edges_tensor generation:  0.03906559944152832
mini_batch_src_global generation:  0.05736494064331055
r_  generation:  0.518561601638794
----------------------check_connections_block total spend ----------------------------- 12.281757593154907
generate_one_block  0.6291470527648926
generate_one_block  0.6386699676513672
generate_one_block  0.641028642654419
generate_one_block  0.6405208110809326
generate_one_block  0.7329308986663818
generate_one_block  0.6490399837493896
generate_one_block  0.6458187103271484
generate_one_block  0.6533372402191162
generate_one_block  0.6613950729370117
generate_one_block  0.6543872356414795
generate_one_block  0.6326789855957031
generate_one_block  0.7034828662872314
generate_one_block  0.6488912105560303
generate_one_block  0.6519374847412109
generate_one_block  0.6398270130157471
generate_one_block  0.6539199352264404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018024444580078125  GigaBytes
Max Memory Allocated: 0.0018024444580078125  GigaBytes

connection checking time:  42.48233389854431
block generation total time  36.52907991409302
average batch blocks generation time:  2.2830674946308136
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12342119216918945  GigaBytes
Max Memory Allocated: 0.12342119216918945  GigaBytes

torch.Size([166330, 128])
torch.Size([163977, 256])
torch.Size([156033, 256])
torch.Size([124295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5838623046875 GB
    Memory Allocated: 2.0641326904296875  GigaBytes
Max Memory Allocated: 2.101658821105957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 0.1271224021911621  GigaBytes
Max Memory Allocated: 2.1432137489318848  GigaBytes

torch.Size([166290, 128])
torch.Size([163915, 256])
torch.Size([155776, 256])
torch.Size([123776, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0613746643066406  GigaBytes
Max Memory Allocated: 2.1432137489318848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.1271219253540039  GigaBytes
Max Memory Allocated: 2.1432137489318848  GigaBytes

torch.Size([166248, 128])
torch.Size([163885, 256])
torch.Size([155799, 256])
torch.Size([124170, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.066251754760742  GigaBytes
Max Memory Allocated: 2.1432137489318848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12700748443603516  GigaBytes
Max Memory Allocated: 2.145495891571045  GigaBytes

torch.Size([166264, 128])
torch.Size([163907, 256])
torch.Size([155691, 256])
torch.Size([123634, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0571699142456055  GigaBytes
Max Memory Allocated: 2.145495891571045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12714529037475586  GigaBytes
Max Memory Allocated: 2.145495891571045  GigaBytes

torch.Size([166317, 128])
torch.Size([164021, 256])
torch.Size([156001, 256])
torch.Size([124313, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.067552089691162  GigaBytes
Max Memory Allocated: 2.145495891571045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12702131271362305  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

torch.Size([166302, 128])
torch.Size([163819, 256])
torch.Size([155545, 256])
torch.Size([123234, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.055431842803955  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.1270427703857422  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

torch.Size([166312, 128])
torch.Size([163948, 256])
torch.Size([155769, 256])
torch.Size([123878, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0602617263793945  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.1269526481628418  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

torch.Size([166318, 128])
torch.Size([164044, 256])
torch.Size([155729, 256])
torch.Size([123365, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0568413734436035  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12711095809936523  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

torch.Size([166331, 128])
torch.Size([164073, 256])
torch.Size([155985, 256])
torch.Size([124220, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.067777633666992  GigaBytes
Max Memory Allocated: 2.146738052368164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12714242935180664  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166211, 128])
torch.Size([163922, 256])
torch.Size([155736, 256])
torch.Size([123588, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.060446262359619  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.1270899772644043  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166216, 128])
torch.Size([163968, 256])
torch.Size([155837, 256])
torch.Size([123784, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0600075721740723  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12691736221313477  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166392, 128])
torch.Size([164104, 256])
torch.Size([155737, 256])
torch.Size([123244, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.054622173309326  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12711095809936523  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166346, 128])
torch.Size([164006, 256])
torch.Size([155953, 256])
torch.Size([124542, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0671329498291016  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.1270308494567871  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166307, 128])
torch.Size([163937, 256])
torch.Size([155609, 256])
torch.Size([123296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0564117431640625  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12717676162719727  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166271, 128])
torch.Size([163865, 256])
torch.Size([155576, 256])
torch.Size([123749, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.060457706451416  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 0.12698841094970703  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166308, 128])
torch.Size([164079, 256])
torch.Size([155936, 256])
torch.Size([123770, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3807373046875 GB
    Memory Allocated: 2.0593514442443848  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14251437783241272 |0.06048710644245148 |0.04992508888244629 |9.781122207641602e-05 |0.04758301377296448 |0.0032324790954589844 |
----------------------------------------------------------pseudo_mini_loss sum 6.110597610473633
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10419219
Number of first layer input nodes during this epoch:  2660763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 0.2059159278869629  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.019734621047973633
range selection method range initialization spend 0.014980792999267578
time for parepare:  0.016824007034301758
local_output_nid generation:  0.0013473033905029297
local_in_edges_tensor generation:  0.0043182373046875
mini_batch_src_global generation:  0.0032863616943359375
r_  generation:  0.020536184310913086
local_output_nid generation:  0.0018131732940673828
local_in_edges_tensor generation:  0.0010712146759033203
mini_batch_src_global generation:  0.002250194549560547
r_  generation:  0.01935291290283203
local_output_nid generation:  0.0018515586853027344
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.00141143798828125
r_  generation:  0.018088340759277344
local_output_nid generation:  0.001924276351928711
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.001497507095336914
r_  generation:  0.01781439781188965
local_output_nid generation:  0.0019135475158691406
local_in_edges_tensor generation:  0.0009238719940185547
mini_batch_src_global generation:  0.001325845718383789
r_  generation:  0.0181276798248291
local_output_nid generation:  0.0018405914306640625
local_in_edges_tensor generation:  0.0009267330169677734
mini_batch_src_global generation:  0.001493215560913086
r_  generation:  0.018336772918701172
local_output_nid generation:  0.0017800331115722656
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.001462697982788086
r_  generation:  0.018355607986450195
local_output_nid generation:  0.0017783641815185547
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0014801025390625
r_  generation:  0.018572330474853516
local_output_nid generation:  0.0017807483673095703
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.018428564071655273
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.018894433975219727
local_output_nid generation:  0.0017595291137695312
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.018804073333740234
local_output_nid generation:  0.0017886161804199219
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.0015819072723388672
r_  generation:  0.018644332885742188
local_output_nid generation:  0.0018105506896972656
local_in_edges_tensor generation:  0.0009613037109375
mini_batch_src_global generation:  0.0014460086822509766
r_  generation:  0.01922011375427246
local_output_nid generation:  0.0017774105072021484
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0015485286712646484
r_  generation:  0.019047021865844727
local_output_nid generation:  0.0018000602722167969
local_in_edges_tensor generation:  0.0009799003601074219
mini_batch_src_global generation:  0.0016465187072753906
r_  generation:  0.019074678421020508
local_output_nid generation:  0.0018541812896728516
local_in_edges_tensor generation:  0.0010013580322265625
mini_batch_src_global generation:  0.0016188621520996094
r_  generation:  0.019455432891845703
----------------------check_connections_block total spend ----------------------------- 0.46992969512939453
generate_one_block  0.042497873306274414
generate_one_block  0.028265953063964844
generate_one_block  0.027944326400756836
generate_one_block  0.04038715362548828
generate_one_block  0.02883434295654297
generate_one_block  0.03131246566772461
generate_one_block  0.028598308563232422
generate_one_block  0.028354406356811523
generate_one_block  0.0285184383392334
generate_one_block  0.028368473052978516
generate_one_block  0.028589963912963867
generate_one_block  0.02953791618347168
generate_one_block  0.033399343490600586
generate_one_block  0.040915727615356445
generate_one_block  0.028609514236450195
generate_one_block  0.028666973114013672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04207801818847656
gen group dst list time:  0.019531726837158203
time for parepare:  0.03120732307434082
local_output_nid generation:  0.007345914840698242
local_in_edges_tensor generation:  0.034435272216796875
mini_batch_src_global generation:  0.021197080612182617
r_  generation:  0.2116553783416748
local_output_nid generation:  0.012837886810302734
local_in_edges_tensor generation:  0.019463777542114258
mini_batch_src_global generation:  0.03345036506652832
r_  generation:  0.21220111846923828
local_output_nid generation:  0.011598825454711914
local_in_edges_tensor generation:  0.01716470718383789
mini_batch_src_global generation:  0.02420496940612793
r_  generation:  0.21876311302185059
local_output_nid generation:  0.012117862701416016
local_in_edges_tensor generation:  0.019256114959716797
mini_batch_src_global generation:  0.025293350219726562
r_  generation:  0.21909117698669434
local_output_nid generation:  0.012099742889404297
local_in_edges_tensor generation:  0.013477087020874023
mini_batch_src_global generation:  0.02810955047607422
r_  generation:  0.22288966178894043
local_output_nid generation:  0.012339591979980469
local_in_edges_tensor generation:  0.015349864959716797
mini_batch_src_global generation:  0.026706218719482422
r_  generation:  0.22086071968078613
local_output_nid generation:  0.012577533721923828
local_in_edges_tensor generation:  0.01124715805053711
mini_batch_src_global generation:  0.028365612030029297
r_  generation:  0.2196521759033203
local_output_nid generation:  0.012807369232177734
local_in_edges_tensor generation:  0.011684894561767578
mini_batch_src_global generation:  0.027062416076660156
r_  generation:  0.2218949794769287
local_output_nid generation:  0.013062715530395508
local_in_edges_tensor generation:  0.01542043685913086
mini_batch_src_global generation:  0.02748703956604004
r_  generation:  0.22162175178527832
local_output_nid generation:  0.012758255004882812
local_in_edges_tensor generation:  0.01322174072265625
mini_batch_src_global generation:  0.028873205184936523
r_  generation:  0.22287392616271973
local_output_nid generation:  0.012790203094482422
local_in_edges_tensor generation:  0.01148080825805664
mini_batch_src_global generation:  0.03061699867248535
r_  generation:  0.2181682586669922
local_output_nid generation:  0.012923717498779297
local_in_edges_tensor generation:  0.011511802673339844
mini_batch_src_global generation:  0.02884674072265625
r_  generation:  0.2232036590576172
local_output_nid generation:  0.013260602951049805
local_in_edges_tensor generation:  0.021281957626342773
mini_batch_src_global generation:  0.027583599090576172
r_  generation:  0.22509384155273438
local_output_nid generation:  0.013260602951049805
local_in_edges_tensor generation:  0.012005805969238281
mini_batch_src_global generation:  0.02745199203491211
r_  generation:  0.22469258308410645
local_output_nid generation:  0.014487504959106445
local_in_edges_tensor generation:  0.020430803298950195
mini_batch_src_global generation:  0.0295870304107666
r_  generation:  0.23896312713623047
local_output_nid generation:  0.015452861785888672
local_in_edges_tensor generation:  0.015610456466674805
mini_batch_src_global generation:  0.03197193145751953
r_  generation:  0.219862699508667
----------------------check_connections_block total spend ----------------------------- 5.269230127334595
generate_one_block  0.28667545318603516
generate_one_block  0.2801475524902344
generate_one_block  0.28882908821105957
generate_one_block  0.2905886173248291
generate_one_block  0.2864956855773926
generate_one_block  0.2868640422821045
generate_one_block  0.30153560638427734
generate_one_block  0.2924339771270752
generate_one_block  0.28265976905822754
generate_one_block  0.2828099727630615
generate_one_block  0.27327632904052734
generate_one_block  0.2871544361114502
generate_one_block  0.2894265651702881
generate_one_block  0.27342867851257324
generate_one_block  0.289470911026001
generate_one_block  0.27637338638305664
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04349327087402344
gen group dst list time:  0.06749510765075684
time for parepare:  0.018943309783935547
local_output_nid generation:  0.025133848190307617
local_in_edges_tensor generation:  0.05929851531982422
mini_batch_src_global generation:  0.04911041259765625
r_  generation:  0.494464635848999
local_output_nid generation:  0.030064821243286133
local_in_edges_tensor generation:  0.04774665832519531
mini_batch_src_global generation:  0.05807852745056152
r_  generation:  0.5058600902557373
local_output_nid generation:  0.03009486198425293
local_in_edges_tensor generation:  0.04381728172302246
mini_batch_src_global generation:  0.057534217834472656
r_  generation:  0.5069887638092041
local_output_nid generation:  0.030360698699951172
local_in_edges_tensor generation:  0.03448295593261719
mini_batch_src_global generation:  0.05898141860961914
r_  generation:  0.4999101161956787
local_output_nid generation:  0.030553579330444336
local_in_edges_tensor generation:  0.0847928524017334
mini_batch_src_global generation:  0.05857276916503906
r_  generation:  0.508965253829956
local_output_nid generation:  0.03069448471069336
local_in_edges_tensor generation:  0.030579805374145508
mini_batch_src_global generation:  0.07593393325805664
r_  generation:  0.5039472579956055
local_output_nid generation:  0.030831575393676758
local_in_edges_tensor generation:  0.030211687088012695
mini_batch_src_global generation:  0.05839061737060547
r_  generation:  0.5098323822021484
local_output_nid generation:  0.03199172019958496
local_in_edges_tensor generation:  0.033898353576660156
mini_batch_src_global generation:  0.06721997261047363
r_  generation:  0.5155727863311768
local_output_nid generation:  0.03113412857055664
local_in_edges_tensor generation:  0.04804420471191406
mini_batch_src_global generation:  0.07077407836914062
r_  generation:  0.5167033672332764
local_output_nid generation:  0.03293204307556152
local_in_edges_tensor generation:  0.0406496524810791
mini_batch_src_global generation:  0.06066417694091797
r_  generation:  0.5102095603942871
local_output_nid generation:  0.03234457969665527
local_in_edges_tensor generation:  0.03215456008911133
mini_batch_src_global generation:  0.05839037895202637
r_  generation:  0.5129439830780029
local_output_nid generation:  0.03209996223449707
local_in_edges_tensor generation:  0.039170265197753906
mini_batch_src_global generation:  0.06301140785217285
r_  generation:  0.5061526298522949
local_output_nid generation:  0.03208732604980469
local_in_edges_tensor generation:  0.04379534721374512
mini_batch_src_global generation:  0.07281112670898438
r_  generation:  0.5295939445495605
local_output_nid generation:  0.03240323066711426
local_in_edges_tensor generation:  0.04373741149902344
mini_batch_src_global generation:  0.059252023696899414
r_  generation:  0.5141904354095459
local_output_nid generation:  0.03261113166809082
local_in_edges_tensor generation:  0.0343785285949707
mini_batch_src_global generation:  0.05851459503173828
r_  generation:  0.5215373039245605
local_output_nid generation:  0.03188323974609375
local_in_edges_tensor generation:  0.030249357223510742
mini_batch_src_global generation:  0.05999469757080078
r_  generation:  0.5041990280151367
----------------------check_connections_block total spend ----------------------------- 12.061206579208374
generate_one_block  0.6681933403015137
generate_one_block  0.6721029281616211
generate_one_block  0.6526610851287842
generate_one_block  0.6480469703674316
generate_one_block  0.6505227088928223
generate_one_block  0.6592419147491455
generate_one_block  0.638676643371582
generate_one_block  0.6427960395812988
generate_one_block  0.6804053783416748
generate_one_block  0.6506288051605225
generate_one_block  0.6524040699005127
generate_one_block  0.653099775314331
generate_one_block  0.6768889427185059
generate_one_block  0.6658434867858887
generate_one_block  0.6447534561157227
generate_one_block  0.6444575786590576
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.12404489517211914
gen group dst list time:  0.09923911094665527
time for parepare:  0.019341468811035156
local_output_nid generation:  0.030633211135864258
local_in_edges_tensor generation:  0.059694528579711914
mini_batch_src_global generation:  0.05234646797180176
r_  generation:  0.5187504291534424
local_output_nid generation:  0.038015127182006836
local_in_edges_tensor generation:  0.05204916000366211
mini_batch_src_global generation:  0.06165289878845215
r_  generation:  0.529914379119873
local_output_nid generation:  0.03808236122131348
local_in_edges_tensor generation:  0.04342246055603027
mini_batch_src_global generation:  0.05717325210571289
r_  generation:  0.534536600112915
local_output_nid generation:  0.03845405578613281
local_in_edges_tensor generation:  0.03387141227722168
mini_batch_src_global generation:  0.05779433250427246
r_  generation:  0.5378291606903076
local_output_nid generation:  0.03628897666931152
local_in_edges_tensor generation:  0.03845643997192383
mini_batch_src_global generation:  0.05699276924133301
r_  generation:  0.5406105518341064
local_output_nid generation:  0.03586530685424805
local_in_edges_tensor generation:  0.04350614547729492
mini_batch_src_global generation:  0.05695605278015137
r_  generation:  0.5714359283447266
local_output_nid generation:  0.03666067123413086
local_in_edges_tensor generation:  0.04411673545837402
mini_batch_src_global generation:  0.05780649185180664
r_  generation:  0.5409789085388184
local_output_nid generation:  0.03629565238952637
local_in_edges_tensor generation:  0.04358553886413574
mini_batch_src_global generation:  0.05795431137084961
r_  generation:  0.5566682815551758
local_output_nid generation:  0.03657650947570801
local_in_edges_tensor generation:  0.0345454216003418
mini_batch_src_global generation:  0.05923724174499512
r_  generation:  0.5457096099853516
local_output_nid generation:  0.03617358207702637
local_in_edges_tensor generation:  0.03421449661254883
mini_batch_src_global generation:  0.058794260025024414
r_  generation:  0.5543491840362549
local_output_nid generation:  0.03653264045715332
local_in_edges_tensor generation:  0.0343325138092041
mini_batch_src_global generation:  0.06321501731872559
r_  generation:  0.5503230094909668
local_output_nid generation:  0.03660273551940918
local_in_edges_tensor generation:  0.03471517562866211
mini_batch_src_global generation:  0.058945655822753906
r_  generation:  0.5496828556060791
local_output_nid generation:  0.036852359771728516
local_in_edges_tensor generation:  0.03882193565368652
mini_batch_src_global generation:  0.06033754348754883
r_  generation:  0.5500979423522949
local_output_nid generation:  0.0363919734954834
local_in_edges_tensor generation:  0.04804205894470215
mini_batch_src_global generation:  0.05899405479431152
r_  generation:  0.5495190620422363
local_output_nid generation:  0.036599159240722656
local_in_edges_tensor generation:  0.03428077697753906
mini_batch_src_global generation:  0.0605769157409668
r_  generation:  0.5505304336547852
local_output_nid generation:  0.03642892837524414
local_in_edges_tensor generation:  0.03413510322570801
mini_batch_src_global generation:  0.06050419807434082
r_  generation:  0.5526151657104492
----------------------check_connections_block total spend ----------------------------- 12.957091808319092
generate_one_block  0.6703579425811768
generate_one_block  0.6736202239990234
generate_one_block  0.677825927734375
generate_one_block  0.6603500843048096
generate_one_block  0.671682596206665
generate_one_block  0.6712322235107422
generate_one_block  0.7416248321533203
generate_one_block  0.6729464530944824
generate_one_block  0.6674785614013672
generate_one_block  0.6614611148834229
generate_one_block  0.6756546497344971
generate_one_block  0.6678369045257568
generate_one_block  0.6843712329864502
generate_one_block  0.6809134483337402
generate_one_block  0.6723742485046387
generate_one_block  0.6607277393341064
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03242182731628418
gen group dst list time:  0.09437990188598633
time for parepare:  0.01866745948791504
local_output_nid generation:  0.03454899787902832
local_in_edges_tensor generation:  0.05150604248046875
mini_batch_src_global generation:  0.04377603530883789
r_  generation:  0.5104377269744873
local_output_nid generation:  0.0398867130279541
local_in_edges_tensor generation:  0.04213690757751465
mini_batch_src_global generation:  0.06734156608581543
r_  generation:  0.5046060085296631
local_output_nid generation:  0.040525197982788086
local_in_edges_tensor generation:  0.040097713470458984
mini_batch_src_global generation:  0.05717301368713379
r_  generation:  0.5145289897918701
local_output_nid generation:  0.03973197937011719
local_in_edges_tensor generation:  0.038416147232055664
mini_batch_src_global generation:  0.05672454833984375
r_  generation:  0.505659818649292
local_output_nid generation:  0.03994107246398926
local_in_edges_tensor generation:  0.034093379974365234
mini_batch_src_global generation:  0.05625176429748535
r_  generation:  0.5083467960357666
local_output_nid generation:  0.03998160362243652
local_in_edges_tensor generation:  0.03849649429321289
mini_batch_src_global generation:  0.056993722915649414
r_  generation:  0.5089032649993896
local_output_nid generation:  0.0402989387512207
local_in_edges_tensor generation:  0.04300951957702637
mini_batch_src_global generation:  0.056104421615600586
r_  generation:  0.513643741607666
local_output_nid generation:  0.04027700424194336
local_in_edges_tensor generation:  0.038407325744628906
mini_batch_src_global generation:  0.05689811706542969
r_  generation:  0.5084190368652344
local_output_nid generation:  0.04051923751831055
local_in_edges_tensor generation:  0.038086891174316406
mini_batch_src_global generation:  0.0562596321105957
r_  generation:  0.5239865779876709
local_output_nid generation:  0.04017019271850586
local_in_edges_tensor generation:  0.04290199279785156
mini_batch_src_global generation:  0.05612754821777344
r_  generation:  0.5177750587463379
local_output_nid generation:  0.040598154067993164
local_in_edges_tensor generation:  0.03845667839050293
mini_batch_src_global generation:  0.0566105842590332
r_  generation:  0.5209681987762451
local_output_nid generation:  0.040523529052734375
local_in_edges_tensor generation:  0.04299616813659668
mini_batch_src_global generation:  0.056587934494018555
r_  generation:  0.5179958343505859
local_output_nid generation:  0.04027152061462402
local_in_edges_tensor generation:  0.03840065002441406
mini_batch_src_global generation:  0.056612253189086914
r_  generation:  0.5173511505126953
local_output_nid generation:  0.04029583930969238
local_in_edges_tensor generation:  0.03814983367919922
mini_batch_src_global generation:  0.05657768249511719
r_  generation:  0.5166552066802979
local_output_nid generation:  0.04025459289550781
local_in_edges_tensor generation:  0.042983293533325195
mini_batch_src_global generation:  0.056485652923583984
r_  generation:  0.5267350673675537
local_output_nid generation:  0.04038119316101074
local_in_edges_tensor generation:  0.03841447830200195
mini_batch_src_global generation:  0.056389570236206055
r_  generation:  0.5148708820343018
----------------------check_connections_block total spend ----------------------------- 12.39170527458191
generate_one_block  0.6290719509124756
generate_one_block  0.6372425556182861
generate_one_block  0.6340591907501221
generate_one_block  0.6335787773132324
generate_one_block  0.631056547164917
generate_one_block  0.6317360401153564
generate_one_block  0.636437177658081
generate_one_block  0.6321945190429688
generate_one_block  0.6336879730224609
generate_one_block  0.7028717994689941
generate_one_block  0.6334259510040283
generate_one_block  0.6320273876190186
generate_one_block  0.6325168609619141
generate_one_block  0.6363675594329834
generate_one_block  0.6315531730651855
generate_one_block  0.6324653625488281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 0.2059159278869629  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

connection checking time:  42.67923378944397
block generation total time  36.079644203186035
average batch blocks generation time:  2.254977762699127
block dataloader generation time/epoch 81.8911304473877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 0.13058853149414062  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166289, 128])
torch.Size([163923, 256])
torch.Size([155644, 256])
torch.Size([123327, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.060077667236328  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13056564331054688  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166233, 128])
torch.Size([163849, 256])
torch.Size([155843, 256])
torch.Size([124056, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.065469741821289  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1307353973388672  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166296, 128])
torch.Size([164019, 256])
torch.Size([155765, 256])
torch.Size([123576, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.064427375793457  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13065385818481445  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166256, 128])
torch.Size([163958, 256])
torch.Size([155510, 256])
torch.Size([123651, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.06209659576416  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13069629669189453  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166133, 128])
torch.Size([163778, 256])
torch.Size([155767, 256])
torch.Size([123698, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0626330375671387  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1306767463684082  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166238, 128])
torch.Size([163811, 256])
torch.Size([155549, 256])
torch.Size([123714, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0618200302124023  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13059616088867188  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166267, 128])
torch.Size([163924, 256])
torch.Size([155805, 256])
torch.Size([123867, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0629868507385254  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1307072639465332  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166330, 128])
torch.Size([163966, 256])
torch.Size([155886, 256])
torch.Size([123857, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0659074783325195  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13064956665039062  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166317, 128])
torch.Size([163995, 256])
torch.Size([155783, 256])
torch.Size([123672, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0634632110595703  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1306772232055664  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166341, 128])
torch.Size([163921, 256])
torch.Size([155423, 256])
torch.Size([123264, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0597362518310547  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1305403709411621  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166372, 128])
torch.Size([164108, 256])
torch.Size([155738, 256])
torch.Size([123419, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0612082481384277  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13062477111816406  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166220, 128])
torch.Size([163935, 256])
torch.Size([155637, 256])
torch.Size([123554, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.061375141143799  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13071441650390625  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

torch.Size([166261, 128])
torch.Size([164015, 256])
torch.Size([156043, 256])
torch.Size([124246, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.071596622467041  GigaBytes
Max Memory Allocated: 2.147099494934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1306309700012207  GigaBytes
Max Memory Allocated: 2.1510777473449707  GigaBytes

torch.Size([166321, 128])
torch.Size([164008, 256])
torch.Size([155971, 256])
torch.Size([124262, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0704526901245117  GigaBytes
Max Memory Allocated: 2.1510777473449707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.13074684143066406  GigaBytes
Max Memory Allocated: 2.1510777473449707  GigaBytes

torch.Size([166267, 128])
torch.Size([163914, 256])
torch.Size([155793, 256])
torch.Size([123826, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.0652103424072266  GigaBytes
Max Memory Allocated: 2.1510777473449707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 0.1306004524230957  GigaBytes
Max Memory Allocated: 2.1510777473449707  GigaBytes

torch.Size([166295, 128])
torch.Size([163967, 256])
torch.Size([155595, 256])
torch.Size([123355, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 2.060741424560547  GigaBytes
Max Memory Allocated: 2.1510777473449707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.17289511859416962 |0.03763800859451294 |0.007108733057975769 |9.076297283172607e-05 |0.01440863311290741 |0.0049591064453125 |
----------------------------------------------------------pseudo_mini_loss sum 3.5205020904541016
Total (block generation + training)time/epoch 85.79473543167114
Training time/epoch 3.903308391571045
Training time without block to device /epoch 3.301100254058838
Training time without total dataloading part /epoch 0.350689172744751
load block tensor time/epoch 2.766321897506714
block to device time/epoch 0.602208137512207
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10415983
Number of first layer input nodes during this epoch:  2660436
