Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648484025.3961704
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024361371994018555
range selection method range initialization spend 0.013445138931274414
time for parepare:  0.01776719093322754
local_output_nid generation:  0.0013599395751953125
local_in_edges_tensor generation:  0.003753185272216797
mini_batch_src_global generation:  0.0017659664154052734
r_  generation:  0.01857590675354004
local_output_nid generation:  0.001531839370727539
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.0021810531616210938
r_  generation:  0.01772165298461914
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0008499622344970703
mini_batch_src_global generation:  0.0013692378997802734
r_  generation:  0.018547534942626953
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0013725757598876953
r_  generation:  0.01824498176574707
local_output_nid generation:  0.0015156269073486328
local_in_edges_tensor generation:  0.0008549690246582031
mini_batch_src_global generation:  0.0013513565063476562
r_  generation:  0.01771402359008789
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0008385181427001953
mini_batch_src_global generation:  0.0014801025390625
r_  generation:  0.01883697509765625
local_output_nid generation:  0.0015044212341308594
local_in_edges_tensor generation:  0.0008454322814941406
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.01873326301574707
local_output_nid generation:  0.0014777183532714844
local_in_edges_tensor generation:  0.0008268356323242188
mini_batch_src_global generation:  0.0014033317565917969
r_  generation:  0.019252538681030273
local_output_nid generation:  0.0015375614166259766
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0014851093292236328
r_  generation:  0.019034385681152344
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0014128684997558594
r_  generation:  0.0191800594329834
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008399486541748047
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.018863201141357422
local_output_nid generation:  0.001539468765258789
local_in_edges_tensor generation:  0.0008182525634765625
mini_batch_src_global generation:  0.0015065670013427734
r_  generation:  0.018704652786254883
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.019457340240478516
local_output_nid generation:  0.0014982223510742188
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.001436471939086914
r_  generation:  0.019463777542114258
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.0008432865142822266
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.01896953582763672
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.0008656978607177734
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.018900394439697266
----------------------check_connections_block total spend ----------------------------- 0.4507129192352295
generate_one_block  0.02716541290283203
generate_one_block  0.02748584747314453
generate_one_block  0.030179262161254883
generate_one_block  0.028278350830078125
generate_one_block  0.02678537368774414
generate_one_block  0.028533935546875
generate_one_block  0.02785515785217285
generate_one_block  0.02805805206298828
generate_one_block  0.028645992279052734
generate_one_block  0.02818608283996582
generate_one_block  0.027193069458007812
generate_one_block  0.02717423439025879
generate_one_block  0.028026103973388672
generate_one_block  0.028369426727294922
generate_one_block  0.027653932571411133
generate_one_block  0.027246475219726562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04135298728942871
gen group dst list time:  0.01905965805053711
time for parepare:  0.018981218338012695
local_output_nid generation:  0.006754875183105469
local_in_edges_tensor generation:  0.01576399803161621
mini_batch_src_global generation:  0.020018815994262695
r_  generation:  0.1994025707244873
local_output_nid generation:  0.010189056396484375
local_in_edges_tensor generation:  0.017943859100341797
mini_batch_src_global generation:  0.024944305419921875
r_  generation:  0.20257210731506348
local_output_nid generation:  0.010448455810546875
local_in_edges_tensor generation:  0.016985654830932617
mini_batch_src_global generation:  0.024506092071533203
r_  generation:  0.2199079990386963
local_output_nid generation:  0.010676383972167969
local_in_edges_tensor generation:  0.015368223190307617
mini_batch_src_global generation:  0.025836706161499023
r_  generation:  0.22224879264831543
local_output_nid generation:  0.010508298873901367
local_in_edges_tensor generation:  0.011690855026245117
mini_batch_src_global generation:  0.026057004928588867
r_  generation:  0.2181868553161621
local_output_nid generation:  0.014087915420532227
local_in_edges_tensor generation:  0.014070510864257812
mini_batch_src_global generation:  0.027022361755371094
r_  generation:  0.22211408615112305
local_output_nid generation:  0.010987997055053711
local_in_edges_tensor generation:  0.014568805694580078
mini_batch_src_global generation:  0.030434370040893555
r_  generation:  0.2251574993133545
local_output_nid generation:  0.01120758056640625
local_in_edges_tensor generation:  0.015871524810791016
mini_batch_src_global generation:  0.030597209930419922
r_  generation:  0.22395753860473633
local_output_nid generation:  0.012100934982299805
local_in_edges_tensor generation:  0.0124969482421875
mini_batch_src_global generation:  0.028851985931396484
r_  generation:  0.2363584041595459
local_output_nid generation:  0.013409852981567383
local_in_edges_tensor generation:  0.02745509147644043
mini_batch_src_global generation:  0.03491854667663574
r_  generation:  0.22371244430541992
local_output_nid generation:  0.011382341384887695
local_in_edges_tensor generation:  0.015359878540039062
mini_batch_src_global generation:  0.02684164047241211
r_  generation:  0.21636199951171875
local_output_nid generation:  0.011317253112792969
local_in_edges_tensor generation:  0.01546931266784668
mini_batch_src_global generation:  0.026821136474609375
r_  generation:  0.21372556686401367
local_output_nid generation:  0.011814355850219727
local_in_edges_tensor generation:  0.013559103012084961
mini_batch_src_global generation:  0.029529333114624023
r_  generation:  0.22118902206420898
local_output_nid generation:  0.01181793212890625
local_in_edges_tensor generation:  0.015487432479858398
mini_batch_src_global generation:  0.028174161911010742
r_  generation:  0.22179937362670898
local_output_nid generation:  0.0116424560546875
local_in_edges_tensor generation:  0.011792421340942383
mini_batch_src_global generation:  0.027998685836791992
r_  generation:  0.22060680389404297
local_output_nid generation:  0.011446952819824219
local_in_edges_tensor generation:  0.011437416076660156
mini_batch_src_global generation:  0.027016162872314453
r_  generation:  0.21386361122131348
----------------------check_connections_block total spend ----------------------------- 5.159759759902954
generate_one_block  0.28931117057800293
generate_one_block  0.27576231956481934
generate_one_block  0.28957271575927734
generate_one_block  0.28519678115844727
generate_one_block  0.2944159507751465
generate_one_block  0.2850072383880615
generate_one_block  0.3043549060821533
generate_one_block  0.2974889278411865
generate_one_block  0.2909221649169922
generate_one_block  0.2860555648803711
generate_one_block  0.2748878002166748
generate_one_block  0.28635191917419434
generate_one_block  0.2871592044830322
generate_one_block  0.2919433116912842
generate_one_block  0.2848217487335205
generate_one_block  0.29953742027282715
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06319451332092285
gen group dst list time:  0.06920528411865234
time for parepare:  0.019122600555419922
local_output_nid generation:  0.023372173309326172
local_in_edges_tensor generation:  0.04924511909484863
mini_batch_src_global generation:  0.07244539260864258
r_  generation:  0.5286679267883301
local_output_nid generation:  0.03324413299560547
local_in_edges_tensor generation:  0.054110050201416016
mini_batch_src_global generation:  0.06669020652770996
r_  generation:  0.488170862197876
local_output_nid generation:  0.032224416732788086
local_in_edges_tensor generation:  0.04689598083496094
mini_batch_src_global generation:  0.05760979652404785
r_  generation:  0.5046989917755127
local_output_nid generation:  0.03122568130493164
local_in_edges_tensor generation:  0.04195880889892578
mini_batch_src_global generation:  0.05817914009094238
r_  generation:  0.49366021156311035
local_output_nid generation:  0.031209945678710938
local_in_edges_tensor generation:  0.03066420555114746
mini_batch_src_global generation:  0.05916476249694824
r_  generation:  0.5098388195037842
local_output_nid generation:  0.031703948974609375
local_in_edges_tensor generation:  0.03946208953857422
mini_batch_src_global generation:  0.05849862098693848
r_  generation:  0.5008261203765869
local_output_nid generation:  0.031896352767944336
local_in_edges_tensor generation:  0.05876731872558594
mini_batch_src_global generation:  0.05900239944458008
r_  generation:  0.519127607345581
local_output_nid generation:  0.032556772232055664
local_in_edges_tensor generation:  0.044854164123535156
mini_batch_src_global generation:  0.06562662124633789
r_  generation:  0.5262103080749512
local_output_nid generation:  0.03418779373168945
local_in_edges_tensor generation:  0.035366058349609375
mini_batch_src_global generation:  0.07330989837646484
r_  generation:  0.509591817855835
local_output_nid generation:  0.04582929611206055
local_in_edges_tensor generation:  0.030541658401489258
mini_batch_src_global generation:  0.058416128158569336
r_  generation:  0.5095136165618896
local_output_nid generation:  0.03178119659423828
local_in_edges_tensor generation:  0.033518314361572266
mini_batch_src_global generation:  0.05970263481140137
r_  generation:  0.5121057033538818
local_output_nid generation:  0.032469749450683594
local_in_edges_tensor generation:  0.04520058631896973
mini_batch_src_global generation:  0.05941176414489746
r_  generation:  0.5073349475860596
local_output_nid generation:  0.03419232368469238
local_in_edges_tensor generation:  0.04122805595397949
mini_batch_src_global generation:  0.058211565017700195
r_  generation:  0.5043647289276123
local_output_nid generation:  0.03205990791320801
local_in_edges_tensor generation:  0.034018754959106445
mini_batch_src_global generation:  0.05842328071594238
r_  generation:  0.49683570861816406
local_output_nid generation:  0.03220009803771973
local_in_edges_tensor generation:  0.03778409957885742
mini_batch_src_global generation:  0.05679154396057129
r_  generation:  0.5203213691711426
local_output_nid generation:  0.031659841537475586
local_in_edges_tensor generation:  0.03319287300109863
mini_batch_src_global generation:  0.057309627532958984
r_  generation:  0.4947230815887451
----------------------check_connections_block total spend ----------------------------- 12.04027795791626
generate_one_block  0.6369588375091553
generate_one_block  0.642125129699707
generate_one_block  0.6405086517333984
generate_one_block  0.6341812610626221
generate_one_block  0.6410737037658691
generate_one_block  0.6511514186859131
generate_one_block  0.6910226345062256
generate_one_block  0.629356861114502
generate_one_block  0.630225658416748
generate_one_block  0.6311428546905518
generate_one_block  0.6318156719207764
generate_one_block  0.6184470653533936
generate_one_block  0.6374890804290771
generate_one_block  0.638829231262207
generate_one_block  0.6457173824310303
generate_one_block  0.616351842880249
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041880130767822266
gen group dst list time:  0.0847008228302002
time for parepare:  0.019905567169189453
local_output_nid generation:  0.0323939323425293
local_in_edges_tensor generation:  0.05510997772216797
mini_batch_src_global generation:  0.04526209831237793
r_  generation:  0.4961247444152832
local_output_nid generation:  0.03757882118225098
local_in_edges_tensor generation:  0.03740811347961426
mini_batch_src_global generation:  0.05661416053771973
r_  generation:  0.500542163848877
local_output_nid generation:  0.03657174110412598
local_in_edges_tensor generation:  0.03624677658081055
mini_batch_src_global generation:  0.054553985595703125
r_  generation:  0.5093405246734619
local_output_nid generation:  0.03676199913024902
local_in_edges_tensor generation:  0.04262208938598633
mini_batch_src_global generation:  0.054007768630981445
r_  generation:  0.5093247890472412
local_output_nid generation:  0.03720831871032715
local_in_edges_tensor generation:  0.04028654098510742
mini_batch_src_global generation:  0.054162025451660156
r_  generation:  0.5150325298309326
local_output_nid generation:  0.03765130043029785
local_in_edges_tensor generation:  0.04445457458496094
mini_batch_src_global generation:  0.05387711524963379
r_  generation:  0.5138888359069824
local_output_nid generation:  0.037549495697021484
local_in_edges_tensor generation:  0.03988218307495117
mini_batch_src_global generation:  0.053698062896728516
r_  generation:  0.5234155654907227
local_output_nid generation:  0.03871035575866699
local_in_edges_tensor generation:  0.050951242446899414
mini_batch_src_global generation:  0.05521869659423828
r_  generation:  0.5174264907836914
local_output_nid generation:  0.03793764114379883
local_in_edges_tensor generation:  0.04922127723693848
mini_batch_src_global generation:  0.054778099060058594
r_  generation:  0.524564266204834
local_output_nid generation:  0.037888288497924805
local_in_edges_tensor generation:  0.036599159240722656
mini_batch_src_global generation:  0.056128501892089844
r_  generation:  0.5201859474182129
local_output_nid generation:  0.0378572940826416
local_in_edges_tensor generation:  0.035689353942871094
mini_batch_src_global generation:  0.05589556694030762
r_  generation:  0.5294060707092285
local_output_nid generation:  0.04078483581542969
local_in_edges_tensor generation:  0.04470181465148926
mini_batch_src_global generation:  0.055940866470336914
r_  generation:  0.526057243347168
local_output_nid generation:  0.0378262996673584
local_in_edges_tensor generation:  0.04045295715332031
mini_batch_src_global generation:  0.05510687828063965
r_  generation:  0.5219895839691162
local_output_nid generation:  0.0382237434387207
local_in_edges_tensor generation:  0.049910783767700195
mini_batch_src_global generation:  0.06709742546081543
r_  generation:  0.5235166549682617
local_output_nid generation:  0.03900718688964844
local_in_edges_tensor generation:  0.04750180244445801
mini_batch_src_global generation:  0.05547595024108887
r_  generation:  0.5249843597412109
local_output_nid generation:  0.039075613021850586
local_in_edges_tensor generation:  0.040999650955200195
mini_batch_src_global generation:  0.06719827651977539
r_  generation:  0.5210726261138916
----------------------check_connections_block total spend ----------------------------- 12.405539989471436
generate_one_block  0.6234128475189209
generate_one_block  0.7195539474487305
generate_one_block  0.6345202922821045
generate_one_block  0.6279349327087402
generate_one_block  0.6314780712127686
generate_one_block  0.6510345935821533
generate_one_block  0.6473393440246582
generate_one_block  0.6423952579498291
generate_one_block  0.642362117767334
generate_one_block  0.6266913414001465
generate_one_block  0.6376090049743652
generate_one_block  0.6447827816009521
generate_one_block  0.6378993988037109
generate_one_block  0.6620242595672607
generate_one_block  0.6411614418029785
generate_one_block  0.6255605220794678
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  29.60557770729065
block generation total time  25.134946584701538
average batch blocks generation time:  1.5709341615438461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10796260833740234  GigaBytes
Max Memory Allocated: 0.10796260833740234  GigaBytes

torch.Size([163587, 128])
torch.Size([155395, 256])
torch.Size([123694, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8826904296875 GB
    Memory Allocated: 1.3670463562011719  GigaBytes
Max Memory Allocated: 1.4045696258544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 0.10978555679321289  GigaBytes
Max Memory Allocated: 1.4461274147033691  GigaBytes

torch.Size([163542, 128])
torch.Size([155347, 256])
torch.Size([123109, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3514404296875 GB
    Memory Allocated: 1.361788272857666  GigaBytes
Max Memory Allocated: 1.4461274147033691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3514404296875 GB
    Memory Allocated: 0.11017274856567383  GigaBytes
Max Memory Allocated: 1.4461274147033691  GigaBytes

torch.Size([163572, 128])
torch.Size([155660, 256])
torch.Size([124444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9530029296875 GB
    Memory Allocated: 1.3745193481445312  GigaBytes
Max Memory Allocated: 1.4461274147033691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.10991668701171875  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163515, 128])
torch.Size([155268, 256])
torch.Size([123627, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3683037757873535  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.10987997055053711  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163430, 128])
torch.Size([155233, 256])
torch.Size([122941, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3605761528015137  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.1101078987121582  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163738, 128])
torch.Size([155600, 256])
torch.Size([124194, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3735952377319336  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.11014318466186523  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163643, 128])
torch.Size([155696, 256])
torch.Size([124382, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3738837242126465  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.11003637313842773  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163778, 128])
torch.Size([155743, 256])
torch.Size([123679, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3688158988952637  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.11016321182250977  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163626, 128])
torch.Size([155738, 256])
torch.Size([124230, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.374396800994873  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.11000633239746094  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163653, 128])
torch.Size([155564, 256])
torch.Size([123659, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3669676780700684  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.10988283157348633  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163538, 128])
torch.Size([155549, 256])
torch.Size([123897, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.36598539352417  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.10970783233642578  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163565, 128])
torch.Size([155465, 256])
torch.Size([122629, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3589582443237305  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.1100773811340332  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

torch.Size([163555, 128])
torch.Size([155503, 256])
torch.Size([124435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3746185302734375  GigaBytes
Max Memory Allocated: 1.4542250633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.11005687713623047  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163637, 128])
torch.Size([155664, 256])
torch.Size([124228, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3725171089172363  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.1100153923034668  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163605, 128])
torch.Size([155632, 256])
torch.Size([123952, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.372110366821289  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.10967302322387695  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163530, 128])
torch.Size([155488, 256])
torch.Size([123080, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 1.3613486289978027  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09494082629680634 |0.04078666865825653 |0.05160661041736603 |0.00010155141353607178 |0.02054417133331299 |0.0023729801177978516 |
----------------------------------------------------------pseudo_mini_loss sum 6.417611122131348
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7747605
Number of first layer input nodes during this epoch:  2617514
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.16108322143554688  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.019562244415283203
range selection method range initialization spend 0.011443138122558594
time for parepare:  0.01742076873779297
local_output_nid generation:  0.001413583755493164
local_in_edges_tensor generation:  0.003955841064453125
mini_batch_src_global generation:  0.0018739700317382812
r_  generation:  0.018092632293701172
local_output_nid generation:  0.0015590190887451172
local_in_edges_tensor generation:  0.0009882450103759766
mini_batch_src_global generation:  0.0019855499267578125
r_  generation:  0.01827692985534668
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.018549442291259766
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0008533000946044922
mini_batch_src_global generation:  0.0013790130615234375
r_  generation:  0.018583059310913086
local_output_nid generation:  0.0015337467193603516
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.001415252685546875
r_  generation:  0.018372297286987305
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0013861656188964844
r_  generation:  0.019212007522583008
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.01975107192993164
local_output_nid generation:  0.0015692710876464844
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0013980865478515625
r_  generation:  0.019640207290649414
local_output_nid generation:  0.0015039443969726562
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0014531612396240234
r_  generation:  0.01957416534423828
local_output_nid generation:  0.0015020370483398438
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.0014879703521728516
r_  generation:  0.019788503646850586
local_output_nid generation:  0.0015573501586914062
local_in_edges_tensor generation:  0.0008497238159179688
mini_batch_src_global generation:  0.0015370845794677734
r_  generation:  0.019849061965942383
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0009214878082275391
mini_batch_src_global generation:  0.0013971328735351562
r_  generation:  0.019059181213378906
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.019708871841430664
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0014693737030029297
r_  generation:  0.01944279670715332
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.0015861988067626953
r_  generation:  0.019736766815185547
local_output_nid generation:  0.0015430450439453125
local_in_edges_tensor generation:  0.0008676052093505859
mini_batch_src_global generation:  0.0014743804931640625
r_  generation:  0.01890420913696289
----------------------check_connections_block total spend ----------------------------- 0.4592769145965576
generate_one_block  0.030033111572265625
generate_one_block  0.02812337875366211
generate_one_block  0.027152061462402344
generate_one_block  0.029114961624145508
generate_one_block  0.027218103408813477
generate_one_block  0.02976679801940918
generate_one_block  0.028530120849609375
generate_one_block  0.028014421463012695
generate_one_block  0.02776050567626953
generate_one_block  0.02792501449584961
generate_one_block  0.027767658233642578
generate_one_block  0.02834033966064453
generate_one_block  0.027682781219482422
generate_one_block  0.02770256996154785
generate_one_block  0.0280454158782959
generate_one_block  0.027324438095092773
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03887677192687988
gen group dst list time:  0.016768693923950195
time for parepare:  0.020612478256225586
local_output_nid generation:  0.006586313247680664
local_in_edges_tensor generation:  0.01652836799621582
mini_batch_src_global generation:  0.021311283111572266
r_  generation:  0.2016136646270752
local_output_nid generation:  0.010143518447875977
local_in_edges_tensor generation:  0.017656564712524414
mini_batch_src_global generation:  0.0249936580657959
r_  generation:  0.20822477340698242
local_output_nid generation:  0.010255813598632812
local_in_edges_tensor generation:  0.017551660537719727
mini_batch_src_global generation:  0.02389979362487793
r_  generation:  0.21077513694763184
local_output_nid generation:  0.010746479034423828
local_in_edges_tensor generation:  0.014608383178710938
mini_batch_src_global generation:  0.025018692016601562
r_  generation:  0.21415233612060547
local_output_nid generation:  0.011150360107421875
local_in_edges_tensor generation:  0.016159772872924805
mini_batch_src_global generation:  0.025922298431396484
r_  generation:  0.21492791175842285
local_output_nid generation:  0.01166844367980957
local_in_edges_tensor generation:  0.013016462326049805
mini_batch_src_global generation:  0.028110980987548828
r_  generation:  0.2178668975830078
local_output_nid generation:  0.013618946075439453
local_in_edges_tensor generation:  0.013207435607910156
mini_batch_src_global generation:  0.028671741485595703
r_  generation:  0.22367095947265625
local_output_nid generation:  0.012998104095458984
local_in_edges_tensor generation:  0.013560771942138672
mini_batch_src_global generation:  0.029357194900512695
r_  generation:  0.23989558219909668
local_output_nid generation:  0.014065265655517578
local_in_edges_tensor generation:  0.02045726776123047
mini_batch_src_global generation:  0.03394913673400879
r_  generation:  0.22322702407836914
local_output_nid generation:  0.011817216873168945
local_in_edges_tensor generation:  0.015584468841552734
mini_batch_src_global generation:  0.030828475952148438
r_  generation:  0.2550032138824463
local_output_nid generation:  0.011624574661254883
local_in_edges_tensor generation:  0.012332677841186523
mini_batch_src_global generation:  0.04451584815979004
r_  generation:  0.23635005950927734
local_output_nid generation:  0.011396169662475586
local_in_edges_tensor generation:  0.013172626495361328
mini_batch_src_global generation:  0.026985883712768555
r_  generation:  0.22618389129638672
local_output_nid generation:  0.01245260238647461
local_in_edges_tensor generation:  0.01556086540222168
mini_batch_src_global generation:  0.02899646759033203
r_  generation:  0.24095916748046875
local_output_nid generation:  0.013576745986938477
local_in_edges_tensor generation:  0.022571563720703125
mini_batch_src_global generation:  0.029092073440551758
r_  generation:  0.21944379806518555
local_output_nid generation:  0.011855363845825195
local_in_edges_tensor generation:  0.01838207244873047
mini_batch_src_global generation:  0.02740645408630371
r_  generation:  0.22478318214416504
local_output_nid generation:  0.01143026351928711
local_in_edges_tensor generation:  0.012028217315673828
mini_batch_src_global generation:  0.027075767517089844
r_  generation:  0.2279520034790039
----------------------check_connections_block total spend ----------------------------- 5.294002294540405
generate_one_block  0.28969359397888184
generate_one_block  0.2870662212371826
generate_one_block  0.27805328369140625
generate_one_block  0.2818922996520996
generate_one_block  0.29201722145080566
generate_one_block  0.28237199783325195
generate_one_block  0.31758880615234375
generate_one_block  0.294079065322876
generate_one_block  0.28213071823120117
generate_one_block  0.28606653213500977
generate_one_block  0.28081417083740234
generate_one_block  0.2721738815307617
generate_one_block  0.29327893257141113
generate_one_block  0.2811927795410156
generate_one_block  0.28583765029907227
generate_one_block  0.26794862747192383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.053583383560180664
gen group dst list time:  0.06016087532043457
time for parepare:  0.017329931259155273
local_output_nid generation:  0.03241896629333496
local_in_edges_tensor generation:  0.05733656883239746
mini_batch_src_global generation:  0.049195051193237305
r_  generation:  0.4754302501678467
local_output_nid generation:  0.030105113983154297
local_in_edges_tensor generation:  0.04800724983215332
mini_batch_src_global generation:  0.06110429763793945
r_  generation:  0.4884219169616699
local_output_nid generation:  0.03026127815246582
local_in_edges_tensor generation:  0.045526742935180664
mini_batch_src_global generation:  0.05571770668029785
r_  generation:  0.5036280155181885
local_output_nid generation:  0.03189897537231445
local_in_edges_tensor generation:  0.04548192024230957
mini_batch_src_global generation:  0.060611724853515625
r_  generation:  0.4929654598236084
local_output_nid generation:  0.03310823440551758
local_in_edges_tensor generation:  0.09915351867675781
mini_batch_src_global generation:  0.0585017204284668
r_  generation:  0.4926433563232422
local_output_nid generation:  0.03029942512512207
local_in_edges_tensor generation:  0.04431343078613281
mini_batch_src_global generation:  0.05795764923095703
r_  generation:  0.4937472343444824
local_output_nid generation:  0.03076910972595215
local_in_edges_tensor generation:  0.035756587982177734
mini_batch_src_global generation:  0.06072354316711426
r_  generation:  0.49736666679382324
local_output_nid generation:  0.03078317642211914
local_in_edges_tensor generation:  0.035676002502441406
mini_batch_src_global generation:  0.062357425689697266
r_  generation:  0.5066907405853271
local_output_nid generation:  0.030843257904052734
local_in_edges_tensor generation:  0.040003299713134766
mini_batch_src_global generation:  0.05778837203979492
r_  generation:  0.49956512451171875
local_output_nid generation:  0.031349897384643555
local_in_edges_tensor generation:  0.03570127487182617
mini_batch_src_global generation:  0.06217217445373535
r_  generation:  0.500917911529541
local_output_nid generation:  0.030751705169677734
local_in_edges_tensor generation:  0.03210616111755371
mini_batch_src_global generation:  0.05804276466369629
r_  generation:  0.5017788410186768
local_output_nid generation:  0.030905961990356445
local_in_edges_tensor generation:  0.04103851318359375
mini_batch_src_global generation:  0.058207035064697266
r_  generation:  0.4951620101928711
local_output_nid generation:  0.031023740768432617
local_in_edges_tensor generation:  0.04021763801574707
mini_batch_src_global generation:  0.06075167655944824
r_  generation:  0.5041136741638184
local_output_nid generation:  0.030927658081054688
local_in_edges_tensor generation:  0.031760454177856445
mini_batch_src_global generation:  0.06965970993041992
r_  generation:  0.49471139907836914
local_output_nid generation:  0.031299591064453125
local_in_edges_tensor generation:  0.03611135482788086
mini_batch_src_global generation:  0.05767631530761719
r_  generation:  0.5109291076660156
local_output_nid generation:  0.03099203109741211
local_in_edges_tensor generation:  0.04277634620666504
mini_batch_src_global generation:  0.05875039100646973
r_  generation:  0.49974727630615234
----------------------check_connections_block total spend ----------------------------- 11.83491563796997
generate_one_block  0.6584832668304443
generate_one_block  0.6650464534759521
generate_one_block  0.6307101249694824
generate_one_block  0.619849681854248
generate_one_block  0.6279420852661133
generate_one_block  0.6268734931945801
generate_one_block  0.642542839050293
generate_one_block  0.647083044052124
generate_one_block  0.676764965057373
generate_one_block  0.6378777027130127
generate_one_block  0.6254808902740479
generate_one_block  0.6242620944976807
generate_one_block  0.62662672996521
generate_one_block  0.6254274845123291
generate_one_block  0.6443924903869629
generate_one_block  0.6209049224853516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.058168649673461914
gen group dst list time:  0.09731173515319824
time for parepare:  0.020020723342895508
local_output_nid generation:  0.03166365623474121
local_in_edges_tensor generation:  0.048828840255737305
mini_batch_src_global generation:  0.04495739936828613
r_  generation:  0.4948892593383789
local_output_nid generation:  0.03902840614318848
local_in_edges_tensor generation:  0.04661726951599121
mini_batch_src_global generation:  0.056318044662475586
r_  generation:  0.49840235710144043
local_output_nid generation:  0.03930544853210449
local_in_edges_tensor generation:  0.03922772407531738
mini_batch_src_global generation:  0.054296255111694336
r_  generation:  0.5145618915557861
local_output_nid generation:  0.03764510154724121
local_in_edges_tensor generation:  0.03943014144897461
mini_batch_src_global generation:  0.05384945869445801
r_  generation:  0.5057730674743652
local_output_nid generation:  0.03699231147766113
local_in_edges_tensor generation:  0.04386115074157715
mini_batch_src_global generation:  0.05347609519958496
r_  generation:  0.5125102996826172
local_output_nid generation:  0.03712201118469238
local_in_edges_tensor generation:  0.035956382751464844
mini_batch_src_global generation:  0.05411791801452637
r_  generation:  0.5116772651672363
local_output_nid generation:  0.03722095489501953
local_in_edges_tensor generation:  0.04383516311645508
mini_batch_src_global generation:  0.053795814514160156
r_  generation:  0.5201542377471924
local_output_nid generation:  0.037497520446777344
local_in_edges_tensor generation:  0.044455766677856445
mini_batch_src_global generation:  0.05528616905212402
r_  generation:  0.5178351402282715
local_output_nid generation:  0.03755021095275879
local_in_edges_tensor generation:  0.035445451736450195
mini_batch_src_global generation:  0.05547738075256348
r_  generation:  0.5237143039703369
local_output_nid generation:  0.03762936592102051
local_in_edges_tensor generation:  0.04498291015625
mini_batch_src_global generation:  0.05543041229248047
r_  generation:  0.5181715488433838
local_output_nid generation:  0.03746604919433594
local_in_edges_tensor generation:  0.03999066352844238
mini_batch_src_global generation:  0.056136131286621094
r_  generation:  0.5238971710205078
local_output_nid generation:  0.037225961685180664
local_in_edges_tensor generation:  0.0356297492980957
mini_batch_src_global generation:  0.05610918998718262
r_  generation:  0.5218443870544434
local_output_nid generation:  0.03741025924682617
local_in_edges_tensor generation:  0.03991961479187012
mini_batch_src_global generation:  0.05915689468383789
r_  generation:  0.5242929458618164
local_output_nid generation:  0.03829216957092285
local_in_edges_tensor generation:  0.05163264274597168
mini_batch_src_global generation:  0.055129051208496094
r_  generation:  0.5203664302825928
local_output_nid generation:  0.037160634994506836
local_in_edges_tensor generation:  0.040231943130493164
mini_batch_src_global generation:  0.05893087387084961
r_  generation:  0.5229580402374268
local_output_nid generation:  0.03778886795043945
local_in_edges_tensor generation:  0.035639286041259766
mini_batch_src_global generation:  0.05568194389343262
r_  generation:  0.5203151702880859
----------------------check_connections_block total spend ----------------------------- 12.322813034057617
generate_one_block  0.620215654373169
generate_one_block  0.6393215656280518
generate_one_block  0.6342902183532715
generate_one_block  0.6413373947143555
generate_one_block  0.6361627578735352
generate_one_block  0.6304171085357666
generate_one_block  0.7237725257873535
generate_one_block  0.6395564079284668
generate_one_block  0.6443207263946533
generate_one_block  0.634943962097168
generate_one_block  0.6304092407226562
generate_one_block  0.6234540939331055
generate_one_block  0.6395471096038818
generate_one_block  0.6303303241729736
generate_one_block  0.6492969989776611
generate_one_block  0.6240115165710449
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.16108322143554688  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

connection checking time:  29.451730966567993
block generation total time  25.013861656188965
average batch blocks generation time:  1.5633663535118103
block dataloader generation time/epoch 57.002875328063965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1053466796875 GB
    Memory Allocated: 0.11266326904296875  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163783, 128])
torch.Size([155908, 256])
torch.Size([124208, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1072998046875 GB
    Memory Allocated: 1.37532377243042  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11268758773803711  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163850, 128])
torch.Size([155818, 256])
torch.Size([124387, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3748860359191895  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11254549026489258  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163618, 128])
torch.Size([155424, 256])
torch.Size([123206, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3670201301574707  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11247968673706055  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163656, 128])
torch.Size([155405, 256])
torch.Size([123148, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.367088794708252  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11252069473266602  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163779, 128])
torch.Size([155756, 256])
torch.Size([123203, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3655200004577637  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.1124429702758789  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163493, 128])
torch.Size([155243, 256])
torch.Size([123299, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.36891508102417  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11275625228881836  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163604, 128])
torch.Size([155564, 256])
torch.Size([123736, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3727350234985352  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.1127171516418457  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

torch.Size([163532, 128])
torch.Size([155507, 256])
torch.Size([124463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.380542278289795  GigaBytes
Max Memory Allocated: 1.4542717933654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11275911331176758  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163657, 128])
torch.Size([155679, 256])
torch.Size([124051, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3752689361572266  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11263608932495117  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163492, 128])
torch.Size([155459, 256])
torch.Size([124222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3765525817871094  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11261987686157227  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163575, 128])
torch.Size([155428, 256])
torch.Size([123509, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3693137168884277  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11228752136230469  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163457, 128])
torch.Size([155213, 256])
torch.Size([122975, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.363358974456787  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11265134811401367  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163717, 128])
torch.Size([155730, 256])
torch.Size([123664, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3702654838562012  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11248445510864258  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163624, 128])
torch.Size([155471, 256])
torch.Size([123404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3677220344543457  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11275339126586914  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163772, 128])
torch.Size([155912, 256])
torch.Size([124645, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.380765438079834  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 0.11227941513061523  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

torch.Size([163566, 128])
torch.Size([155351, 256])
torch.Size([122854, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1092529296875 GB
    Memory Allocated: 1.3621463775634766  GigaBytes
Max Memory Allocated: 1.461592197418213  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09822787344455719 |0.022641628980636597 |0.007157027721405029 |9.527802467346191e-05 |0.012553855776786804 |0.0018086433410644531 |
----------------------------------------------------------pseudo_mini_loss sum 3.2683398723602295
Total (block generation + training)time/epoch 59.37456488609314
Training time/epoch 2.3714301586151123
Training time without block to device /epoch 2.0091640949249268
Training time without total dataloading part /epoch 0.3187072277069092
load block tensor time/epoch 1.571645975112915
block to device time/epoch 0.36226606369018555
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7747906
Number of first layer input nodes during this epoch:  2618175
