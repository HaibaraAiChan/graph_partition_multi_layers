Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648452463.91806
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027203798294067383
range selection method range initialization spend 0.012984752655029297
time for parepare:  0.017976045608520508
local_output_nid generation:  0.002641439437866211
local_in_edges_tensor generation:  0.0048675537109375
mini_batch_src_global generation:  0.0036211013793945312
r_  generation:  0.04053807258605957
local_output_nid generation:  0.0029745101928710938
local_in_edges_tensor generation:  0.0016655921936035156
mini_batch_src_global generation:  0.004354953765869141
r_  generation:  0.04170370101928711
local_output_nid generation:  0.0031249523162841797
local_in_edges_tensor generation:  0.0017671585083007812
mini_batch_src_global generation:  0.003086090087890625
r_  generation:  0.043245792388916016
local_output_nid generation:  0.003162860870361328
local_in_edges_tensor generation:  0.0017876625061035156
mini_batch_src_global generation:  0.003151416778564453
r_  generation:  0.044376373291015625
local_output_nid generation:  0.0031435489654541016
local_in_edges_tensor generation:  0.0017728805541992188
mini_batch_src_global generation:  0.0032155513763427734
r_  generation:  0.04469609260559082
local_output_nid generation:  0.003145933151245117
local_in_edges_tensor generation:  0.0017151832580566406
mini_batch_src_global generation:  0.0035452842712402344
r_  generation:  0.04616832733154297
local_output_nid generation:  0.0031359195709228516
local_in_edges_tensor generation:  0.001722574234008789
mini_batch_src_global generation:  0.0036063194274902344
r_  generation:  0.04703974723815918
local_output_nid generation:  0.003147602081298828
local_in_edges_tensor generation:  0.0017549991607666016
mini_batch_src_global generation:  0.0037102699279785156
r_  generation:  0.046652793884277344
----------------------check_connections_block total spend ----------------------------- 0.5161068439483643
generate_one_block  0.06154489517211914
generate_one_block  0.06135439872741699
generate_one_block  0.06185770034790039
generate_one_block  0.06129908561706543
generate_one_block  0.06347227096557617
generate_one_block  0.06194949150085449
generate_one_block  0.062026023864746094
generate_one_block  0.0628058910369873
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0457918643951416
gen group dst list time:  0.016119003295898438
time for parepare:  0.019133329391479492
local_output_nid generation:  0.011130571365356445
local_in_edges_tensor generation:  0.03387594223022461
mini_batch_src_global generation:  0.03475499153137207
r_  generation:  0.358870267868042
local_output_nid generation:  0.01657390594482422
local_in_edges_tensor generation:  0.032683610916137695
mini_batch_src_global generation:  0.04456353187561035
r_  generation:  0.36126255989074707
local_output_nid generation:  0.017198562622070312
local_in_edges_tensor generation:  0.023865222930908203
mini_batch_src_global generation:  0.04669070243835449
r_  generation:  0.37319040298461914
local_output_nid generation:  0.01755499839782715
local_in_edges_tensor generation:  0.028137922286987305
mini_batch_src_global generation:  0.045668601989746094
r_  generation:  0.3748478889465332
local_output_nid generation:  0.017484664916992188
local_in_edges_tensor generation:  0.020498991012573242
mini_batch_src_global generation:  0.04617619514465332
r_  generation:  0.37577128410339355
local_output_nid generation:  0.01778864860534668
local_in_edges_tensor generation:  0.02755260467529297
mini_batch_src_global generation:  0.046248674392700195
r_  generation:  0.38296961784362793
local_output_nid generation:  0.01786208152770996
local_in_edges_tensor generation:  0.027871370315551758
mini_batch_src_global generation:  0.04676413536071777
r_  generation:  0.3852510452270508
local_output_nid generation:  0.017987966537475586
local_in_edges_tensor generation:  0.024213314056396484
mini_batch_src_global generation:  0.048995018005371094
r_  generation:  0.38179969787597656
----------------------check_connections_block total spend ----------------------------- 4.356324672698975
generate_one_block  0.4989442825317383
generate_one_block  0.48970675468444824
generate_one_block  0.5026872158050537
generate_one_block  0.5003345012664795
generate_one_block  0.48398733139038086
generate_one_block  0.5213568210601807
generate_one_block  0.4960505962371826
generate_one_block  0.4974794387817383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03253436088562012
gen group dst list time:  0.03670549392700195
time for parepare:  0.019246339797973633
local_output_nid generation:  0.025362014770507812
local_in_edges_tensor generation:  0.041345834732055664
mini_batch_src_global generation:  0.0475001335144043
r_  generation:  0.479158878326416
local_output_nid generation:  0.03287243843078613
local_in_edges_tensor generation:  0.050988197326660156
mini_batch_src_global generation:  0.05489706993103027
r_  generation:  0.48984789848327637
local_output_nid generation:  0.03330230712890625
local_in_edges_tensor generation:  0.04359102249145508
mini_batch_src_global generation:  0.05413675308227539
r_  generation:  0.49131059646606445
local_output_nid generation:  0.03394722938537598
local_in_edges_tensor generation:  0.03862452507019043
mini_batch_src_global generation:  0.056685686111450195
r_  generation:  0.49648308753967285
local_output_nid generation:  0.03448128700256348
local_in_edges_tensor generation:  0.041802406311035156
mini_batch_src_global generation:  0.05357193946838379
r_  generation:  0.49205541610717773
local_output_nid generation:  0.03419613838195801
local_in_edges_tensor generation:  0.03469514846801758
mini_batch_src_global generation:  0.054206132888793945
r_  generation:  0.49997639656066895
local_output_nid generation:  0.03388023376464844
local_in_edges_tensor generation:  0.03380751609802246
mini_batch_src_global generation:  0.053708553314208984
r_  generation:  0.500382661819458
local_output_nid generation:  0.037537336349487305
local_in_edges_tensor generation:  0.03520393371582031
mini_batch_src_global generation:  0.0551142692565918
r_  generation:  0.5013694763183594
----------------------check_connections_block total spend ----------------------------- 5.869149446487427
generate_one_block  0.6174895763397217
generate_one_block  0.631244421005249
generate_one_block  0.6216070652008057
generate_one_block  0.6261284351348877
generate_one_block  0.6290879249572754
generate_one_block  0.6194593906402588
generate_one_block  0.6402716636657715
generate_one_block  0.6231052875518799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  10.225474119186401
block generation total time  8.998940706253052
average batch blocks generation time:  1.1248675882816315
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.1004018783569336  GigaBytes
Max Memory Allocated: 0.1004018783569336  GigaBytes

torch.Size([162092, 128])
torch.Size([145813, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4783935546875 GB
    Memory Allocated: 0.9482917785644531  GigaBytes
Max Memory Allocated: 1.0141592025756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.10249567031860352  GigaBytes
Max Memory Allocated: 1.0886492729187012  GigaBytes

torch.Size([162303, 128])
torch.Size([146273, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.9489302635192871  GigaBytes
Max Memory Allocated: 1.0886492729187012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1041860580444336  GigaBytes
Max Memory Allocated: 1.0886492729187012  GigaBytes

torch.Size([162252, 128])
torch.Size([146050, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.951624870300293  GigaBytes
Max Memory Allocated: 1.0886492729187012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1025090217590332  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

torch.Size([162220, 128])
torch.Size([146045, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9492473602294922  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10332489013671875  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

torch.Size([162344, 128])
torch.Size([146184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9498343467712402  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10315656661987305  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

torch.Size([161913, 128])
torch.Size([145726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9485206604003906  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10334110260009766  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

torch.Size([162001, 128])
torch.Size([145681, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9486422538757324  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10305547714233398  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

torch.Size([162121, 128])
torch.Size([145873, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.9486989974975586  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07254859805107117 |0.049405038356781006 |0.09924057126045227 |9.828805923461914e-05 |0.01309293508529663 |0.0018031597137451172 |
----------------------------------------------------------pseudo_mini_loss sum 6.236033916473389
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3054121
Number of first layer input nodes during this epoch:  1297246
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1376190185546875  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03166651725769043
range selection method range initialization spend 0.011170148849487305
time for parepare:  0.01712203025817871
local_output_nid generation:  0.002727031707763672
local_in_edges_tensor generation:  0.004835367202758789
mini_batch_src_global generation:  0.003793954849243164
r_  generation:  0.04512166976928711
local_output_nid generation:  0.0033965110778808594
local_in_edges_tensor generation:  0.002823352813720703
mini_batch_src_global generation:  0.0069048404693603516
r_  generation:  0.045142412185668945
local_output_nid generation:  0.0031614303588867188
local_in_edges_tensor generation:  0.0022423267364501953
mini_batch_src_global generation:  0.0032782554626464844
r_  generation:  0.04909014701843262
local_output_nid generation:  0.0034682750701904297
local_in_edges_tensor generation:  0.0021958351135253906
mini_batch_src_global generation:  0.0032477378845214844
r_  generation:  0.04612302780151367
local_output_nid generation:  0.00341033935546875
local_in_edges_tensor generation:  0.002111196517944336
mini_batch_src_global generation:  0.003639698028564453
r_  generation:  0.047595977783203125
local_output_nid generation:  0.003522157669067383
local_in_edges_tensor generation:  0.0020415782928466797
mini_batch_src_global generation:  0.0036907196044921875
r_  generation:  0.049551963806152344
local_output_nid generation:  0.0035789012908935547
local_in_edges_tensor generation:  0.0024030208587646484
mini_batch_src_global generation:  0.0037641525268554688
r_  generation:  0.05715632438659668
local_output_nid generation:  0.0034542083740234375
local_in_edges_tensor generation:  0.002077341079711914
mini_batch_src_global generation:  0.003793954849243164
r_  generation:  0.04657435417175293
----------------------check_connections_block total spend ----------------------------- 0.5849990844726562
generate_one_block  0.060779571533203125
generate_one_block  0.062065839767456055
generate_one_block  0.06125617027282715
generate_one_block  0.06142115592956543
generate_one_block  0.062316179275512695
generate_one_block  0.06218361854553223
generate_one_block  0.06583666801452637
generate_one_block  0.06264615058898926
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05680346488952637
gen group dst list time:  0.016370296478271484
time for parepare:  0.018750905990600586
local_output_nid generation:  0.011090755462646484
local_in_edges_tensor generation:  0.05286574363708496
mini_batch_src_global generation:  0.03974461555480957
r_  generation:  0.3616354465484619
local_output_nid generation:  0.017364025115966797
local_in_edges_tensor generation:  0.03366231918334961
mini_batch_src_global generation:  0.04506850242614746
r_  generation:  0.36760640144348145
local_output_nid generation:  0.017042160034179688
local_in_edges_tensor generation:  0.02359771728515625
mini_batch_src_global generation:  0.04479622840881348
r_  generation:  0.3727881908416748
local_output_nid generation:  0.017426490783691406
local_in_edges_tensor generation:  0.02760457992553711
mini_batch_src_global generation:  0.04540610313415527
r_  generation:  0.3733377456665039
local_output_nid generation:  0.017758607864379883
local_in_edges_tensor generation:  0.02726006507873535
mini_batch_src_global generation:  0.04638862609863281
r_  generation:  0.3755815029144287
local_output_nid generation:  0.01761150360107422
local_in_edges_tensor generation:  0.020994186401367188
mini_batch_src_global generation:  0.04751014709472656
r_  generation:  0.37843918800354004
local_output_nid generation:  0.017930269241333008
local_in_edges_tensor generation:  0.027961015701293945
mini_batch_src_global generation:  0.04642081260681152
r_  generation:  0.38352298736572266
local_output_nid generation:  0.017925262451171875
local_in_edges_tensor generation:  0.028300046920776367
mini_batch_src_global generation:  0.047007083892822266
r_  generation:  0.38501477241516113
----------------------check_connections_block total spend ----------------------------- 4.389879941940308
generate_one_block  0.547065258026123
generate_one_block  0.5043573379516602
generate_one_block  0.5126383304595947
generate_one_block  0.49837183952331543
generate_one_block  0.5143067836761475
generate_one_block  0.5229997634887695
generate_one_block  0.5299992561340332
generate_one_block  0.5399339199066162
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04483318328857422
gen group dst list time:  0.038908958435058594
time for parepare:  0.019763946533203125
local_output_nid generation:  0.025784730911254883
local_in_edges_tensor generation:  0.06398677825927734
mini_batch_src_global generation:  0.04869842529296875
r_  generation:  0.485964298248291
local_output_nid generation:  0.03378868103027344
local_in_edges_tensor generation:  0.053055763244628906
mini_batch_src_global generation:  0.06558060646057129
r_  generation:  0.4977700710296631
local_output_nid generation:  0.03593087196350098
local_in_edges_tensor generation:  0.040149688720703125
mini_batch_src_global generation:  0.055433034896850586
r_  generation:  0.4921379089355469
local_output_nid generation:  0.03486156463623047
local_in_edges_tensor generation:  0.03544330596923828
mini_batch_src_global generation:  0.05341482162475586
r_  generation:  0.5014631748199463
local_output_nid generation:  0.03537249565124512
local_in_edges_tensor generation:  0.04011726379394531
mini_batch_src_global generation:  0.05739617347717285
r_  generation:  0.5121405124664307
local_output_nid generation:  0.03630352020263672
local_in_edges_tensor generation:  0.03122997283935547
mini_batch_src_global generation:  0.0573277473449707
r_  generation:  0.5139892101287842
local_output_nid generation:  0.03570842742919922
local_in_edges_tensor generation:  0.040085554122924805
mini_batch_src_global generation:  0.059491872787475586
r_  generation:  0.5194299221038818
local_output_nid generation:  0.03795194625854492
local_in_edges_tensor generation:  0.04564523696899414
mini_batch_src_global generation:  0.06873679161071777
r_  generation:  0.5133190155029297
----------------------check_connections_block total spend ----------------------------- 6.067919731140137
generate_one_block  0.6619129180908203
generate_one_block  0.6377608776092529
generate_one_block  0.6273343563079834
generate_one_block  0.6384017467498779
generate_one_block  0.6381244659423828
generate_one_block  0.6158087253570557
generate_one_block  0.640373706817627
generate_one_block  0.6305677890777588
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.1376190185546875  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

connection checking time:  10.457799673080444
block generation total time  9.259957075119019
average batch blocks generation time:  1.1574946343898773
block dataloader generation time/epoch 21.85387420654297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10523700714111328  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

torch.Size([162218, 128])
torch.Size([145947, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9526724815368652  GigaBytes
Max Memory Allocated: 1.0926990509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10370683670043945  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

torch.Size([162077, 128])
torch.Size([145821, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9499154090881348  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10492801666259766  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

torch.Size([162203, 128])
torch.Size([145943, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9508056640625  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10470008850097656  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

torch.Size([162152, 128])
torch.Size([145673, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9451103210449219  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10486984252929688  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

torch.Size([162396, 128])
torch.Size([146413, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9535832405090332  GigaBytes
Max Memory Allocated: 1.0936017036437988  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.10349416732788086  GigaBytes
Max Memory Allocated: 1.0942845344543457  GigaBytes

torch.Size([161908, 128])
torch.Size([145532, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9469499588012695  GigaBytes
Max Memory Allocated: 1.0942845344543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1051340103149414  GigaBytes
Max Memory Allocated: 1.0942845344543457  GigaBytes

torch.Size([162236, 128])
torch.Size([146134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.9532508850097656  GigaBytes
Max Memory Allocated: 1.0942845344543457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1037135124206543  GigaBytes
Max Memory Allocated: 1.0942845344543457  GigaBytes

torch.Size([162067, 128])
torch.Size([145870, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.949976921081543  GigaBytes
Max Memory Allocated: 1.0942845344543457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08727583289146423 |0.021290183067321777 |0.003909975290298462 |9.891390800476074e-05 |0.008538663387298584 |0.0013785362243652344 |
----------------------------------------------------------pseudo_mini_loss sum 3.2453372478485107
Total (block generation + training)time/epoch 22.905888080596924
Training time/epoch 1.0517191886901855
Training time without block to device /epoch 0.8813977241516113
Training time without total dataloading part /epoch 0.10175895690917969
load block tensor time/epoch 0.6982066631317139
block to device time/epoch 0.17032146453857422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3053891
Number of first layer input nodes during this epoch:  1297257
