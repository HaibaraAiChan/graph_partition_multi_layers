Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648447926.7300644
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027552366256713867
range selection method range initialization spend 0.013522148132324219
time for parepare:  0.01847362518310547
local_output_nid generation:  0.0054094791412353516
local_in_edges_tensor generation:  0.006329774856567383
mini_batch_src_global generation:  0.007268190383911133
r_  generation:  0.08991098403930664
local_output_nid generation:  0.006142854690551758
local_in_edges_tensor generation:  0.0031652450561523438
mini_batch_src_global generation:  0.009658336639404297
r_  generation:  0.09874105453491211
local_output_nid generation:  0.006119728088378906
local_in_edges_tensor generation:  0.0031507015228271484
mini_batch_src_global generation:  0.007721662521362305
r_  generation:  0.10132122039794922
local_output_nid generation:  0.006097555160522461
local_in_edges_tensor generation:  0.0032203197479248047
mini_batch_src_global generation:  0.008068561553955078
r_  generation:  0.10250377655029297
----------------------check_connections_block total spend ----------------------------- 0.5616493225097656
generate_one_block  0.11409115791320801
generate_one_block  0.11803960800170898
generate_one_block  0.11862754821777344
generate_one_block  0.1171882152557373
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041414499282836914
gen group dst list time:  0.011884689331054688
time for parepare:  0.018990278244018555
local_output_nid generation:  0.014667272567749023
local_in_edges_tensor generation:  0.038156986236572266
mini_batch_src_global generation:  0.04337430000305176
r_  generation:  0.4386427402496338
local_output_nid generation:  0.022696256637573242
local_in_edges_tensor generation:  0.04046773910522461
mini_batch_src_global generation:  0.04964566230773926
r_  generation:  0.4415125846862793
local_output_nid generation:  0.023572444915771484
local_in_edges_tensor generation:  0.03415822982788086
mini_batch_src_global generation:  0.049735069274902344
r_  generation:  0.446216344833374
local_output_nid generation:  0.023833751678466797
local_in_edges_tensor generation:  0.029851675033569336
mini_batch_src_global generation:  0.05110740661621094
r_  generation:  0.4482846260070801
----------------------check_connections_block total spend ----------------------------- 2.583416700363159
generate_one_block  0.5856776237487793
generate_one_block  0.5681672096252441
generate_one_block  0.5723843574523926
generate_one_block  0.5706663131713867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03270220756530762
gen group dst list time:  0.021085023880004883
time for parepare:  0.019066572189331055
local_output_nid generation:  0.023890256881713867
local_in_edges_tensor generation:  0.041619300842285156
mini_batch_src_global generation:  0.04898810386657715
r_  generation:  0.4969775676727295
local_output_nid generation:  0.03426003456115723
local_in_edges_tensor generation:  0.05140280723571777
mini_batch_src_global generation:  0.058576107025146484
r_  generation:  0.4996664524078369
local_output_nid generation:  0.03515982627868652
local_in_edges_tensor generation:  0.03863978385925293
mini_batch_src_global generation:  0.05432701110839844
r_  generation:  0.5042672157287598
local_output_nid generation:  0.034763336181640625
local_in_edges_tensor generation:  0.04226088523864746
mini_batch_src_global generation:  0.05413198471069336
r_  generation:  0.5113279819488525
----------------------check_connections_block total spend ----------------------------- 2.9784085750579834
generate_one_block  0.6370716094970703
generate_one_block  0.6407427787780762
generate_one_block  0.6481034755706787
generate_one_block  0.6524035930633545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  5.561825275421143
block generation total time  4.875216960906982
average batch blocks generation time:  1.2188042402267456
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10227441787719727  GigaBytes
Max Memory Allocated: 0.10227441787719727  GigaBytes

torch.Size([164635, 128])
torch.Size([155683, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.3643813133239746  GigaBytes
Max Memory Allocated: 0.3839125633239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1065206527709961  GigaBytes
Max Memory Allocated: 0.4142122268676758  GigaBytes

torch.Size([164462, 128])
torch.Size([155592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3646278381347656  GigaBytes
Max Memory Allocated: 0.4142122268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.10606241226196289  GigaBytes
Max Memory Allocated: 0.4146404266357422  GigaBytes

torch.Size([164568, 128])
torch.Size([155783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.36521196365356445  GigaBytes
Max Memory Allocated: 0.4146404266357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.10618734359741211  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

torch.Size([164567, 128])
torch.Size([155574, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3641343116760254  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05204296112060547 |0.10030555725097656 |0.1878056526184082 |0.00011336803436279297 |0.011953115463256836 |0.0020148754119873047 |
----------------------------------------------------------pseudo_mini_loss sum 5.283138275146484
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1710329
Number of first layer input nodes during this epoch:  658232
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02629566192626953
range selection method range initialization spend 0.012246847152709961
time for parepare:  0.017357587814331055
local_output_nid generation:  0.005289316177368164
local_in_edges_tensor generation:  0.00840902328491211
mini_batch_src_global generation:  0.007437229156494141
r_  generation:  0.08900070190429688
local_output_nid generation:  0.005980968475341797
local_in_edges_tensor generation:  0.0038628578186035156
mini_batch_src_global generation:  0.009723663330078125
r_  generation:  0.09688115119934082
local_output_nid generation:  0.0060672760009765625
local_in_edges_tensor generation:  0.0032122135162353516
mini_batch_src_global generation:  0.0077207088470458984
r_  generation:  0.10199451446533203
local_output_nid generation:  0.00607752799987793
local_in_edges_tensor generation:  0.0031871795654296875
mini_batch_src_global generation:  0.008182287216186523
r_  generation:  0.1025090217590332
----------------------check_connections_block total spend ----------------------------- 0.5614173412322998
generate_one_block  0.11351513862609863
generate_one_block  0.11449170112609863
generate_one_block  0.11641383171081543
generate_one_block  0.11666440963745117
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03199338912963867
gen group dst list time:  0.011634111404418945
time for parepare:  0.018988370895385742
local_output_nid generation:  0.015129566192626953
local_in_edges_tensor generation:  0.03934645652770996
mini_batch_src_global generation:  0.0398561954498291
r_  generation:  0.42304396629333496
local_output_nid generation:  0.02271127700805664
local_in_edges_tensor generation:  0.0387725830078125
mini_batch_src_global generation:  0.07312488555908203
r_  generation:  0.437056303024292
local_output_nid generation:  0.02307891845703125
local_in_edges_tensor generation:  0.027773380279541016
mini_batch_src_global generation:  0.05310368537902832
r_  generation:  0.44124674797058105
local_output_nid generation:  0.023487329483032227
local_in_edges_tensor generation:  0.024554967880249023
mini_batch_src_global generation:  0.05190634727478027
r_  generation:  0.4414546489715576
----------------------check_connections_block total spend ----------------------------- 2.566986560821533
generate_one_block  0.5748016834259033
generate_one_block  0.5750117301940918
generate_one_block  0.6103448867797852
generate_one_block  0.5851576328277588
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04645061492919922
gen group dst list time:  0.024653196334838867
time for parepare:  0.019355297088623047
local_output_nid generation:  0.024385452270507812
local_in_edges_tensor generation:  0.0547327995300293
mini_batch_src_global generation:  0.05184197425842285
r_  generation:  0.533829927444458
local_output_nid generation:  0.03389143943786621
local_in_edges_tensor generation:  0.04842662811279297
mini_batch_src_global generation:  0.05609130859375
r_  generation:  0.5208499431610107
local_output_nid generation:  0.03514432907104492
local_in_edges_tensor generation:  0.05070757865905762
mini_batch_src_global generation:  0.0630652904510498
r_  generation:  0.5112848281860352
local_output_nid generation:  0.03632545471191406
local_in_edges_tensor generation:  0.03788566589355469
mini_batch_src_global generation:  0.05222606658935547
r_  generation:  0.5412375926971436
----------------------check_connections_block total spend ----------------------------- 3.1106719970703125
generate_one_block  0.6507441997528076
generate_one_block  0.6503818035125732
generate_one_block  0.6374795436859131
generate_one_block  0.636014461517334
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

connection checking time:  5.677658557891846
block generation total time  4.919935941696167
average batch blocks generation time:  1.2299839854240417
block dataloader generation time/epoch 12.57415223121643
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.10626888275146484  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

torch.Size([164543, 128])
torch.Size([155660, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.36511993408203125  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.1065363883972168  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

torch.Size([164601, 128])
torch.Size([155769, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3651466369628906  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.10625553131103516  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

torch.Size([164519, 128])
torch.Size([155594, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.36504030227661133  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.10648488998413086  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

torch.Size([164525, 128])
torch.Size([155530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.3645801544189453  GigaBytes
Max Memory Allocated: 0.4153275489807129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05475205183029175 |0.02218937873840332 |0.00379258394241333 |9.721517562866211e-05 |0.004236757755279541 |0.0029473304748535156 |
----------------------------------------------------------pseudo_mini_loss sum 4.068946838378906
Total (block generation + training)time/epoch 12.946471452713013
Training time/epoch 0.37203192710876465
Training time without block to device /epoch 0.28327441215515137
Training time without total dataloading part /epoch 0.03545355796813965
load block tensor time/epoch 0.219008207321167
block to device time/epoch 0.08875751495361328
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1710635
Number of first layer input nodes during this epoch:  658188
