Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648481399.749067
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024595975875854492
range selection method range initialization spend 0.0136566162109375
time for parepare:  0.01785135269165039
local_output_nid generation:  0.0026667118072509766
local_in_edges_tensor generation:  0.003931522369384766
mini_batch_src_global generation:  0.0034189224243164062
r_  generation:  0.03873467445373535
local_output_nid generation:  0.003134012222290039
local_in_edges_tensor generation:  0.0016925334930419922
mini_batch_src_global generation:  0.004331827163696289
r_  generation:  0.039083003997802734
local_output_nid generation:  0.0031538009643554688
local_in_edges_tensor generation:  0.001729726791381836
mini_batch_src_global generation:  0.002858877182006836
r_  generation:  0.03980517387390137
local_output_nid generation:  0.0031571388244628906
local_in_edges_tensor generation:  0.0016939640045166016
mini_batch_src_global generation:  0.0029144287109375
r_  generation:  0.040184974670410156
local_output_nid generation:  0.0031709671020507812
local_in_edges_tensor generation:  0.0017120838165283203
mini_batch_src_global generation:  0.002918720245361328
r_  generation:  0.0414431095123291
local_output_nid generation:  0.0032253265380859375
local_in_edges_tensor generation:  0.0017457008361816406
mini_batch_src_global generation:  0.0031158924102783203
r_  generation:  0.0419316291809082
local_output_nid generation:  0.0031862258911132812
local_in_edges_tensor generation:  0.001676321029663086
mini_batch_src_global generation:  0.0031528472900390625
r_  generation:  0.04172396659851074
local_output_nid generation:  0.0031638145446777344
local_in_edges_tensor generation:  0.0016922950744628906
mini_batch_src_global generation:  0.0031173229217529297
r_  generation:  0.04133939743041992
----------------------check_connections_block total spend ----------------------------- 0.4775080680847168
generate_one_block  0.05466651916503906
generate_one_block  0.0561063289642334
generate_one_block  0.05505681037902832
generate_one_block  0.05572223663330078
generate_one_block  0.05830812454223633
generate_one_block  0.05560564994812012
generate_one_block  0.05583071708679199
generate_one_block  0.05499386787414551
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04100346565246582
gen group dst list time:  0.015588760375976562
time for parepare:  0.01899433135986328
local_output_nid generation:  0.010783195495605469
local_in_edges_tensor generation:  0.026941299438476562
mini_batch_src_global generation:  0.030696392059326172
r_  generation:  0.2963235378265381
local_output_nid generation:  0.015795230865478516
local_in_edges_tensor generation:  0.026896238327026367
mini_batch_src_global generation:  0.03673195838928223
r_  generation:  0.3202948570251465
local_output_nid generation:  0.015928983688354492
local_in_edges_tensor generation:  0.027751684188842773
mini_batch_src_global generation:  0.03584575653076172
r_  generation:  0.31537580490112305
local_output_nid generation:  0.016628503799438477
local_in_edges_tensor generation:  0.02556920051574707
mini_batch_src_global generation:  0.03742194175720215
r_  generation:  0.32701635360717773
local_output_nid generation:  0.018621444702148438
local_in_edges_tensor generation:  0.022913694381713867
mini_batch_src_global generation:  0.03821063041687012
r_  generation:  0.3261599540710449
local_output_nid generation:  0.01794600486755371
local_in_edges_tensor generation:  0.02538585662841797
mini_batch_src_global generation:  0.04128289222717285
r_  generation:  0.33770203590393066
local_output_nid generation:  0.019810914993286133
local_in_edges_tensor generation:  0.022887468338012695
mini_batch_src_global generation:  0.03878521919250488
r_  generation:  0.3224759101867676
local_output_nid generation:  0.017806053161621094
local_in_edges_tensor generation:  0.018988370895385742
mini_batch_src_global generation:  0.0392153263092041
r_  generation:  0.31986474990844727
----------------------check_connections_block total spend ----------------------------- 3.7669565677642822
generate_one_block  0.41373300552368164
generate_one_block  0.4175684452056885
generate_one_block  0.4089522361755371
generate_one_block  0.4235377311706543
generate_one_block  0.4459340572357178
generate_one_block  0.4308912754058838
generate_one_block  0.4257183074951172
generate_one_block  0.41210103034973145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04969429969787598
gen group dst list time:  0.05016350746154785
time for parepare:  0.02512359619140625
local_output_nid generation:  0.02587151527404785
local_in_edges_tensor generation:  0.06443381309509277
mini_batch_src_global generation:  0.06387710571289062
r_  generation:  0.5405604839324951
local_output_nid generation:  0.03725481033325195
local_in_edges_tensor generation:  0.06002163887023926
mini_batch_src_global generation:  0.08077883720397949
r_  generation:  0.5418331623077393
local_output_nid generation:  0.03462553024291992
local_in_edges_tensor generation:  0.0461423397064209
mini_batch_src_global generation:  0.05671358108520508
r_  generation:  0.5621657371520996
local_output_nid generation:  0.03768730163574219
local_in_edges_tensor generation:  0.05423736572265625
mini_batch_src_global generation:  0.06374192237854004
r_  generation:  0.526663064956665
local_output_nid generation:  0.0342257022857666
local_in_edges_tensor generation:  0.050026655197143555
mini_batch_src_global generation:  0.05721569061279297
r_  generation:  0.5477848052978516
local_output_nid generation:  0.03795957565307617
local_in_edges_tensor generation:  0.034784555435180664
mini_batch_src_global generation:  0.060277462005615234
r_  generation:  0.5259108543395996
local_output_nid generation:  0.03562045097351074
local_in_edges_tensor generation:  0.04466724395751953
mini_batch_src_global generation:  0.058049678802490234
r_  generation:  0.5574615001678467
local_output_nid generation:  0.034564971923828125
local_in_edges_tensor generation:  0.04418039321899414
mini_batch_src_global generation:  0.07388043403625488
r_  generation:  0.5297696590423584
----------------------check_connections_block total spend ----------------------------- 6.510804891586304
generate_one_block  0.6768379211425781
generate_one_block  0.6762106418609619
generate_one_block  0.6666922569274902
generate_one_block  0.6653478145599365
generate_one_block  0.6732535362243652
generate_one_block  0.6705186367034912
generate_one_block  0.7243409156799316
generate_one_block  0.6861026287078857
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04174542427062988
gen group dst list time:  0.05492401123046875
time for parepare:  0.01927947998046875
local_output_nid generation:  0.031285762786865234
local_in_edges_tensor generation:  0.05416154861450195
mini_batch_src_global generation:  0.04504799842834473
r_  generation:  0.5019829273223877
local_output_nid generation:  0.03644394874572754
local_in_edges_tensor generation:  0.04942131042480469
mini_batch_src_global generation:  0.05640077590942383
r_  generation:  0.5061497688293457
local_output_nid generation:  0.03648710250854492
local_in_edges_tensor generation:  0.043477773666381836
mini_batch_src_global generation:  0.05573439598083496
r_  generation:  0.50758957862854
local_output_nid generation:  0.036957740783691406
local_in_edges_tensor generation:  0.04010629653930664
mini_batch_src_global generation:  0.054303646087646484
r_  generation:  0.5154078006744385
local_output_nid generation:  0.03770160675048828
local_in_edges_tensor generation:  0.039560556411743164
mini_batch_src_global generation:  0.054598331451416016
r_  generation:  0.5214321613311768
local_output_nid generation:  0.03761863708496094
local_in_edges_tensor generation:  0.04555320739746094
mini_batch_src_global generation:  0.054582834243774414
r_  generation:  0.5191910266876221
local_output_nid generation:  0.0376896858215332
local_in_edges_tensor generation:  0.039666175842285156
mini_batch_src_global generation:  0.0581049919128418
r_  generation:  0.5396261215209961
local_output_nid generation:  0.03771185874938965
local_in_edges_tensor generation:  0.040175676345825195
mini_batch_src_global generation:  0.054087162017822266
r_  generation:  0.5240674018859863
----------------------check_connections_block total spend ----------------------------- 6.165818929672241
generate_one_block  0.6487851142883301
generate_one_block  0.647305965423584
generate_one_block  0.6356930732727051
generate_one_block  0.6361258029937744
generate_one_block  0.6412076950073242
generate_one_block  0.6263153553009033
generate_one_block  0.6928725242614746
generate_one_block  0.641671895980835
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

connection checking time:  16.443580389022827
block generation total time  13.987717866897583
average batch blocks generation time:  1.7484647333621979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11107635498046875  GigaBytes
Max Memory Allocated: 0.11107635498046875  GigaBytes

torch.Size([165577, 128])
torch.Size([161259, 32])
torch.Size([142187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.32248401641845703  GigaBytes
Max Memory Allocated: 0.32492685317993164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11292409896850586  GigaBytes
Max Memory Allocated: 0.3365788459777832  GigaBytes

torch.Size([165631, 128])
torch.Size([161398, 32])
torch.Size([142403, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.32354068756103516  GigaBytes
Max Memory Allocated: 0.3365788459777832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11347198486328125  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

torch.Size([165476, 128])
torch.Size([161243, 32])
torch.Size([141878, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.322084903717041  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11343717575073242  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

torch.Size([165567, 128])
torch.Size([161238, 32])
torch.Size([142023, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3231687545776367  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.11378669738769531  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

torch.Size([165627, 128])
torch.Size([161204, 32])
torch.Size([141942, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.3236088752746582  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.1137385368347168  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

torch.Size([165530, 128])
torch.Size([161099, 32])
torch.Size([141762, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3224220275878906  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11367130279541016  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

torch.Size([165609, 128])
torch.Size([161388, 32])
torch.Size([142560, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3247995376586914  GigaBytes
Max Memory Allocated: 0.33776092529296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11353826522827148  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165358, 128])
torch.Size([160851, 32])
torch.Size([141600, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.32338666915893555  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04037937521934509 |0.06720727682113647 |0.09586355090141296 |0.00013494491577148438 |0.01382187008857727 |0.0032269954681396484 |
----------------------------------------------------------pseudo_mini_loss sum 5.151882171630859
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292925
Number of first layer input nodes during this epoch:  1324375
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.1825723648071289  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.018309593200683594
range selection method range initialization spend 0.011776924133300781
time for parepare:  0.017946720123291016
local_output_nid generation:  0.002772808074951172
local_in_edges_tensor generation:  0.0077190399169921875
mini_batch_src_global generation:  0.0033156871795654297
r_  generation:  0.03778839111328125
local_output_nid generation:  0.0035657882690429688
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.004056215286254883
r_  generation:  0.03906393051147461
local_output_nid generation:  0.003597259521484375
local_in_edges_tensor generation:  0.0016701221466064453
mini_batch_src_global generation:  0.002660036087036133
r_  generation:  0.03833627700805664
local_output_nid generation:  0.0035660266876220703
local_in_edges_tensor generation:  0.0016944408416748047
mini_batch_src_global generation:  0.0028421878814697266
r_  generation:  0.03900718688964844
local_output_nid generation:  0.0035974979400634766
local_in_edges_tensor generation:  0.0017251968383789062
mini_batch_src_global generation:  0.005468845367431641
r_  generation:  0.04108309745788574
local_output_nid generation:  0.0035583972930908203
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.0031061172485351562
r_  generation:  0.040908098220825195
local_output_nid generation:  0.003568410873413086
local_in_edges_tensor generation:  0.0017695426940917969
mini_batch_src_global generation:  0.003142118453979492
r_  generation:  0.042139530181884766
local_output_nid generation:  0.003546476364135742
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.0031838417053222656
r_  generation:  0.041631460189819336
----------------------check_connections_block total spend ----------------------------- 0.48660731315612793
generate_one_block  0.06177806854248047
generate_one_block  0.05456042289733887
generate_one_block  0.0535435676574707
generate_one_block  0.05371570587158203
generate_one_block  0.05543684959411621
generate_one_block  0.05459141731262207
generate_one_block  0.05869317054748535
generate_one_block  0.05531024932861328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03870272636413574
gen group dst list time:  0.015167713165283203
time for parepare:  0.0193328857421875
local_output_nid generation:  0.010878324508666992
local_in_edges_tensor generation:  0.026690244674682617
mini_batch_src_global generation:  0.032033443450927734
r_  generation:  0.29853391647338867
local_output_nid generation:  0.01691126823425293
local_in_edges_tensor generation:  0.0272519588470459
mini_batch_src_global generation:  0.03588509559631348
r_  generation:  0.3116881847381592
local_output_nid generation:  0.017272472381591797
local_in_edges_tensor generation:  0.016823768615722656
mini_batch_src_global generation:  0.03619503974914551
r_  generation:  0.30918335914611816
local_output_nid generation:  0.017436504364013672
local_in_edges_tensor generation:  0.022269487380981445
mini_batch_src_global generation:  0.03690147399902344
r_  generation:  0.3128960132598877
local_output_nid generation:  0.017688512802124023
local_in_edges_tensor generation:  0.025404930114746094
mini_batch_src_global generation:  0.040619611740112305
r_  generation:  0.33994221687316895
local_output_nid generation:  0.02173447608947754
local_in_edges_tensor generation:  0.028054475784301758
mini_batch_src_global generation:  0.0424349308013916
r_  generation:  0.3222310543060303
local_output_nid generation:  0.018878698348999023
local_in_edges_tensor generation:  0.022990703582763672
mini_batch_src_global generation:  0.04108071327209473
r_  generation:  0.3250730037689209
local_output_nid generation:  0.018790721893310547
local_in_edges_tensor generation:  0.023433685302734375
mini_batch_src_global generation:  0.03911781311035156
r_  generation:  0.3359036445617676
----------------------check_connections_block total spend ----------------------------- 3.757779598236084
generate_one_block  0.41533899307250977
generate_one_block  0.40592241287231445
generate_one_block  0.40793395042419434
generate_one_block  0.40731096267700195
generate_one_block  0.4170262813568115
generate_one_block  0.4072411060333252
generate_one_block  0.4257316589355469
generate_one_block  0.44547343254089355
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05106067657470703
gen group dst list time:  0.03764677047729492
time for parepare:  0.019299983978271484
local_output_nid generation:  0.025179624557495117
local_in_edges_tensor generation:  0.06584715843200684
mini_batch_src_global generation:  0.05152583122253418
r_  generation:  0.513948917388916
local_output_nid generation:  0.03174757957458496
local_in_edges_tensor generation:  0.05159187316894531
mini_batch_src_global generation:  0.05814337730407715
r_  generation:  0.5179328918457031
local_output_nid generation:  0.032903194427490234
local_in_edges_tensor generation:  0.03853440284729004
mini_batch_src_global generation:  0.05481672286987305
r_  generation:  0.5301079750061035
local_output_nid generation:  0.04692363739013672
local_in_edges_tensor generation:  0.03849911689758301
mini_batch_src_global generation:  0.0583648681640625
r_  generation:  0.5211820602416992
local_output_nid generation:  0.033464908599853516
local_in_edges_tensor generation:  0.0506594181060791
mini_batch_src_global generation:  0.06047368049621582
r_  generation:  0.5406093597412109
local_output_nid generation:  0.03368115425109863
local_in_edges_tensor generation:  0.03656005859375
mini_batch_src_global generation:  0.05923581123352051
r_  generation:  0.5249650478363037
local_output_nid generation:  0.03345942497253418
local_in_edges_tensor generation:  0.03803658485412598
mini_batch_src_global generation:  0.05988717079162598
r_  generation:  0.5376055240631104
local_output_nid generation:  0.03348541259765625
local_in_edges_tensor generation:  0.04330325126647949
mini_batch_src_global generation:  0.06047964096069336
r_  generation:  0.5230755805969238
----------------------check_connections_block total spend ----------------------------- 6.237414598464966
generate_one_block  0.6649630069732666
generate_one_block  0.6531481742858887
generate_one_block  0.6639535427093506
generate_one_block  0.6713640689849854
generate_one_block  0.6803250312805176
generate_one_block  0.6736202239990234
generate_one_block  0.663261890411377
generate_one_block  0.685741662979126
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03967428207397461
gen group dst list time:  0.05463385581970215
time for parepare:  0.01904296875
local_output_nid generation:  0.030992507934570312
local_in_edges_tensor generation:  0.043221235275268555
mini_batch_src_global generation:  0.04439854621887207
r_  generation:  0.535614013671875
local_output_nid generation:  0.03707313537597656
local_in_edges_tensor generation:  0.036103010177612305
mini_batch_src_global generation:  0.05714225769042969
r_  generation:  0.5046403408050537
local_output_nid generation:  0.03670668601989746
local_in_edges_tensor generation:  0.03636574745178223
mini_batch_src_global generation:  0.05793499946594238
r_  generation:  0.5084197521209717
local_output_nid generation:  0.036863088607788086
local_in_edges_tensor generation:  0.03866910934448242
mini_batch_src_global generation:  0.05556082725524902
r_  generation:  0.5134541988372803
local_output_nid generation:  0.037096500396728516
local_in_edges_tensor generation:  0.04353904724121094
mini_batch_src_global generation:  0.058739662170410156
r_  generation:  0.5141141414642334
local_output_nid generation:  0.03734302520751953
local_in_edges_tensor generation:  0.04324007034301758
mini_batch_src_global generation:  0.05572843551635742
r_  generation:  0.529273509979248
local_output_nid generation:  0.03763175010681152
local_in_edges_tensor generation:  0.033399105072021484
mini_batch_src_global generation:  0.056411027908325195
r_  generation:  0.5199577808380127
local_output_nid generation:  0.03757596015930176
local_in_edges_tensor generation:  0.042353153228759766
mini_batch_src_global generation:  0.05665159225463867
r_  generation:  0.5287532806396484
----------------------check_connections_block total spend ----------------------------- 6.162553310394287
generate_one_block  0.6353282928466797
generate_one_block  0.6398305892944336
generate_one_block  0.6392397880554199
generate_one_block  0.6287641525268555
generate_one_block  0.6460282802581787
generate_one_block  0.6430830955505371
generate_one_block  0.6373214721679688
generate_one_block  0.6384170055389404
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.1825723648071289  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

connection checking time:  16.157747507095337
block generation total time  13.796369075775146
average batch blocks generation time:  1.7245461344718933
block dataloader generation time/epoch 32.286338806152344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11381244659423828  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165447, 128])
torch.Size([161163, 32])
torch.Size([142056, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.323486328125  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.113800048828125  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165473, 128])
torch.Size([161109, 32])
torch.Size([141896, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3225870132446289  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11374473571777344  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165586, 128])
torch.Size([161305, 32])
torch.Size([141899, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.32323694229125977  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11349821090698242  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165566, 128])
torch.Size([161149, 32])
torch.Size([142025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.32199907302856445  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11360025405883789  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165550, 128])
torch.Size([161324, 32])
torch.Size([142546, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3238029479980469  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11381292343139648  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165605, 128])
torch.Size([161263, 32])
torch.Size([142090, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.32382917404174805  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11395025253295898  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

torch.Size([165497, 128])
torch.Size([161092, 32])
torch.Size([141820, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.3250284194946289  GigaBytes
Max Memory Allocated: 0.33863401412963867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.11407709121704102  GigaBytes
Max Memory Allocated: 0.33905839920043945  GigaBytes

torch.Size([165575, 128])
torch.Size([161204, 32])
torch.Size([142384, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7713623046875 GB
    Memory Allocated: 0.32413291931152344  GigaBytes
Max Memory Allocated: 0.33905839920043945  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04097139835357666 |0.0219382643699646 |0.005155354738235474 |0.00011858344078063965 |0.004442781209945679 |0.005252838134765625 |
----------------------------------------------------------pseudo_mini_loss sum 4.533688545227051
Total (block generation + training)time/epoch 32.904706716537476
Training time/epoch 0.6180610656738281
Training time without block to device /epoch 0.44255495071411133
Training time without total dataloading part /epoch 0.08298659324645996
load block tensor time/epoch 0.3277711868286133
block to device time/epoch 0.1755061149597168
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4294128
Number of first layer input nodes during this epoch:  1324299
