Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648451020.5767953
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027378320693969727
range selection method range initialization spend 0.013483285903930664
time for parepare:  0.018239498138427734
local_output_nid generation:  0.0013377666473388672
local_in_edges_tensor generation:  0.004153728485107422
mini_batch_src_global generation:  0.0019047260284423828
r_  generation:  0.019748687744140625
local_output_nid generation:  0.0014438629150390625
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0023047924041748047
r_  generation:  0.020087242126464844
local_output_nid generation:  0.0014638900756835938
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.001531362533569336
r_  generation:  0.0205533504486084
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.01969599723815918
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0015578269958496094
r_  generation:  0.01997542381286621
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.0015876293182373047
r_  generation:  0.0203707218170166
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0016622543334960938
r_  generation:  0.021836519241333008
local_output_nid generation:  0.0015377998352050781
local_in_edges_tensor generation:  0.0008707046508789062
mini_batch_src_global generation:  0.001665353775024414
r_  generation:  0.021133899688720703
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0017237663269042969
r_  generation:  0.02150130271911621
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0017123222351074219
r_  generation:  0.02132415771484375
local_output_nid generation:  0.0015079975128173828
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0018436908721923828
r_  generation:  0.021703720092773438
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.0017290115356445312
r_  generation:  0.021795034408569336
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.001712799072265625
r_  generation:  0.021158933639526367
local_output_nid generation:  0.0015056133270263672
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0018050670623779297
r_  generation:  0.022107601165771484
local_output_nid generation:  0.0015156269073486328
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.0018093585968017578
r_  generation:  0.021639585494995117
local_output_nid generation:  0.0014979839324951172
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.02147674560546875
----------------------check_connections_block total spend ----------------------------- 0.49761223793029785
generate_one_block  0.030287742614746094
generate_one_block  0.031207561492919922
generate_one_block  0.0329439640045166
generate_one_block  0.03064131736755371
generate_one_block  0.03070688247680664
generate_one_block  0.030706405639648438
generate_one_block  0.032372474670410156
generate_one_block  0.030673980712890625
generate_one_block  0.03134965896606445
generate_one_block  0.030938386917114258
generate_one_block  0.03192734718322754
generate_one_block  0.03145956993103027
generate_one_block  0.031102657318115234
generate_one_block  0.031093120574951172
generate_one_block  0.03155994415283203
generate_one_block  0.030918121337890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04354572296142578
gen group dst list time:  0.020480632781982422
time for parepare:  0.020215511322021484
local_output_nid generation:  0.007433652877807617
local_in_edges_tensor generation:  0.019995927810668945
mini_batch_src_global generation:  0.02466440200805664
r_  generation:  0.24336552619934082
local_output_nid generation:  0.013492345809936523
local_in_edges_tensor generation:  0.022760391235351562
mini_batch_src_global generation:  0.03121161460876465
r_  generation:  0.2594277858734131
local_output_nid generation:  0.014259576797485352
local_in_edges_tensor generation:  0.021201372146606445
mini_batch_src_global generation:  0.03420758247375488
r_  generation:  0.2762644290924072
local_output_nid generation:  0.01478266716003418
local_in_edges_tensor generation:  0.014921903610229492
mini_batch_src_global generation:  0.03978776931762695
r_  generation:  0.2888460159301758
local_output_nid generation:  0.015582799911499023
local_in_edges_tensor generation:  0.03177642822265625
mini_batch_src_global generation:  0.03542208671569824
r_  generation:  0.2710747718811035
local_output_nid generation:  0.012423515319824219
local_in_edges_tensor generation:  0.021944046020507812
mini_batch_src_global generation:  0.033441781997680664
r_  generation:  0.2653515338897705
local_output_nid generation:  0.012802600860595703
local_in_edges_tensor generation:  0.021230220794677734
mini_batch_src_global generation:  0.033928871154785156
r_  generation:  0.2757086753845215
local_output_nid generation:  0.012440919876098633
local_in_edges_tensor generation:  0.013519287109375
mini_batch_src_global generation:  0.03379392623901367
r_  generation:  0.26529693603515625
local_output_nid generation:  0.012895822525024414
local_in_edges_tensor generation:  0.01434946060180664
mini_batch_src_global generation:  0.036179542541503906
r_  generation:  0.2741427421569824
local_output_nid generation:  0.012477636337280273
local_in_edges_tensor generation:  0.01825690269470215
mini_batch_src_global generation:  0.034087419509887695
r_  generation:  0.2720644474029541
local_output_nid generation:  0.015517711639404297
local_in_edges_tensor generation:  0.019578218460083008
mini_batch_src_global generation:  0.035070180892944336
r_  generation:  0.2815554141998291
local_output_nid generation:  0.01292276382446289
local_in_edges_tensor generation:  0.018395662307739258
mini_batch_src_global generation:  0.03415513038635254
r_  generation:  0.2910342216491699
local_output_nid generation:  0.015688419342041016
local_in_edges_tensor generation:  0.028406620025634766
mini_batch_src_global generation:  0.04473471641540527
r_  generation:  0.276965856552124
local_output_nid generation:  0.012990474700927734
local_in_edges_tensor generation:  0.018897294998168945
mini_batch_src_global generation:  0.03749418258666992
r_  generation:  0.27470898628234863
local_output_nid generation:  0.012954473495483398
local_in_edges_tensor generation:  0.018569231033325195
mini_batch_src_global generation:  0.03707313537597656
r_  generation:  0.2777087688446045
local_output_nid generation:  0.012747526168823242
local_in_edges_tensor generation:  0.014594078063964844
mini_batch_src_global generation:  0.03417849540710449
r_  generation:  0.26753950119018555
----------------------check_connections_block total spend ----------------------------- 6.455202341079712
generate_one_block  0.3587076663970947
generate_one_block  0.3562130928039551
generate_one_block  0.37074780464172363
generate_one_block  0.34640979766845703
generate_one_block  0.3772003650665283
generate_one_block  0.36362743377685547
generate_one_block  0.4207005500793457
generate_one_block  0.37229275703430176
generate_one_block  0.3797028064727783
generate_one_block  0.35777950286865234
generate_one_block  0.36704587936401367
generate_one_block  0.35845160484313965
generate_one_block  0.3525960445404053
generate_one_block  0.3554215431213379
generate_one_block  0.37618494033813477
generate_one_block  0.3470890522003174
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050940752029418945
gen group dst list time:  0.07061481475830078
time for parepare:  0.020960330963134766
local_output_nid generation:  0.02540421485900879
local_in_edges_tensor generation:  0.04639434814453125
mini_batch_src_global generation:  0.05001378059387207
r_  generation:  0.5146191120147705
local_output_nid generation:  0.03114032745361328
local_in_edges_tensor generation:  0.052985191345214844
mini_batch_src_global generation:  0.06183958053588867
r_  generation:  0.5212569236755371
local_output_nid generation:  0.03138303756713867
local_in_edges_tensor generation:  0.045397281646728516
mini_batch_src_global generation:  0.05907273292541504
r_  generation:  0.5462968349456787
local_output_nid generation:  0.03142809867858887
local_in_edges_tensor generation:  0.035658836364746094
mini_batch_src_global generation:  0.059175729751586914
r_  generation:  0.5310482978820801
local_output_nid generation:  0.03223133087158203
local_in_edges_tensor generation:  0.04603171348571777
mini_batch_src_global generation:  0.06461429595947266
r_  generation:  0.5410199165344238
local_output_nid generation:  0.0319828987121582
local_in_edges_tensor generation:  0.05104517936706543
mini_batch_src_global generation:  0.06359028816223145
r_  generation:  0.5504207611083984
local_output_nid generation:  0.03206276893615723
local_in_edges_tensor generation:  0.0479121208190918
mini_batch_src_global generation:  0.06611442565917969
r_  generation:  0.5504064559936523
local_output_nid generation:  0.033514976501464844
local_in_edges_tensor generation:  0.03788948059082031
mini_batch_src_global generation:  0.06603837013244629
r_  generation:  0.5393407344818115
local_output_nid generation:  0.03306865692138672
local_in_edges_tensor generation:  0.03528594970703125
mini_batch_src_global generation:  0.06196951866149902
r_  generation:  0.5420851707458496
local_output_nid generation:  0.0329442024230957
local_in_edges_tensor generation:  0.04504513740539551
mini_batch_src_global generation:  0.06187295913696289
r_  generation:  0.5406038761138916
local_output_nid generation:  0.0330965518951416
local_in_edges_tensor generation:  0.039865970611572266
mini_batch_src_global generation:  0.06560683250427246
r_  generation:  0.5433812141418457
local_output_nid generation:  0.03309941291809082
local_in_edges_tensor generation:  0.044866323471069336
mini_batch_src_global generation:  0.06387138366699219
r_  generation:  0.5592279434204102
local_output_nid generation:  0.03299999237060547
local_in_edges_tensor generation:  0.03515744209289551
mini_batch_src_global generation:  0.06353378295898438
r_  generation:  0.5446491241455078
local_output_nid generation:  0.033263444900512695
local_in_edges_tensor generation:  0.04025149345397949
mini_batch_src_global generation:  0.06271934509277344
r_  generation:  0.5439760684967041
local_output_nid generation:  0.03287768363952637
local_in_edges_tensor generation:  0.07062482833862305
mini_batch_src_global generation:  0.06609773635864258
r_  generation:  0.5424535274505615
local_output_nid generation:  0.03400373458862305
local_in_edges_tensor generation:  0.03315019607543945
mini_batch_src_global generation:  0.06267905235290527
r_  generation:  0.5496382713317871
----------------------check_connections_block total spend ----------------------------- 12.801725387573242
generate_one_block  0.6893737316131592
generate_one_block  0.6936559677124023
generate_one_block  0.6960422992706299
generate_one_block  0.6781680583953857
generate_one_block  0.677140474319458
generate_one_block  0.6904120445251465
generate_one_block  0.7696371078491211
generate_one_block  0.6903793811798096
generate_one_block  0.6881976127624512
generate_one_block  0.6832151412963867
generate_one_block  0.6979763507843018
generate_one_block  0.6803290843963623
generate_one_block  0.6794149875640869
generate_one_block  0.6946167945861816
generate_one_block  0.6893594264984131
generate_one_block  0.6907863616943359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  19.256927728652954
block generation total time  16.948875665664673
average batch blocks generation time:  1.059304729104042
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09529733657836914  GigaBytes
Max Memory Allocated: 0.09529733657836914  GigaBytes

torch.Size([157276, 128])
torch.Size([129609, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.4745635986328125  GigaBytes
Max Memory Allocated: 0.4938688278198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.09694957733154297  GigaBytes
Max Memory Allocated: 0.5173115730285645  GigaBytes

torch.Size([157600, 128])
torch.Size([129970, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47554826736450195  GigaBytes
Max Memory Allocated: 0.5173115730285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09716224670410156  GigaBytes
Max Memory Allocated: 0.5183348655700684  GigaBytes

torch.Size([157554, 128])
torch.Size([130076, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4796571731567383  GigaBytes
Max Memory Allocated: 0.5183348655700684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09686470031738281  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

torch.Size([157472, 128])
torch.Size([129381, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47518014907836914  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.0967864990234375  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

torch.Size([157114, 128])
torch.Size([129281, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47527217864990234  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09689474105834961  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

torch.Size([157347, 128])
torch.Size([129378, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4756793975830078  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09832000732421875  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

torch.Size([157718, 128])
torch.Size([130277, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.48218774795532227  GigaBytes
Max Memory Allocated: 0.5233840942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09689903259277344  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157448, 128])
torch.Size([128990, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4712643623352051  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.0982818603515625  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157799, 128])
torch.Size([130524, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4810948371887207  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09705448150634766  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157630, 128])
torch.Size([129798, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47686004638671875  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09830665588378906  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157961, 128])
torch.Size([130848, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4819488525390625  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09707832336425781  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157536, 128])
torch.Size([130047, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4798159599304199  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09701204299926758  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157455, 128])
torch.Size([129880, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47725677490234375  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.0971536636352539  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157662, 128])
torch.Size([130262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4796452522277832  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09714984893798828  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157534, 128])
torch.Size([129996, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47939062118530273  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09696626663208008  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157657, 128])
torch.Size([130019, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4752845764160156  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04058064520359039 |0.03753678500652313 |0.04943189024925232 |9.870529174804688e-05 |0.008834868669509888 |0.001982450485229492 |
----------------------------------------------------------pseudo_mini_loss sum 5.621054649353027
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5328640
Number of first layer input nodes during this epoch:  2520763
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.12568187713623047  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02316427230834961
range selection method range initialization spend 0.01156926155090332
time for parepare:  0.01702284812927246
local_output_nid generation:  0.0013878345489501953
local_in_edges_tensor generation:  0.00847005844116211
mini_batch_src_global generation:  0.0018815994262695312
r_  generation:  0.019175291061401367
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.0023064613342285156
r_  generation:  0.02026653289794922
local_output_nid generation:  0.0017375946044921875
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0014750957489013672
r_  generation:  0.020842552185058594
local_output_nid generation:  0.0016756057739257812
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.02089071273803711
local_output_nid generation:  0.001630544662475586
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0015783309936523438
r_  generation:  0.020918607711791992
local_output_nid generation:  0.0016512870788574219
local_in_edges_tensor generation:  0.0009655952453613281
mini_batch_src_global generation:  0.0016429424285888672
r_  generation:  0.021435260772705078
local_output_nid generation:  0.0016570091247558594
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.02156972885131836
local_output_nid generation:  0.001623392105102539
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0016300678253173828
r_  generation:  0.021228551864624023
local_output_nid generation:  0.0015308856964111328
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0016925334930419922
r_  generation:  0.02205801010131836
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009298324584960938
mini_batch_src_global generation:  0.0016667842864990234
r_  generation:  0.022082090377807617
local_output_nid generation:  0.0016019344329833984
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.02231884002685547
local_output_nid generation:  0.001573324203491211
local_in_edges_tensor generation:  0.0009121894836425781
mini_batch_src_global generation:  0.0016851425170898438
r_  generation:  0.021909475326538086
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0008759498596191406
mini_batch_src_global generation:  0.0017652511596679688
r_  generation:  0.02233719825744629
local_output_nid generation:  0.0015664100646972656
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.022927522659301758
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0017321109771728516
r_  generation:  0.022423267364501953
local_output_nid generation:  0.0016138553619384766
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0017418861389160156
r_  generation:  0.02187180519104004
----------------------check_connections_block total spend ----------------------------- 0.5140082836151123
generate_one_block  0.03255724906921387
generate_one_block  0.03068256378173828
generate_one_block  0.03135418891906738
generate_one_block  0.0316317081451416
generate_one_block  0.031217336654663086
generate_one_block  0.03296971321105957
generate_one_block  0.030681848526000977
generate_one_block  0.031040668487548828
generate_one_block  0.03227972984313965
generate_one_block  0.032279014587402344
generate_one_block  0.0321650505065918
generate_one_block  0.030723094940185547
generate_one_block  0.03212094306945801
generate_one_block  0.03179049491882324
generate_one_block  0.03176689147949219
generate_one_block  0.031203031539916992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04314923286437988
gen group dst list time:  0.019354581832885742
time for parepare:  0.019042491912841797
local_output_nid generation:  0.007038116455078125
local_in_edges_tensor generation:  0.022210121154785156
mini_batch_src_global generation:  0.02591538429260254
r_  generation:  0.2475745677947998
local_output_nid generation:  0.011104106903076172
local_in_edges_tensor generation:  0.024454593658447266
mini_batch_src_global generation:  0.03146505355834961
r_  generation:  0.2543599605560303
local_output_nid generation:  0.012119770050048828
local_in_edges_tensor generation:  0.016004085540771484
mini_batch_src_global generation:  0.03168368339538574
r_  generation:  0.273357629776001
local_output_nid generation:  0.0185239315032959
local_in_edges_tensor generation:  0.02790212631225586
mini_batch_src_global generation:  0.0523526668548584
r_  generation:  0.2634251117706299
local_output_nid generation:  0.014631509780883789
local_in_edges_tensor generation:  0.017525434494018555
mini_batch_src_global generation:  0.0330195426940918
r_  generation:  0.2627723217010498
local_output_nid generation:  0.01238393783569336
local_in_edges_tensor generation:  0.016267776489257812
mini_batch_src_global generation:  0.033559322357177734
r_  generation:  0.2666487693786621
local_output_nid generation:  0.012423276901245117
local_in_edges_tensor generation:  0.018446683883666992
mini_batch_src_global generation:  0.04443693161010742
r_  generation:  0.2660257816314697
local_output_nid generation:  0.012525081634521484
local_in_edges_tensor generation:  0.016201496124267578
mini_batch_src_global generation:  0.033768415451049805
r_  generation:  0.26610279083251953
local_output_nid generation:  0.012811422348022461
local_in_edges_tensor generation:  0.018549680709838867
mini_batch_src_global generation:  0.03481721878051758
r_  generation:  0.2772078514099121
local_output_nid generation:  0.013621807098388672
local_in_edges_tensor generation:  0.02196049690246582
mini_batch_src_global generation:  0.03474545478820801
r_  generation:  0.28299975395202637
local_output_nid generation:  0.013882637023925781
local_in_edges_tensor generation:  0.02695155143737793
mini_batch_src_global generation:  0.03688240051269531
r_  generation:  0.27484703063964844
local_output_nid generation:  0.012748479843139648
local_in_edges_tensor generation:  0.017140865325927734
mini_batch_src_global generation:  0.03930163383483887
r_  generation:  0.26760387420654297
local_output_nid generation:  0.01268148422241211
local_in_edges_tensor generation:  0.013763189315795898
mini_batch_src_global generation:  0.0370020866394043
r_  generation:  0.28966593742370605
local_output_nid generation:  0.012807607650756836
local_in_edges_tensor generation:  0.020775794982910156
mini_batch_src_global generation:  0.034586191177368164
r_  generation:  0.2734534740447998
local_output_nid generation:  0.012820243835449219
local_in_edges_tensor generation:  0.016495227813720703
mini_batch_src_global generation:  0.03725075721740723
r_  generation:  0.2780008316040039
local_output_nid generation:  0.01265573501586914
local_in_edges_tensor generation:  0.013527870178222656
mini_batch_src_global generation:  0.03418278694152832
r_  generation:  0.2759714126586914
----------------------check_connections_block total spend ----------------------------- 6.380181074142456
generate_one_block  0.3429293632507324
generate_one_block  0.3400435447692871
generate_one_block  0.361081600189209
generate_one_block  0.3570587635040283
generate_one_block  0.36777377128601074
generate_one_block  0.3598501682281494
generate_one_block  0.3773386478424072
generate_one_block  0.35298991203308105
generate_one_block  0.36376094818115234
generate_one_block  0.3730192184448242
generate_one_block  0.3666863441467285
generate_one_block  0.35564470291137695
generate_one_block  0.36274290084838867
generate_one_block  0.3804798126220703
generate_one_block  0.3669006824493408
generate_one_block  0.34879064559936523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052834272384643555
gen group dst list time:  0.07145357131958008
time for parepare:  0.019942283630371094
local_output_nid generation:  0.025589704513549805
local_in_edges_tensor generation:  0.05134463310241699
mini_batch_src_global generation:  0.050936222076416016
r_  generation:  0.5455679893493652
local_output_nid generation:  0.03106689453125
local_in_edges_tensor generation:  0.05177426338195801
mini_batch_src_global generation:  0.061859846115112305
r_  generation:  0.5274357795715332
local_output_nid generation:  0.03162407875061035
local_in_edges_tensor generation:  0.04235959053039551
mini_batch_src_global generation:  0.06644630432128906
r_  generation:  0.545203685760498
local_output_nid generation:  0.03303122520446777
local_in_edges_tensor generation:  0.045224666595458984
mini_batch_src_global generation:  0.0619359016418457
r_  generation:  0.5497796535491943
local_output_nid generation:  0.03259086608886719
local_in_edges_tensor generation:  0.09740066528320312
mini_batch_src_global generation:  0.0728600025177002
r_  generation:  0.5405561923980713
local_output_nid generation:  0.033612966537475586
local_in_edges_tensor generation:  0.03498125076293945
mini_batch_src_global generation:  0.06173276901245117
r_  generation:  0.5358960628509521
local_output_nid generation:  0.033022403717041016
local_in_edges_tensor generation:  0.03596615791320801
mini_batch_src_global generation:  0.06385445594787598
r_  generation:  0.5370180606842041
local_output_nid generation:  0.03322458267211914
local_in_edges_tensor generation:  0.042754173278808594
mini_batch_src_global generation:  0.06131100654602051
r_  generation:  0.5394251346588135
local_output_nid generation:  0.03342604637145996
local_in_edges_tensor generation:  0.0423276424407959
mini_batch_src_global generation:  0.06113553047180176
r_  generation:  0.5405175685882568
local_output_nid generation:  0.03358602523803711
local_in_edges_tensor generation:  0.04871678352355957
mini_batch_src_global generation:  0.06794214248657227
r_  generation:  0.5425114631652832
local_output_nid generation:  0.03345823287963867
local_in_edges_tensor generation:  0.03760385513305664
mini_batch_src_global generation:  0.06705069541931152
r_  generation:  0.5433933734893799
local_output_nid generation:  0.03313446044921875
local_in_edges_tensor generation:  0.03271365165710449
mini_batch_src_global generation:  0.06288266181945801
r_  generation:  0.540874719619751
local_output_nid generation:  0.03322315216064453
local_in_edges_tensor generation:  0.032770633697509766
mini_batch_src_global generation:  0.06252384185791016
r_  generation:  0.545689582824707
local_output_nid generation:  0.033350229263305664
local_in_edges_tensor generation:  0.03889584541320801
mini_batch_src_global generation:  0.06231331825256348
r_  generation:  0.552222728729248
local_output_nid generation:  0.03355693817138672
local_in_edges_tensor generation:  0.042794227600097656
mini_batch_src_global generation:  0.061743736267089844
r_  generation:  0.5554957389831543
local_output_nid generation:  0.03357124328613281
local_in_edges_tensor generation:  0.038559675216674805
mini_batch_src_global generation:  0.062447547912597656
r_  generation:  0.5455367565155029
----------------------check_connections_block total spend ----------------------------- 12.845187902450562
generate_one_block  0.6861894130706787
generate_one_block  0.6906018257141113
generate_one_block  0.6926789283752441
generate_one_block  0.7018818855285645
generate_one_block  0.7008645534515381
generate_one_block  0.6878662109375
generate_one_block  0.683769941329956
generate_one_block  0.6906085014343262
generate_one_block  0.7359912395477295
generate_one_block  0.7009336948394775
generate_one_block  0.6996078491210938
generate_one_block  0.6742987632751465
generate_one_block  0.6896915435791016
generate_one_block  0.690850019454956
generate_one_block  0.6947405338287354
generate_one_block  0.6750838756561279
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.12568187713623047  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

connection checking time:  19.225368976593018
block generation total time  16.87274980545044
average batch blocks generation time:  1.0545468628406525
block dataloader generation time/epoch 38.42897009849548
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09733247756958008  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157468, 128])
torch.Size([129643, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4753389358520508  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.0974740982055664  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157432, 128])
torch.Size([129385, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.47581911087036133  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09779024124145508  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157661, 128])
torch.Size([130069, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.48013830184936523  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09757852554321289  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157425, 128])
torch.Size([129781, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.4780430793762207  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.09753084182739258  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157455, 128])
torch.Size([129438, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47631311416625977  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09758758544921875  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157494, 128])
torch.Size([129631, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4774208068847656  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09748029708862305  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157503, 128])
torch.Size([129204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47594738006591797  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09758186340332031  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157618, 128])
torch.Size([130176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.47713375091552734  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09779500961303711  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157665, 128])
torch.Size([130371, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.480832576751709  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09867191314697266  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157754, 128])
torch.Size([130519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4801654815673828  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0987691879272461  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157974, 128])
torch.Size([130753, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.48203420639038086  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09764575958251953  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157688, 128])
torch.Size([129808, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4768943786621094  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0976409912109375  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157442, 128])
torch.Size([129794, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4803638458251953  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09764671325683594  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157432, 128])
torch.Size([129898, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.48014163970947266  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.0988321304321289  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157741, 128])
torch.Size([130392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.48137760162353516  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.09747600555419922  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

torch.Size([157378, 128])
torch.Size([129577, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.4763054847717285  GigaBytes
Max Memory Allocated: 0.5266575813293457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03862811625003815 |0.015933603048324585 |0.0035332292318344116 |9.384751319885254e-05 |0.0034130364656448364 |0.0021572113037109375 |
----------------------------------------------------------pseudo_mini_loss sum 3.5792694091796875
Total (block generation + training)time/epoch 39.45314860343933
Training time/epoch 1.02390718460083
Training time without block to device /epoch 0.7689695358276367
Training time without total dataloading part /epoch 0.11479902267456055
load block tensor time/epoch 0.6180498600006104
block to device time/epoch 0.25493764877319336
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5329421
Number of first layer input nodes during this epoch:  2521130
