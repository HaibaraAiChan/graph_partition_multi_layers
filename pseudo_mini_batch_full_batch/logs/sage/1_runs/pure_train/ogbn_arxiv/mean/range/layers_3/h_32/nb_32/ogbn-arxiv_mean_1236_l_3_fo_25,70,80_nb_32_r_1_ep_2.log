Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446567.5219738
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026958703994750977
range selection method range initialization spend 0.013422727584838867
time for parepare:  0.01806187629699707
local_output_nid generation:  0.0006835460662841797
local_in_edges_tensor generation:  0.0038230419158935547
mini_batch_src_global generation:  0.0014982223510742188
r_  generation:  0.010374307632446289
local_output_nid generation:  0.0007262229919433594
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0014836788177490234
r_  generation:  0.009444713592529297
local_output_nid generation:  0.0007326602935791016
local_in_edges_tensor generation:  0.0005192756652832031
mini_batch_src_global generation:  0.0010373592376708984
r_  generation:  0.009871959686279297
local_output_nid generation:  0.0008320808410644531
local_in_edges_tensor generation:  0.0005345344543457031
mini_batch_src_global generation:  0.0009434223175048828
r_  generation:  0.009656429290771484
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.0005116462707519531
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.009317874908447266
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009024143218994141
r_  generation:  0.009090900421142578
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.009498357772827148
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0009388923645019531
r_  generation:  0.009791851043701172
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0010700225830078125
r_  generation:  0.009927988052368164
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.009697675704956055
local_output_nid generation:  0.0007474422454833984
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009434223175048828
r_  generation:  0.00992131233215332
local_output_nid generation:  0.0007517337799072266
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0009660720825195312
r_  generation:  0.010143041610717773
local_output_nid generation:  0.00079345703125
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0010035037994384766
r_  generation:  0.009931564331054688
local_output_nid generation:  0.0007545948028564453
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.009945869445800781
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.00093841552734375
r_  generation:  0.009194135665893555
local_output_nid generation:  0.0007619857788085938
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0009388923645019531
r_  generation:  0.009726524353027344
local_output_nid generation:  0.0007593631744384766
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.00098419189453125
r_  generation:  0.009975194931030273
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0004978179931640625
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.009580373764038086
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0010161399841308594
r_  generation:  0.009872674942016602
local_output_nid generation:  0.0007674694061279297
local_in_edges_tensor generation:  0.00046825408935546875
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.009397506713867188
local_output_nid generation:  0.0007843971252441406
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.0009849071502685547
r_  generation:  0.009652376174926758
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.009696245193481445
local_output_nid generation:  0.0007829666137695312
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.010005712509155273
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0009889602661132812
r_  generation:  0.010180473327636719
local_output_nid generation:  0.0007545948028564453
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.00999903678894043
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.0004975795745849609
mini_batch_src_global generation:  0.0009932518005371094
r_  generation:  0.009882211685180664
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.009620904922485352
local_output_nid generation:  0.0007812976837158203
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.010276317596435547
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.010150432586669922
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.004261493682861328
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.010175704956054688
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.0005183219909667969
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.010401725769042969
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.01025390625
----------------------check_connections_block total spend ----------------------------- 0.4850137233734131
generate_one_block  0.015484809875488281
generate_one_block  0.015009403228759766
generate_one_block  0.01524972915649414
generate_one_block  0.014955520629882812
generate_one_block  0.01479792594909668
generate_one_block  0.014501333236694336
generate_one_block  0.014841556549072266
generate_one_block  0.014920234680175781
generate_one_block  0.01533198356628418
generate_one_block  0.015098094940185547
generate_one_block  0.015058279037475586
generate_one_block  0.015348434448242188
generate_one_block  0.015207290649414062
generate_one_block  0.015373706817626953
generate_one_block  0.01398324966430664
generate_one_block  0.014692068099975586
generate_one_block  0.014697790145874023
generate_one_block  0.01422119140625
generate_one_block  0.014945268630981445
generate_one_block  0.014256715774536133
generate_one_block  0.014496803283691406
generate_one_block  0.014613628387451172
generate_one_block  0.015027284622192383
generate_one_block  0.01521611213684082
generate_one_block  0.015382051467895508
generate_one_block  0.014818429946899414
generate_one_block  0.014632701873779297
generate_one_block  0.015186309814453125
generate_one_block  0.015189170837402344
generate_one_block  0.015075206756591797
generate_one_block  0.015304088592529297
generate_one_block  0.015087127685546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045033931732177734
gen group dst list time:  0.023626089096069336
time for parepare:  0.020513296127319336
local_output_nid generation:  0.004500627517700195
local_in_edges_tensor generation:  0.013700723648071289
mini_batch_src_global generation:  0.016161203384399414
r_  generation:  0.16022276878356934
local_output_nid generation:  0.008527994155883789
local_in_edges_tensor generation:  0.014458656311035156
mini_batch_src_global generation:  0.0207216739654541
r_  generation:  0.16759967803955078
local_output_nid generation:  0.008784770965576172
local_in_edges_tensor generation:  0.011627435684204102
mini_batch_src_global generation:  0.01986098289489746
r_  generation:  0.17369508743286133
local_output_nid generation:  0.008725643157958984
local_in_edges_tensor generation:  0.013267040252685547
mini_batch_src_global generation:  0.020197153091430664
r_  generation:  0.17113709449768066
local_output_nid generation:  0.012613534927368164
local_in_edges_tensor generation:  0.010564327239990234
mini_batch_src_global generation:  0.020771026611328125
r_  generation:  0.17349815368652344
local_output_nid generation:  0.00865793228149414
local_in_edges_tensor generation:  0.009716987609863281
mini_batch_src_global generation:  0.02012157440185547
r_  generation:  0.16537213325500488
local_output_nid generation:  0.009140253067016602
local_in_edges_tensor generation:  0.008391857147216797
mini_batch_src_global generation:  0.021982669830322266
r_  generation:  0.1742851734161377
local_output_nid generation:  0.009072303771972656
local_in_edges_tensor generation:  0.012002944946289062
mini_batch_src_global generation:  0.021692752838134766
r_  generation:  0.17685198783874512
local_output_nid generation:  0.00952768325805664
local_in_edges_tensor generation:  0.01098179817199707
mini_batch_src_global generation:  0.02427816390991211
r_  generation:  0.18265247344970703
local_output_nid generation:  0.009272336959838867
local_in_edges_tensor generation:  0.0088043212890625
mini_batch_src_global generation:  0.022172212600708008
r_  generation:  0.1747884750366211
local_output_nid generation:  0.009445905685424805
local_in_edges_tensor generation:  0.009465694427490234
mini_batch_src_global generation:  0.023714303970336914
r_  generation:  0.17752647399902344
local_output_nid generation:  0.009497880935668945
local_in_edges_tensor generation:  0.012273788452148438
mini_batch_src_global generation:  0.0259859561920166
r_  generation:  0.17977428436279297
local_output_nid generation:  0.009616374969482422
local_in_edges_tensor generation:  0.010873079299926758
mini_batch_src_global generation:  0.02450728416442871
r_  generation:  0.18207335472106934
local_output_nid generation:  0.009634256362915039
local_in_edges_tensor generation:  0.012175798416137695
mini_batch_src_global generation:  0.022887706756591797
r_  generation:  0.18007326126098633
local_output_nid generation:  0.0089569091796875
local_in_edges_tensor generation:  0.008509159088134766
mini_batch_src_global generation:  0.021169424057006836
r_  generation:  0.1652393341064453
local_output_nid generation:  0.009379863739013672
local_in_edges_tensor generation:  0.00980067253112793
mini_batch_src_global generation:  0.021834135055541992
r_  generation:  0.1770932674407959
local_output_nid generation:  0.00962209701538086
local_in_edges_tensor generation:  0.012079954147338867
mini_batch_src_global generation:  0.021895170211791992
r_  generation:  0.17489266395568848
local_output_nid generation:  0.009461164474487305
local_in_edges_tensor generation:  0.010344743728637695
mini_batch_src_global generation:  0.021593093872070312
r_  generation:  0.16969966888427734
local_output_nid generation:  0.009629011154174805
local_in_edges_tensor generation:  0.010776996612548828
mini_batch_src_global generation:  0.022671222686767578
r_  generation:  0.17889118194580078
local_output_nid generation:  0.009336233139038086
local_in_edges_tensor generation:  0.01029062271118164
mini_batch_src_global generation:  0.02209615707397461
r_  generation:  0.17362666130065918
local_output_nid generation:  0.009473800659179688
local_in_edges_tensor generation:  0.010370254516601562
mini_batch_src_global generation:  0.022001028060913086
r_  generation:  0.17171120643615723
local_output_nid generation:  0.00954127311706543
local_in_edges_tensor generation:  0.011816263198852539
mini_batch_src_global generation:  0.022003173828125
r_  generation:  0.17679858207702637
local_output_nid generation:  0.009696722030639648
local_in_edges_tensor generation:  0.009333610534667969
mini_batch_src_global generation:  0.023926734924316406
r_  generation:  0.1817026138305664
local_output_nid generation:  0.009802818298339844
local_in_edges_tensor generation:  0.010933160781860352
mini_batch_src_global generation:  0.024637460708618164
r_  generation:  0.18194818496704102
local_output_nid generation:  0.009897947311401367
local_in_edges_tensor generation:  0.01126861572265625
mini_batch_src_global generation:  0.02301812171936035
r_  generation:  0.18468785285949707
local_output_nid generation:  0.009642362594604492
local_in_edges_tensor generation:  0.010504961013793945
mini_batch_src_global generation:  0.0251312255859375
r_  generation:  0.17644548416137695
local_output_nid generation:  0.00954437255859375
local_in_edges_tensor generation:  0.010734319686889648
mini_batch_src_global generation:  0.0237271785736084
r_  generation:  0.17941641807556152
local_output_nid generation:  0.009876489639282227
local_in_edges_tensor generation:  0.010759830474853516
mini_batch_src_global generation:  0.023318767547607422
r_  generation:  0.18332862854003906
local_output_nid generation:  0.009795665740966797
local_in_edges_tensor generation:  0.012403249740600586
mini_batch_src_global generation:  0.02288365364074707
r_  generation:  0.18335223197937012
local_output_nid generation:  0.009969949722290039
local_in_edges_tensor generation:  0.011003732681274414
mini_batch_src_global generation:  0.02295541763305664
r_  generation:  0.182603120803833
local_output_nid generation:  0.009682655334472656
local_in_edges_tensor generation:  0.010642051696777344
mini_batch_src_global generation:  0.022343158721923828
r_  generation:  0.18063974380493164
local_output_nid generation:  0.009947776794433594
local_in_edges_tensor generation:  0.010668754577636719
mini_batch_src_global generation:  0.0247495174407959
r_  generation:  0.18863320350646973
----------------------check_connections_block total spend ----------------------------- 8.324880599975586
generate_one_block  0.23241019248962402
generate_one_block  0.22220754623413086
generate_one_block  0.25705814361572266
generate_one_block  0.2351546287536621
generate_one_block  0.22747445106506348
generate_one_block  0.2161099910736084
generate_one_block  0.2236192226409912
generate_one_block  0.2290639877319336
generate_one_block  0.2375931739807129
generate_one_block  0.22478413581848145
generate_one_block  0.23017239570617676
generate_one_block  0.2424938678741455
generate_one_block  0.23819637298583984
generate_one_block  0.23551273345947266
generate_one_block  0.20761656761169434
generate_one_block  0.26009559631347656
generate_one_block  0.22528433799743652
generate_one_block  0.2170858383178711
generate_one_block  0.22840142250061035
generate_one_block  0.22418856620788574
generate_one_block  0.2206275463104248
generate_one_block  0.22435998916625977
generate_one_block  0.23133492469787598
generate_one_block  0.23864364624023438
generate_one_block  0.23571443557739258
generate_one_block  0.22046899795532227
generate_one_block  0.22404956817626953
generate_one_block  0.23598694801330566
generate_one_block  0.23034906387329102
generate_one_block  0.23990225791931152
generate_one_block  0.2272195816040039
generate_one_block  0.23877549171447754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05452680587768555
gen group dst list time:  0.11519646644592285
time for parepare:  0.020482778549194336
local_output_nid generation:  0.022115230560302734
local_in_edges_tensor generation:  0.06297063827514648
mini_batch_src_global generation:  0.043437957763671875
r_  generation:  0.4111499786376953
local_output_nid generation:  0.028071880340576172
local_in_edges_tensor generation:  0.042165279388427734
mini_batch_src_global generation:  0.0489506721496582
r_  generation:  0.41464662551879883
local_output_nid generation:  0.028200387954711914
local_in_edges_tensor generation:  0.035036563873291016
mini_batch_src_global generation:  0.053343772888183594
r_  generation:  0.43220043182373047
local_output_nid generation:  0.02689814567565918
local_in_edges_tensor generation:  0.03614187240600586
mini_batch_src_global generation:  0.05215930938720703
r_  generation:  0.4298241138458252
local_output_nid generation:  0.027360916137695312
local_in_edges_tensor generation:  0.027074575424194336
mini_batch_src_global generation:  0.04909658432006836
r_  generation:  0.4308464527130127
local_output_nid generation:  0.027287960052490234
local_in_edges_tensor generation:  0.02770829200744629
mini_batch_src_global generation:  0.0491175651550293
r_  generation:  0.42546820640563965
local_output_nid generation:  0.0274507999420166
local_in_edges_tensor generation:  0.03133106231689453
mini_batch_src_global generation:  0.052893877029418945
r_  generation:  0.42843198776245117
local_output_nid generation:  0.02814006805419922
local_in_edges_tensor generation:  0.03954815864562988
mini_batch_src_global generation:  0.05018973350524902
r_  generation:  0.42411231994628906
local_output_nid generation:  0.02757549285888672
local_in_edges_tensor generation:  0.031676530838012695
mini_batch_src_global generation:  0.05411243438720703
r_  generation:  0.43474650382995605
local_output_nid generation:  0.02758502960205078
local_in_edges_tensor generation:  0.038552045822143555
mini_batch_src_global generation:  0.05025339126586914
r_  generation:  0.4297499656677246
local_output_nid generation:  0.02789592742919922
local_in_edges_tensor generation:  0.031678199768066406
mini_batch_src_global generation:  0.04996037483215332
r_  generation:  0.43269944190979004
local_output_nid generation:  0.027874469757080078
local_in_edges_tensor generation:  0.03586268424987793
mini_batch_src_global generation:  0.04998445510864258
r_  generation:  0.4339001178741455
local_output_nid generation:  0.027650117874145508
local_in_edges_tensor generation:  0.03442192077636719
mini_batch_src_global generation:  0.05351066589355469
r_  generation:  0.43591737747192383
local_output_nid generation:  0.0279848575592041
local_in_edges_tensor generation:  0.03248167037963867
mini_batch_src_global generation:  0.05092477798461914
r_  generation:  0.4366631507873535
local_output_nid generation:  0.027706384658813477
local_in_edges_tensor generation:  0.02831411361694336
mini_batch_src_global generation:  0.05052471160888672
r_  generation:  0.4405508041381836
local_output_nid generation:  0.02776932716369629
local_in_edges_tensor generation:  0.03614997863769531
mini_batch_src_global generation:  0.05263853073120117
r_  generation:  0.4320077896118164
local_output_nid generation:  0.027645587921142578
local_in_edges_tensor generation:  0.04058218002319336
mini_batch_src_global generation:  0.049592018127441406
r_  generation:  0.43071842193603516
local_output_nid generation:  0.027800559997558594
local_in_edges_tensor generation:  0.03126788139343262
mini_batch_src_global generation:  0.04984307289123535
r_  generation:  0.43860626220703125
local_output_nid generation:  0.03047919273376465
local_in_edges_tensor generation:  0.03207969665527344
mini_batch_src_global generation:  0.051340579986572266
r_  generation:  0.4341585636138916
local_output_nid generation:  0.028225183486938477
local_in_edges_tensor generation:  0.032186269760131836
mini_batch_src_global generation:  0.050150394439697266
r_  generation:  0.4297802448272705
local_output_nid generation:  0.028393268585205078
local_in_edges_tensor generation:  0.035614967346191406
mini_batch_src_global generation:  0.04965829849243164
r_  generation:  0.43160510063171387
local_output_nid generation:  0.02855849266052246
local_in_edges_tensor generation:  0.03594064712524414
mini_batch_src_global generation:  0.04977607727050781
r_  generation:  0.4294917583465576
local_output_nid generation:  0.028520822525024414
local_in_edges_tensor generation:  0.03158068656921387
mini_batch_src_global generation:  0.053014278411865234
r_  generation:  0.43241047859191895
local_output_nid generation:  0.028838634490966797
local_in_edges_tensor generation:  0.03589224815368652
mini_batch_src_global generation:  0.053063154220581055
r_  generation:  0.43143439292907715
local_output_nid generation:  0.028589248657226562
local_in_edges_tensor generation:  0.03197908401489258
mini_batch_src_global generation:  0.05055713653564453
r_  generation:  0.4400186538696289
local_output_nid generation:  0.028667449951171875
local_in_edges_tensor generation:  0.028464555740356445
mini_batch_src_global generation:  0.050513505935668945
r_  generation:  0.4311788082122803
local_output_nid generation:  0.028491973876953125
local_in_edges_tensor generation:  0.02807164192199707
mini_batch_src_global generation:  0.05034184455871582
r_  generation:  0.43071889877319336
local_output_nid generation:  0.029059171676635742
local_in_edges_tensor generation:  0.03139019012451172
mini_batch_src_global generation:  0.05399894714355469
r_  generation:  0.43733811378479004
local_output_nid generation:  0.028725862503051758
local_in_edges_tensor generation:  0.028249502182006836
mini_batch_src_global generation:  0.05102896690368652
r_  generation:  0.4324769973754883
local_output_nid generation:  0.02951645851135254
local_in_edges_tensor generation:  0.040886640548706055
mini_batch_src_global generation:  0.05176973342895508
r_  generation:  0.43214988708496094
local_output_nid generation:  0.028369903564453125
local_in_edges_tensor generation:  0.032948970794677734
mini_batch_src_global generation:  0.06815814971923828
r_  generation:  0.44115400314331055
local_output_nid generation:  0.0313417911529541
local_in_edges_tensor generation:  0.036337852478027344
mini_batch_src_global generation:  0.05394315719604492
r_  generation:  0.43478894233703613
----------------------check_connections_block total spend ----------------------------- 20.57087469100952
generate_one_block  0.6706807613372803
generate_one_block  0.555506706237793
generate_one_block  0.569014310836792
generate_one_block  0.5601534843444824
generate_one_block  0.5787365436553955
generate_one_block  0.5492227077484131
generate_one_block  0.5543763637542725
generate_one_block  0.5524964332580566
generate_one_block  0.5731828212738037
generate_one_block  0.5478479862213135
generate_one_block  0.5578584671020508
generate_one_block  0.5668518543243408
generate_one_block  0.5652403831481934
generate_one_block  0.5575802326202393
generate_one_block  0.5451254844665527
generate_one_block  0.5452530384063721
generate_one_block  0.5462782382965088
generate_one_block  0.5516078472137451
generate_one_block  0.5538177490234375
generate_one_block  0.5458481311798096
generate_one_block  0.5618901252746582
generate_one_block  0.5595855712890625
generate_one_block  0.5565383434295654
generate_one_block  0.5613799095153809
generate_one_block  0.5636928081512451
generate_one_block  0.5420591831207275
generate_one_block  0.5450692176818848
generate_one_block  0.5617434978485107
generate_one_block  0.5535664558410645
generate_one_block  0.5530650615692139
generate_one_block  0.5461418628692627
generate_one_block  0.5549254417419434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  28.895755290985107
block generation total time  25.28829264640808
average batch blocks generation time:  0.7902591452002525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08529806137084961  GigaBytes
Max Memory Allocated: 0.08529806137084961  GigaBytes

torch.Size([148698, 128])
torch.Size([109543, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.15878057479858398  GigaBytes
Max Memory Allocated: 0.1605515480041504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08552980422973633  GigaBytes
Max Memory Allocated: 0.1763744354248047  GigaBytes

torch.Size([148423, 128])
torch.Size([109073, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15765619277954102  GigaBytes
Max Memory Allocated: 0.1763744354248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08730602264404297  GigaBytes
Max Memory Allocated: 0.1763744354248047  GigaBytes

torch.Size([149564, 128])
torch.Size([110958, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16243553161621094  GigaBytes
Max Memory Allocated: 0.1763744354248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08565139770507812  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148368, 128])
torch.Size([109206, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1579132080078125  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08579397201538086  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148789, 128])
torch.Size([109835, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15818119049072266  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08539628982543945  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148651, 128])
torch.Size([108909, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15719985961914062  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08570384979248047  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148848, 128])
torch.Size([109520, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1579265594482422  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08562326431274414  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148625, 128])
torch.Size([108883, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15767669677734375  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0859060287475586  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148490, 128])
torch.Size([110537, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15995502471923828  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08559513092041016  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148490, 128])
torch.Size([109393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15777349472045898  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08595895767211914  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149081, 128])
torch.Size([109675, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15831613540649414  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08611536026000977  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149151, 128])
torch.Size([110610, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16002750396728516  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08581066131591797  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148354, 128])
torch.Size([109890, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15859317779541016  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08616352081298828  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149180, 128])
torch.Size([110732, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16118621826171875  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08542394638061523  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148891, 128])
torch.Size([108468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15695476531982422  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08548307418823242  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148241, 128])
torch.Size([109109, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15757465362548828  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08556556701660156  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148552, 128])
torch.Size([109354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15774774551391602  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0855112075805664  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148718, 128])
torch.Size([109791, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1576371192932129  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08563852310180664  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148473, 128])
torch.Size([109322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15788745880126953  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0854802131652832  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148483, 128])
torch.Size([108975, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15742206573486328  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08566427230834961  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148927, 128])
torch.Size([109244, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15770864486694336  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08559608459472656  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148566, 128])
torch.Size([109464, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15776729583740234  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0858922004699707  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148785, 128])
torch.Size([110005, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15961170196533203  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08608675003051758  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149027, 128])
torch.Size([110523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1590123176574707  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08614730834960938  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149096, 128])
torch.Size([111011, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16123390197753906  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08553695678710938  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148488, 128])
torch.Size([109530, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15775203704833984  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0856328010559082  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148603, 128])
torch.Size([108856, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1576709747314453  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0859994888305664  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148852, 128])
torch.Size([110708, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16100788116455078  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08577919006347656  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148694, 128])
torch.Size([109847, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1594705581665039  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0858926773071289  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148856, 128])
torch.Size([110123, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15965938568115234  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08561563491821289  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148453, 128])
torch.Size([109303, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15783977508544922  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08598899841308594  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148918, 128])
torch.Size([110039, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15974664688110352  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02866823971271515 |0.021802745759487152 |0.02659585326910019 |9.324401617050171e-05 |0.004234276711940765 |0.0018291473388671875 |
----------------------------------------------------------pseudo_mini_loss sum 5.051564693450928
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9109793
Number of first layer input nodes during this epoch:  4759335
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.11687803268432617  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026330947875976562
range selection method range initialization spend 0.011593818664550781
time for parepare:  0.019992828369140625
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.00815439224243164
mini_batch_src_global generation:  0.001522064208984375
r_  generation:  0.009823322296142578
local_output_nid generation:  0.0008924007415771484
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.001455068588256836
r_  generation:  0.009882211685180664
local_output_nid generation:  0.0008523464202880859
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.0011165142059326172
r_  generation:  0.009333610534667969
local_output_nid generation:  0.0008864402770996094
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.009452342987060547
local_output_nid generation:  0.0008416175842285156
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0009312629699707031
r_  generation:  0.009557485580444336
local_output_nid generation:  0.0008397102355957031
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.001001596450805664
r_  generation:  0.009679079055786133
local_output_nid generation:  0.0008282661437988281
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.010069847106933594
local_output_nid generation:  0.0008242130279541016
local_in_edges_tensor generation:  0.0007226467132568359
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.009788036346435547
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0009913444519042969
r_  generation:  0.01024627685546875
local_output_nid generation:  0.0008401870727539062
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.001026153564453125
r_  generation:  0.010400772094726562
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0010724067687988281
r_  generation:  0.010127544403076172
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.0009779930114746094
r_  generation:  0.010094881057739258
local_output_nid generation:  0.0008447170257568359
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0010037422180175781
r_  generation:  0.010373353958129883
local_output_nid generation:  0.0008285045623779297
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0010170936584472656
r_  generation:  0.00995945930480957
local_output_nid generation:  0.0008637905120849609
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.009730339050292969
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0009729862213134766
r_  generation:  0.009794235229492188
local_output_nid generation:  0.0008194446563720703
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009716033935546875
local_output_nid generation:  0.0008392333984375
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0009930133819580078
r_  generation:  0.01013803482055664
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.0009753704071044922
r_  generation:  0.010376930236816406
local_output_nid generation:  0.0008301734924316406
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.010379552841186523
local_output_nid generation:  0.0008234977722167969
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0009899139404296875
r_  generation:  0.009989023208618164
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0005354881286621094
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.010592222213745117
local_output_nid generation:  0.0008499622344970703
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.010772228240966797
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0005898475646972656
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.010728836059570312
local_output_nid generation:  0.0008323192596435547
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.010167837142944336
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0010380744934082031
r_  generation:  0.010220050811767578
local_output_nid generation:  0.0008254051208496094
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.010585784912109375
local_output_nid generation:  0.0008063316345214844
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.010352373123168945
local_output_nid generation:  0.0008101463317871094
local_in_edges_tensor generation:  0.00051116943359375
mini_batch_src_global generation:  0.0010838508605957031
r_  generation:  0.010407209396362305
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009955406188964844
local_output_nid generation:  0.0007860660552978516
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.010156631469726562
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.01043391227722168
----------------------check_connections_block total spend ----------------------------- 0.507004976272583
generate_one_block  0.019208908081054688
generate_one_block  0.019158124923706055
generate_one_block  0.01839303970336914
generate_one_block  0.014848947525024414
generate_one_block  0.014792680740356445
generate_one_block  0.014668941497802734
generate_one_block  0.014597892761230469
generate_one_block  0.01478433609008789
generate_one_block  0.01517176628112793
generate_one_block  0.014995813369750977
generate_one_block  0.014724254608154297
generate_one_block  0.01519918441772461
generate_one_block  0.015090227127075195
generate_one_block  0.014558076858520508
generate_one_block  0.015846967697143555
generate_one_block  0.014298677444458008
generate_one_block  0.014611959457397461
generate_one_block  0.015030145645141602
generate_one_block  0.014579534530639648
generate_one_block  0.015516281127929688
generate_one_block  0.014826059341430664
generate_one_block  0.014880180358886719
generate_one_block  0.014949798583984375
generate_one_block  0.0157470703125
generate_one_block  0.015033960342407227
generate_one_block  0.014896869659423828
generate_one_block  0.015933752059936523
generate_one_block  0.017167329788208008
generate_one_block  0.015541553497314453
generate_one_block  0.014910697937011719
generate_one_block  0.014907360076904297
generate_one_block  0.015540361404418945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05687236785888672
gen group dst list time:  0.02195596694946289
time for parepare:  0.019176483154296875
local_output_nid generation:  0.004181861877441406
local_in_edges_tensor generation:  0.02059459686279297
mini_batch_src_global generation:  0.017656326293945312
r_  generation:  0.15787196159362793
local_output_nid generation:  0.00663447380065918
local_in_edges_tensor generation:  0.013414859771728516
mini_batch_src_global generation:  0.020117521286010742
r_  generation:  0.16659259796142578
local_output_nid generation:  0.006854534149169922
local_in_edges_tensor generation:  0.03307366371154785
mini_batch_src_global generation:  0.019266128540039062
r_  generation:  0.17225337028503418
local_output_nid generation:  0.007122516632080078
local_in_edges_tensor generation:  0.010818719863891602
mini_batch_src_global generation:  0.01978588104248047
r_  generation:  0.17131495475769043
local_output_nid generation:  0.007559776306152344
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.020759105682373047
r_  generation:  0.17229223251342773
local_output_nid generation:  0.007464170455932617
local_in_edges_tensor generation:  0.009870290756225586
mini_batch_src_global generation:  0.02374100685119629
r_  generation:  0.18108701705932617
local_output_nid generation:  0.007243156433105469
local_in_edges_tensor generation:  0.009747028350830078
mini_batch_src_global generation:  0.023015260696411133
r_  generation:  0.1794888973236084
local_output_nid generation:  0.00771021842956543
local_in_edges_tensor generation:  0.008466005325317383
mini_batch_src_global generation:  0.02174830436706543
r_  generation:  0.17753863334655762
local_output_nid generation:  0.00796365737915039
local_in_edges_tensor generation:  0.012039899826049805
mini_batch_src_global generation:  0.02390742301940918
r_  generation:  0.18709969520568848
local_output_nid generation:  0.008109569549560547
local_in_edges_tensor generation:  0.013572931289672852
mini_batch_src_global generation:  0.022444486618041992
r_  generation:  0.18177342414855957
local_output_nid generation:  0.007835626602172852
local_in_edges_tensor generation:  0.00864553451538086
mini_batch_src_global generation:  0.022260189056396484
r_  generation:  0.17677831649780273
local_output_nid generation:  0.008108139038085938
local_in_edges_tensor generation:  0.010185003280639648
mini_batch_src_global generation:  0.02383708953857422
r_  generation:  0.18089580535888672
local_output_nid generation:  0.008297920227050781
local_in_edges_tensor generation:  0.012125015258789062
mini_batch_src_global generation:  0.024339675903320312
r_  generation:  0.18382835388183594
local_output_nid generation:  0.012585639953613281
local_in_edges_tensor generation:  0.01462411880493164
mini_batch_src_global generation:  0.024680376052856445
r_  generation:  0.19265270233154297
local_output_nid generation:  0.009874820709228516
local_in_edges_tensor generation:  0.011039972305297852
mini_batch_src_global generation:  0.025311708450317383
r_  generation:  0.1742568016052246
local_output_nid generation:  0.008151531219482422
local_in_edges_tensor generation:  0.010588407516479492
mini_batch_src_global generation:  0.022731304168701172
r_  generation:  0.1769726276397705
local_output_nid generation:  0.008248567581176758
local_in_edges_tensor generation:  0.009782552719116211
mini_batch_src_global generation:  0.021843910217285156
r_  generation:  0.17514514923095703
local_output_nid generation:  0.008426666259765625
local_in_edges_tensor generation:  0.013424873352050781
mini_batch_src_global generation:  0.023162364959716797
r_  generation:  0.19239211082458496
local_output_nid generation:  0.008217096328735352
local_in_edges_tensor generation:  0.008652210235595703
mini_batch_src_global generation:  0.022742509841918945
r_  generation:  0.17936301231384277
local_output_nid generation:  0.00854349136352539
local_in_edges_tensor generation:  0.009968757629394531
mini_batch_src_global generation:  0.027835845947265625
r_  generation:  0.18923306465148926
local_output_nid generation:  0.007845640182495117
local_in_edges_tensor generation:  0.00897979736328125
mini_batch_src_global generation:  0.0249481201171875
r_  generation:  0.1894826889038086
local_output_nid generation:  0.008537769317626953
local_in_edges_tensor generation:  0.010740041732788086
mini_batch_src_global generation:  0.02441716194152832
r_  generation:  0.18137001991271973
local_output_nid generation:  0.008082389831542969
local_in_edges_tensor generation:  0.011899709701538086
mini_batch_src_global generation:  0.025033235549926758
r_  generation:  0.1832425594329834
local_output_nid generation:  0.008727312088012695
local_in_edges_tensor generation:  0.020272016525268555
mini_batch_src_global generation:  0.03306460380554199
r_  generation:  0.18936753273010254
local_output_nid generation:  0.009248495101928711
local_in_edges_tensor generation:  0.012077808380126953
mini_batch_src_global generation:  0.02488851547241211
r_  generation:  0.18671822547912598
local_output_nid generation:  0.007948160171508789
local_in_edges_tensor generation:  0.011038780212402344
mini_batch_src_global generation:  0.023424148559570312
r_  generation:  0.17939066886901855
local_output_nid generation:  0.00829315185546875
local_in_edges_tensor generation:  0.010764598846435547
mini_batch_src_global generation:  0.02530074119567871
r_  generation:  0.18809223175048828
local_output_nid generation:  0.00833439826965332
local_in_edges_tensor generation:  0.010348320007324219
mini_batch_src_global generation:  0.03971242904663086
r_  generation:  0.18471550941467285
local_output_nid generation:  0.008228302001953125
local_in_edges_tensor generation:  0.010349035263061523
mini_batch_src_global generation:  0.02852940559387207
r_  generation:  0.18605995178222656
local_output_nid generation:  0.008064031600952148
local_in_edges_tensor generation:  0.008893728256225586
mini_batch_src_global generation:  0.02315068244934082
r_  generation:  0.18050837516784668
local_output_nid generation:  0.008167028427124023
local_in_edges_tensor generation:  0.010360479354858398
mini_batch_src_global generation:  0.03686809539794922
r_  generation:  0.1835014820098877
local_output_nid generation:  0.008946895599365234
local_in_edges_tensor generation:  0.008890867233276367
mini_batch_src_global generation:  0.02559041976928711
r_  generation:  0.1812746524810791
----------------------check_connections_block total spend ----------------------------- 8.545572996139526
generate_one_block  0.24009084701538086
generate_one_block  0.22110867500305176
generate_one_block  0.22590231895446777
generate_one_block  0.2221977710723877
generate_one_block  0.23987174034118652
generate_one_block  0.22523283958435059
generate_one_block  0.22521352767944336
generate_one_block  0.2317667007446289
generate_one_block  0.23344945907592773
generate_one_block  0.2289292812347412
generate_one_block  0.21912860870361328
generate_one_block  0.23038196563720703
generate_one_block  0.2371656894683838
generate_one_block  0.22421646118164062
generate_one_block  0.21670913696289062
generate_one_block  0.2253735065460205
generate_one_block  0.22101759910583496
generate_one_block  0.234299898147583
generate_one_block  0.22197699546813965
generate_one_block  0.2776021957397461
generate_one_block  0.22107934951782227
generate_one_block  0.2316579818725586
generate_one_block  0.2326812744140625
generate_one_block  0.24476027488708496
generate_one_block  0.23304200172424316
generate_one_block  0.22530841827392578
generate_one_block  0.24410653114318848
generate_one_block  0.23270964622497559
generate_one_block  0.2325458526611328
generate_one_block  0.22516131401062012
generate_one_block  0.22569918632507324
generate_one_block  0.22738122940063477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06026172637939453
gen group dst list time:  0.11331439018249512
time for parepare:  0.019746065139770508
local_output_nid generation:  0.023179054260253906
local_in_edges_tensor generation:  0.06665682792663574
mini_batch_src_global generation:  0.03814363479614258
r_  generation:  0.41681838035583496
local_output_nid generation:  0.02877521514892578
local_in_edges_tensor generation:  0.043335676193237305
mini_batch_src_global generation:  0.06013202667236328
r_  generation:  0.4229867458343506
local_output_nid generation:  0.03057718276977539
local_in_edges_tensor generation:  0.03296661376953125
mini_batch_src_global generation:  0.04955935478210449
r_  generation:  0.4317350387573242
local_output_nid generation:  0.02857685089111328
local_in_edges_tensor generation:  0.03243398666381836
mini_batch_src_global generation:  0.04944205284118652
r_  generation:  0.4264650344848633
local_output_nid generation:  0.028670072555541992
local_in_edges_tensor generation:  0.03190279006958008
mini_batch_src_global generation:  0.05267977714538574
r_  generation:  0.43332695960998535
local_output_nid generation:  0.028319835662841797
local_in_edges_tensor generation:  0.028659820556640625
mini_batch_src_global generation:  0.05015158653259277
r_  generation:  0.4274411201477051
local_output_nid generation:  0.028337717056274414
local_in_edges_tensor generation:  0.028301477432250977
mini_batch_src_global generation:  0.053400278091430664
r_  generation:  0.43898630142211914
local_output_nid generation:  0.02862715721130371
local_in_edges_tensor generation:  0.03618812561035156
mini_batch_src_global generation:  0.05038738250732422
r_  generation:  0.43125128746032715
local_output_nid generation:  0.028722763061523438
local_in_edges_tensor generation:  0.04045987129211426
mini_batch_src_global generation:  0.05461001396179199
r_  generation:  0.4370992183685303
local_output_nid generation:  0.029280424118041992
local_in_edges_tensor generation:  0.03263235092163086
mini_batch_src_global generation:  0.05086970329284668
r_  generation:  0.437023401260376
local_output_nid generation:  0.02864551544189453
local_in_edges_tensor generation:  0.028836488723754883
mini_batch_src_global generation:  0.05027961730957031
r_  generation:  0.4354248046875
local_output_nid generation:  0.028696537017822266
local_in_edges_tensor generation:  0.032501220703125
mini_batch_src_global generation:  0.053314208984375
r_  generation:  0.4392108917236328
local_output_nid generation:  0.02882099151611328
local_in_edges_tensor generation:  0.03270888328552246
mini_batch_src_global generation:  0.05353713035583496
r_  generation:  0.4365811347961426
local_output_nid generation:  0.02886819839477539
local_in_edges_tensor generation:  0.028737783432006836
mini_batch_src_global generation:  0.05079936981201172
r_  generation:  0.4299428462982178
local_output_nid generation:  0.02856302261352539
local_in_edges_tensor generation:  0.028641223907470703
mini_batch_src_global generation:  0.04993152618408203
r_  generation:  0.4392573833465576
local_output_nid generation:  0.028514862060546875
local_in_edges_tensor generation:  0.035739898681640625
mini_batch_src_global generation:  0.05013728141784668
r_  generation:  0.4306173324584961
local_output_nid generation:  0.029001235961914062
local_in_edges_tensor generation:  0.03675127029418945
mini_batch_src_global generation:  0.04956173896789551
r_  generation:  0.43158411979675293
local_output_nid generation:  0.02894425392150879
local_in_edges_tensor generation:  0.03618955612182617
mini_batch_src_global generation:  0.05348348617553711
r_  generation:  0.43285536766052246
local_output_nid generation:  0.03279423713684082
local_in_edges_tensor generation:  0.032135009765625
mini_batch_src_global generation:  0.05050969123840332
r_  generation:  0.43642544746398926
local_output_nid generation:  0.02936387062072754
local_in_edges_tensor generation:  0.03460693359375
mini_batch_src_global generation:  0.050650835037231445
r_  generation:  0.4391968250274658
local_output_nid generation:  0.029000282287597656
local_in_edges_tensor generation:  0.02871870994567871
mini_batch_src_global generation:  0.04993486404418945
r_  generation:  0.4346504211425781
local_output_nid generation:  0.028992414474487305
local_in_edges_tensor generation:  0.03210115432739258
mini_batch_src_global generation:  0.05371570587158203
r_  generation:  0.44025111198425293
local_output_nid generation:  0.02908611297607422
local_in_edges_tensor generation:  0.03274130821228027
mini_batch_src_global generation:  0.05307626724243164
r_  generation:  0.43613600730895996
local_output_nid generation:  0.029385089874267578
local_in_edges_tensor generation:  0.03295016288757324
mini_batch_src_global generation:  0.05358624458312988
r_  generation:  0.43848156929016113
local_output_nid generation:  0.029250621795654297
local_in_edges_tensor generation:  0.032428741455078125
mini_batch_src_global generation:  0.049865007400512695
r_  generation:  0.4402580261230469
local_output_nid generation:  0.029298782348632812
local_in_edges_tensor generation:  0.03213095664978027
mini_batch_src_global generation:  0.05115461349487305
r_  generation:  0.43958568572998047
local_output_nid generation:  0.029322147369384766
local_in_edges_tensor generation:  0.0324251651763916
mini_batch_src_global generation:  0.05071377754211426
r_  generation:  0.4416663646697998
local_output_nid generation:  0.02974677085876465
local_in_edges_tensor generation:  0.04101300239562988
mini_batch_src_global generation:  0.051117658615112305
r_  generation:  0.44443440437316895
local_output_nid generation:  0.029659748077392578
local_in_edges_tensor generation:  0.03721809387207031
mini_batch_src_global generation:  0.05045747756958008
r_  generation:  0.4448235034942627
local_output_nid generation:  0.029177188873291016
local_in_edges_tensor generation:  0.02941131591796875
mini_batch_src_global generation:  0.05142354965209961
r_  generation:  0.44008374214172363
local_output_nid generation:  0.029468059539794922
local_in_edges_tensor generation:  0.029129743576049805
mini_batch_src_global generation:  0.05038809776306152
r_  generation:  0.4518239498138428
local_output_nid generation:  0.02956223487854004
local_in_edges_tensor generation:  0.03788161277770996
mini_batch_src_global generation:  0.05897927284240723
r_  generation:  0.43936634063720703
----------------------check_connections_block total spend ----------------------------- 20.72323775291443
generate_one_block  0.5559065341949463
generate_one_block  0.561103343963623
generate_one_block  0.5658383369445801
generate_one_block  0.5554349422454834
generate_one_block  0.671367883682251
generate_one_block  0.5523350238800049
generate_one_block  0.5564579963684082
generate_one_block  0.558696985244751
generate_one_block  0.5666069984436035
generate_one_block  0.6565277576446533
generate_one_block  0.5825939178466797
generate_one_block  0.5796079635620117
generate_one_block  0.5787885189056396
generate_one_block  0.5507791042327881
generate_one_block  0.5477266311645508
generate_one_block  0.5730829238891602
generate_one_block  0.5694854259490967
generate_one_block  0.5926852226257324
generate_one_block  0.5569615364074707
generate_one_block  0.569878339767456
generate_one_block  0.5736596584320068
generate_one_block  0.5646622180938721
generate_one_block  0.5700323581695557
generate_one_block  0.5752766132354736
generate_one_block  0.593524694442749
generate_one_block  0.5529530048370361
generate_one_block  0.5615706443786621
generate_one_block  0.5709030628204346
generate_one_block  0.5775527954101562
generate_one_block  0.5617642402648926
generate_one_block  0.5586748123168945
generate_one_block  0.5538597106933594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.11687803268432617  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

connection checking time:  29.268810749053955
block generation total time  25.69406747817993
average batch blocks generation time:  0.8029396086931229
block dataloader generation time/epoch 57.60311412811279
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08541011810302734  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148225, 128])
torch.Size([108535, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15722942352294922  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08541154861450195  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148219, 128])
torch.Size([108676, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15726804733276367  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0858297348022461  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148710, 128])
torch.Size([109673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1581249237060547  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08586645126342773  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149041, 128])
torch.Size([109735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15804243087768555  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08579349517822266  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148816, 128])
torch.Size([109495, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15798616409301758  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08572578430175781  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148656, 128])
torch.Size([108978, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15780258178710938  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08571672439575195  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148563, 128])
torch.Size([109020, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15778732299804688  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08598756790161133  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149183, 128])
torch.Size([109451, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1581416130065918  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08599615097045898  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148781, 128])
torch.Size([110005, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15973138809204102  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08615779876708984  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149218, 128])
torch.Size([110891, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1601877212524414  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.0858302116394043  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148971, 128])
torch.Size([109737, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15805435180664062  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08566808700561523  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148247, 128])
torch.Size([109292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15795087814331055  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08623123168945312  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([149120, 128])
torch.Size([110581, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16015100479125977  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08578014373779297  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148680, 128])
torch.Size([109347, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15793657302856445  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08534431457519531  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148300, 128])
torch.Size([108115, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15693378448486328  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08568811416625977  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148631, 128])
torch.Size([109104, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15770816802978516  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08575201034545898  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148967, 128])
torch.Size([109887, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15790843963623047  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08588266372680664  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148723, 128])
torch.Size([110081, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1596221923828125  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08580398559570312  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148682, 128])
torch.Size([109372, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15796947479248047  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08626127243041992  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

torch.Size([148915, 128])
torch.Size([110760, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16122722625732422  GigaBytes
Max Memory Allocated: 0.17830896377563477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08581924438476562  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([148896, 128])
torch.Size([109323, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1579456329345703  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08596658706665039  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([148887, 128])
torch.Size([109846, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15836191177368164  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08600807189941406  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([148920, 128])
torch.Size([109757, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15839529037475586  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08611249923706055  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([148845, 128])
torch.Size([110305, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1600809097290039  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08588266372680664  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([148515, 128])
torch.Size([109904, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15959405899047852  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08579206466674805  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([148605, 128])
torch.Size([109640, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15813207626342773  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08634662628173828  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([149222, 128])
torch.Size([110512, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1614084243774414  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08635377883911133  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([149327, 128])
torch.Size([110929, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.16144609451293945  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08625173568725586  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([149239, 128])
torch.Size([111409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1614818572998047  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08607816696166992  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([149155, 128])
torch.Size([110084, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1597747802734375  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08606386184692383  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([149095, 128])
torch.Size([110391, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.1598801612854004  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.08600282669067383  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

torch.Size([149023, 128])
torch.Size([109916, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5721435546875 GB
    Memory Allocated: 0.15970182418823242  GigaBytes
Max Memory Allocated: 0.17896795272827148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02523447573184967 |0.015236631035804749 |0.0034101679921150208 |9.059160947799683e-05 |0.00378262996673584 |0.0013713836669921875 |
----------------------------------------------------------pseudo_mini_loss sum 4.346972942352295
Total (block generation + training)time/epoch 59.17687463760376
Training time/epoch 1.573502540588379
Training time without block to device /epoch 1.085930347442627
Training time without total dataloading part /epoch 0.23443984985351562
load block tensor time/epoch 0.8075032234191895
block to device time/epoch 0.48757219314575195
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9114376
Number of first layer input nodes during this epoch:  4762377
