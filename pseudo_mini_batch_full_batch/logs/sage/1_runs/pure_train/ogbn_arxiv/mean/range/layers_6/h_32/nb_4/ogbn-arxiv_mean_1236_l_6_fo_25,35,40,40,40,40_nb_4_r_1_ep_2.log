Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648514494.1698878
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02709650993347168
range selection method range initialization spend 0.01619577407836914
time for parepare:  0.01781630516052246
local_output_nid generation:  0.005307197570800781
local_in_edges_tensor generation:  0.006104469299316406
mini_batch_src_global generation:  0.007542848587036133
r_  generation:  0.09364628791809082
local_output_nid generation:  0.006014823913574219
local_in_edges_tensor generation:  0.0030438899993896484
mini_batch_src_global generation:  0.008506298065185547
r_  generation:  0.08653116226196289
local_output_nid generation:  0.006041049957275391
local_in_edges_tensor generation:  0.0030269622802734375
mini_batch_src_global generation:  0.006436586380004883
r_  generation:  0.08938026428222656
local_output_nid generation:  0.0060520172119140625
local_in_edges_tensor generation:  0.0030794143676757812
mini_batch_src_global generation:  0.006763935089111328
r_  generation:  0.09061527252197266
----------------------check_connections_block total spend ----------------------------- 0.5157053470611572
generate_one_block  0.10137438774108887
generate_one_block  0.10112643241882324
generate_one_block  0.10439205169677734
generate_one_block  0.10153412818908691
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.041597604751586914
gen group dst list time:  0.011240243911743164
time for parepare:  0.019577980041503906
local_output_nid generation:  0.015341043472290039
local_in_edges_tensor generation:  0.03637981414794922
mini_batch_src_global generation:  0.04108786582946777
r_  generation:  0.40529561042785645
local_output_nid generation:  0.024988174438476562
local_in_edges_tensor generation:  0.035936594009399414
mini_batch_src_global generation:  0.0625302791595459
r_  generation:  0.41462016105651855
local_output_nid generation:  0.026160717010498047
local_in_edges_tensor generation:  0.03401470184326172
mini_batch_src_global generation:  0.0484158992767334
r_  generation:  0.43086957931518555
local_output_nid generation:  0.026357173919677734
local_in_edges_tensor generation:  0.026844501495361328
mini_batch_src_global generation:  0.06379818916320801
r_  generation:  0.42922258377075195
----------------------check_connections_block total spend ----------------------------- 2.4996447563171387
generate_one_block  0.5719203948974609
generate_one_block  0.5419487953186035
generate_one_block  0.5501587390899658
generate_one_block  0.5397300720214844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.035158634185791016
gen group dst list time:  0.0212554931640625
time for parepare:  0.019695758819580078
local_output_nid generation:  0.025124311447143555
local_in_edges_tensor generation:  0.04741978645324707
mini_batch_src_global generation:  0.054383277893066406
r_  generation:  0.5746045112609863
local_output_nid generation:  0.03634023666381836
local_in_edges_tensor generation:  0.052375078201293945
mini_batch_src_global generation:  0.07197809219360352
r_  generation:  0.615297794342041
local_output_nid generation:  0.03833317756652832
local_in_edges_tensor generation:  0.04894065856933594
mini_batch_src_global generation:  0.060685157775878906
r_  generation:  0.5755178928375244
local_output_nid generation:  0.03800153732299805
local_in_edges_tensor generation:  0.038169145584106445
mini_batch_src_global generation:  0.06643486022949219
r_  generation:  0.5866835117340088
----------------------check_connections_block total spend ----------------------------- 3.4393913745880127
generate_one_block  0.737858772277832
generate_one_block  0.7580888271331787
generate_one_block  0.7703497409820557
generate_one_block  0.6987495422363281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0386049747467041
gen group dst list time:  0.025593042373657227
time for parepare:  0.019016504287719727
local_output_nid generation:  0.027773380279541016
local_in_edges_tensor generation:  0.04436469078063965
mini_batch_src_global generation:  0.05219459533691406
r_  generation:  0.5951359272003174
local_output_nid generation:  0.035356998443603516
local_in_edges_tensor generation:  0.055710792541503906
mini_batch_src_global generation:  0.06620073318481445
r_  generation:  0.6108829975128174
local_output_nid generation:  0.035283565521240234
local_in_edges_tensor generation:  0.04543781280517578
mini_batch_src_global generation:  0.06436562538146973
r_  generation:  0.5669631958007812
local_output_nid generation:  0.0359797477722168
local_in_edges_tensor generation:  0.04108285903930664
mini_batch_src_global generation:  0.06432294845581055
r_  generation:  0.5652153491973877
----------------------check_connections_block total spend ----------------------------- 3.432957887649536
generate_one_block  0.7037754058837891
generate_one_block  0.7233247756958008
generate_one_block  0.7140719890594482
generate_one_block  0.7147419452667236
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02938556671142578
gen group dst list time:  0.024323463439941406
time for parepare:  0.019013404846191406
local_output_nid generation:  0.0280609130859375
local_in_edges_tensor generation:  0.03871273994445801
mini_batch_src_global generation:  0.04944205284118652
r_  generation:  0.5404050350189209
local_output_nid generation:  0.03513789176940918
local_in_edges_tensor generation:  0.03547406196594238
mini_batch_src_global generation:  0.06275486946105957
r_  generation:  0.5532784461975098
local_output_nid generation:  0.03614401817321777
local_in_edges_tensor generation:  0.03575897216796875
mini_batch_src_global generation:  0.06388330459594727
r_  generation:  0.5564403533935547
local_output_nid generation:  0.037285804748535156
local_in_edges_tensor generation:  0.03734731674194336
mini_batch_src_global generation:  0.06330633163452148
r_  generation:  0.5582194328308105
----------------------check_connections_block total spend ----------------------------- 3.2518720626831055
generate_one_block  0.7023589611053467
generate_one_block  0.7292649745941162
generate_one_block  0.7444479465484619
generate_one_block  0.7563908100128174
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04981589317321777
gen group dst list time:  0.026682138442993164
time for parepare:  0.020194292068481445
local_output_nid generation:  0.03113555908203125
local_in_edges_tensor generation:  0.04123425483703613
mini_batch_src_global generation:  0.047426700592041016
r_  generation:  0.5181362628936768
local_output_nid generation:  0.03607463836669922
local_in_edges_tensor generation:  0.04968070983886719
mini_batch_src_global generation:  0.07029104232788086
r_  generation:  0.5203568935394287
local_output_nid generation:  0.03665351867675781
local_in_edges_tensor generation:  0.03764772415161133
mini_batch_src_global generation:  0.05892777442932129
r_  generation:  0.5241861343383789
local_output_nid generation:  0.037194013595581055
local_in_edges_tensor generation:  0.03756904602050781
mini_batch_src_global generation:  0.06281423568725586
r_  generation:  0.5297129154205322
----------------------check_connections_block total spend ----------------------------- 3.14017653465271
generate_one_block  0.6438388824462891
generate_one_block  0.6907832622528076
generate_one_block  0.6368489265441895
generate_one_block  0.6558985710144043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  15.764042615890503
block generation total time  13.584551334381104
average batch blocks generation time:  3.396137833595276
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.14231014251708984  GigaBytes
Max Memory Allocated: 0.14231014251708984  GigaBytes

torch.Size([167789, 128])
torch.Size([167547, 32])
torch.Size([166915, 32])
torch.Size([164880, 32])
torch.Size([155133, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.5829367637634277  GigaBytes
Max Memory Allocated: 0.5870599746704102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14783573150634766  GigaBytes
Max Memory Allocated: 0.6029272079467773  GigaBytes

torch.Size([167830, 128])
torch.Size([167590, 32])
torch.Size([166957, 32])
torch.Size([164852, 32])
torch.Size([154997, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5861039161682129  GigaBytes
Max Memory Allocated: 0.6029272079467773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14820432662963867  GigaBytes
Max Memory Allocated: 0.6049513816833496  GigaBytes

torch.Size([167812, 128])
torch.Size([167561, 32])
torch.Size([166922, 32])
torch.Size([164886, 32])
torch.Size([155206, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5871882438659668  GigaBytes
Max Memory Allocated: 0.6049513816833496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.1480884552001953  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

torch.Size([167807, 128])
torch.Size([167581, 32])
torch.Size([166983, 32])
torch.Size([164879, 32])
torch.Size([154926, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5859346389770508  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05387723445892334 |0.14306777715682983 |0.18053066730499268 |0.00011670589447021484 |0.04227948188781738 |0.006884574890136719 |
----------------------------------------------------------pseudo_mini_loss sum 5.289116859436035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3694874
Number of first layer input nodes during this epoch:  671238
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.28026628494262695  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.04049992561340332
range selection method range initialization spend 0.011393070220947266
time for parepare:  0.01681208610534668
local_output_nid generation:  0.005221366882324219
local_in_edges_tensor generation:  0.00980520248413086
mini_batch_src_global generation:  0.006540060043334961
r_  generation:  0.08108234405517578
local_output_nid generation:  0.0060384273529052734
local_in_edges_tensor generation:  0.0031812191009521484
mini_batch_src_global generation:  0.012111425399780273
r_  generation:  0.08921098709106445
local_output_nid generation:  0.006132841110229492
local_in_edges_tensor generation:  0.003093242645263672
mini_batch_src_global generation:  0.006501436233520508
r_  generation:  0.08969402313232422
local_output_nid generation:  0.006171703338623047
local_in_edges_tensor generation:  0.0032634735107421875
mini_batch_src_global generation:  0.0069315433502197266
r_  generation:  0.09223818778991699
----------------------check_connections_block total spend ----------------------------- 0.5157449245452881
generate_one_block  0.10221648216247559
generate_one_block  0.10424447059631348
generate_one_block  0.10450053215026855
generate_one_block  0.10366082191467285
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04107999801635742
gen group dst list time:  0.010989189147949219
time for parepare:  0.0191342830657959
local_output_nid generation:  0.01445770263671875
local_in_edges_tensor generation:  0.03925514221191406
mini_batch_src_global generation:  0.03895163536071777
r_  generation:  0.41790270805358887
local_output_nid generation:  0.0227510929107666
local_in_edges_tensor generation:  0.03963327407836914
mini_batch_src_global generation:  0.049193382263183594
r_  generation:  0.4235696792602539
local_output_nid generation:  0.022645235061645508
local_in_edges_tensor generation:  0.02803802490234375
mini_batch_src_global generation:  0.0489192008972168
r_  generation:  0.431321382522583
local_output_nid generation:  0.022652387619018555
local_in_edges_tensor generation:  0.030324697494506836
mini_batch_src_global generation:  0.04981517791748047
r_  generation:  0.42985033988952637
----------------------check_connections_block total spend ----------------------------- 2.4908297061920166
generate_one_block  0.5581676959991455
generate_one_block  0.5559554100036621
generate_one_block  0.5795450210571289
generate_one_block  0.5732903480529785
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04966092109680176
gen group dst list time:  0.025325536727905273
time for parepare:  0.01883077621459961
local_output_nid generation:  0.02559185028076172
local_in_edges_tensor generation:  0.05998635292053223
mini_batch_src_global generation:  0.055004119873046875
r_  generation:  0.5577390193939209
local_output_nid generation:  0.03341412544250488
local_in_edges_tensor generation:  0.05350661277770996
mini_batch_src_global generation:  0.06300544738769531
r_  generation:  0.5708930492401123
local_output_nid generation:  0.034060001373291016
local_in_edges_tensor generation:  0.04910397529602051
mini_batch_src_global generation:  0.057318925857543945
r_  generation:  0.573606014251709
local_output_nid generation:  0.03429412841796875
local_in_edges_tensor generation:  0.034906864166259766
mini_batch_src_global generation:  0.06062507629394531
r_  generation:  0.5728044509887695
----------------------check_connections_block total spend ----------------------------- 3.331382989883423
generate_one_block  0.7278695106506348
generate_one_block  0.7339057922363281
generate_one_block  0.7097241878509521
generate_one_block  0.6984634399414062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.07634496688842773
gen group dst list time:  0.030650615692138672
time for parepare:  0.01933002471923828
local_output_nid generation:  0.030488252639770508
local_in_edges_tensor generation:  0.058161020278930664
mini_batch_src_global generation:  0.05500388145446777
r_  generation:  0.5588033199310303
local_output_nid generation:  0.03592944145202637
local_in_edges_tensor generation:  0.05422377586364746
mini_batch_src_global generation:  0.0637056827545166
r_  generation:  0.5702464580535889
local_output_nid generation:  0.035799264907836914
local_in_edges_tensor generation:  0.04084205627441406
mini_batch_src_global generation:  0.06870102882385254
r_  generation:  0.5703678131103516
local_output_nid generation:  0.03609967231750488
local_in_edges_tensor generation:  0.040497779846191406
mini_batch_src_global generation:  0.06299328804016113
r_  generation:  0.5807433128356934
----------------------check_connections_block total spend ----------------------------- 3.3969218730926514
generate_one_block  0.7346756458282471
generate_one_block  0.7245612144470215
generate_one_block  0.7159960269927979
generate_one_block  0.7389037609100342
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04868459701538086
gen group dst list time:  0.025426626205444336
time for parepare:  0.019550323486328125
local_output_nid generation:  0.03463292121887207
local_in_edges_tensor generation:  0.053589820861816406
mini_batch_src_global generation:  0.05312514305114746
r_  generation:  0.5515527725219727
local_output_nid generation:  0.03789043426513672
local_in_edges_tensor generation:  0.039751529693603516
mini_batch_src_global generation:  0.0628962516784668
r_  generation:  0.5560331344604492
local_output_nid generation:  0.038344383239746094
local_in_edges_tensor generation:  0.03836870193481445
mini_batch_src_global generation:  0.06409192085266113
r_  generation:  0.5603876113891602
local_output_nid generation:  0.038176536560058594
local_in_edges_tensor generation:  0.04562520980834961
mini_batch_src_global generation:  0.06262087821960449
r_  generation:  0.5554013252258301
----------------------check_connections_block total spend ----------------------------- 3.315675973892212
generate_one_block  0.6936056613922119
generate_one_block  0.700728178024292
generate_one_block  0.6997835636138916
generate_one_block  0.728398323059082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03549385070800781
gen group dst list time:  0.02453017234802246
time for parepare:  0.01928997039794922
local_output_nid generation:  0.029119014739990234
local_in_edges_tensor generation:  0.04057168960571289
mini_batch_src_global generation:  0.04515719413757324
r_  generation:  0.5153257846832275
local_output_nid generation:  0.03715872764587402
local_in_edges_tensor generation:  0.045661211013793945
mini_batch_src_global generation:  0.057871103286743164
r_  generation:  0.5215888023376465
local_output_nid generation:  0.03614640235900879
local_in_edges_tensor generation:  0.0371861457824707
mini_batch_src_global generation:  0.062082767486572266
r_  generation:  0.5180449485778809
local_output_nid generation:  0.03615403175354004
local_in_edges_tensor generation:  0.04766368865966797
mini_batch_src_global generation:  0.05820584297180176
r_  generation:  0.5259072780609131
----------------------check_connections_block total spend ----------------------------- 3.1087443828582764
generate_one_block  0.6354367733001709
generate_one_block  0.6375763416290283
generate_one_block  0.6544716358184814
generate_one_block  0.6817522048950195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.28026628494262695  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

connection checking time:  15.643554925918579
block generation total time  13.482810735702515
average batch blocks generation time:  3.3707026839256287
block dataloader generation time/epoch 31.746826648712158
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.1484088897705078  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

torch.Size([167743, 128])
torch.Size([167510, 32])
torch.Size([166900, 32])
torch.Size([164896, 32])
torch.Size([155019, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5863409042358398  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14833784103393555  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

torch.Size([167746, 128])
torch.Size([167519, 32])
torch.Size([166874, 32])
torch.Size([164787, 32])
torch.Size([154968, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5862689018249512  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14830875396728516  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

torch.Size([167769, 128])
torch.Size([167542, 32])
torch.Size([166912, 32])
torch.Size([164845, 32])
torch.Size([155099, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5862927436828613  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.14829158782958984  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

torch.Size([167746, 128])
torch.Size([167524, 32])
torch.Size([166889, 32])
torch.Size([164803, 32])
torch.Size([154889, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.585721492767334  GigaBytes
Max Memory Allocated: 0.6073589324951172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0760917067527771 |0.052197396755218506 |0.006702721118927002 |9.906291961669922e-05 |0.00778353214263916 |0.0026187896728515625 |
----------------------------------------------------------pseudo_mini_loss sum 4.753101348876953
Total (block generation + training)time/epoch 32.38261795043945
Training time/epoch 0.6354494094848633
Training time without block to device /epoch 0.42665982246398926
Training time without total dataloading part /epoch 0.06096005439758301
load block tensor time/epoch 0.3043668270111084
block to device time/epoch 0.20878958702087402
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3693790
Number of first layer input nodes during this epoch:  671004
