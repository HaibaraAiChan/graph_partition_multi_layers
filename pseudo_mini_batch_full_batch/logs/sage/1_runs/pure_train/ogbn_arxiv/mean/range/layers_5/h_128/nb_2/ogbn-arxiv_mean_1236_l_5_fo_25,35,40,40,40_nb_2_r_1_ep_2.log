Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648498258.393179
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024957895278930664
range selection method range initialization spend 0.013432502746582031
time for parepare:  0.017640352249145508
local_output_nid generation:  0.010721206665039062
local_in_edges_tensor generation:  0.009370565414428711
mini_batch_src_global generation:  0.013961076736450195
r_  generation:  0.17101073265075684
local_output_nid generation:  0.01244211196899414
local_in_edges_tensor generation:  0.01083517074584961
mini_batch_src_global generation:  0.017583847045898438
r_  generation:  0.18105673789978027
----------------------check_connections_block total spend ----------------------------- 0.5133609771728516
generate_one_block  0.19983696937561035
generate_one_block  0.20063233375549316
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04217648506164551
gen group dst list time:  0.007367610931396484
time for parepare:  0.020015239715576172
local_output_nid generation:  0.017633438110351562
local_in_edges_tensor generation:  0.04273676872253418
mini_batch_src_global generation:  0.04587411880493164
r_  generation:  0.5097153186798096
local_output_nid generation:  0.02716827392578125
local_in_edges_tensor generation:  0.04958748817443848
mini_batch_src_global generation:  0.05685687065124512
r_  generation:  0.5317394733428955
----------------------check_connections_block total spend ----------------------------- 1.524461269378662
generate_one_block  0.7012064456939697
generate_one_block  0.6597959995269775
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.058672189712524414
gen group dst list time:  0.013968944549560547
time for parepare:  0.02022385597229004
local_output_nid generation:  0.02247309684753418
local_in_edges_tensor generation:  0.05476641654968262
mini_batch_src_global generation:  0.05024456977844238
r_  generation:  0.5600407123565674
local_output_nid generation:  0.03132367134094238
local_in_edges_tensor generation:  0.05047345161437988
mini_batch_src_global generation:  0.06352424621582031
r_  generation:  0.576284646987915
----------------------check_connections_block total spend ----------------------------- 1.6744177341461182
generate_one_block  0.8149173259735107
generate_one_block  0.7406599521636963
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03478574752807617
gen group dst list time:  0.013197898864746094
time for parepare:  0.021526575088500977
local_output_nid generation:  0.024845600128173828
local_in_edges_tensor generation:  0.07838988304138184
mini_batch_src_global generation:  0.054229021072387695
r_  generation:  0.5705749988555908
local_output_nid generation:  0.03408002853393555
local_in_edges_tensor generation:  0.05547809600830078
mini_batch_src_global generation:  0.06317901611328125
r_  generation:  0.5755515098571777
----------------------check_connections_block total spend ----------------------------- 1.7423524856567383
generate_one_block  0.7550878524780273
generate_one_block  0.7235805988311768
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.10231208801269531
gen group dst list time:  0.015441656112670898
time for parepare:  0.01892852783203125
local_output_nid generation:  0.024489164352416992
local_in_edges_tensor generation:  0.04437851905822754
mini_batch_src_global generation:  0.046419620513916016
r_  generation:  0.5190095901489258
local_output_nid generation:  0.03282022476196289
local_in_edges_tensor generation:  0.03832364082336426
mini_batch_src_global generation:  0.057486772537231445
r_  generation:  0.5483064651489258
----------------------check_connections_block total spend ----------------------------- 1.5724866390228271
generate_one_block  0.6865816116333008
generate_one_block  0.6646416187286377
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  6.513718128204346
block generation total time  5.746471405029297
average batch blocks generation time:  2.8732357025146484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13352441787719727  GigaBytes
Max Memory Allocated: 0.13352441787719727  GigaBytes

torch.Size([167892, 128])
torch.Size([167627, 128])
torch.Size([166849, 128])
torch.Size([162969, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9412841796875 GB
    Memory Allocated: 1.4909915924072266  GigaBytes
Max Memory Allocated: 1.5376076698303223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 0.14144515991210938  GigaBytes
Max Memory Allocated: 1.61647367477417  GigaBytes

torch.Size([167859, 128])
torch.Size([167572, 128])
torch.Size([166766, 128])
torch.Size([162852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.4926056861877441  GigaBytes
Max Memory Allocated: 1.61647367477417  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054929494857788086 |0.21301782131195068 |0.3679220676422119 |0.0001474618911743164 |0.05034339427947998 |0.002910614013671875 |
----------------------------------------------------------pseudo_mini_loss sum 5.497151851654053
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1599425
Number of first layer input nodes during this epoch:  335751
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.2432408332824707  GigaBytes
Max Memory Allocated: 1.6183805465698242  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.019667625427246094
range selection method range initialization spend 0.012804269790649414
time for parepare:  0.017106056213378906
local_output_nid generation:  0.010298728942871094
local_in_edges_tensor generation:  0.012105703353881836
mini_batch_src_global generation:  0.01336669921875
r_  generation:  0.1682453155517578
local_output_nid generation:  0.011714458465576172
local_in_edges_tensor generation:  0.010579109191894531
mini_batch_src_global generation:  0.016936063766479492
r_  generation:  0.17830491065979004
----------------------check_connections_block total spend ----------------------------- 0.5071079730987549
generate_one_block  0.20147085189819336
generate_one_block  0.20914411544799805
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04038214683532715
gen group dst list time:  0.007183551788330078
time for parepare:  0.019243240356445312
local_output_nid generation:  0.017278194427490234
local_in_edges_tensor generation:  0.04150199890136719
mini_batch_src_global generation:  0.04683041572570801
r_  generation:  0.504713773727417
local_output_nid generation:  0.025413990020751953
local_in_edges_tensor generation:  0.04517841339111328
mini_batch_src_global generation:  0.05687117576599121
r_  generation:  0.542543888092041
----------------------check_connections_block total spend ----------------------------- 1.5270628929138184
generate_one_block  0.6541597843170166
generate_one_block  0.6593899726867676
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.047209978103637695
gen group dst list time:  0.013633012771606445
time for parepare:  0.018642663955688477
local_output_nid generation:  0.02143692970275879
local_in_edges_tensor generation:  0.05432295799255371
mini_batch_src_global generation:  0.051204681396484375
r_  generation:  0.560443639755249
local_output_nid generation:  0.03128504753112793
local_in_edges_tensor generation:  0.05213451385498047
mini_batch_src_global generation:  0.06330347061157227
r_  generation:  0.5729072093963623
----------------------check_connections_block total spend ----------------------------- 1.674344778060913
generate_one_block  0.7528800964355469
generate_one_block  0.7469573020935059
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05201244354248047
gen group dst list time:  0.015073537826538086
time for parepare:  0.018913745880126953
local_output_nid generation:  0.02419257164001465
local_in_edges_tensor generation:  0.046752214431762695
mini_batch_src_global generation:  0.050641775131225586
r_  generation:  0.545647144317627
local_output_nid generation:  0.03210902214050293
local_in_edges_tensor generation:  0.051961421966552734
mini_batch_src_global generation:  0.06215333938598633
r_  generation:  0.5591003894805908
----------------------check_connections_block total spend ----------------------------- 1.6385586261749268
generate_one_block  0.71602463722229
generate_one_block  0.7382094860076904
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04305911064147949
gen group dst list time:  0.014024019241333008
time for parepare:  0.020831823348999023
local_output_nid generation:  0.024335861206054688
local_in_edges_tensor generation:  0.050698041915893555
mini_batch_src_global generation:  0.04808926582336426
r_  generation:  0.5142343044281006
local_output_nid generation:  0.03459787368774414
local_in_edges_tensor generation:  0.0383296012878418
mini_batch_src_global generation:  0.05741119384765625
r_  generation:  0.5190684795379639
----------------------check_connections_block total spend ----------------------------- 1.5510058403015137
generate_one_block  0.632732629776001
generate_one_block  0.6486601829528809
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.2432408332824707  GigaBytes
Max Memory Allocated: 1.6183805465698242  GigaBytes

connection checking time:  6.390972137451172
block generation total time  5.549014091491699
average batch blocks generation time:  2.7745070457458496
block dataloader generation time/epoch 14.076268196105957
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.1427454948425293  GigaBytes
Max Memory Allocated: 1.6183805465698242  GigaBytes

torch.Size([167784, 128])
torch.Size([167519, 128])
torch.Size([166670, 128])
torch.Size([162704, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.4946441650390625  GigaBytes
Max Memory Allocated: 1.6183805465698242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 0.14287614822387695  GigaBytes
Max Memory Allocated: 1.620560646057129  GigaBytes

torch.Size([167830, 128])
torch.Size([167583, 128])
torch.Size([166823, 128])
torch.Size([162946, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2674560546875 GB
    Memory Allocated: 1.4943795204162598  GigaBytes
Max Memory Allocated: 1.620560646057129  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07977724075317383 |0.0465850830078125 |0.006106734275817871 |0.00010943412780761719 |0.006235241889953613 |0.0025997161865234375 |
----------------------------------------------------------pseudo_mini_loss sum 3.8665637969970703
Total (block generation + training)time/epoch 14.453499794006348
Training time/epoch 0.3769669532775879
Training time without block to device /epoch 0.2837967872619629
Training time without total dataloading part /epoch 0.02750253677368164
load block tensor time/epoch 0.15955448150634766
block to device time/epoch 0.093170166015625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1598675
Number of first layer input nodes during this epoch:  335614
