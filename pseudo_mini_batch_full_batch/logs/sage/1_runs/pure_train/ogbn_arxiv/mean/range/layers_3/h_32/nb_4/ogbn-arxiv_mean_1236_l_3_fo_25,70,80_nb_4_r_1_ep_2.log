Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648446398.2483153
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027123212814331055
range selection method range initialization spend 0.013146162033081055
time for parepare:  0.01780390739440918
local_output_nid generation:  0.0052568912506103516
local_in_edges_tensor generation:  0.0063648223876953125
mini_batch_src_global generation:  0.007277011871337891
r_  generation:  0.08993220329284668
local_output_nid generation:  0.0059735774993896484
local_in_edges_tensor generation:  0.0031156539916992188
mini_batch_src_global generation:  0.009349346160888672
r_  generation:  0.09736013412475586
local_output_nid generation:  0.006075143814086914
local_in_edges_tensor generation:  0.0032606124877929688
mini_batch_src_global generation:  0.007282257080078125
r_  generation:  0.0993506908416748
local_output_nid generation:  0.006203889846801758
local_in_edges_tensor generation:  0.0032300949096679688
mini_batch_src_global generation:  0.008203268051147461
r_  generation:  0.1027364730834961
----------------------check_connections_block total spend ----------------------------- 0.5550763607025146
generate_one_block  0.11499714851379395
generate_one_block  0.11539196968078613
generate_one_block  0.11479640007019043
generate_one_block  0.1165761947631836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.046669721603393555
gen group dst list time:  0.01186680793762207
time for parepare:  0.018729209899902344
local_output_nid generation:  0.014844417572021484
local_in_edges_tensor generation:  0.039649009704589844
mini_batch_src_global generation:  0.04785871505737305
r_  generation:  0.4634265899658203
local_output_nid generation:  0.022046566009521484
local_in_edges_tensor generation:  0.04340982437133789
mini_batch_src_global generation:  0.05926632881164551
r_  generation:  0.475292444229126
local_output_nid generation:  0.023129940032958984
local_in_edges_tensor generation:  0.03167438507080078
mini_batch_src_global generation:  0.05580568313598633
r_  generation:  0.47733545303344727
local_output_nid generation:  0.023376941680908203
local_in_edges_tensor generation:  0.031658172607421875
mini_batch_src_global generation:  0.057439327239990234
r_  generation:  0.4817042350769043
----------------------check_connections_block total spend ----------------------------- 2.770097494125366
generate_one_block  0.6507084369659424
generate_one_block  0.6434986591339111
generate_one_block  0.6208939552307129
generate_one_block  0.6281111240386963
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03271770477294922
gen group dst list time:  0.0209197998046875
time for parepare:  0.0189058780670166
local_output_nid generation:  0.024387359619140625
local_in_edges_tensor generation:  0.03614377975463867
mini_batch_src_global generation:  0.04490089416503906
r_  generation:  0.5051119327545166
local_output_nid generation:  0.03314852714538574
local_in_edges_tensor generation:  0.0457763671875
mini_batch_src_global generation:  0.056699514389038086
r_  generation:  0.5089457035064697
local_output_nid generation:  0.03383517265319824
local_in_edges_tensor generation:  0.04253673553466797
mini_batch_src_global generation:  0.0567164421081543
r_  generation:  0.5409069061279297
local_output_nid generation:  0.03415870666503906
local_in_edges_tensor generation:  0.04285311698913574
mini_batch_src_global generation:  0.057791948318481445
r_  generation:  0.5149714946746826
----------------------check_connections_block total spend ----------------------------- 3.0520269870758057
generate_one_block  0.6329550743103027
generate_one_block  0.6482076644897461
generate_one_block  0.6424098014831543
generate_one_block  0.642479419708252
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  5.822124481201172
block generation total time  5.109264135360718
average batch blocks generation time:  1.2773160338401794
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10412836074829102  GigaBytes
Max Memory Allocated: 0.10412836074829102  GigaBytes

torch.Size([165539, 128])
torch.Size([157593, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.26035213470458984  GigaBytes
Max Memory Allocated: 0.26388120651245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10781335830688477  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165502, 128])
torch.Size([157420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.26149606704711914  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1078028678894043  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165492, 128])
torch.Size([157360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2604060173034668  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1078329086303711  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165467, 128])
torch.Size([157290, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.25986433029174805  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035673439502716064 |0.0845482349395752 |0.1874690055847168 |0.00012046098709106445 |0.010199368000030518 |0.0039365291595458984 |
----------------------------------------------------------pseudo_mini_loss sum 4.9984283447265625
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1721166
Number of first layer input nodes during this epoch:  662000
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1617298126220703  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021129369735717773
range selection method range initialization spend 0.014972686767578125
time for parepare:  0.018738985061645508
local_output_nid generation:  0.005236387252807617
local_in_edges_tensor generation:  0.006392717361450195
mini_batch_src_global generation:  0.008464813232421875
r_  generation:  0.09105706214904785
local_output_nid generation:  0.006673574447631836
local_in_edges_tensor generation:  0.0038475990295410156
mini_batch_src_global generation:  0.010600805282592773
r_  generation:  0.09945559501647949
local_output_nid generation:  0.00698542594909668
local_in_edges_tensor generation:  0.003412961959838867
mini_batch_src_global generation:  0.008438587188720703
r_  generation:  0.1046903133392334
local_output_nid generation:  0.0069599151611328125
local_in_edges_tensor generation:  0.0033462047576904297
mini_batch_src_global generation:  0.00969243049621582
r_  generation:  0.10747289657592773
----------------------check_connections_block total spend ----------------------------- 0.5803494453430176
generate_one_block  0.11887478828430176
generate_one_block  0.12165045738220215
generate_one_block  0.12307310104370117
generate_one_block  0.1229393482208252
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04914069175720215
gen group dst list time:  0.013499736785888672
time for parepare:  0.02137613296508789
local_output_nid generation:  0.015413761138916016
local_in_edges_tensor generation:  0.038312673568725586
mini_batch_src_global generation:  0.04804825782775879
r_  generation:  0.48739147186279297
local_output_nid generation:  0.02930283546447754
local_in_edges_tensor generation:  0.048430442810058594
mini_batch_src_global generation:  0.07587599754333496
r_  generation:  0.48525047302246094
local_output_nid generation:  0.02555227279663086
local_in_edges_tensor generation:  0.04850339889526367
mini_batch_src_global generation:  0.0570218563079834
r_  generation:  0.4870738983154297
local_output_nid generation:  0.025689125061035156
local_in_edges_tensor generation:  0.03021979331970215
mini_batch_src_global generation:  0.06081414222717285
r_  generation:  0.4930245876312256
----------------------check_connections_block total spend ----------------------------- 2.9104630947113037
generate_one_block  0.6498875617980957
generate_one_block  0.6527347564697266
generate_one_block  0.6811344623565674
generate_one_block  0.6597907543182373
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036698102951049805
gen group dst list time:  0.027853012084960938
time for parepare:  0.020692825317382812
local_output_nid generation:  0.026431560516357422
local_in_edges_tensor generation:  0.05226922035217285
mini_batch_src_global generation:  0.06924295425415039
r_  generation:  0.49982237815856934
local_output_nid generation:  0.033983707427978516
local_in_edges_tensor generation:  0.04694867134094238
mini_batch_src_global generation:  0.056963443756103516
r_  generation:  0.524500846862793
local_output_nid generation:  0.034422874450683594
local_in_edges_tensor generation:  0.04115748405456543
mini_batch_src_global generation:  0.05679655075073242
r_  generation:  0.5119006633758545
local_output_nid generation:  0.03502297401428223
local_in_edges_tensor generation:  0.041132211685180664
mini_batch_src_global generation:  0.055858612060546875
r_  generation:  0.5194079875946045
----------------------check_connections_block total spend ----------------------------- 3.0873050689697266
generate_one_block  0.6661407947540283
generate_one_block  0.6454238891601562
generate_one_block  0.6382818222045898
generate_one_block  0.6435225009918213
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1617298126220703  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

connection checking time:  5.99776816368103
block generation total time  5.236916542053223
average batch blocks generation time:  1.3092291355133057
block dataloader generation time/epoch 13.230337619781494
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1078190803527832  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165527, 128])
torch.Size([157498, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2595548629760742  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10791349411010742  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165489, 128])
torch.Size([157410, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.25978851318359375  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.10795164108276367  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165530, 128])
torch.Size([157406, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.25997066497802734  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.1079111099243164  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

torch.Size([165493, 128])
torch.Size([157533, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2607421875  GigaBytes
Max Memory Allocated: 0.2837352752685547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04354947805404663 |0.02404475212097168 |0.0037517547607421875 |9.953975677490234e-05 |0.004600346088409424 |0.0016131401062011719 |
----------------------------------------------------------pseudo_mini_loss sum 4.2927165031433105
Total (block generation + training)time/epoch 13.559087753295898
Training time/epoch 0.3284919261932373
Training time without block to device /epoch 0.23231291770935059
Training time without total dataloading part /epoch 0.03541970252990723
load block tensor time/epoch 0.17419791221618652
block to device time/epoch 0.09617900848388672
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1721683
Number of first layer input nodes during this epoch:  662039
