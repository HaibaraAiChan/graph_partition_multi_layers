Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648448492.091494
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028157949447631836
range selection method range initialization spend 0.013993024826049805
time for parepare:  0.018334388732910156
local_output_nid generation:  0.0013604164123535156
local_in_edges_tensor generation:  0.003981351852416992
mini_batch_src_global generation:  0.0020554065704345703
r_  generation:  0.021784305572509766
local_output_nid generation:  0.0014913082122802734
local_in_edges_tensor generation:  0.0009624958038330078
mini_batch_src_global generation:  0.002489328384399414
r_  generation:  0.020659446716308594
local_output_nid generation:  0.0015676021575927734
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.019621610641479492
local_output_nid generation:  0.001567840576171875
local_in_edges_tensor generation:  0.0008919239044189453
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.02031254768371582
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.0008869171142578125
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.020838260650634766
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0016560554504394531
r_  generation:  0.0215761661529541
local_output_nid generation:  0.0015757083892822266
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0016672611236572266
r_  generation:  0.021485328674316406
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0017545223236083984
r_  generation:  0.022443294525146484
local_output_nid generation:  0.0015647411346435547
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.02228713035583496
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0018177032470703125
r_  generation:  0.022304296493530273
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0008704662322998047
mini_batch_src_global generation:  0.0017800331115722656
r_  generation:  0.021671056747436523
local_output_nid generation:  0.0015540122985839844
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.021808862686157227
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008683204650878906
mini_batch_src_global generation:  0.0017206668853759766
r_  generation:  0.02190995216369629
local_output_nid generation:  0.0016231536865234375
local_in_edges_tensor generation:  0.0009052753448486328
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.021846532821655273
local_output_nid generation:  0.001522064208984375
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.001718759536743164
r_  generation:  0.02169203758239746
local_output_nid generation:  0.001542806625366211
local_in_edges_tensor generation:  0.0008769035339355469
mini_batch_src_global generation:  0.001772165298461914
r_  generation:  0.021876811981201172
----------------------check_connections_block total spend ----------------------------- 0.5090303421020508
generate_one_block  0.03143620491027832
generate_one_block  0.031800270080566406
generate_one_block  0.031321048736572266
generate_one_block  0.031243085861206055
generate_one_block  0.030991792678833008
generate_one_block  0.03146791458129883
generate_one_block  0.0313420295715332
generate_one_block  0.03222155570983887
generate_one_block  0.03215742111206055
generate_one_block  0.03206229209899902
generate_one_block  0.031090736389160156
generate_one_block  0.0312347412109375
generate_one_block  0.0314335823059082
generate_one_block  0.031585693359375
generate_one_block  0.030688047409057617
generate_one_block  0.031083345413208008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04176163673400879
gen group dst list time:  0.02056717872619629
time for parepare:  0.019222497940063477
local_output_nid generation:  0.007540225982666016
local_in_edges_tensor generation:  0.01612377166748047
mini_batch_src_global generation:  0.025538206100463867
r_  generation:  0.25612521171569824
local_output_nid generation:  0.01108694076538086
local_in_edges_tensor generation:  0.022619247436523438
mini_batch_src_global generation:  0.031975507736206055
r_  generation:  0.2550501823425293
local_output_nid generation:  0.01110076904296875
local_in_edges_tensor generation:  0.01773357391357422
mini_batch_src_global generation:  0.034091949462890625
r_  generation:  0.254136323928833
local_output_nid generation:  0.011592388153076172
local_in_edges_tensor generation:  0.018667936325073242
mini_batch_src_global generation:  0.03295707702636719
r_  generation:  0.258162260055542
local_output_nid generation:  0.011881113052368164
local_in_edges_tensor generation:  0.014100313186645508
mini_batch_src_global generation:  0.03621721267700195
r_  generation:  0.27103281021118164
local_output_nid generation:  0.01210331916809082
local_in_edges_tensor generation:  0.014698028564453125
mini_batch_src_global generation:  0.03604555130004883
r_  generation:  0.2689797878265381
local_output_nid generation:  0.012126684188842773
local_in_edges_tensor generation:  0.014213085174560547
mini_batch_src_global generation:  0.033951520919799805
r_  generation:  0.2702605724334717
local_output_nid generation:  0.01238250732421875
local_in_edges_tensor generation:  0.019309520721435547
mini_batch_src_global generation:  0.034905195236206055
r_  generation:  0.2725968360900879
local_output_nid generation:  0.012311935424804688
local_in_edges_tensor generation:  0.019743680953979492
mini_batch_src_global generation:  0.034834861755371094
r_  generation:  0.2782721519470215
local_output_nid generation:  0.012431621551513672
local_in_edges_tensor generation:  0.014866828918457031
mini_batch_src_global generation:  0.03455781936645508
r_  generation:  0.27068090438842773
local_output_nid generation:  0.012301445007324219
local_in_edges_tensor generation:  0.016649723052978516
mini_batch_src_global generation:  0.034104347229003906
r_  generation:  0.2721860408782959
local_output_nid generation:  0.012159585952758789
local_in_edges_tensor generation:  0.016765832901000977
mini_batch_src_global generation:  0.03390240669250488
r_  generation:  0.26556968688964844
local_output_nid generation:  0.012451887130737305
local_in_edges_tensor generation:  0.01697707176208496
mini_batch_src_global generation:  0.036476850509643555
r_  generation:  0.27283620834350586
local_output_nid generation:  0.012489795684814453
local_in_edges_tensor generation:  0.021973609924316406
mini_batch_src_global generation:  0.034384727478027344
r_  generation:  0.273252010345459
local_output_nid generation:  0.012229442596435547
local_in_edges_tensor generation:  0.01447606086730957
mini_batch_src_global generation:  0.03469061851501465
r_  generation:  0.27361416816711426
local_output_nid generation:  0.012408733367919922
local_in_edges_tensor generation:  0.014313459396362305
mini_batch_src_global generation:  0.033782005310058594
r_  generation:  0.26757359504699707
----------------------check_connections_block total spend ----------------------------- 6.22224760055542
generate_one_block  0.35898375511169434
generate_one_block  0.35637402534484863
generate_one_block  0.33840298652648926
generate_one_block  0.34784388542175293
generate_one_block  0.36528515815734863
generate_one_block  0.3569526672363281
generate_one_block  0.3518834114074707
generate_one_block  0.3633852005004883
generate_one_block  0.3582282066345215
generate_one_block  0.35895395278930664
generate_one_block  0.35036540031433105
generate_one_block  0.3466205596923828
generate_one_block  0.352632999420166
generate_one_block  0.36005306243896484
generate_one_block  0.3577308654785156
generate_one_block  0.34996485710144043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03545260429382324
gen group dst list time:  0.06274127960205078
time for parepare:  0.018929481506347656
local_output_nid generation:  0.02451324462890625
local_in_edges_tensor generation:  0.03929424285888672
mini_batch_src_global generation:  0.045124053955078125
r_  generation:  0.4490389823913574
local_output_nid generation:  0.030617237091064453
local_in_edges_tensor generation:  0.04748654365539551
mini_batch_src_global generation:  0.05223393440246582
r_  generation:  0.4612996578216553
local_output_nid generation:  0.030158042907714844
local_in_edges_tensor generation:  0.03563356399536133
mini_batch_src_global generation:  0.05082082748413086
r_  generation:  0.4643259048461914
local_output_nid generation:  0.03083324432373047
local_in_edges_tensor generation:  0.03571486473083496
mini_batch_src_global generation:  0.05136418342590332
r_  generation:  0.46564149856567383
local_output_nid generation:  0.031148910522460938
local_in_edges_tensor generation:  0.04417085647583008
mini_batch_src_global generation:  0.051677703857421875
r_  generation:  0.47098612785339355
local_output_nid generation:  0.031212329864501953
local_in_edges_tensor generation:  0.03570270538330078
mini_batch_src_global generation:  0.05819106101989746
r_  generation:  0.4697751998901367
local_output_nid generation:  0.031182289123535156
local_in_edges_tensor generation:  0.04009532928466797
mini_batch_src_global generation:  0.05320453643798828
r_  generation:  0.4725937843322754
local_output_nid generation:  0.031424522399902344
local_in_edges_tensor generation:  0.032283782958984375
mini_batch_src_global generation:  0.05359220504760742
r_  generation:  0.4750709533691406
local_output_nid generation:  0.03148698806762695
local_in_edges_tensor generation:  0.03237771987915039
mini_batch_src_global generation:  0.05338788032531738
r_  generation:  0.47313857078552246
local_output_nid generation:  0.03167104721069336
local_in_edges_tensor generation:  0.040921926498413086
mini_batch_src_global generation:  0.053544044494628906
r_  generation:  0.4753377437591553
local_output_nid generation:  0.03132510185241699
local_in_edges_tensor generation:  0.03280830383300781
mini_batch_src_global generation:  0.053568363189697266
r_  generation:  0.47867393493652344
local_output_nid generation:  0.031580448150634766
local_in_edges_tensor generation:  0.03259754180908203
mini_batch_src_global generation:  0.05445098876953125
r_  generation:  0.47432780265808105
local_output_nid generation:  0.03190898895263672
local_in_edges_tensor generation:  0.03261375427246094
mini_batch_src_global generation:  0.05312371253967285
r_  generation:  0.4736137390136719
local_output_nid generation:  0.03143167495727539
local_in_edges_tensor generation:  0.0412297248840332
mini_batch_src_global generation:  0.05302596092224121
r_  generation:  0.4767923355102539
local_output_nid generation:  0.03272414207458496
local_in_edges_tensor generation:  0.044667959213256836
mini_batch_src_global generation:  0.05513906478881836
r_  generation:  0.47313404083251953
local_output_nid generation:  0.03176307678222656
local_in_edges_tensor generation:  0.030039072036743164
mini_batch_src_global generation:  0.053716182708740234
r_  generation:  0.4748847484588623
----------------------check_connections_block total spend ----------------------------- 11.149956464767456
generate_one_block  0.6136727333068848
generate_one_block  0.599635124206543
generate_one_block  0.5919318199157715
generate_one_block  0.6032059192657471
generate_one_block  0.6014983654022217
generate_one_block  0.5985579490661621
generate_one_block  0.6523425579071045
generate_one_block  0.6069331169128418
generate_one_block  0.5951223373413086
generate_one_block  0.6523678302764893
generate_one_block  0.6253652572631836
generate_one_block  0.6163508892059326
generate_one_block  0.60971999168396
generate_one_block  0.6337776184082031
generate_one_block  0.6049885749816895
generate_one_block  0.6007106304168701
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  17.372204065322876
block generation total time  15.479841709136963
average batch blocks generation time:  0.9674901068210602
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09264087677001953  GigaBytes
Max Memory Allocated: 0.09264087677001953  GigaBytes

torch.Size([156593, 128])
torch.Size([130133, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.2635822296142578  GigaBytes
Max Memory Allocated: 0.27309417724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09448575973510742  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([157023, 128])
torch.Size([129726, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.263425350189209  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09421062469482422  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([157020, 128])
torch.Size([129539, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2616000175476074  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944051742553711  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([157058, 128])
torch.Size([130407, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2629208564758301  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09430408477783203  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([156610, 128])
torch.Size([129785, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2633028030395508  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09447765350341797  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([156774, 128])
torch.Size([130147, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2640972137451172  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944981575012207  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([157009, 128])
torch.Size([130119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2638688087463379  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09458446502685547  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([156740, 128])
torch.Size([129644, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2644381523132324  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09458684921264648  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([156899, 128])
torch.Size([129970, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2647061347961426  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09464597702026367  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

torch.Size([157095, 128])
torch.Size([130614, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26488494873046875  GigaBytes
Max Memory Allocated: 0.28681468963623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09438610076904297  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([156738, 128])
torch.Size([129894, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2635049819946289  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09426259994506836  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([156661, 128])
torch.Size([129437, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2626171112060547  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09446239471435547  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([156932, 128])
torch.Size([129988, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.263702392578125  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09454154968261719  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([156834, 128])
torch.Size([130181, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26407861709594727  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09426069259643555  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([156693, 128])
torch.Size([129427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2624807357788086  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09444522857666016  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([157036, 128])
torch.Size([130071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.263272762298584  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03586195409297943 |0.037869811058044434 |0.050027698278427124 |9.463727474212646e-05 |0.008328691124916077 |0.0019578933715820312 |
----------------------------------------------------------pseudo_mini_loss sum 5.342812538146973
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5319096
Number of first layer input nodes during this epoch:  2509715
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.1326913833618164  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022886991500854492
range selection method range initialization spend 0.011528253555297852
time for parepare:  0.016367435455322266
local_output_nid generation:  0.0027968883514404297
local_in_edges_tensor generation:  0.006669044494628906
mini_batch_src_global generation:  0.0019054412841796875
r_  generation:  0.01958632469177246
local_output_nid generation:  0.0016193389892578125
local_in_edges_tensor generation:  0.0010380744934082031
mini_batch_src_global generation:  0.002309560775756836
r_  generation:  0.020431995391845703
local_output_nid generation:  0.0015802383422851562
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.020896196365356445
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0015649795532226562
r_  generation:  0.02085423469543457
local_output_nid generation:  0.0015902519226074219
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0015513896942138672
r_  generation:  0.021491527557373047
local_output_nid generation:  0.0015506744384765625
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.021190881729125977
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0015709400177001953
r_  generation:  0.021190166473388672
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0009734630584716797
mini_batch_src_global generation:  0.0016529560089111328
r_  generation:  0.021815776824951172
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0016872882843017578
r_  generation:  0.02238631248474121
local_output_nid generation:  0.0015544891357421875
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.0016353130340576172
r_  generation:  0.02116250991821289
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0009310245513916016
mini_batch_src_global generation:  0.001706838607788086
r_  generation:  0.022824525833129883
local_output_nid generation:  0.0015270709991455078
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.02167510986328125
local_output_nid generation:  0.0015192031860351562
local_in_edges_tensor generation:  0.0008955001831054688
mini_batch_src_global generation:  0.0017473697662353516
r_  generation:  0.02219247817993164
local_output_nid generation:  0.001523733139038086
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.02364516258239746
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.022193431854248047
local_output_nid generation:  0.0015354156494140625
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.001699209213256836
r_  generation:  0.021804332733154297
----------------------check_connections_block total spend ----------------------------- 0.5145838260650635
generate_one_block  0.04236793518066406
generate_one_block  0.03159952163696289
generate_one_block  0.03116583824157715
generate_one_block  0.03166031837463379
generate_one_block  0.031562089920043945
generate_one_block  0.03297853469848633
generate_one_block  0.03080463409423828
generate_one_block  0.032083749771118164
generate_one_block  0.03245735168457031
generate_one_block  0.03095221519470215
generate_one_block  0.0331578254699707
generate_one_block  0.031403303146362305
generate_one_block  0.03450751304626465
generate_one_block  0.03143477439880371
generate_one_block  0.031154632568359375
generate_one_block  0.03188967704772949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042530059814453125
gen group dst list time:  0.019484519958496094
time for parepare:  0.018874645233154297
local_output_nid generation:  0.007049560546875
local_in_edges_tensor generation:  0.022839784622192383
mini_batch_src_global generation:  0.026943683624267578
r_  generation:  0.26346278190612793
local_output_nid generation:  0.013908863067626953
local_in_edges_tensor generation:  0.026742935180664062
mini_batch_src_global generation:  0.03879261016845703
r_  generation:  0.2577052116394043
local_output_nid generation:  0.012864351272583008
local_in_edges_tensor generation:  0.020995140075683594
mini_batch_src_global generation:  0.03139925003051758
r_  generation:  0.2667214870452881
local_output_nid generation:  0.01268458366394043
local_in_edges_tensor generation:  0.013981342315673828
mini_batch_src_global generation:  0.03223419189453125
r_  generation:  0.26229000091552734
local_output_nid generation:  0.012951374053955078
local_in_edges_tensor generation:  0.018077611923217773
mini_batch_src_global generation:  0.035486459732055664
r_  generation:  0.26894378662109375
local_output_nid generation:  0.012527704238891602
local_in_edges_tensor generation:  0.013662576675415039
mini_batch_src_global generation:  0.03380990028381348
r_  generation:  0.2646372318267822
local_output_nid generation:  0.012381315231323242
local_in_edges_tensor generation:  0.013353347778320312
mini_batch_src_global generation:  0.03364276885986328
r_  generation:  0.2642178535461426
local_output_nid generation:  0.012824773788452148
local_in_edges_tensor generation:  0.02047419548034668
mini_batch_src_global generation:  0.03413581848144531
r_  generation:  0.27152371406555176
local_output_nid generation:  0.012941598892211914
local_in_edges_tensor generation:  0.016138792037963867
mini_batch_src_global generation:  0.0363774299621582
r_  generation:  0.27625489234924316
local_output_nid generation:  0.012561559677124023
local_in_edges_tensor generation:  0.01369333267211914
mini_batch_src_global generation:  0.03435039520263672
r_  generation:  0.27167820930480957
local_output_nid generation:  0.012959957122802734
local_in_edges_tensor generation:  0.016301870346069336
mini_batch_src_global generation:  0.03720211982727051
r_  generation:  0.2808399200439453
local_output_nid generation:  0.012614727020263672
local_in_edges_tensor generation:  0.01799774169921875
mini_batch_src_global generation:  0.03439474105834961
r_  generation:  0.27457761764526367
local_output_nid generation:  0.013162612915039062
local_in_edges_tensor generation:  0.016219615936279297
mini_batch_src_global generation:  0.035144805908203125
r_  generation:  0.27931666374206543
local_output_nid generation:  0.012745857238769531
local_in_edges_tensor generation:  0.013768196105957031
mini_batch_src_global generation:  0.03418564796447754
r_  generation:  0.2724778652191162
local_output_nid generation:  0.013854026794433594
local_in_edges_tensor generation:  0.021733999252319336
mini_batch_src_global generation:  0.0367891788482666
r_  generation:  0.28708910942077637
local_output_nid generation:  0.01488637924194336
local_in_edges_tensor generation:  0.020139217376708984
mini_batch_src_global generation:  0.03643655776977539
r_  generation:  0.275806188583374
----------------------check_connections_block total spend ----------------------------- 6.334002733230591
generate_one_block  0.3575451374053955
generate_one_block  0.3609461784362793
generate_one_block  0.3700408935546875
generate_one_block  0.3549797534942627
generate_one_block  0.3575170040130615
generate_one_block  0.3454124927520752
generate_one_block  0.3729896545410156
generate_one_block  0.3629794120788574
generate_one_block  0.36582422256469727
generate_one_block  0.35657191276550293
generate_one_block  0.3770153522491455
generate_one_block  0.34855222702026367
generate_one_block  0.3648490905761719
generate_one_block  0.34236860275268555
generate_one_block  0.3476986885070801
generate_one_block  0.3583040237426758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06253480911254883
gen group dst list time:  0.07004570960998535
time for parepare:  0.018311262130737305
local_output_nid generation:  0.026594161987304688
local_in_edges_tensor generation:  0.047196149826049805
mini_batch_src_global generation:  0.045523881912231445
r_  generation:  0.45594072341918945
local_output_nid generation:  0.030252456665039062
local_in_edges_tensor generation:  0.0480196475982666
mini_batch_src_global generation:  0.05253171920776367
r_  generation:  0.48255419731140137
local_output_nid generation:  0.03688549995422363
local_in_edges_tensor generation:  0.05080103874206543
mini_batch_src_global generation:  0.060228586196899414
r_  generation:  0.47721362113952637
local_output_nid generation:  0.031819820404052734
local_in_edges_tensor generation:  0.03968167304992676
mini_batch_src_global generation:  0.05555248260498047
r_  generation:  0.4684126377105713
local_output_nid generation:  0.03227424621582031
local_in_edges_tensor generation:  0.08806896209716797
mini_batch_src_global generation:  0.05239558219909668
r_  generation:  0.4742453098297119
local_output_nid generation:  0.031205177307128906
local_in_edges_tensor generation:  0.04500102996826172
mini_batch_src_global generation:  0.05459880828857422
r_  generation:  0.4932687282562256
local_output_nid generation:  0.03667902946472168
local_in_edges_tensor generation:  0.04382610321044922
mini_batch_src_global generation:  0.05802750587463379
r_  generation:  0.4709913730621338
local_output_nid generation:  0.03214240074157715
local_in_edges_tensor generation:  0.03729844093322754
mini_batch_src_global generation:  0.056426048278808594
r_  generation:  0.47948718070983887
local_output_nid generation:  0.03249669075012207
local_in_edges_tensor generation:  0.037638187408447266
mini_batch_src_global generation:  0.05316472053527832
r_  generation:  0.4805634021759033
local_output_nid generation:  0.03278470039367676
local_in_edges_tensor generation:  0.029015779495239258
mini_batch_src_global generation:  0.05403542518615723
r_  generation:  0.4737715721130371
local_output_nid generation:  0.03386330604553223
local_in_edges_tensor generation:  0.03328275680541992
mini_batch_src_global generation:  0.05625605583190918
r_  generation:  0.4788939952850342
local_output_nid generation:  0.03302454948425293
local_in_edges_tensor generation:  0.04170584678649902
mini_batch_src_global generation:  0.05354189872741699
r_  generation:  0.47594213485717773
local_output_nid generation:  0.033750057220458984
local_in_edges_tensor generation:  0.034784555435180664
mini_batch_src_global generation:  0.05740189552307129
r_  generation:  0.49250125885009766
local_output_nid generation:  0.03384041786193848
local_in_edges_tensor generation:  0.03927016258239746
mini_batch_src_global generation:  0.05945777893066406
r_  generation:  0.477386474609375
local_output_nid generation:  0.035837411880493164
local_in_edges_tensor generation:  0.03715085983276367
mini_batch_src_global generation:  0.05643916130065918
r_  generation:  0.4794750213623047
local_output_nid generation:  0.03280758857727051
local_in_edges_tensor generation:  0.03740644454956055
mini_batch_src_global generation:  0.05301380157470703
r_  generation:  0.4725809097290039
----------------------check_connections_block total spend ----------------------------- 11.447749137878418
generate_one_block  0.6006479263305664
generate_one_block  0.6066675186157227
generate_one_block  0.5994861125946045
generate_one_block  0.6055130958557129
generate_one_block  0.5820934772491455
generate_one_block  0.5895392894744873
generate_one_block  0.6024718284606934
generate_one_block  0.6018335819244385
generate_one_block  0.6361758708953857
generate_one_block  0.5848729610443115
generate_one_block  0.5948336124420166
generate_one_block  0.6023914813995361
generate_one_block  0.6096034049987793
generate_one_block  0.5953166484832764
generate_one_block  0.5972847938537598
generate_one_block  0.5935535430908203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.1326913833618164  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

connection checking time:  17.78175187110901
block generation total time  15.345879793167114
average batch blocks generation time:  0.9591174870729446
block dataloader generation time/epoch 35.43215894699097
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09461212158203125  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

torch.Size([156887, 128])
torch.Size([130271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2636117935180664  GigaBytes
Max Memory Allocated: 0.2868618965148926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09479427337646484  GigaBytes
Max Memory Allocated: 0.28691625595092773  GigaBytes

torch.Size([157074, 128])
torch.Size([130071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26395416259765625  GigaBytes
Max Memory Allocated: 0.28691625595092773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09470653533935547  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156776, 128])
torch.Size([130275, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2646346092224121  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0946044921875  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156726, 128])
torch.Size([129884, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2639198303222656  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09462881088256836  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156745, 128])
torch.Size([130068, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26427316665649414  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09455060958862305  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156835, 128])
torch.Size([129914, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2630882263183594  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0944828987121582  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156829, 128])
torch.Size([129668, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26249217987060547  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09462451934814453  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156648, 128])
torch.Size([130099, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2642989158630371  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09480524063110352  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

torch.Size([156929, 128])
torch.Size([130392, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2647242546081543  GigaBytes
Max Memory Allocated: 0.28692197799682617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09450435638427734  GigaBytes
Max Memory Allocated: 0.286954402923584  GigaBytes

torch.Size([156676, 128])
torch.Size([129667, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26321983337402344  GigaBytes
Max Memory Allocated: 0.286954402923584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09485340118408203  GigaBytes
Max Memory Allocated: 0.286954402923584  GigaBytes

torch.Size([156834, 128])
torch.Size([129976, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26503658294677734  GigaBytes
Max Memory Allocated: 0.286954402923584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09468841552734375  GigaBytes
Max Memory Allocated: 0.286954402923584  GigaBytes

torch.Size([156992, 128])
torch.Size([130342, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26367616653442383  GigaBytes
Max Memory Allocated: 0.286954402923584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09482431411743164  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

torch.Size([156941, 128])
torch.Size([130431, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26503705978393555  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09444189071655273  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

torch.Size([156681, 128])
torch.Size([129173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.2625389099121094  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.09461116790771484  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

torch.Size([156928, 128])
torch.Size([129945, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26305627822875977  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.0946969985961914  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

torch.Size([156972, 128])
torch.Size([130079, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.26402854919433594  GigaBytes
Max Memory Allocated: 0.28698158264160156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031670987606048584 |0.016718745231628418 |0.0034460872411727905 |8.966028690338135e-05 |0.00413946807384491 |0.0013272762298583984 |
----------------------------------------------------------pseudo_mini_loss sum 4.091434478759766
Total (block generation + training)time/epoch 36.36275839805603
Training time/epoch 0.9303038120269775
Training time without block to device /epoch 0.6628038883209229
Training time without total dataloading part /epoch 0.1241307258605957
load block tensor time/epoch 0.5067358016967773
block to device time/epoch 0.2674999237060547
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5320187
Number of first layer input nodes during this epoch:  2509473
