Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648450965.2105227
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025581836700439453
range selection method range initialization spend 0.01374053955078125
time for parepare:  0.01768016815185547
local_output_nid generation:  0.002796173095703125
local_in_edges_tensor generation:  0.004022121429443359
mini_batch_src_global generation:  0.003711223602294922
r_  generation:  0.04149222373962402
local_output_nid generation:  0.003266572952270508
local_in_edges_tensor generation:  0.0016827583312988281
mini_batch_src_global generation:  0.004566669464111328
r_  generation:  0.044060707092285156
local_output_nid generation:  0.003443002700805664
local_in_edges_tensor generation:  0.0016927719116210938
mini_batch_src_global generation:  0.0031890869140625
r_  generation:  0.045326948165893555
local_output_nid generation:  0.0033812522888183594
local_in_edges_tensor generation:  0.0017154216766357422
mini_batch_src_global generation:  0.0033516883850097656
r_  generation:  0.046340227127075195
local_output_nid generation:  0.0031256675720214844
local_in_edges_tensor generation:  0.0017020702362060547
mini_batch_src_global generation:  0.003495931625366211
r_  generation:  0.04688096046447754
local_output_nid generation:  0.0033690929412841797
local_in_edges_tensor generation:  0.0017273426055908203
mini_batch_src_global generation:  0.0037338733673095703
r_  generation:  0.047506093978881836
local_output_nid generation:  0.0031833648681640625
local_in_edges_tensor generation:  0.0017218589782714844
mini_batch_src_global generation:  0.0036704540252685547
r_  generation:  0.04739809036254883
local_output_nid generation:  0.003347635269165039
local_in_edges_tensor generation:  0.0016977787017822266
mini_batch_src_global generation:  0.0037462711334228516
r_  generation:  0.04786372184753418
----------------------check_connections_block total spend ----------------------------- 0.5323939323425293
generate_one_block  0.06000256538391113
generate_one_block  0.06157350540161133
generate_one_block  0.06114554405212402
generate_one_block  0.06207609176635742
generate_one_block  0.06477093696594238
generate_one_block  0.06251716613769531
generate_one_block  0.062035560607910156
generate_one_block  0.06265401840209961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043885231018066406
gen group dst list time:  0.016448497772216797
time for parepare:  0.019078731536865234
local_output_nid generation:  0.011286497116088867
local_in_edges_tensor generation:  0.029833078384399414
mini_batch_src_global generation:  0.03745007514953613
r_  generation:  0.35013270378112793
local_output_nid generation:  0.016983985900878906
local_in_edges_tensor generation:  0.031928300857543945
mini_batch_src_global generation:  0.04448962211608887
r_  generation:  0.36853957176208496
local_output_nid generation:  0.017563581466674805
local_in_edges_tensor generation:  0.025892972946166992
mini_batch_src_global generation:  0.043616294860839844
r_  generation:  0.37464451789855957
local_output_nid generation:  0.01793360710144043
local_in_edges_tensor generation:  0.023035287857055664
mini_batch_src_global generation:  0.048180341720581055
r_  generation:  0.3798387050628662
local_output_nid generation:  0.018058300018310547
local_in_edges_tensor generation:  0.026577234268188477
mini_batch_src_global generation:  0.04608035087585449
r_  generation:  0.3821232318878174
local_output_nid generation:  0.018789052963256836
local_in_edges_tensor generation:  0.023267745971679688
mini_batch_src_global generation:  0.047010183334350586
r_  generation:  0.3944716453552246
local_output_nid generation:  0.01860213279724121
local_in_edges_tensor generation:  0.023183584213256836
mini_batch_src_global generation:  0.0463261604309082
r_  generation:  0.38346171379089355
local_output_nid generation:  0.018578290939331055
local_in_edges_tensor generation:  0.023190736770629883
mini_batch_src_global generation:  0.04705810546875
r_  generation:  0.37972164154052734
----------------------check_connections_block total spend ----------------------------- 4.364516496658325
generate_one_block  0.47986388206481934
generate_one_block  0.49440526962280273
generate_one_block  0.49236440658569336
generate_one_block  0.4980943202972412
generate_one_block  0.49312496185302734
generate_one_block  0.5110383033752441
generate_one_block  0.4946563243865967
generate_one_block  0.4913039207458496
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03509020805358887
gen group dst list time:  0.036840200424194336
time for parepare:  0.01922297477722168
local_output_nid generation:  0.024792909622192383
local_in_edges_tensor generation:  0.04288983345031738
mini_batch_src_global generation:  0.05414438247680664
r_  generation:  0.5347301959991455
local_output_nid generation:  0.032076120376586914
local_in_edges_tensor generation:  0.053824663162231445
mini_batch_src_global generation:  0.06339669227600098
r_  generation:  0.5455348491668701
local_output_nid generation:  0.03302812576293945
local_in_edges_tensor generation:  0.039664506912231445
mini_batch_src_global generation:  0.061667680740356445
r_  generation:  0.5533742904663086
local_output_nid generation:  0.03330230712890625
local_in_edges_tensor generation:  0.04504990577697754
mini_batch_src_global generation:  0.05936479568481445
r_  generation:  0.5578105449676514
local_output_nid generation:  0.033431291580200195
local_in_edges_tensor generation:  0.035950422286987305
mini_batch_src_global generation:  0.06099510192871094
r_  generation:  0.5608243942260742
local_output_nid generation:  0.0334622859954834
local_in_edges_tensor generation:  0.04966092109680176
mini_batch_src_global generation:  0.06177973747253418
r_  generation:  0.5612168312072754
local_output_nid generation:  0.0336301326751709
local_in_edges_tensor generation:  0.03566932678222656
mini_batch_src_global generation:  0.06219291687011719
r_  generation:  0.5690886974334717
local_output_nid generation:  0.03380393981933594
local_in_edges_tensor generation:  0.036092281341552734
mini_batch_src_global generation:  0.06351351737976074
r_  generation:  0.562152624130249
----------------------check_connections_block total spend ----------------------------- 6.51944637298584
generate_one_block  0.7087152004241943
generate_one_block  0.719576358795166
generate_one_block  0.6973536014556885
generate_one_block  0.7064993381500244
generate_one_block  0.7184484004974365
generate_one_block  0.7082767486572266
generate_one_block  0.7213878631591797
generate_one_block  0.7031397819519043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  10.883962869644165
block generation total time  9.638248682022095
average batch blocks generation time:  1.2047810852527618
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10155963897705078  GigaBytes
Max Memory Allocated: 0.10155963897705078  GigaBytes

torch.Size([162401, 128])
torch.Size([145818, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.5777111053466797  GigaBytes
Max Memory Allocated: 0.6079196929931641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.10423707962036133  GigaBytes
Max Memory Allocated: 0.6470346450805664  GigaBytes

torch.Size([162456, 128])
torch.Size([145858, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.5781402587890625  GigaBytes
Max Memory Allocated: 0.6470346450805664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.1037282943725586  GigaBytes
Max Memory Allocated: 0.648038387298584  GigaBytes

torch.Size([162480, 128])
torch.Size([145472, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.578620433807373  GigaBytes
Max Memory Allocated: 0.648038387298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2322998046875 GB
    Memory Allocated: 0.1047067642211914  GigaBytes
Max Memory Allocated: 0.648038387298584  GigaBytes

torch.Size([162709, 128])
torch.Size([145734, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 0.578892707824707  GigaBytes
Max Memory Allocated: 0.648038387298584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10439062118530273  GigaBytes
Max Memory Allocated: 0.6487851142883301  GigaBytes

torch.Size([162714, 128])
torch.Size([146174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5785179138183594  GigaBytes
Max Memory Allocated: 0.6487851142883301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10431289672851562  GigaBytes
Max Memory Allocated: 0.6487851142883301  GigaBytes

torch.Size([162816, 128])
torch.Size([146400, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5809082984924316  GigaBytes
Max Memory Allocated: 0.6487851142883301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10373640060424805  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162506, 128])
torch.Size([145901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5782384872436523  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10418033599853516  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162553, 128])
torch.Size([145906, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5785737037658691  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04093360900878906 |0.049253880977630615 |0.0920756459236145 |9.909272193908691e-05 |0.013510584831237793 |0.002073526382446289 |
----------------------------------------------------------pseudo_mini_loss sum 5.595458030700684
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3056377
Number of first layer input nodes during this epoch:  1300635
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.14012479782104492  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021921157836914062
range selection method range initialization spend 0.011548042297363281
time for parepare:  0.018108844757080078
local_output_nid generation:  0.002820730209350586
local_in_edges_tensor generation:  0.0048482418060302734
mini_batch_src_global generation:  0.0036787986755371094
r_  generation:  0.040669918060302734
local_output_nid generation:  0.003540515899658203
local_in_edges_tensor generation:  0.0017366409301757812
mini_batch_src_global generation:  0.004877328872680664
r_  generation:  0.045014142990112305
local_output_nid generation:  0.003614664077758789
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.003267526626586914
r_  generation:  0.0443727970123291
local_output_nid generation:  0.0038182735443115234
local_in_edges_tensor generation:  0.0017936229705810547
mini_batch_src_global generation:  0.0033507347106933594
r_  generation:  0.04610705375671387
local_output_nid generation:  0.0037894248962402344
local_in_edges_tensor generation:  0.0017161369323730469
mini_batch_src_global generation:  0.0035419464111328125
r_  generation:  0.04909944534301758
local_output_nid generation:  0.003877401351928711
local_in_edges_tensor generation:  0.0017430782318115234
mini_batch_src_global generation:  0.003871917724609375
r_  generation:  0.04834413528442383
local_output_nid generation:  0.003829479217529297
local_in_edges_tensor generation:  0.0017902851104736328
mini_batch_src_global generation:  0.003839731216430664
r_  generation:  0.04759716987609863
local_output_nid generation:  0.0036437511444091797
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.003826141357421875
r_  generation:  0.048623085021972656
----------------------check_connections_block total spend ----------------------------- 0.5415656566619873
generate_one_block  0.06186652183532715
generate_one_block  0.0621790885925293
generate_one_block  0.06366586685180664
generate_one_block  0.06477165222167969
generate_one_block  0.0638885498046875
generate_one_block  0.06539344787597656
generate_one_block  0.06817936897277832
generate_one_block  0.06277155876159668
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05500626564025879
gen group dst list time:  0.022716999053955078
time for parepare:  0.022106647491455078
local_output_nid generation:  0.012570381164550781
local_in_edges_tensor generation:  0.06302070617675781
mini_batch_src_global generation:  0.037775516510009766
r_  generation:  0.35898733139038086
local_output_nid generation:  0.018923521041870117
local_in_edges_tensor generation:  0.0345304012298584
mini_batch_src_global generation:  0.04491090774536133
r_  generation:  0.37717556953430176
local_output_nid generation:  0.01820230484008789
local_in_edges_tensor generation:  0.030530214309692383
mini_batch_src_global generation:  0.04352259635925293
r_  generation:  0.37517881393432617
local_output_nid generation:  0.018686532974243164
local_in_edges_tensor generation:  0.021823644638061523
mini_batch_src_global generation:  0.04471850395202637
r_  generation:  0.37881970405578613
local_output_nid generation:  0.018944740295410156
local_in_edges_tensor generation:  0.027525663375854492
mini_batch_src_global generation:  0.045612335205078125
r_  generation:  0.38678431510925293
local_output_nid generation:  0.018900394439697266
local_in_edges_tensor generation:  0.024236440658569336
mini_batch_src_global generation:  0.0468745231628418
r_  generation:  0.3860199451446533
local_output_nid generation:  0.01893925666809082
local_in_edges_tensor generation:  0.02385115623474121
mini_batch_src_global generation:  0.04688525199890137
r_  generation:  0.38880038261413574
local_output_nid generation:  0.01996588706970215
local_in_edges_tensor generation:  0.031017065048217773
mini_batch_src_global generation:  0.05031609535217285
r_  generation:  0.40607452392578125
----------------------check_connections_block total spend ----------------------------- 4.496337652206421
generate_one_block  0.4993093013763428
generate_one_block  0.511420488357544
generate_one_block  0.5082902908325195
generate_one_block  0.49840497970581055
generate_one_block  0.5025551319122314
generate_one_block  0.49805212020874023
generate_one_block  0.5012643337249756
generate_one_block  0.5287430286407471
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08295416831970215
gen group dst list time:  0.04015827178955078
time for parepare:  0.021384716033935547
local_output_nid generation:  0.026948213577270508
local_in_edges_tensor generation:  0.06251287460327148
mini_batch_src_global generation:  0.05196404457092285
r_  generation:  0.5490853786468506
local_output_nid generation:  0.03679466247558594
local_in_edges_tensor generation:  0.053131818771362305
mini_batch_src_global generation:  0.06772017478942871
r_  generation:  0.54984450340271
local_output_nid generation:  0.034868478775024414
local_in_edges_tensor generation:  0.03389930725097656
mini_batch_src_global generation:  0.06209754943847656
r_  generation:  0.5685958862304688
local_output_nid generation:  0.03542351722717285
local_in_edges_tensor generation:  0.038683414459228516
mini_batch_src_global generation:  0.06004977226257324
r_  generation:  0.5609550476074219
local_output_nid generation:  0.03572559356689453
local_in_edges_tensor generation:  0.04859042167663574
mini_batch_src_global generation:  0.06172609329223633
r_  generation:  0.5690174102783203
local_output_nid generation:  0.03574228286743164
local_in_edges_tensor generation:  0.04411435127258301
mini_batch_src_global generation:  0.061811208724975586
r_  generation:  0.566702127456665
local_output_nid generation:  0.036168813705444336
local_in_edges_tensor generation:  0.03412032127380371
mini_batch_src_global generation:  0.06282901763916016
r_  generation:  0.5689060688018799
local_output_nid generation:  0.03634953498840332
local_in_edges_tensor generation:  0.033808231353759766
mini_batch_src_global generation:  0.06309747695922852
r_  generation:  0.5717782974243164
----------------------check_connections_block total spend ----------------------------- 6.628537893295288
generate_one_block  0.7085533142089844
generate_one_block  0.7285544872283936
generate_one_block  0.7128865718841553
generate_one_block  0.7286808490753174
generate_one_block  0.719383955001831
generate_one_block  0.7116200923919678
generate_one_block  0.7063689231872559
generate_one_block  0.7087266445159912
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.14012479782104492  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

connection checking time:  11.124875545501709
block generation total time  9.772814512252808
average batch blocks generation time:  1.221601814031601
block dataloader generation time/epoch 23.08445644378662
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.1049656867980957  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162561, 128])
torch.Size([145857, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5784749984741211  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.1052546501159668  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162439, 128])
torch.Size([145941, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5799236297607422  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10486555099487305  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162475, 128])
torch.Size([145339, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5746903419494629  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10420846939086914  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162691, 128])
torch.Size([145931, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5794343948364258  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10471963882446289  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162773, 128])
torch.Size([146364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5816869735717773  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.1047067642211914  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162791, 128])
torch.Size([146355, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5799760818481445  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10478830337524414  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162366, 128])
torch.Size([145428, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5800948143005371  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.10490942001342773  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

torch.Size([162732, 128])
torch.Size([146154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.5791692733764648  GigaBytes
Max Memory Allocated: 0.6517233848571777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04379722476005554 |0.026977628469467163 |0.003970891237258911 |0.0001010894775390625 |0.003538280725479126 |0.0014445781707763672 |
----------------------------------------------------------pseudo_mini_loss sum 3.5762834548950195
Total (block generation + training)time/epoch 23.74915623664856
Training time/epoch 0.6644930839538574
Training time without block to device /epoch 0.4486720561981201
Training time without total dataloading part /epoch 0.062326669692993164
load block tensor time/epoch 0.35037779808044434
block to device time/epoch 0.2158210277557373
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3056836
Number of first layer input nodes during this epoch:  1300828
