Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648448439.9788344
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026715993881225586
range selection method range initialization spend 0.01389932632446289
time for parepare:  0.017967700958251953
local_output_nid generation:  0.00262451171875
local_in_edges_tensor generation:  0.003998994827270508
mini_batch_src_global generation:  0.0039937496185302734
r_  generation:  0.04220938682556152
local_output_nid generation:  0.0031082630157470703
local_in_edges_tensor generation:  0.0016889572143554688
mini_batch_src_global generation:  0.004694461822509766
r_  generation:  0.04201149940490723
local_output_nid generation:  0.0031571388244628906
local_in_edges_tensor generation:  0.0016827583312988281
mini_batch_src_global generation:  0.0033636093139648438
r_  generation:  0.044200897216796875
local_output_nid generation:  0.0031707286834716797
local_in_edges_tensor generation:  0.0016884803771972656
mini_batch_src_global generation:  0.003523111343383789
r_  generation:  0.04529404640197754
local_output_nid generation:  0.0031709671020507812
local_in_edges_tensor generation:  0.001720428466796875
mini_batch_src_global generation:  0.0037889480590820312
r_  generation:  0.046706199645996094
local_output_nid generation:  0.0032210350036621094
local_in_edges_tensor generation:  0.0017664432525634766
mini_batch_src_global generation:  0.0039288997650146484
r_  generation:  0.045935630798339844
local_output_nid generation:  0.0032248497009277344
local_in_edges_tensor generation:  0.0017123222351074219
mini_batch_src_global generation:  0.0038738250732421875
r_  generation:  0.046747684478759766
local_output_nid generation:  0.003206968307495117
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0038614273071289062
r_  generation:  0.0458226203918457
----------------------check_connections_block total spend ----------------------------- 0.5267810821533203
generate_one_block  0.060982465744018555
generate_one_block  0.05980181694030762
generate_one_block  0.0617673397064209
generate_one_block  0.06219983100891113
generate_one_block  0.06584835052490234
generate_one_block  0.06090974807739258
generate_one_block  0.06233501434326172
generate_one_block  0.06189918518066406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043131351470947266
gen group dst list time:  0.016530513763427734
time for parepare:  0.019243478775024414
local_output_nid generation:  0.01132655143737793
local_in_edges_tensor generation:  0.03350496292114258
mini_batch_src_global generation:  0.03980731964111328
r_  generation:  0.35913801193237305
local_output_nid generation:  0.01654052734375
local_in_edges_tensor generation:  0.032562255859375
mini_batch_src_global generation:  0.05125999450683594
r_  generation:  0.3578145503997803
local_output_nid generation:  0.01708197593688965
local_in_edges_tensor generation:  0.026917695999145508
mini_batch_src_global generation:  0.045358896255493164
r_  generation:  0.373516321182251
local_output_nid generation:  0.017552614212036133
local_in_edges_tensor generation:  0.02771925926208496
mini_batch_src_global generation:  0.047037363052368164
r_  generation:  0.37490224838256836
local_output_nid generation:  0.0180056095123291
local_in_edges_tensor generation:  0.023769617080688477
mini_batch_src_global generation:  0.04827141761779785
r_  generation:  0.3813800811767578
local_output_nid generation:  0.021262407302856445
local_in_edges_tensor generation:  0.021142244338989258
mini_batch_src_global generation:  0.04788374900817871
r_  generation:  0.38837409019470215
local_output_nid generation:  0.018110036849975586
local_in_edges_tensor generation:  0.023903608322143555
mini_batch_src_global generation:  0.04818367958068848
r_  generation:  0.3813657760620117
local_output_nid generation:  0.018111228942871094
local_in_edges_tensor generation:  0.02040410041809082
mini_batch_src_global generation:  0.04811978340148926
r_  generation:  0.3717327117919922
----------------------check_connections_block total spend ----------------------------- 4.376587152481079
generate_one_block  0.49091219902038574
generate_one_block  0.4853198528289795
generate_one_block  0.49587178230285645
generate_one_block  0.500744104385376
generate_one_block  0.5006716251373291
generate_one_block  0.4976167678833008
generate_one_block  0.4941260814666748
generate_one_block  0.48864293098449707
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034303903579711914
gen group dst list time:  0.03688764572143555
time for parepare:  0.019061803817749023
local_output_nid generation:  0.02537083625793457
local_in_edges_tensor generation:  0.03899073600769043
mini_batch_src_global generation:  0.04571533203125
r_  generation:  0.47772765159606934
local_output_nid generation:  0.03339672088623047
local_in_edges_tensor generation:  0.04728817939758301
mini_batch_src_global generation:  0.05847620964050293
r_  generation:  0.48290443420410156
local_output_nid generation:  0.033522844314575195
local_in_edges_tensor generation:  0.03803253173828125
mini_batch_src_global generation:  0.06023979187011719
r_  generation:  0.4842948913574219
local_output_nid generation:  0.03427553176879883
local_in_edges_tensor generation:  0.03957772254943848
mini_batch_src_global generation:  0.054529428482055664
r_  generation:  0.49399304389953613
local_output_nid generation:  0.03449606895446777
local_in_edges_tensor generation:  0.03588724136352539
mini_batch_src_global generation:  0.05916595458984375
r_  generation:  0.48950839042663574
local_output_nid generation:  0.0343015193939209
local_in_edges_tensor generation:  0.030431270599365234
mini_batch_src_global generation:  0.055234432220458984
r_  generation:  0.5020022392272949
local_output_nid generation:  0.03459668159484863
local_in_edges_tensor generation:  0.03526806831359863
mini_batch_src_global generation:  0.055944204330444336
r_  generation:  0.4990377426147461
local_output_nid generation:  0.03904390335083008
local_in_edges_tensor generation:  0.04211282730102539
mini_batch_src_global generation:  0.05763101577758789
r_  generation:  0.5027832984924316
----------------------check_connections_block total spend ----------------------------- 5.865798473358154
generate_one_block  0.6183173656463623
generate_one_block  0.6139636039733887
generate_one_block  0.6385798454284668
generate_one_block  0.6323366165161133
generate_one_block  0.64652419090271
generate_one_block  0.6128356456756592
generate_one_block  0.6534750461578369
generate_one_block  0.6268157958984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  10.242385625839233
block generation total time  8.996753454208374
average batch blocks generation time:  1.1245941817760468
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.0997457504272461  GigaBytes
Max Memory Allocated: 0.0997457504272461  GigaBytes

torch.Size([162138, 128])
torch.Size([145993, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6522216796875 GB
    Memory Allocated: 0.31565427780151367  GigaBytes
Max Memory Allocated: 0.3287525177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10172891616821289  GigaBytes
Max Memory Allocated: 0.3504619598388672  GigaBytes

torch.Size([162364, 128])
torch.Size([145923, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31511402130126953  GigaBytes
Max Memory Allocated: 0.3504619598388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10206365585327148  GigaBytes
Max Memory Allocated: 0.3504619598388672  GigaBytes

torch.Size([162042, 128])
torch.Size([145963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3165745735168457  GigaBytes
Max Memory Allocated: 0.3504619598388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10226297378540039  GigaBytes
Max Memory Allocated: 0.3508901596069336  GigaBytes

torch.Size([162091, 128])
torch.Size([145818, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3169736862182617  GigaBytes
Max Memory Allocated: 0.3508901596069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10214805603027344  GigaBytes
Max Memory Allocated: 0.35156774520874023  GigaBytes

torch.Size([162188, 128])
torch.Size([145968, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31728601455688477  GigaBytes
Max Memory Allocated: 0.35156774520874023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10185575485229492  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162113, 128])
torch.Size([145795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.316225528717041  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10231447219848633  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162252, 128])
torch.Size([146019, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31668901443481445  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10201215744018555  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162130, 128])
torch.Size([145604, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3160848617553711  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043433427810668945 |0.056054770946502686 |0.0931195318698883 |9.807944297790527e-05 |0.010368585586547852 |0.00351715087890625 |
----------------------------------------------------------pseudo_mini_loss sum 5.316220283508301
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3053346
Number of first layer input nodes during this epoch:  1297318
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.14814233779907227  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06295037269592285
range selection method range initialization spend 0.01149749755859375
time for parepare:  0.017412662506103516
local_output_nid generation:  0.0026397705078125
local_in_edges_tensor generation:  0.008751392364501953
mini_batch_src_global generation:  0.0064961910247802734
r_  generation:  0.04074263572692871
local_output_nid generation:  0.0031130313873291016
local_in_edges_tensor generation:  0.0017366409301757812
mini_batch_src_global generation:  0.004913806915283203
r_  generation:  0.04321479797363281
local_output_nid generation:  0.0031092166900634766
local_in_edges_tensor generation:  0.0019936561584472656
mini_batch_src_global generation:  0.003469705581665039
r_  generation:  0.04488062858581543
local_output_nid generation:  0.0031652450561523438
local_in_edges_tensor generation:  0.0017099380493164062
mini_batch_src_global generation:  0.0034949779510498047
r_  generation:  0.04498434066772461
local_output_nid generation:  0.0031545162200927734
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.003734111785888672
r_  generation:  0.047400474548339844
local_output_nid generation:  0.0032148361206054688
local_in_edges_tensor generation:  0.0016798973083496094
mini_batch_src_global generation:  0.003916501998901367
r_  generation:  0.04750347137451172
local_output_nid generation:  0.0031812191009521484
local_in_edges_tensor generation:  0.0018537044525146484
mini_batch_src_global generation:  0.00391840934753418
r_  generation:  0.04671216011047363
local_output_nid generation:  0.003191709518432617
local_in_edges_tensor generation:  0.0017306804656982422
mini_batch_src_global generation:  0.003959178924560547
r_  generation:  0.047075510025024414
----------------------check_connections_block total spend ----------------------------- 0.5403800010681152
generate_one_block  0.0669403076171875
generate_one_block  0.061055660247802734
generate_one_block  0.061774253845214844
generate_one_block  0.06112527847290039
generate_one_block  0.061562299728393555
generate_one_block  0.06248140335083008
generate_one_block  0.0642557144165039
generate_one_block  0.06121325492858887
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0394744873046875
gen group dst list time:  0.016463041305541992
time for parepare:  0.019084453582763672
local_output_nid generation:  0.010628938674926758
local_in_edges_tensor generation:  0.0325922966003418
mini_batch_src_global generation:  0.036449432373046875
r_  generation:  0.3518335819244385
local_output_nid generation:  0.017126083374023438
local_in_edges_tensor generation:  0.03203296661376953
mini_batch_src_global generation:  0.04660153388977051
r_  generation:  0.37023019790649414
local_output_nid generation:  0.0171358585357666
local_in_edges_tensor generation:  0.02617955207824707
mini_batch_src_global generation:  0.04526472091674805
r_  generation:  0.3684859275817871
local_output_nid generation:  0.017406702041625977
local_in_edges_tensor generation:  0.022739887237548828
mini_batch_src_global generation:  0.04884982109069824
r_  generation:  0.3717963695526123
local_output_nid generation:  0.01757645606994629
local_in_edges_tensor generation:  0.029313087463378906
mini_batch_src_global generation:  0.046883583068847656
r_  generation:  0.37967658042907715
local_output_nid generation:  0.017746448516845703
local_in_edges_tensor generation:  0.019338607788085938
mini_batch_src_global generation:  0.049735069274902344
r_  generation:  0.37755703926086426
local_output_nid generation:  0.017850160598754883
local_in_edges_tensor generation:  0.022621631622314453
mini_batch_src_global generation:  0.0469973087310791
r_  generation:  0.37839341163635254
local_output_nid generation:  0.017932653427124023
local_in_edges_tensor generation:  0.019804954528808594
mini_batch_src_global generation:  0.048400163650512695
r_  generation:  0.3781874179840088
----------------------check_connections_block total spend ----------------------------- 4.347681522369385
generate_one_block  0.5003659725189209
generate_one_block  0.5057220458984375
generate_one_block  0.4938986301422119
generate_one_block  0.4941372871398926
generate_one_block  0.4993290901184082
generate_one_block  0.4977283477783203
generate_one_block  0.49695873260498047
generate_one_block  0.5156176090240479
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02866649627685547
gen group dst list time:  0.03767251968383789
time for parepare:  0.01934504508972168
local_output_nid generation:  0.02520155906677246
local_in_edges_tensor generation:  0.038706064224243164
mini_batch_src_global generation:  0.04982948303222656
r_  generation:  0.474621057510376
local_output_nid generation:  0.032190799713134766
local_in_edges_tensor generation:  0.048392534255981445
mini_batch_src_global generation:  0.05595064163208008
r_  generation:  0.48276376724243164
local_output_nid generation:  0.033170223236083984
local_in_edges_tensor generation:  0.04851818084716797
mini_batch_src_global generation:  0.05611705780029297
r_  generation:  0.4902210235595703
local_output_nid generation:  0.03357863426208496
local_in_edges_tensor generation:  0.03716850280761719
mini_batch_src_global generation:  0.05374741554260254
r_  generation:  0.49191975593566895
local_output_nid generation:  0.03403973579406738
local_in_edges_tensor generation:  0.03745889663696289
mini_batch_src_global generation:  0.05525565147399902
r_  generation:  0.489884614944458
local_output_nid generation:  0.03346967697143555
local_in_edges_tensor generation:  0.03664875030517578
mini_batch_src_global generation:  0.055088043212890625
r_  generation:  0.5007779598236084
local_output_nid generation:  0.03383135795593262
local_in_edges_tensor generation:  0.03305220603942871
mini_batch_src_global generation:  0.0556027889251709
r_  generation:  0.4973890781402588
local_output_nid generation:  0.03418922424316406
local_in_edges_tensor generation:  0.03314995765686035
mini_batch_src_global generation:  0.05588197708129883
r_  generation:  0.5012977123260498
----------------------check_connections_block total spend ----------------------------- 5.843298673629761
generate_one_block  0.6145286560058594
generate_one_block  0.6247372627258301
generate_one_block  0.62003493309021
generate_one_block  0.618443489074707
generate_one_block  0.6195240020751953
generate_one_block  0.6133978366851807
generate_one_block  0.6071693897247314
generate_one_block  0.6184449195861816
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.14814233779907227  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

connection checking time:  10.190980195999146
block generation total time  8.940038204193115
average batch blocks generation time:  1.1175047755241394
block dataloader generation time/epoch 21.177638292312622
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10245943069458008  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162139, 128])
torch.Size([145996, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3164944648742676  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10255575180053711  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162040, 128])
torch.Size([145854, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31717872619628906  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10223579406738281  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162311, 128])
torch.Size([146293, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3169059753417969  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10228776931762695  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162192, 128])
torch.Size([145938, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31668615341186523  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10245847702026367  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162192, 128])
torch.Size([146052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3170928955078125  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10236024856567383  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162122, 128])
torch.Size([145934, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31708812713623047  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10230875015258789  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162076, 128])
torch.Size([145745, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3168926239013672  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.10231351852416992  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

torch.Size([162364, 128])
torch.Size([146190, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.31683778762817383  GigaBytes
Max Memory Allocated: 0.35230159759521484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04168263077735901 |0.013063311576843262 |0.0038048624992370605 |9.062886238098145e-05 |0.00442466139793396 |0.0013060569763183594 |
----------------------------------------------------------pseudo_mini_loss sum 4.081387996673584
Total (block generation + training)time/epoch 21.71062183380127
Training time/epoch 0.5326950550079346
Training time without block to device /epoch 0.4281885623931885
Training time without total dataloading part /epoch 0.06786727905273438
load block tensor time/epoch 0.33346104621887207
block to device time/epoch 0.1045064926147461
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3055606
Number of first layer input nodes during this epoch:  1297436
