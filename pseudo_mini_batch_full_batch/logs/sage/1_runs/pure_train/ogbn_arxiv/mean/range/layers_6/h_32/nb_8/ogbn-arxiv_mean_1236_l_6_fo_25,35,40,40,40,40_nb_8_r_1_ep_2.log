Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648514567.713452
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024495840072631836
range selection method range initialization spend 0.013895750045776367
time for parepare:  0.017944812774658203
local_output_nid generation:  0.0030770301818847656
local_in_edges_tensor generation:  0.0046427249908447266
mini_batch_src_global generation:  0.0033931732177734375
r_  generation:  0.03806662559509277
local_output_nid generation:  0.0034689903259277344
local_in_edges_tensor generation:  0.00159454345703125
mini_batch_src_global generation:  0.004290103912353516
r_  generation:  0.03934144973754883
local_output_nid generation:  0.0034749507904052734
local_in_edges_tensor generation:  0.0016949176788330078
mini_batch_src_global generation:  0.0028357505798339844
r_  generation:  0.03851437568664551
local_output_nid generation:  0.003549337387084961
local_in_edges_tensor generation:  0.0016300678253173828
mini_batch_src_global generation:  0.002928018569946289
r_  generation:  0.040595054626464844
local_output_nid generation:  0.0034606456756591797
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.0030384063720703125
r_  generation:  0.042098045349121094
local_output_nid generation:  0.0034770965576171875
local_in_edges_tensor generation:  0.0016715526580810547
mini_batch_src_global generation:  0.003274202346801758
r_  generation:  0.04265022277832031
local_output_nid generation:  0.003592967987060547
local_in_edges_tensor generation:  0.0016598701477050781
mini_batch_src_global generation:  0.003177165985107422
r_  generation:  0.043105363845825195
local_output_nid generation:  0.003648519515991211
local_in_edges_tensor generation:  0.001619100570678711
mini_batch_src_global generation:  0.0032303333282470703
r_  generation:  0.04144692420959473
----------------------check_connections_block total spend ----------------------------- 0.4823780059814453
generate_one_block  0.05399036407470703
generate_one_block  0.05555272102355957
generate_one_block  0.05438828468322754
generate_one_block  0.05591893196105957
generate_one_block  0.05820274353027344
generate_one_block  0.05525064468383789
generate_one_block  0.05478692054748535
generate_one_block  0.05368161201477051
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04159665107727051
gen group dst list time:  0.01519632339477539
time for parepare:  0.019666433334350586
local_output_nid generation:  0.010706901550292969
local_in_edges_tensor generation:  0.02693629264831543
mini_batch_src_global generation:  0.0281674861907959
r_  generation:  0.2949244976043701
local_output_nid generation:  0.017947673797607422
local_in_edges_tensor generation:  0.028878450393676758
mini_batch_src_global generation:  0.043740272521972656
r_  generation:  0.3057889938354492
local_output_nid generation:  0.018235445022583008
local_in_edges_tensor generation:  0.018139362335205078
mini_batch_src_global generation:  0.0429990291595459
r_  generation:  0.3088374137878418
local_output_nid generation:  0.018930673599243164
local_in_edges_tensor generation:  0.021561861038208008
mini_batch_src_global generation:  0.03706192970275879
r_  generation:  0.31043434143066406
local_output_nid generation:  0.019277572631835938
local_in_edges_tensor generation:  0.024295330047607422
mini_batch_src_global generation:  0.040570735931396484
r_  generation:  0.32251524925231934
local_output_nid generation:  0.019347667694091797
local_in_edges_tensor generation:  0.022125959396362305
mini_batch_src_global generation:  0.03859353065490723
r_  generation:  0.3230609893798828
local_output_nid generation:  0.01950216293334961
local_in_edges_tensor generation:  0.021723508834838867
mini_batch_src_global generation:  0.03889584541320801
r_  generation:  0.3183588981628418
local_output_nid generation:  0.019402503967285156
local_in_edges_tensor generation:  0.019025325775146484
mini_batch_src_global generation:  0.03883481025695801
r_  generation:  0.3184525966644287
----------------------check_connections_block total spend ----------------------------- 3.701009511947632
generate_one_block  0.41074705123901367
generate_one_block  0.4117879867553711
generate_one_block  0.3999202251434326
generate_one_block  0.40427422523498535
generate_one_block  0.42786478996276855
generate_one_block  0.4349198341369629
generate_one_block  0.41030454635620117
generate_one_block  0.39992260932922363
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.040097951889038086
gen group dst list time:  0.03578901290893555
time for parepare:  0.019603490829467773
local_output_nid generation:  0.025317668914794922
local_in_edges_tensor generation:  0.04697775840759277
mini_batch_src_global generation:  0.05409049987792969
r_  generation:  0.5203874111175537
local_output_nid generation:  0.03169608116149902
local_in_edges_tensor generation:  0.052215576171875
mini_batch_src_global generation:  0.0605623722076416
r_  generation:  0.5325167179107666
local_output_nid generation:  0.0334012508392334
local_in_edges_tensor generation:  0.04837489128112793
mini_batch_src_global generation:  0.058954715728759766
r_  generation:  0.540337324142456
local_output_nid generation:  0.03289604187011719
local_in_edges_tensor generation:  0.034900665283203125
mini_batch_src_global generation:  0.060941219329833984
r_  generation:  0.5311481952667236
local_output_nid generation:  0.032806396484375
local_in_edges_tensor generation:  0.04635262489318848
mini_batch_src_global generation:  0.060173988342285156
r_  generation:  0.5736184120178223
local_output_nid generation:  0.03364157676696777
local_in_edges_tensor generation:  0.047080039978027344
mini_batch_src_global generation:  0.07116818428039551
r_  generation:  0.5381016731262207
local_output_nid generation:  0.03330254554748535
local_in_edges_tensor generation:  0.040086984634399414
mini_batch_src_global generation:  0.060405731201171875
r_  generation:  0.5458948612213135
local_output_nid generation:  0.033149003982543945
local_in_edges_tensor generation:  0.036518096923828125
mini_batch_src_global generation:  0.06154489517211914
r_  generation:  0.5619330406188965
----------------------check_connections_block total spend ----------------------------- 6.402498483657837
generate_one_block  0.6802487373352051
generate_one_block  0.6835658550262451
generate_one_block  0.6868841648101807
generate_one_block  0.6862099170684814
generate_one_block  0.6930582523345947
generate_one_block  0.6813638210296631
generate_one_block  0.707409143447876
generate_one_block  0.6727337837219238
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04976391792297363
gen group dst list time:  0.04515385627746582
time for parepare:  0.019171953201293945
local_output_nid generation:  0.030603408813476562
local_in_edges_tensor generation:  0.08010149002075195
mini_batch_src_global generation:  0.05233454704284668
r_  generation:  0.5540347099304199
local_output_nid generation:  0.03646540641784668
local_in_edges_tensor generation:  0.053952693939208984
mini_batch_src_global generation:  0.0695047378540039
r_  generation:  0.5594663619995117
local_output_nid generation:  0.03869295120239258
local_in_edges_tensor generation:  0.05076456069946289
mini_batch_src_global generation:  0.06725597381591797
r_  generation:  0.5608346462249756
local_output_nid generation:  0.04117846488952637
local_in_edges_tensor generation:  0.05425572395324707
mini_batch_src_global generation:  0.07872533798217773
r_  generation:  0.5585358142852783
local_output_nid generation:  0.03768801689147949
local_in_edges_tensor generation:  0.04273843765258789
mini_batch_src_global generation:  0.06479072570800781
r_  generation:  0.5715436935424805
local_output_nid generation:  0.03849172592163086
local_in_edges_tensor generation:  0.04058718681335449
mini_batch_src_global generation:  0.060369253158569336
r_  generation:  0.5647757053375244
local_output_nid generation:  0.040712833404541016
local_in_edges_tensor generation:  0.0409700870513916
mini_batch_src_global generation:  0.06889796257019043
r_  generation:  0.5683467388153076
local_output_nid generation:  0.039072513580322266
local_in_edges_tensor generation:  0.03579306602478027
mini_batch_src_global generation:  0.061202049255371094
r_  generation:  0.5723609924316406
----------------------check_connections_block total spend ----------------------------- 6.783411741256714
generate_one_block  0.7090122699737549
generate_one_block  0.7037153244018555
generate_one_block  0.7147321701049805
generate_one_block  0.7064011096954346
generate_one_block  0.7130911350250244
generate_one_block  0.7304327487945557
generate_one_block  0.7677364349365234
generate_one_block  0.6894993782043457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.060263633728027344
gen group dst list time:  0.04779791831970215
time for parepare:  0.019510984420776367
local_output_nid generation:  0.033071041107177734
local_in_edges_tensor generation:  0.04683566093444824
mini_batch_src_global generation:  0.05237102508544922
r_  generation:  0.5533294677734375
local_output_nid generation:  0.038385629653930664
local_in_edges_tensor generation:  0.03375673294067383
mini_batch_src_global generation:  0.06607365608215332
r_  generation:  0.5680985450744629
local_output_nid generation:  0.038634300231933594
local_in_edges_tensor generation:  0.04388236999511719
mini_batch_src_global generation:  0.06369566917419434
r_  generation:  0.5658411979675293
local_output_nid generation:  0.0388340950012207
local_in_edges_tensor generation:  0.05009007453918457
mini_batch_src_global generation:  0.08196520805358887
r_  generation:  0.5650804042816162
local_output_nid generation:  0.04177379608154297
local_in_edges_tensor generation:  0.04111051559448242
mini_batch_src_global generation:  0.06330013275146484
r_  generation:  0.556236743927002
local_output_nid generation:  0.03982210159301758
local_in_edges_tensor generation:  0.04621267318725586
mini_batch_src_global generation:  0.06166362762451172
r_  generation:  0.5597002506256104
local_output_nid generation:  0.040447235107421875
local_in_edges_tensor generation:  0.04482436180114746
mini_batch_src_global generation:  0.06244611740112305
r_  generation:  0.5765182971954346
local_output_nid generation:  0.04003477096557617
local_in_edges_tensor generation:  0.03530597686767578
mini_batch_src_global generation:  0.06187796592712402
r_  generation:  0.558673620223999
----------------------check_connections_block total spend ----------------------------- 6.712052822113037
generate_one_block  0.6859850883483887
generate_one_block  0.6956465244293213
generate_one_block  0.7189500331878662
generate_one_block  0.6872138977050781
generate_one_block  0.687800407409668
generate_one_block  0.6958134174346924
generate_one_block  0.7137060165405273
generate_one_block  0.7236435413360596
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03964734077453613
gen group dst list time:  0.04758882522583008
time for parepare:  0.01930975914001465
local_output_nid generation:  0.031907081604003906
local_in_edges_tensor generation:  0.054198503494262695
mini_batch_src_global generation:  0.054223060607910156
r_  generation:  0.5091753005981445
local_output_nid generation:  0.03898334503173828
local_in_edges_tensor generation:  0.03375983238220215
mini_batch_src_global generation:  0.05886650085449219
r_  generation:  0.5218925476074219
local_output_nid generation:  0.03957104682922363
local_in_edges_tensor generation:  0.04544568061828613
mini_batch_src_global generation:  0.05807614326477051
r_  generation:  0.505964994430542
local_output_nid generation:  0.038745880126953125
local_in_edges_tensor generation:  0.04576992988586426
mini_batch_src_global generation:  0.05903315544128418
r_  generation:  0.5126047134399414
local_output_nid generation:  0.0394136905670166
local_in_edges_tensor generation:  0.03786659240722656
mini_batch_src_global generation:  0.062012434005737305
r_  generation:  0.511225700378418
local_output_nid generation:  0.0393218994140625
local_in_edges_tensor generation:  0.0424954891204834
mini_batch_src_global generation:  0.05858659744262695
r_  generation:  0.5114948749542236
local_output_nid generation:  0.0390629768371582
local_in_edges_tensor generation:  0.04526638984680176
mini_batch_src_global generation:  0.05913829803466797
r_  generation:  0.5085840225219727
local_output_nid generation:  0.039191246032714844
local_in_edges_tensor generation:  0.036553382873535156
mini_batch_src_global generation:  0.05795764923095703
r_  generation:  0.5184519290924072
----------------------check_connections_block total spend ----------------------------- 6.198572397232056
generate_one_block  0.6337912082672119
generate_one_block  0.6519856452941895
generate_one_block  0.6394546031951904
generate_one_block  0.638526439666748
generate_one_block  0.6433885097503662
generate_one_block  0.6484909057617188
generate_one_block  0.6413133144378662
generate_one_block  0.6297640800476074
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

connection checking time:  29.797544956207275
block generation total time  25.261309146881104
average batch blocks generation time:  3.157663643360138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.1385636329650879  GigaBytes
Max Memory Allocated: 0.1385636329650879  GigaBytes

torch.Size([167461, 128])
torch.Size([167039, 32])
torch.Size([165748, 32])
torch.Size([161368, 32])
torch.Size([141889, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.5488076210021973  GigaBytes
Max Memory Allocated: 0.5510268211364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14184093475341797  GigaBytes
Max Memory Allocated: 0.5627493858337402  GigaBytes

torch.Size([167467, 128])
torch.Size([167033, 32])
torch.Size([165727, 32])
torch.Size([161295, 32])
torch.Size([142021, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5492496490478516  GigaBytes
Max Memory Allocated: 0.5627493858337402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14170598983764648  GigaBytes
Max Memory Allocated: 0.5631060600280762  GigaBytes

torch.Size([167484, 128])
torch.Size([167039, 32])
torch.Size([165813, 32])
torch.Size([161273, 32])
torch.Size([141898, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5488524436950684  GigaBytes
Max Memory Allocated: 0.5631060600280762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14174127578735352  GigaBytes
Max Memory Allocated: 0.5631060600280762  GigaBytes

torch.Size([167515, 128])
torch.Size([167072, 32])
torch.Size([165768, 32])
torch.Size([161390, 32])
torch.Size([141964, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5491313934326172  GigaBytes
Max Memory Allocated: 0.5631060600280762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14195966720581055  GigaBytes
Max Memory Allocated: 0.5631060600280762  GigaBytes

torch.Size([167525, 128])
torch.Size([167116, 32])
torch.Size([165934, 32])
torch.Size([161506, 32])
torch.Size([142424, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.549985408782959  GigaBytes
Max Memory Allocated: 0.5631060600280762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14186716079711914  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167553, 128])
torch.Size([167140, 32])
torch.Size([165871, 32])
torch.Size([161451, 32])
torch.Size([142123, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5495624542236328  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1418452262878418  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167513, 128])
torch.Size([167105, 32])
torch.Size([165911, 32])
torch.Size([161518, 32])
torch.Size([142188, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5494704246520996  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14173460006713867  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167445, 128])
torch.Size([167009, 32])
torch.Size([165723, 32])
torch.Size([161255, 32])
torch.Size([141608, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5488901138305664  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05124741792678833 |0.10057693719863892 |0.0951274037361145 |0.00010353326797485352 |0.03606715798377991 |0.0077724456787109375 |
----------------------------------------------------------pseudo_mini_loss sum 5.393090724945068
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6972909
Number of first layer input nodes during this epoch:  1339963
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.2659487724304199  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.049144744873046875
range selection method range initialization spend 0.01529693603515625
time for parepare:  0.016967296600341797
local_output_nid generation:  0.003148794174194336
local_in_edges_tensor generation:  0.004369020462036133
mini_batch_src_global generation:  0.0038864612579345703
r_  generation:  0.03920555114746094
local_output_nid generation:  0.0039632320404052734
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.0042476654052734375
r_  generation:  0.03971576690673828
local_output_nid generation:  0.0041790008544921875
local_in_edges_tensor generation:  0.001699686050415039
mini_batch_src_global generation:  0.002916097640991211
r_  generation:  0.041368961334228516
local_output_nid generation:  0.004159212112426758
local_in_edges_tensor generation:  0.0017249584197998047
mini_batch_src_global generation:  0.0029413700103759766
r_  generation:  0.04196429252624512
local_output_nid generation:  0.004034996032714844
local_in_edges_tensor generation:  0.0017080307006835938
mini_batch_src_global generation:  0.003213167190551758
r_  generation:  0.042662858963012695
local_output_nid generation:  0.0040798187255859375
local_in_edges_tensor generation:  0.0017328262329101562
mini_batch_src_global generation:  0.0032470226287841797
r_  generation:  0.04264020919799805
local_output_nid generation:  0.004091978073120117
local_in_edges_tensor generation:  0.0017240047454833984
mini_batch_src_global generation:  0.003209829330444336
r_  generation:  0.04112410545349121
local_output_nid generation:  0.004025459289550781
local_in_edges_tensor generation:  0.0016765594482421875
mini_batch_src_global generation:  0.0031490325927734375
r_  generation:  0.04217696189880371
----------------------check_connections_block total spend ----------------------------- 0.49628472328186035
generate_one_block  0.05340170860290527
generate_one_block  0.05901980400085449
generate_one_block  0.05575418472290039
generate_one_block  0.05691409111022949
generate_one_block  0.0559077262878418
generate_one_block  0.05704760551452637
generate_one_block  0.05534052848815918
generate_one_block  0.05926775932312012
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04714393615722656
gen group dst list time:  0.015014410018920898
time for parepare:  0.022873640060424805
local_output_nid generation:  0.010880470275878906
local_in_edges_tensor generation:  0.03782033920288086
mini_batch_src_global generation:  0.031219482421875
r_  generation:  0.30291056632995605
local_output_nid generation:  0.019971132278442383
local_in_edges_tensor generation:  0.030592918395996094
mini_batch_src_global generation:  0.03689098358154297
r_  generation:  0.31708455085754395
local_output_nid generation:  0.021245956420898438
local_in_edges_tensor generation:  0.022840499877929688
mini_batch_src_global generation:  0.036637306213378906
r_  generation:  0.3167386054992676
local_output_nid generation:  0.021918296813964844
local_in_edges_tensor generation:  0.020035266876220703
mini_batch_src_global generation:  0.03998303413391113
r_  generation:  0.32102417945861816
local_output_nid generation:  0.022681236267089844
local_in_edges_tensor generation:  0.023990392684936523
mini_batch_src_global generation:  0.04194355010986328
r_  generation:  0.32379913330078125
local_output_nid generation:  0.023741483688354492
local_in_edges_tensor generation:  0.01801156997680664
mini_batch_src_global generation:  0.038788795471191406
r_  generation:  0.3227362632751465
local_output_nid generation:  0.02112603187561035
local_in_edges_tensor generation:  0.017838478088378906
mini_batch_src_global generation:  0.039008378982543945
r_  generation:  0.32653021812438965
local_output_nid generation:  0.02151942253112793
local_in_edges_tensor generation:  0.026079177856445312
mini_batch_src_global generation:  0.03857851028442383
r_  generation:  0.32350707054138184
----------------------check_connections_block total spend ----------------------------- 3.7831106185913086
generate_one_block  0.4134643077850342
generate_one_block  0.42740964889526367
generate_one_block  0.423140287399292
generate_one_block  0.41759324073791504
generate_one_block  0.41626906394958496
generate_one_block  0.41346240043640137
generate_one_block  0.4017486572265625
generate_one_block  0.43666601181030273
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05558180809020996
gen group dst list time:  0.040308237075805664
time for parepare:  0.025704145431518555
local_output_nid generation:  0.02694845199584961
local_in_edges_tensor generation:  0.061707496643066406
mini_batch_src_global generation:  0.05308651924133301
r_  generation:  0.551793098449707
local_output_nid generation:  0.03662705421447754
local_in_edges_tensor generation:  0.05962848663330078
mini_batch_src_global generation:  0.06937146186828613
r_  generation:  0.5302524566650391
local_output_nid generation:  0.034317731857299805
local_in_edges_tensor generation:  0.053078413009643555
mini_batch_src_global generation:  0.056659698486328125
r_  generation:  0.5601842403411865
local_output_nid generation:  0.03482818603515625
local_in_edges_tensor generation:  0.034693002700805664
mini_batch_src_global generation:  0.06345367431640625
r_  generation:  0.5498762130737305
local_output_nid generation:  0.034893035888671875
local_in_edges_tensor generation:  0.03882908821105957
mini_batch_src_global generation:  0.06264185905456543
r_  generation:  0.5884349346160889
local_output_nid generation:  0.038675546646118164
local_in_edges_tensor generation:  0.06184983253479004
mini_batch_src_global generation:  0.07077550888061523
r_  generation:  0.5419764518737793
local_output_nid generation:  0.03528475761413574
local_in_edges_tensor generation:  0.0415647029876709
mini_batch_src_global generation:  0.06282687187194824
r_  generation:  0.560915470123291
local_output_nid generation:  0.03555107116699219
local_in_edges_tensor generation:  0.03712201118469238
mini_batch_src_global generation:  0.0620875358581543
r_  generation:  0.5497210025787354
----------------------check_connections_block total spend ----------------------------- 6.582489967346191
generate_one_block  0.7019634246826172
generate_one_block  0.7107846736907959
generate_one_block  0.6835532188415527
generate_one_block  0.6862719058990479
generate_one_block  0.6984755992889404
generate_one_block  0.6955327987670898
generate_one_block  0.6821792125701904
generate_one_block  0.674943208694458
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04841041564941406
gen group dst list time:  0.06440448760986328
time for parepare:  0.019256114959716797
local_output_nid generation:  0.0311737060546875
local_in_edges_tensor generation:  0.05384087562561035
mini_batch_src_global generation:  0.05465388298034668
r_  generation:  0.5519046783447266
local_output_nid generation:  0.03869891166687012
local_in_edges_tensor generation:  0.08876323699951172
mini_batch_src_global generation:  0.06397485733032227
r_  generation:  0.5601732730865479
local_output_nid generation:  0.03847384452819824
local_in_edges_tensor generation:  0.04128456115722656
mini_batch_src_global generation:  0.06332683563232422
r_  generation:  0.5716016292572021
local_output_nid generation:  0.03725004196166992
local_in_edges_tensor generation:  0.04108738899230957
mini_batch_src_global generation:  0.06452679634094238
r_  generation:  0.5746097564697266
local_output_nid generation:  0.03781557083129883
local_in_edges_tensor generation:  0.040845632553100586
mini_batch_src_global generation:  0.06461596488952637
r_  generation:  0.5725114345550537
local_output_nid generation:  0.037903785705566406
local_in_edges_tensor generation:  0.04128384590148926
mini_batch_src_global generation:  0.06028437614440918
r_  generation:  0.5750892162322998
local_output_nid generation:  0.039179325103759766
local_in_edges_tensor generation:  0.047335147857666016
mini_batch_src_global generation:  0.06026434898376465
r_  generation:  0.5755705833435059
local_output_nid generation:  0.03785848617553711
local_in_edges_tensor generation:  0.04159832000732422
mini_batch_src_global generation:  0.060872793197631836
r_  generation:  0.5762226581573486
----------------------check_connections_block total spend ----------------------------- 6.800662279129028
generate_one_block  0.732640266418457
generate_one_block  0.734053373336792
generate_one_block  0.7003822326660156
generate_one_block  0.7058515548706055
generate_one_block  0.7129960060119629
generate_one_block  0.7109649181365967
generate_one_block  0.7179877758026123
generate_one_block  0.7213561534881592
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0377659797668457
gen group dst list time:  0.055994510650634766
time for parepare:  0.019024372100830078
local_output_nid generation:  0.03162360191345215
local_in_edges_tensor generation:  0.04502272605895996
mini_batch_src_global generation:  0.04882621765136719
r_  generation:  0.544450044631958
local_output_nid generation:  0.0377197265625
local_in_edges_tensor generation:  0.0393674373626709
mini_batch_src_global generation:  0.06610274314880371
r_  generation:  0.5502336025238037
local_output_nid generation:  0.038759469985961914
local_in_edges_tensor generation:  0.03964400291442871
mini_batch_src_global generation:  0.06291580200195312
r_  generation:  0.5482430458068848
local_output_nid generation:  0.038652658462524414
local_in_edges_tensor generation:  0.039691925048828125
mini_batch_src_global generation:  0.0649874210357666
r_  generation:  0.547722339630127
local_output_nid generation:  0.039136648178100586
local_in_edges_tensor generation:  0.04546642303466797
mini_batch_src_global generation:  0.07686424255371094
r_  generation:  0.5627527236938477
local_output_nid generation:  0.03972268104553223
local_in_edges_tensor generation:  0.08387351036071777
mini_batch_src_global generation:  0.06553268432617188
r_  generation:  0.5518803596496582
local_output_nid generation:  0.0393984317779541
local_in_edges_tensor generation:  0.03620266914367676
mini_batch_src_global generation:  0.061263084411621094
r_  generation:  0.5569195747375488
local_output_nid generation:  0.041188716888427734
local_in_edges_tensor generation:  0.0400698184967041
mini_batch_src_global generation:  0.06497359275817871
r_  generation:  0.557727575302124
----------------------check_connections_block total spend ----------------------------- 6.641564846038818
generate_one_block  0.6810669898986816
generate_one_block  0.6973106861114502
generate_one_block  0.685168981552124
generate_one_block  0.6914489269256592
generate_one_block  0.6928865909576416
generate_one_block  0.7053971290588379
generate_one_block  0.6994755268096924
generate_one_block  0.7016856670379639
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046912193298339844
gen group dst list time:  0.047736167907714844
time for parepare:  0.019658565521240234
local_output_nid generation:  0.03314566612243652
local_in_edges_tensor generation:  0.048879384994506836
mini_batch_src_global generation:  0.04788947105407715
r_  generation:  0.506645917892456
local_output_nid generation:  0.04067540168762207
local_in_edges_tensor generation:  0.040343523025512695
mini_batch_src_global generation:  0.05785632133483887
r_  generation:  0.5311064720153809
local_output_nid generation:  0.04285478591918945
local_in_edges_tensor generation:  0.03546309471130371
mini_batch_src_global generation:  0.05878734588623047
r_  generation:  0.5145292282104492
local_output_nid generation:  0.038649559020996094
local_in_edges_tensor generation:  0.03753852844238281
mini_batch_src_global generation:  0.05830645561218262
r_  generation:  0.5178985595703125
local_output_nid generation:  0.04147696495056152
local_in_edges_tensor generation:  0.03612852096557617
mini_batch_src_global generation:  0.05829811096191406
r_  generation:  0.513655424118042
local_output_nid generation:  0.039989471435546875
local_in_edges_tensor generation:  0.03952288627624512
mini_batch_src_global generation:  0.05871844291687012
r_  generation:  0.5197494029998779
local_output_nid generation:  0.04070758819580078
local_in_edges_tensor generation:  0.044922828674316406
mini_batch_src_global generation:  0.05873918533325195
r_  generation:  0.511699914932251
local_output_nid generation:  0.04028892517089844
local_in_edges_tensor generation:  0.04946088790893555
mini_batch_src_global generation:  0.05834627151489258
r_  generation:  0.5142085552215576
----------------------check_connections_block total spend ----------------------------- 6.216476917266846
generate_one_block  0.6654040813446045
generate_one_block  0.642561674118042
generate_one_block  0.6403312683105469
generate_one_block  0.642261266708374
generate_one_block  0.6440219879150391
generate_one_block  0.6527817249298096
generate_one_block  0.6487975120544434
generate_one_block  0.6423652172088623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.2659487724304199  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

connection checking time:  30.024304628372192
block generation total time  25.352655172348022
average batch blocks generation time:  3.169081896543503
block dataloader generation time/epoch 58.30586266517639
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14197540283203125  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167540, 128])
torch.Size([167091, 32])
torch.Size([165743, 32])
torch.Size([161306, 32])
torch.Size([141966, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5494370460510254  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1421065330505371  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167533, 128])
torch.Size([167064, 32])
torch.Size([165811, 32])
torch.Size([161457, 32])
torch.Size([142184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5498700141906738  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14197731018066406  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167534, 128])
torch.Size([167065, 32])
torch.Size([165706, 32])
torch.Size([161214, 32])
torch.Size([142023, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5496249198913574  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14202308654785156  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167559, 128])
torch.Size([167087, 32])
torch.Size([165748, 32])
torch.Size([161300, 32])
torch.Size([142079, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5497584342956543  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14203643798828125  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167537, 128])
torch.Size([167102, 32])
torch.Size([165798, 32])
torch.Size([161379, 32])
torch.Size([142154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5499210357666016  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14189577102661133  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167533, 128])
torch.Size([167078, 32])
torch.Size([165782, 32])
torch.Size([161393, 32])
torch.Size([142092, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5492410659790039  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14192819595336914  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167531, 128])
torch.Size([167080, 32])
torch.Size([165823, 32])
torch.Size([161457, 32])
torch.Size([142051, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5491275787353516  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14190053939819336  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

torch.Size([167554, 128])
torch.Size([167110, 32])
torch.Size([165793, 32])
torch.Size([161310, 32])
torch.Size([141516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5489177703857422  GigaBytes
Max Memory Allocated: 0.564115047454834  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06954771280288696 |0.05033022165298462 |0.006630241870880127 |9.340047836303711e-05 |0.007697463035583496 |0.005687713623046875 |
----------------------------------------------------------pseudo_mini_loss sum 4.805737018585205
Total (block generation + training)time/epoch 59.44481348991394
Training time/epoch 1.1386792659759521
Training time without block to device /epoch 0.7360374927520752
Training time without total dataloading part /epoch 0.12105655670166016
load block tensor time/epoch 0.5563817024230957
block to device time/epoch 0.40264177322387695
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6973372
Number of first layer input nodes during this epoch:  1340321
