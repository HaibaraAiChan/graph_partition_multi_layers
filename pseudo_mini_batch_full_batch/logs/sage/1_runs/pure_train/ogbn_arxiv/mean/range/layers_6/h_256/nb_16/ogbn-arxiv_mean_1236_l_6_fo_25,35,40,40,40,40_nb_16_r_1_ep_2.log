Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648519739.7039702
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024125099182128906
range selection method range initialization spend 0.013248443603515625
time for parepare:  0.017895936965942383
local_output_nid generation:  0.0013279914855957031
local_in_edges_tensor generation:  0.003794431686401367
mini_batch_src_global generation:  0.0017566680908203125
r_  generation:  0.017886638641357422
local_output_nid generation:  0.0014181137084960938
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.002116680145263672
r_  generation:  0.017301321029663086
local_output_nid generation:  0.00145721435546875
local_in_edges_tensor generation:  0.0009124279022216797
mini_batch_src_global generation:  0.0013506412506103516
r_  generation:  0.017665624618530273
local_output_nid generation:  0.0014362335205078125
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0012431144714355469
r_  generation:  0.017256736755371094
local_output_nid generation:  0.001438140869140625
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0014426708221435547
r_  generation:  0.017845869064331055
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0008230209350585938
mini_batch_src_global generation:  0.0014033317565917969
r_  generation:  0.018239259719848633
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.0014884471893310547
r_  generation:  0.018395423889160156
local_output_nid generation:  0.0014595985412597656
local_in_edges_tensor generation:  0.0008313655853271484
mini_batch_src_global generation:  0.0015110969543457031
r_  generation:  0.0186460018157959
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.017699003219604492
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0013535022735595703
r_  generation:  0.019530773162841797
local_output_nid generation:  0.0016922950744628906
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.001575469970703125
r_  generation:  0.020102262496948242
local_output_nid generation:  0.0017342567443847656
local_in_edges_tensor generation:  0.0009725093841552734
mini_batch_src_global generation:  0.0016565322875976562
r_  generation:  0.01920914649963379
local_output_nid generation:  0.0016372203826904297
local_in_edges_tensor generation:  0.0009448528289794922
mini_batch_src_global generation:  0.0015742778778076172
r_  generation:  0.018946170806884766
local_output_nid generation:  0.0016849040985107422
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0015530586242675781
r_  generation:  0.01912856101989746
local_output_nid generation:  0.0016117095947265625
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.019114017486572266
local_output_nid generation:  0.0015461444854736328
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.019212961196899414
----------------------check_connections_block total spend ----------------------------- 0.4472682476043701
generate_one_block  0.02750873565673828
generate_one_block  0.027329444885253906
generate_one_block  0.02728581428527832
generate_one_block  0.0285491943359375
generate_one_block  0.027061939239501953
generate_one_block  0.027369022369384766
generate_one_block  0.02765631675720215
generate_one_block  0.028041839599609375
generate_one_block  0.026765108108520508
generate_one_block  0.02739262580871582
generate_one_block  0.027782917022705078
generate_one_block  0.026961803436279297
generate_one_block  0.02772235870361328
generate_one_block  0.028191328048706055
generate_one_block  0.028227567672729492
generate_one_block  0.027820110321044922
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0414729118347168
gen group dst list time:  0.018501758575439453
time for parepare:  0.019388437271118164
local_output_nid generation:  0.006493806838989258
local_in_edges_tensor generation:  0.017524242401123047
mini_batch_src_global generation:  0.020796775817871094
r_  generation:  0.1963667869567871
local_output_nid generation:  0.010015010833740234
local_in_edges_tensor generation:  0.018487930297851562
mini_batch_src_global generation:  0.025240421295166016
r_  generation:  0.2044353485107422
local_output_nid generation:  0.010280609130859375
local_in_edges_tensor generation:  0.016931533813476562
mini_batch_src_global generation:  0.02388477325439453
r_  generation:  0.21164155006408691
local_output_nid generation:  0.010458946228027344
local_in_edges_tensor generation:  0.01173257827758789
mini_batch_src_global generation:  0.024440288543701172
r_  generation:  0.20953154563903809
local_output_nid generation:  0.010570526123046875
local_in_edges_tensor generation:  0.011679649353027344
mini_batch_src_global generation:  0.025375843048095703
r_  generation:  0.2111186981201172
local_output_nid generation:  0.010789871215820312
local_in_edges_tensor generation:  0.017262697219848633
mini_batch_src_global generation:  0.0259246826171875
r_  generation:  0.218031644821167
local_output_nid generation:  0.011024951934814453
local_in_edges_tensor generation:  0.017442941665649414
mini_batch_src_global generation:  0.026625633239746094
r_  generation:  0.21764779090881348
local_output_nid generation:  0.011047601699829102
local_in_edges_tensor generation:  0.015970945358276367
mini_batch_src_global generation:  0.027347564697265625
r_  generation:  0.22181248664855957
local_output_nid generation:  0.010976791381835938
local_in_edges_tensor generation:  0.011940956115722656
mini_batch_src_global generation:  0.026720523834228516
r_  generation:  0.21180081367492676
local_output_nid generation:  0.011170387268066406
local_in_edges_tensor generation:  0.012384176254272461
mini_batch_src_global generation:  0.027215003967285156
r_  generation:  0.21580767631530762
local_output_nid generation:  0.011363744735717773
local_in_edges_tensor generation:  0.019322633743286133
mini_batch_src_global generation:  0.02718067169189453
r_  generation:  0.224395751953125
local_output_nid generation:  0.0111236572265625
local_in_edges_tensor generation:  0.012180805206298828
mini_batch_src_global generation:  0.027180194854736328
r_  generation:  0.21712303161621094
local_output_nid generation:  0.011297941207885742
local_in_edges_tensor generation:  0.012265443801879883
mini_batch_src_global generation:  0.027472734451293945
r_  generation:  0.22294902801513672
local_output_nid generation:  0.011199951171875
local_in_edges_tensor generation:  0.01254129409790039
mini_batch_src_global generation:  0.027150869369506836
r_  generation:  0.21082830429077148
local_output_nid generation:  0.011481046676635742
local_in_edges_tensor generation:  0.01605701446533203
mini_batch_src_global generation:  0.02863931655883789
r_  generation:  0.22127676010131836
local_output_nid generation:  0.011486291885375977
local_in_edges_tensor generation:  0.016528606414794922
mini_batch_src_global generation:  0.02756810188293457
r_  generation:  0.22264719009399414
----------------------check_connections_block total spend ----------------------------- 5.042294263839722
generate_one_block  0.2747535705566406
generate_one_block  0.2759122848510742
generate_one_block  0.2835536003112793
generate_one_block  0.276547908782959
generate_one_block  0.29241323471069336
generate_one_block  0.2781529426574707
generate_one_block  0.28165578842163086
generate_one_block  0.2900419235229492
generate_one_block  0.270153284072876
generate_one_block  0.2811903953552246
generate_one_block  0.2896449565887451
generate_one_block  0.281597375869751
generate_one_block  0.28456759452819824
generate_one_block  0.27447056770324707
generate_one_block  0.2915468215942383
generate_one_block  0.28334736824035645
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0616755485534668
gen group dst list time:  0.06774640083312988
time for parepare:  0.021166086196899414
local_output_nid generation:  0.02454066276550293
local_in_edges_tensor generation:  0.07436156272888184
mini_batch_src_global generation:  0.05085277557373047
r_  generation:  0.48422813415527344
local_output_nid generation:  0.029649972915649414
local_in_edges_tensor generation:  0.05231213569641113
mini_batch_src_global generation:  0.05991697311401367
r_  generation:  0.48946666717529297
local_output_nid generation:  0.03461122512817383
local_in_edges_tensor generation:  0.03728437423706055
mini_batch_src_global generation:  0.0695180892944336
r_  generation:  0.4950141906738281
local_output_nid generation:  0.030731916427612305
local_in_edges_tensor generation:  0.03653359413146973
mini_batch_src_global generation:  0.061783790588378906
r_  generation:  0.4939572811126709
local_output_nid generation:  0.030493974685668945
local_in_edges_tensor generation:  0.03222823143005371
mini_batch_src_global generation:  0.05780911445617676
r_  generation:  0.4978830814361572
local_output_nid generation:  0.030845165252685547
local_in_edges_tensor generation:  0.03710746765136719
mini_batch_src_global generation:  0.06649065017700195
r_  generation:  0.49465465545654297
local_output_nid generation:  0.031259775161743164
local_in_edges_tensor generation:  0.042752742767333984
mini_batch_src_global generation:  0.06165671348571777
r_  generation:  0.5014505386352539
local_output_nid generation:  0.03069591522216797
local_in_edges_tensor generation:  0.03832411766052246
mini_batch_src_global generation:  0.0626378059387207
r_  generation:  0.4981071949005127
local_output_nid generation:  0.030957460403442383
local_in_edges_tensor generation:  0.03304862976074219
mini_batch_src_global generation:  0.0655522346496582
r_  generation:  0.5108456611633301
local_output_nid generation:  0.030988216400146484
local_in_edges_tensor generation:  0.032987117767333984
mini_batch_src_global generation:  0.06354880332946777
r_  generation:  0.5010108947753906
local_output_nid generation:  0.031304121017456055
local_in_edges_tensor generation:  0.04587435722351074
mini_batch_src_global generation:  0.05805635452270508
r_  generation:  0.5126698017120361
local_output_nid generation:  0.0308992862701416
local_in_edges_tensor generation:  0.03354454040527344
mini_batch_src_global generation:  0.06125831604003906
r_  generation:  0.49502110481262207
local_output_nid generation:  0.03098130226135254
local_in_edges_tensor generation:  0.03385567665100098
mini_batch_src_global generation:  0.06219887733459473
r_  generation:  0.5071980953216553
local_output_nid generation:  0.03231167793273926
local_in_edges_tensor generation:  0.03899025917053223
mini_batch_src_global generation:  0.06818294525146484
r_  generation:  0.4975473880767822
local_output_nid generation:  0.03138446807861328
local_in_edges_tensor generation:  0.03696632385253906
mini_batch_src_global generation:  0.0591433048248291
r_  generation:  0.5047159194946289
local_output_nid generation:  0.031441450119018555
local_in_edges_tensor generation:  0.042667388916015625
mini_batch_src_global generation:  0.08004069328308105
r_  generation:  0.514824628829956
----------------------check_connections_block total spend ----------------------------- 11.902467250823975
generate_one_block  0.6669571399688721
generate_one_block  0.657034158706665
generate_one_block  0.6529326438903809
generate_one_block  0.6779170036315918
generate_one_block  0.6511819362640381
generate_one_block  0.6486461162567139
generate_one_block  0.7296814918518066
generate_one_block  0.6697173118591309
generate_one_block  0.6312205791473389
generate_one_block  0.644366979598999
generate_one_block  0.6376116275787354
generate_one_block  0.6334025859832764
generate_one_block  0.6509625911712646
generate_one_block  0.6390442848205566
generate_one_block  0.6568455696105957
generate_one_block  0.6578733921051025
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06081080436706543
gen group dst list time:  0.0845792293548584
time for parepare:  0.01999187469482422
local_output_nid generation:  0.03126382827758789
local_in_edges_tensor generation:  0.06026482582092285
mini_batch_src_global generation:  0.053925514221191406
r_  generation:  0.5340218544006348
local_output_nid generation:  0.036925554275512695
local_in_edges_tensor generation:  0.05432844161987305
mini_batch_src_global generation:  0.06297755241394043
r_  generation:  0.537194013595581
local_output_nid generation:  0.03630471229553223
local_in_edges_tensor generation:  0.04037618637084961
mini_batch_src_global generation:  0.0597226619720459
r_  generation:  0.5426461696624756
local_output_nid generation:  0.03673243522644043
local_in_edges_tensor generation:  0.04488253593444824
mini_batch_src_global generation:  0.059177398681640625
r_  generation:  0.5459787845611572
local_output_nid generation:  0.0366969108581543
local_in_edges_tensor generation:  0.04114246368408203
mini_batch_src_global generation:  0.05824446678161621
r_  generation:  0.5527102947235107
local_output_nid generation:  0.03666543960571289
local_in_edges_tensor generation:  0.04037737846374512
mini_batch_src_global generation:  0.06016349792480469
r_  generation:  0.5541181564331055
local_output_nid generation:  0.03704524040222168
local_in_edges_tensor generation:  0.040364742279052734
mini_batch_src_global generation:  0.06010556221008301
r_  generation:  0.5597856044769287
local_output_nid generation:  0.036954641342163086
local_in_edges_tensor generation:  0.04612302780151367
mini_batch_src_global generation:  0.0610048770904541
r_  generation:  0.5633351802825928
local_output_nid generation:  0.03726339340209961
local_in_edges_tensor generation:  0.03624391555786133
mini_batch_src_global generation:  0.06148552894592285
r_  generation:  0.5638995170593262
local_output_nid generation:  0.03716135025024414
local_in_edges_tensor generation:  0.055651187896728516
mini_batch_src_global generation:  0.06532025337219238
r_  generation:  0.5606222152709961
local_output_nid generation:  0.03732776641845703
local_in_edges_tensor generation:  0.04021644592285156
mini_batch_src_global generation:  0.0615842342376709
r_  generation:  0.5658929347991943
local_output_nid generation:  0.03700709342956543
local_in_edges_tensor generation:  0.03613877296447754
mini_batch_src_global generation:  0.06265854835510254
r_  generation:  0.5704038143157959
local_output_nid generation:  0.03867840766906738
local_in_edges_tensor generation:  0.03665614128112793
mini_batch_src_global generation:  0.062329769134521484
r_  generation:  0.5660653114318848
local_output_nid generation:  0.03757476806640625
local_in_edges_tensor generation:  0.045607566833496094
mini_batch_src_global generation:  0.061957597732543945
r_  generation:  0.5658130645751953
local_output_nid generation:  0.03765702247619629
local_in_edges_tensor generation:  0.04065394401550293
mini_batch_src_global generation:  0.061601877212524414
r_  generation:  0.5643153190612793
local_output_nid generation:  0.03755950927734375
local_in_edges_tensor generation:  0.042508840560913086
mini_batch_src_global generation:  0.06267809867858887
r_  generation:  0.564965009689331
----------------------check_connections_block total spend ----------------------------- 13.253233909606934
generate_one_block  0.6825447082519531
generate_one_block  0.7105236053466797
generate_one_block  0.6835885047912598
generate_one_block  0.7700276374816895
generate_one_block  0.6941020488739014
generate_one_block  0.6907825469970703
generate_one_block  0.692312479019165
generate_one_block  0.7111577987670898
generate_one_block  0.7051606178283691
generate_one_block  0.7000739574432373
generate_one_block  0.7041034698486328
generate_one_block  0.6972427368164062
generate_one_block  0.6934621334075928
generate_one_block  0.6980392932891846
generate_one_block  0.6844289302825928
generate_one_block  0.7196965217590332
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05135846138000488
gen group dst list time:  0.10503864288330078
time for parepare:  0.018933534622192383
local_output_nid generation:  0.033473968505859375
local_in_edges_tensor generation:  0.0576934814453125
mini_batch_src_global generation:  0.04928016662597656
r_  generation:  0.5305202007293701
local_output_nid generation:  0.04016590118408203
local_in_edges_tensor generation:  0.04250144958496094
mini_batch_src_global generation:  0.06233978271484375
r_  generation:  0.5350131988525391
local_output_nid generation:  0.037697553634643555
local_in_edges_tensor generation:  0.03667736053466797
mini_batch_src_global generation:  0.06281590461730957
r_  generation:  0.5381479263305664
local_output_nid generation:  0.03802847862243652
local_in_edges_tensor generation:  0.04157567024230957
mini_batch_src_global generation:  0.06091642379760742
r_  generation:  0.5390164852142334
local_output_nid generation:  0.03823089599609375
local_in_edges_tensor generation:  0.046729087829589844
mini_batch_src_global generation:  0.06164360046386719
r_  generation:  0.539635181427002
local_output_nid generation:  0.03846430778503418
local_in_edges_tensor generation:  0.041820526123046875
mini_batch_src_global generation:  0.06118488311767578
r_  generation:  0.5429377555847168
local_output_nid generation:  0.03843069076538086
local_in_edges_tensor generation:  0.04137849807739258
mini_batch_src_global generation:  0.06235694885253906
r_  generation:  0.5429708957672119
local_output_nid generation:  0.039582252502441406
local_in_edges_tensor generation:  0.03753829002380371
mini_batch_src_global generation:  0.061095237731933594
r_  generation:  0.5471365451812744
local_output_nid generation:  0.03882789611816406
local_in_edges_tensor generation:  0.04177546501159668
mini_batch_src_global generation:  0.06139945983886719
r_  generation:  0.5459940433502197
local_output_nid generation:  0.03868889808654785
local_in_edges_tensor generation:  0.04691910743713379
mini_batch_src_global generation:  0.06087899208068848
r_  generation:  0.5545060634613037
local_output_nid generation:  0.038990020751953125
local_in_edges_tensor generation:  0.0522003173828125
mini_batch_src_global generation:  0.06146359443664551
r_  generation:  0.5588183403015137
local_output_nid generation:  0.039139509201049805
local_in_edges_tensor generation:  0.03771805763244629
mini_batch_src_global generation:  0.06129908561706543
r_  generation:  0.5532522201538086
local_output_nid generation:  0.038930416107177734
local_in_edges_tensor generation:  0.03734755516052246
mini_batch_src_global generation:  0.06193971633911133
r_  generation:  0.557300329208374
local_output_nid generation:  0.03900957107543945
local_in_edges_tensor generation:  0.051603078842163086
mini_batch_src_global generation:  0.06055736541748047
r_  generation:  0.5517642498016357
local_output_nid generation:  0.03875446319580078
local_in_edges_tensor generation:  0.041465044021606445
mini_batch_src_global generation:  0.06026792526245117
r_  generation:  0.5610885620117188
local_output_nid generation:  0.039629220962524414
local_in_edges_tensor generation:  0.04184293746948242
mini_batch_src_global generation:  0.06209087371826172
r_  generation:  0.5704822540283203
----------------------check_connections_block total spend ----------------------------- 13.126184463500977
generate_one_block  0.6817443370819092
generate_one_block  0.6907575130462646
generate_one_block  0.6737957000732422
generate_one_block  0.6861579418182373
generate_one_block  0.6952733993530273
generate_one_block  0.6840367317199707
generate_one_block  0.7338783740997314
generate_one_block  0.6738553047180176
generate_one_block  0.6857781410217285
generate_one_block  0.6965911388397217
generate_one_block  0.6972250938415527
generate_one_block  0.6689813137054443
generate_one_block  0.6775705814361572
generate_one_block  0.6975893974304199
generate_one_block  0.6793372631072998
generate_one_block  0.6904315948486328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03630375862121582
gen group dst list time:  0.09438657760620117
time for parepare:  0.019069433212280273
local_output_nid generation:  0.03600502014160156
local_in_edges_tensor generation:  0.05612063407897949
mini_batch_src_global generation:  0.045725107192993164
r_  generation:  0.5033855438232422
local_output_nid generation:  0.04245400428771973
local_in_edges_tensor generation:  0.03632926940917969
mini_batch_src_global generation:  0.06035113334655762
r_  generation:  0.5014369487762451
local_output_nid generation:  0.03980755805969238
local_in_edges_tensor generation:  0.03969526290893555
mini_batch_src_global generation:  0.058882713317871094
r_  generation:  0.5046570301055908
local_output_nid generation:  0.03948330879211426
local_in_edges_tensor generation:  0.03962874412536621
mini_batch_src_global generation:  0.06115984916687012
r_  generation:  0.5202727317810059
local_output_nid generation:  0.03977060317993164
local_in_edges_tensor generation:  0.04948878288269043
mini_batch_src_global generation:  0.0653696060180664
r_  generation:  0.5052874088287354
local_output_nid generation:  0.03963828086853027
local_in_edges_tensor generation:  0.0450742244720459
mini_batch_src_global generation:  0.05799698829650879
r_  generation:  0.5053200721740723
local_output_nid generation:  0.03966188430786133
local_in_edges_tensor generation:  0.0375819206237793
mini_batch_src_global generation:  0.057784080505371094
r_  generation:  0.519895076751709
local_output_nid generation:  0.04266810417175293
local_in_edges_tensor generation:  0.046334028244018555
mini_batch_src_global generation:  0.05822038650512695
r_  generation:  0.50836181640625
local_output_nid generation:  0.04074239730834961
local_in_edges_tensor generation:  0.0425410270690918
mini_batch_src_global generation:  0.057920217514038086
r_  generation:  0.5053331851959229
local_output_nid generation:  0.040833473205566406
local_in_edges_tensor generation:  0.05181264877319336
mini_batch_src_global generation:  0.0576024055480957
r_  generation:  0.5130319595336914
local_output_nid generation:  0.04110240936279297
local_in_edges_tensor generation:  0.04229545593261719
mini_batch_src_global generation:  0.060962677001953125
r_  generation:  0.5074646472930908
local_output_nid generation:  0.04121708869934082
local_in_edges_tensor generation:  0.03807806968688965
mini_batch_src_global generation:  0.06064772605895996
r_  generation:  0.5124099254608154
local_output_nid generation:  0.04085493087768555
local_in_edges_tensor generation:  0.046388864517211914
mini_batch_src_global generation:  0.0713050365447998
r_  generation:  0.5112450122833252
local_output_nid generation:  0.041051387786865234
local_in_edges_tensor generation:  0.04063272476196289
mini_batch_src_global generation:  0.058583974838256836
r_  generation:  0.5090172290802002
local_output_nid generation:  0.041028738021850586
local_in_edges_tensor generation:  0.042252302169799805
mini_batch_src_global generation:  0.05883646011352539
r_  generation:  0.5086016654968262
local_output_nid generation:  0.04085969924926758
local_in_edges_tensor generation:  0.04634428024291992
mini_batch_src_global generation:  0.06045818328857422
r_  generation:  0.5101428031921387
----------------------check_connections_block total spend ----------------------------- 12.39743947982788
generate_one_block  0.6390888690948486
generate_one_block  0.6416788101196289
generate_one_block  0.6383295059204102
generate_one_block  0.6429290771484375
generate_one_block  0.6417076587677002
generate_one_block  0.6370525360107422
generate_one_block  0.6231951713562012
generate_one_block  0.628211498260498
generate_one_block  0.7060990333557129
generate_one_block  0.6517550945281982
generate_one_block  0.6493086814880371
generate_one_block  0.6318886280059814
generate_one_block  0.6460089683532715
generate_one_block  0.6389636993408203
generate_one_block  0.6352124214172363
generate_one_block  0.6512510776519775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022950172424316406  GigaBytes
Max Memory Allocated: 0.0022950172424316406  GigaBytes

connection checking time:  55.72161936759949
block generation total time  47.56787657737732
average batch blocks generation time:  2.9729922860860825
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.1372060775756836  GigaBytes
Max Memory Allocated: 0.1372060775756836  GigaBytes

torch.Size([167294, 128])
torch.Size([166485, 256])
torch.Size([164143, 256])
torch.Size([156119, 256])
torch.Size([124124, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2772216796875 GB
    Memory Allocated: 2.7655844688415527  GigaBytes
Max Memory Allocated: 2.8031582832336426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 0.14150238037109375  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167226, 128])
torch.Size([166412, 256])
torch.Size([164074, 256])
torch.Size([155697, 256])
torch.Size([123361, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7609453201293945  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.1414942741394043  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167232, 128])
torch.Size([166385, 256])
torch.Size([163897, 256])
torch.Size([155573, 256])
torch.Size([123697, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.764749526977539  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.1414928436279297  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167241, 128])
torch.Size([166423, 256])
torch.Size([163954, 256])
torch.Size([155808, 256])
torch.Size([123578, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7594547271728516  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14145565032958984  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167262, 128])
torch.Size([166414, 256])
torch.Size([163992, 256])
torch.Size([155746, 256])
torch.Size([122896, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7562050819396973  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14149904251098633  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167233, 128])
torch.Size([166417, 256])
torch.Size([163907, 256])
torch.Size([155607, 256])
torch.Size([123222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7591519355773926  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14151763916015625  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167214, 128])
torch.Size([166353, 256])
torch.Size([163954, 256])
torch.Size([155671, 256])
torch.Size([123617, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.763768196105957  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14154481887817383  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

torch.Size([167168, 128])
torch.Size([166327, 256])
torch.Size([163881, 256])
torch.Size([155640, 256])
torch.Size([123995, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.769468307495117  GigaBytes
Max Memory Allocated: 2.8443775177001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14147281646728516  GigaBytes
Max Memory Allocated: 2.848659038543701  GigaBytes

torch.Size([167214, 128])
torch.Size([166380, 256])
torch.Size([163956, 256])
torch.Size([155735, 256])
torch.Size([123454, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7583627700805664  GigaBytes
Max Memory Allocated: 2.848659038543701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14155149459838867  GigaBytes
Max Memory Allocated: 2.848659038543701  GigaBytes

torch.Size([167293, 128])
torch.Size([166483, 256])
torch.Size([164138, 256])
torch.Size([156152, 256])
torch.Size([124563, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.773312568664551  GigaBytes
Max Memory Allocated: 2.848659038543701  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14152097702026367  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167287, 128])
torch.Size([166523, 256])
torch.Size([164083, 256])
torch.Size([155809, 256])
torch.Size([123800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7677488327026367  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.1414628028869629  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167234, 128])
torch.Size([166364, 256])
torch.Size([163871, 256])
torch.Size([155346, 256])
torch.Size([122800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7550711631774902  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14151668548583984  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167261, 128])
torch.Size([166449, 256])
torch.Size([163968, 256])
torch.Size([155740, 256])
torch.Size([123709, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.76582670211792  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.1414790153503418  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167244, 128])
torch.Size([166477, 256])
torch.Size([164195, 256])
torch.Size([156106, 256])
torch.Size([123729, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7653918266296387  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.1415257453918457  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167269, 128])
torch.Size([166449, 256])
torch.Size([163950, 256])
torch.Size([155654, 256])
torch.Size([123989, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.771268844604492  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 0.14154291152954102  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167300, 128])
torch.Size([166536, 256])
torch.Size([164178, 256])
torch.Size([155937, 256])
torch.Size([124119, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 2.7725038528442383  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2227378636598587 |0.07053166627883911 |0.0514887273311615 |9.846687316894531e-05 |0.04455128312110901 |0.008709907531738281 |
----------------------------------------------------------pseudo_mini_loss sum 6.376347541809082
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13095154
Number of first layer input nodes during this epoch:  2675972
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 0.25119733810424805  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024748802185058594
range selection method range initialization spend 0.011472702026367188
time for parepare:  0.016905784606933594
local_output_nid generation:  0.0013272762298583984
local_in_edges_tensor generation:  0.0057125091552734375
mini_batch_src_global generation:  0.0018055438995361328
r_  generation:  0.018291711807250977
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0020401477813720703
r_  generation:  0.019197463989257812
local_output_nid generation:  0.0015330314636230469
local_in_edges_tensor generation:  0.0008835792541503906
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.018990039825439453
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008563995361328125
mini_batch_src_global generation:  0.0014388561248779297
r_  generation:  0.019054412841796875
local_output_nid generation:  0.0015904903411865234
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.0014543533325195312
r_  generation:  0.019040346145629883
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.01921224594116211
local_output_nid generation:  0.0014920234680175781
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0014467239379882812
r_  generation:  0.018978357315063477
local_output_nid generation:  0.0015726089477539062
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0014870166778564453
r_  generation:  0.019074440002441406
local_output_nid generation:  0.001499176025390625
local_in_edges_tensor generation:  0.0008342266082763672
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.019170284271240234
local_output_nid generation:  0.0015211105346679688
local_in_edges_tensor generation:  0.0008487701416015625
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.018836259841918945
local_output_nid generation:  0.0015604496002197266
local_in_edges_tensor generation:  0.0008246898651123047
mini_batch_src_global generation:  0.0014643669128417969
r_  generation:  0.0192868709564209
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.0014655590057373047
r_  generation:  0.019276857376098633
local_output_nid generation:  0.0015037059783935547
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.001444101333618164
r_  generation:  0.01912212371826172
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0014882087707519531
r_  generation:  0.019481420516967773
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0014934539794921875
r_  generation:  0.019046783447265625
local_output_nid generation:  0.0015530586242675781
local_in_edges_tensor generation:  0.0009224414825439453
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.01909470558166504
----------------------check_connections_block total spend ----------------------------- 0.4570915699005127
generate_one_block  0.030120134353637695
generate_one_block  0.027788639068603516
generate_one_block  0.027737140655517578
generate_one_block  0.027861595153808594
generate_one_block  0.027738571166992188
generate_one_block  0.030323028564453125
generate_one_block  0.02741241455078125
generate_one_block  0.02760910987854004
generate_one_block  0.027485370635986328
generate_one_block  0.027358055114746094
generate_one_block  0.027774333953857422
generate_one_block  0.02780461311340332
generate_one_block  0.027298688888549805
generate_one_block  0.027794837951660156
generate_one_block  0.027725934982299805
generate_one_block  0.028267621994018555
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03804445266723633
gen group dst list time:  0.016572952270507812
time for parepare:  0.01873493194580078
local_output_nid generation:  0.006471872329711914
local_in_edges_tensor generation:  0.017271995544433594
mini_batch_src_global generation:  0.01939105987548828
r_  generation:  0.20145487785339355
local_output_nid generation:  0.009804487228393555
local_in_edges_tensor generation:  0.01784229278564453
mini_batch_src_global generation:  0.024693727493286133
r_  generation:  0.20296597480773926
local_output_nid generation:  0.010618448257446289
local_in_edges_tensor generation:  0.016668081283569336
mini_batch_src_global generation:  0.024039030075073242
r_  generation:  0.21082019805908203
local_output_nid generation:  0.013068675994873047
local_in_edges_tensor generation:  0.01671886444091797
mini_batch_src_global generation:  0.025176048278808594
r_  generation:  0.21450519561767578
local_output_nid generation:  0.01128077507019043
local_in_edges_tensor generation:  0.017289400100708008
mini_batch_src_global generation:  0.02622675895690918
r_  generation:  0.22335314750671387
local_output_nid generation:  0.012359857559204102
local_in_edges_tensor generation:  0.015790700912475586
mini_batch_src_global generation:  0.027563095092773438
r_  generation:  0.22407007217407227
local_output_nid generation:  0.01128244400024414
local_in_edges_tensor generation:  0.02000880241394043
mini_batch_src_global generation:  0.027196645736694336
r_  generation:  0.22198176383972168
local_output_nid generation:  0.012789011001586914
local_in_edges_tensor generation:  0.014812231063842773
mini_batch_src_global generation:  0.02805018424987793
r_  generation:  0.2185523509979248
local_output_nid generation:  0.012187480926513672
local_in_edges_tensor generation:  0.012244701385498047
mini_batch_src_global generation:  0.0266568660736084
r_  generation:  0.2164452075958252
local_output_nid generation:  0.012024641036987305
local_in_edges_tensor generation:  0.012387275695800781
mini_batch_src_global generation:  0.02675652503967285
r_  generation:  0.21739888191223145
local_output_nid generation:  0.012187480926513672
local_in_edges_tensor generation:  0.017270565032958984
mini_batch_src_global generation:  0.027088642120361328
r_  generation:  0.22156095504760742
local_output_nid generation:  0.012193441390991211
local_in_edges_tensor generation:  0.012020587921142578
mini_batch_src_global generation:  0.027387619018554688
r_  generation:  0.21615052223205566
local_output_nid generation:  0.011977672576904297
local_in_edges_tensor generation:  0.011995553970336914
mini_batch_src_global generation:  0.02691030502319336
r_  generation:  0.21702122688293457
local_output_nid generation:  0.012348651885986328
local_in_edges_tensor generation:  0.01414346694946289
mini_batch_src_global generation:  0.027250289916992188
r_  generation:  0.2212519645690918
local_output_nid generation:  0.0123291015625
local_in_edges_tensor generation:  0.013760805130004883
mini_batch_src_global generation:  0.02714395523071289
r_  generation:  0.2194969654083252
local_output_nid generation:  0.011583805084228516
local_in_edges_tensor generation:  0.01912212371826172
mini_batch_src_global generation:  0.02785015106201172
r_  generation:  0.21827125549316406
----------------------check_connections_block total spend ----------------------------- 5.106604099273682
generate_one_block  0.28301453590393066
generate_one_block  0.2697265148162842
generate_one_block  0.2827467918395996
generate_one_block  0.27756810188293457
generate_one_block  0.2852318286895752
generate_one_block  0.2863643169403076
generate_one_block  0.29477787017822266
generate_one_block  0.27789950370788574
generate_one_block  0.2759377956390381
generate_one_block  0.27289676666259766
generate_one_block  0.28461408615112305
generate_one_block  0.2746586799621582
generate_one_block  0.2745966911315918
generate_one_block  0.27639150619506836
generate_one_block  0.27681994438171387
generate_one_block  0.28004884719848633
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05136299133300781
gen group dst list time:  0.059587717056274414
time for parepare:  0.017144441604614258
local_output_nid generation:  0.02313065528869629
local_in_edges_tensor generation:  0.059264421463012695
mini_batch_src_global generation:  0.045241355895996094
r_  generation:  0.49675869941711426
local_output_nid generation:  0.029290437698364258
local_in_edges_tensor generation:  0.04801774024963379
mini_batch_src_global generation:  0.05851101875305176
r_  generation:  0.48951244354248047
local_output_nid generation:  0.029143810272216797
local_in_edges_tensor generation:  0.03529787063598633
mini_batch_src_global generation:  0.0605161190032959
r_  generation:  0.4999730587005615
local_output_nid generation:  0.02949810028076172
local_in_edges_tensor generation:  0.035637617111206055
mini_batch_src_global generation:  0.06158280372619629
r_  generation:  0.49672675132751465
local_output_nid generation:  0.030225038528442383
local_in_edges_tensor generation:  0.08836674690246582
mini_batch_src_global generation:  0.060830116271972656
r_  generation:  0.5254724025726318
local_output_nid generation:  0.03077840805053711
local_in_edges_tensor generation:  0.0462183952331543
mini_batch_src_global generation:  0.06400036811828613
r_  generation:  0.5030016899108887
local_output_nid generation:  0.03070998191833496
local_in_edges_tensor generation:  0.036598920822143555
mini_batch_src_global generation:  0.05817413330078125
r_  generation:  0.5025551319122314
local_output_nid generation:  0.030779600143432617
local_in_edges_tensor generation:  0.04226517677307129
mini_batch_src_global generation:  0.05936479568481445
r_  generation:  0.4978785514831543
local_output_nid generation:  0.030293703079223633
local_in_edges_tensor generation:  0.04005002975463867
mini_batch_src_global generation:  0.05809330940246582
r_  generation:  0.5046660900115967
local_output_nid generation:  0.030452489852905273
local_in_edges_tensor generation:  0.031128644943237305
mini_batch_src_global generation:  0.059171438217163086
r_  generation:  0.4985816478729248
local_output_nid generation:  0.03067159652709961
local_in_edges_tensor generation:  0.035730600357055664
mini_batch_src_global generation:  0.061975955963134766
r_  generation:  0.5063667297363281
local_output_nid generation:  0.030516386032104492
local_in_edges_tensor generation:  0.03541111946105957
mini_batch_src_global generation:  0.059676170349121094
r_  generation:  0.5035839080810547
local_output_nid generation:  0.03090524673461914
local_in_edges_tensor generation:  0.031207561492919922
mini_batch_src_global generation:  0.05918240547180176
r_  generation:  0.5083260536193848
local_output_nid generation:  0.03174448013305664
local_in_edges_tensor generation:  0.04417896270751953
mini_batch_src_global generation:  0.05953621864318848
r_  generation:  0.5053348541259766
local_output_nid generation:  0.0312349796295166
local_in_edges_tensor generation:  0.04090452194213867
mini_batch_src_global generation:  0.06020522117614746
r_  generation:  0.5092308521270752
local_output_nid generation:  0.03101348876953125
local_in_edges_tensor generation:  0.031775712966918945
mini_batch_src_global generation:  0.059181928634643555
r_  generation:  0.5008995532989502
----------------------check_connections_block total spend ----------------------------- 11.903385877609253
generate_one_block  0.6564843654632568
generate_one_block  0.6569771766662598
generate_one_block  0.6496219635009766
generate_one_block  0.6483769416809082
generate_one_block  0.6630933284759521
generate_one_block  0.6510918140411377
generate_one_block  0.6447365283966064
generate_one_block  0.6593759059906006
generate_one_block  0.6840829849243164
generate_one_block  0.641564130783081
generate_one_block  0.6604957580566406
generate_one_block  0.6404492855072021
generate_one_block  0.6456234455108643
generate_one_block  0.6480505466461182
generate_one_block  0.6576659679412842
generate_one_block  0.6565439701080322
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05327725410461426
gen group dst list time:  0.0963582992553711
time for parepare:  0.019390106201171875
local_output_nid generation:  0.03155779838562012
local_in_edges_tensor generation:  0.06004691123962402
mini_batch_src_global generation:  0.05412149429321289
r_  generation:  0.5337347984313965
local_output_nid generation:  0.03839278221130371
local_in_edges_tensor generation:  0.05875968933105469
mini_batch_src_global generation:  0.06234908103942871
r_  generation:  0.5447514057159424
local_output_nid generation:  0.03856325149536133
local_in_edges_tensor generation:  0.0413060188293457
mini_batch_src_global generation:  0.05827665328979492
r_  generation:  0.5466506481170654
local_output_nid generation:  0.03902411460876465
local_in_edges_tensor generation:  0.04441571235656738
mini_batch_src_global generation:  0.05834841728210449
r_  generation:  0.55098557472229
local_output_nid generation:  0.039112091064453125
local_in_edges_tensor generation:  0.04196739196777344
mini_batch_src_global generation:  0.05787014961242676
r_  generation:  0.5565581321716309
local_output_nid generation:  0.03663516044616699
local_in_edges_tensor generation:  0.043393850326538086
mini_batch_src_global generation:  0.06018710136413574
r_  generation:  0.5550827980041504
local_output_nid generation:  0.03683590888977051
local_in_edges_tensor generation:  0.04213714599609375
mini_batch_src_global generation:  0.059642791748046875
r_  generation:  0.5623087882995605
local_output_nid generation:  0.04796123504638672
local_in_edges_tensor generation:  0.04274439811706543
mini_batch_src_global generation:  0.060312747955322266
r_  generation:  0.5635478496551514
local_output_nid generation:  0.03711056709289551
local_in_edges_tensor generation:  0.042398691177368164
mini_batch_src_global generation:  0.06067681312561035
r_  generation:  0.5718297958374023
local_output_nid generation:  0.03713226318359375
local_in_edges_tensor generation:  0.04300737380981445
mini_batch_src_global generation:  0.06147146224975586
r_  generation:  0.5749516487121582
local_output_nid generation:  0.0374760627746582
local_in_edges_tensor generation:  0.043204545974731445
mini_batch_src_global generation:  0.06107926368713379
r_  generation:  0.5700616836547852
local_output_nid generation:  0.03718757629394531
local_in_edges_tensor generation:  0.042746543884277344
mini_batch_src_global generation:  0.06367349624633789
r_  generation:  0.5664076805114746
local_output_nid generation:  0.03715991973876953
local_in_edges_tensor generation:  0.04244089126586914
mini_batch_src_global generation:  0.061272621154785156
r_  generation:  0.5678369998931885
local_output_nid generation:  0.037837982177734375
local_in_edges_tensor generation:  0.04300570487976074
mini_batch_src_global generation:  0.061826229095458984
r_  generation:  0.5658628940582275
local_output_nid generation:  0.03754305839538574
local_in_edges_tensor generation:  0.042410850524902344
mini_batch_src_global generation:  0.06141972541809082
r_  generation:  0.5685350894927979
local_output_nid generation:  0.03733992576599121
local_in_edges_tensor generation:  0.05239582061767578
mini_batch_src_global generation:  0.06086230278015137
r_  generation:  0.5625960826873779
----------------------check_connections_block total spend ----------------------------- 13.334393501281738
generate_one_block  0.6809370517730713
generate_one_block  0.6939127445220947
generate_one_block  0.6970834732055664
generate_one_block  0.692706823348999
generate_one_block  0.6899802684783936
generate_one_block  0.6919195652008057
generate_one_block  0.7628703117370605
generate_one_block  0.6944739818572998
generate_one_block  0.6945853233337402
generate_one_block  0.6983132362365723
generate_one_block  0.6986229419708252
generate_one_block  0.7068016529083252
generate_one_block  0.698948860168457
generate_one_block  0.6958658695220947
generate_one_block  0.7010853290557861
generate_one_block  0.6975264549255371
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04079413414001465
gen group dst list time:  0.10633969306945801
time for parepare:  0.019069433212280273
local_output_nid generation:  0.03399920463562012
local_in_edges_tensor generation:  0.05279064178466797
mini_batch_src_global generation:  0.05144047737121582
r_  generation:  0.5519013404846191
local_output_nid generation:  0.039881229400634766
local_in_edges_tensor generation:  0.05224132537841797
mini_batch_src_global generation:  0.06553339958190918
r_  generation:  0.5522518157958984
local_output_nid generation:  0.03847980499267578
local_in_edges_tensor generation:  0.04040837287902832
mini_batch_src_global generation:  0.06279253959655762
r_  generation:  0.551811695098877
local_output_nid generation:  0.03902268409729004
local_in_edges_tensor generation:  0.039498090744018555
mini_batch_src_global generation:  0.0630803108215332
r_  generation:  0.5478870868682861
local_output_nid generation:  0.038877010345458984
local_in_edges_tensor generation:  0.0404810905456543
mini_batch_src_global generation:  0.0625302791595459
r_  generation:  0.5508458614349365
local_output_nid generation:  0.03879404067993164
local_in_edges_tensor generation:  0.03968095779418945
mini_batch_src_global generation:  0.06261205673217773
r_  generation:  0.5538582801818848
local_output_nid generation:  0.039092063903808594
local_in_edges_tensor generation:  0.04052233695983887
mini_batch_src_global generation:  0.06211543083190918
r_  generation:  0.5516738891601562
local_output_nid generation:  0.039023399353027344
local_in_edges_tensor generation:  0.04062485694885254
mini_batch_src_global generation:  0.06306123733520508
r_  generation:  0.5517957210540771
local_output_nid generation:  0.03898000717163086
local_in_edges_tensor generation:  0.04059290885925293
mini_batch_src_global generation:  0.061867713928222656
r_  generation:  0.5622060298919678
local_output_nid generation:  0.039171695709228516
local_in_edges_tensor generation:  0.04523301124572754
mini_batch_src_global generation:  0.06275248527526855
r_  generation:  0.5588531494140625
local_output_nid generation:  0.039296627044677734
local_in_edges_tensor generation:  0.040612220764160156
mini_batch_src_global generation:  0.06094980239868164
r_  generation:  0.5577542781829834
local_output_nid generation:  0.039264678955078125
local_in_edges_tensor generation:  0.045386314392089844
mini_batch_src_global generation:  0.06206989288330078
r_  generation:  0.5493202209472656
local_output_nid generation:  0.03902316093444824
local_in_edges_tensor generation:  0.040528297424316406
mini_batch_src_global generation:  0.06189537048339844
r_  generation:  0.5575656890869141
local_output_nid generation:  0.039306640625
local_in_edges_tensor generation:  0.039894819259643555
mini_batch_src_global generation:  0.06515979766845703
r_  generation:  0.5551650524139404
local_output_nid generation:  0.039293766021728516
local_in_edges_tensor generation:  0.040680646896362305
mini_batch_src_global generation:  0.0620265007019043
r_  generation:  0.5604326725006104
local_output_nid generation:  0.04118466377258301
local_in_edges_tensor generation:  0.0460665225982666
mini_batch_src_global generation:  0.06211233139038086
r_  generation:  0.555394172668457
----------------------check_connections_block total spend ----------------------------- 13.28626823425293
generate_one_block  0.6857047080993652
generate_one_block  0.6916642189025879
generate_one_block  0.6876211166381836
generate_one_block  0.6867814064025879
generate_one_block  0.6846456527709961
generate_one_block  0.6996724605560303
generate_one_block  0.6869997978210449
generate_one_block  0.690711259841919
generate_one_block  0.6943271160125732
generate_one_block  0.7734594345092773
generate_one_block  0.6952145099639893
generate_one_block  0.7041094303131104
generate_one_block  0.693901777267456
generate_one_block  0.706181526184082
generate_one_block  0.6942472457885742
generate_one_block  0.6959245204925537
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03855776786804199
gen group dst list time:  0.1074819564819336
time for parepare:  0.01957416534423828
local_output_nid generation:  0.03647351264953613
local_in_edges_tensor generation:  0.05371689796447754
mini_batch_src_global generation:  0.049062252044677734
r_  generation:  0.5019643306732178
local_output_nid generation:  0.04188704490661621
local_in_edges_tensor generation:  0.05208563804626465
mini_batch_src_global generation:  0.05747795104980469
r_  generation:  0.5089867115020752
local_output_nid generation:  0.042581796646118164
local_in_edges_tensor generation:  0.03930401802062988
mini_batch_src_global generation:  0.05784773826599121
r_  generation:  0.5064260959625244
local_output_nid generation:  0.042673349380493164
local_in_edges_tensor generation:  0.03931093215942383
mini_batch_src_global generation:  0.05814099311828613
r_  generation:  0.5102221965789795
local_output_nid generation:  0.04248833656311035
local_in_edges_tensor generation:  0.04451608657836914
mini_batch_src_global generation:  0.06235456466674805
r_  generation:  0.5088257789611816
local_output_nid generation:  0.04129528999328613
local_in_edges_tensor generation:  0.03963017463684082
mini_batch_src_global generation:  0.0599212646484375
r_  generation:  0.5159132480621338
local_output_nid generation:  0.040097951889038086
local_in_edges_tensor generation:  0.035741567611694336
mini_batch_src_global generation:  0.057684898376464844
r_  generation:  0.513002872467041
local_output_nid generation:  0.040074825286865234
local_in_edges_tensor generation:  0.045244455337524414
mini_batch_src_global generation:  0.06160092353820801
r_  generation:  0.5159468650817871
local_output_nid generation:  0.040009498596191406
local_in_edges_tensor generation:  0.036196231842041016
mini_batch_src_global generation:  0.05771160125732422
r_  generation:  0.5127081871032715
local_output_nid generation:  0.040024518966674805
local_in_edges_tensor generation:  0.04445767402648926
mini_batch_src_global generation:  0.057239532470703125
r_  generation:  0.5204169750213623
local_output_nid generation:  0.040099143981933594
local_in_edges_tensor generation:  0.040058135986328125
mini_batch_src_global generation:  0.057471275329589844
r_  generation:  0.5166957378387451
local_output_nid generation:  0.04011964797973633
local_in_edges_tensor generation:  0.040094852447509766
mini_batch_src_global generation:  0.06103062629699707
r_  generation:  0.5154979228973389
local_output_nid generation:  0.0400996208190918
local_in_edges_tensor generation:  0.04453563690185547
mini_batch_src_global generation:  0.05796551704406738
r_  generation:  0.521784782409668
local_output_nid generation:  0.04028940200805664
local_in_edges_tensor generation:  0.04024028778076172
mini_batch_src_global generation:  0.058222055435180664
r_  generation:  0.5143122673034668
local_output_nid generation:  0.040302276611328125
local_in_edges_tensor generation:  0.044585227966308594
mini_batch_src_global generation:  0.0579221248626709
r_  generation:  0.5184450149536133
local_output_nid generation:  0.04015803337097168
local_in_edges_tensor generation:  0.04026317596435547
mini_batch_src_global generation:  0.05827474594116211
r_  generation:  0.5172097682952881
----------------------check_connections_block total spend ----------------------------- 12.450083017349243
generate_one_block  0.6362497806549072
generate_one_block  0.6500842571258545
generate_one_block  0.6387100219726562
generate_one_block  0.6482937335968018
generate_one_block  0.6432926654815674
generate_one_block  0.6401233673095703
generate_one_block  0.6260371208190918
generate_one_block  0.6476948261260986
generate_one_block  0.6388180255889893
generate_one_block  0.6369574069976807
generate_one_block  0.6382639408111572
generate_one_block  0.6421411037445068
generate_one_block  0.7193789482116699
generate_one_block  0.6458110809326172
generate_one_block  0.6365625858306885
generate_one_block  0.6452858448028564
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 0.25119733810424805  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

connection checking time:  56.080734729766846
block generation total time  47.63803267478943
average batch blocks generation time:  2.9773770421743393
block dataloader generation time/epoch 107.18300604820251
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 0.14608383178710938  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

torch.Size([167250, 128])
torch.Size([166468, 256])
torch.Size([164073, 256])
torch.Size([156037, 256])
torch.Size([124065, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7758336067199707  GigaBytes
Max Memory Allocated: 2.8521413803100586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14603853225708008  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

torch.Size([167242, 128])
torch.Size([166398, 256])
torch.Size([163956, 256])
torch.Size([155637, 256])
torch.Size([123398, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7626795768737793  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.1460580825805664  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

torch.Size([167226, 128])
torch.Size([166387, 256])
torch.Size([163877, 256])
torch.Size([155338, 256])
torch.Size([123303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7655467987060547  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14606475830078125  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

torch.Size([167254, 128])
torch.Size([166422, 256])
torch.Size([164083, 256])
torch.Size([155916, 256])
torch.Size([123412, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7682547569274902  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14614486694335938  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

torch.Size([167273, 128])
torch.Size([166463, 256])
torch.Size([164088, 256])
torch.Size([155969, 256])
torch.Size([124577, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7777323722839355  GigaBytes
Max Memory Allocated: 2.854302406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14611387252807617  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167226, 128])
torch.Size([166399, 256])
torch.Size([164020, 256])
torch.Size([155876, 256])
torch.Size([124115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.77573823928833  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.1460552215576172  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167119, 128])
torch.Size([166239, 256])
torch.Size([163841, 256])
torch.Size([155623, 256])
torch.Size([123548, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7637996673583984  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14608240127563477  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167248, 128])
torch.Size([166441, 256])
torch.Size([163983, 256])
torch.Size([155603, 256])
torch.Size([123678, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.767652988433838  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14606809616088867  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167204, 128])
torch.Size([166374, 256])
torch.Size([163990, 256])
torch.Size([155651, 256])
torch.Size([123728, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.767746925354004  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14604997634887695  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167172, 128])
torch.Size([166307, 256])
torch.Size([163975, 256])
torch.Size([155841, 256])
torch.Size([123270, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.762627601623535  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14610862731933594  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167169, 128])
torch.Size([166343, 256])
torch.Size([163963, 256])
torch.Size([156088, 256])
torch.Size([124549, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.776871681213379  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14606809616088867  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167191, 128])
torch.Size([166331, 256])
torch.Size([163937, 256])
torch.Size([155659, 256])
torch.Size([123670, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7673983573913574  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14606142044067383  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167247, 128])
torch.Size([166402, 256])
torch.Size([164019, 256])
torch.Size([155737, 256])
torch.Size([123641, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7650704383850098  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.1460881233215332  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167222, 128])
torch.Size([166383, 256])
torch.Size([164006, 256])
torch.Size([155915, 256])
torch.Size([124096, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.775010585784912  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14609622955322266  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167221, 128])
torch.Size([166355, 256])
torch.Size([163969, 256])
torch.Size([155929, 256])
torch.Size([124103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.773092746734619  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 0.14605998992919922  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

torch.Size([167213, 128])
torch.Size([166407, 256])
torch.Size([164017, 256])
torch.Size([155619, 256])
torch.Size([123317, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5526123046875 GB
    Memory Allocated: 2.7663345336914062  GigaBytes
Max Memory Allocated: 2.8576598167419434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.24588380753993988 |0.050047874450683594 |0.006622195243835449 |9.004771709442139e-05 |0.006337791681289673 |0.0025675296783447266 |
----------------------------------------------------------pseudo_mini_loss sum 3.765489339828491
Total (block generation + training)time/epoch 112.38306856155396
Training time/epoch 5.199835777282715
Training time without block to device /epoch 4.399069786071777
Training time without total dataloading part /epoch 0.21136808395385742
load block tensor time/epoch 3.934140920639038
block to device time/epoch 0.8007659912109375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13095548
Number of first layer input nodes during this epoch:  2675477
