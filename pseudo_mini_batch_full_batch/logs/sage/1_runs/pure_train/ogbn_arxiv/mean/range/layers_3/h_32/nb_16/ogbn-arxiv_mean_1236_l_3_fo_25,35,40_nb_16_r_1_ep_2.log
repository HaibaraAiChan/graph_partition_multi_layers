Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648445549.1294248
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023439645767211914
range selection method range initialization spend 0.013752460479736328
time for parepare:  0.0179290771484375
local_output_nid generation:  0.001348733901977539
local_in_edges_tensor generation:  0.0033311843872070312
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.01856064796447754
local_output_nid generation:  0.0015521049499511719
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0021529197692871094
r_  generation:  0.018682479858398438
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0013175010681152344
r_  generation:  0.018593549728393555
local_output_nid generation:  0.0015985965728759766
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0013318061828613281
r_  generation:  0.01856231689453125
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0013706684112548828
r_  generation:  0.01884150505065918
local_output_nid generation:  0.0015494823455810547
local_in_edges_tensor generation:  0.0008411407470703125
mini_batch_src_global generation:  0.0014302730560302734
r_  generation:  0.019107818603515625
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.001455068588256836
r_  generation:  0.019190073013305664
local_output_nid generation:  0.0015227794647216797
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.0014488697052001953
r_  generation:  0.01877117156982422
local_output_nid generation:  0.001528024673461914
local_in_edges_tensor generation:  0.0008304119110107422
mini_batch_src_global generation:  0.0014109611511230469
r_  generation:  0.01894211769104004
local_output_nid generation:  0.0015859603881835938
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.0014007091522216797
r_  generation:  0.01891636848449707
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0014333724975585938
r_  generation:  0.01919698715209961
local_output_nid generation:  0.0015702247619628906
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0014832019805908203
r_  generation:  0.019659996032714844
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0015118122100830078
r_  generation:  0.01939678192138672
local_output_nid generation:  0.0015435218811035156
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.0015017986297607422
r_  generation:  0.01937389373779297
local_output_nid generation:  0.0015444755554199219
local_in_edges_tensor generation:  0.0008361339569091797
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.01979684829711914
local_output_nid generation:  0.00156402587890625
local_in_edges_tensor generation:  0.0008301734924316406
mini_batch_src_global generation:  0.0015058517456054688
r_  generation:  0.019995927810668945
----------------------check_connections_block total spend ----------------------------- 0.4565918445587158
generate_one_block  0.02682352066040039
generate_one_block  0.02854013442993164
generate_one_block  0.029462337493896484
generate_one_block  0.027974843978881836
generate_one_block  0.027927398681640625
generate_one_block  0.027991533279418945
generate_one_block  0.028575420379638672
generate_one_block  0.02701282501220703
generate_one_block  0.0273592472076416
generate_one_block  0.027227401733398438
generate_one_block  0.02738046646118164
generate_one_block  0.028378963470458984
generate_one_block  0.028041601181030273
generate_one_block  0.027547836303710938
generate_one_block  0.028461694717407227
generate_one_block  0.02840566635131836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03986001014709473
gen group dst list time:  0.018860340118408203
time for parepare:  0.01873612403869629
local_output_nid generation:  0.006636619567871094
local_in_edges_tensor generation:  0.014715909957885742
mini_batch_src_global generation:  0.0191500186920166
r_  generation:  0.19124984741210938
local_output_nid generation:  0.010267496109008789
local_in_edges_tensor generation:  0.01801300048828125
mini_batch_src_global generation:  0.02436518669128418
r_  generation:  0.20374774932861328
local_output_nid generation:  0.010266780853271484
local_in_edges_tensor generation:  0.014025211334228516
mini_batch_src_global generation:  0.023102283477783203
r_  generation:  0.20573163032531738
local_output_nid generation:  0.010493993759155273
local_in_edges_tensor generation:  0.016642332077026367
mini_batch_src_global generation:  0.025593280792236328
r_  generation:  0.21193337440490723
local_output_nid generation:  0.010725259780883789
local_in_edges_tensor generation:  0.013105392456054688
mini_batch_src_global generation:  0.029950380325317383
r_  generation:  0.21807622909545898
local_output_nid generation:  0.010877847671508789
local_in_edges_tensor generation:  0.011577606201171875
mini_batch_src_global generation:  0.0293424129486084
r_  generation:  0.21972894668579102
local_output_nid generation:  0.011065483093261719
local_in_edges_tensor generation:  0.013998031616210938
mini_batch_src_global generation:  0.02680516242980957
r_  generation:  0.2371506690979004
local_output_nid generation:  0.013751745223999023
local_in_edges_tensor generation:  0.023942232131958008
mini_batch_src_global generation:  0.03131675720214844
r_  generation:  0.20255184173583984
local_output_nid generation:  0.011423349380493164
local_in_edges_tensor generation:  0.01254415512084961
mini_batch_src_global generation:  0.025632381439208984
r_  generation:  0.20586895942687988
local_output_nid generation:  0.0113677978515625
local_in_edges_tensor generation:  0.014935016632080078
mini_batch_src_global generation:  0.02575516700744629
r_  generation:  0.20923781394958496
local_output_nid generation:  0.011363029479980469
local_in_edges_tensor generation:  0.014630317687988281
mini_batch_src_global generation:  0.025722742080688477
r_  generation:  0.2061939239501953
local_output_nid generation:  0.011599063873291016
local_in_edges_tensor generation:  0.014850139617919922
mini_batch_src_global generation:  0.02662181854248047
r_  generation:  0.21596360206604004
local_output_nid generation:  0.011825799942016602
local_in_edges_tensor generation:  0.011784076690673828
mini_batch_src_global generation:  0.02673196792602539
r_  generation:  0.2141420841217041
local_output_nid generation:  0.011519193649291992
local_in_edges_tensor generation:  0.013087272644042969
mini_batch_src_global generation:  0.026430130004882812
r_  generation:  0.2143397331237793
local_output_nid generation:  0.011924266815185547
local_in_edges_tensor generation:  0.01544499397277832
mini_batch_src_global generation:  0.02680659294128418
r_  generation:  0.2186739444732666
local_output_nid generation:  0.011853694915771484
local_in_edges_tensor generation:  0.015186548233032227
mini_batch_src_global generation:  0.02683115005493164
r_  generation:  0.2223043441772461
----------------------check_connections_block total spend ----------------------------- 5.008234024047852
generate_one_block  0.28158020973205566
generate_one_block  0.27455639839172363
generate_one_block  0.2691221237182617
generate_one_block  0.2689962387084961
generate_one_block  0.2906010150909424
generate_one_block  0.2740170955657959
generate_one_block  0.2776470184326172
generate_one_block  0.2597644329071045
generate_one_block  0.2622034549713135
generate_one_block  0.2659273147583008
generate_one_block  0.2653968334197998
generate_one_block  0.27367329597473145
generate_one_block  0.2724747657775879
generate_one_block  0.2709193229675293
generate_one_block  0.28992462158203125
generate_one_block  0.2760965824127197
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05042219161987305
gen group dst list time:  0.0672769546508789
time for parepare:  0.01860809326171875
local_output_nid generation:  0.02381110191345215
local_in_edges_tensor generation:  0.06003570556640625
mini_batch_src_global generation:  0.04214048385620117
r_  generation:  0.4616127014160156
local_output_nid generation:  0.03418874740600586
local_in_edges_tensor generation:  0.05262184143066406
mini_batch_src_global generation:  0.05604720115661621
r_  generation:  0.46166181564331055
local_output_nid generation:  0.03154778480529785
local_in_edges_tensor generation:  0.04286694526672363
mini_batch_src_global generation:  0.05010819435119629
r_  generation:  0.47420191764831543
local_output_nid generation:  0.03245735168457031
local_in_edges_tensor generation:  0.05589938163757324
mini_batch_src_global generation:  0.07039546966552734
r_  generation:  0.4478738307952881
local_output_nid generation:  0.031462907791137695
local_in_edges_tensor generation:  0.03933882713317871
mini_batch_src_global generation:  0.0538787841796875
r_  generation:  0.4630091190338135
local_output_nid generation:  0.0318455696105957
local_in_edges_tensor generation:  0.035822391510009766
mini_batch_src_global generation:  0.055384159088134766
r_  generation:  0.4808676242828369
local_output_nid generation:  0.03129267692565918
local_in_edges_tensor generation:  0.04446101188659668
mini_batch_src_global generation:  0.056342124938964844
r_  generation:  0.46373772621154785
local_output_nid generation:  0.03232836723327637
local_in_edges_tensor generation:  0.0357050895690918
mini_batch_src_global generation:  0.05904221534729004
r_  generation:  0.4496419429779053
local_output_nid generation:  0.031182050704956055
local_in_edges_tensor generation:  0.03357887268066406
mini_batch_src_global generation:  0.05154848098754883
r_  generation:  0.45741772651672363
local_output_nid generation:  0.030971765518188477
local_in_edges_tensor generation:  0.03150224685668945
mini_batch_src_global generation:  0.05484628677368164
r_  generation:  0.4538111686706543
local_output_nid generation:  0.031113386154174805
local_in_edges_tensor generation:  0.028726577758789062
mini_batch_src_global generation:  0.051836490631103516
r_  generation:  0.46502184867858887
local_output_nid generation:  0.0323333740234375
local_in_edges_tensor generation:  0.03271913528442383
mini_batch_src_global generation:  0.05295443534851074
r_  generation:  0.46053171157836914
local_output_nid generation:  0.031716346740722656
local_in_edges_tensor generation:  0.0418548583984375
mini_batch_src_global generation:  0.05093574523925781
r_  generation:  0.46405935287475586
local_output_nid generation:  0.03149008750915527
local_in_edges_tensor generation:  0.028984785079956055
mini_batch_src_global generation:  0.054303884506225586
r_  generation:  0.4538838863372803
local_output_nid generation:  0.03157615661621094
local_in_edges_tensor generation:  0.04307365417480469
mini_batch_src_global generation:  0.05925726890563965
r_  generation:  0.46033334732055664
local_output_nid generation:  0.03108692169189453
local_in_edges_tensor generation:  0.034325599670410156
mini_batch_src_global generation:  0.0522618293762207
r_  generation:  0.45928525924682617
----------------------check_connections_block total spend ----------------------------- 11.031890392303467
generate_one_block  0.5772366523742676
generate_one_block  0.5835306644439697
generate_one_block  0.5773725509643555
generate_one_block  0.5773489475250244
generate_one_block  0.5797746181488037
generate_one_block  0.587578535079956
generate_one_block  0.6359715461730957
generate_one_block  0.560206413269043
generate_one_block  0.5673263072967529
generate_one_block  0.5729641914367676
generate_one_block  0.5751852989196777
generate_one_block  0.5932013988494873
generate_one_block  0.5714619159698486
generate_one_block  0.5715904235839844
generate_one_block  0.5877740383148193
generate_one_block  0.5644512176513672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  16.04012441635132
block generation total time  13.655875444412231
average batch blocks generation time:  0.8534922152757645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08978509902954102  GigaBytes
Max Memory Allocated: 0.08978509902954102  GigaBytes

torch.Size([154343, 128])
torch.Size([121753, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.1785292625427246  GigaBytes
Max Memory Allocated: 0.1806321144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.0908651351928711  GigaBytes
Max Memory Allocated: 0.1899881362915039  GigaBytes

torch.Size([154513, 128])
torch.Size([122826, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17986679077148438  GigaBytes
Max Memory Allocated: 0.1899881362915039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09072208404541016  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

torch.Size([154605, 128])
torch.Size([122664, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17916393280029297  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09071540832519531  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

torch.Size([154458, 128])
torch.Size([122208, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17899131774902344  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09084224700927734  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

torch.Size([154386, 128])
torch.Size([122710, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17932796478271484  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09084415435791016  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

torch.Size([154871, 128])
torch.Size([123029, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18186664581298828  GigaBytes
Max Memory Allocated: 0.19111919403076172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09095954895019531  GigaBytes
Max Memory Allocated: 0.1931467056274414  GigaBytes

torch.Size([154580, 128])
torch.Size([123228, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1819462776184082  GigaBytes
Max Memory Allocated: 0.1931467056274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0904541015625  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154217, 128])
torch.Size([121354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17576313018798828  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09054851531982422  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154029, 128])
torch.Size([121783, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17661762237548828  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0906381607055664  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154505, 128])
torch.Size([122230, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17780733108520508  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09061431884765625  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154585, 128])
torch.Size([122450, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17797136306762695  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0908823013305664  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154724, 128])
torch.Size([123122, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18190240859985352  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09082317352294922  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154302, 128])
torch.Size([123057, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18186140060424805  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09076499938964844  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154406, 128])
torch.Size([122399, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791548728942871  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09089279174804688  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154486, 128])
torch.Size([123062, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.181884765625  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09083175659179688  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154377, 128])
torch.Size([122243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791224479675293  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03318522870540619 |0.03599628806114197 |0.05043944716453552 |0.00010031461715698242 |0.0071057528257369995 |0.0037119388580322266 |
----------------------------------------------------------pseudo_mini_loss sum 5.027408123016357
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5093497
Number of first layer input nodes during this epoch:  2471387
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.12506675720214844  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.016759872436523438
range selection method range initialization spend 0.011551380157470703
time for parepare:  0.017316102981567383
local_output_nid generation:  0.001338958740234375
local_in_edges_tensor generation:  0.004152536392211914
mini_batch_src_global generation:  0.0016722679138183594
r_  generation:  0.01714301109313965
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0020029544830322266
r_  generation:  0.017652273178100586
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0013277530670166016
r_  generation:  0.01807880401611328
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.000904083251953125
mini_batch_src_global generation:  0.0013396739959716797
r_  generation:  0.018420934677124023
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0013604164123535156
r_  generation:  0.01878213882446289
local_output_nid generation:  0.0015368461608886719
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.019052505493164062
local_output_nid generation:  0.0015339851379394531
local_in_edges_tensor generation:  0.0008590221405029297
mini_batch_src_global generation:  0.0014405250549316406
r_  generation:  0.019192218780517578
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.0008416175842285156
mini_batch_src_global generation:  0.001413583755493164
r_  generation:  0.018524169921875
local_output_nid generation:  0.0016162395477294922
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0014677047729492188
r_  generation:  0.01903510093688965
local_output_nid generation:  0.0015506744384765625
local_in_edges_tensor generation:  0.00092315673828125
mini_batch_src_global generation:  0.0014426708221435547
r_  generation:  0.01953268051147461
local_output_nid generation:  0.0015628337860107422
local_in_edges_tensor generation:  0.0008490085601806641
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.01918482780456543
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0015017986297607422
r_  generation:  0.019803762435913086
local_output_nid generation:  0.0015027523040771484
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.019626140594482422
local_output_nid generation:  0.001528024673461914
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.020023822784423828
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0008296966552734375
mini_batch_src_global generation:  0.001535654067993164
r_  generation:  0.019446134567260742
local_output_nid generation:  0.0015423297882080078
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0015015602111816406
r_  generation:  0.019284486770629883
----------------------check_connections_block total spend ----------------------------- 0.45540928840637207
generate_one_block  0.03332257270812988
generate_one_block  0.02749919891357422
generate_one_block  0.02713632583618164
generate_one_block  0.027724504470825195
generate_one_block  0.028470754623413086
generate_one_block  0.030076265335083008
generate_one_block  0.028041362762451172
generate_one_block  0.026831626892089844
generate_one_block  0.027751922607421875
generate_one_block  0.027802705764770508
generate_one_block  0.027532577514648438
generate_one_block  0.028463125228881836
generate_one_block  0.028428077697753906
generate_one_block  0.02871990203857422
generate_one_block  0.02767324447631836
generate_one_block  0.028270721435546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034604549407958984
gen group dst list time:  0.0173492431640625
time for parepare:  0.019042015075683594
local_output_nid generation:  0.00894784927368164
local_in_edges_tensor generation:  0.014478206634521484
mini_batch_src_global generation:  0.019567489624023438
r_  generation:  0.19319605827331543
local_output_nid generation:  0.010697126388549805
local_in_edges_tensor generation:  0.01731085777282715
mini_batch_src_global generation:  0.02396869659423828
r_  generation:  0.20253849029541016
local_output_nid generation:  0.011199474334716797
local_in_edges_tensor generation:  0.016351699829101562
mini_batch_src_global generation:  0.022577524185180664
r_  generation:  0.20562386512756348
local_output_nid generation:  0.012101411819458008
local_in_edges_tensor generation:  0.01126241683959961
mini_batch_src_global generation:  0.024106502532958984
r_  generation:  0.2096865177154541
local_output_nid generation:  0.01197504997253418
local_in_edges_tensor generation:  0.01408076286315918
mini_batch_src_global generation:  0.02681112289428711
r_  generation:  0.21667933464050293
local_output_nid generation:  0.01206660270690918
local_in_edges_tensor generation:  0.013247966766357422
mini_batch_src_global generation:  0.02576136589050293
r_  generation:  0.2111356258392334
local_output_nid generation:  0.011961698532104492
local_in_edges_tensor generation:  0.013704061508178711
mini_batch_src_global generation:  0.027454376220703125
r_  generation:  0.21673130989074707
local_output_nid generation:  0.011754512786865234
local_in_edges_tensor generation:  0.01142573356628418
mini_batch_src_global generation:  0.02568221092224121
r_  generation:  0.20937108993530273
local_output_nid generation:  0.012137413024902344
local_in_edges_tensor generation:  0.013459920883178711
mini_batch_src_global generation:  0.025830745697021484
r_  generation:  0.2212059497833252
local_output_nid generation:  0.013260841369628906
local_in_edges_tensor generation:  0.024041175842285156
mini_batch_src_global generation:  0.028886079788208008
r_  generation:  0.2242879867553711
local_output_nid generation:  0.014533758163452148
local_in_edges_tensor generation:  0.013185501098632812
mini_batch_src_global generation:  0.033036231994628906
r_  generation:  0.21605730056762695
local_output_nid generation:  0.012770891189575195
local_in_edges_tensor generation:  0.014030694961547852
mini_batch_src_global generation:  0.027960777282714844
r_  generation:  0.21508073806762695
local_output_nid generation:  0.012698888778686523
local_in_edges_tensor generation:  0.013819217681884766
mini_batch_src_global generation:  0.026474475860595703
r_  generation:  0.21599984169006348
local_output_nid generation:  0.012911081314086914
local_in_edges_tensor generation:  0.017461538314819336
mini_batch_src_global generation:  0.026858806610107422
r_  generation:  0.21834588050842285
local_output_nid generation:  0.012704849243164062
local_in_edges_tensor generation:  0.012242317199707031
mini_batch_src_global generation:  0.026755332946777344
r_  generation:  0.21628737449645996
local_output_nid generation:  0.012540340423583984
local_in_edges_tensor generation:  0.011760473251342773
mini_batch_src_global generation:  0.026139259338378906
r_  generation:  0.21141672134399414
----------------------check_connections_block total spend ----------------------------- 5.016067028045654
generate_one_block  0.2638843059539795
generate_one_block  0.2816295623779297
generate_one_block  0.26242780685424805
generate_one_block  0.27351975440979004
generate_one_block  0.2765026092529297
generate_one_block  0.2685818672180176
generate_one_block  0.29509496688842773
generate_one_block  0.2601652145385742
generate_one_block  0.2679300308227539
generate_one_block  0.27744174003601074
generate_one_block  0.27402448654174805
generate_one_block  0.27533745765686035
generate_one_block  0.27726078033447266
generate_one_block  0.2784762382507324
generate_one_block  0.26994967460632324
generate_one_block  0.26467132568359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0706930160522461
gen group dst list time:  0.06583142280578613
time for parepare:  0.018018722534179688
local_output_nid generation:  0.02351689338684082
local_in_edges_tensor generation:  0.052457571029663086
mini_batch_src_global generation:  0.04400014877319336
r_  generation:  0.42995762825012207
local_output_nid generation:  0.02912735939025879
local_in_edges_tensor generation:  0.044998884201049805
mini_batch_src_global generation:  0.050391435623168945
r_  generation:  0.4431459903717041
local_output_nid generation:  0.029036283493041992
local_in_edges_tensor generation:  0.03778719902038574
mini_batch_src_global generation:  0.04956245422363281
r_  generation:  0.4432799816131592
local_output_nid generation:  0.029230594635009766
local_in_edges_tensor generation:  0.03352761268615723
mini_batch_src_global generation:  0.054305076599121094
r_  generation:  0.4562106132507324
local_output_nid generation:  0.029690265655517578
local_in_edges_tensor generation:  0.07129740715026855
mini_batch_src_global generation:  0.05431342124938965
r_  generation:  0.4567220211029053
local_output_nid generation:  0.02986598014831543
local_in_edges_tensor generation:  0.030353784561157227
mini_batch_src_global generation:  0.053391456604003906
r_  generation:  0.44796228408813477
local_output_nid generation:  0.03176522254943848
local_in_edges_tensor generation:  0.03174996376037598
mini_batch_src_global generation:  0.052237749099731445
r_  generation:  0.45186591148376465
local_output_nid generation:  0.02962517738342285
local_in_edges_tensor generation:  0.0335848331451416
mini_batch_src_global generation:  0.05253887176513672
r_  generation:  0.4471275806427002
local_output_nid generation:  0.029911518096923828
local_in_edges_tensor generation:  0.037764549255371094
mini_batch_src_global generation:  0.05172300338745117
r_  generation:  0.45642638206481934
local_output_nid generation:  0.029999732971191406
local_in_edges_tensor generation:  0.03427267074584961
mini_batch_src_global generation:  0.05289888381958008
r_  generation:  0.44977355003356934
local_output_nid generation:  0.030408382415771484
local_in_edges_tensor generation:  0.03402113914489746
mini_batch_src_global generation:  0.05219411849975586
r_  generation:  0.4632601737976074
local_output_nid generation:  0.030055999755859375
local_in_edges_tensor generation:  0.03721189498901367
mini_batch_src_global generation:  0.055951595306396484
r_  generation:  0.44977641105651855
local_output_nid generation:  0.029944419860839844
local_in_edges_tensor generation:  0.04414868354797363
mini_batch_src_global generation:  0.05141925811767578
r_  generation:  0.45670628547668457
local_output_nid generation:  0.03130006790161133
local_in_edges_tensor generation:  0.03838658332824707
mini_batch_src_global generation:  0.052115440368652344
r_  generation:  0.45385193824768066
local_output_nid generation:  0.030651092529296875
local_in_edges_tensor generation:  0.044647216796875
mini_batch_src_global generation:  0.05331277847290039
r_  generation:  0.4758176803588867
local_output_nid generation:  0.031247615814208984
local_in_edges_tensor generation:  0.038924217224121094
mini_batch_src_global generation:  0.055494070053100586
r_  generation:  0.46164798736572266
----------------------check_connections_block total spend ----------------------------- 10.78198766708374
generate_one_block  0.5775790214538574
generate_one_block  0.5679378509521484
generate_one_block  0.5744121074676514
generate_one_block  0.5759317874908447
generate_one_block  0.5819804668426514
generate_one_block  0.5765256881713867
generate_one_block  0.5779969692230225
generate_one_block  0.5649328231811523
generate_one_block  0.6118097305297852
generate_one_block  0.5936472415924072
generate_one_block  0.563046932220459
generate_one_block  0.5815365314483643
generate_one_block  0.575751781463623
generate_one_block  0.580866813659668
generate_one_block  0.587439775466919
generate_one_block  0.5617804527282715
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.12506675720214844  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

connection checking time:  15.798054695129395
block generation total time  13.620073795318604
average batch blocks generation time:  0.8512546122074127
block dataloader generation time/epoch 31.499751567840576
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09067010879516602  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154086, 128])
torch.Size([121446, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17641687393188477  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09075069427490234  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154596, 128])
torch.Size([122429, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1780552864074707  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09070205688476562  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154324, 128])
torch.Size([121655, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17774248123168945  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09085369110107422  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154671, 128])
torch.Size([122273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791391372680664  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09094524383544922  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154559, 128])
torch.Size([122768, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17994928359985352  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0908193588256836  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154632, 128])
torch.Size([122488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17919492721557617  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09084129333496094  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154408, 128])
torch.Size([121935, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1789994239807129  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09066486358642578  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154292, 128])
torch.Size([121587, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17633390426635742  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09080886840820312  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154527, 128])
torch.Size([122521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17919206619262695  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09096813201904297  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154453, 128])
torch.Size([122383, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17937469482421875  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09081172943115234  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154731, 128])
torch.Size([122398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.1791515350341797  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09094715118408203  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154336, 128])
torch.Size([122307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17933177947998047  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0909128189086914  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154212, 128])
torch.Size([122318, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17928838729858398  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09103870391845703  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

torch.Size([154663, 128])
torch.Size([123166, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18201732635498047  GigaBytes
Max Memory Allocated: 0.19336938858032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.09090995788574219  GigaBytes
Max Memory Allocated: 0.1934223175048828  GigaBytes

torch.Size([154789, 128])
torch.Size([123263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.18200111389160156  GigaBytes
Max Memory Allocated: 0.1934223175048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.0908203125  GigaBytes
Max Memory Allocated: 0.1934223175048828  GigaBytes

torch.Size([154506, 128])
torch.Size([122625, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6033935546875 GB
    Memory Allocated: 0.17923974990844727  GigaBytes
Max Memory Allocated: 0.1934223175048828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02838321030139923 |0.011211737990379333 |0.0033668577671051025 |8.767843246459961e-05 |0.003636002540588379 |0.002877950668334961 |
----------------------------------------------------------pseudo_mini_loss sum 4.32711935043335
Total (block generation + training)time/epoch 32.27416729927063
Training time/epoch 0.7741272449493408
Training time without block to device /epoch 0.5947394371032715
Training time without total dataloading part /epoch 0.11632657051086426
load block tensor time/epoch 0.4541313648223877
block to device time/epoch 0.17938780784606934
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5090411
Number of first layer input nodes during this epoch:  2471785
