Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648449631.7573345
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02573108673095703
range selection method range initialization spend 0.01733565330505371
time for parepare:  0.018155574798583984
local_output_nid generation:  0.000698089599609375
local_in_edges_tensor generation:  0.0033164024353027344
mini_batch_src_global generation:  0.0017235279083251953
r_  generation:  0.010309219360351562
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0012819766998291016
r_  generation:  0.008054971694946289
local_output_nid generation:  0.0007636547088623047
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.0008699893951416016
r_  generation:  0.007933616638183594
local_output_nid generation:  0.0007755756378173828
local_in_edges_tensor generation:  0.0005097389221191406
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.007612943649291992
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0007371902465820312
r_  generation:  0.0076923370361328125
local_output_nid generation:  0.0007350444793701172
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0007808208465576172
r_  generation:  0.007978439331054688
local_output_nid generation:  0.0007295608520507812
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0007808208465576172
r_  generation:  0.007992744445800781
local_output_nid generation:  0.0007357597351074219
local_in_edges_tensor generation:  0.00045990943908691406
mini_batch_src_global generation:  0.0007295608520507812
r_  generation:  0.007696390151977539
local_output_nid generation:  0.0007252693176269531
local_in_edges_tensor generation:  0.00046181678771972656
mini_batch_src_global generation:  0.0007359981536865234
r_  generation:  0.007766008377075195
local_output_nid generation:  0.0007433891296386719
local_in_edges_tensor generation:  0.0004611015319824219
mini_batch_src_global generation:  0.0007765293121337891
r_  generation:  0.008013725280761719
local_output_nid generation:  0.0007395744323730469
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.008149385452270508
local_output_nid generation:  0.0007157325744628906
local_in_edges_tensor generation:  0.0004470348358154297
mini_batch_src_global generation:  0.0007658004760742188
r_  generation:  0.007892847061157227
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0004520416259765625
mini_batch_src_global generation:  0.0008106231689453125
r_  generation:  0.008284568786621094
local_output_nid generation:  0.0007262229919433594
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.008411169052124023
local_output_nid generation:  0.0007154941558837891
local_in_edges_tensor generation:  0.0004506111145019531
mini_batch_src_global generation:  0.0007996559143066406
r_  generation:  0.008074760437011719
local_output_nid generation:  0.0007185935974121094
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0008311271667480469
r_  generation:  0.008121728897094727
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.00044798851013183594
mini_batch_src_global generation:  0.0008504390716552734
r_  generation:  0.009400367736816406
local_output_nid generation:  0.0007233619689941406
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.0008537769317626953
r_  generation:  0.008087635040283203
local_output_nid generation:  0.0007183551788330078
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.0008437633514404297
r_  generation:  0.008150577545166016
local_output_nid generation:  0.0007278919219970703
local_in_edges_tensor generation:  0.0004601478576660156
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.00830841064453125
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.0004642009735107422
mini_batch_src_global generation:  0.0008530616760253906
r_  generation:  0.008259296417236328
local_output_nid generation:  0.000720977783203125
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0008330345153808594
r_  generation:  0.008293628692626953
local_output_nid generation:  0.0007388591766357422
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0008175373077392578
r_  generation:  0.008134126663208008
local_output_nid generation:  0.0007240772247314453
local_in_edges_tensor generation:  0.0004439353942871094
mini_batch_src_global generation:  0.0008161067962646484
r_  generation:  0.008238554000854492
local_output_nid generation:  0.0007269382476806641
local_in_edges_tensor generation:  0.0004417896270751953
mini_batch_src_global generation:  0.0008361339569091797
r_  generation:  0.008039474487304688
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.00045871734619140625
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.008222818374633789
local_output_nid generation:  0.0007200241088867188
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.008271455764770508
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.008372783660888672
local_output_nid generation:  0.0007200241088867188
local_in_edges_tensor generation:  0.00045037269592285156
mini_batch_src_global generation:  0.0008244514465332031
r_  generation:  0.008170604705810547
local_output_nid generation:  0.0007162094116210938
local_in_edges_tensor generation:  0.004088878631591797
mini_batch_src_global generation:  0.001081705093383789
r_  generation:  0.008642196655273438
local_output_nid generation:  0.0007700920104980469
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.000919342041015625
r_  generation:  0.008423089981079102
local_output_nid generation:  0.0007531642913818359
local_in_edges_tensor generation:  0.00046133995056152344
mini_batch_src_global generation:  0.0008454322814941406
r_  generation:  0.008101463317871094
----------------------check_connections_block total spend ----------------------------- 0.419842004776001
generate_one_block  0.013399600982666016
generate_one_block  0.01314234733581543
generate_one_block  0.013105630874633789
generate_one_block  0.013008594512939453
generate_one_block  0.012880802154541016
generate_one_block  0.013349294662475586
generate_one_block  0.013112545013427734
generate_one_block  0.012677192687988281
generate_one_block  0.01270914077758789
generate_one_block  0.01329660415649414
generate_one_block  0.013192415237426758
generate_one_block  0.012664318084716797
generate_one_block  0.013248682022094727
generate_one_block  0.013375997543334961
generate_one_block  0.012829303741455078
generate_one_block  0.012943267822265625
generate_one_block  0.013933658599853516
generate_one_block  0.012840032577514648
generate_one_block  0.012760162353515625
generate_one_block  0.013397693634033203
generate_one_block  0.013306617736816406
generate_one_block  0.013272762298583984
generate_one_block  0.013025760650634766
generate_one_block  0.013101577758789062
generate_one_block  0.012923479080200195
generate_one_block  0.013457775115966797
generate_one_block  0.013193607330322266
generate_one_block  0.013138055801391602
generate_one_block  0.013143301010131836
generate_one_block  0.013466596603393555
generate_one_block  0.013437271118164062
generate_one_block  0.013042688369750977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042441606521606445
gen group dst list time:  0.02351999282836914
time for parepare:  0.018895864486694336
local_output_nid generation:  0.0037026405334472656
local_in_edges_tensor generation:  0.01073598861694336
mini_batch_src_global generation:  0.011388063430786133
r_  generation:  0.11457180976867676
local_output_nid generation:  0.006223917007446289
local_in_edges_tensor generation:  0.006421089172363281
mini_batch_src_global generation:  0.014216899871826172
r_  generation:  0.11878705024719238
local_output_nid generation:  0.006417989730834961
local_in_edges_tensor generation:  0.007523536682128906
mini_batch_src_global generation:  0.012854576110839844
r_  generation:  0.1229867935180664
local_output_nid generation:  0.006230354309082031
local_in_edges_tensor generation:  0.008923530578613281
mini_batch_src_global generation:  0.014145612716674805
r_  generation:  0.12884306907653809
local_output_nid generation:  0.00638890266418457
local_in_edges_tensor generation:  0.006928682327270508
mini_batch_src_global generation:  0.014523029327392578
r_  generation:  0.12981009483337402
local_output_nid generation:  0.006485700607299805
local_in_edges_tensor generation:  0.007473945617675781
mini_batch_src_global generation:  0.020264625549316406
r_  generation:  0.1388072967529297
local_output_nid generation:  0.0066149234771728516
local_in_edges_tensor generation:  0.00821375846862793
mini_batch_src_global generation:  0.01578974723815918
r_  generation:  0.13544869422912598
local_output_nid generation:  0.006334543228149414
local_in_edges_tensor generation:  0.009167909622192383
mini_batch_src_global generation:  0.01526784896850586
r_  generation:  0.13172078132629395
local_output_nid generation:  0.006499052047729492
local_in_edges_tensor generation:  0.008018732070922852
mini_batch_src_global generation:  0.01624321937561035
r_  generation:  0.13845109939575195
local_output_nid generation:  0.006634235382080078
local_in_edges_tensor generation:  0.008353233337402344
mini_batch_src_global generation:  0.015863418579101562
r_  generation:  0.13770318031311035
local_output_nid generation:  0.007883071899414062
local_in_edges_tensor generation:  0.009208917617797852
mini_batch_src_global generation:  0.01714038848876953
r_  generation:  0.14458727836608887
local_output_nid generation:  0.011454343795776367
local_in_edges_tensor generation:  0.019722938537597656
mini_batch_src_global generation:  0.020685672760009766
r_  generation:  0.13182616233825684
local_output_nid generation:  0.007209062576293945
local_in_edges_tensor generation:  0.010315895080566406
mini_batch_src_global generation:  0.017198562622070312
r_  generation:  0.13863730430603027
local_output_nid generation:  0.0071222782135009766
local_in_edges_tensor generation:  0.008604288101196289
mini_batch_src_global generation:  0.016421794891357422
r_  generation:  0.13955998420715332
local_output_nid generation:  0.006959676742553711
local_in_edges_tensor generation:  0.00722050666809082
mini_batch_src_global generation:  0.01629638671875
r_  generation:  0.1371169090270996
local_output_nid generation:  0.007030487060546875
local_in_edges_tensor generation:  0.007283449172973633
mini_batch_src_global generation:  0.015761613845825195
r_  generation:  0.1338636875152588
local_output_nid generation:  0.007489204406738281
local_in_edges_tensor generation:  0.01016378402709961
mini_batch_src_global generation:  0.0172882080078125
r_  generation:  0.14643645286560059
local_output_nid generation:  0.006856441497802734
local_in_edges_tensor generation:  0.007489204406738281
mini_batch_src_global generation:  0.015938282012939453
r_  generation:  0.13342547416687012
local_output_nid generation:  0.0069408416748046875
local_in_edges_tensor generation:  0.007223367691040039
mini_batch_src_global generation:  0.01603555679321289
r_  generation:  0.1329817771911621
local_output_nid generation:  0.0073375701904296875
local_in_edges_tensor generation:  0.009582996368408203
mini_batch_src_global generation:  0.016043663024902344
r_  generation:  0.13823294639587402
local_output_nid generation:  0.0072345733642578125
local_in_edges_tensor generation:  0.010487079620361328
mini_batch_src_global generation:  0.016499757766723633
r_  generation:  0.13870620727539062
local_output_nid generation:  0.007194042205810547
local_in_edges_tensor generation:  0.00722813606262207
mini_batch_src_global generation:  0.01626896858215332
r_  generation:  0.13677000999450684
local_output_nid generation:  0.00707244873046875
local_in_edges_tensor generation:  0.009218454360961914
mini_batch_src_global generation:  0.01614689826965332
r_  generation:  0.1358633041381836
local_output_nid generation:  0.007213115692138672
local_in_edges_tensor generation:  0.009359359741210938
mini_batch_src_global generation:  0.016247987747192383
r_  generation:  0.14082956314086914
local_output_nid generation:  0.007079124450683594
local_in_edges_tensor generation:  0.007211923599243164
mini_batch_src_global generation:  0.01588273048400879
r_  generation:  0.1374034881591797
local_output_nid generation:  0.007185697555541992
local_in_edges_tensor generation:  0.007401227951049805
mini_batch_src_global generation:  0.016472339630126953
r_  generation:  0.13992691040039062
local_output_nid generation:  0.007254362106323242
local_in_edges_tensor generation:  0.00919651985168457
mini_batch_src_global generation:  0.016422271728515625
r_  generation:  0.1373157501220703
local_output_nid generation:  0.0072290897369384766
local_in_edges_tensor generation:  0.007300615310668945
mini_batch_src_global generation:  0.017310380935668945
r_  generation:  0.13891077041625977
local_output_nid generation:  0.007256031036376953
local_in_edges_tensor generation:  0.009471654891967773
mini_batch_src_global generation:  0.016051292419433594
r_  generation:  0.13875365257263184
local_output_nid generation:  0.0073773860931396484
local_in_edges_tensor generation:  0.00830078125
mini_batch_src_global generation:  0.017211437225341797
r_  generation:  0.14160990715026855
local_output_nid generation:  0.007166147232055664
local_in_edges_tensor generation:  0.007216453552246094
mini_batch_src_global generation:  0.01600170135498047
r_  generation:  0.13629984855651855
local_output_nid generation:  0.007045269012451172
local_in_edges_tensor generation:  0.007106781005859375
mini_batch_src_global generation:  0.015418291091918945
r_  generation:  0.13748764991760254
----------------------check_connections_block total spend ----------------------------- 6.398504018783569
generate_one_block  0.17003870010375977
generate_one_block  0.16147804260253906
generate_one_block  0.18052148818969727
generate_one_block  0.16466450691223145
generate_one_block  0.16418695449829102
generate_one_block  0.17431259155273438
generate_one_block  0.16756772994995117
generate_one_block  0.15815091133117676
generate_one_block  0.16039776802062988
generate_one_block  0.16779637336730957
generate_one_block  0.16987276077270508
generate_one_block  0.1555027961730957
generate_one_block  0.17032122611999512
generate_one_block  0.1716759204864502
generate_one_block  0.16079282760620117
generate_one_block  0.18167734146118164
generate_one_block  0.18020272254943848
generate_one_block  0.15882420539855957
generate_one_block  0.15998077392578125
generate_one_block  0.17016935348510742
generate_one_block  0.17117643356323242
generate_one_block  0.16758155822753906
generate_one_block  0.167405366897583
generate_one_block  0.17749834060668945
generate_one_block  0.1655580997467041
generate_one_block  0.1724529266357422
generate_one_block  0.1767115592956543
generate_one_block  0.16953611373901367
generate_one_block  0.16994953155517578
generate_one_block  0.1740124225616455
generate_one_block  0.16400837898254395
generate_one_block  0.16521120071411133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04610705375671387
gen group dst list time:  0.10231852531433105
time for parepare:  0.0189359188079834
local_output_nid generation:  0.020246028900146484
local_in_edges_tensor generation:  0.047406673431396484
mini_batch_src_global generation:  0.03687715530395508
r_  generation:  0.39452028274536133
local_output_nid generation:  0.02644944190979004
local_in_edges_tensor generation:  0.03930163383483887
mini_batch_src_global generation:  0.045485734939575195
r_  generation:  0.39299488067626953
local_output_nid generation:  0.026207447052001953
local_in_edges_tensor generation:  0.03265070915222168
mini_batch_src_global generation:  0.04496169090270996
r_  generation:  0.4003593921661377
local_output_nid generation:  0.029030561447143555
local_in_edges_tensor generation:  0.04219388961791992
mini_batch_src_global generation:  0.05061697959899902
r_  generation:  0.4184880256652832
local_output_nid generation:  0.025119304656982422
local_in_edges_tensor generation:  0.0342559814453125
mini_batch_src_global generation:  0.052459001541137695
r_  generation:  0.402632474899292
local_output_nid generation:  0.030076980590820312
local_in_edges_tensor generation:  0.03787541389465332
mini_batch_src_global generation:  0.04737448692321777
r_  generation:  0.4028301239013672
local_output_nid generation:  0.02603626251220703
local_in_edges_tensor generation:  0.029585599899291992
mini_batch_src_global generation:  0.0465998649597168
r_  generation:  0.40086936950683594
local_output_nid generation:  0.02602672576904297
local_in_edges_tensor generation:  0.026507139205932617
mini_batch_src_global generation:  0.04621315002441406
r_  generation:  0.40863633155822754
local_output_nid generation:  0.026081323623657227
local_in_edges_tensor generation:  0.029870986938476562
mini_batch_src_global generation:  0.046539306640625
r_  generation:  0.39937877655029297
local_output_nid generation:  0.026660919189453125
local_in_edges_tensor generation:  0.03831219673156738
mini_batch_src_global generation:  0.051375389099121094
r_  generation:  0.4040360450744629
local_output_nid generation:  0.02653217315673828
local_in_edges_tensor generation:  0.03016829490661621
mini_batch_src_global generation:  0.04714488983154297
r_  generation:  0.40717148780822754
local_output_nid generation:  0.025826692581176758
local_in_edges_tensor generation:  0.04262137413024902
mini_batch_src_global generation:  0.04726076126098633
r_  generation:  0.3977377414703369
local_output_nid generation:  0.027275800704956055
local_in_edges_tensor generation:  0.024696826934814453
mini_batch_src_global generation:  0.04718375205993652
r_  generation:  0.4082634449005127
local_output_nid generation:  0.026777267456054688
local_in_edges_tensor generation:  0.031366586685180664
mini_batch_src_global generation:  0.05808520317077637
r_  generation:  0.42560601234436035
local_output_nid generation:  0.0285186767578125
local_in_edges_tensor generation:  0.03134870529174805
mini_batch_src_global generation:  0.048926353454589844
r_  generation:  0.40053796768188477
local_output_nid generation:  0.026201248168945312
local_in_edges_tensor generation:  0.029710769653320312
mini_batch_src_global generation:  0.05018043518066406
r_  generation:  0.40033435821533203
local_output_nid generation:  0.026698827743530273
local_in_edges_tensor generation:  0.03197026252746582
mini_batch_src_global generation:  0.050936222076416016
r_  generation:  0.4103994369506836
local_output_nid generation:  0.02646660804748535
local_in_edges_tensor generation:  0.024019241333007812
mini_batch_src_global generation:  0.04858255386352539
r_  generation:  0.3990671634674072
local_output_nid generation:  0.026530027389526367
local_in_edges_tensor generation:  0.027017593383789062
mini_batch_src_global generation:  0.04697680473327637
r_  generation:  0.4016764163970947
local_output_nid generation:  0.027027606964111328
local_in_edges_tensor generation:  0.037450551986694336
mini_batch_src_global generation:  0.04821038246154785
r_  generation:  0.41105103492736816
local_output_nid generation:  0.02780294418334961
local_in_edges_tensor generation:  0.028269529342651367
mini_batch_src_global generation:  0.06875157356262207
r_  generation:  0.40973377227783203
local_output_nid generation:  0.02916240692138672
local_in_edges_tensor generation:  0.03180575370788574
mini_batch_src_global generation:  0.053995609283447266
r_  generation:  0.4050123691558838
local_output_nid generation:  0.026613712310791016
local_in_edges_tensor generation:  0.027213335037231445
mini_batch_src_global generation:  0.047547340393066406
r_  generation:  0.40123414993286133
local_output_nid generation:  0.026737689971923828
local_in_edges_tensor generation:  0.02811455726623535
mini_batch_src_global generation:  0.04776573181152344
r_  generation:  0.4044826030731201
local_output_nid generation:  0.026575803756713867
local_in_edges_tensor generation:  0.03150129318237305
mini_batch_src_global generation:  0.0467376708984375
r_  generation:  0.39944911003112793
local_output_nid generation:  0.0266265869140625
local_in_edges_tensor generation:  0.028102397918701172
mini_batch_src_global generation:  0.050245046615600586
r_  generation:  0.40368151664733887
local_output_nid generation:  0.026679039001464844
local_in_edges_tensor generation:  0.03148174285888672
mini_batch_src_global generation:  0.04841494560241699
r_  generation:  0.4047353267669678
local_output_nid generation:  0.026695728302001953
local_in_edges_tensor generation:  0.023947954177856445
mini_batch_src_global generation:  0.0478818416595459
r_  generation:  0.4059410095214844
local_output_nid generation:  0.026692628860473633
local_in_edges_tensor generation:  0.02730703353881836
mini_batch_src_global generation:  0.04979991912841797
r_  generation:  0.40813446044921875
local_output_nid generation:  0.026598691940307617
local_in_edges_tensor generation:  0.031435489654541016
mini_batch_src_global generation:  0.046929121017456055
r_  generation:  0.4038524627685547
local_output_nid generation:  0.02668929100036621
local_in_edges_tensor generation:  0.02780294418334961
mini_batch_src_global generation:  0.04733443260192871
r_  generation:  0.4064633846282959
local_output_nid generation:  0.026468753814697266
local_in_edges_tensor generation:  0.02351069450378418
mini_batch_src_global generation:  0.04671430587768555
r_  generation:  0.4000110626220703
----------------------check_connections_block total spend ----------------------------- 19.219873905181885
generate_one_block  0.6127285957336426
generate_one_block  0.5083491802215576
generate_one_block  0.5157012939453125
generate_one_block  0.5141980648040771
generate_one_block  0.5210962295532227
generate_one_block  0.5267326831817627
generate_one_block  0.5160219669342041
generate_one_block  0.5087900161743164
generate_one_block  0.510136604309082
generate_one_block  0.5303878784179688
generate_one_block  0.5288231372833252
generate_one_block  0.5119278430938721
generate_one_block  0.5236248970031738
generate_one_block  0.5313115119934082
generate_one_block  0.5036687850952148
generate_one_block  0.5059559345245361
generate_one_block  0.5367085933685303
generate_one_block  0.5039184093475342
generate_one_block  0.5031177997589111
generate_one_block  0.5253102779388428
generate_one_block  0.5355677604675293
generate_one_block  0.5149929523468018
generate_one_block  0.5032956600189209
generate_one_block  0.5144617557525635
generate_one_block  0.5203425884246826
generate_one_block  0.5174849033355713
generate_one_block  0.514725923538208
generate_one_block  0.527099609375
generate_one_block  0.5227541923522949
generate_one_block  0.5255286693572998
generate_one_block  0.5212438106536865
generate_one_block  0.5084517002105713
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  25.618377923965454
block generation total time  22.053696155548096
average batch blocks generation time:  0.689178004860878
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08174657821655273  GigaBytes
Max Memory Allocated: 0.08174657821655273  GigaBytes

torch.Size([145152, 128])
torch.Size([98850, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.3446044921875  GigaBytes
Max Memory Allocated: 0.3544907569885254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08225631713867188  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

torch.Size([144966, 128])
torch.Size([98194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34246063232421875  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08245563507080078  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

torch.Size([145352, 128])
torch.Size([98757, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34290218353271484  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0826253890991211  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

torch.Size([145388, 128])
torch.Size([99139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34474658966064453  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08246135711669922  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

torch.Size([145160, 128])
torch.Size([98228, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3430972099304199  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08470678329467773  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

torch.Size([145759, 128])
torch.Size([100013, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35049009323120117  GigaBytes
Max Memory Allocated: 0.3952484130859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08361530303955078  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([145555, 128])
torch.Size([98798, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34654855728149414  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08246564865112305  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([145339, 128])
torch.Size([98241, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3422055244445801  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08213567733764648  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([144679, 128])
torch.Size([97630, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34150028228759766  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08357620239257812  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([145158, 128])
torch.Size([99378, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34676551818847656  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0846872329711914  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([145517, 128])
torch.Size([99466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3493537902832031  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08199262619018555  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([144679, 128])
torch.Size([96956, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.33739376068115234  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08469724655151367  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

torch.Size([145858, 128])
torch.Size([99995, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35054636001586914  GigaBytes
Max Memory Allocated: 0.40032291412353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08471059799194336  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

torch.Size([145783, 128])
torch.Size([99806, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35007333755493164  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08233880996704102  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

torch.Size([144981, 128])
torch.Size([97732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3421502113342285  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08245325088500977  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

torch.Size([145147, 128])
torch.Size([98144, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3428025245666504  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08478450775146484  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

torch.Size([145869, 128])
torch.Size([101189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3567996025085449  GigaBytes
Max Memory Allocated: 0.40079689025878906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0823817253112793  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145137, 128])
torch.Size([98380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.342496395111084  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08248758316040039  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145295, 128])
torch.Size([98230, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34238290786743164  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0846872329711914  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([146015, 128])
torch.Size([100176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35077381134033203  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08469867706298828  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145772, 128])
torch.Size([99489, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3494138717651367  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0846700668334961  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145770, 128])
torch.Size([99818, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.35003089904785156  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08355522155761719  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145496, 128])
torch.Size([98838, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3450946807861328  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0836639404296875  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145665, 128])
torch.Size([99404, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34821605682373047  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08254003524780273  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145309, 128])
torch.Size([98932, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.343935489654541  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08268022537231445  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145341, 128])
torch.Size([98895, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3455815315246582  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08368492126464844  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145507, 128])
torch.Size([99517, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3484363555908203  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.0846710205078125  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145592, 128])
torch.Size([99682, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34975528717041016  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08359003067016602  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145182, 128])
torch.Size([99059, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34654903411865234  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08369779586791992  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145320, 128])
torch.Size([99581, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34865856170654297  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08364105224609375  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([146091, 128])
torch.Size([99763, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.3473362922668457  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08243799209594727  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145179, 128])
torch.Size([98248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.34271764755249023  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03133559972047806 |0.024156399071216583 |0.026686780154705048 |9.906291961669922e-05 |0.00430867075920105 |0.0038225650787353516 |
----------------------------------------------------------pseudo_mini_loss sum 5.612583160400391
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8572713
Number of first layer input nodes during this epoch:  4653013
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.1014547348022461  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02328014373779297
range selection method range initialization spend 0.011591911315917969
time for parepare:  0.016024351119995117
local_output_nid generation:  0.0007321834564208984
local_in_edges_tensor generation:  0.0042724609375
mini_batch_src_global generation:  0.0014140605926513672
r_  generation:  0.00821375846862793
local_output_nid generation:  0.0008268356323242188
local_in_edges_tensor generation:  0.0005860328674316406
mini_batch_src_global generation:  0.0012769699096679688
r_  generation:  0.008893489837646484
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.001058340072631836
r_  generation:  0.00787353515625
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.00046515464782714844
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.007682323455810547
local_output_nid generation:  0.0007994174957275391
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.008167505264282227
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0008392333984375
r_  generation:  0.008286237716674805
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0008425712585449219
r_  generation:  0.008252620697021484
local_output_nid generation:  0.0007596015930175781
local_in_edges_tensor generation:  0.0005085468292236328
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.008185386657714844
local_output_nid generation:  0.0007615089416503906
local_in_edges_tensor generation:  0.0004639625549316406
mini_batch_src_global generation:  0.0008909702301025391
r_  generation:  0.008174896240234375
local_output_nid generation:  0.0008013248443603516
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0008738040924072266
r_  generation:  0.00812983512878418
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.0004544258117675781
mini_batch_src_global generation:  0.0008406639099121094
r_  generation:  0.011043071746826172
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.00046515464782714844
mini_batch_src_global generation:  0.00086212158203125
r_  generation:  0.008193731307983398
local_output_nid generation:  0.0008096694946289062
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0008640289306640625
r_  generation:  0.008247852325439453
local_output_nid generation:  0.0007674694061279297
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.00817251205444336
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0008640289306640625
r_  generation:  0.008200645446777344
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.0004527568817138672
mini_batch_src_global generation:  0.0008573532104492188
r_  generation:  0.008093833923339844
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0010170936584472656
r_  generation:  0.008289098739624023
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.0004611015319824219
mini_batch_src_global generation:  0.0008606910705566406
r_  generation:  0.008424043655395508
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.00838017463684082
local_output_nid generation:  0.0007462501525878906
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.003677845001220703
r_  generation:  0.008411645889282227
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0008707046508789062
r_  generation:  0.008092641830444336
local_output_nid generation:  0.0007421970367431641
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0008780956268310547
r_  generation:  0.008654594421386719
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.0008375644683837891
r_  generation:  0.008128881454467773
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0004596710205078125
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.008419275283813477
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009067058563232422
r_  generation:  0.008530616760253906
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.00045800209045410156
mini_batch_src_global generation:  0.0008711814880371094
r_  generation:  0.008393526077270508
local_output_nid generation:  0.0007460117340087891
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.008548736572265625
local_output_nid generation:  0.0007290840148925781
local_in_edges_tensor generation:  0.00045037269592285156
mini_batch_src_global generation:  0.0008642673492431641
r_  generation:  0.011854171752929688
local_output_nid generation:  0.0009846687316894531
local_in_edges_tensor generation:  0.0006632804870605469
mini_batch_src_global generation:  0.0012564659118652344
r_  generation:  0.008849859237670898
local_output_nid generation:  0.0007634162902832031
local_in_edges_tensor generation:  0.0005471706390380859
mini_batch_src_global generation:  0.000885009765625
r_  generation:  0.008169889450073242
local_output_nid generation:  0.0007512569427490234
local_in_edges_tensor generation:  0.0005621910095214844
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.008582115173339844
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0005395412445068359
mini_batch_src_global generation:  0.0008931159973144531
r_  generation:  0.008234500885009766
----------------------check_connections_block total spend ----------------------------- 0.43212342262268066
generate_one_block  0.013435125350952148
generate_one_block  0.015428543090820312
generate_one_block  0.01639389991760254
generate_one_block  0.013024568557739258
generate_one_block  0.013296365737915039
generate_one_block  0.01334691047668457
generate_one_block  0.013115882873535156
generate_one_block  0.01338505744934082
generate_one_block  0.013753652572631836
generate_one_block  0.013159990310668945
generate_one_block  0.015512228012084961
generate_one_block  0.01340174674987793
generate_one_block  0.013080835342407227
generate_one_block  0.012867450714111328
generate_one_block  0.013322591781616211
generate_one_block  0.013208627700805664
generate_one_block  0.013525009155273438
generate_one_block  0.013339519500732422
generate_one_block  0.013840913772583008
generate_one_block  0.01353907585144043
generate_one_block  0.013154983520507812
generate_one_block  0.013729572296142578
generate_one_block  0.012958049774169922
generate_one_block  0.013556957244873047
generate_one_block  0.014027118682861328
generate_one_block  0.013381242752075195
generate_one_block  0.013573169708251953
generate_one_block  0.01297760009765625
generate_one_block  0.013544797897338867
generate_one_block  0.01294398307800293
generate_one_block  0.013279199600219727
generate_one_block  0.01339268684387207
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049751996994018555
gen group dst list time:  0.021270751953125
time for parepare:  0.023398876190185547
local_output_nid generation:  0.003887653350830078
local_in_edges_tensor generation:  0.02137446403503418
mini_batch_src_global generation:  0.011128902435302734
r_  generation:  0.11545991897583008
local_output_nid generation:  0.006058692932128906
local_in_edges_tensor generation:  0.00918722152709961
mini_batch_src_global generation:  0.014540910720825195
r_  generation:  0.12333106994628906
local_output_nid generation:  0.006026744842529297
local_in_edges_tensor generation:  0.026979923248291016
mini_batch_src_global generation:  0.013118982315063477
r_  generation:  0.12678146362304688
local_output_nid generation:  0.006306171417236328
local_in_edges_tensor generation:  0.009310722351074219
mini_batch_src_global generation:  0.014117240905761719
r_  generation:  0.12926983833312988
local_output_nid generation:  0.0069427490234375
local_in_edges_tensor generation:  0.009625673294067383
mini_batch_src_global generation:  0.015140295028686523
r_  generation:  0.1319739818572998
local_output_nid generation:  0.006891965866088867
local_in_edges_tensor generation:  0.01003885269165039
mini_batch_src_global generation:  0.015424013137817383
r_  generation:  0.1340644359588623
local_output_nid generation:  0.006997585296630859
local_in_edges_tensor generation:  0.009791851043701172
mini_batch_src_global generation:  0.017151832580566406
r_  generation:  0.13468456268310547
local_output_nid generation:  0.006763935089111328
local_in_edges_tensor generation:  0.009802579879760742
mini_batch_src_global generation:  0.01578354835510254
r_  generation:  0.1331934928894043
local_output_nid generation:  0.0067195892333984375
local_in_edges_tensor generation:  0.00897669792175293
mini_batch_src_global generation:  0.017119169235229492
r_  generation:  0.1363050937652588
local_output_nid generation:  0.006610870361328125
local_in_edges_tensor generation:  0.007636070251464844
mini_batch_src_global generation:  0.015778064727783203
r_  generation:  0.1316206455230713
local_output_nid generation:  0.006972789764404297
local_in_edges_tensor generation:  0.007834434509277344
mini_batch_src_global generation:  0.01653432846069336
r_  generation:  0.1363222599029541
local_output_nid generation:  0.007235288619995117
local_in_edges_tensor generation:  0.010953664779663086
mini_batch_src_global generation:  0.019104480743408203
r_  generation:  0.13605427742004395
local_output_nid generation:  0.007174968719482422
local_in_edges_tensor generation:  0.007948875427246094
mini_batch_src_global generation:  0.016002655029296875
r_  generation:  0.13462471961975098
local_output_nid generation:  0.0071337223052978516
local_in_edges_tensor generation:  0.007555484771728516
mini_batch_src_global generation:  0.016183853149414062
r_  generation:  0.13265776634216309
local_output_nid generation:  0.007349252700805664
local_in_edges_tensor generation:  0.007790088653564453
mini_batch_src_global generation:  0.020180940628051758
r_  generation:  0.1339423656463623
local_output_nid generation:  0.007292747497558594
local_in_edges_tensor generation:  0.010039329528808594
mini_batch_src_global generation:  0.01650404930114746
r_  generation:  0.13719892501831055
local_output_nid generation:  0.007418155670166016
local_in_edges_tensor generation:  0.009251832962036133
mini_batch_src_global generation:  0.016483783721923828
r_  generation:  0.14216303825378418
local_output_nid generation:  0.007174491882324219
local_in_edges_tensor generation:  0.008063554763793945
mini_batch_src_global generation:  0.018383502960205078
r_  generation:  0.13504624366760254
local_output_nid generation:  0.007410287857055664
local_in_edges_tensor generation:  0.009333133697509766
mini_batch_src_global generation:  0.016460418701171875
r_  generation:  0.13772225379943848
local_output_nid generation:  0.008348464965820312
local_in_edges_tensor generation:  0.016267061233520508
mini_batch_src_global generation:  0.025300025939941406
r_  generation:  0.141618013381958
local_output_nid generation:  0.009863853454589844
local_in_edges_tensor generation:  0.011303901672363281
mini_batch_src_global generation:  0.016233444213867188
r_  generation:  0.13744211196899414
local_output_nid generation:  0.0074999332427978516
local_in_edges_tensor generation:  0.008718729019165039
mini_batch_src_global generation:  0.020139694213867188
r_  generation:  0.14064669609069824
local_output_nid generation:  0.020937204360961914
local_in_edges_tensor generation:  0.008551597595214844
mini_batch_src_global generation:  0.01594257354736328
r_  generation:  0.13164567947387695
local_output_nid generation:  0.0074579715728759766
local_in_edges_tensor generation:  0.008384227752685547
mini_batch_src_global generation:  0.01604437828063965
r_  generation:  0.14497780799865723
local_output_nid generation:  0.007587432861328125
local_in_edges_tensor generation:  0.0114593505859375
mini_batch_src_global generation:  0.01665472984313965
r_  generation:  0.13898801803588867
local_output_nid generation:  0.00724029541015625
local_in_edges_tensor generation:  0.008253097534179688
mini_batch_src_global generation:  0.016251802444458008
r_  generation:  0.13895869255065918
local_output_nid generation:  0.007430553436279297
local_in_edges_tensor generation:  0.009367704391479492
mini_batch_src_global generation:  0.01745915412902832
r_  generation:  0.14135503768920898
local_output_nid generation:  0.007216215133666992
local_in_edges_tensor generation:  0.008109569549560547
mini_batch_src_global generation:  0.016310453414916992
r_  generation:  0.14566278457641602
local_output_nid generation:  0.0072629451751708984
local_in_edges_tensor generation:  0.007985115051269531
mini_batch_src_global generation:  0.016153573989868164
r_  generation:  0.14024853706359863
local_output_nid generation:  0.007232189178466797
local_in_edges_tensor generation:  0.00815272331237793
mini_batch_src_global generation:  0.016173124313354492
r_  generation:  0.1401536464691162
local_output_nid generation:  0.008228540420532227
local_in_edges_tensor generation:  0.021327495574951172
mini_batch_src_global generation:  0.01810622215270996
r_  generation:  0.13811969757080078
local_output_nid generation:  0.007236003875732422
local_in_edges_tensor generation:  0.008634567260742188
mini_batch_src_global generation:  0.0172421932220459
r_  generation:  0.14718222618103027
----------------------check_connections_block total spend ----------------------------- 6.5173304080963135
generate_one_block  0.16830778121948242
generate_one_block  0.17016053199768066
generate_one_block  0.1604290008544922
generate_one_block  0.16047906875610352
generate_one_block  0.18443584442138672
generate_one_block  0.16635632514953613
generate_one_block  0.16665029525756836
generate_one_block  0.17281150817871094
generate_one_block  0.16811418533325195
generate_one_block  0.15807700157165527
generate_one_block  0.16289138793945312
generate_one_block  0.16686129570007324
generate_one_block  0.16452503204345703
generate_one_block  0.16759324073791504
generate_one_block  0.16532015800476074
generate_one_block  0.16623497009277344
generate_one_block  0.17146730422973633
generate_one_block  0.16088008880615234
generate_one_block  0.16166901588439941
generate_one_block  0.20282673835754395
generate_one_block  0.1661663055419922
generate_one_block  0.17138957977294922
generate_one_block  0.16935014724731445
generate_one_block  0.1755664348602295
generate_one_block  0.17216253280639648
generate_one_block  0.16690421104431152
generate_one_block  0.17159414291381836
generate_one_block  0.1616365909576416
generate_one_block  0.16962647438049316
generate_one_block  0.16195297241210938
generate_one_block  0.16245365142822266
generate_one_block  0.16928625106811523
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03949570655822754
gen group dst list time:  0.09713625907897949
time for parepare:  0.017220258712768555
local_output_nid generation:  0.020123720169067383
local_in_edges_tensor generation:  0.04604673385620117
mini_batch_src_global generation:  0.035730838775634766
r_  generation:  0.3823261260986328
local_output_nid generation:  0.0263214111328125
local_in_edges_tensor generation:  0.04022359848022461
mini_batch_src_global generation:  0.04589724540710449
r_  generation:  0.39054107666015625
local_output_nid generation:  0.02599310874938965
local_in_edges_tensor generation:  0.033289432525634766
mini_batch_src_global generation:  0.045264244079589844
r_  generation:  0.40030932426452637
local_output_nid generation:  0.025214195251464844
local_in_edges_tensor generation:  0.03384208679199219
mini_batch_src_global generation:  0.0464472770690918
r_  generation:  0.39116668701171875
local_output_nid generation:  0.025432109832763672
local_in_edges_tensor generation:  0.026993751525878906
mini_batch_src_global generation:  0.049832820892333984
r_  generation:  0.4047374725341797
local_output_nid generation:  0.0255734920501709
local_in_edges_tensor generation:  0.030969858169555664
mini_batch_src_global generation:  0.04761362075805664
r_  generation:  0.3998093605041504
local_output_nid generation:  0.025350093841552734
local_in_edges_tensor generation:  0.03056502342224121
mini_batch_src_global generation:  0.04666423797607422
r_  generation:  0.3997530937194824
local_output_nid generation:  0.025530576705932617
local_in_edges_tensor generation:  0.030666112899780273
mini_batch_src_global generation:  0.04853487014770508
r_  generation:  0.4002037048339844
local_output_nid generation:  0.025339603424072266
local_in_edges_tensor generation:  0.04300236701965332
mini_batch_src_global generation:  0.046976327896118164
r_  generation:  0.4029579162597656
local_output_nid generation:  0.025400400161743164
local_in_edges_tensor generation:  0.029812335968017578
mini_batch_src_global generation:  0.046570539474487305
r_  generation:  0.39577579498291016
local_output_nid generation:  0.026053428649902344
local_in_edges_tensor generation:  0.027255535125732422
mini_batch_src_global generation:  0.049751996994018555
r_  generation:  0.40502214431762695
local_output_nid generation:  0.02668905258178711
local_in_edges_tensor generation:  0.03876018524169922
mini_batch_src_global generation:  0.047209978103637695
r_  generation:  0.3996121883392334
local_output_nid generation:  0.02565598487854004
local_in_edges_tensor generation:  0.030727624893188477
mini_batch_src_global generation:  0.04703116416931152
r_  generation:  0.3976585865020752
local_output_nid generation:  0.025934219360351562
local_in_edges_tensor generation:  0.031031370162963867
mini_batch_src_global generation:  0.04696249961853027
r_  generation:  0.41918277740478516
local_output_nid generation:  0.027776241302490234
local_in_edges_tensor generation:  0.03309965133666992
mini_batch_src_global generation:  0.04744601249694824
r_  generation:  0.4008204936981201
local_output_nid generation:  0.026874542236328125
local_in_edges_tensor generation:  0.038628578186035156
mini_batch_src_global generation:  0.04818534851074219
r_  generation:  0.4017617702484131
local_output_nid generation:  0.026951313018798828
local_in_edges_tensor generation:  0.031378746032714844
mini_batch_src_global generation:  0.05219864845275879
r_  generation:  0.4129209518432617
local_output_nid generation:  0.026567697525024414
local_in_edges_tensor generation:  0.027434825897216797
mini_batch_src_global generation:  0.04683256149291992
r_  generation:  0.4029662609100342
local_output_nid generation:  0.026991605758666992
local_in_edges_tensor generation:  0.027627229690551758
mini_batch_src_global generation:  0.0473635196685791
r_  generation:  0.40630197525024414
local_output_nid generation:  0.027053117752075195
local_in_edges_tensor generation:  0.03457236289978027
mini_batch_src_global generation:  0.047448158264160156
r_  generation:  0.4116642475128174
local_output_nid generation:  0.026924848556518555
local_in_edges_tensor generation:  0.03100109100341797
mini_batch_src_global generation:  0.048049211502075195
r_  generation:  0.40590620040893555
local_output_nid generation:  0.027178287506103516
local_in_edges_tensor generation:  0.036197662353515625
mini_batch_src_global generation:  0.049361467361450195
r_  generation:  0.41365790367126465
local_output_nid generation:  0.026477813720703125
local_in_edges_tensor generation:  0.027272939682006836
mini_batch_src_global generation:  0.04695010185241699
r_  generation:  0.4034557342529297
local_output_nid generation:  0.038102149963378906
local_in_edges_tensor generation:  0.03461170196533203
mini_batch_src_global generation:  0.04979515075683594
r_  generation:  0.405963659286499
local_output_nid generation:  0.0269012451171875
local_in_edges_tensor generation:  0.03125572204589844
mini_batch_src_global generation:  0.047247886657714844
r_  generation:  0.4089632034301758
local_output_nid generation:  0.026892423629760742
local_in_edges_tensor generation:  0.030542850494384766
mini_batch_src_global generation:  0.04761195182800293
r_  generation:  0.40019798278808594
local_output_nid generation:  0.027303695678710938
local_in_edges_tensor generation:  0.0345611572265625
mini_batch_src_global generation:  0.046959638595581055
r_  generation:  0.416961669921875
local_output_nid generation:  0.026819467544555664
local_in_edges_tensor generation:  0.037042856216430664
mini_batch_src_global generation:  0.04839062690734863
r_  generation:  0.40187954902648926
local_output_nid generation:  0.026864290237426758
local_in_edges_tensor generation:  0.03415560722351074
mini_batch_src_global generation:  0.046476125717163086
r_  generation:  0.4050912857055664
local_output_nid generation:  0.026702880859375
local_in_edges_tensor generation:  0.0270993709564209
mini_batch_src_global generation:  0.04736614227294922
r_  generation:  0.4026823043823242
local_output_nid generation:  0.0272064208984375
local_in_edges_tensor generation:  0.03471255302429199
mini_batch_src_global generation:  0.0468747615814209
r_  generation:  0.40454649925231934
local_output_nid generation:  0.027012348175048828
local_in_edges_tensor generation:  0.035079240798950195
mini_batch_src_global generation:  0.047204017639160156
r_  generation:  0.40509533882141113
----------------------check_connections_block total spend ----------------------------- 19.128796815872192
generate_one_block  0.5118846893310547
generate_one_block  0.5133743286132812
generate_one_block  0.5109207630157471
generate_one_block  0.516524076461792
generate_one_block  0.6175801753997803
generate_one_block  0.530585527420044
generate_one_block  0.5143678188323975
generate_one_block  0.5212218761444092
generate_one_block  0.520972490310669
generate_one_block  0.5204379558563232
generate_one_block  0.5240993499755859
generate_one_block  0.5229134559631348
generate_one_block  0.5097696781158447
generate_one_block  0.5212364196777344
generate_one_block  0.5121057033538818
generate_one_block  0.5363044738769531
generate_one_block  0.5375826358795166
generate_one_block  0.5092852115631104
generate_one_block  0.5081801414489746
generate_one_block  0.5370750427246094
generate_one_block  0.5328915119171143
generate_one_block  0.5323500633239746
generate_one_block  0.5089693069458008
generate_one_block  0.5342788696289062
generate_one_block  0.5424814224243164
generate_one_block  0.5120797157287598
generate_one_block  0.5828342437744141
generate_one_block  0.5267322063446045
generate_one_block  0.5489251613616943
generate_one_block  0.5544371604919434
generate_one_block  0.5337362289428711
generate_one_block  0.5466289520263672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.1014547348022461  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

connection checking time:  25.646127223968506
block generation total time  22.336946725845337
average batch blocks generation time:  0.6980295851826668
block dataloader generation time/epoch 50.32722187042236
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.08400774002075195  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145510, 128])
torch.Size([98556, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34392642974853516  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08302450180053711  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145223, 128])
torch.Size([98064, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3435063362121582  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08305549621582031  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145302, 128])
torch.Size([98290, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3429083824157715  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08407878875732422  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145432, 128])
torch.Size([98179, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3444700241088867  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08525657653808594  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145518, 128])
torch.Size([99546, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.35006284713745117  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0852351188659668  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145651, 128])
torch.Size([99637, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3489651679992676  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08303356170654297  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([144956, 128])
torch.Size([98617, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34470319747924805  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08422088623046875  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145451, 128])
torch.Size([99139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3471689224243164  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0830984115600586  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145004, 128])
torch.Size([98744, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34694957733154297  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0828242301940918  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([144851, 128])
torch.Size([98009, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3424515724182129  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08321094512939453  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145388, 128])
torch.Size([98727, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3449406623840332  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08321857452392578  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145356, 128])
torch.Size([99034, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3460206985473633  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.0827932357788086  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([144694, 128])
torch.Size([98154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34308910369873047  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08301734924316406  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145278, 128])
torch.Size([98286, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34345579147338867  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08310794830322266  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145390, 128])
torch.Size([98671, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3448481559753418  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08522510528564453  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145899, 128])
torch.Size([99695, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34905529022216797  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08525657653808594  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145762, 128])
torch.Size([100113, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.35120153427124023  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08308696746826172  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145302, 128])
torch.Size([98414, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3441042900085449  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08414554595947266  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145698, 128])
torch.Size([99177, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34747934341430664  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08525800704956055  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145896, 128])
torch.Size([100481, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3555908203125  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08422279357910156  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145737, 128])
torch.Size([99248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3486051559448242  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08526945114135742  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

torch.Size([145945, 128])
torch.Size([100628, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3558840751647949  GigaBytes
Max Memory Allocated: 0.40690183639526367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08297014236450195  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145317, 128])
torch.Size([97927, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3426337242126465  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08422708511352539  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145305, 128])
torch.Size([99529, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34902334213256836  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08420944213867188  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145219, 128])
torch.Size([99383, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34897613525390625  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08307456970214844  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145138, 128])
torch.Size([98711, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34441184997558594  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08430242538452148  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145404, 128])
torch.Size([100056, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.350308895111084  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08316230773925781  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145328, 128])
torch.Size([98853, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34550952911376953  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08414220809936523  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145098, 128])
torch.Size([99006, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3472437858581543  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08414459228515625  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145685, 128])
torch.Size([98876, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34566354751586914  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08418941497802734  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145425, 128])
torch.Size([99082, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.34711503982543945  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.08418703079223633  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

torch.Size([145247, 128])
torch.Size([99158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8807373046875 GB
    Memory Allocated: 0.3472881317138672  GigaBytes
Max Memory Allocated: 0.4082374572753906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02936803549528122 |0.012135177850723267 |0.003414951264858246 |8.916109800338745e-05 |0.0033404603600502014 |0.002947568893432617 |
----------------------------------------------------------pseudo_mini_loss sum 3.5761778354644775
Total (block generation + training)time/epoch 51.92456841468811
Training time/epoch 1.5970640182495117
Training time without block to device /epoch 1.2087383270263672
Training time without total dataloading part /epoch 0.22197389602661133
load block tensor time/epoch 0.939777135848999
block to device time/epoch 0.38832569122314453
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8571640
Number of first layer input nodes during this epoch:  4652409
