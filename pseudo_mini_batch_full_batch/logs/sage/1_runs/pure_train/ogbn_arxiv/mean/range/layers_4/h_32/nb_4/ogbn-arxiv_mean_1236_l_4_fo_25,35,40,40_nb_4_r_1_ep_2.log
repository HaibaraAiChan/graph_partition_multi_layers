Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648481353.5581071
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02492070198059082
range selection method range initialization spend 0.013320207595825195
time for parepare:  0.018128156661987305
local_output_nid generation:  0.0052683353424072266
local_in_edges_tensor generation:  0.005913496017456055
mini_batch_src_global generation:  0.006605386734008789
r_  generation:  0.08317255973815918
local_output_nid generation:  0.006147861480712891
local_in_edges_tensor generation:  0.003008127212524414
mini_batch_src_global generation:  0.008434772491455078
r_  generation:  0.0876150131225586
local_output_nid generation:  0.006184577941894531
local_in_edges_tensor generation:  0.003077268600463867
mini_batch_src_global generation:  0.006526470184326172
r_  generation:  0.08871912956237793
local_output_nid generation:  0.006264686584472656
local_in_edges_tensor generation:  0.0030107498168945312
mini_batch_src_global generation:  0.007004499435424805
r_  generation:  0.09105396270751953
----------------------check_connections_block total spend ----------------------------- 0.5060868263244629
generate_one_block  0.10208296775817871
generate_one_block  0.10206937789916992
generate_one_block  0.10296082496643066
generate_one_block  0.1024010181427002
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04105544090270996
gen group dst list time:  0.011141300201416016
time for parepare:  0.019173145294189453
local_output_nid generation:  0.014725208282470703
local_in_edges_tensor generation:  0.03734874725341797
mini_batch_src_global generation:  0.039717674255371094
r_  generation:  0.4057803153991699
local_output_nid generation:  0.0211794376373291
local_in_edges_tensor generation:  0.03779864311218262
mini_batch_src_global generation:  0.05161857604980469
r_  generation:  0.41011810302734375
local_output_nid generation:  0.022205114364624023
local_in_edges_tensor generation:  0.03135848045349121
mini_batch_src_global generation:  0.048119306564331055
r_  generation:  0.4257946014404297
local_output_nid generation:  0.022341251373291016
local_in_edges_tensor generation:  0.032685279846191406
mini_batch_src_global generation:  0.04953598976135254
r_  generation:  0.42099738121032715
----------------------check_connections_block total spend ----------------------------- 2.452716827392578
generate_one_block  0.5690667629241943
generate_one_block  0.5309631824493408
generate_one_block  0.5494546890258789
generate_one_block  0.545917272567749
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0311582088470459
gen group dst list time:  0.020680665969848633
time for parepare:  0.01872992515563965
local_output_nid generation:  0.024083614349365234
local_in_edges_tensor generation:  0.042122840881347656
mini_batch_src_global generation:  0.0501093864440918
r_  generation:  0.5335597991943359
local_output_nid generation:  0.032895565032958984
local_in_edges_tensor generation:  0.04962420463562012
mini_batch_src_global generation:  0.06308174133300781
r_  generation:  0.5362653732299805
local_output_nid generation:  0.033506155014038086
local_in_edges_tensor generation:  0.04093742370605469
mini_batch_src_global generation:  0.06124615669250488
r_  generation:  0.5438568592071533
local_output_nid generation:  0.03397536277770996
local_in_edges_tensor generation:  0.046790122985839844
mini_batch_src_global generation:  0.05822253227233887
r_  generation:  0.5465776920318604
----------------------check_connections_block total spend ----------------------------- 3.1882832050323486
generate_one_block  0.6932015419006348
generate_one_block  0.6867091655731201
generate_one_block  0.6887855529785156
generate_one_block  0.6873786449432373
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02736687660217285
gen group dst list time:  0.02335047721862793
time for parepare:  0.01858377456665039
local_output_nid generation:  0.027512788772583008
local_in_edges_tensor generation:  0.03898978233337402
mini_batch_src_global generation:  0.04568743705749512
r_  generation:  0.5040884017944336
local_output_nid generation:  0.03439140319824219
local_in_edges_tensor generation:  0.04684948921203613
mini_batch_src_global generation:  0.05742025375366211
r_  generation:  0.5126667022705078
local_output_nid generation:  0.034981489181518555
local_in_edges_tensor generation:  0.0438539981842041
mini_batch_src_global generation:  0.06101226806640625
r_  generation:  0.5112049579620361
local_output_nid generation:  0.03584647178649902
local_in_edges_tensor generation:  0.03495621681213379
mini_batch_src_global generation:  0.05757451057434082
r_  generation:  0.5183656215667725
----------------------check_connections_block total spend ----------------------------- 3.0401580333709717
generate_one_block  0.6342849731445312
generate_one_block  0.6750383377075195
generate_one_block  0.6493954658508301
generate_one_block  0.6484160423278809
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

connection checking time:  8.681158065795898
block generation total time  7.558611631393433
average batch blocks generation time:  1.8896529078483582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11599302291870117  GigaBytes
Max Memory Allocated: 0.11599302291870117  GigaBytes

torch.Size([166681, 128])
torch.Size([164770, 32])
torch.Size([155147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6834716796875 GB
    Memory Allocated: 0.36002397537231445  GigaBytes
Max Memory Allocated: 0.36341190338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.11986875534057617  GigaBytes
Max Memory Allocated: 0.3800210952758789  GigaBytes

torch.Size([166674, 128])
torch.Size([164702, 32])
torch.Size([154949, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3595128059387207  GigaBytes
Max Memory Allocated: 0.3800210952758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.12044048309326172  GigaBytes
Max Memory Allocated: 0.3800210952758789  GigaBytes

torch.Size([166769, 128])
torch.Size([164720, 32])
torch.Size([154847, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3617873191833496  GigaBytes
Max Memory Allocated: 0.3800210952758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.12048530578613281  GigaBytes
Max Memory Allocated: 0.3810000419616699  GigaBytes

torch.Size([166700, 128])
torch.Size([164677, 32])
torch.Size([154979, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3612360954284668  GigaBytes
Max Memory Allocated: 0.3810000419616699  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057297468185424805 |0.12142074108123779 |0.18598002195358276 |0.00011348724365234375 |0.024772167205810547 |0.0025665760040283203 |
----------------------------------------------------------pseudo_mini_loss sum 5.106660842895508
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351033
Number of first layer input nodes during this epoch:  666824
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.19750547409057617  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.027011871337890625
range selection method range initialization spend 0.011489152908325195
time for parepare:  0.017173051834106445
local_output_nid generation:  0.00524592399597168
local_in_edges_tensor generation:  0.0069043636322021484
mini_batch_src_global generation:  0.006600141525268555
r_  generation:  0.07975459098815918
local_output_nid generation:  0.0060422420501708984
local_in_edges_tensor generation:  0.0031328201293945312
mini_batch_src_global generation:  0.008420705795288086
r_  generation:  0.0848534107208252
local_output_nid generation:  0.00613856315612793
local_in_edges_tensor generation:  0.0030934810638427734
mini_batch_src_global generation:  0.006605625152587891
r_  generation:  0.09049153327941895
local_output_nid generation:  0.006119728088378906
local_in_edges_tensor generation:  0.0030617713928222656
mini_batch_src_global generation:  0.007140398025512695
r_  generation:  0.09376764297485352
----------------------check_connections_block total spend ----------------------------- 0.5049376487731934
generate_one_block  0.10122013092041016
generate_one_block  0.1000676155090332
generate_one_block  0.1026308536529541
generate_one_block  0.10372447967529297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.040987253189086914
gen group dst list time:  0.011026859283447266
time for parepare:  0.01918935775756836
local_output_nid generation:  0.014356613159179688
local_in_edges_tensor generation:  0.03934884071350098
mini_batch_src_global generation:  0.04163765907287598
r_  generation:  0.40173864364624023
local_output_nid generation:  0.021265268325805664
local_in_edges_tensor generation:  0.03723573684692383
mini_batch_src_global generation:  0.04891371726989746
r_  generation:  0.41620898246765137
local_output_nid generation:  0.02178955078125
local_in_edges_tensor generation:  0.035265207290649414
mini_batch_src_global generation:  0.0486147403717041
r_  generation:  0.42690300941467285
local_output_nid generation:  0.02277350425720215
local_in_edges_tensor generation:  0.032225847244262695
mini_batch_src_global generation:  0.049922943115234375
r_  generation:  0.4315028190612793
----------------------check_connections_block total spend ----------------------------- 2.4757742881774902
generate_one_block  0.5562582015991211
generate_one_block  0.5467424392700195
generate_one_block  0.5728387832641602
generate_one_block  0.5550975799560547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03688168525695801
gen group dst list time:  0.020763635635375977
time for parepare:  0.018795013427734375
local_output_nid generation:  0.02378225326538086
local_in_edges_tensor generation:  0.045200347900390625
mini_batch_src_global generation:  0.05050921440124512
r_  generation:  0.5585601329803467
local_output_nid generation:  0.03811240196228027
local_in_edges_tensor generation:  0.06055498123168945
mini_batch_src_global generation:  0.0720212459564209
r_  generation:  0.5450990200042725
local_output_nid generation:  0.03713583946228027
local_in_edges_tensor generation:  0.047297000885009766
mini_batch_src_global generation:  0.05737709999084473
r_  generation:  0.5485553741455078
local_output_nid generation:  0.034984588623046875
local_in_edges_tensor generation:  0.05507159233093262
mini_batch_src_global generation:  0.05711627006530762
r_  generation:  0.5595724582672119
----------------------check_connections_block total spend ----------------------------- 3.3030340671539307
generate_one_block  0.6964900493621826
generate_one_block  0.6834626197814941
generate_one_block  0.6955969333648682
generate_one_block  0.6924631595611572
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08295035362243652
gen group dst list time:  0.03005671501159668
time for parepare:  0.01870441436767578
local_output_nid generation:  0.02772998809814453
local_in_edges_tensor generation:  0.055258989334106445
mini_batch_src_global generation:  0.04681539535522461
r_  generation:  0.5046336650848389
local_output_nid generation:  0.03506135940551758
local_in_edges_tensor generation:  0.039214134216308594
mini_batch_src_global generation:  0.05875062942504883
r_  generation:  0.5156548023223877
local_output_nid generation:  0.03597307205200195
local_in_edges_tensor generation:  0.04669308662414551
mini_batch_src_global generation:  0.05849289894104004
r_  generation:  0.5166590213775635
local_output_nid generation:  0.03569841384887695
local_in_edges_tensor generation:  0.03758978843688965
mini_batch_src_global generation:  0.05841326713562012
r_  generation:  0.5257582664489746
----------------------check_connections_block total spend ----------------------------- 3.081801176071167
generate_one_block  0.6344661712646484
generate_one_block  0.6341757774353027
generate_one_block  0.6351585388183594
generate_one_block  0.6454308032989502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.19750547409057617  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

connection checking time:  8.860609531402588
block generation total time  7.548181056976318
average batch blocks generation time:  1.8870452642440796
block dataloader generation time/epoch 18.490873336791992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.12123346328735352  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

torch.Size([166576, 128])
torch.Size([164670, 32])
torch.Size([154858, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.3603086471557617  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12126970291137695  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

torch.Size([166725, 128])
torch.Size([164875, 32])
torch.Size([155210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.36034393310546875  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12133216857910156  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

torch.Size([166712, 128])
torch.Size([164815, 32])
torch.Size([155216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.36067962646484375  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.12125205993652344  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

torch.Size([166694, 128])
torch.Size([164733, 32])
torch.Size([155025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.3607301712036133  GigaBytes
Max Memory Allocated: 0.38126277923583984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0560954213142395 |0.028821825981140137 |0.00506746768951416 |9.846687316894531e-05 |0.005931198596954346 |0.0037407875061035156 |
----------------------------------------------------------pseudo_mini_loss sum 4.511002540588379
Total (block generation + training)time/epoch 18.91143822669983
Training time/epoch 0.4203372001647949
Training time without block to device /epoch 0.3050498962402344
Training time without total dataloading part /epoch 0.04812932014465332
load block tensor time/epoch 0.224381685256958
block to device time/epoch 0.11528730392456055
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2351919
Number of first layer input nodes during this epoch:  666707
