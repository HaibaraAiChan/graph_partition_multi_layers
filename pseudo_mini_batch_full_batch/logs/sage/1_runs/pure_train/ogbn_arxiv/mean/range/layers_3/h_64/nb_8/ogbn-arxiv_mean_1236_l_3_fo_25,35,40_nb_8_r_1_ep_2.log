Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648447504.7370331
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024277210235595703
range selection method range initialization spend 0.013313531875610352
time for parepare:  0.017859935760498047
local_output_nid generation:  0.00262451171875
local_in_edges_tensor generation:  0.004540920257568359
mini_batch_src_global generation:  0.0033326148986816406
r_  generation:  0.03680276870727539
local_output_nid generation:  0.002981901168823242
local_in_edges_tensor generation:  0.0016851425170898438
mini_batch_src_global generation:  0.003979921340942383
r_  generation:  0.037012577056884766
local_output_nid generation:  0.003137350082397461
local_in_edges_tensor generation:  0.0015990734100341797
mini_batch_src_global generation:  0.0026328563690185547
r_  generation:  0.3434016704559326
local_output_nid generation:  0.0031414031982421875
local_in_edges_tensor generation:  0.0017018318176269531
mini_batch_src_global generation:  0.002764463424682617
r_  generation:  0.039171695709228516
local_output_nid generation:  0.003148317337036133
local_in_edges_tensor generation:  0.0017042160034179688
mini_batch_src_global generation:  0.002887248992919922
r_  generation:  0.040769338607788086
local_output_nid generation:  0.0031163692474365234
local_in_edges_tensor generation:  0.0016236305236816406
mini_batch_src_global generation:  0.003036975860595703
r_  generation:  0.03983497619628906
local_output_nid generation:  0.0033216476440429688
local_in_edges_tensor generation:  0.0016634464263916016
mini_batch_src_global generation:  0.003054380416870117
r_  generation:  0.04065132141113281
local_output_nid generation:  0.0031464099884033203
local_in_edges_tensor generation:  0.0016913414001464844
mini_batch_src_global generation:  0.0032083988189697266
r_  generation:  0.04035830497741699
----------------------check_connections_block total spend ----------------------------- 0.7677788734436035
generate_one_block  0.055143117904663086
generate_one_block  0.053984642028808594
generate_one_block  0.055411577224731445
generate_one_block  0.05495452880859375
generate_one_block  0.05769085884094238
generate_one_block  0.0543828010559082
generate_one_block  0.054261207580566406
generate_one_block  0.0541384220123291
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04172086715698242
gen group dst list time:  0.014943361282348633
time for parepare:  0.018743038177490234
local_output_nid generation:  0.010533809661865234
local_in_edges_tensor generation:  0.030328750610351562
mini_batch_src_global generation:  0.026915550231933594
r_  generation:  0.28789258003234863
local_output_nid generation:  0.015401363372802734
local_in_edges_tensor generation:  0.026613712310791016
mini_batch_src_global generation:  0.03496861457824707
r_  generation:  0.29087209701538086
local_output_nid generation:  0.01563096046447754
local_in_edges_tensor generation:  0.020122528076171875
mini_batch_src_global generation:  0.03658437728881836
r_  generation:  0.29751014709472656
local_output_nid generation:  0.01616191864013672
local_in_edges_tensor generation:  0.022942543029785156
mini_batch_src_global generation:  0.03604745864868164
r_  generation:  0.30405092239379883
local_output_nid generation:  0.016440391540527344
local_in_edges_tensor generation:  0.023020267486572266
mini_batch_src_global generation:  0.03700828552246094
r_  generation:  0.3069314956665039
local_output_nid generation:  0.01647329330444336
local_in_edges_tensor generation:  0.01838994026184082
mini_batch_src_global generation:  0.03717994689941406
r_  generation:  0.31324195861816406
local_output_nid generation:  0.01661086082458496
local_in_edges_tensor generation:  0.02143096923828125
mini_batch_src_global generation:  0.039064884185791016
r_  generation:  0.3076493740081787
local_output_nid generation:  0.01625800132751465
local_in_edges_tensor generation:  0.018193483352661133
mini_batch_src_global generation:  0.03688478469848633
r_  generation:  0.3050119876861572
----------------------check_connections_block total spend ----------------------------- 3.546210765838623
generate_one_block  0.3952009677886963
generate_one_block  0.384458065032959
generate_one_block  0.3931400775909424
generate_one_block  0.39780712127685547
generate_one_block  0.4012470245361328
generate_one_block  0.3972635269165039
generate_one_block  0.3898346424102783
generate_one_block  0.3884572982788086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03723907470703125
gen group dst list time:  0.03552103042602539
time for parepare:  0.018862485885620117
local_output_nid generation:  0.02600407600402832
local_in_edges_tensor generation:  0.04059553146362305
mini_batch_src_global generation:  0.04746198654174805
r_  generation:  0.4727165699005127
local_output_nid generation:  0.031160593032836914
local_in_edges_tensor generation:  0.0496366024017334
mini_batch_src_global generation:  0.05360150337219238
r_  generation:  0.4743916988372803
local_output_nid generation:  0.032385826110839844
local_in_edges_tensor generation:  0.03757452964782715
mini_batch_src_global generation:  0.054280996322631836
r_  generation:  0.4891517162322998
local_output_nid generation:  0.032106637954711914
local_in_edges_tensor generation:  0.03837108612060547
mini_batch_src_global generation:  0.05394148826599121
r_  generation:  0.4872920513153076
local_output_nid generation:  0.03287553787231445
local_in_edges_tensor generation:  0.03757619857788086
mini_batch_src_global generation:  0.05594992637634277
r_  generation:  0.4965372085571289
local_output_nid generation:  0.0329432487487793
local_in_edges_tensor generation:  0.038385868072509766
mini_batch_src_global generation:  0.05439114570617676
r_  generation:  0.4842255115509033
local_output_nid generation:  0.03309965133666992
local_in_edges_tensor generation:  0.037772417068481445
mini_batch_src_global generation:  0.056715965270996094
r_  generation:  0.5002310276031494
local_output_nid generation:  0.03301119804382324
local_in_edges_tensor generation:  0.0376889705657959
mini_batch_src_global generation:  0.05442357063293457
r_  generation:  0.4839167594909668
----------------------check_connections_block total spend ----------------------------- 5.761957883834839
generate_one_block  0.621884822845459
generate_one_block  0.617755651473999
generate_one_block  0.6153440475463867
generate_one_block  0.6213421821594238
generate_one_block  0.61859130859375
generate_one_block  0.6158781051635742
generate_one_block  0.6421658992767334
generate_one_block  0.6038050651550293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  9.308168649673462
block generation total time  8.104175806045532
average batch blocks generation time:  1.0130219757556915
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09576654434204102  GigaBytes
Max Memory Allocated: 0.09576654434204102  GigaBytes

torch.Size([160467, 128])
torch.Size([141307, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6385498046875 GB
    Memory Allocated: 0.3000326156616211  GigaBytes
Max Memory Allocated: 0.31191539764404297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.0988302230834961  GigaBytes
Max Memory Allocated: 0.331972599029541  GigaBytes

torch.Size([160600, 128])
torch.Size([141084, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.2972540855407715  GigaBytes
Max Memory Allocated: 0.331972599029541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.09802818298339844  GigaBytes
Max Memory Allocated: 0.331972599029541  GigaBytes

torch.Size([160337, 128])
torch.Size([141267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.29979658126831055  GigaBytes
Max Memory Allocated: 0.331972599029541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0982356071472168  GigaBytes
Max Memory Allocated: 0.331972599029541  GigaBytes

torch.Size([160335, 128])
torch.Size([141022, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3003659248352051  GigaBytes
Max Memory Allocated: 0.331972599029541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09849166870117188  GigaBytes
Max Memory Allocated: 0.33208465576171875  GigaBytes

torch.Size([160416, 128])
torch.Size([141254, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3016071319580078  GigaBytes
Max Memory Allocated: 0.33208465576171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09841012954711914  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160425, 128])
torch.Size([141130, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29880571365356445  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09850168228149414  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160521, 128])
torch.Size([141443, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.30097436904907227  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09829187393188477  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160285, 128])
torch.Size([140775, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29706859588623047  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032919108867645264 |0.04581862688064575 |0.09416884183883667 |0.00011530518531799316 |0.009045273065567017 |0.004277467727661133 |
----------------------------------------------------------pseudo_mini_loss sum 5.294605255126953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2955536
Number of first layer input nodes during this epoch:  1283386
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.13772964477539062  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026793956756591797
range selection method range initialization spend 0.011254310607910156
time for parepare:  0.016400814056396484
local_output_nid generation:  0.002619504928588867
local_in_edges_tensor generation:  0.004036664962768555
mini_batch_src_global generation:  0.003147125244140625
r_  generation:  0.04001498222351074
local_output_nid generation:  0.003005504608154297
local_in_edges_tensor generation:  0.0016791820526123047
mini_batch_src_global generation:  0.004103660583496094
r_  generation:  0.03881716728210449
local_output_nid generation:  0.003028392791748047
local_in_edges_tensor generation:  0.001718759536743164
mini_batch_src_global generation:  0.0027985572814941406
r_  generation:  0.03951764106750488
local_output_nid generation:  0.0030891895294189453
local_in_edges_tensor generation:  0.0016696453094482422
mini_batch_src_global generation:  0.002918243408203125
r_  generation:  0.04113125801086426
local_output_nid generation:  0.003073453903198242
local_in_edges_tensor generation:  0.001737833023071289
mini_batch_src_global generation:  0.002977609634399414
r_  generation:  0.04429793357849121
local_output_nid generation:  0.0031118392944335938
local_in_edges_tensor generation:  0.0017533302307128906
mini_batch_src_global generation:  0.0032491683959960938
r_  generation:  0.04242730140686035
local_output_nid generation:  0.0030815601348876953
local_in_edges_tensor generation:  0.001667022705078125
mini_batch_src_global generation:  0.0031511783599853516
r_  generation:  0.04219532012939453
local_output_nid generation:  0.0031282901763916016
local_in_edges_tensor generation:  0.001703023910522461
mini_batch_src_global generation:  0.010967016220092773
r_  generation:  0.04603171348571777
----------------------check_connections_block total spend ----------------------------- 0.4958515167236328
generate_one_block  0.05888199806213379
generate_one_block  0.05960392951965332
generate_one_block  0.05544710159301758
generate_one_block  0.0555727481842041
generate_one_block  0.05585789680480957
generate_one_block  0.0605616569519043
generate_one_block  0.0607607364654541
generate_one_block  0.05697226524353027
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06563806533813477
gen group dst list time:  0.015229463577270508
time for parepare:  0.022702455520629883
local_output_nid generation:  0.010558128356933594
local_in_edges_tensor generation:  0.046640634536743164
mini_batch_src_global generation:  0.03059554100036621
r_  generation:  0.2861964702606201
local_output_nid generation:  0.01592397689819336
local_in_edges_tensor generation:  0.028362035751342773
mini_batch_src_global generation:  0.03514361381530762
r_  generation:  0.3012118339538574
local_output_nid generation:  0.015945911407470703
local_in_edges_tensor generation:  0.018664121627807617
mini_batch_src_global generation:  0.03533124923706055
r_  generation:  0.3016998767852783
local_output_nid generation:  0.016200780868530273
local_in_edges_tensor generation:  0.02371668815612793
mini_batch_src_global generation:  0.03641009330749512
r_  generation:  0.3047351837158203
local_output_nid generation:  0.0166623592376709
local_in_edges_tensor generation:  0.024190902709960938
mini_batch_src_global generation:  0.0525968074798584
r_  generation:  0.3165466785430908
local_output_nid generation:  0.018503427505493164
local_in_edges_tensor generation:  0.023815631866455078
mini_batch_src_global generation:  0.04124021530151367
r_  generation:  0.3168494701385498
local_output_nid generation:  0.016731977462768555
local_in_edges_tensor generation:  0.01941514015197754
mini_batch_src_global generation:  0.03765368461608887
r_  generation:  0.3177144527435303
local_output_nid generation:  0.016729116439819336
local_in_edges_tensor generation:  0.01870560646057129
mini_batch_src_global generation:  0.04041647911071777
r_  generation:  0.3209056854248047
----------------------check_connections_block total spend ----------------------------- 3.6750593185424805
generate_one_block  0.4170958995819092
generate_one_block  0.4090297222137451
generate_one_block  0.433638334274292
generate_one_block  0.3990306854248047
generate_one_block  0.4030017852783203
generate_one_block  0.4188835620880127
generate_one_block  0.3972737789154053
generate_one_block  0.4174008369445801
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07141780853271484
gen group dst list time:  0.03701424598693848
time for parepare:  0.020240306854248047
local_output_nid generation:  0.02512502670288086
local_in_edges_tensor generation:  0.05533480644226074
mini_batch_src_global generation:  0.04848647117614746
r_  generation:  0.48388123512268066
local_output_nid generation:  0.03218817710876465
local_in_edges_tensor generation:  0.05231142044067383
mini_batch_src_global generation:  0.05705881118774414
r_  generation:  0.47893190383911133
local_output_nid generation:  0.033315181732177734
local_in_edges_tensor generation:  0.04541635513305664
mini_batch_src_global generation:  0.050557613372802734
r_  generation:  0.49010562896728516
local_output_nid generation:  0.033473968505859375
local_in_edges_tensor generation:  0.037305593490600586
mini_batch_src_global generation:  0.05711507797241211
r_  generation:  0.49117565155029297
local_output_nid generation:  0.03499341011047363
local_in_edges_tensor generation:  0.03990364074707031
mini_batch_src_global generation:  0.0529325008392334
r_  generation:  0.5027775764465332
local_output_nid generation:  0.034973859786987305
local_in_edges_tensor generation:  0.04915976524353027
mini_batch_src_global generation:  0.06722068786621094
r_  generation:  0.493760347366333
local_output_nid generation:  0.036740779876708984
local_in_edges_tensor generation:  0.04894232749938965
mini_batch_src_global generation:  0.05596113204956055
r_  generation:  0.4974353313446045
local_output_nid generation:  0.034734487533569336
local_in_edges_tensor generation:  0.035855770111083984
mini_batch_src_global generation:  0.05499768257141113
r_  generation:  0.48706746101379395
----------------------check_connections_block total spend ----------------------------- 5.872640132904053
generate_one_block  0.6134450435638428
generate_one_block  0.6235208511352539
generate_one_block  0.6346871852874756
generate_one_block  0.6187317371368408
generate_one_block  0.6095497608184814
generate_one_block  0.6107051372528076
generate_one_block  0.6006884574890137
generate_one_block  0.6068220138549805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.13772964477539062  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

connection checking time:  9.547699451446533
block generation total time  8.213504791259766
average batch blocks generation time:  1.0266880989074707
block dataloader generation time/epoch 19.771692752838135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09827232360839844  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160473, 128])
torch.Size([141089, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29833364486694336  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09836721420288086  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160388, 128])
torch.Size([141146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3006625175476074  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09842491149902344  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160702, 128])
torch.Size([141465, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2993783950805664  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09828472137451172  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160517, 128])
torch.Size([141158, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29979944229125977  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0984201431274414  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160505, 128])
torch.Size([141279, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2992587089538574  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09836101531982422  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160479, 128])
torch.Size([141085, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3002047538757324  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09767961502075195  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160442, 128])
torch.Size([140900, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.29937124252319336  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.09860038757324219  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

torch.Size([160715, 128])
torch.Size([141305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.2999110221862793  GigaBytes
Max Memory Allocated: 0.3336973190307617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04027274250984192 |0.01456606388092041 |0.003936141729354858 |9.325146675109863e-05 |0.00936397910118103 |0.0028810501098632812 |
----------------------------------------------------------pseudo_mini_loss sum 4.072421550750732
Total (block generation + training)time/epoch 20.330799341201782
Training time/epoch 0.558905839920044
Training time without block to device /epoch 0.44237732887268066
Training time without total dataloading part /epoch 0.11002802848815918
load block tensor time/epoch 0.32218194007873535
block to device time/epoch 0.11652851104736328
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2957256
Number of first layer input nodes during this epoch:  1284221
