Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648498458.5886366
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02374100685119629
range selection method range initialization spend 0.013840436935424805
time for parepare:  0.017847537994384766
local_output_nid generation:  0.0013356208801269531
local_in_edges_tensor generation:  0.003233671188354492
mini_batch_src_global generation:  0.0017292499542236328
r_  generation:  0.018840789794921875
local_output_nid generation:  0.0016200542449951172
local_in_edges_tensor generation:  0.0009491443634033203
mini_batch_src_global generation:  0.0021407604217529297
r_  generation:  0.018344402313232422
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0013766288757324219
r_  generation:  0.018631935119628906
local_output_nid generation:  0.0015285015106201172
local_in_edges_tensor generation:  0.0008683204650878906
mini_batch_src_global generation:  0.0013599395751953125
r_  generation:  0.018530845642089844
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0013208389282226562
r_  generation:  0.018383264541625977
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.0014247894287109375
r_  generation:  0.018976688385009766
local_output_nid generation:  0.0015113353729248047
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0014505386352539062
r_  generation:  0.020474672317504883
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.0008320808410644531
mini_batch_src_global generation:  0.0017347335815429688
r_  generation:  0.021272659301757812
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.0008141994476318359
mini_batch_src_global generation:  0.0016794204711914062
r_  generation:  0.019047260284423828
local_output_nid generation:  0.001528024673461914
local_in_edges_tensor generation:  0.0008485317230224609
mini_batch_src_global generation:  0.0014824867248535156
r_  generation:  0.019588470458984375
local_output_nid generation:  0.0015058517456054688
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.0014698505401611328
r_  generation:  0.019522666931152344
local_output_nid generation:  0.0015211105346679688
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0014410018920898438
r_  generation:  0.018941402435302734
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.01980447769165039
local_output_nid generation:  0.0015366077423095703
local_in_edges_tensor generation:  0.0008296966552734375
mini_batch_src_global generation:  0.0014662742614746094
r_  generation:  0.018720388412475586
local_output_nid generation:  0.0015339851379394531
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.0014705657958984375
r_  generation:  0.019062519073486328
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.0014834403991699219
r_  generation:  0.01938033103942871
----------------------check_connections_block total spend ----------------------------- 0.46001625061035156
generate_one_block  0.026760578155517578
generate_one_block  0.028244495391845703
generate_one_block  0.02789592742919922
generate_one_block  0.029320716857910156
generate_one_block  0.027788162231445312
generate_one_block  0.027609825134277344
generate_one_block  0.02826976776123047
generate_one_block  0.02754378318786621
generate_one_block  0.027119874954223633
generate_one_block  0.028317689895629883
generate_one_block  0.027533769607543945
generate_one_block  0.027103424072265625
generate_one_block  0.02790093421936035
generate_one_block  0.0274045467376709
generate_one_block  0.027367591857910156
generate_one_block  0.02762913703918457
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03815197944641113
gen group dst list time:  0.018764257431030273
time for parepare:  0.018985271453857422
local_output_nid generation:  0.0065839290618896484
local_in_edges_tensor generation:  0.0147247314453125
mini_batch_src_global generation:  0.019850969314575195
r_  generation:  0.19707798957824707
local_output_nid generation:  0.010471820831298828
local_in_edges_tensor generation:  0.0180051326751709
mini_batch_src_global generation:  0.024821043014526367
r_  generation:  0.2048628330230713
local_output_nid generation:  0.014862298965454102
local_in_edges_tensor generation:  0.01679372787475586
mini_batch_src_global generation:  0.025422334671020508
r_  generation:  0.23401880264282227
local_output_nid generation:  0.012573003768920898
local_in_edges_tensor generation:  0.02218914031982422
mini_batch_src_global generation:  0.02774643898010254
r_  generation:  0.21656394004821777
local_output_nid generation:  0.01109766960144043
local_in_edges_tensor generation:  0.012745857238769531
mini_batch_src_global generation:  0.02647542953491211
r_  generation:  0.2138841152191162
local_output_nid generation:  0.011358499526977539
local_in_edges_tensor generation:  0.012660980224609375
mini_batch_src_global generation:  0.0283663272857666
r_  generation:  0.21747636795043945
local_output_nid generation:  0.011482954025268555
local_in_edges_tensor generation:  0.0171968936920166
mini_batch_src_global generation:  0.027505874633789062
r_  generation:  0.22348380088806152
local_output_nid generation:  0.011422157287597656
local_in_edges_tensor generation:  0.015128374099731445
mini_batch_src_global generation:  0.027103662490844727
r_  generation:  0.21696758270263672
local_output_nid generation:  0.011251211166381836
local_in_edges_tensor generation:  0.011576414108276367
mini_batch_src_global generation:  0.02678513526916504
r_  generation:  0.2131357192993164
local_output_nid generation:  0.011665105819702148
local_in_edges_tensor generation:  0.013263225555419922
mini_batch_src_global generation:  0.027540206909179688
r_  generation:  0.2239534854888916
local_output_nid generation:  0.011621475219726562
local_in_edges_tensor generation:  0.013694286346435547
mini_batch_src_global generation:  0.02760910987854004
r_  generation:  0.2232060432434082
local_output_nid generation:  0.01144266128540039
local_in_edges_tensor generation:  0.013097763061523438
mini_batch_src_global generation:  0.027329444885253906
r_  generation:  0.22139525413513184
local_output_nid generation:  0.011785030364990234
local_in_edges_tensor generation:  0.013372421264648438
mini_batch_src_global generation:  0.02928447723388672
r_  generation:  0.2303297519683838
local_output_nid generation:  0.012221813201904297
local_in_edges_tensor generation:  0.01665949821472168
mini_batch_src_global generation:  0.02736973762512207
r_  generation:  0.2252805233001709
local_output_nid generation:  0.01266932487487793
local_in_edges_tensor generation:  0.017182588577270508
mini_batch_src_global generation:  0.028693675994873047
r_  generation:  0.22177958488464355
local_output_nid generation:  0.012759923934936523
local_in_edges_tensor generation:  0.0167238712310791
mini_batch_src_global generation:  0.027856826782226562
r_  generation:  0.23488140106201172
----------------------check_connections_block total spend ----------------------------- 5.179316520690918
generate_one_block  0.28998279571533203
generate_one_block  0.2866175174713135
generate_one_block  0.28455376625061035
generate_one_block  0.2823934555053711
generate_one_block  0.3020813465118408
generate_one_block  0.28017544746398926
generate_one_block  0.2849555015563965
generate_one_block  0.28066182136535645
generate_one_block  0.27263951301574707
generate_one_block  0.28324437141418457
generate_one_block  0.2828381061553955
generate_one_block  0.2754848003387451
generate_one_block  0.2882556915283203
generate_one_block  0.2723672389984131
generate_one_block  0.30454421043395996
generate_one_block  0.2825143337249756
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04250001907348633
gen group dst list time:  0.06148028373718262
time for parepare:  0.019315242767333984
local_output_nid generation:  0.026310443878173828
local_in_edges_tensor generation:  0.0654611587524414
mini_batch_src_global generation:  0.0503692626953125
r_  generation:  0.5138366222381592
local_output_nid generation:  0.03181052207946777
local_in_edges_tensor generation:  0.06180405616760254
mini_batch_src_global generation:  0.061283111572265625
r_  generation:  0.49391651153564453
local_output_nid generation:  0.031206846237182617
local_in_edges_tensor generation:  0.04520559310913086
mini_batch_src_global generation:  0.05693697929382324
r_  generation:  0.5023884773254395
local_output_nid generation:  0.031079530715942383
local_in_edges_tensor generation:  0.03396320343017578
mini_batch_src_global generation:  0.061926841735839844
r_  generation:  0.5049765110015869
local_output_nid generation:  0.030771493911743164
local_in_edges_tensor generation:  0.03390169143676758
mini_batch_src_global generation:  0.05795860290527344
r_  generation:  0.5019493103027344
local_output_nid generation:  0.03079390525817871
local_in_edges_tensor generation:  0.03391432762145996
mini_batch_src_global generation:  0.05952167510986328
r_  generation:  0.5015959739685059
local_output_nid generation:  0.031031131744384766
local_in_edges_tensor generation:  0.038800716400146484
mini_batch_src_global generation:  0.05782914161682129
r_  generation:  0.5125806331634521
local_output_nid generation:  0.03148078918457031
local_in_edges_tensor generation:  0.033653974533081055
mini_batch_src_global generation:  0.05928444862365723
r_  generation:  0.5056571960449219
local_output_nid generation:  0.031278133392333984
local_in_edges_tensor generation:  0.029720067977905273
mini_batch_src_global generation:  0.05954694747924805
r_  generation:  0.5072286128997803
local_output_nid generation:  0.03149271011352539
local_in_edges_tensor generation:  0.030261516571044922
mini_batch_src_global generation:  0.0628209114074707
r_  generation:  0.5115864276885986
local_output_nid generation:  0.031961917877197266
local_in_edges_tensor generation:  0.03976559638977051
mini_batch_src_global generation:  0.06002020835876465
r_  generation:  0.5288634300231934
local_output_nid generation:  0.03172016143798828
local_in_edges_tensor generation:  0.04747462272644043
mini_batch_src_global generation:  0.06447482109069824
r_  generation:  0.508044958114624
local_output_nid generation:  0.03383350372314453
local_in_edges_tensor generation:  0.04284071922302246
mini_batch_src_global generation:  0.05937933921813965
r_  generation:  0.517937183380127
local_output_nid generation:  0.03136754035949707
local_in_edges_tensor generation:  0.032872676849365234
mini_batch_src_global generation:  0.060300350189208984
r_  generation:  0.5096662044525146
local_output_nid generation:  0.03161215782165527
local_in_edges_tensor generation:  0.02974677085876465
mini_batch_src_global generation:  0.0620884895324707
r_  generation:  0.5095548629760742
local_output_nid generation:  0.03192424774169922
local_in_edges_tensor generation:  0.034175872802734375
mini_batch_src_global generation:  0.05997872352600098
r_  generation:  0.5126848220825195
----------------------check_connections_block total spend ----------------------------- 11.9570791721344
generate_one_block  0.6484696865081787
generate_one_block  0.6584644317626953
generate_one_block  0.6474401950836182
generate_one_block  0.6829044818878174
generate_one_block  0.6519429683685303
generate_one_block  0.6514196395874023
generate_one_block  0.7042770385742188
generate_one_block  0.652686595916748
generate_one_block  0.6356048583984375
generate_one_block  0.6676516532897949
generate_one_block  0.6417407989501953
generate_one_block  0.6619994640350342
generate_one_block  0.6605875492095947
generate_one_block  0.6512088775634766
generate_one_block  0.6556901931762695
generate_one_block  0.6551864147186279
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.049925804138183594
gen group dst list time:  0.10004782676696777
time for parepare:  0.019489049911499023
local_output_nid generation:  0.032285213470458984
local_in_edges_tensor generation:  0.06598424911499023
mini_batch_src_global generation:  0.05286526679992676
r_  generation:  0.5268850326538086
local_output_nid generation:  0.03738117218017578
local_in_edges_tensor generation:  0.05438423156738281
mini_batch_src_global generation:  0.060900211334228516
r_  generation:  0.5313205718994141
local_output_nid generation:  0.03644514083862305
local_in_edges_tensor generation:  0.0408327579498291
mini_batch_src_global generation:  0.058562517166137695
r_  generation:  0.552628755569458
local_output_nid generation:  0.03672051429748535
local_in_edges_tensor generation:  0.04695844650268555
mini_batch_src_global generation:  0.05802202224731445
r_  generation:  0.5370693206787109
local_output_nid generation:  0.03672194480895996
local_in_edges_tensor generation:  0.04150056838989258
mini_batch_src_global generation:  0.05733227729797363
r_  generation:  0.5460593700408936
local_output_nid generation:  0.036936283111572266
local_in_edges_tensor generation:  0.0416111946105957
mini_batch_src_global generation:  0.062108516693115234
r_  generation:  0.5465052127838135
local_output_nid generation:  0.03695821762084961
local_in_edges_tensor generation:  0.041059017181396484
mini_batch_src_global generation:  0.06094479560852051
r_  generation:  0.5521204471588135
local_output_nid generation:  0.036958932876586914
local_in_edges_tensor generation:  0.0366976261138916
mini_batch_src_global generation:  0.05999112129211426
r_  generation:  0.5591363906860352
local_output_nid generation:  0.03872108459472656
local_in_edges_tensor generation:  0.040395259857177734
mini_batch_src_global generation:  0.06373977661132812
r_  generation:  0.5623767375946045
local_output_nid generation:  0.03795504570007324
local_in_edges_tensor generation:  0.04068422317504883
mini_batch_src_global generation:  0.06071758270263672
r_  generation:  0.5591332912445068
local_output_nid generation:  0.03801774978637695
local_in_edges_tensor generation:  0.03639388084411621
mini_batch_src_global generation:  0.06002449989318848
r_  generation:  0.5680255889892578
local_output_nid generation:  0.03772306442260742
local_in_edges_tensor generation:  0.05306649208068848
mini_batch_src_global generation:  0.0609130859375
r_  generation:  0.5589756965637207
local_output_nid generation:  0.037599802017211914
local_in_edges_tensor generation:  0.041448354721069336
mini_batch_src_global generation:  0.05990266799926758
r_  generation:  0.5716397762298584
local_output_nid generation:  0.038945913314819336
local_in_edges_tensor generation:  0.04890108108520508
mini_batch_src_global generation:  0.0692598819732666
r_  generation:  0.5600361824035645
local_output_nid generation:  0.03861045837402344
local_in_edges_tensor generation:  0.0486598014831543
mini_batch_src_global generation:  0.06082797050476074
r_  generation:  0.5660412311553955
local_output_nid generation:  0.03876900672912598
local_in_edges_tensor generation:  0.046785593032836914
mini_batch_src_global generation:  0.061042070388793945
r_  generation:  0.5636234283447266
----------------------check_connections_block total spend ----------------------------- 13.239951848983765
generate_one_block  0.6838059425354004
generate_one_block  0.6773021221160889
generate_one_block  0.7602384090423584
generate_one_block  0.6984350681304932
generate_one_block  0.6858720779418945
generate_one_block  0.6842336654663086
generate_one_block  0.6826050281524658
generate_one_block  0.6751737594604492
generate_one_block  0.6749727725982666
generate_one_block  0.6974961757659912
generate_one_block  0.6716585159301758
generate_one_block  0.6946194171905518
generate_one_block  0.6946148872375488
generate_one_block  0.670499324798584
generate_one_block  0.6938798427581787
generate_one_block  0.6879668235778809
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042293548583984375
gen group dst list time:  0.09853219985961914
time for parepare:  0.018895864486694336
local_output_nid generation:  0.034705162048339844
local_in_edges_tensor generation:  0.04490542411804199
mini_batch_src_global generation:  0.04522871971130371
r_  generation:  0.5026266574859619
local_output_nid generation:  0.04061460494995117
local_in_edges_tensor generation:  0.03349804878234863
mini_batch_src_global generation:  0.05757474899291992
r_  generation:  0.5074172019958496
local_output_nid generation:  0.03881978988647461
local_in_edges_tensor generation:  0.036820173263549805
mini_batch_src_global generation:  0.057892799377441406
r_  generation:  0.5082859992980957
local_output_nid generation:  0.0391082763671875
local_in_edges_tensor generation:  0.03658914566040039
mini_batch_src_global generation:  0.057312965393066406
r_  generation:  0.5108492374420166
local_output_nid generation:  0.03930807113647461
local_in_edges_tensor generation:  0.0351252555847168
mini_batch_src_global generation:  0.05743598937988281
r_  generation:  0.5210974216461182
local_output_nid generation:  0.039170026779174805
local_in_edges_tensor generation:  0.04292774200439453
mini_batch_src_global generation:  0.05790066719055176
r_  generation:  0.5146746635437012
local_output_nid generation:  0.039809465408325195
local_in_edges_tensor generation:  0.03536701202392578
mini_batch_src_global generation:  0.05766463279724121
r_  generation:  0.5170140266418457
local_output_nid generation:  0.03983163833618164
local_in_edges_tensor generation:  0.03493165969848633
mini_batch_src_global generation:  0.05715227127075195
r_  generation:  0.5187892913818359
local_output_nid generation:  0.0398256778717041
local_in_edges_tensor generation:  0.04171037673950195
mini_batch_src_global generation:  0.05774974822998047
r_  generation:  0.5153045654296875
local_output_nid generation:  0.0397796630859375
local_in_edges_tensor generation:  0.0482480525970459
mini_batch_src_global generation:  0.05746054649353027
r_  generation:  0.5161342620849609
local_output_nid generation:  0.03959226608276367
local_in_edges_tensor generation:  0.03523731231689453
mini_batch_src_global generation:  0.058001041412353516
r_  generation:  0.5177876949310303
local_output_nid generation:  0.039841413497924805
local_in_edges_tensor generation:  0.04364824295043945
mini_batch_src_global generation:  0.06262898445129395
r_  generation:  0.5197007656097412
local_output_nid generation:  0.03972053527832031
local_in_edges_tensor generation:  0.03746604919433594
mini_batch_src_global generation:  0.05738997459411621
r_  generation:  0.5178937911987305
local_output_nid generation:  0.03943228721618652
local_in_edges_tensor generation:  0.03868818283081055
mini_batch_src_global generation:  0.06055641174316406
r_  generation:  0.5171010494232178
local_output_nid generation:  0.03944253921508789
local_in_edges_tensor generation:  0.03891301155090332
mini_batch_src_global generation:  0.05695748329162598
r_  generation:  0.5284106731414795
local_output_nid generation:  0.039566755294799805
local_in_edges_tensor generation:  0.05027937889099121
mini_batch_src_global generation:  0.06090235710144043
r_  generation:  0.5177569389343262
----------------------check_connections_block total spend ----------------------------- 12.375255823135376
generate_one_block  0.6314926147460938
generate_one_block  0.6387372016906738
generate_one_block  0.6394851207733154
generate_one_block  0.6407654285430908
generate_one_block  0.7118136882781982
generate_one_block  0.6437520980834961
generate_one_block  0.651071310043335
generate_one_block  0.6253938674926758
generate_one_block  0.6932473182678223
generate_one_block  0.7080967426300049
generate_one_block  0.6403954029083252
generate_one_block  0.666959285736084
generate_one_block  0.6303987503051758
generate_one_block  0.6651341915130615
generate_one_block  0.6582486629486084
generate_one_block  0.6570408344268799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0005359649658203125  GigaBytes
Max Memory Allocated: 0.0005359649658203125  GigaBytes

connection checking time:  42.75160336494446
block generation total time  36.61599111557007
average batch blocks generation time:  2.2884994447231293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1221003532409668  GigaBytes
Max Memory Allocated: 0.1221003532409668  GigaBytes

torch.Size([166386, 128])
torch.Size([164153, 128])
torch.Size([156063, 128])
torch.Size([124118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5838623046875 GB
    Memory Allocated: 1.1545023918151855  GigaBytes
Max Memory Allocated: 1.1721711158752441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0682373046875 GB
    Memory Allocated: 0.12358283996582031  GigaBytes
Max Memory Allocated: 1.194277286529541  GigaBytes

torch.Size([166330, 128])
torch.Size([164015, 128])
torch.Size([155874, 128])
torch.Size([123890, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0682373046875 GB
    Memory Allocated: 1.1535015106201172  GigaBytes
Max Memory Allocated: 1.194277286529541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0682373046875 GB
    Memory Allocated: 0.1236867904663086  GigaBytes
Max Memory Allocated: 1.194277286529541  GigaBytes

torch.Size([166288, 128])
torch.Size([163996, 128])
torch.Size([155709, 128])
torch.Size([123553, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1528983116149902  GigaBytes
Max Memory Allocated: 1.194277286529541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12369918823242188  GigaBytes
Max Memory Allocated: 1.194277286529541  GigaBytes

torch.Size([166378, 128])
torch.Size([164120, 128])
torch.Size([156106, 128])
torch.Size([124599, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1560063362121582  GigaBytes
Max Memory Allocated: 1.194277286529541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12356376647949219  GigaBytes
Max Memory Allocated: 1.1954584121704102  GigaBytes

torch.Size([166236, 128])
torch.Size([163918, 128])
torch.Size([155864, 128])
torch.Size([123961, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1529932022094727  GigaBytes
Max Memory Allocated: 1.1954584121704102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12360954284667969  GigaBytes
Max Memory Allocated: 1.1954584121704102  GigaBytes

torch.Size([166268, 128])
torch.Size([163924, 128])
torch.Size([155818, 128])
torch.Size([123884, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1527304649353027  GigaBytes
Max Memory Allocated: 1.1954584121704102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12375831604003906  GigaBytes
Max Memory Allocated: 1.1954584121704102  GigaBytes

torch.Size([166361, 128])
torch.Size([164160, 128])
torch.Size([156001, 128])
torch.Size([124199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1562309265136719  GigaBytes
Max Memory Allocated: 1.1954584121704102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12362194061279297  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166275, 128])
torch.Size([163932, 128])
torch.Size([155664, 128])
torch.Size([124091, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1535096168518066  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12342166900634766  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166325, 128])
torch.Size([164001, 128])
torch.Size([155985, 128])
torch.Size([123445, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1513705253601074  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12372207641601562  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166306, 128])
torch.Size([164015, 128])
torch.Size([155879, 128])
torch.Size([123956, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1543784141540527  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12358856201171875  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166193, 128])
torch.Size([163736, 128])
torch.Size([155324, 128])
torch.Size([122877, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1479849815368652  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12356090545654297  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166343, 128])
torch.Size([164054, 128])
torch.Size([156140, 128])
torch.Size([124021, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1533489227294922  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12372684478759766  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166210, 128])
torch.Size([163871, 128])
torch.Size([155896, 128])
torch.Size([124155, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1550874710083008  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12337207794189453  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166243, 128])
torch.Size([163921, 128])
torch.Size([155556, 128])
torch.Size([122524, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1458039283752441  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12351799011230469  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166321, 128])
torch.Size([164072, 128])
torch.Size([156000, 128])
torch.Size([123591, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.152000904083252  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.1235971450805664  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166301, 128])
torch.Size([163969, 128])
torch.Size([155957, 128])
torch.Size([124219, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.1549630165100098  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07418122887611389 |0.057763129472732544 |0.04910685122013092 |0.00010101497173309326 |0.009859934449195862 |0.006324291229248047 |
----------------------------------------------------------pseudo_mini_loss sum 5.750367641448975
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10420753
Number of first layer input nodes during this epoch:  2660764
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.1999058723449707  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.018732309341430664
range selection method range initialization spend 0.011520147323608398
time for parepare:  0.015962839126586914
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.004134178161621094
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.018822669982910156
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0009415149688720703
mini_batch_src_global generation:  0.0017728805541992188
r_  generation:  0.01962900161743164
local_output_nid generation:  0.0014677047729492188
local_in_edges_tensor generation:  0.0008461475372314453
mini_batch_src_global generation:  0.0014383792877197266
r_  generation:  0.018848657608032227
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.0013899803161621094
r_  generation:  0.019467830657958984
local_output_nid generation:  0.0017266273498535156
local_in_edges_tensor generation:  0.001195669174194336
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.023586034774780273
local_output_nid generation:  0.0016460418701171875
local_in_edges_tensor generation:  0.0009329319000244141
mini_batch_src_global generation:  0.003325939178466797
r_  generation:  0.024248838424682617
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0010864734649658203
mini_batch_src_global generation:  0.0019960403442382812
r_  generation:  0.022052288055419922
local_output_nid generation:  0.0017132759094238281
local_in_edges_tensor generation:  0.0010576248168945312
mini_batch_src_global generation:  0.0018160343170166016
r_  generation:  0.021478652954101562
local_output_nid generation:  0.001695871353149414
local_in_edges_tensor generation:  0.0010523796081542969
mini_batch_src_global generation:  0.0018613338470458984
r_  generation:  0.022068500518798828
local_output_nid generation:  0.0016703605651855469
local_in_edges_tensor generation:  0.0023584365844726562
mini_batch_src_global generation:  0.0022428035736083984
r_  generation:  0.020096540451049805
local_output_nid generation:  0.0017361640930175781
local_in_edges_tensor generation:  0.0010330677032470703
mini_batch_src_global generation:  0.001524209976196289
r_  generation:  0.02709221839904785
local_output_nid generation:  0.003618955612182617
local_in_edges_tensor generation:  0.002201557159423828
mini_batch_src_global generation:  0.0033392906188964844
r_  generation:  0.021968603134155273
local_output_nid generation:  0.0017194747924804688
local_in_edges_tensor generation:  0.0010461807250976562
mini_batch_src_global generation:  0.0043904781341552734
r_  generation:  0.019529342651367188
local_output_nid generation:  0.0017230510711669922
local_in_edges_tensor generation:  0.0012080669403076172
mini_batch_src_global generation:  0.0015187263488769531
r_  generation:  0.02022695541381836
local_output_nid generation:  0.0017054080963134766
local_in_edges_tensor generation:  0.0010089874267578125
mini_batch_src_global generation:  0.001493692398071289
r_  generation:  0.019572019577026367
local_output_nid generation:  0.0017256736755371094
local_in_edges_tensor generation:  0.0009937286376953125
mini_batch_src_global generation:  0.0014731884002685547
r_  generation:  0.01996135711669922
----------------------check_connections_block total spend ----------------------------- 0.5457894802093506
generate_one_block  0.031855106353759766
generate_one_block  0.0284881591796875
generate_one_block  0.027906179428100586
generate_one_block  0.03071880340576172
generate_one_block  0.031354427337646484
generate_one_block  0.030443906784057617
generate_one_block  0.028124094009399414
generate_one_block  0.027302265167236328
generate_one_block  0.028293132781982422
generate_one_block  0.027775049209594727
generate_one_block  0.027921199798583984
generate_one_block  0.02784252166748047
generate_one_block  0.028023958206176758
generate_one_block  0.027626752853393555
generate_one_block  0.02746725082397461
generate_one_block  0.02741098403930664
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04423117637634277
gen group dst list time:  0.01603102684020996
time for parepare:  0.02211928367614746
local_output_nid generation:  0.006749868392944336
local_in_edges_tensor generation:  0.029856204986572266
mini_batch_src_global generation:  0.021179676055908203
r_  generation:  0.2015392780303955
local_output_nid generation:  0.01435399055480957
local_in_edges_tensor generation:  0.02168726921081543
mini_batch_src_global generation:  0.026311635971069336
r_  generation:  0.22325420379638672
local_output_nid generation:  0.01487874984741211
local_in_edges_tensor generation:  0.0168149471282959
mini_batch_src_global generation:  0.027220726013183594
r_  generation:  0.23070383071899414
local_output_nid generation:  0.014314889907836914
local_in_edges_tensor generation:  0.012125253677368164
mini_batch_src_global generation:  0.027855873107910156
r_  generation:  0.2269763946533203
local_output_nid generation:  0.013995170593261719
local_in_edges_tensor generation:  0.015695571899414062
mini_batch_src_global generation:  0.029107332229614258
r_  generation:  0.2329111099243164
local_output_nid generation:  0.014041900634765625
local_in_edges_tensor generation:  0.018222808837890625
mini_batch_src_global generation:  0.031145334243774414
r_  generation:  0.2407064437866211
local_output_nid generation:  0.014322280883789062
local_in_edges_tensor generation:  0.012295961380004883
mini_batch_src_global generation:  0.030766010284423828
r_  generation:  0.24050378799438477
local_output_nid generation:  0.016195058822631836
local_in_edges_tensor generation:  0.013701438903808594
mini_batch_src_global generation:  0.03016066551208496
r_  generation:  0.23607993125915527
local_output_nid generation:  0.014809370040893555
local_in_edges_tensor generation:  0.017577648162841797
mini_batch_src_global generation:  0.03099846839904785
r_  generation:  0.24843049049377441
local_output_nid generation:  0.014787912368774414
local_in_edges_tensor generation:  0.016167402267456055
mini_batch_src_global generation:  0.031101226806640625
r_  generation:  0.2380678653717041
local_output_nid generation:  0.014808177947998047
local_in_edges_tensor generation:  0.013307571411132812
mini_batch_src_global generation:  0.031094074249267578
r_  generation:  0.24138212203979492
local_output_nid generation:  0.014989376068115234
local_in_edges_tensor generation:  0.012560367584228516
mini_batch_src_global generation:  0.03092026710510254
r_  generation:  0.23463988304138184
local_output_nid generation:  0.014398336410522461
local_in_edges_tensor generation:  0.013707399368286133
mini_batch_src_global generation:  0.03726363182067871
r_  generation:  0.25734853744506836
local_output_nid generation:  0.015043020248413086
local_in_edges_tensor generation:  0.021892786026000977
mini_batch_src_global generation:  0.03457069396972656
r_  generation:  0.24181461334228516
local_output_nid generation:  0.011686563491821289
local_in_edges_tensor generation:  0.014889240264892578
mini_batch_src_global generation:  0.03128457069396973
r_  generation:  0.23600530624389648
local_output_nid generation:  0.011478662490844727
local_in_edges_tensor generation:  0.01410222053527832
mini_batch_src_global generation:  0.030776023864746094
r_  generation:  0.23088908195495605
----------------------check_connections_block total spend ----------------------------- 5.600342750549316
generate_one_block  0.2787482738494873
generate_one_block  0.2813894748687744
generate_one_block  0.2828333377838135
generate_one_block  0.28099584579467773
generate_one_block  0.2815432548522949
generate_one_block  0.30167055130004883
generate_one_block  0.3145434856414795
generate_one_block  0.2751290798187256
generate_one_block  0.28809499740600586
generate_one_block  0.28692173957824707
generate_one_block  0.2926595211029053
generate_one_block  0.2758033275604248
generate_one_block  0.2758021354675293
generate_one_block  0.2800917625427246
generate_one_block  0.2763669490814209
generate_one_block  0.27186131477355957
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04364371299743652
gen group dst list time:  0.0672295093536377
time for parepare:  0.0178067684173584
local_output_nid generation:  0.024860143661499023
local_in_edges_tensor generation:  0.05236983299255371
mini_batch_src_global generation:  0.049479007720947266
r_  generation:  0.4853031635284424
local_output_nid generation:  0.030237197875976562
local_in_edges_tensor generation:  0.048645734786987305
mini_batch_src_global generation:  0.06211447715759277
r_  generation:  0.5014753341674805
local_output_nid generation:  0.029753446578979492
local_in_edges_tensor generation:  0.04409933090209961
mini_batch_src_global generation:  0.05669140815734863
r_  generation:  0.5003290176391602
local_output_nid generation:  0.03014087677001953
local_in_edges_tensor generation:  0.030774831771850586
mini_batch_src_global generation:  0.0590052604675293
r_  generation:  0.5056846141815186
local_output_nid generation:  0.030388832092285156
local_in_edges_tensor generation:  0.07358837127685547
mini_batch_src_global generation:  0.05771327018737793
r_  generation:  0.51096510887146
local_output_nid generation:  0.03107166290283203
local_in_edges_tensor generation:  0.04320383071899414
mini_batch_src_global generation:  0.05976390838623047
r_  generation:  0.504349946975708
local_output_nid generation:  0.030823469161987305
local_in_edges_tensor generation:  0.040349721908569336
mini_batch_src_global generation:  0.05858588218688965
r_  generation:  0.5227820873260498
local_output_nid generation:  0.03228592872619629
local_in_edges_tensor generation:  0.03926992416381836
mini_batch_src_global generation:  0.07473492622375488
r_  generation:  0.504051923751831
local_output_nid generation:  0.032988548278808594
local_in_edges_tensor generation:  0.043057918548583984
mini_batch_src_global generation:  0.05855298042297363
r_  generation:  0.5083351135253906
local_output_nid generation:  0.03176093101501465
local_in_edges_tensor generation:  0.04002785682678223
mini_batch_src_global generation:  0.05951189994812012
r_  generation:  0.498915433883667
local_output_nid generation:  0.03189229965209961
local_in_edges_tensor generation:  0.030857086181640625
mini_batch_src_global generation:  0.05851459503173828
r_  generation:  0.5051727294921875
local_output_nid generation:  0.03197598457336426
local_in_edges_tensor generation:  0.03981900215148926
mini_batch_src_global generation:  0.06276655197143555
r_  generation:  0.49993419647216797
local_output_nid generation:  0.043985843658447266
local_in_edges_tensor generation:  0.04023551940917969
mini_batch_src_global generation:  0.058226585388183594
r_  generation:  0.5057511329650879
local_output_nid generation:  0.03203845024108887
local_in_edges_tensor generation:  0.03989577293395996
mini_batch_src_global generation:  0.06312131881713867
r_  generation:  0.5019457340240479
local_output_nid generation:  0.03191375732421875
local_in_edges_tensor generation:  0.03131699562072754
mini_batch_src_global generation:  0.06389498710632324
r_  generation:  0.5077455043792725
local_output_nid generation:  0.032001495361328125
local_in_edges_tensor generation:  0.030951499938964844
mini_batch_src_global generation:  0.06524801254272461
r_  generation:  0.5030434131622314
----------------------check_connections_block total spend ----------------------------- 11.938362121582031
generate_one_block  0.6678369045257568
generate_one_block  0.6697897911071777
generate_one_block  0.6614508628845215
generate_one_block  0.6442210674285889
generate_one_block  0.6469326019287109
generate_one_block  0.663130521774292
generate_one_block  0.6346595287322998
generate_one_block  0.6402854919433594
generate_one_block  0.7020077705383301
generate_one_block  0.6436769962310791
generate_one_block  0.6426029205322266
generate_one_block  0.6518247127532959
generate_one_block  0.6623241901397705
generate_one_block  0.6566276550292969
generate_one_block  0.6389362812042236
generate_one_block  0.6322469711303711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03571057319641113
gen group dst list time:  0.09670758247375488
time for parepare:  0.018980026245117188
local_output_nid generation:  0.03208303451538086
local_in_edges_tensor generation:  0.05230712890625
mini_batch_src_global generation:  0.05244088172912598
r_  generation:  0.5238769054412842
local_output_nid generation:  0.03920912742614746
local_in_edges_tensor generation:  0.05274319648742676
mini_batch_src_global generation:  0.06075143814086914
r_  generation:  0.5294666290283203
local_output_nid generation:  0.039269447326660156
local_in_edges_tensor generation:  0.04406404495239258
mini_batch_src_global generation:  0.0577387809753418
r_  generation:  0.5423891544342041
local_output_nid generation:  0.03968644142150879
local_in_edges_tensor generation:  0.03455781936645508
mini_batch_src_global generation:  0.058106184005737305
r_  generation:  0.5405395030975342
local_output_nid generation:  0.03719663619995117
local_in_edges_tensor generation:  0.03881692886352539
mini_batch_src_global generation:  0.05795168876647949
r_  generation:  0.5616283416748047
local_output_nid generation:  0.03744244575500488
local_in_edges_tensor generation:  0.04466056823730469
mini_batch_src_global generation:  0.06161141395568848
r_  generation:  0.546109676361084
local_output_nid generation:  0.03726673126220703
local_in_edges_tensor generation:  0.03917694091796875
mini_batch_src_global generation:  0.06247830390930176
r_  generation:  0.5549683570861816
local_output_nid generation:  0.037656307220458984
local_in_edges_tensor generation:  0.036542415618896484
mini_batch_src_global generation:  0.05941057205200195
r_  generation:  0.5503180027008057
local_output_nid generation:  0.037572622299194336
local_in_edges_tensor generation:  0.03917121887207031
mini_batch_src_global generation:  0.05992889404296875
r_  generation:  0.5565750598907471
local_output_nid generation:  0.038767337799072266
local_in_edges_tensor generation:  0.03840041160583496
mini_batch_src_global generation:  0.05965709686279297
r_  generation:  0.5584015846252441
local_output_nid generation:  0.038118839263916016
local_in_edges_tensor generation:  0.04444289207458496
mini_batch_src_global generation:  0.05970287322998047
r_  generation:  0.5606484413146973
local_output_nid generation:  0.03815865516662598
local_in_edges_tensor generation:  0.039339542388916016
mini_batch_src_global generation:  0.060359954833984375
r_  generation:  0.5569148063659668
local_output_nid generation:  0.03809952735900879
local_in_edges_tensor generation:  0.034865379333496094
mini_batch_src_global generation:  0.05997967720031738
r_  generation:  0.5610768795013428
local_output_nid generation:  0.038031816482543945
local_in_edges_tensor generation:  0.03525686264038086
mini_batch_src_global generation:  0.06066441535949707
r_  generation:  0.5545108318328857
local_output_nid generation:  0.03777813911437988
local_in_edges_tensor generation:  0.034515380859375
mini_batch_src_global generation:  0.05978274345397949
r_  generation:  0.563096284866333
local_output_nid generation:  0.03804969787597656
local_in_edges_tensor generation:  0.0419468879699707
mini_batch_src_global generation:  0.061220645904541016
r_  generation:  0.5586569309234619
----------------------check_connections_block total spend ----------------------------- 13.101664543151855
generate_one_block  0.6861631870269775
generate_one_block  0.6930139064788818
generate_one_block  0.6887266635894775
generate_one_block  0.666297197341919
generate_one_block  0.6788806915283203
generate_one_block  0.6931571960449219
generate_one_block  0.7736907005310059
generate_one_block  0.671065092086792
generate_one_block  0.682816743850708
generate_one_block  0.6751856803894043
generate_one_block  0.6845920085906982
generate_one_block  0.6926848888397217
generate_one_block  0.6723191738128662
generate_one_block  0.667027473449707
generate_one_block  0.6692609786987305
generate_one_block  0.6700959205627441
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029332399368286133
gen group dst list time:  0.09163546562194824
time for parepare:  0.01955127716064453
local_output_nid generation:  0.034150123596191406
local_in_edges_tensor generation:  0.0438380241394043
mini_batch_src_global generation:  0.04382491111755371
r_  generation:  0.5169389247894287
local_output_nid generation:  0.04066824913024902
local_in_edges_tensor generation:  0.036257028579711914
mini_batch_src_global generation:  0.0578463077545166
r_  generation:  0.502220869064331
local_output_nid generation:  0.03916645050048828
local_in_edges_tensor generation:  0.040746212005615234
mini_batch_src_global generation:  0.057682037353515625
r_  generation:  0.5086336135864258
local_output_nid generation:  0.03978133201599121
local_in_edges_tensor generation:  0.038265228271484375
mini_batch_src_global generation:  0.058423757553100586
r_  generation:  0.5048809051513672
local_output_nid generation:  0.04013419151306152
local_in_edges_tensor generation:  0.04300427436828613
mini_batch_src_global generation:  0.05695343017578125
r_  generation:  0.5124015808105469
local_output_nid generation:  0.03989434242248535
local_in_edges_tensor generation:  0.03851461410522461
mini_batch_src_global generation:  0.05710554122924805
r_  generation:  0.5096993446350098
local_output_nid generation:  0.03998279571533203
local_in_edges_tensor generation:  0.03836369514465332
mini_batch_src_global generation:  0.05676770210266113
r_  generation:  0.514507532119751
local_output_nid generation:  0.04015469551086426
local_in_edges_tensor generation:  0.043511152267456055
mini_batch_src_global generation:  0.05727648735046387
r_  generation:  0.513596773147583
local_output_nid generation:  0.04138517379760742
local_in_edges_tensor generation:  0.03439188003540039
mini_batch_src_global generation:  0.05640053749084473
r_  generation:  0.5115625858306885
local_output_nid generation:  0.040615081787109375
local_in_edges_tensor generation:  0.043351173400878906
mini_batch_src_global generation:  0.057080984115600586
r_  generation:  0.5144815444946289
local_output_nid generation:  0.04239320755004883
local_in_edges_tensor generation:  0.04605817794799805
mini_batch_src_global generation:  0.05849432945251465
r_  generation:  0.5178689956665039
local_output_nid generation:  0.04070329666137695
local_in_edges_tensor generation:  0.043634891510009766
mini_batch_src_global generation:  0.05724000930786133
r_  generation:  0.5213098526000977
local_output_nid generation:  0.040665626525878906
local_in_edges_tensor generation:  0.03864288330078125
mini_batch_src_global generation:  0.05727553367614746
r_  generation:  0.5181810855865479
local_output_nid generation:  0.04057598114013672
local_in_edges_tensor generation:  0.038442373275756836
mini_batch_src_global generation:  0.057914018630981445
r_  generation:  0.5196890830993652
local_output_nid generation:  0.04060053825378418
local_in_edges_tensor generation:  0.04578256607055664
mini_batch_src_global generation:  0.05916476249694824
r_  generation:  0.5169575214385986
local_output_nid generation:  0.04070115089416504
local_in_edges_tensor generation:  0.03857707977294922
mini_batch_src_global generation:  0.05745577812194824
r_  generation:  0.5229177474975586
----------------------check_connections_block total spend ----------------------------- 12.403501749038696
generate_one_block  0.6336464881896973
generate_one_block  0.6463501453399658
generate_one_block  0.6469497680664062
generate_one_block  0.6385960578918457
generate_one_block  0.6386747360229492
generate_one_block  0.6500904560089111
generate_one_block  0.643728494644165
generate_one_block  0.653796911239624
generate_one_block  0.6410346031188965
generate_one_block  0.7309062480926514
generate_one_block  0.643798828125
generate_one_block  0.6419253349304199
generate_one_block  0.6413629055023193
generate_one_block  0.6423110961914062
generate_one_block  0.6423778533935547
generate_one_block  0.6498253345489502
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.1999058723449707  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

connection checking time:  43.0438711643219
block generation total time  36.35336208343506
average batch blocks generation time:  2.272085130214691
block dataloader generation time/epoch 82.46763157844543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 0.12466192245483398  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166187, 128])
torch.Size([163767, 128])
torch.Size([155647, 128])
torch.Size([123731, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0701904296875 GB
    Memory Allocated: 1.153395175933838  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12469863891601562  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166297, 128])
torch.Size([163907, 128])
torch.Size([155749, 128])
torch.Size([124054, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1548352241516113  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.1247091293334961  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166289, 128])
torch.Size([163839, 128])
torch.Size([155683, 128])
torch.Size([123390, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1526098251342773  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12463855743408203  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166244, 128])
torch.Size([163760, 128])
torch.Size([155482, 128])
torch.Size([123581, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1513895988464355  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.1246194839477539  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166245, 128])
torch.Size([163920, 128])
torch.Size([155627, 128])
torch.Size([123513, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.151843547821045  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12481212615966797  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

torch.Size([166282, 128])
torch.Size([163964, 128])
torch.Size([155813, 128])
torch.Size([124286, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1565546989440918  GigaBytes
Max Memory Allocated: 1.1961159706115723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12461566925048828  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166326, 128])
torch.Size([164040, 128])
torch.Size([155948, 128])
torch.Size([123891, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1543736457824707  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12454605102539062  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166290, 128])
torch.Size([163966, 128])
torch.Size([155818, 128])
torch.Size([123708, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1530728340148926  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12479591369628906  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166301, 128])
torch.Size([163960, 128])
torch.Size([155901, 128])
torch.Size([124182, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1556758880615234  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.1246633529663086  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166296, 128])
torch.Size([163951, 128])
torch.Size([155746, 128])
torch.Size([123702, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1532702445983887  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12466144561767578  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166304, 128])
torch.Size([164001, 128])
torch.Size([155691, 128])
torch.Size([123528, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1529836654663086  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12460041046142578  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166369, 128])
torch.Size([164078, 128])
torch.Size([156129, 128])
torch.Size([124145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.15568208694458  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12457752227783203  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166319, 128])
torch.Size([163849, 128])
torch.Size([155548, 128])
torch.Size([123374, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.150527000427246  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12470149993896484  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166284, 128])
torch.Size([164007, 128])
torch.Size([155832, 128])
torch.Size([123709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1537055969238281  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12458229064941406  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166164, 128])
torch.Size([163707, 128])
torch.Size([155353, 128])
torch.Size([123154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.1495704650878906  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 0.12446403503417969  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

torch.Size([166204, 128])
torch.Size([163818, 128])
torch.Size([155479, 128])
torch.Size([122983, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0721435546875 GB
    Memory Allocated: 1.148557186126709  GigaBytes
Max Memory Allocated: 1.1963677406311035  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07304641604423523 |0.030131027102470398 |0.005579277873039246 |9.116530418395996e-05 |0.005831703543663025 |0.005171775817871094 |
----------------------------------------------------------pseudo_mini_loss sum 3.858919382095337
Total (block generation + training)time/epoch 84.38779640197754
Training time/epoch 1.9198760986328125
Training time without block to device /epoch 1.4377796649932861
Training time without total dataloading part /epoch 0.18920612335205078
load block tensor time/epoch 1.1687426567077637
block to device time/epoch 0.48209643363952637
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10413857
Number of first layer input nodes during this epoch:  2660401
