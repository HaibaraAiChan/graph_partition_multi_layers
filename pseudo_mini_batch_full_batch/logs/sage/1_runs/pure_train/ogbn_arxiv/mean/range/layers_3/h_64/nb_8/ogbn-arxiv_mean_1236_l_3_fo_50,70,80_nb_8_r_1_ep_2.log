Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648448955.5347087
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027261018753051758
range selection method range initialization spend 0.013550043106079102
time for parepare:  0.0181272029876709
local_output_nid generation:  0.002656221389770508
local_in_edges_tensor generation:  0.005049228668212891
mini_batch_src_global generation:  0.003831148147583008
r_  generation:  0.04241013526916504
local_output_nid generation:  0.0031404495239257812
local_in_edges_tensor generation:  0.0017380714416503906
mini_batch_src_global generation:  0.004618406295776367
r_  generation:  0.041565656661987305
local_output_nid generation:  0.0031099319458007812
local_in_edges_tensor generation:  0.0017347335815429688
mini_batch_src_global generation:  0.0031461715698242188
r_  generation:  0.04428696632385254
local_output_nid generation:  0.0031747817993164062
local_in_edges_tensor generation:  0.0017414093017578125
mini_batch_src_global generation:  0.0033655166625976562
r_  generation:  0.0463101863861084
local_output_nid generation:  0.003122568130493164
local_in_edges_tensor generation:  0.001766204833984375
mini_batch_src_global generation:  0.003570079803466797
r_  generation:  0.046920061111450195
local_output_nid generation:  0.0031518936157226562
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.0036110877990722656
r_  generation:  0.046018123626708984
local_output_nid generation:  0.003161191940307617
local_in_edges_tensor generation:  0.0016980171203613281
mini_batch_src_global generation:  0.003787517547607422
r_  generation:  0.04713273048400879
local_output_nid generation:  0.0032041072845458984
local_in_edges_tensor generation:  0.0017173290252685547
mini_batch_src_global generation:  0.0036401748657226562
r_  generation:  0.046244144439697266
----------------------check_connections_block total spend ----------------------------- 0.5285172462463379
generate_one_block  0.06121420860290527
generate_one_block  0.05971240997314453
generate_one_block  0.06123948097229004
generate_one_block  0.06189465522766113
generate_one_block  0.06486845016479492
generate_one_block  0.06028318405151367
generate_one_block  0.06135821342468262
generate_one_block  0.060546159744262695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04357624053955078
gen group dst list time:  0.01631760597229004
time for parepare:  0.02014446258544922
local_output_nid generation:  0.010949373245239258
local_in_edges_tensor generation:  0.03232693672180176
mini_batch_src_global generation:  0.038140058517456055
r_  generation:  0.3564612865447998
local_output_nid generation:  0.019578933715820312
local_in_edges_tensor generation:  0.032088279724121094
mini_batch_src_global generation:  0.043306827545166016
r_  generation:  0.3632361888885498
local_output_nid generation:  0.020544052124023438
local_in_edges_tensor generation:  0.028263092041015625
mini_batch_src_global generation:  0.043509721755981445
r_  generation:  0.37261009216308594
local_output_nid generation:  0.021379470825195312
local_in_edges_tensor generation:  0.027508020401000977
mini_batch_src_global generation:  0.04467439651489258
r_  generation:  0.3818035125732422
local_output_nid generation:  0.02198481559753418
local_in_edges_tensor generation:  0.027969837188720703
mini_batch_src_global generation:  0.048946380615234375
r_  generation:  0.3796851634979248
local_output_nid generation:  0.0216524600982666
local_in_edges_tensor generation:  0.021273136138916016
mini_batch_src_global generation:  0.04623842239379883
r_  generation:  0.38851332664489746
local_output_nid generation:  0.022327899932861328
local_in_edges_tensor generation:  0.021070241928100586
mini_batch_src_global generation:  0.04770660400390625
r_  generation:  0.38407206535339355
local_output_nid generation:  0.022055625915527344
local_in_edges_tensor generation:  0.020952939987182617
mini_batch_src_global generation:  0.04691958427429199
r_  generation:  0.3764071464538574
----------------------check_connections_block total spend ----------------------------- 4.4061126708984375
generate_one_block  0.5021612644195557
generate_one_block  0.4871809482574463
generate_one_block  0.5051577091217041
generate_one_block  0.5139656066894531
generate_one_block  0.5041158199310303
generate_one_block  0.5047287940979004
generate_one_block  0.5060110092163086
generate_one_block  0.48790550231933594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03820967674255371
gen group dst list time:  0.036963462829589844
time for parepare:  0.01912546157836914
local_output_nid generation:  0.02528095245361328
local_in_edges_tensor generation:  0.04388618469238281
mini_batch_src_global generation:  0.055800676345825195
r_  generation:  0.5383498668670654
local_output_nid generation:  0.03227734565734863
local_in_edges_tensor generation:  0.05569267272949219
mini_batch_src_global generation:  0.06383705139160156
r_  generation:  0.542630672454834
local_output_nid generation:  0.03303670883178711
local_in_edges_tensor generation:  0.045804738998413086
mini_batch_src_global generation:  0.06147575378417969
r_  generation:  0.551027774810791
local_output_nid generation:  0.033446550369262695
local_in_edges_tensor generation:  0.04666638374328613
mini_batch_src_global generation:  0.060367584228515625
r_  generation:  0.5615441799163818
local_output_nid generation:  0.03374743461608887
local_in_edges_tensor generation:  0.04024910926818848
mini_batch_src_global generation:  0.06611442565917969
r_  generation:  0.564021110534668
local_output_nid generation:  0.033622026443481445
local_in_edges_tensor generation:  0.04734206199645996
mini_batch_src_global generation:  0.06245756149291992
r_  generation:  0.5632615089416504
local_output_nid generation:  0.033963918685913086
local_in_edges_tensor generation:  0.03675699234008789
mini_batch_src_global generation:  0.06712579727172852
r_  generation:  0.5615599155426025
local_output_nid generation:  0.03425312042236328
local_in_edges_tensor generation:  0.04184317588806152
mini_batch_src_global generation:  0.06289529800415039
r_  generation:  0.5671854019165039
----------------------check_connections_block total spend ----------------------------- 6.60461163520813
generate_one_block  0.7190670967102051
generate_one_block  0.7086319923400879
generate_one_block  0.7118191719055176
generate_one_block  0.7137093544006348
generate_one_block  0.7187469005584717
generate_one_block  0.7542846202850342
generate_one_block  0.7366759777069092
generate_one_block  0.7115182876586914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  11.010724306106567
block generation total time  9.785680055618286
average batch blocks generation time:  1.2232100069522858
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10168266296386719  GigaBytes
Max Memory Allocated: 0.10168266296386719  GigaBytes

torch.Size([162582, 128])
torch.Size([145935, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.31987714767456055  GigaBytes
Max Memory Allocated: 0.3329582214355469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10370397567749023  GigaBytes
Max Memory Allocated: 0.35466766357421875  GigaBytes

torch.Size([162794, 128])
torch.Size([145959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.31906652450561523  GigaBytes
Max Memory Allocated: 0.35466766357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10439538955688477  GigaBytes
Max Memory Allocated: 0.35466766357421875  GigaBytes

torch.Size([162456, 128])
torch.Size([145966, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32004642486572266  GigaBytes
Max Memory Allocated: 0.35466766357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1041874885559082  GigaBytes
Max Memory Allocated: 0.35466766357421875  GigaBytes

torch.Size([162523, 128])
torch.Size([145831, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3202691078186035  GigaBytes
Max Memory Allocated: 0.35466766357421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1041269302368164  GigaBytes
Max Memory Allocated: 0.354799747467041  GigaBytes

torch.Size([162599, 128])
torch.Size([145994, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3206453323364258  GigaBytes
Max Memory Allocated: 0.354799747467041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1038217544555664  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162561, 128])
torch.Size([145825, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3195967674255371  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10425615310668945  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162657, 128])
torch.Size([146104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32013368606567383  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10396480560302734  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162550, 128])
torch.Size([145685, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3193812370300293  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037484437227249146 |0.04952925443649292 |0.09112685918807983 |0.0001042485237121582 |0.010131269693374634 |0.0017468929290771484 |
----------------------------------------------------------pseudo_mini_loss sum 5.319152355194092
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057128
Number of first layer input nodes during this epoch:  1300722
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.15296125411987305  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022533416748046875
range selection method range initialization spend 0.011102914810180664
time for parepare:  0.018746614456176758
local_output_nid generation:  0.002691984176635742
local_in_edges_tensor generation:  0.004867076873779297
mini_batch_src_global generation:  0.003694772720336914
r_  generation:  0.04131317138671875
local_output_nid generation:  0.0033941268920898438
local_in_edges_tensor generation:  0.0018112659454345703
mini_batch_src_global generation:  0.0046079158782958984
r_  generation:  0.04421401023864746
local_output_nid generation:  0.0036630630493164062
local_in_edges_tensor generation:  0.0017170906066894531
mini_batch_src_global generation:  0.0032689571380615234
r_  generation:  0.04465627670288086
local_output_nid generation:  0.003660440444946289
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.0033516883850097656
r_  generation:  0.04573535919189453
local_output_nid generation:  0.003707408905029297
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0035543441772460938
r_  generation:  0.05182290077209473
local_output_nid generation:  0.003681659698486328
local_in_edges_tensor generation:  0.0018172264099121094
mini_batch_src_global generation:  0.021578550338745117
r_  generation:  0.05052804946899414
local_output_nid generation:  0.0037260055541992188
local_in_edges_tensor generation:  0.0017578601837158203
mini_batch_src_global generation:  0.0037195682525634766
r_  generation:  0.048511505126953125
local_output_nid generation:  0.003770589828491211
local_in_edges_tensor generation:  0.001739501953125
mini_batch_src_global generation:  0.0038132667541503906
r_  generation:  0.04758143424987793
----------------------check_connections_block total spend ----------------------------- 0.569847583770752
generate_one_block  0.06446433067321777
generate_one_block  0.06670975685119629
generate_one_block  0.06247138977050781
generate_one_block  0.06158041954040527
generate_one_block  0.06528902053833008
generate_one_block  0.06319189071655273
generate_one_block  0.07272052764892578
generate_one_block  0.06355738639831543
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06853365898132324
gen group dst list time:  0.0211639404296875
time for parepare:  0.02361583709716797
local_output_nid generation:  0.011659622192382812
local_in_edges_tensor generation:  0.05333518981933594
mini_batch_src_global generation:  0.03635430335998535
r_  generation:  0.3557748794555664
local_output_nid generation:  0.017084598541259766
local_in_edges_tensor generation:  0.03406167030334473
mini_batch_src_global generation:  0.04481935501098633
r_  generation:  0.37305164337158203
local_output_nid generation:  0.01742243766784668
local_in_edges_tensor generation:  0.024455547332763672
mini_batch_src_global generation:  0.044519662857055664
r_  generation:  0.3851144313812256
local_output_nid generation:  0.01740717887878418
local_in_edges_tensor generation:  0.028444290161132812
mini_batch_src_global generation:  0.04535531997680664
r_  generation:  0.37732887268066406
local_output_nid generation:  0.018030643463134766
local_in_edges_tensor generation:  0.02847146987915039
mini_batch_src_global generation:  0.0467219352722168
r_  generation:  0.38393688201904297
local_output_nid generation:  0.01818251609802246
local_in_edges_tensor generation:  0.025057315826416016
mini_batch_src_global generation:  0.04949235916137695
r_  generation:  0.3915739059448242
local_output_nid generation:  0.018141508102416992
local_in_edges_tensor generation:  0.02509307861328125
mini_batch_src_global generation:  0.04645895957946777
r_  generation:  0.38483500480651855
local_output_nid generation:  0.01829981803894043
local_in_edges_tensor generation:  0.021920204162597656
mini_batch_src_global generation:  0.046979427337646484
r_  generation:  0.38424134254455566
----------------------check_connections_block total spend ----------------------------- 4.458361625671387
generate_one_block  0.5048167705535889
generate_one_block  0.5107898712158203
generate_one_block  0.4937713146209717
generate_one_block  0.5339627265930176
generate_one_block  0.5243525505065918
generate_one_block  0.5496618747711182
generate_one_block  0.5131349563598633
generate_one_block  0.5296871662139893
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.055074453353881836
gen group dst list time:  0.04100155830383301
time for parepare:  0.019319534301757812
local_output_nid generation:  0.026288747787475586
local_in_edges_tensor generation:  0.08454394340515137
mini_batch_src_global generation:  0.058319091796875
r_  generation:  0.5509130954742432
local_output_nid generation:  0.03354191780090332
local_in_edges_tensor generation:  0.0531768798828125
mini_batch_src_global generation:  0.06588530540466309
r_  generation:  0.5712027549743652
local_output_nid generation:  0.03560590744018555
local_in_edges_tensor generation:  0.05605268478393555
mini_batch_src_global generation:  0.06591653823852539
r_  generation:  0.5809779167175293
local_output_nid generation:  0.03814840316772461
local_in_edges_tensor generation:  0.04461526870727539
mini_batch_src_global generation:  0.06346964836120605
r_  generation:  0.5666170120239258
local_output_nid generation:  0.03568601608276367
local_in_edges_tensor generation:  0.038439035415649414
mini_batch_src_global generation:  0.06423735618591309
r_  generation:  0.5789008140563965
local_output_nid generation:  0.036119699478149414
local_in_edges_tensor generation:  0.0383453369140625
mini_batch_src_global generation:  0.0718533992767334
r_  generation:  0.5712769031524658
local_output_nid generation:  0.03579854965209961
local_in_edges_tensor generation:  0.0330653190612793
mini_batch_src_global generation:  0.06782174110412598
r_  generation:  0.5797214508056641
local_output_nid generation:  0.03620338439941406
local_in_edges_tensor generation:  0.041291236877441406
mini_batch_src_global generation:  0.07210421562194824
r_  generation:  0.584040641784668
----------------------check_connections_block total spend ----------------------------- 6.86089825630188
generate_one_block  0.737623929977417
generate_one_block  0.7286136150360107
generate_one_block  0.7346763610839844
generate_one_block  0.734041690826416
generate_one_block  0.7037303447723389
generate_one_block  0.7007761001586914
generate_one_block  0.7085886001586914
generate_one_block  0.7297308444976807
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.15296125411987305  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

connection checking time:  11.319259881973267
block generation total time  9.937958717346191
average batch blocks generation time:  1.242244839668274
block dataloader generation time/epoch 23.461740016937256
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1042933464050293  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162590, 128])
torch.Size([145937, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3197002410888672  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1043696403503418  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162512, 128])
torch.Size([145841, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.320615291595459  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.1041574478149414  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162687, 128])
torch.Size([146244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3203010559082031  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10422277450561523  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162622, 128])
torch.Size([145927, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3199925422668457  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10439205169677734  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162603, 128])
torch.Size([145959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3204197883605957  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10434198379516602  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162600, 128])
torch.Size([146002, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.32048845291137695  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10425376892089844  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162529, 128])
torch.Size([145680, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3200564384460449  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.10423040390014648  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

torch.Size([162771, 128])
torch.Size([146115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.3200864791870117  GigaBytes
Max Memory Allocated: 0.3556709289550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041688770055770874 |0.01812782883644104 |0.003651827573776245 |9.191036224365234e-05 |0.003751099109649658 |0.002835988998413086 |
----------------------------------------------------------pseudo_mini_loss sum 4.078474998474121
Total (block generation + training)time/epoch 24.028907299041748
Training time/epoch 0.5669660568237305
Training time without block to device /epoch 0.42194342613220215
Training time without total dataloading part /epoch 0.06279468536376953
load block tensor time/epoch 0.333510160446167
block to device time/epoch 0.14502263069152832
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3058927
Number of first layer input nodes during this epoch:  1300914
