Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648445500.0931582
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025140762329101562
range selection method range initialization spend 0.013447284698486328
time for parepare:  0.017719030380249023
local_output_nid generation:  0.002615690231323242
local_in_edges_tensor generation:  0.004574298858642578
mini_batch_src_global generation:  0.0032079219818115234
r_  generation:  0.036916255950927734
local_output_nid generation:  0.0029535293579101562
local_in_edges_tensor generation:  0.0016291141510009766
mini_batch_src_global generation:  0.003978252410888672
r_  generation:  0.03822922706604004
local_output_nid generation:  0.0030465126037597656
local_in_edges_tensor generation:  0.0016269683837890625
mini_batch_src_global generation:  0.0026879310607910156
r_  generation:  0.04073476791381836
local_output_nid generation:  0.0032913684844970703
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.002759218215942383
r_  generation:  0.039890289306640625
local_output_nid generation:  0.003103971481323242
local_in_edges_tensor generation:  0.0016810894012451172
mini_batch_src_global generation:  0.002820253372192383
r_  generation:  0.03953194618225098
local_output_nid generation:  0.0030472278594970703
local_in_edges_tensor generation:  0.0016155242919921875
mini_batch_src_global generation:  0.0031452178955078125
r_  generation:  0.04142355918884277
local_output_nid generation:  0.0031282901763916016
local_in_edges_tensor generation:  0.0016155242919921875
mini_batch_src_global generation:  0.0030465126037597656
r_  generation:  0.040662527084350586
local_output_nid generation:  0.003076314926147461
local_in_edges_tensor generation:  0.0016732215881347656
mini_batch_src_global generation:  0.003133535385131836
r_  generation:  0.04409909248352051
----------------------check_connections_block total spend ----------------------------- 0.47154974937438965
generate_one_block  0.05466127395629883
generate_one_block  0.055527448654174805
generate_one_block  0.05562710762023926
generate_one_block  0.0547480583190918
generate_one_block  0.05585813522338867
generate_one_block  0.05431246757507324
generate_one_block  0.054514408111572266
generate_one_block  0.055535078048706055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04084372520446777
gen group dst list time:  0.015068531036376953
time for parepare:  0.019043922424316406
local_output_nid generation:  0.01021885871887207
local_in_edges_tensor generation:  0.029597997665405273
mini_batch_src_global generation:  0.026987552642822266
r_  generation:  0.28702569007873535
local_output_nid generation:  0.015421390533447266
local_in_edges_tensor generation:  0.027406692504882812
mini_batch_src_global generation:  0.03520011901855469
r_  generation:  0.2979121208190918
local_output_nid generation:  0.015728235244750977
local_in_edges_tensor generation:  0.025600910186767578
mini_batch_src_global generation:  0.03514504432678223
r_  generation:  0.3085484504699707
local_output_nid generation:  0.016136884689331055
local_in_edges_tensor generation:  0.017781496047973633
mini_batch_src_global generation:  0.03651928901672363
r_  generation:  0.30615830421447754
local_output_nid generation:  0.016179561614990234
local_in_edges_tensor generation:  0.017377853393554688
mini_batch_src_global generation:  0.03649330139160156
r_  generation:  0.3043372631072998
local_output_nid generation:  0.01652812957763672
local_in_edges_tensor generation:  0.020623445510864258
mini_batch_src_global generation:  0.03935551643371582
r_  generation:  0.31400156021118164
local_output_nid generation:  0.01687002182006836
local_in_edges_tensor generation:  0.029051780700683594
mini_batch_src_global generation:  0.03746771812438965
r_  generation:  0.31538891792297363
local_output_nid generation:  0.016756057739257812
local_in_edges_tensor generation:  0.0211184024810791
mini_batch_src_global generation:  0.03833580017089844
r_  generation:  0.31456422805786133
----------------------check_connections_block total spend ----------------------------- 3.5854246616363525
generate_one_block  0.3945305347442627
generate_one_block  0.3958461284637451
generate_one_block  0.4036691188812256
generate_one_block  0.3879375457763672
generate_one_block  0.3876986503601074
generate_one_block  0.40702342987060547
generate_one_block  0.4004027843475342
generate_one_block  0.40580105781555176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03136873245239258
gen group dst list time:  0.03556537628173828
time for parepare:  0.019692420959472656
local_output_nid generation:  0.02595996856689453
local_in_edges_tensor generation:  0.04078507423400879
mini_batch_src_global generation:  0.044359683990478516
r_  generation:  0.4800903797149658
local_output_nid generation:  0.03250455856323242
local_in_edges_tensor generation:  0.04948997497558594
mini_batch_src_global generation:  0.05580759048461914
r_  generation:  0.48018956184387207
local_output_nid generation:  0.03312063217163086
local_in_edges_tensor generation:  0.05383610725402832
mini_batch_src_global generation:  0.061556339263916016
r_  generation:  0.5025441646575928
local_output_nid generation:  0.034143686294555664
local_in_edges_tensor generation:  0.04010820388793945
mini_batch_src_global generation:  0.05901455879211426
r_  generation:  0.48206591606140137
local_output_nid generation:  0.03346395492553711
local_in_edges_tensor generation:  0.04335761070251465
mini_batch_src_global generation:  0.05350923538208008
r_  generation:  0.4942646026611328
local_output_nid generation:  0.034394264221191406
local_in_edges_tensor generation:  0.03536033630371094
mini_batch_src_global generation:  0.054831504821777344
r_  generation:  0.48261189460754395
local_output_nid generation:  0.03398895263671875
local_in_edges_tensor generation:  0.04723381996154785
mini_batch_src_global generation:  0.05260610580444336
r_  generation:  0.5028948783874512
local_output_nid generation:  0.03807353973388672
local_in_edges_tensor generation:  0.03157615661621094
mini_batch_src_global generation:  0.0554506778717041
r_  generation:  0.48506784439086914
----------------------check_connections_block total spend ----------------------------- 5.847198009490967
generate_one_block  0.6161298751831055
generate_one_block  0.6117372512817383
generate_one_block  0.6340768337249756
generate_one_block  0.6035494804382324
generate_one_block  0.6007680892944336
generate_one_block  0.6196694374084473
generate_one_block  0.6471710205078125
generate_one_block  0.604729175567627
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  9.43262267112732
block generation total time  8.120740413665771
average batch blocks generation time:  1.0150925517082214
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09556055068969727  GigaBytes
Max Memory Allocated: 0.09556055068969727  GigaBytes

torch.Size([160333, 128])
torch.Size([140959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.21323585510253906  GigaBytes
Max Memory Allocated: 0.21538209915161133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.09738779067993164  GigaBytes
Max Memory Allocated: 0.22704267501831055  GigaBytes

torch.Size([160492, 128])
torch.Size([141417, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.21350383758544922  GigaBytes
Max Memory Allocated: 0.22704267501831055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09843873977661133  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

torch.Size([160551, 128])
torch.Size([141374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21216917037963867  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09792375564575195  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

torch.Size([160480, 128])
torch.Size([140978, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21309661865234375  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09768199920654297  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

torch.Size([160243, 128])
torch.Size([140765, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21322250366210938  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.0980062484741211  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

torch.Size([160561, 128])
torch.Size([141292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2131938934326172  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09855890274047852  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

torch.Size([160352, 128])
torch.Size([141216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21402311325073242  GigaBytes
Max Memory Allocated: 0.22714614868164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09836626052856445  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

torch.Size([160442, 128])
torch.Size([140915, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21209287643432617  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037944018840789795 |0.054497987031936646 |0.09399205446243286 |0.0001112222671508789 |0.011271268129348755 |0.003991842269897461 |
----------------------------------------------------------pseudo_mini_loss sum 5.012543201446533
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2955318
Number of first layer input nodes during this epoch:  1283454
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.13907241821289062  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024044275283813477
range selection method range initialization spend 0.011564970016479492
time for parepare:  0.01697540283203125
local_output_nid generation:  0.0026807785034179688
local_in_edges_tensor generation:  0.007559299468994141
mini_batch_src_global generation:  0.0032253265380859375
r_  generation:  0.036177873611450195
local_output_nid generation:  0.0031042098999023438
local_in_edges_tensor generation:  0.001626729965209961
mini_batch_src_global generation:  0.004115581512451172
r_  generation:  0.039275169372558594
local_output_nid generation:  0.0030710697174072266
local_in_edges_tensor generation:  0.0016393661499023438
mini_batch_src_global generation:  0.0028591156005859375
r_  generation:  0.0396270751953125
local_output_nid generation:  0.003122091293334961
local_in_edges_tensor generation:  0.0017163753509521484
mini_batch_src_global generation:  0.002930164337158203
r_  generation:  0.04052734375
local_output_nid generation:  0.0031273365020751953
local_in_edges_tensor generation:  0.0016651153564453125
mini_batch_src_global generation:  0.002997875213623047
r_  generation:  0.04150032997131348
local_output_nid generation:  0.0031745433807373047
local_in_edges_tensor generation:  0.00165557861328125
mini_batch_src_global generation:  0.003259420394897461
r_  generation:  0.04194021224975586
local_output_nid generation:  0.003159761428833008
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.0032913684844970703
r_  generation:  0.04584312438964844
local_output_nid generation:  0.003159046173095703
local_in_edges_tensor generation:  0.0016508102416992188
mini_batch_src_global generation:  0.003218412399291992
r_  generation:  0.041742563247680664
----------------------check_connections_block total spend ----------------------------- 0.4856693744659424
generate_one_block  0.05526280403137207
generate_one_block  0.05453085899353027
generate_one_block  0.059487104415893555
generate_one_block  0.05454540252685547
generate_one_block  0.06284141540527344
generate_one_block  0.06338858604431152
generate_one_block  0.06228065490722656
generate_one_block  0.058271169662475586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.053290605545043945
gen group dst list time:  0.0160520076751709
time for parepare:  0.02310919761657715
local_output_nid generation:  0.010793209075927734
local_in_edges_tensor generation:  0.03692269325256348
mini_batch_src_global generation:  0.02780604362487793
r_  generation:  0.29082703590393066
local_output_nid generation:  0.015728473663330078
local_in_edges_tensor generation:  0.027176380157470703
mini_batch_src_global generation:  0.0375828742980957
r_  generation:  0.3008847236633301
local_output_nid generation:  0.016301870346069336
local_in_edges_tensor generation:  0.03456759452819824
mini_batch_src_global generation:  0.034944772720336914
r_  generation:  0.3069026470184326
local_output_nid generation:  0.016265869140625
local_in_edges_tensor generation:  0.019900083541870117
mini_batch_src_global generation:  0.03650474548339844
r_  generation:  0.3053855895996094
local_output_nid generation:  0.016564369201660156
local_in_edges_tensor generation:  0.020104408264160156
mini_batch_src_global generation:  0.03931736946105957
r_  generation:  0.317169189453125
local_output_nid generation:  0.01764655113220215
local_in_edges_tensor generation:  0.030313491821289062
mini_batch_src_global generation:  0.040085554122924805
r_  generation:  0.32165026664733887
local_output_nid generation:  0.018471717834472656
local_in_edges_tensor generation:  0.025586605072021484
mini_batch_src_global generation:  0.04110431671142578
r_  generation:  0.31625914573669434
local_output_nid generation:  0.017421483993530273
local_in_edges_tensor generation:  0.0205533504486084
mini_batch_src_global generation:  0.038553714752197266
r_  generation:  0.31113338470458984
----------------------check_connections_block total spend ----------------------------- 3.675576686859131
generate_one_block  0.4059727191925049
generate_one_block  0.40822434425354004
generate_one_block  0.4057581424713135
generate_one_block  0.39050793647766113
generate_one_block  0.40101170539855957
generate_one_block  0.4003314971923828
generate_one_block  0.40647220611572266
generate_one_block  0.41166043281555176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04811906814575195
gen group dst list time:  0.035906076431274414
time for parepare:  0.021625280380249023
local_output_nid generation:  0.02688741683959961
local_in_edges_tensor generation:  0.05438518524169922
mini_batch_src_global generation:  0.06265878677368164
r_  generation:  0.47839951515197754
local_output_nid generation:  0.03402256965637207
local_in_edges_tensor generation:  0.0530085563659668
mini_batch_src_global generation:  0.07083368301391602
r_  generation:  0.4861032962799072
local_output_nid generation:  0.03546786308288574
local_in_edges_tensor generation:  0.04809284210205078
mini_batch_src_global generation:  0.05357170104980469
r_  generation:  0.49550652503967285
local_output_nid generation:  0.03446531295776367
local_in_edges_tensor generation:  0.03337812423706055
mini_batch_src_global generation:  0.05636763572692871
r_  generation:  0.490109920501709
local_output_nid generation:  0.034804582595825195
local_in_edges_tensor generation:  0.03683137893676758
mini_batch_src_global generation:  0.05894970893859863
r_  generation:  0.502763032913208
local_output_nid generation:  0.034693002700805664
local_in_edges_tensor generation:  0.04555654525756836
mini_batch_src_global generation:  0.06469273567199707
r_  generation:  0.4958345890045166
local_output_nid generation:  0.03500938415527344
local_in_edges_tensor generation:  0.04168367385864258
mini_batch_src_global generation:  0.055441856384277344
r_  generation:  0.5069048404693604
local_output_nid generation:  0.035007476806640625
local_in_edges_tensor generation:  0.03307151794433594
mini_batch_src_global generation:  0.05758810043334961
r_  generation:  0.4937167167663574
----------------------check_connections_block total spend ----------------------------- 5.947020530700684
generate_one_block  0.6360001564025879
generate_one_block  0.6273689270019531
generate_one_block  0.6402883529663086
generate_one_block  0.6209414005279541
generate_one_block  0.6096682548522949
generate_one_block  0.6321456432342529
generate_one_block  0.627051591873169
generate_one_block  0.628770112991333
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.13907241821289062  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

connection checking time:  9.622597217559814
block generation total time  8.25217342376709
average batch blocks generation time:  1.0315216779708862
block dataloader generation time/epoch 19.872482776641846
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09792757034301758  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

torch.Size([160435, 128])
torch.Size([140944, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21226119995117188  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09804725646972656  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

torch.Size([160575, 128])
torch.Size([141073, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2139301300048828  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09815454483032227  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

torch.Size([160566, 128])
torch.Size([141450, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21538972854614258  GigaBytes
Max Memory Allocated: 0.22760009765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09889650344848633  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

torch.Size([160372, 128])
torch.Size([140708, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21149444580078125  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09807968139648438  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

torch.Size([160485, 128])
torch.Size([140920, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21406841278076172  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09813261032104492  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

torch.Size([160546, 128])
torch.Size([141146, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.21420621871948242  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.0976710319519043  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

torch.Size([160576, 128])
torch.Size([141440, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2151780128479004  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.0979452133178711  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

torch.Size([160704, 128])
torch.Size([141771, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2144770622253418  GigaBytes
Max Memory Allocated: 0.22931337356567383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03827717900276184 |0.018246442079544067 |0.0038396716117858887 |9.778141975402832e-05 |0.006119132041931152 |0.002910137176513672 |
----------------------------------------------------------pseudo_mini_loss sum 4.307303428649902
Total (block generation + training)time/epoch 20.41874051094055
Training time/epoch 0.5459787845611572
Training time without block to device /epoch 0.4000072479248047
Training time without total dataloading part /epoch 0.08336281776428223
load block tensor time/epoch 0.3062174320220947
block to device time/epoch 0.14597153663635254
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2956832
Number of first layer input nodes during this epoch:  1284259
