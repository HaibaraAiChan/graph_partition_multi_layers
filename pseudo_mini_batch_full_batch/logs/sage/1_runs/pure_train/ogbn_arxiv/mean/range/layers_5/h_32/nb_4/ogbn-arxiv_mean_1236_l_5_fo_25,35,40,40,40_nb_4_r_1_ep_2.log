Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648495767.149411
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02325749397277832
range selection method range initialization spend 0.013937711715698242
time for parepare:  0.01752758026123047
local_output_nid generation:  0.005296945571899414
local_in_edges_tensor generation:  0.005663156509399414
mini_batch_src_global generation:  0.006554365158081055
r_  generation:  0.08299088478088379
local_output_nid generation:  0.006117105484008789
local_in_edges_tensor generation:  0.003109455108642578
mini_batch_src_global generation:  0.008601903915405273
r_  generation:  0.08894753456115723
local_output_nid generation:  0.006124734878540039
local_in_edges_tensor generation:  0.003072977066040039
mini_batch_src_global generation:  0.006479740142822266
r_  generation:  0.09136819839477539
local_output_nid generation:  0.006156444549560547
local_in_edges_tensor generation:  0.0030570030212402344
mini_batch_src_global generation:  0.006977081298828125
r_  generation:  0.09281611442565918
----------------------check_connections_block total spend ----------------------------- 0.5118832588195801
generate_one_block  0.10180306434631348
generate_one_block  0.10368227958679199
generate_one_block  0.10347580909729004
generate_one_block  0.10268473625183105
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.037770986557006836
gen group dst list time:  0.011608362197875977
time for parepare:  0.0194394588470459
local_output_nid generation:  0.01490330696105957
local_in_edges_tensor generation:  0.03414511680603027
mini_batch_src_global generation:  0.04184842109680176
r_  generation:  0.42763662338256836
local_output_nid generation:  0.02163529396057129
local_in_edges_tensor generation:  0.03983473777770996
mini_batch_src_global generation:  0.048892974853515625
r_  generation:  0.48778748512268066
local_output_nid generation:  0.03732657432556152
local_in_edges_tensor generation:  0.04701590538024902
mini_batch_src_global generation:  0.059092044830322266
r_  generation:  0.46272730827331543
local_output_nid generation:  0.03482532501220703
local_in_edges_tensor generation:  0.03778529167175293
mini_batch_src_global generation:  0.052610158920288086
r_  generation:  0.45488810539245605
----------------------check_connections_block total spend ----------------------------- 2.7161128520965576
generate_one_block  0.592094898223877
generate_one_block  0.581836462020874
generate_one_block  0.6504364013671875
generate_one_block  0.5589704513549805
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04388236999511719
gen group dst list time:  0.02869391441345215
time for parepare:  0.019741058349609375
local_output_nid generation:  0.025426149368286133
local_in_edges_tensor generation:  0.05567741394042969
mini_batch_src_global generation:  0.052474260330200195
r_  generation:  0.5536415576934814
local_output_nid generation:  0.03379511833190918
local_in_edges_tensor generation:  0.052572011947631836
mini_batch_src_global generation:  0.06489753723144531
r_  generation:  0.5605273246765137
local_output_nid generation:  0.034973859786987305
local_in_edges_tensor generation:  0.03839516639709473
mini_batch_src_global generation:  0.05769753456115723
r_  generation:  0.5692634582519531
local_output_nid generation:  0.03524923324584961
local_in_edges_tensor generation:  0.03864407539367676
mini_batch_src_global generation:  0.05902862548828125
r_  generation:  0.6071469783782959
----------------------check_connections_block total spend ----------------------------- 3.337188482284546
generate_one_block  0.7353308200836182
generate_one_block  0.718876838684082
generate_one_block  0.7058875560760498
generate_one_block  0.7065224647521973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029459714889526367
gen group dst list time:  0.028805017471313477
time for parepare:  0.019034862518310547
local_output_nid generation:  0.028159618377685547
local_in_edges_tensor generation:  0.06576395034790039
mini_batch_src_global generation:  0.05044698715209961
r_  generation:  0.5497267246246338
local_output_nid generation:  0.035881757736206055
local_in_edges_tensor generation:  0.0472414493560791
mini_batch_src_global generation:  0.06258678436279297
r_  generation:  0.5667552947998047
local_output_nid generation:  0.037424564361572266
local_in_edges_tensor generation:  0.053407907485961914
mini_batch_src_global generation:  0.06318879127502441
r_  generation:  0.5706257820129395
local_output_nid generation:  0.0376133918762207
local_in_edges_tensor generation:  0.05347037315368652
mini_batch_src_global generation:  0.08048295974731445
r_  generation:  0.5597708225250244
----------------------check_connections_block total spend ----------------------------- 3.3843753337860107
generate_one_block  0.6962549686431885
generate_one_block  0.6948826313018799
generate_one_block  0.7020297050476074
generate_one_block  0.6993145942687988
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027968883514404297
gen group dst list time:  0.02809906005859375
time for parepare:  0.019912004470825195
local_output_nid generation:  0.029356718063354492
local_in_edges_tensor generation:  0.04691171646118164
mini_batch_src_global generation:  0.04814267158508301
r_  generation:  0.5398726463317871
local_output_nid generation:  0.040090084075927734
local_in_edges_tensor generation:  0.0561220645904541
mini_batch_src_global generation:  0.06150460243225098
r_  generation:  0.5237545967102051
local_output_nid generation:  0.03788042068481445
local_in_edges_tensor generation:  0.044890403747558594
mini_batch_src_global generation:  0.06194496154785156
r_  generation:  0.5362157821655273
local_output_nid generation:  0.038008689880371094
local_in_edges_tensor generation:  0.03411602973937988
mini_batch_src_global generation:  0.05903768539428711
r_  generation:  0.5279195308685303
----------------------check_connections_block total spend ----------------------------- 3.192122220993042
generate_one_block  0.6746952533721924
generate_one_block  0.6551599502563477
generate_one_block  0.6497802734375
generate_one_block  0.6373519897460938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 7.2479248046875e-05  GigaBytes
Max Memory Allocated: 7.2479248046875e-05  GigaBytes

connection checking time:  12.629798889160156
block generation total time  10.659425258636475
average batch blocks generation time:  2.6648563146591187
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12938880920410156  GigaBytes
Max Memory Allocated: 0.12938880920410156  GigaBytes

torch.Size([167432, 128])
torch.Size([166890, 32])
torch.Size([164865, 32])
torch.Size([155279, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.47148990631103516  GigaBytes
Max Memory Allocated: 0.47487783432006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.13521146774291992  GigaBytes
Max Memory Allocated: 0.4915151596069336  GigaBytes

torch.Size([167445, 128])
torch.Size([166941, 32])
torch.Size([164921, 32])
torch.Size([155249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.47562503814697266  GigaBytes
Max Memory Allocated: 0.4915151596069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.1346149444580078  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

torch.Size([167437, 128])
torch.Size([166944, 32])
torch.Size([164978, 32])
torch.Size([154996, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.4732241630554199  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.13449764251708984  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

torch.Size([167431, 128])
torch.Size([166873, 32])
torch.Size([164754, 32])
torch.Size([154963, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.472475528717041  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05823475122451782 |0.11891096830368042 |0.1845298409461975 |0.00015395879745483398 |0.0205422043800354 |0.003174304962158203 |
----------------------------------------------------------pseudo_mini_loss sum 4.92844820022583
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3023100
Number of first layer input nodes during this epoch:  669745
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.23933124542236328  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.019899845123291016
range selection method range initialization spend 0.011548995971679688
time for parepare:  0.02044224739074707
local_output_nid generation:  0.00538325309753418
local_in_edges_tensor generation:  0.006439685821533203
mini_batch_src_global generation:  0.006529808044433594
r_  generation:  0.09549474716186523
local_output_nid generation:  0.011734962463378906
local_in_edges_tensor generation:  0.004430294036865234
mini_batch_src_global generation:  0.010765552520751953
r_  generation:  0.0935361385345459
local_output_nid generation:  0.00614166259765625
local_in_edges_tensor generation:  0.003104686737060547
mini_batch_src_global generation:  0.006743192672729492
r_  generation:  0.09421420097351074
local_output_nid generation:  0.00626373291015625
local_in_edges_tensor generation:  0.0030617713928222656
mini_batch_src_global generation:  0.0072252750396728516
r_  generation:  0.09900760650634766
----------------------check_connections_block total spend ----------------------------- 0.567000150680542
generate_one_block  0.11284732818603516
generate_one_block  0.10680079460144043
generate_one_block  0.10488462448120117
generate_one_block  0.10380911827087402
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.050482749938964844
gen group dst list time:  0.011234521865844727
time for parepare:  0.020399093627929688
local_output_nid generation:  0.015625953674316406
local_in_edges_tensor generation:  0.04511427879333496
mini_batch_src_global generation:  0.038210153579711914
r_  generation:  0.4071464538574219
local_output_nid generation:  0.022419214248657227
local_in_edges_tensor generation:  0.03813028335571289
mini_batch_src_global generation:  0.04810476303100586
r_  generation:  0.41965746879577637
local_output_nid generation:  0.022603988647460938
local_in_edges_tensor generation:  0.031218767166137695
mini_batch_src_global generation:  0.047847747802734375
r_  generation:  0.42322850227355957
local_output_nid generation:  0.023142099380493164
local_in_edges_tensor generation:  0.03195476531982422
mini_batch_src_global generation:  0.04942440986633301
r_  generation:  0.42911386489868164
----------------------check_connections_block total spend ----------------------------- 2.472332239151001
generate_one_block  0.5487873554229736
generate_one_block  0.5536725521087646
generate_one_block  0.556328296661377
generate_one_block  0.5470783710479736
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.040857791900634766
gen group dst list time:  0.020965576171875
time for parepare:  0.018874645233154297
local_output_nid generation:  0.02509307861328125
local_in_edges_tensor generation:  0.043988704681396484
mini_batch_src_global generation:  0.05091381072998047
r_  generation:  0.5521228313446045
local_output_nid generation:  0.0325469970703125
local_in_edges_tensor generation:  0.05433464050292969
mini_batch_src_global generation:  0.06290531158447266
r_  generation:  0.5713531970977783
local_output_nid generation:  0.033592939376831055
local_in_edges_tensor generation:  0.041382789611816406
mini_batch_src_global generation:  0.057382822036743164
r_  generation:  0.58036208152771
local_output_nid generation:  0.03565382957458496
local_in_edges_tensor generation:  0.0567324161529541
mini_batch_src_global generation:  0.08155417442321777
r_  generation:  0.5660231113433838
----------------------check_connections_block total spend ----------------------------- 3.3464369773864746
generate_one_block  0.7052838802337646
generate_one_block  0.701505184173584
generate_one_block  0.697063684463501
generate_one_block  0.7101752758026123
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04107046127319336
gen group dst list time:  0.02701115608215332
time for parepare:  0.018877506256103516
local_output_nid generation:  0.028763771057128906
local_in_edges_tensor generation:  0.062299251556396484
mini_batch_src_global generation:  0.05359601974487305
r_  generation:  0.5522136688232422
local_output_nid generation:  0.03530716896057129
local_in_edges_tensor generation:  0.05760836601257324
mini_batch_src_global generation:  0.06254267692565918
r_  generation:  0.5569469928741455
local_output_nid generation:  0.03905463218688965
local_in_edges_tensor generation:  0.05041241645812988
mini_batch_src_global generation:  0.06280851364135742
r_  generation:  0.5589780807495117
local_output_nid generation:  0.040283918380737305
local_in_edges_tensor generation:  0.05450081825256348
mini_batch_src_global generation:  0.06222939491271973
r_  generation:  0.5703084468841553
----------------------check_connections_block total spend ----------------------------- 3.3620245456695557
generate_one_block  0.711158037185669
generate_one_block  0.7028789520263672
generate_one_block  0.6983466148376465
generate_one_block  0.727184534072876
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03690457344055176
gen group dst list time:  0.024603843688964844
time for parepare:  0.019610881805419922
local_output_nid generation:  0.02826213836669922
local_in_edges_tensor generation:  0.04824948310852051
mini_batch_src_global generation:  0.04594707489013672
r_  generation:  0.517061710357666
local_output_nid generation:  0.03573012351989746
local_in_edges_tensor generation:  0.04988884925842285
mini_batch_src_global generation:  0.05751824378967285
r_  generation:  0.5167491436004639
local_output_nid generation:  0.0368807315826416
local_in_edges_tensor generation:  0.03740739822387695
mini_batch_src_global generation:  0.05826711654663086
r_  generation:  0.5262258052825928
local_output_nid generation:  0.03702712059020996
local_in_edges_tensor generation:  0.04189944267272949
mini_batch_src_global generation:  0.058255672454833984
r_  generation:  0.5202786922454834
----------------------check_connections_block total spend ----------------------------- 3.102710247039795
generate_one_block  0.656205415725708
generate_one_block  0.6552190780639648
generate_one_block  0.6484429836273193
generate_one_block  0.6564784049987793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.23933124542236328  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

connection checking time:  12.283504009246826
block generation total time  10.47580862045288
average batch blocks generation time:  2.61895215511322
block dataloader generation time/epoch 25.140751838684082
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.13471460342407227  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

torch.Size([167464, 128])
torch.Size([166901, 32])
torch.Size([164935, 32])
torch.Size([155158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.47298097610473633  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.13466358184814453  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

torch.Size([167450, 128])
torch.Size([166892, 32])
torch.Size([164911, 32])
torch.Size([155058, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.47305822372436523  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.13460159301757812  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

torch.Size([167410, 128])
torch.Size([166797, 32])
torch.Size([164687, 32])
torch.Size([154743, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.4725608825683594  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.13472747802734375  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

torch.Size([167442, 128])
torch.Size([166882, 32])
torch.Size([164835, 32])
torch.Size([155016, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.47307920455932617  GigaBytes
Max Memory Allocated: 0.49509620666503906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05207628011703491 |0.04071676731109619 |0.005724132061004639 |0.00010138750076293945 |0.019903063774108887 |0.004877805709838867 |
----------------------------------------------------------pseudo_mini_loss sum 4.276586532592773
Total (block generation + training)time/epoch 25.66626477241516
Training time/epoch 0.5252611637115479
Training time without block to device /epoch 0.3623940944671631
Training time without total dataloading part /epoch 0.10779213905334473
load block tensor time/epoch 0.20830512046813965
block to device time/epoch 0.16286706924438477
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3022210
Number of first layer input nodes during this epoch:  669766
