Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648451979.878936
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026373624801635742
range selection method range initialization spend 0.013774633407592773
time for parepare:  0.017717599868774414
local_output_nid generation:  0.002646207809448242
local_in_edges_tensor generation:  0.004302024841308594
mini_batch_src_global generation:  0.0037534236907958984
r_  generation:  0.0424504280090332
local_output_nid generation:  0.003119945526123047
local_in_edges_tensor generation:  0.0016944408416748047
mini_batch_src_global generation:  0.0045893192291259766
r_  generation:  0.04318118095397949
local_output_nid generation:  0.003175497055053711
local_in_edges_tensor generation:  0.0016665458679199219
mini_batch_src_global generation:  0.003342866897583008
r_  generation:  0.0448918342590332
local_output_nid generation:  0.0031790733337402344
local_in_edges_tensor generation:  0.001668691635131836
mini_batch_src_global generation:  0.0033795833587646484
r_  generation:  0.046131134033203125
local_output_nid generation:  0.00311279296875
local_in_edges_tensor generation:  0.001781463623046875
mini_batch_src_global generation:  0.0034568309783935547
r_  generation:  0.0464167594909668
local_output_nid generation:  0.0031995773315429688
local_in_edges_tensor generation:  0.0016906261444091797
mini_batch_src_global generation:  0.0036973953247070312
r_  generation:  0.047020673751831055
local_output_nid generation:  0.003125905990600586
local_in_edges_tensor generation:  0.0016849040985107422
mini_batch_src_global generation:  0.003702402114868164
r_  generation:  0.04693484306335449
local_output_nid generation:  0.0032072067260742188
local_in_edges_tensor generation:  0.0017061233520507812
mini_batch_src_global generation:  0.003767251968383789
r_  generation:  0.047774314880371094
----------------------check_connections_block total spend ----------------------------- 0.5297183990478516
generate_one_block  0.06099128723144531
generate_one_block  0.061141014099121094
generate_one_block  0.062242746353149414
generate_one_block  0.061693668365478516
generate_one_block  0.06381416320800781
generate_one_block  0.061720848083496094
generate_one_block  0.06194901466369629
generate_one_block  0.06236410140991211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0387272834777832
gen group dst list time:  0.016405582427978516
time for parepare:  0.019584178924560547
local_output_nid generation:  0.011096000671386719
local_in_edges_tensor generation:  0.0287325382232666
mini_batch_src_global generation:  0.030493497848510742
r_  generation:  0.31984472274780273
local_output_nid generation:  0.0178375244140625
local_in_edges_tensor generation:  0.028456687927246094
mini_batch_src_global generation:  0.03892064094543457
r_  generation:  0.3271346092224121
local_output_nid generation:  0.01878046989440918
local_in_edges_tensor generation:  0.024214506149291992
mini_batch_src_global generation:  0.038164377212524414
r_  generation:  0.3326106071472168
local_output_nid generation:  0.019027233123779297
local_in_edges_tensor generation:  0.027402162551879883
mini_batch_src_global generation:  0.03966164588928223
r_  generation:  0.3389253616333008
local_output_nid generation:  0.019419193267822266
local_in_edges_tensor generation:  0.01845836639404297
mini_batch_src_global generation:  0.03991389274597168
r_  generation:  0.33509373664855957
local_output_nid generation:  0.019563913345336914
local_in_edges_tensor generation:  0.01877617835998535
mini_batch_src_global generation:  0.04294323921203613
r_  generation:  0.3422238826751709
local_output_nid generation:  0.019784927368164062
local_in_edges_tensor generation:  0.024715185165405273
mini_batch_src_global generation:  0.040335893630981445
r_  generation:  0.3352241516113281
local_output_nid generation:  0.01982593536376953
local_in_edges_tensor generation:  0.02173638343811035
mini_batch_src_global generation:  0.04122328758239746
r_  generation:  0.3436582088470459
----------------------check_connections_block total spend ----------------------------- 3.9189274311065674
generate_one_block  0.44259047508239746
generate_one_block  0.42638349533081055
generate_one_block  0.4304683208465576
generate_one_block  0.4355134963989258
generate_one_block  0.427215576171875
generate_one_block  0.4532582759857178
generate_one_block  0.42348194122314453
generate_one_block  0.43286991119384766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03178095817565918
gen group dst list time:  0.0362238883972168
time for parepare:  0.019184589385986328
local_output_nid generation:  0.025258541107177734
local_in_edges_tensor generation:  0.04112958908081055
mini_batch_src_global generation:  0.04310798645019531
r_  generation:  0.47118425369262695
local_output_nid generation:  0.03272294998168945
local_in_edges_tensor generation:  0.048117876052856445
mini_batch_src_global generation:  0.05708646774291992
r_  generation:  0.4750957489013672
local_output_nid generation:  0.032964468002319336
local_in_edges_tensor generation:  0.04004859924316406
mini_batch_src_global generation:  0.050534963607788086
r_  generation:  0.4922025203704834
local_output_nid generation:  0.03338003158569336
local_in_edges_tensor generation:  0.044264793395996094
mini_batch_src_global generation:  0.0537872314453125
r_  generation:  0.4843447208404541
local_output_nid generation:  0.033811330795288086
local_in_edges_tensor generation:  0.03553581237792969
mini_batch_src_global generation:  0.05263257026672363
r_  generation:  0.49675750732421875
local_output_nid generation:  0.03410816192626953
local_in_edges_tensor generation:  0.032541513442993164
mini_batch_src_global generation:  0.054805755615234375
r_  generation:  0.49182939529418945
local_output_nid generation:  0.03400278091430664
local_in_edges_tensor generation:  0.03151559829711914
mini_batch_src_global generation:  0.05320000648498535
r_  generation:  0.4969315528869629
local_output_nid generation:  0.03412675857543945
local_in_edges_tensor generation:  0.03239011764526367
mini_batch_src_global generation:  0.055149078369140625
r_  generation:  0.4877185821533203
----------------------check_connections_block total spend ----------------------------- 5.750897169113159
generate_one_block  0.604769229888916
generate_one_block  0.6197249889373779
generate_one_block  0.6175756454467773
generate_one_block  0.6213452816009521
generate_one_block  0.6178088188171387
generate_one_block  0.5990614891052246
generate_one_block  0.6238582134246826
generate_one_block  0.5985054969787598
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.669824600219727
block generation total time  8.374430656433105
average batch blocks generation time:  1.0468038320541382
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.0980677604675293  GigaBytes
Max Memory Allocated: 0.0980677604675293  GigaBytes

torch.Size([160893, 128])
torch.Size([142836, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.9352340698242188  GigaBytes
Max Memory Allocated: 1.000967025756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.10070610046386719  GigaBytes
Max Memory Allocated: 1.0754566192626953  GigaBytes

torch.Size([161100, 128])
torch.Size([143169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8143310546875 GB
    Memory Allocated: 0.9341554641723633  GigaBytes
Max Memory Allocated: 1.0754566192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10104036331176758  GigaBytes
Max Memory Allocated: 1.0754566192626953  GigaBytes

torch.Size([160964, 128])
torch.Size([143032, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9375481605529785  GigaBytes
Max Memory Allocated: 1.0754566192626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10017013549804688  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

torch.Size([161019, 128])
torch.Size([143081, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9355149269104004  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10080194473266602  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

torch.Size([161085, 128])
torch.Size([143215, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9343562126159668  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10090065002441406  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

torch.Size([160618, 128])
torch.Size([142749, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.935645580291748  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10064411163330078  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

torch.Size([160840, 128])
torch.Size([142771, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.935246467590332  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10093545913696289  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

torch.Size([160838, 128])
torch.Size([142861, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.9353528022766113  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0646631121635437 |0.04752194881439209 |0.09837716817855835 |0.00010591745376586914 |0.01682618260383606 |0.0019478797912597656 |
----------------------------------------------------------pseudo_mini_loss sum 6.234954833984375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3020101
Number of first layer input nodes during this epoch:  1287357
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.13335323333740234  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024108409881591797
range selection method range initialization spend 0.011520862579345703
time for parepare:  0.016320228576660156
local_output_nid generation:  0.002622842788696289
local_in_edges_tensor generation:  0.009058952331542969
mini_batch_src_global generation:  0.00437164306640625
r_  generation:  0.04677915573120117
local_output_nid generation:  0.003702878952026367
local_in_edges_tensor generation:  0.0018720626831054688
mini_batch_src_global generation:  0.0050508975982666016
r_  generation:  0.04462909698486328
local_output_nid generation:  0.003823995590209961
local_in_edges_tensor generation:  0.0019266605377197266
mini_batch_src_global generation:  0.0033545494079589844
r_  generation:  0.045313119888305664
local_output_nid generation:  0.003942251205444336
local_in_edges_tensor generation:  0.0019328594207763672
mini_batch_src_global generation:  0.0033707618713378906
r_  generation:  0.04605293273925781
local_output_nid generation:  0.003831624984741211
local_in_edges_tensor generation:  0.0018534660339355469
mini_batch_src_global generation:  0.003621339797973633
r_  generation:  0.04748678207397461
local_output_nid generation:  0.003852367401123047
local_in_edges_tensor generation:  0.0019257068634033203
mini_batch_src_global generation:  0.0038139820098876953
r_  generation:  0.04801011085510254
local_output_nid generation:  0.0037636756896972656
local_in_edges_tensor generation:  0.0018520355224609375
mini_batch_src_global generation:  0.0039103031158447266
r_  generation:  0.0489501953125
local_output_nid generation:  0.0039081573486328125
local_in_edges_tensor generation:  0.0018661022186279297
mini_batch_src_global generation:  0.0038347244262695312
r_  generation:  0.048204898834228516
----------------------check_connections_block total spend ----------------------------- 0.5622727870941162
generate_one_block  0.0753631591796875
generate_one_block  0.07039189338684082
generate_one_block  0.064300537109375
generate_one_block  0.06189680099487305
generate_one_block  0.0620570182800293
generate_one_block  0.07549476623535156
generate_one_block  0.06810593605041504
generate_one_block  0.06401896476745605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04053378105163574
gen group dst list time:  0.017438173294067383
time for parepare:  0.02031564712524414
local_output_nid generation:  0.012845516204833984
local_in_edges_tensor generation:  0.03731203079223633
mini_batch_src_global generation:  0.03192615509033203
r_  generation:  0.3220229148864746
local_output_nid generation:  0.021588802337646484
local_in_edges_tensor generation:  0.03341937065124512
mini_batch_src_global generation:  0.038986921310424805
r_  generation:  0.33406615257263184
local_output_nid generation:  0.024456262588500977
local_in_edges_tensor generation:  0.02737116813659668
mini_batch_src_global generation:  0.037955522537231445
r_  generation:  0.34238457679748535
local_output_nid generation:  0.022462129592895508
local_in_edges_tensor generation:  0.024692296981811523
mini_batch_src_global generation:  0.05379462242126465
r_  generation:  0.3349788188934326
local_output_nid generation:  0.022675514221191406
local_in_edges_tensor generation:  0.024404287338256836
mini_batch_src_global generation:  0.042571306228637695
r_  generation:  0.42096853256225586
local_output_nid generation:  0.031420230865478516
local_in_edges_tensor generation:  0.04893922805786133
mini_batch_src_global generation:  0.06656146049499512
r_  generation:  0.3685603141784668
local_output_nid generation:  0.021558046340942383
local_in_edges_tensor generation:  0.030696630477905273
mini_batch_src_global generation:  0.0628519058227539
r_  generation:  0.34480977058410645
local_output_nid generation:  0.021204233169555664
local_in_edges_tensor generation:  0.02185511589050293
mini_batch_src_global generation:  0.04987692832946777
r_  generation:  0.36557793617248535
----------------------check_connections_block total spend ----------------------------- 4.278540372848511
generate_one_block  0.45572757720947266
generate_one_block  0.4528214931488037
generate_one_block  0.4465341567993164
generate_one_block  0.43897366523742676
generate_one_block  0.4481618404388428
generate_one_block  0.4321928024291992
generate_one_block  0.4412088394165039
generate_one_block  0.4733090400695801
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.033333539962768555
gen group dst list time:  0.03762412071228027
time for parepare:  0.019329309463500977
local_output_nid generation:  0.025259971618652344
local_in_edges_tensor generation:  0.05714678764343262
mini_batch_src_global generation:  0.04381537437438965
r_  generation:  0.4782078266143799
local_output_nid generation:  0.03209853172302246
local_in_edges_tensor generation:  0.04747629165649414
mini_batch_src_global generation:  0.05432891845703125
r_  generation:  0.49329519271850586
local_output_nid generation:  0.03274846076965332
local_in_edges_tensor generation:  0.03571581840515137
mini_batch_src_global generation:  0.051271915435791016
r_  generation:  0.4972200393676758
local_output_nid generation:  0.03296971321105957
local_in_edges_tensor generation:  0.03515148162841797
mini_batch_src_global generation:  0.05798077583312988
r_  generation:  0.49478936195373535
local_output_nid generation:  0.03490805625915527
local_in_edges_tensor generation:  0.05000138282775879
mini_batch_src_global generation:  0.052901268005371094
r_  generation:  0.5245766639709473
local_output_nid generation:  0.03705143928527832
local_in_edges_tensor generation:  0.04025149345397949
mini_batch_src_global generation:  0.06603741645812988
r_  generation:  0.49236297607421875
local_output_nid generation:  0.0349431037902832
local_in_edges_tensor generation:  0.037610769271850586
mini_batch_src_global generation:  0.054173946380615234
r_  generation:  0.5064795017242432
local_output_nid generation:  0.03458523750305176
local_in_edges_tensor generation:  0.04387474060058594
mini_batch_src_global generation:  0.06283831596374512
r_  generation:  0.5422253608703613
----------------------check_connections_block total spend ----------------------------- 6.039819240570068
generate_one_block  0.6116528511047363
generate_one_block  0.6157259941101074
generate_one_block  0.6347918510437012
generate_one_block  0.6441965103149414
generate_one_block  0.6354281902313232
generate_one_block  0.6228725910186768
generate_one_block  0.6343908309936523
generate_one_block  0.6273941993713379
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.13335323333740234  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

connection checking time:  10.318359613418579
block generation total time  8.615382432937622
average batch blocks generation time:  1.0769228041172028
block dataloader generation time/epoch 21.0299174785614
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9510498046875 GB
    Memory Allocated: 0.10257101058959961  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

torch.Size([160881, 128])
torch.Size([142837, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9394307136535645  GigaBytes
Max Memory Allocated: 1.078010082244873  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10169363021850586  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([160770, 128])
torch.Size([142748, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9370942115783691  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10233306884765625  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([160894, 128])
torch.Size([142868, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9363207817077637  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10241413116455078  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([160855, 128])
torch.Size([142516, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9322700500488281  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.10285806655883789  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([161198, 128])
torch.Size([143411, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5076904296875 GB
    Memory Allocated: 0.9384970664978027  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10222721099853516  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([160644, 128])
torch.Size([142414, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9353508949279785  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10273361206054688  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([161033, 128])
torch.Size([143094, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9393997192382812  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.10169839859008789  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

torch.Size([160768, 128])
torch.Size([142711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6483154296875 GB
    Memory Allocated: 0.9369730949401855  GigaBytes
Max Memory Allocated: 1.0800509452819824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07520046830177307 |0.01913437247276306 |0.003835052251815796 |9.202957153320312e-05 |0.008167028427124023 |0.0020465850830078125 |
----------------------------------------------------------pseudo_mini_loss sum 3.232670307159424
Total (block generation + training)time/epoch 21.958782196044922
Training time/epoch 0.9286520481109619
Training time without block to device /epoch 0.7755770683288574
Training time without total dataloading part /epoch 0.09879946708679199
load block tensor time/epoch 0.6016037464141846
block to device time/epoch 0.1530749797821045
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019017
Number of first layer input nodes during this epoch:  1287043
