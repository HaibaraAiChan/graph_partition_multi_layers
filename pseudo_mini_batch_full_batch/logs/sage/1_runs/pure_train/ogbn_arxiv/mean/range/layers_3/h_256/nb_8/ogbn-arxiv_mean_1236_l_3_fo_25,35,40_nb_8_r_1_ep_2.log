Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648451519.3295202
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025009632110595703
range selection method range initialization spend 0.013428449630737305
time for parepare:  0.01756453514099121
local_output_nid generation:  0.002625703811645508
local_in_edges_tensor generation:  0.00439453125
mini_batch_src_global generation:  0.003255605697631836
r_  generation:  0.03680133819580078
local_output_nid generation:  0.002944469451904297
local_in_edges_tensor generation:  0.0016298294067382812
mini_batch_src_global generation:  0.003912687301635742
r_  generation:  0.037894487380981445
local_output_nid generation:  0.003108501434326172
local_in_edges_tensor generation:  0.0016341209411621094
mini_batch_src_global generation:  0.0027434825897216797
r_  generation:  0.0389714241027832
local_output_nid generation:  0.0031876564025878906
local_in_edges_tensor generation:  0.0016257762908935547
mini_batch_src_global generation:  0.0027921199798583984
r_  generation:  0.039481163024902344
local_output_nid generation:  0.003164529800415039
local_in_edges_tensor generation:  0.0016224384307861328
mini_batch_src_global generation:  0.002951383590698242
r_  generation:  0.04104304313659668
local_output_nid generation:  0.0032014846801757812
local_in_edges_tensor generation:  0.0016012191772460938
mini_batch_src_global generation:  0.0032465457916259766
r_  generation:  0.0415647029876709
local_output_nid generation:  0.003166675567626953
local_in_edges_tensor generation:  0.0016179084777832031
mini_batch_src_global generation:  0.0030570030212402344
r_  generation:  0.041140079498291016
local_output_nid generation:  0.0031900405883789062
local_in_edges_tensor generation:  0.0016510486602783203
mini_batch_src_global generation:  0.0031626224517822266
r_  generation:  0.04074740409851074
----------------------check_connections_block total spend ----------------------------- 0.46709632873535156
generate_one_block  0.05425691604614258
generate_one_block  0.05411672592163086
generate_one_block  0.05456948280334473
generate_one_block  0.05430436134338379
generate_one_block  0.05628538131713867
generate_one_block  0.055049896240234375
generate_one_block  0.054322242736816406
generate_one_block  0.056722402572631836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04057478904724121
gen group dst list time:  0.015259742736816406
time for parepare:  0.01958489418029785
local_output_nid generation:  0.010712623596191406
local_in_edges_tensor generation:  0.030840635299682617
mini_batch_src_global generation:  0.02700638771057129
r_  generation:  0.2883322238922119
local_output_nid generation:  0.015413999557495117
local_in_edges_tensor generation:  0.026967287063598633
mini_batch_src_global generation:  0.034639835357666016
r_  generation:  0.29282522201538086
local_output_nid generation:  0.015756607055664062
local_in_edges_tensor generation:  0.02269601821899414
mini_batch_src_global generation:  0.03437638282775879
r_  generation:  0.3046684265136719
local_output_nid generation:  0.016112565994262695
local_in_edges_tensor generation:  0.01811695098876953
mini_batch_src_global generation:  0.038091421127319336
r_  generation:  0.3053476810455322
local_output_nid generation:  0.016325950622558594
local_in_edges_tensor generation:  0.017614126205444336
mini_batch_src_global generation:  0.03624558448791504
r_  generation:  0.3017444610595703
local_output_nid generation:  0.016613245010375977
local_in_edges_tensor generation:  0.02260589599609375
mini_batch_src_global generation:  0.037752389907836914
r_  generation:  0.31159281730651855
local_output_nid generation:  0.016613245010375977
local_in_edges_tensor generation:  0.020117759704589844
mini_batch_src_global generation:  0.03683328628540039
r_  generation:  0.3083062171936035
local_output_nid generation:  0.01648998260498047
local_in_edges_tensor generation:  0.020721912384033203
mini_batch_src_global generation:  0.03699183464050293
r_  generation:  0.30715394020080566
----------------------check_connections_block total spend ----------------------------- 3.545893430709839
generate_one_block  0.39925217628479004
generate_one_block  0.3897573947906494
generate_one_block  0.3934488296508789
generate_one_block  0.3948955535888672
generate_one_block  0.38540124893188477
generate_one_block  0.41254615783691406
generate_one_block  0.3922550678253174
generate_one_block  0.39266014099121094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032987117767333984
gen group dst list time:  0.0356595516204834
time for parepare:  0.01869368553161621
local_output_nid generation:  0.024549007415771484
local_in_edges_tensor generation:  0.03679800033569336
mini_batch_src_global generation:  0.04574251174926758
r_  generation:  0.46565723419189453
local_output_nid generation:  0.03152918815612793
local_in_edges_tensor generation:  0.04951000213623047
mini_batch_src_global generation:  0.05351710319519043
r_  generation:  0.4746849536895752
local_output_nid generation:  0.03221774101257324
local_in_edges_tensor generation:  0.042482614517211914
mini_batch_src_global generation:  0.05025196075439453
r_  generation:  0.4863424301147461
local_output_nid generation:  0.032599449157714844
local_in_edges_tensor generation:  0.037986040115356445
mini_batch_src_global generation:  0.05407309532165527
r_  generation:  0.48039674758911133
local_output_nid generation:  0.0325777530670166
local_in_edges_tensor generation:  0.03579854965209961
mini_batch_src_global generation:  0.05291604995727539
r_  generation:  0.49694061279296875
local_output_nid generation:  0.032669782638549805
local_in_edges_tensor generation:  0.0420992374420166
mini_batch_src_global generation:  0.05494332313537598
r_  generation:  0.48227953910827637
local_output_nid generation:  0.032996416091918945
local_in_edges_tensor generation:  0.04583573341369629
mini_batch_src_global generation:  0.05296802520751953
r_  generation:  0.4993278980255127
local_output_nid generation:  0.03268599510192871
local_in_edges_tensor generation:  0.03405904769897461
mini_batch_src_global generation:  0.05487060546875
r_  generation:  0.4830155372619629
----------------------check_connections_block total spend ----------------------------- 5.731448173522949
generate_one_block  0.6014902591705322
generate_one_block  0.6170072555541992
generate_one_block  0.6105191707611084
generate_one_block  0.5984363555908203
generate_one_block  0.6070668697357178
generate_one_block  0.614771842956543
generate_one_block  0.631511926651001
generate_one_block  0.5976355075836182
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  9.277341604232788
block generation total time  8.038655757904053
average batch blocks generation time:  1.0048319697380066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09640836715698242  GigaBytes
Max Memory Allocated: 0.09640836715698242  GigaBytes

torch.Size([160381, 128])
torch.Size([141112, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9015727043151855  GigaBytes
Max Memory Allocated: 0.962338924407959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 0.09945535659790039  GigaBytes
Max Memory Allocated: 1.0310297012329102  GigaBytes

torch.Size([160656, 128])
torch.Size([141389, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3787841796875 GB
    Memory Allocated: 0.9013156890869141  GigaBytes
Max Memory Allocated: 1.0310297012329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09968948364257812  GigaBytes
Max Memory Allocated: 1.0310297012329102  GigaBytes

torch.Size([160526, 128])
torch.Size([141305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9035224914550781  GigaBytes
Max Memory Allocated: 1.0310297012329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09952974319458008  GigaBytes
Max Memory Allocated: 1.0331168174743652  GigaBytes

torch.Size([160564, 128])
torch.Size([141187, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9016509056091309  GigaBytes
Max Memory Allocated: 1.0331168174743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09945297241210938  GigaBytes
Max Memory Allocated: 1.0331168174743652  GigaBytes

torch.Size([160609, 128])
torch.Size([141273, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9006943702697754  GigaBytes
Max Memory Allocated: 1.0331168174743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09975242614746094  GigaBytes
Max Memory Allocated: 1.0331168174743652  GigaBytes

torch.Size([160313, 128])
torch.Size([141326, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9048910140991211  GigaBytes
Max Memory Allocated: 1.0331168174743652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09966659545898438  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160368, 128])
torch.Size([141034, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9006867408752441  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.09947586059570312  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160421, 128])
torch.Size([141062, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.901191234588623  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07012903690338135 |0.046631306409835815 |0.09928464889526367 |0.00010889768600463867 |0.01378592848777771 |0.0018911361694335938 |
----------------------------------------------------------pseudo_mini_loss sum 6.203315258026123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2956691
Number of first layer input nodes during this epoch:  1283838
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.12965154647827148  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.058060407638549805
range selection method range initialization spend 0.011148214340209961
time for parepare:  0.017229795455932617
local_output_nid generation:  0.002753019332885742
local_in_edges_tensor generation:  0.004518985748291016
mini_batch_src_global generation:  0.0032379627227783203
r_  generation:  0.03799867630004883
local_output_nid generation:  0.0029180049896240234
local_in_edges_tensor generation:  0.001561880111694336
mini_batch_src_global generation:  0.004111766815185547
r_  generation:  0.03816986083984375
local_output_nid generation:  0.003084421157836914
local_in_edges_tensor generation:  0.0016472339630126953
mini_batch_src_global generation:  0.0027000904083251953
r_  generation:  0.03882575035095215
local_output_nid generation:  0.003145456314086914
local_in_edges_tensor generation:  0.0015766620635986328
mini_batch_src_global generation:  0.002831697463989258
r_  generation:  0.0381009578704834
local_output_nid generation:  0.003073453903198242
local_in_edges_tensor generation:  0.0015990734100341797
mini_batch_src_global generation:  0.0029757022857666016
r_  generation:  0.04149484634399414
local_output_nid generation:  0.0033283233642578125
local_in_edges_tensor generation:  0.002247333526611328
mini_batch_src_global generation:  0.005752086639404297
r_  generation:  0.046105384826660156
local_output_nid generation:  0.0033676624298095703
local_in_edges_tensor generation:  0.0021162033081054688
mini_batch_src_global generation:  0.003203868865966797
r_  generation:  0.041506052017211914
local_output_nid generation:  0.0034444332122802734
local_in_edges_tensor generation:  0.0019216537475585938
mini_batch_src_global generation:  0.0032231807708740234
r_  generation:  0.040677547454833984
----------------------check_connections_block total spend ----------------------------- 0.49065279960632324
generate_one_block  0.05388951301574707
generate_one_block  0.05443572998046875
generate_one_block  0.054119110107421875
generate_one_block  0.05443549156188965
generate_one_block  0.05486011505126953
generate_one_block  0.05591869354248047
generate_one_block  0.05909442901611328
generate_one_block  0.05667448043823242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05980801582336426
gen group dst list time:  0.01514434814453125
time for parepare:  0.021087646484375
local_output_nid generation:  0.010331392288208008
local_in_edges_tensor generation:  0.045696258544921875
mini_batch_src_global generation:  0.03049778938293457
r_  generation:  0.286470890045166
local_output_nid generation:  0.015687942504882812
local_in_edges_tensor generation:  0.028052091598510742
mini_batch_src_global generation:  0.03546404838562012
r_  generation:  0.2961266040802002
local_output_nid generation:  0.01568007469177246
local_in_edges_tensor generation:  0.02283787727355957
mini_batch_src_global generation:  0.034700632095336914
r_  generation:  0.2963597774505615
local_output_nid generation:  0.015740394592285156
local_in_edges_tensor generation:  0.017549753189086914
mini_batch_src_global generation:  0.035093069076538086
r_  generation:  0.2992854118347168
local_output_nid generation:  0.01656818389892578
local_in_edges_tensor generation:  0.026792526245117188
mini_batch_src_global generation:  0.037020206451416016
r_  generation:  0.3102438449859619
local_output_nid generation:  0.016455411911010742
local_in_edges_tensor generation:  0.023653268814086914
mini_batch_src_global generation:  0.03717660903930664
r_  generation:  0.3072836399078369
local_output_nid generation:  0.01667928695678711
local_in_edges_tensor generation:  0.02116870880126953
mini_batch_src_global generation:  0.03934979438781738
r_  generation:  0.31177806854248047
local_output_nid generation:  0.01655888557434082
local_in_edges_tensor generation:  0.021469593048095703
mini_batch_src_global generation:  0.037427425384521484
r_  generation:  0.31087565422058105
----------------------check_connections_block total spend ----------------------------- 3.5852460861206055
generate_one_block  0.40703845024108887
generate_one_block  0.4030473232269287
generate_one_block  0.39570045471191406
generate_one_block  0.39284777641296387
generate_one_block  0.4168705940246582
generate_one_block  0.3972156047821045
generate_one_block  0.4020822048187256
generate_one_block  0.4483966827392578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06440353393554688
gen group dst list time:  0.03723478317260742
time for parepare:  0.020158767700195312
local_output_nid generation:  0.025478839874267578
local_in_edges_tensor generation:  0.04643416404724121
mini_batch_src_global generation:  0.06360173225402832
r_  generation:  0.47440075874328613
local_output_nid generation:  0.03213977813720703
local_in_edges_tensor generation:  0.04866814613342285
mini_batch_src_global generation:  0.05360531806945801
r_  generation:  0.4821484088897705
local_output_nid generation:  0.033150434494018555
local_in_edges_tensor generation:  0.03646969795227051
mini_batch_src_global generation:  0.05102252960205078
r_  generation:  0.49721360206604004
local_output_nid generation:  0.03352952003479004
local_in_edges_tensor generation:  0.037047624588012695
mini_batch_src_global generation:  0.05429220199584961
r_  generation:  0.49357008934020996
local_output_nid generation:  0.03334522247314453
local_in_edges_tensor generation:  0.04715371131896973
mini_batch_src_global generation:  0.05831122398376465
r_  generation:  0.5210742950439453
local_output_nid generation:  0.03604292869567871
local_in_edges_tensor generation:  0.04120349884033203
mini_batch_src_global generation:  0.06129860877990723
r_  generation:  0.4877622127532959
local_output_nid generation:  0.03592705726623535
local_in_edges_tensor generation:  0.04464912414550781
mini_batch_src_global generation:  0.052896976470947266
r_  generation:  0.5024034976959229
local_output_nid generation:  0.03490877151489258
local_in_edges_tensor generation:  0.04111456871032715
mini_batch_src_global generation:  0.05515336990356445
r_  generation:  0.49026989936828613
----------------------check_connections_block total spend ----------------------------- 5.887477397918701
generate_one_block  0.6327793598175049
generate_one_block  0.6157538890838623
generate_one_block  0.6078305244445801
generate_one_block  0.6200728416442871
generate_one_block  0.6137740612030029
generate_one_block  0.6052954196929932
generate_one_block  0.6358180046081543
generate_one_block  0.606931209564209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.12965154647827148  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

connection checking time:  9.472723484039307
block generation total time  8.201454401016235
average batch blocks generation time:  1.0251818001270294
block dataloader generation time/epoch 19.701093435287476
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.10130596160888672  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160518, 128])
torch.Size([141202, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5194091796875 GB
    Memory Allocated: 0.9044694900512695  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10108613967895508  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160360, 128])
torch.Size([141008, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9037199020385742  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10108089447021484  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160505, 128])
torch.Size([141043, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022402763366699  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10118293762207031  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160384, 128])
torch.Size([140867, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.899540901184082  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10140609741210938  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

torch.Size([160723, 128])
torch.Size([141590, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9062819480895996  GigaBytes
Max Memory Allocated: 1.0345878601074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10096931457519531  GigaBytes
Max Memory Allocated: 1.035510540008545  GigaBytes

torch.Size([160281, 128])
torch.Size([140721, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9022316932678223  GigaBytes
Max Memory Allocated: 1.035510540008545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10139799118041992  GigaBytes
Max Memory Allocated: 1.035510540008545  GigaBytes

torch.Size([160557, 128])
torch.Size([141379, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9065065383911133  GigaBytes
Max Memory Allocated: 1.035510540008545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.10128498077392578  GigaBytes
Max Memory Allocated: 1.0357298851013184  GigaBytes

torch.Size([160358, 128])
torch.Size([141105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5213623046875 GB
    Memory Allocated: 0.9033169746398926  GigaBytes
Max Memory Allocated: 1.0357298851013184  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07711973786354065 |0.01788860559463501 |0.003922969102859497 |9.85562801361084e-05 |0.00847691297531128 |0.0017440319061279297 |
----------------------------------------------------------pseudo_mini_loss sum 3.245656967163086
Total (block generation + training)time/epoch 20.632367610931396
Training time/epoch 0.9309773445129395
Training time without block to device /epoch 0.7878684997558594
Training time without total dataloading part /epoch 0.10173153877258301
load block tensor time/epoch 0.6169579029083252
block to device time/epoch 0.14310884475708008
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2955086
Number of first layer input nodes during this epoch:  1283686
