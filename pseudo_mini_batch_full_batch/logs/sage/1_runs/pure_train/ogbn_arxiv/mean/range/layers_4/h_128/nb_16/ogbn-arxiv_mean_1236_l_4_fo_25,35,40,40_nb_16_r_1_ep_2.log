Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648483171.525999
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024316072463989258
range selection method range initialization spend 0.013270378112792969
time for parepare:  0.017760515213012695
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0039250850677490234
mini_batch_src_global generation:  0.0017838478088378906
r_  generation:  0.018413543701171875
local_output_nid generation:  0.0013914108276367188
local_in_edges_tensor generation:  0.0009152889251708984
mini_batch_src_global generation:  0.0021948814392089844
r_  generation:  0.018334150314331055
local_output_nid generation:  0.0014238357543945312
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.001367807388305664
r_  generation:  0.017492294311523438
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0012614727020263672
r_  generation:  0.01740241050720215
local_output_nid generation:  0.001474618911743164
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.001440286636352539
r_  generation:  0.017888307571411133
local_output_nid generation:  0.0014715194702148438
local_in_edges_tensor generation:  0.0008146762847900391
mini_batch_src_global generation:  0.0013022422790527344
r_  generation:  0.01791524887084961
local_output_nid generation:  0.0014548301696777344
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0014226436614990234
r_  generation:  0.018570423126220703
local_output_nid generation:  0.0014679431915283203
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.0013039112091064453
r_  generation:  0.018246173858642578
local_output_nid generation:  0.0014615058898925781
local_in_edges_tensor generation:  0.0008034706115722656
mini_batch_src_global generation:  0.001432180404663086
r_  generation:  0.018220186233520508
local_output_nid generation:  0.0014545917510986328
local_in_edges_tensor generation:  0.0008115768432617188
mini_batch_src_global generation:  0.0013856887817382812
r_  generation:  0.018398523330688477
local_output_nid generation:  0.0014526844024658203
local_in_edges_tensor generation:  0.0008051395416259766
mini_batch_src_global generation:  0.0015156269073486328
r_  generation:  0.01943802833557129
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0014176368713378906
r_  generation:  0.019524574279785156
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0008084774017333984
mini_batch_src_global generation:  0.0015468597412109375
r_  generation:  0.018908262252807617
local_output_nid generation:  0.001466512680053711
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.0015506744384765625
r_  generation:  0.019112586975097656
local_output_nid generation:  0.0015368461608886719
local_in_edges_tensor generation:  0.0008599758148193359
mini_batch_src_global generation:  0.0014362335205078125
r_  generation:  0.0189208984375
local_output_nid generation:  0.001483917236328125
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.0015718936920166016
r_  generation:  0.0187990665435791
----------------------check_connections_block total spend ----------------------------- 0.44356298446655273
generate_one_block  0.02700018882751465
generate_one_block  0.028833389282226562
generate_one_block  0.02937173843383789
generate_one_block  0.02702164649963379
generate_one_block  0.02758932113647461
generate_one_block  0.027968168258666992
generate_one_block  0.027448654174804688
generate_one_block  0.0270538330078125
generate_one_block  0.02738499641418457
generate_one_block  0.027335643768310547
generate_one_block  0.028004169464111328
generate_one_block  0.028021574020385742
generate_one_block  0.02739715576171875
generate_one_block  0.027300596237182617
generate_one_block  0.027721643447875977
generate_one_block  0.027315855026245117
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04198050498962402
gen group dst list time:  0.01875901222229004
time for parepare:  0.018944263458251953
local_output_nid generation:  0.006559610366821289
local_in_edges_tensor generation:  0.01616382598876953
mini_batch_src_global generation:  0.019432544708251953
r_  generation:  0.19992804527282715
local_output_nid generation:  0.010274410247802734
local_in_edges_tensor generation:  0.018707990646362305
mini_batch_src_global generation:  0.027109384536743164
r_  generation:  0.21171951293945312
local_output_nid generation:  0.010320663452148438
local_in_edges_tensor generation:  0.012942314147949219
mini_batch_src_global generation:  0.024116039276123047
r_  generation:  0.21427035331726074
local_output_nid generation:  0.010383129119873047
local_in_edges_tensor generation:  0.017039060592651367
mini_batch_src_global generation:  0.024912118911743164
r_  generation:  0.2148270606994629
local_output_nid generation:  0.010866403579711914
local_in_edges_tensor generation:  0.01357889175415039
mini_batch_src_global generation:  0.028716087341308594
r_  generation:  0.22179698944091797
local_output_nid generation:  0.011003732681274414
local_in_edges_tensor generation:  0.015502691268920898
mini_batch_src_global generation:  0.0295107364654541
r_  generation:  0.22495627403259277
local_output_nid generation:  0.011707544326782227
local_in_edges_tensor generation:  0.014293670654296875
mini_batch_src_global generation:  0.0426023006439209
r_  generation:  0.22762084007263184
local_output_nid generation:  0.013274431228637695
local_in_edges_tensor generation:  0.028065204620361328
mini_batch_src_global generation:  0.03180217742919922
r_  generation:  0.21782994270324707
local_output_nid generation:  0.011386871337890625
local_in_edges_tensor generation:  0.013883829116821289
mini_batch_src_global generation:  0.026536226272583008
r_  generation:  0.21519827842712402
local_output_nid generation:  0.011370182037353516
local_in_edges_tensor generation:  0.013104438781738281
mini_batch_src_global generation:  0.026722431182861328
r_  generation:  0.21514439582824707
local_output_nid generation:  0.011703252792358398
local_in_edges_tensor generation:  0.015360832214355469
mini_batch_src_global generation:  0.027583837509155273
r_  generation:  0.22136712074279785
local_output_nid generation:  0.011696815490722656
local_in_edges_tensor generation:  0.019072294235229492
mini_batch_src_global generation:  0.027482271194458008
r_  generation:  0.2231769561767578
local_output_nid generation:  0.011590957641601562
local_in_edges_tensor generation:  0.011930227279663086
mini_batch_src_global generation:  0.02717900276184082
r_  generation:  0.2185966968536377
local_output_nid generation:  0.011691808700561523
local_in_edges_tensor generation:  0.011553049087524414
mini_batch_src_global generation:  0.027100563049316406
r_  generation:  0.21867656707763672
local_output_nid generation:  0.011570215225219727
local_in_edges_tensor generation:  0.013583898544311523
mini_batch_src_global generation:  0.02662801742553711
r_  generation:  0.21470284461975098
local_output_nid generation:  0.011746883392333984
local_in_edges_tensor generation:  0.015409708023071289
mini_batch_src_global generation:  0.02730393409729004
r_  generation:  0.22047996520996094
----------------------check_connections_block total spend ----------------------------- 5.1412413120269775
generate_one_block  0.28473663330078125
generate_one_block  0.2879626750946045
generate_one_block  0.2814178466796875
generate_one_block  0.29820847511291504
generate_one_block  0.33167600631713867
generate_one_block  0.30788540840148926
generate_one_block  0.28676486015319824
generate_one_block  0.2929682731628418
generate_one_block  0.27428698539733887
generate_one_block  0.2773730754852295
generate_one_block  0.3128986358642578
generate_one_block  0.3045203685760498
generate_one_block  0.2811272144317627
generate_one_block  0.2801363468170166
generate_one_block  0.28449058532714844
generate_one_block  0.2852931022644043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.12761664390563965
gen group dst list time:  0.06658291816711426
time for parepare:  0.029384374618530273
local_output_nid generation:  0.023248672485351562
local_in_edges_tensor generation:  0.04683279991149902
mini_batch_src_global generation:  0.044872283935546875
r_  generation:  0.4899759292602539
local_output_nid generation:  0.03376913070678711
local_in_edges_tensor generation:  0.0553898811340332
mini_batch_src_global generation:  0.060074567794799805
r_  generation:  0.47855377197265625
local_output_nid generation:  0.030292034149169922
local_in_edges_tensor generation:  0.0409243106842041
mini_batch_src_global generation:  0.054860830307006836
r_  generation:  0.4844815731048584
local_output_nid generation:  0.0300900936126709
local_in_edges_tensor generation:  0.0339055061340332
mini_batch_src_global generation:  0.055831193923950195
r_  generation:  0.4847989082336426
local_output_nid generation:  0.03037738800048828
local_in_edges_tensor generation:  0.04088163375854492
mini_batch_src_global generation:  0.06659221649169922
r_  generation:  0.49566078186035156
local_output_nid generation:  0.032636404037475586
local_in_edges_tensor generation:  0.05630898475646973
mini_batch_src_global generation:  0.05819988250732422
r_  generation:  0.5129318237304688
local_output_nid generation:  0.033272743225097656
local_in_edges_tensor generation:  0.03847146034240723
mini_batch_src_global generation:  0.06336736679077148
r_  generation:  0.5036280155181885
local_output_nid generation:  0.030725479125976562
local_in_edges_tensor generation:  0.03582000732421875
mini_batch_src_global generation:  0.05723166465759277
r_  generation:  0.4925875663757324
local_output_nid generation:  0.0316319465637207
local_in_edges_tensor generation:  0.03890037536621094
mini_batch_src_global generation:  0.06841778755187988
r_  generation:  0.5083005428314209
local_output_nid generation:  0.033121347427368164
local_in_edges_tensor generation:  0.03558683395385742
mini_batch_src_global generation:  0.05796360969543457
r_  generation:  0.48821234703063965
local_output_nid generation:  0.031012296676635742
local_in_edges_tensor generation:  0.03808236122131348
mini_batch_src_global generation:  0.06697392463684082
r_  generation:  0.5038433074951172
local_output_nid generation:  0.03123617172241211
local_in_edges_tensor generation:  0.04315066337585449
mini_batch_src_global generation:  0.059456825256347656
r_  generation:  0.511925458908081
local_output_nid generation:  0.03436279296875
local_in_edges_tensor generation:  0.04058265686035156
mini_batch_src_global generation:  0.06299996376037598
r_  generation:  0.494889497756958
local_output_nid generation:  0.03141307830810547
local_in_edges_tensor generation:  0.03812885284423828
mini_batch_src_global generation:  0.05744743347167969
r_  generation:  0.4904303550720215
local_output_nid generation:  0.031154155731201172
local_in_edges_tensor generation:  0.029412269592285156
mini_batch_src_global generation:  0.05606532096862793
r_  generation:  0.492542028427124
local_output_nid generation:  0.03132796287536621
local_in_edges_tensor generation:  0.041769981384277344
mini_batch_src_global generation:  0.06048703193664551
r_  generation:  0.4877970218658447
----------------------check_connections_block total spend ----------------------------- 11.756701707839966
generate_one_block  0.6234951019287109
generate_one_block  0.6549887657165527
generate_one_block  0.6298339366912842
generate_one_block  0.6197891235351562
generate_one_block  0.6520838737487793
generate_one_block  0.6315467357635498
generate_one_block  0.6761677265167236
generate_one_block  0.6215574741363525
generate_one_block  0.615614652633667
generate_one_block  0.6216616630554199
generate_one_block  0.6430258750915527
generate_one_block  0.6251635551452637
generate_one_block  0.629558801651001
generate_one_block  0.6334645748138428
generate_one_block  0.6182560920715332
generate_one_block  0.6574854850769043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040288448333740234
gen group dst list time:  0.09001469612121582
time for parepare:  0.019117355346679688
local_output_nid generation:  0.03151345252990723
local_in_edges_tensor generation:  0.06626296043395996
mini_batch_src_global generation:  0.044623374938964844
r_  generation:  0.4877028465270996
local_output_nid generation:  0.03859591484069824
local_in_edges_tensor generation:  0.04224658012390137
mini_batch_src_global generation:  0.05582427978515625
r_  generation:  0.4900386333465576
local_output_nid generation:  0.0373075008392334
local_in_edges_tensor generation:  0.033634185791015625
mini_batch_src_global generation:  0.053179025650024414
r_  generation:  0.49960875511169434
local_output_nid generation:  0.037668466567993164
local_in_edges_tensor generation:  0.03636479377746582
mini_batch_src_global generation:  0.053829193115234375
r_  generation:  0.5022108554840088
local_output_nid generation:  0.038079261779785156
local_in_edges_tensor generation:  0.036379337310791016
mini_batch_src_global generation:  0.05353093147277832
r_  generation:  0.5093982219696045
local_output_nid generation:  0.03821063041687012
local_in_edges_tensor generation:  0.038280487060546875
mini_batch_src_global generation:  0.054251909255981445
r_  generation:  0.5063557624816895
local_output_nid generation:  0.049036264419555664
local_in_edges_tensor generation:  0.03441023826599121
mini_batch_src_global generation:  0.05411410331726074
r_  generation:  0.5154242515563965
local_output_nid generation:  0.03772997856140137
local_in_edges_tensor generation:  0.04295659065246582
mini_batch_src_global generation:  0.05477023124694824
r_  generation:  0.5097305774688721
local_output_nid generation:  0.03772115707397461
local_in_edges_tensor generation:  0.043411970138549805
mini_batch_src_global generation:  0.054685354232788086
r_  generation:  0.5133121013641357
local_output_nid generation:  0.03737807273864746
local_in_edges_tensor generation:  0.04291534423828125
mini_batch_src_global generation:  0.0548250675201416
r_  generation:  0.5107784271240234
local_output_nid generation:  0.03746747970581055
local_in_edges_tensor generation:  0.0385899543762207
mini_batch_src_global generation:  0.05828070640563965
r_  generation:  0.5259251594543457
local_output_nid generation:  0.037276506423950195
local_in_edges_tensor generation:  0.034346580505371094
mini_batch_src_global generation:  0.055913686752319336
r_  generation:  0.5141856670379639
local_output_nid generation:  0.03836369514465332
local_in_edges_tensor generation:  0.04130387306213379
mini_batch_src_global generation:  0.05568242073059082
r_  generation:  0.519345760345459
local_output_nid generation:  0.03975033760070801
local_in_edges_tensor generation:  0.046147823333740234
mini_batch_src_global generation:  0.05522012710571289
r_  generation:  0.5242331027984619
local_output_nid generation:  0.0380856990814209
local_in_edges_tensor generation:  0.04381561279296875
mini_batch_src_global generation:  0.06422185897827148
r_  generation:  0.5250799655914307
local_output_nid generation:  0.03956890106201172
local_in_edges_tensor generation:  0.044200897216796875
mini_batch_src_global generation:  0.056322336196899414
r_  generation:  0.5104258060455322
----------------------check_connections_block total spend ----------------------------- 12.238407611846924
generate_one_block  0.6222460269927979
generate_one_block  0.710883378982544
generate_one_block  0.6215879917144775
generate_one_block  0.6256237030029297
generate_one_block  0.6283082962036133
generate_one_block  0.6312539577484131
generate_one_block  0.6184031963348389
generate_one_block  0.6466248035430908
generate_one_block  0.6267929077148438
generate_one_block  0.6272501945495605
generate_one_block  0.6390507221221924
generate_one_block  0.6270081996917725
generate_one_block  0.6263420581817627
generate_one_block  0.6400716304779053
generate_one_block  0.6310720443725586
generate_one_block  0.6423852443695068
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0004115104675292969  GigaBytes
Max Memory Allocated: 0.0004115104675292969  GigaBytes

connection checking time:  29.136350631713867
block generation total time  24.990344285964966
average batch blocks generation time:  1.5618965178728104
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10703182220458984  GigaBytes
Max Memory Allocated: 0.10703182220458984  GigaBytes

torch.Size([163716, 128])
torch.Size([155751, 128])
torch.Size([124065, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.7919487953186035  GigaBytes
Max Memory Allocated: 0.8096404075622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.10846185684204102  GigaBytes
Max Memory Allocated: 0.8313283920288086  GigaBytes

torch.Size([163669, 128])
torch.Size([155776, 128])
torch.Size([124670, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.7957935333251953  GigaBytes
Max Memory Allocated: 0.8313283920288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.10816621780395508  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163709, 128])
torch.Size([155553, 128])
torch.Size([123783, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7892003059387207  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10810327529907227  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163561, 128])
torch.Size([155348, 128])
torch.Size([122969, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7859969139099121  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10826826095581055  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163799, 128])
torch.Size([155827, 128])
torch.Size([124299, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7934927940368652  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10826921463012695  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163736, 128])
torch.Size([155784, 128])
torch.Size([124092, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7924246788024902  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10819768905639648  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163480, 128])
torch.Size([155311, 128])
torch.Size([123338, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7878975868225098  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1082606315612793  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163579, 128])
torch.Size([155460, 128])
torch.Size([123843, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7895369529724121  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1081089973449707  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163647, 128])
torch.Size([155473, 128])
torch.Size([123302, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7880043983459473  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10814332962036133  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163728, 128])
torch.Size([155642, 128])
torch.Size([123199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7873725891113281  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1084141731262207  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163755, 128])
torch.Size([155871, 128])
torch.Size([124420, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7938094139099121  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10836458206176758  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163493, 128])
torch.Size([155333, 128])
torch.Size([123946, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7910428047180176  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10821866989135742  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163661, 128])
torch.Size([155644, 128])
torch.Size([123585, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7891788482666016  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10825967788696289  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163793, 128])
torch.Size([155823, 128])
torch.Size([124025, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7919402122497559  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10819673538208008  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163687, 128])
torch.Size([155291, 128])
torch.Size([123238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7876081466674805  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10836267471313477  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163764, 128])
torch.Size([155891, 128])
torch.Size([124444, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7940340042114258  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05479186773300171 |0.04765811562538147 |0.04978868365287781 |9.846687316894531e-05 |0.014670386910438538 |0.00482487678527832 |
----------------------------------------------------------pseudo_mini_loss sum 5.860544204711914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7751915
Number of first layer input nodes during this epoch:  2618777
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1576519012451172  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02594733238220215
range selection method range initialization spend 0.012085676193237305
time for parepare:  0.019419193267822266
local_output_nid generation:  0.001560211181640625
local_in_edges_tensor generation:  0.004601240158081055
mini_batch_src_global generation:  0.0020020008087158203
r_  generation:  0.01963186264038086
local_output_nid generation:  0.0015935897827148438
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.0021240711212158203
r_  generation:  0.01767897605895996
local_output_nid generation:  0.001725912094116211
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.001348733901977539
r_  generation:  0.01827526092529297
local_output_nid generation:  0.0018546581268310547
local_in_edges_tensor generation:  0.0008993148803710938
mini_batch_src_global generation:  0.0014183521270751953
r_  generation:  0.017696142196655273
local_output_nid generation:  0.0017085075378417969
local_in_edges_tensor generation:  0.0008845329284667969
mini_batch_src_global generation:  0.013504981994628906
r_  generation:  0.018680334091186523
local_output_nid generation:  0.0017542839050292969
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.018574237823486328
local_output_nid generation:  0.0017883777618408203
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.0187835693359375
local_output_nid generation:  0.0017361640930175781
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0015001296997070312
r_  generation:  0.018595457077026367
local_output_nid generation:  0.001749277114868164
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0015478134155273438
r_  generation:  0.018415212631225586
local_output_nid generation:  0.0017545223236083984
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.018595457077026367
local_output_nid generation:  0.0017554759979248047
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.019290924072265625
local_output_nid generation:  0.0017268657684326172
local_in_edges_tensor generation:  0.000946044921875
mini_batch_src_global generation:  0.0014705657958984375
r_  generation:  0.01920318603515625
local_output_nid generation:  0.0018115043640136719
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0015668869018554688
r_  generation:  0.018711566925048828
local_output_nid generation:  0.0017399787902832031
local_in_edges_tensor generation:  0.0009033679962158203
mini_batch_src_global generation:  0.001584768295288086
r_  generation:  0.018980026245117188
local_output_nid generation:  0.0017919540405273438
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0014984607696533203
r_  generation:  0.018407344818115234
local_output_nid generation:  0.0017354488372802734
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.01862168312072754
----------------------check_connections_block total spend ----------------------------- 0.47206592559814453
generate_one_block  0.03411984443664551
generate_one_block  0.027825355529785156
generate_one_block  0.028409242630004883
generate_one_block  0.027820110321044922
generate_one_block  0.028461217880249023
generate_one_block  0.030827045440673828
generate_one_block  0.02797102928161621
generate_one_block  0.027785778045654297
generate_one_block  0.027692317962646484
generate_one_block  0.027865886688232422
generate_one_block  0.028213024139404297
generate_one_block  0.02881789207458496
generate_one_block  0.02821636199951172
generate_one_block  0.027965784072875977
generate_one_block  0.027507305145263672
generate_one_block  0.028110742568969727
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04094862937927246
gen group dst list time:  0.019170761108398438
time for parepare:  0.021249771118164062
local_output_nid generation:  0.0077533721923828125
local_in_edges_tensor generation:  0.020478010177612305
mini_batch_src_global generation:  0.02214646339416504
r_  generation:  0.2067122459411621
local_output_nid generation:  0.014010906219482422
local_in_edges_tensor generation:  0.01974940299987793
mini_batch_src_global generation:  0.027070999145507812
r_  generation:  0.23617005348205566
local_output_nid generation:  0.015209197998046875
local_in_edges_tensor generation:  0.016244173049926758
mini_batch_src_global generation:  0.03388237953186035
r_  generation:  0.2373523712158203
local_output_nid generation:  0.013289451599121094
local_in_edges_tensor generation:  0.01480865478515625
mini_batch_src_global generation:  0.027811288833618164
r_  generation:  0.23214364051818848
local_output_nid generation:  0.013794183731079102
local_in_edges_tensor generation:  0.016495466232299805
mini_batch_src_global generation:  0.02992415428161621
r_  generation:  0.24211883544921875
local_output_nid generation:  0.014189481735229492
local_in_edges_tensor generation:  0.012891292572021484
mini_batch_src_global generation:  0.0324399471282959
r_  generation:  0.244096040725708
local_output_nid generation:  0.02526402473449707
local_in_edges_tensor generation:  0.025362491607666016
mini_batch_src_global generation:  0.057749032974243164
r_  generation:  0.21735429763793945
local_output_nid generation:  0.012230157852172852
local_in_edges_tensor generation:  0.020664691925048828
mini_batch_src_global generation:  0.028628110885620117
r_  generation:  0.21564078330993652
local_output_nid generation:  0.011867761611938477
local_in_edges_tensor generation:  0.011091470718383789
mini_batch_src_global generation:  0.026720285415649414
r_  generation:  0.21356701850891113
local_output_nid generation:  0.012363672256469727
local_in_edges_tensor generation:  0.012267112731933594
mini_batch_src_global generation:  0.026879072189331055
r_  generation:  0.21219658851623535
local_output_nid generation:  0.012617349624633789
local_in_edges_tensor generation:  0.016709566116333008
mini_batch_src_global generation:  0.027183055877685547
r_  generation:  0.21622157096862793
local_output_nid generation:  0.012666940689086914
local_in_edges_tensor generation:  0.015190601348876953
mini_batch_src_global generation:  0.027393341064453125
r_  generation:  0.21791315078735352
local_output_nid generation:  0.012530326843261719
local_in_edges_tensor generation:  0.011487722396850586
mini_batch_src_global generation:  0.026987791061401367
r_  generation:  0.2143244743347168
local_output_nid generation:  0.012728691101074219
local_in_edges_tensor generation:  0.013228893280029297
mini_batch_src_global generation:  0.02898859977722168
r_  generation:  0.21928071975708008
local_output_nid generation:  0.012567758560180664
local_in_edges_tensor generation:  0.01504373550415039
mini_batch_src_global generation:  0.027333974838256836
r_  generation:  0.21688246726989746
local_output_nid generation:  0.012646675109863281
local_in_edges_tensor generation:  0.011475086212158203
mini_batch_src_global generation:  0.027124404907226562
r_  generation:  0.21367835998535156
----------------------check_connections_block total spend ----------------------------- 5.325497150421143
generate_one_block  0.3070228099822998
generate_one_block  0.2841789722442627
generate_one_block  0.3038151264190674
generate_one_block  0.2843143939971924
generate_one_block  0.280289888381958
generate_one_block  0.2726428508758545
generate_one_block  0.2998359203338623
generate_one_block  0.27559375762939453
generate_one_block  0.271728515625
generate_one_block  0.27203822135925293
generate_one_block  0.2769279479980469
generate_one_block  0.2848067283630371
generate_one_block  0.2748754024505615
generate_one_block  0.2919425964355469
generate_one_block  0.2954747676849365
generate_one_block  0.2779109477996826
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.053397178649902344
gen group dst list time:  0.06624436378479004
time for parepare:  0.018877506256103516
local_output_nid generation:  0.025011777877807617
local_in_edges_tensor generation:  0.06323027610778809
mini_batch_src_global generation:  0.04935574531555176
r_  generation:  0.47170066833496094
local_output_nid generation:  0.03141450881958008
local_in_edges_tensor generation:  0.047297000885009766
mini_batch_src_global generation:  0.056200504302978516
r_  generation:  0.4719698429107666
local_output_nid generation:  0.03048396110534668
local_in_edges_tensor generation:  0.0346982479095459
mini_batch_src_global generation:  0.05576276779174805
r_  generation:  0.4829075336456299
local_output_nid generation:  0.030522823333740234
local_in_edges_tensor generation:  0.04300975799560547
mini_batch_src_global generation:  0.05654764175415039
r_  generation:  0.4819200038909912
local_output_nid generation:  0.030789613723754883
local_in_edges_tensor generation:  0.08586335182189941
mini_batch_src_global generation:  0.07131576538085938
r_  generation:  0.4932734966278076
local_output_nid generation:  0.02960944175720215
local_in_edges_tensor generation:  0.030699729919433594
mini_batch_src_global generation:  0.057486534118652344
r_  generation:  0.4853668212890625
local_output_nid generation:  0.030770540237426758
local_in_edges_tensor generation:  0.0410768985748291
mini_batch_src_global generation:  0.05848979949951172
r_  generation:  0.5167896747589111
local_output_nid generation:  0.033503055572509766
local_in_edges_tensor generation:  0.04750847816467285
mini_batch_src_global generation:  0.059003353118896484
r_  generation:  0.48241138458251953
local_output_nid generation:  0.03144717216491699
local_in_edges_tensor generation:  0.046567678451538086
mini_batch_src_global generation:  0.05738425254821777
r_  generation:  0.48944973945617676
local_output_nid generation:  0.031105518341064453
local_in_edges_tensor generation:  0.03290534019470215
mini_batch_src_global generation:  0.05823683738708496
r_  generation:  0.48471689224243164
local_output_nid generation:  0.031417131423950195
local_in_edges_tensor generation:  0.03507089614868164
mini_batch_src_global generation:  0.06014060974121094
r_  generation:  0.4952692985534668
local_output_nid generation:  0.03149867057800293
local_in_edges_tensor generation:  0.04343867301940918
mini_batch_src_global generation:  0.05821824073791504
r_  generation:  0.4965376853942871
local_output_nid generation:  0.03125810623168945
local_in_edges_tensor generation:  0.030664682388305664
mini_batch_src_global generation:  0.05775785446166992
r_  generation:  0.4930305480957031
local_output_nid generation:  0.03211641311645508
local_in_edges_tensor generation:  0.03598594665527344
mini_batch_src_global generation:  0.05859375
r_  generation:  0.4911844730377197
local_output_nid generation:  0.03154253959655762
local_in_edges_tensor generation:  0.04660630226135254
mini_batch_src_global generation:  0.05731201171875
r_  generation:  0.5170769691467285
local_output_nid generation:  0.03327155113220215
local_in_edges_tensor generation:  0.042022705078125
mini_batch_src_global generation:  0.06610608100891113
r_  generation:  0.4842517375946045
----------------------check_connections_block total spend ----------------------------- 11.712525844573975
generate_one_block  0.6366331577301025
generate_one_block  0.6229753494262695
generate_one_block  0.6270184516906738
generate_one_block  0.6235272884368896
generate_one_block  0.6292974948883057
generate_one_block  0.6205408573150635
generate_one_block  0.6173083782196045
generate_one_block  0.6511273384094238
generate_one_block  0.6677207946777344
generate_one_block  0.6196370124816895
generate_one_block  0.623309850692749
generate_one_block  0.6379752159118652
generate_one_block  0.6171543598175049
generate_one_block  0.6355929374694824
generate_one_block  0.6293728351593018
generate_one_block  0.6255545616149902
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04643821716308594
gen group dst list time:  0.1012115478515625
time for parepare:  0.020852327346801758
local_output_nid generation:  0.03205299377441406
local_in_edges_tensor generation:  0.06223177909851074
mini_batch_src_global generation:  0.04726910591125488
r_  generation:  0.5080225467681885
local_output_nid generation:  0.041281938552856445
local_in_edges_tensor generation:  0.05012202262878418
mini_batch_src_global generation:  0.056023359298706055
r_  generation:  0.49833059310913086
local_output_nid generation:  0.039781808853149414
local_in_edges_tensor generation:  0.04165959358215332
mini_batch_src_global generation:  0.053635358810424805
r_  generation:  0.5037868022918701
local_output_nid generation:  0.038340091705322266
local_in_edges_tensor generation:  0.03929424285888672
mini_batch_src_global generation:  0.052911996841430664
r_  generation:  0.5042788982391357
local_output_nid generation:  0.03736758232116699
local_in_edges_tensor generation:  0.04795646667480469
mini_batch_src_global generation:  0.05296039581298828
r_  generation:  0.5070095062255859
local_output_nid generation:  0.03754925727844238
local_in_edges_tensor generation:  0.03935575485229492
mini_batch_src_global generation:  0.053110361099243164
r_  generation:  0.5109214782714844
local_output_nid generation:  0.03767967224121094
local_in_edges_tensor generation:  0.04346942901611328
mini_batch_src_global generation:  0.05360770225524902
r_  generation:  0.5144469738006592
local_output_nid generation:  0.037988901138305664
local_in_edges_tensor generation:  0.03904414176940918
mini_batch_src_global generation:  0.05360269546508789
r_  generation:  0.5133652687072754
local_output_nid generation:  0.03765058517456055
local_in_edges_tensor generation:  0.04308772087097168
mini_batch_src_global generation:  0.05455660820007324
r_  generation:  0.515329122543335
local_output_nid generation:  0.03771781921386719
local_in_edges_tensor generation:  0.03577375411987305
mini_batch_src_global generation:  0.055509328842163086
r_  generation:  0.5153894424438477
local_output_nid generation:  0.037458181381225586
local_in_edges_tensor generation:  0.034273386001586914
mini_batch_src_global generation:  0.05517005920410156
r_  generation:  0.51833176612854
local_output_nid generation:  0.03800511360168457
local_in_edges_tensor generation:  0.04360079765319824
mini_batch_src_global generation:  0.05454683303833008
r_  generation:  0.5188920497894287
local_output_nid generation:  0.037909507751464844
local_in_edges_tensor generation:  0.04493904113769531
mini_batch_src_global generation:  0.0553278923034668
r_  generation:  0.5175135135650635
local_output_nid generation:  0.037953853607177734
local_in_edges_tensor generation:  0.04451870918273926
mini_batch_src_global generation:  0.05466485023498535
r_  generation:  0.5164000988006592
local_output_nid generation:  0.03816485404968262
local_in_edges_tensor generation:  0.03549671173095703
mini_batch_src_global generation:  0.05571246147155762
r_  generation:  0.514601469039917
local_output_nid generation:  0.03798174858093262
local_in_edges_tensor generation:  0.043090105056762695
mini_batch_src_global generation:  0.059087514877319336
r_  generation:  0.5193455219268799
----------------------check_connections_block total spend ----------------------------- 12.279304027557373
generate_one_block  0.6418309211730957
generate_one_block  0.6373376846313477
generate_one_block  0.6239151954650879
generate_one_block  0.6294541358947754
generate_one_block  0.6303343772888184
generate_one_block  0.6259117126464844
generate_one_block  0.7048907279968262
generate_one_block  0.6291606426239014
generate_one_block  0.6298339366912842
generate_one_block  0.6349048614501953
generate_one_block  0.6246864795684814
generate_one_block  0.6460490226745605
generate_one_block  0.6395118236541748
generate_one_block  0.633660078048706
generate_one_block  0.6284410953521729
generate_one_block  0.6367831230163574
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.1576519012451172  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

connection checking time:  29.31732702255249
block generation total time  24.834850549697876
average batch blocks generation time:  1.5521781593561172
block dataloader generation time/epoch 56.731226205825806
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10924530029296875  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163797, 128])
torch.Size([155808, 128])
torch.Size([124498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7955594062805176  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10890913009643555  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163528, 128])
torch.Size([155406, 128])
torch.Size([123468, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7888188362121582  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10914087295532227  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163656, 128])
torch.Size([155412, 128])
torch.Size([123963, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7911410331726074  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10904455184936523  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163561, 128])
torch.Size([155494, 128])
torch.Size([123246, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7889223098754883  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10916757583618164  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163646, 128])
torch.Size([155412, 128])
torch.Size([123726, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7907209396362305  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10896635055541992  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163650, 128])
torch.Size([155531, 128])
torch.Size([123405, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7894434928894043  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10895872116088867  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163663, 128])
torch.Size([155490, 128])
torch.Size([123079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7880301475524902  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10906744003295898  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163735, 128])
torch.Size([155547, 128])
torch.Size([123868, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7906856536865234  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10898733139038086  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163729, 128])
torch.Size([155618, 128])
torch.Size([123873, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7901873588562012  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10895109176635742  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163575, 128])
torch.Size([155442, 128])
torch.Size([123218, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7881765365600586  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10907697677612305  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163613, 128])
torch.Size([155357, 128])
torch.Size([123625, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7902565002441406  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10914087295532227  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163666, 128])
torch.Size([155521, 128])
torch.Size([124138, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7923145294189453  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10899972915649414  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163672, 128])
torch.Size([155580, 128])
torch.Size([123627, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7904534339904785  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10912179946899414  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163713, 128])
torch.Size([155785, 128])
torch.Size([124110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7935795783996582  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10906267166137695  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163540, 128])
torch.Size([155411, 128])
torch.Size([123816, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7901415824890137  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.10893392562866211  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

torch.Size([163701, 128])
torch.Size([155757, 128])
torch.Size([123871, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.7915005683898926  GigaBytes
Max Memory Allocated: 0.8360919952392578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05855491757392883 |0.025052040815353394 |0.00447411835193634 |9.22083854675293e-05 |0.004141911864280701 |0.0018420219421386719 |
----------------------------------------------------------pseudo_mini_loss sum 3.78608775138855
Total (block generation + training)time/epoch 58.268542766571045
Training time/epoch 1.537097692489624
Training time without block to device /epoch 1.1362650394439697
Training time without total dataloading part /epoch 0.1411738395690918
load block tensor time/epoch 0.9368786811828613
block to device time/epoch 0.4008326530456543
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7747312
Number of first layer input nodes during this epoch:  2618445
