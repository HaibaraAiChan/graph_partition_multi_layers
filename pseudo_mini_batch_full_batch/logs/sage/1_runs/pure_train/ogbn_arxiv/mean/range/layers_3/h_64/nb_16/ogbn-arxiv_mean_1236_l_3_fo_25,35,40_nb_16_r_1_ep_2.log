Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648447553.7129104
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024915218353271484
range selection method range initialization spend 0.013303995132446289
time for parepare:  0.017716169357299805
local_output_nid generation:  0.0013871192932128906
local_in_edges_tensor generation:  0.004080533981323242
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.018117427825927734
local_output_nid generation:  0.0014405250549316406
local_in_edges_tensor generation:  0.0009341239929199219
mini_batch_src_global generation:  0.001985311508178711
r_  generation:  0.01735377311706543
local_output_nid generation:  0.0014133453369140625
local_in_edges_tensor generation:  0.0008776187896728516
mini_batch_src_global generation:  0.0012297630310058594
r_  generation:  0.016662120819091797
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0009279251098632812
mini_batch_src_global generation:  0.0013685226440429688
r_  generation:  0.017442941665649414
local_output_nid generation:  0.0014448165893554688
local_in_edges_tensor generation:  0.0008380413055419922
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.017694950103759766
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.0014109611511230469
r_  generation:  0.018111467361450195
local_output_nid generation:  0.0014345645904541016
local_in_edges_tensor generation:  0.0008134841918945312
mini_batch_src_global generation:  0.0014357566833496094
r_  generation:  0.018372058868408203
local_output_nid generation:  0.0014908313751220703
local_in_edges_tensor generation:  0.000888824462890625
mini_batch_src_global generation:  0.0013878345489501953
r_  generation:  0.018622875213623047
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0014693737030029297
r_  generation:  0.018652677536010742
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.018902063369750977
local_output_nid generation:  0.0014576911926269531
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.001489400863647461
r_  generation:  0.01853656768798828
local_output_nid generation:  0.001444101333618164
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0014672279357910156
r_  generation:  0.018526077270507812
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0008206367492675781
mini_batch_src_global generation:  0.0015022754669189453
r_  generation:  0.018637657165527344
local_output_nid generation:  0.0014591217041015625
local_in_edges_tensor generation:  0.0008168220520019531
mini_batch_src_global generation:  0.0014913082122802734
r_  generation:  0.018535614013671875
local_output_nid generation:  0.0015211105346679688
local_in_edges_tensor generation:  0.0007975101470947266
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.018575191497802734
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.01887989044189453
----------------------check_connections_block total spend ----------------------------- 0.43828248977661133
generate_one_block  0.028118133544921875
generate_one_block  0.027736902236938477
generate_one_block  0.02810072898864746
generate_one_block  0.027833223342895508
generate_one_block  0.027501583099365234
generate_one_block  0.028094768524169922
generate_one_block  0.02731156349182129
generate_one_block  0.027927637100219727
generate_one_block  0.02822136878967285
generate_one_block  0.028208017349243164
generate_one_block  0.027492284774780273
generate_one_block  0.027995586395263672
generate_one_block  0.027734756469726562
generate_one_block  0.028056621551513672
generate_one_block  0.02741837501525879
generate_one_block  0.027799129486083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036752939224243164
gen group dst list time:  0.018652677536010742
time for parepare:  0.019536495208740234
local_output_nid generation:  0.006751060485839844
local_in_edges_tensor generation:  0.01761317253112793
mini_batch_src_global generation:  0.02129364013671875
r_  generation:  0.19344067573547363
local_output_nid generation:  0.012060403823852539
local_in_edges_tensor generation:  0.01822972297668457
mini_batch_src_global generation:  0.023962020874023438
r_  generation:  0.19767975807189941
local_output_nid generation:  0.012188911437988281
local_in_edges_tensor generation:  0.014940977096557617
mini_batch_src_global generation:  0.022411108016967773
r_  generation:  0.19578123092651367
local_output_nid generation:  0.012789487838745117
local_in_edges_tensor generation:  0.015649080276489258
mini_batch_src_global generation:  0.02408003807067871
r_  generation:  0.20357632637023926
local_output_nid generation:  0.01295781135559082
local_in_edges_tensor generation:  0.013723134994506836
mini_batch_src_global generation:  0.024599552154541016
r_  generation:  0.20271039009094238
local_output_nid generation:  0.013548612594604492
local_in_edges_tensor generation:  0.01624917984008789
mini_batch_src_global generation:  0.026218652725219727
r_  generation:  0.21457171440124512
local_output_nid generation:  0.013554573059082031
local_in_edges_tensor generation:  0.014309883117675781
mini_batch_src_global generation:  0.02566361427307129
r_  generation:  0.20728349685668945
local_output_nid generation:  0.01370382308959961
local_in_edges_tensor generation:  0.0164947509765625
mini_batch_src_global generation:  0.02609729766845703
r_  generation:  0.21264863014221191
local_output_nid generation:  0.014007329940795898
local_in_edges_tensor generation:  0.016666412353515625
mini_batch_src_global generation:  0.026497602462768555
r_  generation:  0.21164512634277344
local_output_nid generation:  0.014171123504638672
local_in_edges_tensor generation:  0.014625310897827148
mini_batch_src_global generation:  0.02649378776550293
r_  generation:  0.2115328311920166
local_output_nid generation:  0.013989448547363281
local_in_edges_tensor generation:  0.01284933090209961
mini_batch_src_global generation:  0.026308536529541016
r_  generation:  0.20954227447509766
local_output_nid generation:  0.01399374008178711
local_in_edges_tensor generation:  0.01446843147277832
mini_batch_src_global generation:  0.026101112365722656
r_  generation:  0.2118675708770752
local_output_nid generation:  0.013887643814086914
local_in_edges_tensor generation:  0.014748334884643555
mini_batch_src_global generation:  0.026300668716430664
r_  generation:  0.21192073822021484
local_output_nid generation:  0.014164209365844727
local_in_edges_tensor generation:  0.016476154327392578
mini_batch_src_global generation:  0.028289318084716797
r_  generation:  0.21166300773620605
local_output_nid generation:  0.01388859748840332
local_in_edges_tensor generation:  0.012834548950195312
mini_batch_src_global generation:  0.026109695434570312
r_  generation:  0.20703840255737305
local_output_nid generation:  0.01413726806640625
local_in_edges_tensor generation:  0.01495218276977539
mini_batch_src_global generation:  0.026732683181762695
r_  generation:  0.21167397499084473
----------------------check_connections_block total spend ----------------------------- 4.928931713104248
generate_one_block  0.2765216827392578
generate_one_block  0.2664909362792969
generate_one_block  0.2615163326263428
generate_one_block  0.26976943016052246
generate_one_block  0.2818031311035156
generate_one_block  0.27463650703430176
generate_one_block  0.27210307121276855
generate_one_block  0.27649831771850586
generate_one_block  0.2753918170928955
generate_one_block  0.2741115093231201
generate_one_block  0.2722351551055908
generate_one_block  0.2713429927825928
generate_one_block  0.2698211669921875
generate_one_block  0.27427053451538086
generate_one_block  0.2682981491088867
generate_one_block  0.2676396369934082
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0364985466003418
gen group dst list time:  0.058920860290527344
time for parepare:  0.019548416137695312
local_output_nid generation:  0.024255990982055664
local_in_edges_tensor generation:  0.03830361366271973
mini_batch_src_global generation:  0.040956735610961914
r_  generation:  0.43999314308166504
local_output_nid generation:  0.0338749885559082
local_in_edges_tensor generation:  0.04256796836853027
mini_batch_src_global generation:  0.05095624923706055
r_  generation:  0.4422764778137207
local_output_nid generation:  0.03395271301269531
local_in_edges_tensor generation:  0.035527944564819336
mini_batch_src_global generation:  0.04956173896789551
r_  generation:  0.4423661231994629
local_output_nid generation:  0.0345609188079834
local_in_edges_tensor generation:  0.03168225288391113
mini_batch_src_global generation:  0.0553896427154541
r_  generation:  0.44989848136901855
local_output_nid generation:  0.03462505340576172
local_in_edges_tensor generation:  0.03230929374694824
mini_batch_src_global generation:  0.05163264274597168
r_  generation:  0.45240139961242676
local_output_nid generation:  0.034918785095214844
local_in_edges_tensor generation:  0.0316464900970459
mini_batch_src_global generation:  0.05355691909790039
r_  generation:  0.4512515068054199
local_output_nid generation:  0.03548765182495117
local_in_edges_tensor generation:  0.035626888275146484
mini_batch_src_global generation:  0.05155134201049805
r_  generation:  0.4576146602630615
local_output_nid generation:  0.03568387031555176
local_in_edges_tensor generation:  0.02917957305908203
mini_batch_src_global generation:  0.05320382118225098
r_  generation:  0.4511725902557373
local_output_nid generation:  0.03517007827758789
local_in_edges_tensor generation:  0.03573179244995117
mini_batch_src_global generation:  0.05227994918823242
r_  generation:  0.4575488567352295
local_output_nid generation:  0.03550434112548828
local_in_edges_tensor generation:  0.03275132179260254
mini_batch_src_global generation:  0.053961992263793945
r_  generation:  0.4561779499053955
local_output_nid generation:  0.03519773483276367
local_in_edges_tensor generation:  0.0286710262298584
mini_batch_src_global generation:  0.051687002182006836
r_  generation:  0.4599885940551758
local_output_nid generation:  0.03497767448425293
local_in_edges_tensor generation:  0.0290987491607666
mini_batch_src_global generation:  0.05260276794433594
r_  generation:  0.44817590713500977
local_output_nid generation:  0.035539865493774414
local_in_edges_tensor generation:  0.036525726318359375
mini_batch_src_global generation:  0.05235123634338379
r_  generation:  0.4599146842956543
local_output_nid generation:  0.035718441009521484
local_in_edges_tensor generation:  0.03647971153259277
mini_batch_src_global generation:  0.05630683898925781
r_  generation:  0.45406556129455566
local_output_nid generation:  0.035596609115600586
local_in_edges_tensor generation:  0.027658939361572266
mini_batch_src_global generation:  0.05206036567687988
r_  generation:  0.45737147331237793
local_output_nid generation:  0.03537273406982422
local_in_edges_tensor generation:  0.03182625770568848
mini_batch_src_global generation:  0.05316305160522461
r_  generation:  0.45735836029052734
----------------------check_connections_block total spend ----------------------------- 10.731759309768677
generate_one_block  0.5853831768035889
generate_one_block  0.5816433429718018
generate_one_block  0.5759732723236084
generate_one_block  0.5823965072631836
generate_one_block  0.5753226280212402
generate_one_block  0.5942153930664062
generate_one_block  0.6191792488098145
generate_one_block  0.5742597579956055
generate_one_block  0.5768604278564453
generate_one_block  0.5885696411132812
generate_one_block  0.5716266632080078
generate_one_block  0.5796446800231934
generate_one_block  0.5841515064239502
generate_one_block  0.5953226089477539
generate_one_block  0.5706155300140381
generate_one_block  0.572913646697998
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  15.660691022872925
block generation total time  13.680528402328491
average batch blocks generation time:  0.8550330251455307
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0901036262512207  GigaBytes
Max Memory Allocated: 0.0901036262512207  GigaBytes

torch.Size([154376, 128])
torch.Size([123012, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.24846744537353516  GigaBytes
Max Memory Allocated: 0.2564373016357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09081077575683594  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154587, 128])
torch.Size([122078, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24448633193969727  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09059619903564453  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154674, 128])
torch.Size([121902, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.243865966796875  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09082889556884766  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154766, 128])
torch.Size([123014, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24555253982543945  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09080314636230469  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154263, 128])
torch.Size([122148, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24451923370361328  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09096145629882812  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154520, 128])
torch.Size([122915, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2461085319519043  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09085464477539062  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154709, 128])
torch.Size([122597, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24544095993041992  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09097003936767578  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154379, 128])
torch.Size([122031, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2451786994934082  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.090972900390625  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154472, 128])
torch.Size([122643, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2462005615234375  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.0909576416015625  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154764, 128])
torch.Size([122978, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2465219497680664  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09087657928466797  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154511, 128])
torch.Size([122394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24515104293823242  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09084415435791016  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154306, 128])
torch.Size([122055, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24494171142578125  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.0908498764038086  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154716, 128])
torch.Size([122707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24542760848999023  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09096431732177734  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154493, 128])
torch.Size([122912, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24587392807006836  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09073829650878906  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154345, 128])
torch.Size([121843, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2441420555114746  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09085559844970703  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154628, 128])
torch.Size([122591, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24557018280029297  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03820648789405823 |0.034347206354141235 |0.04983164370059967 |9.575486183166504e-05 |0.00842142105102539 |0.003682851791381836 |
----------------------------------------------------------pseudo_mini_loss sum 5.310603141784668
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5093576
Number of first layer input nodes during this epoch:  2472509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.12393760681152344  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02256631851196289
range selection method range initialization spend 0.011289119720458984
time for parepare:  0.016364574432373047
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.0066602230072021484
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.01684093475341797
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0020608901977539062
r_  generation:  0.017664432525634766
local_output_nid generation:  0.001516580581665039
local_in_edges_tensor generation:  0.0008649826049804688
mini_batch_src_global generation:  0.0013470649719238281
r_  generation:  0.017995595932006836
local_output_nid generation:  0.001550912857055664
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.0014007091522216797
r_  generation:  0.018245220184326172
local_output_nid generation:  0.0015463829040527344
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0012941360473632812
r_  generation:  0.018196821212768555
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0008742809295654297
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.01845693588256836
local_output_nid generation:  0.0015950202941894531
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.0013523101806640625
r_  generation:  0.018143415451049805
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0009553432464599609
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.01874232292175293
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.019633054733276367
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.018225669860839844
local_output_nid generation:  0.0015835762023925781
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0015022754669189453
r_  generation:  0.019286632537841797
local_output_nid generation:  0.0015048980712890625
local_in_edges_tensor generation:  0.0008440017700195312
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.018990039825439453
local_output_nid generation:  0.0014870166778564453
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.001489877700805664
r_  generation:  0.019078969955444336
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.018893718719482422
local_output_nid generation:  0.0014710426330566406
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0014917850494384766
r_  generation:  0.018674612045288086
local_output_nid generation:  0.001499176025390625
local_in_edges_tensor generation:  0.0008032321929931641
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.018833398818969727
----------------------check_connections_block total spend ----------------------------- 0.44777989387512207
generate_one_block  0.03615617752075195
generate_one_block  0.027662992477416992
generate_one_block  0.0277554988861084
generate_one_block  0.027962207794189453
generate_one_block  0.027786731719970703
generate_one_block  0.02948284149169922
generate_one_block  0.026901721954345703
generate_one_block  0.027719497680664062
generate_one_block  0.028422832489013672
generate_one_block  0.026946306228637695
generate_one_block  0.028050661087036133
generate_one_block  0.028212785720825195
generate_one_block  0.028397083282470703
generate_one_block  0.0284273624420166
generate_one_block  0.02758622169494629
generate_one_block  0.02828240394592285
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03910660743713379
gen group dst list time:  0.017241716384887695
time for parepare:  0.0189359188079834
local_output_nid generation:  0.00664830207824707
local_in_edges_tensor generation:  0.018689870834350586
mini_batch_src_global generation:  0.019321203231811523
r_  generation:  0.19450616836547852
local_output_nid generation:  0.009973526000976562
local_in_edges_tensor generation:  0.017699241638183594
mini_batch_src_global generation:  0.023966550827026367
r_  generation:  0.2012782096862793
local_output_nid generation:  0.010824918746948242
local_in_edges_tensor generation:  0.017106056213378906
mini_batch_src_global generation:  0.026629924774169922
r_  generation:  0.20903253555297852
local_output_nid generation:  0.011370182037353516
local_in_edges_tensor generation:  0.013810157775878906
mini_batch_src_global generation:  0.024691104888916016
r_  generation:  0.20874285697937012
local_output_nid generation:  0.01097249984741211
local_in_edges_tensor generation:  0.01337432861328125
mini_batch_src_global generation:  0.025219440460205078
r_  generation:  0.21107149124145508
local_output_nid generation:  0.01123356819152832
local_in_edges_tensor generation:  0.01167607307434082
mini_batch_src_global generation:  0.025358200073242188
r_  generation:  0.20903325080871582
local_output_nid generation:  0.010811090469360352
local_in_edges_tensor generation:  0.012870073318481445
mini_batch_src_global generation:  0.025806903839111328
r_  generation:  0.2089097499847412
local_output_nid generation:  0.01105809211730957
local_in_edges_tensor generation:  0.015089273452758789
mini_batch_src_global generation:  0.02675151824951172
r_  generation:  0.2173616886138916
local_output_nid generation:  0.012175321578979492
local_in_edges_tensor generation:  0.02502155303955078
mini_batch_src_global generation:  0.03098583221435547
r_  generation:  0.22840642929077148
local_output_nid generation:  0.013534307479858398
local_in_edges_tensor generation:  0.0153656005859375
mini_batch_src_global generation:  0.03113079071044922
r_  generation:  0.20902395248413086
local_output_nid generation:  0.011719226837158203
local_in_edges_tensor generation:  0.013201713562011719
mini_batch_src_global generation:  0.026336669921875
r_  generation:  0.2150411605834961
local_output_nid generation:  0.011756181716918945
local_in_edges_tensor generation:  0.011998176574707031
mini_batch_src_global generation:  0.025950193405151367
r_  generation:  0.21024775505065918
local_output_nid generation:  0.01191401481628418
local_in_edges_tensor generation:  0.013444662094116211
mini_batch_src_global generation:  0.02787947654724121
r_  generation:  0.21853923797607422
local_output_nid generation:  0.011681079864501953
local_in_edges_tensor generation:  0.011959552764892578
mini_batch_src_global generation:  0.02657938003540039
r_  generation:  0.22307515144348145
local_output_nid generation:  0.01176142692565918
local_in_edges_tensor generation:  0.013580083847045898
mini_batch_src_global generation:  0.02626657485961914
r_  generation:  0.21267294883728027
local_output_nid generation:  0.011949300765991211
local_in_edges_tensor generation:  0.013540267944335938
mini_batch_src_global generation:  0.02630305290222168
r_  generation:  0.21229934692382812
----------------------check_connections_block total spend ----------------------------- 5.0477025508880615
generate_one_block  0.28970837593078613
generate_one_block  0.26876139640808105
generate_one_block  0.27087998390197754
generate_one_block  0.2866206169128418
generate_one_block  0.2952604293823242
generate_one_block  0.2683894634246826
generate_one_block  0.2929494380950928
generate_one_block  0.2709989547729492
generate_one_block  0.27797627449035645
generate_one_block  0.27209973335266113
generate_one_block  0.27390289306640625
generate_one_block  0.2668275833129883
generate_one_block  0.27315616607666016
generate_one_block  0.26569056510925293
generate_one_block  0.2695915699005127
generate_one_block  0.27532076835632324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05159735679626465
gen group dst list time:  0.06969404220581055
time for parepare:  0.01758098602294922
local_output_nid generation:  0.02456521987915039
local_in_edges_tensor generation:  0.05401968955993652
mini_batch_src_global generation:  0.04208564758300781
r_  generation:  0.44217586517333984
local_output_nid generation:  0.02953028678894043
local_in_edges_tensor generation:  0.04667210578918457
mini_batch_src_global generation:  0.0518949031829834
r_  generation:  0.4429774284362793
local_output_nid generation:  0.029767751693725586
local_in_edges_tensor generation:  0.04236268997192383
mini_batch_src_global generation:  0.05394172668457031
r_  generation:  0.4513218402862549
local_output_nid generation:  0.029799699783325195
local_in_edges_tensor generation:  0.031104087829589844
mini_batch_src_global generation:  0.05270528793334961
r_  generation:  0.4555211067199707
local_output_nid generation:  0.03049492835998535
local_in_edges_tensor generation:  0.0736844539642334
mini_batch_src_global generation:  0.05253338813781738
r_  generation:  0.4535353183746338
local_output_nid generation:  0.03035879135131836
local_in_edges_tensor generation:  0.03536868095397949
mini_batch_src_global generation:  0.052290916442871094
r_  generation:  0.45756006240844727
local_output_nid generation:  0.030287981033325195
local_in_edges_tensor generation:  0.0430150032043457
mini_batch_src_global generation:  0.051401615142822266
r_  generation:  0.4583892822265625
local_output_nid generation:  0.030659914016723633
local_in_edges_tensor generation:  0.03556680679321289
mini_batch_src_global generation:  0.05288553237915039
r_  generation:  0.455890417098999
local_output_nid generation:  0.030590057373046875
local_in_edges_tensor generation:  0.039534568786621094
mini_batch_src_global generation:  0.07091522216796875
r_  generation:  0.4612715244293213
local_output_nid generation:  0.030720949172973633
local_in_edges_tensor generation:  0.03443765640258789
mini_batch_src_global generation:  0.052855491638183594
r_  generation:  0.453336238861084
local_output_nid generation:  0.030358552932739258
local_in_edges_tensor generation:  0.03611898422241211
mini_batch_src_global generation:  0.05201387405395508
r_  generation:  0.4652855396270752
local_output_nid generation:  0.03080463409423828
local_in_edges_tensor generation:  0.03528547286987305
mini_batch_src_global generation:  0.05286240577697754
r_  generation:  0.45160365104675293
local_output_nid generation:  0.030679702758789062
local_in_edges_tensor generation:  0.0395808219909668
mini_batch_src_global generation:  0.05230975151062012
r_  generation:  0.46380043029785156
local_output_nid generation:  0.030314207077026367
local_in_edges_tensor generation:  0.03190159797668457
mini_batch_src_global generation:  0.0527498722076416
r_  generation:  0.4491426944732666
local_output_nid generation:  0.03054499626159668
local_in_edges_tensor generation:  0.036339521408081055
mini_batch_src_global generation:  0.05525565147399902
r_  generation:  0.4561028480529785
local_output_nid generation:  0.0304257869720459
local_in_edges_tensor generation:  0.03507852554321289
mini_batch_src_global generation:  0.056138038635253906
r_  generation:  0.4519829750061035
----------------------check_connections_block total spend ----------------------------- 10.828466415405273
generate_one_block  0.5708451271057129
generate_one_block  0.5764384269714355
generate_one_block  0.5760049819946289
generate_one_block  0.5654666423797607
generate_one_block  0.5708761215209961
generate_one_block  0.5704827308654785
generate_one_block  0.5797755718231201
generate_one_block  0.582617998123169
generate_one_block  0.616004228591919
generate_one_block  0.5625221729278564
generate_one_block  0.5760624408721924
generate_one_block  0.572664737701416
generate_one_block  0.5899536609649658
generate_one_block  0.5638105869293213
generate_one_block  0.569843053817749
generate_one_block  0.590418815612793
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.12393760681152344  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

connection checking time:  15.876168966293335
block generation total time  13.651921510696411
average batch blocks generation time:  0.8532450944185257
block dataloader generation time/epoch 31.67256736755371
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09112310409545898  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154456, 128])
torch.Size([122795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24592876434326172  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.0910806655883789  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154545, 128])
torch.Size([122461, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24516963958740234  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09119319915771484  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154315, 128])
torch.Size([122722, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24648666381835938  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09113216400146484  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154199, 128])
torch.Size([122086, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24554967880249023  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09108638763427734  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154331, 128])
torch.Size([122331, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24567413330078125  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09103679656982422  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154433, 128])
torch.Size([122106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2451014518737793  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.0909414291381836  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154361, 128])
torch.Size([121873, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24433183670043945  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.0911417007446289  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154263, 128])
torch.Size([122436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24563121795654297  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.0912160873413086  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154486, 128])
torch.Size([122861, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24664592742919922  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09100151062011719  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154243, 128])
torch.Size([121879, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24448728561401367  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09122180938720703  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154359, 128])
torch.Size([122240, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24596214294433594  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09105396270751953  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154560, 128])
torch.Size([122495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24530553817749023  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09119892120361328  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154487, 128])
torch.Size([122956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24669361114501953  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09096622467041016  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154147, 128])
torch.Size([121286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2440199851989746  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09102630615234375  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154565, 128])
torch.Size([122248, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.2449660301208496  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.09107589721679688  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

torch.Size([154593, 128])
torch.Size([122446, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.24549627304077148  GigaBytes
Max Memory Allocated: 0.26842212677001953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03410866856575012 |0.016129806637763977 |0.0037593692541122437 |9.329617023468018e-05 |0.004264041781425476 |0.0015184879302978516 |
----------------------------------------------------------pseudo_mini_loss sum 4.092179298400879
Total (block generation + training)time/epoch 32.638063192367554
Training time/epoch 0.9652950763702393
Training time without block to device /epoch 0.7072181701660156
Training time without total dataloading part /epoch 0.13138580322265625
load block tensor time/epoch 0.545738697052002
block to device time/epoch 0.25807690620422363
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5089116
Number of first layer input nodes during this epoch:  2470343
