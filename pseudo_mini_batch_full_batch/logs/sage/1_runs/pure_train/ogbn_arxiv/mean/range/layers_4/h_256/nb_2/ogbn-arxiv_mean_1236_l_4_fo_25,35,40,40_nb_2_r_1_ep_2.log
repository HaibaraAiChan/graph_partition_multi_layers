Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648483871.650635
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02477550506591797
range selection method range initialization spend 0.013190746307373047
time for parepare:  0.018065690994262695
local_output_nid generation:  0.010392427444458008
local_in_edges_tensor generation:  0.010210275650024414
mini_batch_src_global generation:  0.014117956161499023
r_  generation:  0.16696643829345703
local_output_nid generation:  0.011565446853637695
local_in_edges_tensor generation:  0.010489702224731445
mini_batch_src_global generation:  0.017237424850463867
r_  generation:  0.17687177658081055
----------------------check_connections_block total spend ----------------------------- 0.5039312839508057
generate_one_block  0.19719338417053223
generate_one_block  0.19954156875610352
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04093647003173828
gen group dst list time:  0.007679939270019531
time for parepare:  0.019978761672973633
local_output_nid generation:  0.017187118530273438
local_in_edges_tensor generation:  0.04281020164489746
mini_batch_src_global generation:  0.04663515090942383
r_  generation:  0.4922306537628174
local_output_nid generation:  0.028205156326293945
local_in_edges_tensor generation:  0.04510354995727539
mini_batch_src_global generation:  0.057158708572387695
r_  generation:  0.5098316669464111
----------------------check_connections_block total spend ----------------------------- 1.4771735668182373
generate_one_block  0.6509392261505127
generate_one_block  0.6434392929077148
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0357208251953125
gen group dst list time:  0.011962652206420898
time for parepare:  0.0195314884185791
local_output_nid generation:  0.022320032119750977
local_in_edges_tensor generation:  0.03464365005493164
mini_batch_src_global generation:  0.05284738540649414
r_  generation:  0.5368421077728271
local_output_nid generation:  0.038047075271606445
local_in_edges_tensor generation:  0.049190521240234375
mini_batch_src_global generation:  0.06124281883239746
r_  generation:  0.549544095993042
----------------------check_connections_block total spend ----------------------------- 1.6016268730163574
generate_one_block  0.7174179553985596
generate_one_block  0.7099273204803467
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026448965072631836
gen group dst list time:  0.012794971466064453
time for parepare:  0.01969289779663086
local_output_nid generation:  0.023447275161743164
local_in_edges_tensor generation:  0.03460359573364258
mini_batch_src_global generation:  0.04541301727294922
r_  generation:  0.5114152431488037
local_output_nid generation:  0.035221099853515625
local_in_edges_tensor generation:  0.03201484680175781
mini_batch_src_global generation:  0.05792951583862305
r_  generation:  0.5212719440460205
----------------------check_connections_block total spend ----------------------------- 1.5123956203460693
generate_one_block  0.6483719348907471
generate_one_block  0.657651424407959
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  4.591196060180664
block generation total time  4.02774715423584
average batch blocks generation time:  2.01387357711792
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12107086181640625  GigaBytes
Max Memory Allocated: 0.12107086181640625  GigaBytes

torch.Size([167418, 128])
torch.Size([166684, 256])
torch.Size([162820, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5682373046875 GB
    Memory Allocated: 1.985407829284668  GigaBytes
Max Memory Allocated: 2.0967798233032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5115966796875 GB
    Memory Allocated: 0.13008356094360352  GigaBytes
Max Memory Allocated: 2.2395377159118652  GigaBytes

torch.Size([167444, 128])
torch.Size([166756, 256])
torch.Size([162971, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5135498046875 GB
    Memory Allocated: 1.9887909889221191  GigaBytes
Max Memory Allocated: 2.2395377159118652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04600191116333008 |0.16432714462280273 |0.382297158241272 |0.00012695789337158203 |0.12408638000488281 |0.005707979202270508 |
----------------------------------------------------------pseudo_mini_loss sum 6.147871494293213
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1263189
Number of first layer input nodes during this epoch:  334862
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.20512008666992188  GigaBytes
Max Memory Allocated: 2.241896152496338  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.01851367950439453
range selection method range initialization spend 0.013055086135864258
time for parepare:  0.017604827880859375
local_output_nid generation:  0.010541677474975586
local_in_edges_tensor generation:  0.009174823760986328
mini_batch_src_global generation:  0.012949943542480469
r_  generation:  0.16707992553710938
local_output_nid generation:  0.011625051498413086
local_in_edges_tensor generation:  0.010877847671508789
mini_batch_src_global generation:  0.017070770263671875
r_  generation:  0.17880988121032715
----------------------check_connections_block total spend ----------------------------- 0.5036129951477051
generate_one_block  0.2011585235595703
generate_one_block  0.20212888717651367
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043181657791137695
gen group dst list time:  0.00742030143737793
time for parepare:  0.019167184829711914
local_output_nid generation:  0.01645517349243164
local_in_edges_tensor generation:  0.03811287879943848
mini_batch_src_global generation:  0.0447392463684082
r_  generation:  0.4999229907989502
local_output_nid generation:  0.02535700798034668
local_in_edges_tensor generation:  0.04661059379577637
mini_batch_src_global generation:  0.056630611419677734
r_  generation:  0.5049099922180176
----------------------check_connections_block total spend ----------------------------- 1.4704692363739014
generate_one_block  0.6455237865447998
generate_one_block  0.6482036113739014
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03589153289794922
gen group dst list time:  0.011905908584594727
time for parepare:  0.01886749267578125
local_output_nid generation:  0.021654605865478516
local_in_edges_tensor generation:  0.03533768653869629
mini_batch_src_global generation:  0.05285477638244629
r_  generation:  0.54803466796875
local_output_nid generation:  0.03060173988342285
local_in_edges_tensor generation:  0.05103754997253418
mini_batch_src_global generation:  0.06094074249267578
r_  generation:  0.5514299869537354
----------------------check_connections_block total spend ----------------------------- 1.6149823665618896
generate_one_block  0.714257001876831
generate_one_block  0.7116899490356445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0277254581451416
gen group dst list time:  0.012486696243286133
time for parepare:  0.01922440528869629
local_output_nid generation:  0.025869131088256836
local_in_edges_tensor generation:  0.03453969955444336
mini_batch_src_global generation:  0.0445249080657959
r_  generation:  0.5125703811645508
local_output_nid generation:  0.034043073654174805
local_in_edges_tensor generation:  0.04031705856323242
mini_batch_src_global generation:  0.05760335922241211
r_  generation:  0.5129454135894775
----------------------check_connections_block total spend ----------------------------- 1.5121593475341797
generate_one_block  0.6657383441925049
generate_one_block  0.648949146270752
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.20512008666992188  GigaBytes
Max Memory Allocated: 2.241896152496338  GigaBytes

connection checking time:  4.597610950469971
block generation total time  4.034361839294434
average batch blocks generation time:  2.017180919647217
block dataloader generation time/epoch 10.49948501586914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.13178443908691406  GigaBytes
Max Memory Allocated: 2.241896152496338  GigaBytes

torch.Size([167444, 128])
torch.Size([166689, 256])
torch.Size([162842, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 1.9898066520690918  GigaBytes
Max Memory Allocated: 2.241896152496338  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 0.13180065155029297  GigaBytes
Max Memory Allocated: 2.243927478790283  GigaBytes

torch.Size([167399, 128])
torch.Size([166669, 256])
torch.Size([162909, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 1.9895997047424316  GigaBytes
Max Memory Allocated: 2.243927478790283  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11987876892089844 |0.024184584617614746 |0.004487752914428711 |8.797645568847656e-05 |0.0033190250396728516 |0.001627206802368164 |
----------------------------------------------------------pseudo_mini_loss sum 3.2665820121765137
Total (block generation + training)time/epoch 10.981623888015747
Training time/epoch 0.4818875789642334
Training time without block to device /epoch 0.4335184097290039
Training time without total dataloading part /epoch 0.017416715621948242
load block tensor time/epoch 0.23975753784179688
block to device time/epoch 0.04836916923522949
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1262900
Number of first layer input nodes during this epoch:  334843
