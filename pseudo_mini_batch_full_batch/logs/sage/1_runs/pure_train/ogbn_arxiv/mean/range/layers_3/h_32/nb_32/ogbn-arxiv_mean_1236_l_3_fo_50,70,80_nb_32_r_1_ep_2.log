Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648447093.4884229
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027152061462402344
range selection method range initialization spend 0.013310909271240234
time for parepare:  0.017923593521118164
local_output_nid generation:  0.0007114410400390625
local_in_edges_tensor generation:  0.0037889480590820312
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.010288000106811523
local_output_nid generation:  0.0007402896881103516
local_in_edges_tensor generation:  0.00060272216796875
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.009674549102783203
local_output_nid generation:  0.0007522106170654297
local_in_edges_tensor generation:  0.0005259513854980469
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.009624719619750977
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0009109973907470703
r_  generation:  0.009245872497558594
local_output_nid generation:  0.0007281303405761719
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0008940696716308594
r_  generation:  0.00930023193359375
local_output_nid generation:  0.0007448196411132812
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.0008924007415771484
r_  generation:  0.00924372673034668
local_output_nid generation:  0.0007426738739013672
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0009720325469970703
r_  generation:  0.009593963623046875
local_output_nid generation:  0.0007915496826171875
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.00090789794921875
r_  generation:  0.009669065475463867
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.0009436607360839844
r_  generation:  0.010060787200927734
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.001070261001586914
r_  generation:  0.009695053100585938
local_output_nid generation:  0.0007491111755371094
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.00988912582397461
local_output_nid generation:  0.0007448196411132812
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.009893417358398438
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0010330677032470703
r_  generation:  0.009935855865478516
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0010876655578613281
r_  generation:  0.009895801544189453
local_output_nid generation:  0.0007452964782714844
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0009052753448486328
r_  generation:  0.009161233901977539
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0009596347808837891
r_  generation:  0.009747743606567383
local_output_nid generation:  0.0007522106170654297
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009777545928955078
r_  generation:  0.009725332260131836
local_output_nid generation:  0.0007565021514892578
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0009615421295166016
r_  generation:  0.009439706802368164
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.009997367858886719
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.009453058242797852
local_output_nid generation:  0.0007801055908203125
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.0009679794311523438
r_  generation:  0.009653806686401367
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.009781837463378906
local_output_nid generation:  0.0007522106170654297
local_in_edges_tensor generation:  0.00046443939208984375
mini_batch_src_global generation:  0.0009927749633789062
r_  generation:  0.009848356246948242
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0010352134704589844
r_  generation:  0.010102510452270508
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.00046825408935546875
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.010029792785644531
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009961128234863281
r_  generation:  0.009875297546386719
local_output_nid generation:  0.0007398128509521484
local_in_edges_tensor generation:  0.00046539306640625
mini_batch_src_global generation:  0.0009679794311523438
r_  generation:  0.00984954833984375
local_output_nid generation:  0.0007579326629638672
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0010218620300292969
r_  generation:  0.010094404220581055
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009975671768188477
local_output_nid generation:  0.0007374286651611328
local_in_edges_tensor generation:  0.004286050796508789
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010203123092651367
local_output_nid generation:  0.0007848739624023438
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.0010678768157958984
r_  generation:  0.010102272033691406
local_output_nid generation:  0.0007836818695068359
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0010724067687988281
r_  generation:  0.010027885437011719
----------------------check_connections_block total spend ----------------------------- 0.4823312759399414
generate_one_block  0.015523672103881836
generate_one_block  0.014923572540283203
generate_one_block  0.015214204788208008
generate_one_block  0.014787435531616211
generate_one_block  0.014696359634399414
generate_one_block  0.014216423034667969
generate_one_block  0.014693498611450195
generate_one_block  0.014893054962158203
generate_one_block  0.015241146087646484
generate_one_block  0.015139102935791016
generate_one_block  0.015075922012329102
generate_one_block  0.015000343322753906
generate_one_block  0.01512002944946289
generate_one_block  0.015180587768554688
generate_one_block  0.013710260391235352
generate_one_block  0.014495849609375
generate_one_block  0.014618158340454102
generate_one_block  0.01426386833190918
generate_one_block  0.014711380004882812
generate_one_block  0.014205455780029297
generate_one_block  0.014517068862915039
generate_one_block  0.014516592025756836
generate_one_block  0.014907598495483398
generate_one_block  0.015233755111694336
generate_one_block  0.015137672424316406
generate_one_block  0.014708995819091797
generate_one_block  0.014415264129638672
generate_one_block  0.01535797119140625
generate_one_block  0.015088796615600586
generate_one_block  0.015001773834228516
generate_one_block  0.015128374099731445
generate_one_block  0.015018224716186523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.045089006423950195
gen group dst list time:  0.023670673370361328
time for parepare:  0.019517898559570312
local_output_nid generation:  0.004283905029296875
local_in_edges_tensor generation:  0.013326883316040039
mini_batch_src_global generation:  0.01659417152404785
r_  generation:  0.15859484672546387
local_output_nid generation:  0.008554935455322266
local_in_edges_tensor generation:  0.014109373092651367
mini_batch_src_global generation:  0.020302534103393555
r_  generation:  0.16255593299865723
local_output_nid generation:  0.008863449096679688
local_in_edges_tensor generation:  0.011544466018676758
mini_batch_src_global generation:  0.019611597061157227
r_  generation:  0.17274022102355957
local_output_nid generation:  0.008603572845458984
local_in_edges_tensor generation:  0.013113260269165039
mini_batch_src_global generation:  0.02097034454345703
r_  generation:  0.17515897750854492
local_output_nid generation:  0.008936643600463867
local_in_edges_tensor generation:  0.010195732116699219
mini_batch_src_global generation:  0.020580291748046875
r_  generation:  0.1753835678100586
local_output_nid generation:  0.008717775344848633
local_in_edges_tensor generation:  0.010130167007446289
mini_batch_src_global generation:  0.020817995071411133
r_  generation:  0.16634511947631836
local_output_nid generation:  0.009102821350097656
local_in_edges_tensor generation:  0.008837699890136719
mini_batch_src_global generation:  0.02236795425415039
r_  generation:  0.17469406127929688
local_output_nid generation:  0.00910186767578125
local_in_edges_tensor generation:  0.011809110641479492
mini_batch_src_global generation:  0.021764039993286133
r_  generation:  0.17388415336608887
local_output_nid generation:  0.009588241577148438
local_in_edges_tensor generation:  0.012341499328613281
mini_batch_src_global generation:  0.024152040481567383
r_  generation:  0.18498849868774414
local_output_nid generation:  0.009274721145629883
local_in_edges_tensor generation:  0.008743047714233398
mini_batch_src_global generation:  0.022114992141723633
r_  generation:  0.1748216152191162
local_output_nid generation:  0.009478330612182617
local_in_edges_tensor generation:  0.009541034698486328
mini_batch_src_global generation:  0.02240729331970215
r_  generation:  0.17586445808410645
local_output_nid generation:  0.009556293487548828
local_in_edges_tensor generation:  0.010710000991821289
mini_batch_src_global generation:  0.023994922637939453
r_  generation:  0.17869186401367188
local_output_nid generation:  0.009703874588012695
local_in_edges_tensor generation:  0.012594223022460938
mini_batch_src_global generation:  0.02286243438720703
r_  generation:  0.18113350868225098
local_output_nid generation:  0.009723663330078125
local_in_edges_tensor generation:  0.010658979415893555
mini_batch_src_global generation:  0.022598743438720703
r_  generation:  0.18019771575927734
local_output_nid generation:  0.009020805358886719
local_in_edges_tensor generation:  0.010026693344116211
mini_batch_src_global generation:  0.023168087005615234
r_  generation:  0.16651368141174316
local_output_nid generation:  0.009342670440673828
local_in_edges_tensor generation:  0.008927583694458008
mini_batch_src_global generation:  0.023221731185913086
r_  generation:  0.17756152153015137
local_output_nid generation:  0.009512901306152344
local_in_edges_tensor generation:  0.011844158172607422
mini_batch_src_global generation:  0.021945714950561523
r_  generation:  0.17437314987182617
local_output_nid generation:  0.009454488754272461
local_in_edges_tensor generation:  0.008764505386352539
mini_batch_src_global generation:  0.021377086639404297
r_  generation:  0.1741654872894287
local_output_nid generation:  0.009590864181518555
local_in_edges_tensor generation:  0.012056112289428711
mini_batch_src_global generation:  0.022370576858520508
r_  generation:  0.17931461334228516
local_output_nid generation:  0.009350061416625977
local_in_edges_tensor generation:  0.008821487426757812
mini_batch_src_global generation:  0.022291183471679688
r_  generation:  0.174940824508667
local_output_nid generation:  0.009569883346557617
local_in_edges_tensor generation:  0.01163482666015625
mini_batch_src_global generation:  0.02196955680847168
r_  generation:  0.17730188369750977
local_output_nid generation:  0.00950002670288086
local_in_edges_tensor generation:  0.013496160507202148
mini_batch_src_global generation:  0.022139310836791992
r_  generation:  0.1786181926727295
local_output_nid generation:  0.009679317474365234
local_in_edges_tensor generation:  0.013744354248046875
mini_batch_src_global generation:  0.022464990615844727
r_  generation:  0.18192291259765625
local_output_nid generation:  0.009946346282958984
local_in_edges_tensor generation:  0.00978851318359375
mini_batch_src_global generation:  0.023622989654541016
r_  generation:  0.1887507438659668
local_output_nid generation:  0.00992441177368164
local_in_edges_tensor generation:  0.012538433074951172
mini_batch_src_global generation:  0.0233457088470459
r_  generation:  0.1836538314819336
local_output_nid generation:  0.009595155715942383
local_in_edges_tensor generation:  0.009203195571899414
mini_batch_src_global generation:  0.022722244262695312
r_  generation:  0.17638325691223145
local_output_nid generation:  0.009596586227416992
local_in_edges_tensor generation:  0.010344266891479492
mini_batch_src_global generation:  0.022614240646362305
r_  generation:  0.18223237991333008
local_output_nid generation:  0.009909391403198242
local_in_edges_tensor generation:  0.012662649154663086
mini_batch_src_global generation:  0.02472543716430664
r_  generation:  0.18436288833618164
local_output_nid generation:  0.009851694107055664
local_in_edges_tensor generation:  0.009632587432861328
mini_batch_src_global generation:  0.023013830184936523
r_  generation:  0.18075299263000488
local_output_nid generation:  0.009830713272094727
local_in_edges_tensor generation:  0.010751008987426758
mini_batch_src_global generation:  0.024491071701049805
r_  generation:  0.18586468696594238
local_output_nid generation:  0.009685993194580078
local_in_edges_tensor generation:  0.00944828987121582
mini_batch_src_global generation:  0.022542715072631836
r_  generation:  0.18163371086120605
local_output_nid generation:  0.01005864143371582
local_in_edges_tensor generation:  0.012939929962158203
mini_batch_src_global generation:  0.02337360382080078
r_  generation:  0.18501901626586914
----------------------check_connections_block total spend ----------------------------- 8.344738245010376
generate_one_block  0.23453760147094727
generate_one_block  0.22448182106018066
generate_one_block  0.2604982852935791
generate_one_block  0.23528575897216797
generate_one_block  0.22766494750976562
generate_one_block  0.21502232551574707
generate_one_block  0.22232604026794434
generate_one_block  0.23132085800170898
generate_one_block  0.2523312568664551
generate_one_block  0.23397231101989746
generate_one_block  0.23442316055297852
generate_one_block  0.24695873260498047
generate_one_block  0.25249481201171875
generate_one_block  0.23490095138549805
generate_one_block  0.21721124649047852
generate_one_block  0.2568519115447998
generate_one_block  0.2227628231048584
generate_one_block  0.21565937995910645
generate_one_block  0.2324521541595459
generate_one_block  0.2203197479248047
generate_one_block  0.21919012069702148
generate_one_block  0.22825956344604492
generate_one_block  0.24083828926086426
generate_one_block  0.25380659103393555
generate_one_block  0.24098515510559082
generate_one_block  0.23675131797790527
generate_one_block  0.23006153106689453
generate_one_block  0.24191069602966309
generate_one_block  0.23795342445373535
generate_one_block  0.23890185356140137
generate_one_block  0.23185014724731445
generate_one_block  0.24039244651794434
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05821585655212402
gen group dst list time:  0.1175234317779541
time for parepare:  0.020480632781982422
local_output_nid generation:  0.02286076545715332
local_in_edges_tensor generation:  0.04666495323181152
mini_batch_src_global generation:  0.0578160285949707
r_  generation:  0.47593045234680176
local_output_nid generation:  0.028703689575195312
local_in_edges_tensor generation:  0.049042701721191406
mini_batch_src_global generation:  0.058338165283203125
r_  generation:  0.4790079593658447
local_output_nid generation:  0.029277801513671875
local_in_edges_tensor generation:  0.05195164680480957
mini_batch_src_global generation:  0.05724930763244629
r_  generation:  0.5108697414398193
local_output_nid generation:  0.02854466438293457
local_in_edges_tensor generation:  0.04327058792114258
mini_batch_src_global generation:  0.06652307510375977
r_  generation:  0.4897456169128418
local_output_nid generation:  0.031540870666503906
local_in_edges_tensor generation:  0.04107666015625
mini_batch_src_global generation:  0.06390523910522461
r_  generation:  0.49015021324157715
local_output_nid generation:  0.028342485427856445
local_in_edges_tensor generation:  0.03457164764404297
mini_batch_src_global generation:  0.06067681312561035
r_  generation:  0.4864013195037842
local_output_nid generation:  0.028782129287719727
local_in_edges_tensor generation:  0.03262662887573242
mini_batch_src_global generation:  0.05897188186645508
r_  generation:  0.4925522804260254
local_output_nid generation:  0.02837061882019043
local_in_edges_tensor generation:  0.03399395942687988
mini_batch_src_global generation:  0.05866384506225586
r_  generation:  0.4997851848602295
local_output_nid generation:  0.028971195220947266
local_in_edges_tensor generation:  0.04155611991882324
mini_batch_src_global generation:  0.05854964256286621
r_  generation:  0.5079271793365479
local_output_nid generation:  0.028694629669189453
local_in_edges_tensor generation:  0.03243660926818848
mini_batch_src_global generation:  0.05894923210144043
r_  generation:  0.4962351322174072
local_output_nid generation:  0.028632164001464844
local_in_edges_tensor generation:  0.05456137657165527
mini_batch_src_global generation:  0.061946868896484375
r_  generation:  0.5003809928894043
local_output_nid generation:  0.029100656509399414
local_in_edges_tensor generation:  0.03686022758483887
mini_batch_src_global generation:  0.05843186378479004
r_  generation:  0.5001809597015381
local_output_nid generation:  0.029651165008544922
local_in_edges_tensor generation:  0.033416748046875
mini_batch_src_global generation:  0.05862927436828613
r_  generation:  0.5063297748565674
local_output_nid generation:  0.029146909713745117
local_in_edges_tensor generation:  0.039797306060791016
mini_batch_src_global generation:  0.06411480903625488
r_  generation:  0.5167975425720215
local_output_nid generation:  0.03048992156982422
local_in_edges_tensor generation:  0.03270912170410156
mini_batch_src_global generation:  0.0641932487487793
r_  generation:  0.4908478260040283
local_output_nid generation:  0.02888774871826172
local_in_edges_tensor generation:  0.029836654663085938
mini_batch_src_global generation:  0.06177330017089844
r_  generation:  0.4932992458343506
local_output_nid generation:  0.02871084213256836
local_in_edges_tensor generation:  0.03231930732727051
mini_batch_src_global generation:  0.05748701095581055
r_  generation:  0.4961519241333008
local_output_nid generation:  0.02874922752380371
local_in_edges_tensor generation:  0.03263401985168457
mini_batch_src_global generation:  0.058547019958496094
r_  generation:  0.49279308319091797
local_output_nid generation:  0.028577566146850586
local_in_edges_tensor generation:  0.03169655799865723
mini_batch_src_global generation:  0.058164119720458984
r_  generation:  0.4998042583465576
local_output_nid generation:  0.028723716735839844
local_in_edges_tensor generation:  0.03665661811828613
mini_batch_src_global generation:  0.05778050422668457
r_  generation:  0.5065841674804688
local_output_nid generation:  0.02892327308654785
local_in_edges_tensor generation:  0.03245401382446289
mini_batch_src_global generation:  0.05785775184631348
r_  generation:  0.4972522258758545
local_output_nid generation:  0.02887701988220215
local_in_edges_tensor generation:  0.03242206573486328
mini_batch_src_global generation:  0.058183908462524414
r_  generation:  0.5002014636993408
local_output_nid generation:  0.02877521514892578
local_in_edges_tensor generation:  0.037111520767211914
mini_batch_src_global generation:  0.06200814247131348
r_  generation:  0.4992649555206299
local_output_nid generation:  0.029319047927856445
local_in_edges_tensor generation:  0.03286266326904297
mini_batch_src_global generation:  0.05838179588317871
r_  generation:  0.5012993812561035
local_output_nid generation:  0.02939152717590332
local_in_edges_tensor generation:  0.043100833892822266
mini_batch_src_global generation:  0.05905294418334961
r_  generation:  0.4981727600097656
local_output_nid generation:  0.028728723526000977
local_in_edges_tensor generation:  0.02861809730529785
mini_batch_src_global generation:  0.058302879333496094
r_  generation:  0.4933509826660156
local_output_nid generation:  0.028814077377319336
local_in_edges_tensor generation:  0.027843713760375977
mini_batch_src_global generation:  0.05944561958312988
r_  generation:  0.5057055950164795
local_output_nid generation:  0.029302358627319336
local_in_edges_tensor generation:  0.03336501121520996
mini_batch_src_global generation:  0.06312942504882812
r_  generation:  0.5004274845123291
local_output_nid generation:  0.02897930145263672
local_in_edges_tensor generation:  0.03245377540588379
mini_batch_src_global generation:  0.058278560638427734
r_  generation:  0.5015842914581299
local_output_nid generation:  0.029967308044433594
local_in_edges_tensor generation:  0.028489112854003906
mini_batch_src_global generation:  0.05888795852661133
r_  generation:  0.4955930709838867
local_output_nid generation:  0.028921127319335938
local_in_edges_tensor generation:  0.03192567825317383
mini_batch_src_global generation:  0.05760955810546875
r_  generation:  0.4994480609893799
local_output_nid generation:  0.02901291847229004
local_in_edges_tensor generation:  0.03779768943786621
mini_batch_src_global generation:  0.05829930305480957
r_  generation:  0.49667906761169434
----------------------check_connections_block total spend ----------------------------- 23.391236543655396
generate_one_block  0.77390456199646
generate_one_block  0.6413450241088867
generate_one_block  0.6487853527069092
generate_one_block  0.6515281200408936
generate_one_block  0.6584348678588867
generate_one_block  0.6324400901794434
generate_one_block  0.6436843872070312
generate_one_block  0.6456782817840576
generate_one_block  0.6641902923583984
generate_one_block  0.6385259628295898
generate_one_block  0.6432476043701172
generate_one_block  0.647223711013794
generate_one_block  0.6518251895904541
generate_one_block  0.6531121730804443
generate_one_block  0.6255311965942383
generate_one_block  0.6298496723175049
generate_one_block  0.642174243927002
generate_one_block  0.6267540454864502
generate_one_block  0.6503822803497314
generate_one_block  0.6493222713470459
generate_one_block  0.6570508480072021
generate_one_block  0.6423501968383789
generate_one_block  0.6570098400115967
generate_one_block  0.6507549285888672
generate_one_block  0.6632282733917236
generate_one_block  0.6289715766906738
generate_one_block  0.6317136287689209
generate_one_block  0.65592360496521
generate_one_block  0.6368238925933838
generate_one_block  0.6421222686767578
generate_one_block  0.6374125480651855
generate_one_block  0.6438977718353271
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  31.73597478866577
block generation total time  28.277575969696045
average batch blocks generation time:  0.8836742490530014
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08859395980834961  GigaBytes
Max Memory Allocated: 0.08859395980834961  GigaBytes

torch.Size([150205, 128])
torch.Size([109665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4510498046875 GB
    Memory Allocated: 0.16445302963256836  GigaBytes
Max Memory Allocated: 0.1661825180053711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08893203735351562  GigaBytes
Max Memory Allocated: 0.1840667724609375  GigaBytes

torch.Size([149923, 128])
torch.Size([109069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1643357276916504  GigaBytes
Max Memory Allocated: 0.1840667724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08925437927246094  GigaBytes
Max Memory Allocated: 0.1840667724609375  GigaBytes

torch.Size([150853, 128])
torch.Size([111133, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16630077362060547  GigaBytes
Max Memory Allocated: 0.1840667724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08911705017089844  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149946, 128])
torch.Size([109368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16453170776367188  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902263641357422  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150318, 128])
torch.Size([109890, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16475200653076172  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.088714599609375  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150150, 128])
torch.Size([109098, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16278409957885742  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08891773223876953  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150336, 128])
torch.Size([109610, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16458606719970703  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08894824981689453  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150054, 128])
torch.Size([108948, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1642599105834961  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08929920196533203  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149802, 128])
torch.Size([110574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16519975662231445  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08896636962890625  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149964, 128])
torch.Size([109389, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1643366813659668  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08905506134033203  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150456, 128])
torch.Size([109666, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1646409034729004  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08919239044189453  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150578, 128])
torch.Size([110647, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16501379013061523  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08923149108886719  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149805, 128])
torch.Size([109790, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648550033569336  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0892343521118164  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150594, 128])
torch.Size([110795, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16520404815673828  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08850526809692383  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150425, 128])
torch.Size([108404, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1612410545349121  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08899879455566406  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149784, 128])
torch.Size([109208, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16433238983154297  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08891773223876953  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150041, 128])
torch.Size([109484, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16451263427734375  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08875846862792969  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150095, 128])
torch.Size([109592, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16315650939941406  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902931213378906  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149882, 128])
torch.Size([109354, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16447067260742188  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08886146545410156  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150005, 128])
torch.Size([108986, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16306829452514648  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08882999420166016  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150381, 128])
torch.Size([109232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16324615478515625  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08894062042236328  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150027, 128])
torch.Size([109485, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1643977165222168  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08913993835449219  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150157, 128])
torch.Size([110072, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648240089416504  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08920955657958984  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150321, 128])
torch.Size([110461, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16498422622680664  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08922576904296875  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150378, 128])
torch.Size([110959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1652216911315918  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08891582489013672  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149920, 128])
torch.Size([109587, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16454172134399414  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08896827697753906  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150132, 128])
torch.Size([108900, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16422319412231445  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08921241760253906  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150215, 128])
torch.Size([110700, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16514301300048828  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0890798568725586  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150103, 128])
torch.Size([109970, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16485595703125  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08909320831298828  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150215, 128])
torch.Size([110164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16486549377441406  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08901500701904297  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149888, 128])
torch.Size([109289, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16442060470581055  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08916759490966797  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150427, 128])
torch.Size([110151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16485309600830078  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029215477406978607 |0.02391577512025833 |0.02602192759513855 |9.05841588973999e-05 |0.004784621298313141 |0.001895904541015625 |
----------------------------------------------------------pseudo_mini_loss sum 5.0531907081604
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9157005
Number of first layer input nodes during this epoch:  4805380
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12452030181884766  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023468732833862305
range selection method range initialization spend 0.015110492706298828
time for parepare:  0.018543243408203125
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.007466316223144531
mini_batch_src_global generation:  0.0020072460174560547
r_  generation:  0.011455297470092773
local_output_nid generation:  0.0009996891021728516
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.0015211105346679688
r_  generation:  0.010401725769042969
local_output_nid generation:  0.0010094642639160156
local_in_edges_tensor generation:  0.0005457401275634766
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.009323835372924805
local_output_nid generation:  0.0009608268737792969
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0009593963623046875
r_  generation:  0.011102676391601562
local_output_nid generation:  0.0009481906890869141
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0010678768157958984
r_  generation:  0.00942087173461914
local_output_nid generation:  0.0009343624114990234
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0009799003601074219
r_  generation:  0.009734153747558594
local_output_nid generation:  0.0009341239929199219
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.009806156158447266
local_output_nid generation:  0.0009050369262695312
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.009748697280883789
local_output_nid generation:  0.0009121894836425781
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.010245084762573242
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.001032114028930664
r_  generation:  0.01000356674194336
local_output_nid generation:  0.0009379386901855469
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009961128234863281
r_  generation:  0.009933710098266602
local_output_nid generation:  0.0009369850158691406
local_in_edges_tensor generation:  0.0019383430480957031
mini_batch_src_global generation:  0.001009225845336914
r_  generation:  0.010460615158081055
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.010393857955932617
local_output_nid generation:  0.0009374618530273438
local_in_edges_tensor generation:  0.0005381107330322266
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.009911775588989258
local_output_nid generation:  0.0008771419525146484
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.009888410568237305
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.0010156631469726562
r_  generation:  0.009701013565063477
local_output_nid generation:  0.0008690357208251953
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.00965261459350586
local_output_nid generation:  0.00087738037109375
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0010228157043457031
r_  generation:  0.010110616683959961
local_output_nid generation:  0.0008947849273681641
local_in_edges_tensor generation:  0.0005025863647460938
mini_batch_src_global generation:  0.0010287761688232422
r_  generation:  0.011185407638549805
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0010731220245361328
r_  generation:  0.0103607177734375
local_output_nid generation:  0.0008945465087890625
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.010068655014038086
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0010118484497070312
r_  generation:  0.010280847549438477
local_output_nid generation:  0.0008955001831054688
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.010101318359375
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010500907897949219
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.010333061218261719
local_output_nid generation:  0.0008730888366699219
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.001055002212524414
r_  generation:  0.011682510375976562
local_output_nid generation:  0.0009229183197021484
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0011448860168457031
r_  generation:  0.010663509368896484
local_output_nid generation:  0.0008919239044189453
local_in_edges_tensor generation:  0.0005066394805908203
mini_batch_src_global generation:  0.001104116439819336
r_  generation:  0.010368585586547852
local_output_nid generation:  0.0008957386016845703
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.010271787643432617
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.001024007797241211
r_  generation:  0.010035037994384766
local_output_nid generation:  0.0008838176727294922
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.010078668594360352
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.010244131088256836
----------------------check_connections_block total spend ----------------------------- 0.5077023506164551
generate_one_block  0.020915985107421875
generate_one_block  0.01636028289794922
generate_one_block  0.014804840087890625
generate_one_block  0.014531850814819336
generate_one_block  0.014843940734863281
generate_one_block  0.014676809310913086
generate_one_block  0.014738798141479492
generate_one_block  0.01622796058654785
generate_one_block  0.015175580978393555
generate_one_block  0.01503896713256836
generate_one_block  0.014703512191772461
generate_one_block  0.01527547836303711
generate_one_block  0.01508021354675293
generate_one_block  0.01597738265991211
generate_one_block  0.014188051223754883
generate_one_block  0.014512777328491211
generate_one_block  0.014426231384277344
generate_one_block  0.015015125274658203
generate_one_block  0.015057802200317383
generate_one_block  0.015881776809692383
generate_one_block  0.017382144927978516
generate_one_block  0.01508021354675293
generate_one_block  0.015130996704101562
generate_one_block  0.016034364700317383
generate_one_block  0.014905929565429688
generate_one_block  0.015175819396972656
generate_one_block  0.01604461669921875
generate_one_block  0.01841592788696289
generate_one_block  0.015388011932373047
generate_one_block  0.01483297348022461
generate_one_block  0.014946222305297852
generate_one_block  0.015187978744506836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04612278938293457
gen group dst list time:  0.023957014083862305
time for parepare:  0.01911330223083496
local_output_nid generation:  0.00422978401184082
local_in_edges_tensor generation:  0.01587677001953125
mini_batch_src_global generation:  0.01659417152404785
r_  generation:  0.15960001945495605
local_output_nid generation:  0.0066165924072265625
local_in_edges_tensor generation:  0.013830184936523438
mini_batch_src_global generation:  0.021728038787841797
r_  generation:  0.1686239242553711
local_output_nid generation:  0.006984710693359375
local_in_edges_tensor generation:  0.03311324119567871
mini_batch_src_global generation:  0.019255876541137695
r_  generation:  0.17006683349609375
local_output_nid generation:  0.007168292999267578
local_in_edges_tensor generation:  0.01128077507019043
mini_batch_src_global generation:  0.023359298706054688
r_  generation:  0.17076897621154785
local_output_nid generation:  0.008863449096679688
local_in_edges_tensor generation:  0.01770639419555664
mini_batch_src_global generation:  0.023424386978149414
r_  generation:  0.2320573329925537
local_output_nid generation:  0.00941324234008789
local_in_edges_tensor generation:  0.013060331344604492
mini_batch_src_global generation:  0.024785995483398438
r_  generation:  0.20038533210754395
local_output_nid generation:  0.011931180953979492
local_in_edges_tensor generation:  0.014433860778808594
mini_batch_src_global generation:  0.022166013717651367
r_  generation:  0.18176031112670898
local_output_nid generation:  0.013813972473144531
local_in_edges_tensor generation:  0.023348569869995117
mini_batch_src_global generation:  0.0463869571685791
r_  generation:  0.19234561920166016
local_output_nid generation:  0.008824586868286133
local_in_edges_tensor generation:  0.011664628982543945
mini_batch_src_global generation:  0.03030872344970703
r_  generation:  0.20257949829101562
local_output_nid generation:  0.008681297302246094
local_in_edges_tensor generation:  0.01077580451965332
mini_batch_src_global generation:  0.025714635848999023
r_  generation:  0.21181225776672363
local_output_nid generation:  0.010912656784057617
local_in_edges_tensor generation:  0.026433944702148438
mini_batch_src_global generation:  0.02749180793762207
r_  generation:  0.19562745094299316
local_output_nid generation:  0.00838923454284668
local_in_edges_tensor generation:  0.010259151458740234
mini_batch_src_global generation:  0.027545690536499023
r_  generation:  0.20805048942565918
local_output_nid generation:  0.008538961410522461
local_in_edges_tensor generation:  0.012012004852294922
mini_batch_src_global generation:  0.026401519775390625
r_  generation:  0.19916462898254395
local_output_nid generation:  0.011671066284179688
local_in_edges_tensor generation:  0.008890151977539062
mini_batch_src_global generation:  0.026800870895385742
r_  generation:  0.19919300079345703
local_output_nid generation:  0.007992029190063477
local_in_edges_tensor generation:  0.009530067443847656
mini_batch_src_global generation:  0.0250246524810791
r_  generation:  0.19322586059570312
local_output_nid generation:  0.008136272430419922
local_in_edges_tensor generation:  0.012121200561523438
mini_batch_src_global generation:  0.02660989761352539
r_  generation:  0.21405291557312012
local_output_nid generation:  0.011114120483398438
local_in_edges_tensor generation:  0.014870166778564453
mini_batch_src_global generation:  0.027718782424926758
r_  generation:  0.17601370811462402
local_output_nid generation:  0.008428335189819336
local_in_edges_tensor generation:  0.013553619384765625
mini_batch_src_global generation:  0.02424788475036621
r_  generation:  0.18150711059570312
local_output_nid generation:  0.008178949356079102
local_in_edges_tensor generation:  0.011608600616455078
mini_batch_src_global generation:  0.022649288177490234
r_  generation:  0.23678112030029297
local_output_nid generation:  0.008494853973388672
local_in_edges_tensor generation:  0.01248931884765625
mini_batch_src_global generation:  0.02712559700012207
r_  generation:  0.19235825538635254
local_output_nid generation:  0.007912158966064453
local_in_edges_tensor generation:  0.0086517333984375
mini_batch_src_global generation:  0.025005340576171875
r_  generation:  0.18112611770629883
local_output_nid generation:  0.007912158966064453
local_in_edges_tensor generation:  0.008645296096801758
mini_batch_src_global generation:  0.027536869049072266
r_  generation:  0.18934202194213867
local_output_nid generation:  0.011046648025512695
local_in_edges_tensor generation:  0.01692962646484375
mini_batch_src_global generation:  0.026228666305541992
r_  generation:  0.19740581512451172
local_output_nid generation:  0.01015019416809082
local_in_edges_tensor generation:  0.015245199203491211
mini_batch_src_global generation:  0.02785944938659668
r_  generation:  0.19265985488891602
local_output_nid generation:  0.008141756057739258
local_in_edges_tensor generation:  0.01132965087890625
mini_batch_src_global generation:  0.026140689849853516
r_  generation:  0.23216629028320312
local_output_nid generation:  0.007927656173706055
local_in_edges_tensor generation:  0.010137319564819336
mini_batch_src_global generation:  0.026322603225708008
r_  generation:  0.19147825241088867
local_output_nid generation:  0.008400917053222656
local_in_edges_tensor generation:  0.01195526123046875
mini_batch_src_global generation:  0.025333404541015625
r_  generation:  0.20595121383666992
local_output_nid generation:  0.012243032455444336
local_in_edges_tensor generation:  0.01644301414489746
mini_batch_src_global generation:  0.024205446243286133
r_  generation:  0.19005966186523438
local_output_nid generation:  0.008354425430297852
local_in_edges_tensor generation:  0.011669635772705078
mini_batch_src_global generation:  0.02377176284790039
r_  generation:  0.19656944274902344
local_output_nid generation:  0.008140802383422852
local_in_edges_tensor generation:  0.01038813591003418
mini_batch_src_global generation:  0.022855043411254883
r_  generation:  0.1982555389404297
local_output_nid generation:  0.00827336311340332
local_in_edges_tensor generation:  0.008685588836669922
mini_batch_src_global generation:  0.02433180809020996
r_  generation:  0.1906113624572754
local_output_nid generation:  0.008359432220458984
local_in_edges_tensor generation:  0.010149478912353516
mini_batch_src_global generation:  0.02288198471069336
r_  generation:  0.19098114967346191
----------------------check_connections_block total spend ----------------------------- 9.208508253097534
generate_one_block  0.22989320755004883
generate_one_block  0.22151613235473633
generate_one_block  0.22425532341003418
generate_one_block  0.22129607200622559
generate_one_block  0.23885416984558105
generate_one_block  0.2265470027923584
generate_one_block  0.2300879955291748
generate_one_block  0.22335457801818848
generate_one_block  0.23469829559326172
generate_one_block  0.2236802577972412
generate_one_block  0.22220897674560547
generate_one_block  0.23061537742614746
generate_one_block  0.23951196670532227
generate_one_block  0.22135615348815918
generate_one_block  0.2151482105255127
generate_one_block  0.2198638916015625
generate_one_block  0.21802186965942383
generate_one_block  0.23456287384033203
generate_one_block  0.22529244422912598
generate_one_block  0.2787346839904785
generate_one_block  0.22170090675354004
generate_one_block  0.23296666145324707
generate_one_block  0.2426753044128418
generate_one_block  0.24094271659851074
generate_one_block  0.23703312873840332
generate_one_block  0.22821640968322754
generate_one_block  0.24077463150024414
generate_one_block  0.23813199996948242
generate_one_block  0.23416876792907715
generate_one_block  0.22403645515441895
generate_one_block  0.22430729866027832
generate_one_block  0.22822022438049316
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0476381778717041
gen group dst list time:  0.1253795623779297
time for parepare:  0.022237539291381836
local_output_nid generation:  0.031525373458862305
local_in_edges_tensor generation:  0.061586856842041016
mini_batch_src_global generation:  0.04747343063354492
r_  generation:  0.524010419845581
local_output_nid generation:  0.031775474548339844
local_in_edges_tensor generation:  0.04967665672302246
mini_batch_src_global generation:  0.06266093254089355
r_  generation:  0.5027821063995361
local_output_nid generation:  0.028325319290161133
local_in_edges_tensor generation:  0.044912099838256836
mini_batch_src_global generation:  0.060013771057128906
r_  generation:  0.5306453704833984
local_output_nid generation:  0.02902841567993164
local_in_edges_tensor generation:  0.05929207801818848
mini_batch_src_global generation:  0.0949406623840332
r_  generation:  0.544205904006958
local_output_nid generation:  0.0359799861907959
local_in_edges_tensor generation:  0.0379638671875
mini_batch_src_global generation:  0.06450533866882324
r_  generation:  0.5437779426574707
local_output_nid generation:  0.0323481559753418
local_in_edges_tensor generation:  0.03760123252868652
mini_batch_src_global generation:  0.07971763610839844
r_  generation:  0.5079329013824463
local_output_nid generation:  0.03448820114135742
local_in_edges_tensor generation:  0.036792755126953125
mini_batch_src_global generation:  0.06423783302307129
r_  generation:  0.5285372734069824
local_output_nid generation:  0.03140664100646973
local_in_edges_tensor generation:  0.043688058853149414
mini_batch_src_global generation:  0.062042951583862305
r_  generation:  0.5165247917175293
local_output_nid generation:  0.03175973892211914
local_in_edges_tensor generation:  0.03223133087158203
mini_batch_src_global generation:  0.06971979141235352
r_  generation:  0.5505619049072266
local_output_nid generation:  0.0340576171875
local_in_edges_tensor generation:  0.04805469512939453
mini_batch_src_global generation:  0.0754086971282959
r_  generation:  0.49735283851623535
local_output_nid generation:  0.032027244567871094
local_in_edges_tensor generation:  0.030526161193847656
mini_batch_src_global generation:  0.06070137023925781
r_  generation:  0.5081076622009277
local_output_nid generation:  0.03183388710021973
local_in_edges_tensor generation:  0.027748584747314453
mini_batch_src_global generation:  0.06606912612915039
r_  generation:  0.49593400955200195
local_output_nid generation:  0.03215932846069336
local_in_edges_tensor generation:  0.041596174240112305
mini_batch_src_global generation:  0.058603763580322266
r_  generation:  0.5048084259033203
local_output_nid generation:  0.03170609474182129
local_in_edges_tensor generation:  0.027810096740722656
mini_batch_src_global generation:  0.05925107002258301
r_  generation:  0.495882511138916
local_output_nid generation:  0.03150677680969238
local_in_edges_tensor generation:  0.028644323348999023
mini_batch_src_global generation:  0.057599782943725586
r_  generation:  0.4971334934234619
local_output_nid generation:  0.031976938247680664
local_in_edges_tensor generation:  0.036997318267822266
mini_batch_src_global generation:  0.06257987022399902
r_  generation:  0.4990813732147217
local_output_nid generation:  0.032070159912109375
local_in_edges_tensor generation:  0.03392601013183594
mini_batch_src_global generation:  0.0645604133605957
r_  generation:  0.5079617500305176
local_output_nid generation:  0.03303337097167969
local_in_edges_tensor generation:  0.032572269439697266
mini_batch_src_global generation:  0.06295657157897949
r_  generation:  0.520766019821167
local_output_nid generation:  0.03420448303222656
local_in_edges_tensor generation:  0.03961992263793945
mini_batch_src_global generation:  0.06403350830078125
r_  generation:  0.5002574920654297
local_output_nid generation:  0.03239607810974121
local_in_edges_tensor generation:  0.037560224533081055
mini_batch_src_global generation:  0.0597379207611084
r_  generation:  0.5025656223297119
local_output_nid generation:  0.031813621520996094
local_in_edges_tensor generation:  0.030057430267333984
mini_batch_src_global generation:  0.05853605270385742
r_  generation:  0.512742280960083
local_output_nid generation:  0.0320131778717041
local_in_edges_tensor generation:  0.028357505798339844
mini_batch_src_global generation:  0.05908703804016113
r_  generation:  0.49605894088745117
local_output_nid generation:  0.032097578048706055
local_in_edges_tensor generation:  0.041147708892822266
mini_batch_src_global generation:  0.061881303787231445
r_  generation:  0.5008423328399658
local_output_nid generation:  0.03236079216003418
local_in_edges_tensor generation:  0.037302494049072266
mini_batch_src_global generation:  0.059157609939575195
r_  generation:  0.4988553524017334
local_output_nid generation:  0.03226518630981445
local_in_edges_tensor generation:  0.03692483901977539
mini_batch_src_global generation:  0.0582122802734375
r_  generation:  0.5032987594604492
local_output_nid generation:  0.03214550018310547
local_in_edges_tensor generation:  0.02811717987060547
mini_batch_src_global generation:  0.05946230888366699
r_  generation:  0.5008728504180908
local_output_nid generation:  0.032079458236694336
local_in_edges_tensor generation:  0.028733015060424805
mini_batch_src_global generation:  0.05872297286987305
r_  generation:  0.5114727020263672
local_output_nid generation:  0.032479047775268555
local_in_edges_tensor generation:  0.0459444522857666
mini_batch_src_global generation:  0.05927085876464844
r_  generation:  0.5024867057800293
local_output_nid generation:  0.032709598541259766
local_in_edges_tensor generation:  0.038648128509521484
mini_batch_src_global generation:  0.05965733528137207
r_  generation:  0.5043096542358398
local_output_nid generation:  0.032233238220214844
local_in_edges_tensor generation:  0.027903079986572266
mini_batch_src_global generation:  0.05971217155456543
r_  generation:  0.5005302429199219
local_output_nid generation:  0.032242536544799805
local_in_edges_tensor generation:  0.03246450424194336
mini_batch_src_global generation:  0.0590360164642334
r_  generation:  0.5005526542663574
local_output_nid generation:  0.0333867073059082
local_in_edges_tensor generation:  0.028305530548095703
mini_batch_src_global generation:  0.05916166305541992
r_  generation:  0.5056746006011963
----------------------check_connections_block total spend ----------------------------- 24.16944122314453
generate_one_block  0.6436092853546143
generate_one_block  0.6522848606109619
generate_one_block  0.6669013500213623
generate_one_block  0.6419761180877686
generate_one_block  0.7565884590148926
generate_one_block  0.6292171478271484
generate_one_block  0.6430983543395996
generate_one_block  0.6446411609649658
generate_one_block  0.659156322479248
generate_one_block  0.6613855361938477
generate_one_block  0.6410043239593506
generate_one_block  0.6331555843353271
generate_one_block  0.6597836017608643
generate_one_block  0.6319539546966553
generate_one_block  0.6308748722076416
generate_one_block  0.6382160186767578
generate_one_block  0.6532413959503174
generate_one_block  0.6627638339996338
generate_one_block  0.6439986228942871
generate_one_block  0.6515240669250488
generate_one_block  0.6404097080230713
generate_one_block  0.6525368690490723
generate_one_block  0.6422216892242432
generate_one_block  0.6524801254272461
generate_one_block  0.6684830188751221
generate_one_block  0.6376650333404541
generate_one_block  0.6531367301940918
generate_one_block  0.6603670120239258
generate_one_block  0.6622724533081055
generate_one_block  0.63718581199646
generate_one_block  0.6350743770599365
generate_one_block  0.6396315097808838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.12452030181884766  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

connection checking time:  33.377949476242065
block generation total time  28.19951319694519
average batch blocks generation time:  0.8812347874045372
block dataloader generation time/epoch 64.17677021026611
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08892011642456055  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149576, 128])
torch.Size([108561, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16302061080932617  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08891773223876953  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149761, 128])
torch.Size([108750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16306447982788086  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08909797668457031  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150121, 128])
torch.Size([109709, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16472101211547852  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08899307250976562  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150478, 128])
torch.Size([109729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1634969711303711  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08903694152832031  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150244, 128])
torch.Size([109574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1646723747253418  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902740478515625  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149927, 128])
torch.Size([108799, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16426706314086914  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0890817642211914  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150021, 128])
torch.Size([109036, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16432952880859375  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08902263641357422  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150518, 128])
torch.Size([109401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1644277572631836  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08924293518066406  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150165, 128])
torch.Size([110034, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16492748260498047  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08917427062988281  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150439, 128])
torch.Size([110785, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16527223587036133  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08899116516113281  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150349, 128])
torch.Size([109729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16461563110351562  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08919143676757812  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149791, 128])
torch.Size([109440, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16475200653076172  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08931446075439453  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150370, 128])
torch.Size([110541, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.165130615234375  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0890655517578125  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150016, 128])
torch.Size([109113, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16433143615722656  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08880996704101562  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149793, 128])
torch.Size([108168, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16252613067626953  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08901405334472656  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150104, 128])
torch.Size([109170, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16334247589111328  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08892536163330078  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150270, 128])
torch.Size([109941, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16344022750854492  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08916473388671875  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150112, 128])
torch.Size([110161, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16496753692626953  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08907794952392578  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149956, 128])
torch.Size([109198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16443204879760742  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08944129943847656  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150207, 128])
torch.Size([110612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16496706008911133  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08904457092285156  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150376, 128])
torch.Size([109479, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16455602645874023  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08915233612060547  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150221, 128])
torch.Size([109726, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16472864151000977  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08920478820800781  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150140, 128])
torch.Size([109720, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16473150253295898  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08935260772705078  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150173, 128])
torch.Size([110387, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16521644592285156  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08926010131835938  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149956, 128])
torch.Size([109923, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1649026870727539  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08913993835449219  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([149975, 128])
torch.Size([109728, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16480731964111328  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08936882019042969  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150529, 128])
torch.Size([110458, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1652226448059082  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08934783935546875  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150659, 128])
torch.Size([111004, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16535520553588867  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08930110931396484  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150521, 128])
torch.Size([111557, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1655750274658203  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08915233612060547  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150535, 128])
torch.Size([110041, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16483163833618164  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.0891580581665039  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150415, 128])
torch.Size([110185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.16495180130004883  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.08913993835449219  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

torch.Size([150344, 128])
torch.Size([109842, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.1648874282836914  GigaBytes
Max Memory Allocated: 0.1864180564880371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02017798274755478 |0.011271700263023376 |0.003265202045440674 |8.741766214370728e-05 |0.0036152973771095276 |0.0014357566833496094 |
----------------------------------------------------------pseudo_mini_loss sum 4.349006175994873
Total (block generation + training)time/epoch 65.44727659225464
Training time/epoch 1.270282506942749
Training time without block to device /epoch 0.909588098526001
Training time without total dataloading part /epoch 0.2244091033935547
load block tensor time/epoch 0.6456954479217529
block to device time/epoch 0.36069440841674805
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9157593
Number of first layer input nodes during this epoch:  4806062
