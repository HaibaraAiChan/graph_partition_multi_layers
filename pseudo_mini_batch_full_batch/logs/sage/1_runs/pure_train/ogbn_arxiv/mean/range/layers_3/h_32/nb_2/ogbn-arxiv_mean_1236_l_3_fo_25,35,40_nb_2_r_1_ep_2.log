Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648445443.254602
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023729801177978516
range selection method range initialization spend 0.013931751251220703
time for parepare:  0.017848491668701172
local_output_nid generation:  0.010439872741699219
local_in_edges_tensor generation:  0.01010274887084961
mini_batch_src_global generation:  0.014036417007446289
r_  generation:  0.16923284530639648
local_output_nid generation:  0.011525869369506836
local_in_edges_tensor generation:  0.010532855987548828
mini_batch_src_global generation:  0.017254114151000977
r_  generation:  0.18072867393493652
----------------------check_connections_block total spend ----------------------------- 0.5102534294128418
generate_one_block  0.19927406311035156
generate_one_block  0.20185589790344238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0379180908203125
gen group dst list time:  0.007636547088623047
time for parepare:  0.01949000358581543
local_output_nid generation:  0.016443490982055664
local_in_edges_tensor generation:  0.04125547409057617
mini_batch_src_global generation:  0.04813861846923828
r_  generation:  0.4862406253814697
local_output_nid generation:  0.026033878326416016
local_in_edges_tensor generation:  0.04839181900024414
mini_batch_src_global generation:  0.05592179298400879
r_  generation:  0.5147871971130371
----------------------check_connections_block total spend ----------------------------- 1.4732670783996582
generate_one_block  0.6397533416748047
generate_one_block  0.6750192642211914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04044985771179199
gen group dst list time:  0.014488697052001953
time for parepare:  0.020540237426757812
local_output_nid generation:  0.022176742553710938
local_in_edges_tensor generation:  0.05343151092529297
mini_batch_src_global generation:  0.0489346981048584
r_  generation:  0.5097606182098389
local_output_nid generation:  0.03140592575073242
local_in_edges_tensor generation:  0.04819154739379883
mini_batch_src_global generation:  0.056472063064575195
r_  generation:  0.5207493305206299
----------------------check_connections_block total spend ----------------------------- 1.5342373847961426
generate_one_block  0.6664047241210938
generate_one_block  0.6744968891143799
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  3.007504463195801
block generation total time  2.6556742191314697
average batch blocks generation time:  1.3278371095657349
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10730361938476562  GigaBytes
Max Memory Allocated: 0.10730361938476562  GigaBytes

torch.Size([166433, 128])
torch.Size([162663, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.28831052780151367  GigaBytes
Max Memory Allocated: 0.2950863838195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.11368942260742188  GigaBytes
Max Memory Allocated: 0.3118162155151367  GigaBytes

torch.Size([166411, 128])
torch.Size([162616, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.2871518135070801  GigaBytes
Max Memory Allocated: 0.3118162155151367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03820466995239258 |0.17430877685546875 |0.36712467670440674 |0.0001798868179321289 |0.019643068313598633 |0.003917217254638672 |
----------------------------------------------------------pseudo_mini_loss sum 4.950954437255859
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  927264
Number of first layer input nodes during this epoch:  332844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.17183876037597656  GigaBytes
Max Memory Allocated: 0.3118162155151367  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021751880645751953
range selection method range initialization spend 0.013674736022949219
time for parepare:  0.017920255661010742
local_output_nid generation:  0.010813474655151367
local_in_edges_tensor generation:  0.01014399528503418
mini_batch_src_global generation:  0.015587329864501953
r_  generation:  0.1663515567779541
local_output_nid generation:  0.01425790786743164
local_in_edges_tensor generation:  0.01047205924987793
mini_batch_src_global generation:  0.01709580421447754
r_  generation:  0.1839156150817871
----------------------check_connections_block total spend ----------------------------- 0.5147304534912109
generate_one_block  0.20821571350097656
generate_one_block  0.20296263694763184
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032581329345703125
gen group dst list time:  0.00748443603515625
time for parepare:  0.01936650276184082
local_output_nid generation:  0.01646566390991211
local_in_edges_tensor generation:  0.041458845138549805
mini_batch_src_global generation:  0.04913020133972168
r_  generation:  0.487382173538208
local_output_nid generation:  0.026995420455932617
local_in_edges_tensor generation:  0.04443216323852539
mini_batch_src_global generation:  0.05530953407287598
r_  generation:  0.5017890930175781
----------------------check_connections_block total spend ----------------------------- 1.4559407234191895
generate_one_block  0.6500537395477295
generate_one_block  0.676762580871582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04192614555358887
gen group dst list time:  0.01426839828491211
time for parepare:  0.018767356872558594
local_output_nid generation:  0.022431373596191406
local_in_edges_tensor generation:  0.05616044998168945
mini_batch_src_global generation:  0.04563450813293457
r_  generation:  0.5168209075927734
local_output_nid generation:  0.03171396255493164
local_in_edges_tensor generation:  0.048738956451416016
mini_batch_src_global generation:  0.05704021453857422
r_  generation:  0.5208032131195068
----------------------check_connections_block total spend ----------------------------- 1.5461969375610352
generate_one_block  0.6348931789398193
generate_one_block  0.6600785255432129
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.17183876037597656  GigaBytes
Max Memory Allocated: 0.3118162155151367  GigaBytes

connection checking time:  3.0021376609802246
block generation total time  2.6217880249023438
average batch blocks generation time:  1.3108940124511719
block dataloader generation time/epoch 7.421372413635254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.11499166488647461  GigaBytes
Max Memory Allocated: 0.3118162155151367  GigaBytes

torch.Size([166439, 128])
torch.Size([162700, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28812170028686523  GigaBytes
Max Memory Allocated: 0.3118162155151367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.11505270004272461  GigaBytes
Max Memory Allocated: 0.31181955337524414  GigaBytes

torch.Size([166392, 128])
torch.Size([162618, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28829288482666016  GigaBytes
Max Memory Allocated: 0.31181955337524414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03392529487609863 |0.016783714294433594 |0.004908561706542969 |0.00011229515075683594 |0.004500150680541992 |0.0017580986022949219 |
----------------------------------------------------------pseudo_mini_loss sum 4.279047966003418
Total (block generation + training)time/epoch 7.573454856872559
Training time/epoch 0.15182209014892578
Training time without block to device /epoch 0.1182546615600586
Training time without total dataloading part /epoch 0.020800113677978516
load block tensor time/epoch 0.06785058975219727
block to device time/epoch 0.03356742858886719
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  927254
Number of first layer input nodes during this epoch:  332831
