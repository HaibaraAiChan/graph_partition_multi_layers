Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648483902.0984
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024465084075927734
range selection method range initialization spend 0.013700723648071289
time for parepare:  0.017660140991210938
local_output_nid generation:  0.005312442779541016
local_in_edges_tensor generation:  0.006039857864379883
mini_batch_src_global generation:  0.006668806076049805
r_  generation:  0.0843970775604248
local_output_nid generation:  0.0060465335845947266
local_in_edges_tensor generation:  0.0030117034912109375
mini_batch_src_global generation:  0.008717775344848633
r_  generation:  0.0877845287322998
local_output_nid generation:  0.006115436553955078
local_in_edges_tensor generation:  0.0030057430267333984
mini_batch_src_global generation:  0.006395578384399414
r_  generation:  0.08909392356872559
local_output_nid generation:  0.006146430969238281
local_in_edges_tensor generation:  0.002972841262817383
mini_batch_src_global generation:  0.006967306137084961
r_  generation:  0.09112882614135742
----------------------check_connections_block total spend ----------------------------- 0.5086004734039307
generate_one_block  0.10069990158081055
generate_one_block  0.10201263427734375
generate_one_block  0.10187196731567383
generate_one_block  0.10190176963806152
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0402066707611084
gen group dst list time:  0.011430501937866211
time for parepare:  0.01925945281982422
local_output_nid generation:  0.01435995101928711
local_in_edges_tensor generation:  0.03614354133605957
mini_batch_src_global generation:  0.041864633560180664
r_  generation:  0.4059107303619385
local_output_nid generation:  0.02114081382751465
local_in_edges_tensor generation:  0.03616476058959961
mini_batch_src_global generation:  0.04886960983276367
r_  generation:  0.41516923904418945
local_output_nid generation:  0.021911144256591797
local_in_edges_tensor generation:  0.029613971710205078
mini_batch_src_global generation:  0.04969167709350586
r_  generation:  0.4273498058319092
local_output_nid generation:  0.022434711456298828
local_in_edges_tensor generation:  0.023059606552124023
mini_batch_src_global generation:  0.049738407135009766
r_  generation:  0.4206087589263916
----------------------check_connections_block total spend ----------------------------- 2.4377901554107666
generate_one_block  0.5615057945251465
generate_one_block  0.5422282218933105
generate_one_block  0.5432384014129639
generate_one_block  0.5381679534912109
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03550124168395996
gen group dst list time:  0.021032333374023438
time for parepare:  0.018960952758789062
local_output_nid generation:  0.02360987663269043
local_in_edges_tensor generation:  0.04106903076171875
mini_batch_src_global generation:  0.052529096603393555
r_  generation:  0.5317530632019043
local_output_nid generation:  0.03241682052612305
local_in_edges_tensor generation:  0.04954838752746582
mini_batch_src_global generation:  0.06436347961425781
r_  generation:  0.5334947109222412
local_output_nid generation:  0.032707929611206055
local_in_edges_tensor generation:  0.0425410270690918
mini_batch_src_global generation:  0.05675458908081055
r_  generation:  0.5497441291809082
local_output_nid generation:  0.03332924842834473
local_in_edges_tensor generation:  0.03687644004821777
mini_batch_src_global generation:  0.05552339553833008
r_  generation:  0.548621654510498
----------------------check_connections_block total spend ----------------------------- 3.1626861095428467
generate_one_block  0.6707756519317627
generate_one_block  0.6806046962738037
generate_one_block  0.6925442218780518
generate_one_block  0.6814985275268555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026409149169921875
gen group dst list time:  0.02392721176147461
time for parepare:  0.01870441436767578
local_output_nid generation:  0.02684330940246582
local_in_edges_tensor generation:  0.03717970848083496
mini_batch_src_global generation:  0.045012474060058594
r_  generation:  0.5002694129943848
local_output_nid generation:  0.03418707847595215
local_in_edges_tensor generation:  0.03620123863220215
mini_batch_src_global generation:  0.057363271713256836
r_  generation:  0.5086567401885986
local_output_nid generation:  0.034956932067871094
local_in_edges_tensor generation:  0.04202151298522949
mini_batch_src_global generation:  0.06158781051635742
r_  generation:  0.5109822750091553
local_output_nid generation:  0.03513026237487793
local_in_edges_tensor generation:  0.03684568405151367
mini_batch_src_global generation:  0.0573420524597168
r_  generation:  0.51188063621521
----------------------check_connections_block total spend ----------------------------- 3.0109283924102783
generate_one_block  0.6399185657501221
generate_one_block  0.6672401428222656
generate_one_block  0.645582914352417
generate_one_block  0.6245791912078857
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  8.611404657363892
block generation total time  7.487884283065796
average batch blocks generation time:  1.871971070766449
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11725664138793945  GigaBytes
Max Memory Allocated: 0.11725664138793945  GigaBytes

torch.Size([166685, 128])
torch.Size([164626, 256])
torch.Size([154897, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 1.7965078353881836  GigaBytes
Max Memory Allocated: 1.8843789100646973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 0.12298250198364258  GigaBytes
Max Memory Allocated: 1.9896416664123535  GigaBytes

torch.Size([166701, 128])
torch.Size([164717, 256])
torch.Size([154951, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0955810546875 GB
    Memory Allocated: 1.7985539436340332  GigaBytes
Max Memory Allocated: 1.9896416664123535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 0.122467041015625  GigaBytes
Max Memory Allocated: 1.9914331436157227  GigaBytes

torch.Size([166738, 128])
torch.Size([164796, 256])
torch.Size([155075, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 1.7940654754638672  GigaBytes
Max Memory Allocated: 1.9914331436157227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 0.1224508285522461  GigaBytes
Max Memory Allocated: 1.9914331436157227  GigaBytes

torch.Size([166687, 128])
torch.Size([164702, 256])
torch.Size([155020, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0975341796875 GB
    Memory Allocated: 1.7987403869628906  GigaBytes
Max Memory Allocated: 1.9914331436157227  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04982924461364746 |0.08799666166305542 |0.19542080163955688 |0.00013405084609985352 |0.07554543018341064 |0.0057926177978515625 |
----------------------------------------------------------pseudo_mini_loss sum 6.269241809844971
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351171
Number of first layer input nodes during this epoch:  666811
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 0.1879410743713379  GigaBytes
Max Memory Allocated: 1.9916119575500488  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.017655134201049805
range selection method range initialization spend 0.012208700180053711
time for parepare:  0.018218040466308594
local_output_nid generation:  0.005433082580566406
local_in_edges_tensor generation:  0.0060961246490478516
mini_batch_src_global generation:  0.006559133529663086
r_  generation:  0.08090662956237793
local_output_nid generation:  0.006864309310913086
local_in_edges_tensor generation:  0.0030689239501953125
mini_batch_src_global generation:  0.009253740310668945
r_  generation:  0.08858966827392578
local_output_nid generation:  0.006945371627807617
local_in_edges_tensor generation:  0.0030503273010253906
mini_batch_src_global generation:  0.0066013336181640625
r_  generation:  0.08918356895446777
local_output_nid generation:  0.0069963932037353516
local_in_edges_tensor generation:  0.0030400753021240234
mini_batch_src_global generation:  0.006920576095581055
r_  generation:  0.09229087829589844
----------------------check_connections_block total spend ----------------------------- 0.5126464366912842
generate_one_block  0.10206890106201172
generate_one_block  0.10457444190979004
generate_one_block  0.1040196418762207
generate_one_block  0.10510540008544922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04125809669494629
gen group dst list time:  0.011196136474609375
time for parepare:  0.02008509635925293
local_output_nid generation:  0.014835357666015625
local_in_edges_tensor generation:  0.038114070892333984
mini_batch_src_global generation:  0.05880260467529297
r_  generation:  0.41596055030822754
local_output_nid generation:  0.025087833404541016
local_in_edges_tensor generation:  0.03795623779296875
mini_batch_src_global generation:  0.05231142044067383
r_  generation:  0.4461634159088135
local_output_nid generation:  0.023882389068603516
local_in_edges_tensor generation:  0.045694828033447266
mini_batch_src_global generation:  0.052159786224365234
r_  generation:  0.42362093925476074
local_output_nid generation:  0.023324966430664062
local_in_edges_tensor generation:  0.030820131301879883
mini_batch_src_global generation:  0.04953408241271973
r_  generation:  0.42353296279907227
----------------------check_connections_block total spend ----------------------------- 2.5530805587768555
generate_one_block  0.5471971035003662
generate_one_block  0.5542469024658203
generate_one_block  0.5821001529693604
generate_one_block  0.5374038219451904
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0677492618560791
gen group dst list time:  0.021258831024169922
time for parepare:  0.01959681510925293
local_output_nid generation:  0.02373504638671875
local_in_edges_tensor generation:  0.07390952110290527
mini_batch_src_global generation:  0.051134347915649414
r_  generation:  0.5406243801116943
local_output_nid generation:  0.0320742130279541
local_in_edges_tensor generation:  0.05161619186401367
mini_batch_src_global generation:  0.06397771835327148
r_  generation:  0.5410568714141846
local_output_nid generation:  0.03306221961975098
local_in_edges_tensor generation:  0.03890800476074219
mini_batch_src_global generation:  0.059470415115356445
r_  generation:  0.5731658935546875
local_output_nid generation:  0.03721952438354492
local_in_edges_tensor generation:  0.051048994064331055
mini_batch_src_global generation:  0.0738673210144043
r_  generation:  0.5531847476959229
----------------------check_connections_block total spend ----------------------------- 3.288402557373047
generate_one_block  0.6975553035736084
generate_one_block  0.7003796100616455
generate_one_block  0.6910104751586914
generate_one_block  0.6912026405334473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036809444427490234
gen group dst list time:  0.026747941970825195
time for parepare:  0.020597219467163086
local_output_nid generation:  0.02802419662475586
local_in_edges_tensor generation:  0.04700160026550293
mini_batch_src_global generation:  0.04710745811462402
r_  generation:  0.5252156257629395
local_output_nid generation:  0.03454160690307617
local_in_edges_tensor generation:  0.05041313171386719
mini_batch_src_global generation:  0.06564140319824219
r_  generation:  0.533179521560669
local_output_nid generation:  0.03821444511413574
local_in_edges_tensor generation:  0.05011487007141113
mini_batch_src_global generation:  0.06307053565979004
r_  generation:  0.515204668045044
local_output_nid generation:  0.036757469177246094
local_in_edges_tensor generation:  0.04051542282104492
mini_batch_src_global generation:  0.057520389556884766
r_  generation:  0.5180175304412842
----------------------check_connections_block total spend ----------------------------- 3.137707233428955
generate_one_block  0.6610658168792725
generate_one_block  0.6598446369171143
generate_one_block  0.6401593685150146
generate_one_block  0.6466219425201416
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 0.1879410743713379  GigaBytes
Max Memory Allocated: 1.9916119575500488  GigaBytes

connection checking time:  8.979190349578857
block generation total time  7.608787775039673
average batch blocks generation time:  1.9021969437599182
block dataloader generation time/epoch 18.616230010986328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 0.12497234344482422  GigaBytes
Max Memory Allocated: 1.9916119575500488  GigaBytes

torch.Size([166696, 128])
torch.Size([164793, 256])
torch.Size([155219, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0994873046875 GB
    Memory Allocated: 1.798020839691162  GigaBytes
Max Memory Allocated: 1.9916119575500488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1014404296875 GB
    Memory Allocated: 0.1254868507385254  GigaBytes
Max Memory Allocated: 1.9916119575500488  GigaBytes

torch.Size([166713, 128])
torch.Size([164777, 256])
torch.Size([154859, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1014404296875 GB
    Memory Allocated: 1.8026676177978516  GigaBytes
Max Memory Allocated: 1.9916119575500488  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 0.12556743621826172  GigaBytes
Max Memory Allocated: 1.9958138465881348  GigaBytes

torch.Size([166687, 128])
torch.Size([164740, 256])
torch.Size([155038, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 1.7972736358642578  GigaBytes
Max Memory Allocated: 1.9958138465881348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 0.125  GigaBytes
Max Memory Allocated: 1.9958138465881348  GigaBytes

torch.Size([166694, 128])
torch.Size([164759, 256])
torch.Size([155015, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 1.7976479530334473  GigaBytes
Max Memory Allocated: 1.9958138465881348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13904398679733276 |0.03083348274230957 |0.01111745834350586 |9.894371032714844e-05 |0.005358636379241943 |0.0038280487060546875 |
----------------------------------------------------------pseudo_mini_loss sum 3.280003070831299
Total (block generation + training)time/epoch 19.522331714630127
Training time/epoch 0.9057881832122803
Training time without block to device /epoch 0.782454252243042
Training time without total dataloading part /epoch 0.07012820243835449
load block tensor time/epoch 0.556175947189331
block to device time/epoch 0.12333393096923828
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2351489
Number of first layer input nodes during this epoch:  666790
