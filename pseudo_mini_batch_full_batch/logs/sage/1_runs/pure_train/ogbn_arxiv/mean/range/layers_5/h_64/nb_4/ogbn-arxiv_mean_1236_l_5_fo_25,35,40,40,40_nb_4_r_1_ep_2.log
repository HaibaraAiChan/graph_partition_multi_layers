Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648497033.1395628
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024599313735961914
range selection method range initialization spend 0.013594388961791992
time for parepare:  0.017772912979125977
local_output_nid generation:  0.0054242610931396484
local_in_edges_tensor generation:  0.0058650970458984375
mini_batch_src_global generation:  0.006541252136230469
r_  generation:  0.08249473571777344
local_output_nid generation:  0.0061304569244384766
local_in_edges_tensor generation:  0.002992868423461914
mini_batch_src_global generation:  0.008620977401733398
r_  generation:  0.08797931671142578
local_output_nid generation:  0.006312847137451172
local_in_edges_tensor generation:  0.0031735897064208984
mini_batch_src_global generation:  0.0066144466400146484
r_  generation:  0.08775758743286133
local_output_nid generation:  0.0061032772064208984
local_in_edges_tensor generation:  0.0030324459075927734
mini_batch_src_global generation:  0.006733894348144531
r_  generation:  0.09046387672424316
----------------------check_connections_block total spend ----------------------------- 0.5037059783935547
generate_one_block  0.1018216609954834
generate_one_block  0.10224628448486328
generate_one_block  0.10203981399536133
generate_one_block  0.1014869213104248
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.041213274002075195
gen group dst list time:  0.011161088943481445
time for parepare:  0.019575834274291992
local_output_nid generation:  0.014535903930664062
local_in_edges_tensor generation:  0.03678536415100098
mini_batch_src_global generation:  0.04121541976928711
r_  generation:  0.4079563617706299
local_output_nid generation:  0.023726940155029297
local_in_edges_tensor generation:  0.036556243896484375
mini_batch_src_global generation:  0.0484004020690918
r_  generation:  0.41658568382263184
local_output_nid generation:  0.025619029998779297
local_in_edges_tensor generation:  0.03028416633605957
mini_batch_src_global generation:  0.048404693603515625
r_  generation:  0.41541099548339844
local_output_nid generation:  0.026035308837890625
local_in_edges_tensor generation:  0.02644205093383789
mini_batch_src_global generation:  0.05249643325805664
r_  generation:  0.41729283332824707
----------------------check_connections_block total spend ----------------------------- 2.440171003341675
generate_one_block  0.5678644180297852
generate_one_block  0.5551738739013672
generate_one_block  0.5474450588226318
generate_one_block  0.5356650352478027
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03760552406311035
gen group dst list time:  0.020688295364379883
time for parepare:  0.018784284591674805
local_output_nid generation:  0.02383589744567871
local_in_edges_tensor generation:  0.0516514778137207
mini_batch_src_global generation:  0.05464529991149902
r_  generation:  0.5397710800170898
local_output_nid generation:  0.0325775146484375
local_in_edges_tensor generation:  0.0537259578704834
mini_batch_src_global generation:  0.0625455379486084
r_  generation:  0.5584378242492676
local_output_nid generation:  0.03349590301513672
local_in_edges_tensor generation:  0.04049229621887207
mini_batch_src_global generation:  0.06172800064086914
r_  generation:  0.5625808238983154
local_output_nid generation:  0.03403115272521973
local_in_edges_tensor generation:  0.035009145736694336
mini_batch_src_global generation:  0.05883908271789551
r_  generation:  0.5624902248382568
----------------------check_connections_block total spend ----------------------------- 3.2560880184173584
generate_one_block  0.6918075084686279
generate_one_block  0.711540937423706
generate_one_block  0.7094435691833496
generate_one_block  0.6903345584869385
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05181741714477539
gen group dst list time:  0.028809785842895508
time for parepare:  0.01937413215637207
local_output_nid generation:  0.027536869049072266
local_in_edges_tensor generation:  0.07020854949951172
mini_batch_src_global generation:  0.07507848739624023
r_  generation:  0.5414767265319824
local_output_nid generation:  0.03464460372924805
local_in_edges_tensor generation:  0.0615086555480957
mini_batch_src_global generation:  0.06197953224182129
r_  generation:  0.5649571418762207
local_output_nid generation:  0.0382380485534668
local_in_edges_tensor generation:  0.039408206939697266
mini_batch_src_global generation:  0.06363463401794434
r_  generation:  0.5497848987579346
local_output_nid generation:  0.03665637969970703
local_in_edges_tensor generation:  0.03894162178039551
mini_batch_src_global generation:  0.061724185943603516
r_  generation:  0.5525021553039551
----------------------check_connections_block total spend ----------------------------- 3.3372230529785156
generate_one_block  0.7015659809112549
generate_one_block  0.6993579864501953
generate_one_block  0.6902837753295898
generate_one_block  0.6869182586669922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041077613830566406
gen group dst list time:  0.02471613883972168
time for parepare:  0.01970529556274414
local_output_nid generation:  0.02835392951965332
local_in_edges_tensor generation:  0.05605196952819824
mini_batch_src_global generation:  0.046407461166381836
r_  generation:  0.5043473243713379
local_output_nid generation:  0.035033226013183594
local_in_edges_tensor generation:  0.05156445503234863
mini_batch_src_global generation:  0.06076359748840332
r_  generation:  0.5119903087615967
local_output_nid generation:  0.036145687103271484
local_in_edges_tensor generation:  0.05000734329223633
mini_batch_src_global generation:  0.05827522277832031
r_  generation:  0.5105316638946533
local_output_nid generation:  0.03664422035217285
local_in_edges_tensor generation:  0.043970346450805664
mini_batch_src_global generation:  0.058469295501708984
r_  generation:  0.5144102573394775
----------------------check_connections_block total spend ----------------------------- 3.09149432182312
generate_one_block  0.6505732536315918
generate_one_block  0.6429774761199951
generate_one_block  0.6423013210296631
generate_one_block  0.6400694847106934
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

connection checking time:  12.124976396560669
block generation total time  10.363322496414185
average batch blocks generation time:  2.590830624103546
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12953805923461914  GigaBytes
Max Memory Allocated: 0.12953805923461914  GigaBytes

torch.Size([167462, 128])
torch.Size([166931, 64])
torch.Size([164904, 64])
torch.Size([155092, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.7481980323791504  GigaBytes
Max Memory Allocated: 0.7671341896057129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4549560546875 GB
    Memory Allocated: 0.13482093811035156  GigaBytes
Max Memory Allocated: 0.7948188781738281  GigaBytes

torch.Size([167409, 128])
torch.Size([166886, 64])
torch.Size([164937, 64])
torch.Size([155051, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4549560546875 GB
    Memory Allocated: 0.7502894401550293  GigaBytes
Max Memory Allocated: 0.7948188781738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.13584566116333008  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

torch.Size([167341, 128])
torch.Size([166804, 64])
torch.Size([164871, 64])
torch.Size([155112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.7500333786010742  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.13474416732788086  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

torch.Size([167358, 128])
torch.Size([166745, 64])
torch.Size([164713, 64])
torch.Size([154864, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.7492094039916992  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07058930397033691 |0.11905872821807861 |0.18640464544296265 |0.00012385845184326172 |0.023796916007995605 |0.002710580825805664 |
----------------------------------------------------------pseudo_mini_loss sum 5.441847801208496
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021572
Number of first layer input nodes during this epoch:  669570
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.24054861068725586  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.018970489501953125
range selection method range initialization spend 0.011276721954345703
time for parepare:  0.017247676849365234
local_output_nid generation:  0.005245685577392578
local_in_edges_tensor generation:  0.008606433868408203
mini_batch_src_global generation:  0.006568431854248047
r_  generation:  0.0794990062713623
local_output_nid generation:  0.006276607513427734
local_in_edges_tensor generation:  0.0045473575592041016
mini_batch_src_global generation:  0.009023904800415039
r_  generation:  0.09310102462768555
local_output_nid generation:  0.006543159484863281
local_in_edges_tensor generation:  0.0042819976806640625
mini_batch_src_global generation:  0.007115840911865234
r_  generation:  0.09347105026245117
local_output_nid generation:  0.006674289703369141
local_in_edges_tensor generation:  0.003911495208740234
mini_batch_src_global generation:  0.006997585296630859
r_  generation:  0.09812569618225098
----------------------check_connections_block total spend ----------------------------- 0.5364334583282471
generate_one_block  0.10254454612731934
generate_one_block  0.10227465629577637
generate_one_block  0.10231328010559082
generate_one_block  0.10343718528747559
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05437445640563965
gen group dst list time:  0.011033058166503906
time for parepare:  0.020514488220214844
local_output_nid generation:  0.014161348342895508
local_in_edges_tensor generation:  0.04570770263671875
mini_batch_src_global generation:  0.04171895980834961
r_  generation:  0.4093787670135498
local_output_nid generation:  0.020458698272705078
local_in_edges_tensor generation:  0.03906130790710449
mini_batch_src_global generation:  0.04739522933959961
r_  generation:  0.4160885810852051
local_output_nid generation:  0.021953821182250977
local_in_edges_tensor generation:  0.031955718994140625
mini_batch_src_global generation:  0.04729509353637695
r_  generation:  0.41986513137817383
local_output_nid generation:  0.02182459831237793
local_in_edges_tensor generation:  0.027579307556152344
mini_batch_src_global generation:  0.05405402183532715
r_  generation:  0.42348361015319824
----------------------check_connections_block total spend ----------------------------- 2.4579265117645264
generate_one_block  0.5527627468109131
generate_one_block  0.5657813549041748
generate_one_block  0.5673413276672363
generate_one_block  0.5535268783569336
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.044936180114746094
gen group dst list time:  0.021363496780395508
time for parepare:  0.019671201705932617
local_output_nid generation:  0.024590253829956055
local_in_edges_tensor generation:  0.05925440788269043
mini_batch_src_global generation:  0.08091926574707031
r_  generation:  0.5517644882202148
local_output_nid generation:  0.03298616409301758
local_in_edges_tensor generation:  0.05351114273071289
mini_batch_src_global generation:  0.0648500919342041
r_  generation:  0.5532681941986084
local_output_nid generation:  0.033632516860961914
local_in_edges_tensor generation:  0.039255619049072266
mini_batch_src_global generation:  0.057891130447387695
r_  generation:  0.5716390609741211
local_output_nid generation:  0.035212039947509766
local_in_edges_tensor generation:  0.051291465759277344
mini_batch_src_global generation:  0.059983253479003906
r_  generation:  0.5677731037139893
----------------------check_connections_block total spend ----------------------------- 3.33535099029541
generate_one_block  0.7268402576446533
generate_one_block  0.7101726531982422
generate_one_block  0.692662239074707
generate_one_block  0.7246942520141602
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040041208267211914
gen group dst list time:  0.028216123580932617
time for parepare:  0.018650054931640625
local_output_nid generation:  0.02823352813720703
local_in_edges_tensor generation:  0.0556027889251709
mini_batch_src_global generation:  0.05459856986999512
r_  generation:  0.5509228706359863
local_output_nid generation:  0.03501701354980469
local_in_edges_tensor generation:  0.052143096923828125
mini_batch_src_global generation:  0.06439208984375
r_  generation:  0.547950267791748
local_output_nid generation:  0.03599262237548828
local_in_edges_tensor generation:  0.04297661781311035
mini_batch_src_global generation:  0.06442642211914062
r_  generation:  0.5561692714691162
local_output_nid generation:  0.03620791435241699
local_in_edges_tensor generation:  0.034238576889038086
mini_batch_src_global generation:  0.06261205673217773
r_  generation:  0.5593197345733643
----------------------check_connections_block total spend ----------------------------- 3.296431541442871
generate_one_block  0.7018344402313232
generate_one_block  0.7191412448883057
generate_one_block  0.7050380706787109
generate_one_block  0.7091069221496582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04340028762817383
gen group dst list time:  0.024698734283447266
time for parepare:  0.020281314849853516
local_output_nid generation:  0.029410123825073242
local_in_edges_tensor generation:  0.06512904167175293
mini_batch_src_global generation:  0.04567122459411621
r_  generation:  0.5105783939361572
local_output_nid generation:  0.03634905815124512
local_in_edges_tensor generation:  0.05160951614379883
mini_batch_src_global generation:  0.05795598030090332
r_  generation:  0.5188236236572266
local_output_nid generation:  0.03703165054321289
local_in_edges_tensor generation:  0.043595075607299805
mini_batch_src_global generation:  0.06029152870178223
r_  generation:  0.5242316722869873
local_output_nid generation:  0.037686824798583984
local_in_edges_tensor generation:  0.0443415641784668
mini_batch_src_global generation:  0.07628083229064941
r_  generation:  0.5347778797149658
----------------------check_connections_block total spend ----------------------------- 3.162222385406494
generate_one_block  0.642371416091919
generate_one_block  0.6439652442932129
generate_one_block  0.6549537181854248
generate_one_block  0.6499676704406738
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.24054861068725586  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

connection checking time:  12.251931428909302
block generation total time  10.520160436630249
average batch blocks generation time:  2.6300401091575623
block dataloader generation time/epoch 25.07516860961914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.13629674911499023  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

torch.Size([167405, 128])
torch.Size([166849, 64])
torch.Size([164797, 64])
torch.Size([154849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.7507157325744629  GigaBytes
Max Memory Allocated: 0.7970871925354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.13516902923583984  GigaBytes
Max Memory Allocated: 0.797637939453125  GigaBytes

torch.Size([167349, 128])
torch.Size([166804, 64])
torch.Size([164804, 64])
torch.Size([155127, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.7505607604980469  GigaBytes
Max Memory Allocated: 0.797637939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.13518333435058594  GigaBytes
Max Memory Allocated: 0.797637939453125  GigaBytes

torch.Size([167433, 128])
torch.Size([166884, 64])
torch.Size([164889, 64])
torch.Size([154863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.7491803169250488  GigaBytes
Max Memory Allocated: 0.797637939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.13521671295166016  GigaBytes
Max Memory Allocated: 0.797637939453125  GigaBytes

torch.Size([167440, 128])
torch.Size([166889, 64])
torch.Size([164849, 64])
torch.Size([154982, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.7505745887756348  GigaBytes
Max Memory Allocated: 0.797637939453125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08108282089233398 |0.03841608762741089 |0.005796551704406738 |9.691715240478516e-05 |0.006487071514129639 |0.0025687217712402344 |
----------------------------------------------------------pseudo_mini_loss sum 4.414251327514648
Total (block generation + training)time/epoch 25.664387702941895
Training time/epoch 0.5888988971710205
Training time without block to device /epoch 0.43523454666137695
Training time without total dataloading part /epoch 0.05209088325500488
load block tensor time/epoch 0.32433128356933594
block to device time/epoch 0.15366435050964355
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021623
Number of first layer input nodes during this epoch:  669627
