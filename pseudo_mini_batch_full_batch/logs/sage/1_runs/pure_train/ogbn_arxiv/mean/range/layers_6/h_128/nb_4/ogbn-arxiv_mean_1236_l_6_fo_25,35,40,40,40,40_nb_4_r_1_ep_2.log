Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648517849.0618646
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.023488759994506836
range selection method range initialization spend 0.013604402542114258
time for parepare:  0.018064022064208984
local_output_nid generation:  0.00517725944519043
local_in_edges_tensor generation:  0.0055959224700927734
mini_batch_src_global generation:  0.006708621978759766
r_  generation:  0.08301544189453125
local_output_nid generation:  0.006021022796630859
local_in_edges_tensor generation:  0.0029668807983398438
mini_batch_src_global generation:  0.008699178695678711
r_  generation:  0.08871316909790039
local_output_nid generation:  0.0060155391693115234
local_in_edges_tensor generation:  0.002981424331665039
mini_batch_src_global generation:  0.006447553634643555
r_  generation:  0.0880441665649414
local_output_nid generation:  0.006066322326660156
local_in_edges_tensor generation:  0.0029916763305664062
mini_batch_src_global generation:  0.007210254669189453
r_  generation:  0.0911252498626709
----------------------check_connections_block total spend ----------------------------- 0.5073292255401611
generate_one_block  0.09975457191467285
generate_one_block  0.10085105895996094
generate_one_block  0.10053563117980957
generate_one_block  0.10272669792175293
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03845071792602539
gen group dst list time:  0.01144099235534668
time for parepare:  0.01926589012145996
local_output_nid generation:  0.0146636962890625
local_in_edges_tensor generation:  0.03545212745666504
mini_batch_src_global generation:  0.03919839859008789
r_  generation:  0.4029242992401123
local_output_nid generation:  0.0208432674407959
local_in_edges_tensor generation:  0.03608226776123047
mini_batch_src_global generation:  0.049131155014038086
r_  generation:  0.40908122062683105
local_output_nid generation:  0.021531343460083008
local_in_edges_tensor generation:  0.0298922061920166
mini_batch_src_global generation:  0.05802297592163086
r_  generation:  0.4147624969482422
local_output_nid generation:  0.02220010757446289
local_in_edges_tensor generation:  0.029914379119873047
mini_batch_src_global generation:  0.05003523826599121
r_  generation:  0.4230921268463135
----------------------check_connections_block total spend ----------------------------- 2.4342727661132812
generate_one_block  0.5710580348968506
generate_one_block  0.5419275760650635
generate_one_block  0.5306615829467773
generate_one_block  0.5441257953643799
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.033360958099365234
gen group dst list time:  0.0209047794342041
time for parepare:  0.018952131271362305
local_output_nid generation:  0.023830175399780273
local_in_edges_tensor generation:  0.04962444305419922
mini_batch_src_global generation:  0.05140948295593262
r_  generation:  0.539527177810669
local_output_nid generation:  0.03218436241149902
local_in_edges_tensor generation:  0.051175832748413086
mini_batch_src_global generation:  0.06310343742370605
r_  generation:  0.5415966510772705
local_output_nid generation:  0.03308916091918945
local_in_edges_tensor generation:  0.03735685348510742
mini_batch_src_global generation:  0.06174874305725098
r_  generation:  0.5513887405395508
local_output_nid generation:  0.03342723846435547
local_in_edges_tensor generation:  0.032987356185913086
mini_batch_src_global generation:  0.060105085372924805
r_  generation:  0.5545721054077148
----------------------check_connections_block total spend ----------------------------- 3.206685781478882
generate_one_block  0.6884441375732422
generate_one_block  0.6942083835601807
generate_one_block  0.7031228542327881
generate_one_block  0.6802971363067627
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03289222717285156
gen group dst list time:  0.023373842239379883
time for parepare:  0.01889348030090332
local_output_nid generation:  0.026735782623291016
local_in_edges_tensor generation:  0.04035377502441406
mini_batch_src_global generation:  0.05576372146606445
r_  generation:  0.5523719787597656
local_output_nid generation:  0.03408050537109375
local_in_edges_tensor generation:  0.05246162414550781
mini_batch_src_global generation:  0.06474494934082031
r_  generation:  0.5687177181243896
local_output_nid generation:  0.03538155555725098
local_in_edges_tensor generation:  0.03921222686767578
mini_batch_src_global generation:  0.06636977195739746
r_  generation:  0.560544490814209
local_output_nid generation:  0.03539013862609863
local_in_edges_tensor generation:  0.03856039047241211
mini_batch_src_global generation:  0.06479549407958984
r_  generation:  0.5702230930328369
----------------------check_connections_block total spend ----------------------------- 3.322436809539795
generate_one_block  0.6916906833648682
generate_one_block  0.7317471504211426
generate_one_block  0.6897857189178467
generate_one_block  0.7003581523895264
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027051210403442383
gen group dst list time:  0.0240933895111084
time for parepare:  0.01897144317626953
local_output_nid generation:  0.02774190902709961
local_in_edges_tensor generation:  0.03719615936279297
mini_batch_src_global generation:  0.05042576789855957
r_  generation:  0.5395815372467041
local_output_nid generation:  0.03579425811767578
local_in_edges_tensor generation:  0.03311300277709961
mini_batch_src_global generation:  0.06430411338806152
r_  generation:  0.546454906463623
local_output_nid generation:  0.03608345985412598
local_in_edges_tensor generation:  0.03403043746948242
mini_batch_src_global generation:  0.06465578079223633
r_  generation:  0.5482285022735596
local_output_nid generation:  0.03653407096862793
local_in_edges_tensor generation:  0.0337214469909668
mini_batch_src_global generation:  0.06703019142150879
r_  generation:  0.5520339012145996
----------------------check_connections_block total spend ----------------------------- 3.225429058074951
generate_one_block  0.6802694797515869
generate_one_block  0.7012302875518799
generate_one_block  0.6838016510009766
generate_one_block  0.6889429092407227
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034377336502075195
gen group dst list time:  0.02467799186706543
time for parepare:  0.019262075424194336
local_output_nid generation:  0.02915477752685547
local_in_edges_tensor generation:  0.03895378112792969
mini_batch_src_global generation:  0.046250343322753906
r_  generation:  0.510474443435669
local_output_nid generation:  0.03515625
local_in_edges_tensor generation:  0.05402040481567383
mini_batch_src_global generation:  0.05869913101196289
r_  generation:  0.5094976425170898
local_output_nid generation:  0.03617691993713379
local_in_edges_tensor generation:  0.04099583625793457
mini_batch_src_global generation:  0.0594637393951416
r_  generation:  0.5098216533660889
local_output_nid generation:  0.03654980659484863
local_in_edges_tensor generation:  0.03679919242858887
mini_batch_src_global generation:  0.06258416175842285
r_  generation:  0.5095205307006836
----------------------check_connections_block total spend ----------------------------- 3.0713894367218018
generate_one_block  0.6305608749389648
generate_one_block  0.6709184646606445
generate_one_block  0.6314041614532471
generate_one_block  0.6290948390960693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

connection checking time:  15.260213851928711
block generation total time  13.08364987373352
average batch blocks generation time:  3.27091246843338
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2420654296875 GB
    Memory Allocated: 0.14294052124023438  GigaBytes
Max Memory Allocated: 0.14294052124023438  GigaBytes

torch.Size([167748, 128])
torch.Size([167534, 128])
torch.Size([166946, 128])
torch.Size([164839, 128])
torch.Size([155042, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2127685546875 GB
    Memory Allocated: 1.7557568550109863  GigaBytes
Max Memory Allocated: 1.7957682609558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.14820623397827148  GigaBytes
Max Memory Allocated: 1.8516464233398438  GigaBytes

torch.Size([167796, 128])
torch.Size([167579, 128])
torch.Size([166991, 128])
torch.Size([164961, 128])
torch.Size([154984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.7570481300354004  GigaBytes
Max Memory Allocated: 1.8516464233398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.14764690399169922  GigaBytes
Max Memory Allocated: 1.851968765258789  GigaBytes

torch.Size([167736, 128])
torch.Size([167505, 128])
torch.Size([166912, 128])
torch.Size([164821, 128])
torch.Size([155068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.7544922828674316  GigaBytes
Max Memory Allocated: 1.851968765258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.1484355926513672  GigaBytes
Max Memory Allocated: 1.851968765258789  GigaBytes

torch.Size([167745, 128])
torch.Size([167499, 128])
torch.Size([166880, 128])
torch.Size([164776, 128])
torch.Size([154907, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.7584614753723145  GigaBytes
Max Memory Allocated: 1.851968765258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06719613075256348 |0.13249576091766357 |0.1792261004447937 |0.0001290440559387207 |0.058774352073669434 |0.007246732711791992 |
----------------------------------------------------------pseudo_mini_loss sum 5.940756797790527
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3693651
Number of first layer input nodes during this epoch:  671025
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.2692832946777344  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.019371747970581055
range selection method range initialization spend 0.015017032623291016
time for parepare:  0.01669454574584961
local_output_nid generation:  0.005395412445068359
local_in_edges_tensor generation:  0.005795717239379883
mini_batch_src_global generation:  0.007804155349731445
r_  generation:  0.08606958389282227
local_output_nid generation:  0.0072689056396484375
local_in_edges_tensor generation:  0.006965160369873047
mini_batch_src_global generation:  0.016180753707885742
r_  generation:  0.09396576881408691
local_output_nid generation:  0.0065081119537353516
local_in_edges_tensor generation:  0.004854917526245117
mini_batch_src_global generation:  0.008238792419433594
r_  generation:  0.09239983558654785
local_output_nid generation:  0.006554126739501953
local_in_edges_tensor generation:  0.004033327102661133
mini_batch_src_global generation:  0.008565425872802734
r_  generation:  0.09202408790588379
----------------------check_connections_block total spend ----------------------------- 0.5498747825622559
generate_one_block  0.1004800796508789
generate_one_block  0.10147762298583984
generate_one_block  0.1019132137298584
generate_one_block  0.10229015350341797
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04313206672668457
gen group dst list time:  0.010878324508666992
time for parepare:  0.020781755447387695
local_output_nid generation:  0.014862775802612305
local_in_edges_tensor generation:  0.04375290870666504
mini_batch_src_global generation:  0.04233527183532715
r_  generation:  0.4023556709289551
local_output_nid generation:  0.0218961238861084
local_in_edges_tensor generation:  0.036640167236328125
mini_batch_src_global generation:  0.05208396911621094
r_  generation:  0.41906094551086426
local_output_nid generation:  0.024054765701293945
local_in_edges_tensor generation:  0.0263669490814209
mini_batch_src_global generation:  0.05444955825805664
r_  generation:  0.4241499900817871
local_output_nid generation:  0.02294445037841797
local_in_edges_tensor generation:  0.03428316116333008
mini_batch_src_global generation:  0.05073046684265137
r_  generation:  0.42906904220581055
----------------------check_connections_block total spend ----------------------------- 2.485980272293091
generate_one_block  0.5410442352294922
generate_one_block  0.5336296558380127
generate_one_block  0.5692226886749268
generate_one_block  0.5499918460845947
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0419766902923584
gen group dst list time:  0.021114110946655273
time for parepare:  0.01934647560119629
local_output_nid generation:  0.02422356605529785
local_in_edges_tensor generation:  0.06418347358703613
mini_batch_src_global generation:  0.05209207534790039
r_  generation:  0.5413768291473389
local_output_nid generation:  0.03370785713195801
local_in_edges_tensor generation:  0.06442427635192871
mini_batch_src_global generation:  0.07321405410766602
r_  generation:  0.5466153621673584
local_output_nid generation:  0.0364680290222168
local_in_edges_tensor generation:  0.043314456939697266
mini_batch_src_global generation:  0.06477832794189453
r_  generation:  0.5617148876190186
local_output_nid generation:  0.03483939170837402
local_in_edges_tensor generation:  0.0547184944152832
mini_batch_src_global generation:  0.06055903434753418
r_  generation:  0.5581433773040771
----------------------check_connections_block total spend ----------------------------- 3.3309061527252197
generate_one_block  0.7282779216766357
generate_one_block  0.7175469398498535
generate_one_block  0.7077832221984863
generate_one_block  0.7324481010437012
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.11730694770812988
gen group dst list time:  0.030892372131347656
time for parepare:  0.01922130584716797
local_output_nid generation:  0.028258323669433594
local_in_edges_tensor generation:  0.051692962646484375
mini_batch_src_global generation:  0.06721925735473633
r_  generation:  0.5749132633209229
local_output_nid generation:  0.03685760498046875
local_in_edges_tensor generation:  0.053293466567993164
mini_batch_src_global generation:  0.07263541221618652
r_  generation:  0.5941178798675537
local_output_nid generation:  0.03579211235046387
local_in_edges_tensor generation:  0.043763160705566406
mini_batch_src_global generation:  0.08019661903381348
r_  generation:  0.6129481792449951
local_output_nid generation:  0.04096364974975586
local_in_edges_tensor generation:  0.050168514251708984
mini_batch_src_global generation:  0.0719597339630127
r_  generation:  0.5873773097991943
----------------------check_connections_block total spend ----------------------------- 3.563264846801758
generate_one_block  0.7223672866821289
generate_one_block  0.7506544589996338
generate_one_block  0.7344443798065186
generate_one_block  0.7437567710876465
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033255815505981445
gen group dst list time:  0.02690744400024414
time for parepare:  0.019692182540893555
local_output_nid generation:  0.02908802032470703
local_in_edges_tensor generation:  0.05152320861816406
mini_batch_src_global generation:  0.05510902404785156
r_  generation:  0.5587601661682129
local_output_nid generation:  0.03578901290893555
local_in_edges_tensor generation:  0.03581857681274414
mini_batch_src_global generation:  0.06650376319885254
r_  generation:  0.5505566596984863
local_output_nid generation:  0.03682541847229004
local_in_edges_tensor generation:  0.03403949737548828
mini_batch_src_global generation:  0.0668478012084961
r_  generation:  0.5536439418792725
local_output_nid generation:  0.03734707832336426
local_in_edges_tensor generation:  0.03823423385620117
mini_batch_src_global generation:  0.06492996215820312
r_  generation:  0.5538027286529541
----------------------check_connections_block total spend ----------------------------- 3.3126988410949707
generate_one_block  0.7114148139953613
generate_one_block  0.7006886005401611
generate_one_block  0.7028350830078125
generate_one_block  0.6982557773590088
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03383493423461914
gen group dst list time:  0.028614521026611328
time for parepare:  0.019060134887695312
local_output_nid generation:  0.029491424560546875
local_in_edges_tensor generation:  0.04313397407531738
mini_batch_src_global generation:  0.06060314178466797
r_  generation:  0.5381104946136475
local_output_nid generation:  0.07150101661682129
local_in_edges_tensor generation:  0.041733741760253906
mini_batch_src_global generation:  0.06405806541442871
r_  generation:  0.5528931617736816
local_output_nid generation:  0.04311680793762207
local_in_edges_tensor generation:  0.04723954200744629
mini_batch_src_global generation:  0.0704801082611084
r_  generation:  0.5328550338745117
local_output_nid generation:  0.03972148895263672
local_in_edges_tensor generation:  0.04240608215332031
mini_batch_src_global generation:  0.06785202026367188
r_  generation:  0.5629127025604248
----------------------check_connections_block total spend ----------------------------- 3.3452961444854736
generate_one_block  0.6488475799560547
generate_one_block  0.6556639671325684
generate_one_block  0.6731765270233154
generate_one_block  0.6994366645812988
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.2692832946777344  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

connection checking time:  16.038146257400513
block generation total time  13.521486520767212
average batch blocks generation time:  3.380371630191803
block dataloader generation time/epoch 32.13010287284851
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 0.14950132369995117  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

torch.Size([167719, 128])
torch.Size([167460, 128])
torch.Size([166857, 128])
torch.Size([164769, 128])
torch.Size([154892, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5135498046875 GB
    Memory Allocated: 1.757948398590088  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 0.14910316467285156  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

torch.Size([167728, 128])
torch.Size([167506, 128])
torch.Size([166914, 128])
torch.Size([164768, 128])
torch.Size([154657, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 1.7562508583068848  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 0.14906978607177734  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

torch.Size([167765, 128])
torch.Size([167534, 128])
torch.Size([166989, 128])
torch.Size([164963, 128])
torch.Size([155214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5155029296875 GB
    Memory Allocated: 1.7569704055786133  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5955810546875 GB
    Memory Allocated: 0.14978742599487305  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

torch.Size([167731, 128])
torch.Size([167503, 128])
torch.Size([166914, 128])
torch.Size([164797, 128])
torch.Size([155086, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5955810546875 GB
    Memory Allocated: 1.7598471641540527  GigaBytes
Max Memory Allocated: 1.8543152809143066  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11044144630432129 |0.052567481994628906 |0.006765902042388916 |0.00010448694229125977 |0.007538199424743652 |0.0026912689208984375 |
----------------------------------------------------------pseudo_mini_loss sum 4.13340950012207
Total (block generation + training)time/epoch 32.95160460472107
Training time/epoch 0.8211493492126465
Training time without block to device /epoch 0.6108794212341309
Training time without total dataloading part /epoch 0.06032562255859375
load block tensor time/epoch 0.44176578521728516
block to device time/epoch 0.21026992797851562
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3693273
Number of first layer input nodes during this epoch:  670943
