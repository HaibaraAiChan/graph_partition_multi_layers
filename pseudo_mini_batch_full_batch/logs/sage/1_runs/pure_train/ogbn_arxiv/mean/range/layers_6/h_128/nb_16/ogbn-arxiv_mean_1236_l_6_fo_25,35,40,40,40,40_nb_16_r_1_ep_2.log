Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648518049.076221
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.023633241653442383
range selection method range initialization spend 0.013809919357299805
time for parepare:  0.017560482025146484
local_output_nid generation:  0.0013439655303955078
local_in_edges_tensor generation:  0.0030384063720703125
mini_batch_src_global generation:  0.001714944839477539
r_  generation:  0.018320560455322266
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0021522045135498047
r_  generation:  0.01870560646057129
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0008692741394042969
mini_batch_src_global generation:  0.00136566162109375
r_  generation:  0.01812601089477539
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.001302957534790039
r_  generation:  0.018567562103271484
local_output_nid generation:  0.001512289047241211
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0013608932495117188
r_  generation:  0.017963171005249023
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0013687610626220703
r_  generation:  0.01855611801147461
local_output_nid generation:  0.0015077590942382812
local_in_edges_tensor generation:  0.0008256435394287109
mini_batch_src_global generation:  0.0014650821685791016
r_  generation:  0.019453048706054688
local_output_nid generation:  0.001504659652709961
local_in_edges_tensor generation:  0.0008318424224853516
mini_batch_src_global generation:  0.001409292221069336
r_  generation:  0.018631696701049805
local_output_nid generation:  0.0015139579772949219
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0014157295227050781
r_  generation:  0.01889204978942871
local_output_nid generation:  0.0015289783477783203
local_in_edges_tensor generation:  0.0008251667022705078
mini_batch_src_global generation:  0.0014233589172363281
r_  generation:  0.018900632858276367
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0014243125915527344
r_  generation:  0.019085407257080078
local_output_nid generation:  0.0015239715576171875
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0014483928680419922
r_  generation:  0.01894354820251465
local_output_nid generation:  0.001520395278930664
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0014674663543701172
r_  generation:  0.019118309020996094
local_output_nid generation:  0.0016455650329589844
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0014603137969970703
r_  generation:  0.019864559173583984
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0014960765838623047
r_  generation:  0.019205808639526367
local_output_nid generation:  0.0015282630920410156
local_in_edges_tensor generation:  0.0008237361907958984
mini_batch_src_global generation:  0.0015108585357666016
r_  generation:  0.019439697265625
----------------------check_connections_block total spend ----------------------------- 0.45073938369750977
generate_one_block  0.026682615280151367
generate_one_block  0.028521299362182617
generate_one_block  0.0275881290435791
generate_one_block  0.029409170150756836
generate_one_block  0.027467012405395508
generate_one_block  0.027467727661132812
generate_one_block  0.0284423828125
generate_one_block  0.02720785140991211
generate_one_block  0.027364492416381836
generate_one_block  0.03387928009033203
generate_one_block  0.02805328369140625
generate_one_block  0.026996850967407227
generate_one_block  0.027920246124267578
generate_one_block  0.02874469757080078
generate_one_block  0.027404069900512695
generate_one_block  0.028219223022460938
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03894329071044922
gen group dst list time:  0.018989086151123047
time for parepare:  0.019251108169555664
local_output_nid generation:  0.006582498550415039
local_in_edges_tensor generation:  0.013722658157348633
mini_batch_src_global generation:  0.01985788345336914
r_  generation:  0.19746804237365723
local_output_nid generation:  0.010854244232177734
local_in_edges_tensor generation:  0.018674850463867188
mini_batch_src_global generation:  0.02503490447998047
r_  generation:  0.20554709434509277
local_output_nid generation:  0.011027097702026367
local_in_edges_tensor generation:  0.014963865280151367
mini_batch_src_global generation:  0.023876667022705078
r_  generation:  0.20856428146362305
local_output_nid generation:  0.01156473159790039
local_in_edges_tensor generation:  0.015592575073242188
mini_batch_src_global generation:  0.025571584701538086
r_  generation:  0.21306085586547852
local_output_nid generation:  0.011637449264526367
local_in_edges_tensor generation:  0.01194906234741211
mini_batch_src_global generation:  0.03152871131896973
r_  generation:  0.21407270431518555
local_output_nid generation:  0.011622428894042969
local_in_edges_tensor generation:  0.013518095016479492
mini_batch_src_global generation:  0.02619171142578125
r_  generation:  0.21135687828063965
local_output_nid generation:  0.011968851089477539
local_in_edges_tensor generation:  0.016072511672973633
mini_batch_src_global generation:  0.027114391326904297
r_  generation:  0.21801543235778809
local_output_nid generation:  0.011928796768188477
local_in_edges_tensor generation:  0.012087583541870117
mini_batch_src_global generation:  0.026869773864746094
r_  generation:  0.21012663841247559
local_output_nid generation:  0.011978864669799805
local_in_edges_tensor generation:  0.012063980102539062
mini_batch_src_global generation:  0.026782989501953125
r_  generation:  0.2149357795715332
local_output_nid generation:  0.011880159378051758
local_in_edges_tensor generation:  0.01558542251586914
mini_batch_src_global generation:  0.0266721248626709
r_  generation:  0.21391940116882324
local_output_nid generation:  0.012136697769165039
local_in_edges_tensor generation:  0.015924692153930664
mini_batch_src_global generation:  0.026490449905395508
r_  generation:  0.21390581130981445
local_output_nid generation:  0.012029409408569336
local_in_edges_tensor generation:  0.01249241828918457
mini_batch_src_global generation:  0.026520490646362305
r_  generation:  0.2087242603302002
local_output_nid generation:  0.012174129486083984
local_in_edges_tensor generation:  0.01392364501953125
mini_batch_src_global generation:  0.028863906860351562
r_  generation:  0.21735525131225586
local_output_nid generation:  0.012378931045532227
local_in_edges_tensor generation:  0.017989397048950195
mini_batch_src_global generation:  0.028260469436645508
r_  generation:  0.22083210945129395
local_output_nid generation:  0.012163162231445312
local_in_edges_tensor generation:  0.016237974166870117
mini_batch_src_global generation:  0.02769017219543457
r_  generation:  0.21674060821533203
local_output_nid generation:  0.012326717376708984
local_in_edges_tensor generation:  0.01639723777770996
mini_batch_src_global generation:  0.027668237686157227
r_  generation:  0.21973419189453125
----------------------check_connections_block total spend ----------------------------- 5.025705575942993
generate_one_block  0.27872347831726074
generate_one_block  0.2804741859436035
generate_one_block  0.2787513732910156
generate_one_block  0.2889587879180908
generate_one_block  0.2914414405822754
generate_one_block  0.2711365222930908
generate_one_block  0.28925633430480957
generate_one_block  0.26714038848876953
generate_one_block  0.27559351921081543
generate_one_block  0.2728724479675293
generate_one_block  0.2748110294342041
generate_one_block  0.2771608829498291
generate_one_block  0.27951574325561523
generate_one_block  0.29222679138183594
generate_one_block  0.28159284591674805
generate_one_block  0.287106990814209
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.039237260818481445
gen group dst list time:  0.05917620658874512
time for parepare:  0.01896357536315918
local_output_nid generation:  0.023632526397705078
local_in_edges_tensor generation:  0.039235830307006836
mini_batch_src_global generation:  0.049777984619140625
r_  generation:  0.4831676483154297
local_output_nid generation:  0.02908182144165039
local_in_edges_tensor generation:  0.04816317558288574
mini_batch_src_global generation:  0.057851552963256836
r_  generation:  0.4917316436767578
local_output_nid generation:  0.028639793395996094
local_in_edges_tensor generation:  0.035698652267456055
mini_batch_src_global generation:  0.056783437728881836
r_  generation:  0.4993114471435547
local_output_nid generation:  0.029448270797729492
local_in_edges_tensor generation:  0.039783477783203125
mini_batch_src_global generation:  0.058318138122558594
r_  generation:  0.4992694854736328
local_output_nid generation:  0.02915358543395996
local_in_edges_tensor generation:  0.03108668327331543
mini_batch_src_global generation:  0.05875205993652344
r_  generation:  0.4990661144256592
local_output_nid generation:  0.029251813888549805
local_in_edges_tensor generation:  0.035651206970214844
mini_batch_src_global generation:  0.05917716026306152
r_  generation:  0.5059943199157715
local_output_nid generation:  0.029911279678344727
local_in_edges_tensor generation:  0.045049428939819336
mini_batch_src_global generation:  0.05835580825805664
r_  generation:  0.5080814361572266
local_output_nid generation:  0.029584646224975586
local_in_edges_tensor generation:  0.03067922592163086
mini_batch_src_global generation:  0.059201955795288086
r_  generation:  0.4982297420501709
local_output_nid generation:  0.03325033187866211
local_in_edges_tensor generation:  0.03231930732727051
mini_batch_src_global generation:  0.0619966983795166
r_  generation:  0.5083572864532471
local_output_nid generation:  0.029780864715576172
local_in_edges_tensor generation:  0.03547978401184082
mini_batch_src_global generation:  0.05931901931762695
r_  generation:  0.5006098747253418
local_output_nid generation:  0.030095577239990234
local_in_edges_tensor generation:  0.03573179244995117
mini_batch_src_global generation:  0.062215328216552734
r_  generation:  0.5084049701690674
local_output_nid generation:  0.029962778091430664
local_in_edges_tensor generation:  0.03528475761413574
mini_batch_src_global generation:  0.059325456619262695
r_  generation:  0.5004215240478516
local_output_nid generation:  0.03010702133178711
local_in_edges_tensor generation:  0.04115033149719238
mini_batch_src_global generation:  0.05859637260437012
r_  generation:  0.5067741870880127
local_output_nid generation:  0.030124664306640625
local_in_edges_tensor generation:  0.04155611991882324
mini_batch_src_global generation:  0.059639930725097656
r_  generation:  0.511962890625
local_output_nid generation:  0.030550003051757812
local_in_edges_tensor generation:  0.03580212593078613
mini_batch_src_global generation:  0.0597844123840332
r_  generation:  0.5113587379455566
local_output_nid generation:  0.0301055908203125
local_in_edges_tensor generation:  0.04104781150817871
mini_batch_src_global generation:  0.059139251708984375
r_  generation:  0.5090827941894531
----------------------check_connections_block total spend ----------------------------- 11.790472745895386
generate_one_block  0.640350341796875
generate_one_block  0.6489098072052002
generate_one_block  0.6478312015533447
generate_one_block  0.6550641059875488
generate_one_block  0.6306581497192383
generate_one_block  0.6354260444641113
generate_one_block  0.7298245429992676
generate_one_block  0.6312541961669922
generate_one_block  0.644542932510376
generate_one_block  0.6472399234771729
generate_one_block  0.654829740524292
generate_one_block  0.6360547542572021
generate_one_block  0.675361156463623
generate_one_block  0.6665818691253662
generate_one_block  0.6341547966003418
generate_one_block  0.6505436897277832
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04804491996765137
gen group dst list time:  0.09652829170227051
time for parepare:  0.019713640213012695
local_output_nid generation:  0.03237104415893555
local_in_edges_tensor generation:  0.06943416595458984
mini_batch_src_global generation:  0.051779747009277344
r_  generation:  0.5348026752471924
local_output_nid generation:  0.03764677047729492
local_in_edges_tensor generation:  0.05502057075500488
mini_batch_src_global generation:  0.06366825103759766
r_  generation:  0.5377333164215088
local_output_nid generation:  0.03636455535888672
local_in_edges_tensor generation:  0.04130959510803223
mini_batch_src_global generation:  0.05945229530334473
r_  generation:  0.5440270900726318
local_output_nid generation:  0.03678464889526367
local_in_edges_tensor generation:  0.040192365646362305
mini_batch_src_global generation:  0.060064077377319336
r_  generation:  0.542994499206543
local_output_nid generation:  0.03669095039367676
local_in_edges_tensor generation:  0.040549516677856445
mini_batch_src_global generation:  0.06006479263305664
r_  generation:  0.5510523319244385
local_output_nid generation:  0.036812543869018555
local_in_edges_tensor generation:  0.04098820686340332
mini_batch_src_global generation:  0.05875515937805176
r_  generation:  0.5553653240203857
local_output_nid generation:  0.03668665885925293
local_in_edges_tensor generation:  0.03994441032409668
mini_batch_src_global generation:  0.06484389305114746
r_  generation:  0.558243989944458
local_output_nid generation:  0.03672075271606445
local_in_edges_tensor generation:  0.04107236862182617
mini_batch_src_global generation:  0.0643622875213623
r_  generation:  0.5619082450866699
local_output_nid generation:  0.03767251968383789
local_in_edges_tensor generation:  0.04651498794555664
mini_batch_src_global generation:  0.062091827392578125
r_  generation:  0.5647809505462646
local_output_nid generation:  0.036943912506103516
local_in_edges_tensor generation:  0.03713059425354004
mini_batch_src_global generation:  0.06168103218078613
r_  generation:  0.5689890384674072
local_output_nid generation:  0.03716087341308594
local_in_edges_tensor generation:  0.0357670783996582
mini_batch_src_global generation:  0.06584548950195312
r_  generation:  0.5678484439849854
local_output_nid generation:  0.03718209266662598
local_in_edges_tensor generation:  0.03772163391113281
mini_batch_src_global generation:  0.06146502494812012
r_  generation:  0.5667407512664795
local_output_nid generation:  0.037213802337646484
local_in_edges_tensor generation:  0.03654670715332031
mini_batch_src_global generation:  0.06676197052001953
r_  generation:  0.562157392501831
local_output_nid generation:  0.03736472129821777
local_in_edges_tensor generation:  0.04198408126831055
mini_batch_src_global generation:  0.06157326698303223
r_  generation:  0.5742573738098145
local_output_nid generation:  0.03702116012573242
local_in_edges_tensor generation:  0.04125857353210449
mini_batch_src_global generation:  0.06607699394226074
r_  generation:  0.564138650894165
local_output_nid generation:  0.03759169578552246
local_in_edges_tensor generation:  0.04557633399963379
mini_batch_src_global generation:  0.06255102157592773
r_  generation:  0.567645788192749
----------------------check_connections_block total spend ----------------------------- 13.2844717502594
generate_one_block  0.6918103694915771
generate_one_block  0.6973652839660645
generate_one_block  0.6879673004150391
generate_one_block  0.7551312446594238
generate_one_block  0.6956226825714111
generate_one_block  0.688255786895752
generate_one_block  0.7004537582397461
generate_one_block  0.7222967147827148
generate_one_block  0.7117724418640137
generate_one_block  0.6812279224395752
generate_one_block  0.680340051651001
generate_one_block  0.6839122772216797
generate_one_block  0.6954610347747803
generate_one_block  0.6981267929077148
generate_one_block  0.6964373588562012
generate_one_block  0.7096879482269287
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04484152793884277
gen group dst list time:  0.09852385520935059
time for parepare:  0.019090890884399414
local_output_nid generation:  0.035101890563964844
local_in_edges_tensor generation:  0.05217576026916504
mini_batch_src_global generation:  0.05333828926086426
r_  generation:  0.5370039939880371
local_output_nid generation:  0.03996920585632324
local_in_edges_tensor generation:  0.03636288642883301
mini_batch_src_global generation:  0.06256222724914551
r_  generation:  0.5390374660491943
local_output_nid generation:  0.038156747817993164
local_in_edges_tensor generation:  0.03618025779724121
mini_batch_src_global generation:  0.06344270706176758
r_  generation:  0.538095235824585
local_output_nid generation:  0.03851127624511719
local_in_edges_tensor generation:  0.036589622497558594
mini_batch_src_global generation:  0.060695648193359375
r_  generation:  0.5447831153869629
local_output_nid generation:  0.03844022750854492
local_in_edges_tensor generation:  0.041646718978881836
mini_batch_src_global generation:  0.0656282901763916
r_  generation:  0.5490729808807373
local_output_nid generation:  0.03856682777404785
local_in_edges_tensor generation:  0.04157137870788574
mini_batch_src_global generation:  0.06105756759643555
r_  generation:  0.542900562286377
local_output_nid generation:  0.03894305229187012
local_in_edges_tensor generation:  0.041312217712402344
mini_batch_src_global generation:  0.06471133232116699
r_  generation:  0.5436253547668457
local_output_nid generation:  0.038513898849487305
local_in_edges_tensor generation:  0.03713583946228027
mini_batch_src_global generation:  0.06418180465698242
r_  generation:  0.5557360649108887
local_output_nid generation:  0.03870129585266113
local_in_edges_tensor generation:  0.04977107048034668
mini_batch_src_global generation:  0.06026935577392578
r_  generation:  0.5451064109802246
local_output_nid generation:  0.038988351821899414
local_in_edges_tensor generation:  0.041657209396362305
mini_batch_src_global generation:  0.0611419677734375
r_  generation:  0.5486605167388916
local_output_nid generation:  0.03878355026245117
local_in_edges_tensor generation:  0.036417484283447266
mini_batch_src_global generation:  0.060857534408569336
r_  generation:  0.5695409774780273
local_output_nid generation:  0.04203963279724121
local_in_edges_tensor generation:  0.041992902755737305
mini_batch_src_global generation:  0.06389284133911133
r_  generation:  0.5475571155548096
local_output_nid generation:  0.03990459442138672
local_in_edges_tensor generation:  0.04658007621765137
mini_batch_src_global generation:  0.06498336791992188
r_  generation:  0.5462164878845215
local_output_nid generation:  0.04013705253601074
local_in_edges_tensor generation:  0.041709184646606445
mini_batch_src_global generation:  0.060117244720458984
r_  generation:  0.5549614429473877
local_output_nid generation:  0.03997159004211426
local_in_edges_tensor generation:  0.042061567306518555
mini_batch_src_global generation:  0.06350398063659668
r_  generation:  0.549884557723999
local_output_nid generation:  0.0406641960144043
local_in_edges_tensor generation:  0.04247331619262695
mini_batch_src_global generation:  0.06448507308959961
r_  generation:  0.5572056770324707
----------------------check_connections_block total spend ----------------------------- 13.128129243850708
generate_one_block  0.7025492191314697
generate_one_block  0.7024857997894287
generate_one_block  0.6798171997070312
generate_one_block  0.6894609928131104
generate_one_block  0.6936962604522705
generate_one_block  0.6713511943817139
generate_one_block  0.7267642021179199
generate_one_block  0.7044665813446045
generate_one_block  0.6867141723632812
generate_one_block  0.6699924468994141
generate_one_block  0.6930851936340332
generate_one_block  0.6736130714416504
generate_one_block  0.6822388172149658
generate_one_block  0.6716337203979492
generate_one_block  0.6783959865570068
generate_one_block  0.694319486618042
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03524947166442871
gen group dst list time:  0.09390377998352051
time for parepare:  0.01881885528564453
local_output_nid generation:  0.03475451469421387
local_in_edges_tensor generation:  0.05099034309387207
mini_batch_src_global generation:  0.047959327697753906
r_  generation:  0.49814462661743164
local_output_nid generation:  0.0411067008972168
local_in_edges_tensor generation:  0.033442020416259766
mini_batch_src_global generation:  0.05710959434509277
r_  generation:  0.510753870010376
local_output_nid generation:  0.03941011428833008
local_in_edges_tensor generation:  0.03424787521362305
mini_batch_src_global generation:  0.05762743949890137
r_  generation:  0.5014913082122803
local_output_nid generation:  0.03916573524475098
local_in_edges_tensor generation:  0.03884577751159668
mini_batch_src_global generation:  0.05753278732299805
r_  generation:  0.5049264430999756
local_output_nid generation:  0.03893303871154785
local_in_edges_tensor generation:  0.04347419738769531
mini_batch_src_global generation:  0.057554006576538086
r_  generation:  0.5043654441833496
local_output_nid generation:  0.03951239585876465
local_in_edges_tensor generation:  0.0346987247467041
mini_batch_src_global generation:  0.05811953544616699
r_  generation:  0.5050811767578125
local_output_nid generation:  0.03978848457336426
local_in_edges_tensor generation:  0.03462553024291992
mini_batch_src_global generation:  0.05741524696350098
r_  generation:  0.5039196014404297
local_output_nid generation:  0.039071083068847656
local_in_edges_tensor generation:  0.043407440185546875
mini_batch_src_global generation:  0.05775141716003418
r_  generation:  0.5079984664916992
local_output_nid generation:  0.04263782501220703
local_in_edges_tensor generation:  0.03545689582824707
mini_batch_src_global generation:  0.05849957466125488
r_  generation:  0.5116763114929199
local_output_nid generation:  0.03995013236999512
local_in_edges_tensor generation:  0.0405879020690918
mini_batch_src_global generation:  0.06165647506713867
r_  generation:  0.5099239349365234
local_output_nid generation:  0.039793968200683594
local_in_edges_tensor generation:  0.04309582710266113
mini_batch_src_global generation:  0.059165239334106445
r_  generation:  0.5127823352813721
local_output_nid generation:  0.04005575180053711
local_in_edges_tensor generation:  0.03975200653076172
mini_batch_src_global generation:  0.06121540069580078
r_  generation:  0.5113222599029541
local_output_nid generation:  0.0399622917175293
local_in_edges_tensor generation:  0.04378867149353027
mini_batch_src_global generation:  0.05917525291442871
r_  generation:  0.5118200778961182
local_output_nid generation:  0.03983044624328613
local_in_edges_tensor generation:  0.034063100814819336
mini_batch_src_global generation:  0.05890250205993652
r_  generation:  0.5141212940216064
local_output_nid generation:  0.04009866714477539
local_in_edges_tensor generation:  0.043849945068359375
mini_batch_src_global generation:  0.058235883712768555
r_  generation:  0.5160598754882812
local_output_nid generation:  0.04041647911071777
local_in_edges_tensor generation:  0.044446706771850586
mini_batch_src_global generation:  0.058995723724365234
r_  generation:  0.5151810646057129
----------------------check_connections_block total spend ----------------------------- 12.282515048980713
generate_one_block  0.6287860870361328
generate_one_block  0.6388142108917236
generate_one_block  0.6415159702301025
generate_one_block  0.6507275104522705
generate_one_block  0.6462404727935791
generate_one_block  0.6286108493804932
generate_one_block  0.6293754577636719
generate_one_block  0.6479878425598145
generate_one_block  0.699819803237915
generate_one_block  0.6461532115936279
generate_one_block  0.6456482410430908
generate_one_block  0.6526646614074707
generate_one_block  0.6346700191497803
generate_one_block  0.6241946220397949
generate_one_block  0.6452500820159912
generate_one_block  0.6544091701507568
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006604194641113281  GigaBytes
Max Memory Allocated: 0.0006604194641113281  GigaBytes

connection checking time:  55.5112943649292
block generation total time  47.44671154022217
average batch blocks generation time:  2.9654194712638855
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13562965393066406  GigaBytes
Max Memory Allocated: 0.13562965393066406  GigaBytes

torch.Size([167206, 128])
torch.Size([166413, 128])
torch.Size([164111, 128])
torch.Size([156051, 128])
torch.Size([124171, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9451904296875 GB
    Memory Allocated: 1.5220208168029785  GigaBytes
Max Memory Allocated: 1.5397825241088867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2733154296875 GB
    Memory Allocated: 0.13827133178710938  GigaBytes
Max Memory Allocated: 1.561830997467041  GigaBytes

torch.Size([167154, 128])
torch.Size([166345, 128])
torch.Size([164012, 128])
torch.Size([155923, 128])
torch.Size([123984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5245060920715332  GigaBytes
Max Memory Allocated: 1.561830997467041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.1382603645324707  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

torch.Size([167213, 128])
torch.Size([166430, 128])
torch.Size([164027, 128])
torch.Size([155795, 128])
torch.Size([123621, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5225248336791992  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13827896118164062  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

torch.Size([167200, 128])
torch.Size([166466, 128])
torch.Size([164063, 128])
torch.Size([155805, 128])
torch.Size([124041, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5244522094726562  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13823270797729492  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

torch.Size([167234, 128])
torch.Size([166468, 128])
torch.Size([164118, 128])
torch.Size([155906, 128])
torch.Size([123478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.522413730621338  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13822507858276367  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

torch.Size([167172, 128])
torch.Size([166333, 128])
torch.Size([163972, 128])
torch.Size([155718, 128])
torch.Size([123351, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5211257934570312  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13829469680786133  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

torch.Size([167186, 128])
torch.Size([166382, 128])
torch.Size([164001, 128])
torch.Size([155789, 128])
torch.Size([124352, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5263018608093262  GigaBytes
Max Memory Allocated: 1.5648603439331055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13817977905273438  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167216, 128])
torch.Size([166442, 128])
torch.Size([164054, 128])
torch.Size([155687, 128])
torch.Size([123035, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5199370384216309  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13827180862426758  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167107, 128])
torch.Size([166342, 128])
torch.Size([164045, 128])
torch.Size([156038, 128])
torch.Size([124540, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5252747535705566  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13818597793579102  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167195, 128])
torch.Size([166417, 128])
torch.Size([164020, 128])
torch.Size([155728, 128])
torch.Size([123159, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5203924179077148  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.1382460594177246  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167192, 128])
torch.Size([166390, 128])
torch.Size([164038, 128])
torch.Size([156016, 128])
torch.Size([124065, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5236921310424805  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13820600509643555  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167196, 128])
torch.Size([166400, 128])
torch.Size([163904, 128])
torch.Size([155561, 128])
torch.Size([123222, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5183210372924805  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13828134536743164  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167150, 128])
torch.Size([166366, 128])
torch.Size([164088, 128])
torch.Size([155913, 128])
torch.Size([124145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.524796485900879  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.1382899284362793  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167088, 128])
torch.Size([166282, 128])
torch.Size([163880, 128])
torch.Size([155723, 128])
torch.Size([124263, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5255746841430664  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.1382441520690918  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167176, 128])
torch.Size([166388, 128])
torch.Size([163979, 128])
torch.Size([155732, 128])
torch.Size([123569, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5219402313232422  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.13831043243408203  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167229, 128])
torch.Size([166431, 128])
torch.Size([164043, 128])
torch.Size([155919, 128])
torch.Size([124400, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5258893966674805  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09321381151676178 |0.0677836537361145 |0.04784119129180908 |9.47713851928711e-05 |0.02251279354095459 |0.0032110214233398438 |
----------------------------------------------------------pseudo_mini_loss sum 6.155643939971924
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13097741
Number of first layer input nodes during this epoch:  2674914
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.24523067474365234  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.01762557029724121
range selection method range initialization spend 0.01147150993347168
time for parepare:  0.01685190200805664
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.006162881851196289
mini_batch_src_global generation:  0.0018727779388427734
r_  generation:  0.018076658248901367
local_output_nid generation:  0.0015106201171875
local_in_edges_tensor generation:  0.0008969306945800781
mini_batch_src_global generation:  0.002107858657836914
r_  generation:  0.01916956901550293
local_output_nid generation:  0.0015146732330322266
local_in_edges_tensor generation:  0.0008454322814941406
mini_batch_src_global generation:  0.0014905929565429688
r_  generation:  0.01862645149230957
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008299350738525391
mini_batch_src_global generation:  0.001378774642944336
r_  generation:  0.018613815307617188
local_output_nid generation:  0.0015795230865478516
local_in_edges_tensor generation:  0.0008368492126464844
mini_batch_src_global generation:  0.0014770030975341797
r_  generation:  0.018516063690185547
local_output_nid generation:  0.0015301704406738281
local_in_edges_tensor generation:  0.0008263587951660156
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.018623828887939453
local_output_nid generation:  0.0016415119171142578
local_in_edges_tensor generation:  0.0008556842803955078
mini_batch_src_global generation:  0.0015723705291748047
r_  generation:  0.01944422721862793
local_output_nid generation:  0.001634359359741211
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0015795230865478516
r_  generation:  0.019756555557250977
local_output_nid generation:  0.0015828609466552734
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.001439809799194336
r_  generation:  0.018931865692138672
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0015349388122558594
r_  generation:  0.019307851791381836
local_output_nid generation:  0.001569509506225586
local_in_edges_tensor generation:  0.0008261203765869141
mini_batch_src_global generation:  0.0015647411346435547
r_  generation:  0.019344806671142578
local_output_nid generation:  0.0015673637390136719
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.0015721321105957031
r_  generation:  0.019316911697387695
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008387565612792969
mini_batch_src_global generation:  0.0014445781707763672
r_  generation:  0.019578933715820312
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0009019374847412109
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.01911449432373047
local_output_nid generation:  0.0015473365783691406
local_in_edges_tensor generation:  0.0008139610290527344
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.019176006317138672
local_output_nid generation:  0.0015218257904052734
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.018887996673583984
----------------------check_connections_block total spend ----------------------------- 0.4576382637023926
generate_one_block  0.02616262435913086
generate_one_block  0.028034210205078125
generate_one_block  0.02729201316833496
generate_one_block  0.02699732780456543
generate_one_block  0.027486562728881836
generate_one_block  0.03260517120361328
generate_one_block  0.027600526809692383
generate_one_block  0.027820587158203125
generate_one_block  0.027302265167236328
generate_one_block  0.027449369430541992
generate_one_block  0.027722597122192383
generate_one_block  0.027786731719970703
generate_one_block  0.02863907814025879
generate_one_block  0.027562618255615234
generate_one_block  0.031751155853271484
generate_one_block  0.02818465232849121
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03905510902404785
gen group dst list time:  0.016544103622436523
time for parepare:  0.01892375946044922
local_output_nid generation:  0.006453514099121094
local_in_edges_tensor generation:  0.019852876663208008
mini_batch_src_global generation:  0.0189359188079834
r_  generation:  0.19591784477233887
local_output_nid generation:  0.009943485260009766
local_in_edges_tensor generation:  0.017655134201049805
mini_batch_src_global generation:  0.02881455421447754
r_  generation:  0.20476722717285156
local_output_nid generation:  0.010564804077148438
local_in_edges_tensor generation:  0.012819051742553711
mini_batch_src_global generation:  0.02388596534729004
r_  generation:  0.20710229873657227
local_output_nid generation:  0.010979890823364258
local_in_edges_tensor generation:  0.013096809387207031
mini_batch_src_global generation:  0.026610851287841797
r_  generation:  0.2120962142944336
local_output_nid generation:  0.011055469512939453
local_in_edges_tensor generation:  0.013154745101928711
mini_batch_src_global generation:  0.02739715576171875
r_  generation:  0.21382498741149902
local_output_nid generation:  0.010717153549194336
local_in_edges_tensor generation:  0.011498212814331055
mini_batch_src_global generation:  0.026343107223510742
r_  generation:  0.21514201164245605
local_output_nid generation:  0.011128664016723633
local_in_edges_tensor generation:  0.01303863525390625
mini_batch_src_global generation:  0.026703834533691406
r_  generation:  0.2154836654663086
local_output_nid generation:  0.011664628982543945
local_in_edges_tensor generation:  0.015151500701904297
mini_batch_src_global generation:  0.02861499786376953
r_  generation:  0.21715211868286133
local_output_nid generation:  0.011563539505004883
local_in_edges_tensor generation:  0.011828899383544922
mini_batch_src_global generation:  0.027007102966308594
r_  generation:  0.21642494201660156
local_output_nid generation:  0.011600255966186523
local_in_edges_tensor generation:  0.01315450668334961
mini_batch_src_global generation:  0.026967525482177734
r_  generation:  0.21970677375793457
local_output_nid generation:  0.011716127395629883
local_in_edges_tensor generation:  0.013465166091918945
mini_batch_src_global generation:  0.028642654418945312
r_  generation:  0.2189638614654541
local_output_nid generation:  0.011639595031738281
local_in_edges_tensor generation:  0.011883735656738281
mini_batch_src_global generation:  0.027111291885375977
r_  generation:  0.21614718437194824
local_output_nid generation:  0.011785030364990234
local_in_edges_tensor generation:  0.011930227279663086
mini_batch_src_global generation:  0.02733445167541504
r_  generation:  0.22125554084777832
local_output_nid generation:  0.011707782745361328
local_in_edges_tensor generation:  0.01720905303955078
mini_batch_src_global generation:  0.027341604232788086
r_  generation:  0.21786212921142578
local_output_nid generation:  0.011808156967163086
local_in_edges_tensor generation:  0.011710643768310547
mini_batch_src_global generation:  0.027429580688476562
r_  generation:  0.21756362915039062
local_output_nid generation:  0.011445283889770508
local_in_edges_tensor generation:  0.011967658996582031
mini_batch_src_global generation:  0.026888370513916016
r_  generation:  0.21827483177185059
----------------------check_connections_block total spend ----------------------------- 5.018516302108765
generate_one_block  0.2683899402618408
generate_one_block  0.27948999404907227
generate_one_block  0.27515697479248047
generate_one_block  0.2744760513305664
generate_one_block  0.2752711772918701
generate_one_block  0.2741584777832031
generate_one_block  0.29738807678222656
generate_one_block  0.2845652103424072
generate_one_block  0.2742040157318115
generate_one_block  0.27562451362609863
generate_one_block  0.27669763565063477
generate_one_block  0.2742149829864502
generate_one_block  0.2857382297515869
generate_one_block  0.2758457660675049
generate_one_block  0.27448296546936035
generate_one_block  0.27530550956726074
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03945136070251465
gen group dst list time:  0.059166908264160156
time for parepare:  0.017201662063598633
local_output_nid generation:  0.02368450164794922
local_in_edges_tensor generation:  0.03789877891540527
mini_batch_src_global generation:  0.04830145835876465
r_  generation:  0.49125194549560547
local_output_nid generation:  0.029021263122558594
local_in_edges_tensor generation:  0.04846453666687012
mini_batch_src_global generation:  0.06198263168334961
r_  generation:  0.49248290061950684
local_output_nid generation:  0.029462814331054688
local_in_edges_tensor generation:  0.03980731964111328
mini_batch_src_global generation:  0.05763888359069824
r_  generation:  0.4998624324798584
local_output_nid generation:  0.03001260757446289
local_in_edges_tensor generation:  0.031579017639160156
mini_batch_src_global generation:  0.06291890144348145
r_  generation:  0.49443864822387695
local_output_nid generation:  0.029584884643554688
local_in_edges_tensor generation:  0.08299469947814941
mini_batch_src_global generation:  0.06027936935424805
r_  generation:  0.5024094581604004
local_output_nid generation:  0.029924392700195312
local_in_edges_tensor generation:  0.041075944900512695
mini_batch_src_global generation:  0.05917048454284668
r_  generation:  0.5009312629699707
local_output_nid generation:  0.029897212982177734
local_in_edges_tensor generation:  0.03188443183898926
mini_batch_src_global generation:  0.05866074562072754
r_  generation:  0.5027000904083252
local_output_nid generation:  0.030205488204956055
local_in_edges_tensor generation:  0.03162360191345215
mini_batch_src_global generation:  0.058835506439208984
r_  generation:  0.499997615814209
local_output_nid generation:  0.030280590057373047
local_in_edges_tensor generation:  0.037587881088256836
mini_batch_src_global generation:  0.058177947998046875
r_  generation:  0.5090947151184082
local_output_nid generation:  0.030480623245239258
local_in_edges_tensor generation:  0.035559892654418945
mini_batch_src_global generation:  0.059293270111083984
r_  generation:  0.5011653900146484
local_output_nid generation:  0.030602455139160156
local_in_edges_tensor generation:  0.035625457763671875
mini_batch_src_global generation:  0.06180214881896973
r_  generation:  0.5090622901916504
local_output_nid generation:  0.030226469039916992
local_in_edges_tensor generation:  0.03342795372009277
mini_batch_src_global generation:  0.05999135971069336
r_  generation:  0.5057892799377441
local_output_nid generation:  0.03047943115234375
local_in_edges_tensor generation:  0.03638863563537598
mini_batch_src_global generation:  0.06598138809204102
r_  generation:  0.5097613334655762
local_output_nid generation:  0.030683040618896484
local_in_edges_tensor generation:  0.04522824287414551
mini_batch_src_global generation:  0.05940723419189453
r_  generation:  0.4993019104003906
local_output_nid generation:  0.030597209930419922
local_in_edges_tensor generation:  0.045859336853027344
mini_batch_src_global generation:  0.05783343315124512
r_  generation:  0.5153276920318604
local_output_nid generation:  0.030351877212524414
local_in_edges_tensor generation:  0.03230547904968262
mini_batch_src_global generation:  0.05936288833618164
r_  generation:  0.5028958320617676
----------------------check_connections_block total spend ----------------------------- 11.8344407081604
generate_one_block  0.6338210105895996
generate_one_block  0.6426997184753418
generate_one_block  0.6428115367889404
generate_one_block  0.6492807865142822
generate_one_block  0.6421966552734375
generate_one_block  0.6552133560180664
generate_one_block  0.6362695693969727
generate_one_block  0.6527879238128662
generate_one_block  0.6889505386352539
generate_one_block  0.635561466217041
generate_one_block  0.6473338603973389
generate_one_block  0.6345007419586182
generate_one_block  0.6543800830841064
generate_one_block  0.6688210964202881
generate_one_block  0.6498322486877441
generate_one_block  0.6340608596801758
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.045121192932128906
gen group dst list time:  0.08861756324768066
time for parepare:  0.019562482833862305
local_output_nid generation:  0.03165245056152344
local_in_edges_tensor generation:  0.058563947677612305
mini_batch_src_global generation:  0.054822444915771484
r_  generation:  0.5362622737884521
local_output_nid generation:  0.03838038444519043
local_in_edges_tensor generation:  0.05429244041442871
mini_batch_src_global generation:  0.06202244758605957
r_  generation:  0.54337477684021
local_output_nid generation:  0.0385587215423584
local_in_edges_tensor generation:  0.040203094482421875
mini_batch_src_global generation:  0.05952191352844238
r_  generation:  0.5561766624450684
local_output_nid generation:  0.03973960876464844
local_in_edges_tensor generation:  0.03969860076904297
mini_batch_src_global generation:  0.05818963050842285
r_  generation:  0.5563080310821533
local_output_nid generation:  0.03859996795654297
local_in_edges_tensor generation:  0.0411982536315918
mini_batch_src_global generation:  0.05900263786315918
r_  generation:  0.5641725063323975
local_output_nid generation:  0.036281585693359375
local_in_edges_tensor generation:  0.040319204330444336
mini_batch_src_global generation:  0.059032440185546875
r_  generation:  0.5636136531829834
local_output_nid generation:  0.03613924980163574
local_in_edges_tensor generation:  0.040274858474731445
mini_batch_src_global generation:  0.060158729553222656
r_  generation:  0.5656604766845703
local_output_nid generation:  0.03676605224609375
local_in_edges_tensor generation:  0.04507565498352051
mini_batch_src_global generation:  0.0601191520690918
r_  generation:  0.5624711513519287
local_output_nid generation:  0.03641080856323242
local_in_edges_tensor generation:  0.041219472885131836
mini_batch_src_global generation:  0.060677528381347656
r_  generation:  0.568002462387085
local_output_nid generation:  0.03641557693481445
local_in_edges_tensor generation:  0.03996539115905762
mini_batch_src_global generation:  0.06058931350708008
r_  generation:  0.5938313007354736
local_output_nid generation:  0.03692197799682617
local_in_edges_tensor generation:  0.04089164733886719
mini_batch_src_global generation:  0.0685873031616211
r_  generation:  0.5671746730804443
local_output_nid generation:  0.0373227596282959
local_in_edges_tensor generation:  0.04069089889526367
mini_batch_src_global generation:  0.06120419502258301
r_  generation:  0.5829341411590576
local_output_nid generation:  0.039891719818115234
local_in_edges_tensor generation:  0.04369544982910156
mini_batch_src_global generation:  0.06808781623840332
r_  generation:  0.5754387378692627
local_output_nid generation:  0.038105010986328125
local_in_edges_tensor generation:  0.040452003479003906
mini_batch_src_global generation:  0.06115555763244629
r_  generation:  0.5700719356536865
local_output_nid generation:  0.038367271423339844
local_in_edges_tensor generation:  0.04158210754394531
mini_batch_src_global generation:  0.061991214752197266
r_  generation:  0.5759601593017578
local_output_nid generation:  0.038114309310913086
local_in_edges_tensor generation:  0.04087257385253906
mini_batch_src_global generation:  0.06189274787902832
r_  generation:  0.569544792175293
----------------------check_connections_block total spend ----------------------------- 13.42242693901062
generate_one_block  0.6923606395721436
generate_one_block  0.7042372226715088
generate_one_block  0.7088329792022705
generate_one_block  0.6912224292755127
generate_one_block  0.6952834129333496
generate_one_block  0.7578399181365967
generate_one_block  0.8408901691436768
generate_one_block  0.7123785018920898
generate_one_block  0.7257513999938965
generate_one_block  0.716886043548584
generate_one_block  0.7182166576385498
generate_one_block  0.7208693027496338
generate_one_block  0.7335236072540283
generate_one_block  0.7190535068511963
generate_one_block  0.7222659587860107
generate_one_block  0.7128620147705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04336142539978027
gen group dst list time:  0.11551713943481445
time for parepare:  0.019959688186645508
local_output_nid generation:  0.03619074821472168
local_in_edges_tensor generation:  0.05437874794006348
mini_batch_src_global generation:  0.04805469512939453
r_  generation:  0.5562312602996826
local_output_nid generation:  0.042315006256103516
local_in_edges_tensor generation:  0.04757285118103027
mini_batch_src_global generation:  0.06322979927062988
r_  generation:  0.5592546463012695
local_output_nid generation:  0.039557695388793945
local_in_edges_tensor generation:  0.0418398380279541
mini_batch_src_global generation:  0.062207698822021484
r_  generation:  0.5703356266021729
local_output_nid generation:  0.03918027877807617
local_in_edges_tensor generation:  0.04161429405212402
mini_batch_src_global generation:  0.0620882511138916
r_  generation:  0.551483154296875
local_output_nid generation:  0.03969097137451172
local_in_edges_tensor generation:  0.042265892028808594
mini_batch_src_global generation:  0.06150054931640625
r_  generation:  0.5608692169189453
local_output_nid generation:  0.039960622787475586
local_in_edges_tensor generation:  0.04230475425720215
mini_batch_src_global generation:  0.062128305435180664
r_  generation:  0.5522196292877197
local_output_nid generation:  0.04018855094909668
local_in_edges_tensor generation:  0.04498767852783203
mini_batch_src_global generation:  0.06035161018371582
r_  generation:  0.5638453960418701
local_output_nid generation:  0.04074573516845703
local_in_edges_tensor generation:  0.04997396469116211
mini_batch_src_global generation:  0.06162691116333008
r_  generation:  0.5607120990753174
local_output_nid generation:  0.04036569595336914
local_in_edges_tensor generation:  0.04978370666503906
mini_batch_src_global generation:  0.06097698211669922
r_  generation:  0.5683152675628662
local_output_nid generation:  0.039939165115356445
local_in_edges_tensor generation:  0.053254127502441406
mini_batch_src_global generation:  0.06419157981872559
r_  generation:  0.5634016990661621
local_output_nid generation:  0.04327559471130371
local_in_edges_tensor generation:  0.04323148727416992
mini_batch_src_global generation:  0.06498265266418457
r_  generation:  0.5622529983520508
local_output_nid generation:  0.04115486145019531
local_in_edges_tensor generation:  0.04186201095581055
mini_batch_src_global generation:  0.06135749816894531
r_  generation:  0.5624644756317139
local_output_nid generation:  0.04123973846435547
local_in_edges_tensor generation:  0.042075157165527344
mini_batch_src_global generation:  0.06101107597351074
r_  generation:  0.5649940967559814
local_output_nid generation:  0.04133796691894531
local_in_edges_tensor generation:  0.05167126655578613
mini_batch_src_global generation:  0.06255054473876953
r_  generation:  0.5635082721710205
local_output_nid generation:  0.05244016647338867
local_in_edges_tensor generation:  0.04255938529968262
mini_batch_src_global generation:  0.0621943473815918
r_  generation:  0.5792474746704102
local_output_nid generation:  0.0413665771484375
local_in_edges_tensor generation:  0.04765439033508301
mini_batch_src_global generation:  0.06284594535827637
r_  generation:  0.5685007572174072
----------------------check_connections_block total spend ----------------------------- 13.532225847244263
generate_one_block  0.7013444900512695
generate_one_block  0.7067165374755859
generate_one_block  0.7013919353485107
generate_one_block  0.7053623199462891
generate_one_block  0.706305980682373
generate_one_block  0.7105891704559326
generate_one_block  0.6861553192138672
generate_one_block  0.7049410343170166
generate_one_block  0.7035906314849854
generate_one_block  0.7913072109222412
generate_one_block  0.7055811882019043
generate_one_block  0.6896703243255615
generate_one_block  0.7541050910949707
generate_one_block  0.7205338478088379
generate_one_block  0.6944868564605713
generate_one_block  0.7050306797027588
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0411524772644043
gen group dst list time:  0.11816239356994629
time for parepare:  0.019503116607666016
local_output_nid generation:  0.03627324104309082
local_in_edges_tensor generation:  0.05598330497741699
mini_batch_src_global generation:  0.04536747932434082
r_  generation:  0.513174295425415
local_output_nid generation:  0.05201458930969238
local_in_edges_tensor generation:  0.041142940521240234
mini_batch_src_global generation:  0.05802035331726074
r_  generation:  0.5175631046295166
local_output_nid generation:  0.04252457618713379
local_in_edges_tensor generation:  0.0452883243560791
mini_batch_src_global generation:  0.05888772010803223
r_  generation:  0.5174036026000977
local_output_nid generation:  0.04291534423828125
local_in_edges_tensor generation:  0.05027174949645996
mini_batch_src_global generation:  0.06380963325500488
r_  generation:  0.5211482048034668
local_output_nid generation:  0.04275822639465332
local_in_edges_tensor generation:  0.04581022262573242
mini_batch_src_global generation:  0.06521177291870117
r_  generation:  0.534327507019043
local_output_nid generation:  0.0452120304107666
local_in_edges_tensor generation:  0.04199790954589844
mini_batch_src_global generation:  0.059917449951171875
r_  generation:  0.5163533687591553
local_output_nid generation:  0.04104256629943848
local_in_edges_tensor generation:  0.04519367218017578
mini_batch_src_global generation:  0.057936906814575195
r_  generation:  0.515700101852417
local_output_nid generation:  0.04117631912231445
local_in_edges_tensor generation:  0.03813290596008301
mini_batch_src_global generation:  0.06166529655456543
r_  generation:  0.5141322612762451
local_output_nid generation:  0.05257606506347656
local_in_edges_tensor generation:  0.0453486442565918
mini_batch_src_global generation:  0.058570146560668945
r_  generation:  0.5170624256134033
local_output_nid generation:  0.04154157638549805
local_in_edges_tensor generation:  0.047209739685058594
mini_batch_src_global generation:  0.058592796325683594
r_  generation:  0.5268580913543701
local_output_nid generation:  0.04159069061279297
local_in_edges_tensor generation:  0.04484701156616211
mini_batch_src_global generation:  0.07670998573303223
r_  generation:  0.5388028621673584
local_output_nid generation:  0.042410850524902344
local_in_edges_tensor generation:  0.05410122871398926
mini_batch_src_global generation:  0.0610041618347168
r_  generation:  0.5452077388763428
local_output_nid generation:  0.04359555244445801
local_in_edges_tensor generation:  0.049918174743652344
mini_batch_src_global generation:  0.06522417068481445
r_  generation:  0.5239675045013428
local_output_nid generation:  0.041814565658569336
local_in_edges_tensor generation:  0.040384769439697266
mini_batch_src_global generation:  0.058692216873168945
r_  generation:  0.5244917869567871
local_output_nid generation:  0.04230642318725586
local_in_edges_tensor generation:  0.044739723205566406
mini_batch_src_global generation:  0.05824637413024902
r_  generation:  0.5273149013519287
local_output_nid generation:  0.04161429405212402
local_in_edges_tensor generation:  0.04030418395996094
mini_batch_src_global generation:  0.06410026550292969
r_  generation:  0.5404789447784424
----------------------check_connections_block total spend ----------------------------- 12.798555135726929
generate_one_block  0.6505489349365234
generate_one_block  0.6612920761108398
generate_one_block  0.6499624252319336
generate_one_block  0.6585330963134766
generate_one_block  0.6415233612060547
generate_one_block  0.6467437744140625
generate_one_block  0.6399538516998291
generate_one_block  0.6598479747772217
generate_one_block  0.6646292209625244
generate_one_block  0.6616532802581787
generate_one_block  0.6441793441772461
generate_one_block  0.6432654857635498
generate_one_block  0.7340397834777832
generate_one_block  0.6521127223968506
generate_one_block  0.6421477794647217
generate_one_block  0.6504037380218506
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.24523067474365234  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

connection checking time:  56.60616493225098
block generation total time  48.269954204559326
average batch blocks generation time:  3.016872137784958
block dataloader generation time/epoch 108.317875623703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 0.1395277976989746  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167259, 128])
torch.Size([166429, 128])
torch.Size([164008, 128])
torch.Size([155946, 128])
torch.Size([123406, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2752685546875 GB
    Memory Allocated: 1.5228204727172852  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.1395854949951172  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

torch.Size([167221, 128])
torch.Size([166409, 128])
torch.Size([163986, 128])
torch.Size([155891, 128])
torch.Size([124426, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5269756317138672  GigaBytes
Max Memory Allocated: 1.5663905143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13954401016235352  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167284, 128])
torch.Size([166421, 128])
torch.Size([163937, 128])
torch.Size([155656, 128])
torch.Size([123824, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5238080024719238  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.1395549774169922  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167274, 128])
torch.Size([166435, 128])
torch.Size([163994, 128])
torch.Size([155762, 128])
torch.Size([123999, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.525075912475586  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13954830169677734  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167295, 128])
torch.Size([166442, 128])
torch.Size([163947, 128])
torch.Size([155800, 128])
torch.Size([123659, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5239028930664062  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13956451416015625  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167274, 128])
torch.Size([166490, 128])
torch.Size([164080, 128])
torch.Size([156140, 128])
torch.Size([124249, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5258173942565918  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13953876495361328  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167176, 128])
torch.Size([166353, 128])
torch.Size([163841, 128])
torch.Size([155360, 128])
torch.Size([123241, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.521071434020996  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13956737518310547  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167234, 128])
torch.Size([166387, 128])
torch.Size([163973, 128])
torch.Size([155753, 128])
torch.Size([123710, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5251593589782715  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13956451416015625  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167270, 128])
torch.Size([166436, 128])
torch.Size([164010, 128])
torch.Size([155894, 128])
torch.Size([124006, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5249981880187988  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13955211639404297  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167253, 128])
torch.Size([166477, 128])
torch.Size([164030, 128])
torch.Size([155920, 128])
torch.Size([123996, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5251564979553223  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.139556884765625  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167309, 128])
torch.Size([166501, 128])
torch.Size([163999, 128])
torch.Size([155673, 128])
torch.Size([123841, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5246481895446777  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13952255249023438  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167254, 128])
torch.Size([166432, 128])
torch.Size([164001, 128])
torch.Size([155704, 128])
torch.Size([123496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5233397483825684  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13956260681152344  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167258, 128])
torch.Size([166404, 128])
torch.Size([164001, 128])
torch.Size([155636, 128])
torch.Size([123514, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5236902236938477  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.1395735740661621  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167247, 128])
torch.Size([166495, 128])
torch.Size([164089, 128])
torch.Size([155764, 128])
torch.Size([124157, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5250234603881836  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13957548141479492  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167260, 128])
torch.Size([166423, 128])
torch.Size([163982, 128])
torch.Size([155837, 128])
torch.Size([124166, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.525536060333252  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.13953638076782227  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

torch.Size([167291, 128])
torch.Size([166489, 128])
torch.Size([163992, 128])
torch.Size([155854, 128])
torch.Size([123631, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 1.5237212181091309  GigaBytes
Max Memory Allocated: 1.5672497749328613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09444327652454376 |0.05130767822265625 |0.006761491298675537 |9.231269359588623e-05 |0.016507312655448914 |0.0032668113708496094 |
----------------------------------------------------------pseudo_mini_loss sum 4.144251823425293
Total (block generation + training)time/epoch 111.13433361053467
Training time/epoch 2.816084623336792
Training time without block to device /epoch 1.995161771774292
Training time without total dataloading part /epoch 0.377044677734375
load block tensor time/epoch 1.5110924243927002
block to device time/epoch 0.8209228515625
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13099250
Number of first layer input nodes during this epoch:  2676159
