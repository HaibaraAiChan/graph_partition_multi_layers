Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648483949.0739367
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024877071380615234
range selection method range initialization spend 0.01335287094116211
time for parepare:  0.017725706100463867
local_output_nid generation:  0.002695798873901367
local_in_edges_tensor generation:  0.004728555679321289
mini_batch_src_global generation:  0.003198385238647461
r_  generation:  0.037851810455322266
local_output_nid generation:  0.003019094467163086
local_in_edges_tensor generation:  0.0016102790832519531
mini_batch_src_global generation:  0.004151821136474609
r_  generation:  0.03892660140991211
local_output_nid generation:  0.0031423568725585938
local_in_edges_tensor generation:  0.0016613006591796875
mini_batch_src_global generation:  0.002667665481567383
r_  generation:  0.03921985626220703
local_output_nid generation:  0.0030794143676757812
local_in_edges_tensor generation:  0.001645803451538086
mini_batch_src_global generation:  0.0029201507568359375
r_  generation:  0.03999614715576172
local_output_nid generation:  0.003132343292236328
local_in_edges_tensor generation:  0.0016286373138427734
mini_batch_src_global generation:  0.002869129180908203
r_  generation:  0.041800498962402344
local_output_nid generation:  0.003164052963256836
local_in_edges_tensor generation:  0.001689910888671875
mini_batch_src_global generation:  0.0031745433807373047
r_  generation:  0.04037976264953613
local_output_nid generation:  0.0031321048736572266
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.0031049251556396484
r_  generation:  0.04223918914794922
local_output_nid generation:  0.0032453536987304688
local_in_edges_tensor generation:  0.001720428466796875
mini_batch_src_global generation:  0.0031778812408447266
r_  generation:  0.040920257568359375
----------------------check_connections_block total spend ----------------------------- 0.472703218460083
generate_one_block  0.05450606346130371
generate_one_block  0.056355953216552734
generate_one_block  0.05522489547729492
generate_one_block  0.05550837516784668
generate_one_block  0.05799269676208496
generate_one_block  0.05429720878601074
generate_one_block  0.05548906326293945
generate_one_block  0.05448341369628906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04164624214172363
gen group dst list time:  0.015255451202392578
time for parepare:  0.018820524215698242
local_output_nid generation:  0.010622978210449219
local_in_edges_tensor generation:  0.029985427856445312
mini_batch_src_global generation:  0.0316162109375
r_  generation:  0.3144509792327881
local_output_nid generation:  0.015703439712524414
local_in_edges_tensor generation:  0.028669357299804688
mini_batch_src_global generation:  0.03723788261413574
r_  generation:  0.32889771461486816
local_output_nid generation:  0.016088008880615234
local_in_edges_tensor generation:  0.02187323570251465
mini_batch_src_global generation:  0.0377812385559082
r_  generation:  0.34299445152282715
local_output_nid generation:  0.017765045166015625
local_in_edges_tensor generation:  0.03837752342224121
mini_batch_src_global generation:  0.060825347900390625
r_  generation:  0.3328683376312256
local_output_nid generation:  0.018921375274658203
local_in_edges_tensor generation:  0.02606511116027832
mini_batch_src_global generation:  0.03881239891052246
r_  generation:  0.3343791961669922
local_output_nid generation:  0.017418384552001953
local_in_edges_tensor generation:  0.01967644691467285
mini_batch_src_global generation:  0.03926491737365723
r_  generation:  0.31840085983276367
local_output_nid generation:  0.017583608627319336
local_in_edges_tensor generation:  0.017931699752807617
mini_batch_src_global generation:  0.04115462303161621
r_  generation:  0.3269224166870117
local_output_nid generation:  0.017348051071166992
local_in_edges_tensor generation:  0.020921707153320312
mini_batch_src_global generation:  0.03847956657409668
r_  generation:  0.3173816204071045
----------------------check_connections_block total spend ----------------------------- 3.862107992172241
generate_one_block  0.41462206840515137
generate_one_block  0.42989277839660645
generate_one_block  0.4100008010864258
generate_one_block  0.4159398078918457
generate_one_block  0.4248545169830322
generate_one_block  0.41010570526123047
generate_one_block  0.40596866607666016
generate_one_block  0.4026665687561035
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06026721000671387
gen group dst list time:  0.0358731746673584
time for parepare:  0.01885843276977539
local_output_nid generation:  0.025086641311645508
local_in_edges_tensor generation:  0.06686520576477051
mini_batch_src_global generation:  0.05208182334899902
r_  generation:  0.5173137187957764
local_output_nid generation:  0.031902313232421875
local_in_edges_tensor generation:  0.05111408233642578
mini_batch_src_global generation:  0.05929112434387207
r_  generation:  0.5216550827026367
local_output_nid generation:  0.04589271545410156
local_in_edges_tensor generation:  0.043243408203125
mini_batch_src_global generation:  0.056104421615600586
r_  generation:  0.5510590076446533
local_output_nid generation:  0.03448033332824707
local_in_edges_tensor generation:  0.055091142654418945
mini_batch_src_global generation:  0.07647085189819336
r_  generation:  0.5408987998962402
local_output_nid generation:  0.035260915756225586
local_in_edges_tensor generation:  0.04558587074279785
mini_batch_src_global generation:  0.05704331398010254
r_  generation:  0.5422341823577881
local_output_nid generation:  0.03446173667907715
local_in_edges_tensor generation:  0.03785514831542969
mini_batch_src_global generation:  0.06050848960876465
r_  generation:  0.5329630374908447
local_output_nid generation:  0.03530120849609375
local_in_edges_tensor generation:  0.03429722785949707
mini_batch_src_global generation:  0.05947566032409668
r_  generation:  0.556490421295166
local_output_nid generation:  0.03535962104797363
local_in_edges_tensor generation:  0.05022549629211426
mini_batch_src_global generation:  0.06074333190917969
r_  generation:  0.5345184803009033
----------------------check_connections_block total spend ----------------------------- 6.4008989334106445
generate_one_block  0.7116923332214355
generate_one_block  0.6824431419372559
generate_one_block  0.67836594581604
generate_one_block  0.6717495918273926
generate_one_block  0.6738481521606445
generate_one_block  0.6736142635345459
generate_one_block  0.71128249168396
generate_one_block  0.682549238204956
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.11208295822143555
gen group dst list time:  0.04856300354003906
time for parepare:  0.019121408462524414
local_output_nid generation:  0.03088068962097168
local_in_edges_tensor generation:  0.04808831214904785
mini_batch_src_global generation:  0.045881032943725586
r_  generation:  0.5038392543792725
local_output_nid generation:  0.03615212440490723
local_in_edges_tensor generation:  0.04793691635131836
mini_batch_src_global generation:  0.05706644058227539
r_  generation:  0.5032362937927246
local_output_nid generation:  0.036271095275878906
local_in_edges_tensor generation:  0.041484832763671875
mini_batch_src_global generation:  0.05642127990722656
r_  generation:  0.5145230293273926
local_output_nid generation:  0.03715801239013672
local_in_edges_tensor generation:  0.04218721389770508
mini_batch_src_global generation:  0.05375170707702637
r_  generation:  0.5164055824279785
local_output_nid generation:  0.0372316837310791
local_in_edges_tensor generation:  0.04490303993225098
mini_batch_src_global generation:  0.05836296081542969
r_  generation:  0.511035680770874
local_output_nid generation:  0.03725266456604004
local_in_edges_tensor generation:  0.03331756591796875
mini_batch_src_global generation:  0.055478811264038086
r_  generation:  0.5191290378570557
local_output_nid generation:  0.037354469299316406
local_in_edges_tensor generation:  0.04460644721984863
mini_batch_src_global generation:  0.06750035285949707
r_  generation:  0.5224101543426514
local_output_nid generation:  0.03936195373535156
local_in_edges_tensor generation:  0.04037356376647949
mini_batch_src_global generation:  0.054761648178100586
r_  generation:  0.5194635391235352
----------------------check_connections_block total spend ----------------------------- 6.152254581451416
generate_one_block  0.623042106628418
generate_one_block  0.6345877647399902
generate_one_block  0.6570608615875244
generate_one_block  0.6576840877532959
generate_one_block  0.6423799991607666
generate_one_block  0.6265101432800293
generate_one_block  0.6777083873748779
generate_one_block  0.6235036849975586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013098716735839844  GigaBytes
Max Memory Allocated: 0.0013098716735839844  GigaBytes

connection checking time:  16.4152615070343
block generation total time  13.942073106765747
average batch blocks generation time:  1.7427591383457184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11224222183227539  GigaBytes
Max Memory Allocated: 0.11224222183227539  GigaBytes

torch.Size([165428, 128])
torch.Size([160996, 256])
torch.Size([141557, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1014404296875 GB
    Memory Allocated: 1.576439380645752  GigaBytes
Max Memory Allocated: 1.6367135047912598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 0.11537504196166992  GigaBytes
Max Memory Allocated: 1.7049551010131836  GigaBytes

torch.Size([165484, 128])
torch.Size([161000, 256])
torch.Size([141810, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7791748046875 GB
    Memory Allocated: 1.5815191268920898  GigaBytes
Max Memory Allocated: 1.7049551010131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11539697647094727  GigaBytes
Max Memory Allocated: 1.711308479309082  GigaBytes

torch.Size([165559, 128])
torch.Size([161163, 256])
torch.Size([141965, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5795021057128906  GigaBytes
Max Memory Allocated: 1.711308479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11543798446655273  GigaBytes
Max Memory Allocated: 1.711308479309082  GigaBytes

torch.Size([165501, 128])
torch.Size([161293, 256])
torch.Size([142089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5828814506530762  GigaBytes
Max Memory Allocated: 1.711308479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11557149887084961  GigaBytes
Max Memory Allocated: 1.7118196487426758  GigaBytes

torch.Size([165608, 128])
torch.Size([161346, 256])
torch.Size([142199, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5844359397888184  GigaBytes
Max Memory Allocated: 1.7118196487426758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11590862274169922  GigaBytes
Max Memory Allocated: 1.7138481140136719  GigaBytes

torch.Size([165427, 128])
torch.Size([161050, 256])
torch.Size([141634, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.575305461883545  GigaBytes
Max Memory Allocated: 1.7138481140136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11594581604003906  GigaBytes
Max Memory Allocated: 1.7138481140136719  GigaBytes

torch.Size([165518, 128])
torch.Size([161230, 256])
torch.Size([142359, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5880188941955566  GigaBytes
Max Memory Allocated: 1.7138481140136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1152181625366211  GigaBytes
Max Memory Allocated: 1.7177019119262695  GigaBytes

torch.Size([165414, 128])
torch.Size([161067, 256])
torch.Size([141990, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 1.5781116485595703  GigaBytes
Max Memory Allocated: 1.7177019119262695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0785258412361145 |0.06463074684143066 |0.11037418246269226 |0.00010478496551513672 |0.049951642751693726 |0.004848957061767578 |
----------------------------------------------------------pseudo_mini_loss sum 6.328661918640137
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4291895
Number of first layer input nodes during this epoch:  1323939
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1728048324584961  GigaBytes
Max Memory Allocated: 1.7177019119262695  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.018670082092285156
range selection method range initialization spend 0.011521339416503906
time for parepare:  0.016738176345825195
local_output_nid generation:  0.0026504993438720703
local_in_edges_tensor generation:  0.007679939270019531
mini_batch_src_global generation:  0.003224611282348633
r_  generation:  0.03724837303161621
local_output_nid generation:  0.0031812191009521484
local_in_edges_tensor generation:  0.0016622543334960938
mini_batch_src_global generation:  0.004045724868774414
r_  generation:  0.03923487663269043
local_output_nid generation:  0.003147602081298828
local_in_edges_tensor generation:  0.0016698837280273438
mini_batch_src_global generation:  0.0027616024017333984
r_  generation:  0.03930068016052246
local_output_nid generation:  0.0031359195709228516
local_in_edges_tensor generation:  0.001653432846069336
mini_batch_src_global generation:  0.002911806106567383
r_  generation:  0.0420682430267334
local_output_nid generation:  0.003131389617919922
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.003020763397216797
r_  generation:  0.042044878005981445
local_output_nid generation:  0.0030972957611083984
local_in_edges_tensor generation:  0.0016565322875976562
mini_batch_src_global generation:  0.003154754638671875
r_  generation:  0.04152250289916992
local_output_nid generation:  0.0031442642211914062
local_in_edges_tensor generation:  0.0016856193542480469
mini_batch_src_global generation:  0.0031511783599853516
r_  generation:  0.04190874099731445
local_output_nid generation:  0.003117084503173828
local_in_edges_tensor generation:  0.0016584396362304688
mini_batch_src_global generation:  0.0031828880310058594
r_  generation:  0.04179954528808594
----------------------check_connections_block total spend ----------------------------- 0.4792630672454834
generate_one_block  0.05242753028869629
generate_one_block  0.05413961410522461
generate_one_block  0.053740501403808594
generate_one_block  0.05537581443786621
generate_one_block  0.05503058433532715
generate_one_block  0.05371522903442383
generate_one_block  0.0565950870513916
generate_one_block  0.054453134536743164
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03855395317077637
gen group dst list time:  0.014849185943603516
time for parepare:  0.019084930419921875
local_output_nid generation:  0.010589599609375
local_in_edges_tensor generation:  0.03161478042602539
mini_batch_src_global generation:  0.02837681770324707
r_  generation:  0.29592347145080566
local_output_nid generation:  0.015740394592285156
local_in_edges_tensor generation:  0.027029991149902344
mini_batch_src_global generation:  0.041776418685913086
r_  generation:  0.3066859245300293
local_output_nid generation:  0.016667842864990234
local_in_edges_tensor generation:  0.02496337890625
mini_batch_src_global generation:  0.04117536544799805
r_  generation:  0.3119089603424072
local_output_nid generation:  0.016921520233154297
local_in_edges_tensor generation:  0.026357650756835938
mini_batch_src_global generation:  0.04833388328552246
r_  generation:  0.3223848342895508
local_output_nid generation:  0.01819777488708496
local_in_edges_tensor generation:  0.024614572525024414
mini_batch_src_global generation:  0.0384821891784668
r_  generation:  0.32068967819213867
local_output_nid generation:  0.017065048217773438
local_in_edges_tensor generation:  0.017816781997680664
mini_batch_src_global generation:  0.0385587215423584
r_  generation:  0.3160266876220703
local_output_nid generation:  0.01728534698486328
local_in_edges_tensor generation:  0.019967317581176758
mini_batch_src_global generation:  0.03846168518066406
r_  generation:  0.31806063652038574
local_output_nid generation:  0.01758742332458496
local_in_edges_tensor generation:  0.02328968048095703
mini_batch_src_global generation:  0.03795123100280762
r_  generation:  0.3148207664489746
----------------------check_connections_block total spend ----------------------------- 3.717913866043091
generate_one_block  0.4032137393951416
generate_one_block  0.41087961196899414
generate_one_block  0.4106936454772949
generate_one_block  0.41765308380126953
generate_one_block  0.41515064239501953
generate_one_block  0.39588165283203125
generate_one_block  0.3979477882385254
generate_one_block  0.4245259761810303
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04786872863769531
gen group dst list time:  0.03579854965209961
time for parepare:  0.018514156341552734
local_output_nid generation:  0.024903059005737305
local_in_edges_tensor generation:  0.05867624282836914
mini_batch_src_global generation:  0.05261659622192383
r_  generation:  0.5156519412994385
local_output_nid generation:  0.0319058895111084
local_in_edges_tensor generation:  0.050829172134399414
mini_batch_src_global generation:  0.05945754051208496
r_  generation:  0.5310714244842529
local_output_nid generation:  0.03263282775878906
local_in_edges_tensor generation:  0.038329362869262695
mini_batch_src_global generation:  0.05545783042907715
r_  generation:  0.5403907299041748
local_output_nid generation:  0.032972097396850586
local_in_edges_tensor generation:  0.042981863021850586
mini_batch_src_global generation:  0.05908918380737305
r_  generation:  0.5407023429870605
local_output_nid generation:  0.032933712005615234
local_in_edges_tensor generation:  0.04740500450134277
mini_batch_src_global generation:  0.05750870704650879
r_  generation:  0.5344529151916504
local_output_nid generation:  0.03308510780334473
local_in_edges_tensor generation:  0.034787893295288086
mini_batch_src_global generation:  0.06039023399353027
r_  generation:  0.5283527374267578
local_output_nid generation:  0.03337979316711426
local_in_edges_tensor generation:  0.03410458564758301
mini_batch_src_global generation:  0.058016061782836914
r_  generation:  0.5344090461730957
local_output_nid generation:  0.03352022171020508
local_in_edges_tensor generation:  0.043211936950683594
mini_batch_src_global generation:  0.061370849609375
r_  generation:  0.529294490814209
----------------------check_connections_block total spend ----------------------------- 6.24857234954834
generate_one_block  0.6546270847320557
generate_one_block  0.6645293235778809
generate_one_block  0.6636519432067871
generate_one_block  0.6678292751312256
generate_one_block  0.6661357879638672
generate_one_block  0.6574966907501221
generate_one_block  0.6671650409698486
generate_one_block  0.6734285354614258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03546881675720215
gen group dst list time:  0.04551219940185547
time for parepare:  0.018906593322753906
local_output_nid generation:  0.031125545501708984
local_in_edges_tensor generation:  0.040724992752075195
mini_batch_src_global generation:  0.045290470123291016
r_  generation:  0.5414724349975586
local_output_nid generation:  0.037589073181152344
local_in_edges_tensor generation:  0.04645729064941406
mini_batch_src_global generation:  0.0570673942565918
r_  generation:  0.5100245475769043
local_output_nid generation:  0.0375211238861084
local_in_edges_tensor generation:  0.03762459754943848
mini_batch_src_global generation:  0.060709476470947266
r_  generation:  0.5052928924560547
local_output_nid generation:  0.03751850128173828
local_in_edges_tensor generation:  0.03845524787902832
mini_batch_src_global generation:  0.055004119873046875
r_  generation:  0.5123541355133057
local_output_nid generation:  0.0377960205078125
local_in_edges_tensor generation:  0.0373537540435791
mini_batch_src_global generation:  0.058432817459106445
r_  generation:  0.5137832164764404
local_output_nid generation:  0.037671804428100586
local_in_edges_tensor generation:  0.03952288627624512
mini_batch_src_global generation:  0.05557656288146973
r_  generation:  0.516620397567749
local_output_nid generation:  0.03773331642150879
local_in_edges_tensor generation:  0.04206061363220215
mini_batch_src_global generation:  0.0542149543762207
r_  generation:  0.5188329219818115
local_output_nid generation:  0.037545204162597656
local_in_edges_tensor generation:  0.04180026054382324
mini_batch_src_global generation:  0.055254459381103516
r_  generation:  0.5205941200256348
----------------------check_connections_block total spend ----------------------------- 6.150362730026245
generate_one_block  0.645221471786499
generate_one_block  0.6352975368499756
generate_one_block  0.640369176864624
generate_one_block  0.6315984725952148
generate_one_block  0.638786792755127
generate_one_block  0.6307094097137451
generate_one_block  0.6350705623626709
generate_one_block  0.6334939002990723
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.1728048324584961  GigaBytes
Max Memory Allocated: 1.7177019119262695  GigaBytes

connection checking time:  16.116848945617676
block generation total time  13.681357145309448
average batch blocks generation time:  1.710169643163681
block dataloader generation time/epoch 31.955920934677124
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7811279296875 GB
    Memory Allocated: 0.11808633804321289  GigaBytes
Max Memory Allocated: 1.7177019119262695  GigaBytes

torch.Size([165583, 128])
torch.Size([161403, 256])
torch.Size([142607, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7830810546875 GB
    Memory Allocated: 1.5897479057312012  GigaBytes
Max Memory Allocated: 1.7177019119262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.1178884506225586  GigaBytes
Max Memory Allocated: 1.7182879447937012  GigaBytes

torch.Size([165506, 128])
torch.Size([161140, 256])
torch.Size([141904, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.581592082977295  GigaBytes
Max Memory Allocated: 1.7182879447937012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11793756484985352  GigaBytes
Max Memory Allocated: 1.7182879447937012  GigaBytes

torch.Size([165523, 128])
torch.Size([161243, 256])
torch.Size([141917, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5816826820373535  GigaBytes
Max Memory Allocated: 1.7182879447937012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11817741394042969  GigaBytes
Max Memory Allocated: 1.7182879447937012  GigaBytes

torch.Size([165498, 128])
torch.Size([161129, 256])
torch.Size([142111, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.589456558227539  GigaBytes
Max Memory Allocated: 1.7182879447937012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11873865127563477  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

torch.Size([165462, 128])
torch.Size([161209, 256])
torch.Size([142274, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5866456031799316  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11785173416137695  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

torch.Size([165437, 128])
torch.Size([161063, 256])
torch.Size([141683, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5792803764343262  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11801338195800781  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

torch.Size([165568, 128])
torch.Size([161398, 256])
torch.Size([142107, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.582754135131836  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 0.11793136596679688  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

torch.Size([165520, 128])
torch.Size([161262, 256])
torch.Size([142390, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7850341796875 GB
    Memory Allocated: 1.5877313613891602  GigaBytes
Max Memory Allocated: 1.7203874588012695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12548643350601196 |0.019212663173675537 |0.007853299379348755 |9.766221046447754e-05 |0.014854371547698975 |0.0017867088317871094 |
----------------------------------------------------------pseudo_mini_loss sum 3.280156373977661
Total (block generation + training)time/epoch 33.43763780593872
Training time/epoch 1.481461763381958
Training time without block to device /epoch 1.3277604579925537
Training time without total dataloading part /epoch 0.18422937393188477
load block tensor time/epoch 1.0038914680480957
block to device time/epoch 0.1537013053894043
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4294443
Number of first layer input nodes during this epoch:  1324097
