Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648447005.8341875
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0277864933013916
range selection method range initialization spend 0.013544559478759766
time for parepare:  0.01798868179321289
local_output_nid generation:  0.001331329345703125
local_in_edges_tensor generation:  0.004274129867553711
mini_batch_src_global generation:  0.0019102096557617188
r_  generation:  0.020145893096923828
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0009586811065673828
mini_batch_src_global generation:  0.0024127960205078125
r_  generation:  0.020415544509887695
local_output_nid generation:  0.0014712810516357422
local_in_edges_tensor generation:  0.0009100437164306641
mini_batch_src_global generation:  0.0014853477478027344
r_  generation:  0.019574642181396484
local_output_nid generation:  0.001505136489868164
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0015177726745605469
r_  generation:  0.020180702209472656
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.020577430725097656
local_output_nid generation:  0.0015060901641845703
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.0016274452209472656
r_  generation:  0.021139860153198242
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0008585453033447266
mini_batch_src_global generation:  0.0016760826110839844
r_  generation:  0.021656036376953125
local_output_nid generation:  0.0015277862548828125
local_in_edges_tensor generation:  0.0008440017700195312
mini_batch_src_global generation:  0.0016167163848876953
r_  generation:  0.02063894271850586
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008730888366699219
mini_batch_src_global generation:  0.0016336441040039062
r_  generation:  0.020653963088989258
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0016014575958251953
r_  generation:  0.021180391311645508
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.00173187255859375
r_  generation:  0.021184444427490234
local_output_nid generation:  0.0015263557434082031
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.001771688461303711
r_  generation:  0.021763086318969727
local_output_nid generation:  0.0015380382537841797
local_in_edges_tensor generation:  0.0008542537689208984
mini_batch_src_global generation:  0.0017294883728027344
r_  generation:  0.02171778678894043
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0017406940460205078
r_  generation:  0.02152085304260254
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.001773834228515625
r_  generation:  0.021811723709106445
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0009169578552246094
mini_batch_src_global generation:  0.0018036365509033203
r_  generation:  0.021986722946166992
----------------------check_connections_block total spend ----------------------------- 0.49727582931518555
generate_one_block  0.030365943908691406
generate_one_block  0.03222537040710449
generate_one_block  0.03226017951965332
generate_one_block  0.03139209747314453
generate_one_block  0.03170371055603027
generate_one_block  0.03153562545776367
generate_one_block  0.03173017501831055
generate_one_block  0.029814481735229492
generate_one_block  0.030449390411376953
generate_one_block  0.030672550201416016
generate_one_block  0.030675888061523438
generate_one_block  0.031751155853271484
generate_one_block  0.03168201446533203
generate_one_block  0.031026124954223633
generate_one_block  0.03208160400390625
generate_one_block  0.03213214874267578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04525923728942871
gen group dst list time:  0.020531177520751953
time for parepare:  0.019376754760742188
local_output_nid generation:  0.007452726364135742
local_in_edges_tensor generation:  0.0206453800201416
mini_batch_src_global generation:  0.0269775390625
r_  generation:  0.25429821014404297
local_output_nid generation:  0.011294126510620117
local_in_edges_tensor generation:  0.023574113845825195
mini_batch_src_global generation:  0.032218217849731445
r_  generation:  0.2647125720977783
local_output_nid generation:  0.01128244400024414
local_in_edges_tensor generation:  0.01629185676574707
mini_batch_src_global generation:  0.03112506866455078
r_  generation:  0.2615540027618408
local_output_nid generation:  0.0115509033203125
local_in_edges_tensor generation:  0.01619124412536621
mini_batch_src_global generation:  0.03391003608703613
r_  generation:  0.2663917541503906
local_output_nid generation:  0.011910200119018555
local_in_edges_tensor generation:  0.019062280654907227
mini_batch_src_global generation:  0.03523993492126465
r_  generation:  0.2738981246948242
local_output_nid generation:  0.012158393859863281
local_in_edges_tensor generation:  0.014307975769042969
mini_batch_src_global generation:  0.03433418273925781
r_  generation:  0.27298521995544434
local_output_nid generation:  0.012173175811767578
local_in_edges_tensor generation:  0.017945528030395508
mini_batch_src_global generation:  0.03406977653503418
r_  generation:  0.2782866954803467
local_output_nid generation:  0.011676788330078125
local_in_edges_tensor generation:  0.014249563217163086
mini_batch_src_global generation:  0.03296613693237305
r_  generation:  0.25972557067871094
local_output_nid generation:  0.011974096298217773
local_in_edges_tensor generation:  0.01420736312866211
mini_batch_src_global generation:  0.03252673149108887
r_  generation:  0.26404285430908203
local_output_nid generation:  0.012198448181152344
local_in_edges_tensor generation:  0.022838592529296875
mini_batch_src_global generation:  0.0332484245300293
r_  generation:  0.26813817024230957
local_output_nid generation:  0.012166023254394531
local_in_edges_tensor generation:  0.01425933837890625
mini_batch_src_global generation:  0.033371686935424805
r_  generation:  0.2693469524383545
local_output_nid generation:  0.012469768524169922
local_in_edges_tensor generation:  0.01951146125793457
mini_batch_src_global generation:  0.03664994239807129
r_  generation:  0.2769913673400879
local_output_nid generation:  0.012515068054199219
local_in_edges_tensor generation:  0.019921541213989258
mini_batch_src_global generation:  0.03515338897705078
r_  generation:  0.2758493423461914
local_output_nid generation:  0.01243734359741211
local_in_edges_tensor generation:  0.016791582107543945
mini_batch_src_global generation:  0.03465604782104492
r_  generation:  0.2726590633392334
local_output_nid generation:  0.012448787689208984
local_in_edges_tensor generation:  0.016861915588378906
mini_batch_src_global generation:  0.04013943672180176
r_  generation:  0.27260375022888184
local_output_nid generation:  0.012464523315429688
local_in_edges_tensor generation:  0.017298221588134766
mini_batch_src_global generation:  0.034955501556396484
r_  generation:  0.27730298042297363
----------------------check_connections_block total spend ----------------------------- 6.266486883163452
generate_one_block  0.35501623153686523
generate_one_block  0.364243745803833
generate_one_block  0.34650111198425293
generate_one_block  0.35491418838500977
generate_one_block  0.3776113986968994
generate_one_block  0.3581502437591553
generate_one_block  0.36820173263549805
generate_one_block  0.33331775665283203
generate_one_block  0.3407869338989258
generate_one_block  0.35596370697021484
generate_one_block  0.34888505935668945
generate_one_block  0.36579298973083496
generate_one_block  0.36394429206848145
generate_one_block  0.35740041732788086
generate_one_block  0.3694570064544678
generate_one_block  0.3615281581878662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04216718673706055
gen group dst list time:  0.06265139579772949
time for parepare:  0.019242525100708008
local_output_nid generation:  0.02519392967224121
local_in_edges_tensor generation:  0.042340993881225586
mini_batch_src_global generation:  0.05413007736206055
r_  generation:  0.511458158493042
local_output_nid generation:  0.030999422073364258
local_in_edges_tensor generation:  0.051532745361328125
mini_batch_src_global generation:  0.06143522262573242
r_  generation:  0.555513858795166
local_output_nid generation:  0.031369686126708984
local_in_edges_tensor generation:  0.047516584396362305
mini_batch_src_global generation:  0.0590057373046875
r_  generation:  0.5282025337219238
local_output_nid generation:  0.031450748443603516
local_in_edges_tensor generation:  0.03402519226074219
mini_batch_src_global generation:  0.059720516204833984
r_  generation:  0.5295867919921875
local_output_nid generation:  0.030913352966308594
local_in_edges_tensor generation:  0.04318404197692871
mini_batch_src_global generation:  0.060227155685424805
r_  generation:  0.5358266830444336
local_output_nid generation:  0.03140664100646973
local_in_edges_tensor generation:  0.03923749923706055
mini_batch_src_global generation:  0.061789512634277344
r_  generation:  0.5388638973236084
local_output_nid generation:  0.031185626983642578
local_in_edges_tensor generation:  0.04773831367492676
mini_batch_src_global generation:  0.06521272659301758
r_  generation:  0.5448033809661865
local_output_nid generation:  0.03139805793762207
local_in_edges_tensor generation:  0.0343475341796875
mini_batch_src_global generation:  0.06201481819152832
r_  generation:  0.5367605686187744
local_output_nid generation:  0.03163266181945801
local_in_edges_tensor generation:  0.03371238708496094
mini_batch_src_global generation:  0.062198638916015625
r_  generation:  0.5409879684448242
local_output_nid generation:  0.03200125694274902
local_in_edges_tensor generation:  0.034709930419921875
mini_batch_src_global generation:  0.06214022636413574
r_  generation:  0.5477745532989502
local_output_nid generation:  0.0319974422454834
local_in_edges_tensor generation:  0.03876543045043945
mini_batch_src_global generation:  0.06248140335083008
r_  generation:  0.5433995723724365
local_output_nid generation:  0.03208017349243164
local_in_edges_tensor generation:  0.03431439399719238
mini_batch_src_global generation:  0.06215310096740723
r_  generation:  0.5498054027557373
local_output_nid generation:  0.03196406364440918
local_in_edges_tensor generation:  0.04831433296203613
mini_batch_src_global generation:  0.06212615966796875
r_  generation:  0.5424647331237793
local_output_nid generation:  0.031928062438964844
local_in_edges_tensor generation:  0.03860974311828613
mini_batch_src_global generation:  0.06238222122192383
r_  generation:  0.5449719429016113
local_output_nid generation:  0.032349348068237305
local_in_edges_tensor generation:  0.03876805305480957
mini_batch_src_global generation:  0.06262540817260742
r_  generation:  0.5522987842559814
local_output_nid generation:  0.031829833984375
local_in_edges_tensor generation:  0.04303407669067383
mini_batch_src_global generation:  0.06312799453735352
r_  generation:  0.5520541667938232
----------------------check_connections_block total spend ----------------------------- 12.70026707649231
generate_one_block  0.6864848136901855
generate_one_block  0.7067568302154541
generate_one_block  0.7156834602355957
generate_one_block  0.7434413433074951
generate_one_block  0.6985116004943848
generate_one_block  0.6959664821624756
generate_one_block  0.7731451988220215
generate_one_block  0.7075719833374023
generate_one_block  0.7017419338226318
generate_one_block  0.7172763347625732
generate_one_block  0.7006938457489014
generate_one_block  0.7435016632080078
generate_one_block  0.6908881664276123
generate_one_block  0.682633638381958
generate_one_block  0.6950299739837646
generate_one_block  0.7000939846038818
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 5.245208740234375e-05  GigaBytes
Max Memory Allocated: 5.245208740234375e-05  GigaBytes

connection checking time:  18.96675395965576
block generation total time  17.081136226654053
average batch blocks generation time:  1.0675710141658783
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09526729583740234  GigaBytes
Max Memory Allocated: 0.09526729583740234  GigaBytes

torch.Size([157679, 128])
torch.Size([129573, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.19353103637695312  GigaBytes
Max Memory Allocated: 0.19612646102905273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09681510925292969  GigaBytes
Max Memory Allocated: 0.20715665817260742  GigaBytes

torch.Size([157656, 128])
torch.Size([130237, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19497919082641602  GigaBytes
Max Memory Allocated: 0.20715665817260742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09752941131591797  GigaBytes
Max Memory Allocated: 0.20841503143310547  GigaBytes

torch.Size([157707, 128])
torch.Size([130024, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1946568489074707  GigaBytes
Max Memory Allocated: 0.20841503143310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09758281707763672  GigaBytes
Max Memory Allocated: 0.20892858505249023  GigaBytes

torch.Size([157714, 128])
torch.Size([129627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19475793838500977  GigaBytes
Max Memory Allocated: 0.20892858505249023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09675979614257812  GigaBytes
Max Memory Allocated: 0.20894956588745117  GigaBytes

torch.Size([157662, 128])
torch.Size([130097, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1948533058166504  GigaBytes
Max Memory Allocated: 0.20894956588745117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09772586822509766  GigaBytes
Max Memory Allocated: 0.20912408828735352  GigaBytes

torch.Size([158060, 128])
torch.Size([130524, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1958298683166504  GigaBytes
Max Memory Allocated: 0.20912408828735352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09680938720703125  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157586, 128])
torch.Size([130304, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1950087547302246  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09621810913085938  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157464, 128])
torch.Size([128997, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19215965270996094  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09617376327514648  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157177, 128])
torch.Size([129254, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19324159622192383  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.097564697265625  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157931, 128])
torch.Size([130097, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19468402862548828  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09748077392578125  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157753, 128])
torch.Size([129973, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19460248947143555  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09781169891357422  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157795, 128])
torch.Size([130513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19586706161499023  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09666728973388672  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157524, 128])
torch.Size([130535, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19479084014892578  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09666204452514648  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157585, 128])
torch.Size([129944, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19475841522216797  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09671926498413086  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157663, 128])
torch.Size([130353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19487619400024414  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.0966792106628418  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157527, 128])
torch.Size([129786, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1947627067565918  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033502429723739624 |0.03866049647331238 |0.049613937735557556 |9.472668170928955e-05 |0.00906313955783844 |0.0037033557891845703 |
----------------------------------------------------------pseudo_mini_loss sum 5.040247440338135
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5333290
Number of first layer input nodes during this epoch:  2522483
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.13979625701904297  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025917768478393555
range selection method range initialization spend 0.015310525894165039
time for parepare:  0.016380786895751953
local_output_nid generation:  0.0013499259948730469
local_in_edges_tensor generation:  0.004857778549194336
mini_batch_src_global generation:  0.0023164749145507812
r_  generation:  0.02115607261657715
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0009810924530029297
mini_batch_src_global generation:  0.0026693344116210938
r_  generation:  0.022614717483520508
local_output_nid generation:  0.0015797615051269531
local_in_edges_tensor generation:  0.0009584426879882812
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.022444963455200195
local_output_nid generation:  0.001577138900756836
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0018627643585205078
r_  generation:  0.022870302200317383
local_output_nid generation:  0.0016238689422607422
local_in_edges_tensor generation:  0.0009505748748779297
mini_batch_src_global generation:  0.0018856525421142578
r_  generation:  0.021481990814208984
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.001627206802368164
r_  generation:  0.021932125091552734
local_output_nid generation:  0.0015566349029541016
local_in_edges_tensor generation:  0.0009007453918457031
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.02204442024230957
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0015869140625
r_  generation:  0.020823955535888672
local_output_nid generation:  0.001535654067993164
local_in_edges_tensor generation:  0.0009021759033203125
mini_batch_src_global generation:  0.0016510486602783203
r_  generation:  0.021265745162963867
local_output_nid generation:  0.0015406608581542969
local_in_edges_tensor generation:  0.0008866786956787109
mini_batch_src_global generation:  0.001626729965209961
r_  generation:  0.022437334060668945
local_output_nid generation:  0.0015416145324707031
local_in_edges_tensor generation:  0.0009274482727050781
mini_batch_src_global generation:  0.001653432846069336
r_  generation:  0.021847248077392578
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0017852783203125
r_  generation:  0.022907257080078125
local_output_nid generation:  0.0015285015106201172
local_in_edges_tensor generation:  0.0008950233459472656
mini_batch_src_global generation:  0.0017333030700683594
r_  generation:  0.02218914031982422
local_output_nid generation:  0.0015552043914794922
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0018172264099121094
r_  generation:  0.023066997528076172
local_output_nid generation:  0.0015947818756103516
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0017495155334472656
r_  generation:  0.022664308547973633
local_output_nid generation:  0.0016107559204101562
local_in_edges_tensor generation:  0.0009334087371826172
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.022066593170166016
----------------------check_connections_block total spend ----------------------------- 0.5235607624053955
generate_one_block  0.03295326232910156
generate_one_block  0.031082868576049805
generate_one_block  0.030661344528198242
generate_one_block  0.031014442443847656
generate_one_block  0.03174901008605957
generate_one_block  0.03302931785583496
generate_one_block  0.03175091743469238
generate_one_block  0.030192852020263672
generate_one_block  0.031290531158447266
generate_one_block  0.03179121017456055
generate_one_block  0.03122425079345703
generate_one_block  0.03215837478637695
generate_one_block  0.03249168395996094
generate_one_block  0.03241395950317383
generate_one_block  0.031207799911499023
generate_one_block  0.03220248222351074
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042200565338134766
gen group dst list time:  0.019318819046020508
time for parepare:  0.019160985946655273
local_output_nid generation:  0.00693511962890625
local_in_edges_tensor generation:  0.018451690673828125
mini_batch_src_global generation:  0.02456355094909668
r_  generation:  0.24524593353271484
local_output_nid generation:  0.01090860366821289
local_in_edges_tensor generation:  0.02142167091369629
mini_batch_src_global generation:  0.03349637985229492
r_  generation:  0.25647878646850586
local_output_nid generation:  0.011505842208862305
local_in_edges_tensor generation:  0.016997098922729492
mini_batch_src_global generation:  0.03034186363220215
r_  generation:  0.25989580154418945
local_output_nid generation:  0.012082338333129883
local_in_edges_tensor generation:  0.017473697662353516
mini_batch_src_global generation:  0.0320436954498291
r_  generation:  0.26418352127075195
local_output_nid generation:  0.01214909553527832
local_in_edges_tensor generation:  0.017858028411865234
mini_batch_src_global generation:  0.03507518768310547
r_  generation:  0.27145957946777344
local_output_nid generation:  0.011944770812988281
local_in_edges_tensor generation:  0.01589226722717285
mini_batch_src_global generation:  0.03477287292480469
r_  generation:  0.2696714401245117
local_output_nid generation:  0.012039661407470703
local_in_edges_tensor generation:  0.015020608901977539
mini_batch_src_global generation:  0.0385284423828125
r_  generation:  0.27854371070861816
local_output_nid generation:  0.011816740036010742
local_in_edges_tensor generation:  0.012952089309692383
mini_batch_src_global generation:  0.033591270446777344
r_  generation:  0.2680037021636963
local_output_nid generation:  0.012166976928710938
local_in_edges_tensor generation:  0.012975931167602539
mini_batch_src_global generation:  0.033979177474975586
r_  generation:  0.28916025161743164
local_output_nid generation:  0.015455484390258789
local_in_edges_tensor generation:  0.02692866325378418
mini_batch_src_global generation:  0.036336660385131836
r_  generation:  0.2736375331878662
local_output_nid generation:  0.012766361236572266
local_in_edges_tensor generation:  0.023041963577270508
mini_batch_src_global generation:  0.03537774085998535
r_  generation:  0.2728271484375
local_output_nid generation:  0.012981891632080078
local_in_edges_tensor generation:  0.019641637802124023
mini_batch_src_global generation:  0.05719614028930664
r_  generation:  0.2780008316040039
local_output_nid generation:  0.012930154800415039
local_in_edges_tensor generation:  0.013729572296142578
mini_batch_src_global generation:  0.04333209991455078
r_  generation:  0.29453492164611816
local_output_nid generation:  0.015737295150756836
local_in_edges_tensor generation:  0.0273895263671875
mini_batch_src_global generation:  0.03670549392700195
r_  generation:  0.2828340530395508
local_output_nid generation:  0.013065814971923828
local_in_edges_tensor generation:  0.020083189010620117
mini_batch_src_global generation:  0.03434920310974121
r_  generation:  0.2788121700286865
local_output_nid generation:  0.012789487838745117
local_in_edges_tensor generation:  0.014498710632324219
mini_batch_src_global generation:  0.04927539825439453
r_  generation:  0.27991294860839844
----------------------check_connections_block total spend ----------------------------- 6.3929526805877686
generate_one_block  0.35370898246765137
generate_one_block  0.3517475128173828
generate_one_block  0.35068368911743164
generate_one_block  0.35002636909484863
generate_one_block  0.36219358444213867
generate_one_block  0.35270214080810547
generate_one_block  0.38370466232299805
generate_one_block  0.36582517623901367
generate_one_block  0.3727092742919922
generate_one_block  0.3813607692718506
generate_one_block  0.3643763065338135
generate_one_block  0.3664529323577881
generate_one_block  0.3577737808227539
generate_one_block  0.37076687812805176
generate_one_block  0.3774588108062744
generate_one_block  0.36635446548461914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.054711103439331055
gen group dst list time:  0.07177305221557617
time for parepare:  0.022067785263061523
local_output_nid generation:  0.026198625564575195
local_in_edges_tensor generation:  0.060326337814331055
mini_batch_src_global generation:  0.04987168312072754
r_  generation:  0.5444064140319824
local_output_nid generation:  0.03353714942932129
local_in_edges_tensor generation:  0.05280590057373047
mini_batch_src_global generation:  0.06403279304504395
r_  generation:  0.5333914756774902
local_output_nid generation:  0.03193831443786621
local_in_edges_tensor generation:  0.04827475547790527
mini_batch_src_global generation:  0.05797219276428223
r_  generation:  0.5360057353973389
local_output_nid generation:  0.031855106353759766
local_in_edges_tensor generation:  0.03780031204223633
mini_batch_src_global generation:  0.062166452407836914
r_  generation:  0.5557248592376709
local_output_nid generation:  0.03256940841674805
local_in_edges_tensor generation:  0.0995323657989502
mini_batch_src_global generation:  0.06006979942321777
r_  generation:  0.5463671684265137
local_output_nid generation:  0.03149604797363281
local_in_edges_tensor generation:  0.043524980545043945
mini_batch_src_global generation:  0.06063652038574219
r_  generation:  0.5511248111724854
local_output_nid generation:  0.03180122375488281
local_in_edges_tensor generation:  0.04070878028869629
mini_batch_src_global generation:  0.061673641204833984
r_  generation:  0.5509319305419922
local_output_nid generation:  0.03291916847229004
local_in_edges_tensor generation:  0.04884028434753418
mini_batch_src_global generation:  0.06065702438354492
r_  generation:  0.5624079704284668
local_output_nid generation:  0.03494596481323242
local_in_edges_tensor generation:  0.044389963150024414
mini_batch_src_global generation:  0.06833457946777344
r_  generation:  0.5493619441986084
local_output_nid generation:  0.03309750556945801
local_in_edges_tensor generation:  0.051197052001953125
mini_batch_src_global generation:  0.06484508514404297
r_  generation:  0.5474975109100342
local_output_nid generation:  0.03323960304260254
local_in_edges_tensor generation:  0.04447746276855469
mini_batch_src_global generation:  0.061325788497924805
r_  generation:  0.5473916530609131
local_output_nid generation:  0.03315162658691406
local_in_edges_tensor generation:  0.03844809532165527
mini_batch_src_global generation:  0.06192803382873535
r_  generation:  0.5490968227386475
local_output_nid generation:  0.03303027153015137
local_in_edges_tensor generation:  0.034613609313964844
mini_batch_src_global generation:  0.06933379173278809
r_  generation:  0.5418956279754639
local_output_nid generation:  0.03336453437805176
local_in_edges_tensor generation:  0.038817644119262695
mini_batch_src_global generation:  0.0759129524230957
r_  generation:  0.5481574535369873
local_output_nid generation:  0.0335080623626709
local_in_edges_tensor generation:  0.06216597557067871
mini_batch_src_global generation:  0.06288433074951172
r_  generation:  0.5488569736480713
local_output_nid generation:  0.03450894355773926
local_in_edges_tensor generation:  0.03597688674926758
mini_batch_src_global generation:  0.06741070747375488
r_  generation:  0.5696423053741455
----------------------check_connections_block total spend ----------------------------- 13.057616710662842
generate_one_block  0.6942257881164551
generate_one_block  0.6868152618408203
generate_one_block  0.6806666851043701
generate_one_block  0.6819524765014648
generate_one_block  0.6863985061645508
generate_one_block  0.701216459274292
generate_one_block  0.6772580146789551
generate_one_block  0.6772475242614746
generate_one_block  0.7314589023590088
generate_one_block  0.6985189914703369
generate_one_block  0.6932544708251953
generate_one_block  0.6874265670776367
generate_one_block  0.6734752655029297
generate_one_block  0.707120418548584
generate_one_block  0.7074329853057861
generate_one_block  0.6727070808410645
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.13979625701904297  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

connection checking time:  19.45056939125061
block generation total time  16.88502073287964
average batch blocks generation time:  1.0553137958049774
block dataloader generation time/epoch 38.70642447471619
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.0963587760925293  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157216, 128])
torch.Size([129055, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19338703155517578  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09666013717651367  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157645, 128])
torch.Size([130065, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19379806518554688  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09652137756347656  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157406, 128])
torch.Size([129310, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19365262985229492  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09769058227539062  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157699, 128])
torch.Size([129748, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19579362869262695  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09678030014038086  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157615, 128])
torch.Size([130261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19493770599365234  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09770584106445312  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157700, 128])
torch.Size([130105, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19588136672973633  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09673452377319336  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157553, 128])
torch.Size([129503, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1947917938232422  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.0964350700378418  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157427, 128])
torch.Size([129058, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1934041976928711  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09657049179077148  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157517, 128])
torch.Size([130031, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1937255859375  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09680652618408203  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157544, 128])
torch.Size([129670, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19485950469970703  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09770011901855469  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157794, 128])
torch.Size([129959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19585180282592773  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09674882888793945  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157337, 128])
torch.Size([129802, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19489574432373047  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09659385681152344  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157246, 128])
torch.Size([129645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1947164535522461  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09794235229492188  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157775, 128])
torch.Size([130564, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19620704650878906  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09780693054199219  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

torch.Size([157881, 128])
torch.Size([130846, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.19594526290893555  GigaBytes
Max Memory Allocated: 0.21015071868896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.09677886962890625  GigaBytes
Max Memory Allocated: 0.21025943756103516  GigaBytes

torch.Size([157652, 128])
torch.Size([130392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6365966796875 GB
    Memory Allocated: 0.1949477195739746  GigaBytes
Max Memory Allocated: 0.21025943756103516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030803784728050232 |0.016334116458892822 |0.003565564751625061 |9.603798389434814e-05 |0.0036531388759613037 |0.0014154911041259766 |
----------------------------------------------------------pseudo_mini_loss sum 4.339077472686768
Total (block generation + training)time/epoch 39.60847616195679
Training time/epoch 0.9018547534942627
Training time without block to device /epoch 0.6405088901519775
Training time without total dataloading part /epoch 0.11845135688781738
load block tensor time/epoch 0.4928605556488037
block to device time/epoch 0.26134586334228516
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5328898
Number of first layer input nodes during this epoch:  2521007
