Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648452109.449085
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027296066284179688
range selection method range initialization spend 0.013806343078613281
time for parepare:  0.017953157424926758
local_output_nid generation:  0.0006890296936035156
local_in_edges_tensor generation:  0.003616809844970703
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.010703086853027344
local_output_nid generation:  0.000820159912109375
local_in_edges_tensor generation:  0.0006108283996582031
mini_batch_src_global generation:  0.0015032291412353516
r_  generation:  0.009662628173828125
local_output_nid generation:  0.0007824897766113281
local_in_edges_tensor generation:  0.0005316734313964844
mini_batch_src_global generation:  0.0010492801666259766
r_  generation:  0.009471654891967773
local_output_nid generation:  0.0008065700531005859
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.0009586811065673828
r_  generation:  0.009499073028564453
local_output_nid generation:  0.0008137226104736328
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.0009012222290039062
r_  generation:  0.009560585021972656
local_output_nid generation:  0.0007963180541992188
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0009086132049560547
r_  generation:  0.009253740310668945
local_output_nid generation:  0.0007815361022949219
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.009776115417480469
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0009300708770751953
r_  generation:  0.00967264175415039
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0009362697601318359
r_  generation:  0.009682655334472656
local_output_nid generation:  0.0007696151733398438
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.009895086288452148
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0009543895721435547
r_  generation:  0.009955406188964844
local_output_nid generation:  0.0007493495941162109
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0010027885437011719
r_  generation:  0.009844779968261719
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.010048866271972656
local_output_nid generation:  0.0007634162902832031
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.010280847549438477
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.00046539306640625
mini_batch_src_global generation:  0.0009400844573974609
r_  generation:  0.009528398513793945
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0009720325469970703
r_  generation:  0.009862184524536133
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.01028895378112793
local_output_nid generation:  0.000766754150390625
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.01003408432006836
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0009763240814208984
r_  generation:  0.009735584259033203
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.0004668235778808594
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.009893417358398438
local_output_nid generation:  0.000759124755859375
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0009984970092773438
r_  generation:  0.009897708892822266
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0009846687316894531
r_  generation:  0.010095596313476562
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0010118484497070312
r_  generation:  0.010169744491577148
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0010046958923339844
r_  generation:  0.009885311126708984
local_output_nid generation:  0.0007596015930175781
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.01016998291015625
local_output_nid generation:  0.0007581710815429688
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.001001119613647461
r_  generation:  0.009993314743041992
local_output_nid generation:  0.0007510185241699219
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.009765625
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.00046563148498535156
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.010102987289428711
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0010004043579101562
r_  generation:  0.010146856307983398
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.004277229309082031
mini_batch_src_global generation:  0.0012233257293701172
r_  generation:  0.010080575942993164
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0010488033294677734
r_  generation:  0.010246992111206055
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0004956722259521484
mini_batch_src_global generation:  0.001043081283569336
r_  generation:  0.010241031646728516
----------------------check_connections_block total spend ----------------------------- 0.4880681037902832
generate_one_block  0.015021800994873047
generate_one_block  0.01471710205078125
generate_one_block  0.015274524688720703
generate_one_block  0.014947891235351562
generate_one_block  0.014354228973388672
generate_one_block  0.014021635055541992
generate_one_block  0.014533042907714844
generate_one_block  0.014685392379760742
generate_one_block  0.014673471450805664
generate_one_block  0.015056848526000977
generate_one_block  0.01456904411315918
generate_one_block  0.014793634414672852
generate_one_block  0.014691352844238281
generate_one_block  0.015053272247314453
generate_one_block  0.014032602310180664
generate_one_block  0.014599084854125977
generate_one_block  0.014949560165405273
generate_one_block  0.01483011245727539
generate_one_block  0.014351844787597656
generate_one_block  0.014518260955810547
generate_one_block  0.014800310134887695
generate_one_block  0.014790534973144531
generate_one_block  0.01523137092590332
generate_one_block  0.014705181121826172
generate_one_block  0.01475214958190918
generate_one_block  0.014816761016845703
generate_one_block  0.014406204223632812
generate_one_block  0.014841079711914062
generate_one_block  0.014922618865966797
generate_one_block  0.014868974685668945
generate_one_block  0.015059471130371094
generate_one_block  0.015024423599243164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0384061336517334
gen group dst list time:  0.023843765258789062
time for parepare:  0.019034385681152344
local_output_nid generation:  0.004297733306884766
local_in_edges_tensor generation:  0.01106405258178711
mini_batch_src_global generation:  0.013366460800170898
r_  generation:  0.1304454803466797
local_output_nid generation:  0.00703883171081543
local_in_edges_tensor generation:  0.012015342712402344
mini_batch_src_global generation:  0.0169675350189209
r_  generation:  0.14298057556152344
local_output_nid generation:  0.00753021240234375
local_in_edges_tensor generation:  0.00755000114440918
mini_batch_src_global generation:  0.016364574432373047
r_  generation:  0.1514890193939209
local_output_nid generation:  0.007166147232055664
local_in_edges_tensor generation:  0.00877523422241211
mini_batch_src_global generation:  0.020303726196289062
r_  generation:  0.14912033081054688
local_output_nid generation:  0.0071752071380615234
local_in_edges_tensor generation:  0.008708000183105469
mini_batch_src_global generation:  0.02032756805419922
r_  generation:  0.1490190029144287
local_output_nid generation:  0.007050514221191406
local_in_edges_tensor generation:  0.012664556503295898
mini_batch_src_global generation:  0.017209291458129883
r_  generation:  0.14643168449401855
local_output_nid generation:  0.007390260696411133
local_in_edges_tensor generation:  0.008747577667236328
mini_batch_src_global generation:  0.02141284942626953
r_  generation:  0.15145111083984375
local_output_nid generation:  0.007408618927001953
local_in_edges_tensor generation:  0.013073921203613281
mini_batch_src_global generation:  0.018117189407348633
r_  generation:  0.15292668342590332
local_output_nid generation:  0.01108551025390625
local_in_edges_tensor generation:  0.00931096076965332
mini_batch_src_global generation:  0.018613100051879883
r_  generation:  0.16526389122009277
local_output_nid generation:  0.010373115539550781
local_in_edges_tensor generation:  0.01540684700012207
mini_batch_src_global generation:  0.0193941593170166
r_  generation:  0.1535658836364746
local_output_nid generation:  0.007726430892944336
local_in_edges_tensor generation:  0.008367776870727539
mini_batch_src_global generation:  0.01815485954284668
r_  generation:  0.14846253395080566
local_output_nid generation:  0.007956743240356445
local_in_edges_tensor generation:  0.010376214981079102
mini_batch_src_global generation:  0.01972794532775879
r_  generation:  0.1550750732421875
local_output_nid generation:  0.007737636566162109
local_in_edges_tensor generation:  0.009138107299804688
mini_batch_src_global generation:  0.01849842071533203
r_  generation:  0.16229987144470215
local_output_nid generation:  0.008149147033691406
local_in_edges_tensor generation:  0.009551048278808594
mini_batch_src_global generation:  0.020334720611572266
r_  generation:  0.16032934188842773
local_output_nid generation:  0.007770538330078125
local_in_edges_tensor generation:  0.008193731307983398
mini_batch_src_global generation:  0.01853775978088379
r_  generation:  0.15165925025939941
local_output_nid generation:  0.008741378784179688
local_in_edges_tensor generation:  0.014878034591674805
mini_batch_src_global generation:  0.019737720489501953
r_  generation:  0.15725159645080566
local_output_nid generation:  0.008904457092285156
local_in_edges_tensor generation:  0.011999368667602539
mini_batch_src_global generation:  0.020525693893432617
r_  generation:  0.15412187576293945
local_output_nid generation:  0.00796961784362793
local_in_edges_tensor generation:  0.009772539138793945
mini_batch_src_global generation:  0.018393278121948242
r_  generation:  0.15221500396728516
local_output_nid generation:  0.007910013198852539
local_in_edges_tensor generation:  0.008152246475219727
mini_batch_src_global generation:  0.017972946166992188
r_  generation:  0.15031147003173828
local_output_nid generation:  0.007981300354003906
local_in_edges_tensor generation:  0.009018182754516602
mini_batch_src_global generation:  0.019752025604248047
r_  generation:  0.15188050270080566
local_output_nid generation:  0.007968425750732422
local_in_edges_tensor generation:  0.010433197021484375
mini_batch_src_global generation:  0.01961040496826172
r_  generation:  0.15447306632995605
local_output_nid generation:  0.007947921752929688
local_in_edges_tensor generation:  0.009292840957641602
mini_batch_src_global generation:  0.0340571403503418
r_  generation:  0.1570901870727539
local_output_nid generation:  0.008188962936401367
local_in_edges_tensor generation:  0.012285232543945312
mini_batch_src_global generation:  0.019387006759643555
r_  generation:  0.15653181076049805
local_output_nid generation:  0.007936716079711914
local_in_edges_tensor generation:  0.007973670959472656
mini_batch_src_global generation:  0.01872110366821289
r_  generation:  0.15308570861816406
local_output_nid generation:  0.008917093276977539
local_in_edges_tensor generation:  0.01458430290222168
mini_batch_src_global generation:  0.019690752029418945
r_  generation:  0.1549084186553955
local_output_nid generation:  0.008047342300415039
local_in_edges_tensor generation:  0.013008356094360352
mini_batch_src_global generation:  0.025225400924682617
r_  generation:  0.15555644035339355
local_output_nid generation:  0.008838176727294922
local_in_edges_tensor generation:  0.009932518005371094
mini_batch_src_global generation:  0.018199682235717773
r_  generation:  0.14970183372497559
local_output_nid generation:  0.008003473281860352
local_in_edges_tensor generation:  0.009302377700805664
mini_batch_src_global generation:  0.01882481575012207
r_  generation:  0.15605378150939941
local_output_nid generation:  0.008104324340820312
local_in_edges_tensor generation:  0.011815309524536133
mini_batch_src_global generation:  0.019888639450073242
r_  generation:  0.15464997291564941
local_output_nid generation:  0.008128166198730469
local_in_edges_tensor generation:  0.008188009262084961
mini_batch_src_global generation:  0.018423080444335938
r_  generation:  0.1544971466064453
local_output_nid generation:  0.00810861587524414
local_in_edges_tensor generation:  0.009293556213378906
mini_batch_src_global generation:  0.018732786178588867
r_  generation:  0.15471792221069336
local_output_nid generation:  0.008186101913452148
local_in_edges_tensor generation:  0.011937618255615234
mini_batch_src_global generation:  0.04001665115356445
r_  generation:  0.15839791297912598
----------------------check_connections_block total spend ----------------------------- 7.2877585887908936
generate_one_block  0.19187474250793457
generate_one_block  0.18732142448425293
generate_one_block  0.2234659194946289
generate_one_block  0.18651795387268066
generate_one_block  0.1840345859527588
generate_one_block  0.1794888973236084
generate_one_block  0.190871000289917
generate_one_block  0.1880955696105957
generate_one_block  0.18866395950317383
generate_one_block  0.18541526794433594
generate_one_block  0.1943378448486328
generate_one_block  0.19484996795654297
generate_one_block  0.1934354305267334
generate_one_block  0.19495272636413574
generate_one_block  0.18431472778320312
generate_one_block  0.21737360954284668
generate_one_block  0.1886136531829834
generate_one_block  0.18469476699829102
generate_one_block  0.18390560150146484
generate_one_block  0.18801164627075195
generate_one_block  0.1935594081878662
generate_one_block  0.18753719329833984
generate_one_block  0.19750332832336426
generate_one_block  0.19316649436950684
generate_one_block  0.20106840133666992
generate_one_block  0.1961219310760498
generate_one_block  0.18123626708984375
generate_one_block  0.1915125846862793
generate_one_block  0.19632339477539062
generate_one_block  0.19211602210998535
generate_one_block  0.1963207721710205
generate_one_block  0.19600605964660645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04639029502868652
gen group dst list time:  0.11011528968811035
time for parepare:  0.020572662353515625
local_output_nid generation:  0.020795106887817383
local_in_edges_tensor generation:  0.0564579963684082
mini_batch_src_global generation:  0.040936946868896484
r_  generation:  0.39191675186157227
local_output_nid generation:  0.02741861343383789
local_in_edges_tensor generation:  0.03995203971862793
mini_batch_src_global generation:  0.07590246200561523
r_  generation:  0.40659451484680176
local_output_nid generation:  0.026729345321655273
local_in_edges_tensor generation:  0.03390359878540039
mini_batch_src_global generation:  0.04885601997375488
r_  generation:  0.4162020683288574
local_output_nid generation:  0.027075529098510742
local_in_edges_tensor generation:  0.029844045639038086
mini_batch_src_global generation:  0.058965444564819336
r_  generation:  0.42655181884765625
local_output_nid generation:  0.029545068740844727
local_in_edges_tensor generation:  0.03538370132446289
mini_batch_src_global generation:  0.04885244369506836
r_  generation:  0.4126396179199219
local_output_nid generation:  0.026648998260498047
local_in_edges_tensor generation:  0.026421308517456055
mini_batch_src_global generation:  0.04816460609436035
r_  generation:  0.40781617164611816
local_output_nid generation:  0.02687835693359375
local_in_edges_tensor generation:  0.029942989349365234
mini_batch_src_global generation:  0.047722816467285156
r_  generation:  0.41631555557250977
local_output_nid generation:  0.02697157859802246
local_in_edges_tensor generation:  0.03513669967651367
mini_batch_src_global generation:  0.049398183822631836
r_  generation:  0.4109046459197998
local_output_nid generation:  0.027307748794555664
local_in_edges_tensor generation:  0.02928614616394043
mini_batch_src_global generation:  0.05082845687866211
r_  generation:  0.4158334732055664
local_output_nid generation:  0.02718973159790039
local_in_edges_tensor generation:  0.025178909301757812
mini_batch_src_global generation:  0.04862499237060547
r_  generation:  0.41103029251098633
local_output_nid generation:  0.02675604820251465
local_in_edges_tensor generation:  0.024408578872680664
mini_batch_src_global generation:  0.04892683029174805
r_  generation:  0.4138021469116211
local_output_nid generation:  0.027184486389160156
local_in_edges_tensor generation:  0.03234219551086426
mini_batch_src_global generation:  0.0483250617980957
r_  generation:  0.4153590202331543
local_output_nid generation:  0.027169466018676758
local_in_edges_tensor generation:  0.035286664962768555
mini_batch_src_global generation:  0.04804873466491699
r_  generation:  0.4158310890197754
local_output_nid generation:  0.02827906608581543
local_in_edges_tensor generation:  0.02935171127319336
mini_batch_src_global generation:  0.0563359260559082
r_  generation:  0.43878865242004395
local_output_nid generation:  0.027111053466796875
local_in_edges_tensor generation:  0.034185171127319336
mini_batch_src_global generation:  0.05264449119567871
r_  generation:  0.4118049144744873
local_output_nid generation:  0.028311491012573242
local_in_edges_tensor generation:  0.030359745025634766
mini_batch_src_global generation:  0.051770925521850586
r_  generation:  0.41393518447875977
local_output_nid generation:  0.02696847915649414
local_in_edges_tensor generation:  0.0286862850189209
mini_batch_src_global generation:  0.0502781867980957
r_  generation:  0.4183533191680908
local_output_nid generation:  0.02684617042541504
local_in_edges_tensor generation:  0.028885364532470703
mini_batch_src_global generation:  0.04860115051269531
r_  generation:  0.4091970920562744
local_output_nid generation:  0.027064085006713867
local_in_edges_tensor generation:  0.03252887725830078
mini_batch_src_global generation:  0.048185110092163086
r_  generation:  0.4127647876739502
local_output_nid generation:  0.02687358856201172
local_in_edges_tensor generation:  0.032965660095214844
mini_batch_src_global generation:  0.04767918586730957
r_  generation:  0.41480326652526855
local_output_nid generation:  0.027257442474365234
local_in_edges_tensor generation:  0.03310132026672363
mini_batch_src_global generation:  0.04801583290100098
r_  generation:  0.4150819778442383
local_output_nid generation:  0.027338266372680664
local_in_edges_tensor generation:  0.025218963623046875
mini_batch_src_global generation:  0.048360347747802734
r_  generation:  0.41561293601989746
local_output_nid generation:  0.02719259262084961
local_in_edges_tensor generation:  0.0325932502746582
mini_batch_src_global generation:  0.05075883865356445
r_  generation:  0.4177262783050537
local_output_nid generation:  0.02723836898803711
local_in_edges_tensor generation:  0.03644061088562012
mini_batch_src_global generation:  0.04806017875671387
r_  generation:  0.41655755043029785
local_output_nid generation:  0.02817082405090332
local_in_edges_tensor generation:  0.028488874435424805
mini_batch_src_global generation:  0.0575404167175293
r_  generation:  0.4301731586456299
local_output_nid generation:  0.02924489974975586
local_in_edges_tensor generation:  0.030768156051635742
mini_batch_src_global generation:  0.05505061149597168
r_  generation:  0.412416934967041
local_output_nid generation:  0.02710580825805664
local_in_edges_tensor generation:  0.0272064208984375
mini_batch_src_global generation:  0.04831576347351074
r_  generation:  0.4130568504333496
local_output_nid generation:  0.027400493621826172
local_in_edges_tensor generation:  0.03246045112609863
mini_batch_src_global generation:  0.048406124114990234
r_  generation:  0.41519856452941895
local_output_nid generation:  0.02735304832458496
local_in_edges_tensor generation:  0.03214097023010254
mini_batch_src_global generation:  0.04901909828186035
r_  generation:  0.437089204788208
local_output_nid generation:  0.02760004997253418
local_in_edges_tensor generation:  0.028808116912841797
mini_batch_src_global generation:  0.060088396072387695
r_  generation:  0.421205997467041
local_output_nid generation:  0.02774834632873535
local_in_edges_tensor generation:  0.02904534339904785
mini_batch_src_global generation:  0.04821348190307617
r_  generation:  0.42548274993896484
local_output_nid generation:  0.028680086135864258
local_in_edges_tensor generation:  0.0354161262512207
mini_batch_src_global generation:  0.04909777641296387
r_  generation:  0.4162464141845703
----------------------check_connections_block total spend ----------------------------- 19.772639274597168
generate_one_block  0.6298165321350098
generate_one_block  0.5352294445037842
generate_one_block  0.5369086265563965
generate_one_block  0.5186052322387695
generate_one_block  0.5314397811889648
generate_one_block  0.524644136428833
generate_one_block  0.5321791172027588
generate_one_block  0.5460078716278076
generate_one_block  0.5311312675476074
generate_one_block  0.5317761898040771
generate_one_block  0.5244324207305908
generate_one_block  0.5387084484100342
generate_one_block  0.5322802066802979
generate_one_block  0.5541131496429443
generate_one_block  0.5189423561096191
generate_one_block  0.5420191287994385
generate_one_block  0.5423150062561035
generate_one_block  0.5199010372161865
generate_one_block  0.5223190784454346
generate_one_block  0.543346643447876
generate_one_block  0.5587451457977295
generate_one_block  0.5194346904754639
generate_one_block  0.5302524566650391
generate_one_block  0.5440526008605957
generate_one_block  0.5265312194824219
generate_one_block  0.5247538089752197
generate_one_block  0.5264461040496826
generate_one_block  0.5349409580230713
generate_one_block  0.5554020404815674
generate_one_block  0.5203092098236084
generate_one_block  0.5297698974609375
generate_one_block  0.5416197776794434
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  27.06039786338806
block generation total time  23.32108473777771
average batch blocks generation time:  0.7287838980555534
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08409643173217773  GigaBytes
Max Memory Allocated: 0.08409643173217773  GigaBytes

torch.Size([145865, 128])
torch.Size([101590, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9764404296875 GB
    Memory Allocated: 0.5723814964294434  GigaBytes
Max Memory Allocated: 0.5961766242980957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.08521652221679688  GigaBytes
Max Memory Allocated: 0.6642661094665527  GigaBytes

torch.Size([146832, 128])
torch.Size([102920, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.5758280754089355  GigaBytes
Max Memory Allocated: 0.6642661094665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08572769165039062  GigaBytes
Max Memory Allocated: 0.668421745300293  GigaBytes

torch.Size([146679, 128])
torch.Size([103379, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5803203582763672  GigaBytes
Max Memory Allocated: 0.668421745300293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08452606201171875  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145650, 128])
torch.Size([101345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5697646141052246  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.0853872299194336  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146324, 128])
torch.Size([102204, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5731191635131836  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08474159240722656  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146482, 128])
torch.Size([101426, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.569127082824707  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08536529541015625  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146686, 128])
torch.Size([102248, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5736293792724609  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08479976654052734  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146242, 128])
torch.Size([101901, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5727849006652832  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08546161651611328  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([147261, 128])
torch.Size([103268, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5779719352722168  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08479452133178711  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146213, 128])
torch.Size([102062, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5729818344116211  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08533859252929688  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145987, 128])
torch.Size([101635, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.573204517364502  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08487462997436523  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146247, 128])
torch.Size([102489, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5753889083862305  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08545303344726562  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145713, 128])
torch.Size([101415, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5730981826782227  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08530998229980469  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146756, 128])
torch.Size([103285, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5797338485717773  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08526420593261719  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145947, 128])
torch.Size([101500, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5698771476745605  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08480978012084961  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146179, 128])
torch.Size([102065, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5727801322937012  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08547019958496094  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146129, 128])
torch.Size([102286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5742316246032715  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.0847783088684082  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146215, 128])
torch.Size([101888, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5727744102478027  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08531379699707031  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146615, 128])
torch.Size([102049, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5727510452270508  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08516168594360352  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146919, 128])
torch.Size([102589, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5751538276672363  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08548164367675781  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146535, 128])
torch.Size([102528, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.575251579284668  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08484792709350586  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146307, 128])
torch.Size([101956, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5729207992553711  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08559608459472656  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146374, 128])
torch.Size([102962, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5780119895935059  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08496475219726562  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146302, 128])
torch.Size([102723, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.575075626373291  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08546829223632812  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145866, 128])
torch.Size([101756, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5737595558166504  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08497190475463867  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146455, 128])
torch.Size([101862, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5730137825012207  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08526611328125  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146565, 128])
torch.Size([101976, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5727729797363281  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08476877212524414  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145959, 128])
torch.Size([101993, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.572965145111084  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08551788330078125  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146922, 128])
torch.Size([103018, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5772466659545898  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.084747314453125  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146034, 128])
torch.Size([102274, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5734162330627441  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.08545875549316406  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146087, 128])
torch.Size([101999, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5732378959655762  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.0848379135131836  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([145968, 128])
torch.Size([102451, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.5755491256713867  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04772362858057022 |0.023243770003318787 |0.026429295539855957 |9.156763553619385e-05 |0.005430877208709717 |0.0024459362030029297 |
----------------------------------------------------------pseudo_mini_loss sum 6.3182692527771
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8792911
Number of first layer input nodes during this epoch:  4682315
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.10617733001708984  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021750211715698242
range selection method range initialization spend 0.011649847030639648
time for parepare:  0.01601099967956543
local_output_nid generation:  0.0007319450378417969
local_in_edges_tensor generation:  0.00455784797668457
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.010102510452270508
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.0005965232849121094
mini_batch_src_global generation:  0.0014729499816894531
r_  generation:  0.010323286056518555
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0005347728729248047
mini_batch_src_global generation:  0.0009818077087402344
r_  generation:  0.009209632873535156
local_output_nid generation:  0.0007812976837158203
local_in_edges_tensor generation:  0.000522613525390625
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.009959936141967773
local_output_nid generation:  0.0007727146148681641
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.0009415149688720703
r_  generation:  0.00957179069519043
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.01023101806640625
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.009656906127929688
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0009396076202392578
r_  generation:  0.009626388549804688
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.009634971618652344
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.001007080078125
r_  generation:  0.00972127914428711
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.009893655776977539
local_output_nid generation:  0.0008027553558349609
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0010137557983398438
r_  generation:  0.009656906127929688
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0005075931549072266
mini_batch_src_global generation:  0.0009784698486328125
r_  generation:  0.009782075881958008
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.009980440139770508
local_output_nid generation:  0.0007860660552978516
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0009028911590576172
r_  generation:  0.009190797805786133
local_output_nid generation:  0.0007824897766113281
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009794235229492188
r_  generation:  0.009956598281860352
local_output_nid generation:  0.0007874965667724609
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0009398460388183594
r_  generation:  0.009337425231933594
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0009801387786865234
r_  generation:  0.009836912155151367
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0009932518005371094
r_  generation:  0.010176897048950195
local_output_nid generation:  0.0007796287536621094
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009591579437255859
r_  generation:  0.009717702865600586
local_output_nid generation:  0.0007891654968261719
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.00985264778137207
local_output_nid generation:  0.0007998943328857422
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.009796142578125
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.010114908218383789
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0010673999786376953
r_  generation:  0.009945154190063477
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0010089874267578125
r_  generation:  0.010112285614013672
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.000980377197265625
r_  generation:  0.009780406951904297
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.0010106563568115234
r_  generation:  0.010448932647705078
local_output_nid generation:  0.0007779598236083984
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.010293245315551758
local_output_nid generation:  0.0007953643798828125
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.000993967056274414
r_  generation:  0.009835243225097656
local_output_nid generation:  0.0007917881011962891
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009815692901611328
r_  generation:  0.009767293930053711
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.010240793228149414
----------------------check_connections_block total spend ----------------------------- 0.48140621185302734
generate_one_block  0.01524972915649414
generate_one_block  0.017264842987060547
generate_one_block  0.014269113540649414
generate_one_block  0.01571798324584961
generate_one_block  0.014705181121826172
generate_one_block  0.015738725662231445
generate_one_block  0.014397621154785156
generate_one_block  0.014512062072753906
generate_one_block  0.014488697052001953
generate_one_block  0.014585256576538086
generate_one_block  0.014574766159057617
generate_one_block  0.014606475830078125
generate_one_block  0.014651060104370117
generate_one_block  0.01479959487915039
generate_one_block  0.013667583465576172
generate_one_block  0.014737367630004883
generate_one_block  0.01494908332824707
generate_one_block  0.013924598693847656
generate_one_block  0.01475667953491211
generate_one_block  0.015058040618896484
generate_one_block  0.014070510864257812
generate_one_block  0.014764547348022461
generate_one_block  0.01473093032836914
generate_one_block  0.014865636825561523
generate_one_block  0.01470494270324707
generate_one_block  0.014823436737060547
generate_one_block  0.014489412307739258
generate_one_block  0.0159151554107666
generate_one_block  0.015286684036254883
generate_one_block  0.0145263671875
generate_one_block  0.014231681823730469
generate_one_block  0.01496434211730957
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03962373733520508
gen group dst list time:  0.020595788955688477
time for parepare:  0.018923282623291016
local_output_nid generation:  0.0042645931243896484
local_in_edges_tensor generation:  0.012690305709838867
mini_batch_src_global generation:  0.01477670669555664
r_  generation:  0.13246989250183105
local_output_nid generation:  0.006760835647583008
local_in_edges_tensor generation:  0.012388944625854492
mini_batch_src_global generation:  0.017621278762817383
r_  generation:  0.1486067771911621
local_output_nid generation:  0.006592512130737305
local_in_edges_tensor generation:  0.02589106559753418
mini_batch_src_global generation:  0.014989376068115234
r_  generation:  0.13631248474121094
local_output_nid generation:  0.0073888301849365234
local_in_edges_tensor generation:  0.010167598724365234
mini_batch_src_global generation:  0.017092227935791016
r_  generation:  0.15338373184204102
local_output_nid generation:  0.00753331184387207
local_in_edges_tensor generation:  0.0077092647552490234
mini_batch_src_global generation:  0.017426729202270508
r_  generation:  0.1450939178466797
local_output_nid generation:  0.007984638214111328
local_in_edges_tensor generation:  0.008635759353637695
mini_batch_src_global generation:  0.01981377601623535
r_  generation:  0.15506935119628906
local_output_nid generation:  0.007607460021972656
local_in_edges_tensor generation:  0.00802755355834961
mini_batch_src_global generation:  0.01778388023376465
r_  generation:  0.14825105667114258
local_output_nid generation:  0.007356882095336914
local_in_edges_tensor generation:  0.00970005989074707
mini_batch_src_global generation:  0.017698287963867188
r_  generation:  0.15134763717651367
local_output_nid generation:  0.007486820220947266
local_in_edges_tensor generation:  0.008070230484008789
mini_batch_src_global generation:  0.017688512802124023
r_  generation:  0.15134215354919434
local_output_nid generation:  0.007720232009887695
local_in_edges_tensor generation:  0.010311603546142578
mini_batch_src_global generation:  0.01763153076171875
r_  generation:  0.15112662315368652
local_output_nid generation:  0.007997989654541016
local_in_edges_tensor generation:  0.010341882705688477
mini_batch_src_global generation:  0.018118858337402344
r_  generation:  0.15182733535766602
local_output_nid generation:  0.007823944091796875
local_in_edges_tensor generation:  0.00907135009765625
mini_batch_src_global generation:  0.017948627471923828
r_  generation:  0.15132880210876465
local_output_nid generation:  0.007910966873168945
local_in_edges_tensor generation:  0.009143590927124023
mini_batch_src_global generation:  0.018184185028076172
r_  generation:  0.15120339393615723
local_output_nid generation:  0.00807642936706543
local_in_edges_tensor generation:  0.010883331298828125
mini_batch_src_global generation:  0.019561290740966797
r_  generation:  0.15534162521362305
local_output_nid generation:  0.007424831390380859
local_in_edges_tensor generation:  0.0073888301849365234
mini_batch_src_global generation:  0.016997575759887695
r_  generation:  0.13981151580810547
local_output_nid generation:  0.007954597473144531
local_in_edges_tensor generation:  0.010087728500366211
mini_batch_src_global generation:  0.018000125885009766
r_  generation:  0.1554265022277832
local_output_nid generation:  0.00811910629272461
local_in_edges_tensor generation:  0.010749101638793945
mini_batch_src_global generation:  0.01852107048034668
r_  generation:  0.15366721153259277
local_output_nid generation:  0.007727384567260742
local_in_edges_tensor generation:  0.008903741836547852
mini_batch_src_global generation:  0.0173795223236084
r_  generation:  0.14458155632019043
local_output_nid generation:  0.00814366340637207
local_in_edges_tensor generation:  0.009464740753173828
mini_batch_src_global generation:  0.018772363662719727
r_  generation:  0.1519320011138916
local_output_nid generation:  0.00785684585571289
local_in_edges_tensor generation:  0.01348423957824707
mini_batch_src_global generation:  0.01849675178527832
r_  generation:  0.157731294631958
local_output_nid generation:  0.0073947906494140625
local_in_edges_tensor generation:  0.007944822311401367
mini_batch_src_global generation:  0.017889738082885742
r_  generation:  0.14764976501464844
local_output_nid generation:  0.007637500762939453
local_in_edges_tensor generation:  0.008323431015014648
mini_batch_src_global generation:  0.01809549331665039
r_  generation:  0.15350556373596191
local_output_nid generation:  0.007712125778198242
local_in_edges_tensor generation:  0.010647773742675781
mini_batch_src_global generation:  0.019777297973632812
r_  generation:  0.15514206886291504
local_output_nid generation:  0.007772684097290039
local_in_edges_tensor generation:  0.010772943496704102
mini_batch_src_global generation:  0.01828289031982422
r_  generation:  0.15531635284423828
local_output_nid generation:  0.0077440738677978516
local_in_edges_tensor generation:  0.01109933853149414
mini_batch_src_global generation:  0.01883721351623535
r_  generation:  0.1578209400177002
local_output_nid generation:  0.008816242218017578
local_in_edges_tensor generation:  0.012620687484741211
mini_batch_src_global generation:  0.02062082290649414
r_  generation:  0.16271328926086426
local_output_nid generation:  0.007645606994628906
local_in_edges_tensor generation:  0.01258230209350586
mini_batch_src_global generation:  0.02192234992980957
r_  generation:  0.15843510627746582
local_output_nid generation:  0.010180234909057617
local_in_edges_tensor generation:  0.010877847671508789
mini_batch_src_global generation:  0.02483391761779785
r_  generation:  0.15898752212524414
local_output_nid generation:  0.008051156997680664
local_in_edges_tensor generation:  0.008756875991821289
mini_batch_src_global generation:  0.018653392791748047
r_  generation:  0.15515518188476562
local_output_nid generation:  0.007973670959472656
local_in_edges_tensor generation:  0.008513450622558594
mini_batch_src_global generation:  0.018105745315551758
r_  generation:  0.15272736549377441
local_output_nid generation:  0.007831573486328125
local_in_edges_tensor generation:  0.008479595184326172
mini_batch_src_global generation:  0.01804375648498535
r_  generation:  0.14851641654968262
local_output_nid generation:  0.008035421371459961
local_in_edges_tensor generation:  0.009403228759765625
mini_batch_src_global generation:  0.0179445743560791
r_  generation:  0.15179109573364258
----------------------check_connections_block total spend ----------------------------- 7.149960517883301
generate_one_block  0.19207382202148438
generate_one_block  0.1930084228515625
generate_one_block  0.17609429359436035
generate_one_block  0.19810986518859863
generate_one_block  0.199493408203125
generate_one_block  0.19794964790344238
generate_one_block  0.18270087242126465
generate_one_block  0.1882467269897461
generate_one_block  0.19175171852111816
generate_one_block  0.19515085220336914
generate_one_block  0.18567299842834473
generate_one_block  0.1885392665863037
generate_one_block  0.18526268005371094
generate_one_block  0.18981194496154785
generate_one_block  0.16974759101867676
generate_one_block  0.19175434112548828
generate_one_block  0.18956875801086426
generate_one_block  0.17761683464050293
generate_one_block  0.19235730171203613
generate_one_block  0.2269740104675293
generate_one_block  0.1820826530456543
generate_one_block  0.18531513214111328
generate_one_block  0.18895173072814941
generate_one_block  0.1906278133392334
generate_one_block  0.19672918319702148
generate_one_block  0.19308185577392578
generate_one_block  0.1894056797027588
generate_one_block  0.19740509986877441
generate_one_block  0.1880815029144287
generate_one_block  0.1867387294769287
generate_one_block  0.1801297664642334
generate_one_block  0.18624591827392578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.051157236099243164
gen group dst list time:  0.10129237174987793
time for parepare:  0.01741194725036621
local_output_nid generation:  0.021042346954345703
local_in_edges_tensor generation:  0.058187246322631836
mini_batch_src_global generation:  0.04051041603088379
r_  generation:  0.39765429496765137
local_output_nid generation:  0.028641939163208008
local_in_edges_tensor generation:  0.041649818420410156
mini_batch_src_global generation:  0.04735374450683594
r_  generation:  0.4213402271270752
local_output_nid generation:  0.02733922004699707
local_in_edges_tensor generation:  0.03812670707702637
mini_batch_src_global generation:  0.05337834358215332
r_  generation:  0.4040651321411133
local_output_nid generation:  0.025884151458740234
local_in_edges_tensor generation:  0.0344691276550293
mini_batch_src_global generation:  0.05472207069396973
r_  generation:  0.4079592227935791
local_output_nid generation:  0.02634739875793457
local_in_edges_tensor generation:  0.027600526809692383
mini_batch_src_global generation:  0.047815799713134766
r_  generation:  0.4066030979156494
local_output_nid generation:  0.026915788650512695
local_in_edges_tensor generation:  0.03108358383178711
mini_batch_src_global generation:  0.04899430274963379
r_  generation:  0.409121036529541
local_output_nid generation:  0.02657938003540039
local_in_edges_tensor generation:  0.031076669692993164
mini_batch_src_global generation:  0.047969818115234375
r_  generation:  0.4093129634857178
local_output_nid generation:  0.027134180068969727
local_in_edges_tensor generation:  0.035516977310180664
mini_batch_src_global generation:  0.048635005950927734
r_  generation:  0.41840434074401855
local_output_nid generation:  0.027007102966308594
local_in_edges_tensor generation:  0.027706623077392578
mini_batch_src_global generation:  0.05028200149536133
r_  generation:  0.4096035957336426
local_output_nid generation:  0.026927947998046875
local_in_edges_tensor generation:  0.030423402786254883
mini_batch_src_global generation:  0.05135655403137207
r_  generation:  0.41512036323547363
local_output_nid generation:  0.027232885360717773
local_in_edges_tensor generation:  0.03525853157043457
mini_batch_src_global generation:  0.04767751693725586
r_  generation:  0.4117152690887451
local_output_nid generation:  0.02705550193786621
local_in_edges_tensor generation:  0.030820131301879883
mini_batch_src_global generation:  0.04863286018371582
r_  generation:  0.4128422737121582
local_output_nid generation:  0.026906490325927734
local_in_edges_tensor generation:  0.031087875366210938
mini_batch_src_global generation:  0.04806709289550781
r_  generation:  0.4164571762084961
local_output_nid generation:  0.027345657348632812
local_in_edges_tensor generation:  0.034691810607910156
mini_batch_src_global generation:  0.04831290245056152
r_  generation:  0.4124414920806885
local_output_nid generation:  0.026578903198242188
local_in_edges_tensor generation:  0.027419567108154297
mini_batch_src_global generation:  0.047486066818237305
r_  generation:  0.4053049087524414
local_output_nid generation:  0.027263879776000977
local_in_edges_tensor generation:  0.030848026275634766
mini_batch_src_global generation:  0.062285661697387695
r_  generation:  0.4140326976776123
local_output_nid generation:  0.027475833892822266
local_in_edges_tensor generation:  0.031018733978271484
mini_batch_src_global generation:  0.04800558090209961
r_  generation:  0.41078734397888184
local_output_nid generation:  0.02719902992248535
local_in_edges_tensor generation:  0.03630638122558594
mini_batch_src_global generation:  0.049253225326538086
r_  generation:  0.40587878227233887
local_output_nid generation:  0.027632713317871094
local_in_edges_tensor generation:  0.035035133361816406
mini_batch_src_global generation:  0.05083894729614258
r_  generation:  0.4168076515197754
local_output_nid generation:  0.027647733688354492
local_in_edges_tensor generation:  0.03483867645263672
mini_batch_src_global generation:  0.048917293548583984
r_  generation:  0.4148678779602051
local_output_nid generation:  0.02701258659362793
local_in_edges_tensor generation:  0.02727222442626953
mini_batch_src_global generation:  0.04822254180908203
r_  generation:  0.40640830993652344
local_output_nid generation:  0.02811145782470703
local_in_edges_tensor generation:  0.027568340301513672
mini_batch_src_global generation:  0.0525510311126709
r_  generation:  0.4314734935760498
local_output_nid generation:  0.028484582901000977
local_in_edges_tensor generation:  0.039571285247802734
mini_batch_src_global generation:  0.05292248725891113
r_  generation:  0.41568470001220703
local_output_nid generation:  0.02772998809814453
local_in_edges_tensor generation:  0.03804636001586914
mini_batch_src_global generation:  0.051572322845458984
r_  generation:  0.41130828857421875
local_output_nid generation:  0.027811765670776367
local_in_edges_tensor generation:  0.031027555465698242
mini_batch_src_global generation:  0.05089902877807617
r_  generation:  0.4245145320892334
local_output_nid generation:  0.027836084365844727
local_in_edges_tensor generation:  0.03926968574523926
mini_batch_src_global generation:  0.04816460609436035
r_  generation:  0.41698765754699707
local_output_nid generation:  0.027146577835083008
local_in_edges_tensor generation:  0.02752685546875
mini_batch_src_global generation:  0.04846811294555664
r_  generation:  0.4143056869506836
local_output_nid generation:  0.03299450874328613
local_in_edges_tensor generation:  0.02802443504333496
mini_batch_src_global generation:  0.05165815353393555
r_  generation:  0.41696715354919434
local_output_nid generation:  0.02735614776611328
local_in_edges_tensor generation:  0.038726091384887695
mini_batch_src_global generation:  0.04733633995056152
r_  generation:  0.41614699363708496
local_output_nid generation:  0.02755427360534668
local_in_edges_tensor generation:  0.02745509147644043
mini_batch_src_global generation:  0.04859519004821777
r_  generation:  0.4093019962310791
local_output_nid generation:  0.027643203735351562
local_in_edges_tensor generation:  0.027997255325317383
mini_batch_src_global generation:  0.0476076602935791
r_  generation:  0.41463804244995117
local_output_nid generation:  0.0274808406829834
local_in_edges_tensor generation:  0.02734541893005371
mini_batch_src_global generation:  0.05157947540283203
r_  generation:  0.4108116626739502
----------------------check_connections_block total spend ----------------------------- 19.601426601409912
generate_one_block  0.5318193435668945
generate_one_block  0.5460047721862793
generate_one_block  0.5196824073791504
generate_one_block  0.542076587677002
generate_one_block  0.6142034530639648
generate_one_block  0.5385212898254395
generate_one_block  0.5346496105194092
generate_one_block  0.5329685211181641
generate_one_block  0.5281603336334229
generate_one_block  0.5336191654205322
generate_one_block  0.5345675945281982
generate_one_block  0.5350401401519775
generate_one_block  0.5178000926971436
generate_one_block  0.5913076400756836
generate_one_block  0.5185000896453857
generate_one_block  0.5368683338165283
generate_one_block  0.5329599380493164
generate_one_block  0.5541296005249023
generate_one_block  0.5513763427734375
generate_one_block  0.5431289672851562
generate_one_block  0.5496962070465088
generate_one_block  0.5445172786712646
generate_one_block  0.5394155979156494
generate_one_block  0.5561244487762451
generate_one_block  0.5790338516235352
generate_one_block  0.5427553653717041
generate_one_block  0.5327537059783936
generate_one_block  0.5546066761016846
generate_one_block  0.5617403984069824
generate_one_block  0.5285999774932861
generate_one_block  0.5401821136474609
generate_one_block  0.5388710498809814
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.10617733001708984  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

connection checking time:  26.751387119293213
block generation total time  23.482361316680908
average batch blocks generation time:  0.7338237911462784
block dataloader generation time/epoch 52.65054488182068
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08710336685180664  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146417, 128])
torch.Size([102482, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5771694183349609  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08659601211547852  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146135, 128])
torch.Size([102624, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5776748657226562  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08684349060058594  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146386, 128])
torch.Size([101658, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5709352493286133  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08691740036010742  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

torch.Size([146447, 128])
torch.Size([103155, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5831828117370605  GigaBytes
Max Memory Allocated: 0.6715021133422852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08699321746826172  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146318, 128])
torch.Size([101625, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5748653411865234  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08641958236694336  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([145547, 128])
torch.Size([102431, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.579768180847168  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08697509765625  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146040, 128])
torch.Size([101934, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5744872093200684  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08684206008911133  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146855, 128])
torch.Size([103063, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5780563354492188  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08699798583984375  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146562, 128])
torch.Size([102302, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5750226974487305  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08654403686523438  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146460, 128])
torch.Size([102083, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5745477676391602  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08705329895019531  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146322, 128])
torch.Size([102441, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5769176483154297  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08642053604125977  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146133, 128])
torch.Size([102194, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5739736557006836  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08578252792358398  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([144933, 128])
torch.Size([100944, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5693225860595703  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08675813674926758  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146567, 128])
torch.Size([102843, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5772867202758789  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08651447296142578  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146270, 128])
torch.Size([100094, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5581631660461426  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08662748336791992  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146317, 128])
torch.Size([102668, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5773301124572754  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08709907531738281  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146361, 128])
torch.Size([102476, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5781793594360352  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08611249923706055  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146087, 128])
torch.Size([101159, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5642156600952148  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08716678619384766  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146857, 128])
torch.Size([103296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5798006057739258  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08675146102905273  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146629, 128])
torch.Size([103123, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5797829627990723  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.0868072509765625  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([145782, 128])
torch.Size([100776, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5662474632263184  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08623361587524414  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([145849, 128])
torch.Size([102001, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.574519157409668  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08708763122558594  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146594, 128])
torch.Size([102764, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5779461860656738  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.0863656997680664  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([145954, 128])
torch.Size([102316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5752992630004883  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08723831176757812  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146236, 128])
torch.Size([103098, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5788464546203613  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08684492111206055  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

torch.Size([146707, 128])
torch.Size([103409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5811324119567871  GigaBytes
Max Memory Allocated: 0.6726431846618652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08696556091308594  GigaBytes
Max Memory Allocated: 0.6731681823730469  GigaBytes

torch.Size([145771, 128])
torch.Size([101536, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5744404792785645  GigaBytes
Max Memory Allocated: 0.6731681823730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08671426773071289  GigaBytes
Max Memory Allocated: 0.6731681823730469  GigaBytes

torch.Size([146181, 128])
torch.Size([103567, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5849075317382812  GigaBytes
Max Memory Allocated: 0.6731681823730469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08719825744628906  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

torch.Size([146294, 128])
torch.Size([102849, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5785150527954102  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08643054962158203  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

torch.Size([146064, 128])
torch.Size([101967, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5741796493530273  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08694076538085938  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

torch.Size([146120, 128])
torch.Size([101971, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.5718011856079102  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08652496337890625  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

torch.Size([146304, 128])
torch.Size([102359, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.575019359588623  GigaBytes
Max Memory Allocated: 0.6781306266784668  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04635555297136307 |0.01313529908657074 |0.0035819336771965027 |8.864700794219971e-05 |0.004093855619430542 |0.0029458999633789062 |
----------------------------------------------------------pseudo_mini_loss sum 3.2561397552490234
Total (block generation + training)time/epoch 54.87055468559265
Training time/epoch 2.219700574874878
Training time without block to device /epoch 1.7993710041046143
Training time without total dataloading part /epoch 0.2514078617095947
load block tensor time/epoch 1.4833776950836182
block to device time/epoch 0.42032957077026367
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8792169
Number of first layer input nodes during this epoch:  4679499
