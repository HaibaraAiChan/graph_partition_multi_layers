Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648451108.2581887
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02716517448425293
range selection method range initialization spend 0.013241767883300781
time for parepare:  0.017937898635864258
local_output_nid generation:  0.0006966590881347656
local_in_edges_tensor generation:  0.0038917064666748047
mini_batch_src_global generation:  0.0014338493347167969
r_  generation:  0.01005697250366211
local_output_nid generation:  0.0007429122924804688
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.009366750717163086
local_output_nid generation:  0.0007224082946777344
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.009056568145751953
local_output_nid generation:  0.0007481575012207031
local_in_edges_tensor generation:  0.0005180835723876953
mini_batch_src_global generation:  0.0009181499481201172
r_  generation:  0.009318351745605469
local_output_nid generation:  0.0007183551788330078
local_in_edges_tensor generation:  0.0005061626434326172
mini_batch_src_global generation:  0.0009157657623291016
r_  generation:  0.009350061416625977
local_output_nid generation:  0.0007345676422119141
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009198188781738281
r_  generation:  0.009694099426269531
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.009661436080932617
local_output_nid generation:  0.0007181167602539062
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0008556842803955078
r_  generation:  0.009139299392700195
local_output_nid generation:  0.0007293224334716797
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0008754730224609375
r_  generation:  0.009354591369628906
local_output_nid generation:  0.0007703304290771484
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0009496212005615234
r_  generation:  0.00963449478149414
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.009902477264404297
local_output_nid generation:  0.0007410049438476562
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0009369850158691406
r_  generation:  0.009348869323730469
local_output_nid generation:  0.0007333755493164062
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.009927034378051758
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.010343790054321289
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0009551048278808594
r_  generation:  0.009837150573730469
local_output_nid generation:  0.0007417201995849609
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.009670019149780273
local_output_nid generation:  0.0007390975952148438
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.001079559326171875
r_  generation:  0.011215925216674805
local_output_nid generation:  0.0007843971252441406
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.0012042522430419922
r_  generation:  0.009944438934326172
local_output_nid generation:  0.0007562637329101562
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.00950932502746582
local_output_nid generation:  0.0007486343383789062
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.001062631607055664
r_  generation:  0.010103225708007812
local_output_nid generation:  0.0007464885711669922
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.010136127471923828
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.01012730598449707
local_output_nid generation:  0.0007886886596679688
local_in_edges_tensor generation:  0.0004956722259521484
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.010268449783325195
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0011012554168701172
r_  generation:  0.010215282440185547
local_output_nid generation:  0.0007612705230712891
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.009634733200073242
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.0010638236999511719
r_  generation:  0.010066747665405273
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.01003265380859375
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.0010025501251220703
r_  generation:  0.009908914566040039
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.009992599487304688
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.004203081130981445
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.010342121124267578
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.0010557174682617188
r_  generation:  0.009914159774780273
local_output_nid generation:  0.0007779598236083984
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.009860515594482422
----------------------check_connections_block total spend ----------------------------- 0.48493194580078125
generate_one_block  0.015139102935791016
generate_one_block  0.014736175537109375
generate_one_block  0.014614582061767578
generate_one_block  0.01507115364074707
generate_one_block  0.014953136444091797
generate_one_block  0.015340328216552734
generate_one_block  0.015201807022094727
generate_one_block  0.014128684997558594
generate_one_block  0.014501810073852539
generate_one_block  0.015169382095336914
generate_one_block  0.015158414840698242
generate_one_block  0.014222383499145508
generate_one_block  0.015393733978271484
generate_one_block  0.015423774719238281
generate_one_block  0.01464223861694336
generate_one_block  0.014733076095581055
generate_one_block  0.01627063751220703
generate_one_block  0.015192031860351562
generate_one_block  0.014806270599365234
generate_one_block  0.01541590690612793
generate_one_block  0.015484094619750977
generate_one_block  0.015288591384887695
generate_one_block  0.01473379135131836
generate_one_block  0.015323638916015625
generate_one_block  0.014473438262939453
generate_one_block  0.015196084976196289
generate_one_block  0.014922142028808594
generate_one_block  0.014990568161010742
generate_one_block  0.015263080596923828
generate_one_block  0.015392541885375977
generate_one_block  0.015058279037475586
generate_one_block  0.014739036560058594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04487299919128418
gen group dst list time:  0.023234128952026367
time for parepare:  0.019563913345336914
local_output_nid generation:  0.00409245491027832
local_in_edges_tensor generation:  0.012692689895629883
mini_batch_src_global generation:  0.015326261520385742
r_  generation:  0.15521240234375
local_output_nid generation:  0.008274316787719727
local_in_edges_tensor generation:  0.014327287673950195
mini_batch_src_global generation:  0.020069599151611328
r_  generation:  0.16114115715026855
local_output_nid generation:  0.008225679397583008
local_in_edges_tensor generation:  0.011425495147705078
mini_batch_src_global generation:  0.018647432327270508
r_  generation:  0.16193175315856934
local_output_nid generation:  0.00864410400390625
local_in_edges_tensor generation:  0.011876106262207031
mini_batch_src_global generation:  0.019530534744262695
r_  generation:  0.17115497589111328
local_output_nid generation:  0.008840322494506836
local_in_edges_tensor generation:  0.012131214141845703
mini_batch_src_global generation:  0.023128032684326172
r_  generation:  0.17480111122131348
local_output_nid generation:  0.009046316146850586
local_in_edges_tensor generation:  0.013864994049072266
mini_batch_src_global generation:  0.022203445434570312
r_  generation:  0.17786312103271484
local_output_nid generation:  0.009300470352172852
local_in_edges_tensor generation:  0.012307167053222656
mini_batch_src_global generation:  0.02172565460205078
r_  generation:  0.17421221733093262
local_output_nid generation:  0.008874177932739258
local_in_edges_tensor generation:  0.009357452392578125
mini_batch_src_global generation:  0.021311283111572266
r_  generation:  0.17041730880737305
local_output_nid generation:  0.00890493392944336
local_in_edges_tensor generation:  0.0094146728515625
mini_batch_src_global generation:  0.020963668823242188
r_  generation:  0.17002201080322266
local_output_nid generation:  0.009368896484375
local_in_edges_tensor generation:  0.009800434112548828
mini_batch_src_global generation:  0.023847103118896484
r_  generation:  0.1808030605316162
local_output_nid generation:  0.00934457778930664
local_in_edges_tensor generation:  0.009763717651367188
mini_batch_src_global generation:  0.02268695831298828
r_  generation:  0.1776411533355713
local_output_nid generation:  0.009122133255004883
local_in_edges_tensor generation:  0.009365081787109375
mini_batch_src_global generation:  0.02148151397705078
r_  generation:  0.1721498966217041
local_output_nid generation:  0.009723663330078125
local_in_edges_tensor generation:  0.01261758804321289
mini_batch_src_global generation:  0.022272825241088867
r_  generation:  0.18228650093078613
local_output_nid generation:  0.009763479232788086
local_in_edges_tensor generation:  0.013444662094116211
mini_batch_src_global generation:  0.02452373504638672
r_  generation:  0.18686747550964355
local_output_nid generation:  0.009354114532470703
local_in_edges_tensor generation:  0.009589195251464844
mini_batch_src_global generation:  0.022614717483520508
r_  generation:  0.178175687789917
local_output_nid generation:  0.009445428848266602
local_in_edges_tensor generation:  0.009684085845947266
mini_batch_src_global generation:  0.022312164306640625
r_  generation:  0.17819523811340332
local_output_nid generation:  0.01019597053527832
local_in_edges_tensor generation:  0.013723373413085938
mini_batch_src_global generation:  0.024067401885986328
r_  generation:  0.19229769706726074
local_output_nid generation:  0.009199857711791992
local_in_edges_tensor generation:  0.009554862976074219
mini_batch_src_global generation:  0.022444486618041992
r_  generation:  0.17165136337280273
local_output_nid generation:  0.009263753890991211
local_in_edges_tensor generation:  0.009398460388183594
mini_batch_src_global generation:  0.022071361541748047
r_  generation:  0.1764824390411377
local_output_nid generation:  0.009886026382446289
local_in_edges_tensor generation:  0.012942075729370117
mini_batch_src_global generation:  0.022746801376342773
r_  generation:  0.1810617446899414
local_output_nid generation:  0.009901762008666992
local_in_edges_tensor generation:  0.01150822639465332
mini_batch_src_global generation:  0.02454853057861328
r_  generation:  0.18323612213134766
local_output_nid generation:  0.009885787963867188
local_in_edges_tensor generation:  0.012749671936035156
mini_batch_src_global generation:  0.023134946823120117
r_  generation:  0.18407249450683594
local_output_nid generation:  0.009591102600097656
local_in_edges_tensor generation:  0.010036230087280273
mini_batch_src_global generation:  0.022650957107543945
r_  generation:  0.17559528350830078
local_output_nid generation:  0.009952783584594727
local_in_edges_tensor generation:  0.010104894638061523
mini_batch_src_global generation:  0.022843122482299805
r_  generation:  0.1811351776123047
local_output_nid generation:  0.009448051452636719
local_in_edges_tensor generation:  0.009898900985717773
mini_batch_src_global generation:  0.021894454956054688
r_  generation:  0.17314791679382324
local_output_nid generation:  0.009570598602294922
local_in_edges_tensor generation:  0.011554718017578125
mini_batch_src_global generation:  0.02295398712158203
r_  generation:  0.18413233757019043
local_output_nid generation:  0.009717702865600586
local_in_edges_tensor generation:  0.012470245361328125
mini_batch_src_global generation:  0.02280116081237793
r_  generation:  0.17795729637145996
local_output_nid generation:  0.009855508804321289
local_in_edges_tensor generation:  0.011564254760742188
mini_batch_src_global generation:  0.023700714111328125
r_  generation:  0.18306851387023926
local_output_nid generation:  0.009743213653564453
local_in_edges_tensor generation:  0.011663675308227539
mini_batch_src_global generation:  0.022594928741455078
r_  generation:  0.18282580375671387
local_output_nid generation:  0.009888887405395508
local_in_edges_tensor generation:  0.012755870819091797
mini_batch_src_global generation:  0.022446632385253906
r_  generation:  0.17942380905151367
local_output_nid generation:  0.009536266326904297
local_in_edges_tensor generation:  0.0098114013671875
mini_batch_src_global generation:  0.022034168243408203
r_  generation:  0.17261099815368652
local_output_nid generation:  0.009671211242675781
local_in_edges_tensor generation:  0.009734153747558594
mini_batch_src_global generation:  0.02168107032775879
r_  generation:  0.1759648323059082
----------------------check_connections_block total spend ----------------------------- 8.31548023223877
generate_one_block  0.22538280487060547
generate_one_block  0.21846389770507812
generate_one_block  0.24217438697814941
generate_one_block  0.22883248329162598
generate_one_block  0.22699284553527832
generate_one_block  0.23230409622192383
generate_one_block  0.22848176956176758
generate_one_block  0.21567010879516602
generate_one_block  0.2194221019744873
generate_one_block  0.23226118087768555
generate_one_block  0.23118090629577637
generate_one_block  0.21753549575805664
generate_one_block  0.23813152313232422
generate_one_block  0.2402944564819336
generate_one_block  0.22067952156066895
generate_one_block  0.2544083595275879
generate_one_block  0.2535712718963623
generate_one_block  0.21807479858398438
generate_one_block  0.21823978424072266
generate_one_block  0.24424958229064941
generate_one_block  0.23899602890014648
generate_one_block  0.23282337188720703
generate_one_block  0.22257423400878906
generate_one_block  0.23132896423339844
generate_one_block  0.22176384925842285
generate_one_block  0.23497629165649414
generate_one_block  0.22951316833496094
generate_one_block  0.23954987525939941
generate_one_block  0.2345750331878662
generate_one_block  0.23439693450927734
generate_one_block  0.2225346565246582
generate_one_block  0.22216057777404785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0883328914642334
gen group dst list time:  0.10898470878601074
time for parepare:  0.020114898681640625
local_output_nid generation:  0.02243638038635254
local_in_edges_tensor generation:  0.06115221977233887
mini_batch_src_global generation:  0.046015262603759766
r_  generation:  0.4776582717895508
local_output_nid generation:  0.028524160385131836
local_in_edges_tensor generation:  0.04852914810180664
mini_batch_src_global generation:  0.058393239974975586
r_  generation:  0.48480939865112305
local_output_nid generation:  0.028356552124023438
local_in_edges_tensor generation:  0.039467573165893555
mini_batch_src_global generation:  0.05579805374145508
r_  generation:  0.48744916915893555
local_output_nid generation:  0.027115345001220703
local_in_edges_tensor generation:  0.043807029724121094
mini_batch_src_global generation:  0.05747699737548828
r_  generation:  0.4854393005371094
local_output_nid generation:  0.02733016014099121
local_in_edges_tensor generation:  0.03130817413330078
mini_batch_src_global generation:  0.05837607383728027
r_  generation:  0.4895343780517578
local_output_nid generation:  0.02727508544921875
local_in_edges_tensor generation:  0.035086631774902344
mini_batch_src_global generation:  0.06965136528015137
r_  generation:  0.4940767288208008
local_output_nid generation:  0.027428150177001953
local_in_edges_tensor generation:  0.03935647010803223
mini_batch_src_global generation:  0.05800294876098633
r_  generation:  0.49918699264526367
local_output_nid generation:  0.02837967872619629
local_in_edges_tensor generation:  0.04886054992675781
mini_batch_src_global generation:  0.061772823333740234
r_  generation:  0.49263930320739746
local_output_nid generation:  0.027595996856689453
local_in_edges_tensor generation:  0.0442194938659668
mini_batch_src_global generation:  0.05802202224731445
r_  generation:  0.4945218563079834
local_output_nid generation:  0.027893781661987305
local_in_edges_tensor generation:  0.04025626182556152
mini_batch_src_global generation:  0.0587766170501709
r_  generation:  0.5097765922546387
local_output_nid generation:  0.028206348419189453
local_in_edges_tensor generation:  0.04855227470397949
mini_batch_src_global generation:  0.062116384506225586
r_  generation:  0.5008828639984131
local_output_nid generation:  0.027646541595458984
local_in_edges_tensor generation:  0.033814430236816406
mini_batch_src_global generation:  0.05835914611816406
r_  generation:  0.49512743949890137
local_output_nid generation:  0.028790712356567383
local_in_edges_tensor generation:  0.03417825698852539
mini_batch_src_global generation:  0.058516740798950195
r_  generation:  0.4996793270111084
local_output_nid generation:  0.0289154052734375
local_in_edges_tensor generation:  0.04474616050720215
mini_batch_src_global generation:  0.06275367736816406
r_  generation:  0.49923276901245117
local_output_nid generation:  0.028267860412597656
local_in_edges_tensor generation:  0.031763553619384766
mini_batch_src_global generation:  0.05825161933898926
r_  generation:  0.509021520614624
local_output_nid generation:  0.029510498046875
local_in_edges_tensor generation:  0.03168344497680664
mini_batch_src_global generation:  0.05997276306152344
r_  generation:  0.492950439453125
local_output_nid generation:  0.029100894927978516
local_in_edges_tensor generation:  0.03972792625427246
mini_batch_src_global generation:  0.0590665340423584
r_  generation:  0.5077197551727295
local_output_nid generation:  0.02849602699279785
local_in_edges_tensor generation:  0.03111433982849121
mini_batch_src_global generation:  0.06032514572143555
r_  generation:  0.5000710487365723
local_output_nid generation:  0.02848339080810547
local_in_edges_tensor generation:  0.03482484817504883
mini_batch_src_global generation:  0.058115243911743164
r_  generation:  0.4930858612060547
local_output_nid generation:  0.029092788696289062
local_in_edges_tensor generation:  0.04084348678588867
mini_batch_src_global generation:  0.05837202072143555
r_  generation:  0.4965488910675049
local_output_nid generation:  0.02861642837524414
local_in_edges_tensor generation:  0.03226780891418457
mini_batch_src_global generation:  0.060927391052246094
r_  generation:  0.5033729076385498
local_output_nid generation:  0.029020309448242188
local_in_edges_tensor generation:  0.03518176078796387
mini_batch_src_global generation:  0.059789419174194336
r_  generation:  0.5069551467895508
local_output_nid generation:  0.028701305389404297
local_in_edges_tensor generation:  0.03535771369934082
mini_batch_src_global generation:  0.0592951774597168
r_  generation:  0.497450590133667
local_output_nid generation:  0.02895951271057129
local_in_edges_tensor generation:  0.03614497184753418
mini_batch_src_global generation:  0.0632481575012207
r_  generation:  0.496307373046875
local_output_nid generation:  0.028626441955566406
local_in_edges_tensor generation:  0.035980939865112305
mini_batch_src_global generation:  0.05845022201538086
r_  generation:  0.49933385848999023
local_output_nid generation:  0.029933691024780273
local_in_edges_tensor generation:  0.050536155700683594
mini_batch_src_global generation:  0.060108184814453125
r_  generation:  0.4985661506652832
local_output_nid generation:  0.028729915618896484
local_in_edges_tensor generation:  0.03733062744140625
mini_batch_src_global generation:  0.05911660194396973
r_  generation:  0.5030875205993652
local_output_nid generation:  0.028754472732543945
local_in_edges_tensor generation:  0.03673529624938965
mini_batch_src_global generation:  0.06284308433532715
r_  generation:  0.49837684631347656
local_output_nid generation:  0.028952598571777344
local_in_edges_tensor generation:  0.030257225036621094
mini_batch_src_global generation:  0.07155323028564453
r_  generation:  0.5110089778900146
local_output_nid generation:  0.028748512268066406
local_in_edges_tensor generation:  0.033290863037109375
mini_batch_src_global generation:  0.06792759895324707
r_  generation:  0.4918961524963379
local_output_nid generation:  0.02969503402709961
local_in_edges_tensor generation:  0.037818193435668945
mini_batch_src_global generation:  0.05830264091491699
r_  generation:  0.5002527236938477
local_output_nid generation:  0.028542757034301758
local_in_edges_tensor generation:  0.03183913230895996
mini_batch_src_global generation:  0.059464454650878906
r_  generation:  0.4961826801300049
----------------------check_connections_block total spend ----------------------------- 23.45320773124695
generate_one_block  0.7611973285675049
generate_one_block  0.6423451900482178
generate_one_block  0.6545488834381104
generate_one_block  0.6514010429382324
generate_one_block  0.6793897151947021
generate_one_block  0.6991682052612305
generate_one_block  0.6465737819671631
generate_one_block  0.6593570709228516
generate_one_block  0.6454949378967285
generate_one_block  0.6817259788513184
generate_one_block  0.656369686126709
generate_one_block  0.6413943767547607
generate_one_block  0.650808572769165
generate_one_block  0.6579208374023438
generate_one_block  0.6310327053070068
generate_one_block  0.6438865661621094
generate_one_block  0.6582286357879639
generate_one_block  0.6298251152038574
generate_one_block  0.6424531936645508
generate_one_block  0.6513786315917969
generate_one_block  0.6859462261199951
generate_one_block  0.6754848957061768
generate_one_block  0.667698860168457
generate_one_block  0.6460757255554199
generate_one_block  0.63698410987854
generate_one_block  0.6458349227905273
generate_one_block  0.6622910499572754
generate_one_block  0.6653957366943359
generate_one_block  0.6414146423339844
generate_one_block  0.6537292003631592
generate_one_block  0.6521904468536377
generate_one_block  0.6382753849029541
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  31.768687963485718
block generation total time  28.427366018295288
average batch blocks generation time:  0.8883551880717278
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0886693000793457  GigaBytes
Max Memory Allocated: 0.0886693000793457  GigaBytes

torch.Size([149941, 128])
torch.Size([109622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.38358020782470703  GigaBytes
Max Memory Allocated: 0.39475154876708984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.0893392562866211  GigaBytes
Max Memory Allocated: 0.44059228897094727  GigaBytes

torch.Size([149960, 128])
torch.Size([109280, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.383786678314209  GigaBytes
Max Memory Allocated: 0.44059228897094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.0893087387084961  GigaBytes
Max Memory Allocated: 0.44059228897094727  GigaBytes

torch.Size([150228, 128])
torch.Size([109570, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3837261199951172  GigaBytes
Max Memory Allocated: 0.44059228897094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08949756622314453  GigaBytes
Max Memory Allocated: 0.44059228897094727  GigaBytes

torch.Size([150151, 128])
torch.Size([110073, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38567066192626953  GigaBytes
Max Memory Allocated: 0.44059228897094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.0894613265991211  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

torch.Size([150152, 128])
torch.Size([109278, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38520193099975586  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08962726593017578  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

torch.Size([150394, 128])
torch.Size([110236, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38637781143188477  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08951377868652344  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

torch.Size([150450, 128])
torch.Size([109708, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3859100341796875  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.0892171859741211  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

torch.Size([150277, 128])
torch.Size([108766, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3816208839416504  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08928298950195312  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

torch.Size([149569, 128])
torch.Size([108217, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.37801551818847656  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08960723876953125  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

torch.Size([150001, 128])
torch.Size([110017, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38558292388916016  GigaBytes
Max Memory Allocated: 0.44209766387939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08960819244384766  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([150297, 128])
torch.Size([110041, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.38591575622558594  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08912086486816406  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([149589, 128])
torch.Size([107867, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.3764948844909668  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.08968544006347656  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([150851, 128])
torch.Size([110834, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.3876838684082031  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08974361419677734  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([150788, 128])
torch.Size([110588, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.38696861267089844  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08934593200683594  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([149961, 128])
torch.Size([108212, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.3792557716369629  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.08938312530517578  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([150015, 128])
torch.Size([108905, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.38387298583984375  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.09007835388183594  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

torch.Size([150723, 128])
torch.Size([111996, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.39383792877197266  GigaBytes
Max Memory Allocated: 0.4424877166748047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08924198150634766  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150070, 128])
torch.Size([108962, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38205623626708984  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08932685852050781  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150136, 128])
torch.Size([108983, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3824334144592285  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08966636657714844  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150824, 128])
torch.Size([111006, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3876028060913086  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08972644805908203  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150746, 128])
torch.Size([110514, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3868293762207031  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08963298797607422  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150483, 128])
torch.Size([110477, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3866710662841797  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08942890167236328  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150365, 128])
torch.Size([109913, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38509654998779297  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08959770202636719  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150636, 128])
torch.Size([110498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3867053985595703  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08935260772705078  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150101, 128])
torch.Size([109432, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38381290435791016  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08959770202636719  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150182, 128])
torch.Size([109620, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38565778732299805  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08948707580566406  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150504, 128])
torch.Size([110108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.385678768157959  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08954811096191406  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150301, 128])
torch.Size([110346, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38590240478515625  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08956623077392578  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150056, 128])
torch.Size([109346, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3856663703918457  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08957481384277344  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149976, 128])
torch.Size([109745, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38580989837646484  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08940601348876953  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150788, 128])
torch.Size([110348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3839244842529297  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08935737609863281  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149994, 128])
torch.Size([109011, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3838210105895996  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03627214580774307 |0.027553103864192963 |0.026489362120628357 |9.242445230484009e-05 |0.0049510374665260315 |0.0038192272186279297 |
----------------------------------------------------------pseudo_mini_loss sum 5.652646541595459
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9159045
Number of first layer input nodes during this epoch:  4808509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.11117696762084961  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021535158157348633
range selection method range initialization spend 0.015188932418823242
time for parepare:  0.0172421932220459
local_output_nid generation:  0.0007472038269042969
local_in_edges_tensor generation:  0.003700733184814453
mini_batch_src_global generation:  0.002038717269897461
r_  generation:  0.011020660400390625
local_output_nid generation:  0.0008482933044433594
local_in_edges_tensor generation:  0.0005998611450195312
mini_batch_src_global generation:  0.0015163421630859375
r_  generation:  0.009920597076416016
local_output_nid generation:  0.0008101463317871094
local_in_edges_tensor generation:  0.0005183219909667969
mini_batch_src_global generation:  0.0009737014770507812
r_  generation:  0.009390115737915039
local_output_nid generation:  0.0008168220520019531
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0009517669677734375
r_  generation:  0.012307882308959961
local_output_nid generation:  0.0007789134979248047
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0009603500366210938
r_  generation:  0.009693145751953125
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.000997304916381836
r_  generation:  0.009985685348510742
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0009922981262207031
r_  generation:  0.009829521179199219
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0009634494781494141
r_  generation:  0.009931325912475586
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0009684562683105469
r_  generation:  0.0099945068359375
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.00047087669372558594
mini_batch_src_global generation:  0.0009424686431884766
r_  generation:  0.009635686874389648
local_output_nid generation:  0.0007717609405517578
local_in_edges_tensor generation:  0.00048351287841796875
mini_batch_src_global generation:  0.0009739398956298828
r_  generation:  0.009800195693969727
local_output_nid generation:  0.0007753372192382812
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.00996088981628418
local_output_nid generation:  0.0007658004760742188
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.00960850715637207
local_output_nid generation:  0.0007774829864501953
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.010024547576904297
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.01009225845336914
local_output_nid generation:  0.0007693767547607422
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.009892702102661133
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.01016092300415039
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.010325431823730469
local_output_nid generation:  0.0007822513580322266
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.011762142181396484
local_output_nid generation:  0.0007894039154052734
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.0010619163513183594
r_  generation:  0.010251522064208984
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.010002613067626953
local_output_nid generation:  0.0007843971252441406
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.010481119155883789
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.009816884994506836
local_output_nid generation:  0.00077056884765625
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.010516881942749023
local_output_nid generation:  0.0008234977722167969
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.010501623153686523
local_output_nid generation:  0.0007765293121337891
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010464191436767578
r_  generation:  0.012317657470703125
local_output_nid generation:  0.00077056884765625
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.010289907455444336
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.010510444641113281
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.010552644729614258
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0010840892791748047
r_  generation:  0.010189294815063477
local_output_nid generation:  0.0007958412170410156
local_in_edges_tensor generation:  0.0004642009735107422
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.010051727294921875
local_output_nid generation:  0.0007801055908203125
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0010051727294921875
r_  generation:  0.010299444198608398
----------------------check_connections_block total spend ----------------------------- 0.5008728504180908
generate_one_block  0.021254301071166992
generate_one_block  0.016877174377441406
generate_one_block  0.014516353607177734
generate_one_block  0.014765262603759766
generate_one_block  0.01492762565612793
generate_one_block  0.015062093734741211
generate_one_block  0.014809370040893555
generate_one_block  0.017441272735595703
generate_one_block  0.01524806022644043
generate_one_block  0.014292478561401367
generate_one_block  0.014820098876953125
generate_one_block  0.015147686004638672
generate_one_block  0.014627456665039062
generate_one_block  0.016645431518554688
generate_one_block  0.014939308166503906
generate_one_block  0.014904022216796875
generate_one_block  0.015459775924682617
generate_one_block  0.01553201675415039
generate_one_block  0.014743566513061523
generate_one_block  0.015488624572753906
generate_one_block  0.01886725425720215
generate_one_block  0.016492843627929688
generate_one_block  0.014801740646362305
generate_one_block  0.015444517135620117
generate_one_block  0.016091346740722656
generate_one_block  0.014961004257202148
generate_one_block  0.015542030334472656
generate_one_block  0.019847393035888672
generate_one_block  0.016192913055419922
generate_one_block  0.014838695526123047
generate_one_block  0.014772415161132812
generate_one_block  0.015103340148925781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06299209594726562
gen group dst list time:  0.026852846145629883
time for parepare:  0.019013643264770508
local_output_nid generation:  0.004122257232666016
local_in_edges_tensor generation:  0.029396772384643555
mini_batch_src_global generation:  0.015255212783813477
r_  generation:  0.1496601104736328
local_output_nid generation:  0.006670713424682617
local_in_edges_tensor generation:  0.013880491256713867
mini_batch_src_global generation:  0.023523569107055664
r_  generation:  0.1642770767211914
local_output_nid generation:  0.0066683292388916016
local_in_edges_tensor generation:  0.031033992767333984
mini_batch_src_global generation:  0.020525693893432617
r_  generation:  0.17226767539978027
local_output_nid generation:  0.007364988327026367
local_in_edges_tensor generation:  0.00993967056274414
mini_batch_src_global generation:  0.02134108543395996
r_  generation:  0.17287826538085938
local_output_nid generation:  0.007506132125854492
local_in_edges_tensor generation:  0.013440608978271484
mini_batch_src_global generation:  0.02134561538696289
r_  generation:  0.18302345275878906
local_output_nid generation:  0.007632255554199219
local_in_edges_tensor generation:  0.010223627090454102
mini_batch_src_global generation:  0.022116899490356445
r_  generation:  0.1782989501953125
local_output_nid generation:  0.007356882095336914
local_in_edges_tensor generation:  0.010344505310058594
mini_batch_src_global generation:  0.02216935157775879
r_  generation:  0.18828439712524414
local_output_nid generation:  0.007273197174072266
local_in_edges_tensor generation:  0.01044011116027832
mini_batch_src_global generation:  0.022101163864135742
r_  generation:  0.1784358024597168
local_output_nid generation:  0.0075871944427490234
local_in_edges_tensor generation:  0.012121915817260742
mini_batch_src_global generation:  0.022281885147094727
r_  generation:  0.1837775707244873
local_output_nid generation:  0.007551431655883789
local_in_edges_tensor generation:  0.00868368148803711
mini_batch_src_global generation:  0.021409034729003906
r_  generation:  0.17319178581237793
local_output_nid generation:  0.007864952087402344
local_in_edges_tensor generation:  0.00880885124206543
mini_batch_src_global generation:  0.023537158966064453
r_  generation:  0.18219280242919922
local_output_nid generation:  0.00797891616821289
local_in_edges_tensor generation:  0.011932611465454102
mini_batch_src_global generation:  0.023833274841308594
r_  generation:  0.1852257251739502
local_output_nid generation:  0.007812976837158203
local_in_edges_tensor generation:  0.009093284606933594
mini_batch_src_global generation:  0.022274017333984375
r_  generation:  0.18070197105407715
local_output_nid generation:  0.008036613464355469
local_in_edges_tensor generation:  0.012212514877319336
mini_batch_src_global generation:  0.024124860763549805
r_  generation:  0.18045568466186523
local_output_nid generation:  0.010637521743774414
local_in_edges_tensor generation:  0.015023946762084961
mini_batch_src_global generation:  0.026416301727294922
r_  generation:  0.18241333961486816
local_output_nid generation:  0.008551597595214844
local_in_edges_tensor generation:  0.011752843856811523
mini_batch_src_global generation:  0.02392268180847168
r_  generation:  0.18091154098510742
local_output_nid generation:  0.008510828018188477
local_in_edges_tensor generation:  0.009659528732299805
mini_batch_src_global generation:  0.02447366714477539
r_  generation:  0.1871194839477539
local_output_nid generation:  0.008392095565795898
local_in_edges_tensor generation:  0.010666131973266602
mini_batch_src_global generation:  0.02338862419128418
r_  generation:  0.17900419235229492
local_output_nid generation:  0.008255243301391602
local_in_edges_tensor generation:  0.009299993515014648
mini_batch_src_global generation:  0.022683143615722656
r_  generation:  0.18016552925109863
local_output_nid generation:  0.008165121078491211
local_in_edges_tensor generation:  0.009340524673461914
mini_batch_src_global generation:  0.035692691802978516
r_  generation:  0.18321442604064941
local_output_nid generation:  0.007986068725585938
local_in_edges_tensor generation:  0.016405582427978516
mini_batch_src_global generation:  0.022819995880126953
r_  generation:  0.1833178997039795
local_output_nid generation:  0.008202075958251953
local_in_edges_tensor generation:  0.014076471328735352
mini_batch_src_global generation:  0.02475595474243164
r_  generation:  0.18782711029052734
local_output_nid generation:  0.007761955261230469
local_in_edges_tensor generation:  0.00937509536743164
mini_batch_src_global generation:  0.02257061004638672
r_  generation:  0.17890667915344238
local_output_nid generation:  0.008021354675292969
local_in_edges_tensor generation:  0.009321212768554688
mini_batch_src_global generation:  0.030284643173217773
r_  generation:  0.1834878921508789
local_output_nid generation:  0.008188486099243164
local_in_edges_tensor generation:  0.012563228607177734
mini_batch_src_global generation:  0.0233762264251709
r_  generation:  0.19102001190185547
local_output_nid generation:  0.008744239807128906
local_in_edges_tensor generation:  0.024948835372924805
mini_batch_src_global generation:  0.0242464542388916
r_  generation:  0.17961907386779785
local_output_nid generation:  0.010713338851928711
local_in_edges_tensor generation:  0.013809919357299805
mini_batch_src_global generation:  0.02734208106994629
r_  generation:  0.1885521411895752
local_output_nid generation:  0.007891654968261719
local_in_edges_tensor generation:  0.01092219352722168
mini_batch_src_global generation:  0.022565603256225586
r_  generation:  0.18373632431030273
local_output_nid generation:  0.010078191757202148
local_in_edges_tensor generation:  0.01107478141784668
mini_batch_src_global generation:  0.02482128143310547
r_  generation:  0.19069933891296387
local_output_nid generation:  0.008002042770385742
local_in_edges_tensor generation:  0.01050877571105957
mini_batch_src_global generation:  0.023067712783813477
r_  generation:  0.18186497688293457
local_output_nid generation:  0.007883310317993164
local_in_edges_tensor generation:  0.008768081665039062
mini_batch_src_global generation:  0.02283191680908203
r_  generation:  0.17965078353881836
local_output_nid generation:  0.007963180541992188
local_in_edges_tensor generation:  0.009309053421020508
mini_batch_src_global generation:  0.022728919982910156
r_  generation:  0.1816093921661377
----------------------check_connections_block total spend ----------------------------- 8.525305271148682
generate_one_block  0.2194821834564209
generate_one_block  0.21801376342773438
generate_one_block  0.2238142490386963
generate_one_block  0.22879624366760254
generate_one_block  0.2467663288116455
generate_one_block  0.2325458526611328
generate_one_block  0.23095417022705078
generate_one_block  0.22396421432495117
generate_one_block  0.23322486877441406
generate_one_block  0.21230149269104004
generate_one_block  0.22337579727172852
generate_one_block  0.2307746410369873
generate_one_block  0.21738672256469727
generate_one_block  0.2313399314880371
generate_one_block  0.2221682071685791
generate_one_block  0.228013277053833
generate_one_block  0.24379944801330566
generate_one_block  0.2263340950012207
generate_one_block  0.22118926048278809
generate_one_block  0.26314520835876465
generate_one_block  0.22890448570251465
generate_one_block  0.23578548431396484
generate_one_block  0.2183990478515625
generate_one_block  0.22949695587158203
generate_one_block  0.24037957191467285
generate_one_block  0.22389912605285645
generate_one_block  0.23645973205566406
generate_one_block  0.23203229904174805
generate_one_block  0.24090957641601562
generate_one_block  0.23128175735473633
generate_one_block  0.2217247486114502
generate_one_block  0.2297658920288086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0811159610748291
gen group dst list time:  0.11389732360839844
time for parepare:  0.017760515213012695
local_output_nid generation:  0.022631406784057617
local_in_edges_tensor generation:  0.05169200897216797
mini_batch_src_global generation:  0.049318552017211914
r_  generation:  0.4821310043334961
local_output_nid generation:  0.02890944480895996
local_in_edges_tensor generation:  0.047814369201660156
mini_batch_src_global generation:  0.05796694755554199
r_  generation:  0.482546329498291
local_output_nid generation:  0.028496265411376953
local_in_edges_tensor generation:  0.03916168212890625
mini_batch_src_global generation:  0.05663752555847168
r_  generation:  0.4908590316772461
local_output_nid generation:  0.02740311622619629
local_in_edges_tensor generation:  0.043564796447753906
mini_batch_src_global generation:  0.05743694305419922
r_  generation:  0.4971156120300293
local_output_nid generation:  0.02800774574279785
local_in_edges_tensor generation:  0.035649776458740234
mini_batch_src_global generation:  0.05871868133544922
r_  generation:  0.49823641777038574
local_output_nid generation:  0.027914762496948242
local_in_edges_tensor generation:  0.03490757942199707
mini_batch_src_global generation:  0.05902576446533203
r_  generation:  0.49483799934387207
local_output_nid generation:  0.027599096298217773
local_in_edges_tensor generation:  0.03393888473510742
mini_batch_src_global generation:  0.05770611763000488
r_  generation:  0.4951040744781494
local_output_nid generation:  0.02770400047302246
local_in_edges_tensor generation:  0.031198978424072266
mini_batch_src_global generation:  0.06282973289489746
r_  generation:  0.4907996654510498
local_output_nid generation:  0.027767658233642578
local_in_edges_tensor generation:  0.03524613380432129
mini_batch_src_global generation:  0.06230497360229492
r_  generation:  0.49314236640930176
local_output_nid generation:  0.02759861946105957
local_in_edges_tensor generation:  0.031147241592407227
mini_batch_src_global generation:  0.05958747863769531
r_  generation:  0.49003148078918457
local_output_nid generation:  0.02789139747619629
local_in_edges_tensor generation:  0.03053569793701172
mini_batch_src_global generation:  0.061920166015625
r_  generation:  0.499666690826416
local_output_nid generation:  0.02801656723022461
local_in_edges_tensor generation:  0.04939103126525879
mini_batch_src_global generation:  0.05928659439086914
r_  generation:  0.4934501647949219
local_output_nid generation:  0.027875185012817383
local_in_edges_tensor generation:  0.030939340591430664
mini_batch_src_global generation:  0.0585629940032959
r_  generation:  0.4973580837249756
local_output_nid generation:  0.02814793586730957
local_in_edges_tensor generation:  0.030940532684326172
mini_batch_src_global generation:  0.058587074279785156
r_  generation:  0.49562716484069824
local_output_nid generation:  0.02809619903564453
local_in_edges_tensor generation:  0.04446220397949219
mini_batch_src_global generation:  0.05794548988342285
r_  generation:  0.4986610412597656
local_output_nid generation:  0.028305530548095703
local_in_edges_tensor generation:  0.03490304946899414
mini_batch_src_global generation:  0.0627596378326416
r_  generation:  0.49796628952026367
local_output_nid generation:  0.02831435203552246
local_in_edges_tensor generation:  0.0406346321105957
mini_batch_src_global generation:  0.058074235916137695
r_  generation:  0.5016024112701416
local_output_nid generation:  0.02797985076904297
local_in_edges_tensor generation:  0.030813217163085938
mini_batch_src_global generation:  0.06127762794494629
r_  generation:  0.493499755859375
local_output_nid generation:  0.028220176696777344
local_in_edges_tensor generation:  0.039963483810424805
mini_batch_src_global generation:  0.061777591705322266
r_  generation:  0.4991326332092285
local_output_nid generation:  0.02819538116455078
local_in_edges_tensor generation:  0.04935026168823242
mini_batch_src_global generation:  0.05894351005554199
r_  generation:  0.504194974899292
local_output_nid generation:  0.028259992599487305
local_in_edges_tensor generation:  0.0353548526763916
mini_batch_src_global generation:  0.05860710144042969
r_  generation:  0.49992966651916504
local_output_nid generation:  0.02810359001159668
local_in_edges_tensor generation:  0.040168046951293945
mini_batch_src_global generation:  0.059372901916503906
r_  generation:  0.5035350322723389
local_output_nid generation:  0.028075218200683594
local_in_edges_tensor generation:  0.03837013244628906
mini_batch_src_global generation:  0.059166669845581055
r_  generation:  0.4926750659942627
local_output_nid generation:  0.028530359268188477
local_in_edges_tensor generation:  0.04017329216003418
mini_batch_src_global generation:  0.05886125564575195
r_  generation:  0.5008916854858398
local_output_nid generation:  0.02845907211303711
local_in_edges_tensor generation:  0.039429664611816406
mini_batch_src_global generation:  0.05789899826049805
r_  generation:  0.49818992614746094
local_output_nid generation:  0.028384685516357422
local_in_edges_tensor generation:  0.035162925720214844
mini_batch_src_global generation:  0.05930948257446289
r_  generation:  0.49773478507995605
local_output_nid generation:  0.029288291931152344
local_in_edges_tensor generation:  0.040474891662597656
mini_batch_src_global generation:  0.06301474571228027
r_  generation:  0.5021305084228516
local_output_nid generation:  0.028144121170043945
local_in_edges_tensor generation:  0.030841827392578125
mini_batch_src_global generation:  0.060038089752197266
r_  generation:  0.4988133907318115
local_output_nid generation:  0.028280019760131836
local_in_edges_tensor generation:  0.030587434768676758
mini_batch_src_global generation:  0.0627288818359375
r_  generation:  0.5151045322418213
local_output_nid generation:  0.0287933349609375
local_in_edges_tensor generation:  0.04259514808654785
mini_batch_src_global generation:  0.07509183883666992
r_  generation:  0.49755144119262695
local_output_nid generation:  0.031040430068969727
local_in_edges_tensor generation:  0.0373835563659668
mini_batch_src_global generation:  0.06037187576293945
r_  generation:  0.49850940704345703
local_output_nid generation:  0.028803348541259766
local_in_edges_tensor generation:  0.039658546447753906
mini_batch_src_global generation:  0.059099435806274414
r_  generation:  0.497175931930542
----------------------check_connections_block total spend ----------------------------- 23.372024297714233
generate_one_block  0.6418876647949219
generate_one_block  0.6374855041503906
generate_one_block  0.6421527862548828
generate_one_block  0.6378562450408936
generate_one_block  0.7649595737457275
generate_one_block  0.6511275768280029
generate_one_block  0.6411092281341553
generate_one_block  0.6486544609069824
generate_one_block  0.6506476402282715
generate_one_block  0.6324546337127686
generate_one_block  0.645275354385376
generate_one_block  0.7030434608459473
generate_one_block  0.6579952239990234
generate_one_block  0.6698756217956543
generate_one_block  0.6696779727935791
generate_one_block  0.7114450931549072
generate_one_block  0.7098135948181152
generate_one_block  0.6568024158477783
generate_one_block  0.6686310768127441
generate_one_block  0.6822285652160645
generate_one_block  0.6542026996612549
generate_one_block  0.6834163665771484
generate_one_block  0.6477751731872559
generate_one_block  0.6474721431732178
generate_one_block  0.6776940822601318
generate_one_block  0.6460304260253906
generate_one_block  0.668257474899292
generate_one_block  0.6579382419586182
generate_one_block  0.66123366355896
generate_one_block  0.6547031402587891
generate_one_block  0.6532018184661865
generate_one_block  0.6528825759887695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.11117696762084961  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

connection checking time:  31.897329568862915
block generation total time  28.574360132217407
average batch blocks generation time:  0.892948754131794
block dataloader generation time/epoch 63.188467502593994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0897364616394043  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150330, 128])
torch.Size([109060, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3828554153442383  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0898904800415039  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150048, 128])
torch.Size([109009, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3843207359313965  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08994197845458984  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150121, 128])
torch.Size([109019, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38442182540893555  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08997726440429688  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150274, 128])
torch.Size([109143, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3853940963745117  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09016990661621094  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150197, 128])
torch.Size([110003, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38643741607666016  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09014034271240234  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150297, 128])
torch.Size([109992, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38608217239379883  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09006500244140625  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149700, 128])
torch.Size([108933, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3858919143676758  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09003925323486328  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150094, 128])
torch.Size([109541, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.385500431060791  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09015369415283203  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149700, 128])
torch.Size([109415, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38645172119140625  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08978557586669922  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149758, 128])
torch.Size([108456, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3784646987915039  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09002304077148438  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150084, 128])
torch.Size([109209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3845858573913574  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09011650085449219  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150215, 128])
torch.Size([109933, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38591432571411133  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0899038314819336  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149529, 128])
torch.Size([108631, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38434314727783203  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09000492095947266  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150306, 128])
torch.Size([109579, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3858218193054199  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08996295928955078  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150215, 128])
torch.Size([109831, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3859281539916992  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09012603759765625  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150659, 128])
torch.Size([110421, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38601016998291016  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09024238586425781  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150399, 128])
torch.Size([110686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38751697540283203  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09000682830810547  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150134, 128])
torch.Size([109364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38608694076538086  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08998298645019531  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150510, 128])
torch.Size([110091, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3859095573425293  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09019947052001953  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150698, 128])
torch.Size([111127, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3880043029785156  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0900726318359375  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150317, 128])
torch.Size([110014, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3861961364746094  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09029388427734375  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150718, 128])
torch.Size([111302, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3891258239746094  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08988094329833984  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150168, 128])
torch.Size([108875, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38429927825927734  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09016895294189453  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150217, 128])
torch.Size([110201, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38668012619018555  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09022331237792969  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150053, 128])
torch.Size([110013, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38782739639282227  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09006404876708984  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150049, 128])
torch.Size([109912, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3856229782104492  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09026622772216797  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150127, 128])
torch.Size([110507, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38761425018310547  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09001922607421875  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150110, 128])
torch.Size([109566, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3855299949645996  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09024238586425781  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149865, 128])
torch.Size([109643, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38674116134643555  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.09007072448730469  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150519, 128])
torch.Size([109840, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38585376739501953  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.08998489379882812  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([150253, 128])
torch.Size([109817, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.38451242446899414  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.0901031494140625  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

torch.Size([149807, 128])
torch.Size([109609, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.3859724998474121  GigaBytes
Max Memory Allocated: 0.44766950607299805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031100183725357056 |0.016428068280220032 |0.0034201592206954956 |8.943676948547363e-05 |0.0030082836747169495 |0.0018694400787353516 |
----------------------------------------------------------pseudo_mini_loss sum 3.5889601707458496
Total (block generation + training)time/epoch 64.970468044281
Training time/epoch 1.7817225456237793
Training time without block to device /epoch 1.2560243606567383
Training time without total dataloading part /epoch 0.21044158935546875
load block tensor time/epoch 0.9952058792114258
block to device time/epoch 0.525698184967041
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9155241
Number of first layer input nodes during this epoch:  4805471
