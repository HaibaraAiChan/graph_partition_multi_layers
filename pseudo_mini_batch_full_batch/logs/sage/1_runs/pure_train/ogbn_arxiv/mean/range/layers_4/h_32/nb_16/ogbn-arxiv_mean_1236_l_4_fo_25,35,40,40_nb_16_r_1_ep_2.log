Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648481474.7262263
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024652719497680664
range selection method range initialization spend 0.013652563095092773
time for parepare:  0.01830601692199707
local_output_nid generation:  0.001336812973022461
local_in_edges_tensor generation:  0.0037670135498046875
mini_batch_src_global generation:  0.001817941665649414
r_  generation:  0.01859426498413086
local_output_nid generation:  0.0014276504516601562
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.002196788787841797
r_  generation:  0.01779770851135254
local_output_nid generation:  0.0015358924865722656
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.018177509307861328
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0012869834899902344
r_  generation:  0.018117666244506836
local_output_nid generation:  0.0015723705291748047
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.01794600486755371
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008728504180908203
mini_batch_src_global generation:  0.0013108253479003906
r_  generation:  0.018477916717529297
local_output_nid generation:  0.0015616416931152344
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0014798641204833984
r_  generation:  0.018810510635375977
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.001434326171875
r_  generation:  0.018404722213745117
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0008070468902587891
mini_batch_src_global generation:  0.0014927387237548828
r_  generation:  0.01899242401123047
local_output_nid generation:  0.0015137195587158203
local_in_edges_tensor generation:  0.00087738037109375
mini_batch_src_global generation:  0.0014791488647460938
r_  generation:  0.018764019012451172
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.001523733139038086
r_  generation:  0.019046545028686523
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.001495361328125
r_  generation:  0.01902294158935547
local_output_nid generation:  0.001531362533569336
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0015764236450195312
r_  generation:  0.019452810287475586
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.01876044273376465
local_output_nid generation:  0.0015079975128173828
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0014429092407226562
r_  generation:  0.018642902374267578
local_output_nid generation:  0.0014951229095458984
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.018729686737060547
----------------------check_connections_block total spend ----------------------------- 0.44918394088745117
generate_one_block  0.02783370018005371
generate_one_block  0.027483463287353516
generate_one_block  0.029909610748291016
generate_one_block  0.027962684631347656
generate_one_block  0.02708268165588379
generate_one_block  0.02771615982055664
generate_one_block  0.027998685836791992
generate_one_block  0.0278012752532959
generate_one_block  0.027784109115600586
generate_one_block  0.027681589126586914
generate_one_block  0.02780008316040039
generate_one_block  0.027775049209594727
generate_one_block  0.027981281280517578
generate_one_block  0.02715921401977539
generate_one_block  0.027100324630737305
generate_one_block  0.027390480041503906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.042108774185180664
gen group dst list time:  0.018673419952392578
time for parepare:  0.01930379867553711
local_output_nid generation:  0.006592273712158203
local_in_edges_tensor generation:  0.015875577926635742
mini_batch_src_global generation:  0.02007126808166504
r_  generation:  0.2011396884918213
local_output_nid generation:  0.010087966918945312
local_in_edges_tensor generation:  0.018178224563598633
mini_batch_src_global generation:  0.024587631225585938
r_  generation:  0.20301556587219238
local_output_nid generation:  0.0104217529296875
local_in_edges_tensor generation:  0.015244722366333008
mini_batch_src_global generation:  0.024775981903076172
r_  generation:  0.21295976638793945
local_output_nid generation:  0.010722160339355469
local_in_edges_tensor generation:  0.013376235961914062
mini_batch_src_global generation:  0.025341510772705078
r_  generation:  0.20825934410095215
local_output_nid generation:  0.010827779769897461
local_in_edges_tensor generation:  0.013423919677734375
mini_batch_src_global generation:  0.02569723129272461
r_  generation:  0.21126699447631836
local_output_nid generation:  0.010851860046386719
local_in_edges_tensor generation:  0.015079021453857422
mini_batch_src_global generation:  0.03997659683227539
r_  generation:  0.2144632339477539
local_output_nid generation:  0.01113438606262207
local_in_edges_tensor generation:  0.013433456420898438
mini_batch_src_global generation:  0.027201175689697266
r_  generation:  0.2156381607055664
local_output_nid generation:  0.011136531829833984
local_in_edges_tensor generation:  0.017393112182617188
mini_batch_src_global generation:  0.027838706970214844
r_  generation:  0.21437931060791016
local_output_nid generation:  0.011201143264770508
local_in_edges_tensor generation:  0.012317895889282227
mini_batch_src_global generation:  0.027822017669677734
r_  generation:  0.21921753883361816
local_output_nid generation:  0.011388063430786133
local_in_edges_tensor generation:  0.01383829116821289
mini_batch_src_global generation:  0.0278170108795166
r_  generation:  0.2156829833984375
local_output_nid generation:  0.01129603385925293
local_in_edges_tensor generation:  0.0156707763671875
mini_batch_src_global generation:  0.029289722442626953
r_  generation:  0.2191472053527832
local_output_nid generation:  0.011253595352172852
local_in_edges_tensor generation:  0.012176752090454102
mini_batch_src_global generation:  0.027681350708007812
r_  generation:  0.21985769271850586
local_output_nid generation:  0.011401653289794922
local_in_edges_tensor generation:  0.015644311904907227
mini_batch_src_global generation:  0.027744054794311523
r_  generation:  0.22136592864990234
local_output_nid generation:  0.011278629302978516
local_in_edges_tensor generation:  0.011749029159545898
mini_batch_src_global generation:  0.02767634391784668
r_  generation:  0.21285271644592285
local_output_nid generation:  0.011373281478881836
local_in_edges_tensor generation:  0.014001607894897461
mini_batch_src_global generation:  0.027202129364013672
r_  generation:  0.21484732627868652
local_output_nid generation:  0.011387825012207031
local_in_edges_tensor generation:  0.015401840209960938
mini_batch_src_global generation:  0.02778172492980957
r_  generation:  0.21805691719055176
----------------------check_connections_block total spend ----------------------------- 5.03985333442688
generate_one_block  0.28504133224487305
generate_one_block  0.27946901321411133
generate_one_block  0.2915034294128418
generate_one_block  0.2792031764984131
generate_one_block  0.29094576835632324
generate_one_block  0.274341344833374
generate_one_block  0.282520055770874
generate_one_block  0.283355712890625
generate_one_block  0.2840578556060791
generate_one_block  0.2893991470336914
generate_one_block  0.2849438190460205
generate_one_block  0.2788400650024414
generate_one_block  0.2917194366455078
generate_one_block  0.27443814277648926
generate_one_block  0.28025102615356445
generate_one_block  0.2826962471008301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037200212478637695
gen group dst list time:  0.05960893630981445
time for parepare:  0.018871068954467773
local_output_nid generation:  0.023348093032836914
local_in_edges_tensor generation:  0.04195356369018555
mini_batch_src_global generation:  0.048729658126831055
r_  generation:  0.47434329986572266
local_output_nid generation:  0.02959132194519043
local_in_edges_tensor generation:  0.04773521423339844
mini_batch_src_global generation:  0.0592350959777832
r_  generation:  0.48705244064331055
local_output_nid generation:  0.03026723861694336
local_in_edges_tensor generation:  0.03989863395690918
mini_batch_src_global generation:  0.06039738655090332
r_  generation:  0.5001702308654785
local_output_nid generation:  0.030245542526245117
local_in_edges_tensor generation:  0.052916765213012695
mini_batch_src_global generation:  0.06584715843200684
r_  generation:  0.48789119720458984
local_output_nid generation:  0.03000926971435547
local_in_edges_tensor generation:  0.03670692443847656
mini_batch_src_global generation:  0.05744123458862305
r_  generation:  0.5307729244232178
local_output_nid generation:  0.03035140037536621
local_in_edges_tensor generation:  0.038576364517211914
mini_batch_src_global generation:  0.05848240852355957
r_  generation:  0.5180244445800781
local_output_nid generation:  0.03260660171508789
local_in_edges_tensor generation:  0.0382232666015625
mini_batch_src_global generation:  0.05815911293029785
r_  generation:  0.49483561515808105
local_output_nid generation:  0.031219959259033203
local_in_edges_tensor generation:  0.033612728118896484
mini_batch_src_global generation:  0.058533430099487305
r_  generation:  0.4945065975189209
local_output_nid generation:  0.0311739444732666
local_in_edges_tensor generation:  0.033165931701660156
mini_batch_src_global generation:  0.057531118392944336
r_  generation:  0.496584415435791
local_output_nid generation:  0.03171253204345703
local_in_edges_tensor generation:  0.038774967193603516
mini_batch_src_global generation:  0.05811738967895508
r_  generation:  0.4892137050628662
local_output_nid generation:  0.031201839447021484
local_in_edges_tensor generation:  0.03402209281921387
mini_batch_src_global generation:  0.05764293670654297
r_  generation:  0.5007584095001221
local_output_nid generation:  0.03164553642272949
local_in_edges_tensor generation:  0.03318357467651367
mini_batch_src_global generation:  0.05859947204589844
r_  generation:  0.4909818172454834
local_output_nid generation:  0.03156089782714844
local_in_edges_tensor generation:  0.04290032386779785
mini_batch_src_global generation:  0.060520172119140625
r_  generation:  0.49814939498901367
local_output_nid generation:  0.03162050247192383
local_in_edges_tensor generation:  0.029987812042236328
mini_batch_src_global generation:  0.060064077377319336
r_  generation:  0.49500250816345215
local_output_nid generation:  0.03130841255187988
local_in_edges_tensor generation:  0.02940654754638672
mini_batch_src_global generation:  0.05834507942199707
r_  generation:  0.4997258186340332
local_output_nid generation:  0.031514644622802734
local_in_edges_tensor generation:  0.03363299369812012
mini_batch_src_global generation:  0.061562299728393555
r_  generation:  0.4903745651245117
----------------------check_connections_block total spend ----------------------------- 11.685414791107178
generate_one_block  0.639256477355957
generate_one_block  0.6460349559783936
generate_one_block  0.6775920391082764
generate_one_block  0.687962532043457
generate_one_block  0.672588586807251
generate_one_block  0.6329472064971924
generate_one_block  0.7127509117126465
generate_one_block  0.6417849063873291
generate_one_block  0.6522526741027832
generate_one_block  0.6302201747894287
generate_one_block  0.6328659057617188
generate_one_block  0.6388447284698486
generate_one_block  0.6529569625854492
generate_one_block  0.6246547698974609
generate_one_block  0.6265192031860352
generate_one_block  0.627213716506958
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04849743843078613
gen group dst list time:  0.10347580909729004
time for parepare:  0.019709110260009766
local_output_nid generation:  0.03251791000366211
local_in_edges_tensor generation:  0.05379796028137207
mini_batch_src_global generation:  0.04723000526428223
r_  generation:  0.4918217658996582
local_output_nid generation:  0.03768610954284668
local_in_edges_tensor generation:  0.043674468994140625
mini_batch_src_global generation:  0.05780649185180664
r_  generation:  0.5017187595367432
local_output_nid generation:  0.03678107261657715
local_in_edges_tensor generation:  0.033364295959472656
mini_batch_src_global generation:  0.05981183052062988
r_  generation:  0.5058755874633789
local_output_nid generation:  0.03741717338562012
local_in_edges_tensor generation:  0.040622711181640625
mini_batch_src_global generation:  0.05794572830200195
r_  generation:  0.5096123218536377
local_output_nid generation:  0.038758277893066406
local_in_edges_tensor generation:  0.04491853713989258
mini_batch_src_global generation:  0.058150291442871094
r_  generation:  0.5274949073791504
local_output_nid generation:  0.04095315933227539
local_in_edges_tensor generation:  0.05151653289794922
mini_batch_src_global generation:  0.06090092658996582
r_  generation:  0.5122301578521729
local_output_nid generation:  0.03865313529968262
local_in_edges_tensor generation:  0.04008293151855469
mini_batch_src_global generation:  0.05991530418395996
r_  generation:  0.5171470642089844
local_output_nid generation:  0.03856778144836426
local_in_edges_tensor generation:  0.03776216506958008
mini_batch_src_global generation:  0.05775952339172363
r_  generation:  0.5165574550628662
local_output_nid generation:  0.038700103759765625
local_in_edges_tensor generation:  0.037352800369262695
mini_batch_src_global generation:  0.06034684181213379
r_  generation:  0.5221028327941895
local_output_nid generation:  0.03892087936401367
local_in_edges_tensor generation:  0.033976078033447266
mini_batch_src_global generation:  0.05810093879699707
r_  generation:  0.5197396278381348
local_output_nid generation:  0.03864455223083496
local_in_edges_tensor generation:  0.04182934761047363
mini_batch_src_global generation:  0.05781245231628418
r_  generation:  0.522559642791748
local_output_nid generation:  0.03889608383178711
local_in_edges_tensor generation:  0.038022756576538086
mini_batch_src_global generation:  0.05821990966796875
r_  generation:  0.5298464298248291
local_output_nid generation:  0.038782358169555664
local_in_edges_tensor generation:  0.04689168930053711
mini_batch_src_global generation:  0.05752134323120117
r_  generation:  0.5236608982086182
local_output_nid generation:  0.03890728950500488
local_in_edges_tensor generation:  0.037459611892700195
mini_batch_src_global generation:  0.058042287826538086
r_  generation:  0.5215871334075928
local_output_nid generation:  0.03876018524169922
local_in_edges_tensor generation:  0.037262916564941406
mini_batch_src_global generation:  0.05788731575012207
r_  generation:  0.5185661315917969
local_output_nid generation:  0.038866281509399414
local_in_edges_tensor generation:  0.0418245792388916
mini_batch_src_global generation:  0.0558774471282959
r_  generation:  0.5196020603179932
----------------------check_connections_block total spend ----------------------------- 12.382999420166016
generate_one_block  0.6453380584716797
generate_one_block  0.7074315547943115
generate_one_block  0.6344630718231201
generate_one_block  0.6312267780303955
generate_one_block  0.6379280090332031
generate_one_block  0.6143765449523926
generate_one_block  0.6269125938415527
generate_one_block  0.6296632289886475
generate_one_block  0.6259801387786865
generate_one_block  0.628715991973877
generate_one_block  0.6287600994110107
generate_one_block  0.6253135204315186
generate_one_block  0.6420462131500244
generate_one_block  0.6336743831634521
generate_one_block  0.6321289539337158
generate_one_block  0.6299343109130859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 6.246566772460938e-05  GigaBytes
Max Memory Allocated: 6.246566772460938e-05  GigaBytes

connection checking time:  29.108267545700073
block generation total time  25.10306477546692
average batch blocks generation time:  1.5689415484666824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.106719970703125  GigaBytes
Max Memory Allocated: 0.106719970703125  GigaBytes

torch.Size([163662, 128])
torch.Size([155677, 32])
torch.Size([124142, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.2920513153076172  GigaBytes
Max Memory Allocated: 0.29419422149658203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10752534866333008  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163668, 128])
torch.Size([155711, 32])
torch.Size([123653, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2872638702392578  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10771703720092773  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163655, 128])
torch.Size([155651, 32])
torch.Size([124513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28820323944091797  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10750913619995117  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163752, 128])
torch.Size([155831, 32])
torch.Size([123865, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2875547409057617  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1074213981628418  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163712, 128])
torch.Size([155868, 32])
torch.Size([123508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28742456436157227  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10738515853881836  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163492, 128])
torch.Size([155478, 32])
torch.Size([123352, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2843136787414551  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10759782791137695  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163738, 128])
torch.Size([155727, 32])
torch.Size([124176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28786420822143555  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10754728317260742  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163615, 128])
torch.Size([155497, 32])
torch.Size([123641, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28450870513916016  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1076207160949707  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163760, 128])
torch.Size([155662, 32])
torch.Size([123965, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28774261474609375  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10756731033325195  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163534, 128])
torch.Size([155465, 32])
torch.Size([123756, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28455162048339844  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10761117935180664  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163622, 128])
torch.Size([155341, 32])
torch.Size([123352, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2842540740966797  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1075444221496582  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163569, 128])
torch.Size([155479, 32])
torch.Size([123815, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2844047546386719  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1076960563659668  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163589, 128])
torch.Size([155698, 32])
torch.Size([124573, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28830862045288086  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10746335983276367  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163693, 128])
torch.Size([155647, 32])
torch.Size([124000, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28742504119873047  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10744428634643555  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163369, 128])
torch.Size([155192, 32])
torch.Size([123178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28423357009887695  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10753870010375977  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163587, 128])
torch.Size([155226, 32])
torch.Size([123261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28416872024536133  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04477636516094208 |0.046793267130851746 |0.04979635775089264 |0.00010010600090026855 |0.009142383933067322 |0.002221822738647461 |
----------------------------------------------------------pseudo_mini_loss sum 5.177870750427246
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7749315
Number of first layer input nodes during this epoch:  2618017
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.16757488250732422  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.020247697830200195
range selection method range initialization spend 0.011499166488647461
time for parepare:  0.017257213592529297
local_output_nid generation:  0.0014045238494873047
local_in_edges_tensor generation:  0.0040438175201416016
mini_batch_src_global generation:  0.0019276142120361328
r_  generation:  0.0182955265045166
local_output_nid generation:  0.0015566349029541016
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.002138376235961914
r_  generation:  0.01910400390625
local_output_nid generation:  0.0015244483947753906
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.001439809799194336
r_  generation:  0.018547773361206055
local_output_nid generation:  0.0015740394592285156
local_in_edges_tensor generation:  0.0008349418640136719
mini_batch_src_global generation:  0.0013420581817626953
r_  generation:  0.01883983612060547
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0008454322814941406
mini_batch_src_global generation:  0.0014543533325195312
r_  generation:  0.018433332443237305
local_output_nid generation:  0.0015072822570800781
local_in_edges_tensor generation:  0.0008234977722167969
mini_batch_src_global generation:  0.0013613700866699219
r_  generation:  0.01871633529663086
local_output_nid generation:  0.001543283462524414
local_in_edges_tensor generation:  0.0008687973022460938
mini_batch_src_global generation:  0.0014557838439941406
r_  generation:  0.018849849700927734
local_output_nid generation:  0.0015685558319091797
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0013413429260253906
r_  generation:  0.019071578979492188
local_output_nid generation:  0.0015015602111816406
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.0015194416046142578
r_  generation:  0.019680500030517578
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.001505136489868164
r_  generation:  0.019370079040527344
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.001524209976196289
r_  generation:  0.019183635711669922
local_output_nid generation:  0.0015079975128173828
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.001512765884399414
r_  generation:  0.019850730895996094
local_output_nid generation:  0.0015285015106201172
local_in_edges_tensor generation:  0.0008502006530761719
mini_batch_src_global generation:  0.0015134811401367188
r_  generation:  0.01972365379333496
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.01981949806213379
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008809566497802734
mini_batch_src_global generation:  0.0014824867248535156
r_  generation:  0.01958012580871582
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.01952648162841797
----------------------check_connections_block total spend ----------------------------- 0.4595978260040283
generate_one_block  0.026442289352416992
generate_one_block  0.028437137603759766
generate_one_block  0.027101755142211914
generate_one_block  0.027819395065307617
generate_one_block  0.027167081832885742
generate_one_block  0.029053688049316406
generate_one_block  0.027250289916992188
generate_one_block  0.027234792709350586
generate_one_block  0.02793717384338379
generate_one_block  0.02799701690673828
generate_one_block  0.027198076248168945
generate_one_block  0.028086423873901367
generate_one_block  0.02806997299194336
generate_one_block  0.027809858322143555
generate_one_block  0.027956008911132812
generate_one_block  0.028319597244262695
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.035125017166137695
gen group dst list time:  0.01688385009765625
time for parepare:  0.019036054611206055
local_output_nid generation:  0.006717681884765625
local_in_edges_tensor generation:  0.016541242599487305
mini_batch_src_global generation:  0.02069878578186035
r_  generation:  0.19217872619628906
local_output_nid generation:  0.010252237319946289
local_in_edges_tensor generation:  0.01839423179626465
mini_batch_src_global generation:  0.027051687240600586
r_  generation:  0.20984125137329102
local_output_nid generation:  0.010669231414794922
local_in_edges_tensor generation:  0.01682114601135254
mini_batch_src_global generation:  0.02391982078552246
r_  generation:  0.20759892463684082
local_output_nid generation:  0.010802030563354492
local_in_edges_tensor generation:  0.01326751708984375
mini_batch_src_global generation:  0.029189109802246094
r_  generation:  0.21449875831604004
local_output_nid generation:  0.011529922485351562
local_in_edges_tensor generation:  0.01170492172241211
mini_batch_src_global generation:  0.02557849884033203
r_  generation:  0.21339750289916992
local_output_nid generation:  0.011569976806640625
local_in_edges_tensor generation:  0.013423681259155273
mini_batch_src_global generation:  0.02784585952758789
r_  generation:  0.2155745029449463
local_output_nid generation:  0.011749505996704102
local_in_edges_tensor generation:  0.013275146484375
mini_batch_src_global generation:  0.02675175666809082
r_  generation:  0.21486186981201172
local_output_nid generation:  0.011900186538696289
local_in_edges_tensor generation:  0.015218734741210938
mini_batch_src_global generation:  0.028467178344726562
r_  generation:  0.21749567985534668
local_output_nid generation:  0.012017965316772461
local_in_edges_tensor generation:  0.017824649810791016
mini_batch_src_global generation:  0.026930570602416992
r_  generation:  0.22147727012634277
local_output_nid generation:  0.011834144592285156
local_in_edges_tensor generation:  0.016853809356689453
mini_batch_src_global generation:  0.02698040008544922
r_  generation:  0.22181153297424316
local_output_nid generation:  0.011356830596923828
local_in_edges_tensor generation:  0.011841058731079102
mini_batch_src_global generation:  0.027233600616455078
r_  generation:  0.21988534927368164
local_output_nid generation:  0.014761924743652344
local_in_edges_tensor generation:  0.0139617919921875
mini_batch_src_global generation:  0.027545928955078125
r_  generation:  0.22355175018310547
local_output_nid generation:  0.01159358024597168
local_in_edges_tensor generation:  0.01392054557800293
mini_batch_src_global generation:  0.02808833122253418
r_  generation:  0.22905850410461426
local_output_nid generation:  0.011413812637329102
local_in_edges_tensor generation:  0.015596389770507812
mini_batch_src_global generation:  0.027583837509155273
r_  generation:  0.22389745712280273
local_output_nid generation:  0.011450529098510742
local_in_edges_tensor generation:  0.012106895446777344
mini_batch_src_global generation:  0.027709007263183594
r_  generation:  0.22514104843139648
local_output_nid generation:  0.011490106582641602
local_in_edges_tensor generation:  0.013846397399902344
mini_batch_src_global generation:  0.02937626838684082
r_  generation:  0.22456836700439453
----------------------check_connections_block total spend ----------------------------- 5.103030443191528
generate_one_block  0.28183937072753906
generate_one_block  0.29404711723327637
generate_one_block  0.27983999252319336
generate_one_block  0.2849009037017822
generate_one_block  0.2759861946105957
generate_one_block  0.28276777267456055
generate_one_block  0.3055846691131592
generate_one_block  0.28858304023742676
generate_one_block  0.28688979148864746
generate_one_block  0.28559255599975586
generate_one_block  0.27246975898742676
generate_one_block  0.2868523597717285
generate_one_block  0.2966790199279785
generate_one_block  0.28203320503234863
generate_one_block  0.2821657657623291
generate_one_block  0.30417895317077637
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.1334984302520752
gen group dst list time:  0.07297897338867188
time for parepare:  0.018779516220092773
local_output_nid generation:  0.025110721588134766
local_in_edges_tensor generation:  0.0558171272277832
mini_batch_src_global generation:  0.04507040977478027
r_  generation:  0.4861152172088623
local_output_nid generation:  0.02962327003479004
local_in_edges_tensor generation:  0.048126220703125
mini_batch_src_global generation:  0.06303691864013672
r_  generation:  0.4865560531616211
local_output_nid generation:  0.03258967399597168
local_in_edges_tensor generation:  0.03969860076904297
mini_batch_src_global generation:  0.05500483512878418
r_  generation:  0.4924604892730713
local_output_nid generation:  0.030185937881469727
local_in_edges_tensor generation:  0.038240671157836914
mini_batch_src_global generation:  0.07805109024047852
r_  generation:  0.5145952701568604
local_output_nid generation:  0.03457999229431152
local_in_edges_tensor generation:  0.10106611251831055
mini_batch_src_global generation:  0.062340497970581055
r_  generation:  0.4981389045715332
local_output_nid generation:  0.041403770446777344
local_in_edges_tensor generation:  0.040210723876953125
mini_batch_src_global generation:  0.058338165283203125
r_  generation:  0.4987804889678955
local_output_nid generation:  0.030445575714111328
local_in_edges_tensor generation:  0.03516554832458496
mini_batch_src_global generation:  0.05712103843688965
r_  generation:  0.5045952796936035
local_output_nid generation:  0.030748367309570312
local_in_edges_tensor generation:  0.03527069091796875
mini_batch_src_global generation:  0.05858302116394043
r_  generation:  0.496382474899292
local_output_nid generation:  0.03228449821472168
local_in_edges_tensor generation:  0.04571080207824707
mini_batch_src_global generation:  0.05742907524108887
r_  generation:  0.5350298881530762
local_output_nid generation:  0.034450531005859375
local_in_edges_tensor generation:  0.04755353927612305
mini_batch_src_global generation:  0.06943392753601074
r_  generation:  0.49245119094848633
local_output_nid generation:  0.0317387580871582
local_in_edges_tensor generation:  0.034645795822143555
mini_batch_src_global generation:  0.057435035705566406
r_  generation:  0.4986147880554199
local_output_nid generation:  0.03257036209106445
local_in_edges_tensor generation:  0.030236244201660156
mini_batch_src_global generation:  0.06475424766540527
r_  generation:  0.5014486312866211
local_output_nid generation:  0.032042741775512695
local_in_edges_tensor generation:  0.04688906669616699
mini_batch_src_global generation:  0.05673551559448242
r_  generation:  0.5021696090698242
local_output_nid generation:  0.031369686126708984
local_in_edges_tensor generation:  0.029892444610595703
mini_batch_src_global generation:  0.058678627014160156
r_  generation:  0.493070125579834
local_output_nid generation:  0.03190445899963379
local_in_edges_tensor generation:  0.04663681983947754
mini_batch_src_global generation:  0.060097455978393555
r_  generation:  0.5086524486541748
local_output_nid generation:  0.0321044921875
local_in_edges_tensor generation:  0.04288768768310547
mini_batch_src_global generation:  0.05812263488769531
r_  generation:  0.49385905265808105
----------------------check_connections_block total spend ----------------------------- 11.92308259010315
generate_one_block  0.6282808780670166
generate_one_block  0.6348979473114014
generate_one_block  0.6308729648590088
generate_one_block  0.6594216823577881
generate_one_block  0.6425530910491943
generate_one_block  0.6223077774047852
generate_one_block  0.6215240955352783
generate_one_block  0.6378555297851562
generate_one_block  0.6908032894134521
generate_one_block  0.6473546028137207
generate_one_block  0.6221528053283691
generate_one_block  0.6291134357452393
generate_one_block  0.6485497951507568
generate_one_block  0.6424791812896729
generate_one_block  0.6402416229248047
generate_one_block  0.6473143100738525
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0386958122253418
gen group dst list time:  0.09731721878051758
time for parepare:  0.019370555877685547
local_output_nid generation:  0.03237318992614746
local_in_edges_tensor generation:  0.04840087890625
mini_batch_src_global generation:  0.04501628875732422
r_  generation:  0.4901466369628906
local_output_nid generation:  0.03894209861755371
local_in_edges_tensor generation:  0.03261852264404297
mini_batch_src_global generation:  0.05634355545043945
r_  generation:  0.49831342697143555
local_output_nid generation:  0.03949117660522461
local_in_edges_tensor generation:  0.03307390213012695
mini_batch_src_global generation:  0.05414772033691406
r_  generation:  0.506479024887085
local_output_nid generation:  0.03839373588562012
local_in_edges_tensor generation:  0.03573727607727051
mini_batch_src_global generation:  0.05327296257019043
r_  generation:  0.5045092105865479
local_output_nid generation:  0.03706955909729004
local_in_edges_tensor generation:  0.035658836364746094
mini_batch_src_global generation:  0.0539705753326416
r_  generation:  0.5117099285125732
local_output_nid generation:  0.03715658187866211
local_in_edges_tensor generation:  0.033670663833618164
mini_batch_src_global generation:  0.054204702377319336
r_  generation:  0.5082800388336182
local_output_nid generation:  0.03722357749938965
local_in_edges_tensor generation:  0.04222559928894043
mini_batch_src_global generation:  0.0533444881439209
r_  generation:  0.5155000686645508
local_output_nid generation:  0.03728318214416504
local_in_edges_tensor generation:  0.03782987594604492
mini_batch_src_global generation:  0.05514264106750488
r_  generation:  0.5117387771606445
local_output_nid generation:  0.03712177276611328
local_in_edges_tensor generation:  0.0424802303314209
mini_batch_src_global generation:  0.0543060302734375
r_  generation:  0.5191202163696289
local_output_nid generation:  0.03772544860839844
local_in_edges_tensor generation:  0.04287838935852051
mini_batch_src_global generation:  0.05516791343688965
r_  generation:  0.5164549350738525
local_output_nid generation:  0.037125587463378906
local_in_edges_tensor generation:  0.033690690994262695
mini_batch_src_global generation:  0.05507969856262207
r_  generation:  0.5235824584960938
local_output_nid generation:  0.03760719299316406
local_in_edges_tensor generation:  0.04198908805847168
mini_batch_src_global generation:  0.055335283279418945
r_  generation:  0.5153932571411133
local_output_nid generation:  0.03750419616699219
local_in_edges_tensor generation:  0.042840003967285156
mini_batch_src_global generation:  0.05555891990661621
r_  generation:  0.5229473114013672
local_output_nid generation:  0.03732419013977051
local_in_edges_tensor generation:  0.037310123443603516
mini_batch_src_global generation:  0.056081533432006836
r_  generation:  0.5213823318481445
local_output_nid generation:  0.03800153732299805
local_in_edges_tensor generation:  0.03806638717651367
mini_batch_src_global generation:  0.05546879768371582
r_  generation:  0.5287535190582275
local_output_nid generation:  0.03816628456115723
local_in_edges_tensor generation:  0.04268980026245117
mini_batch_src_global generation:  0.05693769454956055
r_  generation:  0.5227653980255127
----------------------check_connections_block total spend ----------------------------- 12.249990224838257
generate_one_block  0.624793529510498
generate_one_block  0.6357243061065674
generate_one_block  0.6272413730621338
generate_one_block  0.6326484680175781
generate_one_block  0.6322474479675293
generate_one_block  0.6247608661651611
generate_one_block  0.6918923854827881
generate_one_block  0.6249096393585205
generate_one_block  0.6350593566894531
generate_one_block  0.6338214874267578
generate_one_block  0.6252741813659668
generate_one_block  0.6371054649353027
generate_one_block  0.6362407207489014
generate_one_block  0.6328067779541016
generate_one_block  0.6240565776824951
generate_one_block  0.6493749618530273
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.16757488250732422  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

connection checking time:  29.276103258132935
block generation total time  25.004091024398804
average batch blocks generation time:  1.5627556890249252
block dataloader generation time/epoch 56.86765718460083
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10746288299560547  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163634, 128])
torch.Size([155482, 32])
torch.Size([123215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2843160629272461  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10781335830688477  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163561, 128])
torch.Size([155568, 32])
torch.Size([124304, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2852349281311035  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10758066177368164  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163439, 128])
torch.Size([155218, 32])
torch.Size([123302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28436899185180664  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1077418327331543  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163721, 128])
torch.Size([155666, 32])
torch.Size([124152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28797483444213867  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10754537582397461  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163723, 128])
torch.Size([155716, 32])
torch.Size([123938, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28740978240966797  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1075892448425293  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163641, 128])
torch.Size([155303, 32])
torch.Size([122862, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2842402458190918  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1075434684753418  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163541, 128])
torch.Size([155310, 32])
torch.Size([123468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2843513488769531  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.1076197624206543  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163668, 128])
torch.Size([155564, 32])
torch.Size([123905, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2846388816833496  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10775995254516602  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163654, 128])
torch.Size([155693, 32])
torch.Size([124368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28818511962890625  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10770750045776367  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163540, 128])
torch.Size([155571, 32])
torch.Size([124117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2849855422973633  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.10759496688842773  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163563, 128])
torch.Size([155369, 32])
torch.Size([123553, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.28429222106933594  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.10774707794189453  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163887, 128])
torch.Size([155703, 32])
torch.Size([123742, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.28784990310668945  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.10785150527954102  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163685, 128])
torch.Size([155485, 32])
torch.Size([124165, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.28548336029052734  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.10770940780639648  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163552, 128])
torch.Size([155150, 32])
torch.Size([123262, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.28429603576660156  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.10766077041625977  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163557, 128])
torch.Size([155440, 32])
torch.Size([123948, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.2848386764526367  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.10774850845336914  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

torch.Size([163656, 128])
torch.Size([155541, 32])
torch.Size([124336, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.28519248962402344  GigaBytes
Max Memory Allocated: 0.3047194480895996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039007097482681274 |0.025944098830223083 |0.004494413733482361 |9.164214134216309e-05 |0.006578654050827026 |0.0017979145050048828 |
----------------------------------------------------------pseudo_mini_loss sum 4.548292636871338
Total (block generation + training)time/epoch 58.12737011909485
Training time/epoch 1.2594151496887207
Training time without block to device /epoch 0.8443095684051514
Training time without total dataloading part /epoch 0.1804332733154297
load block tensor time/epoch 0.6241135597229004
block to device time/epoch 0.41510558128356934
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7748477
Number of first layer input nodes during this epoch:  2618022
