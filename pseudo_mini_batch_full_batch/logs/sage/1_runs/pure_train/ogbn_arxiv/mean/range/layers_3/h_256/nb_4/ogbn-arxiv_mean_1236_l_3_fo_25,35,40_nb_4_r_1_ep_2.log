Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648451485.3087516
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023161649703979492
range selection method range initialization spend 0.013647794723510742
time for parepare:  0.018026351928710938
local_output_nid generation:  0.005212306976318359
local_in_edges_tensor generation:  0.005293846130371094
mini_batch_src_global generation:  0.0065462589263916016
r_  generation:  0.08304214477539062
local_output_nid generation:  0.006099700927734375
local_in_edges_tensor generation:  0.0029954910278320312
mini_batch_src_global generation:  0.008671998977661133
r_  generation:  0.08733034133911133
local_output_nid generation:  0.006125450134277344
local_in_edges_tensor generation:  0.0031363964080810547
mini_batch_src_global generation:  0.006503105163574219
r_  generation:  0.09061861038208008
local_output_nid generation:  0.006111621856689453
local_in_edges_tensor generation:  0.002988576889038086
mini_batch_src_global generation:  0.007028102874755859
r_  generation:  0.09139132499694824
----------------------check_connections_block total spend ----------------------------- 0.5087618827819824
generate_one_block  0.10074758529663086
generate_one_block  0.10246729850769043
generate_one_block  0.10298275947570801
generate_one_block  0.10374665260314941
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03988289833068848
gen group dst list time:  0.011436700820922852
time for parepare:  0.019428253173828125
local_output_nid generation:  0.014782428741455078
local_in_edges_tensor generation:  0.035417795181274414
mini_batch_src_global generation:  0.03677773475646973
r_  generation:  0.3947281837463379
local_output_nid generation:  0.021414756774902344
local_in_edges_tensor generation:  0.035863399505615234
mini_batch_src_global generation:  0.04897427558898926
r_  generation:  0.4419255256652832
local_output_nid generation:  0.02589249610900879
local_in_edges_tensor generation:  0.04310178756713867
mini_batch_src_global generation:  0.05202364921569824
r_  generation:  0.4106137752532959
local_output_nid generation:  0.023474693298339844
local_in_edges_tensor generation:  0.02870655059814453
mini_batch_src_global generation:  0.04825019836425781
r_  generation:  0.4173164367675781
----------------------check_connections_block total spend ----------------------------- 2.459577798843384
generate_one_block  0.5426697731018066
generate_one_block  0.5290250778198242
generate_one_block  0.5321409702301025
generate_one_block  0.5199272632598877
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04624605178833008
gen group dst list time:  0.021356821060180664
time for parepare:  0.01858687400817871
local_output_nid generation:  0.024213790893554688
local_in_edges_tensor generation:  0.05429244041442871
mini_batch_src_global generation:  0.04480481147766113
r_  generation:  0.5002055168151855
local_output_nid generation:  0.03248858451843262
local_in_edges_tensor generation:  0.049584388732910156
mini_batch_src_global generation:  0.05762219429016113
r_  generation:  0.5085399150848389
local_output_nid generation:  0.035178184509277344
local_in_edges_tensor generation:  0.04233241081237793
mini_batch_src_global generation:  0.05592012405395508
r_  generation:  0.5290298461914062
local_output_nid generation:  0.03524422645568848
local_in_edges_tensor generation:  0.050844430923461914
mini_batch_src_global generation:  0.07054781913757324
r_  generation:  0.5207836627960205
----------------------check_connections_block total spend ----------------------------- 3.077207326889038
generate_one_block  0.6466596126556396
generate_one_block  0.6602239608764648
generate_one_block  0.6568002700805664
generate_one_block  0.6477680206298828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  5.536785125732422
block generation total time  4.735214948654175
average batch blocks generation time:  1.1838037371635437
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10184383392333984  GigaBytes
Max Memory Allocated: 0.10184383392333984  GigaBytes

torch.Size([164260, 128])
torch.Size([154452, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6463623046875 GB
    Memory Allocated: 1.0958662033081055  GigaBytes
Max Memory Allocated: 1.1837539672851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.10628175735473633  GigaBytes
Max Memory Allocated: 1.2872319221496582  GigaBytes

torch.Size([164260, 128])
torch.Size([154480, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.1016154289245605  GigaBytes
Max Memory Allocated: 1.2872319221496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10606765747070312  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

torch.Size([164241, 128])
torch.Size([154538, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.0972518920898438  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.1060628890991211  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

torch.Size([164247, 128])
torch.Size([154370, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.0956602096557617  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050986528396606445 |0.10210102796554565 |0.20113062858581543 |0.00012701749801635742 |0.03528934717178345 |0.0019979476928710938 |
----------------------------------------------------------pseudo_mini_loss sum 6.1554460525512695
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1679982
Number of first layer input nodes during this epoch:  657008
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.14435863494873047  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019295692443847656
range selection method range initialization spend 0.012697696685791016
time for parepare:  0.016826868057250977
local_output_nid generation:  0.005151510238647461
local_in_edges_tensor generation:  0.009136199951171875
mini_batch_src_global generation:  0.0065615177154541016
r_  generation:  0.08185601234436035
local_output_nid generation:  0.005959510803222656
local_in_edges_tensor generation:  0.0030901432037353516
mini_batch_src_global generation:  0.008548974990844727
r_  generation:  0.0846402645111084
local_output_nid generation:  0.006092548370361328
local_in_edges_tensor generation:  0.0030601024627685547
mini_batch_src_global generation:  0.006491184234619141
r_  generation:  0.09010505676269531
local_output_nid generation:  0.008878231048583984
local_in_edges_tensor generation:  0.003114938735961914
mini_batch_src_global generation:  0.00717473030090332
r_  generation:  0.09616518020629883
----------------------check_connections_block total spend ----------------------------- 0.5162146091461182
generate_one_block  0.11050915718078613
generate_one_block  0.1100621223449707
generate_one_block  0.10913586616516113
generate_one_block  0.10759830474853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05700516700744629
gen group dst list time:  0.011887788772583008
time for parepare:  0.019315242767333984
local_output_nid generation:  0.014548778533935547
local_in_edges_tensor generation:  0.04476737976074219
mini_batch_src_global generation:  0.03719329833984375
r_  generation:  0.4008455276489258
local_output_nid generation:  0.02395462989807129
local_in_edges_tensor generation:  0.03757739067077637
mini_batch_src_global generation:  0.04629683494567871
r_  generation:  0.41739344596862793
local_output_nid generation:  0.02342677116394043
local_in_edges_tensor generation:  0.027380943298339844
mini_batch_src_global generation:  0.04928398132324219
r_  generation:  0.4189004898071289
local_output_nid generation:  0.02230358123779297
local_in_edges_tensor generation:  0.034522056579589844
mini_batch_src_global generation:  0.04804039001464844
r_  generation:  0.4359009265899658
----------------------check_connections_block total spend ----------------------------- 2.458571672439575
generate_one_block  0.5446727275848389
generate_one_block  0.5310089588165283
generate_one_block  0.5591468811035156
generate_one_block  0.5475203990936279
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044097185134887695
gen group dst list time:  0.021167278289794922
time for parepare:  0.019338369369506836
local_output_nid generation:  0.024091243743896484
local_in_edges_tensor generation:  0.053040266036987305
mini_batch_src_global generation:  0.04508686065673828
r_  generation:  0.49489736557006836
local_output_nid generation:  0.032891273498535156
local_in_edges_tensor generation:  0.05973052978515625
mini_batch_src_global generation:  0.05528712272644043
r_  generation:  0.5128672122955322
local_output_nid generation:  0.03480267524719238
local_in_edges_tensor generation:  0.04282402992248535
mini_batch_src_global generation:  0.06910848617553711
r_  generation:  0.5221705436706543
local_output_nid generation:  0.03768754005432129
local_in_edges_tensor generation:  0.04378843307495117
mini_batch_src_global generation:  0.05730867385864258
r_  generation:  0.5210199356079102
----------------------check_connections_block total spend ----------------------------- 3.0699691772460938
generate_one_block  0.6450867652893066
generate_one_block  0.6393105983734131
generate_one_block  0.6277189254760742
generate_one_block  0.6436765193939209
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.14435863494873047  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

connection checking time:  5.528540849685669
block generation total time  4.738141775131226
average batch blocks generation time:  1.1845354437828064
block dataloader generation time/epoch 12.120767593383789
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10874128341674805  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

torch.Size([164254, 128])
torch.Size([154503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0623779296875 GB
    Memory Allocated: 1.1034965515136719  GigaBytes
Max Memory Allocated: 1.2949023246765137  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10873842239379883  GigaBytes
Max Memory Allocated: 1.2966299057006836  GigaBytes

torch.Size([164283, 128])
torch.Size([154513, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.0984978675842285  GigaBytes
Max Memory Allocated: 1.2966299057006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10864734649658203  GigaBytes
Max Memory Allocated: 1.2966299057006836  GigaBytes

torch.Size([164338, 128])
torch.Size([154653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1073822975158691  GigaBytes
Max Memory Allocated: 1.2966299057006836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 0.10779953002929688  GigaBytes
Max Memory Allocated: 1.300480842590332  GigaBytes

torch.Size([164299, 128])
torch.Size([154572, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.1029629707336426  GigaBytes
Max Memory Allocated: 1.300480842590332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07945036888122559 |0.018374204635620117 |0.0038799047470092773 |0.00010037422180175781 |0.017017483711242676 |0.0013511180877685547 |
----------------------------------------------------------pseudo_mini_loss sum 3.2288341522216797
Total (block generation + training)time/epoch 12.683561563491821
Training time/epoch 0.5625131130218506
Training time without block to device /epoch 0.4890162944793701
Training time without total dataloading part /epoch 0.0853421688079834
load block tensor time/epoch 0.31780147552490234
block to device time/epoch 0.07349681854248047
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1681351
Number of first layer input nodes during this epoch:  657174
