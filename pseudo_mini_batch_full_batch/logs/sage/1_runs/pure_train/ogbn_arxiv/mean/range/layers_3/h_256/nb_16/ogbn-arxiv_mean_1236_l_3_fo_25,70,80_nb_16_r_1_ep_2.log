Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648452517.6350236
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027792692184448242
range selection method range initialization spend 0.013589620590209961
time for parepare:  0.017758607864379883
local_output_nid generation:  0.001314401626586914
local_in_edges_tensor generation:  0.003782987594604492
mini_batch_src_global generation:  0.0019598007202148438
r_  generation:  0.02050638198852539
local_output_nid generation:  0.0014736652374267578
local_in_edges_tensor generation:  0.0010044574737548828
mini_batch_src_global generation:  0.0023851394653320312
r_  generation:  0.0205538272857666
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0008857250213623047
mini_batch_src_global generation:  0.0015323162078857422
r_  generation:  0.020149946212768555
local_output_nid generation:  0.0015325546264648438
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.001544952392578125
r_  generation:  0.020079374313354492
local_output_nid generation:  0.001516580581665039
local_in_edges_tensor generation:  0.0008678436279296875
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.020572662353515625
local_output_nid generation:  0.0015022754669189453
local_in_edges_tensor generation:  0.0009105205535888672
mini_batch_src_global generation:  0.0015833377838134766
r_  generation:  0.0209200382232666
local_output_nid generation:  0.001514434814453125
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.0016641616821289062
r_  generation:  0.021344423294067383
local_output_nid generation:  0.0014901161193847656
local_in_edges_tensor generation:  0.0008826255798339844
mini_batch_src_global generation:  0.0017056465148925781
r_  generation:  0.02092599868774414
local_output_nid generation:  0.0014960765838623047
local_in_edges_tensor generation:  0.0008974075317382812
mini_batch_src_global generation:  0.0016591548919677734
r_  generation:  0.021533489227294922
local_output_nid generation:  0.0015606880187988281
local_in_edges_tensor generation:  0.0008885860443115234
mini_batch_src_global generation:  0.0016641616821289062
r_  generation:  0.021078824996948242
local_output_nid generation:  0.0015211105346679688
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0016298294067382812
r_  generation:  0.0213320255279541
local_output_nid generation:  0.0015344619750976562
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.0017004013061523438
r_  generation:  0.02173757553100586
local_output_nid generation:  0.0015261173248291016
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.0017125606536865234
r_  generation:  0.021526098251342773
local_output_nid generation:  0.0015149116516113281
local_in_edges_tensor generation:  0.0008685588836669922
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.021673202514648438
local_output_nid generation:  0.001524209976196289
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0016791820526123047
r_  generation:  0.021936893463134766
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0008895397186279297
mini_batch_src_global generation:  0.0017175674438476562
r_  generation:  0.021885156631469727
----------------------check_connections_block total spend ----------------------------- 0.49861836433410645
generate_one_block  0.0300443172454834
generate_one_block  0.03273797035217285
generate_one_block  0.03220176696777344
generate_one_block  0.03160238265991211
generate_one_block  0.031580209732055664
generate_one_block  0.03171372413635254
generate_one_block  0.031966447830200195
generate_one_block  0.030757427215576172
generate_one_block  0.031222105026245117
generate_one_block  0.03099203109741211
generate_one_block  0.0317845344543457
generate_one_block  0.0323183536529541
generate_one_block  0.0320436954498291
generate_one_block  0.031064987182617188
generate_one_block  0.03168535232543945
generate_one_block  0.03229165077209473
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03907203674316406
gen group dst list time:  0.020693063735961914
time for parepare:  0.019195079803466797
local_output_nid generation:  0.007306098937988281
local_in_edges_tensor generation:  0.018120527267456055
mini_batch_src_global generation:  0.02672433853149414
r_  generation:  0.24973773956298828
local_output_nid generation:  0.01116323471069336
local_in_edges_tensor generation:  0.022231340408325195
mini_batch_src_global generation:  0.03431439399719238
r_  generation:  0.2665228843688965
local_output_nid generation:  0.011146306991577148
local_in_edges_tensor generation:  0.017579078674316406
mini_batch_src_global generation:  0.030401229858398438
r_  generation:  0.25745272636413574
local_output_nid generation:  0.011454105377197266
local_in_edges_tensor generation:  0.013140201568603516
mini_batch_src_global generation:  0.0343930721282959
r_  generation:  0.26560187339782715
local_output_nid generation:  0.011954307556152344
local_in_edges_tensor generation:  0.015819311141967773
mini_batch_src_global generation:  0.038661956787109375
r_  generation:  0.2693057060241699
local_output_nid generation:  0.011801004409790039
local_in_edges_tensor generation:  0.020804882049560547
mini_batch_src_global generation:  0.0337519645690918
r_  generation:  0.27335453033447266
local_output_nid generation:  0.012045145034790039
local_in_edges_tensor generation:  0.01847696304321289
mini_batch_src_global generation:  0.034049034118652344
r_  generation:  0.2766892910003662
local_output_nid generation:  0.011774539947509766
local_in_edges_tensor generation:  0.013654947280883789
mini_batch_src_global generation:  0.03418135643005371
r_  generation:  0.26859593391418457
local_output_nid generation:  0.012006521224975586
local_in_edges_tensor generation:  0.013702392578125
mini_batch_src_global generation:  0.035553932189941406
r_  generation:  0.27272605895996094
local_output_nid generation:  0.012032032012939453
local_in_edges_tensor generation:  0.014036178588867188
mini_batch_src_global generation:  0.033889055252075195
r_  generation:  0.27190351486206055
local_output_nid generation:  0.012169122695922852
local_in_edges_tensor generation:  0.016145706176757812
mini_batch_src_global generation:  0.03609824180603027
r_  generation:  0.2720072269439697
local_output_nid generation:  0.012340784072875977
local_in_edges_tensor generation:  0.01915907859802246
mini_batch_src_global generation:  0.034021854400634766
r_  generation:  0.27902793884277344
local_output_nid generation:  0.012146949768066406
local_in_edges_tensor generation:  0.01884150505065918
mini_batch_src_global generation:  0.03391671180725098
r_  generation:  0.27509593963623047
local_output_nid generation:  0.012298107147216797
local_in_edges_tensor generation:  0.013879060745239258
mini_batch_src_global generation:  0.03402352333068848
r_  generation:  0.27342915534973145
local_output_nid generation:  0.012515783309936523
local_in_edges_tensor generation:  0.01641082763671875
mini_batch_src_global generation:  0.0342257022857666
r_  generation:  0.27826595306396484
local_output_nid generation:  0.012314558029174805
local_in_edges_tensor generation:  0.018907785415649414
mini_batch_src_global generation:  0.03474926948547363
r_  generation:  0.27683138847351074
----------------------check_connections_block total spend ----------------------------- 6.26555061340332
generate_one_block  0.3520491123199463
generate_one_block  0.3637247085571289
generate_one_block  0.34186744689941406
generate_one_block  0.3512873649597168
generate_one_block  0.36754369735717773
generate_one_block  0.3505864143371582
generate_one_block  0.3585782051086426
generate_one_block  0.346299409866333
generate_one_block  0.3493976593017578
generate_one_block  0.3514530658721924
generate_one_block  0.3515157699584961
generate_one_block  0.35796022415161133
generate_one_block  0.35447001457214355
generate_one_block  0.3506922721862793
generate_one_block  0.3651299476623535
generate_one_block  0.35779786109924316
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03142905235290527
gen group dst list time:  0.062189579010009766
time for parepare:  0.01864147186279297
local_output_nid generation:  0.024315357208251953
local_in_edges_tensor generation:  0.03854656219482422
mini_batch_src_global generation:  0.04494118690490723
r_  generation:  0.44750308990478516
local_output_nid generation:  0.03088974952697754
local_in_edges_tensor generation:  0.045833587646484375
mini_batch_src_global generation:  0.05213427543640137
r_  generation:  0.4538536071777344
local_output_nid generation:  0.030525922775268555
local_in_edges_tensor generation:  0.03455948829650879
mini_batch_src_global generation:  0.051618337631225586
r_  generation:  0.46295619010925293
local_output_nid generation:  0.03138375282287598
local_in_edges_tensor generation:  0.03439927101135254
mini_batch_src_global generation:  0.05154228210449219
r_  generation:  0.46674060821533203
local_output_nid generation:  0.03147578239440918
local_in_edges_tensor generation:  0.0392305850982666
mini_batch_src_global generation:  0.0515294075012207
r_  generation:  0.46932506561279297
local_output_nid generation:  0.03151893615722656
local_in_edges_tensor generation:  0.0342099666595459
mini_batch_src_global generation:  0.05758237838745117
r_  generation:  0.4693942070007324
local_output_nid generation:  0.03156018257141113
local_in_edges_tensor generation:  0.0353546142578125
mini_batch_src_global generation:  0.05299043655395508
r_  generation:  0.4753737449645996
local_output_nid generation:  0.0320127010345459
local_in_edges_tensor generation:  0.04023933410644531
mini_batch_src_global generation:  0.05737471580505371
r_  generation:  0.4988677501678467
local_output_nid generation:  0.03348088264465332
local_in_edges_tensor generation:  0.0427088737487793
mini_batch_src_global generation:  0.06397390365600586
r_  generation:  0.4794914722442627
local_output_nid generation:  0.0324857234954834
local_in_edges_tensor generation:  0.04101729393005371
mini_batch_src_global generation:  0.053760528564453125
r_  generation:  0.47783613204956055
local_output_nid generation:  0.03238511085510254
local_in_edges_tensor generation:  0.03792548179626465
mini_batch_src_global generation:  0.0531618595123291
r_  generation:  0.48625683784484863
local_output_nid generation:  0.034700632095336914
local_in_edges_tensor generation:  0.03460121154785156
mini_batch_src_global generation:  0.05363941192626953
r_  generation:  0.47486257553100586
local_output_nid generation:  0.03243398666381836
local_in_edges_tensor generation:  0.03376483917236328
mini_batch_src_global generation:  0.05341053009033203
r_  generation:  0.4788546562194824
local_output_nid generation:  0.03258657455444336
local_in_edges_tensor generation:  0.03432607650756836
mini_batch_src_global generation:  0.0539090633392334
r_  generation:  0.48027849197387695
local_output_nid generation:  0.03267979621887207
local_in_edges_tensor generation:  0.03433513641357422
mini_batch_src_global generation:  0.05384349822998047
r_  generation:  0.47545933723449707
local_output_nid generation:  0.03261423110961914
local_in_edges_tensor generation:  0.041677236557006836
mini_batch_src_global generation:  0.053508758544921875
r_  generation:  0.47498130798339844
----------------------check_connections_block total spend ----------------------------- 11.243138074874878
generate_one_block  0.5940561294555664
generate_one_block  0.6091880798339844
generate_one_block  0.6016032695770264
generate_one_block  0.6033680438995361
generate_one_block  0.6002161502838135
generate_one_block  0.5892550945281982
generate_one_block  0.6513841152191162
generate_one_block  0.5907278060913086
generate_one_block  0.5932316780090332
generate_one_block  0.6003904342651367
generate_one_block  0.6082696914672852
generate_one_block  0.6025106906890869
generate_one_block  0.588665246963501
generate_one_block  0.5842874050140381
generate_one_block  0.5881080627441406
generate_one_block  0.6010758876800537
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008172988891601562  GigaBytes
Max Memory Allocated: 0.0008172988891601562  GigaBytes

connection checking time:  17.5086886882782
block generation total time  15.27669095993042
average batch blocks generation time:  0.9547931849956512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09336042404174805  GigaBytes
Max Memory Allocated: 0.09336042404174805  GigaBytes

torch.Size([156964, 128])
torch.Size([130040, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 0.7637472152709961  GigaBytes
Max Memory Allocated: 0.8049983978271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.0959477424621582  GigaBytes
Max Memory Allocated: 0.8504533767700195  GigaBytes

torch.Size([156701, 128])
torch.Size([129635, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.7694063186645508  GigaBytes
Max Memory Allocated: 0.8504533767700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 0.09576559066772461  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([157033, 128])
torch.Size([129773, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 0.7610263824462891  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 0.09582233428955078  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156988, 128])
torch.Size([130210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7677302360534668  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09599542617797852  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([157243, 128])
torch.Size([130461, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7706646919250488  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09578514099121094  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156806, 128])
torch.Size([129911, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7659726142883301  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09599113464355469  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156880, 128])
torch.Size([129887, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7695164680480957  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09555530548095703  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156522, 128])
torch.Size([129571, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7611083984375  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09569215774536133  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156651, 128])
torch.Size([129682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7640066146850586  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09583187103271484  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([157070, 128])
torch.Size([130175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7666811943054199  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.0957646369934082  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156711, 128])
torch.Size([129982, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7649435997009277  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09580755233764648  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156579, 128])
torch.Size([129989, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7672300338745117  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09581899642944336  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156747, 128])
torch.Size([129586, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7639861106872559  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09575176239013672  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156734, 128])
torch.Size([129798, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7642450332641602  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09588336944580078  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156896, 128])
torch.Size([129922, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7664456367492676  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09579753875732422  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156624, 128])
torch.Size([129821, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.7653145790100098  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06148916482925415 |0.033192649483680725 |0.0496850460767746 |0.00010377168655395508 |0.008763179183006287 |0.0038831233978271484 |
----------------------------------------------------------pseudo_mini_loss sum 6.282496452331543
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5317445
Number of first layer input nodes during this epoch:  2509149
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12336111068725586  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0683753490447998
range selection method range initialization spend 0.011487245559692383
time for parepare:  0.017005205154418945
local_output_nid generation:  0.0013666152954101562
local_in_edges_tensor generation:  0.005920886993408203
mini_batch_src_global generation:  0.002053499221801758
r_  generation:  0.019997596740722656
local_output_nid generation:  0.0015575885772705078
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.0024716854095458984
r_  generation:  0.020856857299804688
local_output_nid generation:  0.0015506744384765625
local_in_edges_tensor generation:  0.0009067058563232422
mini_batch_src_global generation:  0.0016078948974609375
r_  generation:  0.021411657333374023
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0015742778778076172
r_  generation:  0.020666122436523438
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.001516103744506836
r_  generation:  0.021111011505126953
local_output_nid generation:  0.001558065414428711
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0015621185302734375
r_  generation:  0.021243810653686523
local_output_nid generation:  0.0015404224395751953
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.0214691162109375
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.00159454345703125
r_  generation:  0.020718097686767578
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.0008971691131591797
mini_batch_src_global generation:  0.0016164779663085938
r_  generation:  0.02086925506591797
local_output_nid generation:  0.0015592575073242188
local_in_edges_tensor generation:  0.00089263916015625
mini_batch_src_global generation:  0.0016489028930664062
r_  generation:  0.02189159393310547
local_output_nid generation:  0.0015599727630615234
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0016407966613769531
r_  generation:  0.02129054069519043
local_output_nid generation:  0.001621246337890625
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.00167083740234375
r_  generation:  0.02168893814086914
local_output_nid generation:  0.0015769004821777344
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0017020702362060547
r_  generation:  0.02197098731994629
local_output_nid generation:  0.001546621322631836
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.001703500747680664
r_  generation:  0.022069692611694336
local_output_nid generation:  0.0015561580657958984
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0017268657684326172
r_  generation:  0.021825790405273438
local_output_nid generation:  0.00152587890625
local_in_edges_tensor generation:  0.0008661746978759766
mini_batch_src_global generation:  0.0016679763793945312
r_  generation:  0.021726369857788086
----------------------check_connections_block total spend ----------------------------- 0.5044591426849365
generate_one_block  0.04262948036193848
generate_one_block  0.03216743469238281
generate_one_block  0.03189706802368164
generate_one_block  0.030587196350097656
generate_one_block  0.030965328216552734
generate_one_block  0.03264284133911133
generate_one_block  0.03179788589477539
generate_one_block  0.03035759925842285
generate_one_block  0.030951499938964844
generate_one_block  0.03145790100097656
generate_one_block  0.030910015106201172
generate_one_block  0.03168845176696777
generate_one_block  0.03230428695678711
generate_one_block  0.031946659088134766
generate_one_block  0.03136301040649414
generate_one_block  0.03156614303588867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03847527503967285
gen group dst list time:  0.019116878509521484
time for parepare:  0.018830537796020508
local_output_nid generation:  0.007260322570800781
local_in_edges_tensor generation:  0.021858930587768555
mini_batch_src_global generation:  0.027891159057617188
r_  generation:  0.2538473606109619
local_output_nid generation:  0.01118016242980957
local_in_edges_tensor generation:  0.021788835525512695
mini_batch_src_global generation:  0.03236103057861328
r_  generation:  0.25742173194885254
local_output_nid generation:  0.01212763786315918
local_in_edges_tensor generation:  0.022644519805908203
mini_batch_src_global generation:  0.031829118728637695
r_  generation:  0.2656238079071045
local_output_nid generation:  0.012086629867553711
local_in_edges_tensor generation:  0.01265573501586914
mini_batch_src_global generation:  0.03208160400390625
r_  generation:  0.2654745578765869
local_output_nid generation:  0.011934280395507812
local_in_edges_tensor generation:  0.015279769897460938
mini_batch_src_global generation:  0.033087968826293945
r_  generation:  0.265317440032959
local_output_nid generation:  0.012057304382324219
local_in_edges_tensor generation:  0.015381813049316406
mini_batch_src_global generation:  0.03342437744140625
r_  generation:  0.2710390090942383
local_output_nid generation:  0.012070417404174805
local_in_edges_tensor generation:  0.01773524284362793
mini_batch_src_global generation:  0.03361797332763672
r_  generation:  0.2693040370941162
local_output_nid generation:  0.011805057525634766
local_in_edges_tensor generation:  0.014810800552368164
mini_batch_src_global generation:  0.033359527587890625
r_  generation:  0.26270580291748047
local_output_nid generation:  0.012211084365844727
local_in_edges_tensor generation:  0.01655864715576172
mini_batch_src_global generation:  0.03317546844482422
r_  generation:  0.2666778564453125
local_output_nid generation:  0.012497425079345703
local_in_edges_tensor generation:  0.019073963165283203
mini_batch_src_global generation:  0.03921866416931152
r_  generation:  0.2741663455963135
local_output_nid generation:  0.012133598327636719
local_in_edges_tensor generation:  0.01339411735534668
mini_batch_src_global generation:  0.03389573097229004
r_  generation:  0.2669529914855957
local_output_nid generation:  0.012480974197387695
local_in_edges_tensor generation:  0.0182645320892334
mini_batch_src_global generation:  0.034082889556884766
r_  generation:  0.27190661430358887
local_output_nid generation:  0.012581110000610352
local_in_edges_tensor generation:  0.016131162643432617
mini_batch_src_global generation:  0.03516745567321777
r_  generation:  0.2799837589263916
local_output_nid generation:  0.013387203216552734
local_in_edges_tensor generation:  0.016176700592041016
mini_batch_src_global generation:  0.035420894622802734
r_  generation:  0.29067444801330566
local_output_nid generation:  0.01489877700805664
local_in_edges_tensor generation:  0.026253700256347656
mini_batch_src_global generation:  0.03804612159729004
r_  generation:  0.2741410732269287
local_output_nid generation:  0.0127716064453125
local_in_edges_tensor generation:  0.017498493194580078
mini_batch_src_global generation:  0.03445005416870117
r_  generation:  0.2716183662414551
----------------------check_connections_block total spend ----------------------------- 6.268571615219116
generate_one_block  0.3661003112792969
generate_one_block  0.3744046688079834
generate_one_block  0.36878275871276855
generate_one_block  0.34779930114746094
generate_one_block  0.3523411750793457
generate_one_block  0.35443878173828125
generate_one_block  0.38587379455566406
generate_one_block  0.3378181457519531
generate_one_block  0.34710049629211426
generate_one_block  0.3933901786804199
generate_one_block  0.3501262664794922
generate_one_block  0.3744807243347168
generate_one_block  0.3750319480895996
generate_one_block  0.3620772361755371
generate_one_block  0.36910319328308105
generate_one_block  0.36918187141418457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06094074249267578
gen group dst list time:  0.07756280899047852
time for parepare:  0.01965641975402832
local_output_nid generation:  0.02609086036682129
local_in_edges_tensor generation:  0.06085920333862305
mini_batch_src_global generation:  0.04266071319580078
r_  generation:  0.4545857906341553
local_output_nid generation:  0.03102397918701172
local_in_edges_tensor generation:  0.04593539237976074
mini_batch_src_global generation:  0.05292034149169922
r_  generation:  0.45709681510925293
local_output_nid generation:  0.04265022277832031
local_in_edges_tensor generation:  0.034262895584106445
mini_batch_src_global generation:  0.05153918266296387
r_  generation:  0.4675424098968506
local_output_nid generation:  0.031470537185668945
local_in_edges_tensor generation:  0.03418421745300293
mini_batch_src_global generation:  0.05122518539428711
r_  generation:  0.467771053314209
local_output_nid generation:  0.03211092948913574
local_in_edges_tensor generation:  0.08444046974182129
mini_batch_src_global generation:  0.055353641510009766
r_  generation:  0.4713718891143799
local_output_nid generation:  0.03162503242492676
local_in_edges_tensor generation:  0.030553817749023438
mini_batch_src_global generation:  0.05237603187561035
r_  generation:  0.4730079174041748
local_output_nid generation:  0.03169512748718262
local_in_edges_tensor generation:  0.03922700881958008
mini_batch_src_global generation:  0.05367922782897949
r_  generation:  0.479938268661499
local_output_nid generation:  0.03321361541748047
local_in_edges_tensor generation:  0.03819561004638672
mini_batch_src_global generation:  0.052764892578125
r_  generation:  0.49254393577575684
local_output_nid generation:  0.03524947166442871
local_in_edges_tensor generation:  0.0442042350769043
mini_batch_src_global generation:  0.05595707893371582
r_  generation:  0.4745211601257324
local_output_nid generation:  0.03310728073120117
local_in_edges_tensor generation:  0.038649559020996094
mini_batch_src_global generation:  0.056703805923461914
r_  generation:  0.4779789447784424
local_output_nid generation:  0.03273749351501465
local_in_edges_tensor generation:  0.030710935592651367
mini_batch_src_global generation:  0.05331277847290039
r_  generation:  0.4854462146759033
local_output_nid generation:  0.03300881385803223
local_in_edges_tensor generation:  0.030723094940185547
mini_batch_src_global generation:  0.05424308776855469
r_  generation:  0.47513437271118164
local_output_nid generation:  0.033293724060058594
local_in_edges_tensor generation:  0.035221099853515625
mini_batch_src_global generation:  0.05381917953491211
r_  generation:  0.4848957061767578
local_output_nid generation:  0.03271150588989258
local_in_edges_tensor generation:  0.031346797943115234
mini_batch_src_global generation:  0.05387306213378906
r_  generation:  0.4764440059661865
local_output_nid generation:  0.0346980094909668
local_in_edges_tensor generation:  0.03468823432922363
mini_batch_src_global generation:  0.05346870422363281
r_  generation:  0.47768545150756836
local_output_nid generation:  0.03293871879577637
local_in_edges_tensor generation:  0.0347137451171875
mini_batch_src_global generation:  0.05837821960449219
r_  generation:  0.47615504264831543
----------------------check_connections_block total spend ----------------------------- 11.359071493148804
generate_one_block  0.5976004600524902
generate_one_block  0.6083500385284424
generate_one_block  0.5979738235473633
generate_one_block  0.5935821533203125
generate_one_block  0.6157808303833008
generate_one_block  0.6127140522003174
generate_one_block  0.5911517143249512
generate_one_block  0.5913794040679932
generate_one_block  0.6266796588897705
generate_one_block  0.6005856990814209
generate_one_block  0.5896787643432617
generate_one_block  0.6103029251098633
generate_one_block  0.6109902858734131
generate_one_block  0.5949976444244385
generate_one_block  0.6069607734680176
generate_one_block  0.596552848815918
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.12336111068725586  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

connection checking time:  17.62764310836792
block generation total time  15.473331928253174
average batch blocks generation time:  0.9670832455158234
block dataloader generation time/epoch 35.432085275650024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6580810546875 GB
    Memory Allocated: 0.09754323959350586  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

torch.Size([156792, 128])
torch.Size([130042, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7714715003967285  GigaBytes
Max Memory Allocated: 0.8584294319152832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09754180908203125  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([156878, 128])
torch.Size([129928, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7682881355285645  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09746551513671875  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([156514, 128])
torch.Size([129555, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7702994346618652  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09741353988647461  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([156845, 128])
torch.Size([129971, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7661952972412109  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09752225875854492  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([157083, 128])
torch.Size([130233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7701272964477539  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09730339050292969  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([156598, 128])
torch.Size([129604, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7645316123962402  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09736871719360352  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([156619, 128])
torch.Size([129572, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7652626037597656  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.0973515510559082  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([157027, 128])
torch.Size([129717, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7617812156677246  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09742498397827148  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([157021, 128])
torch.Size([129929, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7652602195739746  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09771871566772461  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

torch.Size([157239, 128])
torch.Size([130994, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7753300666809082  GigaBytes
Max Memory Allocated: 0.8601627349853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09716606140136719  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

torch.Size([156574, 128])
torch.Size([129266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7611598968505859  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09734392166137695  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

torch.Size([156561, 128])
torch.Size([129922, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7682638168334961  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09769964218139648  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

torch.Size([157027, 128])
torch.Size([130809, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7752418518066406  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09742593765258789  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

torch.Size([156679, 128])
torch.Size([129793, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7672548294067383  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09743928909301758  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

torch.Size([156607, 128])
torch.Size([129738, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7674617767333984  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.09735107421875  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

torch.Size([156704, 128])
torch.Size([129975, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.7658863067626953  GigaBytes
Max Memory Allocated: 0.8642544746398926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0637013167142868 |0.01432141661643982 |0.003587096929550171 |9.097158908843994e-05 |0.004996120929718018 |0.0017807483673095703 |
----------------------------------------------------------pseudo_mini_loss sum 3.241950750350952
Total (block generation + training)time/epoch 36.88493824005127
Training time/epoch 1.4525644779205322
Training time without block to device /epoch 1.2234218120574951
Training time without total dataloading part /epoch 0.14056777954101562
load block tensor time/epoch 1.0192210674285889
block to device time/epoch 0.2291426658630371
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5318142
Number of first layer input nodes during this epoch:  2508768
