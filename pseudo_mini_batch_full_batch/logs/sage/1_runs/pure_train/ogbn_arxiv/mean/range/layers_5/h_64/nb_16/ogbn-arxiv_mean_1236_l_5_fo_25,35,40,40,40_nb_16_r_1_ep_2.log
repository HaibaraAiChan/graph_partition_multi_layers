Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648497194.027073
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024850130081176758
range selection method range initialization spend 0.01362919807434082
time for parepare:  0.017847299575805664
local_output_nid generation:  0.0013387203216552734
local_in_edges_tensor generation:  0.003786325454711914
mini_batch_src_global generation:  0.0017898082733154297
r_  generation:  0.017898082733154297
local_output_nid generation:  0.0014758110046386719
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.002003192901611328
r_  generation:  0.018538475036621094
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0013735294342041016
r_  generation:  0.017784595489501953
local_output_nid generation:  0.00148773193359375
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.001394033432006836
r_  generation:  0.018335819244384766
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0008420944213867188
mini_batch_src_global generation:  0.0012798309326171875
r_  generation:  0.018461227416992188
local_output_nid generation:  0.0015201568603515625
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0014231204986572266
r_  generation:  0.01840496063232422
local_output_nid generation:  0.0014905929565429688
local_in_edges_tensor generation:  0.0008702278137207031
mini_batch_src_global generation:  0.0013425350189208984
r_  generation:  0.018620729446411133
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0008478164672851562
mini_batch_src_global generation:  0.00144195556640625
r_  generation:  0.018558025360107422
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0014107227325439453
r_  generation:  0.018765687942504883
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0015304088592529297
r_  generation:  0.01901865005493164
local_output_nid generation:  0.0015716552734375
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0014834403991699219
r_  generation:  0.018668174743652344
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0008499622344970703
mini_batch_src_global generation:  0.0014014244079589844
r_  generation:  0.01907825469970703
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008273124694824219
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.01879119873046875
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0008082389831542969
mini_batch_src_global generation:  0.0015254020690917969
r_  generation:  0.018796920776367188
local_output_nid generation:  0.0015087127685546875
local_in_edges_tensor generation:  0.0008540153503417969
mini_batch_src_global generation:  0.0014369487762451172
r_  generation:  0.019040584564208984
local_output_nid generation:  0.001483917236328125
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0015597343444824219
r_  generation:  0.01860952377319336
----------------------check_connections_block total spend ----------------------------- 0.44600915908813477
generate_one_block  0.027210235595703125
generate_one_block  0.02818155288696289
generate_one_block  0.027393817901611328
generate_one_block  0.029613733291625977
generate_one_block  0.028174400329589844
generate_one_block  0.027709245681762695
generate_one_block  0.027424097061157227
generate_one_block  0.027715682983398438
generate_one_block  0.027910709381103516
generate_one_block  0.02798748016357422
generate_one_block  0.0272982120513916
generate_one_block  0.02788257598876953
generate_one_block  0.027341127395629883
generate_one_block  0.0282135009765625
generate_one_block  0.027722835540771484
generate_one_block  0.02787184715270996
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.040140390396118164
gen group dst list time:  0.018837451934814453
time for parepare:  0.019084453582763672
local_output_nid generation:  0.006684541702270508
local_in_edges_tensor generation:  0.016231298446655273
mini_batch_src_global generation:  0.019744873046875
r_  generation:  0.19925594329833984
local_output_nid generation:  0.009966611862182617
local_in_edges_tensor generation:  0.018259286880493164
mini_batch_src_global generation:  0.02505040168762207
r_  generation:  0.20684099197387695
local_output_nid generation:  0.010251522064208984
local_in_edges_tensor generation:  0.01320505142211914
mini_batch_src_global generation:  0.024194717407226562
r_  generation:  0.20966887474060059
local_output_nid generation:  0.010708093643188477
local_in_edges_tensor generation:  0.015929460525512695
mini_batch_src_global generation:  0.025225400924682617
r_  generation:  0.21517372131347656
local_output_nid generation:  0.010669708251953125
local_in_edges_tensor generation:  0.014030694961547852
mini_batch_src_global generation:  0.02650165557861328
r_  generation:  0.2151775360107422
local_output_nid generation:  0.010933399200439453
local_in_edges_tensor generation:  0.013942956924438477
mini_batch_src_global generation:  0.03191637992858887
r_  generation:  0.21700334548950195
local_output_nid generation:  0.010983467102050781
local_in_edges_tensor generation:  0.012264251708984375
mini_batch_src_global generation:  0.027009248733520508
r_  generation:  0.21267962455749512
local_output_nid generation:  0.011137247085571289
local_in_edges_tensor generation:  0.013980388641357422
mini_batch_src_global generation:  0.027074337005615234
r_  generation:  0.2176990509033203
local_output_nid generation:  0.011160612106323242
local_in_edges_tensor generation:  0.019253015518188477
mini_batch_src_global generation:  0.027582883834838867
r_  generation:  0.21867942810058594
local_output_nid generation:  0.01111912727355957
local_in_edges_tensor generation:  0.01400136947631836
mini_batch_src_global generation:  0.027668476104736328
r_  generation:  0.21715974807739258
local_output_nid generation:  0.010905265808105469
local_in_edges_tensor generation:  0.012224435806274414
mini_batch_src_global generation:  0.026940584182739258
r_  generation:  0.21217894554138184
local_output_nid generation:  0.01152491569519043
local_in_edges_tensor generation:  0.014113426208496094
mini_batch_src_global generation:  0.029619216918945312
r_  generation:  0.22204256057739258
local_output_nid generation:  0.011153936386108398
local_in_edges_tensor generation:  0.012454509735107422
mini_batch_src_global generation:  0.027330636978149414
r_  generation:  0.2135014533996582
local_output_nid generation:  0.011171817779541016
local_in_edges_tensor generation:  0.013874292373657227
mini_batch_src_global generation:  0.027368545532226562
r_  generation:  0.21715211868286133
local_output_nid generation:  0.011151790618896484
local_in_edges_tensor generation:  0.012168645858764648
mini_batch_src_global generation:  0.02765512466430664
r_  generation:  0.21686148643493652
local_output_nid generation:  0.011210918426513672
local_in_edges_tensor generation:  0.01564931869506836
mini_batch_src_global generation:  0.028119802474975586
r_  generation:  0.21510696411132812
----------------------check_connections_block total spend ----------------------------- 5.042839527130127
generate_one_block  0.2868368625640869
generate_one_block  0.28870368003845215
generate_one_block  0.27433109283447266
generate_one_block  0.2858905792236328
generate_one_block  0.30005598068237305
generate_one_block  0.28292131423950195
generate_one_block  0.27588558197021484
generate_one_block  0.28273987770080566
generate_one_block  0.2886989116668701
generate_one_block  0.2806527614593506
generate_one_block  0.2697741985321045
generate_one_block  0.2868046760559082
generate_one_block  0.2747306823730469
generate_one_block  0.2797098159790039
generate_one_block  0.2851881980895996
generate_one_block  0.2816643714904785
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04113125801086426
gen group dst list time:  0.05935835838317871
time for parepare:  0.018768787384033203
local_output_nid generation:  0.02350616455078125
local_in_edges_tensor generation:  0.04051494598388672
mini_batch_src_global generation:  0.05102348327636719
r_  generation:  0.48455238342285156
local_output_nid generation:  0.029575824737548828
local_in_edges_tensor generation:  0.048187971115112305
mini_batch_src_global generation:  0.05829882621765137
r_  generation:  0.4967226982116699
local_output_nid generation:  0.02945852279663086
local_in_edges_tensor generation:  0.03570365905761719
mini_batch_src_global generation:  0.05808591842651367
r_  generation:  0.5038578510284424
local_output_nid generation:  0.029835939407348633
local_in_edges_tensor generation:  0.04122281074523926
mini_batch_src_global generation:  0.06236910820007324
r_  generation:  0.5084228515625
local_output_nid generation:  0.029787302017211914
local_in_edges_tensor generation:  0.03592276573181152
mini_batch_src_global generation:  0.05875110626220703
r_  generation:  0.5063478946685791
local_output_nid generation:  0.030443906784057617
local_in_edges_tensor generation:  0.03582119941711426
mini_batch_src_global generation:  0.0600128173828125
r_  generation:  0.5057930946350098
local_output_nid generation:  0.030338287353515625
local_in_edges_tensor generation:  0.04020833969116211
mini_batch_src_global generation:  0.05881309509277344
r_  generation:  0.5098950862884521
local_output_nid generation:  0.030347585678100586
local_in_edges_tensor generation:  0.03210163116455078
mini_batch_src_global generation:  0.06023049354553223
r_  generation:  0.514580488204956
local_output_nid generation:  0.031043291091918945
local_in_edges_tensor generation:  0.03618907928466797
mini_batch_src_global generation:  0.06408476829528809
r_  generation:  0.51175856590271
local_output_nid generation:  0.03097248077392578
local_in_edges_tensor generation:  0.04485583305358887
mini_batch_src_global generation:  0.05932188034057617
r_  generation:  0.5060772895812988
local_output_nid generation:  0.030270814895629883
local_in_edges_tensor generation:  0.031590938568115234
mini_batch_src_global generation:  0.059404850006103516
r_  generation:  0.5153064727783203
local_output_nid generation:  0.0305936336517334
local_in_edges_tensor generation:  0.056722402572631836
mini_batch_src_global generation:  0.060064077377319336
r_  generation:  0.5078139305114746
local_output_nid generation:  0.03037548065185547
local_in_edges_tensor generation:  0.0346834659576416
mini_batch_src_global generation:  0.05893206596374512
r_  generation:  0.5089051723480225
local_output_nid generation:  0.030161142349243164
local_in_edges_tensor generation:  0.0392146110534668
mini_batch_src_global generation:  0.05914902687072754
r_  generation:  0.5114741325378418
local_output_nid generation:  0.031455039978027344
local_in_edges_tensor generation:  0.03506112098693848
mini_batch_src_global generation:  0.05892300605773926
r_  generation:  0.5084099769592285
local_output_nid generation:  0.030483722686767578
local_in_edges_tensor generation:  0.03410649299621582
mini_batch_src_global generation:  0.059981346130371094
r_  generation:  0.5073039531707764
----------------------check_connections_block total spend ----------------------------- 11.887118101119995
generate_one_block  0.6602108478546143
generate_one_block  0.6617763042449951
generate_one_block  0.7026340961456299
generate_one_block  0.6620674133300781
generate_one_block  0.6643509864807129
generate_one_block  0.66994309425354
generate_one_block  0.7213068008422852
generate_one_block  0.6784653663635254
generate_one_block  0.6714885234832764
generate_one_block  0.6637246608734131
generate_one_block  0.6512863636016846
generate_one_block  0.6826045513153076
generate_one_block  0.6430504322052002
generate_one_block  0.6495943069458008
generate_one_block  0.6552307605743408
generate_one_block  0.6627476215362549
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06835079193115234
gen group dst list time:  0.103607177734375
time for parepare:  0.019600868225097656
local_output_nid generation:  0.03201007843017578
local_in_edges_tensor generation:  0.059218645095825195
mini_batch_src_global generation:  0.05366039276123047
r_  generation:  0.5276856422424316
local_output_nid generation:  0.03743267059326172
local_in_edges_tensor generation:  0.05611133575439453
mini_batch_src_global generation:  0.06523990631103516
r_  generation:  0.5345463752746582
local_output_nid generation:  0.03664803504943848
local_in_edges_tensor generation:  0.04403948783874512
mini_batch_src_global generation:  0.06289982795715332
r_  generation:  0.539233922958374
local_output_nid generation:  0.036812782287597656
local_in_edges_tensor generation:  0.058411359786987305
mini_batch_src_global generation:  0.05859375
r_  generation:  0.542881965637207
local_output_nid generation:  0.037520408630371094
local_in_edges_tensor generation:  0.046277523040771484
mini_batch_src_global generation:  0.059256792068481445
r_  generation:  0.5491130352020264
local_output_nid generation:  0.03730487823486328
local_in_edges_tensor generation:  0.04430270195007324
mini_batch_src_global generation:  0.06302356719970703
r_  generation:  0.5519258975982666
local_output_nid generation:  0.037152767181396484
local_in_edges_tensor generation:  0.037566423416137695
mini_batch_src_global generation:  0.059545040130615234
r_  generation:  0.5560448169708252
local_output_nid generation:  0.04102063179016113
local_in_edges_tensor generation:  0.04532361030578613
mini_batch_src_global generation:  0.05976104736328125
r_  generation:  0.5567550659179688
local_output_nid generation:  0.03793740272521973
local_in_edges_tensor generation:  0.04677581787109375
mini_batch_src_global generation:  0.06386423110961914
r_  generation:  0.5594449043273926
local_output_nid generation:  0.03787803649902344
local_in_edges_tensor generation:  0.051729440689086914
mini_batch_src_global generation:  0.06312775611877441
r_  generation:  0.5704913139343262
local_output_nid generation:  0.0388791561126709
local_in_edges_tensor generation:  0.045365333557128906
mini_batch_src_global generation:  0.0638265609741211
r_  generation:  0.5707156658172607
local_output_nid generation:  0.04075431823730469
local_in_edges_tensor generation:  0.04489398002624512
mini_batch_src_global generation:  0.06572937965393066
r_  generation:  0.5607454776763916
local_output_nid generation:  0.039029598236083984
local_in_edges_tensor generation:  0.04129195213317871
mini_batch_src_global generation:  0.06139802932739258
r_  generation:  0.5605258941650391
local_output_nid generation:  0.03890347480773926
local_in_edges_tensor generation:  0.03733181953430176
mini_batch_src_global generation:  0.06052827835083008
r_  generation:  0.5597481727600098
local_output_nid generation:  0.038782596588134766
local_in_edges_tensor generation:  0.048517704010009766
mini_batch_src_global generation:  0.06031632423400879
r_  generation:  0.5628855228424072
local_output_nid generation:  0.03917407989501953
local_in_edges_tensor generation:  0.04261612892150879
mini_batch_src_global generation:  0.06551218032836914
r_  generation:  0.5710244178771973
----------------------check_connections_block total spend ----------------------------- 13.32110071182251
generate_one_block  0.6866271495819092
generate_one_block  0.6845650672912598
generate_one_block  0.7679016590118408
generate_one_block  0.6987526416778564
generate_one_block  0.6859910488128662
generate_one_block  0.6861999034881592
generate_one_block  0.6721038818359375
generate_one_block  0.7130856513977051
generate_one_block  0.708709716796875
generate_one_block  0.7015290260314941
generate_one_block  0.6727752685546875
generate_one_block  0.6762440204620361
generate_one_block  0.6699087619781494
generate_one_block  0.683356523513794
generate_one_block  0.6778485774993896
generate_one_block  0.6829979419708252
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05575108528137207
gen group dst list time:  0.09981846809387207
time for parepare:  0.019436120986938477
local_output_nid generation:  0.03489398956298828
local_in_edges_tensor generation:  0.04540896415710449
mini_batch_src_global generation:  0.046217918395996094
r_  generation:  0.5003912448883057
local_output_nid generation:  0.04066324234008789
local_in_edges_tensor generation:  0.03798985481262207
mini_batch_src_global generation:  0.05817747116088867
r_  generation:  0.5124738216400146
local_output_nid generation:  0.038831472396850586
local_in_edges_tensor generation:  0.038841962814331055
mini_batch_src_global generation:  0.059505462646484375
r_  generation:  0.5099079608917236
local_output_nid generation:  0.03889012336730957
local_in_edges_tensor generation:  0.043738603591918945
mini_batch_src_global generation:  0.057301998138427734
r_  generation:  0.5146543979644775
local_output_nid generation:  0.038846731185913086
local_in_edges_tensor generation:  0.04235363006591797
mini_batch_src_global generation:  0.05840325355529785
r_  generation:  0.5138053894042969
local_output_nid generation:  0.039339542388916016
local_in_edges_tensor generation:  0.04767751693725586
mini_batch_src_global generation:  0.058654069900512695
r_  generation:  0.5209686756134033
local_output_nid generation:  0.039191484451293945
local_in_edges_tensor generation:  0.04365873336791992
mini_batch_src_global generation:  0.057723045349121094
r_  generation:  0.5195510387420654
local_output_nid generation:  0.03936171531677246
local_in_edges_tensor generation:  0.040711402893066406
mini_batch_src_global generation:  0.06068277359008789
r_  generation:  0.5453295707702637
local_output_nid generation:  0.04035210609436035
local_in_edges_tensor generation:  0.052065372467041016
mini_batch_src_global generation:  0.06020045280456543
r_  generation:  0.5226883888244629
local_output_nid generation:  0.03942275047302246
local_in_edges_tensor generation:  0.04848456382751465
mini_batch_src_global generation:  0.059407949447631836
r_  generation:  0.5276000499725342
local_output_nid generation:  0.04126691818237305
local_in_edges_tensor generation:  0.03670787811279297
mini_batch_src_global generation:  0.05909132957458496
r_  generation:  0.519345760345459
local_output_nid generation:  0.040593624114990234
local_in_edges_tensor generation:  0.04115033149719238
mini_batch_src_global generation:  0.05750155448913574
r_  generation:  0.5228731632232666
local_output_nid generation:  0.04108095169067383
local_in_edges_tensor generation:  0.04087042808532715
mini_batch_src_global generation:  0.05737590789794922
r_  generation:  0.5205919742584229
local_output_nid generation:  0.04065299034118652
local_in_edges_tensor generation:  0.04564976692199707
mini_batch_src_global generation:  0.057237863540649414
r_  generation:  0.521862268447876
local_output_nid generation:  0.04062247276306152
local_in_edges_tensor generation:  0.04555845260620117
mini_batch_src_global generation:  0.05756998062133789
r_  generation:  0.5268723964691162
local_output_nid generation:  0.04053330421447754
local_in_edges_tensor generation:  0.040468692779541016
mini_batch_src_global generation:  0.05716967582702637
r_  generation:  0.5246117115020752
----------------------check_connections_block total spend ----------------------------- 12.536088228225708
generate_one_block  0.633561372756958
generate_one_block  0.6411609649658203
generate_one_block  0.6429286003112793
generate_one_block  0.657792329788208
generate_one_block  0.7049071788787842
generate_one_block  0.6330852508544922
generate_one_block  0.6400387287139893
generate_one_block  0.6426055431365967
generate_one_block  0.6418311595916748
generate_one_block  0.6455848217010498
generate_one_block  0.625206708908081
generate_one_block  0.6242339611053467
generate_one_block  0.624298095703125
generate_one_block  0.6560802459716797
generate_one_block  0.6251652240753174
generate_one_block  0.6361665725708008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0001811981201171875  GigaBytes
Max Memory Allocated: 0.0001811981201171875  GigaBytes

connection checking time:  42.78714656829834
block generation total time  36.56831431388855
average batch blocks generation time:  2.2855196446180344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1219029426574707  GigaBytes
Max Memory Allocated: 0.1219029426574707  GigaBytes

torch.Size([166303, 128])
torch.Size([164027, 64])
torch.Size([156028, 64])
torch.Size([124021, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6234540939331055  GigaBytes
Max Memory Allocated: 0.6312789916992188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12344598770141602  GigaBytes
Max Memory Allocated: 0.6452431678771973  GigaBytes

torch.Size([166346, 128])
torch.Size([163939, 64])
torch.Size([155647, 64])
torch.Size([123566, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6214866638183594  GigaBytes
Max Memory Allocated: 0.6452431678771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12342691421508789  GigaBytes
Max Memory Allocated: 0.6452431678771973  GigaBytes

torch.Size([166319, 128])
torch.Size([164067, 64])
torch.Size([155872, 64])
torch.Size([123684, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6218981742858887  GigaBytes
Max Memory Allocated: 0.6452431678771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12348699569702148  GigaBytes
Max Memory Allocated: 0.6452431678771973  GigaBytes

torch.Size([166373, 128])
torch.Size([164172, 64])
torch.Size([156119, 64])
torch.Size([124583, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.625035285949707  GigaBytes
Max Memory Allocated: 0.6452431678771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.12343692779541016  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166303, 128])
torch.Size([163990, 64])
torch.Size([155875, 64])
torch.Size([123780, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.622124195098877  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.1234598159790039  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166269, 128])
torch.Size([163992, 64])
torch.Size([155915, 64])
torch.Size([123894, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.6223263740539551  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12344503402709961  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166283, 128])
torch.Size([163909, 64])
torch.Size([155797, 64])
torch.Size([123888, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6217508316040039  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12344932556152344  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166298, 128])
torch.Size([164003, 64])
torch.Size([155678, 64])
torch.Size([123542, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6216349601745605  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12345314025878906  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166350, 128])
torch.Size([163941, 64])
torch.Size([155691, 64])
torch.Size([123698, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6218385696411133  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12346887588500977  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166312, 128])
torch.Size([164068, 64])
torch.Size([156189, 64])
torch.Size([124280, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6229519844055176  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12337779998779297  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166172, 128])
torch.Size([163850, 64])
torch.Size([155673, 64])
torch.Size([123266, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6207418441772461  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12346506118774414  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166190, 128])
torch.Size([163865, 64])
torch.Size([155941, 64])
torch.Size([124212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6229562759399414  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12339258193969727  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166191, 128])
torch.Size([163795, 64])
torch.Size([155543, 64])
torch.Size([123333, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6206159591674805  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12342405319213867  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166297, 128])
torch.Size([163942, 64])
torch.Size([155645, 64])
torch.Size([123556, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6211080551147461  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12340784072875977  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166258, 128])
torch.Size([163862, 64])
torch.Size([155724, 64])
torch.Size([123386, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6209144592285156  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12340116500854492  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166265, 128])
torch.Size([163889, 64])
torch.Size([155666, 64])
torch.Size([123319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6208605766296387  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061391934752464294 |0.0545026957988739 |0.04985499382019043 |9.422004222869873e-05 |0.015821322798728943 |0.006181955337524414 |
----------------------------------------------------------pseudo_mini_loss sum 5.575502395629883
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10417900
Number of first layer input nodes during this epoch:  2660529
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.2109532356262207  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.018111228942871094
range selection method range initialization spend 0.011660099029541016
time for parepare:  0.016557693481445312
local_output_nid generation:  0.0013685226440429688
local_in_edges_tensor generation:  0.005764484405517578
mini_batch_src_global generation:  0.0018801689147949219
r_  generation:  0.017849206924438477
local_output_nid generation:  0.001592874526977539
local_in_edges_tensor generation:  0.0009307861328125
mini_batch_src_global generation:  0.001936197280883789
r_  generation:  0.019527435302734375
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0014579296112060547
r_  generation:  0.01914215087890625
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0008819103240966797
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.01907825469970703
local_output_nid generation:  0.0015559196472167969
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.0014939308166503906
r_  generation:  0.01915764808654785
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0015103816986083984
r_  generation:  0.01881575584411621
local_output_nid generation:  0.001566171646118164
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0014371871948242188
r_  generation:  0.019034147262573242
local_output_nid generation:  0.0015017986297607422
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0015039443969726562
r_  generation:  0.019330978393554688
local_output_nid generation:  0.0015082359313964844
local_in_edges_tensor generation:  0.0008192062377929688
mini_batch_src_global generation:  0.0014660358428955078
r_  generation:  0.018973827362060547
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0008306503295898438
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.018970012664794922
local_output_nid generation:  0.0015103816986083984
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0014967918395996094
r_  generation:  0.01900506019592285
local_output_nid generation:  0.0014986991882324219
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.001528024673461914
r_  generation:  0.019460439682006836
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0008270740509033203
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.01954817771911621
local_output_nid generation:  0.001527547836303711
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.001482248306274414
r_  generation:  0.01926565170288086
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0015146732330322266
r_  generation:  0.01918339729309082
local_output_nid generation:  0.0015857219696044922
local_in_edges_tensor generation:  0.0008406639099121094
mini_batch_src_global generation:  0.0014789104461669922
r_  generation:  0.01908588409423828
----------------------check_connections_block total spend ----------------------------- 0.45664381980895996
generate_one_block  0.02614736557006836
generate_one_block  0.028139591217041016
generate_one_block  0.0276641845703125
generate_one_block  0.027827024459838867
generate_one_block  0.028035402297973633
generate_one_block  0.028970956802368164
generate_one_block  0.027321338653564453
generate_one_block  0.02742314338684082
generate_one_block  0.027513742446899414
generate_one_block  0.02724599838256836
generate_one_block  0.027297019958496094
generate_one_block  0.02743816375732422
generate_one_block  0.027925729751586914
generate_one_block  0.027716875076293945
generate_one_block  0.027261972427368164
generate_one_block  0.027806520462036133
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03789377212524414
gen group dst list time:  0.016300201416015625
time for parepare:  0.018671035766601562
local_output_nid generation:  0.006496906280517578
local_in_edges_tensor generation:  0.01700568199157715
mini_batch_src_global generation:  0.019150733947753906
r_  generation:  0.1933300495147705
local_output_nid generation:  0.009926557540893555
local_in_edges_tensor generation:  0.01784205436706543
mini_batch_src_global generation:  0.02640843391418457
r_  generation:  0.20556974411010742
local_output_nid generation:  0.010626554489135742
local_in_edges_tensor generation:  0.014728546142578125
mini_batch_src_global generation:  0.024216175079345703
r_  generation:  0.22217941284179688
local_output_nid generation:  0.012740612030029297
local_in_edges_tensor generation:  0.01638317108154297
mini_batch_src_global generation:  0.025379419326782227
r_  generation:  0.2150707244873047
local_output_nid generation:  0.011367082595825195
local_in_edges_tensor generation:  0.013103246688842773
mini_batch_src_global generation:  0.0266265869140625
r_  generation:  0.2178657054901123
local_output_nid generation:  0.010816097259521484
local_in_edges_tensor generation:  0.011356353759765625
mini_batch_src_global generation:  0.0264437198638916
r_  generation:  0.21157121658325195
local_output_nid generation:  0.011460542678833008
local_in_edges_tensor generation:  0.012570619583129883
mini_batch_src_global generation:  0.028005599975585938
r_  generation:  0.21307158470153809
local_output_nid generation:  0.011693239212036133
local_in_edges_tensor generation:  0.016254663467407227
mini_batch_src_global generation:  0.026707887649536133
r_  generation:  0.2147965431213379
local_output_nid generation:  0.011580705642700195
local_in_edges_tensor generation:  0.011179447174072266
mini_batch_src_global generation:  0.02697277069091797
r_  generation:  0.21390604972839355
local_output_nid generation:  0.01191091537475586
local_in_edges_tensor generation:  0.011609077453613281
mini_batch_src_global generation:  0.02665996551513672
r_  generation:  0.21269774436950684
local_output_nid generation:  0.011915922164916992
local_in_edges_tensor generation:  0.01475381851196289
mini_batch_src_global generation:  0.028340816497802734
r_  generation:  0.2168278694152832
local_output_nid generation:  0.011991262435913086
local_in_edges_tensor generation:  0.013272285461425781
mini_batch_src_global generation:  0.028748035430908203
r_  generation:  0.21649718284606934
local_output_nid generation:  0.011578559875488281
local_in_edges_tensor generation:  0.015298128128051758
mini_batch_src_global generation:  0.02739405632019043
r_  generation:  0.22252607345581055
local_output_nid generation:  0.011504173278808594
local_in_edges_tensor generation:  0.01349949836730957
mini_batch_src_global generation:  0.02762293815612793
r_  generation:  0.21588873863220215
local_output_nid generation:  0.011386871337890625
local_in_edges_tensor generation:  0.01143956184387207
mini_batch_src_global generation:  0.02698826789855957
r_  generation:  0.21693634986877441
local_output_nid generation:  0.011461019515991211
local_in_edges_tensor generation:  0.012986183166503906
mini_batch_src_global generation:  0.027247905731201172
r_  generation:  0.21734118461608887
----------------------check_connections_block total spend ----------------------------- 5.0200889110565186
generate_one_block  0.27028393745422363
generate_one_block  0.28319287300109863
generate_one_block  0.28652167320251465
generate_one_block  0.2820920944213867
generate_one_block  0.2829017639160156
generate_one_block  0.27207112312316895
generate_one_block  0.2957267761230469
generate_one_block  0.27941250801086426
generate_one_block  0.2706429958343506
generate_one_block  0.2739741802215576
generate_one_block  0.27434229850769043
generate_one_block  0.28134846687316895
generate_one_block  0.28052592277526855
generate_one_block  0.27979016304016113
generate_one_block  0.28349971771240234
generate_one_block  0.27629780769348145
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03925442695617676
gen group dst list time:  0.059244632720947266
time for parepare:  0.01788473129272461
local_output_nid generation:  0.023865699768066406
local_in_edges_tensor generation:  0.05106472969055176
mini_batch_src_global generation:  0.04898500442504883
r_  generation:  0.4848635196685791
local_output_nid generation:  0.029548168182373047
local_in_edges_tensor generation:  0.047330379486083984
mini_batch_src_global generation:  0.06071639060974121
r_  generation:  0.4948258399963379
local_output_nid generation:  0.0297544002532959
local_in_edges_tensor generation:  0.04257798194885254
mini_batch_src_global generation:  0.05684518814086914
r_  generation:  0.49685144424438477
local_output_nid generation:  0.029896259307861328
local_in_edges_tensor generation:  0.039267778396606445
mini_batch_src_global generation:  0.059655189514160156
r_  generation:  0.4963808059692383
local_output_nid generation:  0.03039383888244629
local_in_edges_tensor generation:  0.08223390579223633
mini_batch_src_global generation:  0.05754375457763672
r_  generation:  0.5034389495849609
local_output_nid generation:  0.03025054931640625
local_in_edges_tensor generation:  0.029897451400756836
mini_batch_src_global generation:  0.05911540985107422
r_  generation:  0.49640369415283203
local_output_nid generation:  0.030075550079345703
local_in_edges_tensor generation:  0.02997756004333496
mini_batch_src_global generation:  0.05811333656311035
r_  generation:  0.50091552734375
local_output_nid generation:  0.030360698699951172
local_in_edges_tensor generation:  0.0344843864440918
mini_batch_src_global generation:  0.05950164794921875
r_  generation:  0.49703454971313477
local_output_nid generation:  0.030274152755737305
local_in_edges_tensor generation:  0.03933572769165039
mini_batch_src_global generation:  0.05812668800354004
r_  generation:  0.5029678344726562
local_output_nid generation:  0.03022170066833496
local_in_edges_tensor generation:  0.030703067779541016
mini_batch_src_global generation:  0.05924367904663086
r_  generation:  0.49890685081481934
local_output_nid generation:  0.03041386604309082
local_in_edges_tensor generation:  0.04533267021179199
mini_batch_src_global generation:  0.058417558670043945
r_  generation:  0.5038139820098877
local_output_nid generation:  0.030616044998168945
local_in_edges_tensor generation:  0.030406713485717773
mini_batch_src_global generation:  0.05922293663024902
r_  generation:  0.5026915073394775
local_output_nid generation:  0.03061532974243164
local_in_edges_tensor generation:  0.04420661926269531
mini_batch_src_global generation:  0.058268070220947266
r_  generation:  0.5085101127624512
local_output_nid generation:  0.032425642013549805
local_in_edges_tensor generation:  0.040227413177490234
mini_batch_src_global generation:  0.05904078483581543
r_  generation:  0.4994330406188965
local_output_nid generation:  0.030486345291137695
local_in_edges_tensor generation:  0.03916430473327637
mini_batch_src_global generation:  0.05856180191040039
r_  generation:  0.5018055438995361
local_output_nid generation:  0.030457735061645508
local_in_edges_tensor generation:  0.03507280349731445
mini_batch_src_global generation:  0.05935788154602051
r_  generation:  0.5012669563293457
----------------------check_connections_block total spend ----------------------------- 11.780654907226562
generate_one_block  0.6302740573883057
generate_one_block  0.6422033309936523
generate_one_block  0.6520590782165527
generate_one_block  0.6505241394042969
generate_one_block  0.645564079284668
generate_one_block  0.6320266723632812
generate_one_block  0.6299409866333008
generate_one_block  0.631922721862793
generate_one_block  0.6765842437744141
generate_one_block  0.6401546001434326
generate_one_block  0.6409919261932373
generate_one_block  0.6496825218200684
generate_one_block  0.6516220569610596
generate_one_block  0.6298291683197021
generate_one_block  0.6460771560668945
generate_one_block  0.6427805423736572
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03430914878845215
gen group dst list time:  0.0817878246307373
time for parepare:  0.019366025924682617
local_output_nid generation:  0.03098011016845703
local_in_edges_tensor generation:  0.04427647590637207
mini_batch_src_global generation:  0.052153825759887695
r_  generation:  0.5243575572967529
local_output_nid generation:  0.038407325744628906
local_in_edges_tensor generation:  0.05486321449279785
mini_batch_src_global generation:  0.06134486198425293
r_  generation:  0.5317380428314209
local_output_nid generation:  0.038309335708618164
local_in_edges_tensor generation:  0.045998334884643555
mini_batch_src_global generation:  0.05754518508911133
r_  generation:  0.5398344993591309
local_output_nid generation:  0.03906679153442383
local_in_edges_tensor generation:  0.0363612174987793
mini_batch_src_global generation:  0.05786013603210449
r_  generation:  0.5349469184875488
local_output_nid generation:  0.03665947914123535
local_in_edges_tensor generation:  0.04861330986022949
mini_batch_src_global generation:  0.06198263168334961
r_  generation:  0.5478312969207764
local_output_nid generation:  0.03691554069519043
local_in_edges_tensor generation:  0.04140782356262207
mini_batch_src_global generation:  0.05840587615966797
r_  generation:  0.5370900630950928
local_output_nid generation:  0.0369718074798584
local_in_edges_tensor generation:  0.03599214553833008
mini_batch_src_global generation:  0.057813167572021484
r_  generation:  0.5529072284698486
local_output_nid generation:  0.037796735763549805
local_in_edges_tensor generation:  0.04606986045837402
mini_batch_src_global generation:  0.059064626693725586
r_  generation:  0.5444130897521973
local_output_nid generation:  0.03707170486450195
local_in_edges_tensor generation:  0.036570072174072266
mini_batch_src_global generation:  0.058624982833862305
r_  generation:  0.552344799041748
local_output_nid generation:  0.0365147590637207
local_in_edges_tensor generation:  0.04546856880187988
mini_batch_src_global generation:  0.06011366844177246
r_  generation:  0.5515570640563965
local_output_nid generation:  0.03714561462402344
local_in_edges_tensor generation:  0.045578718185424805
mini_batch_src_global generation:  0.05999135971069336
r_  generation:  0.5573318004608154
local_output_nid generation:  0.03741621971130371
local_in_edges_tensor generation:  0.04129624366760254
mini_batch_src_global generation:  0.06033897399902344
r_  generation:  0.5517075061798096
local_output_nid generation:  0.03766274452209473
local_in_edges_tensor generation:  0.04099559783935547
mini_batch_src_global generation:  0.06026053428649902
r_  generation:  0.5562291145324707
local_output_nid generation:  0.03746676445007324
local_in_edges_tensor generation:  0.04120230674743652
mini_batch_src_global generation:  0.06400489807128906
r_  generation:  0.553530216217041
local_output_nid generation:  0.0376431941986084
local_in_edges_tensor generation:  0.04134726524353027
mini_batch_src_global generation:  0.06384634971618652
r_  generation:  0.5638015270233154
local_output_nid generation:  0.03768754005432129
local_in_edges_tensor generation:  0.037222862243652344
mini_batch_src_global generation:  0.0608057975769043
r_  generation:  0.5538887977600098
----------------------check_connections_block total spend ----------------------------- 13.036319494247437
generate_one_block  0.6835227012634277
generate_one_block  0.7435977458953857
generate_one_block  0.6947762966156006
generate_one_block  0.7091529369354248
generate_one_block  0.7051668167114258
generate_one_block  0.6969356536865234
generate_one_block  0.7797436714172363
generate_one_block  0.6980605125427246
generate_one_block  0.6925771236419678
generate_one_block  0.6983160972595215
generate_one_block  0.7008087635040283
generate_one_block  0.7279641628265381
generate_one_block  0.6824760437011719
generate_one_block  0.7109794616699219
generate_one_block  0.6917216777801514
generate_one_block  0.7055881023406982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06169295310974121
gen group dst list time:  0.1152796745300293
time for parepare:  0.01862955093383789
local_output_nid generation:  0.03475785255432129
local_in_edges_tensor generation:  0.05027508735656738
mini_batch_src_global generation:  0.04366159439086914
r_  generation:  0.5094199180603027
local_output_nid generation:  0.04026961326599121
local_in_edges_tensor generation:  0.03806281089782715
mini_batch_src_global generation:  0.058443307876586914
r_  generation:  0.5117299556732178
local_output_nid generation:  0.039696455001831055
local_in_edges_tensor generation:  0.043938398361206055
mini_batch_src_global generation:  0.06606364250183105
r_  generation:  0.5280203819274902
local_output_nid generation:  0.042081356048583984
local_in_edges_tensor generation:  0.0411524772644043
mini_batch_src_global generation:  0.05844569206237793
r_  generation:  0.5125646591186523
local_output_nid generation:  0.040242910385131836
local_in_edges_tensor generation:  0.043235063552856445
mini_batch_src_global generation:  0.05671834945678711
r_  generation:  0.5096335411071777
local_output_nid generation:  0.04018259048461914
local_in_edges_tensor generation:  0.038808345794677734
mini_batch_src_global generation:  0.056870460510253906
r_  generation:  0.5092852115631104
local_output_nid generation:  0.04034423828125
local_in_edges_tensor generation:  0.0402376651763916
mini_batch_src_global generation:  0.05644536018371582
r_  generation:  0.5237202644348145
local_output_nid generation:  0.04063987731933594
local_in_edges_tensor generation:  0.0467226505279541
mini_batch_src_global generation:  0.05704212188720703
r_  generation:  0.5119030475616455
local_output_nid generation:  0.040493011474609375
local_in_edges_tensor generation:  0.0390017032623291
mini_batch_src_global generation:  0.06188774108886719
r_  generation:  0.5220825672149658
local_output_nid generation:  0.04036355018615723
local_in_edges_tensor generation:  0.03825664520263672
mini_batch_src_global generation:  0.05692267417907715
r_  generation:  0.5176436901092529
local_output_nid generation:  0.04079127311706543
local_in_edges_tensor generation:  0.04396557807922363
mini_batch_src_global generation:  0.05779838562011719
r_  generation:  0.5195896625518799
local_output_nid generation:  0.04060006141662598
local_in_edges_tensor generation:  0.03939414024353027
mini_batch_src_global generation:  0.05705404281616211
r_  generation:  0.5177252292633057
local_output_nid generation:  0.041311025619506836
local_in_edges_tensor generation:  0.04523968696594238
mini_batch_src_global generation:  0.06105446815490723
r_  generation:  0.5190834999084473
local_output_nid generation:  0.04061722755432129
local_in_edges_tensor generation:  0.046863555908203125
mini_batch_src_global generation:  0.057464599609375
r_  generation:  0.5317940711975098
local_output_nid generation:  0.04130244255065918
local_in_edges_tensor generation:  0.044370174407958984
mini_batch_src_global generation:  0.05836653709411621
r_  generation:  0.5299811363220215
local_output_nid generation:  0.04327559471130371
local_in_edges_tensor generation:  0.04395174980163574
mini_batch_src_global generation:  0.05959367752075195
r_  generation:  0.525956392288208
----------------------check_connections_block total spend ----------------------------- 12.535978078842163
generate_one_block  0.6390736103057861
generate_one_block  0.6439082622528076
generate_one_block  0.6457939147949219
generate_one_block  0.652885913848877
generate_one_block  0.6406445503234863
generate_one_block  0.6457118988037109
generate_one_block  0.6382052898406982
generate_one_block  0.6472387313842773
generate_one_block  0.6418271064758301
generate_one_block  0.7240383625030518
generate_one_block  0.6409881114959717
generate_one_block  0.6396808624267578
generate_one_block  0.6382136344909668
generate_one_block  0.6393880844116211
generate_one_block  0.6414709091186523
generate_one_block  0.6406919956207275
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.2109532356262207  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

connection checking time:  42.37304139137268
block generation total time  36.44601058959961
average batch blocks generation time:  2.2778756618499756
block dataloader generation time/epoch 81.75307488441467
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12374305725097656  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166185, 128])
torch.Size([163786, 64])
torch.Size([155375, 64])
torch.Size([122999, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6203784942626953  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12380695343017578  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166341, 128])
torch.Size([164040, 64])
torch.Size([155978, 64])
torch.Size([123936, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6229419708251953  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12382841110229492  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166215, 128])
torch.Size([163875, 64])
torch.Size([155865, 64])
torch.Size([124319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6233639717102051  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12382364273071289  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166207, 128])
torch.Size([163863, 64])
torch.Size([155718, 64])
torch.Size([124089, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6227855682373047  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12383890151977539  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166215, 128])
torch.Size([163857, 64])
torch.Size([155761, 64])
torch.Size([124202, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6244912147521973  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12377357482910156  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166298, 128])
torch.Size([163938, 64])
torch.Size([155816, 64])
torch.Size([123914, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6220893859863281  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12378597259521484  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166320, 128])
torch.Size([164009, 64])
torch.Size([155837, 64])
torch.Size([123530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6217484474182129  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12375354766845703  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166286, 128])
torch.Size([163919, 64])
torch.Size([155807, 64])
torch.Size([123662, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6219596862792969  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12376213073730469  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166305, 128])
torch.Size([163959, 64])
torch.Size([155665, 64])
torch.Size([123767, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6220946311950684  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12375545501708984  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166190, 128])
torch.Size([163864, 64])
torch.Size([155489, 64])
torch.Size([123281, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6210713386535645  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12378883361816406  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166267, 128])
torch.Size([163993, 64])
torch.Size([155930, 64])
torch.Size([123952, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6223263740539551  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12380313873291016  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166343, 128])
torch.Size([164016, 64])
torch.Size([155925, 64])
torch.Size([123849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6223239898681641  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12381601333618164  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166187, 128])
torch.Size([163769, 64])
torch.Size([155616, 64])
torch.Size([123853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6223869323730469  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12377786636352539  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166220, 128])
torch.Size([163836, 64])
torch.Size([155673, 64])
torch.Size([123432, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6215109825134277  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12379884719848633  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166332, 128])
torch.Size([164018, 64])
torch.Size([155718, 64])
torch.Size([123803, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6219620704650879  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.12378406524658203  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

torch.Size([166342, 128])
torch.Size([163976, 64])
torch.Size([155657, 64])
torch.Size([123500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.6215672492980957  GigaBytes
Max Memory Allocated: 0.6471514701843262  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06144815683364868 |0.03611983358860016 |0.005453541874885559 |8.837878704071045e-05 |0.006476476788520813 |0.004754066467285156 |
----------------------------------------------------------pseudo_mini_loss sum 4.4586639404296875
Total (block generation + training)time/epoch 83.57079410552979
Training time/epoch 1.8174304962158203
Training time without block to device /epoch 1.2395131587982178
Training time without total dataloading part /epoch 0.19704842567443848
load block tensor time/epoch 0.9831705093383789
block to device time/epoch 0.5779173374176025
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10416250
Number of first layer input nodes during this epoch:  2660253
