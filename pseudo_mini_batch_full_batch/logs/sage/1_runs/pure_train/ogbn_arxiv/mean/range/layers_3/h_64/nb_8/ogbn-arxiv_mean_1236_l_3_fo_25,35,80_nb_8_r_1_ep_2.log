Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648447960.9002032
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028959989547729492
range selection method range initialization spend 0.0173494815826416
time for parepare:  0.017931222915649414
local_output_nid generation:  0.002697467803955078
local_in_edges_tensor generation:  0.0042035579681396484
mini_batch_src_global generation:  0.004553318023681641
r_  generation:  0.05669879913330078
local_output_nid generation:  0.003192901611328125
local_in_edges_tensor generation:  0.0016207695007324219
mini_batch_src_global generation:  0.0046558380126953125
r_  generation:  0.04248809814453125
local_output_nid generation:  0.003231048583984375
local_in_edges_tensor generation:  0.0016982555389404297
mini_batch_src_global generation:  0.0032460689544677734
r_  generation:  0.043709516525268555
local_output_nid generation:  0.003176450729370117
local_in_edges_tensor generation:  0.0017158985137939453
mini_batch_src_global generation:  0.0035185813903808594
r_  generation:  0.0454256534576416
local_output_nid generation:  0.003161191940307617
local_in_edges_tensor generation:  0.0017714500427246094
mini_batch_src_global generation:  0.0036725997924804688
r_  generation:  0.047168731689453125
local_output_nid generation:  0.0031845569610595703
local_in_edges_tensor generation:  0.0017237663269042969
mini_batch_src_global generation:  0.003729104995727539
r_  generation:  0.045464515686035156
local_output_nid generation:  0.0031523704528808594
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.003682851791381836
r_  generation:  0.047089338302612305
local_output_nid generation:  0.0031554698944091797
local_in_edges_tensor generation:  0.001772165298461914
mini_batch_src_global generation:  0.0036962032318115234
r_  generation:  0.04632234573364258
----------------------check_connections_block total spend ----------------------------- 0.5419542789459229
generate_one_block  0.061736106872558594
generate_one_block  0.06059670448303223
generate_one_block  0.062398433685302734
generate_one_block  0.06325936317443848
generate_one_block  0.0661168098449707
generate_one_block  0.061080217361450195
generate_one_block  0.062454938888549805
generate_one_block  0.06091022491455078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03863716125488281
gen group dst list time:  0.01644110679626465
time for parepare:  0.019760608673095703
local_output_nid generation:  0.011303186416625977
local_in_edges_tensor generation:  0.031098604202270508
mini_batch_src_global generation:  0.03337550163269043
r_  generation:  0.3171968460083008
local_output_nid generation:  0.01816534996032715
local_in_edges_tensor generation:  0.028755664825439453
mini_batch_src_global generation:  0.038176536560058594
r_  generation:  0.32216382026672363
local_output_nid generation:  0.019083023071289062
local_in_edges_tensor generation:  0.024381160736083984
mini_batch_src_global generation:  0.04090690612792969
r_  generation:  0.33092665672302246
local_output_nid generation:  0.02013707160949707
local_in_edges_tensor generation:  0.01901721954345703
mini_batch_src_global generation:  0.05577898025512695
r_  generation:  0.33096814155578613
local_output_nid generation:  0.02017831802368164
local_in_edges_tensor generation:  0.02245783805847168
mini_batch_src_global generation:  0.04163789749145508
r_  generation:  0.3375685214996338
local_output_nid generation:  0.02029895782470703
local_in_edges_tensor generation:  0.025064468383789062
mini_batch_src_global generation:  0.0536191463470459
r_  generation:  0.3391599655151367
local_output_nid generation:  0.0205385684967041
local_in_edges_tensor generation:  0.024971723556518555
mini_batch_src_global generation:  0.041020870208740234
r_  generation:  0.33510661125183105
local_output_nid generation:  0.02041149139404297
local_in_edges_tensor generation:  0.019182205200195312
mini_batch_src_global generation:  0.041378021240234375
r_  generation:  0.3342421054840088
----------------------check_connections_block total spend ----------------------------- 3.9312872886657715
generate_one_block  0.4388084411621094
generate_one_block  0.42262959480285645
generate_one_block  0.43762707710266113
generate_one_block  0.44286584854125977
generate_one_block  0.44158077239990234
generate_one_block  0.44170188903808594
generate_one_block  0.4408855438232422
generate_one_block  0.42543601989746094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03551816940307617
gen group dst list time:  0.03733181953430176
time for parepare:  0.019500255584716797
local_output_nid generation:  0.025278806686401367
local_in_edges_tensor generation:  0.07225179672241211
mini_batch_src_global generation:  0.049039363861083984
r_  generation:  0.47391724586486816
local_output_nid generation:  0.031949520111083984
local_in_edges_tensor generation:  0.04614686965942383
mini_batch_src_global generation:  0.05424904823303223
r_  generation:  0.4800584316253662
local_output_nid generation:  0.03473401069641113
local_in_edges_tensor generation:  0.0396723747253418
mini_batch_src_global generation:  0.05438804626464844
r_  generation:  0.48514795303344727
local_output_nid generation:  0.03301882743835449
local_in_edges_tensor generation:  0.04209327697753906
mini_batch_src_global generation:  0.05359935760498047
r_  generation:  0.4994940757751465
local_output_nid generation:  0.03293418884277344
local_in_edges_tensor generation:  0.038787126541137695
mini_batch_src_global generation:  0.05681014060974121
r_  generation:  0.4947986602783203
local_output_nid generation:  0.033678293228149414
local_in_edges_tensor generation:  0.03338479995727539
mini_batch_src_global generation:  0.05667853355407715
r_  generation:  0.48859071731567383
local_output_nid generation:  0.03340888023376465
local_in_edges_tensor generation:  0.03214550018310547
mini_batch_src_global generation:  0.054654836654663086
r_  generation:  0.512223482131958
local_output_nid generation:  0.036666154861450195
local_in_edges_tensor generation:  0.03952670097351074
mini_batch_src_global generation:  0.056960344314575195
r_  generation:  0.49268555641174316
----------------------check_connections_block total spend ----------------------------- 5.859191179275513
generate_one_block  0.6197676658630371
generate_one_block  0.6209502220153809
generate_one_block  0.6175315380096436
generate_one_block  0.6233417987823486
generate_one_block  0.6245033740997314
generate_one_block  0.6098449230194092
generate_one_block  0.6494083404541016
generate_one_block  0.6249020099639893
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  9.790478467941284
block generation total time  8.48178505897522
average batch blocks generation time:  1.0602231323719025
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09734487533569336  GigaBytes
Max Memory Allocated: 0.09734487533569336  GigaBytes

torch.Size([160839, 128])
torch.Size([143038, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.30884313583374023  GigaBytes
Max Memory Allocated: 0.3219127655029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09910869598388672  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

torch.Size([160929, 128])
torch.Size([142690, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3074045181274414  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09965944290161133  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

torch.Size([160649, 128])
torch.Size([142951, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30838584899902344  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0995020866394043  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

torch.Size([160813, 128])
torch.Size([142778, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30863094329833984  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09946537017822266  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

torch.Size([160841, 128])
torch.Size([143038, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3092813491821289  GigaBytes
Max Memory Allocated: 0.34362220764160156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09914970397949219  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160812, 128])
torch.Size([142711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30794525146484375  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09963655471801758  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160918, 128])
torch.Size([143035, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3087186813354492  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09926986694335938  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160737, 128])
torch.Size([142600, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.307736873626709  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04084354639053345 |0.055898070335388184 |0.09667947888374329 |0.00010541081428527832 |0.009866565465927124 |0.0036766529083251953 |
----------------------------------------------------------pseudo_mini_loss sum 5.301523685455322
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3018341
Number of first layer input nodes during this epoch:  1286538
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.14186477661132812  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022854089736938477
range selection method range initialization spend 0.011404991149902344
time for parepare:  0.017255067825317383
local_output_nid generation:  0.002624034881591797
local_in_edges_tensor generation:  0.010105609893798828
mini_batch_src_global generation:  0.0038137435913085938
r_  generation:  0.04055929183959961
local_output_nid generation:  0.003067493438720703
local_in_edges_tensor generation:  0.0017523765563964844
mini_batch_src_global generation:  0.004814863204956055
r_  generation:  0.04657316207885742
local_output_nid generation:  0.0031287670135498047
local_in_edges_tensor generation:  0.001745462417602539
mini_batch_src_global generation:  0.0033288002014160156
r_  generation:  0.04504656791687012
local_output_nid generation:  0.003210306167602539
local_in_edges_tensor generation:  0.0017254352569580078
mini_batch_src_global generation:  0.0034170150756835938
r_  generation:  0.04478859901428223
local_output_nid generation:  0.0031435489654541016
local_in_edges_tensor generation:  0.001773834228515625
mini_batch_src_global generation:  0.003530263900756836
r_  generation:  0.046730995178222656
local_output_nid generation:  0.003116607666015625
local_in_edges_tensor generation:  0.001760721206665039
mini_batch_src_global generation:  0.0038118362426757812
r_  generation:  0.048195838928222656
local_output_nid generation:  0.003145456314086914
local_in_edges_tensor generation:  0.0018072128295898438
mini_batch_src_global generation:  0.003881216049194336
r_  generation:  0.047371864318847656
local_output_nid generation:  0.003125905990600586
local_in_edges_tensor generation:  0.0018193721771240234
mini_batch_src_global generation:  0.003711700439453125
r_  generation:  0.04622793197631836
----------------------check_connections_block total spend ----------------------------- 0.5389995574951172
generate_one_block  0.05971860885620117
generate_one_block  0.06741881370544434
generate_one_block  0.06819677352905273
generate_one_block  0.06389379501342773
generate_one_block  0.06513857841491699
generate_one_block  0.0633234977722168
generate_one_block  0.06941413879394531
generate_one_block  0.06327199935913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05576682090759277
gen group dst list time:  0.016608715057373047
time for parepare:  0.019085168838500977
local_output_nid generation:  0.010931015014648438
local_in_edges_tensor generation:  0.04142642021179199
mini_batch_src_global generation:  0.03296351432800293
r_  generation:  0.31563758850097656
local_output_nid generation:  0.01731252670288086
local_in_edges_tensor generation:  0.030370712280273438
mini_batch_src_global generation:  0.039359092712402344
r_  generation:  0.3285534381866455
local_output_nid generation:  0.01712203025817871
local_in_edges_tensor generation:  0.02511453628540039
mini_batch_src_global generation:  0.03883957862854004
r_  generation:  0.3343770503997803
local_output_nid generation:  0.017650365829467773
local_in_edges_tensor generation:  0.02516794204711914
mini_batch_src_global generation:  0.04214191436767578
r_  generation:  0.3377871513366699
local_output_nid generation:  0.017873287200927734
local_in_edges_tensor generation:  0.02200794219970703
mini_batch_src_global generation:  0.04099607467651367
r_  generation:  0.3422412872314453
local_output_nid generation:  0.01813197135925293
local_in_edges_tensor generation:  0.025564908981323242
mini_batch_src_global generation:  0.041631460189819336
r_  generation:  0.3477363586425781
local_output_nid generation:  0.01923513412475586
local_in_edges_tensor generation:  0.029171466827392578
mini_batch_src_global generation:  0.04165363311767578
r_  generation:  0.35416460037231445
local_output_nid generation:  0.021193981170654297
local_in_edges_tensor generation:  0.02688121795654297
mini_batch_src_global generation:  0.04674935340881348
r_  generation:  0.33879780769348145
----------------------check_connections_block total spend ----------------------------- 4.007704257965088
generate_one_block  0.44648265838623047
generate_one_block  0.45053648948669434
generate_one_block  0.44139695167541504
generate_one_block  0.4386739730834961
generate_one_block  0.4410395622253418
generate_one_block  0.4558734893798828
generate_one_block  0.45182275772094727
generate_one_block  0.4637172222137451
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0455172061920166
gen group dst list time:  0.038155317306518555
time for parepare:  0.020261764526367188
local_output_nid generation:  0.025342226028442383
local_in_edges_tensor generation:  0.05959057807922363
mini_batch_src_global generation:  0.04415082931518555
r_  generation:  0.47588181495666504
local_output_nid generation:  0.03257894515991211
local_in_edges_tensor generation:  0.04850649833679199
mini_batch_src_global generation:  0.05863356590270996
r_  generation:  0.4900217056274414
local_output_nid generation:  0.033605098724365234
local_in_edges_tensor generation:  0.03646492958068848
mini_batch_src_global generation:  0.051271677017211914
r_  generation:  0.4919438362121582
local_output_nid generation:  0.033753395080566406
local_in_edges_tensor generation:  0.03587985038757324
mini_batch_src_global generation:  0.05913949012756348
r_  generation:  0.4844784736633301
local_output_nid generation:  0.03426671028137207
local_in_edges_tensor generation:  0.032462358474731445
mini_batch_src_global generation:  0.05268454551696777
r_  generation:  0.4972984790802002
local_output_nid generation:  0.034238576889038086
local_in_edges_tensor generation:  0.03261518478393555
mini_batch_src_global generation:  0.05485343933105469
r_  generation:  0.4885551929473877
local_output_nid generation:  0.034210920333862305
local_in_edges_tensor generation:  0.0326075553894043
mini_batch_src_global generation:  0.06261396408081055
r_  generation:  0.5085153579711914
local_output_nid generation:  0.03577542304992676
local_in_edges_tensor generation:  0.04200339317321777
mini_batch_src_global generation:  0.06303906440734863
r_  generation:  0.503227949142456
----------------------check_connections_block total spend ----------------------------- 5.863049030303955
generate_one_block  0.6253008842468262
generate_one_block  0.6319797039031982
generate_one_block  0.6256277561187744
generate_one_block  0.6268453598022461
generate_one_block  0.6212630271911621
generate_one_block  0.6079616546630859
generate_one_block  0.6015384197235107
generate_one_block  0.6116583347320557
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.14186477661132812  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

connection checking time:  9.870753288269043
block generation total time  8.541718244552612
average batch blocks generation time:  1.0677147805690765
block dataloader generation time/epoch 20.56690764427185
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09976530075073242  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160856, 128])
torch.Size([142844, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3083500862121582  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09978628158569336  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160758, 128])
torch.Size([142744, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3089108467102051  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09957742691040039  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160958, 128])
torch.Size([143132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30896615982055664  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09962034225463867  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160915, 128])
torch.Size([142899, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30855703353881836  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.0997476577758789  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160875, 128])
torch.Size([142916, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.3088994026184082  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09973430633544922  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160967, 128])
torch.Size([143047, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30911779403686523  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09959554672241211  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([160804, 128])
torch.Size([142588, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30843305587768555  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.09970283508300781  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

torch.Size([161011, 128])
torch.Size([143064, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.30886173248291016  GigaBytes
Max Memory Allocated: 0.34430408477783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03952857851982117 |0.015382111072540283 |0.00386163592338562 |9.167194366455078e-05 |0.01186460256576538 |0.003084421157836914 |
----------------------------------------------------------pseudo_mini_loss sum 4.075841903686523
Total (block generation + training)time/epoch 21.1462664604187
Training time/epoch 0.5791351795196533
Training time without block to device /epoch 0.45607829093933105
Training time without total dataloading part /epoch 0.12962770462036133
load block tensor time/epoch 0.31622862815856934
block to device time/epoch 0.12305688858032227
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3020487
Number of first layer input nodes during this epoch:  1287144
