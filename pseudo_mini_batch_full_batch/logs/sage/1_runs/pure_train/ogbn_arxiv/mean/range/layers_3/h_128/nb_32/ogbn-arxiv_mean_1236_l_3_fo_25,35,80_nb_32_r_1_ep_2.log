Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648450095.6088538
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02776956558227539
range selection method range initialization spend 0.013754844665527344
time for parepare:  0.017880678176879883
local_output_nid generation:  0.0007340908050537109
local_in_edges_tensor generation:  0.0035071372985839844
mini_batch_src_global generation:  0.0014417171478271484
r_  generation:  0.010272026062011719
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0014650821685791016
r_  generation:  0.009491920471191406
local_output_nid generation:  0.0007264614105224609
local_in_edges_tensor generation:  0.0005245208740234375
mini_batch_src_global generation:  0.0009353160858154297
r_  generation:  0.009054183959960938
local_output_nid generation:  0.0007383823394775391
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008919239044189453
r_  generation:  0.009446144104003906
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0008759498596191406
r_  generation:  0.009402751922607422
local_output_nid generation:  0.0007500648498535156
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.0009157657623291016
r_  generation:  0.00967097282409668
local_output_nid generation:  0.0007429122924804688
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.009784698486328125
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0008833408355712891
r_  generation:  0.009146928787231445
local_output_nid generation:  0.0007429122924804688
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.009342432022094727
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0009348392486572266
r_  generation:  0.009761571884155273
local_output_nid generation:  0.0007407665252685547
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.00992274284362793
local_output_nid generation:  0.0007395744323730469
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.0009245872497558594
r_  generation:  0.009385108947753906
local_output_nid generation:  0.0007359981536865234
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.009999752044677734
local_output_nid generation:  0.0007350444793701172
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0009920597076416016
r_  generation:  0.01038050651550293
local_output_nid generation:  0.0007364749908447266
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0010368824005126953
r_  generation:  0.009802103042602539
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.01000213623046875
local_output_nid generation:  0.0007393360137939453
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.01147150993347168
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0005092620849609375
mini_batch_src_global generation:  0.0010678768157958984
r_  generation:  0.010073661804199219
local_output_nid generation:  0.0007452964782714844
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0009486675262451172
r_  generation:  0.00948953628540039
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0011272430419921875
r_  generation:  0.010145425796508789
local_output_nid generation:  0.0007419586181640625
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.010299444198608398
local_output_nid generation:  0.0007686614990234375
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0010426044464111328
r_  generation:  0.010057687759399414
local_output_nid generation:  0.0007283687591552734
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.009847879409790039
local_output_nid generation:  0.0007312297821044922
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.0010094642639160156
r_  generation:  0.010133743286132812
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.009695291519165039
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0009546279907226562
r_  generation:  0.01027536392211914
local_output_nid generation:  0.0007729530334472656
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.009866952896118164
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.009965181350708008
local_output_nid generation:  0.0007395744323730469
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.010216236114501953
local_output_nid generation:  0.0007474422454833984
local_in_edges_tensor generation:  0.0042040348052978516
mini_batch_src_global generation:  0.0011911392211914062
r_  generation:  0.01026153564453125
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.0010380744934082031
r_  generation:  0.009884357452392578
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.009941577911376953
----------------------check_connections_block total spend ----------------------------- 0.48590755462646484
generate_one_block  0.014957427978515625
generate_one_block  0.014646530151367188
generate_one_block  0.014659881591796875
generate_one_block  0.014965057373046875
generate_one_block  0.014734506607055664
generate_one_block  0.015307426452636719
generate_one_block  0.014925718307495117
generate_one_block  0.013935327529907227
generate_one_block  0.014252662658691406
generate_one_block  0.015317201614379883
generate_one_block  0.014941692352294922
generate_one_block  0.014113664627075195
generate_one_block  0.015166759490966797
generate_one_block  0.015354394912719727
generate_one_block  0.014420032501220703
generate_one_block  0.014556646347045898
generate_one_block  0.01608109474182129
generate_one_block  0.015198945999145508
generate_one_block  0.014917612075805664
generate_one_block  0.015181303024291992
generate_one_block  0.015339851379394531
generate_one_block  0.014989614486694336
generate_one_block  0.014778614044189453
generate_one_block  0.015013456344604492
generate_one_block  0.01434326171875
generate_one_block  0.014903783798217773
generate_one_block  0.014802694320678711
generate_one_block  0.014806270599365234
generate_one_block  0.015228033065795898
generate_one_block  0.015152692794799805
generate_one_block  0.014976263046264648
generate_one_block  0.01460123062133789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04216575622558594
gen group dst list time:  0.023662805557250977
time for parepare:  0.019553422927856445
local_output_nid generation:  0.0042438507080078125
local_in_edges_tensor generation:  0.012080192565917969
mini_batch_src_global generation:  0.01279592514038086
r_  generation:  0.1288747787475586
local_output_nid generation:  0.008055448532104492
local_in_edges_tensor generation:  0.011193513870239258
mini_batch_src_global generation:  0.016515016555786133
r_  generation:  0.13663792610168457
local_output_nid generation:  0.008269548416137695
local_in_edges_tensor generation:  0.009270906448364258
mini_batch_src_global generation:  0.015157461166381836
r_  generation:  0.13860440254211426
local_output_nid generation:  0.008468151092529297
local_in_edges_tensor generation:  0.01067209243774414
mini_batch_src_global generation:  0.016196727752685547
r_  generation:  0.14553308486938477
local_output_nid generation:  0.008576631546020508
local_in_edges_tensor generation:  0.009546756744384766
mini_batch_src_global generation:  0.016821861267089844
r_  generation:  0.14550375938415527
local_output_nid generation:  0.008856058120727539
local_in_edges_tensor generation:  0.011296749114990234
mini_batch_src_global generation:  0.01790618896484375
r_  generation:  0.14791202545166016
local_output_nid generation:  0.008959770202636719
local_in_edges_tensor generation:  0.008821487426757812
mini_batch_src_global generation:  0.017856121063232422
r_  generation:  0.14736366271972656
local_output_nid generation:  0.008688926696777344
local_in_edges_tensor generation:  0.009618520736694336
mini_batch_src_global generation:  0.017023324966430664
r_  generation:  0.14406156539916992
local_output_nid generation:  0.008694171905517578
local_in_edges_tensor generation:  0.009779691696166992
mini_batch_src_global generation:  0.017117977142333984
r_  generation:  0.1432654857635498
local_output_nid generation:  0.009117364883422852
local_in_edges_tensor generation:  0.011324405670166016
mini_batch_src_global generation:  0.01831793785095215
r_  generation:  0.1494889259338379
local_output_nid generation:  0.009129524230957031
local_in_edges_tensor generation:  0.011414289474487305
mini_batch_src_global generation:  0.018395423889160156
r_  generation:  0.1493842601776123
local_output_nid generation:  0.008810997009277344
local_in_edges_tensor generation:  0.008504152297973633
mini_batch_src_global generation:  0.01696491241455078
r_  generation:  0.13919925689697266
local_output_nid generation:  0.009535074234008789
local_in_edges_tensor generation:  0.01045989990234375
mini_batch_src_global generation:  0.018585205078125
r_  generation:  0.15261054039001465
local_output_nid generation:  0.009610176086425781
local_in_edges_tensor generation:  0.01170492172241211
mini_batch_src_global generation:  0.01910877227783203
r_  generation:  0.15730810165405273
local_output_nid generation:  0.009200096130371094
local_in_edges_tensor generation:  0.008863449096679688
mini_batch_src_global generation:  0.018316268920898438
r_  generation:  0.14702153205871582
local_output_nid generation:  0.009159088134765625
local_in_edges_tensor generation:  0.008820295333862305
mini_batch_src_global generation:  0.017923593521118164
r_  generation:  0.1481790542602539
local_output_nid generation:  0.010006904602050781
local_in_edges_tensor generation:  0.012420892715454102
mini_batch_src_global generation:  0.020092248916625977
r_  generation:  0.16977643966674805
local_output_nid generation:  0.008979558944702148
local_in_edges_tensor generation:  0.008907794952392578
mini_batch_src_global generation:  0.01831674575805664
r_  generation:  0.14386510848999023
local_output_nid generation:  0.009130239486694336
local_in_edges_tensor generation:  0.008776664733886719
mini_batch_src_global generation:  0.017722368240356445
r_  generation:  0.145355224609375
local_output_nid generation:  0.009584426879882812
local_in_edges_tensor generation:  0.011677742004394531
mini_batch_src_global generation:  0.018507719039916992
r_  generation:  0.15359187126159668
local_output_nid generation:  0.009692192077636719
local_in_edges_tensor generation:  0.010490179061889648
mini_batch_src_global generation:  0.0203092098236084
r_  generation:  0.15349435806274414
local_output_nid generation:  0.009706258773803711
local_in_edges_tensor generation:  0.009335517883300781
mini_batch_src_global generation:  0.018626689910888672
r_  generation:  0.15172529220581055
local_output_nid generation:  0.009427309036254883
local_in_edges_tensor generation:  0.010671377182006836
mini_batch_src_global generation:  0.018136262893676758
r_  generation:  0.14782452583312988
local_output_nid generation:  0.009611845016479492
local_in_edges_tensor generation:  0.009206295013427734
mini_batch_src_global generation:  0.018518447875976562
r_  generation:  0.15244364738464355
local_output_nid generation:  0.009160518646240234
local_in_edges_tensor generation:  0.010663032531738281
mini_batch_src_global generation:  0.018520355224609375
r_  generation:  0.14505767822265625
local_output_nid generation:  0.009474992752075195
local_in_edges_tensor generation:  0.0117645263671875
mini_batch_src_global generation:  0.01942133903503418
r_  generation:  0.15684103965759277
local_output_nid generation:  0.009505033493041992
local_in_edges_tensor generation:  0.010395288467407227
mini_batch_src_global generation:  0.01862168312072754
r_  generation:  0.15040135383605957
local_output_nid generation:  0.009578227996826172
local_in_edges_tensor generation:  0.01046609878540039
mini_batch_src_global generation:  0.01855325698852539
r_  generation:  0.15352988243103027
local_output_nid generation:  0.009485960006713867
local_in_edges_tensor generation:  0.011537790298461914
mini_batch_src_global generation:  0.018671274185180664
r_  generation:  0.15141677856445312
local_output_nid generation:  0.009656190872192383
local_in_edges_tensor generation:  0.011735677719116211
mini_batch_src_global generation:  0.01877427101135254
r_  generation:  0.15398931503295898
local_output_nid generation:  0.009424209594726562
local_in_edges_tensor generation:  0.008876562118530273
mini_batch_src_global generation:  0.018049955368041992
r_  generation:  0.14673471450805664
local_output_nid generation:  0.009308099746704102
local_in_edges_tensor generation:  0.009028434753417969
mini_batch_src_global generation:  0.01798224449157715
r_  generation:  0.14949250221252441
----------------------check_connections_block total spend ----------------------------- 7.065920114517212
generate_one_block  0.18516826629638672
generate_one_block  0.17937922477722168
generate_one_block  0.2024974822998047
generate_one_block  0.1935882568359375
generate_one_block  0.1890735626220703
generate_one_block  0.193070650100708
generate_one_block  0.19118428230285645
generate_one_block  0.17505860328674316
generate_one_block  0.18070602416992188
generate_one_block  0.1934950351715088
generate_one_block  0.19134306907653809
generate_one_block  0.17499613761901855
generate_one_block  0.19425392150878906
generate_one_block  0.19989275932312012
generate_one_block  0.18192315101623535
generate_one_block  0.20435285568237305
generate_one_block  0.2089381217956543
generate_one_block  0.17755889892578125
generate_one_block  0.17988085746765137
generate_one_block  0.19046592712402344
generate_one_block  0.19895291328430176
generate_one_block  0.19066762924194336
generate_one_block  0.1860334873199463
generate_one_block  0.19506001472473145
generate_one_block  0.18222761154174805
generate_one_block  0.1939098834991455
generate_one_block  0.19013381004333496
generate_one_block  0.1895127296447754
generate_one_block  0.1933455467224121
generate_one_block  0.1917738914489746
generate_one_block  0.1827540397644043
generate_one_block  0.1841287612915039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03602123260498047
gen group dst list time:  0.09534859657287598
time for parepare:  0.018813133239746094
local_output_nid generation:  0.019669055938720703
local_in_edges_tensor generation:  0.03756594657897949
mini_batch_src_global generation:  0.03696036338806152
r_  generation:  0.3897674083709717
local_output_nid generation:  0.02618575096130371
local_in_edges_tensor generation:  0.03952741622924805
mini_batch_src_global generation:  0.04644918441772461
r_  generation:  0.39526987075805664
local_output_nid generation:  0.026740550994873047
local_in_edges_tensor generation:  0.03296184539794922
mini_batch_src_global generation:  0.05280351638793945
r_  generation:  0.4017486572265625
local_output_nid generation:  0.025236129760742188
local_in_edges_tensor generation:  0.03386640548706055
mini_batch_src_global generation:  0.047492265701293945
r_  generation:  0.4057745933532715
local_output_nid generation:  0.02547144889831543
local_in_edges_tensor generation:  0.025936603546142578
mini_batch_src_global generation:  0.05568885803222656
r_  generation:  0.40549707412719727
local_output_nid generation:  0.0257723331451416
local_in_edges_tensor generation:  0.026424646377563477
mini_batch_src_global generation:  0.051863670349121094
r_  generation:  0.4080045223236084
local_output_nid generation:  0.025600671768188477
local_in_edges_tensor generation:  0.027012109756469727
mini_batch_src_global generation:  0.05629158020019531
r_  generation:  0.4100818634033203
local_output_nid generation:  0.025667190551757812
local_in_edges_tensor generation:  0.03274869918823242
mini_batch_src_global generation:  0.04825901985168457
r_  generation:  0.40767955780029297
local_output_nid generation:  0.02548813819885254
local_in_edges_tensor generation:  0.0325167179107666
mini_batch_src_global generation:  0.055780887603759766
r_  generation:  0.4042365550994873
local_output_nid generation:  0.026081085205078125
local_in_edges_tensor generation:  0.033782243728637695
mini_batch_src_global generation:  0.051276445388793945
r_  generation:  0.40808820724487305
local_output_nid generation:  0.025948047637939453
local_in_edges_tensor generation:  0.03463602066040039
mini_batch_src_global generation:  0.05926704406738281
r_  generation:  0.416841983795166
local_output_nid generation:  0.02569746971130371
local_in_edges_tensor generation:  0.02689528465270996
mini_batch_src_global generation:  0.0487368106842041
r_  generation:  0.40096235275268555
local_output_nid generation:  0.02646613121032715
local_in_edges_tensor generation:  0.026358842849731445
mini_batch_src_global generation:  0.05659890174865723
r_  generation:  0.410153865814209
local_output_nid generation:  0.02630758285522461
local_in_edges_tensor generation:  0.03756976127624512
mini_batch_src_global generation:  0.04857492446899414
r_  generation:  0.4181177616119385
local_output_nid generation:  0.0257720947265625
local_in_edges_tensor generation:  0.027136564254760742
mini_batch_src_global generation:  0.05715537071228027
r_  generation:  0.40625858306884766
local_output_nid generation:  0.025985240936279297
local_in_edges_tensor generation:  0.026692628860473633
mini_batch_src_global generation:  0.048651695251464844
r_  generation:  0.41056227684020996
local_output_nid generation:  0.026759862899780273
local_in_edges_tensor generation:  0.03853583335876465
mini_batch_src_global generation:  0.056943655014038086
r_  generation:  0.4198579788208008
local_output_nid generation:  0.025816679000854492
local_in_edges_tensor generation:  0.026708126068115234
mini_batch_src_global generation:  0.04909253120422363
r_  generation:  0.40366077423095703
local_output_nid generation:  0.026073932647705078
local_in_edges_tensor generation:  0.035918235778808594
mini_batch_src_global generation:  0.08055281639099121
r_  generation:  0.47402215003967285
local_output_nid generation:  0.034043312072753906
local_in_edges_tensor generation:  0.03665757179260254
mini_batch_src_global generation:  0.05484509468078613
r_  generation:  0.4195284843444824
local_output_nid generation:  0.0274965763092041
local_in_edges_tensor generation:  0.04984927177429199
mini_batch_src_global generation:  0.05997347831726074
r_  generation:  0.42254042625427246
local_output_nid generation:  0.02900075912475586
local_in_edges_tensor generation:  0.0347294807434082
mini_batch_src_global generation:  0.04964184761047363
r_  generation:  0.4378335475921631
local_output_nid generation:  0.03189873695373535
local_in_edges_tensor generation:  0.03358316421508789
mini_batch_src_global generation:  0.06137824058532715
r_  generation:  0.4093749523162842
local_output_nid generation:  0.027570247650146484
local_in_edges_tensor generation:  0.029937744140625
mini_batch_src_global generation:  0.05002713203430176
r_  generation:  0.42151975631713867
local_output_nid generation:  0.02754497528076172
local_in_edges_tensor generation:  0.02975320816040039
mini_batch_src_global generation:  0.05723762512207031
r_  generation:  0.4123806953430176
local_output_nid generation:  0.027191162109375
local_in_edges_tensor generation:  0.033325910568237305
mini_batch_src_global generation:  0.06899094581604004
r_  generation:  0.4541661739349365
local_output_nid generation:  0.030622482299804688
local_in_edges_tensor generation:  0.03679656982421875
mini_batch_src_global generation:  0.06762909889221191
r_  generation:  0.4404914379119873
local_output_nid generation:  0.02721118927001953
local_in_edges_tensor generation:  0.03982353210449219
mini_batch_src_global generation:  0.04884648323059082
r_  generation:  0.41872382164001465
local_output_nid generation:  0.027966022491455078
local_in_edges_tensor generation:  0.03524184226989746
mini_batch_src_global generation:  0.0650336742401123
r_  generation:  0.44043779373168945
local_output_nid generation:  0.02924036979675293
local_in_edges_tensor generation:  0.03205585479736328
mini_batch_src_global generation:  0.04946637153625488
r_  generation:  0.41324949264526367
local_output_nid generation:  0.039173126220703125
local_in_edges_tensor generation:  0.03295612335205078
mini_batch_src_global generation:  0.05678915977478027
r_  generation:  0.41750621795654297
local_output_nid generation:  0.027336835861206055
local_in_edges_tensor generation:  0.02504277229309082
mini_batch_src_global generation:  0.048868656158447266
r_  generation:  0.4167056083679199
----------------------check_connections_block total spend ----------------------------- 19.942798852920532
generate_one_block  0.6449747085571289
generate_one_block  0.5539250373840332
generate_one_block  0.5368678569793701
generate_one_block  0.5343337059020996
generate_one_block  0.533935546875
generate_one_block  0.5617210865020752
generate_one_block  0.5222711563110352
generate_one_block  0.5279762744903564
generate_one_block  0.5248351097106934
generate_one_block  0.5439343452453613
generate_one_block  0.5415778160095215
generate_one_block  0.5131769180297852
generate_one_block  0.5289931297302246
generate_one_block  0.5454070568084717
generate_one_block  0.5205564498901367
generate_one_block  0.5168590545654297
generate_one_block  0.5457124710083008
generate_one_block  0.525313138961792
generate_one_block  0.5245633125305176
generate_one_block  0.5419309139251709
generate_one_block  0.5553715229034424
generate_one_block  0.5390031337738037
generate_one_block  0.5252618789672852
generate_one_block  0.5321297645568848
generate_one_block  0.5278439521789551
generate_one_block  0.5353496074676514
generate_one_block  0.5366032123565674
generate_one_block  0.5459475517272949
generate_one_block  0.5302631855010986
generate_one_block  0.5307562351226807
generate_one_block  0.5367600917816162
generate_one_block  0.5202224254608154
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00028705596923828125  GigaBytes
Max Memory Allocated: 0.00028705596923828125  GigaBytes

connection checking time:  27.008718967437744
block generation total time  23.269705057144165
average batch blocks generation time:  0.7271782830357552
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08356618881225586  GigaBytes
Max Memory Allocated: 0.08356618881225586  GigaBytes

torch.Size([146036, 128])
torch.Size([102134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.3579878807067871  GigaBytes
Max Memory Allocated: 0.3691592216491699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.08419322967529297  GigaBytes
Max Memory Allocated: 0.40703582763671875  GigaBytes

torch.Size([145855, 128])
torch.Size([101648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.3587508201599121  GigaBytes
Max Memory Allocated: 0.40703582763671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.0842132568359375  GigaBytes
Max Memory Allocated: 0.40826940536499023  GigaBytes

torch.Size([146193, 128])
torch.Size([102007, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.35863542556762695  GigaBytes
Max Memory Allocated: 0.40826940536499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.08523082733154297  GigaBytes
Max Memory Allocated: 0.4084596633911133  GigaBytes

torch.Size([146207, 128])
torch.Size([102502, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.36133289337158203  GigaBytes
Max Memory Allocated: 0.4084596633911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522796630859375  GigaBytes
Max Memory Allocated: 0.40958356857299805  GigaBytes

torch.Size([146135, 128])
torch.Size([101974, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3612852096557617  GigaBytes
Max Memory Allocated: 0.40958356857299805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.40973854064941406  GigaBytes

torch.Size([146468, 128])
torch.Size([103075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3628554344177246  GigaBytes
Max Memory Allocated: 0.40973854064941406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523273468017578  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([146412, 128])
torch.Size([102171, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3610720634460449  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.0841073989868164  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([146220, 128])
torch.Size([101283, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3573951721191406  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08416175842285156  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([145462, 128])
torch.Size([100694, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3580508232116699  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522987365722656  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([146048, 128])
torch.Size([102491, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.361236572265625  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523178100585938  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([146338, 128])
torch.Size([102654, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.36160945892333984  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08400917053222656  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([145450, 128])
torch.Size([100191, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.35312843322753906  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

torch.Size([146882, 128])
torch.Size([103611, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3646674156188965  GigaBytes
Max Memory Allocated: 0.41048765182495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08523941040039062  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

torch.Size([146767, 128])
torch.Size([103296, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.36380815505981445  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08422470092773438  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

torch.Size([145919, 128])
torch.Size([100877, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3586239814758301  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08522605895996094  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

torch.Size([146053, 128])
torch.Size([101491, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.3606405258178711  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.08524799346923828  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

torch.Size([146771, 128])
torch.Size([104828, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.37258386611938477  GigaBytes
Max Memory Allocated: 0.4120950698852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08412551879882812  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145953, 128])
torch.Size([101247, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3577108383178711  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08421134948730469  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146153, 128])
torch.Size([101367, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35800647735595703  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0852365493774414  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146940, 128])
torch.Size([103679, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3643064498901367  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146847, 128])
torch.Size([103194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36342906951904297  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523368835449219  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146593, 128])
torch.Size([103527, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3639683723449707  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522701263427734  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146392, 128])
torch.Size([102477, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3608689308166504  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523368835449219  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146729, 128])
torch.Size([103281, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3634333610534668  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0852212905883789  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146020, 128])
torch.Size([101956, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3606381416320801  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523368835449219  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146282, 128])
torch.Size([102083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3613753318786621  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522987365722656  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146456, 128])
torch.Size([102580, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3614978790283203  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522987365722656  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146381, 128])
torch.Size([102993, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36216115951538086  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08523273468017578  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145993, 128])
torch.Size([102079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36145448684692383  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.085235595703125  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146062, 128])
torch.Size([102439, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36144208908081055  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08522605895996094  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146797, 128])
torch.Size([102912, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36062145233154297  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08424186706542969  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145935, 128])
torch.Size([101496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35967540740966797  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03232318162918091 |0.021521158516407013 |0.027138128876686096 |9.100884199142456e-05 |0.004737548530101776 |0.0018928050994873047 |
----------------------------------------------------------pseudo_mini_loss sum 5.643850326538086
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8793959
Number of first layer input nodes during this epoch:  4680749
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.1047968864440918  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022684812545776367
range selection method range initialization spend 0.011624574661254883
time for parepare:  0.017850399017333984
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.006197690963745117
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.009766340255737305
local_output_nid generation:  0.0008571147918701172
local_in_edges_tensor generation:  0.0006010532379150391
mini_batch_src_global generation:  0.0015354156494140625
r_  generation:  0.01020503044128418
local_output_nid generation:  0.0008518695831298828
local_in_edges_tensor generation:  0.000530242919921875
mini_batch_src_global generation:  0.001129150390625
r_  generation:  0.009487390518188477
local_output_nid generation:  0.0007975101470947266
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0010166168212890625
r_  generation:  0.009522199630737305
local_output_nid generation:  0.0008153915405273438
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0009672641754150391
r_  generation:  0.009667396545410156
local_output_nid generation:  0.0008258819580078125
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.009857654571533203
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.010038375854492188
local_output_nid generation:  0.0007927417755126953
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.009975194931030273
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.0005211830139160156
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.010132551193237305
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.009797811508178711
local_output_nid generation:  0.0008268356323242188
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.009923219680786133
local_output_nid generation:  0.0007944107055664062
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.010101556777954102
local_output_nid generation:  0.0008394718170166016
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.009711027145385742
local_output_nid generation:  0.0007975101470947266
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.009958505630493164
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.009928226470947266
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.01180887222290039
local_output_nid generation:  0.0007889270782470703
local_in_edges_tensor generation:  0.0004887580871582031
mini_batch_src_global generation:  0.001077413558959961
r_  generation:  0.010362863540649414
local_output_nid generation:  0.0007874965667724609
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.0010590553283691406
r_  generation:  0.010248422622680664
local_output_nid generation:  0.0007736682891845703
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0010406970977783203
r_  generation:  0.010059833526611328
local_output_nid generation:  0.0007698535919189453
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.01030731201171875
local_output_nid generation:  0.0007784366607666016
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.010024070739746094
local_output_nid generation:  0.0007853507995605469
local_in_edges_tensor generation:  0.000518798828125
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010503292083740234
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.011324882507324219
local_output_nid generation:  0.0007894039154052734
local_in_edges_tensor generation:  0.0005218982696533203
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.010293960571289062
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.010338306427001953
local_output_nid generation:  0.0007903575897216797
local_in_edges_tensor generation:  0.0004985332489013672
mini_batch_src_global generation:  0.001016855239868164
r_  generation:  0.010115861892700195
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.01027679443359375
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0010194778442382812
r_  generation:  0.010194540023803711
local_output_nid generation:  0.0008120536804199219
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.010833501815795898
local_output_nid generation:  0.0007920265197753906
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0010221004486083984
r_  generation:  0.011407852172851562
local_output_nid generation:  0.0007767677307128906
local_in_edges_tensor generation:  0.00048828125
mini_batch_src_global generation:  0.001010894775390625
r_  generation:  0.010129213333129883
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.0010232925415039062
r_  generation:  0.010057210922241211
----------------------check_connections_block total spend ----------------------------- 0.4999973773956299
generate_one_block  0.0184171199798584
generate_one_block  0.0169219970703125
generate_one_block  0.014426708221435547
generate_one_block  0.01470327377319336
generate_one_block  0.016393184661865234
generate_one_block  0.014842033386230469
generate_one_block  0.014804840087890625
generate_one_block  0.014793157577514648
generate_one_block  0.015038251876831055
generate_one_block  0.014166831970214844
generate_one_block  0.014581441879272461
generate_one_block  0.016360759735107422
generate_one_block  0.01428079605102539
generate_one_block  0.01465153694152832
generate_one_block  0.014631271362304688
generate_one_block  0.01468801498413086
generate_one_block  0.015133857727050781
generate_one_block  0.015010595321655273
generate_one_block  0.0161898136138916
generate_one_block  0.015137910842895508
generate_one_block  0.014580011367797852
generate_one_block  0.01540684700012207
generate_one_block  0.014424800872802734
generate_one_block  0.015128612518310547
generate_one_block  0.015430450439453125
generate_one_block  0.01634502410888672
generate_one_block  0.015336751937866211
generate_one_block  0.014910697937011719
generate_one_block  0.01612067222595215
generate_one_block  0.014631032943725586
generate_one_block  0.014709949493408203
generate_one_block  0.014713048934936523
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03743767738342285
gen group dst list time:  0.0212857723236084
time for parepare:  0.019180774688720703
local_output_nid generation:  0.004190683364868164
local_in_edges_tensor generation:  0.013502120971679688
mini_batch_src_global generation:  0.016707181930541992
r_  generation:  0.13057351112365723
local_output_nid generation:  0.006653547286987305
local_in_edges_tensor generation:  0.011985540390014648
mini_batch_src_global generation:  0.0167391300201416
r_  generation:  0.14010405540466309
local_output_nid generation:  0.006748676300048828
local_in_edges_tensor generation:  0.0287935733795166
mini_batch_src_global generation:  0.017182111740112305
r_  generation:  0.14200282096862793
local_output_nid generation:  0.007159233093261719
local_in_edges_tensor generation:  0.011439800262451172
mini_batch_src_global generation:  0.017882108688354492
r_  generation:  0.14619684219360352
local_output_nid generation:  0.007585287094116211
local_in_edges_tensor generation:  0.00892019271850586
mini_batch_src_global generation:  0.02142024040222168
r_  generation:  0.1514902114868164
local_output_nid generation:  0.007764101028442383
local_in_edges_tensor generation:  0.0101776123046875
mini_batch_src_global generation:  0.02041029930114746
r_  generation:  0.16304922103881836
local_output_nid generation:  0.011243104934692383
local_in_edges_tensor generation:  0.015448570251464844
mini_batch_src_global generation:  0.02045893669128418
r_  generation:  0.1503157615661621
local_output_nid generation:  0.007643461227416992
local_in_edges_tensor generation:  0.009398937225341797
mini_batch_src_global generation:  0.01841568946838379
r_  generation:  0.15080666542053223
local_output_nid generation:  0.007999420166015625
local_in_edges_tensor generation:  0.00954127311706543
mini_batch_src_global generation:  0.018619298934936523
r_  generation:  0.1542356014251709
local_output_nid generation:  0.007894039154052734
local_in_edges_tensor generation:  0.008777856826782227
mini_batch_src_global generation:  0.017673730850219727
r_  generation:  0.14439630508422852
local_output_nid generation:  0.008165836334228516
local_in_edges_tensor generation:  0.01179361343383789
mini_batch_src_global generation:  0.01806020736694336
r_  generation:  0.16092157363891602
local_output_nid generation:  0.008385896682739258
local_in_edges_tensor generation:  0.009372472763061523
mini_batch_src_global generation:  0.01948261260986328
r_  generation:  0.15435433387756348
local_output_nid generation:  0.008885383605957031
local_in_edges_tensor generation:  0.010759353637695312
mini_batch_src_global generation:  0.01853632926940918
r_  generation:  0.15984869003295898
local_output_nid generation:  0.010242223739624023
local_in_edges_tensor generation:  0.016809463500976562
mini_batch_src_global generation:  0.019925832748413086
r_  generation:  0.15181922912597656
local_output_nid generation:  0.008356332778930664
local_in_edges_tensor generation:  0.010329484939575195
mini_batch_src_global generation:  0.018030643463134766
r_  generation:  0.15002894401550293
local_output_nid generation:  0.008407354354858398
local_in_edges_tensor generation:  0.011811494827270508
mini_batch_src_global generation:  0.018509864807128906
r_  generation:  0.15331530570983887
local_output_nid generation:  0.00850224494934082
local_in_edges_tensor generation:  0.011937618255615234
mini_batch_src_global generation:  0.01910686492919922
r_  generation:  0.15531563758850098
local_output_nid generation:  0.008466005325317383
local_in_edges_tensor generation:  0.00804281234741211
mini_batch_src_global generation:  0.018782377243041992
r_  generation:  0.15120911598205566
local_output_nid generation:  0.00840902328491211
local_in_edges_tensor generation:  0.008001327514648438
mini_batch_src_global generation:  0.018154144287109375
r_  generation:  0.14969468116760254
local_output_nid generation:  0.013428688049316406
local_in_edges_tensor generation:  0.009440898895263672
mini_batch_src_global generation:  0.019875049591064453
r_  generation:  0.15258121490478516
local_output_nid generation:  0.00804448127746582
local_in_edges_tensor generation:  0.010572671890258789
mini_batch_src_global generation:  0.018634796142578125
r_  generation:  0.16124486923217773
local_output_nid generation:  0.008203744888305664
local_in_edges_tensor generation:  0.01201939582824707
mini_batch_src_global generation:  0.020252466201782227
r_  generation:  0.15491223335266113
local_output_nid generation:  0.007888078689575195
local_in_edges_tensor generation:  0.007871150970458984
mini_batch_src_global generation:  0.018090486526489258
r_  generation:  0.15259075164794922
local_output_nid generation:  0.008951663970947266
local_in_edges_tensor generation:  0.010885477066040039
mini_batch_src_global generation:  0.0190432071685791
r_  generation:  0.15279030799865723
local_output_nid generation:  0.008312225341796875
local_in_edges_tensor generation:  0.010683774948120117
mini_batch_src_global generation:  0.01916980743408203
r_  generation:  0.16659331321716309
local_output_nid generation:  0.008014678955078125
local_in_edges_tensor generation:  0.013365030288696289
mini_batch_src_global generation:  0.019624710083007812
r_  generation:  0.15224170684814453
local_output_nid generation:  0.00824284553527832
local_in_edges_tensor generation:  0.009934425354003906
mini_batch_src_global generation:  0.02362370491027832
r_  generation:  0.15864229202270508
local_output_nid generation:  0.00891256332397461
local_in_edges_tensor generation:  0.008409738540649414
mini_batch_src_global generation:  0.01848435401916504
r_  generation:  0.1521587371826172
local_output_nid generation:  0.008196592330932617
local_in_edges_tensor generation:  0.010450363159179688
mini_batch_src_global generation:  0.020032405853271484
r_  generation:  0.15610003471374512
local_output_nid generation:  0.008059501647949219
local_in_edges_tensor generation:  0.010553836822509766
mini_batch_src_global generation:  0.018843412399291992
r_  generation:  0.15086603164672852
local_output_nid generation:  0.007925748825073242
local_in_edges_tensor generation:  0.009171485900878906
mini_batch_src_global generation:  0.01810622215270996
r_  generation:  0.15021371841430664
local_output_nid generation:  0.008020877838134766
local_in_edges_tensor generation:  0.007990837097167969
mini_batch_src_global generation:  0.019679546356201172
r_  generation:  0.15323591232299805
----------------------check_connections_block total spend ----------------------------- 7.297074794769287
generate_one_block  0.1834402084350586
generate_one_block  0.18507885932922363
generate_one_block  0.18435144424438477
generate_one_block  0.1860647201538086
generate_one_block  0.20540904998779297
generate_one_block  0.1914222240447998
generate_one_block  0.1954042911529541
generate_one_block  0.18801212310791016
generate_one_block  0.19446015357971191
generate_one_block  0.17789340019226074
generate_one_block  0.18590736389160156
generate_one_block  0.19687247276306152
generate_one_block  0.1814572811126709
generate_one_block  0.1848149299621582
generate_one_block  0.18420815467834473
generate_one_block  0.1988847255706787
generate_one_block  0.19884920120239258
generate_one_block  0.18434762954711914
generate_one_block  0.18271541595458984
generate_one_block  0.22451376914978027
generate_one_block  0.19376254081726074
generate_one_block  0.19318771362304688
generate_one_block  0.18122315406799316
generate_one_block  0.1900942325592041
generate_one_block  0.19857525825500488
generate_one_block  0.1912236213684082
generate_one_block  0.1969451904296875
generate_one_block  0.18420958518981934
generate_one_block  0.1977405548095703
generate_one_block  0.19253849983215332
generate_one_block  0.18618154525756836
generate_one_block  0.19278407096862793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05240797996520996
gen group dst list time:  0.1045079231262207
time for parepare:  0.017318248748779297
local_output_nid generation:  0.021192312240600586
local_in_edges_tensor generation:  0.05820274353027344
mini_batch_src_global generation:  0.039046525955200195
r_  generation:  0.39084959030151367
local_output_nid generation:  0.0267946720123291
local_in_edges_tensor generation:  0.04100918769836426
mini_batch_src_global generation:  0.0460050106048584
r_  generation:  0.39788174629211426
local_output_nid generation:  0.026852846145629883
local_in_edges_tensor generation:  0.037502288818359375
mini_batch_src_global generation:  0.04631161689758301
r_  generation:  0.4047572612762451
local_output_nid generation:  0.025640487670898438
local_in_edges_tensor generation:  0.030585527420043945
mini_batch_src_global generation:  0.047014713287353516
r_  generation:  0.4050276279449463
local_output_nid generation:  0.025879383087158203
local_in_edges_tensor generation:  0.034234046936035156
mini_batch_src_global generation:  0.047322988510131836
r_  generation:  0.4141685962677002
local_output_nid generation:  0.026323556900024414
local_in_edges_tensor generation:  0.035009145736694336
mini_batch_src_global generation:  0.04790067672729492
r_  generation:  0.4113729000091553
local_output_nid generation:  0.026119470596313477
local_in_edges_tensor generation:  0.02802753448486328
mini_batch_src_global generation:  0.04775881767272949
r_  generation:  0.4119250774383545
local_output_nid generation:  0.026459932327270508
local_in_edges_tensor generation:  0.02752685546875
mini_batch_src_global generation:  0.05197024345397949
r_  generation:  0.4119865894317627
local_output_nid generation:  0.026140213012695312
local_in_edges_tensor generation:  0.034079551696777344
mini_batch_src_global generation:  0.05229330062866211
r_  generation:  0.41455507278442383
local_output_nid generation:  0.02613067626953125
local_in_edges_tensor generation:  0.026886940002441406
mini_batch_src_global generation:  0.048729658126831055
r_  generation:  0.40787839889526367
local_output_nid generation:  0.026455163955688477
local_in_edges_tensor generation:  0.03095221519470215
mini_batch_src_global generation:  0.047434091567993164
r_  generation:  0.4148876667022705
local_output_nid generation:  0.026429176330566406
local_in_edges_tensor generation:  0.03924226760864258
mini_batch_src_global generation:  0.0484309196472168
r_  generation:  0.4142036437988281
local_output_nid generation:  0.02612924575805664
local_in_edges_tensor generation:  0.028513431549072266
mini_batch_src_global generation:  0.048308610916137695
r_  generation:  0.41470861434936523
local_output_nid generation:  0.026643753051757812
local_in_edges_tensor generation:  0.027827739715576172
mini_batch_src_global generation:  0.047826290130615234
r_  generation:  0.4126160144805908
local_output_nid generation:  0.0264892578125
local_in_edges_tensor generation:  0.03063201904296875
mini_batch_src_global generation:  0.04774045944213867
r_  generation:  0.412426233291626
local_output_nid generation:  0.02666926383972168
local_in_edges_tensor generation:  0.03109431266784668
mini_batch_src_global generation:  0.050966739654541016
r_  generation:  0.41826748847961426
local_output_nid generation:  0.026631593704223633
local_in_edges_tensor generation:  0.03534746170043945
mini_batch_src_global generation:  0.05072832107543945
r_  generation:  0.4184074401855469
local_output_nid generation:  0.02634263038635254
local_in_edges_tensor generation:  0.027553558349609375
mini_batch_src_global generation:  0.04860115051269531
r_  generation:  0.41127872467041016
local_output_nid generation:  0.02680206298828125
local_in_edges_tensor generation:  0.026996135711669922
mini_batch_src_global generation:  0.04787135124206543
r_  generation:  0.41212010383605957
local_output_nid generation:  0.02732110023498535
local_in_edges_tensor generation:  0.03197121620178223
mini_batch_src_global generation:  0.04919266700744629
r_  generation:  0.41761136054992676
local_output_nid generation:  0.02681875228881836
local_in_edges_tensor generation:  0.04061269760131836
mini_batch_src_global generation:  0.04794502258300781
r_  generation:  0.4158005714416504
local_output_nid generation:  0.02715325355529785
local_in_edges_tensor generation:  0.035178422927856445
mini_batch_src_global generation:  0.05083155632019043
r_  generation:  0.4344172477722168
local_output_nid generation:  0.02655959129333496
local_in_edges_tensor generation:  0.027476787567138672
mini_batch_src_global generation:  0.047249555587768555
r_  generation:  0.41707372665405273
local_output_nid generation:  0.027900218963623047
local_in_edges_tensor generation:  0.028078794479370117
mini_batch_src_global generation:  0.04932665824890137
r_  generation:  0.41689372062683105
local_output_nid generation:  0.027103900909423828
local_in_edges_tensor generation:  0.03814077377319336
mini_batch_src_global generation:  0.047928810119628906
r_  generation:  0.4164915084838867
local_output_nid generation:  0.02689528465270996
local_in_edges_tensor generation:  0.03116321563720703
mini_batch_src_global generation:  0.04819607734680176
r_  generation:  0.4132232666015625
local_output_nid generation:  0.02701091766357422
local_in_edges_tensor generation:  0.03854823112487793
mini_batch_src_global generation:  0.04819536209106445
r_  generation:  0.42553234100341797
local_output_nid generation:  0.026930570602416992
local_in_edges_tensor generation:  0.02951645851135254
mini_batch_src_global generation:  0.04829144477844238
r_  generation:  0.4130527973175049
local_output_nid generation:  0.02694225311279297
local_in_edges_tensor generation:  0.02771782875061035
mini_batch_src_global generation:  0.04796957969665527
r_  generation:  0.41764235496520996
local_output_nid generation:  0.026746034622192383
local_in_edges_tensor generation:  0.03847455978393555
mini_batch_src_global generation:  0.04796195030212402
r_  generation:  0.41435742378234863
local_output_nid generation:  0.031210899353027344
local_in_edges_tensor generation:  0.03362607955932617
mini_batch_src_global generation:  0.055632829666137695
r_  generation:  0.4175121784210205
local_output_nid generation:  0.026784658432006836
local_in_edges_tensor generation:  0.038633108139038086
mini_batch_src_global generation:  0.048628807067871094
r_  generation:  0.41898465156555176
----------------------check_connections_block total spend ----------------------------- 19.58945107460022
generate_one_block  0.5235066413879395
generate_one_block  0.5500426292419434
generate_one_block  0.5584406852722168
generate_one_block  0.5553476810455322
generate_one_block  0.6406896114349365
generate_one_block  0.5411036014556885
generate_one_block  0.5242023468017578
generate_one_block  0.5291748046875
generate_one_block  0.5411159992218018
generate_one_block  0.5190906524658203
generate_one_block  0.5314309597015381
generate_one_block  0.5350172519683838
generate_one_block  0.5187511444091797
generate_one_block  0.5360872745513916
generate_one_block  0.5262174606323242
generate_one_block  0.5460870265960693
generate_one_block  0.5583171844482422
generate_one_block  0.5224080085754395
generate_one_block  0.5219895839691162
generate_one_block  0.5442731380462646
generate_one_block  0.5322818756103516
generate_one_block  0.5414071083068848
generate_one_block  0.5211832523345947
generate_one_block  0.5345594882965088
generate_one_block  0.6182050704956055
generate_one_block  0.5294883251190186
generate_one_block  0.5386409759521484
generate_one_block  0.5351338386535645
generate_one_block  0.5683624744415283
generate_one_block  0.545518159866333
generate_one_block  0.5760455131530762
generate_one_block  0.5531425476074219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.1047968864440918  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

connection checking time:  26.886525869369507
block generation total time  23.52983570098877
average batch blocks generation time:  0.735307365655899
block dataloader generation time/epoch 52.93385863304138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08461809158325195  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146252, 128])
torch.Size([101321, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3578524589538574  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08479499816894531  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145960, 128])
torch.Size([101476, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3604316711425781  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08578968048095703  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146000, 128])
torch.Size([101562, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36092710494995117  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579349517822266  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146135, 128])
torch.Size([101524, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3615436553955078  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0857992172241211  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146237, 128])
torch.Size([102552, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3620142936706543  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0858001708984375  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146252, 128])
torch.Size([102467, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.361696720123291  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579826354980469  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145741, 128])
torch.Size([101513, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3618350028991699  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579730987548828  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146031, 128])
torch.Size([102163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3615999221801758  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580207824707031  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145690, 128])
torch.Size([101994, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36218833923339844  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08469676971435547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145757, 128])
torch.Size([100940, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.358273983001709  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146085, 128])
torch.Size([101717, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36113739013671875  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579635620117188  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146066, 128])
torch.Size([102271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3618283271789551  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08578968048095703  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145463, 128])
torch.Size([101150, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35999155044555664  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579730987548828  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146302, 128])
torch.Size([102018, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.361907958984375  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579444885253906  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146211, 128])
torch.Size([101968, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3620285987854004  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146752, 128])
torch.Size([102860, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36211204528808594  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580207824707031  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146398, 128])
torch.Size([103405, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3643465042114258  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.0858011245727539  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146101, 128])
torch.Size([101913, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3621053695678711  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579635620117188  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146599, 128])
torch.Size([102542, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3617219924926758  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580303192138672  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146787, 128])
torch.Size([103857, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3654952049255371  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146445, 128])
torch.Size([102526, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36193037033081055  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580493927001953  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146834, 128])
torch.Size([103795, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36535167694091797  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08478546142578125  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146147, 128])
torch.Size([101565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.35909032821655273  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580303192138672  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146194, 128])
torch.Size([102602, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36240625381469727  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580684661865234  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146021, 128])
torch.Size([102571, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3637113571166992  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579826354980469  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145971, 128])
torch.Size([102136, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3616147041320801  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580493927001953  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146013, 128])
torch.Size([102937, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36367082595825195  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145999, 128])
torch.Size([101923, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3616328239440918  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08580780029296875  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145934, 128])
torch.Size([102360, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.361907958984375  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146500, 128])
torch.Size([102176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36183834075927734  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579540252685547  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([146138, 128])
torch.Size([102089, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.3615145683288574  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.08579826354980469  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

torch.Size([145935, 128])
torch.Size([102083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1561279296875 GB
    Memory Allocated: 0.36183977127075195  GigaBytes
Max Memory Allocated: 0.42009496688842773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029324710369110107 |0.015928640961647034 |0.003714814782142639 |9.675323963165283e-05 |0.0032554417848587036 |0.002001523971557617 |
----------------------------------------------------------pseudo_mini_loss sum 3.5848515033721924
Total (block generation + training)time/epoch 54.66187930107117
Training time/epoch 1.727529764175415
Training time without block to device /epoch 1.21781325340271
Training time without total dataloading part /epoch 0.22814583778381348
load block tensor time/epoch 0.9383907318115234
block to device time/epoch 0.5097165107727051
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8785830
Number of first layer input nodes during this epoch:  4676950
