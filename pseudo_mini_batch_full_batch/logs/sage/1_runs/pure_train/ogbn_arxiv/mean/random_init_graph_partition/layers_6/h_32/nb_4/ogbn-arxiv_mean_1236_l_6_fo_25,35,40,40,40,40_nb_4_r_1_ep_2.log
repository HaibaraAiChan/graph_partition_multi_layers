Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648657480.04477
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

{'VmPeak': 20911.59375, 'VmSize': 20911.34375, 'VmHWM': 3751.08203125, 'VmRSS': 3751.08203125}
The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02882218360900879
global_2_local 0.029209613800048828
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.01442408561706543
before graph partition 
		134855, 134047, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45471, 45470, 


	preparing two sides time :  0.1177515983581543
	Initialize BitList time :  0.007838964462280273
	getRedundancyCost: time   7.867813110351562e-06

					length of partitions 134855, 134047

	before terminate 1 the average redundancy rate is:  1.7089201281203925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.23615842188214975
			 the number of node to move is : 27007
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4727617062382428,  1.0529640551121053,  1.8925593573643804
						 current side  1
			 redundancy will reduce  0.22568508820987354
			 the number of node to move is : 5768
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.483235039910519,  1.1475418170725507,  1.8189282627484875
						 current side  0
			 redundancy will reduce  0.25315216838680143
			 the number of node to move is : 2044
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.455767959733591,  1.0773552290406223,  1.8341806904265596
	walk terminate 1 spend time 144.46627163887024
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.24692409375158886
			 the number of node to move is : 4825
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4619960343688037,  1.1664929584625552,  1.7574991102750521
						 current side  0
			 redundancy will reduce  0.27903045401393056
			 the number of node to move is : 2244
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.429889674106462,  1.082452081956378,  1.7773272662565458
						 current side  1
			 redundancy will reduce  0.28334562001118524
			 the number of node to move is : 1081
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4255745081092073,  1.0957852458182928,  1.755363770400122
	walk terminate 1 spend time 147.94270825386047
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		86212, 138105, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 293.0197412967682
partition_len_list
[86212, 138105]
random_init_graph_partition selection method range initialization spend 293.1065378189087
time for parepare:  0.01416778564453125
local_output_nid generation:  0.006129264831542969
local_in_edges_tensor generation:  0.026397705078125
mini_batch_src_global generation:  0.003969907760620117
r_  generation:  0.07194638252258301
local_output_nid generation:  0.01824474334716797
local_in_edges_tensor generation:  0.020546436309814453
mini_batch_src_global generation:  0.02260422706604004
r_  generation:  0.24445676803588867
----------------------check_connections_block total spend ----------------------------- 0.5171349048614502
generate_one_block  0.10471606254577637
generate_one_block  0.3119242191314697
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.054787635803222656
gen group dst list time:  0.0053272247314453125
time for parepare:  0.02325582504272461
local_output_nid generation:  0.017453908920288086
local_in_edges_tensor generation:  0.04836106300354004
mini_batch_src_global generation:  0.03874969482421875
r_  generation:  0.35141563415527344
local_output_nid generation:  0.03377509117126465
local_in_edges_tensor generation:  0.05046248435974121
mini_batch_src_global generation:  0.0796821117401123
r_  generation:  0.5332026481628418
----------------------check_connections_block total spend ----------------------------- 1.391352653503418
generate_one_block  0.48637986183166504
generate_one_block  0.6766684055328369
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03673839569091797
gen group dst list time:  0.010024785995483398
time for parepare:  0.019134044647216797
local_output_nid generation:  0.0314335823059082
local_in_edges_tensor generation:  0.05630755424499512
mini_batch_src_global generation:  0.05917763710021973
r_  generation:  0.5330674648284912
local_output_nid generation:  0.03966116905212402
local_in_edges_tensor generation:  0.05980563163757324
mini_batch_src_global generation:  0.06314802169799805
r_  generation:  0.5689880847930908
----------------------check_connections_block total spend ----------------------------- 1.693063735961914
generate_one_block  0.6941776275634766
generate_one_block  0.7181322574615479
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030222177505493164
gen group dst list time:  0.011307001113891602
time for parepare:  0.01954960823059082
local_output_nid generation:  0.03393912315368652
local_in_edges_tensor generation:  0.06297588348388672
mini_batch_src_global generation:  0.05507373809814453
r_  generation:  0.5642457008361816
local_output_nid generation:  0.042575836181640625
local_in_edges_tensor generation:  0.08779382705688477
mini_batch_src_global generation:  0.06531500816345215
r_  generation:  0.576474666595459
----------------------check_connections_block total spend ----------------------------- 1.7881181240081787
generate_one_block  0.7204632759094238
generate_one_block  0.732337474822998
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0399169921875
gen group dst list time:  0.011245489120483398
time for parepare:  0.019110441207885742
local_output_nid generation:  0.03560280799865723
local_in_edges_tensor generation:  0.04916572570800781
mini_batch_src_global generation:  0.050537109375
r_  generation:  0.545851469039917
local_output_nid generation:  0.04130125045776367
local_in_edges_tensor generation:  0.041002750396728516
mini_batch_src_global generation:  0.0638580322265625
r_  generation:  0.5622296333312988
----------------------check_connections_block total spend ----------------------------- 1.680924892425537
generate_one_block  0.6898090839385986
generate_one_block  0.7006244659423828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0385746955871582
gen group dst list time:  0.01194310188293457
time for parepare:  0.01960611343383789
local_output_nid generation:  0.04131674766540527
local_in_edges_tensor generation:  0.04748940467834473
mini_batch_src_global generation:  0.046509504318237305
r_  generation:  0.5128746032714844
local_output_nid generation:  0.04161381721496582
local_in_edges_tensor generation:  0.048334598541259766
mini_batch_src_global generation:  0.05847620964050293
r_  generation:  0.526033878326416
----------------------check_connections_block total spend ----------------------------- 1.5978713035583496
generate_one_block  0.6351182460784912
generate_one_block  0.6554508209228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.249282836914062e-05  GigaBytes
Max Memory Allocated: 8.249282836914062e-05  GigaBytes

{'VmPeak': 21893.94140625, 'VmSize': 21834.640625, 'VmHWM': 4936.2734375, 'VmRSS': 4877.11328125}
connection checking time:  8.151330709457397
block generation total time  6.7091615200042725
average batch blocks generation time:  3.3545807600021362
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2401123046875 GB
    Memory Allocated: 0.14072084426879883  GigaBytes
Max Memory Allocated: 0.14072084426879883  GigaBytes

{'VmPeak': 22122.63671875, 'VmSize': 22090.640625, 'VmHWM': 4955.609375, 'VmRSS': 4938.58984375}
torch.Size([167844, 128])
torch.Size([167527, 32])
torch.Size([166586, 32])
torch.Size([163477, 32])
torch.Size([148909, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.5696115493774414  GigaBytes
Max Memory Allocated: 0.5734639167785645  GigaBytes

{'VmPeak': 23186.90625, 'VmSize': 23154.91015625, 'VmHWM': 5317.30078125, 'VmRSS': 5317.30078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.15301179885864258  GigaBytes
Max Memory Allocated: 0.5848522186279297  GigaBytes

{'VmPeak': 23525.015625, 'VmSize': 23417.625, 'VmHWM': 5402.1640625, 'VmRSS': 5327.015625}
torch.Size([168159, 128])
torch.Size([167991, 32])
torch.Size([167608, 32])
torch.Size([166500, 32])
torch.Size([161845, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.6406235694885254  GigaBytes
Max Memory Allocated: 0.6541752815246582  GigaBytes

{'VmPeak': 23525.015625, 'VmSize': 23417.625, 'VmHWM': 5402.1640625, 'VmRSS': 5327.015625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043175578117370605 |0.20167255401611328 |0.35271334648132324 |0.00016641616821289062 |0.07758975028991699 |0.00743412971496582 |
----------------------------------------------------------pseudo_mini_loss sum 5.254183769226074
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1870763
Number of first layer input nodes during this epoch:  336003
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.3056001663208008  GigaBytes
Max Memory Allocated: 0.6623668670654297  GigaBytes

{'VmPeak': 23525.015625, 'VmSize': 23417.625, 'VmHWM': 5402.1640625, 'VmRSS': 5327.515625}
The real block id is  5
get_global_graph_edges_ids_block function  spend 0.022311925888061523
global_2_local 0.03225231170654297
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.015470266342163086
before graph partition 
		134701, 134574, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45471, 45470, 


	preparing two sides time :  0.12538647651672363
	Initialize BitList time :  0.009472131729125977
	getRedundancyCost: time   6.9141387939453125e-06

					length of partitions 134701, 134574

	before terminate 1 the average redundancy rate is:  1.7118454428134595
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.24412432215942692
			 the number of node to move is : 26753
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4677211206540326,  1.037107202115689,  1.8983350391923763
						 current side  1
			 redundancy will reduce  0.23622863173152098
			 the number of node to move is : 5642
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4756168110819385,  1.1242903732334824,  1.8269432489303945
						 current side  0
			 redundancy will reduce  0.2669976668934082
			 the number of node to move is : 2127
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4448477759200513,  1.0461344810268212,  1.8435610708132815
	walk terminate 1 spend time 150.7088212966919
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.25990934577656866
			 the number of node to move is : 4768
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4519360970368909,  1.130698469812652,  1.7731737242611298
						 current side  0
			 redundancy will reduce  0.2932339908837198
			 the number of node to move is : 2244
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4186114519297397,  1.046541344301689,  1.7906815595577905
						 current side  1
			 redundancy will reduce  0.2977285586232763
			 the number of node to move is : 1125
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4141168841901832,  1.059624541484161,  1.7686092268962053
	walk terminate 1 spend time 150.86076879501343
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83340, 139102, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 302.2086718082428
partition_len_list
[83340, 139102]
random_init_graph_partition selection method range initialization spend 302.2912380695343
time for parepare:  0.015433073043823242
local_output_nid generation:  0.006519794464111328
local_in_edges_tensor generation:  0.015561580657958984
mini_batch_src_global generation:  0.003287792205810547
r_  generation:  0.06719660758972168
local_output_nid generation:  0.021874189376831055
local_in_edges_tensor generation:  0.020846843719482422
mini_batch_src_global generation:  0.02289128303527832
r_  generation:  0.2462315559387207
----------------------check_connections_block total spend ----------------------------- 0.5081973075866699
generate_one_block  0.09875774383544922
generate_one_block  0.30784010887145996
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04099750518798828
gen group dst list time:  0.005477428436279297
time for parepare:  0.02185988426208496
local_output_nid generation:  0.01766347885131836
local_in_edges_tensor generation:  0.04491066932678223
mini_batch_src_global generation:  0.03241539001464844
r_  generation:  0.34804654121398926
local_output_nid generation:  0.04044222831726074
local_in_edges_tensor generation:  0.05448269844055176
mini_batch_src_global generation:  0.06317973136901855
r_  generation:  0.5752208232879639
----------------------check_connections_block total spend ----------------------------- 1.4179794788360596
generate_one_block  0.49605226516723633
generate_one_block  0.7029280662536621
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03741192817687988
gen group dst list time:  0.01145315170288086
time for parepare:  0.020227909088134766
local_output_nid generation:  0.03187704086303711
local_in_edges_tensor generation:  0.06482744216918945
mini_batch_src_global generation:  0.05444908142089844
r_  generation:  0.5427117347717285
local_output_nid generation:  0.04407334327697754
local_in_edges_tensor generation:  0.06031537055969238
mini_batch_src_global generation:  0.06655383110046387
r_  generation:  0.5809159278869629
----------------------check_connections_block total spend ----------------------------- 1.7257349491119385
generate_one_block  0.706336498260498
generate_one_block  0.7462446689605713
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03640890121459961
gen group dst list time:  0.01721978187561035
time for parepare:  0.02031731605529785
local_output_nid generation:  0.03654980659484863
local_in_edges_tensor generation:  0.06908369064331055
mini_batch_src_global generation:  0.052201032638549805
r_  generation:  0.5735538005828857
local_output_nid generation:  0.044586181640625
local_in_edges_tensor generation:  0.06019306182861328
mini_batch_src_global generation:  0.06487822532653809
r_  generation:  0.5797333717346191
----------------------check_connections_block total spend ----------------------------- 1.7890141010284424
generate_one_block  0.7112152576446533
generate_one_block  0.7700691223144531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03222250938415527
gen group dst list time:  0.011971235275268555
time for parepare:  0.01952672004699707
local_output_nid generation:  0.03699445724487305
local_in_edges_tensor generation:  0.06351518630981445
mini_batch_src_global generation:  0.05060768127441406
r_  generation:  0.5451028347015381
local_output_nid generation:  0.046407461166381836
local_in_edges_tensor generation:  0.0525209903717041
mini_batch_src_global generation:  0.06459403038024902
r_  generation:  0.572608232498169
----------------------check_connections_block total spend ----------------------------- 1.7240140438079834
generate_one_block  0.7063143253326416
generate_one_block  0.7150387763977051
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028570175170898438
gen group dst list time:  0.014143228530883789
time for parepare:  0.019423961639404297
local_output_nid generation:  0.03533458709716797
local_in_edges_tensor generation:  0.062286376953125
mini_batch_src_global generation:  0.046341657638549805
r_  generation:  0.5134739875793457
local_output_nid generation:  0.041803598403930664
local_in_edges_tensor generation:  0.042159318923950195
mini_batch_src_global generation:  0.06152653694152832
r_  generation:  0.5314569473266602
----------------------check_connections_block total spend ----------------------------- 1.61537766456604
generate_one_block  0.6389386653900146
generate_one_block  0.6714823246002197
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.3056001663208008  GigaBytes
Max Memory Allocated: 0.6623668670654297  GigaBytes

{'VmPeak': 24499.09375, 'VmSize': 24435.05859375, 'VmHWM': 6362.796875, 'VmRSS': 6298.85546875}
connection checking time:  8.272120237350464
block generation total time  6.864619970321655
average batch blocks generation time:  3.4323099851608276
block dataloader generation time/epoch 319.8256001472473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.15096426010131836  GigaBytes
Max Memory Allocated: 0.6623668670654297  GigaBytes

{'VmPeak': 24515.7265625, 'VmSize': 24433.80859375, 'VmHWM': 6376.23046875, 'VmRSS': 6294.3125}
torch.Size([167764, 128])
torch.Size([167467, 32])
torch.Size([166577, 32])
torch.Size([163329, 32])
torch.Size([148178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.5695090293884277  GigaBytes
Max Memory Allocated: 0.6623668670654297  GigaBytes

{'VmPeak': 24515.7265625, 'VmSize': 24433.80859375, 'VmHWM': 6376.23046875, 'VmRSS': 6294.3125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.15351533889770508  GigaBytes
Max Memory Allocated: 0.6623668670654297  GigaBytes

{'VmPeak': 24515.91796875, 'VmSize': 24433.80859375, 'VmHWM': 6376.26953125, 'VmRSS': 6295.25390625}
torch.Size([168159, 128])
torch.Size([167999, 32])
torch.Size([167605, 32])
torch.Size([166422, 32])
torch.Size([161917, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.6412124633789062  GigaBytes
Max Memory Allocated: 0.6623668670654297  GigaBytes

{'VmPeak': 24515.91796875, 'VmSize': 24433.80859375, 'VmHWM': 6376.26953125, 'VmRSS': 6295.25390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06817877292633057 |0.0561220645904541 |0.007290959358215332 |0.00012505054473876953 |0.006358027458190918 |0.004892587661743164 |
----------------------------------------------------------pseudo_mini_loss sum 4.687864780426025
Total (block generation + training)time/epoch 320.1754081249237
Training time/epoch 0.34951353073120117
Training time without block to device /epoch 0.23726940155029297
Training time without total dataloading part /epoch 0.0324406623840332
load block tensor time/epoch 0.13635754585266113
block to device time/epoch 0.1122441291809082
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1867859
Number of first layer input nodes during this epoch:  335923
