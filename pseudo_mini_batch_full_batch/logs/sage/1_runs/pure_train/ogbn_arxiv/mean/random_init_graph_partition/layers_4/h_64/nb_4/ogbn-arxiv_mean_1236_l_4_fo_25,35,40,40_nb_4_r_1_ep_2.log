Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648646183.8461354
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

{'VmPeak': 20923.0078125, 'VmSize': 20906.3359375, 'VmHWM': 3745.1875, 'VmRSS': 3745.1875}
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024573802947998047
global_2_local 0.027527332305908203
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.010581016540527344
before graph partition 
		134712, 134426, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45471, 45470, 


	preparing two sides time :  0.1165320873260498
	Initialize BitList time :  0.008717060089111328
	getRedundancyCost: time   2.574920654296875e-05

					length of partitions 134712, 134426

	before terminate 1 the average redundancy rate is:  1.7097571356876498
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.23716592657531477
			 the number of node to move is : 26652
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.472591209112335,  1.0522129684333568,  1.8929694497913132
						 current side  1
			 redundancy will reduce  0.22787190384529876
			 the number of node to move is : 5761
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.481885231842351,  1.1439207689326802,  1.8198496947520217
						 current side  0
			 redundancy will reduce  0.25487729730073116
			 the number of node to move is : 2113
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4548798383869186,  1.074396650848405,  1.8353630259254319
	walk terminate 1 spend time 142.3039939403534
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.24882951217497906
			 the number of node to move is : 5026
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4609276235126707,  1.164795791961274,  1.7570594550640672
						 current side  0
			 redundancy will reduce  0.27969100391962565
			 the number of node to move is : 2239
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.430066131768024,  1.0856917789509126,  1.7744404845851358
						 current side  1
			 redundancy will reduce  0.2843602497887723
			 the number of node to move is : 1285
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4253968858988775,  1.1016243893452256,  1.7491693824525294
	walk terminate 1 spend time 148.76483869552612
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		86705, 137671, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 291.68642687797546
partition_len_list
[86705, 137671]
random_init_graph_partition selection method range initialization spend 291.7697207927704
time for parepare:  0.015834808349609375
local_output_nid generation:  0.006674766540527344
local_in_edges_tensor generation:  0.026135683059692383
mini_batch_src_global generation:  0.0037322044372558594
r_  generation:  0.07312250137329102
local_output_nid generation:  0.020813941955566406
local_in_edges_tensor generation:  0.01953601837158203
mini_batch_src_global generation:  0.02388286590576172
r_  generation:  0.24446988105773926
----------------------check_connections_block total spend ----------------------------- 0.5225894451141357
generate_one_block  0.1045074462890625
generate_one_block  0.3040297031402588
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06473636627197266
gen group dst list time:  0.005275249481201172
time for parepare:  0.020380735397338867
local_output_nid generation:  0.018357276916503906
local_in_edges_tensor generation:  0.045722246170043945
mini_batch_src_global generation:  0.03726482391357422
r_  generation:  0.3619194030761719
local_output_nid generation:  0.03875565528869629
local_in_edges_tensor generation:  0.05376577377319336
mini_batch_src_global generation:  0.06013774871826172
r_  generation:  0.5893192291259766
----------------------check_connections_block total spend ----------------------------- 1.458752155303955
generate_one_block  0.5078866481781006
generate_one_block  0.7296044826507568
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03818488121032715
gen group dst list time:  0.01100611686706543
time for parepare:  0.019024372100830078
local_output_nid generation:  0.0322721004486084
local_in_edges_tensor generation:  0.08386611938476562
mini_batch_src_global generation:  0.05367469787597656
r_  generation:  0.5348742008209229
local_output_nid generation:  0.043586015701293945
local_in_edges_tensor generation:  0.05661797523498535
mini_batch_src_global generation:  0.06203484535217285
r_  generation:  0.5864548683166504
----------------------check_connections_block total spend ----------------------------- 1.737534761428833
generate_one_block  0.7195613384246826
generate_one_block  0.7330105304718018
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03946065902709961
gen group dst list time:  0.01182699203491211
time for parepare:  0.01920294761657715
local_output_nid generation:  0.03782200813293457
local_in_edges_tensor generation:  0.06553912162780762
mini_batch_src_global generation:  0.04835796356201172
r_  generation:  0.5159025192260742
local_output_nid generation:  0.04233980178833008
local_in_edges_tensor generation:  0.08013415336608887
mini_batch_src_global generation:  0.0581514835357666
r_  generation:  0.5410068035125732
----------------------check_connections_block total spend ----------------------------- 1.6590423583984375
generate_one_block  0.6455943584442139
generate_one_block  0.6774852275848389
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00014829635620117188  GigaBytes
Max Memory Allocated: 0.00014829635620117188  GigaBytes

{'VmPeak': 21590.7578125, 'VmSize': 21530.60546875, 'VmHWM': 4634.36328125, 'VmRSS': 4574.40234375}
connection checking time:  4.855329275131226
block generation total time  4.0131425857543945
average batch blocks generation time:  2.0065712928771973
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11443710327148438  GigaBytes
Max Memory Allocated: 0.11443710327148438  GigaBytes

{'VmPeak': 21754.6015625, 'VmSize': 21722.60546875, 'VmHWM': 4639.21875, 'VmRSS': 4639.21875}
torch.Size([166355, 128])
torch.Size([163525, 64])
torch.Size([149449, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.5303030014038086  GigaBytes
Max Memory Allocated: 0.5471782684326172  GigaBytes

{'VmPeak': 22911.81640625, 'VmSize': 22879.8203125, 'VmHWM': 5142.86328125, 'VmRSS': 5142.86328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.12671709060668945  GigaBytes
Max Memory Allocated: 0.5701546669006348  GigaBytes

{'VmPeak': 23441.5234375, 'VmSize': 23346.890625, 'VmHWM': 5223.1640625, 'VmRSS': 5160.43359375}
torch.Size([167334, 128])
torch.Size([166234, 64])
torch.Size([161510, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2498779296875 GB
    Memory Allocated: 0.6225776672363281  GigaBytes
Max Memory Allocated: 0.6576137542724609  GigaBytes

{'VmPeak': 23506.88671875, 'VmSize': 23474.890625, 'VmHWM': 5223.1640625, 'VmRSS': 5160.43359375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0590205192565918 |0.18816256523132324 |0.36315131187438965 |0.00015974044799804688 |0.05648839473724365 |0.004840373992919922 |
----------------------------------------------------------pseudo_mini_loss sum 5.503589630126953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1198783
Number of first layer input nodes during this epoch:  333689
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.22066164016723633  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

{'VmPeak': 23570.88671875, 'VmSize': 23538.890625, 'VmHWM': 5223.1640625, 'VmRSS': 5161.125}
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02258920669555664
global_2_local 0.02729511260986328
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.01104116439819336
before graph partition 
		134661, 134756, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45471, 45470, 


	preparing two sides time :  0.12709689140319824
	Initialize BitList time :  0.012674331665039062
	getRedundancyCost: time   1.049041748046875e-05

					length of partitions 134661, 134756

	before terminate 1 the average redundancy rate is:  1.7126828431029768
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.25233460685157016
			 the number of node to move is : 27045
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4603482362514066,  1.8971438016108628,  1.0235526708919502
						 current side  0
			 redundancy will reduce  0.2435110961368534
			 the number of node to move is : 5470
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4691717469661234,  1.8298104979435117,  1.1085329959887353
						 current side  1
			 redundancy will reduce  0.2738148969848764
			 the number of node to move is : 2079
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4388679461181004,  1.845181714736153,  1.0325541775000477
	walk terminate 1 spend time 146.90228080749512
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.2665742783220071
			 the number of node to move is : 4777
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4461085647809697,  1.7735383676505179,  1.1186787619114216
						 current side  1
			 redundancy will reduce  0.27538507504433984
			 the number of node to move is : 2191
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.437297768058637,  1.8040265213881137,  1.0705690147291602
						 current side  0
			 redundancy will reduce  0.2791992727596355
			 the number of node to move is : 1149
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4334835703433413,  1.7835315656645923,  1.0834355750220905
	walk terminate 1 spend time 150.1197316646576
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		85216, 140281, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 297.6754689216614
partition_len_list
[85216, 140281]
random_init_graph_partition selection method range initialization spend 297.7517080307007
time for parepare:  0.016212940216064453
local_output_nid generation:  0.0062656402587890625
local_in_edges_tensor generation:  0.015453815460205078
mini_batch_src_global generation:  0.004128932952880859
r_  generation:  0.08265209197998047
local_output_nid generation:  0.021363258361816406
local_in_edges_tensor generation:  0.020350933074951172
mini_batch_src_global generation:  0.024338245391845703
r_  generation:  0.23693203926086426
----------------------check_connections_block total spend ----------------------------- 0.5312910079956055
generate_one_block  0.10482025146484375
generate_one_block  0.2979927062988281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04581642150878906
gen group dst list time:  0.0054056644439697266
time for parepare:  0.021567344665527344
local_output_nid generation:  0.01751565933227539
local_in_edges_tensor generation:  0.043625593185424805
mini_batch_src_global generation:  0.03357124328613281
r_  generation:  0.355499267578125
local_output_nid generation:  0.03984832763671875
local_in_edges_tensor generation:  0.0508427619934082
mini_batch_src_global generation:  0.058989524841308594
r_  generation:  0.5353178977966309
----------------------check_connections_block total spend ----------------------------- 1.3702387809753418
generate_one_block  0.48134708404541016
generate_one_block  0.7637522220611572
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03741288185119629
gen group dst list time:  0.016326189041137695
time for parepare:  0.02366328239440918
local_output_nid generation:  0.03078746795654297
local_in_edges_tensor generation:  0.05743098258972168
mini_batch_src_global generation:  0.05504274368286133
r_  generation:  0.5484883785247803
local_output_nid generation:  0.04136347770690918
local_in_edges_tensor generation:  0.05911397933959961
mini_batch_src_global generation:  0.060853004455566406
r_  generation:  0.558436393737793
----------------------check_connections_block total spend ----------------------------- 1.6988389492034912
generate_one_block  0.6666924953460693
generate_one_block  0.699892520904541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.028058767318725586
gen group dst list time:  0.011371612548828125
time for parepare:  0.02024364471435547
local_output_nid generation:  0.03316521644592285
local_in_edges_tensor generation:  0.05499458312988281
mini_batch_src_global generation:  0.05507159233093262
r_  generation:  0.5254673957824707
local_output_nid generation:  0.04055285453796387
local_in_edges_tensor generation:  0.052097320556640625
mini_batch_src_global generation:  0.056282997131347656
r_  generation:  0.5462760925292969
----------------------check_connections_block total spend ----------------------------- 1.6325359344482422
generate_one_block  0.6468889713287354
generate_one_block  0.7008144855499268
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.22066164016723633  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

{'VmPeak': 24295.6484375, 'VmSize': 24240.3515625, 'VmHWM': 5872.40625, 'VmRSS': 5817.18359375}
connection checking time:  4.701613664627075
block generation total time  3.95938777923584
average batch blocks generation time:  1.97969388961792
block dataloader generation time/epoch 308.3530557155609
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.12452936172485352  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

{'VmPeak': 24320.75, 'VmSize': 24239.6015625, 'VmHWM': 5894.1015625, 'VmRSS': 5812.953125}
torch.Size([166185, 128])
torch.Size([162962, 64])
torch.Size([148032, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.5240797996520996  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

{'VmPeak': 24320.75, 'VmSize': 24239.6015625, 'VmHWM': 5894.1015625, 'VmRSS': 5812.953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.1269822120666504  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

{'VmPeak': 24321.37890625, 'VmSize': 24239.6015625, 'VmHWM': 5895.53515625, 'VmRSS': 5814.1796875}
torch.Size([167476, 128])
torch.Size([166590, 64])
torch.Size([162521, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3299560546875 GB
    Memory Allocated: 0.6274185180664062  GigaBytes
Max Memory Allocated: 0.6878795623779297  GigaBytes

{'VmPeak': 24321.37890625, 'VmSize': 24239.6015625, 'VmHWM': 5895.53515625, 'VmRSS': 5814.1796875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05669069290161133 |0.04044008255004883 |0.006578326225280762 |0.00014019012451171875 |0.03346812725067139 |0.004018068313598633 |
----------------------------------------------------------pseudo_mini_loss sum 4.400641441345215
Total (block generation + training)time/epoch 308.6364116668701
Training time/epoch 0.2829160690307617
Training time without block to device /epoch 0.20203590393066406
Training time without total dataloading part /epoch 0.08439135551452637
load block tensor time/epoch 0.11338138580322266
block to device time/epoch 0.08088016510009766
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1199263
Number of first layer input nodes during this epoch:  333661
