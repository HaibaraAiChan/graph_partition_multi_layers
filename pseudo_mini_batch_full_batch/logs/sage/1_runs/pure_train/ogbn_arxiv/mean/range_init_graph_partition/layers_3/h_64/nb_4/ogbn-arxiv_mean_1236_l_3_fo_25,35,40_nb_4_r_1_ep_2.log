Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648584602.5357575
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024741411209106445
global_2_local 0.028003931045532227
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  0.018112897872924805
before graph partition 
		101132, 101413, 101730, 101078, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				22736, 22736, 22736, 22733, 


	preparing two sides time :  0.05112600326538086
	Initialize BitList time :  0.0025992393493652344
	getRedundancyCost: time   6.9141387939453125e-06

					length of partitions 101132, 101413

	before terminate 1 the average redundancy rate is:  2.5755321583886475
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.35286488136110483
			 the number of node to move is : 14770
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.2226672770275426,  3.158770122835126,  1.286564431219959
						 current side  0
			 redundancy will reduce  0.3050278477149617
			 the number of node to move is : 5710
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.2705043106736857,  2.8989344116375473,  1.6420742097098242
						 current side  1
			 redundancy will reduce  0.511889321227843
			 the number of node to move is : 3752
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0636428371608044,  3.042445512575977,  1.084840161745632
	walk terminate 1 spend time 71.80377769470215
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.46958368301925235
			 the number of node to move is : 4883
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.105948475369395,  2.8111950357315427,  1.400701915007248
						 current side  1
			 redundancy will reduce  0.48381272093792127
			 the number of node to move is : 1195
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.091719437450726,  2.8685943897662827,  1.3148444851351695
						 current side  0
			 redundancy will reduce  0.48363469901579315
			 the number of node to move is : 287
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0918974593728543,  2.8469011469698127,  1.3368937717758957
	walk terminate 1 spend time 73.13963317871094
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		52568, 111943, 101730, 101078, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				13899, 31573, 22736, 22733, 


	preparing two sides time :  0.0721890926361084
	Initialize BitList time :  0.0035495758056640625
	getRedundancyCost: time   9.775161743164062e-06

					length of partitions 111943, 101730

	before terminate 1 the average redundancy rate is:  2.7170341547773456
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.06176089112687855
			 the number of node to move is : 8529
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.655273263650467,  2.444012105490705,  2.8665344218102287
						 current side  1
			 redundancy will reduce  0.1922128124920528
			 the number of node to move is : 10995
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.5248213422852928,  2.8821749192543424,  2.167467765316243
						 current side  0
			 redundancy will reduce  0.2246890974288549
			 the number of node to move is : 2747
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.4923450573484907,  2.729559268584217,  2.255130846112764
	walk terminate 1 spend time 85.39490461349487
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.25075659316904453
			 the number of node to move is : 6014
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.466277561608301,  2.4022532489000787,  2.530301874316523
						 current side  1
			 redundancy will reduce  0.3717479209582666
			 the number of node to move is : 4836
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.345286233819079,  2.5949746954553548,  2.095597772182803
						 current side  0
			 redundancy will reduce  0.3802293939625141
			 the number of node to move is : 645
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.3368047608148315,  2.557869840543221,  2.1157396810864424
	walk terminate 1 spend time 88.35494303703308
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		52568, 83193, 100578, 101078, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				13899, 24840, 29469, 22733, 


	preparing two sides time :  0.07186555862426758
	Initialize BitList time :  0.0039021968841552734
	getRedundancyCost: time   5.9604644775390625e-06

					length of partitions 100578, 101078

	before terminate 1 the average redundancy rate is:  2.564227766333511
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.04455634393835339
			 the number of node to move is : 3276
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.5196714223951577,  2.702143892576486,  2.33719895221383
						 current side  0
			 redundancy will reduce  0.05428397039749733
			 the number of node to move is : 3625
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.509943795936014,  2.5729254088146285,  2.4469621830573995
						 current side  1
			 redundancy will reduce  0.4304951552605476
			 the number of node to move is : 11974
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.1337326110729635,  3.021820401312276,  1.2456448208336512
	walk terminate 1 spend time 81.92021751403809
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.4194069326822816
			 the number of node to move is : 5513
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.1448208336512296,  2.7266091910175225,  1.5630324762849368
						 current side  1
			 redundancy will reduce  0.5782533506268912
			 the number of node to move is : 3924
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.98597441570662,  2.8473843493298747,  1.1245644820833651
						 current side  0
			 redundancy will reduce  0.5807838050914267
			 the number of node to move is : 234
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.9834439612420844,  2.8346430660461333,  1.1322448564380356
	walk terminate 1 spend time 83.7115888595581
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		52568, 83193, 44521, 111461, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 485.3340013027191
partition_len_list
[52568, 83193, 44521, 111461]
range_init_graph_partition selection method range initialization spend 485.40128993988037
time for parepare:  0.014869451522827148
local_output_nid generation:  0.0019690990447998047
local_in_edges_tensor generation:  0.020065784454345703
mini_batch_src_global generation:  0.0015993118286132812
r_  generation:  0.030573368072509766
local_output_nid generation:  0.004285097122192383
local_in_edges_tensor generation:  0.004517793655395508
mini_batch_src_global generation:  0.007245779037475586
r_  generation:  0.07010102272033691
local_output_nid generation:  0.002756357192993164
local_in_edges_tensor generation:  0.002469778060913086
mini_batch_src_global generation:  0.003128528594970703
r_  generation:  0.027151823043823242
local_output_nid generation:  0.006346702575683594
local_in_edges_tensor generation:  0.007997751235961914
mini_batch_src_global generation:  0.018040895462036133
r_  generation:  0.17983627319335938
----------------------check_connections_block total spend ----------------------------- 0.49175429344177246
generate_one_block  0.04847979545593262
generate_one_block  0.09541535377502441
generate_one_block  0.035866737365722656
generate_one_block  0.2308816909790039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.060193538665771484
gen group dst list time:  0.007485389709472656
time for parepare:  0.024077653884887695
local_output_nid generation:  0.010825395584106445
local_in_edges_tensor generation:  0.0376284122467041
mini_batch_src_global generation:  0.019647836685180664
r_  generation:  0.20429039001464844
local_output_nid generation:  0.021799325942993164
local_in_edges_tensor generation:  0.028583526611328125
mini_batch_src_global generation:  0.032881736755371094
r_  generation:  0.31104016304016113
local_output_nid generation:  0.013462543487548828
local_in_edges_tensor generation:  0.011221170425415039
mini_batch_src_global generation:  0.0174710750579834
r_  generation:  0.1458117961883545
local_output_nid generation:  0.02298116683959961
local_in_edges_tensor generation:  0.027164936065673828
mini_batch_src_global generation:  0.04761195182800293
r_  generation:  0.48935389518737793
----------------------check_connections_block total spend ----------------------------- 1.735668420791626
generate_one_block  0.27349281311035156
generate_one_block  0.4187963008880615
generate_one_block  0.17774438858032227
generate_one_block  0.6594388484954834
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04383587837219238
gen group dst list time:  0.0282135009765625
time for parepare:  0.02173304557800293
local_output_nid generation:  0.03336834907531738
local_in_edges_tensor generation:  0.05805826187133789
mini_batch_src_global generation:  0.04645538330078125
r_  generation:  0.45432591438293457
local_output_nid generation:  0.040448904037475586
local_in_edges_tensor generation:  0.04988503456115723
mini_batch_src_global generation:  0.05736136436462402
r_  generation:  0.4898808002471924
local_output_nid generation:  0.03318619728088379
local_in_edges_tensor generation:  0.027417659759521484
mini_batch_src_global generation:  0.04242420196533203
r_  generation:  0.3726024627685547
local_output_nid generation:  0.035146474838256836
local_in_edges_tensor generation:  0.033476829528808594
mini_batch_src_global generation:  0.0566859245300293
r_  generation:  0.5140790939331055
----------------------check_connections_block total spend ----------------------------- 2.7784714698791504
generate_one_block  0.5869812965393066
generate_one_block  0.6422758102416992
generate_one_block  0.5005693435668945
generate_one_block  0.6768832206726074
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00011539459228515625  GigaBytes
Max Memory Allocated: 0.00011539459228515625  GigaBytes

connection checking time:  4.514139890670776
block generation total time  3.9361820220947266
average batch blocks generation time:  0.9840455055236816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09215545654296875  GigaBytes
Max Memory Allocated: 0.09215545654296875  GigaBytes

torch.Size([159408, 128])
torch.Size([131547, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.26962804794311523  GigaBytes
Max Memory Allocated: 0.27983617782592773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.10069751739501953  GigaBytes
Max Memory Allocated: 0.29263973236083984  GigaBytes

torch.Size([162762, 128])
torch.Size([147226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.326322078704834  GigaBytes
Max Memory Allocated: 0.34546327590942383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.09038782119750977  GigaBytes
Max Memory Allocated: 0.3639411926269531  GigaBytes

torch.Size([156027, 128])
torch.Size([110988, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.23598480224609375  GigaBytes
Max Memory Allocated: 0.3639411926269531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.10682392120361328  GigaBytes
Max Memory Allocated: 0.3639411926269531  GigaBytes

torch.Size([161731, 128])
torch.Size([149693, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.3750615119934082  GigaBytes
Max Memory Allocated: 0.39944982528686523  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04413628578186035 |0.10079938173294067 |0.1929858922958374 |0.00013118982315063477 |0.01529991626739502 |0.0018000602722167969 |
----------------------------------------------------------pseudo_mini_loss sum 5.216104507446289
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1471125
Number of first layer input nodes during this epoch:  639928
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16827630996704102  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019437789916992188
global_2_local 0.02708601951599121
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  0.018771886825561523
before graph partition 
		101457, 101355, 101303, 101353, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				22736, 22736, 22736, 22733, 


	preparing two sides time :  0.04867911338806152
	Initialize BitList time :  0.002717733383178711
	getRedundancyCost: time   6.4373016357421875e-06

					length of partitions 101457, 101355

	before terminate 1 the average redundancy rate is:  2.578419095445444
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.377217684264056
			 the number of node to move is : 15121
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.201201411181388,  1.2292025553825128,  3.1732002669802624
						 current side  1
			 redundancy will reduce  0.32771191558338364
			 the number of node to move is : 5659
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.25070717986206,  1.5818199154562502,  2.91959444426787
						 current side  0
			 redundancy will reduce  0.5401137844452215
			 the number of node to move is : 3691
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0383053110002223,  1.0259670088675588,  3.0506436131328862
	walk terminate 1 spend time 73.67405915260315
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.4989479706321709
			 the number of node to move is : 4929
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.079471124813273,  1.337240568286559,  2.8217016813399867
						 current side  0
			 redundancy will reduce  0.5566538473762832
			 the number of node to move is : 1179
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0217652480691606,  1.1727044464927057,  2.8708260496456153
						 current side  1
			 redundancy will reduce  0.556958967676318
			 the number of node to move is : 278
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0214601277691258,  1.192003305469917,  2.8509169500683345
	walk terminate 1 spend time 75.6910252571106
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		46880, 112123, 101303, 101353, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				13611, 31861, 22736, 22733, 


	preparing two sides time :  0.06866168975830078
	Initialize BitList time :  0.0042955875396728516
	getRedundancyCost: time   5.4836273193359375e-06

					length of partitions 112123, 101303

	before terminate 1 the average redundancy rate is:  2.713358548135906
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.04269141531322518
			 the number of node to move is : 7851
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.6706671328226808,  2.4846963099513713,  2.85663795569399
						 current side  1
			 redundancy will reduce  0.16606172329402824
			 the number of node to move is : 11039
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.5472968248418777,  2.905355496932905,  2.18923815275085
						 current side  0
			 redundancy will reduce  0.18889489241331114
			 the number of node to move is : 2670
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.524463655722595,  2.756533070590853,  2.2923942408543367
	walk terminate 1 spend time 89.32669973373413
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.21217302863681198
			 the number of node to move is : 5982
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.501185519499094,  2.434326033753933,  2.568045005244255
						 current side  1
			 redundancy will reduce  0.3198677812033184
			 the number of node to move is : 4948
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.3934907669325876,  2.6199154562501987,  2.1670660776149764
						 current side  0
			 redundancy will reduce  0.3273813685916793
			 the number of node to move is : 645
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.3859771795442266,  2.577071480786956,  2.194882878301497
	walk terminate 1 spend time 90.73920130729675
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		46880, 86322, 101353, 101353, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				13611, 23897, 30700, 22733, 


	preparing two sides time :  0.06898236274719238
	Initialize BitList time :  0.003959178924560547
	getRedundancyCost: time   5.9604644775390625e-06

					length of partitions 101353, 101353

	before terminate 1 the average redundancy rate is:  2.577071480786956
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.024778311032005895
			 the number of node to move is : 5141
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.5522931697549502,  2.3755649493055335,  2.729021390204367
						 current side  1
			 redundancy will reduce  0.2869020754537077
			 the number of node to move is : 13116
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.2901694053332484,  2.9031688014493215,  1.6771700092171757
						 current side  0
			 redundancy will reduce  0.2945809363379208
			 the number of node to move is : 998
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.2824905444490353,  2.8535104726186313,  1.7114706162794393
	walk terminate 1 spend time 89.02197885513306
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.294695356450434
			 the number of node to move is : 5280
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.282376124336522,  2.554060324825986,  2.0106919238470584
						 current side  1
			 redundancy will reduce  0.5101102882751167
			 the number of node to move is : 5378
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0669611925118394,  2.722715570670311,  1.4112068143533674
						 current side  0
			 redundancy will reduce  0.5122334170295266
			 the number of node to move is : 186
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 2.0648380637574295,  2.7114261195690177,  1.418250007945841
	walk terminate 1 spend time 90.9687066078186
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		46880, 86322, 55778, 106637, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 510.4198851585388
partition_len_list
[46880, 86322, 55778, 106637]
range_init_graph_partition selection method range initialization spend 510.4850151538849
time for parepare:  0.015044450759887695
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.014382600784301758
mini_batch_src_global generation:  0.0012285709381103516
r_  generation:  0.021708250045776367
local_output_nid generation:  0.003245115280151367
local_in_edges_tensor generation:  0.0049877166748046875
mini_batch_src_global generation:  0.011204242706298828
r_  generation:  0.07033038139343262
local_output_nid generation:  0.002978086471557617
local_in_edges_tensor generation:  0.0027303695678710938
mini_batch_src_global generation:  0.0040934085845947266
r_  generation:  0.038620710372924805
local_output_nid generation:  0.005213260650634766
local_in_edges_tensor generation:  0.007960319519042969
mini_batch_src_global generation:  0.018033981323242188
r_  generation:  0.17789673805236816
----------------------check_connections_block total spend ----------------------------- 0.4826834201812744
generate_one_block  0.04332613945007324
generate_one_block  0.09467124938964844
generate_one_block  0.04995870590209961
generate_one_block  0.22387290000915527
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043506622314453125
gen group dst list time:  0.006394147872924805
time for parepare:  0.020781993865966797
local_output_nid generation:  0.00847315788269043
local_in_edges_tensor generation:  0.021752595901489258
mini_batch_src_global generation:  0.01610541343688965
r_  generation:  0.16636896133422852
local_output_nid generation:  0.020305633544921875
local_in_edges_tensor generation:  0.03167557716369629
mini_batch_src_global generation:  0.0378875732421875
r_  generation:  0.342332124710083
local_output_nid generation:  0.015363216400146484
local_in_edges_tensor generation:  0.016510725021362305
mini_batch_src_global generation:  0.023323774337768555
r_  generation:  0.19829630851745605
local_output_nid generation:  0.020488262176513672
local_in_edges_tensor generation:  0.03190207481384277
mini_batch_src_global generation:  0.05087590217590332
r_  generation:  0.4652533531188965
----------------------check_connections_block total spend ----------------------------- 1.7614684104919434
generate_one_block  0.23469758033752441
generate_one_block  0.47373175621032715
generate_one_block  0.26122117042541504
generate_one_block  0.6713905334472656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035093069076538086
gen group dst list time:  0.018111467361450195
time for parepare:  0.01849985122680664
local_output_nid generation:  0.025758743286132812
local_in_edges_tensor generation:  0.04560971260070801
mini_batch_src_global generation:  0.04230451583862305
r_  generation:  0.4348275661468506
local_output_nid generation:  0.034590959548950195
local_in_edges_tensor generation:  0.05222940444946289
mini_batch_src_global generation:  0.0547792911529541
r_  generation:  0.499035120010376
local_output_nid generation:  0.03245973587036133
local_in_edges_tensor generation:  0.03291583061218262
mini_batch_src_global generation:  0.05003237724304199
r_  generation:  0.44352269172668457
local_output_nid generation:  0.030771732330322266
local_in_edges_tensor generation:  0.03387928009033203
mini_batch_src_global generation:  0.058138370513916016
r_  generation:  0.5158388614654541
----------------------check_connections_block total spend ----------------------------- 2.8464467525482178
generate_one_block  0.5848302841186523
generate_one_block  0.6704070568084717
generate_one_block  0.5590357780456543
generate_one_block  0.6426198482513428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.16827630996704102  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

connection checking time:  4.607915163040161
block generation total time  4.097934007644653
average batch blocks generation time:  1.0244835019111633
block dataloader generation time/epoch 520.9470272064209
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.09768009185791016  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

torch.Size([158837, 128])
torch.Size([126391, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25765275955200195  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.10166168212890625  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

torch.Size([163188, 128])
torch.Size([149255, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.33402538299560547  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.09503173828125  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

torch.Size([159671, 128])
torch.Size([128416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.27025461196899414  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.10660266876220703  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

torch.Size([160313, 128])
torch.Size([146386, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.3664388656616211  GigaBytes
Max Memory Allocated: 0.42742013931274414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04061955213546753 |0.017160356044769287 |0.004609584808349609 |0.00013965368270874023 |0.009320855140686035 |0.00171661376953125 |
----------------------------------------------------------pseudo_mini_loss sum 4.062008857727051
Total (block generation + training)time/epoch 521.2661421298981
Training time/epoch 0.3188767433166504
Training time without block to device /epoch 0.25023531913757324
Training time without total dataloading part /epoch 0.05799698829650879
load block tensor time/epoch 0.16247820854187012
block to device time/epoch 0.06864142417907715
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1488074
Number of first layer input nodes during this epoch:  642009
