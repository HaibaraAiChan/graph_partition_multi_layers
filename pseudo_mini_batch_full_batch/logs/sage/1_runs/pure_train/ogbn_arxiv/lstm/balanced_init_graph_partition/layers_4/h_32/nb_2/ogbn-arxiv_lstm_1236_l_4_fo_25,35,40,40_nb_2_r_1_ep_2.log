Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648795695.3504524
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

{'VmPeak': 20906.26171875, 'VmSize': 20906.26171875, 'VmHWM': 3745.375, 'VmRSS': 3745.375}
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023680686950683594
global_2_local 0.027535200119018555
---------------------------- variant graph partition start---------------------
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
balanced_init for graph_partition spend:  3874.396830558777
before graph partition 
		134612, 134607, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45417, 45524, 


	preparing two sides time :  0.09315919876098633
	Initialize BitList time :  0.012459516525268555
	getRedundancyCost: time   1.4066696166992188e-05

					length of partitions 134612, 134607

	before terminate 1 the average redundancy rate is:  1.710978213895315
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.2551923125810307
			 the number of node to move is : 27555
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4557859013142842,  1.0080585708111955,  1.9035132318173729
						 current side  1
			 redundancy will reduce  0.2473752446805808
			 the number of node to move is : 5407
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.463602969214734,  1.0894704730914915,  1.837735465337977
						 current side  0
			 redundancy will reduce  0.27735973765157484
			 the number of node to move is : 2022
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.43361847624374,  1.0162061163789817,  1.8510308361084984
	walk terminate 1 spend time 46.923861503601074
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2704578386760559
			 the number of node to move is : 4656
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.440520375219259,  1.099422935150113,  1.7816178152884052
						 current side  0
			 redundancy will reduce  0.305698197625645
			 the number of node to move is : 2148
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.40528001626967,  1.0124691766021812,  1.7980908559371584
						 current side  1
			 redundancy will reduce  0.31003889467930956
			 the number of node to move is : 1034
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4009393192160053,  1.0231715687520655,  1.7787070696799452
	walk terminate 1 spend time 52.730021715164185
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		80497, 139938, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 3974.5688400268555
partition_len_list
[80497, 139938]
balanced_init_graph_partition selection method range initialization spend 3974.6316046714783
time for parepare:  0.015197515487670898
local_output_nid generation:  0.003998279571533203
local_in_edges_tensor generation:  0.017988204956054688
mini_batch_src_global generation:  0.0029103755950927734
r_  generation:  0.06524085998535156
local_output_nid generation:  0.00895833969116211
local_in_edges_tensor generation:  0.014749288558959961
mini_batch_src_global generation:  0.02326822280883789
r_  generation:  0.24849152565002441
----------------------check_connections_block total spend ----------------------------- 0.48224592208862305
generate_one_block  0.09080934524536133
generate_one_block  0.3095996379852295
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04977250099182129
gen group dst list time:  0.0047533512115478516
time for parepare:  0.01943230628967285
local_output_nid generation:  0.014820337295532227
local_in_edges_tensor generation:  0.0538783073425293
mini_batch_src_global generation:  0.03139376640319824
r_  generation:  0.32796692848205566
local_output_nid generation:  0.025147676467895508
local_in_edges_tensor generation:  0.04439711570739746
mini_batch_src_global generation:  0.05568099021911621
r_  generation:  0.5375165939331055
----------------------check_connections_block total spend ----------------------------- 1.313079595565796
generate_one_block  0.44831156730651855
generate_one_block  0.7022659778594971
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03736066818237305
gen group dst list time:  0.009163618087768555
time for parepare:  0.019057750701904297
local_output_nid generation:  0.028919458389282227
local_in_edges_tensor generation:  0.06564807891845703
mini_batch_src_global generation:  0.049634695053100586
r_  generation:  0.5535674095153809
local_output_nid generation:  0.03599190711975098
local_in_edges_tensor generation:  0.05644631385803223
mini_batch_src_global generation:  0.06168317794799805
r_  generation:  0.5863678455352783
----------------------check_connections_block total spend ----------------------------- 1.7177646160125732
generate_one_block  0.709383487701416
generate_one_block  0.7099766731262207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0930020809173584
gen group dst list time:  0.014864206314086914
time for parepare:  0.018667936325073242
local_output_nid generation:  0.0318145751953125
local_in_edges_tensor generation:  0.055095672607421875
mini_batch_src_global generation:  0.04521679878234863
r_  generation:  0.506829023361206
local_output_nid generation:  0.03041863441467285
local_in_edges_tensor generation:  0.0744774341583252
mini_batch_src_global generation:  0.05708122253417969
r_  generation:  0.5298073291778564
----------------------check_connections_block total spend ----------------------------- 1.5841038227081299
generate_one_block  0.630967378616333
generate_one_block  0.6566441059112549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

{'VmPeak': 21584.3125, 'VmSize': 21500.45703125, 'VmHWM': 4596.3046875, 'VmRSS': 4512.640625}
connection checking time:  4.614948034286499
block generation total time  3.8575491905212402
average batch blocks generation time:  1.9287745952606201
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11397027969360352  GigaBytes
Max Memory Allocated: 0.11397027969360352  GigaBytes

{'VmPeak': 21724.453125, 'VmSize': 21692.45703125, 'VmHWM': 4596.3046875, 'VmRSS': 4577.58203125}
torch.Size([166254, 128])
torch.Size([162948, 32])
torch.Size([146842, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5955810546875 GB
    Memory Allocated: 17.32752275466919  GigaBytes
Max Memory Allocated: 17.346713542938232  GigaBytes

{'VmPeak': 41838.56640625, 'VmSize': 41812.09375, 'VmHWM': 4840.98828125, 'VmRSS': 4840.98828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6151123046875 GB
    Memory Allocated: 0.12739276885986328  GigaBytes
Max Memory Allocated: 17.346713542938232  GigaBytes

{'VmPeak': 43078.58984375, 'VmSize': 43009.6953125, 'VmHWM': 4922.74609375, 'VmRSS': 4854.5546875}
torch.Size([167476, 128])
torch.Size([166479, 32])
torch.Size([162087, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 19.582854747772217  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 43873.69140625, 'VmSize': 43841.6953125, 'VmHWM': 4922.74609375, 'VmRSS': 4854.5546875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047519683837890625 |0.1820908784866333 |0.9081258773803711 |0.00022149085998535156 |0.4911079406738281 |0.009760618209838867 |
----------------------------------------------------------pseudo_mini_loss sum 4.474584579467773
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1192521
Number of first layer input nodes during this epoch:  333730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 0.21295499801635742  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 43873.69140625, 'VmSize': 43841.6953125, 'VmHWM': 4922.74609375, 'VmRSS': 4855.1796875}
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.018962621688842773
global_2_local 0.027997493743896484
---------------------------- variant graph partition start---------------------
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
balanced_init for graph_partition spend:  3867.646013736725
before graph partition 
		134568, 134569, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45273, 45668, 


	preparing two sides time :  0.09093832969665527
	Initialize BitList time :  0.006460666656494141
	getRedundancyCost: time   1.8596649169921875e-05

					length of partitions 134568, 134569

	before terminate 1 the average redundancy rate is:  1.710544044743867
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.253126986144655
			 the number of node to move is : 27495
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.457417058599212,  1.900864370153807,  1.0139697470446167
						 current side  0
			 redundancy will reduce  0.24428625905681978
			 the number of node to move is : 5629
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4662577856870471,  1.8336087453921444,  1.0989068259819499
						 current side  1
			 redundancy will reduce  0.273751112241007
			 the number of node to move is : 2029
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4367929325028599,  1.847705605694674,  1.025880259311046
	walk terminate 1 spend time 48.31120538711548
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.26644209991102086
			 the number of node to move is : 4993
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.444101944832846,  1.7730519893224863,  1.1151519003432058
						 current side  1
			 redundancy will reduce  0.27541629591966466
			 the number of node to move is : 2126
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4351277488242022,  1.800953349434346,  1.0693021482140588
						 current side  0
			 redundancy will reduce  0.28003050718189915
			 the number of node to move is : 1228
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4305135375619678,  1.778301766874285,  1.0827253082496504
	walk terminate 1 spend time 52.49588322639465
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		85178, 139899, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 3968.968325853348
partition_len_list
[85178, 139899]
balanced_init_graph_partition selection method range initialization spend 3969.0232388973236
time for parepare:  0.014919281005859375
local_output_nid generation:  0.004327297210693359
local_in_edges_tensor generation:  0.019152164459228516
mini_batch_src_global generation:  0.00394892692565918
r_  generation:  0.07057881355285645
local_output_nid generation:  0.010477781295776367
local_in_edges_tensor generation:  0.017735004425048828
mini_batch_src_global generation:  0.025050878524780273
r_  generation:  0.25067830085754395
----------------------check_connections_block total spend ----------------------------- 0.4974849224090576
generate_one_block  0.13335275650024414
generate_one_block  0.33698511123657227
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.043665409088134766
gen group dst list time:  0.005354881286621094
time for parepare:  0.020972728729248047
local_output_nid generation:  0.018755197525024414
local_in_edges_tensor generation:  0.038251399993896484
mini_batch_src_global generation:  0.03387308120727539
r_  generation:  0.34841489791870117
local_output_nid generation:  0.028315305709838867
local_in_edges_tensor generation:  0.04674053192138672
mini_batch_src_global generation:  0.05560946464538574
r_  generation:  0.5521090030670166
----------------------check_connections_block total spend ----------------------------- 1.3533895015716553
generate_one_block  0.530040979385376
generate_one_block  0.7562310695648193
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03258109092712402
gen group dst list time:  0.018059253692626953
time for parepare:  0.01800084114074707
local_output_nid generation:  0.028230905532836914
local_in_edges_tensor generation:  0.06033492088317871
mini_batch_src_global generation:  0.05313396453857422
r_  generation:  0.5345544815063477
local_output_nid generation:  0.02911663055419922
local_in_edges_tensor generation:  0.04813504219055176
mini_batch_src_global generation:  0.060591697692871094
r_  generation:  0.5597724914550781
----------------------check_connections_block total spend ----------------------------- 1.6352250576019287
generate_one_block  0.7133667469024658
generate_one_block  0.740386962890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02782917022705078
gen group dst list time:  0.01085805892944336
time for parepare:  0.019152164459228516
local_output_nid generation:  0.03211021423339844
local_in_edges_tensor generation:  0.04535341262817383
mini_batch_src_global generation:  0.04691767692565918
r_  generation:  0.5147655010223389
local_output_nid generation:  0.030094623565673828
local_in_edges_tensor generation:  0.04267144203186035
mini_batch_src_global generation:  0.05779075622558594
r_  generation:  0.5298061370849609
----------------------check_connections_block total spend ----------------------------- 1.553222417831421
generate_one_block  0.6545522212982178
generate_one_block  0.7273128032684326
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 0.21295499801635742  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 44604.81640625, 'VmSize': 44537.03515625, 'VmHWM': 5561.640625, 'VmRSS': 5493.98046875}
connection checking time:  4.541836977005005
block generation total time  4.1218907833099365
average batch blocks generation time:  2.0609453916549683
block dataloader generation time/epoch 3979.7988255023956
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 0.12657880783081055  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 44617.69921875, 'VmSize': 44536.53515625, 'VmHWM': 5571.28515625, 'VmRSS': 5490.12109375}
torch.Size([166221, 128])
torch.Size([163213, 32])
torch.Size([148476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 17.540435314178467  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 44617.69921875, 'VmSize': 44536.53515625, 'VmHWM': 5571.28515625, 'VmRSS': 5490.12109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 0.12880182266235352  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 44618.30078125, 'VmSize': 44536.53515625, 'VmHWM': 5571.55859375, 'VmRSS': 5491.8984375}
torch.Size([167452, 128])
torch.Size([166524, 32])
torch.Size([162332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9256591796875 GB
    Memory Allocated: 19.53483247756958  GigaBytes
Max Memory Allocated: 19.665627479553223  GigaBytes

{'VmPeak': 44618.30078125, 'VmSize': 44536.53515625, 'VmHWM': 5571.55859375, 'VmRSS': 5491.8984375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03608715534210205 |0.02753758430480957 |0.3797377347946167 |0.0001271963119506836 |0.49350666999816895 |0.008274555206298828 |
----------------------------------------------------------pseudo_mini_loss sum 3.9594478607177734
Total (block generation + training)time/epoch 3981.7065715789795
Training time/epoch 1.9074578285217285
Training time without block to device /epoch 1.8523826599121094
Training time without total dataloading part /epoch 1.7550177574157715
load block tensor time/epoch 0.0721743106842041
block to device time/epoch 0.05507516860961914
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1199295
Number of first layer input nodes during this epoch:  333673
