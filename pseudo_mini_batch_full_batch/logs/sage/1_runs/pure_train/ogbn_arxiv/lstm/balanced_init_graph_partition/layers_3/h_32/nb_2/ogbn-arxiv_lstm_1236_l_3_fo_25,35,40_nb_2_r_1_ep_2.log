Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648735037.1887572
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

{'VmPeak': 20924.453125, 'VmSize': 20910.88671875, 'VmHWM': 3750.609375, 'VmRSS': 3750.609375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02367997169494629
global_2_local 0.027686119079589844
---------------------------- variant graph partition start---------------------
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
balanced_init for graph_partition spend:  3829.3676891326904
before graph partition 
		134409, 134406, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45701, 45240, 


	preparing two sides time :  0.09265947341918945
	Initialize BitList time :  0.010184288024902344
	getRedundancyCost: time   1.1682510375976562e-05

					length of partitions 134409, 134406

	before terminate 1 the average redundancy rate is:  1.7089211130253463
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.24757630275713427
			 the number of node to move is : 27292
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.461344810268212,  1.0257913172834248,  1.8968983032529991
						 current side  1
			 redundancy will reduce  0.2378497275923228
			 the number of node to move is : 5714
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4710713854330235,  1.1150215192528974,  1.8271212516131494
						 current side  0
			 redundancy will reduce  0.2681038264219555
			 the number of node to move is : 1974
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4408172866033908,  1.0392178053540664,  1.8424167678527155
	walk terminate 1 spend time 45.19716143608093
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2595024825017005
			 the number of node to move is : 4883
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4494186305236458,  1.1286005810516144,  1.770236679995677
						 current side  0
			 redundancy will reduce  0.29142853510149336
			 the number of node to move is : 2165
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.417492577923853,  1.0475966459208779,  1.787388509926828
						 current side  1
			 redundancy will reduce  0.29564974157824797
			 the number of node to move is : 1167
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4132713714470984,  1.0605399838526137,  1.7660027590415828
	walk terminate 1 spend time 51.56546092033386
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83412, 138897, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 3926.6319558620453
partition_len_list
[83412, 138897]
balanced_init_graph_partition selection method range initialization spend 3926.6918618679047
time for parepare:  0.013993501663208008
local_output_nid generation:  0.004005908966064453
local_in_edges_tensor generation:  0.017191171646118164
mini_batch_src_global generation:  0.003884553909301758
r_  generation:  0.06720900535583496
local_output_nid generation:  0.008452177047729492
local_in_edges_tensor generation:  0.014578580856323242
mini_batch_src_global generation:  0.02289271354675293
r_  generation:  0.24217700958251953
----------------------check_connections_block total spend ----------------------------- 0.47774529457092285
generate_one_block  0.10545134544372559
generate_one_block  0.30241823196411133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04667258262634277
gen group dst list time:  0.004887104034423828
time for parepare:  0.01999354362487793
local_output_nid generation:  0.01560354232788086
local_in_edges_tensor generation:  0.03838825225830078
mini_batch_src_global generation:  0.0311124324798584
r_  generation:  0.3217158317565918
local_output_nid generation:  0.02559971809387207
local_in_edges_tensor generation:  0.042513370513916016
mini_batch_src_global generation:  0.05379462242126465
r_  generation:  0.5219602584838867
----------------------check_connections_block total spend ----------------------------- 1.2649857997894287
generate_one_block  0.42684507369995117
generate_one_block  0.660498857498169
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03177356719970703
gen group dst list time:  0.009527921676635742
time for parepare:  0.020076274871826172
local_output_nid generation:  0.02958059310913086
local_in_edges_tensor generation:  0.04026174545288086
mini_batch_src_global generation:  0.04744124412536621
r_  generation:  0.4869842529296875
local_output_nid generation:  0.03163576126098633
local_in_edges_tensor generation:  0.04513669013977051
mini_batch_src_global generation:  0.058885812759399414
r_  generation:  0.5332252979278564
----------------------check_connections_block total spend ----------------------------- 1.5378272533416748
generate_one_block  0.6463332176208496
generate_one_block  0.6523106098175049
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

{'VmPeak': 21430.43359375, 'VmSize': 21349.09765625, 'VmHWM': 4443.1875, 'VmRSS': 4362.05078125}
connection checking time:  2.8028130531311035
block generation total time  2.3859877586364746
average batch blocks generation time:  1.1929938793182373
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09977293014526367  GigaBytes
Max Memory Allocated: 0.09977293014526367  GigaBytes

{'VmPeak': 21556.578125, 'VmSize': 21509.09765625, 'VmHWM': 4443.1875, 'VmRSS': 4424.0703125}
torch.Size([162777, 128])
torch.Size([147762, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0291748046875 GB
    Memory Allocated: 13.766287326812744  GigaBytes
Max Memory Allocated: 13.786588191986084  GigaBytes

{'VmPeak': 38995.99609375, 'VmSize': 38969.32421875, 'VmHWM': 4747.90234375, 'VmRSS': 4747.90234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3143310546875 GB
    Memory Allocated: 0.11415910720825195  GigaBytes
Max Memory Allocated: 13.786588191986084  GigaBytes

{'VmPeak': 39370.890625, 'VmSize': 39301.828125, 'VmHWM': 4830.56640625, 'VmRSS': 4761.47265625}
torch.Size([166109, 128])
torch.Size([161674, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.4354248046875 GB
    Memory Allocated: 16.099559783935547  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 41477.82421875, 'VmSize': 41445.828125, 'VmHWM': 4830.56640625, 'VmRSS': 4761.47265625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04499256610870361 |0.17357289791107178 |0.6568983793258667 |0.00015556812286376953 |0.3231220245361328 |0.0073089599609375 |
----------------------------------------------------------pseudo_mini_loss sum 4.392926216125488
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  860631
Number of first layer input nodes during this epoch:  328886
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.6815185546875 GB
    Memory Allocated: 0.17015409469604492  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 41797.82421875, 'VmSize': 41765.828125, 'VmHWM': 4830.56640625, 'VmRSS': 4762.09765625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027125835418701172
global_2_local 0.02868795394897461
---------------------------- variant graph partition start---------------------
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  0
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  1
p_id  0
p_id  1
p_id  0
p_id  1
p_id  0
p_id  0
p_id  0
p_id  1
balanced_init for graph_partition spend:  3841.622805118561
before graph partition 
		134670, 134669, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				45345, 45596, 


	preparing two sides time :  0.09167075157165527
	Initialize BitList time :  0.006587028503417969
	getRedundancyCost: time   1.4543533325195312e-05

					length of partitions 134670, 134669

	before terminate 1 the average redundancy rate is:  1.7110666412553206
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.24138873006797557
			 the number of node to move is : 27007
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.469677911187345,  1.0405183914617877,  1.8988374309129026
						 current side  1
			 redundancy will reduce  0.23225970395781736
			 the number of node to move is : 5618
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4788069372975032,  1.1285178832348643,  1.8290959913601423
						 current side  0
			 redundancy will reduce  0.26081570421193057
			 the number of node to move is : 2083
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.45025093704339,  1.0562607204116639,  1.844241153675116
	walk terminate 1 spend time 48.71799826622009
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2538212311797219
			 the number of node to move is : 4818
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4572454100755987,  1.1422400101645385,  1.772250809986659
						 current side  0
			 redundancy will reduce  0.286487516676196
			 the number of node to move is : 2227
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4245791245791246,  1.0600978336827394,  1.7890604154755099
						 current side  1
			 redundancy will reduce  0.2907439171590116
			 the number of node to move is : 1103
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.420322724096309,  1.0721682231116194,  1.7684772250809986
	walk terminate 1 spend time 53.151955127716064
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		84385, 139188, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 3943.974621772766
partition_len_list
[84385, 139188]
balanced_init_graph_partition selection method range initialization spend 3944.029618740082
time for parepare:  0.014667034149169922
local_output_nid generation:  0.003808259963989258
local_in_edges_tensor generation:  0.015033960342407227
mini_batch_src_global generation:  0.003596782684326172
r_  generation:  0.06594252586364746
local_output_nid generation:  0.008632898330688477
local_in_edges_tensor generation:  0.01635289192199707
mini_batch_src_global generation:  0.02352285385131836
r_  generation:  0.2422046661376953
----------------------check_connections_block total spend ----------------------------- 0.477916955947876
generate_one_block  0.11747860908508301
generate_one_block  0.3219764232635498
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04109477996826172
gen group dst list time:  0.004764556884765625
time for parepare:  0.019843578338623047
local_output_nid generation:  0.017749309539794922
local_in_edges_tensor generation:  0.03330254554748535
mini_batch_src_global generation:  0.03516554832458496
r_  generation:  0.3508646488189697
local_output_nid generation:  0.024886131286621094
local_in_edges_tensor generation:  0.04356503486633301
mini_batch_src_global generation:  0.057952880859375
r_  generation:  0.528637170791626
----------------------check_connections_block total spend ----------------------------- 1.3086133003234863
generate_one_block  0.4697287082672119
generate_one_block  0.6875457763671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03853797912597656
gen group dst list time:  0.010974407196044922
time for parepare:  0.020073890686035156
local_output_nid generation:  0.027645349502563477
local_in_edges_tensor generation:  0.04722738265991211
mini_batch_src_global generation:  0.046988487243652344
r_  generation:  0.5033066272735596
local_output_nid generation:  0.033286094665527344
local_in_edges_tensor generation:  0.046233415603637695
mini_batch_src_global generation:  0.0614469051361084
r_  generation:  0.5267515182495117
----------------------check_connections_block total spend ----------------------------- 1.546612024307251
generate_one_block  0.6506702899932861
generate_one_block  0.6788077354431152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.6815185546875 GB
    Memory Allocated: 0.17015409469604492  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 42371.59375, 'VmSize': 42303.6328125, 'VmHWM': 5310.32421875, 'VmRSS': 5244.61328125}
connection checking time:  2.8552253246307373
block generation total time  2.486752510070801
average batch blocks generation time:  1.2433762550354004
block dataloader generation time/epoch 3951.1825864315033
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6815185546875 GB
    Memory Allocated: 0.11108970642089844  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 42382.52734375, 'VmSize': 42303.1328125, 'VmHWM': 5320.78125, 'VmRSS': 5241.38671875}
torch.Size([162592, 128])
torch.Size([147816, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6815185546875 GB
    Memory Allocated: 13.862921237945557  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 42382.52734375, 'VmSize': 42303.1328125, 'VmHWM': 5320.78125, 'VmRSS': 5241.38671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6815185546875 GB
    Memory Allocated: 0.11634063720703125  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 42384.30078125, 'VmSize': 42303.1328125, 'VmHWM': 5322.359375, 'VmRSS': 5241.44140625}
torch.Size([166228, 128])
torch.Size([161852, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6815185546875 GB
    Memory Allocated: 16.091607570648193  GigaBytes
Max Memory Allocated: 16.181405544281006  GigaBytes

{'VmPeak': 42384.30078125, 'VmSize': 42303.1328125, 'VmHWM': 5322.359375, 'VmRSS': 5241.44140625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038327813148498535 |0.018945813179016113 |0.27359533309936523 |0.0001609325408935547 |0.3277784585952759 |0.006039619445800781 |
----------------------------------------------------------pseudo_mini_loss sum 3.721261501312256
Total (block generation + training)time/epoch 3952.5310921669006
Training time/epoch 1.348238468170166
Training time without block to device /epoch 1.3103468418121338
Training time without total dataloading part /epoch 1.2091090679168701
load block tensor time/epoch 0.07665562629699707
block to device time/epoch 0.03789162635803223
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  862061
Number of first layer input nodes during this epoch:  328820
