Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648462149.219708
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029976606369018555
random selection method range initialization spend 0.0073108673095703125
time for parepare:  0.019927978515625
local_output_nid generation:  0.0022487640380859375
local_in_edges_tensor generation:  0.0054247379302978516
mini_batch_src_global generation:  0.0023415088653564453
r_  generation:  0.022119522094726562
local_output_nid generation:  0.0026483535766601562
local_in_edges_tensor generation:  0.001743316650390625
mini_batch_src_global generation:  0.0026323795318603516
r_  generation:  0.03273320198059082
local_output_nid generation:  0.002852916717529297
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.0015316009521484375
r_  generation:  0.020871639251708984
local_output_nid generation:  0.0029993057250976562
local_in_edges_tensor generation:  0.0016205310821533203
mini_batch_src_global generation:  0.0016205310821533203
r_  generation:  0.02042245864868164
local_output_nid generation:  0.002885580062866211
local_in_edges_tensor generation:  0.0016379356384277344
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.020773887634277344
local_output_nid generation:  0.002956390380859375
local_in_edges_tensor generation:  0.0016102790832519531
mini_batch_src_global generation:  0.0016865730285644531
r_  generation:  0.020978212356567383
local_output_nid generation:  0.0030176639556884766
local_in_edges_tensor generation:  0.0016207695007324219
mini_batch_src_global generation:  0.0016922950744628906
r_  generation:  0.021203041076660156
local_output_nid generation:  0.002939939498901367
local_in_edges_tensor generation:  0.0016047954559326172
mini_batch_src_global generation:  0.0016090869903564453
r_  generation:  0.020514249801635742
local_output_nid generation:  0.0028934478759765625
local_in_edges_tensor generation:  0.0015723705291748047
mini_batch_src_global generation:  0.0016143321990966797
r_  generation:  0.02052760124206543
local_output_nid generation:  0.002945423126220703
local_in_edges_tensor generation:  0.0015938282012939453
mini_batch_src_global generation:  0.0016906261444091797
r_  generation:  0.02168130874633789
local_output_nid generation:  0.002980470657348633
local_in_edges_tensor generation:  0.0017392635345458984
mini_batch_src_global generation:  0.0017015933990478516
r_  generation:  0.02130889892578125
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0016961097717285156
r_  generation:  0.021395206451416016
local_output_nid generation:  0.003007650375366211
local_in_edges_tensor generation:  0.0016791820526123047
mini_batch_src_global generation:  0.0016901493072509766
r_  generation:  0.020885705947875977
local_output_nid generation:  0.0029773712158203125
local_in_edges_tensor generation:  0.001575469970703125
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.021782875061035156
local_output_nid generation:  0.0029163360595703125
local_in_edges_tensor generation:  0.0016117095947265625
mini_batch_src_global generation:  0.001997232437133789
r_  generation:  0.02173304557800293
local_output_nid generation:  0.003047466278076172
local_in_edges_tensor generation:  0.0016090869903564453
mini_batch_src_global generation:  0.0018303394317626953
r_  generation:  0.022086620330810547
----------------------check_connections_block total spend ----------------------------- 0.5629913806915283
generate_one_block  0.031055450439453125
generate_one_block  0.031516313552856445
generate_one_block  0.03442883491516113
generate_one_block  0.031599998474121094
generate_one_block  0.031640052795410156
generate_one_block  0.030759572982788086
generate_one_block  0.030633926391601562
generate_one_block  0.030077219009399414
generate_one_block  0.029890775680541992
generate_one_block  0.03127121925354004
generate_one_block  0.030892133712768555
generate_one_block  0.031111478805541992
generate_one_block  0.030595064163208008
generate_one_block  0.032349348068237305
generate_one_block  0.0325779914855957
generate_one_block  0.032730817794799805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04492497444152832
gen group dst list time:  0.02128005027770996
time for parepare:  0.019367694854736328
local_output_nid generation:  0.009090423583984375
local_in_edges_tensor generation:  0.022847414016723633
mini_batch_src_global generation:  0.027426719665527344
r_  generation:  0.2524604797363281
local_output_nid generation:  0.013401031494140625
local_in_edges_tensor generation:  0.023774385452270508
mini_batch_src_global generation:  0.031922340393066406
r_  generation:  0.25519585609436035
local_output_nid generation:  0.013124465942382812
local_in_edges_tensor generation:  0.01957845687866211
mini_batch_src_global generation:  0.031560420989990234
r_  generation:  0.27543044090270996
local_output_nid generation:  0.01303863525390625
local_in_edges_tensor generation:  0.01995706558227539
mini_batch_src_global generation:  0.03238654136657715
r_  generation:  0.27196407318115234
local_output_nid generation:  0.013036012649536133
local_in_edges_tensor generation:  0.014738321304321289
mini_batch_src_global generation:  0.035543203353881836
r_  generation:  0.2868626117706299
local_output_nid generation:  0.013095855712890625
local_in_edges_tensor generation:  0.01757955551147461
mini_batch_src_global generation:  0.03420376777648926
r_  generation:  0.28972721099853516
local_output_nid generation:  0.01602482795715332
local_in_edges_tensor generation:  0.03521323204040527
mini_batch_src_global generation:  0.06158161163330078
r_  generation:  0.26955127716064453
local_output_nid generation:  0.013290166854858398
local_in_edges_tensor generation:  0.01852583885192871
mini_batch_src_global generation:  0.03358960151672363
r_  generation:  0.2629523277282715
local_output_nid generation:  0.013283491134643555
local_in_edges_tensor generation:  0.02011871337890625
mini_batch_src_global generation:  0.03387331962585449
r_  generation:  0.26535892486572266
local_output_nid generation:  0.013471841812133789
local_in_edges_tensor generation:  0.016221046447753906
mini_batch_src_global generation:  0.033756256103515625
r_  generation:  0.27045464515686035
local_output_nid generation:  0.013495445251464844
local_in_edges_tensor generation:  0.016186237335205078
mini_batch_src_global generation:  0.03396797180175781
r_  generation:  0.27109265327453613
local_output_nid generation:  0.013619184494018555
local_in_edges_tensor generation:  0.015985727310180664
mini_batch_src_global generation:  0.03625988960266113
r_  generation:  0.26842641830444336
local_output_nid generation:  0.013316631317138672
local_in_edges_tensor generation:  0.016485214233398438
mini_batch_src_global generation:  0.0340421199798584
r_  generation:  0.26980161666870117
local_output_nid generation:  0.013554096221923828
local_in_edges_tensor generation:  0.016710281372070312
mini_batch_src_global generation:  0.03671765327453613
r_  generation:  0.27358365058898926
local_output_nid generation:  0.013463497161865234
local_in_edges_tensor generation:  0.016329526901245117
mini_batch_src_global generation:  0.03394341468811035
r_  generation:  0.27031493186950684
local_output_nid generation:  0.01358938217163086
local_in_edges_tensor generation:  0.01699686050415039
mini_batch_src_global generation:  0.03665447235107422
r_  generation:  0.29326438903808594
----------------------check_connections_block total spend ----------------------------- 6.4037981033325195
generate_one_block  0.369581937789917
generate_one_block  0.3684275150299072
generate_one_block  0.35955166816711426
generate_one_block  0.3560459613800049
generate_one_block  0.38785290718078613
generate_one_block  0.35489654541015625
generate_one_block  0.34934520721435547
generate_one_block  0.3497612476348877
generate_one_block  0.3485991954803467
generate_one_block  0.3570973873138428
generate_one_block  0.3585987091064453
generate_one_block  0.3546106815338135
generate_one_block  0.3497641086578369
generate_one_block  0.3691878318786621
generate_one_block  0.37415575981140137
generate_one_block  0.37169647216796875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05146217346191406
gen group dst list time:  0.06885075569152832
time for parepare:  0.019379854202270508
local_output_nid generation:  0.027683258056640625
local_in_edges_tensor generation:  0.0664517879486084
mini_batch_src_global generation:  0.05881047248840332
r_  generation:  0.5282089710235596
local_output_nid generation:  0.03474593162536621
local_in_edges_tensor generation:  0.05495405197143555
mini_batch_src_global generation:  0.07152605056762695
r_  generation:  0.5512895584106445
local_output_nid generation:  0.035929203033447266
local_in_edges_tensor generation:  0.04849410057067871
mini_batch_src_global generation:  0.06859254837036133
r_  generation:  0.5342743396759033
local_output_nid generation:  0.03334689140319824
local_in_edges_tensor generation:  0.04148054122924805
mini_batch_src_global generation:  0.060396432876586914
r_  generation:  0.5359377861022949
local_output_nid generation:  0.03316903114318848
local_in_edges_tensor generation:  0.0324711799621582
mini_batch_src_global generation:  0.06102609634399414
r_  generation:  0.537834882736206
local_output_nid generation:  0.03371119499206543
local_in_edges_tensor generation:  0.03706979751586914
mini_batch_src_global generation:  0.06537914276123047
r_  generation:  0.5405888557434082
local_output_nid generation:  0.03445792198181152
local_in_edges_tensor generation:  0.04922008514404297
mini_batch_src_global generation:  0.06210732460021973
r_  generation:  0.5406177043914795
local_output_nid generation:  0.03364205360412598
local_in_edges_tensor generation:  0.03218960762023926
mini_batch_src_global generation:  0.06239724159240723
r_  generation:  0.5390927791595459
local_output_nid generation:  0.03363990783691406
local_in_edges_tensor generation:  0.0321805477142334
mini_batch_src_global generation:  0.06582427024841309
r_  generation:  0.5392189025878906
local_output_nid generation:  0.033609628677368164
local_in_edges_tensor generation:  0.037378549575805664
mini_batch_src_global generation:  0.06257247924804688
r_  generation:  0.5417735576629639
local_output_nid generation:  0.03369879722595215
local_in_edges_tensor generation:  0.04199552536010742
mini_batch_src_global generation:  0.06239128112792969
r_  generation:  0.542083740234375
local_output_nid generation:  0.03362584114074707
local_in_edges_tensor generation:  0.04566669464111328
mini_batch_src_global generation:  0.06191754341125488
r_  generation:  0.5695655345916748
local_output_nid generation:  0.03388690948486328
local_in_edges_tensor generation:  0.0389251708984375
mini_batch_src_global generation:  0.06268048286437988
r_  generation:  0.5464251041412354
local_output_nid generation:  0.03482675552368164
local_in_edges_tensor generation:  0.048349857330322266
mini_batch_src_global generation:  0.06635785102844238
r_  generation:  0.5458755493164062
local_output_nid generation:  0.033332109451293945
local_in_edges_tensor generation:  0.03187704086303711
mini_batch_src_global generation:  0.06240224838256836
r_  generation:  0.5401458740234375
local_output_nid generation:  0.03352808952331543
local_in_edges_tensor generation:  0.032512664794921875
mini_batch_src_global generation:  0.061873674392700195
r_  generation:  0.5451431274414062
----------------------check_connections_block total spend ----------------------------- 12.862563610076904
generate_one_block  0.6927275657653809
generate_one_block  0.6911580562591553
generate_one_block  0.6795179843902588
generate_one_block  0.6910593509674072
generate_one_block  0.6735150814056396
generate_one_block  0.6921381950378418
generate_one_block  0.7551512718200684
generate_one_block  0.6691863536834717
generate_one_block  0.687716007232666
generate_one_block  0.7003943920135498
generate_one_block  0.7026615142822266
generate_one_block  0.6733095645904541
generate_one_block  0.6962504386901855
generate_one_block  0.69100022315979
generate_one_block  0.668710470199585
generate_one_block  0.6872644424438477
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  19.266361713409424
block generation total time  16.830934047698975
average batch blocks generation time:  1.051933377981186
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09697771072387695  GigaBytes
Max Memory Allocated: 0.09697771072387695  GigaBytes

torch.Size([157672, 128])
torch.Size([130494, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6014404296875 GB
    Memory Allocated: 19.918071746826172  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 0.09919500350952148  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157729, 128])
torch.Size([130214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 19.826382160186768  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 0.09920787811279297  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157558, 128])
torch.Size([129982, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 19.90030336380005  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 0.09923362731933594  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157654, 128])
torch.Size([130154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 19.876463890075684  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 0.09899616241455078  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157120, 128])
torch.Size([129400, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8494873046875 GB
    Memory Allocated: 19.894172191619873  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09915781021118164  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157645, 128])
torch.Size([129771, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.82534408569336  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09915304183959961  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157635, 128])
torch.Size([130262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.811586380004883  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09891748428344727  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157395, 128])
torch.Size([129622, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.684658527374268  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09899568557739258  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157613, 128])
torch.Size([129885, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.646623611450195  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09914350509643555  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157503, 128])
torch.Size([130156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.875492572784424  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.10017108917236328  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157720, 128])
torch.Size([130115, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.843809127807617  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09909629821777344  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157482, 128])
torch.Size([129756, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.83712911605835  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09898567199707031  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157364, 128])
torch.Size([129491, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.794883251190186  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09930801391601562  GigaBytes
Max Memory Allocated: 19.95125436782837  GigaBytes

torch.Size([157670, 128])
torch.Size([130291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.947879314422607  GigaBytes
Max Memory Allocated: 19.98198127746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.0990142822265625  GigaBytes
Max Memory Allocated: 19.98198127746582  GigaBytes

torch.Size([157410, 128])
torch.Size([129291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.7919659614563  GigaBytes
Max Memory Allocated: 19.98198127746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 0.09921026229858398  GigaBytes
Max Memory Allocated: 19.98198127746582  GigaBytes

torch.Size([157429, 128])
torch.Size([129901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2615966796875 GB
    Memory Allocated: 19.95375967025757  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03868266940116882 |0.04558591544628143 |0.7109816521406174 |0.00011302530765533447 |1.1850662976503372 |0.027089834213256836 |
----------------------------------------------------------pseudo_mini_loss sum 4.99445915222168
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5329736
Number of first layer input nodes during this epoch:  2520599
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.3592529296875 GB
    Memory Allocated: 0.13267183303833008  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029773473739624023
random selection method range initialization spend 0.006312847137451172
time for parepare:  0.01952219009399414
local_output_nid generation:  0.002752065658569336
local_in_edges_tensor generation:  0.005900859832763672
mini_batch_src_global generation:  0.002589702606201172
r_  generation:  0.02260279655456543
local_output_nid generation:  0.0032112598419189453
local_in_edges_tensor generation:  0.0017709732055664062
mini_batch_src_global generation:  0.0027751922607421875
r_  generation:  0.022929906845092773
local_output_nid generation:  0.0032243728637695312
local_in_edges_tensor generation:  0.0016851425170898438
mini_batch_src_global generation:  0.001951456069946289
r_  generation:  0.023622751235961914
local_output_nid generation:  0.0032958984375
local_in_edges_tensor generation:  0.001744985580444336
mini_batch_src_global generation:  0.0020101070404052734
r_  generation:  0.023281335830688477
local_output_nid generation:  0.0033605098724365234
local_in_edges_tensor generation:  0.0016548633575439453
mini_batch_src_global generation:  0.0020172595977783203
r_  generation:  0.02363443374633789
local_output_nid generation:  0.003248453140258789
local_in_edges_tensor generation:  0.0016837120056152344
mini_batch_src_global generation:  0.0020754337310791016
r_  generation:  0.02184271812438965
local_output_nid generation:  0.003265857696533203
local_in_edges_tensor generation:  0.0016360282897949219
mini_batch_src_global generation:  0.0017974376678466797
r_  generation:  0.021715164184570312
local_output_nid generation:  0.0032351016998291016
local_in_edges_tensor generation:  0.001619100570678711
mini_batch_src_global generation:  0.0017349720001220703
r_  generation:  0.022183895111083984
local_output_nid generation:  0.0033202171325683594
local_in_edges_tensor generation:  0.0016903877258300781
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.021691322326660156
local_output_nid generation:  0.0032439231872558594
local_in_edges_tensor generation:  0.0016431808471679688
mini_batch_src_global generation:  0.0017881393432617188
r_  generation:  0.022580385208129883
local_output_nid generation:  0.0032434463500976562
local_in_edges_tensor generation:  0.0016100406646728516
mini_batch_src_global generation:  0.0018715858459472656
r_  generation:  0.022815704345703125
local_output_nid generation:  0.003297090530395508
local_in_edges_tensor generation:  0.0015909671783447266
mini_batch_src_global generation:  0.0018341541290283203
r_  generation:  0.021855831146240234
local_output_nid generation:  0.0032269954681396484
local_in_edges_tensor generation:  0.0016312599182128906
mini_batch_src_global generation:  0.0017809867858886719
r_  generation:  0.022562265396118164
local_output_nid generation:  0.0032837390899658203
local_in_edges_tensor generation:  0.001630544662475586
mini_batch_src_global generation:  0.0018186569213867188
r_  generation:  0.022119522094726562
local_output_nid generation:  0.0032050609588623047
local_in_edges_tensor generation:  0.0015895366668701172
mini_batch_src_global generation:  0.00183868408203125
r_  generation:  0.022289752960205078
local_output_nid generation:  0.0032219886779785156
local_in_edges_tensor generation:  0.0016100406646728516
mini_batch_src_global generation:  0.0018970966339111328
r_  generation:  0.022405624389648438
----------------------check_connections_block total spend ----------------------------- 0.5897698402404785
generate_one_block  0.04344367980957031
generate_one_block  0.0384364128112793
generate_one_block  0.03902745246887207
generate_one_block  0.039519309997558594
generate_one_block  0.03913140296936035
generate_one_block  0.04098701477050781
generate_one_block  0.03903031349182129
generate_one_block  0.03782916069030762
generate_one_block  0.03774690628051758
generate_one_block  0.03937888145446777
generate_one_block  0.039633750915527344
generate_one_block  0.03743720054626465
generate_one_block  0.03829312324523926
generate_one_block  0.0380096435546875
generate_one_block  0.038323402404785156
generate_one_block  0.03973960876464844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043486833572387695
gen group dst list time:  0.020261764526367188
time for parepare:  0.0191037654876709
local_output_nid generation:  0.01029658317565918
local_in_edges_tensor generation:  0.026496410369873047
mini_batch_src_global generation:  0.027049541473388672
r_  generation:  0.2511765956878662
local_output_nid generation:  0.013945579528808594
local_in_edges_tensor generation:  0.023784875869750977
mini_batch_src_global generation:  0.03233957290649414
r_  generation:  0.26024746894836426
local_output_nid generation:  0.014412164688110352
local_in_edges_tensor generation:  0.0194091796875
mini_batch_src_global generation:  0.03135967254638672
r_  generation:  0.28049230575561523
local_output_nid generation:  0.014566898345947266
local_in_edges_tensor generation:  0.019034385681152344
mini_batch_src_global generation:  0.03212141990661621
r_  generation:  0.26750969886779785
local_output_nid generation:  0.014335870742797852
local_in_edges_tensor generation:  0.019344091415405273
mini_batch_src_global generation:  0.033828020095825195
r_  generation:  0.2773265838623047
local_output_nid generation:  0.013705730438232422
local_in_edges_tensor generation:  0.016399860382080078
mini_batch_src_global generation:  0.03371381759643555
r_  generation:  0.2700178623199463
local_output_nid generation:  0.013930559158325195
local_in_edges_tensor generation:  0.0165555477142334
mini_batch_src_global generation:  0.03425431251525879
r_  generation:  0.2720327377319336
local_output_nid generation:  0.013777494430541992
local_in_edges_tensor generation:  0.016867876052856445
mini_batch_src_global generation:  0.037020206451416016
r_  generation:  0.2718071937561035
local_output_nid generation:  0.013760566711425781
local_in_edges_tensor generation:  0.016286134719848633
mini_batch_src_global generation:  0.03756380081176758
r_  generation:  0.2666351795196533
local_output_nid generation:  0.014003515243530273
local_in_edges_tensor generation:  0.01680445671081543
mini_batch_src_global generation:  0.03819108009338379
r_  generation:  0.28079748153686523
local_output_nid generation:  0.013940095901489258
local_in_edges_tensor generation:  0.019368886947631836
mini_batch_src_global generation:  0.03630185127258301
r_  generation:  0.2803473472595215
local_output_nid generation:  0.013574361801147461
local_in_edges_tensor generation:  0.01668858528137207
mini_batch_src_global generation:  0.034326791763305664
r_  generation:  0.2694716453552246
local_output_nid generation:  0.013671398162841797
local_in_edges_tensor generation:  0.016906261444091797
mini_batch_src_global generation:  0.03654336929321289
r_  generation:  0.2706286907196045
local_output_nid generation:  0.013790369033813477
local_in_edges_tensor generation:  0.01684427261352539
mini_batch_src_global generation:  0.03456711769104004
r_  generation:  0.268587589263916
local_output_nid generation:  0.013709783554077148
local_in_edges_tensor generation:  0.01606464385986328
mini_batch_src_global generation:  0.0437929630279541
r_  generation:  0.26861572265625
local_output_nid generation:  0.013557195663452148
local_in_edges_tensor generation:  0.018841028213500977
mini_batch_src_global generation:  0.03656435012817383
r_  generation:  0.27286767959594727
----------------------check_connections_block total spend ----------------------------- 6.337447166442871
generate_one_block  0.3806784152984619
generate_one_block  0.37702488899230957
generate_one_block  0.3811831474304199
generate_one_block  0.3766136169433594
generate_one_block  0.38268399238586426
generate_one_block  0.36750197410583496
generate_one_block  0.39908599853515625
generate_one_block  0.3738234043121338
generate_one_block  0.3634319305419922
generate_one_block  0.3889775276184082
generate_one_block  0.385486364364624
generate_one_block  0.3684251308441162
generate_one_block  0.37167811393737793
generate_one_block  0.37209224700927734
generate_one_block  0.37009477615356445
generate_one_block  0.3842601776123047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04286932945251465
gen group dst list time:  0.06600546836853027
time for parepare:  0.018135547637939453
local_output_nid generation:  0.027904510498046875
local_in_edges_tensor generation:  0.04361724853515625
mini_batch_src_global generation:  0.05325198173522949
r_  generation:  0.5158891677856445
local_output_nid generation:  0.03305363655090332
local_in_edges_tensor generation:  0.0516660213470459
mini_batch_src_global generation:  0.061630964279174805
r_  generation:  0.5207161903381348
local_output_nid generation:  0.033184051513671875
local_in_edges_tensor generation:  0.03771066665649414
mini_batch_src_global generation:  0.05895543098449707
r_  generation:  0.5272955894470215
local_output_nid generation:  0.033288002014160156
local_in_edges_tensor generation:  0.03731346130371094
mini_batch_src_global generation:  0.0596165657043457
r_  generation:  0.5286130905151367
local_output_nid generation:  0.03315258026123047
local_in_edges_tensor generation:  0.09174537658691406
mini_batch_src_global generation:  0.05972027778625488
r_  generation:  0.5349400043487549
local_output_nid generation:  0.0328981876373291
local_in_edges_tensor generation:  0.0326685905456543
mini_batch_src_global generation:  0.06019306182861328
r_  generation:  0.5341260433197021
local_output_nid generation:  0.03328871726989746
local_in_edges_tensor generation:  0.05219101905822754
mini_batch_src_global generation:  0.060753822326660156
r_  generation:  0.5356791019439697
local_output_nid generation:  0.03326058387756348
local_in_edges_tensor generation:  0.04735088348388672
mini_batch_src_global generation:  0.06094861030578613
r_  generation:  0.5374834537506104
local_output_nid generation:  0.03331279754638672
local_in_edges_tensor generation:  0.038095712661743164
mini_batch_src_global generation:  0.06096959114074707
r_  generation:  0.5386161804199219
local_output_nid generation:  0.033658504486083984
local_in_edges_tensor generation:  0.037877559661865234
mini_batch_src_global generation:  0.06566619873046875
r_  generation:  0.5380733013153076
local_output_nid generation:  0.0335540771484375
local_in_edges_tensor generation:  0.03767967224121094
mini_batch_src_global generation:  0.06127667427062988
r_  generation:  0.5445687770843506
local_output_nid generation:  0.03341031074523926
local_in_edges_tensor generation:  0.032779693603515625
mini_batch_src_global generation:  0.0625302791595459
r_  generation:  0.5415451526641846
local_output_nid generation:  0.03360247611999512
local_in_edges_tensor generation:  0.0369875431060791
mini_batch_src_global generation:  0.061990976333618164
r_  generation:  0.5463018417358398
local_output_nid generation:  0.033622026443481445
local_in_edges_tensor generation:  0.03828930854797363
mini_batch_src_global generation:  0.06210017204284668
r_  generation:  0.5411677360534668
local_output_nid generation:  0.033301591873168945
local_in_edges_tensor generation:  0.0374295711517334
mini_batch_src_global generation:  0.06119203567504883
r_  generation:  0.5417897701263428
local_output_nid generation:  0.03323721885681152
local_in_edges_tensor generation:  0.03738594055175781
mini_batch_src_global generation:  0.061692237854003906
r_  generation:  0.5410194396972656
----------------------check_connections_block total spend ----------------------------- 12.635620832443237
generate_one_block  0.7080614566802979
generate_one_block  0.713435173034668
generate_one_block  0.7152969837188721
generate_one_block  0.710900068283081
generate_one_block  0.7126963138580322
generate_one_block  0.7091217041015625
generate_one_block  0.7093143463134766
generate_one_block  0.7201144695281982
generate_one_block  0.7524120807647705
generate_one_block  0.7191576957702637
generate_one_block  0.7244865894317627
generate_one_block  0.71315598487854
generate_one_block  0.6993300914764404
generate_one_block  0.7115073204040527
generate_one_block  0.7125368118286133
generate_one_block  0.7111773490905762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.3592529296875 GB
    Memory Allocated: 0.13267183303833008  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

connection checking time:  18.97306799888611
block generation total time  17.485746145248413
average batch blocks generation time:  1.0928591340780258
block dataloader generation time/epoch 39.41233587265015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3592529296875 GB
    Memory Allocated: 0.10274839401245117  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

torch.Size([157574, 128])
torch.Size([130475, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8553466796875 GB
    Memory Allocated: 19.91104507446289  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 0.10260581970214844  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

torch.Size([157456, 128])
torch.Size([129984, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 19.814576625823975  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 0.10269737243652344  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

torch.Size([157464, 128])
torch.Size([129875, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 19.901451587677002  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 0.1026163101196289  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

torch.Size([157498, 128])
torch.Size([129702, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 19.784482955932617  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 0.10285329818725586  GigaBytes
Max Memory Allocated: 19.988192081451416  GigaBytes

torch.Size([157579, 128])
torch.Size([130008, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8572998046875 GB
    Memory Allocated: 19.979151248931885  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 0.10259246826171875  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

torch.Size([157568, 128])
torch.Size([129645, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 19.765501499176025  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 0.10266256332397461  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

torch.Size([157509, 128])
torch.Size([130117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 19.84788227081299  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 0.1026468276977539  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

torch.Size([157578, 128])
torch.Size([130083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 19.796674251556396  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 0.10271072387695312  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

torch.Size([158078, 128])
torch.Size([130231, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 19.640703201293945  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 0.10402202606201172  GigaBytes
Max Memory Allocated: 20.013556480407715  GigaBytes

torch.Size([158013, 128])
torch.Size([130946, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6932373046875 GB
    Memory Allocated: 20.05085563659668  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 0.10297060012817383  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

torch.Size([157883, 128])
torch.Size([130440, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.97720956802368  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 0.10246944427490234  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

torch.Size([157310, 128])
torch.Size([129511, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.74238920211792  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 0.10270404815673828  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

torch.Size([157742, 128])
torch.Size([130194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.781760215759277  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 0.1025843620300293  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

torch.Size([157637, 128])
torch.Size([130023, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.729896068572998  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 0.10248517990112305  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

torch.Size([157461, 128])
torch.Size([129437, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.67638111114502  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 0.10266590118408203  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

torch.Size([157478, 128])
torch.Size([129643, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5330810546875 GB
    Memory Allocated: 19.869001388549805  GigaBytes
Max Memory Allocated: 20.085265159606934  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031491056084632874 |0.025077208876609802 |0.6318830698728561 |9.907782077789307e-05 |1.1449421644210815 |0.011171579360961914 |
----------------------------------------------------------pseudo_mini_loss sum 3.3131117820739746
Total (block generation + training)time/epoch 68.80678915977478
Training time/epoch 29.39397430419922
Training time without block to device /epoch 28.992738962173462
Training time without total dataloading part /epoch 28.44196057319641
load block tensor time/epoch 0.503856897354126
block to device time/epoch 0.40123534202575684
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5332856
Number of first layer input nodes during this epoch:  2521828
