Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648503170.7190576
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02501821517944336
random selection method range initialization spend 0.00633549690246582
time for parepare:  0.017980098724365234
local_output_nid generation:  0.0010819435119628906
local_in_edges_tensor generation:  0.004000663757324219
mini_batch_src_global generation:  0.0014171600341796875
r_  generation:  0.008603572845458984
local_output_nid generation:  0.0012204647064208984
local_in_edges_tensor generation:  0.001005411148071289
mini_batch_src_global generation:  0.0013785362243652344
r_  generation:  0.008039712905883789
local_output_nid generation:  0.0012722015380859375
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.0009253025054931641
r_  generation:  0.007704734802246094
local_output_nid generation:  0.0012896060943603516
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.0008616447448730469
r_  generation:  0.007579803466796875
local_output_nid generation:  0.0013115406036376953
local_in_edges_tensor generation:  0.0008101463317871094
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.0078277587890625
local_output_nid generation:  0.0013265609741210938
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.0008792877197265625
r_  generation:  0.007907867431640625
local_output_nid generation:  0.0013298988342285156
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.007966041564941406
local_output_nid generation:  0.0013387203216552734
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0008139610290527344
r_  generation:  0.007972955703735352
local_output_nid generation:  0.0013339519500732422
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0008764266967773438
r_  generation:  0.009136438369750977
local_output_nid generation:  0.0013642311096191406
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.007939815521240234
local_output_nid generation:  0.0013663768768310547
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.008095502853393555
local_output_nid generation:  0.0013642311096191406
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0008637905120849609
r_  generation:  0.008227348327636719
local_output_nid generation:  0.001378774642944336
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.008073806762695312
local_output_nid generation:  0.001367807388305664
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0008482933044433594
r_  generation:  0.007863044738769531
local_output_nid generation:  0.0013680458068847656
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0008282661437988281
r_  generation:  0.008080482482910156
local_output_nid generation:  0.0013494491577148438
local_in_edges_tensor generation:  0.0007376670837402344
mini_batch_src_global generation:  0.0008425712585449219
r_  generation:  0.00809335708618164
local_output_nid generation:  0.0013663768768310547
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0008559226989746094
r_  generation:  0.008309125900268555
local_output_nid generation:  0.0013506412506103516
local_in_edges_tensor generation:  0.0007395744323730469
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.00809621810913086
local_output_nid generation:  0.0013439655303955078
local_in_edges_tensor generation:  0.0007340908050537109
mini_batch_src_global generation:  0.0008220672607421875
r_  generation:  0.008098602294921875
local_output_nid generation:  0.0013425350189208984
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.0009558200836181641
r_  generation:  0.008178949356079102
local_output_nid generation:  0.001390218734741211
local_in_edges_tensor generation:  0.000766754150390625
mini_batch_src_global generation:  0.0008373260498046875
r_  generation:  0.008017301559448242
local_output_nid generation:  0.0013666152954101562
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.0008234977722167969
r_  generation:  0.008044958114624023
local_output_nid generation:  0.0013492107391357422
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.0008494853973388672
r_  generation:  0.008408069610595703
local_output_nid generation:  0.0013594627380371094
local_in_edges_tensor generation:  0.0007410049438476562
mini_batch_src_global generation:  0.0008249282836914062
r_  generation:  0.007978677749633789
local_output_nid generation:  0.0013685226440429688
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.0008161067962646484
r_  generation:  0.00803518295288086
local_output_nid generation:  0.001355886459350586
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0009329319000244141
r_  generation:  0.007903099060058594
local_output_nid generation:  0.0013594627380371094
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0009341239929199219
r_  generation:  0.008082866668701172
local_output_nid generation:  0.0013511180877685547
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0007982254028320312
r_  generation:  0.007754325866699219
local_output_nid generation:  0.0013599395751953125
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0008165836334228516
r_  generation:  0.008240222930908203
local_output_nid generation:  0.0013391971588134766
local_in_edges_tensor generation:  0.0007405281066894531
mini_batch_src_global generation:  0.0008373260498046875
r_  generation:  0.008202552795410156
local_output_nid generation:  0.0013587474822998047
local_in_edges_tensor generation:  0.005283832550048828
mini_batch_src_global generation:  0.001102447509765625
r_  generation:  0.008228540420532227
local_output_nid generation:  0.0012271404266357422
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0009720325469970703
r_  generation:  0.008251428604125977
----------------------check_connections_block total spend ----------------------------- 0.4615950584411621
generate_one_block  0.013941049575805664
generate_one_block  0.013622045516967773
generate_one_block  0.013321399688720703
generate_one_block  0.017317771911621094
generate_one_block  0.017169713973999023
generate_one_block  0.013214111328125
generate_one_block  0.013113975524902344
generate_one_block  0.013196706771850586
generate_one_block  0.013752460479736328
generate_one_block  0.013354778289794922
generate_one_block  0.013152837753295898
generate_one_block  0.01328420639038086
generate_one_block  0.012848854064941406
generate_one_block  0.012665271759033203
generate_one_block  0.012881278991699219
generate_one_block  0.013016462326049805
generate_one_block  0.013273954391479492
generate_one_block  0.01288747787475586
generate_one_block  0.012694358825683594
generate_one_block  0.013127803802490234
generate_one_block  0.01277470588684082
generate_one_block  0.01292109489440918
generate_one_block  0.013466835021972656
generate_one_block  0.012660503387451172
generate_one_block  0.012686729431152344
generate_one_block  0.012778759002685547
generate_one_block  0.012851476669311523
generate_one_block  0.012358427047729492
generate_one_block  0.012915611267089844
generate_one_block  0.013041496276855469
generate_one_block  0.01349186897277832
generate_one_block  0.013322830200195312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.044568538665771484
gen group dst list time:  0.022360563278198242
time for parepare:  0.018826961517333984
local_output_nid generation:  0.004626274108886719
local_in_edges_tensor generation:  0.013242721557617188
mini_batch_src_global generation:  0.012249231338500977
r_  generation:  0.11762762069702148
local_output_nid generation:  0.007601261138916016
local_in_edges_tensor generation:  0.008165359497070312
mini_batch_src_global generation:  0.015366554260253906
r_  generation:  0.12748169898986816
local_output_nid generation:  0.007294893264770508
local_in_edges_tensor generation:  0.008498668670654297
mini_batch_src_global generation:  0.015278100967407227
r_  generation:  0.13033080101013184
local_output_nid generation:  0.00716400146484375
local_in_edges_tensor generation:  0.009454727172851562
mini_batch_src_global generation:  0.014511823654174805
r_  generation:  0.13225340843200684
local_output_nid generation:  0.007166147232055664
local_in_edges_tensor generation:  0.009157419204711914
mini_batch_src_global generation:  0.016870975494384766
r_  generation:  0.13406848907470703
local_output_nid generation:  0.0072612762451171875
local_in_edges_tensor generation:  0.009865283966064453
mini_batch_src_global generation:  0.017314672470092773
r_  generation:  0.1385359764099121
local_output_nid generation:  0.007270336151123047
local_in_edges_tensor generation:  0.009813070297241211
mini_batch_src_global generation:  0.01647186279296875
r_  generation:  0.135664701461792
local_output_nid generation:  0.0072536468505859375
local_in_edges_tensor generation:  0.008639097213745117
mini_batch_src_global generation:  0.016469717025756836
r_  generation:  0.13628697395324707
local_output_nid generation:  0.007534027099609375
local_in_edges_tensor generation:  0.011994361877441406
mini_batch_src_global generation:  0.01722431182861328
r_  generation:  0.14232873916625977
local_output_nid generation:  0.007329463958740234
local_in_edges_tensor generation:  0.009500503540039062
mini_batch_src_global generation:  0.01693582534790039
r_  generation:  0.13859248161315918
local_output_nid generation:  0.007211446762084961
local_in_edges_tensor generation:  0.009586334228515625
mini_batch_src_global generation:  0.01643681526184082
r_  generation:  0.13697600364685059
local_output_nid generation:  0.0073871612548828125
local_in_edges_tensor generation:  0.009435653686523438
mini_batch_src_global generation:  0.02166152000427246
r_  generation:  0.1381678581237793
local_output_nid generation:  0.007111549377441406
local_in_edges_tensor generation:  0.008411169052124023
mini_batch_src_global generation:  0.02042984962463379
r_  generation:  0.13411593437194824
local_output_nid generation:  0.007113456726074219
local_in_edges_tensor generation:  0.009813785552978516
mini_batch_src_global generation:  0.015948772430419922
r_  generation:  0.13138461112976074
local_output_nid generation:  0.007252216339111328
local_in_edges_tensor generation:  0.010503292083740234
mini_batch_src_global generation:  0.01658773422241211
r_  generation:  0.13727855682373047
local_output_nid generation:  0.007292270660400391
local_in_edges_tensor generation:  0.010545730590820312
mini_batch_src_global generation:  0.017129898071289062
r_  generation:  0.13846969604492188
local_output_nid generation:  0.007275819778442383
local_in_edges_tensor generation:  0.009325504302978516
mini_batch_src_global generation:  0.016928911209106445
r_  generation:  0.1398639678955078
local_output_nid generation:  0.0072286128997802734
local_in_edges_tensor generation:  0.008240461349487305
mini_batch_src_global generation:  0.01711106300354004
r_  generation:  0.1374988555908203
local_output_nid generation:  0.007246255874633789
local_in_edges_tensor generation:  0.008017778396606445
mini_batch_src_global generation:  0.01947474479675293
r_  generation:  0.1369798183441162
local_output_nid generation:  0.007373809814453125
local_in_edges_tensor generation:  0.010438919067382812
mini_batch_src_global generation:  0.01714301109313965
r_  generation:  0.1405346393585205
local_output_nid generation:  0.007078886032104492
local_in_edges_tensor generation:  0.008211851119995117
mini_batch_src_global generation:  0.018693923950195312
r_  generation:  0.13683056831359863
local_output_nid generation:  0.008188247680664062
local_in_edges_tensor generation:  0.008984565734863281
mini_batch_src_global generation:  0.01825690269470215
r_  generation:  0.13724470138549805
local_output_nid generation:  0.007465362548828125
local_in_edges_tensor generation:  0.010643482208251953
mini_batch_src_global generation:  0.017356157302856445
r_  generation:  0.14332032203674316
local_output_nid generation:  0.0073010921478271484
local_in_edges_tensor generation:  0.017458677291870117
mini_batch_src_global generation:  0.017324209213256836
r_  generation:  0.14560723304748535
local_output_nid generation:  0.0071563720703125
local_in_edges_tensor generation:  0.02220892906188965
mini_batch_src_global generation:  0.02738785743713379
r_  generation:  0.137986421585083
local_output_nid generation:  0.008397102355957031
local_in_edges_tensor generation:  0.008144140243530273
mini_batch_src_global generation:  0.020721912384033203
r_  generation:  0.13686203956604004
local_output_nid generation:  0.007394552230834961
local_in_edges_tensor generation:  0.010680675506591797
mini_batch_src_global generation:  0.016538381576538086
r_  generation:  0.13786029815673828
local_output_nid generation:  0.007193565368652344
local_in_edges_tensor generation:  0.007987499237060547
mini_batch_src_global generation:  0.015639305114746094
r_  generation:  0.13180065155029297
local_output_nid generation:  0.0074083805084228516
local_in_edges_tensor generation:  0.009631872177124023
mini_batch_src_global generation:  0.016746997833251953
r_  generation:  0.1383039951324463
local_output_nid generation:  0.007487297058105469
local_in_edges_tensor generation:  0.009886980056762695
mini_batch_src_global generation:  0.017091751098632812
r_  generation:  0.14079976081848145
local_output_nid generation:  0.007502317428588867
local_in_edges_tensor generation:  0.008538007736206055
mini_batch_src_global generation:  0.017023801803588867
r_  generation:  0.14138436317443848
local_output_nid generation:  0.0075533390045166016
local_in_edges_tensor generation:  0.011063098907470703
mini_batch_src_global generation:  0.01727747917175293
r_  generation:  0.1424252986907959
----------------------check_connections_block total spend ----------------------------- 6.540917634963989
generate_one_block  0.17539262771606445
generate_one_block  0.17235708236694336
generate_one_block  0.20112013816833496
generate_one_block  0.17142271995544434
generate_one_block  0.18242120742797852
generate_one_block  0.18197154998779297
generate_one_block  0.1717836856842041
generate_one_block  0.17647409439086914
generate_one_block  0.18530511856079102
generate_one_block  0.17449569702148438
generate_one_block  0.1745004653930664
generate_one_block  0.1759181022644043
generate_one_block  0.1756267547607422
generate_one_block  0.16721606254577637
generate_one_block  0.17210173606872559
generate_one_block  0.17519521713256836
generate_one_block  0.1764078140258789
generate_one_block  0.1718893051147461
generate_one_block  0.16648530960083008
generate_one_block  0.18075776100158691
generate_one_block  0.16633248329162598
generate_one_block  0.17444348335266113
generate_one_block  0.18123507499694824
generate_one_block  0.1684284210205078
generate_one_block  0.1720583438873291
generate_one_block  0.17433619499206543
generate_one_block  0.17618989944458008
generate_one_block  0.16335797309875488
generate_one_block  0.1762866973876953
generate_one_block  0.18079233169555664
generate_one_block  0.181563138961792
generate_one_block  0.18032240867614746
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04587531089782715
gen group dst list time:  0.10993599891662598
time for parepare:  0.01895308494567871
local_output_nid generation:  0.02147507667541504
local_in_edges_tensor generation:  0.04386472702026367
mini_batch_src_global generation:  0.045821428298950195
r_  generation:  0.46483469009399414
local_output_nid generation:  0.02773261070251465
local_in_edges_tensor generation:  0.04423046112060547
mini_batch_src_global generation:  0.059034109115600586
r_  generation:  0.4452238082885742
local_output_nid generation:  0.02785944938659668
local_in_edges_tensor generation:  0.041898488998413086
mini_batch_src_global generation:  0.052278757095336914
r_  generation:  0.44615960121154785
local_output_nid generation:  0.026028156280517578
local_in_edges_tensor generation:  0.03726649284362793
mini_batch_src_global generation:  0.05324125289916992
r_  generation:  0.4407813549041748
local_output_nid generation:  0.026447296142578125
local_in_edges_tensor generation:  0.027956724166870117
mini_batch_src_global generation:  0.05644679069519043
r_  generation:  0.4484884738922119
local_output_nid generation:  0.026415348052978516
local_in_edges_tensor generation:  0.04453730583190918
mini_batch_src_global generation:  0.054050445556640625
r_  generation:  0.4477877616882324
local_output_nid generation:  0.026001930236816406
local_in_edges_tensor generation:  0.027348041534423828
mini_batch_src_global generation:  0.05417823791503906
r_  generation:  0.4490623474121094
local_output_nid generation:  0.02722001075744629
local_in_edges_tensor generation:  0.030349016189575195
mini_batch_src_global generation:  0.05602622032165527
r_  generation:  0.4470994472503662
local_output_nid generation:  0.02649068832397461
local_in_edges_tensor generation:  0.04097270965576172
mini_batch_src_global generation:  0.0539088249206543
r_  generation:  0.45650482177734375
local_output_nid generation:  0.02622222900390625
local_in_edges_tensor generation:  0.027676105499267578
mini_batch_src_global generation:  0.05400276184082031
r_  generation:  0.44977402687072754
local_output_nid generation:  0.026152610778808594
local_in_edges_tensor generation:  0.02749156951904297
mini_batch_src_global generation:  0.05363965034484863
r_  generation:  0.4506092071533203
local_output_nid generation:  0.026137113571166992
local_in_edges_tensor generation:  0.03169369697570801
mini_batch_src_global generation:  0.05437040328979492
r_  generation:  0.45613861083984375
local_output_nid generation:  0.030996084213256836
local_in_edges_tensor generation:  0.03400373458862305
mini_batch_src_global generation:  0.06664466857910156
r_  generation:  0.4513993263244629
local_output_nid generation:  0.02568960189819336
local_in_edges_tensor generation:  0.03139829635620117
mini_batch_src_global generation:  0.05379176139831543
r_  generation:  0.4448878765106201
local_output_nid generation:  0.025934219360351562
local_in_edges_tensor generation:  0.03600144386291504
mini_batch_src_global generation:  0.05679059028625488
r_  generation:  0.4545857906341553
local_output_nid generation:  0.026465654373168945
local_in_edges_tensor generation:  0.031734466552734375
mini_batch_src_global generation:  0.05429363250732422
r_  generation:  0.4474356174468994
local_output_nid generation:  0.026353836059570312
local_in_edges_tensor generation:  0.036345481872558594
mini_batch_src_global generation:  0.05705404281616211
r_  generation:  0.4521825313568115
local_output_nid generation:  0.028345108032226562
local_in_edges_tensor generation:  0.041338205337524414
mini_batch_src_global generation:  0.05719804763793945
r_  generation:  0.45302295684814453
local_output_nid generation:  0.027933597564697266
local_in_edges_tensor generation:  0.0362851619720459
mini_batch_src_global generation:  0.05363106727600098
r_  generation:  0.45243263244628906
local_output_nid generation:  0.02685070037841797
local_in_edges_tensor generation:  0.031716108322143555
mini_batch_src_global generation:  0.054154396057128906
r_  generation:  0.44965410232543945
local_output_nid generation:  0.026643991470336914
local_in_edges_tensor generation:  0.027338266372680664
mini_batch_src_global generation:  0.053752899169921875
r_  generation:  0.44992733001708984
local_output_nid generation:  0.026819467544555664
local_in_edges_tensor generation:  0.03615713119506836
mini_batch_src_global generation:  0.05374550819396973
r_  generation:  0.4463036060333252
local_output_nid generation:  0.026734590530395508
local_in_edges_tensor generation:  0.04152846336364746
mini_batch_src_global generation:  0.05413985252380371
r_  generation:  0.45427846908569336
local_output_nid generation:  0.02675914764404297
local_in_edges_tensor generation:  0.03607821464538574
mini_batch_src_global generation:  0.05374264717102051
r_  generation:  0.4490854740142822
local_output_nid generation:  0.0267183780670166
local_in_edges_tensor generation:  0.02790665626525879
mini_batch_src_global generation:  0.05339407920837402
r_  generation:  0.4512660503387451
local_output_nid generation:  0.02667832374572754
local_in_edges_tensor generation:  0.027137041091918945
mini_batch_src_global generation:  0.05400705337524414
r_  generation:  0.45117807388305664
local_output_nid generation:  0.026474714279174805
local_in_edges_tensor generation:  0.03603529930114746
mini_batch_src_global generation:  0.057951927185058594
r_  generation:  0.455751895904541
local_output_nid generation:  0.026778697967529297
local_in_edges_tensor generation:  0.04070925712585449
mini_batch_src_global generation:  0.05379223823547363
r_  generation:  0.4468045234680176
local_output_nid generation:  0.026548147201538086
local_in_edges_tensor generation:  0.025539875030517578
mini_batch_src_global generation:  0.053251028060913086
r_  generation:  0.4522395133972168
local_output_nid generation:  0.026816368103027344
local_in_edges_tensor generation:  0.034096479415893555
mini_batch_src_global generation:  0.05650138854980469
r_  generation:  0.4576125144958496
local_output_nid generation:  0.02670764923095703
local_in_edges_tensor generation:  0.03777933120727539
mini_batch_src_global generation:  0.05365324020385742
r_  generation:  0.455214262008667
local_output_nid generation:  0.027906417846679688
local_in_edges_tensor generation:  0.03519916534423828
mini_batch_src_global generation:  0.07219123840332031
r_  generation:  0.4596126079559326
----------------------check_connections_block total spend ----------------------------- 21.269184112548828
generate_one_block  0.5964710712432861
generate_one_block  0.6926355361938477
generate_one_block  0.5924468040466309
generate_one_block  0.5696399211883545
generate_one_block  0.5836308002471924
generate_one_block  0.5933480262756348
generate_one_block  0.573998212814331
generate_one_block  0.5900804996490479
generate_one_block  0.6036996841430664
generate_one_block  0.584801197052002
generate_one_block  0.57193922996521
generate_one_block  0.5878200531005859
generate_one_block  0.5727372169494629
generate_one_block  0.5718884468078613
generate_one_block  0.5918240547180176
generate_one_block  0.584214448928833
generate_one_block  0.5903313159942627
generate_one_block  0.5961201190948486
generate_one_block  0.5930421352386475
generate_one_block  0.5863606929779053
generate_one_block  0.5725822448730469
generate_one_block  0.5871117115020752
generate_one_block  0.5999031066894531
generate_one_block  0.5732686519622803
generate_one_block  0.5748357772827148
generate_one_block  0.568572998046875
generate_one_block  0.5847585201263428
generate_one_block  0.5779232978820801
generate_one_block  0.5894362926483154
generate_one_block  0.6016035079956055
generate_one_block  0.5891830921173096
generate_one_block  0.5965135097503662
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04477357864379883
gen group dst list time:  0.17400622367858887
time for parepare:  0.020473480224609375
local_output_nid generation:  0.03304624557495117
local_in_edges_tensor generation:  0.07528162002563477
mini_batch_src_global generation:  0.05068778991699219
r_  generation:  0.5122714042663574
local_output_nid generation:  0.03933119773864746
local_in_edges_tensor generation:  0.05512571334838867
mini_batch_src_global generation:  0.062172651290893555
r_  generation:  0.5212900638580322
local_output_nid generation:  0.03730893135070801
local_in_edges_tensor generation:  0.04617714881896973
mini_batch_src_global generation:  0.05762624740600586
r_  generation:  0.526512861251831
local_output_nid generation:  0.03672385215759277
local_in_edges_tensor generation:  0.04089999198913574
mini_batch_src_global generation:  0.058556556701660156
r_  generation:  0.5408535003662109
local_output_nid generation:  0.03877568244934082
local_in_edges_tensor generation:  0.040302276611328125
mini_batch_src_global generation:  0.0692288875579834
r_  generation:  0.5356583595275879
local_output_nid generation:  0.03671097755432129
local_in_edges_tensor generation:  0.04096078872680664
mini_batch_src_global generation:  0.060067176818847656
r_  generation:  0.5334017276763916
local_output_nid generation:  0.03736686706542969
local_in_edges_tensor generation:  0.04073643684387207
mini_batch_src_global generation:  0.06041359901428223
r_  generation:  0.5422542095184326
local_output_nid generation:  0.037502288818359375
local_in_edges_tensor generation:  0.040247440338134766
mini_batch_src_global generation:  0.0614628791809082
r_  generation:  0.5353317260742188
local_output_nid generation:  0.03782391548156738
local_in_edges_tensor generation:  0.03698396682739258
mini_batch_src_global generation:  0.06110739707946777
r_  generation:  0.5412888526916504
local_output_nid generation:  0.037334442138671875
local_in_edges_tensor generation:  0.036576271057128906
mini_batch_src_global generation:  0.06125354766845703
r_  generation:  0.53810715675354
local_output_nid generation:  0.03742074966430664
local_in_edges_tensor generation:  0.04062676429748535
mini_batch_src_global generation:  0.06533980369567871
r_  generation:  0.5439302921295166
local_output_nid generation:  0.0375218391418457
local_in_edges_tensor generation:  0.04611063003540039
mini_batch_src_global generation:  0.06159043312072754
r_  generation:  0.5470755100250244
local_output_nid generation:  0.037635087966918945
local_in_edges_tensor generation:  0.045755863189697266
mini_batch_src_global generation:  0.06071138381958008
r_  generation:  0.547593355178833
local_output_nid generation:  0.03756117820739746
local_in_edges_tensor generation:  0.0365140438079834
mini_batch_src_global generation:  0.0626230239868164
r_  generation:  0.5463521480560303
local_output_nid generation:  0.03749513626098633
local_in_edges_tensor generation:  0.05032038688659668
mini_batch_src_global generation:  0.06148409843444824
r_  generation:  0.5461773872375488
local_output_nid generation:  0.03748607635498047
local_in_edges_tensor generation:  0.036858558654785156
mini_batch_src_global generation:  0.05948328971862793
r_  generation:  0.5379626750946045
local_output_nid generation:  0.03740549087524414
local_in_edges_tensor generation:  0.036334991455078125
mini_batch_src_global generation:  0.05957937240600586
r_  generation:  0.5447714328765869
local_output_nid generation:  0.03734731674194336
local_in_edges_tensor generation:  0.045760393142700195
mini_batch_src_global generation:  0.059638023376464844
r_  generation:  0.5365502834320068
local_output_nid generation:  0.03748321533203125
local_in_edges_tensor generation:  0.040688514709472656
mini_batch_src_global generation:  0.05963420867919922
r_  generation:  0.5429091453552246
local_output_nid generation:  0.037546634674072266
local_in_edges_tensor generation:  0.04558086395263672
mini_batch_src_global generation:  0.05995655059814453
r_  generation:  0.5483574867248535
local_output_nid generation:  0.037682294845581055
local_in_edges_tensor generation:  0.036840200424194336
mini_batch_src_global generation:  0.05978870391845703
r_  generation:  0.5425624847412109
local_output_nid generation:  0.03755950927734375
local_in_edges_tensor generation:  0.036809682846069336
mini_batch_src_global generation:  0.059815406799316406
r_  generation:  0.5435576438903809
local_output_nid generation:  0.03749966621398926
local_in_edges_tensor generation:  0.040616512298583984
mini_batch_src_global generation:  0.05978250503540039
r_  generation:  0.5445315837860107
local_output_nid generation:  0.03777813911437988
local_in_edges_tensor generation:  0.03710126876831055
mini_batch_src_global generation:  0.06071758270263672
r_  generation:  0.5432713031768799
local_output_nid generation:  0.0376591682434082
local_in_edges_tensor generation:  0.0408024787902832
mini_batch_src_global generation:  0.059894561767578125
r_  generation:  0.5436050891876221
local_output_nid generation:  0.03748321533203125
local_in_edges_tensor generation:  0.036525726318359375
mini_batch_src_global generation:  0.061052560806274414
r_  generation:  0.5447297096252441
local_output_nid generation:  0.03778338432312012
local_in_edges_tensor generation:  0.036454200744628906
mini_batch_src_global generation:  0.06005501747131348
r_  generation:  0.5469748973846436
local_output_nid generation:  0.0376131534576416
local_in_edges_tensor generation:  0.05040764808654785
mini_batch_src_global generation:  0.060278892517089844
r_  generation:  0.5392019748687744
local_output_nid generation:  0.03781008720397949
local_in_edges_tensor generation:  0.0361027717590332
mini_batch_src_global generation:  0.05993986129760742
r_  generation:  0.5438435077667236
local_output_nid generation:  0.03772473335266113
local_in_edges_tensor generation:  0.03662872314453125
mini_batch_src_global generation:  0.06068134307861328
r_  generation:  0.5421125888824463
local_output_nid generation:  0.0377049446105957
local_in_edges_tensor generation:  0.0503697395324707
mini_batch_src_global generation:  0.060004472732543945
r_  generation:  0.5446395874023438
local_output_nid generation:  0.037644386291503906
local_in_edges_tensor generation:  0.046776771545410156
mini_batch_src_global generation:  0.06470584869384766
r_  generation:  0.5440068244934082
----------------------check_connections_block total spend ----------------------------- 25.807786464691162
generate_one_block  0.6666386127471924
generate_one_block  0.6603436470031738
generate_one_block  0.6744475364685059
generate_one_block  0.6696112155914307
generate_one_block  0.6801395416259766
generate_one_block  0.6808936595916748
generate_one_block  0.6667778491973877
generate_one_block  0.7848742008209229
generate_one_block  0.6704354286193848
generate_one_block  0.6753442287445068
generate_one_block  0.6727540493011475
generate_one_block  0.6760613918304443
generate_one_block  0.6723072528839111
generate_one_block  0.6831018924713135
generate_one_block  0.6728537082672119
generate_one_block  0.6620619297027588
generate_one_block  0.6786401271820068
generate_one_block  0.6757636070251465
generate_one_block  0.6694297790527344
generate_one_block  0.681269645690918
generate_one_block  0.6757199764251709
generate_one_block  0.6624777317047119
generate_one_block  0.680732250213623
generate_one_block  0.6762368679046631
generate_one_block  0.661853551864624
generate_one_block  0.6562614440917969
generate_one_block  0.6572616100311279
generate_one_block  0.6890230178833008
generate_one_block  0.6641504764556885
generate_one_block  0.6932485103607178
generate_one_block  0.6647946834564209
generate_one_block  0.6690192222595215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0402677059173584
gen group dst list time:  0.20996499061584473
time for parepare:  0.019054174423217773
local_output_nid generation:  0.0357661247253418
local_in_edges_tensor generation:  0.04710078239440918
mini_batch_src_global generation:  0.04447031021118164
r_  generation:  0.49610066413879395
local_output_nid generation:  0.04263567924499512
local_in_edges_tensor generation:  0.03876948356628418
mini_batch_src_global generation:  0.05689716339111328
r_  generation:  0.4973104000091553
local_output_nid generation:  0.042436838150024414
local_in_edges_tensor generation:  0.03514504432678223
mini_batch_src_global generation:  0.0570375919342041
r_  generation:  0.5039682388305664
local_output_nid generation:  0.04119062423706055
local_in_edges_tensor generation:  0.03474760055541992
mini_batch_src_global generation:  0.05603599548339844
r_  generation:  0.4997367858886719
local_output_nid generation:  0.039713382720947266
local_in_edges_tensor generation:  0.04395294189453125
mini_batch_src_global generation:  0.057203054428100586
r_  generation:  0.5037186145782471
local_output_nid generation:  0.03951382637023926
local_in_edges_tensor generation:  0.0434117317199707
mini_batch_src_global generation:  0.05603528022766113
r_  generation:  0.5059511661529541
local_output_nid generation:  0.042582035064697266
local_in_edges_tensor generation:  0.039467811584472656
mini_batch_src_global generation:  0.056591033935546875
r_  generation:  0.5068178176879883
local_output_nid generation:  0.039328813552856445
local_in_edges_tensor generation:  0.03847479820251465
mini_batch_src_global generation:  0.056903839111328125
r_  generation:  0.5065374374389648
local_output_nid generation:  0.03965353965759277
local_in_edges_tensor generation:  0.04284334182739258
mini_batch_src_global generation:  0.05658912658691406
r_  generation:  0.5068647861480713
local_output_nid generation:  0.040376901626586914
local_in_edges_tensor generation:  0.039093732833862305
mini_batch_src_global generation:  0.05652976036071777
r_  generation:  0.5068907737731934
local_output_nid generation:  0.03949785232543945
local_in_edges_tensor generation:  0.04290294647216797
mini_batch_src_global generation:  0.06000566482543945
r_  generation:  0.5074448585510254
local_output_nid generation:  0.03965878486633301
local_in_edges_tensor generation:  0.03827071189880371
mini_batch_src_global generation:  0.05625724792480469
r_  generation:  0.5125536918640137
local_output_nid generation:  0.03961610794067383
local_in_edges_tensor generation:  0.03890275955200195
mini_batch_src_global generation:  0.06049513816833496
r_  generation:  0.5111567974090576
local_output_nid generation:  0.039882659912109375
local_in_edges_tensor generation:  0.03874540328979492
mini_batch_src_global generation:  0.0556330680847168
r_  generation:  0.5134875774383545
local_output_nid generation:  0.03993868827819824
local_in_edges_tensor generation:  0.03900933265686035
mini_batch_src_global generation:  0.06229138374328613
r_  generation:  0.51595139503479
local_output_nid generation:  0.03978252410888672
local_in_edges_tensor generation:  0.0348355770111084
mini_batch_src_global generation:  0.05662131309509277
r_  generation:  0.5188958644866943
local_output_nid generation:  0.03957319259643555
local_in_edges_tensor generation:  0.03790879249572754
mini_batch_src_global generation:  0.05616283416748047
r_  generation:  0.5196847915649414
local_output_nid generation:  0.0398561954498291
local_in_edges_tensor generation:  0.043184757232666016
mini_batch_src_global generation:  0.05665278434753418
r_  generation:  0.5178444385528564
local_output_nid generation:  0.039877891540527344
local_in_edges_tensor generation:  0.03881716728210449
mini_batch_src_global generation:  0.05716657638549805
r_  generation:  0.513239860534668
local_output_nid generation:  0.04008936882019043
local_in_edges_tensor generation:  0.0383915901184082
mini_batch_src_global generation:  0.059989213943481445
r_  generation:  0.5191054344177246
local_output_nid generation:  0.03976750373840332
local_in_edges_tensor generation:  0.039426326751708984
mini_batch_src_global generation:  0.056684017181396484
r_  generation:  0.513782262802124
local_output_nid generation:  0.03959345817565918
local_in_edges_tensor generation:  0.043004751205444336
mini_batch_src_global generation:  0.05695223808288574
r_  generation:  0.5152101516723633
local_output_nid generation:  0.039373159408569336
local_in_edges_tensor generation:  0.03903770446777344
mini_batch_src_global generation:  0.058142662048339844
r_  generation:  0.5186433792114258
local_output_nid generation:  0.03991436958312988
local_in_edges_tensor generation:  0.03872251510620117
mini_batch_src_global generation:  0.060610294342041016
r_  generation:  0.5184547901153564
local_output_nid generation:  0.04047751426696777
local_in_edges_tensor generation:  0.035449981689453125
mini_batch_src_global generation:  0.05614781379699707
r_  generation:  0.5194895267486572
local_output_nid generation:  0.03971385955810547
local_in_edges_tensor generation:  0.039943695068359375
mini_batch_src_global generation:  0.056416988372802734
r_  generation:  0.5173740386962891
local_output_nid generation:  0.03987550735473633
local_in_edges_tensor generation:  0.04749345779418945
mini_batch_src_global generation:  0.05725908279418945
r_  generation:  0.5218408107757568
local_output_nid generation:  0.03981733322143555
local_in_edges_tensor generation:  0.04795122146606445
mini_batch_src_global generation:  0.05645632743835449
r_  generation:  0.5280225276947021
local_output_nid generation:  0.03976774215698242
local_in_edges_tensor generation:  0.034905195236206055
mini_batch_src_global generation:  0.056697845458984375
r_  generation:  0.5258522033691406
local_output_nid generation:  0.04038214683532715
local_in_edges_tensor generation:  0.052381277084350586
mini_batch_src_global generation:  0.056612491607666016
r_  generation:  0.5221960544586182
local_output_nid generation:  0.0400848388671875
local_in_edges_tensor generation:  0.04525423049926758
mini_batch_src_global generation:  0.0596165657043457
r_  generation:  0.5296204090118408
local_output_nid generation:  0.03999638557434082
local_in_edges_tensor generation:  0.047258853912353516
mini_batch_src_global generation:  0.05618000030517578
r_  generation:  0.5220086574554443
----------------------check_connections_block total spend ----------------------------- 24.781609773635864
generate_one_block  0.624727725982666
generate_one_block  0.6244194507598877
generate_one_block  0.6341338157653809
generate_one_block  0.6217091083526611
generate_one_block  0.6445908546447754
generate_one_block  0.6405704021453857
generate_one_block  0.6239132881164551
generate_one_block  0.6284403800964355
generate_one_block  0.6356275081634521
generate_one_block  0.6265788078308105
generate_one_block  0.6572797298431396
generate_one_block  0.6282608509063721
generate_one_block  0.705543041229248
generate_one_block  0.8381383419036865
generate_one_block  0.6484813690185547
generate_one_block  0.6424438953399658
generate_one_block  0.6393048763275146
generate_one_block  0.6703112125396729
generate_one_block  0.641155481338501
generate_one_block  0.6626737117767334
generate_one_block  0.6347026824951172
generate_one_block  0.643815279006958
generate_one_block  0.6542143821716309
generate_one_block  0.6662294864654541
generate_one_block  0.6473305225372314
generate_one_block  0.642695426940918
generate_one_block  0.6359565258026123
generate_one_block  0.6560118198394775
generate_one_block  0.644848108291626
generate_one_block  0.6362457275390625
generate_one_block  0.6553950309753418
generate_one_block  0.6507174968719482
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

connection checking time:  78.39949798583984
block generation total time  66.89790606498718
average batch blocks generation time:  2.0905595645308495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.12005472183227539  GigaBytes
Max Memory Allocated: 0.12005472183227539  GigaBytes

torch.Size([165273, 128])
torch.Size([161301, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.38 GiB already allocated; 6.44 MiB free; 22.42 GiB reserved in total by PyTorch)
