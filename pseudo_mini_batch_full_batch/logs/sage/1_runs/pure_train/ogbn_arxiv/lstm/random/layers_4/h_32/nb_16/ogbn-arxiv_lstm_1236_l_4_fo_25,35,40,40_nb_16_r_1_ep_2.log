Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648484914.7974849
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023821592330932617
random selection method range initialization spend 0.006651878356933594
time for parepare:  0.018685102462768555
local_output_nid generation:  0.0021660327911376953
local_in_edges_tensor generation:  0.0037217140197753906
mini_batch_src_global generation:  0.0017447471618652344
r_  generation:  0.018627643585205078
local_output_nid generation:  0.002894163131713867
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.0021507740020751953
r_  generation:  0.01826167106628418
local_output_nid generation:  0.0029599666595458984
local_in_edges_tensor generation:  0.0015091896057128906
mini_batch_src_global generation:  0.001375436782836914
r_  generation:  0.017834901809692383
local_output_nid generation:  0.002918243408203125
local_in_edges_tensor generation:  0.0014803409576416016
mini_batch_src_global generation:  0.0013763904571533203
r_  generation:  0.018444299697875977
local_output_nid generation:  0.002893686294555664
local_in_edges_tensor generation:  0.0014884471893310547
mini_batch_src_global generation:  0.0013451576232910156
r_  generation:  0.018047809600830078
local_output_nid generation:  0.0029010772705078125
local_in_edges_tensor generation:  0.0014700889587402344
mini_batch_src_global generation:  0.0014338493347167969
r_  generation:  0.01894211769104004
local_output_nid generation:  0.0029294490814208984
local_in_edges_tensor generation:  0.0014851093292236328
mini_batch_src_global generation:  0.0014255046844482422
r_  generation:  0.01923513412475586
local_output_nid generation:  0.002918720245361328
local_in_edges_tensor generation:  0.0015130043029785156
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.019236087799072266
local_output_nid generation:  0.002912282943725586
local_in_edges_tensor generation:  0.0015020370483398438
mini_batch_src_global generation:  0.0014433860778808594
r_  generation:  0.019042015075683594
local_output_nid generation:  0.002977132797241211
local_in_edges_tensor generation:  0.0014317035675048828
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.01876997947692871
local_output_nid generation:  0.0029108524322509766
local_in_edges_tensor generation:  0.0014700889587402344
mini_batch_src_global generation:  0.0014700889587402344
r_  generation:  0.01931452751159668
local_output_nid generation:  0.002909421920776367
local_in_edges_tensor generation:  0.0014603137969970703
mini_batch_src_global generation:  0.0015401840209960938
r_  generation:  0.019815444946289062
local_output_nid generation:  0.002887248992919922
local_in_edges_tensor generation:  0.001440286636352539
mini_batch_src_global generation:  0.0014963150024414062
r_  generation:  0.019013404846191406
local_output_nid generation:  0.002887248992919922
local_in_edges_tensor generation:  0.0014925003051757812
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.01956486701965332
local_output_nid generation:  0.0029010772705078125
local_in_edges_tensor generation:  0.0014429092407226562
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.019413232803344727
local_output_nid generation:  0.0029129981994628906
local_in_edges_tensor generation:  0.0014119148254394531
mini_batch_src_global generation:  0.0015676021575927734
r_  generation:  0.01964712142944336
----------------------check_connections_block total spend ----------------------------- 0.49680376052856445
generate_one_block  0.02678680419921875
generate_one_block  0.028466224670410156
generate_one_block  0.027294397354125977
generate_one_block  0.03066730499267578
generate_one_block  0.027559757232666016
generate_one_block  0.028141021728515625
generate_one_block  0.027804136276245117
generate_one_block  0.028008699417114258
generate_one_block  0.027466535568237305
generate_one_block  0.026985645294189453
generate_one_block  0.02788090705871582
generate_one_block  0.02859044075012207
generate_one_block  0.02735114097595215
generate_one_block  0.028171539306640625
generate_one_block  0.027750253677368164
generate_one_block  0.027597904205322266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.038848161697387695
gen group dst list time:  0.018890857696533203
time for parepare:  0.018698453903198242
local_output_nid generation:  0.008161544799804688
local_in_edges_tensor generation:  0.01760554313659668
mini_batch_src_global generation:  0.021209239959716797
r_  generation:  0.19858384132385254
local_output_nid generation:  0.011973857879638672
local_in_edges_tensor generation:  0.019725561141967773
mini_batch_src_global generation:  0.02497577667236328
r_  generation:  0.20462656021118164
local_output_nid generation:  0.0115814208984375
local_in_edges_tensor generation:  0.013914823532104492
mini_batch_src_global generation:  0.024128437042236328
r_  generation:  0.20467853546142578
local_output_nid generation:  0.011852025985717773
local_in_edges_tensor generation:  0.017827272415161133
mini_batch_src_global generation:  0.025099754333496094
r_  generation:  0.21000981330871582
local_output_nid generation:  0.011736392974853516
local_in_edges_tensor generation:  0.012258768081665039
mini_batch_src_global generation:  0.025973796844482422
r_  generation:  0.20925545692443848
local_output_nid generation:  0.0118255615234375
local_in_edges_tensor generation:  0.01577448844909668
mini_batch_src_global generation:  0.02821636199951172
r_  generation:  0.2174088954925537
local_output_nid generation:  0.011856794357299805
local_in_edges_tensor generation:  0.014162778854370117
mini_batch_src_global generation:  0.026915311813354492
r_  generation:  0.21535110473632812
local_output_nid generation:  0.011801481246948242
local_in_edges_tensor generation:  0.014286041259765625
mini_batch_src_global generation:  0.028406381607055664
r_  generation:  0.21584606170654297
local_output_nid generation:  0.011665821075439453
local_in_edges_tensor generation:  0.012296676635742188
mini_batch_src_global generation:  0.02694082260131836
r_  generation:  0.21408987045288086
local_output_nid generation:  0.01152801513671875
local_in_edges_tensor generation:  0.013563394546508789
mini_batch_src_global generation:  0.026779890060424805
r_  generation:  0.21134734153747559
local_output_nid generation:  0.01175546646118164
local_in_edges_tensor generation:  0.01751399040222168
mini_batch_src_global generation:  0.027243614196777344
r_  generation:  0.21629810333251953
local_output_nid generation:  0.012044668197631836
local_in_edges_tensor generation:  0.018182039260864258
mini_batch_src_global generation:  0.029011011123657227
r_  generation:  0.2262406349182129
local_output_nid generation:  0.01164102554321289
local_in_edges_tensor generation:  0.012175559997558594
mini_batch_src_global generation:  0.027114152908325195
r_  generation:  0.2190556526184082
local_output_nid generation:  0.011927366256713867
local_in_edges_tensor generation:  0.012238502502441406
mini_batch_src_global generation:  0.027572154998779297
r_  generation:  0.21832990646362305
local_output_nid generation:  0.011771440505981445
local_in_edges_tensor generation:  0.01358938217163086
mini_batch_src_global generation:  0.02714228630065918
r_  generation:  0.21592020988464355
local_output_nid generation:  0.011805295944213867
local_in_edges_tensor generation:  0.01813650131225586
mini_batch_src_global generation:  0.027530908584594727
r_  generation:  0.2191312313079834
----------------------check_connections_block total spend ----------------------------- 5.0326502323150635
generate_one_block  0.2775230407714844
generate_one_block  0.2766907215118408
generate_one_block  0.27245473861694336
generate_one_block  0.2813425064086914
generate_one_block  0.2890181541442871
generate_one_block  0.2851722240447998
generate_one_block  0.27396702766418457
generate_one_block  0.2799525260925293
generate_one_block  0.2760751247406006
generate_one_block  0.26871562004089355
generate_one_block  0.2799084186553955
generate_one_block  0.2882659435272217
generate_one_block  0.27068495750427246
generate_one_block  0.2840135097503662
generate_one_block  0.28429484367370605
generate_one_block  0.28737378120422363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0387110710144043
gen group dst list time:  0.05966925621032715
time for parepare:  0.01916956901550293
local_output_nid generation:  0.025065898895263672
local_in_edges_tensor generation:  0.03862714767456055
mini_batch_src_global generation:  0.0481867790222168
r_  generation:  0.47054266929626465
local_output_nid generation:  0.03309273719787598
local_in_edges_tensor generation:  0.048866987228393555
mini_batch_src_global generation:  0.05886411666870117
r_  generation:  0.4779338836669922
local_output_nid generation:  0.032546043395996094
local_in_edges_tensor generation:  0.031992197036743164
mini_batch_src_global generation:  0.05445098876953125
r_  generation:  0.48691534996032715
local_output_nid generation:  0.03266596794128418
local_in_edges_tensor generation:  0.03602194786071777
mini_batch_src_global generation:  0.059621334075927734
r_  generation:  0.48347902297973633
local_output_nid generation:  0.032567501068115234
local_in_edges_tensor generation:  0.04111051559448242
mini_batch_src_global generation:  0.05602407455444336
r_  generation:  0.4881453514099121
local_output_nid generation:  0.03279685974121094
local_in_edges_tensor generation:  0.03570199012756348
mini_batch_src_global generation:  0.060640811920166016
r_  generation:  0.48928046226501465
local_output_nid generation:  0.03282308578491211
local_in_edges_tensor generation:  0.03206300735473633
mini_batch_src_global generation:  0.05599856376647949
r_  generation:  0.4913620948791504
local_output_nid generation:  0.03342461585998535
local_in_edges_tensor generation:  0.030874013900756836
mini_batch_src_global generation:  0.058252811431884766
r_  generation:  0.48418474197387695
local_output_nid generation:  0.03320741653442383
local_in_edges_tensor generation:  0.03567171096801758
mini_batch_src_global generation:  0.05612611770629883
r_  generation:  0.49257779121398926
local_output_nid generation:  0.03260517120361328
local_in_edges_tensor generation:  0.03544497489929199
mini_batch_src_global generation:  0.05694246292114258
r_  generation:  0.4844036102294922
local_output_nid generation:  0.032877206802368164
local_in_edges_tensor generation:  0.0395503044128418
mini_batch_src_global generation:  0.05591535568237305
r_  generation:  0.4887423515319824
local_output_nid generation:  0.03291511535644531
local_in_edges_tensor generation:  0.04396247863769531
mini_batch_src_global generation:  0.061806678771972656
r_  generation:  0.49086570739746094
local_output_nid generation:  0.03273725509643555
local_in_edges_tensor generation:  0.03084254264831543
mini_batch_src_global generation:  0.05708479881286621
r_  generation:  0.49373817443847656
local_output_nid generation:  0.03286266326904297
local_in_edges_tensor generation:  0.035849571228027344
mini_batch_src_global generation:  0.05851578712463379
r_  generation:  0.49040722846984863
local_output_nid generation:  0.03182077407836914
local_in_edges_tensor generation:  0.05033445358276367
mini_batch_src_global generation:  0.05637621879577637
r_  generation:  0.49208831787109375
local_output_nid generation:  0.031237363815307617
local_in_edges_tensor generation:  0.034387826919555664
mini_batch_src_global generation:  0.061632633209228516
r_  generation:  0.48626089096069336
----------------------check_connections_block total spend ----------------------------- 11.498956680297852
generate_one_block  0.6246860027313232
generate_one_block  0.6292603015899658
generate_one_block  0.6185176372528076
generate_one_block  0.6907336711883545
generate_one_block  0.6283833980560303
generate_one_block  0.6460766792297363
generate_one_block  0.6961188316345215
generate_one_block  0.6417865753173828
generate_one_block  0.6470925807952881
generate_one_block  0.6399083137512207
generate_one_block  0.6565852165222168
generate_one_block  0.6402056217193604
generate_one_block  0.6355397701263428
generate_one_block  0.650444507598877
generate_one_block  0.6267554759979248
generate_one_block  0.653266429901123
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07388901710510254
gen group dst list time:  0.10388851165771484
time for parepare:  0.01922917366027832
local_output_nid generation:  0.03435564041137695
local_in_edges_tensor generation:  0.05443739891052246
mini_batch_src_global generation:  0.05021381378173828
r_  generation:  0.4883687496185303
local_output_nid generation:  0.039034366607666016
local_in_edges_tensor generation:  0.04792308807373047
mini_batch_src_global generation:  0.0711374282836914
r_  generation:  0.49551868438720703
local_output_nid generation:  0.0406796932220459
local_in_edges_tensor generation:  0.038042545318603516
mini_batch_src_global generation:  0.05425882339477539
r_  generation:  0.49594902992248535
local_output_nid generation:  0.03912997245788574
local_in_edges_tensor generation:  0.0438997745513916
mini_batch_src_global generation:  0.05457425117492676
r_  generation:  0.5091819763183594
local_output_nid generation:  0.03900265693664551
local_in_edges_tensor generation:  0.039298295974731445
mini_batch_src_global generation:  0.05428600311279297
r_  generation:  0.5097665786743164
local_output_nid generation:  0.03962421417236328
local_in_edges_tensor generation:  0.043985843658447266
mini_batch_src_global generation:  0.05375266075134277
r_  generation:  0.5048191547393799
local_output_nid generation:  0.04209303855895996
local_in_edges_tensor generation:  0.039360761642456055
mini_batch_src_global generation:  0.05487513542175293
r_  generation:  0.5066814422607422
local_output_nid generation:  0.03927755355834961
local_in_edges_tensor generation:  0.034818172454833984
mini_batch_src_global generation:  0.05504345893859863
r_  generation:  0.5090208053588867
local_output_nid generation:  0.039370059967041016
local_in_edges_tensor generation:  0.044298410415649414
mini_batch_src_global generation:  0.05546259880065918
r_  generation:  0.5302867889404297
local_output_nid generation:  0.03958272933959961
local_in_edges_tensor generation:  0.049744606018066406
mini_batch_src_global generation:  0.06022357940673828
r_  generation:  0.5327136516571045
local_output_nid generation:  0.03992414474487305
local_in_edges_tensor generation:  0.04917311668395996
mini_batch_src_global generation:  0.06453061103820801
r_  generation:  0.5150232315063477
local_output_nid generation:  0.04068160057067871
local_in_edges_tensor generation:  0.04549670219421387
mini_batch_src_global generation:  0.05596423149108887
r_  generation:  0.5127391815185547
local_output_nid generation:  0.039266347885131836
local_in_edges_tensor generation:  0.039186716079711914
mini_batch_src_global generation:  0.056243181228637695
r_  generation:  0.5141346454620361
local_output_nid generation:  0.039484500885009766
local_in_edges_tensor generation:  0.043548583984375
mini_batch_src_global generation:  0.05527186393737793
r_  generation:  0.5161879062652588
local_output_nid generation:  0.03964495658874512
local_in_edges_tensor generation:  0.04354453086853027
mini_batch_src_global generation:  0.05654454231262207
r_  generation:  0.5146198272705078
local_output_nid generation:  0.039597511291503906
local_in_edges_tensor generation:  0.034967899322509766
mini_batch_src_global generation:  0.05681109428405762
r_  generation:  0.514732837677002
----------------------check_connections_block total spend ----------------------------- 12.325339794158936
generate_one_block  0.6283550262451172
generate_one_block  0.7034056186676025
generate_one_block  0.6326339244842529
generate_one_block  0.6424155235290527
generate_one_block  0.6304073333740234
generate_one_block  0.6369757652282715
generate_one_block  0.6327018737792969
generate_one_block  0.6199438571929932
generate_one_block  0.6201717853546143
generate_one_block  0.6395750045776367
generate_one_block  0.653656005859375
generate_one_block  0.6253256797790527
generate_one_block  0.6319079399108887
generate_one_block  0.6495954990386963
generate_one_block  0.6487805843353271
generate_one_block  0.6476972103118896
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

connection checking time:  28.85694670677185
block generation total time  25.044362783432007
average batch blocks generation time:  1.5652726739645004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10725212097167969  GigaBytes
Max Memory Allocated: 0.10725212097167969  GigaBytes

torch.Size([163616, 128])
torch.Size([155350, 32])
torch.Size([123692, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2615966796875 GB
    Memory Allocated: 15.979294300079346  GigaBytes
Max Memory Allocated: 15.985494136810303  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 0.10894203186035156  GigaBytes
Max Memory Allocated: 15.985494136810303  GigaBytes

torch.Size([163685, 128])
torch.Size([155522, 32])
torch.Size([123869, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 15.995412349700928  GigaBytes
Max Memory Allocated: 16.00244426727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 0.10896444320678711  GigaBytes
Max Memory Allocated: 16.00244426727295  GigaBytes

torch.Size([163721, 128])
torch.Size([155579, 32])
torch.Size([123457, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 15.977852821350098  GigaBytes
Max Memory Allocated: 16.00244426727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 0.10892534255981445  GigaBytes
Max Memory Allocated: 16.00244426727295  GigaBytes

torch.Size([163598, 128])
torch.Size([155633, 32])
torch.Size([123991, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 16.00769329071045  GigaBytes
Max Memory Allocated: 16.014748096466064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 0.10889291763305664  GigaBytes
Max Memory Allocated: 16.014748096466064  GigaBytes

torch.Size([163704, 128])
torch.Size([155783, 32])
torch.Size([123826, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 15.966878890991211  GigaBytes
Max Memory Allocated: 16.014748096466064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0057373046875 GB
    Memory Allocated: 0.10909509658813477  GigaBytes
Max Memory Allocated: 16.014748096466064  GigaBytes

torch.Size([163888, 128])
torch.Size([155998, 32])
torch.Size([124527, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 16.019545078277588  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10901021957397461  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

torch.Size([163690, 128])
torch.Size([155852, 32])
torch.Size([124123, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.996296405792236  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10893821716308594  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

torch.Size([163635, 128])
torch.Size([155560, 32])
torch.Size([123729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.99624252319336  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10896539688110352  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

torch.Size([163557, 128])
torch.Size([155562, 32])
torch.Size([124061, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.982151508331299  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.1087803840637207  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

torch.Size([163624, 128])
torch.Size([155502, 32])
torch.Size([122868, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.95043134689331  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.1090235710144043  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

torch.Size([163675, 128])
torch.Size([155598, 32])
torch.Size([123471, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.992458820343018  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10904645919799805  GigaBytes
Max Memory Allocated: 16.026616096496582  GigaBytes

torch.Size([163624, 128])
torch.Size([155475, 32])
torch.Size([124048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 16.03496026992798  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10892724990844727  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163501, 128])
torch.Size([155195, 32])
torch.Size([122818, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.962390899658203  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10897064208984375  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163661, 128])
torch.Size([155467, 32])
torch.Size([123784, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 16.001729488372803  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10901498794555664  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163716, 128])
torch.Size([155667, 32])
torch.Size([123735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.996749877929688  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.10893821716308594  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163571, 128])
torch.Size([155587, 32])
torch.Size([124224, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 16.014278888702393  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04137633740901947 |0.05074179172515869 |0.3901918977499008 |0.00010469555854797363 |0.48015542328357697 |0.010298013687133789 |
----------------------------------------------------------pseudo_mini_loss sum 4.487305164337158
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7749576
Number of first layer input nodes during this epoch:  2618466
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.15967607498168945  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024595975875854492
random selection method range initialization spend 0.005590200424194336
time for parepare:  0.01825118064880371
local_output_nid generation:  0.0028924942016601562
local_in_edges_tensor generation:  0.006928443908691406
mini_batch_src_global generation:  0.002002716064453125
r_  generation:  0.018762826919555664
local_output_nid generation:  0.0032227039337158203
local_in_edges_tensor generation:  0.0017511844635009766
mini_batch_src_global generation:  0.002110004425048828
r_  generation:  0.018455982208251953
local_output_nid generation:  0.0031478404998779297
local_in_edges_tensor generation:  0.0016341209411621094
mini_batch_src_global generation:  0.0014812946319580078
r_  generation:  0.019221067428588867
local_output_nid generation:  0.003126382827758789
local_in_edges_tensor generation:  0.0016129016876220703
mini_batch_src_global generation:  0.0014100074768066406
r_  generation:  0.018738746643066406
local_output_nid generation:  0.003084897994995117
local_in_edges_tensor generation:  0.0016193389892578125
mini_batch_src_global generation:  0.0015273094177246094
r_  generation:  0.019423723220825195
local_output_nid generation:  0.003115415573120117
local_in_edges_tensor generation:  0.0016260147094726562
mini_batch_src_global generation:  0.0015034675598144531
r_  generation:  0.01945018768310547
local_output_nid generation:  0.0031147003173828125
local_in_edges_tensor generation:  0.0016019344329833984
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.019599437713623047
local_output_nid generation:  0.003087282180786133
local_in_edges_tensor generation:  0.0015897750854492188
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.019572734832763672
local_output_nid generation:  0.0031058788299560547
local_in_edges_tensor generation:  0.0016827583312988281
mini_batch_src_global generation:  0.001584768295288086
r_  generation:  0.019132375717163086
local_output_nid generation:  0.0031147003173828125
local_in_edges_tensor generation:  0.0016732215881347656
mini_batch_src_global generation:  0.0015943050384521484
r_  generation:  0.01986098289489746
local_output_nid generation:  0.003130674362182617
local_in_edges_tensor generation:  0.0016880035400390625
mini_batch_src_global generation:  0.00157928466796875
r_  generation:  0.01961493492126465
local_output_nid generation:  0.003142833709716797
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.0015397071838378906
r_  generation:  0.019852161407470703
local_output_nid generation:  0.003159761428833008
local_in_edges_tensor generation:  0.0015990734100341797
mini_batch_src_global generation:  0.00154876708984375
r_  generation:  0.0201416015625
local_output_nid generation:  0.0031888484954833984
local_in_edges_tensor generation:  0.001653909683227539
mini_batch_src_global generation:  0.0015342235565185547
r_  generation:  0.0193789005279541
local_output_nid generation:  0.003158092498779297
local_in_edges_tensor generation:  0.0016632080078125
mini_batch_src_global generation:  0.0015561580657958984
r_  generation:  0.020016908645629883
local_output_nid generation:  0.003134012222290039
local_in_edges_tensor generation:  0.001650094985961914
mini_batch_src_global generation:  0.00157928466796875
r_  generation:  0.021015405654907227
----------------------check_connections_block total spend ----------------------------- 0.5191621780395508
generate_one_block  0.0373377799987793
generate_one_block  0.03161478042602539
generate_one_block  0.03220653533935547
generate_one_block  0.03201007843017578
generate_one_block  0.032099008560180664
generate_one_block  0.0347590446472168
generate_one_block  0.033098459243774414
generate_one_block  0.031960487365722656
generate_one_block  0.031119346618652344
generate_one_block  0.03685569763183594
generate_one_block  0.03136396408081055
generate_one_block  0.03176164627075195
generate_one_block  0.03171992301940918
generate_one_block  0.03069448471069336
generate_one_block  0.03131556510925293
generate_one_block  0.03224539756774902
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03882098197937012
gen group dst list time:  0.017067432403564453
time for parepare:  0.0195009708404541
local_output_nid generation:  0.009098291397094727
local_in_edges_tensor generation:  0.020800113677978516
mini_batch_src_global generation:  0.021364927291870117
r_  generation:  0.19976568222045898
local_output_nid generation:  0.013506650924682617
local_in_edges_tensor generation:  0.02018427848815918
mini_batch_src_global generation:  0.024810314178466797
r_  generation:  0.2048656940460205
local_output_nid generation:  0.013392925262451172
local_in_edges_tensor generation:  0.017217397689819336
mini_batch_src_global generation:  0.024259090423583984
r_  generation:  0.21530795097351074
local_output_nid generation:  0.012837886810302734
local_in_edges_tensor generation:  0.0185697078704834
mini_batch_src_global generation:  0.025569915771484375
r_  generation:  0.21425938606262207
local_output_nid generation:  0.013503313064575195
local_in_edges_tensor generation:  0.015254497528076172
mini_batch_src_global generation:  0.026597976684570312
r_  generation:  0.21915650367736816
local_output_nid generation:  0.013564586639404297
local_in_edges_tensor generation:  0.01477813720703125
mini_batch_src_global generation:  0.026753902435302734
r_  generation:  0.21749401092529297
local_output_nid generation:  0.013674259185791016
local_in_edges_tensor generation:  0.015262603759765625
mini_batch_src_global generation:  0.02737283706665039
r_  generation:  0.22594547271728516
local_output_nid generation:  0.013543367385864258
local_in_edges_tensor generation:  0.01743030548095703
mini_batch_src_global generation:  0.02703070640563965
r_  generation:  0.22190523147583008
local_output_nid generation:  0.013472318649291992
local_in_edges_tensor generation:  0.017249584197998047
mini_batch_src_global generation:  0.02701854705810547
r_  generation:  0.22195959091186523
local_output_nid generation:  0.013162374496459961
local_in_edges_tensor generation:  0.021589040756225586
mini_batch_src_global generation:  0.0277402400970459
r_  generation:  0.22437310218811035
local_output_nid generation:  0.012635231018066406
local_in_edges_tensor generation:  0.013010501861572266
mini_batch_src_global generation:  0.027039051055908203
r_  generation:  0.22107648849487305
local_output_nid generation:  0.012721538543701172
local_in_edges_tensor generation:  0.013340234756469727
mini_batch_src_global generation:  0.028873682022094727
r_  generation:  0.22558951377868652
local_output_nid generation:  0.012887954711914062
local_in_edges_tensor generation:  0.016935110092163086
mini_batch_src_global generation:  0.02697157859802246
r_  generation:  0.22742199897766113
local_output_nid generation:  0.01582956314086914
local_in_edges_tensor generation:  0.018040180206298828
mini_batch_src_global generation:  0.028198719024658203
r_  generation:  0.23585939407348633
local_output_nid generation:  0.01580023765563965
local_in_edges_tensor generation:  0.020602941513061523
mini_batch_src_global generation:  0.03045654296875
r_  generation:  0.22185611724853516
local_output_nid generation:  0.01291203498840332
local_in_edges_tensor generation:  0.016495227813720703
mini_batch_src_global generation:  0.027475357055664062
r_  generation:  0.21728181838989258
----------------------check_connections_block total spend ----------------------------- 5.224303960800171
generate_one_block  0.3003115653991699
generate_one_block  0.29073548316955566
generate_one_block  0.29729437828063965
generate_one_block  0.29681968688964844
generate_one_block  0.2949843406677246
generate_one_block  0.28920507431030273
generate_one_block  0.32569456100463867
generate_one_block  0.28641176223754883
generate_one_block  0.29260993003845215
generate_one_block  0.30646824836730957
generate_one_block  0.2832448482513428
generate_one_block  0.2904982566833496
generate_one_block  0.31433892250061035
generate_one_block  0.28678274154663086
generate_one_block  0.289459228515625
generate_one_block  0.29320716857910156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.10132217407226562
gen group dst list time:  0.07181048393249512
time for parepare:  0.022264480590820312
local_output_nid generation:  0.03153514862060547
local_in_edges_tensor generation:  0.06544065475463867
mini_batch_src_global generation:  0.04981040954589844
r_  generation:  0.47777390480041504
local_output_nid generation:  0.0334928035736084
local_in_edges_tensor generation:  0.04995870590209961
mini_batch_src_global generation:  0.060259342193603516
r_  generation:  0.4949791431427002
local_output_nid generation:  0.033093929290771484
local_in_edges_tensor generation:  0.041809797286987305
mini_batch_src_global generation:  0.05696463584899902
r_  generation:  0.4959700107574463
local_output_nid generation:  0.032852888107299805
local_in_edges_tensor generation:  0.04541301727294922
mini_batch_src_global generation:  0.05714845657348633
r_  generation:  0.5011768341064453
local_output_nid generation:  0.032790422439575195
local_in_edges_tensor generation:  0.09765505790710449
mini_batch_src_global generation:  0.0568692684173584
r_  generation:  0.5286750793457031
local_output_nid generation:  0.03647947311401367
local_in_edges_tensor generation:  0.04862213134765625
mini_batch_src_global generation:  0.05972409248352051
r_  generation:  0.49823951721191406
local_output_nid generation:  0.033106327056884766
local_in_edges_tensor generation:  0.047147512435913086
mini_batch_src_global generation:  0.05636763572692871
r_  generation:  0.5031688213348389
local_output_nid generation:  0.03271842002868652
local_in_edges_tensor generation:  0.032621145248413086
mini_batch_src_global generation:  0.057457923889160156
r_  generation:  0.48966312408447266
local_output_nid generation:  0.033112525939941406
local_in_edges_tensor generation:  0.03642582893371582
mini_batch_src_global generation:  0.05697488784790039
r_  generation:  0.51503586769104
local_output_nid generation:  0.03378152847290039
local_in_edges_tensor generation:  0.036722660064697266
mini_batch_src_global generation:  0.058307647705078125
r_  generation:  0.503387451171875
local_output_nid generation:  0.03330802917480469
local_in_edges_tensor generation:  0.03700113296508789
mini_batch_src_global generation:  0.05761075019836426
r_  generation:  0.5095469951629639
local_output_nid generation:  0.03314995765686035
local_in_edges_tensor generation:  0.03925442695617676
mini_batch_src_global generation:  0.06268310546875
r_  generation:  0.5068426132202148
local_output_nid generation:  0.033576250076293945
local_in_edges_tensor generation:  0.04376792907714844
mini_batch_src_global generation:  0.059172630310058594
r_  generation:  0.5166342258453369
local_output_nid generation:  0.034357309341430664
local_in_edges_tensor generation:  0.04500555992126465
mini_batch_src_global generation:  0.0607142448425293
r_  generation:  0.510108232498169
local_output_nid generation:  0.034235477447509766
local_in_edges_tensor generation:  0.040854692459106445
mini_batch_src_global generation:  0.05711245536804199
r_  generation:  0.5036518573760986
local_output_nid generation:  0.032896995544433594
local_in_edges_tensor generation:  0.03465747833251953
mini_batch_src_global generation:  0.05910682678222656
r_  generation:  0.4985032081604004
----------------------check_connections_block total spend ----------------------------- 12.029550313949585
generate_one_block  0.6762382984161377
generate_one_block  0.6575839519500732
generate_one_block  0.6704893112182617
generate_one_block  0.6486465930938721
generate_one_block  0.66322922706604
generate_one_block  0.6511220932006836
generate_one_block  0.666191816329956
generate_one_block  0.6408829689025879
generate_one_block  0.6803572177886963
generate_one_block  0.665931224822998
generate_one_block  0.6432416439056396
generate_one_block  0.659050464630127
generate_one_block  0.6520688533782959
generate_one_block  0.6382648944854736
generate_one_block  0.6512048244476318
generate_one_block  0.6524019241333008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.044107913970947266
gen group dst list time:  0.09895443916320801
time for parepare:  0.01950693130493164
local_output_nid generation:  0.03537392616271973
local_in_edges_tensor generation:  0.05222725868225098
mini_batch_src_global generation:  0.04507899284362793
r_  generation:  0.49700140953063965
local_output_nid generation:  0.041373491287231445
local_in_edges_tensor generation:  0.04602527618408203
mini_batch_src_global generation:  0.056172847747802734
r_  generation:  0.5036430358886719
local_output_nid generation:  0.04452776908874512
local_in_edges_tensor generation:  0.04537320137023926
mini_batch_src_global generation:  0.05689096450805664
r_  generation:  0.5085628032684326
local_output_nid generation:  0.04074549674987793
local_in_edges_tensor generation:  0.04590773582458496
mini_batch_src_global generation:  0.052750587463378906
r_  generation:  0.5062079429626465
local_output_nid generation:  0.03946733474731445
local_in_edges_tensor generation:  0.0413205623626709
mini_batch_src_global generation:  0.05409073829650879
r_  generation:  0.51084303855896
local_output_nid generation:  0.039575815200805664
local_in_edges_tensor generation:  0.04537558555603027
mini_batch_src_global generation:  0.05323529243469238
r_  generation:  0.5141005516052246
local_output_nid generation:  0.03969907760620117
local_in_edges_tensor generation:  0.03702950477600098
mini_batch_src_global generation:  0.05478954315185547
r_  generation:  0.5203685760498047
local_output_nid generation:  0.0395665168762207
local_in_edges_tensor generation:  0.045356035232543945
mini_batch_src_global generation:  0.055399417877197266
r_  generation:  0.5183579921722412
local_output_nid generation:  0.039856672286987305
local_in_edges_tensor generation:  0.04126167297363281
mini_batch_src_global generation:  0.05630350112915039
r_  generation:  0.531092643737793
local_output_nid generation:  0.039595603942871094
local_in_edges_tensor generation:  0.045804738998413086
mini_batch_src_global generation:  0.05881810188293457
r_  generation:  0.5209858417510986
local_output_nid generation:  0.03954148292541504
local_in_edges_tensor generation:  0.041107892990112305
mini_batch_src_global generation:  0.05600166320800781
r_  generation:  0.5267906188964844
local_output_nid generation:  0.0397188663482666
local_in_edges_tensor generation:  0.04131269454956055
mini_batch_src_global generation:  0.05626106262207031
r_  generation:  0.5232205390930176
local_output_nid generation:  0.039621591567993164
local_in_edges_tensor generation:  0.04594922065734863
mini_batch_src_global generation:  0.05617356300354004
r_  generation:  0.5244979858398438
local_output_nid generation:  0.039528846740722656
local_in_edges_tensor generation:  0.036928653717041016
mini_batch_src_global generation:  0.05630016326904297
r_  generation:  0.5198495388031006
local_output_nid generation:  0.039624691009521484
local_in_edges_tensor generation:  0.04058551788330078
mini_batch_src_global generation:  0.05682539939880371
r_  generation:  0.5213005542755127
local_output_nid generation:  0.04084634780883789
local_in_edges_tensor generation:  0.0452725887298584
mini_batch_src_global generation:  0.05634140968322754
r_  generation:  0.5228390693664551
----------------------check_connections_block total spend ----------------------------- 12.421560525894165
generate_one_block  0.6426568031311035
generate_one_block  0.6513791084289551
generate_one_block  0.649334192276001
generate_one_block  0.6535477638244629
generate_one_block  0.6492066383361816
generate_one_block  0.6446607112884521
generate_one_block  0.7024955749511719
generate_one_block  0.636066198348999
generate_one_block  0.6519880294799805
generate_one_block  0.6612303256988525
generate_one_block  0.6689910888671875
generate_one_block  0.645167350769043
generate_one_block  0.6565394401550293
generate_one_block  0.6357946395874023
generate_one_block  0.6328728199005127
generate_one_block  0.6379148960113525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.15967607498168945  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

connection checking time:  29.67541480064392
block generation total time  25.674817085266113
average batch blocks generation time:  1.604676067829132
block dataloader generation time/epoch 58.32213759422302
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.11034202575683594  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163641, 128])
torch.Size([155673, 32])
torch.Size([124359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 16.01912260055542  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.11012554168701172  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163595, 128])
torch.Size([155504, 32])
torch.Size([123574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 15.979565143585205  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0155029296875 GB
    Memory Allocated: 0.1103825569152832  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163598, 128])
torch.Size([155553, 32])
torch.Size([124207, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.02336549758911  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.1102757453918457  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163658, 128])
torch.Size([155585, 32])
torch.Size([123993, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.013410091400146  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11035776138305664  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163585, 128])
torch.Size([155471, 32])
torch.Size([123721, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.00492811203003  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11021614074707031  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163683, 128])
torch.Size([155754, 32])
torch.Size([124072, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.00517463684082  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11038827896118164  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163573, 128])
torch.Size([155476, 32])
torch.Size([124136, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.02888584136963  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11011648178100586  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163528, 128])
torch.Size([155204, 32])
torch.Size([122919, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.967720031738281  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11024713516235352  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163582, 128])
torch.Size([155610, 32])
torch.Size([123731, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.982995986938477  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.1103353500366211  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163721, 128])
torch.Size([155734, 32])
torch.Size([124211, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.03114891052246  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11018037796020508  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163836, 128])
torch.Size([155929, 32])
torch.Size([123763, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.963253021240234  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.1102743148803711  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163769, 128])
torch.Size([155599, 32])
torch.Size([123636, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.997225761413574  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11031389236450195  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163756, 128])
torch.Size([155935, 32])
torch.Size([124444, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 16.006089687347412  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11008501052856445  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163562, 128])
torch.Size([155444, 32])
torch.Size([123392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.970158576965332  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11024999618530273  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163530, 128])
torch.Size([155435, 32])
torch.Size([123521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.976768016815186  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 0.11008834838867188  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

torch.Size([163607, 128])
torch.Size([155314, 32])
torch.Size([122853, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0213623046875 GB
    Memory Allocated: 15.955574989318848  GigaBytes
Max Memory Allocated: 16.042162895202637  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04105207324028015 |0.02843572199344635 |0.3508644700050354 |9.56505537033081e-05 |0.47799526154994965 |0.0069332122802734375 |
----------------------------------------------------------pseudo_mini_loss sum 3.959057569503784
Total (block generation + training)time/epoch 72.75076079368591
Training time/epoch 14.42827844619751
Training time without block to device /epoch 13.973306894302368
Training time without total dataloading part /epoch 13.270219326019287
load block tensor time/epoch 0.6568331718444824
block to device time/epoch 0.4549715518951416
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7749321
Number of first layer input nodes during this epoch:  2618224
