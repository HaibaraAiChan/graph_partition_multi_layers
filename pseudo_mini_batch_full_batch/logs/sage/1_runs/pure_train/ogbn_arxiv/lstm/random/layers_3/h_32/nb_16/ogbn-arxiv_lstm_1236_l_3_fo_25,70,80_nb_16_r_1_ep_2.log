Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648454976.6392906
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026424407958984375
random selection method range initialization spend 0.005682706832885742
time for parepare:  0.019279003143310547
local_output_nid generation:  0.0021822452545166016
local_in_edges_tensor generation:  0.0039370059967041016
mini_batch_src_global generation:  0.0020318031311035156
r_  generation:  0.021099328994750977
local_output_nid generation:  0.0029103755950927734
local_in_edges_tensor generation:  0.0016815662384033203
mini_batch_src_global generation:  0.002495288848876953
r_  generation:  0.022229671478271484
local_output_nid generation:  0.002959728240966797
local_in_edges_tensor generation:  0.0015833377838134766
mini_batch_src_global generation:  0.001661062240600586
r_  generation:  0.021901607513427734
local_output_nid generation:  0.0029745101928710938
local_in_edges_tensor generation:  0.001636505126953125
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.02255392074584961
local_output_nid generation:  0.002997159957885742
local_in_edges_tensor generation:  0.0015914440155029297
mini_batch_src_global generation:  0.0016999244689941406
r_  generation:  0.02257251739501953
local_output_nid generation:  0.0030095577239990234
local_in_edges_tensor generation:  0.001566171646118164
mini_batch_src_global generation:  0.0017685890197753906
r_  generation:  0.022068262100219727
local_output_nid generation:  0.002969026565551758
local_in_edges_tensor generation:  0.0015614032745361328
mini_batch_src_global generation:  0.0017056465148925781
r_  generation:  0.022252321243286133
local_output_nid generation:  0.002959012985229492
local_in_edges_tensor generation:  0.0015437602996826172
mini_batch_src_global generation:  0.0017828941345214844
r_  generation:  0.022805213928222656
local_output_nid generation:  0.002961397171020508
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0017271041870117188
r_  generation:  0.022223711013793945
local_output_nid generation:  0.002995729446411133
local_in_edges_tensor generation:  0.001569986343383789
mini_batch_src_global generation:  0.0018334388732910156
r_  generation:  0.02374720573425293
local_output_nid generation:  0.0029878616333007812
local_in_edges_tensor generation:  0.0015654563903808594
mini_batch_src_global generation:  0.00185394287109375
r_  generation:  0.02263331413269043
local_output_nid generation:  0.0030303001403808594
local_in_edges_tensor generation:  0.0015556812286376953
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.022923707962036133
local_output_nid generation:  0.0029909610748291016
local_in_edges_tensor generation:  0.0015592575073242188
mini_batch_src_global generation:  0.0018334388732910156
r_  generation:  0.022884845733642578
local_output_nid generation:  0.00301361083984375
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.0018193721771240234
r_  generation:  0.02238607406616211
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0015568733215332031
mini_batch_src_global generation:  0.0017843246459960938
r_  generation:  0.02219104766845703
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0015230178833007812
mini_batch_src_global generation:  0.0018286705017089844
r_  generation:  0.022482633590698242
----------------------check_connections_block total spend ----------------------------- 0.5715084075927734
generate_one_block  0.030180931091308594
generate_one_block  0.032944440841674805
generate_one_block  0.03529930114746094
generate_one_block  0.033568620681762695
generate_one_block  0.03312540054321289
generate_one_block  0.03211498260498047
generate_one_block  0.031670331954956055
generate_one_block  0.03298687934875488
generate_one_block  0.03176712989807129
generate_one_block  0.033448219299316406
generate_one_block  0.03210330009460449
generate_one_block  0.03185606002807617
generate_one_block  0.03222346305847168
generate_one_block  0.03131985664367676
generate_one_block  0.0314178466796875
generate_one_block  0.03169655799865723
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03984260559082031
gen group dst list time:  0.020578861236572266
time for parepare:  0.019533634185791016
local_output_nid generation:  0.009171485900878906
local_in_edges_tensor generation:  0.02032184600830078
mini_batch_src_global generation:  0.027447223663330078
r_  generation:  0.2512166500091553
local_output_nid generation:  0.013950109481811523
local_in_edges_tensor generation:  0.023665189743041992
mini_batch_src_global generation:  0.03278207778930664
r_  generation:  0.26420092582702637
local_output_nid generation:  0.013934612274169922
local_in_edges_tensor generation:  0.020022153854370117
mini_batch_src_global generation:  0.032259225845336914
r_  generation:  0.27458977699279785
local_output_nid generation:  0.01409149169921875
local_in_edges_tensor generation:  0.020169973373413086
mini_batch_src_global generation:  0.03606367111206055
r_  generation:  0.2837095260620117
local_output_nid generation:  0.013918161392211914
local_in_edges_tensor generation:  0.01478266716003418
mini_batch_src_global generation:  0.03472614288330078
r_  generation:  0.2857208251953125
local_output_nid generation:  0.013744354248046875
local_in_edges_tensor generation:  0.01920461654663086
mini_batch_src_global generation:  0.03419160842895508
r_  generation:  0.2751009464263916
local_output_nid generation:  0.01374197006225586
local_in_edges_tensor generation:  0.019346237182617188
mini_batch_src_global generation:  0.03450322151184082
r_  generation:  0.2751290798187256
local_output_nid generation:  0.013849258422851562
local_in_edges_tensor generation:  0.01987743377685547
mini_batch_src_global generation:  0.037958383560180664
r_  generation:  0.28775763511657715
local_output_nid generation:  0.013772726058959961
local_in_edges_tensor generation:  0.014973163604736328
mini_batch_src_global generation:  0.03551030158996582
r_  generation:  0.28336286544799805
local_output_nid generation:  0.014081716537475586
local_in_edges_tensor generation:  0.017429351806640625
mini_batch_src_global generation:  0.03619790077209473
r_  generation:  0.28656840324401855
local_output_nid generation:  0.013875484466552734
local_in_edges_tensor generation:  0.019989967346191406
mini_batch_src_global generation:  0.03531908988952637
r_  generation:  0.2833418846130371
local_output_nid generation:  0.013864755630493164
local_in_edges_tensor generation:  0.015192508697509766
mini_batch_src_global generation:  0.03529238700866699
r_  generation:  0.27959656715393066
local_output_nid generation:  0.014046430587768555
local_in_edges_tensor generation:  0.016974210739135742
mini_batch_src_global generation:  0.035524606704711914
r_  generation:  0.28206586837768555
local_output_nid generation:  0.013614177703857422
local_in_edges_tensor generation:  0.014732122421264648
mini_batch_src_global generation:  0.03497767448425293
r_  generation:  0.2776036262512207
local_output_nid generation:  0.013744354248046875
local_in_edges_tensor generation:  0.014740467071533203
mini_batch_src_global generation:  0.0348820686340332
r_  generation:  0.2756922245025635
local_output_nid generation:  0.013892889022827148
local_in_edges_tensor generation:  0.019028902053833008
mini_batch_src_global generation:  0.035805463790893555
r_  generation:  0.2818465232849121
----------------------check_connections_block total spend ----------------------------- 6.4585325717926025
generate_one_block  0.3540639877319336
generate_one_block  0.36032795906066895
generate_one_block  0.37194061279296875
generate_one_block  0.3718302249908447
generate_one_block  0.38124656677246094
generate_one_block  0.3590257167816162
generate_one_block  0.3568994998931885
generate_one_block  0.3749382495880127
generate_one_block  0.3627042770385742
generate_one_block  0.3766202926635742
generate_one_block  0.36162233352661133
generate_one_block  0.35793185234069824
generate_one_block  0.3636016845703125
generate_one_block  0.3577094078063965
generate_one_block  0.36207151412963867
generate_one_block  0.36375856399536133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03159809112548828
gen group dst list time:  0.06326413154602051
time for parepare:  0.019282817840576172
local_output_nid generation:  0.026743173599243164
local_in_edges_tensor generation:  0.04031682014465332
mini_batch_src_global generation:  0.044355154037475586
r_  generation:  0.466280460357666
local_output_nid generation:  0.03374123573303223
local_in_edges_tensor generation:  0.047128915786743164
mini_batch_src_global generation:  0.054225921630859375
r_  generation:  0.4798624515533447
local_output_nid generation:  0.03293442726135254
local_in_edges_tensor generation:  0.039528608322143555
mini_batch_src_global generation:  0.052455902099609375
r_  generation:  0.4817848205566406
local_output_nid generation:  0.03329968452453613
local_in_edges_tensor generation:  0.0397951602935791
mini_batch_src_global generation:  0.05666637420654297
r_  generation:  0.48621511459350586
local_output_nid generation:  0.033103227615356445
local_in_edges_tensor generation:  0.03142905235290527
mini_batch_src_global generation:  0.05469346046447754
r_  generation:  0.49386143684387207
local_output_nid generation:  0.03300809860229492
local_in_edges_tensor generation:  0.03143143653869629
mini_batch_src_global generation:  0.055617332458496094
r_  generation:  0.4883244037628174
local_output_nid generation:  0.03333282470703125
local_in_edges_tensor generation:  0.031525611877441406
mini_batch_src_global generation:  0.05748391151428223
r_  generation:  0.4906010627746582
local_output_nid generation:  0.03327298164367676
local_in_edges_tensor generation:  0.035269737243652344
mini_batch_src_global generation:  0.05886697769165039
r_  generation:  0.4958343505859375
local_output_nid generation:  0.033255577087402344
local_in_edges_tensor generation:  0.03937220573425293
mini_batch_src_global generation:  0.0551755428314209
r_  generation:  0.49457287788391113
local_output_nid generation:  0.03350996971130371
local_in_edges_tensor generation:  0.03509879112243652
mini_batch_src_global generation:  0.061338186264038086
r_  generation:  0.5028748512268066
local_output_nid generation:  0.03344607353210449
local_in_edges_tensor generation:  0.04303574562072754
mini_batch_src_global generation:  0.055535078048706055
r_  generation:  0.4996964931488037
local_output_nid generation:  0.03332972526550293
local_in_edges_tensor generation:  0.03194022178649902
mini_batch_src_global generation:  0.056336164474487305
r_  generation:  0.498492956161499
local_output_nid generation:  0.03324127197265625
local_in_edges_tensor generation:  0.031174659729003906
mini_batch_src_global generation:  0.056210994720458984
r_  generation:  0.5014224052429199
local_output_nid generation:  0.033382415771484375
local_in_edges_tensor generation:  0.03601217269897461
mini_batch_src_global generation:  0.05944085121154785
r_  generation:  0.49145960807800293
local_output_nid generation:  0.03345608711242676
local_in_edges_tensor generation:  0.035314321517944336
mini_batch_src_global generation:  0.05537700653076172
r_  generation:  0.49725794792175293
local_output_nid generation:  0.03352713584899902
local_in_edges_tensor generation:  0.03840136528015137
mini_batch_src_global generation:  0.0557706356048584
r_  generation:  0.4907348155975342
----------------------check_connections_block total spend ----------------------------- 11.587007761001587
generate_one_block  0.6018931865692139
generate_one_block  0.6189911365509033
generate_one_block  0.6374642848968506
generate_one_block  0.6164190769195557
generate_one_block  0.6092150211334229
generate_one_block  0.6133527755737305
generate_one_block  0.6751961708068848
generate_one_block  0.6393239498138428
generate_one_block  0.6031289100646973
generate_one_block  0.6179273128509521
generate_one_block  0.6187350749969482
generate_one_block  0.6114859580993652
generate_one_block  0.6231379508972168
generate_one_block  0.6042370796203613
generate_one_block  0.6173014640808105
generate_one_block  0.6173195838928223
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  18.04554033279419
block generation total time  15.76142168045044
average batch blocks generation time:  0.9850888550281525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09279775619506836  GigaBytes
Max Memory Allocated: 0.09279775619506836  GigaBytes

torch.Size([156596, 128])
torch.Size([129483, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3319091796875 GB
    Memory Allocated: 12.6654953956604  GigaBytes
Max Memory Allocated: 12.67244291305542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3416748046875 GB
    Memory Allocated: 0.09523677825927734  GigaBytes
Max Memory Allocated: 12.67244291305542  GigaBytes

torch.Size([156682, 128])
torch.Size([130102, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5838623046875 GB
    Memory Allocated: 12.727567672729492  GigaBytes
Max Memory Allocated: 12.735579013824463  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5838623046875 GB
    Memory Allocated: 0.0954432487487793  GigaBytes
Max Memory Allocated: 12.735579013824463  GigaBytes

torch.Size([156761, 128])
torch.Size([130000, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3084716796875 GB
    Memory Allocated: 12.762399673461914  GigaBytes
Max Memory Allocated: 12.770522594451904  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3104248046875 GB
    Memory Allocated: 0.09558391571044922  GigaBytes
Max Memory Allocated: 12.770522594451904  GigaBytes

torch.Size([156846, 128])
torch.Size([130346, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.792002201080322  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09544086456298828  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

torch.Size([156790, 128])
torch.Size([130125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.754870414733887  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09523916244506836  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

torch.Size([156643, 128])
torch.Size([129514, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.701315879821777  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09514284133911133  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

torch.Size([156521, 128])
torch.Size([129459, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 12.686308860778809  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.09573554992675781  GigaBytes
Max Memory Allocated: 12.800236701965332  GigaBytes

torch.Size([157094, 128])
torch.Size([130725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0369873046875 GB
    Memory Allocated: 12.802833080291748  GigaBytes
Max Memory Allocated: 12.81101942062378  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0369873046875 GB
    Memory Allocated: 0.09537458419799805  GigaBytes
Max Memory Allocated: 12.81101942062378  GigaBytes

torch.Size([156823, 128])
torch.Size([129779, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0369873046875 GB
    Memory Allocated: 12.71968126296997  GigaBytes
Max Memory Allocated: 12.81101942062378  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0369873046875 GB
    Memory Allocated: 0.09567022323608398  GigaBytes
Max Memory Allocated: 12.81101942062378  GigaBytes

torch.Size([156929, 128])
torch.Size([130169, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.808058261871338  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09546470642089844  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156862, 128])
torch.Size([129985, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.754514217376709  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09534740447998047  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156810, 128])
torch.Size([129763, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.723628044128418  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09549951553344727  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156935, 128])
torch.Size([130197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.754283905029297  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09524250030517578  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156832, 128])
torch.Size([129236, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.660019397735596  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09534168243408203  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([157032, 128])
torch.Size([129841, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.673103332519531  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09540987014770508  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156813, 128])
torch.Size([129574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.727004051208496  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03926508128643036 |0.044383689761161804 |0.5981052219867706 |0.0001141279935836792 |0.9093174338340759 |0.016512155532836914 |
----------------------------------------------------------pseudo_mini_loss sum 4.388108730316162
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5317366
Number of first layer input nodes during this epoch:  2508969
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12440252304077148  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025667667388916016
random selection method range initialization spend 0.006119966506958008
time for parepare:  0.019707441329956055
local_output_nid generation:  0.0030689239501953125
local_in_edges_tensor generation:  0.008210897445678711
mini_batch_src_global generation:  0.0023064613342285156
r_  generation:  0.020847797393798828
local_output_nid generation:  0.003362417221069336
local_in_edges_tensor generation:  0.00191497802734375
mini_batch_src_global generation:  0.002594470977783203
r_  generation:  0.021528244018554688
local_output_nid generation:  0.003482818603515625
local_in_edges_tensor generation:  0.0017976760864257812
mini_batch_src_global generation:  0.0016465187072753906
r_  generation:  0.021759986877441406
local_output_nid generation:  0.003406524658203125
local_in_edges_tensor generation:  0.0017364025115966797
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.02196812629699707
local_output_nid generation:  0.0033745765686035156
local_in_edges_tensor generation:  0.0016617774963378906
mini_batch_src_global generation:  0.0017628669738769531
r_  generation:  0.022272348403930664
local_output_nid generation:  0.0034339427947998047
local_in_edges_tensor generation:  0.001935720443725586
mini_batch_src_global generation:  0.0017819404602050781
r_  generation:  0.02232813835144043
local_output_nid generation:  0.003393888473510742
local_in_edges_tensor generation:  0.001791238784790039
mini_batch_src_global generation:  0.0018153190612792969
r_  generation:  0.02291584014892578
local_output_nid generation:  0.003380298614501953
local_in_edges_tensor generation:  0.0017135143280029297
mini_batch_src_global generation:  0.0018422603607177734
r_  generation:  0.02251720428466797
local_output_nid generation:  0.00336456298828125
local_in_edges_tensor generation:  0.0016589164733886719
mini_batch_src_global generation:  0.0018658638000488281
r_  generation:  0.022854328155517578
local_output_nid generation:  0.003405332565307617
local_in_edges_tensor generation:  0.0017364025115966797
mini_batch_src_global generation:  0.0018124580383300781
r_  generation:  0.022789955139160156
local_output_nid generation:  0.0033707618713378906
local_in_edges_tensor generation:  0.0016491413116455078
mini_batch_src_global generation:  0.0019028186798095703
r_  generation:  0.02364635467529297
local_output_nid generation:  0.003365755081176758
local_in_edges_tensor generation:  0.0017554759979248047
mini_batch_src_global generation:  0.0019943714141845703
r_  generation:  0.024280786514282227
local_output_nid generation:  0.0033893585205078125
local_in_edges_tensor generation:  0.0016956329345703125
mini_batch_src_global generation:  0.0019125938415527344
r_  generation:  0.023304224014282227
local_output_nid generation:  0.003450632095336914
local_in_edges_tensor generation:  0.0016770362854003906
mini_batch_src_global generation:  0.001821756362915039
r_  generation:  0.023212909698486328
local_output_nid generation:  0.0034437179565429688
local_in_edges_tensor generation:  0.0017211437225341797
mini_batch_src_global generation:  0.0019333362579345703
r_  generation:  0.02335667610168457
local_output_nid generation:  0.003370523452758789
local_in_edges_tensor generation:  0.0017499923706054688
mini_batch_src_global generation:  0.001920461654663086
r_  generation:  0.022896766662597656
----------------------check_connections_block total spend ----------------------------- 0.5974209308624268
generate_one_block  0.04600095748901367
generate_one_block  0.037568092346191406
generate_one_block  0.037229061126708984
generate_one_block  0.03826618194580078
generate_one_block  0.038130998611450195
generate_one_block  0.04111933708190918
generate_one_block  0.03977704048156738
generate_one_block  0.03779292106628418
generate_one_block  0.03882646560668945
generate_one_block  0.037973642349243164
generate_one_block  0.03986215591430664
generate_one_block  0.04083871841430664
generate_one_block  0.03825712203979492
generate_one_block  0.03821420669555664
generate_one_block  0.039168596267700195
generate_one_block  0.038848161697387695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041200876235961914
gen group dst list time:  0.019692420959472656
time for parepare:  0.01985335350036621
local_output_nid generation:  0.010577917098999023
local_in_edges_tensor generation:  0.02574777603149414
mini_batch_src_global generation:  0.025615692138671875
r_  generation:  0.25687289237976074
local_output_nid generation:  0.013924360275268555
local_in_edges_tensor generation:  0.02357959747314453
mini_batch_src_global generation:  0.03236961364746094
r_  generation:  0.2630584239959717
local_output_nid generation:  0.013927221298217773
local_in_edges_tensor generation:  0.021618127822875977
mini_batch_src_global generation:  0.031446218490600586
r_  generation:  0.2650749683380127
local_output_nid generation:  0.014895439147949219
local_in_edges_tensor generation:  0.01944708824157715
mini_batch_src_global generation:  0.03338193893432617
r_  generation:  0.28055357933044434
local_output_nid generation:  0.014325380325317383
local_in_edges_tensor generation:  0.019450902938842773
mini_batch_src_global generation:  0.036683082580566406
r_  generation:  0.28195881843566895
local_output_nid generation:  0.014064550399780273
local_in_edges_tensor generation:  0.017037630081176758
mini_batch_src_global generation:  0.03513693809509277
r_  generation:  0.2844700813293457
local_output_nid generation:  0.013820409774780273
local_in_edges_tensor generation:  0.018843650817871094
mini_batch_src_global generation:  0.036557912826538086
r_  generation:  0.28528904914855957
local_output_nid generation:  0.013649940490722656
local_in_edges_tensor generation:  0.014808893203735352
mini_batch_src_global generation:  0.034995079040527344
r_  generation:  0.27817296981811523
local_output_nid generation:  0.013771295547485352
local_in_edges_tensor generation:  0.019196748733520508
mini_batch_src_global generation:  0.03663778305053711
r_  generation:  0.2831084728240967
local_output_nid generation:  0.013751506805419922
local_in_edges_tensor generation:  0.01449894905090332
mini_batch_src_global generation:  0.03647208213806152
r_  generation:  0.2797236442565918
local_output_nid generation:  0.014030218124389648
local_in_edges_tensor generation:  0.0174713134765625
mini_batch_src_global generation:  0.03775954246520996
r_  generation:  0.2908024787902832
local_output_nid generation:  0.01440572738647461
local_in_edges_tensor generation:  0.019715309143066406
mini_batch_src_global generation:  0.036618947982788086
r_  generation:  0.2930309772491455
local_output_nid generation:  0.013903379440307617
local_in_edges_tensor generation:  0.01700615882873535
mini_batch_src_global generation:  0.036287546157836914
r_  generation:  0.28490567207336426
local_output_nid generation:  0.013910770416259766
local_in_edges_tensor generation:  0.016760826110839844
mini_batch_src_global generation:  0.0355224609375
r_  generation:  0.28067779541015625
local_output_nid generation:  0.0140380859375
local_in_edges_tensor generation:  0.019611835479736328
mini_batch_src_global generation:  0.03773331642150879
r_  generation:  0.2862250804901123
local_output_nid generation:  0.01373434066772461
local_in_edges_tensor generation:  0.016770601272583008
mini_batch_src_global generation:  0.0360112190246582
r_  generation:  0.2833850383758545
----------------------check_connections_block total spend ----------------------------- 6.512946128845215
generate_one_block  0.37963438034057617
generate_one_block  0.37477540969848633
generate_one_block  0.37416672706604004
generate_one_block  0.3899867534637451
generate_one_block  0.38791680335998535
generate_one_block  0.38624024391174316
generate_one_block  0.4141809940338135
generate_one_block  0.37535977363586426
generate_one_block  0.38530707359313965
generate_one_block  0.3802611827850342
generate_one_block  0.3966684341430664
generate_one_block  0.40042638778686523
generate_one_block  0.3798792362213135
generate_one_block  0.3770151138305664
generate_one_block  0.3876488208770752
generate_one_block  0.3814198970794678
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036249399185180664
gen group dst list time:  0.07996988296508789
time for parepare:  0.022611141204833984
local_output_nid generation:  0.03764820098876953
local_in_edges_tensor generation:  0.04541516304016113
mini_batch_src_global generation:  0.04909372329711914
r_  generation:  0.5181000232696533
local_output_nid generation:  0.038370370864868164
local_in_edges_tensor generation:  0.06051898002624512
mini_batch_src_global generation:  0.0637979507446289
r_  generation:  0.5274503231048584
local_output_nid generation:  0.04195761680603027
local_in_edges_tensor generation:  0.04669904708862305
mini_batch_src_global generation:  0.06788754463195801
r_  generation:  0.517686128616333
local_output_nid generation:  0.03928184509277344
local_in_edges_tensor generation:  0.041985511779785156
mini_batch_src_global generation:  0.057875871658325195
r_  generation:  0.5106534957885742
local_output_nid generation:  0.0386815071105957
local_in_edges_tensor generation:  0.1075601577758789
mini_batch_src_global generation:  0.0619359016418457
r_  generation:  0.5206449031829834
local_output_nid generation:  0.04037213325500488
local_in_edges_tensor generation:  0.03643965721130371
mini_batch_src_global generation:  0.060172080993652344
r_  generation:  0.5117731094360352
local_output_nid generation:  0.03722357749938965
local_in_edges_tensor generation:  0.034796714782714844
mini_batch_src_global generation:  0.06201004981994629
r_  generation:  0.5349109172821045
local_output_nid generation:  0.037470340728759766
local_in_edges_tensor generation:  0.0325770378112793
mini_batch_src_global generation:  0.06157708168029785
r_  generation:  0.519329309463501
local_output_nid generation:  0.03920173645019531
local_in_edges_tensor generation:  0.04941892623901367
mini_batch_src_global generation:  0.06297874450683594
r_  generation:  0.5251221656799316
local_output_nid generation:  0.04259443283081055
local_in_edges_tensor generation:  0.03891158103942871
mini_batch_src_global generation:  0.05806231498718262
r_  generation:  0.4937429428100586
local_output_nid generation:  0.03876495361328125
local_in_edges_tensor generation:  0.0345914363861084
mini_batch_src_global generation:  0.06367611885070801
r_  generation:  0.49695348739624023
local_output_nid generation:  0.03869366645812988
local_in_edges_tensor generation:  0.03517436981201172
mini_batch_src_global generation:  0.06126260757446289
r_  generation:  0.5077223777770996
local_output_nid generation:  0.03922748565673828
local_in_edges_tensor generation:  0.03522372245788574
mini_batch_src_global generation:  0.058252811431884766
r_  generation:  0.5183656215667725
local_output_nid generation:  0.03872060775756836
local_in_edges_tensor generation:  0.03783464431762695
mini_batch_src_global generation:  0.05797219276428223
r_  generation:  0.49720311164855957
local_output_nid generation:  0.03851890563964844
local_in_edges_tensor generation:  0.0373990535736084
mini_batch_src_global generation:  0.05713963508605957
r_  generation:  0.5028030872344971
local_output_nid generation:  0.03874969482421875
local_in_edges_tensor generation:  0.030631542205810547
mini_batch_src_global generation:  0.05756664276123047
r_  generation:  0.49619293212890625
----------------------check_connections_block total spend ----------------------------- 12.376535892486572
generate_one_block  0.6722440719604492
generate_one_block  0.6593234539031982
generate_one_block  0.6566300392150879
generate_one_block  0.652653694152832
generate_one_block  0.6519243717193604
generate_one_block  0.6424517631530762
generate_one_block  0.6323003768920898
generate_one_block  0.6456778049468994
generate_one_block  0.68398118019104
generate_one_block  0.6709964275360107
generate_one_block  0.6604862213134766
generate_one_block  0.653346061706543
generate_one_block  0.6461637020111084
generate_one_block  0.6337552070617676
generate_one_block  0.6415407657623291
generate_one_block  0.6367752552032471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12440252304077148  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

connection checking time:  18.889482021331787
block generation total time  16.611137628555298
average batch blocks generation time:  1.0381961017847061
block dataloader generation time/epoch 38.377784967422485
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09643745422363281  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156719, 128])
torch.Size([129795, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.708234310150146  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09648847579956055  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156907, 128])
torch.Size([129599, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.681187152862549  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09639549255371094  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156774, 128])
torch.Size([129785, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.684346675872803  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09686803817749023  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([157267, 128])
torch.Size([130643, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.772315502166748  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09660005569458008  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156721, 128])
torch.Size([129593, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.743141651153564  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09660196304321289  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156715, 128])
torch.Size([129759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.721005916595459  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0964961051940918  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156465, 128])
torch.Size([129374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.71900224685669  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09651517868041992  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156767, 128])
torch.Size([129712, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.711352348327637  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09666872024536133  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156871, 128])
torch.Size([129884, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.746137142181396  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09650373458862305  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156761, 128])
torch.Size([129755, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.71157693862915  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09680461883544922  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156830, 128])
torch.Size([130221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.794293403625488  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09691905975341797  GigaBytes
Max Memory Allocated: 12.816417217254639  GigaBytes

torch.Size([156928, 128])
torch.Size([130627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.81922435760498  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09671640396118164  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

torch.Size([156993, 128])
torch.Size([130375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.749811172485352  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09659290313720703  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

torch.Size([156944, 128])
torch.Size([129673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.714850425720215  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09670162200927734  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

torch.Size([156876, 128])
torch.Size([129593, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.740272521972656  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09641075134277344  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

torch.Size([156352, 128])
torch.Size([129408, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 12.709351062774658  GigaBytes
Max Memory Allocated: 12.827655792236328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03530670702457428 |0.022493422031402588 |0.5504648983478546 |0.00010187923908233643 |0.8708339482545853 |0.005620479583740234 |
----------------------------------------------------------pseudo_mini_loss sum 3.6974549293518066
Total (block generation + training)time/epoch 62.08589053153992
Training time/epoch 23.707858324050903
Training time without block to device /epoch 23.347963571548462
Training time without total dataloading part /epoch 22.748032093048096
load block tensor time/epoch 0.5649073123931885
block to device time/epoch 0.3598947525024414
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5316967
Number of first layer input nodes during this epoch:  2508890
