Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648501028.5384126
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024143218994140625
random selection method range initialization spend 0.0063934326171875
time for parepare:  0.01858687400817871
local_output_nid generation:  0.002146482467651367
local_in_edges_tensor generation:  0.004703998565673828
mini_batch_src_global generation:  0.0017552375793457031
r_  generation:  0.017911911010742188
local_output_nid generation:  0.0025262832641601562
local_in_edges_tensor generation:  0.0016803741455078125
mini_batch_src_global generation:  0.002241849899291992
r_  generation:  0.017897367477416992
local_output_nid generation:  0.0027801990509033203
local_in_edges_tensor generation:  0.0015871524810791016
mini_batch_src_global generation:  0.0013453960418701172
r_  generation:  0.017780542373657227
local_output_nid generation:  0.0028166770935058594
local_in_edges_tensor generation:  0.0016567707061767578
mini_batch_src_global generation:  0.0013799667358398438
r_  generation:  0.017885446548461914
local_output_nid generation:  0.0027892589569091797
local_in_edges_tensor generation:  0.0015451908111572266
mini_batch_src_global generation:  0.0014295578002929688
r_  generation:  0.01824784278869629
local_output_nid generation:  0.0028252601623535156
local_in_edges_tensor generation:  0.001519918441772461
mini_batch_src_global generation:  0.001436471939086914
r_  generation:  0.01873469352722168
local_output_nid generation:  0.0027806758880615234
local_in_edges_tensor generation:  0.0014646053314208984
mini_batch_src_global generation:  0.0014755725860595703
r_  generation:  0.0184628963470459
local_output_nid generation:  0.0028405189514160156
local_in_edges_tensor generation:  0.0014591217041015625
mini_batch_src_global generation:  0.0014407634735107422
r_  generation:  0.018153667449951172
local_output_nid generation:  0.002883434295654297
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0013713836669921875
r_  generation:  0.01865530014038086
local_output_nid generation:  0.0028624534606933594
local_in_edges_tensor generation:  0.0015003681182861328
mini_batch_src_global generation:  0.0015087127685546875
r_  generation:  0.01926898956298828
local_output_nid generation:  0.0028400421142578125
local_in_edges_tensor generation:  0.0014646053314208984
mini_batch_src_global generation:  0.0015757083892822266
r_  generation:  0.019906282424926758
local_output_nid generation:  0.0028624534606933594
local_in_edges_tensor generation:  0.0015294551849365234
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.018549680709838867
local_output_nid generation:  0.0029151439666748047
local_in_edges_tensor generation:  0.0015027523040771484
mini_batch_src_global generation:  0.0015475749969482422
r_  generation:  0.01871490478515625
local_output_nid generation:  0.0028533935546875
local_in_edges_tensor generation:  0.0015370845794677734
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.019243717193603516
local_output_nid generation:  0.0028798580169677734
local_in_edges_tensor generation:  0.0014829635620117188
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.01898813247680664
local_output_nid generation:  0.0028533935546875
local_in_edges_tensor generation:  0.001458883285522461
mini_batch_src_global generation:  0.0015232563018798828
r_  generation:  0.018764972686767578
----------------------check_connections_block total spend ----------------------------- 0.48922109603881836
generate_one_block  0.027098417282104492
generate_one_block  0.028029680252075195
generate_one_block  0.02786731719970703
generate_one_block  0.030407190322875977
generate_one_block  0.02830672264099121
generate_one_block  0.027985095977783203
generate_one_block  0.0273745059967041
generate_one_block  0.026818513870239258
generate_one_block  0.02736949920654297
generate_one_block  0.02799701690673828
generate_one_block  0.028288841247558594
generate_one_block  0.026899337768554688
generate_one_block  0.027236461639404297
generate_one_block  0.027500391006469727
generate_one_block  0.027480602264404297
generate_one_block  0.026361465454101562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04159426689147949
gen group dst list time:  0.01848769187927246
time for parepare:  0.018817663192749023
local_output_nid generation:  0.008055925369262695
local_in_edges_tensor generation:  0.017592906951904297
mini_batch_src_global generation:  0.01912832260131836
r_  generation:  0.1955258846282959
local_output_nid generation:  0.012157440185546875
local_in_edges_tensor generation:  0.019548892974853516
mini_batch_src_global generation:  0.02487969398498535
r_  generation:  0.20728182792663574
local_output_nid generation:  0.011781454086303711
local_in_edges_tensor generation:  0.01656365394592285
mini_batch_src_global generation:  0.024366140365600586
r_  generation:  0.2091658115386963
local_output_nid generation:  0.01167917251586914
local_in_edges_tensor generation:  0.012737751007080078
mini_batch_src_global generation:  0.025434494018554688
r_  generation:  0.21315693855285645
local_output_nid generation:  0.011874675750732422
local_in_edges_tensor generation:  0.01612401008605957
mini_batch_src_global generation:  0.027764558792114258
r_  generation:  0.21291494369506836
local_output_nid generation:  0.011864185333251953
local_in_edges_tensor generation:  0.014267444610595703
mini_batch_src_global generation:  0.026880979537963867
r_  generation:  0.21908998489379883
local_output_nid generation:  0.011803150177001953
local_in_edges_tensor generation:  0.01239323616027832
mini_batch_src_global generation:  0.02687239646911621
r_  generation:  0.21745848655700684
local_output_nid generation:  0.011796951293945312
local_in_edges_tensor generation:  0.014087677001953125
mini_batch_src_global generation:  0.02685689926147461
r_  generation:  0.21269702911376953
local_output_nid generation:  0.01186990737915039
local_in_edges_tensor generation:  0.016469478607177734
mini_batch_src_global generation:  0.026846647262573242
r_  generation:  0.22056961059570312
local_output_nid generation:  0.012038469314575195
local_in_edges_tensor generation:  0.02010035514831543
mini_batch_src_global generation:  0.027440786361694336
r_  generation:  0.21964049339294434
local_output_nid generation:  0.011971235275268555
local_in_edges_tensor generation:  0.01446080207824707
mini_batch_src_global generation:  0.027558565139770508
r_  generation:  0.22530031204223633
local_output_nid generation:  0.015127420425415039
local_in_edges_tensor generation:  0.012651443481445312
mini_batch_src_global generation:  0.02767634391784668
r_  generation:  0.2153606414794922
local_output_nid generation:  0.011832237243652344
local_in_edges_tensor generation:  0.014059305191040039
mini_batch_src_global generation:  0.02672100067138672
r_  generation:  0.21630430221557617
local_output_nid generation:  0.011902570724487305
local_in_edges_tensor generation:  0.014152050018310547
mini_batch_src_global generation:  0.027280807495117188
r_  generation:  0.21815919876098633
local_output_nid generation:  0.011829614639282227
local_in_edges_tensor generation:  0.017976045608520508
mini_batch_src_global generation:  0.027258634567260742
r_  generation:  0.21840143203735352
local_output_nid generation:  0.011539459228515625
local_in_edges_tensor generation:  0.012287616729736328
mini_batch_src_global generation:  0.027124404907226562
r_  generation:  0.21298575401306152
----------------------check_connections_block total spend ----------------------------- 5.060421466827393
generate_one_block  0.28233957290649414
generate_one_block  0.2785770893096924
generate_one_block  0.28893375396728516
generate_one_block  0.27302026748657227
generate_one_block  0.2999296188354492
generate_one_block  0.2867302894592285
generate_one_block  0.27358412742614746
generate_one_block  0.27392125129699707
generate_one_block  0.2810945510864258
generate_one_block  0.2901782989501953
generate_one_block  0.2906038761138916
generate_one_block  0.27798032760620117
generate_one_block  0.27236270904541016
generate_one_block  0.2740323543548584
generate_one_block  0.2838571071624756
generate_one_block  0.26751160621643066
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.044060707092285156
gen group dst list time:  0.060153961181640625
time for parepare:  0.019054412841796875
local_output_nid generation:  0.025609970092773438
local_in_edges_tensor generation:  0.039031982421875
mini_batch_src_global generation:  0.04971146583557129
r_  generation:  0.4819502830505371
local_output_nid generation:  0.03204083442687988
local_in_edges_tensor generation:  0.051473379135131836
mini_batch_src_global generation:  0.06359243392944336
r_  generation:  0.4982759952545166
local_output_nid generation:  0.03190016746520996
local_in_edges_tensor generation:  0.047501564025878906
mini_batch_src_global generation:  0.05692696571350098
r_  generation:  0.5050065517425537
local_output_nid generation:  0.03139638900756836
local_in_edges_tensor generation:  0.059761762619018555
mini_batch_src_global generation:  0.058415889739990234
r_  generation:  0.51997971534729
local_output_nid generation:  0.031484365463256836
local_in_edges_tensor generation:  0.037030696868896484
mini_batch_src_global generation:  0.05865907669067383
r_  generation:  0.5028986930847168
local_output_nid generation:  0.03189563751220703
local_in_edges_tensor generation:  0.03510165214538574
mini_batch_src_global generation:  0.059123992919921875
r_  generation:  0.5027871131896973
local_output_nid generation:  0.03199601173400879
local_in_edges_tensor generation:  0.04016280174255371
mini_batch_src_global generation:  0.0587306022644043
r_  generation:  0.5129470825195312
local_output_nid generation:  0.03379988670349121
local_in_edges_tensor generation:  0.03134417533874512
mini_batch_src_global generation:  0.05988049507141113
r_  generation:  0.5044941902160645
local_output_nid generation:  0.03158926963806152
local_in_edges_tensor generation:  0.03924679756164551
mini_batch_src_global generation:  0.058779001235961914
r_  generation:  0.5043747425079346
local_output_nid generation:  0.0315854549407959
local_in_edges_tensor generation:  0.042633771896362305
mini_batch_src_global generation:  0.05946826934814453
r_  generation:  0.5046865940093994
local_output_nid generation:  0.0321195125579834
local_in_edges_tensor generation:  0.043778419494628906
mini_batch_src_global generation:  0.05843615531921387
r_  generation:  0.5083646774291992
local_output_nid generation:  0.031630754470825195
local_in_edges_tensor generation:  0.030413389205932617
mini_batch_src_global generation:  0.05905508995056152
r_  generation:  0.501291036605835
local_output_nid generation:  0.03157520294189453
local_in_edges_tensor generation:  0.031120777130126953
mini_batch_src_global generation:  0.060350894927978516
r_  generation:  0.5072083473205566
local_output_nid generation:  0.03164815902709961
local_in_edges_tensor generation:  0.03841233253479004
mini_batch_src_global generation:  0.05953264236450195
r_  generation:  0.49974584579467773
local_output_nid generation:  0.03165721893310547
local_in_edges_tensor generation:  0.03535032272338867
mini_batch_src_global generation:  0.05837583541870117
r_  generation:  0.517932653427124
local_output_nid generation:  0.03164863586425781
local_in_edges_tensor generation:  0.0295257568359375
mini_batch_src_global generation:  0.05984687805175781
r_  generation:  0.5040130615234375
----------------------check_connections_block total spend ----------------------------- 11.880718469619751
generate_one_block  0.6493122577667236
generate_one_block  0.6546707153320312
generate_one_block  0.6604068279266357
generate_one_block  0.6396889686584473
generate_one_block  0.6351020336151123
generate_one_block  0.6521503925323486
generate_one_block  0.7427718639373779
generate_one_block  0.6587722301483154
generate_one_block  0.6588056087493896
generate_one_block  0.6538388729095459
generate_one_block  0.6608080863952637
generate_one_block  0.6387641429901123
generate_one_block  0.6562435626983643
generate_one_block  0.6431596279144287
generate_one_block  0.6615049839019775
generate_one_block  0.6369540691375732
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07410001754760742
gen group dst list time:  0.09743356704711914
time for parepare:  0.02013254165649414
local_output_nid generation:  0.03460860252380371
local_in_edges_tensor generation:  0.06178116798400879
mini_batch_src_global generation:  0.048834800720214844
r_  generation:  0.5267760753631592
local_output_nid generation:  0.03888702392578125
local_in_edges_tensor generation:  0.057804107666015625
mini_batch_src_global generation:  0.0611119270324707
r_  generation:  0.5281519889831543
local_output_nid generation:  0.03802800178527832
local_in_edges_tensor generation:  0.052908897399902344
mini_batch_src_global generation:  0.05763053894042969
r_  generation:  0.5450258255004883
local_output_nid generation:  0.03800177574157715
local_in_edges_tensor generation:  0.04808449745178223
mini_batch_src_global generation:  0.05738401412963867
r_  generation:  0.5392532348632812
local_output_nid generation:  0.037713050842285156
local_in_edges_tensor generation:  0.038564443588256836
mini_batch_src_global generation:  0.05814552307128906
r_  generation:  0.541388988494873
local_output_nid generation:  0.0379180908203125
local_in_edges_tensor generation:  0.043151140213012695
mini_batch_src_global generation:  0.05743074417114258
r_  generation:  0.5444133281707764
local_output_nid generation:  0.038010597229003906
local_in_edges_tensor generation:  0.0428011417388916
mini_batch_src_global generation:  0.061811208724975586
r_  generation:  0.544231653213501
local_output_nid generation:  0.03788471221923828
local_in_edges_tensor generation:  0.03874492645263672
mini_batch_src_global generation:  0.05864214897155762
r_  generation:  0.5466747283935547
local_output_nid generation:  0.03787994384765625
local_in_edges_tensor generation:  0.03800010681152344
mini_batch_src_global generation:  0.05938243865966797
r_  generation:  0.5492556095123291
local_output_nid generation:  0.03800082206726074
local_in_edges_tensor generation:  0.052387237548828125
mini_batch_src_global generation:  0.06052422523498535
r_  generation:  0.5521490573883057
local_output_nid generation:  0.037863731384277344
local_in_edges_tensor generation:  0.042791128158569336
mini_batch_src_global generation:  0.05972933769226074
r_  generation:  0.5533332824707031
local_output_nid generation:  0.04891514778137207
local_in_edges_tensor generation:  0.04245305061340332
mini_batch_src_global generation:  0.06318330764770508
r_  generation:  0.5527358055114746
local_output_nid generation:  0.037766456604003906
local_in_edges_tensor generation:  0.03876304626464844
mini_batch_src_global generation:  0.05926322937011719
r_  generation:  0.5553486347198486
local_output_nid generation:  0.03811478614807129
local_in_edges_tensor generation:  0.03788042068481445
mini_batch_src_global generation:  0.060362815856933594
r_  generation:  0.5528731346130371
local_output_nid generation:  0.03803586959838867
local_in_edges_tensor generation:  0.05221128463745117
mini_batch_src_global generation:  0.06046032905578613
r_  generation:  0.558866024017334
local_output_nid generation:  0.0378875732421875
local_in_edges_tensor generation:  0.03823971748352051
mini_batch_src_global generation:  0.06043243408203125
r_  generation:  0.5512807369232178
----------------------check_connections_block total spend ----------------------------- 13.074777841567993
generate_one_block  0.6917200088500977
generate_one_block  0.684727668762207
generate_one_block  0.7439010143280029
generate_one_block  0.682431697845459
generate_one_block  0.6605789661407471
generate_one_block  0.6657781600952148
generate_one_block  0.6757957935333252
generate_one_block  0.6622745990753174
generate_one_block  0.6723496913909912
generate_one_block  0.6881601810455322
generate_one_block  0.6719379425048828
generate_one_block  0.6833531856536865
generate_one_block  0.6654555797576904
generate_one_block  0.6822948455810547
generate_one_block  0.664099931716919
generate_one_block  0.6612241268157959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03614616394042969
gen group dst list time:  0.09694886207580566
time for parepare:  0.018927574157714844
local_output_nid generation:  0.0356900691986084
local_in_edges_tensor generation:  0.04487299919128418
mini_batch_src_global generation:  0.04474067687988281
r_  generation:  0.4971473217010498
local_output_nid generation:  0.04207658767700195
local_in_edges_tensor generation:  0.04522109031677246
mini_batch_src_global generation:  0.057677507400512695
r_  generation:  0.5047123432159424
local_output_nid generation:  0.03960847854614258
local_in_edges_tensor generation:  0.04773402214050293
mini_batch_src_global generation:  0.06214642524719238
r_  generation:  0.5014371871948242
local_output_nid generation:  0.03940105438232422
local_in_edges_tensor generation:  0.045198917388916016
mini_batch_src_global generation:  0.057500362396240234
r_  generation:  0.5008871555328369
local_output_nid generation:  0.03958630561828613
local_in_edges_tensor generation:  0.036357879638671875
mini_batch_src_global generation:  0.057984113693237305
r_  generation:  0.505246639251709
local_output_nid generation:  0.043253183364868164
local_in_edges_tensor generation:  0.0448606014251709
mini_batch_src_global generation:  0.05736207962036133
r_  generation:  0.5085544586181641
local_output_nid generation:  0.03927159309387207
local_in_edges_tensor generation:  0.0401458740234375
mini_batch_src_global generation:  0.06020665168762207
r_  generation:  0.5096499919891357
local_output_nid generation:  0.03950309753417969
local_in_edges_tensor generation:  0.044725894927978516
mini_batch_src_global generation:  0.05678248405456543
r_  generation:  0.511282205581665
local_output_nid generation:  0.03977394104003906
local_in_edges_tensor generation:  0.03656959533691406
mini_batch_src_global generation:  0.057747602462768555
r_  generation:  0.5137779712677002
local_output_nid generation:  0.03997659683227539
local_in_edges_tensor generation:  0.03893113136291504
mini_batch_src_global generation:  0.05687212944030762
r_  generation:  0.5153903961181641
local_output_nid generation:  0.039980411529541016
local_in_edges_tensor generation:  0.04983019828796387
mini_batch_src_global generation:  0.05603814125061035
r_  generation:  0.5136535167694092
local_output_nid generation:  0.039566993713378906
local_in_edges_tensor generation:  0.03690958023071289
mini_batch_src_global generation:  0.05679631233215332
r_  generation:  0.5177931785583496
local_output_nid generation:  0.03951835632324219
local_in_edges_tensor generation:  0.043161869049072266
mini_batch_src_global generation:  0.05645346641540527
r_  generation:  0.5146510601043701
local_output_nid generation:  0.03914666175842285
local_in_edges_tensor generation:  0.04979562759399414
mini_batch_src_global generation:  0.059822797775268555
r_  generation:  0.5169694423675537
local_output_nid generation:  0.04015970230102539
local_in_edges_tensor generation:  0.03715348243713379
mini_batch_src_global generation:  0.05685567855834961
r_  generation:  0.5183205604553223
local_output_nid generation:  0.03974318504333496
local_in_edges_tensor generation:  0.037069082260131836
mini_batch_src_global generation:  0.05662655830383301
r_  generation:  0.5247089862823486
----------------------check_connections_block total spend ----------------------------- 12.342575788497925
generate_one_block  0.6424353122711182
generate_one_block  0.6424531936645508
generate_one_block  0.6366794109344482
generate_one_block  0.6506400108337402
generate_one_block  0.6276202201843262
generate_one_block  0.7082335948944092
generate_one_block  0.6353790760040283
generate_one_block  0.6424567699432373
generate_one_block  0.6272392272949219
generate_one_block  0.6324377059936523
generate_one_block  0.6446342468261719
generate_one_block  0.6257591247558594
generate_one_block  0.6310362815856934
generate_one_block  0.6458814144134521
generate_one_block  0.6252570152282715
generate_one_block  0.6276533603668213
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

connection checking time:  42.35849356651306
block generation total time  36.09949040412903
average batch blocks generation time:  2.2562181502580643
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12225961685180664  GigaBytes
Max Memory Allocated: 0.12225961685180664  GigaBytes

torch.Size([166293, 128])
torch.Size([163950, 32])
torch.Size([155583, 32])
torch.Size([123360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7283935546875 GB
    Memory Allocated: 19.441728115081787  GigaBytes
Max Memory Allocated: 19.44788932800293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6932373046875 GB
    Memory Allocated: 0.12367820739746094  GigaBytes
Max Memory Allocated: 19.44788932800293  GigaBytes

torch.Size([166278, 128])
torch.Size([163993, 32])
torch.Size([156043, 32])
torch.Size([123957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7069091796875 GB
    Memory Allocated: 19.47732973098755  GigaBytes
Max Memory Allocated: 19.484410762786865  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7069091796875 GB
    Memory Allocated: 0.1244955062866211  GigaBytes
Max Memory Allocated: 19.484410762786865  GigaBytes

torch.Size([166401, 128])
torch.Size([164126, 32])
torch.Size([155940, 32])
torch.Size([124219, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.493266582489014  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.12370014190673828  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166345, 128])
torch.Size([164082, 32])
torch.Size([155970, 32])
torch.Size([123632, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.464701175689697  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.1244359016418457  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166328, 128])
torch.Size([164000, 32])
torch.Size([155786, 32])
torch.Size([123519, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.472923278808594  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.12369728088378906  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166312, 128])
torch.Size([163915, 32])
torch.Size([155739, 32])
torch.Size([123853, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.47748851776123  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.12446737289428711  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166320, 128])
torch.Size([163975, 32])
torch.Size([155888, 32])
torch.Size([123901, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.472667694091797  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.12366390228271484  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166318, 128])
torch.Size([163905, 32])
torch.Size([155536, 32])
torch.Size([123235, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.440285205841064  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.12448453903198242  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166257, 128])
torch.Size([163922, 32])
torch.Size([155870, 32])
torch.Size([124125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 19.480067253112793  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7108154296875 GB
    Memory Allocated: 0.12370443344116211  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166296, 128])
torch.Size([163916, 32])
torch.Size([155757, 32])
torch.Size([123782, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.490858554840088  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.1244964599609375  GigaBytes
Max Memory Allocated: 19.50031614303589  GigaBytes

torch.Size([166312, 128])
torch.Size([163931, 32])
torch.Size([155734, 32])
torch.Size([124209, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.5097393989563  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12366247177124023  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166305, 128])
torch.Size([163993, 32])
torch.Size([155818, 32])
torch.Size([123337, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.461695194244385  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12442398071289062  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166228, 128])
torch.Size([163794, 32])
torch.Size([155453, 32])
torch.Size([123292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.44564437866211  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12371540069580078  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166372, 128])
torch.Size([164123, 32])
torch.Size([156154, 32])
torch.Size([124104, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.467172145843506  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12446022033691406  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166251, 128])
torch.Size([163865, 32])
torch.Size([155697, 32])
torch.Size([123824, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.486449241638184  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12351322174072266  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166170, 128])
torch.Size([163743, 32])
torch.Size([155242, 32])
torch.Size([122348, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.381789684295654  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04058635234832764 |0.0637550950050354 |0.5108661204576492 |0.00010320544242858887 |0.6471057534217834 |0.012367725372314453 |
----------------------------------------------------------pseudo_mini_loss sum 4.506190776824951
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10415794
Number of first layer input nodes during this epoch:  2660786
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.20114374160766602  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.026894807815551758
random selection method range initialization spend 0.005430936813354492
time for parepare:  0.020814180374145508
local_output_nid generation:  0.0035088062286376953
local_in_edges_tensor generation:  0.01040339469909668
mini_batch_src_global generation:  0.0024962425231933594
r_  generation:  0.01825571060180664
local_output_nid generation:  0.0035257339477539062
local_in_edges_tensor generation:  0.0019202232360839844
mini_batch_src_global generation:  0.0025424957275390625
r_  generation:  0.021291732788085938
local_output_nid generation:  0.003701448440551758
local_in_edges_tensor generation:  0.0018720626831054688
mini_batch_src_global generation:  0.0015926361083984375
r_  generation:  0.01853466033935547
local_output_nid generation:  0.0037140846252441406
local_in_edges_tensor generation:  0.0018739700317382812
mini_batch_src_global generation:  0.0016078948974609375
r_  generation:  0.018807172775268555
local_output_nid generation:  0.0036242008209228516
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.0015769004821777344
r_  generation:  0.0185697078704834
local_output_nid generation:  0.003634929656982422
local_in_edges_tensor generation:  0.0017595291137695312
mini_batch_src_global generation:  0.0016469955444335938
r_  generation:  0.01999068260192871
local_output_nid generation:  0.0036513805389404297
local_in_edges_tensor generation:  0.0018415451049804688
mini_batch_src_global generation:  0.0017275810241699219
r_  generation:  0.019960641860961914
local_output_nid generation:  0.003627777099609375
local_in_edges_tensor generation:  0.001870870590209961
mini_batch_src_global generation:  0.0016303062438964844
r_  generation:  0.01989603042602539
local_output_nid generation:  0.003679037094116211
local_in_edges_tensor generation:  0.002100229263305664
mini_batch_src_global generation:  0.00558161735534668
r_  generation:  0.024808883666992188
local_output_nid generation:  0.004653215408325195
local_in_edges_tensor generation:  0.002163410186767578
mini_batch_src_global generation:  0.0016405582427978516
r_  generation:  0.020176172256469727
local_output_nid generation:  0.004323005676269531
local_in_edges_tensor generation:  0.0018689632415771484
mini_batch_src_global generation:  0.0016357898712158203
r_  generation:  0.01986074447631836
local_output_nid generation:  0.004196643829345703
local_in_edges_tensor generation:  0.0018498897552490234
mini_batch_src_global generation:  0.004946231842041016
r_  generation:  0.020195484161376953
local_output_nid generation:  0.00401616096496582
local_in_edges_tensor generation:  0.0017390251159667969
mini_batch_src_global generation:  0.0016245841979980469
r_  generation:  0.020435571670532227
local_output_nid generation:  0.003974437713623047
local_in_edges_tensor generation:  0.001718282699584961
mini_batch_src_global generation:  0.0015790462493896484
r_  generation:  0.02038121223449707
local_output_nid generation:  0.003920078277587891
local_in_edges_tensor generation:  0.004225254058837891
mini_batch_src_global generation:  0.0016050338745117188
r_  generation:  0.01952672004699707
local_output_nid generation:  0.0038988590240478516
local_in_edges_tensor generation:  0.0016515254974365234
mini_batch_src_global generation:  0.0016326904296875
r_  generation:  0.023346900939941406
----------------------check_connections_block total spend ----------------------------- 0.5751407146453857
generate_one_block  0.04616212844848633
generate_one_block  0.03368043899536133
generate_one_block  0.032126665115356445
generate_one_block  0.034982919692993164
generate_one_block  0.03282952308654785
generate_one_block  0.03663825988769531
generate_one_block  0.03717327117919922
generate_one_block  0.0362699031829834
generate_one_block  0.03325343132019043
generate_one_block  0.03779768943786621
generate_one_block  0.039411067962646484
generate_one_block  0.0334169864654541
generate_one_block  0.034581661224365234
generate_one_block  0.032990217208862305
generate_one_block  0.03297686576843262
generate_one_block  0.035433053970336914
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04103589057922363
gen group dst list time:  0.020361661911010742
time for parepare:  0.0222475528717041
local_output_nid generation:  0.011430740356445312
local_in_edges_tensor generation:  0.02686762809753418
mini_batch_src_global generation:  0.020377635955810547
r_  generation:  0.19842314720153809
local_output_nid generation:  0.013840198516845703
local_in_edges_tensor generation:  0.02116870880126953
mini_batch_src_global generation:  0.0271756649017334
r_  generation:  0.2120976448059082
local_output_nid generation:  0.01659989356994629
local_in_edges_tensor generation:  0.018776655197143555
mini_batch_src_global generation:  0.023607730865478516
r_  generation:  0.2098548412322998
local_output_nid generation:  0.013688802719116211
local_in_edges_tensor generation:  0.017892122268676758
mini_batch_src_global generation:  0.02510213851928711
r_  generation:  0.21642065048217773
local_output_nid generation:  0.012979269027709961
local_in_edges_tensor generation:  0.01365041732788086
mini_batch_src_global generation:  0.0257112979888916
r_  generation:  0.2140178680419922
local_output_nid generation:  0.013560295104980469
local_in_edges_tensor generation:  0.015941858291625977
mini_batch_src_global generation:  0.02842545509338379
r_  generation:  0.2250511646270752
local_output_nid generation:  0.013937950134277344
local_in_edges_tensor generation:  0.019462108612060547
mini_batch_src_global generation:  0.02708888053894043
r_  generation:  0.2253282070159912
local_output_nid generation:  0.013939142227172852
local_in_edges_tensor generation:  0.013826847076416016
mini_batch_src_global generation:  0.029910802841186523
r_  generation:  0.22209525108337402
local_output_nid generation:  0.014168262481689453
local_in_edges_tensor generation:  0.01602649688720703
mini_batch_src_global generation:  0.02865123748779297
r_  generation:  0.22484660148620605
local_output_nid generation:  0.013838768005371094
local_in_edges_tensor generation:  0.015280723571777344
mini_batch_src_global generation:  0.027230501174926758
r_  generation:  0.22780966758728027
local_output_nid generation:  0.01367807388305664
local_in_edges_tensor generation:  0.01371908187866211
mini_batch_src_global generation:  0.027357816696166992
r_  generation:  0.2228221893310547
local_output_nid generation:  0.01398158073425293
local_in_edges_tensor generation:  0.015538215637207031
mini_batch_src_global generation:  0.02730584144592285
r_  generation:  0.22423386573791504
local_output_nid generation:  0.013583898544311523
local_in_edges_tensor generation:  0.01927804946899414
mini_batch_src_global generation:  0.027587175369262695
r_  generation:  0.22617363929748535
local_output_nid generation:  0.012972116470336914
local_in_edges_tensor generation:  0.01385807991027832
mini_batch_src_global generation:  0.027701139450073242
r_  generation:  0.22336125373840332
local_output_nid generation:  0.013001680374145508
local_in_edges_tensor generation:  0.013564825057983398
mini_batch_src_global generation:  0.03024911880493164
r_  generation:  0.23482608795166016
local_output_nid generation:  0.014234542846679688
local_in_edges_tensor generation:  0.02656078338623047
mini_batch_src_global generation:  0.03121161460876465
r_  generation:  0.23168516159057617
----------------------check_connections_block total spend ----------------------------- 5.282300710678101
generate_one_block  0.3068094253540039
generate_one_block  0.30263376235961914
generate_one_block  0.29550838470458984
generate_one_block  0.31105566024780273
generate_one_block  0.28647422790527344
generate_one_block  0.2995750904083252
generate_one_block  0.3288605213165283
generate_one_block  0.29347944259643555
generate_one_block  0.29848146438598633
generate_one_block  0.2964301109313965
generate_one_block  0.29439735412597656
generate_one_block  0.3229401111602783
generate_one_block  0.3115394115447998
generate_one_block  0.31382250785827637
generate_one_block  0.29417967796325684
generate_one_block  0.30065250396728516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06895160675048828
gen group dst list time:  0.0687720775604248
time for parepare:  0.01837897300720215
local_output_nid generation:  0.028885602951049805
local_in_edges_tensor generation:  0.05383491516113281
mini_batch_src_global generation:  0.051122188568115234
r_  generation:  0.5090982913970947
local_output_nid generation:  0.0324244499206543
local_in_edges_tensor generation:  0.050763845443725586
mini_batch_src_global generation:  0.058257102966308594
r_  generation:  0.5064697265625
local_output_nid generation:  0.03181767463684082
local_in_edges_tensor generation:  0.0430147647857666
mini_batch_src_global generation:  0.05762648582458496
r_  generation:  0.5109498500823975
local_output_nid generation:  0.032268524169921875
local_in_edges_tensor generation:  0.0367431640625
mini_batch_src_global generation:  0.062207698822021484
r_  generation:  0.516160249710083
local_output_nid generation:  0.03615832328796387
local_in_edges_tensor generation:  0.08602643013000488
mini_batch_src_global generation:  0.05928397178649902
r_  generation:  0.5570738315582275
local_output_nid generation:  0.036454200744628906
local_in_edges_tensor generation:  0.04822111129760742
mini_batch_src_global generation:  0.06478047370910645
r_  generation:  0.5228650569915771
local_output_nid generation:  0.03356599807739258
local_in_edges_tensor generation:  0.046239376068115234
mini_batch_src_global generation:  0.05844902992248535
r_  generation:  0.5156064033508301
local_output_nid generation:  0.03267788887023926
local_in_edges_tensor generation:  0.035778045654296875
mini_batch_src_global generation:  0.06023454666137695
r_  generation:  0.5126214027404785
local_output_nid generation:  0.03333091735839844
local_in_edges_tensor generation:  0.036663055419921875
mini_batch_src_global generation:  0.05856680870056152
r_  generation:  0.5106637477874756
local_output_nid generation:  0.032674312591552734
local_in_edges_tensor generation:  0.04223370552062988
mini_batch_src_global generation:  0.05963945388793945
r_  generation:  0.5018160343170166
local_output_nid generation:  0.03307747840881348
local_in_edges_tensor generation:  0.03225088119506836
mini_batch_src_global generation:  0.05892372131347656
r_  generation:  0.5145807266235352
local_output_nid generation:  0.0341336727142334
local_in_edges_tensor generation:  0.04505133628845215
mini_batch_src_global generation:  0.06018257141113281
r_  generation:  0.5102894306182861
local_output_nid generation:  0.03344607353210449
local_in_edges_tensor generation:  0.051116943359375
mini_batch_src_global generation:  0.061173439025878906
r_  generation:  0.5364623069763184
local_output_nid generation:  0.036957740783691406
local_in_edges_tensor generation:  0.03789639472961426
mini_batch_src_global generation:  0.06201362609863281
r_  generation:  0.5034918785095215
local_output_nid generation:  0.03320622444152832
local_in_edges_tensor generation:  0.036722660064697266
mini_batch_src_global generation:  0.06348872184753418
r_  generation:  0.5107567310333252
local_output_nid generation:  0.03319239616394043
local_in_edges_tensor generation:  0.047849416732788086
mini_batch_src_global generation:  0.07069039344787598
r_  generation:  0.5171318054199219
----------------------check_connections_block total spend ----------------------------- 12.246387004852295
generate_one_block  0.686586856842041
generate_one_block  0.6827728748321533
generate_one_block  0.6760053634643555
generate_one_block  0.6784660816192627
generate_one_block  0.6605923175811768
generate_one_block  0.6750342845916748
generate_one_block  0.6842348575592041
generate_one_block  0.66044020652771
generate_one_block  0.7111403942108154
generate_one_block  0.6715736389160156
generate_one_block  0.6762237548828125
generate_one_block  0.6808907985687256
generate_one_block  0.671933650970459
generate_one_block  0.6728236675262451
generate_one_block  0.6804711818695068
generate_one_block  0.6899971961975098
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03625082969665527
gen group dst list time:  0.0980222225189209
time for parepare:  0.019976377487182617
local_output_nid generation:  0.035897254943847656
local_in_edges_tensor generation:  0.06315970420837402
mini_batch_src_global generation:  0.049315690994262695
r_  generation:  0.529616117477417
local_output_nid generation:  0.041556596755981445
local_in_edges_tensor generation:  0.0584566593170166
mini_batch_src_global generation:  0.06154155731201172
r_  generation:  0.5504467487335205
local_output_nid generation:  0.042174577713012695
local_in_edges_tensor generation:  0.050566911697387695
mini_batch_src_global generation:  0.06294035911560059
r_  generation:  0.5561814308166504
local_output_nid generation:  0.043797969818115234
local_in_edges_tensor generation:  0.044171810150146484
mini_batch_src_global generation:  0.057973623275756836
r_  generation:  0.5436818599700928
local_output_nid generation:  0.040554046630859375
local_in_edges_tensor generation:  0.04149627685546875
mini_batch_src_global generation:  0.05755949020385742
r_  generation:  0.547231912612915
local_output_nid generation:  0.04006195068359375
local_in_edges_tensor generation:  0.04730486869812012
mini_batch_src_global generation:  0.057747602462768555
r_  generation:  0.5489273071289062
local_output_nid generation:  0.03976106643676758
local_in_edges_tensor generation:  0.03731822967529297
mini_batch_src_global generation:  0.058263540267944336
r_  generation:  0.55611252784729
local_output_nid generation:  0.039852142333984375
local_in_edges_tensor generation:  0.04249167442321777
mini_batch_src_global generation:  0.059099674224853516
r_  generation:  0.5511682033538818
local_output_nid generation:  0.03966069221496582
local_in_edges_tensor generation:  0.046634674072265625
mini_batch_src_global generation:  0.05971813201904297
r_  generation:  0.5562915802001953
local_output_nid generation:  0.03944969177246094
local_in_edges_tensor generation:  0.03713822364807129
mini_batch_src_global generation:  0.059752702713012695
r_  generation:  0.5527284145355225
local_output_nid generation:  0.03952383995056152
local_in_edges_tensor generation:  0.04192042350769043
mini_batch_src_global generation:  0.060456275939941406
r_  generation:  0.5594398975372314
local_output_nid generation:  0.04126453399658203
local_in_edges_tensor generation:  0.05581974983215332
mini_batch_src_global generation:  0.05961728096008301
r_  generation:  0.5565352439880371
local_output_nid generation:  0.039938926696777344
local_in_edges_tensor generation:  0.04174923896789551
mini_batch_src_global generation:  0.06041145324707031
r_  generation:  0.5653285980224609
local_output_nid generation:  0.040085792541503906
local_in_edges_tensor generation:  0.0468137264251709
mini_batch_src_global generation:  0.06011319160461426
r_  generation:  0.5548884868621826
local_output_nid generation:  0.03973245620727539
local_in_edges_tensor generation:  0.03766608238220215
mini_batch_src_global generation:  0.06058454513549805
r_  generation:  0.5631346702575684
local_output_nid generation:  0.04020833969116211
local_in_edges_tensor generation:  0.04151129722595215
mini_batch_src_global generation:  0.059981584548950195
r_  generation:  0.5601792335510254
----------------------check_connections_block total spend ----------------------------- 13.261543035507202
generate_one_block  0.7263584136962891
generate_one_block  0.7319393157958984
generate_one_block  0.7194302082061768
generate_one_block  0.7087905406951904
generate_one_block  0.707939863204956
generate_one_block  0.7186539173126221
generate_one_block  0.7750749588012695
generate_one_block  0.7063920497894287
generate_one_block  0.7286670207977295
generate_one_block  0.6896324157714844
generate_one_block  0.6988980770111084
generate_one_block  0.7028236389160156
generate_one_block  0.701869010925293
generate_one_block  0.7011013031005859
generate_one_block  0.7103984355926514
generate_one_block  0.7046058177947998
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040691375732421875
gen group dst list time:  0.0962839126586914
time for parepare:  0.020227909088134766
local_output_nid generation:  0.03901934623718262
local_in_edges_tensor generation:  0.0583035945892334
mini_batch_src_global generation:  0.0489962100982666
r_  generation:  0.5130126476287842
local_output_nid generation:  0.04307675361633301
local_in_edges_tensor generation:  0.04410529136657715
mini_batch_src_global generation:  0.05848264694213867
r_  generation:  0.5082967281341553
local_output_nid generation:  0.041199684143066406
local_in_edges_tensor generation:  0.03749251365661621
mini_batch_src_global generation:  0.057210445404052734
r_  generation:  0.5258409976959229
local_output_nid generation:  0.04224753379821777
local_in_edges_tensor generation:  0.03543567657470703
mini_batch_src_global generation:  0.05682229995727539
r_  generation:  0.5111958980560303
local_output_nid generation:  0.04249978065490723
local_in_edges_tensor generation:  0.037427425384521484
mini_batch_src_global generation:  0.05642557144165039
r_  generation:  0.5152671337127686
local_output_nid generation:  0.04277396202087402
local_in_edges_tensor generation:  0.036925315856933594
mini_batch_src_global generation:  0.056949615478515625
r_  generation:  0.5145771503448486
local_output_nid generation:  0.04225587844848633
local_in_edges_tensor generation:  0.03780674934387207
mini_batch_src_global generation:  0.056234121322631836
r_  generation:  0.5201687812805176
local_output_nid generation:  0.04245448112487793
local_in_edges_tensor generation:  0.038001298904418945
mini_batch_src_global generation:  0.05735659599304199
r_  generation:  0.5130569934844971
local_output_nid generation:  0.0419316291809082
local_in_edges_tensor generation:  0.03866457939147949
mini_batch_src_global generation:  0.05703234672546387
r_  generation:  0.5251688957214355
local_output_nid generation:  0.041991472244262695
local_in_edges_tensor generation:  0.0399317741394043
mini_batch_src_global generation:  0.05719566345214844
r_  generation:  0.5160257816314697
local_output_nid generation:  0.04215216636657715
local_in_edges_tensor generation:  0.04423952102661133
mini_batch_src_global generation:  0.05654168128967285
r_  generation:  0.5248534679412842
local_output_nid generation:  0.04208183288574219
local_in_edges_tensor generation:  0.039988040924072266
mini_batch_src_global generation:  0.057561635971069336
r_  generation:  0.5324487686157227
local_output_nid generation:  0.04312443733215332
local_in_edges_tensor generation:  0.04014754295349121
mini_batch_src_global generation:  0.05682206153869629
r_  generation:  0.5330710411071777
local_output_nid generation:  0.04213595390319824
local_in_edges_tensor generation:  0.0399472713470459
mini_batch_src_global generation:  0.05765533447265625
r_  generation:  0.5186419486999512
local_output_nid generation:  0.04210519790649414
local_in_edges_tensor generation:  0.04414701461791992
mini_batch_src_global generation:  0.056464433670043945
r_  generation:  0.5278165340423584
local_output_nid generation:  0.04212450981140137
local_in_edges_tensor generation:  0.04005265235900879
mini_batch_src_global generation:  0.05738258361816406
r_  generation:  0.5357439517974854
----------------------check_connections_block total spend ----------------------------- 12.55531644821167
generate_one_block  0.673051118850708
generate_one_block  0.6679835319519043
generate_one_block  0.6610569953918457
generate_one_block  0.664806604385376
generate_one_block  0.663996696472168
generate_one_block  0.6675291061401367
generate_one_block  0.6601238250732422
generate_one_block  0.6589107513427734
generate_one_block  0.6575686931610107
generate_one_block  0.730715274810791
generate_one_block  0.6632661819458008
generate_one_block  0.659296989440918
generate_one_block  0.6650118827819824
generate_one_block  0.6655256748199463
generate_one_block  0.6618704795837402
generate_one_block  0.6701624393463135
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.20114374160766602  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

connection checking time:  43.34554719924927
block generation total time  37.83947801589966
average batch blocks generation time:  2.3649673759937286
block dataloader generation time/epoch 84.84007167816162
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12576961517333984  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166221, 128])
torch.Size([163877, 32])
torch.Size([155704, 32])
torch.Size([123411, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.42731285095215  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12513113021850586  GigaBytes
Max Memory Allocated: 19.516953945159912  GigaBytes

torch.Size([166357, 128])
torch.Size([164050, 32])
torch.Size([155924, 32])
torch.Size([124392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.5115704536438  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.1257948875427246  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166319, 128])
torch.Size([164068, 32])
torch.Size([155918, 32])
torch.Size([123358, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.4392991065979  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.1250605583190918  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166281, 128])
torch.Size([163944, 32])
torch.Size([155905, 32])
torch.Size([124083, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.484965324401855  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12577581405639648  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166386, 128])
torch.Size([164052, 32])
torch.Size([155754, 32])
torch.Size([123371, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.416449069976807  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12510204315185547  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166356, 128])
torch.Size([164077, 32])
torch.Size([155964, 32])
torch.Size([124325, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.49808692932129  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12585687637329102  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166309, 128])
torch.Size([163963, 32])
torch.Size([155677, 32])
torch.Size([124043, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.4961838722229  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12502098083496094  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166294, 128])
torch.Size([163927, 32])
torch.Size([155688, 32])
torch.Size([123420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.455946922302246  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12585115432739258  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166282, 128])
torch.Size([163975, 32])
torch.Size([155974, 32])
torch.Size([124152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.48982048034668  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12499332427978516  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166213, 128])
torch.Size([163820, 32])
torch.Size([155577, 32])
torch.Size([123515, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.463393688201904  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12581443786621094  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166277, 128])
torch.Size([163884, 32])
torch.Size([155777, 32])
torch.Size([123462, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.461304187774658  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12502336502075195  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166277, 128])
torch.Size([163891, 32])
torch.Size([155651, 32])
torch.Size([123296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 19.470834255218506  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7205810546875 GB
    Memory Allocated: 0.12584829330444336  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166371, 128])
torch.Size([164029, 32])
torch.Size([155830, 32])
torch.Size([123778, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 19.49391222000122  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 0.12504339218139648  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166330, 128])
torch.Size([164019, 32])
torch.Size([155791, 32])
torch.Size([123346, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 19.461425304412842  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 0.1258234977722168  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166247, 128])
torch.Size([163949, 32])
torch.Size([155751, 32])
torch.Size([123702, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 19.46611738204956  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 0.12505674362182617  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

torch.Size([166245, 128])
torch.Size([163969, 32])
torch.Size([155848, 32])
torch.Size([124176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7283935546875 GB
    Memory Allocated: 19.500622749328613  GigaBytes
Max Memory Allocated: 19.518689155578613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0432015061378479 |0.04209446907043457 |0.45124728977680206 |9.559094905853271e-05 |0.6343715190887451 |0.008560895919799805 |
----------------------------------------------------------pseudo_mini_loss sum 4.008625507354736
Total (block generation + training)time/epoch 103.64828586578369
Training time/epoch 18.807900428771973
Training time without block to device /epoch 18.13438892364502
Training time without total dataloading part /epoch 17.37999129295349
load block tensor time/epoch 0.6912240982055664
block to device time/epoch 0.6735115051269531
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10417791
Number of first layer input nodes during this epoch:  2660765
