Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648463038.863403
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02419114112854004
random selection method range initialization spend 0.006167411804199219
time for parepare:  0.01853775978088379
local_output_nid generation:  0.0021393299102783203
local_in_edges_tensor generation:  0.004370212554931641
mini_batch_src_global generation:  0.0018315315246582031
r_  generation:  0.01926565170288086
local_output_nid generation:  0.0027861595153808594
local_in_edges_tensor generation:  0.0015892982482910156
mini_batch_src_global generation:  0.0020706653594970703
r_  generation:  0.017838239669799805
local_output_nid generation:  0.0029010772705078125
local_in_edges_tensor generation:  0.0015413761138916016
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.018308639526367188
local_output_nid generation:  0.002957582473754883
local_in_edges_tensor generation:  0.001506805419921875
mini_batch_src_global generation:  0.001440286636352539
r_  generation:  0.01880645751953125
local_output_nid generation:  0.0029358863830566406
local_in_edges_tensor generation:  0.001506805419921875
mini_batch_src_global generation:  0.0014386177062988281
r_  generation:  0.018687725067138672
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.0015108585357666016
mini_batch_src_global generation:  0.0014986991882324219
r_  generation:  0.01908731460571289
local_output_nid generation:  0.002971172332763672
local_in_edges_tensor generation:  0.0015380382537841797
mini_batch_src_global generation:  0.0014688968658447266
r_  generation:  0.018819093704223633
local_output_nid generation:  0.0028972625732421875
local_in_edges_tensor generation:  0.00147247314453125
mini_batch_src_global generation:  0.0014641284942626953
r_  generation:  0.01863408088684082
local_output_nid generation:  0.0028793811798095703
local_in_edges_tensor generation:  0.0014445781707763672
mini_batch_src_global generation:  0.001463174819946289
r_  generation:  0.019055843353271484
local_output_nid generation:  0.002897024154663086
local_in_edges_tensor generation:  0.0014734268188476562
mini_batch_src_global generation:  0.001451253890991211
r_  generation:  0.018855571746826172
local_output_nid generation:  0.0028839111328125
local_in_edges_tensor generation:  0.0014727115631103516
mini_batch_src_global generation:  0.0014805793762207031
r_  generation:  0.018925905227661133
local_output_nid generation:  0.002943277359008789
local_in_edges_tensor generation:  0.001470804214477539
mini_batch_src_global generation:  0.001577615737915039
r_  generation:  0.019469261169433594
local_output_nid generation:  0.002902507781982422
local_in_edges_tensor generation:  0.001531362533569336
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.0192110538482666
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.0014777183532714844
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.019158601760864258
local_output_nid generation:  0.002882719039916992
local_in_edges_tensor generation:  0.0014510154724121094
mini_batch_src_global generation:  0.0015311241149902344
r_  generation:  0.019381284713745117
local_output_nid generation:  0.002925395965576172
local_in_edges_tensor generation:  0.0014672279357910156
mini_batch_src_global generation:  0.0015044212341308594
r_  generation:  0.01854395866394043
----------------------check_connections_block total spend ----------------------------- 0.49617743492126465
generate_one_block  0.02750372886657715
generate_one_block  0.027344942092895508
generate_one_block  0.030717134475708008
generate_one_block  0.0286099910736084
generate_one_block  0.027830839157104492
generate_one_block  0.028094053268432617
generate_one_block  0.027297258377075195
generate_one_block  0.027108192443847656
generate_one_block  0.02824234962463379
generate_one_block  0.02769017219543457
generate_one_block  0.0275118350982666
generate_one_block  0.028238773345947266
generate_one_block  0.02773594856262207
generate_one_block  0.027804851531982422
generate_one_block  0.028264999389648438
generate_one_block  0.027520179748535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03370237350463867
gen group dst list time:  0.018839120864868164
time for parepare:  0.018981456756591797
local_output_nid generation:  0.008297204971313477
local_in_edges_tensor generation:  0.015414953231811523
mini_batch_src_global generation:  0.019380569458007812
r_  generation:  0.19797110557556152
local_output_nid generation:  0.011744260787963867
local_in_edges_tensor generation:  0.018967390060424805
mini_batch_src_global generation:  0.02367877960205078
r_  generation:  0.1938462257385254
local_output_nid generation:  0.011713027954101562
local_in_edges_tensor generation:  0.0157473087310791
mini_batch_src_global generation:  0.022661209106445312
r_  generation:  0.20256447792053223
local_output_nid generation:  0.011915445327758789
local_in_edges_tensor generation:  0.01799464225769043
mini_batch_src_global generation:  0.02589726448059082
r_  generation:  0.2066974639892578
local_output_nid generation:  0.011892557144165039
local_in_edges_tensor generation:  0.01577448844909668
mini_batch_src_global generation:  0.03154134750366211
r_  generation:  0.20875191688537598
local_output_nid generation:  0.011788606643676758
local_in_edges_tensor generation:  0.015924453735351562
mini_batch_src_global generation:  0.025829076766967773
r_  generation:  0.21386504173278809
local_output_nid generation:  0.011531829833984375
local_in_edges_tensor generation:  0.012441396713256836
mini_batch_src_global generation:  0.025466203689575195
r_  generation:  0.20714259147644043
local_output_nid generation:  0.011651992797851562
local_in_edges_tensor generation:  0.011980533599853516
mini_batch_src_global generation:  0.02556753158569336
r_  generation:  0.2051835060119629
local_output_nid generation:  0.01186060905456543
local_in_edges_tensor generation:  0.015653610229492188
mini_batch_src_global generation:  0.025716304779052734
r_  generation:  0.21088576316833496
local_output_nid generation:  0.011689186096191406
local_in_edges_tensor generation:  0.014057636260986328
mini_batch_src_global generation:  0.02596139907836914
r_  generation:  0.20726513862609863
local_output_nid generation:  0.011623144149780273
local_in_edges_tensor generation:  0.011865377426147461
mini_batch_src_global generation:  0.02557373046875
r_  generation:  0.2077343463897705
local_output_nid generation:  0.011827230453491211
local_in_edges_tensor generation:  0.017302751541137695
mini_batch_src_global generation:  0.0265195369720459
r_  generation:  0.21082544326782227
local_output_nid generation:  0.011867046356201172
local_in_edges_tensor generation:  0.014106035232543945
mini_batch_src_global generation:  0.026500225067138672
r_  generation:  0.21547460556030273
local_output_nid generation:  0.011853456497192383
local_in_edges_tensor generation:  0.012302637100219727
mini_batch_src_global generation:  0.02618408203125
r_  generation:  0.20934557914733887
local_output_nid generation:  0.011766433715820312
local_in_edges_tensor generation:  0.01230931282043457
mini_batch_src_global generation:  0.027689695358276367
r_  generation:  0.21729660034179688
local_output_nid generation:  0.01174020767211914
local_in_edges_tensor generation:  0.012315750122070312
mini_batch_src_global generation:  0.026301860809326172
r_  generation:  0.20760631561279297
----------------------check_connections_block total spend ----------------------------- 4.895875692367554
generate_one_block  0.2779855728149414
generate_one_block  0.2583582401275635
generate_one_block  0.26818132400512695
generate_one_block  0.2765517234802246
generate_one_block  0.2859196662902832
generate_one_block  0.2740664482116699
generate_one_block  0.26348090171813965
generate_one_block  0.25779175758361816
generate_one_block  0.26929140090942383
generate_one_block  0.2657012939453125
generate_one_block  0.26878976821899414
generate_one_block  0.2712264060974121
generate_one_block  0.27329444885253906
generate_one_block  0.2613241672515869
generate_one_block  0.2765922546386719
generate_one_block  0.26066088676452637
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03451848030090332
gen group dst list time:  0.058481693267822266
time for parepare:  0.018634796142578125
local_output_nid generation:  0.02546072006225586
local_in_edges_tensor generation:  0.042249441146850586
mini_batch_src_global generation:  0.044267892837524414
r_  generation:  0.43584656715393066
local_output_nid generation:  0.030916452407836914
local_in_edges_tensor generation:  0.04500246047973633
mini_batch_src_global generation:  0.05092215538024902
r_  generation:  0.44191431999206543
local_output_nid generation:  0.0305173397064209
local_in_edges_tensor generation:  0.03737330436706543
mini_batch_src_global generation:  0.050099849700927734
r_  generation:  0.4438474178314209
local_output_nid generation:  0.03041696548461914
local_in_edges_tensor generation:  0.03842663764953613
mini_batch_src_global generation:  0.051145076751708984
r_  generation:  0.44977617263793945
local_output_nid generation:  0.030355453491210938
local_in_edges_tensor generation:  0.030305147171020508
mini_batch_src_global generation:  0.0507504940032959
r_  generation:  0.4489114284515381
local_output_nid generation:  0.03072977066040039
local_in_edges_tensor generation:  0.034667253494262695
mini_batch_src_global generation:  0.055316925048828125
r_  generation:  0.45986175537109375
local_output_nid generation:  0.03044867515563965
local_in_edges_tensor generation:  0.029782533645629883
mini_batch_src_global generation:  0.05110645294189453
r_  generation:  0.4566936492919922
local_output_nid generation:  0.030315637588500977
local_in_edges_tensor generation:  0.029935598373413086
mini_batch_src_global generation:  0.052867889404296875
r_  generation:  0.44737911224365234
local_output_nid generation:  0.03043222427368164
local_in_edges_tensor generation:  0.03829073905944824
mini_batch_src_global generation:  0.05135154724121094
r_  generation:  0.4554779529571533
local_output_nid generation:  0.030686140060424805
local_in_edges_tensor generation:  0.04190850257873535
mini_batch_src_global generation:  0.05211591720581055
r_  generation:  0.47205185890197754
local_output_nid generation:  0.030495882034301758
local_in_edges_tensor generation:  0.035028934478759766
mini_batch_src_global generation:  0.0516204833984375
r_  generation:  0.4580693244934082
local_output_nid generation:  0.030496835708618164
local_in_edges_tensor generation:  0.03384709358215332
mini_batch_src_global generation:  0.05275106430053711
r_  generation:  0.4531583786010742
local_output_nid generation:  0.03045821189880371
local_in_edges_tensor generation:  0.03365516662597656
mini_batch_src_global generation:  0.05099916458129883
r_  generation:  0.4619452953338623
local_output_nid generation:  0.030651569366455078
local_in_edges_tensor generation:  0.03356504440307617
mini_batch_src_global generation:  0.05619525909423828
r_  generation:  0.4521300792694092
local_output_nid generation:  0.030739307403564453
local_in_edges_tensor generation:  0.033251285552978516
mini_batch_src_global generation:  0.052019357681274414
r_  generation:  0.4584512710571289
local_output_nid generation:  0.030616044998168945
local_in_edges_tensor generation:  0.03469586372375488
mini_batch_src_global generation:  0.052236080169677734
r_  generation:  0.45844006538391113
----------------------check_connections_block total spend ----------------------------- 10.69947075843811
generate_one_block  0.5683619976043701
generate_one_block  0.5701665878295898
generate_one_block  0.5705254077911377
generate_one_block  0.5847177505493164
generate_one_block  0.5654206275939941
generate_one_block  0.5787384510040283
generate_one_block  0.6924395561218262
generate_one_block  0.5790624618530273
generate_one_block  0.582078218460083
generate_one_block  0.6083316802978516
generate_one_block  0.5959315299987793
generate_one_block  0.6188275814056396
generate_one_block  0.5896837711334229
generate_one_block  0.5876579284667969
generate_one_block  0.6157870292663574
generate_one_block  0.6260616779327393
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  15.595346450805664
block generation total time  13.843008518218994
average batch blocks generation time:  0.8651880323886871
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09528017044067383  GigaBytes
Max Memory Allocated: 0.09528017044067383  GigaBytes

torch.Size([154595, 128])
torch.Size([123194, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2108154296875 GB
    Memory Allocated: 21.603971481323242  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6385498046875 GB
    Memory Allocated: 0.1002802848815918  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154419, 128])
torch.Size([121826, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3221435546875 GB
    Memory Allocated: 20.702714443206787  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3240966796875 GB
    Memory Allocated: 0.10107421875  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154183, 128])
torch.Size([122070, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2459716796875 GB
    Memory Allocated: 21.053943157196045  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.1006765365600586  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154552, 128])
torch.Size([123024, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 21.266907215118408  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.10113716125488281  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154161, 128])
torch.Size([122102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4569091796875 GB
    Memory Allocated: 21.168028831481934  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4569091796875 GB
    Memory Allocated: 0.10061359405517578  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154374, 128])
torch.Size([122563, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4822998046875 GB
    Memory Allocated: 21.311705589294434  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10104179382324219  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154282, 128])
torch.Size([121944, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.004050254821777  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10033941268920898  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154401, 128])
torch.Size([121955, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 20.86492681503296  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10108566284179688  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154342, 128])
torch.Size([122256, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.125435829162598  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10065460205078125  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154788, 128])
torch.Size([122818, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.007938385009766  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10105037689208984  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154495, 128])
torch.Size([122463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 20.983226776123047  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10065317153930664  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154547, 128])
torch.Size([122852, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.2613525390625  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10114002227783203  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154313, 128])
torch.Size([122009, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.218013286590576  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10045623779296875  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154414, 128])
torch.Size([122471, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.002007007598877  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10117340087890625  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154358, 128])
torch.Size([122769, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.26632261276245  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.10035324096679688  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154260, 128])
torch.Size([122211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 20.92578411102295  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03958617150783539 |0.03796759247779846 |0.3529442697763443 |0.00010634958744049072 |0.595202848315239 |0.00844717025756836 |
----------------------------------------------------------pseudo_mini_loss sum 5.374927520751953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5090145
Number of first layer input nodes during this epoch:  2470484
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.13466882705688477  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01899433135986328
random selection method range initialization spend 0.005441188812255859
time for parepare:  0.018644094467163086
local_output_nid generation:  0.0026903152465820312
local_in_edges_tensor generation:  0.0045642852783203125
mini_batch_src_global generation:  0.0017468929290771484
r_  generation:  0.017784833908081055
local_output_nid generation:  0.004050731658935547
local_in_edges_tensor generation:  0.0017955303192138672
mini_batch_src_global generation:  0.0021462440490722656
r_  generation:  0.01896810531616211
local_output_nid generation:  0.0038299560546875
local_in_edges_tensor generation:  0.0016493797302246094
mini_batch_src_global generation:  0.0014033317565917969
r_  generation:  0.01865100860595703
local_output_nid generation:  0.0038874149322509766
local_in_edges_tensor generation:  0.0016775131225585938
mini_batch_src_global generation:  0.00140380859375
r_  generation:  0.018292903900146484
local_output_nid generation:  0.0037903785705566406
local_in_edges_tensor generation:  0.0016236305236816406
mini_batch_src_global generation:  0.0014312267303466797
r_  generation:  0.018779993057250977
local_output_nid generation:  0.0037949085235595703
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.0014426708221435547
r_  generation:  0.019434213638305664
local_output_nid generation:  0.003786325454711914
local_in_edges_tensor generation:  0.001596689224243164
mini_batch_src_global generation:  0.0014481544494628906
r_  generation:  0.01872539520263672
local_output_nid generation:  0.0037834644317626953
local_in_edges_tensor generation:  0.00160980224609375
mini_batch_src_global generation:  0.001435995101928711
r_  generation:  0.019480466842651367
local_output_nid generation:  0.0037186145782470703
local_in_edges_tensor generation:  0.0016160011291503906
mini_batch_src_global generation:  0.0014541149139404297
r_  generation:  0.019615888595581055
local_output_nid generation:  0.0037915706634521484
local_in_edges_tensor generation:  0.0016252994537353516
mini_batch_src_global generation:  0.0015010833740234375
r_  generation:  0.019814491271972656
local_output_nid generation:  0.0038001537322998047
local_in_edges_tensor generation:  0.0016384124755859375
mini_batch_src_global generation:  0.0015425682067871094
r_  generation:  0.0218355655670166
local_output_nid generation:  0.003932952880859375
local_in_edges_tensor generation:  0.0017905235290527344
mini_batch_src_global generation:  0.0018475055694580078
r_  generation:  0.019600391387939453
local_output_nid generation:  0.003798246383666992
local_in_edges_tensor generation:  0.0016176700592041016
mini_batch_src_global generation:  0.0014824867248535156
r_  generation:  0.021537065505981445
local_output_nid generation:  0.003995656967163086
local_in_edges_tensor generation:  0.0016562938690185547
mini_batch_src_global generation:  0.0018630027770996094
r_  generation:  0.019953489303588867
local_output_nid generation:  0.00393986701965332
local_in_edges_tensor generation:  0.001795053482055664
mini_batch_src_global generation:  0.001554727554321289
r_  generation:  0.021567821502685547
local_output_nid generation:  0.003816366195678711
local_in_edges_tensor generation:  0.0016450881958007812
mini_batch_src_global generation:  0.0018765926361083984
r_  generation:  0.02146458625793457
----------------------check_connections_block total spend ----------------------------- 0.5362355709075928
generate_one_block  0.034806013107299805
generate_one_block  0.03339409828186035
generate_one_block  0.03145480155944824
generate_one_block  0.03038167953491211
generate_one_block  0.031308889389038086
generate_one_block  0.03480958938598633
generate_one_block  0.030360937118530273
generate_one_block  0.03038620948791504
generate_one_block  0.03075885772705078
generate_one_block  0.030998945236206055
generate_one_block  0.031319379806518555
generate_one_block  0.030874013900756836
generate_one_block  0.030762434005737305
generate_one_block  0.030921220779418945
generate_one_block  0.03076791763305664
generate_one_block  0.030858755111694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03516268730163574
gen group dst list time:  0.019011974334716797
time for parepare:  0.022366046905517578
local_output_nid generation:  0.010211944580078125
local_in_edges_tensor generation:  0.05982613563537598
mini_batch_src_global generation:  0.02089977264404297
r_  generation:  0.2079613208770752
local_output_nid generation:  0.017565250396728516
local_in_edges_tensor generation:  0.021831035614013672
mini_batch_src_global generation:  0.027378082275390625
r_  generation:  0.21089696884155273
local_output_nid generation:  0.013443231582641602
local_in_edges_tensor generation:  0.01936817169189453
mini_batch_src_global generation:  0.026625633239746094
r_  generation:  0.21438908576965332
local_output_nid generation:  0.013557672500610352
local_in_edges_tensor generation:  0.014119863510131836
mini_batch_src_global generation:  0.02571272850036621
r_  generation:  0.21042203903198242
local_output_nid generation:  0.014052152633666992
local_in_edges_tensor generation:  0.015405416488647461
mini_batch_src_global generation:  0.026613473892211914
r_  generation:  0.22075104713439941
local_output_nid generation:  0.013992786407470703
local_in_edges_tensor generation:  0.01742386817932129
mini_batch_src_global generation:  0.028782129287719727
r_  generation:  0.22060608863830566
local_output_nid generation:  0.01290750503540039
local_in_edges_tensor generation:  0.013758659362792969
mini_batch_src_global generation:  0.026677846908569336
r_  generation:  0.21445465087890625
local_output_nid generation:  0.013227224349975586
local_in_edges_tensor generation:  0.013588905334472656
mini_batch_src_global generation:  0.02735590934753418
r_  generation:  0.2176363468170166
local_output_nid generation:  0.013373851776123047
local_in_edges_tensor generation:  0.01726078987121582
mini_batch_src_global generation:  0.02751445770263672
r_  generation:  0.21926331520080566
local_output_nid generation:  0.013464212417602539
local_in_edges_tensor generation:  0.015762805938720703
mini_batch_src_global generation:  0.028182268142700195
r_  generation:  0.26571226119995117
local_output_nid generation:  0.01348423957824707
local_in_edges_tensor generation:  0.0144805908203125
mini_batch_src_global generation:  0.028704404830932617
r_  generation:  0.22817158699035645
local_output_nid generation:  0.01340341567993164
local_in_edges_tensor generation:  0.017385244369506836
mini_batch_src_global generation:  0.02786087989807129
r_  generation:  0.2245042324066162
local_output_nid generation:  0.01333308219909668
local_in_edges_tensor generation:  0.015437126159667969
mini_batch_src_global generation:  0.028148174285888672
r_  generation:  0.2283649444580078
local_output_nid generation:  0.013592243194580078
local_in_edges_tensor generation:  0.018928050994873047
mini_batch_src_global generation:  0.032251596450805664
r_  generation:  0.23954558372497559
local_output_nid generation:  0.016447067260742188
local_in_edges_tensor generation:  0.022699594497680664
mini_batch_src_global generation:  0.027449846267700195
r_  generation:  0.21782803535461426
local_output_nid generation:  0.012936115264892578
local_in_edges_tensor generation:  0.016822338104248047
mini_batch_src_global generation:  0.027076244354248047
r_  generation:  0.21693062782287598
----------------------check_connections_block total spend ----------------------------- 5.343151807785034
generate_one_block  0.28707313537597656
generate_one_block  0.28159499168395996
generate_one_block  0.28299808502197266
generate_one_block  0.2769627571105957
generate_one_block  0.2819838523864746
generate_one_block  0.28480982780456543
generate_one_block  0.2901322841644287
generate_one_block  0.2845752239227295
generate_one_block  0.29378795623779297
generate_one_block  0.28951287269592285
generate_one_block  0.28905582427978516
generate_one_block  0.2770805358886719
generate_one_block  0.28174710273742676
generate_one_block  0.28523874282836914
generate_one_block  0.2958526611328125
generate_one_block  0.2937045097351074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03808736801147461
gen group dst list time:  0.07506752014160156
time for parepare:  0.018714189529418945
local_output_nid generation:  0.02799367904663086
local_in_edges_tensor generation:  0.05688762664794922
mini_batch_src_global generation:  0.044377803802490234
r_  generation:  0.44124531745910645
local_output_nid generation:  0.031369686126708984
local_in_edges_tensor generation:  0.04409527778625488
mini_batch_src_global generation:  0.053778886795043945
r_  generation:  0.44533586502075195
local_output_nid generation:  0.031790733337402344
local_in_edges_tensor generation:  0.03703498840332031
mini_batch_src_global generation:  0.050067901611328125
r_  generation:  0.4554018974304199
local_output_nid generation:  0.03189802169799805
local_in_edges_tensor generation:  0.03261256217956543
mini_batch_src_global generation:  0.05196428298950195
r_  generation:  0.4553217887878418
local_output_nid generation:  0.03175640106201172
local_in_edges_tensor generation:  0.07427191734313965
mini_batch_src_global generation:  0.05386948585510254
r_  generation:  0.457965612411499
local_output_nid generation:  0.03185391426086426
local_in_edges_tensor generation:  0.05159354209899902
mini_batch_src_global generation:  0.05232834815979004
r_  generation:  0.4574704170227051
local_output_nid generation:  0.03136563301086426
local_in_edges_tensor generation:  0.028859615325927734
mini_batch_src_global generation:  0.05231165885925293
r_  generation:  0.4591395854949951
local_output_nid generation:  0.0316007137298584
local_in_edges_tensor generation:  0.02859807014465332
mini_batch_src_global generation:  0.05257701873779297
r_  generation:  0.4582529067993164
local_output_nid generation:  0.03165888786315918
local_in_edges_tensor generation:  0.028959274291992188
mini_batch_src_global generation:  0.055782318115234375
r_  generation:  0.4689028263092041
local_output_nid generation:  0.03264188766479492
local_in_edges_tensor generation:  0.03276658058166504
mini_batch_src_global generation:  0.05284857749938965
r_  generation:  0.4654102325439453
local_output_nid generation:  0.032079219818115234
local_in_edges_tensor generation:  0.0384373664855957
mini_batch_src_global generation:  0.0525364875793457
r_  generation:  0.4762740135192871
local_output_nid generation:  0.03209972381591797
local_in_edges_tensor generation:  0.041015625
mini_batch_src_global generation:  0.06295466423034668
r_  generation:  0.46079230308532715
local_output_nid generation:  0.03401947021484375
local_in_edges_tensor generation:  0.037520408630371094
mini_batch_src_global generation:  0.052008628845214844
r_  generation:  0.4614386558532715
local_output_nid generation:  0.03258562088012695
local_in_edges_tensor generation:  0.032325029373168945
mini_batch_src_global generation:  0.052619218826293945
r_  generation:  0.45916032791137695
local_output_nid generation:  0.03260612487792969
local_in_edges_tensor generation:  0.032335758209228516
mini_batch_src_global generation:  0.05541086196899414
r_  generation:  0.4648571014404297
local_output_nid generation:  0.032782793045043945
local_in_edges_tensor generation:  0.03685498237609863
mini_batch_src_global generation:  0.05275130271911621
r_  generation:  0.46010780334472656
----------------------check_connections_block total spend ----------------------------- 10.926130771636963
generate_one_block  0.6156847476959229
generate_one_block  0.6155550479888916
generate_one_block  0.6096501350402832
generate_one_block  0.5861022472381592
generate_one_block  0.6000816822052002
generate_one_block  0.6022763252258301
generate_one_block  0.5823450088500977
generate_one_block  0.588747501373291
generate_one_block  0.6344964504241943
generate_one_block  0.6006557941436768
generate_one_block  0.600269079208374
generate_one_block  0.5915818214416504
generate_one_block  0.5877389907836914
generate_one_block  0.5952143669128418
generate_one_block  0.6099100112915039
generate_one_block  0.6043763160705566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.13466882705688477  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

connection checking time:  16.269282579421997
block generation total time  14.200795888900757
average batch blocks generation time:  0.8875497430562973
block dataloader generation time/epoch 32.847057819366455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.11143922805786133  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154567, 128])
torch.Size([122098, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 20.90282964706421  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.11089420318603516  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154218, 128])
torch.Size([121995, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.184811115264893  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 0.1116495132446289  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154601, 128])
torch.Size([122636, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4842529296875 GB
    Memory Allocated: 21.291853427886963  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 0.11084938049316406  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154368, 128])
torch.Size([121935, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 20.94428014755249  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 0.11159038543701172  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154622, 128])
torch.Size([122506, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 21.201798915863037  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 0.1112203598022461  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154736, 128])
torch.Size([123257, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 21.315109729766846  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4862060546875 GB
    Memory Allocated: 0.11118507385253906  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154344, 128])
torch.Size([121478, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5194091796875 GB
    Memory Allocated: 20.485074520111084  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.11096858978271484  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154538, 128])
torch.Size([121892, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.009947299957275  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.11156940460205078  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154984, 128])
torch.Size([123383, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.12283754348755  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.11109113693237305  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154441, 128])
torch.Size([122923, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.32676935195923  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.11167049407958984  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154322, 128])
torch.Size([122471, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.334907054901123  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.11109256744384766  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154610, 128])
torch.Size([123014, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.162705421447754  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.111541748046875  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154325, 128])
torch.Size([122211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.10819387435913  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.1109156608581543  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154359, 128])
torch.Size([121899, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.129719257354736  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.11163139343261719  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154502, 128])
torch.Size([122641, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.25648260116577  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 0.111236572265625  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

torch.Size([154850, 128])
torch.Size([123018, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5213623046875 GB
    Memory Allocated: 21.2205753326416  GigaBytes
Max Memory Allocated: 21.665154933929443  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042775556445121765 |0.01583939790725708 |0.3043377548456192 |9.749829769134521e-05 |0.5564477443695068 |0.006434917449951172 |
----------------------------------------------------------pseudo_mini_loss sum 3.868572235107422
Total (block generation + training)time/epoch 47.60251593589783
Training time/epoch 14.75518536567688
Training time without block to device /epoch 14.501754999160767
Training time without total dataloading part /epoch 13.78056287765503
load block tensor time/epoch 0.6844089031219482
block to device time/epoch 0.2534303665161133
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5093116
Number of first layer input nodes during this epoch:  2472387
