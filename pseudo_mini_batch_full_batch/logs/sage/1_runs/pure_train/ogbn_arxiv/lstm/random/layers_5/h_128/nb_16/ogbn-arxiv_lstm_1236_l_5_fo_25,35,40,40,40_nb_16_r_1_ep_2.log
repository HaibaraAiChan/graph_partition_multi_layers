Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648503079.5480833
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025260448455810547
random selection method range initialization spend 0.006280660629272461
time for parepare:  0.018364906311035156
local_output_nid generation:  0.0021255016326904297
local_in_edges_tensor generation:  0.004870414733886719
mini_batch_src_global generation:  0.0017771720886230469
r_  generation:  0.01751422882080078
local_output_nid generation:  0.0025773048400878906
local_in_edges_tensor generation:  0.0016083717346191406
mini_batch_src_global generation:  0.0020487308502197266
r_  generation:  0.016913652420043945
local_output_nid generation:  0.0026781558990478516
local_in_edges_tensor generation:  0.0016016960144042969
mini_batch_src_global generation:  0.0013916492462158203
r_  generation:  0.017754554748535156
local_output_nid generation:  0.0027468204498291016
local_in_edges_tensor generation:  0.0015490055084228516
mini_batch_src_global generation:  0.0013778209686279297
r_  generation:  0.0175778865814209
local_output_nid generation:  0.0027544498443603516
local_in_edges_tensor generation:  0.0014603137969970703
mini_batch_src_global generation:  0.0013637542724609375
r_  generation:  0.018384695053100586
local_output_nid generation:  0.002822399139404297
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0014495849609375
r_  generation:  0.018349170684814453
local_output_nid generation:  0.0028314590454101562
local_in_edges_tensor generation:  0.0015215873718261719
mini_batch_src_global generation:  0.0014545917510986328
r_  generation:  0.018187284469604492
local_output_nid generation:  0.002876758575439453
local_in_edges_tensor generation:  0.0014755725860595703
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.0182802677154541
local_output_nid generation:  0.0028285980224609375
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.018379688262939453
local_output_nid generation:  0.0028700828552246094
local_in_edges_tensor generation:  0.001585245132446289
mini_batch_src_global generation:  0.0014433860778808594
r_  generation:  0.017996788024902344
local_output_nid generation:  0.0028853416442871094
local_in_edges_tensor generation:  0.0014340877532958984
mini_batch_src_global generation:  0.0013916492462158203
r_  generation:  0.018323183059692383
local_output_nid generation:  0.0029449462890625
local_in_edges_tensor generation:  0.0014955997467041016
mini_batch_src_global generation:  0.0014824867248535156
r_  generation:  0.0180816650390625
local_output_nid generation:  0.0028443336486816406
local_in_edges_tensor generation:  0.0014312267303466797
mini_batch_src_global generation:  0.0015208721160888672
r_  generation:  0.018019437789916992
local_output_nid generation:  0.002839803695678711
local_in_edges_tensor generation:  0.0014624595642089844
mini_batch_src_global generation:  0.0014667510986328125
r_  generation:  0.01793217658996582
local_output_nid generation:  0.002825021743774414
local_in_edges_tensor generation:  0.0014371871948242188
mini_batch_src_global generation:  0.0014944076538085938
r_  generation:  0.018495798110961914
local_output_nid generation:  0.0028629302978515625
local_in_edges_tensor generation:  0.0014417171478271484
mini_batch_src_global generation:  0.0014500617980957031
r_  generation:  0.0189054012298584
----------------------check_connections_block total spend ----------------------------- 0.47887492179870605
generate_one_block  0.02856731414794922
generate_one_block  0.02792978286743164
generate_one_block  0.028118610382080078
generate_one_block  0.030352115631103516
generate_one_block  0.028368234634399414
generate_one_block  0.027010440826416016
generate_one_block  0.026746749877929688
generate_one_block  0.02668023109436035
generate_one_block  0.02693343162536621
generate_one_block  0.02670907974243164
generate_one_block  0.026789426803588867
generate_one_block  0.026831865310668945
generate_one_block  0.02626967430114746
generate_one_block  0.026677370071411133
generate_one_block  0.026597976684570312
generate_one_block  0.027479887008666992
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.041730642318725586
gen group dst list time:  0.019371509552001953
time for parepare:  0.019435405731201172
local_output_nid generation:  0.00833439826965332
local_in_edges_tensor generation:  0.019906997680664062
mini_batch_src_global generation:  0.02105402946472168
r_  generation:  0.19629478454589844
local_output_nid generation:  0.014598369598388672
local_in_edges_tensor generation:  0.020886659622192383
mini_batch_src_global generation:  0.026500701904296875
r_  generation:  0.2035517692565918
local_output_nid generation:  0.014685869216918945
local_in_edges_tensor generation:  0.019477128982543945
mini_batch_src_global generation:  0.024233341217041016
r_  generation:  0.21061968803405762
local_output_nid generation:  0.014742612838745117
local_in_edges_tensor generation:  0.01702404022216797
mini_batch_src_global generation:  0.025188446044921875
r_  generation:  0.2105274200439453
local_output_nid generation:  0.015079021453857422
local_in_edges_tensor generation:  0.017764568328857422
mini_batch_src_global generation:  0.0284578800201416
r_  generation:  0.22188305854797363
local_output_nid generation:  0.014724016189575195
local_in_edges_tensor generation:  0.013527870178222656
mini_batch_src_global generation:  0.026900053024291992
r_  generation:  0.21494841575622559
local_output_nid generation:  0.014528751373291016
local_in_edges_tensor generation:  0.013746500015258789
mini_batch_src_global generation:  0.026586055755615234
r_  generation:  0.2086775302886963
local_output_nid generation:  0.014800071716308594
local_in_edges_tensor generation:  0.013463973999023438
mini_batch_src_global generation:  0.026531219482421875
r_  generation:  0.21357226371765137
local_output_nid generation:  0.014922618865966797
local_in_edges_tensor generation:  0.016860485076904297
mini_batch_src_global generation:  0.02675318717956543
r_  generation:  0.21610212326049805
local_output_nid generation:  0.014868736267089844
local_in_edges_tensor generation:  0.015700817108154297
mini_batch_src_global generation:  0.02681446075439453
r_  generation:  0.21688628196716309
local_output_nid generation:  0.01462101936340332
local_in_edges_tensor generation:  0.015193462371826172
mini_batch_src_global generation:  0.026441335678100586
r_  generation:  0.2132885456085205
local_output_nid generation:  0.014839887619018555
local_in_edges_tensor generation:  0.017367124557495117
mini_batch_src_global generation:  0.03175783157348633
r_  generation:  0.21740436553955078
local_output_nid generation:  0.014833450317382812
local_in_edges_tensor generation:  0.013627052307128906
mini_batch_src_global generation:  0.026430606842041016
r_  generation:  0.21170401573181152
local_output_nid generation:  0.014650106430053711
local_in_edges_tensor generation:  0.013228893280029297
mini_batch_src_global generation:  0.02611827850341797
r_  generation:  0.20894670486450195
local_output_nid generation:  0.014936208724975586
local_in_edges_tensor generation:  0.018861055374145508
mini_batch_src_global generation:  0.026939868927001953
r_  generation:  0.2163407802581787
local_output_nid generation:  0.01502370834350586
local_in_edges_tensor generation:  0.01747608184814453
mini_batch_src_global generation:  0.027216196060180664
r_  generation:  0.21990704536437988
----------------------check_connections_block total spend ----------------------------- 5.088624954223633
generate_one_block  0.28092265129089355
generate_one_block  0.283954381942749
generate_one_block  0.28754305839538574
generate_one_block  0.2797665596008301
generate_one_block  0.31090521812438965
generate_one_block  0.2758934497833252
generate_one_block  0.2676236629486084
generate_one_block  0.275815486907959
generate_one_block  0.2814054489135742
generate_one_block  0.28052592277526855
generate_one_block  0.27432990074157715
generate_one_block  0.2857348918914795
generate_one_block  0.26752305030822754
generate_one_block  0.2676115036010742
generate_one_block  0.277864933013916
generate_one_block  0.2913789749145508
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03759312629699707
gen group dst list time:  0.06156420707702637
time for parepare:  0.01890850067138672
local_output_nid generation:  0.025027990341186523
local_in_edges_tensor generation:  0.045822858810424805
mini_batch_src_global generation:  0.05050992965698242
r_  generation:  0.47954249382019043
local_output_nid generation:  0.031365156173706055
local_in_edges_tensor generation:  0.05174899101257324
mini_batch_src_global generation:  0.057301998138427734
r_  generation:  0.4907691478729248
local_output_nid generation:  0.030556201934814453
local_in_edges_tensor generation:  0.04329490661621094
mini_batch_src_global generation:  0.05647635459899902
r_  generation:  0.5057082176208496
local_output_nid generation:  0.03022933006286621
local_in_edges_tensor generation:  0.03901028633117676
mini_batch_src_global generation:  0.058277130126953125
r_  generation:  0.4957852363586426
local_output_nid generation:  0.030025959014892578
local_in_edges_tensor generation:  0.04304170608520508
mini_batch_src_global generation:  0.05782818794250488
r_  generation:  0.5105395317077637
local_output_nid generation:  0.030373334884643555
local_in_edges_tensor generation:  0.03515005111694336
mini_batch_src_global generation:  0.0623173713684082
r_  generation:  0.5016608238220215
local_output_nid generation:  0.030457496643066406
local_in_edges_tensor generation:  0.03839373588562012
mini_batch_src_global generation:  0.058322906494140625
r_  generation:  0.5168824195861816
local_output_nid generation:  0.03034377098083496
local_in_edges_tensor generation:  0.04810023307800293
mini_batch_src_global generation:  0.059429168701171875
r_  generation:  0.4992663860321045
local_output_nid generation:  0.030829429626464844
local_in_edges_tensor generation:  0.03972983360290527
mini_batch_src_global generation:  0.05817413330078125
r_  generation:  0.5068979263305664
local_output_nid generation:  0.030719757080078125
local_in_edges_tensor generation:  0.047725677490234375
mini_batch_src_global generation:  0.058733463287353516
r_  generation:  0.4969930648803711
local_output_nid generation:  0.030520915985107422
local_in_edges_tensor generation:  0.03460240364074707
mini_batch_src_global generation:  0.05870485305786133
r_  generation:  0.5058636665344238
local_output_nid generation:  0.030879735946655273
local_in_edges_tensor generation:  0.03448605537414551
mini_batch_src_global generation:  0.058890342712402344
r_  generation:  0.498384952545166
local_output_nid generation:  0.030535221099853516
local_in_edges_tensor generation:  0.03895306587219238
mini_batch_src_global generation:  0.0581967830657959
r_  generation:  0.4975159168243408
local_output_nid generation:  0.03050541877746582
local_in_edges_tensor generation:  0.04358053207397461
mini_batch_src_global generation:  0.05915522575378418
r_  generation:  0.5034923553466797
local_output_nid generation:  0.030550241470336914
local_in_edges_tensor generation:  0.043463945388793945
mini_batch_src_global generation:  0.06161665916442871
r_  generation:  0.5039987564086914
local_output_nid generation:  0.0309908390045166
local_in_edges_tensor generation:  0.03876900672912598
mini_batch_src_global generation:  0.05891299247741699
r_  generation:  0.5052695274353027
----------------------check_connections_block total spend ----------------------------- 11.817535161972046
generate_one_block  0.6485514640808105
generate_one_block  0.6539828777313232
generate_one_block  0.6528007984161377
generate_one_block  0.634122371673584
generate_one_block  0.6520750522613525
generate_one_block  0.6359686851501465
generate_one_block  0.6966333389282227
generate_one_block  0.6449487209320068
generate_one_block  0.6501708030700684
generate_one_block  0.6549942493438721
generate_one_block  0.636298656463623
generate_one_block  0.6629986763000488
generate_one_block  0.6581094264984131
generate_one_block  0.6463227272033691
generate_one_block  0.6468925476074219
generate_one_block  0.6539127826690674
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06352972984313965
gen group dst list time:  0.0897819995880127
time for parepare:  0.019442319869995117
local_output_nid generation:  0.034897804260253906
local_in_edges_tensor generation:  0.07558202743530273
mini_batch_src_global generation:  0.054078102111816406
r_  generation:  0.5300838947296143
local_output_nid generation:  0.03941607475280762
local_in_edges_tensor generation:  0.05818009376525879
mini_batch_src_global generation:  0.06089663505554199
r_  generation:  0.556800365447998
local_output_nid generation:  0.0417332649230957
local_in_edges_tensor generation:  0.04968762397766113
mini_batch_src_global generation:  0.06224465370178223
r_  generation:  0.5616486072540283
local_output_nid generation:  0.03932619094848633
local_in_edges_tensor generation:  0.052909135818481445
mini_batch_src_global generation:  0.059416770935058594
r_  generation:  0.553908109664917
local_output_nid generation:  0.0408024787902832
local_in_edges_tensor generation:  0.04669046401977539
mini_batch_src_global generation:  0.06315779685974121
r_  generation:  0.5680849552154541
local_output_nid generation:  0.04186654090881348
local_in_edges_tensor generation:  0.050397634506225586
mini_batch_src_global generation:  0.06619644165039062
r_  generation:  0.5800397396087646
local_output_nid generation:  0.039469003677368164
local_in_edges_tensor generation:  0.04424309730529785
mini_batch_src_global generation:  0.06270933151245117
r_  generation:  0.5570864677429199
local_output_nid generation:  0.03944516181945801
local_in_edges_tensor generation:  0.050507545471191406
mini_batch_src_global generation:  0.06215977668762207
r_  generation:  0.560523271560669
local_output_nid generation:  0.04033637046813965
local_in_edges_tensor generation:  0.05182647705078125
mini_batch_src_global generation:  0.05983877182006836
r_  generation:  0.5735361576080322
local_output_nid generation:  0.044713735580444336
local_in_edges_tensor generation:  0.05138540267944336
mini_batch_src_global generation:  0.08130788803100586
r_  generation:  0.5613751411437988
local_output_nid generation:  0.038704633712768555
local_in_edges_tensor generation:  0.03954958915710449
mini_batch_src_global generation:  0.060250282287597656
r_  generation:  0.5572731494903564
local_output_nid generation:  0.038881540298461914
local_in_edges_tensor generation:  0.0394129753112793
mini_batch_src_global generation:  0.06508445739746094
r_  generation:  0.5631661415100098
local_output_nid generation:  0.03879857063293457
local_in_edges_tensor generation:  0.03492259979248047
mini_batch_src_global generation:  0.06011652946472168
r_  generation:  0.56321120262146
local_output_nid generation:  0.03867173194885254
local_in_edges_tensor generation:  0.037697553634643555
mini_batch_src_global generation:  0.0656423568725586
r_  generation:  0.5501360893249512
local_output_nid generation:  0.039098262786865234
local_in_edges_tensor generation:  0.04276680946350098
mini_batch_src_global generation:  0.06071949005126953
r_  generation:  0.5624890327453613
local_output_nid generation:  0.03887677192687988
local_in_edges_tensor generation:  0.04271960258483887
mini_batch_src_global generation:  0.06462502479553223
r_  generation:  0.5539608001708984
----------------------check_connections_block total spend ----------------------------- 13.4903724193573
generate_one_block  0.6865048408508301
generate_one_block  0.6883940696716309
generate_one_block  0.8045721054077148
generate_one_block  0.6861832141876221
generate_one_block  0.6901309490203857
generate_one_block  0.6904342174530029
generate_one_block  0.6755411624908447
generate_one_block  0.6901955604553223
generate_one_block  0.6697516441345215
generate_one_block  0.6973893642425537
generate_one_block  0.6665887832641602
generate_one_block  0.6790347099304199
generate_one_block  0.6688222885131836
generate_one_block  0.6898500919342041
generate_one_block  0.6869754791259766
generate_one_block  0.686154842376709
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03925967216491699
gen group dst list time:  0.10115432739257812
time for parepare:  0.018892288208007812
local_output_nid generation:  0.03937864303588867
local_in_edges_tensor generation:  0.047013282775878906
mini_batch_src_global generation:  0.04504513740539551
r_  generation:  0.496246337890625
local_output_nid generation:  0.04309201240539551
local_in_edges_tensor generation:  0.04044628143310547
mini_batch_src_global generation:  0.05728602409362793
r_  generation:  0.5081255435943604
local_output_nid generation:  0.04086709022521973
local_in_edges_tensor generation:  0.035104990005493164
mini_batch_src_global generation:  0.059179067611694336
r_  generation:  0.5019490718841553
local_output_nid generation:  0.04088950157165527
local_in_edges_tensor generation:  0.03955411911010742
mini_batch_src_global generation:  0.05564165115356445
r_  generation:  0.5039334297180176
local_output_nid generation:  0.04036712646484375
local_in_edges_tensor generation:  0.04340243339538574
mini_batch_src_global generation:  0.05589604377746582
r_  generation:  0.508103609085083
local_output_nid generation:  0.04074978828430176
local_in_edges_tensor generation:  0.03688669204711914
mini_batch_src_global generation:  0.05663728713989258
r_  generation:  0.5161492824554443
local_output_nid generation:  0.0405275821685791
local_in_edges_tensor generation:  0.040717124938964844
mini_batch_src_global generation:  0.057306528091430664
r_  generation:  0.51271653175354
local_output_nid generation:  0.04075479507446289
local_in_edges_tensor generation:  0.051854610443115234
mini_batch_src_global generation:  0.055684566497802734
r_  generation:  0.5129773616790771
local_output_nid generation:  0.04095911979675293
local_in_edges_tensor generation:  0.04355573654174805
mini_batch_src_global generation:  0.05656170845031738
r_  generation:  0.518017053604126
local_output_nid generation:  0.04103589057922363
local_in_edges_tensor generation:  0.0441746711730957
mini_batch_src_global generation:  0.05550026893615723
r_  generation:  0.5214393138885498
local_output_nid generation:  0.04102373123168945
local_in_edges_tensor generation:  0.04434776306152344
mini_batch_src_global generation:  0.0561985969543457
r_  generation:  0.5177955627441406
local_output_nid generation:  0.040933847427368164
local_in_edges_tensor generation:  0.0357365608215332
mini_batch_src_global generation:  0.0585789680480957
r_  generation:  0.5186305046081543
local_output_nid generation:  0.04093647003173828
local_in_edges_tensor generation:  0.03927135467529297
mini_batch_src_global generation:  0.056880950927734375
r_  generation:  0.5216336250305176
local_output_nid generation:  0.04192042350769043
local_in_edges_tensor generation:  0.04650688171386719
mini_batch_src_global generation:  0.0594782829284668
r_  generation:  0.514542818069458
local_output_nid generation:  0.04164481163024902
local_in_edges_tensor generation:  0.041790008544921875
mini_batch_src_global generation:  0.06171679496765137
r_  generation:  0.5290870666503906
local_output_nid generation:  0.04398655891418457
local_in_edges_tensor generation:  0.044338226318359375
mini_batch_src_global generation:  0.06131386756896973
r_  generation:  0.520200252532959
----------------------check_connections_block total spend ----------------------------- 12.40879511833191
generate_one_block  0.6361441612243652
generate_one_block  0.6393392086029053
generate_one_block  0.6368205547332764
generate_one_block  0.6465151309967041
generate_one_block  0.6484165191650391
generate_one_block  0.7219016551971436
generate_one_block  0.6327428817749023
generate_one_block  0.6228845119476318
generate_one_block  0.6391217708587646
generate_one_block  0.6408894062042236
generate_one_block  0.6388964653015137
generate_one_block  0.7106242179870605
generate_one_block  0.6316289901733398
generate_one_block  0.6337611675262451
generate_one_block  0.639901876449585
generate_one_block  0.6600689888000488
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

connection checking time:  42.80532765388489
block generation total time  36.35376310348511
average batch blocks generation time:  2.272110193967819
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12463235855102539  GigaBytes
Max Memory Allocated: 0.12463235855102539  GigaBytes

torch.Size([166356, 128])
torch.Size([164052, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.37 GiB already allocated; 12.44 MiB free; 22.41 GiB reserved in total by PyTorch)
