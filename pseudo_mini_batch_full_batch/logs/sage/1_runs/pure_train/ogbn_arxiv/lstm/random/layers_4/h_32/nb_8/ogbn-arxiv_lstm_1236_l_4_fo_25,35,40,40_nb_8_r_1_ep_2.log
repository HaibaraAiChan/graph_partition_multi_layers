Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648484824.9534912
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024926185607910156
random selection method range initialization spend 0.006134510040283203
time for parepare:  0.018349885940551758
local_output_nid generation:  0.00422215461730957
local_in_edges_tensor generation:  0.006311178207397461
mini_batch_src_global generation:  0.0032911300659179688
r_  generation:  0.03671574592590332
local_output_nid generation:  0.005482196807861328
local_in_edges_tensor generation:  0.003156423568725586
mini_batch_src_global generation:  0.00391387939453125
r_  generation:  0.03836178779602051
local_output_nid generation:  0.005994319915771484
local_in_edges_tensor generation:  0.003203153610229492
mini_batch_src_global generation:  0.002701282501220703
r_  generation:  0.0386965274810791
local_output_nid generation:  0.0060465335845947266
local_in_edges_tensor generation:  0.0031239986419677734
mini_batch_src_global generation:  0.002995014190673828
r_  generation:  0.04001259803771973
local_output_nid generation:  0.006027698516845703
local_in_edges_tensor generation:  0.0031807422637939453
mini_batch_src_global generation:  0.002987384796142578
r_  generation:  0.04041647911071777
local_output_nid generation:  0.006041049957275391
local_in_edges_tensor generation:  0.003288745880126953
mini_batch_src_global generation:  0.0032804012298583984
r_  generation:  0.042181968688964844
local_output_nid generation:  0.00610041618347168
local_in_edges_tensor generation:  0.0032036304473876953
mini_batch_src_global generation:  0.0032274723052978516
r_  generation:  0.04122567176818848
local_output_nid generation:  0.0060656070709228516
local_in_edges_tensor generation:  0.0032219886779785156
mini_batch_src_global generation:  0.003399372100830078
r_  generation:  0.04178667068481445
----------------------check_connections_block total spend ----------------------------- 0.5137274265289307
generate_one_block  0.05546164512634277
generate_one_block  0.05497097969055176
generate_one_block  0.05466103553771973
generate_one_block  0.054961204528808594
generate_one_block  0.05735325813293457
generate_one_block  0.05548357963562012
generate_one_block  0.05449390411376953
generate_one_block  0.05472970008850098
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04223942756652832
gen group dst list time:  0.015458822250366211
time for parepare:  0.019783735275268555
local_output_nid generation:  0.013629913330078125
local_in_edges_tensor generation:  0.03315901756286621
mini_batch_src_global generation:  0.028780698776245117
r_  generation:  0.299579381942749
local_output_nid generation:  0.02219104766845703
local_in_edges_tensor generation:  0.02980637550354004
mini_batch_src_global generation:  0.03687334060668945
r_  generation:  0.31965112686157227
local_output_nid generation:  0.0274503231048584
local_in_edges_tensor generation:  0.02262282371520996
mini_batch_src_global generation:  0.036338090896606445
r_  generation:  0.32555580139160156
local_output_nid generation:  0.02198195457458496
local_in_edges_tensor generation:  0.02490520477294922
mini_batch_src_global generation:  0.03984642028808594
r_  generation:  0.3217482566833496
local_output_nid generation:  0.0219881534576416
local_in_edges_tensor generation:  0.01982855796813965
mini_batch_src_global generation:  0.03787565231323242
r_  generation:  0.32361888885498047
local_output_nid generation:  0.019901514053344727
local_in_edges_tensor generation:  0.037261247634887695
mini_batch_src_global generation:  0.07137084007263184
r_  generation:  0.34851598739624023
local_output_nid generation:  0.020595788955688477
local_in_edges_tensor generation:  0.024637222290039062
mini_batch_src_global generation:  0.04537820816040039
r_  generation:  0.31989336013793945
local_output_nid generation:  0.01853489875793457
local_in_edges_tensor generation:  0.018870830535888672
mini_batch_src_global generation:  0.0401921272277832
r_  generation:  0.32051682472229004
----------------------check_connections_block total spend ----------------------------- 3.8790929317474365
generate_one_block  0.4157271385192871
generate_one_block  0.4158031940460205
generate_one_block  0.41269493103027344
generate_one_block  0.4368281364440918
generate_one_block  0.43529486656188965
generate_one_block  0.43601465225219727
generate_one_block  0.4507002830505371
generate_one_block  0.42278313636779785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06591463088989258
gen group dst list time:  0.042859554290771484
time for parepare:  0.02096247673034668
local_output_nid generation:  0.030467987060546875
local_in_edges_tensor generation:  0.10002708435058594
mini_batch_src_global generation:  0.05171489715576172
r_  generation:  0.5089631080627441
local_output_nid generation:  0.04761648178100586
local_in_edges_tensor generation:  0.05586862564086914
mini_batch_src_global generation:  0.06042337417602539
r_  generation:  0.5220348834991455
local_output_nid generation:  0.03576350212097168
local_in_edges_tensor generation:  0.05005621910095215
mini_batch_src_global generation:  0.0684514045715332
r_  generation:  0.5323591232299805
local_output_nid generation:  0.0347898006439209
local_in_edges_tensor generation:  0.0505673885345459
mini_batch_src_global generation:  0.07921099662780762
r_  generation:  0.5291781425476074
local_output_nid generation:  0.03639078140258789
local_in_edges_tensor generation:  0.04206585884094238
mini_batch_src_global generation:  0.058441877365112305
r_  generation:  0.5329186916351318
local_output_nid generation:  0.03537726402282715
local_in_edges_tensor generation:  0.042582035064697266
mini_batch_src_global generation:  0.06246805191040039
r_  generation:  0.5237116813659668
local_output_nid generation:  0.03535199165344238
local_in_edges_tensor generation:  0.0520024299621582
mini_batch_src_global generation:  0.07127976417541504
r_  generation:  0.5402297973632812
local_output_nid generation:  0.03591609001159668
local_in_edges_tensor generation:  0.047271728515625
mini_batch_src_global generation:  0.0650482177734375
r_  generation:  0.5377962589263916
----------------------check_connections_block total spend ----------------------------- 6.435871839523315
generate_one_block  0.665259599685669
generate_one_block  0.6666853427886963
generate_one_block  0.6877703666687012
generate_one_block  0.671868085861206
generate_one_block  0.6555442810058594
generate_one_block  0.7223823070526123
generate_one_block  0.6583449840545654
generate_one_block  0.6929011344909668
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03827095031738281
gen group dst list time:  0.0463109016418457
time for parepare:  0.018891572952270508
local_output_nid generation:  0.03373217582702637
local_in_edges_tensor generation:  0.05470466613769531
mini_batch_src_global generation:  0.04555201530456543
r_  generation:  0.5027339458465576
local_output_nid generation:  0.03847694396972656
local_in_edges_tensor generation:  0.0390775203704834
mini_batch_src_global generation:  0.05792498588562012
r_  generation:  0.5141611099243164
local_output_nid generation:  0.03910517692565918
local_in_edges_tensor generation:  0.04018807411193848
mini_batch_src_global generation:  0.06079578399658203
r_  generation:  0.5150840282440186
local_output_nid generation:  0.03807830810546875
local_in_edges_tensor generation:  0.04037356376647949
mini_batch_src_global generation:  0.05510210990905762
r_  generation:  0.5211670398712158
local_output_nid generation:  0.03800368309020996
local_in_edges_tensor generation:  0.03931474685668945
mini_batch_src_global generation:  0.05529022216796875
r_  generation:  0.5169384479522705
local_output_nid generation:  0.03840303421020508
local_in_edges_tensor generation:  0.039301156997680664
mini_batch_src_global generation:  0.05439138412475586
r_  generation:  0.5268948078155518
local_output_nid generation:  0.03896617889404297
local_in_edges_tensor generation:  0.047391653060913086
mini_batch_src_global generation:  0.0749504566192627
r_  generation:  0.517848014831543
local_output_nid generation:  0.038362741470336914
local_in_edges_tensor generation:  0.03867793083190918
mini_batch_src_global generation:  0.05445218086242676
r_  generation:  0.5265774726867676
----------------------check_connections_block total spend ----------------------------- 6.199640989303589
generate_one_block  0.6187458038330078
generate_one_block  0.6436395645141602
generate_one_block  0.6342828273773193
generate_one_block  0.6378145217895508
generate_one_block  0.6388440132141113
generate_one_block  0.6286568641662598
generate_one_block  0.690528154373169
generate_one_block  0.6450085639953613
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

connection checking time:  16.51460576057434
block generation total time  13.98412275314331
average batch blocks generation time:  1.7480153441429138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11170291900634766  GigaBytes
Max Memory Allocated: 0.11170291900634766  GigaBytes

torch.Size([165583, 128])
torch.Size([161366, 32])
torch.Size([142222, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3397216796875 GB
    Memory Allocated: 16.996997356414795  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1893310546875 GB
    Memory Allocated: 0.11408805847167969  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

torch.Size([165536, 128])
torch.Size([161140, 32])
torch.Size([141756, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2264404296875 GB
    Memory Allocated: 16.982975959777832  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2264404296875 GB
    Memory Allocated: 0.11405181884765625  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

torch.Size([165540, 128])
torch.Size([161281, 32])
torch.Size([142355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2264404296875 GB
    Memory Allocated: 16.994174003601074  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2264404296875 GB
    Memory Allocated: 0.11409568786621094  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

torch.Size([165568, 128])
torch.Size([161323, 32])
torch.Size([142074, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2264404296875 GB
    Memory Allocated: 16.97932195663452  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2264404296875 GB
    Memory Allocated: 0.11391878128051758  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

torch.Size([165405, 128])
torch.Size([161071, 32])
torch.Size([141749, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 16.956499576568604  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11414718627929688  GigaBytes
Max Memory Allocated: 17.009910106658936  GigaBytes

torch.Size([165470, 128])
torch.Size([161062, 32])
torch.Size([141775, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 17.023290634155273  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11402320861816406  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165464, 128])
torch.Size([161099, 32])
torch.Size([141795, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 16.99510908126831  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.1140446662902832  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165385, 128])
torch.Size([161188, 32])
torch.Size([142249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 16.993935108184814  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041577935218811035 |0.07442545890808105 |0.457014799118042 |0.00011685490608215332 |0.4866977035999298 |0.008636474609375 |
----------------------------------------------------------pseudo_mini_loss sum 4.481729507446289
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292585
Number of first layer input nodes during this epoch:  1323951
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.1713547706604004  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02523350715637207
random selection method range initialization spend 0.005040407180786133
time for parepare:  0.017618656158447266
local_output_nid generation:  0.004979133605957031
local_in_edges_tensor generation:  0.006262063980102539
mini_batch_src_global generation:  0.0032584667205810547
r_  generation:  0.037613630294799805
local_output_nid generation:  0.0060536861419677734
local_in_edges_tensor generation:  0.003127574920654297
mini_batch_src_global generation:  0.004326343536376953
r_  generation:  0.04138040542602539
local_output_nid generation:  0.006188154220581055
local_in_edges_tensor generation:  0.003357410430908203
mini_batch_src_global generation:  0.0029168128967285156
r_  generation:  0.041600942611694336
local_output_nid generation:  0.006257772445678711
local_in_edges_tensor generation:  0.0032541751861572266
mini_batch_src_global generation:  0.0030951499938964844
r_  generation:  0.04214596748352051
local_output_nid generation:  0.006211757659912109
local_in_edges_tensor generation:  0.003277301788330078
mini_batch_src_global generation:  0.003265857696533203
r_  generation:  0.04326510429382324
local_output_nid generation:  0.0062313079833984375
local_in_edges_tensor generation:  0.0031862258911132812
mini_batch_src_global generation:  0.0033426284790039062
r_  generation:  0.04308271408081055
local_output_nid generation:  0.00619816780090332
local_in_edges_tensor generation:  0.0032737255096435547
mini_batch_src_global generation:  0.0033130645751953125
r_  generation:  0.04252767562866211
local_output_nid generation:  0.0062906742095947266
local_in_edges_tensor generation:  0.003254413604736328
mini_batch_src_global generation:  0.0033941268920898438
r_  generation:  0.04283761978149414
----------------------check_connections_block total spend ----------------------------- 0.536470890045166
generate_one_block  0.06518244743347168
generate_one_block  0.06314349174499512
generate_one_block  0.06307601928710938
generate_one_block  0.06351709365844727
generate_one_block  0.0632023811340332
generate_one_block  0.06528615951538086
generate_one_block  0.06569385528564453
generate_one_block  0.06324982643127441
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04046821594238281
gen group dst list time:  0.014899969100952148
time for parepare:  0.02176356315612793
local_output_nid generation:  0.013657808303833008
local_in_edges_tensor generation:  0.03068089485168457
mini_batch_src_global generation:  0.03061223030090332
r_  generation:  0.31188297271728516
local_output_nid generation:  0.020797014236450195
local_in_edges_tensor generation:  0.03533124923706055
mini_batch_src_global generation:  0.040102481842041016
r_  generation:  0.33097314834594727
local_output_nid generation:  0.02039051055908203
local_in_edges_tensor generation:  0.0273287296295166
mini_batch_src_global generation:  0.036618709564208984
r_  generation:  0.3227071762084961
local_output_nid generation:  0.018978118896484375
local_in_edges_tensor generation:  0.02156233787536621
mini_batch_src_global generation:  0.0379180908203125
r_  generation:  0.3290891647338867
local_output_nid generation:  0.01900172233581543
local_in_edges_tensor generation:  0.02169489860534668
mini_batch_src_global generation:  0.03855180740356445
r_  generation:  0.3235781192779541
local_output_nid generation:  0.018658161163330078
local_in_edges_tensor generation:  0.023838281631469727
mini_batch_src_global generation:  0.03849673271179199
r_  generation:  0.32163453102111816
local_output_nid generation:  0.01893162727355957
local_in_edges_tensor generation:  0.021045684814453125
mini_batch_src_global generation:  0.03844499588012695
r_  generation:  0.32165002822875977
local_output_nid generation:  0.0188601016998291
local_in_edges_tensor generation:  0.02141427993774414
mini_batch_src_global generation:  0.03848528861999512
r_  generation:  0.31999874114990234
----------------------check_connections_block total spend ----------------------------- 3.812204599380493
generate_one_block  0.4338517189025879
generate_one_block  0.44283127784729004
generate_one_block  0.42514777183532715
generate_one_block  0.4280056953430176
generate_one_block  0.42846131324768066
generate_one_block  0.4269554615020752
generate_one_block  0.42330288887023926
generate_one_block  0.4422266483306885
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04621171951293945
gen group dst list time:  0.036867618560791016
time for parepare:  0.01889801025390625
local_output_nid generation:  0.029397010803222656
local_in_edges_tensor generation:  0.061499595642089844
mini_batch_src_global generation:  0.04849100112915039
r_  generation:  0.5289459228515625
local_output_nid generation:  0.03605079650878906
local_in_edges_tensor generation:  0.05666613578796387
mini_batch_src_global generation:  0.0595548152923584
r_  generation:  0.5428042411804199
local_output_nid generation:  0.04003405570983887
local_in_edges_tensor generation:  0.05604147911071777
mini_batch_src_global generation:  0.07139015197753906
r_  generation:  0.5367119312286377
local_output_nid generation:  0.03650927543640137
local_in_edges_tensor generation:  0.044794559478759766
mini_batch_src_global generation:  0.059293270111083984
r_  generation:  0.5270686149597168
local_output_nid generation:  0.037274837493896484
local_in_edges_tensor generation:  0.03883981704711914
mini_batch_src_global generation:  0.060965538024902344
r_  generation:  0.5355737209320068
local_output_nid generation:  0.03733110427856445
local_in_edges_tensor generation:  0.035166263580322266
mini_batch_src_global generation:  0.05977368354797363
r_  generation:  0.5285181999206543
local_output_nid generation:  0.036739349365234375
local_in_edges_tensor generation:  0.04357647895812988
mini_batch_src_global generation:  0.05795550346374512
r_  generation:  0.547774076461792
local_output_nid generation:  0.03656768798828125
local_in_edges_tensor generation:  0.0389246940612793
mini_batch_src_global generation:  0.06043052673339844
r_  generation:  0.5429940223693848
----------------------check_connections_block total spend ----------------------------- 6.3769261837005615
generate_one_block  0.6965432167053223
generate_one_block  0.6931321620941162
generate_one_block  0.6946873664855957
generate_one_block  0.6776289939880371
generate_one_block  0.6782610416412354
generate_one_block  0.6865420341491699
generate_one_block  0.7186722755432129
generate_one_block  0.6767990589141846
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037911415100097656
gen group dst list time:  0.05060243606567383
time for parepare:  0.019311189651489258
local_output_nid generation:  0.03672218322753906
local_in_edges_tensor generation:  0.051835060119628906
mini_batch_src_global generation:  0.04537200927734375
r_  generation:  0.5482215881347656
local_output_nid generation:  0.04077267646789551
local_in_edges_tensor generation:  0.05277132987976074
mini_batch_src_global generation:  0.05694913864135742
r_  generation:  0.5319106578826904
local_output_nid generation:  0.03923773765563965
local_in_edges_tensor generation:  0.04789376258850098
mini_batch_src_global generation:  0.06335568428039551
r_  generation:  0.5218310356140137
local_output_nid generation:  0.04232215881347656
local_in_edges_tensor generation:  0.03944134712219238
mini_batch_src_global generation:  0.05496621131896973
r_  generation:  0.5270853042602539
local_output_nid generation:  0.04102039337158203
local_in_edges_tensor generation:  0.04643440246582031
mini_batch_src_global generation:  0.055237770080566406
r_  generation:  0.5250458717346191
local_output_nid generation:  0.04031968116760254
local_in_edges_tensor generation:  0.04393744468688965
mini_batch_src_global generation:  0.05409717559814453
r_  generation:  0.5288619995117188
local_output_nid generation:  0.04021334648132324
local_in_edges_tensor generation:  0.04398965835571289
mini_batch_src_global generation:  0.05547475814819336
r_  generation:  0.5253903865814209
local_output_nid generation:  0.04022645950317383
local_in_edges_tensor generation:  0.03605818748474121
mini_batch_src_global generation:  0.05596637725830078
r_  generation:  0.5435659885406494
----------------------check_connections_block total spend ----------------------------- 6.342207670211792
generate_one_block  0.6543371677398682
generate_one_block  0.661858081817627
generate_one_block  0.6574544906616211
generate_one_block  0.65445876121521
generate_one_block  0.6634793281555176
generate_one_block  0.6691265106201172
generate_one_block  0.6686928272247314
generate_one_block  0.6439249515533447
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.1713547706604004  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

connection checking time:  16.531338453292847
block generation total time  14.246381044387817
average batch blocks generation time:  1.7807976305484772
block dataloader generation time/epoch 33.24330472946167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11539173126220703  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165541, 128])
torch.Size([161136, 32])
torch.Size([142101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 17.00414276123047  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11547231674194336  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165475, 128])
torch.Size([161183, 32])
torch.Size([142505, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 17.013906002044678  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11540937423706055  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165471, 128])
torch.Size([161177, 32])
torch.Size([142096, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 16.994576930999756  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11539697647094727  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165469, 128])
torch.Size([160974, 32])
torch.Size([141843, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 16.994815826416016  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4686279296875 GB
    Memory Allocated: 0.11541557312011719  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165518, 128])
torch.Size([161324, 32])
torch.Size([142187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 17.01241445541382  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 0.11532354354858398  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165605, 128])
torch.Size([161309, 32])
torch.Size([142045, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 16.979912757873535  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 0.11535406112670898  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165521, 128])
torch.Size([161365, 32])
torch.Size([142318, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 17.001163482666016  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 0.11521387100219727  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

torch.Size([165395, 128])
torch.Size([160976, 32])
torch.Size([141742, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4725341796875 GB
    Memory Allocated: 16.96311044692993  GigaBytes
Max Memory Allocated: 17.037453651428223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04636767506599426 |0.028423070907592773 |0.360540509223938 |9.775161743164062e-05 |0.483720064163208 |0.007699728012084961 |
----------------------------------------------------------pseudo_mini_loss sum 3.9558544158935547
Total (block generation + training)time/epoch 40.62843680381775
Training time/epoch 7.384856224060059
Training time without block to device /epoch 7.157471656799316
Training time without total dataloading part /epoch 6.762566328048706
load block tensor time/epoch 0.3709414005279541
block to device time/epoch 0.2273845672607422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4293945
Number of first layer input nodes during this epoch:  1323995
