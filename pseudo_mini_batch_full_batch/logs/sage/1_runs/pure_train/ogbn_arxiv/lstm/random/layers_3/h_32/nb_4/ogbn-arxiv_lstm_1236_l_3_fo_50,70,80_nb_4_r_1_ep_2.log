Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648455758.7704153
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02613043785095215
random selection method range initialization spend 0.005689144134521484
time for parepare:  0.019696474075317383
local_output_nid generation:  0.008410453796386719
local_in_edges_tensor generation:  0.007941961288452148
mini_batch_src_global generation:  0.007640361785888672
r_  generation:  0.09094548225402832
local_output_nid generation:  0.011789560317993164
local_in_edges_tensor generation:  0.0062351226806640625
mini_batch_src_global generation:  0.01004338264465332
r_  generation:  0.09990453720092773
local_output_nid generation:  0.012012481689453125
local_in_edges_tensor generation:  0.006322383880615234
mini_batch_src_global generation:  0.007747650146484375
r_  generation:  0.1012723445892334
local_output_nid generation:  0.012054681777954102
local_in_edges_tensor generation:  0.006166696548461914
mini_batch_src_global generation:  0.008623123168945312
r_  generation:  0.10349750518798828
----------------------check_connections_block total spend ----------------------------- 0.6118943691253662
generate_one_block  0.1148989200592041
generate_one_block  0.1177523136138916
generate_one_block  0.11618161201477051
generate_one_block  0.11577343940734863
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04150557518005371
gen group dst list time:  0.012287378311157227
time for parepare:  0.019150733947753906
local_output_nid generation:  0.01984548568725586
local_in_edges_tensor generation:  0.04656815528869629
mini_batch_src_global generation:  0.048984527587890625
r_  generation:  0.47090697288513184
local_output_nid generation:  0.02709197998046875
local_in_edges_tensor generation:  0.048537254333496094
mini_batch_src_global generation:  0.05693960189819336
r_  generation:  0.493438720703125
local_output_nid generation:  0.028108596801757812
local_in_edges_tensor generation:  0.05474138259887695
mini_batch_src_global generation:  0.06741499900817871
r_  generation:  0.48827385902404785
local_output_nid generation:  0.02680683135986328
local_in_edges_tensor generation:  0.033796072006225586
mini_batch_src_global generation:  0.061278343200683594
r_  generation:  0.48682093620300293
----------------------check_connections_block total spend ----------------------------- 2.9111263751983643
generate_one_block  0.6529064178466797
generate_one_block  0.649092435836792
generate_one_block  0.6489803791046143
generate_one_block  0.6159884929656982
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04516935348510742
gen group dst list time:  0.024199485778808594
time for parepare:  0.01923394203186035
local_output_nid generation:  0.03017139434814453
local_in_edges_tensor generation:  0.06499028205871582
mini_batch_src_global generation:  0.05702352523803711
r_  generation:  0.5597128868103027
local_output_nid generation:  0.03743338584899902
local_in_edges_tensor generation:  0.05706596374511719
mini_batch_src_global generation:  0.06565499305725098
r_  generation:  0.5782487392425537
local_output_nid generation:  0.03794527053833008
local_in_edges_tensor generation:  0.04723072052001953
mini_batch_src_global generation:  0.06542110443115234
r_  generation:  0.5769762992858887
local_output_nid generation:  0.03744244575500488
local_in_edges_tensor generation:  0.04186058044433594
mini_batch_src_global generation:  0.06415581703186035
r_  generation:  0.5989558696746826
----------------------check_connections_block total spend ----------------------------- 3.454639196395874
generate_one_block  0.7705376148223877
generate_one_block  0.7432575225830078
generate_one_block  0.7497084140777588
generate_one_block  0.7343404293060303
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  6.365765571594238
block generation total time  5.564811706542969
average batch blocks generation time:  1.3912029266357422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10694169998168945  GigaBytes
Max Memory Allocated: 0.10694169998168945  GigaBytes

torch.Size([165663, 128])
torch.Size([157313, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3690185546875 GB
    Memory Allocated: 17.01985502243042  GigaBytes
Max Memory Allocated: 17.048397541046143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9510498046875 GB
    Memory Allocated: 0.1107635498046875  GigaBytes
Max Memory Allocated: 17.048397541046143  GigaBytes

torch.Size([165613, 128])
torch.Size([157241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8143310546875 GB
    Memory Allocated: 17.05636739730835  GigaBytes
Max Memory Allocated: 17.088336944580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8143310546875 GB
    Memory Allocated: 0.11084651947021484  GigaBytes
Max Memory Allocated: 17.088336944580078  GigaBytes

torch.Size([165785, 128])
torch.Size([157409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 17.085457801818848  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 0.11083984375  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

torch.Size([165843, 128])
torch.Size([157573, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 17.05627679824829  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0419582724571228 |0.10198229551315308 |0.9078420996665955 |0.00014019012451171875 |1.139517068862915 |0.011582612991333008 |
----------------------------------------------------------pseudo_mini_loss sum 4.3907060623168945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1722200
Number of first layer input nodes during this epoch:  662904
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 0.1553955078125  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029588937759399414
random selection method range initialization spend 0.004900932312011719
time for parepare:  0.019502878189086914
local_output_nid generation:  0.008803844451904297
local_in_edges_tensor generation:  0.011153936386108398
mini_batch_src_global generation:  0.007411003112792969
r_  generation:  0.0907444953918457
local_output_nid generation:  0.011944055557250977
local_in_edges_tensor generation:  0.00874638557434082
mini_batch_src_global generation:  0.014190912246704102
r_  generation:  0.09811639785766602
local_output_nid generation:  0.012237071990966797
local_in_edges_tensor generation:  0.006196737289428711
mini_batch_src_global generation:  0.007977485656738281
r_  generation:  0.10764837265014648
local_output_nid generation:  0.012195825576782227
local_in_edges_tensor generation:  0.006233930587768555
mini_batch_src_global generation:  0.008727073669433594
r_  generation:  0.10562753677368164
----------------------check_connections_block total spend ----------------------------- 0.6292033195495605
generate_one_block  0.13849663734436035
generate_one_block  0.1367177963256836
generate_one_block  0.1379532814025879
generate_one_block  0.14803051948547363
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.046871185302734375
gen group dst list time:  0.022266387939453125
time for parepare:  0.025450944900512695
local_output_nid generation:  0.022597789764404297
local_in_edges_tensor generation:  0.057187557220458984
mini_batch_src_global generation:  0.061338186264038086
r_  generation:  0.47116780281066895
local_output_nid generation:  0.034539222717285156
local_in_edges_tensor generation:  0.04979848861694336
mini_batch_src_global generation:  0.0565495491027832
r_  generation:  0.48775506019592285
local_output_nid generation:  0.030573606491088867
local_in_edges_tensor generation:  0.041132450103759766
mini_batch_src_global generation:  0.0564882755279541
r_  generation:  0.4927694797515869
local_output_nid generation:  0.03020167350769043
local_in_edges_tensor generation:  0.031589508056640625
mini_batch_src_global generation:  0.0576629638671875
r_  generation:  0.48966336250305176
----------------------check_connections_block total spend ----------------------------- 2.9255852699279785
generate_one_block  0.6696469783782959
generate_one_block  0.700373649597168
generate_one_block  0.7098157405853271
generate_one_block  0.7295429706573486
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04021763801574707
gen group dst list time:  0.025869131088256836
time for parepare:  0.02055954933166504
local_output_nid generation:  0.030232667922973633
local_in_edges_tensor generation:  0.06176042556762695
mini_batch_src_global generation:  0.05427098274230957
r_  generation:  0.5889606475830078
local_output_nid generation:  0.03692984580993652
local_in_edges_tensor generation:  0.05615401268005371
mini_batch_src_global generation:  0.06588029861450195
r_  generation:  0.6047863960266113
local_output_nid generation:  0.041166067123413086
local_in_edges_tensor generation:  0.0616459846496582
mini_batch_src_global generation:  0.06731581687927246
r_  generation:  0.574122428894043
local_output_nid generation:  0.03849625587463379
local_in_edges_tensor generation:  0.044053077697753906
mini_batch_src_global generation:  0.06481289863586426
r_  generation:  0.5751838684082031
----------------------check_connections_block total spend ----------------------------- 3.5373852252960205
generate_one_block  0.7952067852020264
generate_one_block  0.8017826080322266
generate_one_block  0.7897341251373291
generate_one_block  0.8192801475524902
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 0.1553955078125  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

connection checking time:  6.462970495223999
block generation total time  6.015383005142212
average batch blocks generation time:  1.503845751285553
block dataloader generation time/epoch 14.890902280807495
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 0.11197185516357422  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

torch.Size([165707, 128])
torch.Size([157233, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 17.032048225402832  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 0.11194324493408203  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

torch.Size([165589, 128])
torch.Size([157198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 17.06258249282837  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8280029296875 GB
    Memory Allocated: 0.11208724975585938  GigaBytes
Max Memory Allocated: 17.117348194122314  GigaBytes

torch.Size([165773, 128])
torch.Size([157456, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8338623046875 GB
    Memory Allocated: 17.09953784942627  GigaBytes
Max Memory Allocated: 17.13200616836548  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8338623046875 GB
    Memory Allocated: 0.11203193664550781  GigaBytes
Max Memory Allocated: 17.13200616836548  GigaBytes

torch.Size([165757, 128])
torch.Size([157452, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8338623046875 GB
    Memory Allocated: 17.064192295074463  GigaBytes
Max Memory Allocated: 17.13200616836548  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03889113664627075 |0.03002113103866577 |0.6622623205184937 |0.00012159347534179688 |1.1442469954490662 |0.008500337600708008 |
----------------------------------------------------------pseudo_mini_loss sum 3.705998659133911
Total (block generation + training)time/epoch 22.420499801635742
Training time/epoch 7.529350519180298
Training time without block to device /epoch 7.409265995025635
Training time without total dataloading part /epoch 7.2350239753723145
load block tensor time/epoch 0.155564546585083
block to device time/epoch 0.12008452415466309
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1721703
Number of first layer input nodes during this epoch:  662826
