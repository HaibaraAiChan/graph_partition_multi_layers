Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648460556.9571288
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02750539779663086
random selection method range initialization spend 0.0061228275299072266
time for parepare:  0.018757343292236328
local_output_nid generation:  0.004279375076293945
local_in_edges_tensor generation:  0.006659507751464844
mini_batch_src_global generation:  0.0037643909454345703
r_  generation:  0.04165482521057129
local_output_nid generation:  0.005726814270019531
local_in_edges_tensor generation:  0.0033473968505859375
mini_batch_src_global generation:  0.004813671112060547
r_  generation:  0.04373645782470703
local_output_nid generation:  0.0060422420501708984
local_in_edges_tensor generation:  0.0032825469970703125
mini_batch_src_global generation:  0.0033025741577148438
r_  generation:  0.044272661209106445
local_output_nid generation:  0.006093263626098633
local_in_edges_tensor generation:  0.0034770965576171875
mini_batch_src_global generation:  0.003503084182739258
r_  generation:  0.044896841049194336
local_output_nid generation:  0.006070375442504883
local_in_edges_tensor generation:  0.003198385238647461
mini_batch_src_global generation:  0.0036170482635498047
r_  generation:  0.046117305755615234
local_output_nid generation:  0.0061419010162353516
local_in_edges_tensor generation:  0.00339508056640625
mini_batch_src_global generation:  0.0038123130798339844
r_  generation:  0.045995235443115234
local_output_nid generation:  0.006131649017333984
local_in_edges_tensor generation:  0.0033240318298339844
mini_batch_src_global generation:  0.004038810729980469
r_  generation:  0.04741549491882324
local_output_nid generation:  0.0061626434326171875
local_in_edges_tensor generation:  0.003294229507446289
mini_batch_src_global generation:  0.0039825439453125
r_  generation:  0.048641204833984375
----------------------check_connections_block total spend ----------------------------- 0.5736868381500244
generate_one_block  0.06294536590576172
generate_one_block  0.06373715400695801
generate_one_block  0.0630197525024414
generate_one_block  0.06203031539916992
generate_one_block  0.06533122062683105
generate_one_block  0.06277346611022949
generate_one_block  0.06287384033203125
generate_one_block  0.06422233581542969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03947925567626953
gen group dst list time:  0.016202449798583984
time for parepare:  0.019639968872070312
local_output_nid generation:  0.015290260314941406
local_in_edges_tensor generation:  0.033926963806152344
mini_batch_src_global generation:  0.03344917297363281
r_  generation:  0.32459044456481934
local_output_nid generation:  0.023427724838256836
local_in_edges_tensor generation:  0.03137397766113281
mini_batch_src_global generation:  0.04243636131286621
r_  generation:  0.34534382820129395
local_output_nid generation:  0.0228884220123291
local_in_edges_tensor generation:  0.02588200569152832
mini_batch_src_global generation:  0.03901839256286621
r_  generation:  0.3666391372680664
local_output_nid generation:  0.025426387786865234
local_in_edges_tensor generation:  0.035025596618652344
mini_batch_src_global generation:  0.04935288429260254
r_  generation:  0.3356142044067383
local_output_nid generation:  0.020111083984375
local_in_edges_tensor generation:  0.025044679641723633
mini_batch_src_global generation:  0.03985261917114258
r_  generation:  0.33968305587768555
local_output_nid generation:  0.02026081085205078
local_in_edges_tensor generation:  0.029537200927734375
mini_batch_src_global generation:  0.04060864448547363
r_  generation:  0.34088659286499023
local_output_nid generation:  0.020479440689086914
local_in_edges_tensor generation:  0.023207426071166992
mini_batch_src_global generation:  0.0430760383605957
r_  generation:  0.34308433532714844
local_output_nid generation:  0.02017807960510254
local_in_edges_tensor generation:  0.023221731185913086
mini_batch_src_global generation:  0.041082143783569336
r_  generation:  0.3439633846282959
----------------------check_connections_block total spend ----------------------------- 4.087508916854858
generate_one_block  0.46405529975891113
generate_one_block  0.4439821243286133
generate_one_block  0.4514622688293457
generate_one_block  0.4355201721191406
generate_one_block  0.43376684188842773
generate_one_block  0.4538090229034424
generate_one_block  0.441678524017334
generate_one_block  0.4420015811920166
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03485679626464844
gen group dst list time:  0.036400794982910156
time for parepare:  0.0189666748046875
local_output_nid generation:  0.029805660247802734
local_in_edges_tensor generation:  0.06873345375061035
mini_batch_src_global generation:  0.04465317726135254
r_  generation:  0.48336100578308105
local_output_nid generation:  0.035180091857910156
local_in_edges_tensor generation:  0.05112004280090332
mini_batch_src_global generation:  0.06636929512023926
r_  generation:  0.5239589214324951
local_output_nid generation:  0.038916587829589844
local_in_edges_tensor generation:  0.04873156547546387
mini_batch_src_global generation:  0.05868649482727051
r_  generation:  0.49806690216064453
local_output_nid generation:  0.03650856018066406
local_in_edges_tensor generation:  0.04183197021484375
mini_batch_src_global generation:  0.05385327339172363
r_  generation:  0.4916648864746094
local_output_nid generation:  0.03660321235656738
local_in_edges_tensor generation:  0.03887653350830078
mini_batch_src_global generation:  0.05282759666442871
r_  generation:  0.4967939853668213
local_output_nid generation:  0.0362086296081543
local_in_edges_tensor generation:  0.03807473182678223
mini_batch_src_global generation:  0.05491805076599121
r_  generation:  0.493088960647583
local_output_nid generation:  0.03636026382446289
local_in_edges_tensor generation:  0.047286272048950195
mini_batch_src_global generation:  0.054578542709350586
r_  generation:  0.502971887588501
local_output_nid generation:  0.03635907173156738
local_in_edges_tensor generation:  0.03403282165527344
mini_batch_src_global generation:  0.05583548545837402
r_  generation:  0.5085039138793945
----------------------check_connections_block total spend ----------------------------- 5.999701738357544
generate_one_block  0.6573154926300049
generate_one_block  0.6269378662109375
generate_one_block  0.6284153461456299
generate_one_block  0.6210618019104004
generate_one_block  0.618156909942627
generate_one_block  0.6215920448303223
generate_one_block  0.6615345478057861
generate_one_block  0.62823486328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  10.087210655212402
block generation total time  8.62952470779419
average batch blocks generation time:  1.0786905884742737
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09904861450195312  GigaBytes
Max Memory Allocated: 0.09904861450195312  GigaBytes

torch.Size([160974, 128])
torch.Size([143331, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0018310546875 GB
    Memory Allocated: 20.41507387161255  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5389404296875 GB
    Memory Allocated: 0.1025381088256836  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160887, 128])
torch.Size([143061, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0115966796875 GB
    Memory Allocated: 20.412203311920166  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5291748046875 GB
    Memory Allocated: 0.10239458084106445  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160684, 128])
torch.Size([142454, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6170654296875 GB
    Memory Allocated: 20.29370927810669  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6170654296875 GB
    Memory Allocated: 0.10297060012817383  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160787, 128])
torch.Size([142762, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2420654296875 GB
    Memory Allocated: 20.2269287109375  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2381591796875 GB
    Memory Allocated: 0.10317182540893555  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160963, 128])
torch.Size([142757, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8631591796875 GB
    Memory Allocated: 20.240161895751953  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3514404296875 GB
    Memory Allocated: 0.1024327278137207  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160856, 128])
torch.Size([142680, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9393310546875 GB
    Memory Allocated: 20.3058500289917  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4393310546875 GB
    Memory Allocated: 0.10254478454589844  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160943, 128])
torch.Size([143068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4393310546875 GB
    Memory Allocated: 20.347822189331055  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5213623046875 GB
    Memory Allocated: 0.1025533676147461  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160821, 128])
torch.Size([142858, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9100341796875 GB
    Memory Allocated: 20.311940670013428  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0438501238822937 |0.06403139233589172 |0.9292857944965363 |0.00011137127876281738 |0.8646265268325806 |0.012605428695678711 |
----------------------------------------------------------pseudo_mini_loss sum 4.980462551116943
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3019185
Number of first layer input nodes during this epoch:  1286915
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.4139404296875 GB
    Memory Allocated: 0.13828134536743164  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026641368865966797
random selection method range initialization spend 0.005400657653808594
time for parepare:  0.017937421798706055
local_output_nid generation:  0.004665374755859375
local_in_edges_tensor generation:  0.006709575653076172
mini_batch_src_global generation:  0.007359743118286133
r_  generation:  0.04371047019958496
local_output_nid generation:  0.008443832397460938
local_in_edges_tensor generation:  0.004125833511352539
mini_batch_src_global generation:  0.005011320114135742
r_  generation:  0.044333696365356445
local_output_nid generation:  0.00878453254699707
local_in_edges_tensor generation:  0.004311561584472656
mini_batch_src_global generation:  0.0033540725708007812
r_  generation:  0.045064449310302734
local_output_nid generation:  0.008861541748046875
local_in_edges_tensor generation:  0.0053653717041015625
mini_batch_src_global generation:  0.007703304290771484
r_  generation:  0.05210256576538086
local_output_nid generation:  0.00844430923461914
local_in_edges_tensor generation:  0.003576040267944336
mini_batch_src_global generation:  0.004401445388793945
r_  generation:  0.049887895584106445
local_output_nid generation:  0.007665395736694336
local_in_edges_tensor generation:  0.0034799575805664062
mini_batch_src_global generation:  0.004937171936035156
r_  generation:  0.05064988136291504
local_output_nid generation:  0.007272481918334961
local_in_edges_tensor generation:  0.0034656524658203125
mini_batch_src_global generation:  0.004826545715332031
r_  generation:  0.05023384094238281
local_output_nid generation:  0.007002115249633789
local_in_edges_tensor generation:  0.0034449100494384766
mini_batch_src_global generation:  0.00491023063659668
r_  generation:  0.05152702331542969
----------------------check_connections_block total spend ----------------------------- 0.6456615924835205
generate_one_block  0.0798039436340332
generate_one_block  0.07583332061767578
generate_one_block  0.07631182670593262
generate_one_block  0.07610774040222168
generate_one_block  0.07661700248718262
generate_one_block  0.07676291465759277
generate_one_block  0.08036971092224121
generate_one_block  0.07827496528625488
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03484010696411133
gen group dst list time:  0.01646900177001953
time for parepare:  0.021942853927612305
local_output_nid generation:  0.015282154083251953
local_in_edges_tensor generation:  0.02955174446105957
mini_batch_src_global generation:  0.030602216720581055
r_  generation:  0.3205535411834717
local_output_nid generation:  0.020582199096679688
local_in_edges_tensor generation:  0.0320286750793457
mini_batch_src_global generation:  0.039090871810913086
r_  generation:  0.33742594718933105
local_output_nid generation:  0.01984405517578125
local_in_edges_tensor generation:  0.026354551315307617
mini_batch_src_global generation:  0.04113960266113281
r_  generation:  0.3436579704284668
local_output_nid generation:  0.019870519638061523
local_in_edges_tensor generation:  0.025959491729736328
mini_batch_src_global generation:  0.039725303649902344
r_  generation:  0.3481323719024658
local_output_nid generation:  0.019877195358276367
local_in_edges_tensor generation:  0.02535414695739746
mini_batch_src_global generation:  0.040232181549072266
r_  generation:  0.3436708450317383
local_output_nid generation:  0.02011275291442871
local_in_edges_tensor generation:  0.023568391799926758
mini_batch_src_global generation:  0.04844784736633301
r_  generation:  0.3692951202392578
local_output_nid generation:  0.02330923080444336
local_in_edges_tensor generation:  0.03297758102416992
mini_batch_src_global generation:  0.04815030097961426
r_  generation:  0.3413217067718506
local_output_nid generation:  0.020447492599487305
local_in_edges_tensor generation:  0.02531886100769043
mini_batch_src_global generation:  0.04322457313537598
r_  generation:  0.33460569381713867
----------------------check_connections_block total spend ----------------------------- 4.053667783737183
generate_one_block  0.4845542907714844
generate_one_block  0.4756276607513428
generate_one_block  0.47237491607666016
generate_one_block  0.4705510139465332
generate_one_block  0.47167539596557617
generate_one_block  0.4812736511230469
generate_one_block  0.47452282905578613
generate_one_block  0.49151182174682617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04871845245361328
gen group dst list time:  0.03670811653137207
time for parepare:  0.02004861831665039
local_output_nid generation:  0.02942347526550293
local_in_edges_tensor generation:  0.061995506286621094
mini_batch_src_global generation:  0.04496407508850098
r_  generation:  0.49537038803100586
local_output_nid generation:  0.036672115325927734
local_in_edges_tensor generation:  0.056220054626464844
mini_batch_src_global generation:  0.05593395233154297
r_  generation:  0.5078275203704834
local_output_nid generation:  0.04135870933532715
local_in_edges_tensor generation:  0.04823899269104004
mini_batch_src_global generation:  0.06344962120056152
r_  generation:  0.4982430934906006
local_output_nid generation:  0.03737950325012207
local_in_edges_tensor generation:  0.047063350677490234
mini_batch_src_global generation:  0.05955076217651367
r_  generation:  0.5008926391601562
local_output_nid generation:  0.03700757026672363
local_in_edges_tensor generation:  0.03765678405761719
mini_batch_src_global generation:  0.05404543876647949
r_  generation:  0.503662109375
local_output_nid generation:  0.03687286376953125
local_in_edges_tensor generation:  0.03466629981994629
mini_batch_src_global generation:  0.05646467208862305
r_  generation:  0.5008325576782227
local_output_nid generation:  0.036722660064697266
local_in_edges_tensor generation:  0.039147138595581055
mini_batch_src_global generation:  0.05460357666015625
r_  generation:  0.5199103355407715
local_output_nid generation:  0.03681373596191406
local_in_edges_tensor generation:  0.03915834426879883
mini_batch_src_global generation:  0.055925607681274414
r_  generation:  0.4941284656524658
----------------------check_connections_block total spend ----------------------------- 6.027693033218384
generate_one_block  0.6971359252929688
generate_one_block  0.655768871307373
generate_one_block  0.6507606506347656
generate_one_block  0.6786143779754639
generate_one_block  0.659477710723877
generate_one_block  0.6574468612670898
generate_one_block  0.6410493850708008
generate_one_block  0.6530590057373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.4139404296875 GB
    Memory Allocated: 0.13828134536743164  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

connection checking time:  10.081360816955566
block generation total time  9.1154043674469
average batch blocks generation time:  1.1394255459308624
block dataloader generation time/epoch 21.80744433403015
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4139404296875 GB
    Memory Allocated: 0.10605859756469727  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160955, 128])
torch.Size([143352, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4139404296875 GB
    Memory Allocated: 20.33991003036499  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4139404296875 GB
    Memory Allocated: 0.1060032844543457  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160822, 128])
torch.Size([142864, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4451904296875 GB
    Memory Allocated: 20.319440364837646  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4451904296875 GB
    Memory Allocated: 0.1060328483581543  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160858, 128])
torch.Size([142808, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4451904296875 GB
    Memory Allocated: 20.368396759033203  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9510498046875 GB
    Memory Allocated: 0.10604286193847656  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160947, 128])
torch.Size([143100, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9510498046875 GB
    Memory Allocated: 20.336379528045654  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9510498046875 GB
    Memory Allocated: 0.106048583984375  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160991, 128])
torch.Size([143080, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9510498046875 GB
    Memory Allocated: 20.29145336151123  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9510498046875 GB
    Memory Allocated: 0.10603618621826172  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160867, 128])
torch.Size([142882, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9510498046875 GB
    Memory Allocated: 20.34314775466919  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4569091796875 GB
    Memory Allocated: 0.10591840744018555  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160916, 128])
torch.Size([142831, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5291748046875 GB
    Memory Allocated: 20.182756900787354  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5291748046875 GB
    Memory Allocated: 0.10580921173095703  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

torch.Size([160669, 128])
torch.Size([142349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5291748046875 GB
    Memory Allocated: 20.19867753982544  GigaBytes
Max Memory Allocated: 20.48086643218994  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037116676568984985 |0.02084311842918396 |0.47447270154953003 |0.00010135769844055176 |0.8377242088317871 |0.004635334014892578 |
----------------------------------------------------------pseudo_mini_loss sum 3.314396381378174
Total (block generation + training)time/epoch 32.79808855056763
Training time/epoch 10.990407705307007
Training time without block to device /epoch 10.823662757873535
Training time without total dataloading part /epoch 10.503021478652954
load block tensor time/epoch 0.2969334125518799
block to device time/epoch 0.16674494743347168
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019830
Number of first layer input nodes during this epoch:  1287025
