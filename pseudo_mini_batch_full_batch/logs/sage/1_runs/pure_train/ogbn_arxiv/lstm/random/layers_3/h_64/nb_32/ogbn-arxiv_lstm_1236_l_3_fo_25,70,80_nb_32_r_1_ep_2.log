Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648458344.0850673
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02749800682067871
random selection method range initialization spend 0.006510019302368164
time for parepare:  0.018788576126098633
local_output_nid generation:  0.0011515617370605469
local_in_edges_tensor generation:  0.004169464111328125
mini_batch_src_global generation:  0.0016093254089355469
r_  generation:  0.010654449462890625
local_output_nid generation:  0.0013544559478759766
local_in_edges_tensor generation:  0.0010259151458740234
mini_batch_src_global generation:  0.0016703605651855469
r_  generation:  0.010092020034790039
local_output_nid generation:  0.0014324188232421875
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.00914621353149414
local_output_nid generation:  0.0014319419860839844
local_in_edges_tensor generation:  0.0008709430694580078
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.009448051452636719
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.009829044342041016
local_output_nid generation:  0.001483917236328125
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.00099945068359375
r_  generation:  0.009282112121582031
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0008065700531005859
mini_batch_src_global generation:  0.0009677410125732422
r_  generation:  0.009561777114868164
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0007977485656738281
mini_batch_src_global generation:  0.0009682178497314453
r_  generation:  0.009375810623168945
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.0008015632629394531
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.009876012802124023
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0007836818695068359
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.00960087776184082
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0007798671722412109
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.009093761444091797
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0009846687316894531
r_  generation:  0.009711742401123047
local_output_nid generation:  0.0014455318450927734
local_in_edges_tensor generation:  0.0007700920104980469
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.010469198226928711
local_output_nid generation:  0.0014791488647460938
local_in_edges_tensor generation:  0.0008089542388916016
mini_batch_src_global generation:  0.0010833740234375
r_  generation:  0.010169029235839844
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.0007739067077636719
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.01008152961730957
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0010311603546142578
r_  generation:  0.009897708892822266
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0010159015655517578
r_  generation:  0.009620904922485352
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0010390281677246094
r_  generation:  0.010338544845581055
local_output_nid generation:  0.00145721435546875
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0010559558868408203
r_  generation:  0.010313987731933594
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.01000213623046875
local_output_nid generation:  0.0014667510986328125
local_in_edges_tensor generation:  0.0007431507110595703
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.009594917297363281
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.010256767272949219
local_output_nid generation:  0.0014815330505371094
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.0010542869567871094
r_  generation:  0.010062694549560547
local_output_nid generation:  0.0014843940734863281
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.010401010513305664
local_output_nid generation:  0.0014774799346923828
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.010170698165893555
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.0010366439819335938
r_  generation:  0.009742498397827148
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.001085042953491211
r_  generation:  0.01023721694946289
local_output_nid generation:  0.0015106201171875
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.010501861572265625
local_output_nid generation:  0.001491546630859375
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0010991096496582031
r_  generation:  0.010247945785522461
local_output_nid generation:  0.0014944076538085938
local_in_edges_tensor generation:  0.005633354187011719
mini_batch_src_global generation:  0.0012965202331542969
r_  generation:  0.010426044464111328
local_output_nid generation:  0.0013446807861328125
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.009929656982421875
local_output_nid generation:  0.0014178752899169922
local_in_edges_tensor generation:  0.0007624626159667969
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.009891510009765625
----------------------check_connections_block total spend ----------------------------- 0.5418910980224609
generate_one_block  0.01576685905456543
generate_one_block  0.015543222427368164
generate_one_block  0.014392614364624023
generate_one_block  0.015131711959838867
generate_one_block  0.0154266357421875
generate_one_block  0.014889955520629883
generate_one_block  0.014937877655029297
generate_one_block  0.014413118362426758
generate_one_block  0.015324115753173828
generate_one_block  0.014972209930419922
generate_one_block  0.013985872268676758
generate_one_block  0.014600992202758789
generate_one_block  0.015444755554199219
generate_one_block  0.01509404182434082
generate_one_block  0.014964818954467773
generate_one_block  0.014871358871459961
generate_one_block  0.014434337615966797
generate_one_block  0.015222787857055664
generate_one_block  0.01526784896850586
generate_one_block  0.014922380447387695
generate_one_block  0.014497041702270508
generate_one_block  0.015169143676757812
generate_one_block  0.014987468719482422
generate_one_block  0.015408039093017578
generate_one_block  0.014875173568725586
generate_one_block  0.014404773712158203
generate_one_block  0.01470184326171875
generate_one_block  0.015388965606689453
generate_one_block  0.015017271041870117
generate_one_block  0.015180587768554688
generate_one_block  0.014875411987304688
generate_one_block  0.014818429946899414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044321537017822266
gen group dst list time:  0.02402186393737793
time for parepare:  0.019676685333251953
local_output_nid generation:  0.005360841751098633
local_in_edges_tensor generation:  0.014955759048461914
mini_batch_src_global generation:  0.016552448272705078
r_  generation:  0.16165709495544434
local_output_nid generation:  0.010473966598510742
local_in_edges_tensor generation:  0.01653742790222168
mini_batch_src_global generation:  0.021956205368041992
r_  generation:  0.17528367042541504
local_output_nid generation:  0.00989842414855957
local_in_edges_tensor generation:  0.012694835662841797
mini_batch_src_global generation:  0.019087791442871094
r_  generation:  0.16665196418762207
local_output_nid generation:  0.010068655014038086
local_in_edges_tensor generation:  0.016506433486938477
mini_batch_src_global generation:  0.020653247833251953
r_  generation:  0.17941808700561523
local_output_nid generation:  0.010320186614990234
local_in_edges_tensor generation:  0.013704061508178711
mini_batch_src_global generation:  0.021925926208496094
r_  generation:  0.18415117263793945
local_output_nid generation:  0.010159015655517578
local_in_edges_tensor generation:  0.011466026306152344
mini_batch_src_global generation:  0.024858474731445312
r_  generation:  0.19911408424377441
local_output_nid generation:  0.012603998184204102
local_in_edges_tensor generation:  0.02733612060546875
mini_batch_src_global generation:  0.028601646423339844
r_  generation:  0.17570281028747559
local_output_nid generation:  0.008054018020629883
local_in_edges_tensor generation:  0.009675741195678711
mini_batch_src_global generation:  0.02208733558654785
r_  generation:  0.1695420742034912
local_output_nid generation:  0.008314847946166992
local_in_edges_tensor generation:  0.010328531265258789
mini_batch_src_global generation:  0.021859169006347656
r_  generation:  0.17776107788085938
local_output_nid generation:  0.008062124252319336
local_in_edges_tensor generation:  0.011999368667602539
mini_batch_src_global generation:  0.022265911102294922
r_  generation:  0.1746196746826172
local_output_nid generation:  0.007883310317993164
local_in_edges_tensor generation:  0.008502721786499023
mini_batch_src_global generation:  0.021555662155151367
r_  generation:  0.1693875789642334
local_output_nid generation:  0.008067131042480469
local_in_edges_tensor generation:  0.010210275650024414
mini_batch_src_global generation:  0.02312636375427246
r_  generation:  0.1771225929260254
local_output_nid generation:  0.008500099182128906
local_in_edges_tensor generation:  0.012254714965820312
mini_batch_src_global generation:  0.02327871322631836
r_  generation:  0.18883109092712402
local_output_nid generation:  0.008387565612792969
local_in_edges_tensor generation:  0.011010169982910156
mini_batch_src_global generation:  0.02313685417175293
r_  generation:  0.18049383163452148
local_output_nid generation:  0.00982522964477539
local_in_edges_tensor generation:  0.009000062942504883
mini_batch_src_global generation:  0.02320122718811035
r_  generation:  0.18209218978881836
local_output_nid generation:  0.008329153060913086
local_in_edges_tensor generation:  0.010790348052978516
mini_batch_src_global generation:  0.022617101669311523
r_  generation:  0.18114471435546875
local_output_nid generation:  0.008039236068725586
local_in_edges_tensor generation:  0.01188969612121582
mini_batch_src_global generation:  0.022573471069335938
r_  generation:  0.18078112602233887
local_output_nid generation:  0.008422136306762695
local_in_edges_tensor generation:  0.011988401412963867
mini_batch_src_global generation:  0.023439884185791016
r_  generation:  0.18501973152160645
local_output_nid generation:  0.00850987434387207
local_in_edges_tensor generation:  0.012072563171386719
mini_batch_src_global generation:  0.02307271957397461
r_  generation:  0.1873936653137207
local_output_nid generation:  0.008144378662109375
local_in_edges_tensor generation:  0.008841753005981445
mini_batch_src_global generation:  0.023081302642822266
r_  generation:  0.17824482917785645
local_output_nid generation:  0.008143424987792969
local_in_edges_tensor generation:  0.008564949035644531
mini_batch_src_global generation:  0.03379487991333008
r_  generation:  0.17728757858276367
local_output_nid generation:  0.00842595100402832
local_in_edges_tensor generation:  0.011789083480834961
mini_batch_src_global generation:  0.024760723114013672
r_  generation:  0.18265867233276367
local_output_nid generation:  0.008325576782226562
local_in_edges_tensor generation:  0.012356042861938477
mini_batch_src_global generation:  0.022922992706298828
r_  generation:  0.1830606460571289
local_output_nid generation:  0.008489608764648438
local_in_edges_tensor generation:  0.010987520217895508
mini_batch_src_global generation:  0.025408029556274414
r_  generation:  0.18629884719848633
local_output_nid generation:  0.008276939392089844
local_in_edges_tensor generation:  0.010542869567871094
mini_batch_src_global generation:  0.023168563842773438
r_  generation:  0.18000030517578125
local_output_nid generation:  0.008033990859985352
local_in_edges_tensor generation:  0.010147333145141602
mini_batch_src_global generation:  0.022649765014648438
r_  generation:  0.1785726547241211
local_output_nid generation:  0.008255243301391602
local_in_edges_tensor generation:  0.010281562805175781
mini_batch_src_global generation:  0.022550582885742188
r_  generation:  0.18300533294677734
local_output_nid generation:  0.00855875015258789
local_in_edges_tensor generation:  0.01257467269897461
mini_batch_src_global generation:  0.024784564971923828
r_  generation:  0.18703794479370117
local_output_nid generation:  0.008308172225952148
local_in_edges_tensor generation:  0.010529279708862305
mini_batch_src_global generation:  0.025532245635986328
r_  generation:  0.18263983726501465
local_output_nid generation:  0.00838017463684082
local_in_edges_tensor generation:  0.01203465461730957
mini_batch_src_global generation:  0.02347588539123535
r_  generation:  0.1850292682647705
local_output_nid generation:  0.008174657821655273
local_in_edges_tensor generation:  0.008840560913085938
mini_batch_src_global generation:  0.022639989852905273
r_  generation:  0.17815089225769043
local_output_nid generation:  0.008281230926513672
local_in_edges_tensor generation:  0.008950471878051758
mini_batch_src_global generation:  0.022052764892578125
r_  generation:  0.17758560180664062
----------------------check_connections_block total spend ----------------------------- 8.466879606246948
generate_one_block  0.24273180961608887
generate_one_block  0.2363274097442627
generate_one_block  0.24464035034179688
generate_one_block  0.24148917198181152
generate_one_block  0.24374604225158691
generate_one_block  0.23553848266601562
generate_one_block  0.22996854782104492
generate_one_block  0.22141695022583008
generate_one_block  0.28455066680908203
generate_one_block  0.22601652145385742
generate_one_block  0.21328401565551758
generate_one_block  0.2314777374267578
generate_one_block  0.2447977066040039
generate_one_block  0.23227143287658691
generate_one_block  0.22968220710754395
generate_one_block  0.2626619338989258
generate_one_block  0.23306775093078613
generate_one_block  0.23780083656311035
generate_one_block  0.24196672439575195
generate_one_block  0.2231426239013672
generate_one_block  0.2234666347503662
generate_one_block  0.2334740161895752
generate_one_block  0.23352694511413574
generate_one_block  0.2431645393371582
generate_one_block  0.22834205627441406
generate_one_block  0.2278895378112793
generate_one_block  0.23274540901184082
generate_one_block  0.23885369300842285
generate_one_block  0.22730302810668945
generate_one_block  0.23385405540466309
generate_one_block  0.2219994068145752
generate_one_block  0.2207479476928711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04821586608886719
gen group dst list time:  0.11197662353515625
time for parepare:  0.020500659942626953
local_output_nid generation:  0.023392677307128906
local_in_edges_tensor generation:  0.050401926040649414
mini_batch_src_global generation:  0.04280209541320801
r_  generation:  0.42796874046325684
local_output_nid generation:  0.03005075454711914
local_in_edges_tensor generation:  0.045771121978759766
mini_batch_src_global generation:  0.0491642951965332
r_  generation:  0.42218995094299316
local_output_nid generation:  0.029266834259033203
local_in_edges_tensor generation:  0.037444114685058594
mini_batch_src_global generation:  0.047308921813964844
r_  generation:  0.4274778366088867
local_output_nid generation:  0.028040170669555664
local_in_edges_tensor generation:  0.037886619567871094
mini_batch_src_global generation:  0.04858684539794922
r_  generation:  0.426891565322876
local_output_nid generation:  0.028091907501220703
local_in_edges_tensor generation:  0.03476834297180176
mini_batch_src_global generation:  0.0492706298828125
r_  generation:  0.43689656257629395
local_output_nid generation:  0.029071331024169922
local_in_edges_tensor generation:  0.03902316093444824
mini_batch_src_global generation:  0.0529484748840332
r_  generation:  0.4311847686767578
local_output_nid generation:  0.027796506881713867
local_in_edges_tensor generation:  0.030129432678222656
mini_batch_src_global generation:  0.05002284049987793
r_  generation:  0.43231892585754395
local_output_nid generation:  0.027918577194213867
local_in_edges_tensor generation:  0.030611276626586914
mini_batch_src_global generation:  0.050719261169433594
r_  generation:  0.43222641944885254
local_output_nid generation:  0.028150558471679688
local_in_edges_tensor generation:  0.03741335868835449
mini_batch_src_global generation:  0.05191612243652344
r_  generation:  0.4450232982635498
local_output_nid generation:  0.028169870376586914
local_in_edges_tensor generation:  0.036611080169677734
mini_batch_src_global generation:  0.0521700382232666
r_  generation:  0.43958115577697754
local_output_nid generation:  0.030417203903198242
local_in_edges_tensor generation:  0.03549623489379883
mini_batch_src_global generation:  0.0512232780456543
r_  generation:  0.4318838119506836
local_output_nid generation:  0.028583526611328125
local_in_edges_tensor generation:  0.03378009796142578
mini_batch_src_global generation:  0.05298614501953125
r_  generation:  0.4308006763458252
local_output_nid generation:  0.028804540634155273
local_in_edges_tensor generation:  0.04151582717895508
mini_batch_src_global generation:  0.05005812644958496
r_  generation:  0.44211864471435547
local_output_nid generation:  0.028749465942382812
local_in_edges_tensor generation:  0.03400921821594238
mini_batch_src_global generation:  0.05050969123840332
r_  generation:  0.43831372261047363
local_output_nid generation:  0.029059648513793945
local_in_edges_tensor generation:  0.03377723693847656
mini_batch_src_global generation:  0.05270791053771973
r_  generation:  0.4370541572570801
local_output_nid generation:  0.028620243072509766
local_in_edges_tensor generation:  0.030066490173339844
mini_batch_src_global generation:  0.0507659912109375
r_  generation:  0.4353799819946289
local_output_nid generation:  0.028591394424438477
local_in_edges_tensor generation:  0.03363800048828125
mini_batch_src_global generation:  0.050182342529296875
r_  generation:  0.43849945068359375
local_output_nid generation:  0.02935028076171875
local_in_edges_tensor generation:  0.03833317756652832
mini_batch_src_global generation:  0.0499417781829834
r_  generation:  0.43901586532592773
local_output_nid generation:  0.029053211212158203
local_in_edges_tensor generation:  0.037485361099243164
mini_batch_src_global generation:  0.05005455017089844
r_  generation:  0.43915605545043945
local_output_nid generation:  0.028654098510742188
local_in_edges_tensor generation:  0.03133225440979004
mini_batch_src_global generation:  0.04976534843444824
r_  generation:  0.432342529296875
local_output_nid generation:  0.028701066970825195
local_in_edges_tensor generation:  0.031156301498413086
mini_batch_src_global generation:  0.04976606369018555
r_  generation:  0.44997501373291016
local_output_nid generation:  0.028594017028808594
local_in_edges_tensor generation:  0.0373532772064209
mini_batch_src_global generation:  0.04979515075683594
r_  generation:  0.43607473373413086
local_output_nid generation:  0.028617143630981445
local_in_edges_tensor generation:  0.0377504825592041
mini_batch_src_global generation:  0.04971194267272949
r_  generation:  0.43615293502807617
local_output_nid generation:  0.028620243072509766
local_in_edges_tensor generation:  0.03760504722595215
mini_batch_src_global generation:  0.05066728591918945
r_  generation:  0.44214630126953125
local_output_nid generation:  0.029070138931274414
local_in_edges_tensor generation:  0.02977919578552246
mini_batch_src_global generation:  0.050048112869262695
r_  generation:  0.4319627285003662
local_output_nid generation:  0.02844715118408203
local_in_edges_tensor generation:  0.031157255172729492
mini_batch_src_global generation:  0.05008530616760254
r_  generation:  0.43210625648498535
local_output_nid generation:  0.02875518798828125
local_in_edges_tensor generation:  0.04173541069030762
mini_batch_src_global generation:  0.05024838447570801
r_  generation:  0.43494725227355957
local_output_nid generation:  0.028937101364135742
local_in_edges_tensor generation:  0.03787803649902344
mini_batch_src_global generation:  0.05068469047546387
r_  generation:  0.4418981075286865
local_output_nid generation:  0.029607534408569336
local_in_edges_tensor generation:  0.04613375663757324
mini_batch_src_global generation:  0.05096101760864258
r_  generation:  0.43292808532714844
local_output_nid generation:  0.029001951217651367
local_in_edges_tensor generation:  0.026505708694458008
mini_batch_src_global generation:  0.05077171325683594
r_  generation:  0.43755602836608887
local_output_nid generation:  0.028551340103149414
local_in_edges_tensor generation:  0.026293039321899414
mini_batch_src_global generation:  0.050293684005737305
r_  generation:  0.4312863349914551
local_output_nid generation:  0.031045198440551758
local_in_edges_tensor generation:  0.026684284210205078
mini_batch_src_global generation:  0.05022239685058594
r_  generation:  0.43721747398376465
----------------------check_connections_block total spend ----------------------------- 20.67490863800049
generate_one_block  0.6508617401123047
generate_one_block  0.5995054244995117
generate_one_block  0.590691089630127
generate_one_block  0.568749189376831
generate_one_block  0.5570170879364014
generate_one_block  0.5558528900146484
generate_one_block  0.5765984058380127
generate_one_block  0.5492990016937256
generate_one_block  0.5802021026611328
generate_one_block  0.5584065914154053
generate_one_block  0.5728907585144043
generate_one_block  0.55368971824646
generate_one_block  0.5741372108459473
generate_one_block  0.5679295063018799
generate_one_block  0.5589416027069092
generate_one_block  0.5423834323883057
generate_one_block  0.5490148067474365
generate_one_block  0.5701138973236084
generate_one_block  0.5604040622711182
generate_one_block  0.5548954010009766
generate_one_block  0.5601871013641357
generate_one_block  0.5589983463287354
generate_one_block  0.5578844547271729
generate_one_block  0.5667259693145752
generate_one_block  0.5405936241149902
generate_one_block  0.5410933494567871
generate_one_block  0.5611190795898438
generate_one_block  0.5645802021026611
generate_one_block  0.5447640419006348
generate_one_block  0.5611071586608887
generate_one_block  0.5402460098266602
generate_one_block  0.5436429977416992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  29.141788244247437
block generation total time  25.55447244644165
average batch blocks generation time:  0.7985772639513016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08645105361938477  GigaBytes
Max Memory Allocated: 0.08645105361938477  GigaBytes

torch.Size([149190, 128])
torch.Size([110984, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8944091796875 GB
    Memory Allocated: 12.467002391815186  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.9041748046875 GB
    Memory Allocated: 0.08764982223510742  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148915, 128])
torch.Size([110685, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 12.393292903900146  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 0.08728694915771484  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([149050, 128])
torch.Size([109458, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 12.13912582397461  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 0.08752107620239258  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148705, 128])
torch.Size([110046, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1580810546875 GB
    Memory Allocated: 12.419844627380371  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08754396438598633  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148755, 128])
torch.Size([110400, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.452271461486816  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.0875239372253418  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([149075, 128])
torch.Size([110044, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.352108478546143  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08727216720581055  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148661, 128])
torch.Size([109224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.284132957458496  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08723306655883789  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148999, 128])
torch.Size([109014, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.079269409179688  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08760499954223633  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([149157, 128])
torch.Size([110453, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.37010669708252  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08708000183105469  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148352, 128])
torch.Size([108867, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.211438179016113  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08676862716674805  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148173, 128])
torch.Size([108534, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.105164051055908  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08714103698730469  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([148476, 128])
torch.Size([108789, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 12.236768245697021  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1600341796875 GB
    Memory Allocated: 0.08798837661743164  GigaBytes
Max Memory Allocated: 12.489553928375244  GigaBytes

torch.Size([149415, 128])
torch.Size([110704, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.531107902526855  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08755350112915039  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149035, 128])
torch.Size([110071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.345927238464355  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08878898620605469  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149539, 128])
torch.Size([111001, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.406187057495117  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08741474151611328  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148982, 128])
torch.Size([109593, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.280958652496338  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08742094039916992  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149015, 128])
torch.Size([109778, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.26042652130127  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.0877528190612793  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149151, 128])
torch.Size([111076, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.483994007110596  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.0876150131225586  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148936, 128])
torch.Size([110313, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.44354772567749  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.0872044563293457  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148657, 128])
torch.Size([109341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.248810768127441  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.0872340202331543  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148697, 128])
torch.Size([109251, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.269561290740967  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08743762969970703  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148704, 128])
torch.Size([109743, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.40360403060913  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08724689483642578  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148416, 128])
torch.Size([109365, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.336724758148193  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08749818801879883  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148477, 128])
torch.Size([109988, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.48854398727417  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08746099472045898  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148907, 128])
torch.Size([109647, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.334091663360596  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.0871438980102539  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148454, 128])
torch.Size([108845, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.240081787109375  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.0875997543334961  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149134, 128])
torch.Size([110356, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 12.370298862457275  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1776123046875 GB
    Memory Allocated: 0.08798551559448242  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149491, 128])
torch.Size([111579, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.53293514251709  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08722925186157227  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148425, 128])
torch.Size([109442, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.326743602752686  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08777332305908203  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149210, 128])
torch.Size([110947, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.467491149902344  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08710336685180664  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148427, 128])
torch.Size([109332, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.25428056716919  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08734703063964844  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149030, 128])
torch.Size([109989, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.243565559387207  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03626289218664169 |0.03213442862033844 |0.5461786091327667 |0.00010577589273452759 |0.8600359261035919 |0.014131784439086914 |
----------------------------------------------------------pseudo_mini_loss sum 4.960566997528076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9121106
Number of first layer input nodes during this epoch:  4763610
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.10888814926147461  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026915311813354492
random selection method range initialization spend 0.006064891815185547
time for parepare:  0.01932239532470703
local_output_nid generation:  0.0013780593872070312
local_in_edges_tensor generation:  0.006982564926147461
mini_batch_src_global generation:  0.0018422603607177734
r_  generation:  0.010854959487915039
local_output_nid generation:  0.0018930435180664062
local_in_edges_tensor generation:  0.0011115074157714844
mini_batch_src_global generation:  0.001566171646118164
r_  generation:  0.009937763214111328
local_output_nid generation:  0.0018322467803955078
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.0012392997741699219
r_  generation:  0.009729146957397461
local_output_nid generation:  0.0017998218536376953
local_in_edges_tensor generation:  0.0010020732879638672
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.009836196899414062
local_output_nid generation:  0.0017790794372558594
local_in_edges_tensor generation:  0.0009875297546386719
mini_batch_src_global generation:  0.001100778579711914
r_  generation:  0.009865522384643555
local_output_nid generation:  0.001779794692993164
local_in_edges_tensor generation:  0.0009925365447998047
mini_batch_src_global generation:  0.0011835098266601562
r_  generation:  0.010154008865356445
local_output_nid generation:  0.001775503158569336
local_in_edges_tensor generation:  0.0009684562683105469
mini_batch_src_global generation:  0.0012288093566894531
r_  generation:  0.010450601577758789
local_output_nid generation:  0.0017731189727783203
local_in_edges_tensor generation:  0.0009756088256835938
mini_batch_src_global generation:  0.0012049674987792969
r_  generation:  0.01055908203125
local_output_nid generation:  0.0017616748809814453
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0011587142944335938
r_  generation:  0.010331869125366211
local_output_nid generation:  0.0017747879028320312
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.010280370712280273
local_output_nid generation:  0.0017673969268798828
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010289430618286133
local_output_nid generation:  0.001756429672241211
local_in_edges_tensor generation:  0.0009763240814208984
mini_batch_src_global generation:  0.0011436939239501953
r_  generation:  0.0102386474609375
local_output_nid generation:  0.0017497539520263672
local_in_edges_tensor generation:  0.0009710788726806641
mini_batch_src_global generation:  0.0011749267578125
r_  generation:  0.010586977005004883
local_output_nid generation:  0.0017783641815185547
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0011417865753173828
r_  generation:  0.010296106338500977
local_output_nid generation:  0.001768350601196289
local_in_edges_tensor generation:  0.0009176731109619141
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.010228633880615234
local_output_nid generation:  0.0017409324645996094
local_in_edges_tensor generation:  0.0009264945983886719
mini_batch_src_global generation:  0.0011148452758789062
r_  generation:  0.00983881950378418
local_output_nid generation:  0.0017528533935546875
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010224342346191406
local_output_nid generation:  0.0017580986022949219
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.0012068748474121094
r_  generation:  0.010473489761352539
local_output_nid generation:  0.0017626285552978516
local_in_edges_tensor generation:  0.0009360313415527344
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010735511779785156
local_output_nid generation:  0.0017817020416259766
local_in_edges_tensor generation:  0.0009353160858154297
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010161399841308594
local_output_nid generation:  0.001764059066772461
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0012125968933105469
r_  generation:  0.010101318359375
local_output_nid generation:  0.0017654895782470703
local_in_edges_tensor generation:  0.0009229183197021484
mini_batch_src_global generation:  0.0011096000671386719
r_  generation:  0.010131597518920898
local_output_nid generation:  0.0017478466033935547
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.010353326797485352
local_output_nid generation:  0.0017671585083007812
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.0011572837829589844
r_  generation:  0.010568618774414062
local_output_nid generation:  0.0017807483673095703
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.010404348373413086
local_output_nid generation:  0.001775979995727539
local_in_edges_tensor generation:  0.0009522438049316406
mini_batch_src_global generation:  0.0012061595916748047
r_  generation:  0.010515451431274414
local_output_nid generation:  0.0017750263214111328
local_in_edges_tensor generation:  0.0009555816650390625
mini_batch_src_global generation:  0.0011429786682128906
r_  generation:  0.0106048583984375
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.0009219646453857422
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.010013818740844727
local_output_nid generation:  0.001779317855834961
local_in_edges_tensor generation:  0.0009295940399169922
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010120630264282227
local_output_nid generation:  0.0017633438110351562
local_in_edges_tensor generation:  0.0009291172027587891
mini_batch_src_global generation:  0.0011599063873291016
r_  generation:  0.010544538497924805
local_output_nid generation:  0.0017611980438232422
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0012276172637939453
r_  generation:  0.010730266571044922
local_output_nid generation:  0.0017681121826171875
local_in_edges_tensor generation:  0.0009217262268066406
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010198354721069336
----------------------check_connections_block total spend ----------------------------- 0.5764119625091553
generate_one_block  0.02446579933166504
generate_one_block  0.02090001106262207
generate_one_block  0.018636465072631836
generate_one_block  0.018330097198486328
generate_one_block  0.018294811248779297
generate_one_block  0.01825118064880371
generate_one_block  0.01867818832397461
generate_one_block  0.01862931251525879
generate_one_block  0.01856064796447754
generate_one_block  0.018279075622558594
generate_one_block  0.018232345581054688
generate_one_block  0.01845407485961914
generate_one_block  0.018875598907470703
generate_one_block  0.018053770065307617
generate_one_block  0.01806640625
generate_one_block  0.017395973205566406
generate_one_block  0.01800251007080078
generate_one_block  0.018262147903442383
generate_one_block  0.018641948699951172
generate_one_block  0.01776909828186035
generate_one_block  0.01802682876586914
generate_one_block  0.017931699752807617
generate_one_block  0.018258094787597656
generate_one_block  0.018543720245361328
generate_one_block  0.01830267906188965
generate_one_block  0.01834583282470703
generate_one_block  0.018455982208251953
generate_one_block  0.017373085021972656
generate_one_block  0.017822980880737305
generate_one_block  0.018732070922851562
generate_one_block  0.01900482177734375
generate_one_block  0.018004179000854492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0414729118347168
gen group dst list time:  0.022308349609375
time for parepare:  0.019831418991088867
local_output_nid generation:  0.006297111511230469
local_in_edges_tensor generation:  0.015967369079589844
mini_batch_src_global generation:  0.01619744300842285
r_  generation:  0.1590585708618164
local_output_nid generation:  0.008813858032226562
local_in_edges_tensor generation:  0.011416435241699219
mini_batch_src_global generation:  0.020348787307739258
r_  generation:  0.16544246673583984
local_output_nid generation:  0.00918269157409668
local_in_edges_tensor generation:  0.030645370483398438
mini_batch_src_global generation:  0.02536797523498535
r_  generation:  0.17190289497375488
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.01218724250793457
mini_batch_src_global generation:  0.021932601928710938
r_  generation:  0.17811083793640137
local_output_nid generation:  0.009396076202392578
local_in_edges_tensor generation:  0.010530471801757812
mini_batch_src_global generation:  0.02801036834716797
r_  generation:  0.18154644966125488
local_output_nid generation:  0.009270906448364258
local_in_edges_tensor generation:  0.010750055313110352
mini_batch_src_global generation:  0.022008180618286133
r_  generation:  0.17560696601867676
local_output_nid generation:  0.009192228317260742
local_in_edges_tensor generation:  0.012248992919921875
mini_batch_src_global generation:  0.02585887908935547
r_  generation:  0.1852712631225586
local_output_nid generation:  0.010216951370239258
local_in_edges_tensor generation:  0.012916326522827148
mini_batch_src_global generation:  0.02279210090637207
r_  generation:  0.18685054779052734
local_output_nid generation:  0.009180307388305664
local_in_edges_tensor generation:  0.016096115112304688
mini_batch_src_global generation:  0.02341294288635254
r_  generation:  0.1928999423980713
local_output_nid generation:  0.011594295501708984
local_in_edges_tensor generation:  0.011980533599853516
mini_batch_src_global generation:  0.02282261848449707
r_  generation:  0.18249821662902832
local_output_nid generation:  0.009742975234985352
local_in_edges_tensor generation:  0.009333133697509766
mini_batch_src_global generation:  0.02265453338623047
r_  generation:  0.18528461456298828
local_output_nid generation:  0.009583711624145508
local_in_edges_tensor generation:  0.011392831802368164
mini_batch_src_global generation:  0.022404193878173828
r_  generation:  0.1781907081604004
local_output_nid generation:  0.00999593734741211
local_in_edges_tensor generation:  0.01076650619506836
mini_batch_src_global generation:  0.0251004695892334
r_  generation:  0.18871760368347168
local_output_nid generation:  0.009530305862426758
local_in_edges_tensor generation:  0.010686397552490234
mini_batch_src_global generation:  0.022799015045166016
r_  generation:  0.18103361129760742
local_output_nid generation:  0.00952911376953125
local_in_edges_tensor generation:  0.009189605712890625
mini_batch_src_global generation:  0.022736549377441406
r_  generation:  0.18132233619689941
local_output_nid generation:  0.009396553039550781
local_in_edges_tensor generation:  0.008940458297729492
mini_batch_src_global generation:  0.021854639053344727
r_  generation:  0.17560696601867676
local_output_nid generation:  0.009702682495117188
local_in_edges_tensor generation:  0.01383662223815918
mini_batch_src_global generation:  0.023012876510620117
r_  generation:  0.1845381259918213
local_output_nid generation:  0.009639739990234375
local_in_edges_tensor generation:  0.009408950805664062
mini_batch_src_global generation:  0.02259206771850586
r_  generation:  0.18072986602783203
local_output_nid generation:  0.009684324264526367
local_in_edges_tensor generation:  0.00934290885925293
mini_batch_src_global generation:  0.023136138916015625
r_  generation:  0.18622112274169922
local_output_nid generation:  0.00898432731628418
local_in_edges_tensor generation:  0.009420394897460938
mini_batch_src_global generation:  0.022660493850708008
r_  generation:  0.17814421653747559
local_output_nid generation:  0.009171009063720703
local_in_edges_tensor generation:  0.010870218276977539
mini_batch_src_global generation:  0.024028301239013672
r_  generation:  0.18407869338989258
local_output_nid generation:  0.009213924407958984
local_in_edges_tensor generation:  0.010756969451904297
mini_batch_src_global generation:  0.022760868072509766
r_  generation:  0.1809830665588379
local_output_nid generation:  0.009292125701904297
local_in_edges_tensor generation:  0.010825395584106445
mini_batch_src_global generation:  0.023901939392089844
r_  generation:  0.184431791305542
local_output_nid generation:  0.009361982345581055
local_in_edges_tensor generation:  0.010933637619018555
mini_batch_src_global generation:  0.023270368576049805
r_  generation:  0.18889164924621582
local_output_nid generation:  0.009291887283325195
local_in_edges_tensor generation:  0.010879755020141602
mini_batch_src_global generation:  0.02333688735961914
r_  generation:  0.18686938285827637
local_output_nid generation:  0.00946664810180664
local_in_edges_tensor generation:  0.010730266571044922
mini_batch_src_global generation:  0.023174524307250977
r_  generation:  0.18642282485961914
local_output_nid generation:  0.009214162826538086
local_in_edges_tensor generation:  0.012413263320922852
mini_batch_src_global generation:  0.023510217666625977
r_  generation:  0.1870899200439453
local_output_nid generation:  0.008830785751342773
local_in_edges_tensor generation:  0.00894474983215332
mini_batch_src_global generation:  0.023801565170288086
r_  generation:  0.17485260963439941
local_output_nid generation:  0.008873462677001953
local_in_edges_tensor generation:  0.008921146392822266
mini_batch_src_global generation:  0.021859169006347656
r_  generation:  0.1768784523010254
local_output_nid generation:  0.009325504302978516
local_in_edges_tensor generation:  0.011275291442871094
mini_batch_src_global generation:  0.02319812774658203
r_  generation:  0.18932819366455078
local_output_nid generation:  0.009659290313720703
local_in_edges_tensor generation:  0.014323711395263672
mini_batch_src_global generation:  0.02435159683227539
r_  generation:  0.19175434112548828
local_output_nid generation:  0.009236812591552734
local_in_edges_tensor generation:  0.009414434432983398
mini_batch_src_global generation:  0.02293109893798828
r_  generation:  0.18124771118164062
----------------------check_connections_block total spend ----------------------------- 8.528281211853027
generate_one_block  0.2527740001678467
generate_one_block  0.23387789726257324
generate_one_block  0.26024627685546875
generate_one_block  0.27242136001586914
generate_one_block  0.3081181049346924
generate_one_block  0.24669194221496582
generate_one_block  0.25327110290527344
generate_one_block  0.2508072853088379
generate_one_block  0.2533893585205078
generate_one_block  0.24626564979553223
generate_one_block  0.2469167709350586
generate_one_block  0.2415299415588379
generate_one_block  0.2653660774230957
generate_one_block  0.25374269485473633
generate_one_block  0.24291348457336426
generate_one_block  0.23479962348937988
generate_one_block  0.25348711013793945
generate_one_block  0.24784469604492188
generate_one_block  0.2565150260925293
generate_one_block  0.24072527885437012
generate_one_block  0.25585365295410156
generate_one_block  0.24411630630493164
generate_one_block  0.2469329833984375
generate_one_block  0.2544281482696533
generate_one_block  0.2544839382171631
generate_one_block  0.2486422061920166
generate_one_block  0.2570681571960449
generate_one_block  0.23448419570922852
generate_one_block  0.23399901390075684
generate_one_block  0.25113892555236816
generate_one_block  0.25992345809936523
generate_one_block  0.24013113975524902
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042734384536743164
gen group dst list time:  0.11451053619384766
time for parepare:  0.0180661678314209
local_output_nid generation:  0.02630901336669922
local_in_edges_tensor generation:  0.05543923377990723
mini_batch_src_global generation:  0.03903794288635254
r_  generation:  0.42409563064575195
local_output_nid generation:  0.031646013259887695
local_in_edges_tensor generation:  0.04535055160522461
mini_batch_src_global generation:  0.04905390739440918
r_  generation:  0.42261695861816406
local_output_nid generation:  0.03055262565612793
local_in_edges_tensor generation:  0.042107343673706055
mini_batch_src_global generation:  0.0511622428894043
r_  generation:  0.42670249938964844
local_output_nid generation:  0.02969837188720703
local_in_edges_tensor generation:  0.03436017036437988
mini_batch_src_global generation:  0.04924631118774414
r_  generation:  0.42958521842956543
local_output_nid generation:  0.029782772064208984
local_in_edges_tensor generation:  0.0380709171295166
mini_batch_src_global generation:  0.06633424758911133
r_  generation:  0.44295382499694824
local_output_nid generation:  0.029596805572509766
local_in_edges_tensor generation:  0.030488014221191406
mini_batch_src_global generation:  0.05054950714111328
r_  generation:  0.4307229518890381
local_output_nid generation:  0.02975630760192871
local_in_edges_tensor generation:  0.03085160255432129
mini_batch_src_global generation:  0.05177927017211914
r_  generation:  0.4367494583129883
local_output_nid generation:  0.029885053634643555
local_in_edges_tensor generation:  0.04215264320373535
mini_batch_src_global generation:  0.05010390281677246
r_  generation:  0.44022321701049805
local_output_nid generation:  0.02979278564453125
local_in_edges_tensor generation:  0.030500411987304688
mini_batch_src_global generation:  0.050728559494018555
r_  generation:  0.44353413581848145
local_output_nid generation:  0.029686689376831055
local_in_edges_tensor generation:  0.03412318229675293
mini_batch_src_global generation:  0.05112504959106445
r_  generation:  0.4361419677734375
local_output_nid generation:  0.02953028678894043
local_in_edges_tensor generation:  0.030802488327026367
mini_batch_src_global generation:  0.049951791763305664
r_  generation:  0.43742942810058594
local_output_nid generation:  0.029549121856689453
local_in_edges_tensor generation:  0.030581951141357422
mini_batch_src_global generation:  0.053343772888183594
r_  generation:  0.43515944480895996
local_output_nid generation:  0.029549360275268555
local_in_edges_tensor generation:  0.04169940948486328
mini_batch_src_global generation:  0.0499415397644043
r_  generation:  0.43619656562805176
local_output_nid generation:  0.029291868209838867
local_in_edges_tensor generation:  0.038674354553222656
mini_batch_src_global generation:  0.05040764808654785
r_  generation:  0.4419517517089844
local_output_nid generation:  0.029396772384643555
local_in_edges_tensor generation:  0.030661344528198242
mini_batch_src_global generation:  0.0500180721282959
r_  generation:  0.43409299850463867
local_output_nid generation:  0.029442787170410156
local_in_edges_tensor generation:  0.030455350875854492
mini_batch_src_global generation:  0.05000877380371094
r_  generation:  0.43321847915649414
local_output_nid generation:  0.029584169387817383
local_in_edges_tensor generation:  0.030524015426635742
mini_batch_src_global generation:  0.05024313926696777
r_  generation:  0.44345736503601074
local_output_nid generation:  0.0307919979095459
local_in_edges_tensor generation:  0.03423142433166504
mini_batch_src_global generation:  0.05108237266540527
r_  generation:  0.43964481353759766
local_output_nid generation:  0.029761314392089844
local_in_edges_tensor generation:  0.034688711166381836
mini_batch_src_global generation:  0.05329418182373047
r_  generation:  0.44110584259033203
local_output_nid generation:  0.02965259552001953
local_in_edges_tensor generation:  0.03394675254821777
mini_batch_src_global generation:  0.05080080032348633
r_  generation:  0.43886256217956543
local_output_nid generation:  0.029864072799682617
local_in_edges_tensor generation:  0.03498959541320801
mini_batch_src_global generation:  0.052918434143066406
r_  generation:  0.4446864128112793
local_output_nid generation:  0.030106067657470703
local_in_edges_tensor generation:  0.04016470909118652
mini_batch_src_global generation:  0.053899288177490234
r_  generation:  0.441741943359375
local_output_nid generation:  0.02985548973083496
local_in_edges_tensor generation:  0.034897565841674805
mini_batch_src_global generation:  0.05626988410949707
r_  generation:  0.44820308685302734
local_output_nid generation:  0.031218528747558594
local_in_edges_tensor generation:  0.043625593185424805
mini_batch_src_global generation:  0.05226707458496094
r_  generation:  0.45553064346313477
local_output_nid generation:  0.03368330001831055
local_in_edges_tensor generation:  0.04139852523803711
mini_batch_src_global generation:  0.05245494842529297
r_  generation:  0.44425177574157715
local_output_nid generation:  0.03130197525024414
local_in_edges_tensor generation:  0.03181934356689453
mini_batch_src_global generation:  0.05086469650268555
r_  generation:  0.4423072338104248
local_output_nid generation:  0.031409263610839844
local_in_edges_tensor generation:  0.030788421630859375
mini_batch_src_global generation:  0.0510408878326416
r_  generation:  0.4407494068145752
local_output_nid generation:  0.03079986572265625
local_in_edges_tensor generation:  0.03476119041442871
mini_batch_src_global generation:  0.05109739303588867
r_  generation:  0.4346303939819336
local_output_nid generation:  0.031225204467773438
local_in_edges_tensor generation:  0.03808283805847168
mini_batch_src_global generation:  0.05916714668273926
r_  generation:  0.4399263858795166
local_output_nid generation:  0.03156256675720215
local_in_edges_tensor generation:  0.034430503845214844
mini_batch_src_global generation:  0.053655385971069336
r_  generation:  0.4411132335662842
local_output_nid generation:  0.03087902069091797
local_in_edges_tensor generation:  0.03837180137634277
mini_batch_src_global generation:  0.05080986022949219
r_  generation:  0.44129014015197754
local_output_nid generation:  0.030942201614379883
local_in_edges_tensor generation:  0.03497195243835449
mini_batch_src_global generation:  0.051184654235839844
r_  generation:  0.4415297508239746
----------------------check_connections_block total spend ----------------------------- 20.894210815429688
generate_one_block  0.5884602069854736
generate_one_block  0.5800497531890869
generate_one_block  0.584425687789917
generate_one_block  0.5837538242340088
generate_one_block  0.6909692287445068
generate_one_block  0.5685849189758301
generate_one_block  0.5886914730072021
generate_one_block  0.5875966548919678
generate_one_block  0.5711798667907715
generate_one_block  0.5858478546142578
generate_one_block  0.5690960884094238
generate_one_block  0.574460506439209
generate_one_block  0.5926375389099121
generate_one_block  0.5811707973480225
generate_one_block  0.5683398246765137
generate_one_block  0.5829067230224609
generate_one_block  0.6267833709716797
generate_one_block  0.5909631252288818
generate_one_block  0.612541913986206
generate_one_block  0.6230630874633789
generate_one_block  0.6021304130554199
generate_one_block  0.6081106662750244
generate_one_block  0.5891196727752686
generate_one_block  0.5967087745666504
generate_one_block  0.615260124206543
generate_one_block  0.6006126403808594
generate_one_block  0.5970661640167236
generate_one_block  0.5759971141815186
generate_one_block  0.5788013935089111
generate_one_block  0.6115274429321289
generate_one_block  0.6011013984680176
generate_one_block  0.5827531814575195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.10888814926147461  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

connection checking time:  29.422492027282715
block generation total time  27.053617238998413
average batch blocks generation time:  0.8454255387187004
block dataloader generation time/epoch 59.89896512031555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08903980255126953  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148775, 128])
torch.Size([109803, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.299068927764893  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08871984481811523  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148347, 128])
torch.Size([108868, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.234951496124268  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08908843994140625  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148940, 128])
torch.Size([109790, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.279556274414062  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08906412124633789  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148567, 128])
torch.Size([109567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.365235328674316  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08908367156982422  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148722, 128])
torch.Size([109923, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.38378620147705  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08878469467163086  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148331, 128])
torch.Size([109141, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.300910949707031  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08936595916748047  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149008, 128])
torch.Size([110282, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.45463228225708  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08937740325927734  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149108, 128])
torch.Size([110557, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.430943965911865  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08937358856201172  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149070, 128])
torch.Size([110213, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.416177749633789  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08932113647460938  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149132, 128])
torch.Size([109946, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.378824710845947  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08906984329223633  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148755, 128])
torch.Size([109330, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.287136554718018  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08924198150634766  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149258, 128])
torch.Size([110090, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.307437896728516  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.0892329216003418  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148593, 128])
torch.Size([109757, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.463422775268555  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08910417556762695  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148869, 128])
torch.Size([109772, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.322664737701416  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08866500854492188  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148166, 128])
torch.Size([108963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.242032527923584  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08855390548706055  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148287, 128])
torch.Size([108595, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.0417799949646  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08922672271728516  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148962, 128])
torch.Size([109521, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.350343704223633  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08880853652954102  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148477, 128])
torch.Size([109245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.154589176177979  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08942079544067383  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149209, 128])
torch.Size([110509, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.449032306671143  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.0887289047241211  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148464, 128])
torch.Size([108956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.185226440429688  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08950471878051758  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149465, 128])
torch.Size([110971, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.40893840789795  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08903312683105469  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148822, 128])
torch.Size([109901, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.319472789764404  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08933115005493164  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149287, 128])
torch.Size([110300, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.339118480682373  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.0892949104309082  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148885, 128])
torch.Size([110323, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.445902824401855  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08944463729858398  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149225, 128])
torch.Size([110763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.460537433624268  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08940362930297852  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149315, 128])
torch.Size([110724, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.396503925323486  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08919906616210938  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148682, 128])
torch.Size([109580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.408121109008789  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08840274810791016  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148162, 128])
torch.Size([107788, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.073999404907227  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08901691436767578  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149040, 128])
torch.Size([109329, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.228043556213379  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08925485610961914  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([148779, 128])
torch.Size([110531, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.435643196105957  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08951807022094727  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149025, 128])
torch.Size([110743, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.520097732543945  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 0.08926582336425781  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

torch.Size([149200, 128])
torch.Size([110711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8280029296875 GB
    Memory Allocated: 12.358138084411621  GigaBytes
Max Memory Allocated: 12.556225776672363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03089422732591629 |0.020669832825660706 |0.5263414904475212 |9.783357381820679e-05 |0.8446377366781235 |0.008267641067504883 |
----------------------------------------------------------pseudo_mini_loss sum 3.793090581893921
Total (block generation + training)time/epoch 105.49581789970398
Training time/epoch 45.59653639793396
Training time without block to device /epoch 44.93510174751282
Training time without total dataloading part /epoch 43.88273358345032
load block tensor time/epoch 0.9886152744293213
block to device time/epoch 0.6614346504211426
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9117264
Number of first layer input nodes during this epoch:  4762927
