Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648503812.3587265
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024669885635375977
random selection method range initialization spend 0.0061206817626953125
time for parepare:  0.019205331802368164
local_output_nid generation:  0.001138925552368164
local_in_edges_tensor generation:  0.0030319690704345703
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.0093231201171875
local_output_nid generation:  0.001397848129272461
local_in_edges_tensor generation:  0.0009696483612060547
mini_batch_src_global generation:  0.0014176368713378906
r_  generation:  0.0077784061431884766
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0008606910705566406
mini_batch_src_global generation:  0.0009202957153320312
r_  generation:  0.007837533950805664
local_output_nid generation:  0.0014286041259765625
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0008406639099121094
r_  generation:  0.00770115852355957
local_output_nid generation:  0.0014052391052246094
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0008251667022705078
r_  generation:  0.0077915191650390625
local_output_nid generation:  0.00140380859375
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0008130073547363281
r_  generation:  0.007901430130004883
local_output_nid generation:  0.0013818740844726562
local_in_edges_tensor generation:  0.0007419586181640625
mini_batch_src_global generation:  0.000942230224609375
r_  generation:  0.008016109466552734
local_output_nid generation:  0.0013942718505859375
local_in_edges_tensor generation:  0.0007319450378417969
mini_batch_src_global generation:  0.0008056163787841797
r_  generation:  0.007997512817382812
local_output_nid generation:  0.0013709068298339844
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0008530616760253906
r_  generation:  0.008176088333129883
local_output_nid generation:  0.0013992786407470703
local_in_edges_tensor generation:  0.0007312297821044922
mini_batch_src_global generation:  0.0008389949798583984
r_  generation:  0.008032560348510742
local_output_nid generation:  0.001390218734741211
local_in_edges_tensor generation:  0.0007448196411132812
mini_batch_src_global generation:  0.0008614063262939453
r_  generation:  0.00833272933959961
local_output_nid generation:  0.0014081001281738281
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.0008683204650878906
r_  generation:  0.008459091186523438
local_output_nid generation:  0.0013878345489501953
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0008485317230224609
r_  generation:  0.008244037628173828
local_output_nid generation:  0.0014061927795410156
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0008873939514160156
r_  generation:  0.008284330368041992
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.0007319450378417969
mini_batch_src_global generation:  0.0008168220520019531
r_  generation:  0.007981538772583008
local_output_nid generation:  0.0014042854309082031
local_in_edges_tensor generation:  0.0007154941558837891
mini_batch_src_global generation:  0.0008566379547119141
r_  generation:  0.008121728897094727
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0007128715515136719
mini_batch_src_global generation:  0.0008215904235839844
r_  generation:  0.00788116455078125
local_output_nid generation:  0.0014026165008544922
local_in_edges_tensor generation:  0.0007345676422119141
mini_batch_src_global generation:  0.0008203983306884766
r_  generation:  0.007821321487426758
local_output_nid generation:  0.0013988018035888672
local_in_edges_tensor generation:  0.0007174015045166016
mini_batch_src_global generation:  0.0009629726409912109
r_  generation:  0.008232355117797852
local_output_nid generation:  0.0014178752899169922
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.008002996444702148
local_output_nid generation:  0.0013952255249023438
local_in_edges_tensor generation:  0.0007297992706298828
mini_batch_src_global generation:  0.0008287429809570312
r_  generation:  0.008114099502563477
local_output_nid generation:  0.0013799667358398438
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008299350738525391
r_  generation:  0.008112430572509766
local_output_nid generation:  0.0013918876647949219
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0008554458618164062
r_  generation:  0.007954835891723633
local_output_nid generation:  0.0013866424560546875
local_in_edges_tensor generation:  0.0007390975952148438
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.008085250854492188
local_output_nid generation:  0.0013804435729980469
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0009756088256835938
r_  generation:  0.008210897445678711
local_output_nid generation:  0.0013651847839355469
local_in_edges_tensor generation:  0.0007071495056152344
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.008368968963623047
local_output_nid generation:  0.0014081001281738281
local_in_edges_tensor generation:  0.0007152557373046875
mini_batch_src_global generation:  0.0008585453033447266
r_  generation:  0.008306741714477539
local_output_nid generation:  0.0013890266418457031
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.0008521080017089844
r_  generation:  0.007955551147460938
local_output_nid generation:  0.0013909339904785156
local_in_edges_tensor generation:  0.0007109642028808594
mini_batch_src_global generation:  0.0008347034454345703
r_  generation:  0.00812673568725586
local_output_nid generation:  0.0013890266418457031
local_in_edges_tensor generation:  0.0007259845733642578
mini_batch_src_global generation:  0.0008540153503417969
r_  generation:  0.008099079132080078
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.005239248275756836
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.008601188659667969
local_output_nid generation:  0.0012562274932861328
local_in_edges_tensor generation:  0.0007569789886474609
mini_batch_src_global generation:  0.0009377002716064453
r_  generation:  0.008070707321166992
----------------------check_connections_block total spend ----------------------------- 0.4632594585418701
generate_one_block  0.013983488082885742
generate_one_block  0.013226747512817383
generate_one_block  0.013430595397949219
generate_one_block  0.012974023818969727
generate_one_block  0.013149023056030273
generate_one_block  0.012992143630981445
generate_one_block  0.013117074966430664
generate_one_block  0.012979507446289062
generate_one_block  0.0134124755859375
generate_one_block  0.013215303421020508
generate_one_block  0.01327371597290039
generate_one_block  0.01328897476196289
generate_one_block  0.013175249099731445
generate_one_block  0.013364076614379883
generate_one_block  0.01264500617980957
generate_one_block  0.013056755065917969
generate_one_block  0.012585163116455078
generate_one_block  0.01253056526184082
generate_one_block  0.013029098510742188
generate_one_block  0.012876749038696289
generate_one_block  0.01287221908569336
generate_one_block  0.012797832489013672
generate_one_block  0.012757539749145508
generate_one_block  0.012925148010253906
generate_one_block  0.013333797454833984
generate_one_block  0.013052701950073242
generate_one_block  0.013086557388305664
generate_one_block  0.012687206268310547
generate_one_block  0.01293492317199707
generate_one_block  0.012978076934814453
generate_one_block  0.013597726821899414
generate_one_block  0.012664794921875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04056859016418457
gen group dst list time:  0.021508216857910156
time for parepare:  0.0190737247467041
local_output_nid generation:  0.004724740982055664
local_in_edges_tensor generation:  0.010827779769897461
mini_batch_src_global generation:  0.012151002883911133
r_  generation:  0.12279295921325684
local_output_nid generation:  0.007605791091918945
local_in_edges_tensor generation:  0.012120723724365234
mini_batch_src_global generation:  0.015682458877563477
r_  generation:  0.12822771072387695
local_output_nid generation:  0.0075953006744384766
local_in_edges_tensor generation:  0.007734060287475586
mini_batch_src_global generation:  0.015522003173828125
r_  generation:  0.1364271640777588
local_output_nid generation:  0.007161140441894531
local_in_edges_tensor generation:  0.008565187454223633
mini_batch_src_global generation:  0.014864683151245117
r_  generation:  0.13837289810180664
local_output_nid generation:  0.0073833465576171875
local_in_edges_tensor generation:  0.008692502975463867
mini_batch_src_global generation:  0.020544052124023438
r_  generation:  0.14068913459777832
local_output_nid generation:  0.0073740482330322266
local_in_edges_tensor generation:  0.008840560913085938
mini_batch_src_global generation:  0.016585588455200195
r_  generation:  0.1412978172302246
local_output_nid generation:  0.010378599166870117
local_in_edges_tensor generation:  0.010190725326538086
mini_batch_src_global generation:  0.016551733016967773
r_  generation:  0.1412973403930664
local_output_nid generation:  0.00734400749206543
local_in_edges_tensor generation:  0.010616064071655273
mini_batch_src_global generation:  0.016576051712036133
r_  generation:  0.13968586921691895
local_output_nid generation:  0.007455587387084961
local_in_edges_tensor generation:  0.010489702224731445
mini_batch_src_global generation:  0.020385265350341797
r_  generation:  0.14806246757507324
local_output_nid generation:  0.00816798210144043
local_in_edges_tensor generation:  0.024079322814941406
mini_batch_src_global generation:  0.02642226219177246
r_  generation:  0.14313721656799316
local_output_nid generation:  0.008577108383178711
local_in_edges_tensor generation:  0.010104894638061523
mini_batch_src_global generation:  0.01774001121520996
r_  generation:  0.14289641380310059
local_output_nid generation:  0.007601499557495117
local_in_edges_tensor generation:  0.009950399398803711
mini_batch_src_global generation:  0.017490386962890625
r_  generation:  0.14109206199645996
local_output_nid generation:  0.0076258182525634766
local_in_edges_tensor generation:  0.007563114166259766
mini_batch_src_global generation:  0.016964435577392578
r_  generation:  0.14151787757873535
local_output_nid generation:  0.007736682891845703
local_in_edges_tensor generation:  0.009967803955078125
mini_batch_src_global generation:  0.017409563064575195
r_  generation:  0.14496135711669922
local_output_nid generation:  0.007401704788208008
local_in_edges_tensor generation:  0.008290529251098633
mini_batch_src_global generation:  0.016596078872680664
r_  generation:  0.137526273727417
local_output_nid generation:  0.007601022720336914
local_in_edges_tensor generation:  0.008573055267333984
mini_batch_src_global generation:  0.0178830623626709
r_  generation:  0.1403360366821289
local_output_nid generation:  0.007392406463623047
local_in_edges_tensor generation:  0.007204771041870117
mini_batch_src_global generation:  0.01659393310546875
r_  generation:  0.1360149383544922
local_output_nid generation:  0.007276296615600586
local_in_edges_tensor generation:  0.007550239562988281
mini_batch_src_global generation:  0.016300678253173828
r_  generation:  0.13278579711914062
local_output_nid generation:  0.007663726806640625
local_in_edges_tensor generation:  0.009845495223999023
mini_batch_src_global generation:  0.018108606338500977
r_  generation:  0.1423637866973877
local_output_nid generation:  0.007538795471191406
local_in_edges_tensor generation:  0.0073490142822265625
mini_batch_src_global generation:  0.01702594757080078
r_  generation:  0.1400895118713379
local_output_nid generation:  0.007511138916015625
local_in_edges_tensor generation:  0.010641336441040039
mini_batch_src_global generation:  0.016885995864868164
r_  generation:  0.1413125991821289
local_output_nid generation:  0.00761866569519043
local_in_edges_tensor generation:  0.009837627410888672
mini_batch_src_global generation:  0.016805171966552734
r_  generation:  0.14920401573181152
local_output_nid generation:  0.007455587387084961
local_in_edges_tensor generation:  0.008147478103637695
mini_batch_src_global generation:  0.01651477813720703
r_  generation:  0.14450693130493164
local_output_nid generation:  0.00823521614074707
local_in_edges_tensor generation:  0.01000356674194336
mini_batch_src_global generation:  0.01715373992919922
r_  generation:  0.13812756538391113
local_output_nid generation:  0.00774073600769043
local_in_edges_tensor generation:  0.009802818298339844
mini_batch_src_global generation:  0.017133235931396484
r_  generation:  0.14072060585021973
local_output_nid generation:  0.007450103759765625
local_in_edges_tensor generation:  0.0075151920318603516
mini_batch_src_global generation:  0.017018556594848633
r_  generation:  0.1410527229309082
local_output_nid generation:  0.007560253143310547
local_in_edges_tensor generation:  0.009760618209838867
mini_batch_src_global generation:  0.017147302627563477
r_  generation:  0.14238381385803223
local_output_nid generation:  0.007482767105102539
local_in_edges_tensor generation:  0.007294178009033203
mini_batch_src_global generation:  0.01701664924621582
r_  generation:  0.13706231117248535
local_output_nid generation:  0.007384538650512695
local_in_edges_tensor generation:  0.007192850112915039
mini_batch_src_global generation:  0.01692509651184082
r_  generation:  0.14366412162780762
local_output_nid generation:  0.007509946823120117
local_in_edges_tensor generation:  0.007456064224243164
mini_batch_src_global generation:  0.016833782196044922
r_  generation:  0.13948535919189453
local_output_nid generation:  0.007616996765136719
local_in_edges_tensor generation:  0.010845184326171875
mini_batch_src_global generation:  0.017317533493041992
r_  generation:  0.14389705657958984
local_output_nid generation:  0.007441520690917969
local_in_edges_tensor generation:  0.007455587387084961
mini_batch_src_global generation:  0.01670551300048828
r_  generation:  0.13591480255126953
----------------------check_connections_block total spend ----------------------------- 6.624037981033325
generate_one_block  0.1810917854309082
generate_one_block  0.1729598045349121
generate_one_block  0.19928312301635742
generate_one_block  0.17043352127075195
generate_one_block  0.1731581687927246
generate_one_block  0.17546868324279785
generate_one_block  0.1772294044494629
generate_one_block  0.1728811264038086
generate_one_block  0.17866873741149902
generate_one_block  0.17319416999816895
generate_one_block  0.17896652221679688
generate_one_block  0.18830633163452148
generate_one_block  0.17653632164001465
generate_one_block  0.18397235870361328
generate_one_block  0.16625142097473145
generate_one_block  0.16953802108764648
generate_one_block  0.17180132865905762
generate_one_block  0.16403532028198242
generate_one_block  0.1795952320098877
generate_one_block  0.16934585571289062
generate_one_block  0.17187809944152832
generate_one_block  0.1706218719482422
generate_one_block  0.17126846313476562
generate_one_block  0.1708228588104248
generate_one_block  0.17554521560668945
generate_one_block  0.17387795448303223
generate_one_block  0.17595791816711426
generate_one_block  0.17134737968444824
generate_one_block  0.177825927734375
generate_one_block  0.17220425605773926
generate_one_block  0.17908763885498047
generate_one_block  0.1660902500152588
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.05309009552001953
gen group dst list time:  0.09963178634643555
time for parepare:  0.021739482879638672
local_output_nid generation:  0.022137880325317383
local_in_edges_tensor generation:  0.05015063285827637
mini_batch_src_global generation:  0.046304941177368164
r_  generation:  0.45693278312683105
local_output_nid generation:  0.02997565269470215
local_in_edges_tensor generation:  0.045665740966796875
mini_batch_src_global generation:  0.053125858306884766
r_  generation:  0.4501161575317383
local_output_nid generation:  0.030455589294433594
local_in_edges_tensor generation:  0.04343295097351074
mini_batch_src_global generation:  0.057637929916381836
r_  generation:  0.45908379554748535
local_output_nid generation:  0.027768611907958984
local_in_edges_tensor generation:  0.02884650230407715
mini_batch_src_global generation:  0.05328512191772461
r_  generation:  0.4704735279083252
local_output_nid generation:  0.02690434455871582
local_in_edges_tensor generation:  0.04680633544921875
mini_batch_src_global generation:  0.05903935432434082
r_  generation:  0.45636534690856934
local_output_nid generation:  0.029484272003173828
local_in_edges_tensor generation:  0.03803133964538574
mini_batch_src_global generation:  0.05414915084838867
r_  generation:  0.4495103359222412
local_output_nid generation:  0.027432918548583984
local_in_edges_tensor generation:  0.032920122146606445
mini_batch_src_global generation:  0.060304880142211914
r_  generation:  0.45656275749206543
local_output_nid generation:  0.027324914932250977
local_in_edges_tensor generation:  0.036275386810302734
mini_batch_src_global generation:  0.053661346435546875
r_  generation:  0.4558236598968506
local_output_nid generation:  0.02766251564025879
local_in_edges_tensor generation:  0.03212690353393555
mini_batch_src_global generation:  0.058655738830566406
r_  generation:  0.4594097137451172
local_output_nid generation:  0.028268098831176758
local_in_edges_tensor generation:  0.028604745864868164
mini_batch_src_global generation:  0.053640127182006836
r_  generation:  0.4550158977508545
local_output_nid generation:  0.027650117874145508
local_in_edges_tensor generation:  0.02884674072265625
mini_batch_src_global generation:  0.05469489097595215
r_  generation:  0.4550197124481201
local_output_nid generation:  0.027538061141967773
local_in_edges_tensor generation:  0.040337324142456055
mini_batch_src_global generation:  0.05559515953063965
r_  generation:  0.4559485912322998
local_output_nid generation:  0.027623891830444336
local_in_edges_tensor generation:  0.045197248458862305
mini_batch_src_global generation:  0.07246875762939453
r_  generation:  0.46311163902282715
local_output_nid generation:  0.028929710388183594
local_in_edges_tensor generation:  0.04143500328063965
mini_batch_src_global generation:  0.05433487892150879
r_  generation:  0.46056675910949707
local_output_nid generation:  0.0274810791015625
local_in_edges_tensor generation:  0.03350377082824707
mini_batch_src_global generation:  0.05694317817687988
r_  generation:  0.45236659049987793
local_output_nid generation:  0.027354955673217773
local_in_edges_tensor generation:  0.02588796615600586
mini_batch_src_global generation:  0.053926944732666016
r_  generation:  0.46403002738952637
local_output_nid generation:  0.027457714080810547
local_in_edges_tensor generation:  0.02645564079284668
mini_batch_src_global generation:  0.05480599403381348
r_  generation:  0.4545261859893799
local_output_nid generation:  0.027190446853637695
local_in_edges_tensor generation:  0.026896953582763672
mini_batch_src_global generation:  0.05312633514404297
r_  generation:  0.4458625316619873
local_output_nid generation:  0.027591466903686523
local_in_edges_tensor generation:  0.031131982803344727
mini_batch_src_global generation:  0.05718183517456055
r_  generation:  0.4616708755493164
local_output_nid generation:  0.028379440307617188
local_in_edges_tensor generation:  0.03027939796447754
mini_batch_src_global generation:  0.054596662521362305
r_  generation:  0.44933247566223145
local_output_nid generation:  0.027323484420776367
local_in_edges_tensor generation:  0.030260562896728516
mini_batch_src_global generation:  0.054685354232788086
r_  generation:  0.4558415412902832
local_output_nid generation:  0.027675390243530273
local_in_edges_tensor generation:  0.02657008171081543
mini_batch_src_global generation:  0.05410337448120117
r_  generation:  0.45061731338500977
local_output_nid generation:  0.027250289916992188
local_in_edges_tensor generation:  0.029947280883789062
mini_batch_src_global generation:  0.053717851638793945
r_  generation:  0.45281982421875
local_output_nid generation:  0.027284860610961914
local_in_edges_tensor generation:  0.034220218658447266
mini_batch_src_global generation:  0.05614018440246582
r_  generation:  0.45427656173706055
local_output_nid generation:  0.027858734130859375
local_in_edges_tensor generation:  0.035823822021484375
mini_batch_src_global generation:  0.0572202205657959
r_  generation:  0.453535795211792
local_output_nid generation:  0.027312278747558594
local_in_edges_tensor generation:  0.034804344177246094
mini_batch_src_global generation:  0.05404496192932129
r_  generation:  0.45877552032470703
local_output_nid generation:  0.027553319931030273
local_in_edges_tensor generation:  0.027020931243896484
mini_batch_src_global generation:  0.06896042823791504
r_  generation:  0.46017932891845703
local_output_nid generation:  0.027394771575927734
local_in_edges_tensor generation:  0.02871417999267578
mini_batch_src_global generation:  0.054335594177246094
r_  generation:  0.4712643623352051
local_output_nid generation:  0.027390003204345703
local_in_edges_tensor generation:  0.0421907901763916
mini_batch_src_global generation:  0.05813884735107422
r_  generation:  0.45636773109436035
local_output_nid generation:  0.027553319931030273
local_in_edges_tensor generation:  0.03369307518005371
mini_batch_src_global generation:  0.05425691604614258
r_  generation:  0.4570729732513428
local_output_nid generation:  0.027300357818603516
local_in_edges_tensor generation:  0.028298139572143555
mini_batch_src_global generation:  0.05360722541809082
r_  generation:  0.46206188201904297
local_output_nid generation:  0.029772520065307617
local_in_edges_tensor generation:  0.030296802520751953
mini_batch_src_global generation:  0.054459571838378906
r_  generation:  0.45494508743286133
----------------------check_connections_block total spend ----------------------------- 21.550747394561768
generate_one_block  0.5979681015014648
generate_one_block  0.68701171875
generate_one_block  0.5989317893981934
generate_one_block  0.5865283012390137
generate_one_block  0.5870592594146729
generate_one_block  0.5958707332611084
generate_one_block  0.5933029651641846
generate_one_block  0.5910649299621582
generate_one_block  0.6023485660552979
generate_one_block  0.5822575092315674
generate_one_block  0.5975759029388428
generate_one_block  0.6001994609832764
generate_one_block  0.595405101776123
generate_one_block  0.5966768264770508
generate_one_block  0.5753810405731201
generate_one_block  0.5738620758056641
generate_one_block  0.5740582942962646
generate_one_block  0.5679962635040283
generate_one_block  0.6048824787139893
generate_one_block  0.5890038013458252
generate_one_block  0.588836669921875
generate_one_block  0.5892231464385986
generate_one_block  0.5849251747131348
generate_one_block  0.5739529132843018
generate_one_block  0.6024348735809326
generate_one_block  0.5992069244384766
generate_one_block  0.5776135921478271
generate_one_block  0.5750441551208496
generate_one_block  0.6030278205871582
generate_one_block  0.5867867469787598
generate_one_block  0.5847735404968262
generate_one_block  0.5880634784698486
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07755446434020996
gen group dst list time:  0.16405820846557617
time for parepare:  0.02053523063659668
local_output_nid generation:  0.034078121185302734
local_in_edges_tensor generation:  0.06344246864318848
mini_batch_src_global generation:  0.051894426345825195
r_  generation:  0.5234911441802979
local_output_nid generation:  0.03910040855407715
local_in_edges_tensor generation:  0.05964398384094238
mini_batch_src_global generation:  0.06452631950378418
r_  generation:  0.532397985458374
local_output_nid generation:  0.03769493103027344
local_in_edges_tensor generation:  0.05100584030151367
mini_batch_src_global generation:  0.06955432891845703
r_  generation:  0.5414400100708008
local_output_nid generation:  0.04022526741027832
local_in_edges_tensor generation:  0.05451202392578125
mini_batch_src_global generation:  0.05608534812927246
r_  generation:  0.5367908477783203
local_output_nid generation:  0.0382084846496582
local_in_edges_tensor generation:  0.048412322998046875
mini_batch_src_global generation:  0.05687761306762695
r_  generation:  0.5416626930236816
local_output_nid generation:  0.037860870361328125
local_in_edges_tensor generation:  0.04016447067260742
mini_batch_src_global generation:  0.057554006576538086
r_  generation:  0.543431282043457
local_output_nid generation:  0.038147687911987305
local_in_edges_tensor generation:  0.04963946342468262
mini_batch_src_global generation:  0.057695865631103516
r_  generation:  0.5474889278411865
local_output_nid generation:  0.038140058517456055
local_in_edges_tensor generation:  0.04872751235961914
mini_batch_src_global generation:  0.05887103080749512
r_  generation:  0.5431015491485596
local_output_nid generation:  0.03789830207824707
local_in_edges_tensor generation:  0.05001258850097656
mini_batch_src_global generation:  0.0578455924987793
r_  generation:  0.550175666809082
local_output_nid generation:  0.03772997856140137
local_in_edges_tensor generation:  0.04059863090515137
mini_batch_src_global generation:  0.05890822410583496
r_  generation:  0.5444135665893555
local_output_nid generation:  0.04062318801879883
local_in_edges_tensor generation:  0.045298099517822266
mini_batch_src_global generation:  0.06305551528930664
r_  generation:  0.5514576435089111
local_output_nid generation:  0.038064002990722656
local_in_edges_tensor generation:  0.050377607345581055
mini_batch_src_global generation:  0.05892753601074219
r_  generation:  0.5492777824401855
local_output_nid generation:  0.03786325454711914
local_in_edges_tensor generation:  0.04749798774719238
mini_batch_src_global generation:  0.059133052825927734
r_  generation:  0.5555791854858398
local_output_nid generation:  0.03914952278137207
local_in_edges_tensor generation:  0.045325279235839844
mini_batch_src_global generation:  0.059693336486816406
r_  generation:  0.5448124408721924
local_output_nid generation:  0.03790593147277832
local_in_edges_tensor generation:  0.040000200271606445
mini_batch_src_global generation:  0.05887889862060547
r_  generation:  0.5491373538970947
local_output_nid generation:  0.03781557083129883
local_in_edges_tensor generation:  0.04079771041870117
mini_batch_src_global generation:  0.059491634368896484
r_  generation:  0.5546436309814453
local_output_nid generation:  0.038565874099731445
local_in_edges_tensor generation:  0.05450153350830078
mini_batch_src_global generation:  0.058600425720214844
r_  generation:  0.5507957935333252
local_output_nid generation:  0.037749290466308594
local_in_edges_tensor generation:  0.04015517234802246
mini_batch_src_global generation:  0.06011486053466797
r_  generation:  0.5441732406616211
local_output_nid generation:  0.03828549385070801
local_in_edges_tensor generation:  0.04505157470703125
mini_batch_src_global generation:  0.05976104736328125
r_  generation:  0.5601277351379395
local_output_nid generation:  0.038378238677978516
local_in_edges_tensor generation:  0.043515682220458984
mini_batch_src_global generation:  0.06065797805786133
r_  generation:  0.5423574447631836
local_output_nid generation:  0.03808760643005371
local_in_edges_tensor generation:  0.04351663589477539
mini_batch_src_global generation:  0.059697628021240234
r_  generation:  0.5547146797180176
local_output_nid generation:  0.038089752197265625
local_in_edges_tensor generation:  0.045191287994384766
mini_batch_src_global generation:  0.06489372253417969
r_  generation:  0.5444774627685547
local_output_nid generation:  0.03794598579406738
local_in_edges_tensor generation:  0.05548405647277832
mini_batch_src_global generation:  0.06553125381469727
r_  generation:  0.5511283874511719
local_output_nid generation:  0.0380401611328125
local_in_edges_tensor generation:  0.0535883903503418
mini_batch_src_global generation:  0.06073498725891113
r_  generation:  0.5424737930297852
local_output_nid generation:  0.03825259208679199
local_in_edges_tensor generation:  0.040468692779541016
mini_batch_src_global generation:  0.05918693542480469
r_  generation:  0.5617859363555908
local_output_nid generation:  0.0390772819519043
local_in_edges_tensor generation:  0.04370999336242676
mini_batch_src_global generation:  0.06473445892333984
r_  generation:  0.5438246726989746
local_output_nid generation:  0.038043975830078125
local_in_edges_tensor generation:  0.04738736152648926
mini_batch_src_global generation:  0.061139822006225586
r_  generation:  0.5563030242919922
local_output_nid generation:  0.038001298904418945
local_in_edges_tensor generation:  0.049864768981933594
mini_batch_src_global generation:  0.06064653396606445
r_  generation:  0.5571873188018799
local_output_nid generation:  0.04017972946166992
local_in_edges_tensor generation:  0.0413355827331543
mini_batch_src_global generation:  0.06650090217590332
r_  generation:  0.5565800666809082
local_output_nid generation:  0.03809785842895508
local_in_edges_tensor generation:  0.045586347579956055
mini_batch_src_global generation:  0.06186699867248535
r_  generation:  0.5455927848815918
local_output_nid generation:  0.03814840316772461
local_in_edges_tensor generation:  0.04201006889343262
mini_batch_src_global generation:  0.06077885627746582
r_  generation:  0.5566604137420654
local_output_nid generation:  0.03800487518310547
local_in_edges_tensor generation:  0.049539804458618164
mini_batch_src_global generation:  0.061267852783203125
r_  generation:  0.5405826568603516
----------------------check_connections_block total spend ----------------------------- 26.26261615753174
generate_one_block  0.6963443756103516
generate_one_block  0.6807043552398682
generate_one_block  0.6798510551452637
generate_one_block  0.6827256679534912
generate_one_block  0.6757442951202393
generate_one_block  0.6658351421356201
generate_one_block  0.6827778816223145
generate_one_block  0.807478666305542
generate_one_block  0.681450605392456
generate_one_block  0.661534309387207
generate_one_block  0.6852607727050781
generate_one_block  0.6669940948486328
generate_one_block  0.671987771987915
generate_one_block  0.672417402267456
generate_one_block  0.6623966693878174
generate_one_block  0.6661443710327148
generate_one_block  0.6829659938812256
generate_one_block  0.6748983860015869
generate_one_block  0.6864449977874756
generate_one_block  0.6736185550689697
generate_one_block  0.6636903285980225
generate_one_block  0.6828093528747559
generate_one_block  0.6839902400970459
generate_one_block  0.6816854476928711
generate_one_block  0.669893741607666
generate_one_block  0.660984992980957
generate_one_block  0.6627089977264404
generate_one_block  0.6992969512939453
generate_one_block  0.6676020622253418
generate_one_block  0.6875884532928467
generate_one_block  0.6671249866485596
generate_one_block  0.6851928234100342
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04177689552307129
gen group dst list time:  0.19469380378723145
time for parepare:  0.01946258544921875
local_output_nid generation:  0.03805875778198242
local_in_edges_tensor generation:  0.057100534439086914
mini_batch_src_global generation:  0.04775118827819824
r_  generation:  0.5059061050415039
local_output_nid generation:  0.042939186096191406
local_in_edges_tensor generation:  0.037982940673828125
mini_batch_src_global generation:  0.05686450004577637
r_  generation:  0.5114703178405762
local_output_nid generation:  0.04279923439025879
local_in_edges_tensor generation:  0.043027639389038086
mini_batch_src_global generation:  0.05697011947631836
r_  generation:  0.5132529735565186
local_output_nid generation:  0.04244709014892578
local_in_edges_tensor generation:  0.05590486526489258
mini_batch_src_global generation:  0.05648922920227051
r_  generation:  0.5093421936035156
local_output_nid generation:  0.039995670318603516
local_in_edges_tensor generation:  0.044005393981933594
mini_batch_src_global generation:  0.05724501609802246
r_  generation:  0.5091400146484375
local_output_nid generation:  0.04016375541687012
local_in_edges_tensor generation:  0.03796553611755371
mini_batch_src_global generation:  0.05617976188659668
r_  generation:  0.5154538154602051
local_output_nid generation:  0.04070258140563965
local_in_edges_tensor generation:  0.03965878486633301
mini_batch_src_global generation:  0.059958696365356445
r_  generation:  0.5087318420410156
local_output_nid generation:  0.040502309799194336
local_in_edges_tensor generation:  0.04883551597595215
mini_batch_src_global generation:  0.05553936958312988
r_  generation:  0.5141410827636719
local_output_nid generation:  0.04001450538635254
local_in_edges_tensor generation:  0.04228830337524414
mini_batch_src_global generation:  0.0589752197265625
r_  generation:  0.5117056369781494
local_output_nid generation:  0.04106783866882324
local_in_edges_tensor generation:  0.03857994079589844
mini_batch_src_global generation:  0.05645895004272461
r_  generation:  0.5112040042877197
local_output_nid generation:  0.039945363998413086
local_in_edges_tensor generation:  0.04230761528015137
mini_batch_src_global generation:  0.05659365653991699
r_  generation:  0.5121574401855469
local_output_nid generation:  0.040069580078125
local_in_edges_tensor generation:  0.043701887130737305
mini_batch_src_global generation:  0.05702614784240723
r_  generation:  0.5211057662963867
local_output_nid generation:  0.04036712646484375
local_in_edges_tensor generation:  0.047447919845581055
mini_batch_src_global generation:  0.056554317474365234
r_  generation:  0.5193870067596436
local_output_nid generation:  0.04016542434692383
local_in_edges_tensor generation:  0.042891740798950195
mini_batch_src_global generation:  0.055721282958984375
r_  generation:  0.5214147567749023
local_output_nid generation:  0.04027199745178223
local_in_edges_tensor generation:  0.04272270202636719
mini_batch_src_global generation:  0.05747413635253906
r_  generation:  0.5231788158416748
local_output_nid generation:  0.04087066650390625
local_in_edges_tensor generation:  0.049353837966918945
mini_batch_src_global generation:  0.06181478500366211
r_  generation:  0.5234742164611816
local_output_nid generation:  0.040494441986083984
local_in_edges_tensor generation:  0.044789791107177734
mini_batch_src_global generation:  0.05729389190673828
r_  generation:  0.5204715728759766
local_output_nid generation:  0.03999137878417969
local_in_edges_tensor generation:  0.05376601219177246
mini_batch_src_global generation:  0.06835269927978516
r_  generation:  0.5257525444030762
local_output_nid generation:  0.04190683364868164
local_in_edges_tensor generation:  0.03896927833557129
mini_batch_src_global generation:  0.05999445915222168
r_  generation:  0.525338888168335
local_output_nid generation:  0.041185855865478516
local_in_edges_tensor generation:  0.04252886772155762
mini_batch_src_global generation:  0.05688834190368652
r_  generation:  0.5302109718322754
local_output_nid generation:  0.041571617126464844
local_in_edges_tensor generation:  0.038861989974975586
mini_batch_src_global generation:  0.0602874755859375
r_  generation:  0.5257034301757812
local_output_nid generation:  0.04129338264465332
local_in_edges_tensor generation:  0.04292154312133789
mini_batch_src_global generation:  0.05756735801696777
r_  generation:  0.5265378952026367
local_output_nid generation:  0.0411074161529541
local_in_edges_tensor generation:  0.04368734359741211
mini_batch_src_global generation:  0.056661128997802734
r_  generation:  0.5230395793914795
local_output_nid generation:  0.041297197341918945
local_in_edges_tensor generation:  0.049074411392211914
mini_batch_src_global generation:  0.056900739669799805
r_  generation:  0.5299637317657471
local_output_nid generation:  0.04124259948730469
local_in_edges_tensor generation:  0.043487548828125
mini_batch_src_global generation:  0.05672025680541992
r_  generation:  0.5240213871002197
local_output_nid generation:  0.04152536392211914
local_in_edges_tensor generation:  0.0422210693359375
mini_batch_src_global generation:  0.057471513748168945
r_  generation:  0.5239624977111816
local_output_nid generation:  0.04133486747741699
local_in_edges_tensor generation:  0.04208874702453613
mini_batch_src_global generation:  0.05675148963928223
r_  generation:  0.5208559036254883
local_output_nid generation:  0.04122209548950195
local_in_edges_tensor generation:  0.04721879959106445
mini_batch_src_global generation:  0.05598592758178711
r_  generation:  0.5233569145202637
local_output_nid generation:  0.04142498970031738
local_in_edges_tensor generation:  0.04755425453186035
mini_batch_src_global generation:  0.05658698081970215
r_  generation:  0.5228877067565918
local_output_nid generation:  0.041285037994384766
local_in_edges_tensor generation:  0.04207611083984375
mini_batch_src_global generation:  0.056867122650146484
r_  generation:  0.5256919860839844
local_output_nid generation:  0.04092001914978027
local_in_edges_tensor generation:  0.047203779220581055
mini_batch_src_global generation:  0.05717968940734863
r_  generation:  0.524838924407959
local_output_nid generation:  0.041854143142700195
local_in_edges_tensor generation:  0.04262208938598633
mini_batch_src_global generation:  0.05746579170227051
r_  generation:  0.5273635387420654
----------------------check_connections_block total spend ----------------------------- 25.20263981819153
generate_one_block  0.6388289928436279
generate_one_block  0.6422016620635986
generate_one_block  0.6343839168548584
generate_one_block  0.6427199840545654
generate_one_block  0.642432451248169
generate_one_block  0.627161979675293
generate_one_block  0.6430063247680664
generate_one_block  0.6437244415283203
generate_one_block  0.6469540596008301
generate_one_block  0.6320614814758301
generate_one_block  0.6526229381561279
generate_one_block  0.6327450275421143
generate_one_block  0.6998462677001953
generate_one_block  0.7875244617462158
generate_one_block  0.63704514503479
generate_one_block  0.6460697650909424
generate_one_block  0.6560888290405273
generate_one_block  0.6615407466888428
generate_one_block  0.6570916175842285
generate_one_block  0.645676851272583
generate_one_block  0.6414616107940674
generate_one_block  0.6737701892852783
generate_one_block  0.6549851894378662
generate_one_block  0.6477563381195068
generate_one_block  0.6368675231933594
generate_one_block  0.6344211101531982
generate_one_block  0.6435348987579346
generate_one_block  0.7412443161010742
generate_one_block  0.6797535419464111
generate_one_block  0.6515359878540039
generate_one_block  0.6418743133544922
generate_one_block  0.6595628261566162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

connection checking time:  79.64004135131836
block generation total time  67.29715776443481
average batch blocks generation time:  2.103036180138588
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2108154296875 GB
    Memory Allocated: 0.12827157974243164  GigaBytes
Max Memory Allocated: 0.12827157974243164  GigaBytes

torch.Size([165358, 128])
torch.Size([161550, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 23.62 GiB total capacity; 21.92 GiB already allocated; 16.44 MiB free; 22.41 GiB reserved in total by PyTorch)
