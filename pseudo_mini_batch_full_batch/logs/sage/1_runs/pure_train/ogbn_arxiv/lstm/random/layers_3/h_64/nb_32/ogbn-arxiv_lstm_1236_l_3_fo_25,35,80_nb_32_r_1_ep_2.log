Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648457571.7118742
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026983022689819336
random selection method range initialization spend 0.006526470184326172
time for parepare:  0.01884603500366211
local_output_nid generation:  0.0011107921600341797
local_in_edges_tensor generation:  0.0032198429107666016
mini_batch_src_global generation:  0.0016753673553466797
r_  generation:  0.010901689529418945
local_output_nid generation:  0.0014040470123291016
local_in_edges_tensor generation:  0.0009946823120117188
mini_batch_src_global generation:  0.0015993118286132812
r_  generation:  0.009743452072143555
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0008447170257568359
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.00912332534790039
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0008368492126464844
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.009383678436279297
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0010378360748291016
r_  generation:  0.009700298309326172
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.00080108642578125
mini_batch_src_global generation:  0.0009768009185791016
r_  generation:  0.009294509887695312
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0009629726409912109
r_  generation:  0.009631633758544922
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0007863044738769531
mini_batch_src_global generation:  0.0009672641754150391
r_  generation:  0.009332418441772461
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.0009851455688476562
r_  generation:  0.009799480438232422
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.009503364562988281
local_output_nid generation:  0.0014371871948242188
local_in_edges_tensor generation:  0.0007343292236328125
mini_batch_src_global generation:  0.0009567737579345703
r_  generation:  0.009104251861572266
local_output_nid generation:  0.0014426708221435547
local_in_edges_tensor generation:  0.0007925033569335938
mini_batch_src_global generation:  0.0009827613830566406
r_  generation:  0.009566307067871094
local_output_nid generation:  0.0014443397521972656
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.010136604309082031
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0010004043579101562
r_  generation:  0.010009288787841797
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.000812530517578125
mini_batch_src_global generation:  0.0010211467742919922
r_  generation:  0.009870052337646484
local_output_nid generation:  0.0014445781707763672
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.0010085105895996094
r_  generation:  0.009803295135498047
local_output_nid generation:  0.0014529228210449219
local_in_edges_tensor generation:  0.0007455348968505859
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.009693145751953125
local_output_nid generation:  0.0014481544494628906
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0010159015655517578
r_  generation:  0.010155916213989258
local_output_nid generation:  0.0014476776123046875
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.010173559188842773
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0010883808135986328
r_  generation:  0.010013818740844727
local_output_nid generation:  0.0014927387237548828
local_in_edges_tensor generation:  0.0007586479187011719
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.00959920883178711
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007545948028564453
mini_batch_src_global generation:  0.0010347366333007812
r_  generation:  0.010237932205200195
local_output_nid generation:  0.0014917850494384766
local_in_edges_tensor generation:  0.000751495361328125
mini_batch_src_global generation:  0.0010640621185302734
r_  generation:  0.010099411010742188
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0010914802551269531
r_  generation:  0.010227203369140625
local_output_nid generation:  0.0014667510986328125
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0010423660278320312
r_  generation:  0.009958505630493164
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007832050323486328
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009614706039428711
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.0007159709930419922
mini_batch_src_global generation:  0.001085519790649414
r_  generation:  0.009849786758422852
local_output_nid generation:  0.001481771469116211
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.010255575180053711
local_output_nid generation:  0.0014514923095703125
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0010600090026855469
r_  generation:  0.010221481323242188
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.005490779876708984
mini_batch_src_global generation:  0.0012781620025634766
r_  generation:  0.010347604751586914
local_output_nid generation:  0.001344442367553711
local_in_edges_tensor generation:  0.0007908344268798828
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.009902000427246094
local_output_nid generation:  0.0013861656188964844
local_in_edges_tensor generation:  0.0007658004760742188
mini_batch_src_global generation:  0.0011088848114013672
r_  generation:  0.009926080703735352
----------------------check_connections_block total spend ----------------------------- 0.5343706607818604
generate_one_block  0.015709400177001953
generate_one_block  0.015388250350952148
generate_one_block  0.014521360397338867
generate_one_block  0.014979362487792969
generate_one_block  0.015329360961914062
generate_one_block  0.014447689056396484
generate_one_block  0.014625310897827148
generate_one_block  0.014278411865234375
generate_one_block  0.015105485916137695
generate_one_block  0.014803409576416016
generate_one_block  0.013873815536499023
generate_one_block  0.014444351196289062
generate_one_block  0.0156705379486084
generate_one_block  0.014942646026611328
generate_one_block  0.014929533004760742
generate_one_block  0.01490020751953125
generate_one_block  0.014390230178833008
generate_one_block  0.014981746673583984
generate_one_block  0.015116453170776367
generate_one_block  0.014849185943603516
generate_one_block  0.014338016510009766
generate_one_block  0.015146732330322266
generate_one_block  0.014934539794921875
generate_one_block  0.015633344650268555
generate_one_block  0.014768362045288086
generate_one_block  0.01434946060180664
generate_one_block  0.014652013778686523
generate_one_block  0.015407800674438477
generate_one_block  0.015007734298706055
generate_one_block  0.015059232711791992
generate_one_block  0.014733076095581055
generate_one_block  0.014425992965698242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03666543960571289
gen group dst list time:  0.023784637451171875
time for parepare:  0.01941704750061035
local_output_nid generation:  0.005220174789428711
local_in_edges_tensor generation:  0.011695623397827148
mini_batch_src_global generation:  0.013346433639526367
r_  generation:  0.1349341869354248
local_output_nid generation:  0.00890040397644043
local_in_edges_tensor generation:  0.014349222183227539
mini_batch_src_global generation:  0.01887369155883789
r_  generation:  0.1442737579345703
local_output_nid generation:  0.008121728897094727
local_in_edges_tensor generation:  0.01030731201171875
mini_batch_src_global generation:  0.015453100204467773
r_  generation:  0.13743853569030762
local_output_nid generation:  0.00847768783569336
local_in_edges_tensor generation:  0.012815475463867188
mini_batch_src_global generation:  0.017023324966430664
r_  generation:  0.14836955070495605
local_output_nid generation:  0.008559465408325195
local_in_edges_tensor generation:  0.01055455207824707
mini_batch_src_global generation:  0.017900466918945312
r_  generation:  0.15134787559509277
local_output_nid generation:  0.008249044418334961
local_in_edges_tensor generation:  0.009100675582885742
mini_batch_src_global generation:  0.01815199851989746
r_  generation:  0.14650702476501465
local_output_nid generation:  0.008344173431396484
local_in_edges_tensor generation:  0.008857488632202148
mini_batch_src_global generation:  0.017320632934570312
r_  generation:  0.14630794525146484
local_output_nid generation:  0.008260011672973633
local_in_edges_tensor generation:  0.008960962295532227
mini_batch_src_global generation:  0.017710208892822266
r_  generation:  0.14634060859680176
local_output_nid generation:  0.008421897888183594
local_in_edges_tensor generation:  0.00969076156616211
mini_batch_src_global generation:  0.019062280654907227
r_  generation:  0.15080809593200684
local_output_nid generation:  0.008224010467529297
local_in_edges_tensor generation:  0.009980201721191406
mini_batch_src_global generation:  0.017797231674194336
r_  generation:  0.1488053798675537
local_output_nid generation:  0.007940053939819336
local_in_edges_tensor generation:  0.008574485778808594
mini_batch_src_global generation:  0.01749587059020996
r_  generation:  0.14382147789001465
local_output_nid generation:  0.008267402648925781
local_in_edges_tensor generation:  0.008979082107543945
mini_batch_src_global generation:  0.01885843276977539
r_  generation:  0.14742279052734375
local_output_nid generation:  0.008666515350341797
local_in_edges_tensor generation:  0.013170242309570312
mini_batch_src_global generation:  0.01918649673461914
r_  generation:  0.15568804740905762
local_output_nid generation:  0.008433818817138672
local_in_edges_tensor generation:  0.011402130126953125
mini_batch_src_global generation:  0.01896834373474121
r_  generation:  0.14918851852416992
local_output_nid generation:  0.008573532104492188
local_in_edges_tensor generation:  0.010249853134155273
mini_batch_src_global generation:  0.018666505813598633
r_  generation:  0.15169858932495117
local_output_nid generation:  0.00841665267944336
local_in_edges_tensor generation:  0.01015925407409668
mini_batch_src_global generation:  0.018597126007080078
r_  generation:  0.1489701271057129
local_output_nid generation:  0.008171558380126953
local_in_edges_tensor generation:  0.010256767272949219
mini_batch_src_global generation:  0.018151521682739258
r_  generation:  0.15091180801391602
local_output_nid generation:  0.008518695831298828
local_in_edges_tensor generation:  0.010457515716552734
mini_batch_src_global generation:  0.020077943801879883
r_  generation:  0.15295171737670898
local_output_nid generation:  0.008509159088134766
local_in_edges_tensor generation:  0.011495590209960938
mini_batch_src_global generation:  0.018686532974243164
r_  generation:  0.15488600730895996
local_output_nid generation:  0.008337259292602539
local_in_edges_tensor generation:  0.00893712043762207
mini_batch_src_global generation:  0.018389225006103516
r_  generation:  0.14929938316345215
local_output_nid generation:  0.008201122283935547
local_in_edges_tensor generation:  0.009029865264892578
mini_batch_src_global generation:  0.017693281173706055
r_  generation:  0.14787602424621582
local_output_nid generation:  0.008386611938476562
local_in_edges_tensor generation:  0.010596752166748047
mini_batch_src_global generation:  0.02002573013305664
r_  generation:  0.1520390510559082
local_output_nid generation:  0.008282184600830078
local_in_edges_tensor generation:  0.010182619094848633
mini_batch_src_global generation:  0.01831364631652832
r_  generation:  0.1540684700012207
local_output_nid generation:  0.008624553680419922
local_in_edges_tensor generation:  0.013116836547851562
mini_batch_src_global generation:  0.019601106643676758
r_  generation:  0.1562657356262207
local_output_nid generation:  0.008466958999633789
local_in_edges_tensor generation:  0.010517120361328125
mini_batch_src_global generation:  0.01877760887145996
r_  generation:  0.1540226936340332
local_output_nid generation:  0.008140802383422852
local_in_edges_tensor generation:  0.008927583694458008
mini_batch_src_global generation:  0.018278837203979492
r_  generation:  0.15264582633972168
local_output_nid generation:  0.008275747299194336
local_in_edges_tensor generation:  0.008972406387329102
mini_batch_src_global generation:  0.019407987594604492
r_  generation:  0.15175461769104004
local_output_nid generation:  0.008709430694580078
local_in_edges_tensor generation:  0.010383129119873047
mini_batch_src_global generation:  0.019183874130249023
r_  generation:  0.15609431266784668
local_output_nid generation:  0.008348226547241211
local_in_edges_tensor generation:  0.012671709060668945
mini_batch_src_global generation:  0.018583059310913086
r_  generation:  0.15264105796813965
local_output_nid generation:  0.008529424667358398
local_in_edges_tensor generation:  0.009343624114990234
mini_batch_src_global generation:  0.019282102584838867
r_  generation:  0.1557464599609375
local_output_nid generation:  0.008246898651123047
local_in_edges_tensor generation:  0.008804082870483398
mini_batch_src_global generation:  0.018079280853271484
r_  generation:  0.14934754371643066
local_output_nid generation:  0.00833892822265625
local_in_edges_tensor generation:  0.009742975234985352
mini_batch_src_global generation:  0.018214702606201172
r_  generation:  0.14882946014404297
----------------------check_connections_block total spend ----------------------------- 7.093728065490723
generate_one_block  0.19144988059997559
generate_one_block  0.1959857940673828
generate_one_block  0.20512080192565918
generate_one_block  0.19309258460998535
generate_one_block  0.19520163536071777
generate_one_block  0.18515443801879883
generate_one_block  0.18451642990112305
generate_one_block  0.18006229400634766
generate_one_block  0.1899867057800293
generate_one_block  0.1835942268371582
generate_one_block  0.17647504806518555
generate_one_block  0.1844491958618164
generate_one_block  0.196990966796875
generate_one_block  0.1914989948272705
generate_one_block  0.1911792755126953
generate_one_block  0.2106633186340332
generate_one_block  0.18488693237304688
generate_one_block  0.19211101531982422
generate_one_block  0.19459223747253418
generate_one_block  0.1837749481201172
generate_one_block  0.18429350852966309
generate_one_block  0.19084668159484863
generate_one_block  0.19170284271240234
generate_one_block  0.20122051239013672
generate_one_block  0.18996548652648926
generate_one_block  0.1821427345275879
generate_one_block  0.18844294548034668
generate_one_block  0.1990978717803955
generate_one_block  0.18930840492248535
generate_one_block  0.19521141052246094
generate_one_block  0.18449997901916504
generate_one_block  0.18506574630737305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03201866149902344
gen group dst list time:  0.09580469131469727
time for parepare:  0.01889801025390625
local_output_nid generation:  0.021498680114746094
local_in_edges_tensor generation:  0.037370920181274414
mini_batch_src_global generation:  0.03708386421203613
r_  generation:  0.4000411033630371
local_output_nid generation:  0.027855873107910156
local_in_edges_tensor generation:  0.041165828704833984
mini_batch_src_global generation:  0.046478271484375
r_  generation:  0.4064209461212158
local_output_nid generation:  0.027271270751953125
local_in_edges_tensor generation:  0.03365683555603027
mini_batch_src_global generation:  0.04615044593811035
r_  generation:  0.40340280532836914
local_output_nid generation:  0.02639460563659668
local_in_edges_tensor generation:  0.030599355697631836
mini_batch_src_global generation:  0.04810309410095215
r_  generation:  0.4129977226257324
local_output_nid generation:  0.026509761810302734
local_in_edges_tensor generation:  0.033698320388793945
mini_batch_src_global generation:  0.04764294624328613
r_  generation:  0.4091503620147705
local_output_nid generation:  0.026466846466064453
local_in_edges_tensor generation:  0.029623985290527344
mini_batch_src_global generation:  0.048520565032958984
r_  generation:  0.40803956985473633
local_output_nid generation:  0.026315689086914062
local_in_edges_tensor generation:  0.029865741729736328
mini_batch_src_global generation:  0.04749798774719238
r_  generation:  0.41019463539123535
local_output_nid generation:  0.026474952697753906
local_in_edges_tensor generation:  0.029726505279541016
mini_batch_src_global generation:  0.048188209533691406
r_  generation:  0.40210771560668945
local_output_nid generation:  0.026563167572021484
local_in_edges_tensor generation:  0.03393983840942383
mini_batch_src_global generation:  0.047525644302368164
r_  generation:  0.41642141342163086
local_output_nid generation:  0.02714824676513672
local_in_edges_tensor generation:  0.03948354721069336
mini_batch_src_global generation:  0.052252769470214844
r_  generation:  0.412811279296875
local_output_nid generation:  0.02614116668701172
local_in_edges_tensor generation:  0.03233027458190918
mini_batch_src_global generation:  0.0611727237701416
r_  generation:  0.41510438919067383
local_output_nid generation:  0.0292205810546875
local_in_edges_tensor generation:  0.030465126037597656
mini_batch_src_global generation:  0.05099010467529297
r_  generation:  0.4058098793029785
local_output_nid generation:  0.027526140213012695
local_in_edges_tensor generation:  0.03306007385253906
mini_batch_src_global generation:  0.05092978477478027
r_  generation:  0.4183990955352783
local_output_nid generation:  0.027363300323486328
local_in_edges_tensor generation:  0.024395227432250977
mini_batch_src_global generation:  0.054207801818847656
r_  generation:  0.4075024127960205
local_output_nid generation:  0.027574539184570312
local_in_edges_tensor generation:  0.029088258743286133
mini_batch_src_global generation:  0.04783272743225098
r_  generation:  0.41209888458251953
local_output_nid generation:  0.02814483642578125
local_in_edges_tensor generation:  0.0377802848815918
mini_batch_src_global generation:  0.04861593246459961
r_  generation:  0.4058961868286133
local_output_nid generation:  0.02723240852355957
local_in_edges_tensor generation:  0.025166988372802734
mini_batch_src_global generation:  0.047482967376708984
r_  generation:  0.4300229549407959
local_output_nid generation:  0.027642011642456055
local_in_edges_tensor generation:  0.03518939018249512
mini_batch_src_global generation:  0.05223965644836426
r_  generation:  0.4136331081390381
local_output_nid generation:  0.02853107452392578
local_in_edges_tensor generation:  0.03557634353637695
mini_batch_src_global generation:  0.04789614677429199
r_  generation:  0.4163777828216553
local_output_nid generation:  0.027303695678710938
local_in_edges_tensor generation:  0.02579045295715332
mini_batch_src_global generation:  0.04831099510192871
r_  generation:  0.4111936092376709
local_output_nid generation:  0.027203083038330078
local_in_edges_tensor generation:  0.0316929817199707
mini_batch_src_global generation:  0.047445058822631836
r_  generation:  0.4112989902496338
local_output_nid generation:  0.02747631072998047
local_in_edges_tensor generation:  0.029455184936523438
mini_batch_src_global generation:  0.048499345779418945
r_  generation:  0.41244959831237793
local_output_nid generation:  0.02716827392578125
local_in_edges_tensor generation:  0.03370976448059082
mini_batch_src_global generation:  0.04756951332092285
r_  generation:  0.4157223701477051
local_output_nid generation:  0.027469158172607422
local_in_edges_tensor generation:  0.032850027084350586
mini_batch_src_global generation:  0.05782723426818848
r_  generation:  0.417191743850708
local_output_nid generation:  0.027352571487426758
local_in_edges_tensor generation:  0.02553272247314453
mini_batch_src_global generation:  0.04758715629577637
r_  generation:  0.4148738384246826
local_output_nid generation:  0.027814388275146484
local_in_edges_tensor generation:  0.030449628829956055
mini_batch_src_global generation:  0.05142498016357422
r_  generation:  0.41026759147644043
local_output_nid generation:  0.027510881423950195
local_in_edges_tensor generation:  0.03181815147399902
mini_batch_src_global generation:  0.05014824867248535
r_  generation:  0.41401171684265137
local_output_nid generation:  0.027683734893798828
local_in_edges_tensor generation:  0.032700538635253906
mini_batch_src_global generation:  0.04858565330505371
r_  generation:  0.41609764099121094
local_output_nid generation:  0.027220726013183594
local_in_edges_tensor generation:  0.024849414825439453
mini_batch_src_global generation:  0.04773545265197754
r_  generation:  0.4125199317932129
local_output_nid generation:  0.027257204055786133
local_in_edges_tensor generation:  0.025247812271118164
mini_batch_src_global generation:  0.04816555976867676
r_  generation:  0.4120676517486572
local_output_nid generation:  0.027247190475463867
local_in_edges_tensor generation:  0.03112959861755371
mini_batch_src_global generation:  0.04962325096130371
r_  generation:  0.4151933193206787
local_output_nid generation:  0.027338743209838867
local_in_edges_tensor generation:  0.03029036521911621
mini_batch_src_global generation:  0.047925472259521484
r_  generation:  0.41002464294433594
----------------------check_connections_block total spend ----------------------------- 19.496665716171265
generate_one_block  0.636512279510498
generate_one_block  0.5342388153076172
generate_one_block  0.522270917892456
generate_one_block  0.5445215702056885
generate_one_block  0.5406856536865234
generate_one_block  0.5316944122314453
generate_one_block  0.5203661918640137
generate_one_block  0.5212514400482178
generate_one_block  0.5400536060333252
generate_one_block  0.5286681652069092
generate_one_block  0.5210130214691162
generate_one_block  0.5247459411621094
generate_one_block  0.5513551235198975
generate_one_block  0.5274944305419922
generate_one_block  0.5307936668395996
generate_one_block  0.5155487060546875
generate_one_block  0.5257165431976318
generate_one_block  0.5405013561248779
generate_one_block  0.5292046070098877
generate_one_block  0.5217878818511963
generate_one_block  0.5543677806854248
generate_one_block  0.5312020778656006
generate_one_block  0.527202844619751
generate_one_block  0.5394625663757324
generate_one_block  0.5309374332427979
generate_one_block  0.5191776752471924
generate_one_block  0.5281059741973877
generate_one_block  0.5901453495025635
generate_one_block  0.54366135597229
generate_one_block  0.5373752117156982
generate_one_block  0.5419397354125977
generate_one_block  0.5611531734466553
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  26.590393781661987
block generation total time  23.305740356445312
average batch blocks generation time:  0.728304386138916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08440065383911133  GigaBytes
Max Memory Allocated: 0.08440065383911133  GigaBytes

torch.Size([146691, 128])
torch.Size([103572, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8709716796875 GB
    Memory Allocated: 11.53091287612915  GigaBytes
Max Memory Allocated: 11.539080619812012  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8787841796875 GB
    Memory Allocated: 0.08556175231933594  GigaBytes
Max Memory Allocated: 11.539080619812012  GigaBytes

torch.Size([146281, 128])
torch.Size([103436, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1151123046875 GB
    Memory Allocated: 11.57071304321289  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1151123046875 GB
    Memory Allocated: 0.0859670639038086  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146401, 128])
torch.Size([101739, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1151123046875 GB
    Memory Allocated: 11.32831859588623  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1151123046875 GB
    Memory Allocated: 0.08539533615112305  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([145992, 128])
torch.Size([102599, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5916748046875 GB
    Memory Allocated: 11.524256706237793  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08611106872558594  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146044, 128])
torch.Size([102848, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.515778064727783  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08550310134887695  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146364, 128])
torch.Size([102361, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.432119846343994  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08601236343383789  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146001, 128])
torch.Size([101460, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.376245498657227  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08545398712158203  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146372, 128])
torch.Size([101299, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.30774736404419  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08605527877807617  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146492, 128])
torch.Size([102842, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.471081733703613  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08519124984741211  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([145746, 128])
torch.Size([101073, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.335466861724854  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08592605590820312  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([145628, 128])
torch.Size([100803, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.258037567138672  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08516836166381836  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([145685, 128])
torch.Size([101062, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 11.350540161132812  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5936279296875 GB
    Memory Allocated: 0.08613157272338867  GigaBytes
Max Memory Allocated: 11.5793137550354  GigaBytes

torch.Size([146764, 128])
torch.Size([103610, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.638965606689453  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08552932739257812  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146364, 128])
torch.Size([102527, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.451319694519043  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08606672286987305  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146922, 128])
torch.Size([103358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.497091293334961  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.085540771484375  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146414, 128])
torch.Size([102269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.413753509521484  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08600902557373047  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146292, 128])
torch.Size([102133, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.383665084838867  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08565330505371094  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146547, 128])
torch.Size([103749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.542593479156494  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0860910415649414  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146335, 128])
torch.Size([102816, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.506110191345215  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08530521392822266  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145966, 128])
torch.Size([101835, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.397860050201416  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0859975814819336  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146036, 128])
torch.Size([101649, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.379907131195068  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0854039192199707  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146050, 128])
torch.Size([102232, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.479241371154785  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08605575561523438  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145743, 128])
torch.Size([101911, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.438524723052979  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08550262451171875  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146130, 128])
torch.Size([102959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.606646537780762  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0860586166381836  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146421, 128])
torch.Size([102426, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.470629215240479  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0852193832397461  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145819, 128])
torch.Size([101113, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.357977390289307  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08604001998901367  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146637, 128])
torch.Size([102782, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.468957424163818  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08587312698364258  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146962, 128])
torch.Size([104217, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.602071762084961  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08604812622070312  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145702, 128])
torch.Size([101668, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.426421165466309  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08571290969848633  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146647, 128])
torch.Size([103392, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.569361686706543  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08600854873657227  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145963, 128])
torch.Size([101858, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.391752243041992  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0855855941772461  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146615, 128])
torch.Size([102278, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.366819381713867  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028284795582294464 |0.028123147785663605 |0.4051843136548996 |0.00010620057582855225 |0.6415400877594948 |0.009907722473144531 |
----------------------------------------------------------pseudo_mini_loss sum 4.953882217407227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8796190
Number of first layer input nodes during this epoch:  4680026
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.10535240173339844  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026937484741210938
random selection method range initialization spend 0.007132053375244141
time for parepare:  0.02024364471435547
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.008356809616088867
mini_batch_src_global generation:  0.0017104148864746094
r_  generation:  0.010949373245239258
local_output_nid generation:  0.001814126968383789
local_in_edges_tensor generation:  0.0011513233184814453
mini_batch_src_global generation:  0.001619100570678711
r_  generation:  0.01012277603149414
local_output_nid generation:  0.0018215179443359375
local_in_edges_tensor generation:  0.0010132789611816406
mini_batch_src_global generation:  0.0012218952178955078
r_  generation:  0.009875774383544922
local_output_nid generation:  0.0018532276153564453
local_in_edges_tensor generation:  0.001020669937133789
mini_batch_src_global generation:  0.001163482666015625
r_  generation:  0.010186433792114258
local_output_nid generation:  0.0018393993377685547
local_in_edges_tensor generation:  0.0010304450988769531
mini_batch_src_global generation:  0.0012354850769042969
r_  generation:  0.01018667221069336
local_output_nid generation:  0.0018689632415771484
local_in_edges_tensor generation:  0.0010216236114501953
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.010260581970214844
local_output_nid generation:  0.001819610595703125
local_in_edges_tensor generation:  0.0010256767272949219
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.010717630386352539
local_output_nid generation:  0.00185394287109375
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0012753009796142578
r_  generation:  0.010604143142700195
local_output_nid generation:  0.0018351078033447266
local_in_edges_tensor generation:  0.0010051727294921875
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010387182235717773
local_output_nid generation:  0.0018389225006103516
local_in_edges_tensor generation:  0.001081228256225586
mini_batch_src_global generation:  0.0011687278747558594
r_  generation:  0.01027989387512207
local_output_nid generation:  0.0018329620361328125
local_in_edges_tensor generation:  0.0009684562683105469
mini_batch_src_global generation:  0.0011725425720214844
r_  generation:  0.01055288314819336
local_output_nid generation:  0.0018444061279296875
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.0012125968933105469
r_  generation:  0.010284662246704102
local_output_nid generation:  0.0018813610076904297
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.0013933181762695312
r_  generation:  0.01079702377319336
local_output_nid generation:  0.001848459243774414
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0011785030364990234
r_  generation:  0.010343074798583984
local_output_nid generation:  0.001825094223022461
local_in_edges_tensor generation:  0.0009739398956298828
mini_batch_src_global generation:  0.0011091232299804688
r_  generation:  0.010656356811523438
local_output_nid generation:  0.0018596649169921875
local_in_edges_tensor generation:  0.0009911060333251953
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.01004934310913086
local_output_nid generation:  0.0018684864044189453
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.001220703125
r_  generation:  0.010338068008422852
local_output_nid generation:  0.0018153190612792969
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0011639595031738281
r_  generation:  0.010428667068481445
local_output_nid generation:  0.0018000602722167969
local_in_edges_tensor generation:  0.0009953975677490234
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.010916471481323242
local_output_nid generation:  0.001844644546508789
local_in_edges_tensor generation:  0.000982046127319336
mini_batch_src_global generation:  0.0011398792266845703
r_  generation:  0.010364770889282227
local_output_nid generation:  0.0018510818481445312
local_in_edges_tensor generation:  0.0009582042694091797
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.010343551635742188
local_output_nid generation:  0.0018146038055419922
local_in_edges_tensor generation:  0.003753662109375
mini_batch_src_global generation:  0.0012810230255126953
r_  generation:  0.010266780853271484
local_output_nid generation:  0.0018417835235595703
local_in_edges_tensor generation:  0.0009520053863525391
mini_batch_src_global generation:  0.0012347698211669922
r_  generation:  0.010489940643310547
local_output_nid generation:  0.0018420219421386719
local_in_edges_tensor generation:  0.000985860824584961
mini_batch_src_global generation:  0.0011632442474365234
r_  generation:  0.010884761810302734
local_output_nid generation:  0.0018281936645507812
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0011086463928222656
r_  generation:  0.010671138763427734
local_output_nid generation:  0.001840829849243164
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.01091909408569336
local_output_nid generation:  0.0018661022186279297
local_in_edges_tensor generation:  0.0009617805480957031
mini_batch_src_global generation:  0.0011641979217529297
r_  generation:  0.010782003402709961
local_output_nid generation:  0.001828908920288086
local_in_edges_tensor generation:  0.0037047863006591797
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010097503662109375
local_output_nid generation:  0.0018475055694580078
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.01036977767944336
local_output_nid generation:  0.001867532730102539
local_in_edges_tensor generation:  0.0009579658508300781
mini_batch_src_global generation:  0.0011341571807861328
r_  generation:  0.01068735122680664
local_output_nid generation:  0.0018153190612792969
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.0014028549194335938
r_  generation:  0.010956048965454102
local_output_nid generation:  0.0018143653869628906
local_in_edges_tensor generation:  0.0009968280792236328
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.010261774063110352
----------------------check_connections_block total spend ----------------------------- 0.5996015071868896
generate_one_block  0.031129121780395508
generate_one_block  0.020806550979614258
generate_one_block  0.018548011779785156
generate_one_block  0.018329143524169922
generate_one_block  0.01820850372314453
generate_one_block  0.020403146743774414
generate_one_block  0.018332719802856445
generate_one_block  0.018249988555908203
generate_one_block  0.018164873123168945
generate_one_block  0.01773810386657715
generate_one_block  0.017795324325561523
generate_one_block  0.020589590072631836
generate_one_block  0.01857900619506836
generate_one_block  0.01771092414855957
generate_one_block  0.017728090286254883
generate_one_block  0.017101764678955078
generate_one_block  0.017624616622924805
generate_one_block  0.0194091796875
generate_one_block  0.018349647521972656
generate_one_block  0.01756596565246582
generate_one_block  0.017673254013061523
generate_one_block  0.01756906509399414
generate_one_block  0.01768350601196289
generate_one_block  0.018119335174560547
generate_one_block  0.01784992218017578
generate_one_block  0.017899274826049805
generate_one_block  0.01796746253967285
generate_one_block  0.017096281051635742
generate_one_block  0.019922494888305664
generate_one_block  0.01811981201171875
generate_one_block  0.018502473831176758
generate_one_block  0.01746344566345215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03750967979431152
gen group dst list time:  0.022413969039916992
time for parepare:  0.02108025550842285
local_output_nid generation:  0.006885528564453125
local_in_edges_tensor generation:  0.01952648162841797
mini_batch_src_global generation:  0.013402938842773438
r_  generation:  0.13785004615783691
local_output_nid generation:  0.01107168197631836
local_in_edges_tensor generation:  0.00902247428894043
mini_batch_src_global generation:  0.016978979110717773
r_  generation:  0.14307689666748047
local_output_nid generation:  0.011844635009765625
local_in_edges_tensor generation:  0.029125690460205078
mini_batch_src_global generation:  0.015398502349853516
r_  generation:  0.14417815208435059
local_output_nid generation:  0.01211094856262207
local_in_edges_tensor generation:  0.011785030364990234
mini_batch_src_global generation:  0.01917099952697754
r_  generation:  0.15239191055297852
local_output_nid generation:  0.012088298797607422
local_in_edges_tensor generation:  0.014019012451171875
mini_batch_src_global generation:  0.01745009422302246
r_  generation:  0.1556859016418457
local_output_nid generation:  0.0175783634185791
local_in_edges_tensor generation:  0.009266853332519531
mini_batch_src_global generation:  0.017841815948486328
r_  generation:  0.16080069541931152
local_output_nid generation:  0.014372110366821289
local_in_edges_tensor generation:  0.014960289001464844
mini_batch_src_global generation:  0.019635677337646484
r_  generation:  0.17052817344665527
local_output_nid generation:  0.014255285263061523
local_in_edges_tensor generation:  0.015125036239624023
mini_batch_src_global generation:  0.022858381271362305
r_  generation:  0.156355619430542
local_output_nid generation:  0.012111186981201172
local_in_edges_tensor generation:  0.012332916259765625
mini_batch_src_global generation:  0.018861770629882812
r_  generation:  0.15643548965454102
local_output_nid generation:  0.012349128723144531
local_in_edges_tensor generation:  0.010515928268432617
mini_batch_src_global generation:  0.018871068954467773
r_  generation:  0.15335464477539062
local_output_nid generation:  0.012656927108764648
local_in_edges_tensor generation:  0.009837865829467773
mini_batch_src_global generation:  0.01896071434020996
r_  generation:  0.15559816360473633
local_output_nid generation:  0.012326955795288086
local_in_edges_tensor generation:  0.010191679000854492
mini_batch_src_global generation:  0.04110312461853027
r_  generation:  0.15070247650146484
local_output_nid generation:  0.012955427169799805
local_in_edges_tensor generation:  0.010240316390991211
mini_batch_src_global generation:  0.02069687843322754
r_  generation:  0.15989398956298828
local_output_nid generation:  0.012309074401855469
local_in_edges_tensor generation:  0.009496927261352539
mini_batch_src_global generation:  0.018967390060424805
r_  generation:  0.1529526710510254
local_output_nid generation:  0.012334346771240234
local_in_edges_tensor generation:  0.00919198989868164
mini_batch_src_global generation:  0.018463611602783203
r_  generation:  0.15221285820007324
local_output_nid generation:  0.012282609939575195
local_in_edges_tensor generation:  0.009197711944580078
mini_batch_src_global generation:  0.018114328384399414
r_  generation:  0.14705276489257812
local_output_nid generation:  0.012535333633422852
local_in_edges_tensor generation:  0.011274337768554688
mini_batch_src_global generation:  0.029729127883911133
r_  generation:  0.17181015014648438
local_output_nid generation:  0.012336254119873047
local_in_edges_tensor generation:  0.009415149688720703
mini_batch_src_global generation:  0.01961517333984375
r_  generation:  0.1621861457824707
local_output_nid generation:  0.011706113815307617
local_in_edges_tensor generation:  0.015561819076538086
mini_batch_src_global generation:  0.019454240798950195
r_  generation:  0.1692514419555664
local_output_nid generation:  0.011379003524780273
local_in_edges_tensor generation:  0.018033742904663086
mini_batch_src_global generation:  0.021193742752075195
r_  generation:  0.1482553482055664
local_output_nid generation:  0.00912928581237793
local_in_edges_tensor generation:  0.011038541793823242
mini_batch_src_global generation:  0.01840376853942871
r_  generation:  0.15456390380859375
local_output_nid generation:  0.009209156036376953
local_in_edges_tensor generation:  0.010621309280395508
mini_batch_src_global generation:  0.01861739158630371
r_  generation:  0.14902091026306152
local_output_nid generation:  0.009280681610107422
local_in_edges_tensor generation:  0.008836984634399414
mini_batch_src_global generation:  0.01848292350769043
r_  generation:  0.15370750427246094
local_output_nid generation:  0.009331941604614258
local_in_edges_tensor generation:  0.010138273239135742
mini_batch_src_global generation:  0.01938176155090332
r_  generation:  0.15616798400878906
local_output_nid generation:  0.00930643081665039
local_in_edges_tensor generation:  0.011149406433105469
mini_batch_src_global generation:  0.018889904022216797
r_  generation:  0.1753830909729004
local_output_nid generation:  0.00946807861328125
local_in_edges_tensor generation:  0.011137723922729492
mini_batch_src_global generation:  0.01907491683959961
r_  generation:  0.1545264720916748
local_output_nid generation:  0.00914621353149414
local_in_edges_tensor generation:  0.009914636611938477
mini_batch_src_global generation:  0.027360916137695312
r_  generation:  0.1566176414489746
local_output_nid generation:  0.008932113647460938
local_in_edges_tensor generation:  0.008529186248779297
mini_batch_src_global generation:  0.018474817276000977
r_  generation:  0.15405583381652832
local_output_nid generation:  0.008993864059448242
local_in_edges_tensor generation:  0.008357048034667969
mini_batch_src_global generation:  0.017719745635986328
r_  generation:  0.15107154846191406
local_output_nid generation:  0.00933218002319336
local_in_edges_tensor generation:  0.009791135787963867
mini_batch_src_global generation:  0.019263029098510742
r_  generation:  0.16031837463378906
local_output_nid generation:  0.009552955627441406
local_in_edges_tensor generation:  0.01031184196472168
mini_batch_src_global generation:  0.0196535587310791
r_  generation:  0.16364502906799316
local_output_nid generation:  0.009315729141235352
local_in_edges_tensor generation:  0.010900020599365234
mini_batch_src_global generation:  0.01894974708557129
r_  generation:  0.15988636016845703
----------------------check_connections_block total spend ----------------------------- 7.525763034820557
generate_one_block  0.21510744094848633
generate_one_block  0.1999671459197998
generate_one_block  0.19894146919250488
generate_one_block  0.22545361518859863
generate_one_block  0.24420523643493652
generate_one_block  0.1979212760925293
generate_one_block  0.20829248428344727
generate_one_block  0.20755410194396973
generate_one_block  0.20874595642089844
generate_one_block  0.20053434371948242
generate_one_block  0.2033228874206543
generate_one_block  0.1986701488494873
generate_one_block  0.21466469764709473
generate_one_block  0.20300984382629395
generate_one_block  0.19768691062927246
generate_one_block  0.19125747680664062
generate_one_block  0.21076250076293945
generate_one_block  0.20052242279052734
generate_one_block  0.20730352401733398
generate_one_block  0.1990528106689453
generate_one_block  0.20670580863952637
generate_one_block  0.20161056518554688
generate_one_block  0.2032461166381836
generate_one_block  0.21274995803833008
generate_one_block  0.2174358367919922
generate_one_block  0.2048487663269043
generate_one_block  0.20873069763183594
generate_one_block  0.19039082527160645
generate_one_block  0.19841504096984863
generate_one_block  0.2084493637084961
generate_one_block  0.21685409545898438
generate_one_block  0.1994950771331787
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049190521240234375
gen group dst list time:  0.10111546516418457
time for parepare:  0.01790928840637207
local_output_nid generation:  0.0249173641204834
local_in_edges_tensor generation:  0.05251431465148926
mini_batch_src_global generation:  0.03699922561645508
r_  generation:  0.39923787117004395
local_output_nid generation:  0.033866167068481445
local_in_edges_tensor generation:  0.042102813720703125
mini_batch_src_global generation:  0.05028104782104492
r_  generation:  0.4037284851074219
local_output_nid generation:  0.029000520706176758
local_in_edges_tensor generation:  0.03536844253540039
mini_batch_src_global generation:  0.0469515323638916
r_  generation:  0.4100933074951172
local_output_nid generation:  0.027917146682739258
local_in_edges_tensor generation:  0.035227298736572266
mini_batch_src_global generation:  0.05054354667663574
r_  generation:  0.41193318367004395
local_output_nid generation:  0.027789592742919922
local_in_edges_tensor generation:  0.034618377685546875
mini_batch_src_global generation:  0.04784440994262695
r_  generation:  0.4133453369140625
local_output_nid generation:  0.031664133071899414
local_in_edges_tensor generation:  0.028205156326293945
mini_batch_src_global generation:  0.049117326736450195
r_  generation:  0.4101109504699707
local_output_nid generation:  0.027850866317749023
local_in_edges_tensor generation:  0.031384944915771484
mini_batch_src_global generation:  0.05163073539733887
r_  generation:  0.42500853538513184
local_output_nid generation:  0.027798175811767578
local_in_edges_tensor generation:  0.03226041793823242
mini_batch_src_global generation:  0.0625460147857666
r_  generation:  0.43860888481140137
local_output_nid generation:  0.02920389175415039
local_in_edges_tensor generation:  0.04730224609375
mini_batch_src_global generation:  0.06658101081848145
r_  generation:  0.4201936721801758
local_output_nid generation:  0.029938936233520508
local_in_edges_tensor generation:  0.034493207931518555
mini_batch_src_global generation:  0.049715280532836914
r_  generation:  0.4279196262359619
local_output_nid generation:  0.028580904006958008
local_in_edges_tensor generation:  0.03447985649108887
mini_batch_src_global generation:  0.0484316349029541
r_  generation:  0.4219086170196533
local_output_nid generation:  0.029756546020507812
local_in_edges_tensor generation:  0.027946949005126953
mini_batch_src_global generation:  0.05151724815368652
r_  generation:  0.42397332191467285
local_output_nid generation:  0.028824806213378906
local_in_edges_tensor generation:  0.05038332939147949
mini_batch_src_global generation:  0.04872584342956543
r_  generation:  0.4162166118621826
local_output_nid generation:  0.02891993522644043
local_in_edges_tensor generation:  0.02919936180114746
mini_batch_src_global generation:  0.04870915412902832
r_  generation:  0.412553071975708
local_output_nid generation:  0.02906060218811035
local_in_edges_tensor generation:  0.02792525291442871
mini_batch_src_global generation:  0.04787921905517578
r_  generation:  0.41062068939208984
local_output_nid generation:  0.028792381286621094
local_in_edges_tensor generation:  0.02827596664428711
mini_batch_src_global generation:  0.04841494560241699
r_  generation:  0.42764782905578613
local_output_nid generation:  0.030958890914916992
local_in_edges_tensor generation:  0.03681063652038574
mini_batch_src_global generation:  0.05535459518432617
r_  generation:  0.4240305423736572
local_output_nid generation:  0.028822898864746094
local_in_edges_tensor generation:  0.0294189453125
mini_batch_src_global generation:  0.04884052276611328
r_  generation:  0.4205801486968994
local_output_nid generation:  0.028914451599121094
local_in_edges_tensor generation:  0.02982163429260254
mini_batch_src_global generation:  0.05109906196594238
r_  generation:  0.4238169193267822
local_output_nid generation:  0.028601884841918945
local_in_edges_tensor generation:  0.02892756462097168
mini_batch_src_global generation:  0.053939104080200195
r_  generation:  0.4200890064239502
local_output_nid generation:  0.028892040252685547
local_in_edges_tensor generation:  0.028926372528076172
mini_batch_src_global generation:  0.05088949203491211
r_  generation:  0.4253096580505371
local_output_nid generation:  0.028830528259277344
local_in_edges_tensor generation:  0.03572583198547363
mini_batch_src_global generation:  0.04917025566101074
r_  generation:  0.4146392345428467
local_output_nid generation:  0.028872966766357422
local_in_edges_tensor generation:  0.029825210571289062
mini_batch_src_global generation:  0.0509183406829834
r_  generation:  0.4169278144836426
local_output_nid generation:  0.029078006744384766
local_in_edges_tensor generation:  0.0359950065612793
mini_batch_src_global generation:  0.049306631088256836
r_  generation:  0.4185507297515869
local_output_nid generation:  0.0290529727935791
local_in_edges_tensor generation:  0.030243396759033203
mini_batch_src_global generation:  0.051171302795410156
r_  generation:  0.42194414138793945
local_output_nid generation:  0.031127452850341797
local_in_edges_tensor generation:  0.03151440620422363
mini_batch_src_global generation:  0.04868817329406738
r_  generation:  0.4191169738769531
local_output_nid generation:  0.02963709831237793
local_in_edges_tensor generation:  0.029234647750854492
mini_batch_src_global generation:  0.04802966117858887
r_  generation:  0.43216967582702637
local_output_nid generation:  0.029887914657592773
local_in_edges_tensor generation:  0.0334165096282959
mini_batch_src_global generation:  0.0538787841796875
r_  generation:  0.40972900390625
local_output_nid generation:  0.029683828353881836
local_in_edges_tensor generation:  0.03336358070373535
mini_batch_src_global generation:  0.048178911209106445
r_  generation:  0.41576361656188965
local_output_nid generation:  0.028868436813354492
local_in_edges_tensor generation:  0.030533313751220703
mini_batch_src_global generation:  0.05140352249145508
r_  generation:  0.4155726432800293
local_output_nid generation:  0.02904510498046875
local_in_edges_tensor generation:  0.028696298599243164
mini_batch_src_global generation:  0.048471689224243164
r_  generation:  0.43134164810180664
local_output_nid generation:  0.028912067413330078
local_in_edges_tensor generation:  0.02928018569946289
mini_batch_src_global generation:  0.048873186111450195
r_  generation:  0.42011070251464844
----------------------check_connections_block total spend ----------------------------- 19.948385000228882
generate_one_block  0.5632996559143066
generate_one_block  0.5552024841308594
generate_one_block  0.5499691963195801
generate_one_block  0.5597681999206543
generate_one_block  0.6884558200836182
generate_one_block  0.5680961608886719
generate_one_block  0.5836906433105469
generate_one_block  0.5635557174682617
generate_one_block  0.5506107807159424
generate_one_block  0.5512080192565918
generate_one_block  0.5491175651550293
generate_one_block  0.5762457847595215
generate_one_block  0.5707540512084961
generate_one_block  0.5638470649719238
generate_one_block  0.5558617115020752
generate_one_block  0.5519440174102783
generate_one_block  0.5641911029815674
generate_one_block  0.5488533973693848
generate_one_block  0.5611152648925781
generate_one_block  0.5377237796783447
generate_one_block  0.5669398307800293
generate_one_block  0.5520310401916504
generate_one_block  0.5682928562164307
generate_one_block  0.5585207939147949
generate_one_block  0.5872890949249268
generate_one_block  0.5499210357666016
generate_one_block  0.5493309497833252
generate_one_block  0.5463335514068604
generate_one_block  0.548105001449585
generate_one_block  0.5737910270690918
generate_one_block  0.5765063762664795
generate_one_block  0.5537900924682617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.10535240173339844  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

connection checking time:  27.47414803504944
block generation total time  24.646270513534546
average batch blocks generation time:  0.7701959535479546
block dataloader generation time/epoch 55.504189252853394
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08773660659790039  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146394, 128])
torch.Size([102118, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.38663101196289  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08687114715576172  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145731, 128])
torch.Size([101474, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.379849433898926  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08771276473999023  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146265, 128])
torch.Size([102023, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.371821880340576  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08707141876220703  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145996, 128])
torch.Size([102399, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.511701583862305  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08774805068969727  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146153, 128])
torch.Size([102352, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.44669246673584  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08694076538085938  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145829, 128])
torch.Size([101652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.383131980895996  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08779621124267578  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146529, 128])
torch.Size([102988, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.536640644073486  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08743143081665039  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146707, 128])
torch.Size([103332, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.505136966705322  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08781290054321289  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146535, 128])
torch.Size([102856, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.521805763244629  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08738470077514648  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146671, 128])
torch.Size([102586, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.49208116531372  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08776378631591797  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146196, 128])
torch.Size([101877, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.432002067565918  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08743619918823242  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146867, 128])
torch.Size([102909, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.42469835281372  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08784198760986328  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146027, 128])
torch.Size([102662, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.563811302185059  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0872645378112793  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146472, 128])
torch.Size([102515, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.437168598175049  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08771944046020508  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145747, 128])
torch.Size([101624, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.381489753723145  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08683204650878906  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145741, 128])
torch.Size([100962, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.273659706115723  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08777093887329102  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146454, 128])
torch.Size([102325, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.48380422592163  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0869436264038086  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145844, 128])
torch.Size([101534, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.342479705810547  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08778810501098633  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146771, 128])
torch.Size([103243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.504068374633789  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08692646026611328  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145863, 128])
torch.Size([101368, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.334622859954834  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08775091171264648  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([147032, 128])
torch.Size([103462, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.487743854522705  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0871267318725586  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146232, 128])
torch.Size([102269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.380314826965332  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08774042129516602  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146712, 128])
torch.Size([102802, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.42154836654663  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08731937408447266  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146451, 128])
torch.Size([103130, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.532052040100098  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0877828598022461  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146780, 128])
torch.Size([103375, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.518952369689941  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0874490737915039  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146784, 128])
torch.Size([103479, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.467209339141846  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.087799072265625  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146126, 128])
torch.Size([102305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.503692626953125  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08672952651977539  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([145563, 128])
torch.Size([100006, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.197147369384766  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08768558502197266  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146436, 128])
torch.Size([101856, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.36394739151001  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.08724594116210938  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146295, 128])
torch.Size([103102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 11.507580757141113  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2147216796875 GB
    Memory Allocated: 0.0878591537475586  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146533, 128])
torch.Size([103621, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 11.619576930999756  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2186279296875 GB
    Memory Allocated: 0.08744382858276367  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

torch.Size([146865, 128])
torch.Size([103296, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2186279296875 GB
    Memory Allocated: 11.441701889038086  GigaBytes
Max Memory Allocated: 11.647612571716309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019987091422080994 |0.01557401567697525 |0.38813018798828125 |9.896606206893921e-05 |0.7920363917946815 |0.006894826889038086 |
----------------------------------------------------------pseudo_mini_loss sum 3.791311264038086
Total (block generation + training)time/epoch 94.46533608436584
Training time/epoch 38.96089959144592
Training time without block to device /epoch 38.462531089782715
Training time without total dataloading part /epoch 37.775392293930054
load block tensor time/epoch 0.6395869255065918
block to device time/epoch 0.498368501663208
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8800011
Number of first layer input nodes during this epoch:  4682601
