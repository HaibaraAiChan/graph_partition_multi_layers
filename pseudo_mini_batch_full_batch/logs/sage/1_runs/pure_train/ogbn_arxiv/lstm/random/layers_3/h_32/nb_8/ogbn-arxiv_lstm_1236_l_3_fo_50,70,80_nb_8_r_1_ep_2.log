Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648455811.9012895
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02688741683959961
random selection method range initialization spend 0.006508827209472656
time for parepare:  0.018708229064941406
local_output_nid generation:  0.004236459732055664
local_in_edges_tensor generation:  0.006629228591918945
mini_batch_src_global generation:  0.0037877559661865234
r_  generation:  0.04127144813537598
local_output_nid generation:  0.005796909332275391
local_in_edges_tensor generation:  0.003290891647338867
mini_batch_src_global generation:  0.004875659942626953
r_  generation:  0.04418659210205078
local_output_nid generation:  0.006027698516845703
local_in_edges_tensor generation:  0.0033371448516845703
mini_batch_src_global generation:  0.0032994747161865234
r_  generation:  0.04445004463195801
local_output_nid generation:  0.006117105484008789
local_in_edges_tensor generation:  0.003293752670288086
mini_batch_src_global generation:  0.00341796875
r_  generation:  0.04599571228027344
local_output_nid generation:  0.006155490875244141
local_in_edges_tensor generation:  0.0033054351806640625
mini_batch_src_global generation:  0.00365447998046875
r_  generation:  0.046418190002441406
local_output_nid generation:  0.0061244964599609375
local_in_edges_tensor generation:  0.003359556198120117
mini_batch_src_global generation:  0.003989696502685547
r_  generation:  0.04597163200378418
local_output_nid generation:  0.006101846694946289
local_in_edges_tensor generation:  0.003320455551147461
mini_batch_src_global generation:  0.003854513168334961
r_  generation:  0.04637455940246582
local_output_nid generation:  0.006115913391113281
local_in_edges_tensor generation:  0.0033042430877685547
mini_batch_src_global generation:  0.003847360610961914
r_  generation:  0.04627203941345215
----------------------check_connections_block total spend ----------------------------- 0.5721030235290527
generate_one_block  0.06055784225463867
generate_one_block  0.06346368789672852
generate_one_block  0.061948299407958984
generate_one_block  0.06254124641418457
generate_one_block  0.06691455841064453
generate_one_block  0.0617525577545166
generate_one_block  0.061809539794921875
generate_one_block  0.06073474884033203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04609322547912598
gen group dst list time:  0.01624441146850586
time for parepare:  0.0194399356842041
local_output_nid generation:  0.014192342758178711
local_in_edges_tensor generation:  0.03567171096801758
mini_batch_src_global generation:  0.034952402114868164
r_  generation:  0.3582630157470703
local_output_nid generation:  0.019930362701416016
local_in_edges_tensor generation:  0.03447389602661133
mini_batch_src_global generation:  0.0446171760559082
r_  generation:  0.37291622161865234
local_output_nid generation:  0.01929759979248047
local_in_edges_tensor generation:  0.028255224227905273
mini_batch_src_global generation:  0.04381704330444336
r_  generation:  0.3764169216156006
local_output_nid generation:  0.019316673278808594
local_in_edges_tensor generation:  0.02441263198852539
mini_batch_src_global generation:  0.04834270477294922
r_  generation:  0.383868932723999
local_output_nid generation:  0.01937127113342285
local_in_edges_tensor generation:  0.024566650390625
mini_batch_src_global generation:  0.049249887466430664
r_  generation:  0.3884258270263672
local_output_nid generation:  0.019499778747558594
local_in_edges_tensor generation:  0.021639108657836914
mini_batch_src_global generation:  0.04720807075500488
r_  generation:  0.38718485832214355
local_output_nid generation:  0.01930069923400879
local_in_edges_tensor generation:  0.020532846450805664
mini_batch_src_global generation:  0.047255754470825195
r_  generation:  0.38466501235961914
local_output_nid generation:  0.019271373748779297
local_in_edges_tensor generation:  0.023725271224975586
mini_batch_src_global generation:  0.04646658897399902
r_  generation:  0.3785409927368164
----------------------check_connections_block total spend ----------------------------- 4.40927267074585
generate_one_block  0.49260473251342773
generate_one_block  0.5100841522216797
generate_one_block  0.5013039112091064
generate_one_block  0.5021200180053711
generate_one_block  0.5083110332489014
generate_one_block  0.5077354907989502
generate_one_block  0.49104762077331543
generate_one_block  0.4909026622772217
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04338335990905762
gen group dst list time:  0.036791324615478516
time for parepare:  0.01890087127685547
local_output_nid generation:  0.028874635696411133
local_in_edges_tensor generation:  0.04788637161254883
mini_batch_src_global generation:  0.05269622802734375
r_  generation:  0.5398085117340088
local_output_nid generation:  0.03566336631774902
local_in_edges_tensor generation:  0.056528329849243164
mini_batch_src_global generation:  0.06714725494384766
r_  generation:  0.5449845790863037
local_output_nid generation:  0.0354466438293457
local_in_edges_tensor generation:  0.04219245910644531
mini_batch_src_global generation:  0.06200981140136719
r_  generation:  0.5625898838043213
local_output_nid generation:  0.03563880920410156
local_in_edges_tensor generation:  0.04178118705749512
mini_batch_src_global generation:  0.06022310256958008
r_  generation:  0.5594174861907959
local_output_nid generation:  0.03552579879760742
local_in_edges_tensor generation:  0.049078941345214844
mini_batch_src_global generation:  0.06559276580810547
r_  generation:  0.5658507347106934
local_output_nid generation:  0.03565049171447754
local_in_edges_tensor generation:  0.04926037788391113
mini_batch_src_global generation:  0.06160736083984375
r_  generation:  0.5653092861175537
local_output_nid generation:  0.036126136779785156
local_in_edges_tensor generation:  0.04067063331604004
mini_batch_src_global generation:  0.064208984375
r_  generation:  0.5695221424102783
local_output_nid generation:  0.03582453727722168
local_in_edges_tensor generation:  0.052237749099731445
mini_batch_src_global generation:  0.06311297416687012
r_  generation:  0.5691351890563965
----------------------check_connections_block total spend ----------------------------- 6.636569499969482
generate_one_block  0.7115726470947266
generate_one_block  0.7250411510467529
generate_one_block  0.7013058662414551
generate_one_block  0.7060248851776123
generate_one_block  0.7247297763824463
generate_one_block  0.7190089225769043
generate_one_block  0.7391383647918701
generate_one_block  0.7132458686828613
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  11.045842170715332
block generation total time  9.744177103042603
average batch blocks generation time:  1.2180221378803253
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10194206237792969  GigaBytes
Max Memory Allocated: 0.10194206237792969  GigaBytes

torch.Size([162471, 128])
torch.Size([146029, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2908935546875 GB
    Memory Allocated: 15.82671308517456  GigaBytes
Max Memory Allocated: 15.840744018554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3065185546875 GB
    Memory Allocated: 0.1048283576965332  GigaBytes
Max Memory Allocated: 15.840744018554688  GigaBytes

torch.Size([162466, 128])
torch.Size([145899, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1971435546875 GB
    Memory Allocated: 15.940137386322021  GigaBytes
Max Memory Allocated: 15.956413745880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1971435546875 GB
    Memory Allocated: 0.10547018051147461  GigaBytes
Max Memory Allocated: 15.956413745880127  GigaBytes

torch.Size([162524, 128])
torch.Size([145797, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1971435546875 GB
    Memory Allocated: 15.910636901855469  GigaBytes
Max Memory Allocated: 15.956413745880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1971435546875 GB
    Memory Allocated: 0.10480117797851562  GigaBytes
Max Memory Allocated: 15.956413745880127  GigaBytes

torch.Size([162449, 128])
torch.Size([145905, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1990966796875 GB
    Memory Allocated: 15.936108112335205  GigaBytes
Max Memory Allocated: 15.956413745880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1990966796875 GB
    Memory Allocated: 0.10547780990600586  GigaBytes
Max Memory Allocated: 15.956413745880127  GigaBytes

torch.Size([162687, 128])
torch.Size([146176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.955663681030273  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10487747192382812  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162635, 128])
torch.Size([146017, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.925722122192383  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10545206069946289  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162783, 128])
torch.Size([146076, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.895724773406982  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10482311248779297  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162543, 128])
torch.Size([145699, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.876515865325928  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040884166955947876 |0.06591838598251343 |0.7652844488620758 |0.00010916590690612793 |1.151791512966156 |0.016613006591796875 |
----------------------------------------------------------pseudo_mini_loss sum 4.399827003479004
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3058095
Number of first layer input nodes during this epoch:  1300558
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.1419525146484375  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03275012969970703
random selection method range initialization spend 0.005455732345581055
time for parepare:  0.017480850219726562
local_output_nid generation:  0.0051271915435791016
local_in_edges_tensor generation:  0.011034011840820312
mini_batch_src_global generation:  0.003727436065673828
r_  generation:  0.04050922393798828
local_output_nid generation:  0.0062983036041259766
local_in_edges_tensor generation:  0.0036513805389404297
mini_batch_src_global generation:  0.004679679870605469
r_  generation:  0.043630123138427734
local_output_nid generation:  0.006415843963623047
local_in_edges_tensor generation:  0.0037081241607666016
mini_batch_src_global generation:  0.003250598907470703
r_  generation:  0.04372739791870117
local_output_nid generation:  0.006531476974487305
local_in_edges_tensor generation:  0.0037415027618408203
mini_batch_src_global generation:  0.0035016536712646484
r_  generation:  0.04579877853393555
local_output_nid generation:  0.006536960601806641
local_in_edges_tensor generation:  0.003754854202270508
mini_batch_src_global generation:  0.0037496089935302734
r_  generation:  0.046887874603271484
local_output_nid generation:  0.006515979766845703
local_in_edges_tensor generation:  0.003673553466796875
mini_batch_src_global generation:  0.004143714904785156
r_  generation:  0.04962897300720215
local_output_nid generation:  0.006517171859741211
local_in_edges_tensor generation:  0.003665924072265625
mini_batch_src_global generation:  0.004088878631591797
r_  generation:  0.046602725982666016
local_output_nid generation:  0.006669282913208008
local_in_edges_tensor generation:  0.003701925277709961
mini_batch_src_global generation:  0.004183053970336914
r_  generation:  0.048384904861450195
----------------------check_connections_block total spend ----------------------------- 0.5877182483673096
generate_one_block  0.07639312744140625
generate_one_block  0.07338166236877441
generate_one_block  0.07351064682006836
generate_one_block  0.07444119453430176
generate_one_block  0.07525968551635742
generate_one_block  0.07851886749267578
generate_one_block  0.07967972755432129
generate_one_block  0.0760347843170166
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04349327087402344
gen group dst list time:  0.01593613624572754
time for parepare:  0.018747329711914062
local_output_nid generation:  0.015208959579467773
local_in_edges_tensor generation:  0.038300514221191406
mini_batch_src_global generation:  0.03447580337524414
r_  generation:  0.34768009185791016
local_output_nid generation:  0.0203855037689209
local_in_edges_tensor generation:  0.03435873985290527
mini_batch_src_global generation:  0.044092416763305664
r_  generation:  0.36856794357299805
local_output_nid generation:  0.022504329681396484
local_in_edges_tensor generation:  0.025445222854614258
mini_batch_src_global generation:  0.04429268836975098
r_  generation:  0.37697744369506836
local_output_nid generation:  0.019846677780151367
local_in_edges_tensor generation:  0.024884462356567383
mini_batch_src_global generation:  0.046222686767578125
r_  generation:  0.37607455253601074
local_output_nid generation:  0.01973867416381836
local_in_edges_tensor generation:  0.02876114845275879
mini_batch_src_global generation:  0.04651355743408203
r_  generation:  0.37871575355529785
local_output_nid generation:  0.020416736602783203
local_in_edges_tensor generation:  0.022458553314208984
mini_batch_src_global generation:  0.047084808349609375
r_  generation:  0.38922119140625
local_output_nid generation:  0.020267009735107422
local_in_edges_tensor generation:  0.024099349975585938
mini_batch_src_global generation:  0.046953678131103516
r_  generation:  0.38675951957702637
local_output_nid generation:  0.02290797233581543
local_in_edges_tensor generation:  0.025237083435058594
mini_batch_src_global generation:  0.0471501350402832
r_  generation:  0.3837087154388428
----------------------check_connections_block total spend ----------------------------- 4.3974244594573975
generate_one_block  0.5194149017333984
generate_one_block  0.5296721458435059
generate_one_block  0.5316247940063477
generate_one_block  0.5264143943786621
generate_one_block  0.5260252952575684
generate_one_block  0.5377895832061768
generate_one_block  0.5274398326873779
generate_one_block  0.5497269630432129
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03622245788574219
gen group dst list time:  0.03691554069519043
time for parepare:  0.01904439926147461
local_output_nid generation:  0.02856731414794922
local_in_edges_tensor generation:  0.04734158515930176
mini_batch_src_global generation:  0.055212974548339844
r_  generation:  0.5403778553009033
local_output_nid generation:  0.03535938262939453
local_in_edges_tensor generation:  0.05592918395996094
mini_batch_src_global generation:  0.06451535224914551
r_  generation:  0.5508127212524414
local_output_nid generation:  0.035558462142944336
local_in_edges_tensor generation:  0.05110979080200195
mini_batch_src_global generation:  0.06150102615356445
r_  generation:  0.5513222217559814
local_output_nid generation:  0.03520369529724121
local_in_edges_tensor generation:  0.041364431381225586
mini_batch_src_global generation:  0.060089111328125
r_  generation:  0.5688490867614746
local_output_nid generation:  0.0356295108795166
local_in_edges_tensor generation:  0.04574251174926758
mini_batch_src_global generation:  0.06155872344970703
r_  generation:  0.5598227977752686
local_output_nid generation:  0.03539085388183594
local_in_edges_tensor generation:  0.04132723808288574
mini_batch_src_global generation:  0.06288599967956543
r_  generation:  0.5736825466156006
local_output_nid generation:  0.03564333915710449
local_in_edges_tensor generation:  0.045960426330566406
mini_batch_src_global generation:  0.06362366676330566
r_  generation:  0.5716004371643066
local_output_nid generation:  0.03554177284240723
local_in_edges_tensor generation:  0.03809332847595215
mini_batch_src_global generation:  0.0627739429473877
r_  generation:  0.5744054317474365
----------------------check_connections_block total spend ----------------------------- 6.6342034339904785
generate_one_block  0.7717156410217285
generate_one_block  0.7652761936187744
generate_one_block  0.7735986709594727
generate_one_block  0.7448272705078125
generate_one_block  0.7604060173034668
generate_one_block  0.7598381042480469
generate_one_block  0.7506284713745117
generate_one_block  0.7375454902648926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.1419525146484375  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

connection checking time:  11.031627893447876
block generation total time  10.311943769454956
average batch blocks generation time:  1.2889929711818695
block dataloader generation time/epoch 24.014707326889038
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10664939880371094  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162500, 128])
torch.Size([145673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.871461868286133  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10612344741821289  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162718, 128])
torch.Size([145771, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.89014482498169  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10666322708129883  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162553, 128])
torch.Size([145752, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.91818618774414  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10599946975708008  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162434, 128])
torch.Size([145693, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.89599609375  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10666799545288086  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162595, 128])
torch.Size([145792, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 15.898016929626465  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2069091796875 GB
    Memory Allocated: 0.10619306564331055  GigaBytes
Max Memory Allocated: 15.97185754776001  GigaBytes

torch.Size([162744, 128])
torch.Size([146439, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2283935546875 GB
    Memory Allocated: 16.00158929824829  GigaBytes
Max Memory Allocated: 16.018239498138428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2283935546875 GB
    Memory Allocated: 0.10666418075561523  GigaBytes
Max Memory Allocated: 16.018239498138428  GigaBytes

torch.Size([162841, 128])
torch.Size([146356, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2283935546875 GB
    Memory Allocated: 15.920557498931885  GigaBytes
Max Memory Allocated: 16.018239498138428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2283935546875 GB
    Memory Allocated: 0.10610008239746094  GigaBytes
Max Memory Allocated: 16.018239498138428  GigaBytes

torch.Size([162637, 128])
torch.Size([145826, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2283935546875 GB
    Memory Allocated: 15.91655158996582  GigaBytes
Max Memory Allocated: 16.018239498138428  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04325547814369202 |0.02662000060081482 |0.6688830554485321 |0.00011038780212402344 |1.3128381669521332 |0.004021644592285156 |
----------------------------------------------------------pseudo_mini_loss sum 3.703885793685913
Total (block generation + training)time/epoch 40.47457432746887
Training time/epoch 16.459665775299072
Training time without block to device /epoch 16.246705770492554
Training time without total dataloading part /epoch 15.8586745262146
load block tensor time/epoch 0.34604382514953613
block to device time/epoch 0.21296000480651855
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057411
Number of first layer input nodes during this epoch:  1301022
