Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648459234.5079727
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0263521671295166
random selection method range initialization spend 0.00728297233581543
time for parepare:  0.019843101501464844
local_output_nid generation:  0.0011098384857177734
local_in_edges_tensor generation:  0.003373861312866211
mini_batch_src_global generation:  0.002249479293823242
r_  generation:  0.012027263641357422
local_output_nid generation:  0.0015113353729248047
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0016429424285888672
r_  generation:  0.009932994842529297
local_output_nid generation:  0.0014951229095458984
local_in_edges_tensor generation:  0.0008218288421630859
mini_batch_src_global generation:  0.0010273456573486328
r_  generation:  0.008995771408081055
local_output_nid generation:  0.0014965534210205078
local_in_edges_tensor generation:  0.0007913112640380859
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.009440422058105469
local_output_nid generation:  0.0014653205871582031
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0010530948638916016
r_  generation:  0.009807109832763672
local_output_nid generation:  0.0015361309051513672
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.0009837150573730469
r_  generation:  0.009442567825317383
local_output_nid generation:  0.0015072822570800781
local_in_edges_tensor generation:  0.0007860660552978516
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.009418725967407227
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0009446144104003906
r_  generation:  0.009343385696411133
local_output_nid generation:  0.001432180404663086
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.009888172149658203
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0009920597076416016
r_  generation:  0.009608745574951172
local_output_nid generation:  0.0014510154724121094
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.009154796600341797
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.009707450866699219
local_output_nid generation:  0.0014455318450927734
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0010421276092529297
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0014541149139404297
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0010521411895751953
r_  generation:  0.010141611099243164
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0010395050048828125
r_  generation:  0.010011672973632812
local_output_nid generation:  0.0014901161193847656
local_in_edges_tensor generation:  0.0007641315460205078
mini_batch_src_global generation:  0.0010333061218261719
r_  generation:  0.009956598281860352
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.009610891342163086
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007412433624267578
mini_batch_src_global generation:  0.001031637191772461
r_  generation:  0.010433197021484375
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.010278463363647461
local_output_nid generation:  0.0014829635620117188
local_in_edges_tensor generation:  0.0007605552673339844
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.010099411010742188
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007560253143310547
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.009543180465698242
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.010245323181152344
local_output_nid generation:  0.0014696121215820312
local_in_edges_tensor generation:  0.0007467269897460938
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.009989261627197266
local_output_nid generation:  0.0014624595642089844
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.0010616779327392578
r_  generation:  0.010315418243408203
local_output_nid generation:  0.0014503002166748047
local_in_edges_tensor generation:  0.0007510185241699219
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.010030746459960938
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0007543563842773438
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.009720563888549805
local_output_nid generation:  0.0014672279357910156
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.009781360626220703
local_output_nid generation:  0.0014548301696777344
local_in_edges_tensor generation:  0.0007596015930175781
mini_batch_src_global generation:  0.001056671142578125
r_  generation:  0.010385274887084961
local_output_nid generation:  0.0014481544494628906
local_in_edges_tensor generation:  0.0007426738739013672
mini_batch_src_global generation:  0.0010457038879394531
r_  generation:  0.010195493698120117
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.005599498748779297
mini_batch_src_global generation:  0.0012950897216796875
r_  generation:  0.010416746139526367
local_output_nid generation:  0.001355886459350586
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.0011205673217773438
r_  generation:  0.009771585464477539
local_output_nid generation:  0.0013995170593261719
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.009734630584716797
----------------------check_connections_block total spend ----------------------------- 0.5387201309204102
generate_one_block  0.015545368194580078
generate_one_block  0.015409469604492188
generate_one_block  0.014182090759277344
generate_one_block  0.014849662780761719
generate_one_block  0.015136003494262695
generate_one_block  0.014323234558105469
generate_one_block  0.014463424682617188
generate_one_block  0.014190912246704102
generate_one_block  0.01490473747253418
generate_one_block  0.014617443084716797
generate_one_block  0.01367807388305664
generate_one_block  0.014472246170043945
generate_one_block  0.015336275100708008
generate_one_block  0.014775276184082031
generate_one_block  0.014684438705444336
generate_one_block  0.01465749740600586
generate_one_block  0.014166593551635742
generate_one_block  0.014920234680175781
generate_one_block  0.014974355697631836
generate_one_block  0.014608144760131836
generate_one_block  0.014173030853271484
generate_one_block  0.014947175979614258
generate_one_block  0.014658689498901367
generate_one_block  0.015485286712646484
generate_one_block  0.01500701904296875
generate_one_block  0.014293909072875977
generate_one_block  0.014474153518676758
generate_one_block  0.015155553817749023
generate_one_block  0.014838457107543945
generate_one_block  0.01494288444519043
generate_one_block  0.014559268951416016
generate_one_block  0.014251947402954102
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041522979736328125
gen group dst list time:  0.026171445846557617
time for parepare:  0.019039154052734375
local_output_nid generation:  0.0052967071533203125
local_in_edges_tensor generation:  0.014857769012451172
mini_batch_src_global generation:  0.019026994705200195
r_  generation:  0.16266942024230957
local_output_nid generation:  0.008824825286865234
local_in_edges_tensor generation:  0.015266895294189453
mini_batch_src_global generation:  0.02392125129699707
r_  generation:  0.17305231094360352
local_output_nid generation:  0.008253097534179688
local_in_edges_tensor generation:  0.011373519897460938
mini_batch_src_global generation:  0.021395444869995117
r_  generation:  0.1702585220336914
local_output_nid generation:  0.008330583572387695
local_in_edges_tensor generation:  0.012035369873046875
mini_batch_src_global generation:  0.02079176902770996
r_  generation:  0.18056464195251465
local_output_nid generation:  0.00836634635925293
local_in_edges_tensor generation:  0.010453224182128906
mini_batch_src_global generation:  0.021837234497070312
r_  generation:  0.1830911636352539
local_output_nid generation:  0.008080005645751953
local_in_edges_tensor generation:  0.009886026382446289
mini_batch_src_global generation:  0.025575637817382812
r_  generation:  0.17872929573059082
local_output_nid generation:  0.008103132247924805
local_in_edges_tensor generation:  0.010090351104736328
mini_batch_src_global generation:  0.0216829776763916
r_  generation:  0.17551803588867188
local_output_nid generation:  0.008196115493774414
local_in_edges_tensor generation:  0.011671066284179688
mini_batch_src_global generation:  0.021604537963867188
r_  generation:  0.17087769508361816
local_output_nid generation:  0.00823354721069336
local_in_edges_tensor generation:  0.008568763732910156
mini_batch_src_global generation:  0.025021076202392578
r_  generation:  0.181610107421875
local_output_nid generation:  0.008119821548461914
local_in_edges_tensor generation:  0.011583566665649414
mini_batch_src_global generation:  0.022418498992919922
r_  generation:  0.18854022026062012
local_output_nid generation:  0.01093292236328125
local_in_edges_tensor generation:  0.01851177215576172
mini_batch_src_global generation:  0.02210235595703125
r_  generation:  0.17160534858703613
local_output_nid generation:  0.008114337921142578
local_in_edges_tensor generation:  0.01318979263305664
mini_batch_src_global generation:  0.022378921508789062
r_  generation:  0.17648768424987793
local_output_nid generation:  0.008547544479370117
local_in_edges_tensor generation:  0.009919881820678711
mini_batch_src_global generation:  0.025020837783813477
r_  generation:  0.18555736541748047
local_output_nid generation:  0.008346319198608398
local_in_edges_tensor generation:  0.011852741241455078
mini_batch_src_global generation:  0.02300262451171875
r_  generation:  0.1768488883972168
local_output_nid generation:  0.008496522903442383
local_in_edges_tensor generation:  0.010383367538452148
mini_batch_src_global generation:  0.023063182830810547
r_  generation:  0.1802229881286621
local_output_nid generation:  0.008288145065307617
local_in_edges_tensor generation:  0.00879359245300293
mini_batch_src_global generation:  0.022632598876953125
r_  generation:  0.17584538459777832
local_output_nid generation:  0.008108377456665039
local_in_edges_tensor generation:  0.008597612380981445
mini_batch_src_global generation:  0.02259039878845215
r_  generation:  0.17578673362731934
local_output_nid generation:  0.008515357971191406
local_in_edges_tensor generation:  0.012092351913452148
mini_batch_src_global generation:  0.02476787567138672
r_  generation:  0.18263888359069824
local_output_nid generation:  0.008466482162475586
local_in_edges_tensor generation:  0.011975526809692383
mini_batch_src_global generation:  0.02332592010498047
r_  generation:  0.18528056144714355
local_output_nid generation:  0.008243799209594727
local_in_edges_tensor generation:  0.008999347686767578
mini_batch_src_global generation:  0.02268385887145996
r_  generation:  0.17782235145568848
local_output_nid generation:  0.00810861587524414
local_in_edges_tensor generation:  0.008641719818115234
mini_batch_src_global generation:  0.022127866744995117
r_  generation:  0.19025397300720215
local_output_nid generation:  0.008293867111206055
local_in_edges_tensor generation:  0.010413169860839844
mini_batch_src_global generation:  0.023253202438354492
r_  generation:  0.18673229217529297
local_output_nid generation:  0.008254051208496094
local_in_edges_tensor generation:  0.011792182922363281
mini_batch_src_global generation:  0.02356696128845215
r_  generation:  0.1847531795501709
local_output_nid generation:  0.009366989135742188
local_in_edges_tensor generation:  0.017554044723510742
mini_batch_src_global generation:  0.02419257164001465
r_  generation:  0.1974649429321289
local_output_nid generation:  0.010219812393188477
local_in_edges_tensor generation:  0.013532638549804688
mini_batch_src_global generation:  0.024466991424560547
r_  generation:  0.1856532096862793
local_output_nid generation:  0.008115768432617188
local_in_edges_tensor generation:  0.011199712753295898
mini_batch_src_global generation:  0.022764921188354492
r_  generation:  0.17920231819152832
local_output_nid generation:  0.008283138275146484
local_in_edges_tensor generation:  0.008765935897827148
mini_batch_src_global generation:  0.022702693939208984
r_  generation:  0.18316411972045898
local_output_nid generation:  0.00850987434387207
local_in_edges_tensor generation:  0.010489463806152344
mini_batch_src_global generation:  0.025568008422851562
r_  generation:  0.1844615936279297
local_output_nid generation:  0.008255481719970703
local_in_edges_tensor generation:  0.010307073593139648
mini_batch_src_global generation:  0.022573471069335938
r_  generation:  0.18233299255371094
local_output_nid generation:  0.008446455001831055
local_in_edges_tensor generation:  0.0100860595703125
mini_batch_src_global generation:  0.024709701538085938
r_  generation:  0.18336224555969238
local_output_nid generation:  0.008144140243530273
local_in_edges_tensor generation:  0.008887290954589844
mini_batch_src_global generation:  0.02263927459716797
r_  generation:  0.17686223983764648
local_output_nid generation:  0.008209228515625
local_in_edges_tensor generation:  0.010588645935058594
mini_batch_src_global generation:  0.02225804328918457
r_  generation:  0.1792430877685547
----------------------check_connections_block total spend ----------------------------- 8.45042610168457
generate_one_block  0.23339128494262695
generate_one_block  0.23801946640014648
generate_one_block  0.24335360527038574
generate_one_block  0.23399710655212402
generate_one_block  0.24102306365966797
generate_one_block  0.22634387016296387
generate_one_block  0.22525453567504883
generate_one_block  0.21467351913452148
generate_one_block  0.2278432846069336
generate_one_block  0.22387242317199707
generate_one_block  0.21042919158935547
generate_one_block  0.22455763816833496
generate_one_block  0.24245738983154297
generate_one_block  0.22811269760131836
generate_one_block  0.2277531623840332
generate_one_block  0.2506840229034424
generate_one_block  0.21978139877319336
generate_one_block  0.23581767082214355
generate_one_block  0.2346329689025879
generate_one_block  0.21965765953063965
generate_one_block  0.2184467315673828
generate_one_block  0.22875237464904785
generate_one_block  0.23172712326049805
generate_one_block  0.25204038619995117
generate_one_block  0.22713494300842285
generate_one_block  0.22296881675720215
generate_one_block  0.22435736656188965
generate_one_block  0.24421215057373047
generate_one_block  0.23355484008789062
generate_one_block  0.2353212833404541
generate_one_block  0.22411513328552246
generate_one_block  0.21730637550354004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07521986961364746
gen group dst list time:  0.11483573913574219
time for parepare:  0.02070450782775879
local_output_nid generation:  0.02343153953552246
local_in_edges_tensor generation:  0.06568694114685059
mini_batch_src_global generation:  0.04678487777709961
r_  generation:  0.47896766662597656
local_output_nid generation:  0.03011918067932129
local_in_edges_tensor generation:  0.04823637008666992
mini_batch_src_global generation:  0.05774259567260742
r_  generation:  0.48526644706726074
local_output_nid generation:  0.029500961303710938
local_in_edges_tensor generation:  0.03929758071899414
mini_batch_src_global generation:  0.055498600006103516
r_  generation:  0.4927043914794922
local_output_nid generation:  0.028179168701171875
local_in_edges_tensor generation:  0.040169715881347656
mini_batch_src_global generation:  0.08210992813110352
r_  generation:  0.4950296878814697
local_output_nid generation:  0.028289079666137695
local_in_edges_tensor generation:  0.04563713073730469
mini_batch_src_global generation:  0.05857706069946289
r_  generation:  0.5028045177459717
local_output_nid generation:  0.02937150001525879
local_in_edges_tensor generation:  0.03473687171936035
mini_batch_src_global generation:  0.06208610534667969
r_  generation:  0.4968750476837158
local_output_nid generation:  0.028195858001708984
local_in_edges_tensor generation:  0.030904531478881836
mini_batch_src_global generation:  0.05833697319030762
r_  generation:  0.49829983711242676
local_output_nid generation:  0.028001070022583008
local_in_edges_tensor generation:  0.029973268508911133
mini_batch_src_global generation:  0.05872225761413574
r_  generation:  0.4916205406188965
local_output_nid generation:  0.028351306915283203
local_in_edges_tensor generation:  0.048949241638183594
mini_batch_src_global generation:  0.05806684494018555
r_  generation:  0.497377872467041
local_output_nid generation:  0.028256654739379883
local_in_edges_tensor generation:  0.030727386474609375
mini_batch_src_global generation:  0.05940842628479004
r_  generation:  0.49194860458374023
local_output_nid generation:  0.027868032455444336
local_in_edges_tensor generation:  0.030318021774291992
mini_batch_src_global generation:  0.05815935134887695
r_  generation:  0.494964599609375
local_output_nid generation:  0.027866601943969727
local_in_edges_tensor generation:  0.03823065757751465
mini_batch_src_global generation:  0.08476734161376953
r_  generation:  0.49808216094970703
local_output_nid generation:  0.03136634826660156
local_in_edges_tensor generation:  0.04584622383117676
mini_batch_src_global generation:  0.063720703125
r_  generation:  0.5028667449951172
local_output_nid generation:  0.02926015853881836
local_in_edges_tensor generation:  0.039605140686035156
mini_batch_src_global generation:  0.061093807220458984
r_  generation:  0.5033221244812012
local_output_nid generation:  0.029636859893798828
local_in_edges_tensor generation:  0.03113412857055664
mini_batch_src_global generation:  0.06296038627624512
r_  generation:  0.5020008087158203
local_output_nid generation:  0.02894735336303711
local_in_edges_tensor generation:  0.030505657196044922
mini_batch_src_global generation:  0.05877804756164551
r_  generation:  0.49683237075805664
local_output_nid generation:  0.028980016708374023
local_in_edges_tensor generation:  0.030824899673461914
mini_batch_src_global generation:  0.05915474891662598
r_  generation:  0.5020222663879395
local_output_nid generation:  0.029187917709350586
local_in_edges_tensor generation:  0.04907417297363281
mini_batch_src_global generation:  0.0656578540802002
r_  generation:  0.5021016597747803
local_output_nid generation:  0.028926849365234375
local_in_edges_tensor generation:  0.03633880615234375
mini_batch_src_global generation:  0.05979013442993164
r_  generation:  0.515902042388916
local_output_nid generation:  0.029741764068603516
local_in_edges_tensor generation:  0.04486823081970215
mini_batch_src_global generation:  0.060155391693115234
r_  generation:  0.4993264675140381
local_output_nid generation:  0.02913355827331543
local_in_edges_tensor generation:  0.04242515563964844
mini_batch_src_global generation:  0.05791759490966797
r_  generation:  0.5007343292236328
local_output_nid generation:  0.02933025360107422
local_in_edges_tensor generation:  0.04199028015136719
mini_batch_src_global generation:  0.059723615646362305
r_  generation:  0.49938368797302246
local_output_nid generation:  0.028928756713867188
local_in_edges_tensor generation:  0.02867269515991211
mini_batch_src_global generation:  0.0574796199798584
r_  generation:  0.509990930557251
local_output_nid generation:  0.029033660888671875
local_in_edges_tensor generation:  0.037000417709350586
mini_batch_src_global generation:  0.060999155044555664
r_  generation:  0.49935173988342285
local_output_nid generation:  0.029140710830688477
local_in_edges_tensor generation:  0.032811880111694336
mini_batch_src_global generation:  0.057761192321777344
r_  generation:  0.5076172351837158
local_output_nid generation:  0.028767108917236328
local_in_edges_tensor generation:  0.03284597396850586
mini_batch_src_global generation:  0.05778670310974121
r_  generation:  0.4943878650665283
local_output_nid generation:  0.029237985610961914
local_in_edges_tensor generation:  0.036810874938964844
mini_batch_src_global generation:  0.06127166748046875
r_  generation:  0.5207631587982178
local_output_nid generation:  0.02943277359008789
local_in_edges_tensor generation:  0.040120840072631836
mini_batch_src_global generation:  0.06800103187561035
r_  generation:  0.5042815208435059
local_output_nid generation:  0.02913641929626465
local_in_edges_tensor generation:  0.038509368896484375
mini_batch_src_global generation:  0.0585484504699707
r_  generation:  0.5014863014221191
local_output_nid generation:  0.029240131378173828
local_in_edges_tensor generation:  0.028006792068481445
mini_batch_src_global generation:  0.058244943618774414
r_  generation:  0.5031239986419678
local_output_nid generation:  0.029039382934570312
local_in_edges_tensor generation:  0.03288459777832031
mini_batch_src_global generation:  0.05832958221435547
r_  generation:  0.5155682563781738
local_output_nid generation:  0.031078577041625977
local_in_edges_tensor generation:  0.03274106979370117
mini_batch_src_global generation:  0.0625905990600586
r_  generation:  0.4961373805999756
----------------------check_connections_block total spend ----------------------------- 23.546632528305054
generate_one_block  0.7535743713378906
generate_one_block  0.6449222564697266
generate_one_block  0.6291170120239258
generate_one_block  0.6454982757568359
generate_one_block  0.6492505073547363
generate_one_block  0.6441390514373779
generate_one_block  0.6265466213226318
generate_one_block  0.6295225620269775
generate_one_block  0.6437504291534424
generate_one_block  0.6416499614715576
generate_one_block  0.6311261653900146
generate_one_block  0.6389026641845703
generate_one_block  0.6613330841064453
generate_one_block  0.6409599781036377
generate_one_block  0.6448276042938232
generate_one_block  0.6486129760742188
generate_one_block  0.638683557510376
generate_one_block  0.6509816646575928
generate_one_block  0.6353740692138672
generate_one_block  0.6409952640533447
generate_one_block  0.6619226932525635
generate_one_block  0.6523246765136719
generate_one_block  0.6485819816589355
generate_one_block  0.6565775871276855
generate_one_block  0.6348557472229004
generate_one_block  0.6290891170501709
generate_one_block  0.6406238079071045
generate_one_block  0.6633338928222656
generate_one_block  0.626392126083374
generate_one_block  0.6329116821289062
generate_one_block  0.635617733001709
generate_one_block  0.6370112895965576
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  31.997058629989624
block generation total time  28.020603895187378
average batch blocks generation time:  0.8756438717246056
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08948945999145508  GigaBytes
Max Memory Allocated: 0.08948945999145508  GigaBytes

torch.Size([150449, 128])
torch.Size([110726, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8162841796875 GB
    Memory Allocated: 14.281553268432617  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.09020853042602539  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150261, 128])
torch.Size([110540, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2987060546875 GB
    Memory Allocated: 14.26406478881836  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2987060546875 GB
    Memory Allocated: 0.09040451049804688  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150467, 128])
torch.Size([109412, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4334716796875 GB
    Memory Allocated: 14.058351516723633  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4334716796875 GB
    Memory Allocated: 0.09010457992553711  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150071, 128])
torch.Size([110094, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.265526294708252  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.09080886840820312  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150035, 128])
torch.Size([110302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.280809879302979  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.09012794494628906  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150450, 128])
torch.Size([110119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.191662788391113  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.09054946899414062  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150053, 128])
torch.Size([109107, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.099182605743408  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.08977794647216797  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150308, 128])
torch.Size([108898, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 13.996595859527588  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.09067440032958984  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150528, 128])
torch.Size([110413, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.20151424407959  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.08967065811157227  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([149745, 128])
torch.Size([108826, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.116172313690186  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.09030437469482422  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([149738, 128])
torch.Size([108495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 13.953917980194092  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.08970022201538086  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([149797, 128])
torch.Size([108752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 14.08382272720337  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4569091796875 GB
    Memory Allocated: 0.09093570709228516  GigaBytes
Max Memory Allocated: 14.304204940795898  GigaBytes

torch.Size([150844, 128])
torch.Size([110751, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.368637561798096  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09016799926757812  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150472, 128])
torch.Size([109972, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.211575984954834  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09072685241699219  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150962, 128])
torch.Size([110959, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.259591102600098  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09000301361083984  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150392, 128])
torch.Size([109598, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.1196870803833  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09055233001708984  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150320, 128])
torch.Size([109757, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.138818740844727  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09033870697021484  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150548, 128])
torch.Size([111054, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.331216812133789  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.0907745361328125  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150383, 128])
torch.Size([110128, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.269890785217285  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.08974647521972656  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([149932, 128])
torch.Size([109327, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.11089038848877  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09051227569580078  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150173, 128])
torch.Size([109204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.11176872253418  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.08998441696166992  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150007, 128])
torch.Size([109672, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.236833572387695  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09067916870117188  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([149857, 128])
torch.Size([109417, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.204050064086914  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.0901041030883789  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([149912, 128])
torch.Size([109932, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.343587875366211  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09067153930664062  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150339, 128])
torch.Size([109652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.189396381378174  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.08973026275634766  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([149866, 128])
torch.Size([108671, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.119041919708252  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09066963195800781  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150647, 128])
torch.Size([110321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 14.188425064086914  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5115966796875 GB
    Memory Allocated: 0.09050893783569336  GigaBytes
Max Memory Allocated: 14.391842365264893  GigaBytes

torch.Size([150743, 128])
torch.Size([111576, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.389735698699951  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09064769744873047  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149853, 128])
torch.Size([109208, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.15913438796997  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09026527404785156  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150490, 128])
torch.Size([110664, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.282557964324951  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09052848815917969  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149949, 128])
torch.Size([109238, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.115211009979248  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.08999824523925781  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150576, 128])
torch.Size([109822, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.086551189422607  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03827538341283798 |0.03357398509979248 |0.6389471516013145 |0.0001148805022239685 |1.1063315942883492 |0.019900798797607422 |
----------------------------------------------------------pseudo_mini_loss sum 4.9586405754089355
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9163274
Number of first layer input nodes during this epoch:  4808167
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.11399459838867188  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028083086013793945
random selection method range initialization spend 0.007194042205810547
time for parepare:  0.02021312713623047
local_output_nid generation:  0.0015151500701904297
local_in_edges_tensor generation:  0.0049190521240234375
mini_batch_src_global generation:  0.0019364356994628906
r_  generation:  0.011147022247314453
local_output_nid generation:  0.0016863346099853516
local_in_edges_tensor generation:  0.0012187957763671875
mini_batch_src_global generation:  0.0016293525695800781
r_  generation:  0.010188579559326172
local_output_nid generation:  0.0017054080963134766
local_in_edges_tensor generation:  0.0011065006256103516
mini_batch_src_global generation:  0.0012278556823730469
r_  generation:  0.009926080703735352
local_output_nid generation:  0.0016443729400634766
local_in_edges_tensor generation:  0.001085042953491211
mini_batch_src_global generation:  0.001218557357788086
r_  generation:  0.009998321533203125
local_output_nid generation:  0.0016357898712158203
local_in_edges_tensor generation:  0.001043081283569336
mini_batch_src_global generation:  0.0012569427490234375
r_  generation:  0.010046005249023438
local_output_nid generation:  0.001638650894165039
local_in_edges_tensor generation:  0.0010197162628173828
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.010298490524291992
local_output_nid generation:  0.0016362667083740234
local_in_edges_tensor generation:  0.001056671142578125
mini_batch_src_global generation:  0.0012812614440917969
r_  generation:  0.010519981384277344
local_output_nid generation:  0.001622915267944336
local_in_edges_tensor generation:  0.0010457038879394531
mini_batch_src_global generation:  0.0013034343719482422
r_  generation:  0.010667085647583008
local_output_nid generation:  0.001615762710571289
local_in_edges_tensor generation:  0.001013040542602539
mini_batch_src_global generation:  0.0012593269348144531
r_  generation:  0.010549545288085938
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.0012359619140625
r_  generation:  0.010538101196289062
local_output_nid generation:  0.00162506103515625
local_in_edges_tensor generation:  0.0010361671447753906
mini_batch_src_global generation:  0.0012018680572509766
r_  generation:  0.010350465774536133
local_output_nid generation:  0.0016148090362548828
local_in_edges_tensor generation:  0.0010399818420410156
mini_batch_src_global generation:  0.0011951923370361328
r_  generation:  0.010416269302368164
local_output_nid generation:  0.0016226768493652344
local_in_edges_tensor generation:  0.0010561943054199219
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010799407958984375
local_output_nid generation:  0.0016651153564453125
local_in_edges_tensor generation:  0.001009225845336914
mini_batch_src_global generation:  0.0013396739959716797
r_  generation:  0.010464906692504883
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0010251998901367188
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010471343994140625
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0010101795196533203
mini_batch_src_global generation:  0.001161813735961914
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.000997304916381836
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010336875915527344
local_output_nid generation:  0.0015976428985595703
local_in_edges_tensor generation:  0.001009225845336914
mini_batch_src_global generation:  0.0011949539184570312
r_  generation:  0.010653495788574219
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0010488033294677734
mini_batch_src_global generation:  0.0012454986572265625
r_  generation:  0.010818958282470703
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0010166168212890625
mini_batch_src_global generation:  0.0011861324310302734
r_  generation:  0.010471105575561523
local_output_nid generation:  0.0016031265258789062
local_in_edges_tensor generation:  0.0010132789611816406
mini_batch_src_global generation:  0.0012905597686767578
r_  generation:  0.010433197021484375
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0010361671447753906
mini_batch_src_global generation:  0.001260519027709961
r_  generation:  0.010317087173461914
local_output_nid generation:  0.0016319751739501953
local_in_edges_tensor generation:  0.0009961128234863281
mini_batch_src_global generation:  0.0013186931610107422
r_  generation:  0.010451316833496094
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0010325908660888672
mini_batch_src_global generation:  0.0013890266418457031
r_  generation:  0.010816335678100586
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0010323524475097656
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010668516159057617
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0010373592376708984
mini_batch_src_global generation:  0.0012905597686767578
r_  generation:  0.010622501373291016
local_output_nid generation:  0.0016198158264160156
local_in_edges_tensor generation:  0.0010290145874023438
mini_batch_src_global generation:  0.00119781494140625
r_  generation:  0.010679244995117188
local_output_nid generation:  0.0016012191772460938
local_in_edges_tensor generation:  0.001009225845336914
mini_batch_src_global generation:  0.0011737346649169922
r_  generation:  0.01015019416809082
local_output_nid generation:  0.0016088485717773438
local_in_edges_tensor generation:  0.0010285377502441406
mini_batch_src_global generation:  0.0011684894561767578
r_  generation:  0.010314464569091797
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0010094642639160156
mini_batch_src_global generation:  0.0012340545654296875
r_  generation:  0.010752677917480469
local_output_nid generation:  0.0016009807586669922
local_in_edges_tensor generation:  0.0010356903076171875
mini_batch_src_global generation:  0.0012929439544677734
r_  generation:  0.011029481887817383
local_output_nid generation:  0.0015995502471923828
local_in_edges_tensor generation:  0.001016378402709961
mini_batch_src_global generation:  0.0013363361358642578
r_  generation:  0.01041102409362793
----------------------check_connections_block total spend ----------------------------- 0.5831592082977295
generate_one_block  0.027542829513549805
generate_one_block  0.0219724178314209
generate_one_block  0.020247220993041992
generate_one_block  0.019895076751708984
generate_one_block  0.01939868927001953
generate_one_block  0.019360780715942383
generate_one_block  0.01995563507080078
generate_one_block  0.019716262817382812
generate_one_block  0.01954340934753418
generate_one_block  0.019340991973876953
generate_one_block  0.01920294761657715
generate_one_block  0.019282102584838867
generate_one_block  0.019887924194335938
generate_one_block  0.019267797470092773
generate_one_block  0.019016027450561523
generate_one_block  0.018428802490234375
generate_one_block  0.019006967544555664
generate_one_block  0.019316434860229492
generate_one_block  0.019901514053344727
generate_one_block  0.02153778076171875
generate_one_block  0.019144058227539062
generate_one_block  0.018919706344604492
generate_one_block  0.01919102668762207
generate_one_block  0.019625425338745117
generate_one_block  0.019858360290527344
generate_one_block  0.019454479217529297
generate_one_block  0.019387245178222656
generate_one_block  0.01831674575805664
generate_one_block  0.01869797706604004
generate_one_block  0.019644975662231445
generate_one_block  0.020020008087158203
generate_one_block  0.019006967544555664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044184207916259766
gen group dst list time:  0.022342920303344727
time for parepare:  0.020078659057617188
local_output_nid generation:  0.0069005489349365234
local_in_edges_tensor generation:  0.014034032821655273
mini_batch_src_global generation:  0.01606440544128418
r_  generation:  0.1628572940826416
local_output_nid generation:  0.00921010971069336
local_in_edges_tensor generation:  0.011823654174804688
mini_batch_src_global generation:  0.02040839195251465
r_  generation:  0.16741180419921875
local_output_nid generation:  0.009808063507080078
local_in_edges_tensor generation:  0.03230881690979004
mini_batch_src_global generation:  0.019331932067871094
r_  generation:  0.17661619186401367
local_output_nid generation:  0.010059833526611328
local_in_edges_tensor generation:  0.011876344680786133
mini_batch_src_global generation:  0.021924972534179688
r_  generation:  0.18332767486572266
local_output_nid generation:  0.010017633438110352
local_in_edges_tensor generation:  0.011296510696411133
mini_batch_src_global generation:  0.02142477035522461
r_  generation:  0.18311238288879395
local_output_nid generation:  0.00978231430053711
local_in_edges_tensor generation:  0.01005244255065918
mini_batch_src_global generation:  0.021604299545288086
r_  generation:  0.1801621913909912
local_output_nid generation:  0.009783506393432617
local_in_edges_tensor generation:  0.011298418045043945
mini_batch_src_global generation:  0.02253127098083496
r_  generation:  0.18697643280029297
local_output_nid generation:  0.012403488159179688
local_in_edges_tensor generation:  0.011623382568359375
mini_batch_src_global generation:  0.02289295196533203
r_  generation:  0.1887187957763672
local_output_nid generation:  0.00982356071472168
local_in_edges_tensor generation:  0.011631250381469727
mini_batch_src_global generation:  0.024307966232299805
r_  generation:  0.18867206573486328
local_output_nid generation:  0.01006770133972168
local_in_edges_tensor generation:  0.010204076766967773
mini_batch_src_global generation:  0.022858619689941406
r_  generation:  0.18399524688720703
local_output_nid generation:  0.010091543197631836
local_in_edges_tensor generation:  0.011126279830932617
mini_batch_src_global generation:  0.022548913955688477
r_  generation:  0.18609976768493652
local_output_nid generation:  0.009996652603149414
local_in_edges_tensor generation:  0.010284900665283203
mini_batch_src_global generation:  0.02251434326171875
r_  generation:  0.18249249458312988
local_output_nid generation:  0.010384559631347656
local_in_edges_tensor generation:  0.011422157287597656
mini_batch_src_global generation:  0.023767471313476562
r_  generation:  0.19241571426391602
local_output_nid generation:  0.009943723678588867
local_in_edges_tensor generation:  0.01308131217956543
mini_batch_src_global generation:  0.022831201553344727
r_  generation:  0.18392658233642578
local_output_nid generation:  0.010040998458862305
local_in_edges_tensor generation:  0.010023832321166992
mini_batch_src_global generation:  0.02230095863342285
r_  generation:  0.18754315376281738
local_output_nid generation:  0.009797811508178711
local_in_edges_tensor generation:  0.009640932083129883
mini_batch_src_global generation:  0.02192997932434082
r_  generation:  0.17716479301452637
local_output_nid generation:  0.010108232498168945
local_in_edges_tensor generation:  0.011516809463500977
mini_batch_src_global generation:  0.022684574127197266
r_  generation:  0.18720626831054688
local_output_nid generation:  0.010198354721069336
local_in_edges_tensor generation:  0.011341333389282227
mini_batch_src_global generation:  0.022583723068237305
r_  generation:  0.18358540534973145
local_output_nid generation:  0.01018214225769043
local_in_edges_tensor generation:  0.011237621307373047
mini_batch_src_global generation:  0.023050785064697266
r_  generation:  0.18847084045410156
local_output_nid generation:  0.009436607360839844
local_in_edges_tensor generation:  0.011124849319458008
mini_batch_src_global generation:  0.022242069244384766
r_  generation:  0.18022680282592773
local_output_nid generation:  0.009787321090698242
local_in_edges_tensor generation:  0.013089418411254883
mini_batch_src_global generation:  0.024157047271728516
r_  generation:  0.18614697456359863
local_output_nid generation:  0.009546041488647461
local_in_edges_tensor generation:  0.00972890853881836
mini_batch_src_global generation:  0.022717714309692383
r_  generation:  0.182389497756958
local_output_nid generation:  0.00966501235961914
local_in_edges_tensor generation:  0.010036706924438477
mini_batch_src_global generation:  0.02425217628479004
r_  generation:  0.18911123275756836
local_output_nid generation:  0.009765625
local_in_edges_tensor generation:  0.013068675994873047
mini_batch_src_global generation:  0.02366924285888672
r_  generation:  0.19205594062805176
local_output_nid generation:  0.009661436080932617
local_in_edges_tensor generation:  0.010183334350585938
mini_batch_src_global generation:  0.023526668548583984
r_  generation:  0.19040322303771973
local_output_nid generation:  0.009835243225097656
local_in_edges_tensor generation:  0.010282516479492188
mini_batch_src_global generation:  0.023177623748779297
r_  generation:  0.18781256675720215
local_output_nid generation:  0.00959157943725586
local_in_edges_tensor generation:  0.013161659240722656
mini_batch_src_global generation:  0.023242712020874023
r_  generation:  0.19109368324279785
local_output_nid generation:  0.009329557418823242
local_in_edges_tensor generation:  0.00948643684387207
mini_batch_src_global generation:  0.022343158721923828
r_  generation:  0.1768662929534912
local_output_nid generation:  0.009299993515014648
local_in_edges_tensor generation:  0.009779214859008789
mini_batch_src_global generation:  0.02173638343811035
r_  generation:  0.18224310874938965
local_output_nid generation:  0.009611368179321289
local_in_edges_tensor generation:  0.010292530059814453
mini_batch_src_global generation:  0.023467063903808594
r_  generation:  0.1894233226776123
local_output_nid generation:  0.009946107864379883
local_in_edges_tensor generation:  0.011819601058959961
mini_batch_src_global generation:  0.024123668670654297
r_  generation:  0.19631242752075195
local_output_nid generation:  0.009571313858032227
local_in_edges_tensor generation:  0.011512041091918945
mini_batch_src_global generation:  0.023188352584838867
r_  generation:  0.18300628662109375
----------------------check_connections_block total spend ----------------------------- 8.62658405303955
generate_one_block  0.24260735511779785
generate_one_block  0.23947930335998535
generate_one_block  0.24539589881896973
generate_one_block  0.2534828186035156
generate_one_block  0.27710437774658203
generate_one_block  0.243272066116333
generate_one_block  0.25762200355529785
generate_one_block  0.2586965560913086
generate_one_block  0.2560391426086426
generate_one_block  0.24692773818969727
generate_one_block  0.24947214126586914
generate_one_block  0.2432560920715332
generate_one_block  0.26174402236938477
generate_one_block  0.24704670906066895
generate_one_block  0.24177980422973633
generate_one_block  0.2388451099395752
generate_one_block  0.25483202934265137
generate_one_block  0.24283933639526367
generate_one_block  0.25760841369628906
generate_one_block  0.24285531044006348
generate_one_block  0.25085902214050293
generate_one_block  0.24634742736816406
generate_one_block  0.24922680854797363
generate_one_block  0.2582125663757324
generate_one_block  0.2538416385650635
generate_one_block  0.24834871292114258
generate_one_block  0.2597320079803467
generate_one_block  0.23446416854858398
generate_one_block  0.2391355037689209
generate_one_block  0.2575862407684326
generate_one_block  0.2664661407470703
generate_one_block  0.24467206001281738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04475069046020508
gen group dst list time:  0.10249018669128418
time for parepare:  0.018305301666259766
local_output_nid generation:  0.026320219039916992
local_in_edges_tensor generation:  0.038971900939941406
mini_batch_src_global generation:  0.04500889778137207
r_  generation:  0.48038363456726074
local_output_nid generation:  0.03208160400390625
local_in_edges_tensor generation:  0.04859185218811035
mini_batch_src_global generation:  0.05699968338012695
r_  generation:  0.48440051078796387
local_output_nid generation:  0.03155875205993652
local_in_edges_tensor generation:  0.04458498954772949
mini_batch_src_global generation:  0.05962347984313965
r_  generation:  0.494492769241333
local_output_nid generation:  0.03064703941345215
local_in_edges_tensor generation:  0.03540444374084473
mini_batch_src_global generation:  0.05766582489013672
r_  generation:  0.4917750358581543
local_output_nid generation:  0.03061532974243164
local_in_edges_tensor generation:  0.03497767448425293
mini_batch_src_global generation:  0.06136965751647949
r_  generation:  0.5018916130065918
local_output_nid generation:  0.030457258224487305
local_in_edges_tensor generation:  0.03106522560119629
mini_batch_src_global generation:  0.058279991149902344
r_  generation:  0.5022122859954834
local_output_nid generation:  0.03169989585876465
local_in_edges_tensor generation:  0.031653642654418945
mini_batch_src_global generation:  0.058568716049194336
r_  generation:  0.4999845027923584
local_output_nid generation:  0.031913042068481445
local_in_edges_tensor generation:  0.04467582702636719
mini_batch_src_global generation:  0.058791160583496094
r_  generation:  0.5005018711090088
local_output_nid generation:  0.030720233917236328
local_in_edges_tensor generation:  0.031389474868774414
mini_batch_src_global generation:  0.05905485153198242
r_  generation:  0.5109069347381592
local_output_nid generation:  0.03100275993347168
local_in_edges_tensor generation:  0.03511357307434082
mini_batch_src_global generation:  0.05993986129760742
r_  generation:  0.4988110065460205
local_output_nid generation:  0.03134942054748535
local_in_edges_tensor generation:  0.03631901741027832
mini_batch_src_global generation:  0.05944538116455078
r_  generation:  0.5013980865478516
local_output_nid generation:  0.03117823600769043
local_in_edges_tensor generation:  0.035573482513427734
mini_batch_src_global generation:  0.0627133846282959
r_  generation:  0.5034048557281494
local_output_nid generation:  0.030966997146606445
local_in_edges_tensor generation:  0.05053591728210449
mini_batch_src_global generation:  0.0578765869140625
r_  generation:  0.5032129287719727
local_output_nid generation:  0.03063344955444336
local_in_edges_tensor generation:  0.03500771522521973
mini_batch_src_global generation:  0.05926942825317383
r_  generation:  0.4995880126953125
local_output_nid generation:  0.03035449981689453
local_in_edges_tensor generation:  0.030860185623168945
mini_batch_src_global generation:  0.05888700485229492
r_  generation:  0.5011107921600342
local_output_nid generation:  0.031554222106933594
local_in_edges_tensor generation:  0.044801950454711914
mini_batch_src_global generation:  0.05866408348083496
r_  generation:  0.4943697452545166
local_output_nid generation:  0.030532360076904297
local_in_edges_tensor generation:  0.04389142990112305
mini_batch_src_global generation:  0.05799388885498047
r_  generation:  0.5012657642364502
local_output_nid generation:  0.03063511848449707
local_in_edges_tensor generation:  0.031517982482910156
mini_batch_src_global generation:  0.0590670108795166
r_  generation:  0.5036311149597168
local_output_nid generation:  0.03100442886352539
local_in_edges_tensor generation:  0.03535866737365723
mini_batch_src_global generation:  0.06245064735412598
r_  generation:  0.5037417411804199
local_output_nid generation:  0.030573368072509766
local_in_edges_tensor generation:  0.03147721290588379
mini_batch_src_global generation:  0.059903860092163086
r_  generation:  0.4990077018737793
local_output_nid generation:  0.031056642532348633
local_in_edges_tensor generation:  0.03568696975708008
mini_batch_src_global generation:  0.05926918983459473
r_  generation:  0.507631778717041
local_output_nid generation:  0.030878067016601562
local_in_edges_tensor generation:  0.04511618614196777
mini_batch_src_global generation:  0.06202578544616699
r_  generation:  0.4990673065185547
local_output_nid generation:  0.030824661254882812
local_in_edges_tensor generation:  0.03419089317321777
mini_batch_src_global generation:  0.05937075614929199
r_  generation:  0.5023443698883057
local_output_nid generation:  0.030992507934570312
local_in_edges_tensor generation:  0.0402984619140625
mini_batch_src_global generation:  0.058679819107055664
r_  generation:  0.5266687870025635
local_output_nid generation:  0.03182077407836914
local_in_edges_tensor generation:  0.04305529594421387
mini_batch_src_global generation:  0.061478376388549805
r_  generation:  0.504563570022583
local_output_nid generation:  0.031389474868774414
local_in_edges_tensor generation:  0.0362851619720459
mini_batch_src_global generation:  0.05883288383483887
r_  generation:  0.507957935333252
local_output_nid generation:  0.031166553497314453
local_in_edges_tensor generation:  0.03617668151855469
mini_batch_src_global generation:  0.0579533576965332
r_  generation:  0.5076882839202881
local_output_nid generation:  0.031197309494018555
local_in_edges_tensor generation:  0.033847808837890625
mini_batch_src_global generation:  0.058441877365112305
r_  generation:  0.49657440185546875
local_output_nid generation:  0.03127431869506836
local_in_edges_tensor generation:  0.03096175193786621
mini_batch_src_global generation:  0.05804276466369629
r_  generation:  0.5032749176025391
local_output_nid generation:  0.031343698501586914
local_in_edges_tensor generation:  0.044386863708496094
mini_batch_src_global generation:  0.060858964920043945
r_  generation:  0.5074672698974609
local_output_nid generation:  0.03169560432434082
local_in_edges_tensor generation:  0.03578948974609375
mini_batch_src_global generation:  0.06183815002441406
r_  generation:  0.5080459117889404
local_output_nid generation:  0.031844139099121094
local_in_edges_tensor generation:  0.03551936149597168
mini_batch_src_global generation:  0.05956912040710449
r_  generation:  0.5075571537017822
----------------------check_connections_block total spend ----------------------------- 23.597711324691772
generate_one_block  0.6936330795288086
generate_one_block  0.688880443572998
generate_one_block  0.6869246959686279
generate_one_block  0.6773366928100586
generate_one_block  0.7861101627349854
generate_one_block  0.6713693141937256
generate_one_block  0.6913528442382812
generate_one_block  0.689457893371582
generate_one_block  0.6700911521911621
generate_one_block  0.6806187629699707
generate_one_block  0.6736280918121338
generate_one_block  0.6824901103973389
generate_one_block  0.6998240947723389
generate_one_block  0.6736865043640137
generate_one_block  0.6666226387023926
generate_one_block  0.6686520576477051
generate_one_block  0.7013142108917236
generate_one_block  0.6902809143066406
generate_one_block  0.7289330959320068
generate_one_block  0.7466022968292236
generate_one_block  0.6943345069885254
generate_one_block  0.6912362575531006
generate_one_block  0.6813223361968994
generate_one_block  0.6849217414855957
generate_one_block  0.7162351608276367
generate_one_block  0.6887223720550537
generate_one_block  0.6841089725494385
generate_one_block  0.6817793846130371
generate_one_block  0.6737337112426758
generate_one_block  0.7132260799407959
generate_one_block  0.7025394439697266
generate_one_block  0.6833102703094482
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.11399459838867188  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

connection checking time:  32.22429537773132
block generation total time  30.173077821731567
average batch blocks generation time:  0.9429086819291115
block dataloader generation time/epoch 66.48814511299133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0922694206237793  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150341, 128])
torch.Size([109644, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.124281883239746  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09137725830078125  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149870, 128])
torch.Size([108902, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.081813335418701  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0922842025756836  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150243, 128])
torch.Size([109867, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.16780138015747  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0916604995727539  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149968, 128])
torch.Size([109569, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.218985080718994  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0923757553100586  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150224, 128])
torch.Size([109972, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.194943904876709  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09138679504394531  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149756, 128])
torch.Size([109129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.130385398864746  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09249591827392578  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150388, 128])
torch.Size([110256, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.293537616729736  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09204244613647461  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150623, 128])
torch.Size([110646, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.2864351272583  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0924825668334961  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150456, 128])
torch.Size([110190, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.250894546508789  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09194183349609375  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150580, 128])
torch.Size([110055, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.224059581756592  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0923309326171875  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150263, 128])
torch.Size([109432, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.132848262786865  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0919656753540039  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150852, 128])
torch.Size([110377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.167925834655762  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0925750732421875  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150094, 128])
torch.Size([109832, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.303053855895996  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09178018569946289  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150379, 128])
torch.Size([109860, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.183382987976074  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0922098159790039  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149715, 128])
torch.Size([109014, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.083106994628906  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09122753143310547  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149836, 128])
torch.Size([108578, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.00022029876709  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0923910140991211  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150336, 128])
torch.Size([109501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.187455177307129  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09141874313354492  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149911, 128])
torch.Size([109255, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.08705759048462  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09245967864990234  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150684, 128])
torch.Size([110516, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.258077621459961  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09137296676635742  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149973, 128])
torch.Size([108928, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.064555644989014  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09242439270019531  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150919, 128])
torch.Size([111045, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.25221300125122  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09169435501098633  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150337, 128])
torch.Size([109933, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.153557300567627  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0923309326171875  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150664, 128])
torch.Size([110183, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.170753479003906  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09196996688842773  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150445, 128])
torch.Size([110382, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.267611980438232  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09245681762695312  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150657, 128])
torch.Size([110612, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.265479564666748  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.0919489860534668  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150647, 128])
torch.Size([110630, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.213991165161133  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 0.09250354766845703  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150123, 128])
torch.Size([109743, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2869873046875 GB
    Memory Allocated: 14.272072792053223  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 0.09113693237304688  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([149792, 128])
torch.Size([108008, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 13.933333396911621  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 0.09214591979980469  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150400, 128])
torch.Size([109310, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 14.056199550628662  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 0.09184408187866211  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150173, 128])
torch.Size([110455, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 14.28734827041626  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 0.09265327453613281  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150424, 128])
torch.Size([110913, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 14.3822660446167  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 0.09187126159667969  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

torch.Size([150612, 128])
torch.Size([110780, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2889404296875 GB
    Memory Allocated: 14.197241306304932  GigaBytes
Max Memory Allocated: 14.410773277282715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03208500146865845 |0.024839505553245544 |0.6166269555687904 |0.00010604411363601685 |1.0523144528269768 |0.0055086612701416016 |
----------------------------------------------------------pseudo_mini_loss sum 3.7962558269500732
Total (block generation + training)time/epoch 121.85281491279602
Training time/epoch 55.364397287368774
Training time without block to device /epoch 54.56953310966492
Training time without total dataloading part /epoch 53.415027141571045
load block tensor time/epoch 1.0267200469970703
block to device time/epoch 0.7948641777038574
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9165130
Number of first layer input nodes during this epoch:  4809685
