Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648502530.7886255
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025063514709472656
random selection method range initialization spend 0.006245851516723633
time for parepare:  0.01819300651550293
local_output_nid generation:  0.001100778579711914
local_in_edges_tensor generation:  0.004100799560546875
mini_batch_src_global generation:  0.0014009475708007812
r_  generation:  0.008401155471801758
local_output_nid generation:  0.0012271404266357422
local_in_edges_tensor generation:  0.0010144710540771484
mini_batch_src_global generation:  0.001356363296508789
r_  generation:  0.00784158706665039
local_output_nid generation:  0.0012562274932861328
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0009438991546630859
r_  generation:  0.007738590240478516
local_output_nid generation:  0.0012934207916259766
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0008203983306884766
r_  generation:  0.007419586181640625
local_output_nid generation:  0.0013072490692138672
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.0008220672607421875
r_  generation:  0.008064985275268555
local_output_nid generation:  0.0013167858123779297
local_in_edges_tensor generation:  0.0008013248443603516
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.007886409759521484
local_output_nid generation:  0.0013341903686523438
local_in_edges_tensor generation:  0.0007903575897216797
mini_batch_src_global generation:  0.0008344650268554688
r_  generation:  0.007918357849121094
local_output_nid generation:  0.0013282299041748047
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.000797271728515625
r_  generation:  0.007735729217529297
local_output_nid generation:  0.0013270378112792969
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.0007693767547607422
r_  generation:  0.007786273956298828
local_output_nid generation:  0.0013344287872314453
local_in_edges_tensor generation:  0.0007655620574951172
mini_batch_src_global generation:  0.0008211135864257812
r_  generation:  0.007848024368286133
local_output_nid generation:  0.001352071762084961
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.0008020401000976562
r_  generation:  0.007907867431640625
local_output_nid generation:  0.0013439655303955078
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.008147478103637695
local_output_nid generation:  0.0013535022735595703
local_in_edges_tensor generation:  0.0007536411285400391
mini_batch_src_global generation:  0.0008099079132080078
r_  generation:  0.007845878601074219
local_output_nid generation:  0.0013513565063476562
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0008068084716796875
r_  generation:  0.007922887802124023
local_output_nid generation:  0.001333475112915039
local_in_edges_tensor generation:  0.0007441043853759766
mini_batch_src_global generation:  0.0008392333984375
r_  generation:  0.008258342742919922
local_output_nid generation:  0.0013308525085449219
local_in_edges_tensor generation:  0.000743865966796875
mini_batch_src_global generation:  0.0008516311645507812
r_  generation:  0.008069753646850586
local_output_nid generation:  0.0013442039489746094
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.007949113845825195
local_output_nid generation:  0.0013689994812011719
local_in_edges_tensor generation:  0.0007429122924804688
mini_batch_src_global generation:  0.0008232593536376953
r_  generation:  0.008239507675170898
local_output_nid generation:  0.0013442039489746094
local_in_edges_tensor generation:  0.0007431507110595703
mini_batch_src_global generation:  0.0008218288421630859
r_  generation:  0.008004188537597656
local_output_nid generation:  0.0013663768768310547
local_in_edges_tensor generation:  0.0007572174072265625
mini_batch_src_global generation:  0.0008146762847900391
r_  generation:  0.007899999618530273
local_output_nid generation:  0.0013577938079833984
local_in_edges_tensor generation:  0.0007293224334716797
mini_batch_src_global generation:  0.0008141994476318359
r_  generation:  0.008104562759399414
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0008246898651123047
r_  generation:  0.008155345916748047
local_output_nid generation:  0.0013568401336669922
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.0008218288421630859
r_  generation:  0.008314132690429688
local_output_nid generation:  0.0013489723205566406
local_in_edges_tensor generation:  0.0007443428039550781
mini_batch_src_global generation:  0.0008285045623779297
r_  generation:  0.007964372634887695
local_output_nid generation:  0.0013566017150878906
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.007890701293945312
local_output_nid generation:  0.0013539791107177734
local_in_edges_tensor generation:  0.0007386207580566406
mini_batch_src_global generation:  0.0007908344268798828
r_  generation:  0.007747173309326172
local_output_nid generation:  0.001344919204711914
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.0007970333099365234
r_  generation:  0.007894754409790039
local_output_nid generation:  0.0013394355773925781
local_in_edges_tensor generation:  0.0007202625274658203
mini_batch_src_global generation:  0.0009398460388183594
r_  generation:  0.008041858673095703
local_output_nid generation:  0.0013434886932373047
local_in_edges_tensor generation:  0.0007562637329101562
mini_batch_src_global generation:  0.0009708404541015625
r_  generation:  0.008209943771362305
local_output_nid generation:  0.0013468265533447266
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.008408784866333008
local_output_nid generation:  0.0013623237609863281
local_in_edges_tensor generation:  0.005221128463745117
mini_batch_src_global generation:  0.0011060237884521484
r_  generation:  0.008434057235717773
local_output_nid generation:  0.0012481212615966797
local_in_edges_tensor generation:  0.0007774829864501953
mini_batch_src_global generation:  0.0009360313415527344
r_  generation:  0.00791311264038086
----------------------check_connections_block total spend ----------------------------- 0.45752668380737305
generate_one_block  0.013822555541992188
generate_one_block  0.013642311096191406
generate_one_block  0.013149023056030273
generate_one_block  0.01275014877319336
generate_one_block  0.013451337814331055
generate_one_block  0.01326894760131836
generate_one_block  0.013251304626464844
generate_one_block  0.01291346549987793
generate_one_block  0.012815475463867188
generate_one_block  0.013259410858154297
generate_one_block  0.012925386428833008
generate_one_block  0.013340950012207031
generate_one_block  0.01281118392944336
generate_one_block  0.012918710708618164
generate_one_block  0.013287782669067383
generate_one_block  0.013243675231933594
generate_one_block  0.012900352478027344
generate_one_block  0.013274669647216797
generate_one_block  0.012788772583007812
generate_one_block  0.012892723083496094
generate_one_block  0.01314997673034668
generate_one_block  0.0129852294921875
generate_one_block  0.012984752655029297
generate_one_block  0.01280522346496582
generate_one_block  0.012820959091186523
generate_one_block  0.012553215026855469
generate_one_block  0.012885808944702148
generate_one_block  0.012916088104248047
generate_one_block  0.01316690444946289
generate_one_block  0.013463973999023438
generate_one_block  0.013613462448120117
generate_one_block  0.012796163558959961
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0432736873626709
gen group dst list time:  0.021262168884277344
time for parepare:  0.020123004913330078
local_output_nid generation:  0.004927873611450195
local_in_edges_tensor generation:  0.014540672302246094
mini_batch_src_global generation:  0.011652946472167969
r_  generation:  0.11799764633178711
local_output_nid generation:  0.009415149688720703
local_in_edges_tensor generation:  0.012690544128417969
mini_batch_src_global generation:  0.01626276969909668
r_  generation:  0.12874555587768555
local_output_nid generation:  0.009478330612182617
local_in_edges_tensor generation:  0.009183645248413086
mini_batch_src_global generation:  0.013529539108276367
r_  generation:  0.12993979454040527
local_output_nid generation:  0.009071826934814453
local_in_edges_tensor generation:  0.008829116821289062
mini_batch_src_global generation:  0.01428532600402832
r_  generation:  0.12845253944396973
local_output_nid generation:  0.009482622146606445
local_in_edges_tensor generation:  0.010365724563598633
mini_batch_src_global generation:  0.01569676399230957
r_  generation:  0.13855767250061035
local_output_nid generation:  0.009364128112792969
local_in_edges_tensor generation:  0.009187459945678711
mini_batch_src_global generation:  0.016473054885864258
r_  generation:  0.1406106948852539
local_output_nid generation:  0.00939321517944336
local_in_edges_tensor generation:  0.009484291076660156
mini_batch_src_global generation:  0.016543149948120117
r_  generation:  0.14086627960205078
local_output_nid generation:  0.009335994720458984
local_in_edges_tensor generation:  0.008057355880737305
mini_batch_src_global generation:  0.016312599182128906
r_  generation:  0.13675570487976074
local_output_nid generation:  0.009183406829833984
local_in_edges_tensor generation:  0.007967233657836914
mini_batch_src_global generation:  0.015941143035888672
r_  generation:  0.13532686233520508
local_output_nid generation:  0.00941014289855957
local_in_edges_tensor generation:  0.008084774017333984
mini_batch_src_global generation:  0.016451358795166016
r_  generation:  0.13823556900024414
local_output_nid generation:  0.009331703186035156
local_in_edges_tensor generation:  0.009251832962036133
mini_batch_src_global generation:  0.01624894142150879
r_  generation:  0.13622045516967773
local_output_nid generation:  0.009436607360839844
local_in_edges_tensor generation:  0.009334087371826172
mini_batch_src_global generation:  0.017488718032836914
r_  generation:  0.13892745971679688
local_output_nid generation:  0.009336233139038086
local_in_edges_tensor generation:  0.009008646011352539
mini_batch_src_global generation:  0.016875505447387695
r_  generation:  0.13487982749938965
local_output_nid generation:  0.009293556213378906
local_in_edges_tensor generation:  0.008887290954589844
mini_batch_src_global generation:  0.016489505767822266
r_  generation:  0.1367628574371338
local_output_nid generation:  0.009432077407836914
local_in_edges_tensor generation:  0.009067296981811523
mini_batch_src_global generation:  0.016554594039916992
r_  generation:  0.13792824745178223
local_output_nid generation:  0.009433746337890625
local_in_edges_tensor generation:  0.011545419692993164
mini_batch_src_global generation:  0.017141103744506836
r_  generation:  0.14103484153747559
local_output_nid generation:  0.009387969970703125
local_in_edges_tensor generation:  0.009020805358886719
mini_batch_src_global generation:  0.01712775230407715
r_  generation:  0.13634657859802246
local_output_nid generation:  0.009551048278808594
local_in_edges_tensor generation:  0.010308027267456055
mini_batch_src_global generation:  0.0170438289642334
r_  generation:  0.14250659942626953
local_output_nid generation:  0.012773513793945312
local_in_edges_tensor generation:  0.007950067520141602
mini_batch_src_global generation:  0.01659393310546875
r_  generation:  0.13534975051879883
local_output_nid generation:  0.009307622909545898
local_in_edges_tensor generation:  0.008585453033447266
mini_batch_src_global generation:  0.0162353515625
r_  generation:  0.13928508758544922
local_output_nid generation:  0.009280204772949219
local_in_edges_tensor generation:  0.010148048400878906
mini_batch_src_global generation:  0.01675105094909668
r_  generation:  0.13882040977478027
local_output_nid generation:  0.009314775466918945
local_in_edges_tensor generation:  0.009244918823242188
mini_batch_src_global generation:  0.0165407657623291
r_  generation:  0.14037680625915527
local_output_nid generation:  0.009379386901855469
local_in_edges_tensor generation:  0.010109901428222656
mini_batch_src_global generation:  0.016839265823364258
r_  generation:  0.1402900218963623
local_output_nid generation:  0.009360074996948242
local_in_edges_tensor generation:  0.0089874267578125
mini_batch_src_global generation:  0.016509056091308594
r_  generation:  0.14147210121154785
local_output_nid generation:  0.009458541870117188
local_in_edges_tensor generation:  0.009166955947875977
mini_batch_src_global generation:  0.017243385314941406
r_  generation:  0.14107871055603027
local_output_nid generation:  0.009095907211303711
local_in_edges_tensor generation:  0.007914543151855469
mini_batch_src_global generation:  0.016689777374267578
r_  generation:  0.1348094940185547
local_output_nid generation:  0.009277582168579102
local_in_edges_tensor generation:  0.007837533950805664
mini_batch_src_global generation:  0.016323328018188477
r_  generation:  0.13683700561523438
local_output_nid generation:  0.009301900863647461
local_in_edges_tensor generation:  0.00815582275390625
mini_batch_src_global generation:  0.01651620864868164
r_  generation:  0.14188241958618164
local_output_nid generation:  0.009523868560791016
local_in_edges_tensor generation:  0.009423971176147461
mini_batch_src_global generation:  0.01678180694580078
r_  generation:  0.14263701438903809
local_output_nid generation:  0.009609699249267578
local_in_edges_tensor generation:  0.010531425476074219
mini_batch_src_global generation:  0.018486738204956055
r_  generation:  0.14519429206848145
local_output_nid generation:  0.00979757308959961
local_in_edges_tensor generation:  0.00852203369140625
mini_batch_src_global generation:  0.017377138137817383
r_  generation:  0.14316534996032715
local_output_nid generation:  0.009319305419921875
local_in_edges_tensor generation:  0.008093118667602539
mini_batch_src_global generation:  0.01646709442138672
r_  generation:  0.13722515106201172
----------------------check_connections_block total spend ----------------------------- 6.559541463851929
generate_one_block  0.17232370376586914
generate_one_block  0.17383360862731934
generate_one_block  0.1900160312652588
generate_one_block  0.16833758354187012
generate_one_block  0.17763161659240723
generate_one_block  0.17713451385498047
generate_one_block  0.17526936531066895
generate_one_block  0.17314815521240234
generate_one_block  0.16536903381347656
generate_one_block  0.17023158073425293
generate_one_block  0.16877388954162598
generate_one_block  0.17450952529907227
generate_one_block  0.16939163208007812
generate_one_block  0.17023897171020508
generate_one_block  0.17723464965820312
generate_one_block  0.1805262565612793
generate_one_block  0.17631149291992188
generate_one_block  0.17829442024230957
generate_one_block  0.16874027252197266
generate_one_block  0.1707289218902588
generate_one_block  0.17383861541748047
generate_one_block  0.17627763748168945
generate_one_block  0.17428946495056152
generate_one_block  0.1706249713897705
generate_one_block  0.17458415031433105
generate_one_block  0.16830039024353027
generate_one_block  0.17082500457763672
generate_one_block  0.17171072959899902
generate_one_block  0.17978596687316895
generate_one_block  0.1883854866027832
generate_one_block  0.17992305755615234
generate_one_block  0.16868185997009277
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0670318603515625
gen group dst list time:  0.1064300537109375
time for parepare:  0.01900959014892578
local_output_nid generation:  0.02159571647644043
local_in_edges_tensor generation:  0.053150177001953125
mini_batch_src_global generation:  0.04368138313293457
r_  generation:  0.432600736618042
local_output_nid generation:  0.02765035629272461
local_in_edges_tensor generation:  0.046533823013305664
mini_batch_src_global generation:  0.0776071548461914
r_  generation:  0.44772934913635254
local_output_nid generation:  0.02771472930908203
local_in_edges_tensor generation:  0.03832411766052246
mini_batch_src_global generation:  0.06155681610107422
r_  generation:  0.45278429985046387
local_output_nid generation:  0.026747941970825195
local_in_edges_tensor generation:  0.0468592643737793
mini_batch_src_global generation:  0.05727553367614746
r_  generation:  0.44116759300231934
local_output_nid generation:  0.026192426681518555
local_in_edges_tensor generation:  0.04184556007385254
mini_batch_src_global generation:  0.053902626037597656
r_  generation:  0.4512045383453369
local_output_nid generation:  0.02599787712097168
local_in_edges_tensor generation:  0.04028439521789551
mini_batch_src_global generation:  0.05468463897705078
r_  generation:  0.4512472152709961
local_output_nid generation:  0.026104211807250977
local_in_edges_tensor generation:  0.032737016677856445
mini_batch_src_global generation:  0.0541231632232666
r_  generation:  0.4507100582122803
local_output_nid generation:  0.025815248489379883
local_in_edges_tensor generation:  0.03293204307556152
mini_batch_src_global generation:  0.05428934097290039
r_  generation:  0.4603245258331299
local_output_nid generation:  0.02603435516357422
local_in_edges_tensor generation:  0.029337644577026367
mini_batch_src_global generation:  0.053811073303222656
r_  generation:  0.4449338912963867
local_output_nid generation:  0.026139497756958008
local_in_edges_tensor generation:  0.03317594528198242
mini_batch_src_global generation:  0.05433797836303711
r_  generation:  0.4456033706665039
local_output_nid generation:  0.02588343620300293
local_in_edges_tensor generation:  0.04151105880737305
mini_batch_src_global generation:  0.053251028060913086
r_  generation:  0.4462456703186035
local_output_nid generation:  0.026091575622558594
local_in_edges_tensor generation:  0.03322267532348633
mini_batch_src_global generation:  0.057660579681396484
r_  generation:  0.45108819007873535
local_output_nid generation:  0.025921344757080078
local_in_edges_tensor generation:  0.03311324119567871
mini_batch_src_global generation:  0.05381608009338379
r_  generation:  0.45545244216918945
local_output_nid generation:  0.028801679611206055
local_in_edges_tensor generation:  0.029643774032592773
mini_batch_src_global generation:  0.058013200759887695
r_  generation:  0.4497981071472168
local_output_nid generation:  0.026726961135864258
local_in_edges_tensor generation:  0.03368020057678223
mini_batch_src_global generation:  0.0573270320892334
r_  generation:  0.4539368152618408
local_output_nid generation:  0.026746511459350586
local_in_edges_tensor generation:  0.03380775451660156
mini_batch_src_global generation:  0.058110952377319336
r_  generation:  0.4517500400543213
local_output_nid generation:  0.02680802345275879
local_in_edges_tensor generation:  0.038001298904418945
mini_batch_src_global generation:  0.05402112007141113
r_  generation:  0.4562692642211914
local_output_nid generation:  0.027090072631835938
local_in_edges_tensor generation:  0.03370809555053711
mini_batch_src_global generation:  0.05830121040344238
r_  generation:  0.45409274101257324
local_output_nid generation:  0.026634693145751953
local_in_edges_tensor generation:  0.030219078063964844
mini_batch_src_global generation:  0.05387735366821289
r_  generation:  0.4552626609802246
local_output_nid generation:  0.026743412017822266
local_in_edges_tensor generation:  0.029327392578125
mini_batch_src_global generation:  0.05493807792663574
r_  generation:  0.4464411735534668
local_output_nid generation:  0.026870250701904297
local_in_edges_tensor generation:  0.03320789337158203
mini_batch_src_global generation:  0.054583072662353516
r_  generation:  0.45530080795288086
local_output_nid generation:  0.027076005935668945
local_in_edges_tensor generation:  0.03382706642150879
mini_batch_src_global generation:  0.054862022399902344
r_  generation:  0.45017576217651367
local_output_nid generation:  0.02692890167236328
local_in_edges_tensor generation:  0.03323698043823242
mini_batch_src_global generation:  0.05384707450866699
r_  generation:  0.4569237232208252
local_output_nid generation:  0.02659773826599121
local_in_edges_tensor generation:  0.03358101844787598
mini_batch_src_global generation:  0.05443763732910156
r_  generation:  0.44896554946899414
local_output_nid generation:  0.028746843338012695
local_in_edges_tensor generation:  0.040557861328125
mini_batch_src_global generation:  0.055437326431274414
r_  generation:  0.45723676681518555
local_output_nid generation:  0.026517391204833984
local_in_edges_tensor generation:  0.028536558151245117
mini_batch_src_global generation:  0.05450320243835449
r_  generation:  0.4442734718322754
local_output_nid generation:  0.026675701141357422
local_in_edges_tensor generation:  0.03298497200012207
mini_batch_src_global generation:  0.05399894714355469
r_  generation:  0.45004725456237793
local_output_nid generation:  0.046427249908447266
local_in_edges_tensor generation:  0.04204821586608887
mini_batch_src_global generation:  0.05425286293029785
r_  generation:  0.4483675956726074
local_output_nid generation:  0.026766538619995117
local_in_edges_tensor generation:  0.03401541709899902
mini_batch_src_global generation:  0.05431318283081055
r_  generation:  0.4572939872741699
local_output_nid generation:  0.0269620418548584
local_in_edges_tensor generation:  0.03374624252319336
mini_batch_src_global generation:  0.05846071243286133
r_  generation:  0.4541008472442627
local_output_nid generation:  0.027006864547729492
local_in_edges_tensor generation:  0.02955317497253418
mini_batch_src_global generation:  0.05399155616760254
r_  generation:  0.4545571804046631
local_output_nid generation:  0.02658557891845703
local_in_edges_tensor generation:  0.029057979583740234
mini_batch_src_global generation:  0.0547943115234375
r_  generation:  0.45467710494995117
----------------------check_connections_block total spend ----------------------------- 21.284862279891968
generate_one_block  0.5907793045043945
generate_one_block  0.6752352714538574
generate_one_block  0.5684452056884766
generate_one_block  0.5736019611358643
generate_one_block  0.5869300365447998
generate_one_block  0.5857713222503662
generate_one_block  0.5808095932006836
generate_one_block  0.573756217956543
generate_one_block  0.5655195713043213
generate_one_block  0.580937385559082
generate_one_block  0.578472375869751
generate_one_block  0.584787130355835
generate_one_block  0.5769884586334229
generate_one_block  0.5790119171142578
generate_one_block  0.5837142467498779
generate_one_block  0.5810821056365967
generate_one_block  0.5811095237731934
generate_one_block  0.5901291370391846
generate_one_block  0.5666882991790771
generate_one_block  0.5709044933319092
generate_one_block  0.6003701686859131
generate_one_block  0.5859489440917969
generate_one_block  0.580488920211792
generate_one_block  0.5771853923797607
generate_one_block  0.5905485153198242
generate_one_block  0.5729563236236572
generate_one_block  0.580146074295044
generate_one_block  0.5861701965332031
generate_one_block  0.6427402496337891
generate_one_block  0.6385595798492432
generate_one_block  0.6075229644775391
generate_one_block  0.6070683002471924
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048377037048339844
gen group dst list time:  0.184523344039917
time for parepare:  0.020756244659423828
local_output_nid generation:  0.033348798751831055
local_in_edges_tensor generation:  0.06839323043823242
mini_batch_src_global generation:  0.049388885498046875
r_  generation:  0.5270407199859619
local_output_nid generation:  0.0405576229095459
local_in_edges_tensor generation:  0.05676984786987305
mini_batch_src_global generation:  0.06432390213012695
r_  generation:  0.544867992401123
local_output_nid generation:  0.041127920150756836
local_in_edges_tensor generation:  0.055612802505493164
mini_batch_src_global generation:  0.06500244140625
r_  generation:  0.5350236892700195
local_output_nid generation:  0.03788280487060547
local_in_edges_tensor generation:  0.04741525650024414
mini_batch_src_global generation:  0.05890655517578125
r_  generation:  0.5426909923553467
local_output_nid generation:  0.0377960205078125
local_in_edges_tensor generation:  0.04547762870788574
mini_batch_src_global generation:  0.05701637268066406
r_  generation:  0.5437672138214111
local_output_nid generation:  0.038225412368774414
local_in_edges_tensor generation:  0.04904890060424805
mini_batch_src_global generation:  0.06043124198913574
r_  generation:  0.5361981391906738
local_output_nid generation:  0.039125680923461914
local_in_edges_tensor generation:  0.03559994697570801
mini_batch_src_global generation:  0.05948972702026367
r_  generation:  0.54831862449646
local_output_nid generation:  0.0378720760345459
local_in_edges_tensor generation:  0.04394936561584473
mini_batch_src_global generation:  0.06018996238708496
r_  generation:  0.5428080558776855
local_output_nid generation:  0.03792238235473633
local_in_edges_tensor generation:  0.048938751220703125
mini_batch_src_global generation:  0.06311297416687012
r_  generation:  0.5647678375244141
local_output_nid generation:  0.03994464874267578
local_in_edges_tensor generation:  0.04839944839477539
mini_batch_src_global generation:  0.06650519371032715
r_  generation:  0.5446703433990479
local_output_nid generation:  0.03816390037536621
local_in_edges_tensor generation:  0.040097951889038086
mini_batch_src_global generation:  0.06005048751831055
r_  generation:  0.54974365234375
local_output_nid generation:  0.03808331489562988
local_in_edges_tensor generation:  0.040073394775390625
mini_batch_src_global generation:  0.05959510803222656
r_  generation:  0.558222770690918
local_output_nid generation:  0.037839412689208984
local_in_edges_tensor generation:  0.04584145545959473
mini_batch_src_global generation:  0.05976748466491699
r_  generation:  0.5545947551727295
local_output_nid generation:  0.03813886642456055
local_in_edges_tensor generation:  0.0363011360168457
mini_batch_src_global generation:  0.06084871292114258
r_  generation:  0.5486657619476318
local_output_nid generation:  0.03829693794250488
local_in_edges_tensor generation:  0.06029486656188965
mini_batch_src_global generation:  0.06039881706237793
r_  generation:  0.5537214279174805
local_output_nid generation:  0.03836345672607422
local_in_edges_tensor generation:  0.04393315315246582
mini_batch_src_global generation:  0.06399059295654297
r_  generation:  0.5478558540344238
local_output_nid generation:  0.038318634033203125
local_in_edges_tensor generation:  0.04793262481689453
mini_batch_src_global generation:  0.0634152889251709
r_  generation:  0.5516269207000732
local_output_nid generation:  0.039880990982055664
local_in_edges_tensor generation:  0.03616595268249512
mini_batch_src_global generation:  0.06090211868286133
r_  generation:  0.5480849742889404
local_output_nid generation:  0.03817176818847656
local_in_edges_tensor generation:  0.03376126289367676
mini_batch_src_global generation:  0.060776710510253906
r_  generation:  0.5523533821105957
local_output_nid generation:  0.03806877136230469
local_in_edges_tensor generation:  0.03472900390625
mini_batch_src_global generation:  0.06069183349609375
r_  generation:  0.5496444702148438
local_output_nid generation:  0.03829026222229004
local_in_edges_tensor generation:  0.0387270450592041
mini_batch_src_global generation:  0.05964016914367676
r_  generation:  0.5526771545410156
local_output_nid generation:  0.03808927536010742
local_in_edges_tensor generation:  0.051137685775756836
mini_batch_src_global generation:  0.06023073196411133
r_  generation:  0.5516958236694336
local_output_nid generation:  0.03819394111633301
local_in_edges_tensor generation:  0.03914666175842285
mini_batch_src_global generation:  0.059871673583984375
r_  generation:  0.5603702068328857
local_output_nid generation:  0.038527727127075195
local_in_edges_tensor generation:  0.04472804069519043
mini_batch_src_global generation:  0.06345105171203613
r_  generation:  0.5669422149658203
local_output_nid generation:  0.04020547866821289
local_in_edges_tensor generation:  0.04160332679748535
mini_batch_src_global generation:  0.07058906555175781
r_  generation:  0.5567779541015625
local_output_nid generation:  0.038134098052978516
local_in_edges_tensor generation:  0.04395580291748047
mini_batch_src_global generation:  0.06046557426452637
r_  generation:  0.547574520111084
local_output_nid generation:  0.038010358810424805
local_in_edges_tensor generation:  0.0381169319152832
mini_batch_src_global generation:  0.05969095230102539
r_  generation:  0.5523345470428467
local_output_nid generation:  0.038127899169921875
local_in_edges_tensor generation:  0.04316401481628418
mini_batch_src_global generation:  0.06370425224304199
r_  generation:  0.5462839603424072
local_output_nid generation:  0.03819847106933594
local_in_edges_tensor generation:  0.0386049747467041
mini_batch_src_global generation:  0.060846567153930664
r_  generation:  0.548914909362793
local_output_nid generation:  0.03779149055480957
local_in_edges_tensor generation:  0.03805088996887207
mini_batch_src_global generation:  0.06096315383911133
r_  generation:  0.5466997623443604
local_output_nid generation:  0.037996768951416016
local_in_edges_tensor generation:  0.03420519828796387
mini_batch_src_global generation:  0.060991764068603516
r_  generation:  0.5503084659576416
local_output_nid generation:  0.03785848617553711
local_in_edges_tensor generation:  0.03392982482910156
mini_batch_src_global generation:  0.06086421012878418
r_  generation:  0.5479640960693359
----------------------check_connections_block total spend ----------------------------- 26.267938137054443
generate_one_block  0.6780838966369629
generate_one_block  0.6654484272003174
generate_one_block  0.683527946472168
generate_one_block  0.67236328125
generate_one_block  0.6781048774719238
generate_one_block  0.6737446784973145
generate_one_block  0.672227144241333
generate_one_block  0.8101518154144287
generate_one_block  0.6719241142272949
generate_one_block  0.6972358226776123
generate_one_block  0.662090539932251
generate_one_block  0.6710257530212402
generate_one_block  0.6808557510375977
generate_one_block  0.663179874420166
generate_one_block  0.6701641082763672
generate_one_block  0.6806640625
generate_one_block  0.6905848979949951
generate_one_block  0.6699447631835938
generate_one_block  0.6662545204162598
generate_one_block  0.6620688438415527
generate_one_block  0.6885852813720703
generate_one_block  0.6870098114013672
generate_one_block  0.673377275466919
generate_one_block  0.6704142093658447
generate_one_block  0.6780941486358643
generate_one_block  0.6772913932800293
generate_one_block  0.6628365516662598
generate_one_block  0.6921758651733398
generate_one_block  0.6823337078094482
generate_one_block  0.6724579334259033
generate_one_block  0.6825475692749023
generate_one_block  0.6803848743438721
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04878354072570801
gen group dst list time:  0.20782876014709473
time for parepare:  0.01915907859802246
local_output_nid generation:  0.03707432746887207
local_in_edges_tensor generation:  0.04967617988586426
mini_batch_src_global generation:  0.04460620880126953
r_  generation:  0.4950547218322754
local_output_nid generation:  0.04285264015197754
local_in_edges_tensor generation:  0.035077571868896484
mini_batch_src_global generation:  0.0573880672454834
r_  generation:  0.5013201236724854
local_output_nid generation:  0.042136192321777344
local_in_edges_tensor generation:  0.03437542915344238
mini_batch_src_global generation:  0.057074785232543945
r_  generation:  0.5070517063140869
local_output_nid generation:  0.041275978088378906
local_in_edges_tensor generation:  0.038031816482543945
mini_batch_src_global generation:  0.05898642539978027
r_  generation:  0.5047695636749268
local_output_nid generation:  0.04001450538635254
local_in_edges_tensor generation:  0.0350797176361084
mini_batch_src_global generation:  0.05622053146362305
r_  generation:  0.5043153762817383
local_output_nid generation:  0.042340755462646484
local_in_edges_tensor generation:  0.03513050079345703
mini_batch_src_global generation:  0.05638694763183594
r_  generation:  0.5082740783691406
local_output_nid generation:  0.03965044021606445
local_in_edges_tensor generation:  0.04487109184265137
mini_batch_src_global generation:  0.056725502014160156
r_  generation:  0.5087664127349854
local_output_nid generation:  0.039778947830200195
local_in_edges_tensor generation:  0.03949761390686035
mini_batch_src_global generation:  0.05631446838378906
r_  generation:  0.5101914405822754
local_output_nid generation:  0.03985333442687988
local_in_edges_tensor generation:  0.04803586006164551
mini_batch_src_global generation:  0.056067705154418945
r_  generation:  0.5125653743743896
local_output_nid generation:  0.03970170021057129
local_in_edges_tensor generation:  0.0432584285736084
mini_batch_src_global generation:  0.05947422981262207
r_  generation:  0.5100319385528564
local_output_nid generation:  0.03954482078552246
local_in_edges_tensor generation:  0.03484606742858887
mini_batch_src_global generation:  0.05650591850280762
r_  generation:  0.5148727893829346
local_output_nid generation:  0.039655447006225586
local_in_edges_tensor generation:  0.03878355026245117
mini_batch_src_global generation:  0.05651688575744629
r_  generation:  0.5160315036773682
local_output_nid generation:  0.03951764106750488
local_in_edges_tensor generation:  0.03511190414428711
mini_batch_src_global generation:  0.05668759346008301
r_  generation:  0.5171151161193848
local_output_nid generation:  0.03962898254394531
local_in_edges_tensor generation:  0.03914141654968262
mini_batch_src_global generation:  0.05930209159851074
r_  generation:  0.5249216556549072
local_output_nid generation:  0.03942394256591797
local_in_edges_tensor generation:  0.035660505294799805
mini_batch_src_global generation:  0.056230783462524414
r_  generation:  0.5244400501251221
local_output_nid generation:  0.03968024253845215
local_in_edges_tensor generation:  0.039278268814086914
mini_batch_src_global generation:  0.0597686767578125
r_  generation:  0.5262064933776855
local_output_nid generation:  0.03968358039855957
local_in_edges_tensor generation:  0.04845738410949707
mini_batch_src_global generation:  0.059778451919555664
r_  generation:  0.529010534286499
local_output_nid generation:  0.03985261917114258
local_in_edges_tensor generation:  0.04392504692077637
mini_batch_src_global generation:  0.05649447441101074
r_  generation:  0.5223233699798584
local_output_nid generation:  0.04015088081359863
local_in_edges_tensor generation:  0.03886914253234863
mini_batch_src_global generation:  0.056464195251464844
r_  generation:  0.5193493366241455
local_output_nid generation:  0.03968405723571777
local_in_edges_tensor generation:  0.0368800163269043
mini_batch_src_global generation:  0.05613517761230469
r_  generation:  0.5182418823242188
local_output_nid generation:  0.03943443298339844
local_in_edges_tensor generation:  0.035446882247924805
mini_batch_src_global generation:  0.059476613998413086
r_  generation:  0.5204999446868896
local_output_nid generation:  0.04056239128112793
local_in_edges_tensor generation:  0.04383444786071777
mini_batch_src_global generation:  0.0573277473449707
r_  generation:  0.5207195281982422
local_output_nid generation:  0.0397336483001709
local_in_edges_tensor generation:  0.03876018524169922
mini_batch_src_global generation:  0.05671358108520508
r_  generation:  0.5225913524627686
local_output_nid generation:  0.03962898254394531
local_in_edges_tensor generation:  0.03661060333251953
mini_batch_src_global generation:  0.05681490898132324
r_  generation:  0.5198769569396973
local_output_nid generation:  0.03977632522583008
local_in_edges_tensor generation:  0.03928685188293457
mini_batch_src_global generation:  0.05697941780090332
r_  generation:  0.523439884185791
local_output_nid generation:  0.03976583480834961
local_in_edges_tensor generation:  0.0443117618560791
mini_batch_src_global generation:  0.057131052017211914
r_  generation:  0.5254275798797607
local_output_nid generation:  0.0397794246673584
local_in_edges_tensor generation:  0.03920245170593262
mini_batch_src_global generation:  0.05739903450012207
r_  generation:  0.5211532115936279
local_output_nid generation:  0.0396113395690918
local_in_edges_tensor generation:  0.048345327377319336
mini_batch_src_global generation:  0.060265541076660156
r_  generation:  0.5276694297790527
local_output_nid generation:  0.03966951370239258
local_in_edges_tensor generation:  0.03938865661621094
mini_batch_src_global generation:  0.05777740478515625
r_  generation:  0.5264897346496582
local_output_nid generation:  0.03956961631774902
local_in_edges_tensor generation:  0.038745880126953125
mini_batch_src_global generation:  0.06036782264709473
r_  generation:  0.5232164859771729
local_output_nid generation:  0.04009604454040527
local_in_edges_tensor generation:  0.03552389144897461
mini_batch_src_global generation:  0.05623912811279297
r_  generation:  0.5252759456634521
local_output_nid generation:  0.04007577896118164
local_in_edges_tensor generation:  0.03489398956298828
mini_batch_src_global generation:  0.057257652282714844
r_  generation:  0.5212466716766357
----------------------check_connections_block total spend ----------------------------- 24.90110683441162
generate_one_block  0.6313786506652832
generate_one_block  0.6345019340515137
generate_one_block  0.6408998966217041
generate_one_block  0.6352493762969971
generate_one_block  0.6261966228485107
generate_one_block  0.632965087890625
generate_one_block  0.628662109375
generate_one_block  0.6463644504547119
generate_one_block  0.64841628074646
generate_one_block  0.6487307548522949
generate_one_block  0.63165283203125
generate_one_block  0.6398015022277832
generate_one_block  0.6251828670501709
generate_one_block  0.7651455402374268
generate_one_block  0.6236560344696045
generate_one_block  0.6232740879058838
generate_one_block  0.6507794857025146
generate_one_block  0.6414055824279785
generate_one_block  0.6222810745239258
generate_one_block  0.621497631072998
generate_one_block  0.6369690895080566
generate_one_block  0.6442906856536865
generate_one_block  0.6599564552307129
generate_one_block  0.6405348777770996
generate_one_block  0.654526948928833
generate_one_block  0.6404094696044922
generate_one_block  0.6314964294433594
generate_one_block  0.6470737457275391
generate_one_block  0.6430380344390869
generate_one_block  0.6482212543487549
generate_one_block  0.6468257904052734
generate_one_block  0.6377897262573242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

connection checking time:  79.01344871520996
block generation total time  66.73597979545593
average batch blocks generation time:  2.085499368607998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.11813163757324219  GigaBytes
Max Memory Allocated: 0.11813163757324219  GigaBytes

torch.Size([165056, 128])
torch.Size([160917, 64])
torch.Size([147111, 64])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 22.36 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
