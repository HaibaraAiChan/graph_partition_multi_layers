Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648454345.9078977
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02744460105895996
random selection method range initialization spend 0.0065152645111083984
time for parepare:  0.01889204978942871
local_output_nid generation:  0.0011279582977294922
local_in_edges_tensor generation:  0.00403141975402832
mini_batch_src_global generation:  0.0015888214111328125
r_  generation:  0.010455846786499023
local_output_nid generation:  0.0013661384582519531
local_in_edges_tensor generation:  0.0010182857513427734
mini_batch_src_global generation:  0.0015399456024169922
r_  generation:  0.009274721145629883
local_output_nid generation:  0.0014319419860839844
local_in_edges_tensor generation:  0.0009090900421142578
mini_batch_src_global generation:  0.0010600090026855469
r_  generation:  0.00932621955871582
local_output_nid generation:  0.0014488697052001953
local_in_edges_tensor generation:  0.0008454322814941406
mini_batch_src_global generation:  0.0009667873382568359
r_  generation:  0.009139537811279297
local_output_nid generation:  0.0014493465423583984
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0009241104125976562
r_  generation:  0.009334087371826172
local_output_nid generation:  0.0014362335205078125
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.009724140167236328
local_output_nid generation:  0.001453399658203125
local_in_edges_tensor generation:  0.0008060932159423828
mini_batch_src_global generation:  0.0009665489196777344
r_  generation:  0.009700536727905273
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0009722709655761719
r_  generation:  0.010065317153930664
local_output_nid generation:  0.0014500617980957031
local_in_edges_tensor generation:  0.0007882118225097656
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.009883403778076172
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0007891654968261719
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.009930133819580078
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0010364055633544922
r_  generation:  0.01012277603149414
local_output_nid generation:  0.0014498233795166016
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0009620189666748047
r_  generation:  0.009716987609863281
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.0009779930114746094
r_  generation:  0.009589195251464844
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.009575128555297852
local_output_nid generation:  0.0014495849609375
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.0010924339294433594
r_  generation:  0.010180950164794922
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0007734298706054688
mini_batch_src_global generation:  0.0009908676147460938
r_  generation:  0.009994745254516602
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0009760856628417969
r_  generation:  0.009582996368408203
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0009815692901611328
r_  generation:  0.010192394256591797
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0008184909820556641
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.010100126266479492
local_output_nid generation:  0.0014638900756835938
local_in_edges_tensor generation:  0.0007925033569335938
mini_batch_src_global generation:  0.0010428428649902344
r_  generation:  0.010357379913330078
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.009749174118041992
local_output_nid generation:  0.0014567375183105469
local_in_edges_tensor generation:  0.0007662773132324219
mini_batch_src_global generation:  0.0009734630584716797
r_  generation:  0.00971364974975586
local_output_nid generation:  0.0014433860778808594
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0009746551513671875
r_  generation:  0.009743213653564453
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.00987696647644043
local_output_nid generation:  0.0014483928680419922
local_in_edges_tensor generation:  0.0007970333099365234
mini_batch_src_global generation:  0.0010294914245605469
r_  generation:  0.009949922561645508
local_output_nid generation:  0.001447439193725586
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.000997304916381836
r_  generation:  0.009857416152954102
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.0008089542388916016
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.009788990020751953
local_output_nid generation:  0.0014619827270507812
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0009722709655761719
r_  generation:  0.009454488754272461
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.0007734298706054688
mini_batch_src_global generation:  0.0009908676147460938
r_  generation:  0.00966644287109375
local_output_nid generation:  0.0014429092407226562
local_in_edges_tensor generation:  0.005529165267944336
mini_batch_src_global generation:  0.0012428760528564453
r_  generation:  0.009718894958496094
local_output_nid generation:  0.0013155937194824219
local_in_edges_tensor generation:  0.0008172988891601562
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.009992599487304688
local_output_nid generation:  0.0013620853424072266
local_in_edges_tensor generation:  0.0008072853088378906
mini_batch_src_global generation:  0.0010516643524169922
r_  generation:  0.009631156921386719
----------------------check_connections_block total spend ----------------------------- 0.5341188907623291
generate_one_block  0.015151262283325195
generate_one_block  0.014301776885986328
generate_one_block  0.014945507049560547
generate_one_block  0.01467132568359375
generate_one_block  0.01477193832397461
generate_one_block  0.014967203140258789
generate_one_block  0.014875411987304688
generate_one_block  0.015498638153076172
generate_one_block  0.015291213989257812
generate_one_block  0.015413045883178711
generate_one_block  0.01493072509765625
generate_one_block  0.014237165451049805
generate_one_block  0.014343976974487305
generate_one_block  0.01461029052734375
generate_one_block  0.015318155288696289
generate_one_block  0.014767169952392578
generate_one_block  0.014325141906738281
generate_one_block  0.014618635177612305
generate_one_block  0.015298128128051758
generate_one_block  0.015408992767333984
generate_one_block  0.014768600463867188
generate_one_block  0.014402151107788086
generate_one_block  0.014388561248779297
generate_one_block  0.014487028121948242
generate_one_block  0.015003442764282227
generate_one_block  0.014587640762329102
generate_one_block  0.014503240585327148
generate_one_block  0.01404881477355957
generate_one_block  0.014167547225952148
generate_one_block  0.014364957809448242
generate_one_block  0.015197515487670898
generate_one_block  0.014151334762573242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041741371154785156
gen group dst list time:  0.024038076400756836
time for parepare:  0.01875162124633789
local_output_nid generation:  0.004950523376464844
local_in_edges_tensor generation:  0.012993335723876953
mini_batch_src_global generation:  0.013437032699584961
r_  generation:  0.12891793251037598
local_output_nid generation:  0.0081329345703125
local_in_edges_tensor generation:  0.01257181167602539
mini_batch_src_global generation:  0.01621079444885254
r_  generation:  0.13218069076538086
local_output_nid generation:  0.007913351058959961
local_in_edges_tensor generation:  0.010329484939575195
mini_batch_src_global generation:  0.015565872192382812
r_  generation:  0.14212942123413086
local_output_nid generation:  0.00787043571472168
local_in_edges_tensor generation:  0.011755943298339844
mini_batch_src_global generation:  0.01624298095703125
r_  generation:  0.14132165908813477
local_output_nid generation:  0.007935523986816406
local_in_edges_tensor generation:  0.009284734725952148
mini_batch_src_global generation:  0.018625974655151367
r_  generation:  0.14589333534240723
local_output_nid generation:  0.007908105850219727
local_in_edges_tensor generation:  0.009263277053833008
mini_batch_src_global generation:  0.018256425857543945
r_  generation:  0.14782333374023438
local_output_nid generation:  0.008060216903686523
local_in_edges_tensor generation:  0.010714054107666016
mini_batch_src_global generation:  0.01889491081237793
r_  generation:  0.1492609977722168
local_output_nid generation:  0.008208990097045898
local_in_edges_tensor generation:  0.012009143829345703
mini_batch_src_global generation:  0.022461891174316406
r_  generation:  0.157073974609375
local_output_nid generation:  0.008047342300415039
local_in_edges_tensor generation:  0.008338451385498047
mini_batch_src_global generation:  0.021526098251342773
r_  generation:  0.14984536170959473
local_output_nid generation:  0.008063554763793945
local_in_edges_tensor generation:  0.008199453353881836
mini_batch_src_global generation:  0.021420717239379883
r_  generation:  0.15160417556762695
local_output_nid generation:  0.008026123046875
local_in_edges_tensor generation:  0.011660099029541016
mini_batch_src_global generation:  0.021367788314819336
r_  generation:  0.1532301902770996
local_output_nid generation:  0.0077970027923583984
local_in_edges_tensor generation:  0.008092403411865234
mini_batch_src_global generation:  0.02053976058959961
r_  generation:  0.14323902130126953
local_output_nid generation:  0.007792234420776367
local_in_edges_tensor generation:  0.00790715217590332
mini_batch_src_global generation:  0.01814436912536621
r_  generation:  0.14605426788330078
local_output_nid generation:  0.007883548736572266
local_in_edges_tensor generation:  0.008044242858886719
mini_batch_src_global generation:  0.018700599670410156
r_  generation:  0.14825201034545898
local_output_nid generation:  0.008224248886108398
local_in_edges_tensor generation:  0.00960087776184082
mini_batch_src_global generation:  0.020804405212402344
r_  generation:  0.1575019359588623
local_output_nid generation:  0.007963418960571289
local_in_edges_tensor generation:  0.010634660720825195
mini_batch_src_global generation:  0.01930379867553711
r_  generation:  0.1508486270904541
local_output_nid generation:  0.007898807525634766
local_in_edges_tensor generation:  0.007760524749755859
mini_batch_src_global generation:  0.01862025260925293
r_  generation:  0.14997005462646484
local_output_nid generation:  0.008076190948486328
local_in_edges_tensor generation:  0.008711576461791992
mini_batch_src_global generation:  0.018792152404785156
r_  generation:  0.15298151969909668
local_output_nid generation:  0.008144617080688477
local_in_edges_tensor generation:  0.011859893798828125
mini_batch_src_global generation:  0.020824193954467773
r_  generation:  0.1530745029449463
local_output_nid generation:  0.008256912231445312
local_in_edges_tensor generation:  0.010647773742675781
mini_batch_src_global generation:  0.019663572311401367
r_  generation:  0.15422868728637695
local_output_nid generation:  0.008142471313476562
local_in_edges_tensor generation:  0.010746479034423828
mini_batch_src_global generation:  0.01927947998046875
r_  generation:  0.15328192710876465
local_output_nid generation:  0.007908344268798828
local_in_edges_tensor generation:  0.008033037185668945
mini_batch_src_global generation:  0.018567323684692383
r_  generation:  0.14815831184387207
local_output_nid generation:  0.007901906967163086
local_in_edges_tensor generation:  0.008101940155029297
mini_batch_src_global generation:  0.018343687057495117
r_  generation:  0.1468520164489746
local_output_nid generation:  0.008002281188964844
local_in_edges_tensor generation:  0.008129596710205078
mini_batch_src_global generation:  0.01957392692565918
r_  generation:  0.151322603225708
local_output_nid generation:  0.008063316345214844
local_in_edges_tensor generation:  0.009443998336791992
mini_batch_src_global generation:  0.02020859718322754
r_  generation:  0.15224409103393555
local_output_nid generation:  0.008019685745239258
local_in_edges_tensor generation:  0.008237838745117188
mini_batch_src_global generation:  0.01888585090637207
r_  generation:  0.15517449378967285
local_output_nid generation:  0.008016824722290039
local_in_edges_tensor generation:  0.008033514022827148
mini_batch_src_global generation:  0.018994808197021484
r_  generation:  0.15088152885437012
local_output_nid generation:  0.007845401763916016
local_in_edges_tensor generation:  0.008043050765991211
mini_batch_src_global generation:  0.018324613571166992
r_  generation:  0.1459040641784668
local_output_nid generation:  0.007871866226196289
local_in_edges_tensor generation:  0.007969141006469727
mini_batch_src_global generation:  0.018743515014648438
r_  generation:  0.14733529090881348
local_output_nid generation:  0.007917642593383789
local_in_edges_tensor generation:  0.009167671203613281
mini_batch_src_global generation:  0.017956972122192383
r_  generation:  0.1497342586517334
local_output_nid generation:  0.008185625076293945
local_in_edges_tensor generation:  0.010744571685791016
mini_batch_src_global generation:  0.018842697143554688
r_  generation:  0.15426015853881836
local_output_nid generation:  0.007742643356323242
local_in_edges_tensor generation:  0.008100032806396484
mini_batch_src_global generation:  0.01842355728149414
r_  generation:  0.14931440353393555
----------------------check_connections_block total spend ----------------------------- 7.0378735065460205
generate_one_block  0.18396615982055664
generate_one_block  0.17991113662719727
generate_one_block  0.21240711212158203
generate_one_block  0.1861119270324707
generate_one_block  0.18894004821777344
generate_one_block  0.19101381301879883
generate_one_block  0.19250202178955078
generate_one_block  0.19506311416625977
generate_one_block  0.18593192100524902
generate_one_block  0.19237136840820312
generate_one_block  0.19212913513183594
generate_one_block  0.17847776412963867
generate_one_block  0.18068981170654297
generate_one_block  0.1888425350189209
generate_one_block  0.20221519470214844
generate_one_block  0.21184158325195312
generate_one_block  0.18397021293640137
generate_one_block  0.1906139850616455
generate_one_block  0.20061588287353516
generate_one_block  0.19722652435302734
generate_one_block  0.19214940071105957
generate_one_block  0.1818251609802246
generate_one_block  0.1813368797302246
generate_one_block  0.19099926948547363
generate_one_block  0.19347143173217773
generate_one_block  0.1869204044342041
generate_one_block  0.18648386001586914
generate_one_block  0.17930865287780762
generate_one_block  0.18198871612548828
generate_one_block  0.18508195877075195
generate_one_block  0.19545841217041016
generate_one_block  0.18317127227783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03679966926574707
gen group dst list time:  0.09590363502502441
time for parepare:  0.018751859664916992
local_output_nid generation:  0.02116847038269043
local_in_edges_tensor generation:  0.03441500663757324
mini_batch_src_global generation:  0.03681063652038574
r_  generation:  0.38903093338012695
local_output_nid generation:  0.02761387825012207
local_in_edges_tensor generation:  0.04244089126586914
mini_batch_src_global generation:  0.04646801948547363
r_  generation:  0.39525890350341797
local_output_nid generation:  0.02824711799621582
local_in_edges_tensor generation:  0.039069175720214844
mini_batch_src_global generation:  0.04643416404724121
r_  generation:  0.40150952339172363
local_output_nid generation:  0.026380300521850586
local_in_edges_tensor generation:  0.03885960578918457
mini_batch_src_global generation:  0.04770040512084961
r_  generation:  0.4081149101257324
local_output_nid generation:  0.026147127151489258
local_in_edges_tensor generation:  0.0312192440032959
mini_batch_src_global generation:  0.04801011085510254
r_  generation:  0.4052407741546631
local_output_nid generation:  0.026147842407226562
local_in_edges_tensor generation:  0.0350034236907959
mini_batch_src_global generation:  0.05064082145690918
r_  generation:  0.40453481674194336
local_output_nid generation:  0.026735305786132812
local_in_edges_tensor generation:  0.031241178512573242
mini_batch_src_global generation:  0.04797649383544922
r_  generation:  0.4121377468109131
local_output_nid generation:  0.02689075469970703
local_in_edges_tensor generation:  0.031015634536743164
mini_batch_src_global generation:  0.05297708511352539
r_  generation:  0.40633440017700195
local_output_nid generation:  0.026532411575317383
local_in_edges_tensor generation:  0.027569055557250977
mini_batch_src_global generation:  0.05054616928100586
r_  generation:  0.4106266498565674
local_output_nid generation:  0.0269927978515625
local_in_edges_tensor generation:  0.04055476188659668
mini_batch_src_global generation:  0.049553632736206055
r_  generation:  0.41375255584716797
local_output_nid generation:  0.027924537658691406
local_in_edges_tensor generation:  0.03766226768493652
mini_batch_src_global generation:  0.06979560852050781
r_  generation:  0.4197554588317871
local_output_nid generation:  0.029469013214111328
local_in_edges_tensor generation:  0.031923770904541016
mini_batch_src_global generation:  0.05135703086853027
r_  generation:  0.4016289710998535
local_output_nid generation:  0.02739238739013672
local_in_edges_tensor generation:  0.024893760681152344
mini_batch_src_global generation:  0.04837203025817871
r_  generation:  0.406219482421875
local_output_nid generation:  0.027205228805541992
local_in_edges_tensor generation:  0.03232598304748535
mini_batch_src_global generation:  0.06043243408203125
r_  generation:  0.4069061279296875
local_output_nid generation:  0.027175426483154297
local_in_edges_tensor generation:  0.03343558311462402
mini_batch_src_global generation:  0.048900604248046875
r_  generation:  0.4152069091796875
local_output_nid generation:  0.027264833450317383
local_in_edges_tensor generation:  0.037648677825927734
mini_batch_src_global generation:  0.05031538009643555
r_  generation:  0.41152000427246094
local_output_nid generation:  0.027842044830322266
local_in_edges_tensor generation:  0.025197982788085938
mini_batch_src_global generation:  0.04803133010864258
r_  generation:  0.40681910514831543
local_output_nid generation:  0.027370929718017578
local_in_edges_tensor generation:  0.02801680564880371
mini_batch_src_global generation:  0.05185723304748535
r_  generation:  0.4104166030883789
local_output_nid generation:  0.02726888656616211
local_in_edges_tensor generation:  0.025973796844482422
mini_batch_src_global generation:  0.048159122467041016
r_  generation:  0.4110550880432129
local_output_nid generation:  0.02746415138244629
local_in_edges_tensor generation:  0.032413482666015625
mini_batch_src_global generation:  0.04819440841674805
r_  generation:  0.409747838973999
local_output_nid generation:  0.027573823928833008
local_in_edges_tensor generation:  0.025679826736450195
mini_batch_src_global generation:  0.0482938289642334
r_  generation:  0.41593289375305176
local_output_nid generation:  0.027236223220825195
local_in_edges_tensor generation:  0.03225207328796387
mini_batch_src_global generation:  0.04830002784729004
r_  generation:  0.40247654914855957
local_output_nid generation:  0.027138948440551758
local_in_edges_tensor generation:  0.03290843963623047
mini_batch_src_global generation:  0.047597646713256836
r_  generation:  0.41248393058776855
local_output_nid generation:  0.02718210220336914
local_in_edges_tensor generation:  0.03551030158996582
mini_batch_src_global generation:  0.050665855407714844
r_  generation:  0.40795350074768066
local_output_nid generation:  0.027562856674194336
local_in_edges_tensor generation:  0.03257489204406738
mini_batch_src_global generation:  0.0482180118560791
r_  generation:  0.41692161560058594
local_output_nid generation:  0.027455806732177734
local_in_edges_tensor generation:  0.0323331356048584
mini_batch_src_global generation:  0.048267364501953125
r_  generation:  0.41410255432128906
local_output_nid generation:  0.028131484985351562
local_in_edges_tensor generation:  0.024932384490966797
mini_batch_src_global generation:  0.04801487922668457
r_  generation:  0.4140894412994385
local_output_nid generation:  0.027029037475585938
local_in_edges_tensor generation:  0.02479076385498047
mini_batch_src_global generation:  0.04809069633483887
r_  generation:  0.4050004482269287
local_output_nid generation:  0.026927709579467773
local_in_edges_tensor generation:  0.028037548065185547
mini_batch_src_global generation:  0.050405263900756836
r_  generation:  0.41295289993286133
local_output_nid generation:  0.027330636978149414
local_in_edges_tensor generation:  0.03211069107055664
mini_batch_src_global generation:  0.04825878143310547
r_  generation:  0.40842270851135254
local_output_nid generation:  0.02764582633972168
local_in_edges_tensor generation:  0.03587698936462402
mini_batch_src_global generation:  0.0487513542175293
r_  generation:  0.41693925857543945
local_output_nid generation:  0.027025222778320312
local_in_edges_tensor generation:  0.025965213775634766
mini_batch_src_global generation:  0.04838395118713379
r_  generation:  0.4041614532470703
----------------------check_connections_block total spend ----------------------------- 19.43126106262207
generate_one_block  0.6209497451782227
generate_one_block  0.5174157619476318
generate_one_block  0.5501449108123779
generate_one_block  0.5339703559875488
generate_one_block  0.5247857570648193
generate_one_block  0.5306205749511719
generate_one_block  0.5303514003753662
generate_one_block  0.5286993980407715
generate_one_block  0.5214850902557373
generate_one_block  0.5217537879943848
generate_one_block  0.5394566059112549
generate_one_block  0.5136909484863281
generate_one_block  0.5106539726257324
generate_one_block  0.5217056274414062
generate_one_block  0.5466241836547852
generate_one_block  0.5277676582336426
generate_one_block  0.5186331272125244
generate_one_block  0.5165636539459229
generate_one_block  0.5316205024719238
generate_one_block  0.5429716110229492
generate_one_block  0.5510632991790771
generate_one_block  0.5215075016021729
generate_one_block  0.5160503387451172
generate_one_block  0.5247716903686523
generate_one_block  0.5252737998962402
generate_one_block  0.5288934707641602
generate_one_block  0.5226800441741943
generate_one_block  0.5254638195037842
generate_one_block  0.533797025680542
generate_one_block  0.5379633903503418
generate_one_block  0.5374417304992676
generate_one_block  0.5199148654937744
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  26.46913456916809
block generation total time  23.06772232055664
average batch blocks generation time:  0.720866322517395
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08383798599243164  GigaBytes
Max Memory Allocated: 0.08383798599243164  GigaBytes

torch.Size([145788, 128])
torch.Size([101249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2967529296875 GB
    Memory Allocated: 10.40730333328247  GigaBytes
Max Memory Allocated: 10.410835266113281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3026123046875 GB
    Memory Allocated: 0.08467864990234375  GigaBytes
Max Memory Allocated: 10.410835266113281  GigaBytes

torch.Size([145802, 128])
torch.Size([101359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5389404296875 GB
    Memory Allocated: 10.372214317321777  GigaBytes
Max Memory Allocated: 10.410835266113281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.5389404296875 GB
    Memory Allocated: 0.08554983139038086  GigaBytes
Max Memory Allocated: 10.410835266113281  GigaBytes

torch.Size([146535, 128])
torch.Size([102907, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1717529296875 GB
    Memory Allocated: 10.53486967086792  GigaBytes
Max Memory Allocated: 10.538974285125732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1717529296875 GB
    Memory Allocated: 0.08488035202026367  GigaBytes
Max Memory Allocated: 10.538974285125732  GigaBytes

torch.Size([146126, 128])
torch.Size([102630, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1717529296875 GB
    Memory Allocated: 10.480536460876465  GigaBytes
Max Memory Allocated: 10.538974285125732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1717529296875 GB
    Memory Allocated: 0.08556747436523438  GigaBytes
Max Memory Allocated: 10.538974285125732  GigaBytes

torch.Size([146565, 128])
torch.Size([102646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1756591796875 GB
    Memory Allocated: 10.531327247619629  GigaBytes
Max Memory Allocated: 10.538974285125732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1756591796875 GB
    Memory Allocated: 0.08480644226074219  GigaBytes
Max Memory Allocated: 10.538974285125732  GigaBytes

torch.Size([145830, 128])
torch.Size([102493, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1776123046875 GB
    Memory Allocated: 10.559138774871826  GigaBytes
Max Memory Allocated: 10.563255310058594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1776123046875 GB
    Memory Allocated: 0.08558893203735352  GigaBytes
Max Memory Allocated: 10.563255310058594  GigaBytes

torch.Size([146475, 128])
torch.Size([103373, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1776123046875 GB
    Memory Allocated: 10.558881759643555  GigaBytes
Max Memory Allocated: 10.563255310058594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1776123046875 GB
    Memory Allocated: 0.0851750373840332  GigaBytes
Max Memory Allocated: 10.563255310058594  GigaBytes

torch.Size([146523, 128])
torch.Size([102902, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8026123046875 GB
    Memory Allocated: 10.574830055236816  GigaBytes
Max Memory Allocated: 10.57901906967163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8026123046875 GB
    Memory Allocated: 0.08556318283081055  GigaBytes
Max Memory Allocated: 10.57901906967163  GigaBytes

torch.Size([146221, 128])
torch.Size([102407, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8026123046875 GB
    Memory Allocated: 10.50281047821045  GigaBytes
Max Memory Allocated: 10.57901906967163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8026123046875 GB
    Memory Allocated: 0.08520984649658203  GigaBytes
Max Memory Allocated: 10.57901906967163  GigaBytes

torch.Size([146660, 128])
torch.Size([103359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8026123046875 GB
    Memory Allocated: 10.524913311004639  GigaBytes
Max Memory Allocated: 10.57901906967163  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8026123046875 GB
    Memory Allocated: 0.0855855941772461  GigaBytes
Max Memory Allocated: 10.57901906967163  GigaBytes

torch.Size([146561, 128])
torch.Size([103241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 10.588500022888184  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 0.08486127853393555  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

torch.Size([146169, 128])
torch.Size([101407, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 10.383100509643555  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 0.0854949951171875  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

torch.Size([146012, 128])
torch.Size([101109, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 10.382198333740234  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 0.08483219146728516  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

torch.Size([146007, 128])
torch.Size([102029, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 10.440057754516602  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 0.0856466293334961  GigaBytes
Max Memory Allocated: 10.592609882354736  GigaBytes

torch.Size([146516, 128])
torch.Size([104022, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.695892333984375  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08519792556762695  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146671, 128])
torch.Size([103048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.543571472167969  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08551502227783203  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145825, 128])
torch.Size([101251, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.418513298034668  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08495473861694336  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146164, 128])
torch.Size([102764, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.561537265777588  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.0856318473815918  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146358, 128])
torch.Size([102644, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.571074962615967  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08498144149780273  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146108, 128])
torch.Size([103385, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.623167991638184  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.0855870246887207  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146587, 128])
torch.Size([102843, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.572932720184326  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08483123779296875  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146039, 128])
torch.Size([101903, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.436988830566406  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08550119400024414  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146455, 128])
torch.Size([101988, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.44199514389038  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08478069305419922  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145802, 128])
torch.Size([101696, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.481456756591797  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.0855865478515625  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146961, 128])
torch.Size([102972, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.54152774810791  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08501815795898438  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146337, 128])
torch.Size([102508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.484931945800781  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08553552627563477  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145978, 128])
torch.Size([101836, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.44408130645752  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08470344543457031  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145852, 128])
torch.Size([101048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.347880840301514  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08548355102539062  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145874, 128])
torch.Size([101392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.434007167816162  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08533716201782227  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([147090, 128])
torch.Size([102717, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.4972243309021  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08557558059692383  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146396, 128])
torch.Size([102871, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.56216812133789  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08474302291870117  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145851, 128])
torch.Size([101223, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.430448532104492  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03254576027393341 |0.028830505907535553 |0.40180502086877823 |0.00010153651237487793 |0.6135129481554031 |0.010226249694824219 |
----------------------------------------------------------pseudo_mini_loss sum 4.406212329864502
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8795462
Number of first layer input nodes during this epoch:  4680138
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.10419368743896484  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022681236267089844
random selection method range initialization spend 0.00507354736328125
time for parepare:  0.019334793090820312
local_output_nid generation:  0.0014162063598632812
local_in_edges_tensor generation:  0.005864620208740234
mini_batch_src_global generation:  0.0017666816711425781
r_  generation:  0.010427713394165039
local_output_nid generation:  0.0016541481018066406
local_in_edges_tensor generation:  0.0010640621185302734
mini_batch_src_global generation:  0.0016772747039794922
r_  generation:  0.01014089584350586
local_output_nid generation:  0.0016598701477050781
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0012323856353759766
r_  generation:  0.009923458099365234
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0011134147644042969
r_  generation:  0.00963592529296875
local_output_nid generation:  0.0016274452209472656
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0010838508605957031
r_  generation:  0.009776592254638672
local_output_nid generation:  0.0015766620635986328
local_in_edges_tensor generation:  0.0009012222290039062
mini_batch_src_global generation:  0.0011701583862304688
r_  generation:  0.010061502456665039
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.000946044921875
mini_batch_src_global generation:  0.001262664794921875
r_  generation:  0.010526657104492188
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010050773620605469
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0011355876922607422
r_  generation:  0.010326862335205078
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0008542537689208984
mini_batch_src_global generation:  0.0010995864868164062
r_  generation:  0.010273933410644531
local_output_nid generation:  0.0016179084777832031
local_in_edges_tensor generation:  0.0009143352508544922
mini_batch_src_global generation:  0.0011363029479980469
r_  generation:  0.010115623474121094
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0012357234954833984
r_  generation:  0.010469913482666016
local_output_nid generation:  0.0015866756439208984
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.010803461074829102
local_output_nid generation:  0.0015876293182373047
local_in_edges_tensor generation:  0.0009119510650634766
mini_batch_src_global generation:  0.0011377334594726562
r_  generation:  0.010118246078491211
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0012187957763671875
r_  generation:  0.010523080825805664
local_output_nid generation:  0.0015864372253417969
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.009973287582397461
local_output_nid generation:  0.0015690326690673828
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0011818408966064453
r_  generation:  0.010490894317626953
local_output_nid generation:  0.0015897750854492188
local_in_edges_tensor generation:  0.0009093284606933594
mini_batch_src_global generation:  0.0011990070343017578
r_  generation:  0.010456085205078125
local_output_nid generation:  0.0015821456909179688
local_in_edges_tensor generation:  0.0009324550628662109
mini_batch_src_global generation:  0.0012519359588623047
r_  generation:  0.010529756546020508
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.0011444091796875
r_  generation:  0.009968042373657227
local_output_nid generation:  0.0015597343444824219
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.001157522201538086
r_  generation:  0.010467290878295898
local_output_nid generation:  0.0015895366668701172
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.001230478286743164
r_  generation:  0.010970115661621094
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0009028911590576172
mini_batch_src_global generation:  0.0012443065643310547
r_  generation:  0.01132822036743164
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009446144104003906
mini_batch_src_global generation:  0.001203298568725586
r_  generation:  0.010707855224609375
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0009362697601318359
mini_batch_src_global generation:  0.0012781620025634766
r_  generation:  0.010482549667358398
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0011479854583740234
r_  generation:  0.010170459747314453
local_output_nid generation:  0.0016331672668457031
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0012819766998291016
r_  generation:  0.01013326644897461
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0012226104736328125
r_  generation:  0.010449409484863281
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0012421607971191406
r_  generation:  0.010575532913208008
local_output_nid generation:  0.0016205310821533203
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0012073516845703125
r_  generation:  0.010346651077270508
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009009838104248047
mini_batch_src_global generation:  0.0011827945709228516
r_  generation:  0.010439395904541016
local_output_nid generation:  0.0016067028045654297
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010161638259887695
----------------------check_connections_block total spend ----------------------------- 0.5709657669067383
generate_one_block  0.023402929306030273
generate_one_block  0.0202329158782959
generate_one_block  0.018143653869628906
generate_one_block  0.017057418823242188
generate_one_block  0.01714301109313965
generate_one_block  0.01724076271057129
generate_one_block  0.018139123916625977
generate_one_block  0.01695084571838379
generate_one_block  0.017526865005493164
generate_one_block  0.016983509063720703
generate_one_block  0.016939163208007812
generate_one_block  0.017853975296020508
generate_one_block  0.01814579963684082
generate_one_block  0.016872167587280273
generate_one_block  0.017481088638305664
generate_one_block  0.01686716079711914
generate_one_block  0.017232656478881836
generate_one_block  0.01761007308959961
generate_one_block  0.01757502555847168
generate_one_block  0.016705036163330078
generate_one_block  0.017610788345336914
generate_one_block  0.018161296844482422
generate_one_block  0.018643617630004883
generate_one_block  0.01800370216369629
generate_one_block  0.017566680908203125
generate_one_block  0.01690220832824707
generate_one_block  0.016855478286743164
generate_one_block  0.017645835876464844
generate_one_block  0.017740964889526367
generate_one_block  0.017027616500854492
generate_one_block  0.017240047454833984
generate_one_block  0.019434213638305664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03176522254943848
gen group dst list time:  0.02213263511657715
time for parepare:  0.019269466400146484
local_output_nid generation:  0.006249904632568359
local_in_edges_tensor generation:  0.01468658447265625
mini_batch_src_global generation:  0.013190507888793945
r_  generation:  0.13500738143920898
local_output_nid generation:  0.008739233016967773
local_in_edges_tensor generation:  0.011826515197753906
mini_batch_src_global generation:  0.01671886444091797
r_  generation:  0.13864636421203613
local_output_nid generation:  0.00939321517944336
local_in_edges_tensor generation:  0.029139280319213867
mini_batch_src_global generation:  0.01553654670715332
r_  generation:  0.1452934741973877
local_output_nid generation:  0.009114742279052734
local_in_edges_tensor generation:  0.008121967315673828
mini_batch_src_global generation:  0.016073226928710938
r_  generation:  0.14440441131591797
local_output_nid generation:  0.009124279022216797
local_in_edges_tensor generation:  0.008359909057617188
mini_batch_src_global generation:  0.01732015609741211
r_  generation:  0.14429593086242676
local_output_nid generation:  0.008909463882446289
local_in_edges_tensor generation:  0.009379148483276367
mini_batch_src_global generation:  0.01838827133178711
r_  generation:  0.14719939231872559
local_output_nid generation:  0.009271621704101562
local_in_edges_tensor generation:  0.009926795959472656
mini_batch_src_global generation:  0.01873183250427246
r_  generation:  0.15584826469421387
local_output_nid generation:  0.00871419906616211
local_in_edges_tensor generation:  0.008435249328613281
mini_batch_src_global generation:  0.021816253662109375
r_  generation:  0.14687824249267578
local_output_nid generation:  0.008971452713012695
local_in_edges_tensor generation:  0.009710073471069336
mini_batch_src_global generation:  0.02256035804748535
r_  generation:  0.1538245677947998
local_output_nid generation:  0.009222030639648438
local_in_edges_tensor generation:  0.008258819580078125
mini_batch_src_global generation:  0.018483877182006836
r_  generation:  0.15131926536560059
local_output_nid generation:  0.009104728698730469
local_in_edges_tensor generation:  0.0105133056640625
mini_batch_src_global generation:  0.018056392669677734
r_  generation:  0.1487748622894287
local_output_nid generation:  0.009410619735717773
local_in_edges_tensor generation:  0.009809017181396484
mini_batch_src_global generation:  0.020017147064208984
r_  generation:  0.1565866470336914
local_output_nid generation:  0.009599447250366211
local_in_edges_tensor generation:  0.011079788208007812
mini_batch_src_global generation:  0.019382238388061523
r_  generation:  0.15816044807434082
local_output_nid generation:  0.009220600128173828
local_in_edges_tensor generation:  0.008422613143920898
mini_batch_src_global generation:  0.018937349319458008
r_  generation:  0.14829254150390625
local_output_nid generation:  0.00934743881225586
local_in_edges_tensor generation:  0.009152412414550781
mini_batch_src_global generation:  0.0189208984375
r_  generation:  0.15619277954101562
local_output_nid generation:  0.009154558181762695
local_in_edges_tensor generation:  0.008323431015014648
mini_batch_src_global generation:  0.01843428611755371
r_  generation:  0.1498873233795166
local_output_nid generation:  0.009242773056030273
local_in_edges_tensor generation:  0.010535240173339844
mini_batch_src_global generation:  0.018644094467163086
r_  generation:  0.14957952499389648
local_output_nid generation:  0.009386539459228516
local_in_edges_tensor generation:  0.008660078048706055
mini_batch_src_global generation:  0.019019126892089844
r_  generation:  0.15546107292175293
local_output_nid generation:  0.009294271469116211
local_in_edges_tensor generation:  0.011192560195922852
mini_batch_src_global generation:  0.019336700439453125
r_  generation:  0.15666890144348145
local_output_nid generation:  0.008593320846557617
local_in_edges_tensor generation:  0.008358240127563477
mini_batch_src_global generation:  0.018214941024780273
r_  generation:  0.14479327201843262
local_output_nid generation:  0.008861303329467773
local_in_edges_tensor generation:  0.009501457214355469
mini_batch_src_global generation:  0.019588947296142578
r_  generation:  0.15378999710083008
local_output_nid generation:  0.009146451950073242
local_in_edges_tensor generation:  0.01027989387512207
mini_batch_src_global generation:  0.02080249786376953
r_  generation:  0.16158127784729004
local_output_nid generation:  0.009429931640625
local_in_edges_tensor generation:  0.011799335479736328
mini_batch_src_global generation:  0.019703388214111328
r_  generation:  0.1607375144958496
local_output_nid generation:  0.009215354919433594
local_in_edges_tensor generation:  0.009888887405395508
mini_batch_src_global generation:  0.019750118255615234
r_  generation:  0.15882158279418945
local_output_nid generation:  0.00921320915222168
local_in_edges_tensor generation:  0.011236906051635742
mini_batch_src_global generation:  0.019092798233032227
r_  generation:  0.15831279754638672
local_output_nid generation:  0.008898019790649414
local_in_edges_tensor generation:  0.008687496185302734
mini_batch_src_global generation:  0.018630266189575195
r_  generation:  0.1524965763092041
local_output_nid generation:  0.008797407150268555
local_in_edges_tensor generation:  0.008538246154785156
mini_batch_src_global generation:  0.017806291580200195
r_  generation:  0.1480247974395752
local_output_nid generation:  0.009004354476928711
local_in_edges_tensor generation:  0.010406970977783203
mini_batch_src_global generation:  0.01998305320739746
r_  generation:  0.15771102905273438
local_output_nid generation:  0.009140253067016602
local_in_edges_tensor generation:  0.009787321090698242
mini_batch_src_global generation:  0.019116878509521484
r_  generation:  0.158980131149292
local_output_nid generation:  0.00883340835571289
local_in_edges_tensor generation:  0.008486032485961914
mini_batch_src_global generation:  0.01889514923095703
r_  generation:  0.15353798866271973
local_output_nid generation:  0.008878946304321289
local_in_edges_tensor generation:  0.008762121200561523
mini_batch_src_global generation:  0.019957542419433594
r_  generation:  0.15410351753234863
local_output_nid generation:  0.00890040397644043
local_in_edges_tensor generation:  0.008698463439941406
mini_batch_src_global generation:  0.0187375545501709
r_  generation:  0.15558218955993652
----------------------check_connections_block total spend ----------------------------- 7.213418483734131
generate_one_block  0.19461846351623535
generate_one_block  0.1916649341583252
generate_one_block  0.19806694984436035
generate_one_block  0.19439268112182617
generate_one_block  0.2233579158782959
generate_one_block  0.19476819038391113
generate_one_block  0.210831880569458
generate_one_block  0.19535040855407715
generate_one_block  0.20345091819763184
generate_one_block  0.1970517635345459
generate_one_block  0.1926872730255127
generate_one_block  0.2118215560913086
generate_one_block  0.21506643295288086
generate_one_block  0.19166231155395508
generate_one_block  0.20179033279418945
generate_one_block  0.19611835479736328
generate_one_block  0.20041203498840332
generate_one_block  0.20794391632080078
generate_one_block  0.20854878425598145
generate_one_block  0.19874024391174316
generate_one_block  0.20277667045593262
generate_one_block  0.21507740020751953
generate_one_block  0.21416664123535156
generate_one_block  0.20696449279785156
generate_one_block  0.20373201370239258
generate_one_block  0.19614338874816895
generate_one_block  0.19179558753967285
generate_one_block  0.20787811279296875
generate_one_block  0.20888686180114746
generate_one_block  0.19943475723266602
generate_one_block  0.20555639266967773
generate_one_block  0.2058696746826172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03939223289489746
gen group dst list time:  0.10555744171142578
time for parepare:  0.01814723014831543
local_output_nid generation:  0.0255887508392334
local_in_edges_tensor generation:  0.05603671073913574
mini_batch_src_global generation:  0.037235260009765625
r_  generation:  0.3997809886932373
local_output_nid generation:  0.029651403427124023
local_in_edges_tensor generation:  0.039314985275268555
mini_batch_src_global generation:  0.06633210182189941
r_  generation:  0.4011101722717285
local_output_nid generation:  0.029652833938598633
local_in_edges_tensor generation:  0.03283524513244629
mini_batch_src_global generation:  0.04655623435974121
r_  generation:  0.40676212310791016
local_output_nid generation:  0.027889490127563477
local_in_edges_tensor generation:  0.025127887725830078
mini_batch_src_global generation:  0.05169820785522461
r_  generation:  0.40230894088745117
local_output_nid generation:  0.028030872344970703
local_in_edges_tensor generation:  0.025630712509155273
mini_batch_src_global generation:  0.04794573783874512
r_  generation:  0.41283369064331055
local_output_nid generation:  0.02783346176147461
local_in_edges_tensor generation:  0.032327890396118164
mini_batch_src_global generation:  0.04943251609802246
r_  generation:  0.40668201446533203
local_output_nid generation:  0.02828359603881836
local_in_edges_tensor generation:  0.03999972343444824
mini_batch_src_global generation:  0.04809379577636719
r_  generation:  0.42482995986938477
local_output_nid generation:  0.027915000915527344
local_in_edges_tensor generation:  0.028704166412353516
mini_batch_src_global generation:  0.04888319969177246
r_  generation:  0.4065284729003906
local_output_nid generation:  0.027893543243408203
local_in_edges_tensor generation:  0.02904963493347168
mini_batch_src_global generation:  0.04802417755126953
r_  generation:  0.42134666442871094
local_output_nid generation:  0.027579307556152344
local_in_edges_tensor generation:  0.0290374755859375
mini_batch_src_global generation:  0.04903721809387207
r_  generation:  0.4086296558380127
local_output_nid generation:  0.027668237686157227
local_in_edges_tensor generation:  0.02790069580078125
mini_batch_src_global generation:  0.04776954650878906
r_  generation:  0.41150498390197754
local_output_nid generation:  0.027936697006225586
local_in_edges_tensor generation:  0.03260517120361328
mini_batch_src_global generation:  0.048601627349853516
r_  generation:  0.4166879653930664
local_output_nid generation:  0.02797698974609375
local_in_edges_tensor generation:  0.033532142639160156
mini_batch_src_global generation:  0.04793262481689453
r_  generation:  0.41818761825561523
local_output_nid generation:  0.027715206146240234
local_in_edges_tensor generation:  0.026089906692504883
mini_batch_src_global generation:  0.048363447189331055
r_  generation:  0.40869140625
local_output_nid generation:  0.02823638916015625
local_in_edges_tensor generation:  0.02892899513244629
mini_batch_src_global generation:  0.04845166206359863
r_  generation:  0.416278600692749
local_output_nid generation:  0.0280609130859375
local_in_edges_tensor generation:  0.028882741928100586
mini_batch_src_global generation:  0.048543691635131836
r_  generation:  0.4068334102630615
local_output_nid generation:  0.027945756912231445
local_in_edges_tensor generation:  0.032558441162109375
mini_batch_src_global generation:  0.04745316505432129
r_  generation:  0.41593146324157715
local_output_nid generation:  0.02916407585144043
local_in_edges_tensor generation:  0.03592681884765625
mini_batch_src_global generation:  0.048685550689697266
r_  generation:  0.4100792407989502
local_output_nid generation:  0.02829599380493164
local_in_edges_tensor generation:  0.02941131591796875
mini_batch_src_global generation:  0.048599958419799805
r_  generation:  0.4181954860687256
local_output_nid generation:  0.027785539627075195
local_in_edges_tensor generation:  0.03137564659118652
mini_batch_src_global generation:  0.04800128936767578
r_  generation:  0.40723228454589844
local_output_nid generation:  0.028103113174438477
local_in_edges_tensor generation:  0.037209272384643555
mini_batch_src_global generation:  0.04995608329772949
r_  generation:  0.4176785945892334
local_output_nid generation:  0.02827167510986328
local_in_edges_tensor generation:  0.03478670120239258
mini_batch_src_global generation:  0.049154043197631836
r_  generation:  0.4314086437225342
local_output_nid generation:  0.031207799911499023
local_in_edges_tensor generation:  0.02966141700744629
mini_batch_src_global generation:  0.04960489273071289
r_  generation:  0.42136096954345703
local_output_nid generation:  0.028944730758666992
local_in_edges_tensor generation:  0.02904963493347168
mini_batch_src_global generation:  0.04884767532348633
r_  generation:  0.41367387771606445
local_output_nid generation:  0.02884507179260254
local_in_edges_tensor generation:  0.02950310707092285
mini_batch_src_global generation:  0.048566341400146484
r_  generation:  0.42556333541870117
local_output_nid generation:  0.028890132904052734
local_in_edges_tensor generation:  0.029636144638061523
mini_batch_src_global generation:  0.04878664016723633
r_  generation:  0.4095280170440674
local_output_nid generation:  0.028259754180908203
local_in_edges_tensor generation:  0.025233983993530273
mini_batch_src_global generation:  0.04714250564575195
r_  generation:  0.4086158275604248
local_output_nid generation:  0.028911590576171875
local_in_edges_tensor generation:  0.028674602508544922
mini_batch_src_global generation:  0.048853397369384766
r_  generation:  0.4121413230895996
local_output_nid generation:  0.028742313385009766
local_in_edges_tensor generation:  0.029101848602294922
mini_batch_src_global generation:  0.04806327819824219
r_  generation:  0.41695237159729004
local_output_nid generation:  0.028232574462890625
local_in_edges_tensor generation:  0.02809882164001465
mini_batch_src_global generation:  0.048217058181762695
r_  generation:  0.40722227096557617
local_output_nid generation:  0.02857208251953125
local_in_edges_tensor generation:  0.033179283142089844
mini_batch_src_global generation:  0.050446510314941406
r_  generation:  0.41512131690979004
local_output_nid generation:  0.028430700302124023
local_in_edges_tensor generation:  0.028505563735961914
mini_batch_src_global generation:  0.05055856704711914
r_  generation:  0.4118647575378418
----------------------check_connections_block total spend ----------------------------- 19.551579236984253
generate_one_block  0.5533831119537354
generate_one_block  0.5546548366546631
generate_one_block  0.545198917388916
generate_one_block  0.5399718284606934
generate_one_block  0.6377832889556885
generate_one_block  0.5546510219573975
generate_one_block  0.5576207637786865
generate_one_block  0.5391659736633301
generate_one_block  0.5559604167938232
generate_one_block  0.5479662418365479
generate_one_block  0.5381574630737305
generate_one_block  0.5633466243743896
generate_one_block  0.5579025745391846
generate_one_block  0.5356531143188477
generate_one_block  0.5629534721374512
generate_one_block  0.5346226692199707
generate_one_block  0.5468490123748779
generate_one_block  0.5615999698638916
generate_one_block  0.5550374984741211
generate_one_block  0.5282862186431885
generate_one_block  0.5408060550689697
generate_one_block  0.5613086223602295
generate_one_block  0.5553457736968994
generate_one_block  0.5455079078674316
generate_one_block  0.5679066181182861
generate_one_block  0.5392715930938721
generate_one_block  0.5322160720825195
generate_one_block  0.5470585823059082
generate_one_block  0.5531690120697021
generate_one_block  0.5349421501159668
generate_one_block  0.5488712787628174
generate_one_block  0.5516457557678223
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.10419368743896484  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

connection checking time:  26.764997720718384
block generation total time  24.135441780090332
average batch blocks generation time:  0.7542325556278229
block dataloader generation time/epoch 54.02133512496948
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08672809600830078  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146172, 128])
torch.Size([102145, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.461008548736572  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08611583709716797  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146228, 128])
torch.Size([101983, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.441160678863525  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08674907684326172  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146853, 128])
torch.Size([102634, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.46599006652832  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08604001998901367  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146115, 128])
torch.Size([100709, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.363271236419678  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08669233322143555  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146419, 128])
torch.Size([101952, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.415716648101807  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08624505996704102  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146487, 128])
torch.Size([102158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.435145378112793  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08683919906616211  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146795, 128])
torch.Size([103747, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.61328125  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08620119094848633  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146426, 128])
torch.Size([101861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.42466688156128  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08679723739624023  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146354, 128])
torch.Size([102533, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.56819772720337  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08604001998901367  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146012, 128])
torch.Size([101647, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.44347333908081  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08671283721923828  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145912, 128])
torch.Size([101071, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.417397022247314  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08621883392333984  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146235, 128])
torch.Size([102642, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.584912300109863  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08684730529785156  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145851, 128])
torch.Size([102508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.609391212463379  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08591938018798828  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145841, 128])
torch.Size([101191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.406103134155273  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08679437637329102  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146732, 128])
torch.Size([103067, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.612964153289795  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08614158630371094  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146340, 128])
torch.Size([101437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.39578914642334  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08673715591430664  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146355, 128])
torch.Size([101787, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.458304405212402  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08635282516479492  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146529, 128])
torch.Size([102993, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.550285816192627  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08681583404541016  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146629, 128])
torch.Size([103686, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.598021030426025  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08577680587768555  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145643, 128])
torch.Size([100158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.261299133300781  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.0867762565612793  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146208, 128])
torch.Size([102562, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 10.519929885864258  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0545654296875 GB
    Memory Allocated: 0.08649349212646484  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146668, 128])
torch.Size([103748, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0584716796875 GB
    Memory Allocated: 10.660744190216064  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0584716796875 GB
    Memory Allocated: 0.08687591552734375  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146787, 128])
torch.Size([103971, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.652795314788818  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08652544021606445  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146824, 128])
torch.Size([103309, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.581517696380615  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08679533004760742  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146806, 128])
torch.Size([103658, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.615503311157227  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.0862264633178711  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146424, 128])
torch.Size([102416, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.453763961791992  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08667802810668945  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146123, 128])
torch.Size([100755, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.342151165008545  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08632612228393555  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146475, 128])
torch.Size([102950, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.559833526611328  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08679914474487305  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([146479, 128])
torch.Size([102597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.534193515777588  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.0858616828918457  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145599, 128])
torch.Size([100756, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.40045166015625  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08677959442138672  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145685, 128])
torch.Size([101934, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.509257793426514  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 0.08591747283935547  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

torch.Size([145738, 128])
torch.Size([101778, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0682373046875 GB
    Memory Allocated: 10.451248168945312  GigaBytes
Max Memory Allocated: 10.700103282928467  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025306664407253265 |0.015574581921100616 |0.38266532868146896 |9.584426879882812e-05 |0.6098812222480774 |0.00810694694519043 |
----------------------------------------------------------pseudo_mini_loss sum 3.6961376667022705
Total (block generation + training)time/epoch 87.14924168586731
Training time/epoch 33.12765336036682
Training time without block to device /epoch 32.6292667388916
Training time without total dataloading part /epoch 31.772663593292236
load block tensor time/epoch 0.8098132610321045
block to device time/epoch 0.4983866214752197
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8793691
Number of first layer input nodes during this epoch:  4681744
