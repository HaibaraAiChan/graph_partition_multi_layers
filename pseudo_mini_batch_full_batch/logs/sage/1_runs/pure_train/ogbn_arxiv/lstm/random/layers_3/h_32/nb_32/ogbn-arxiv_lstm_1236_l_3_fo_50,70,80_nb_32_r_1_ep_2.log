Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648456048.042219
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02896285057067871
random selection method range initialization spend 0.006460905075073242
time for parepare:  0.01909184455871582
local_output_nid generation:  0.0011196136474609375
local_in_edges_tensor generation:  0.004169940948486328
mini_batch_src_global generation:  0.0015614032745361328
r_  generation:  0.010164022445678711
local_output_nid generation:  0.0012841224670410156
local_in_edges_tensor generation:  0.0010058879852294922
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.00910186767578125
local_output_nid generation:  0.0013437271118164062
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0010504722595214844
r_  generation:  0.009252548217773438
local_output_nid generation:  0.0013654232025146484
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.009252786636352539
local_output_nid generation:  0.001394510269165039
local_in_edges_tensor generation:  0.000820159912109375
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.00941014289855957
local_output_nid generation:  0.0014002323150634766
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.009781599044799805
local_output_nid generation:  0.001420736312866211
local_in_edges_tensor generation:  0.0008909702301025391
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.009946584701538086
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0008168220520019531
mini_batch_src_global generation:  0.0010538101196289062
r_  generation:  0.00997161865234375
local_output_nid generation:  0.0014405250549316406
local_in_edges_tensor generation:  0.0008170604705810547
mini_batch_src_global generation:  0.0010557174682617188
r_  generation:  0.009921550750732422
local_output_nid generation:  0.0014448165893554688
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.001051187515258789
r_  generation:  0.009856700897216797
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.0010528564453125
r_  generation:  0.009961605072021484
local_output_nid generation:  0.0014514923095703125
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0009946823120117188
r_  generation:  0.009682178497314453
local_output_nid generation:  0.0015001296997070312
local_in_edges_tensor generation:  0.0007903575897216797
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.00955653190612793
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0009937286376953125
r_  generation:  0.009835243225097656
local_output_nid generation:  0.0014743804931640625
local_in_edges_tensor generation:  0.00078582763671875
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.010164499282836914
local_output_nid generation:  0.0014569759368896484
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.001107931137084961
r_  generation:  0.009915590286254883
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007712841033935547
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009603738784790039
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.01031947135925293
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0010764598846435547
r_  generation:  0.010136127471923828
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0007772445678710938
mini_batch_src_global generation:  0.0010943412780761719
r_  generation:  0.01047205924987793
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0007631778717041016
mini_batch_src_global generation:  0.00104522705078125
r_  generation:  0.009763956069946289
local_output_nid generation:  0.0014679431915283203
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0010018348693847656
r_  generation:  0.00961756706237793
local_output_nid generation:  0.001440286636352539
local_in_edges_tensor generation:  0.0007517337799072266
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009799003601074219
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.009974956512451172
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0007889270782470703
mini_batch_src_global generation:  0.0010752677917480469
r_  generation:  0.009997844696044922
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.00983881950378418
local_output_nid generation:  0.001482248306274414
local_in_edges_tensor generation:  0.0007481575012207031
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.009691953659057617
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0007915496826171875
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.00955057144165039
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.00954890251159668
local_output_nid generation:  0.0014963150024414062
local_in_edges_tensor generation:  0.005517005920410156
mini_batch_src_global generation:  0.0012180805206298828
r_  generation:  0.009864330291748047
local_output_nid generation:  0.0013320446014404297
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.009970903396606445
local_output_nid generation:  0.0013935565948486328
local_in_edges_tensor generation:  0.0008192062377929688
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.009556055068969727
----------------------check_connections_block total spend ----------------------------- 0.537604808807373
generate_one_block  0.01515817642211914
generate_one_block  0.014714241027832031
generate_one_block  0.015157938003540039
generate_one_block  0.014674663543701172
generate_one_block  0.014939308166503906
generate_one_block  0.015251874923706055
generate_one_block  0.015027046203613281
generate_one_block  0.015298128128051758
generate_one_block  0.01511073112487793
generate_one_block  0.015450477600097656
generate_one_block  0.015119314193725586
generate_one_block  0.014419317245483398
generate_one_block  0.014518022537231445
generate_one_block  0.014632463455200195
generate_one_block  0.015400171279907227
generate_one_block  0.014786720275878906
generate_one_block  0.014389753341674805
generate_one_block  0.014829635620117188
generate_one_block  0.015430450439453125
generate_one_block  0.015484333038330078
generate_one_block  0.01483464241027832
generate_one_block  0.01444101333618164
generate_one_block  0.014580488204956055
generate_one_block  0.014824151992797852
generate_one_block  0.015062808990478516
generate_one_block  0.014809846878051758
generate_one_block  0.014648914337158203
generate_one_block  0.014185667037963867
generate_one_block  0.014257669448852539
generate_one_block  0.014470577239990234
generate_one_block  0.015270471572875977
generate_one_block  0.014307260513305664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04410958290100098
gen group dst list time:  0.023481130599975586
time for parepare:  0.0196533203125
local_output_nid generation:  0.0052874088287353516
local_in_edges_tensor generation:  0.015398025512695312
mini_batch_src_global generation:  0.01638484001159668
r_  generation:  0.15361952781677246
local_output_nid generation:  0.009871244430541992
local_in_edges_tensor generation:  0.014854907989501953
mini_batch_src_global generation:  0.020784616470336914
r_  generation:  0.15786147117614746
local_output_nid generation:  0.010326862335205078
local_in_edges_tensor generation:  0.012707948684692383
mini_batch_src_global generation:  0.019423723220825195
r_  generation:  0.1671147346496582
local_output_nid generation:  0.009875059127807617
local_in_edges_tensor generation:  0.013938188552856445
mini_batch_src_global generation:  0.019957780838012695
r_  generation:  0.16678547859191895
local_output_nid generation:  0.010123491287231445
local_in_edges_tensor generation:  0.01132512092590332
mini_batch_src_global generation:  0.02139878273010254
r_  generation:  0.17622900009155273
local_output_nid generation:  0.010038375854492188
local_in_edges_tensor generation:  0.012625932693481445
mini_batch_src_global generation:  0.023357868194580078
r_  generation:  0.1739025115966797
local_output_nid generation:  0.010404109954833984
local_in_edges_tensor generation:  0.011263132095336914
mini_batch_src_global generation:  0.023906469345092773
r_  generation:  0.18109798431396484
local_output_nid generation:  0.010110139846801758
local_in_edges_tensor generation:  0.00938105583190918
mini_batch_src_global generation:  0.024554729461669922
r_  generation:  0.17935824394226074
local_output_nid generation:  0.010108470916748047
local_in_edges_tensor generation:  0.009698152542114258
mini_batch_src_global generation:  0.022388935089111328
r_  generation:  0.1751866340637207
local_output_nid generation:  0.010119438171386719
local_in_edges_tensor generation:  0.010727405548095703
mini_batch_src_global generation:  0.022664308547973633
r_  generation:  0.1762397289276123
local_output_nid generation:  0.010025501251220703
local_in_edges_tensor generation:  0.012601852416992188
mini_batch_src_global generation:  0.023276090621948242
r_  generation:  0.17841243743896484
local_output_nid generation:  0.009857177734375
local_in_edges_tensor generation:  0.009406805038452148
mini_batch_src_global generation:  0.022166013717651367
r_  generation:  0.16838717460632324
local_output_nid generation:  0.00971078872680664
local_in_edges_tensor generation:  0.010708808898925781
mini_batch_src_global generation:  0.021950960159301758
r_  generation:  0.1707606315612793
local_output_nid generation:  0.009940862655639648
local_in_edges_tensor generation:  0.012274980545043945
mini_batch_src_global generation:  0.022165775299072266
r_  generation:  0.17693519592285156
local_output_nid generation:  0.010422706604003906
local_in_edges_tensor generation:  0.017832279205322266
mini_batch_src_global generation:  0.023489713668823242
r_  generation:  0.18315386772155762
local_output_nid generation:  0.010009288787841797
local_in_edges_tensor generation:  0.011018514633178711
mini_batch_src_global generation:  0.023467540740966797
r_  generation:  0.1799027919769287
local_output_nid generation:  0.00995635986328125
local_in_edges_tensor generation:  0.010534524917602539
mini_batch_src_global generation:  0.022545814514160156
r_  generation:  0.17385363578796387
local_output_nid generation:  0.009926795959472656
local_in_edges_tensor generation:  0.011128664016723633
mini_batch_src_global generation:  0.024336814880371094
r_  generation:  0.17892861366271973
local_output_nid generation:  0.010329246520996094
local_in_edges_tensor generation:  0.011074542999267578
mini_batch_src_global generation:  0.02488088607788086
r_  generation:  0.18192243576049805
local_output_nid generation:  0.010268449783325195
local_in_edges_tensor generation:  0.014286518096923828
mini_batch_src_global generation:  0.023992538452148438
r_  generation:  0.18405604362487793
local_output_nid generation:  0.010133028030395508
local_in_edges_tensor generation:  0.011420011520385742
mini_batch_src_global generation:  0.023328065872192383
r_  generation:  0.18015336990356445
local_output_nid generation:  0.009842157363891602
local_in_edges_tensor generation:  0.009706497192382812
mini_batch_src_global generation:  0.022330045700073242
r_  generation:  0.17780685424804688
local_output_nid generation:  0.010003805160522461
local_in_edges_tensor generation:  0.009678840637207031
mini_batch_src_global generation:  0.022412538528442383
r_  generation:  0.1725625991821289
local_output_nid generation:  0.009969949722290039
local_in_edges_tensor generation:  0.009519338607788086
mini_batch_src_global generation:  0.024013280868530273
r_  generation:  0.17987418174743652
local_output_nid generation:  0.010169029235839844
local_in_edges_tensor generation:  0.012437582015991211
mini_batch_src_global generation:  0.024759531021118164
r_  generation:  0.18129706382751465
local_output_nid generation:  0.010056495666503906
local_in_edges_tensor generation:  0.009722232818603516
mini_batch_src_global generation:  0.023601055145263672
r_  generation:  0.17981338500976562
local_output_nid generation:  0.009846210479736328
local_in_edges_tensor generation:  0.011127471923828125
mini_batch_src_global generation:  0.02276158332824707
r_  generation:  0.1786503791809082
local_output_nid generation:  0.009943246841430664
local_in_edges_tensor generation:  0.009472131729125977
mini_batch_src_global generation:  0.022634267807006836
r_  generation:  0.17232418060302734
local_output_nid generation:  0.00986027717590332
local_in_edges_tensor generation:  0.008998870849609375
mini_batch_src_global generation:  0.022462129592895508
r_  generation:  0.1753709316253662
local_output_nid generation:  0.01016855239868164
local_in_edges_tensor generation:  0.009146928787231445
mini_batch_src_global generation:  0.022658348083496094
r_  generation:  0.1779313087463379
local_output_nid generation:  0.010141372680664062
local_in_edges_tensor generation:  0.012408256530761719
mini_batch_src_global generation:  0.0245211124420166
r_  generation:  0.1820085048675537
local_output_nid generation:  0.009752035140991211
local_in_edges_tensor generation:  0.009308338165283203
mini_batch_src_global generation:  0.02241039276123047
r_  generation:  0.17583394050598145
----------------------check_connections_block total spend ----------------------------- 8.314166784286499
generate_one_block  0.2237086296081543
generate_one_block  0.21556973457336426
generate_one_block  0.24915409088134766
generate_one_block  0.22562837600708008
generate_one_block  0.23225831985473633
generate_one_block  0.23541688919067383
generate_one_block  0.23351669311523438
generate_one_block  0.2359328269958496
generate_one_block  0.22493267059326172
generate_one_block  0.2339932918548584
generate_one_block  0.23234844207763672
generate_one_block  0.21483659744262695
generate_one_block  0.21723365783691406
generate_one_block  0.22393298149108887
generate_one_block  0.24498462677001953
generate_one_block  0.25303220748901367
generate_one_block  0.22116851806640625
generate_one_block  0.22815966606140137
generate_one_block  0.23606133460998535
generate_one_block  0.23824238777160645
generate_one_block  0.22788596153259277
generate_one_block  0.21797871589660645
generate_one_block  0.22063755989074707
generate_one_block  0.23000049591064453
generate_one_block  0.23575067520141602
generate_one_block  0.2249774932861328
generate_one_block  0.22576498985290527
generate_one_block  0.21474981307983398
generate_one_block  0.22000956535339355
generate_one_block  0.22626042366027832
generate_one_block  0.23373746871948242
generate_one_block  0.22829008102416992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04219508171081543
gen group dst list time:  0.10068011283874512
time for parepare:  0.01910996437072754
local_output_nid generation:  0.022193193435668945
local_in_edges_tensor generation:  0.040093421936035156
mini_batch_src_global generation:  0.05055499076843262
r_  generation:  0.46834540367126465
local_output_nid generation:  0.029335975646972656
local_in_edges_tensor generation:  0.04826521873474121
mini_batch_src_global generation:  0.06228923797607422
r_  generation:  0.4772357940673828
local_output_nid generation:  0.02949070930480957
local_in_edges_tensor generation:  0.044040679931640625
mini_batch_src_global generation:  0.05719161033630371
r_  generation:  0.49189066886901855
local_output_nid generation:  0.027987957000732422
local_in_edges_tensor generation:  0.03531908988952637
mini_batch_src_global generation:  0.05849123001098633
r_  generation:  0.4846048355102539
local_output_nid generation:  0.02789163589477539
local_in_edges_tensor generation:  0.0349576473236084
mini_batch_src_global generation:  0.05837202072143555
r_  generation:  0.4960925579071045
local_output_nid generation:  0.027895450592041016
local_in_edges_tensor generation:  0.03481268882751465
mini_batch_src_global generation:  0.06309747695922852
r_  generation:  0.4874129295349121
local_output_nid generation:  0.02805638313293457
local_in_edges_tensor generation:  0.03541088104248047
mini_batch_src_global generation:  0.058882951736450195
r_  generation:  0.4936337471008301
local_output_nid generation:  0.027887582778930664
local_in_edges_tensor generation:  0.039299726486206055
mini_batch_src_global generation:  0.05988574028015137
r_  generation:  0.4974968433380127
local_output_nid generation:  0.02823638916015625
local_in_edges_tensor generation:  0.031072139739990234
mini_batch_src_global generation:  0.059171438217163086
r_  generation:  0.493074893951416
local_output_nid generation:  0.028048276901245117
local_in_edges_tensor generation:  0.0354769229888916
mini_batch_src_global generation:  0.05960249900817871
r_  generation:  0.49831175804138184
local_output_nid generation:  0.028264522552490234
local_in_edges_tensor generation:  0.03961682319641113
mini_batch_src_global generation:  0.05910658836364746
r_  generation:  0.5033891201019287
local_output_nid generation:  0.027660369873046875
local_in_edges_tensor generation:  0.04297637939453125
mini_batch_src_global generation:  0.06022238731384277
r_  generation:  0.4873356819152832
local_output_nid generation:  0.027554988861083984
local_in_edges_tensor generation:  0.02998805046081543
mini_batch_src_global generation:  0.0588383674621582
r_  generation:  0.4904484748840332
local_output_nid generation:  0.0276644229888916
local_in_edges_tensor generation:  0.03242778778076172
mini_batch_src_global generation:  0.06301116943359375
r_  generation:  0.4963834285736084
local_output_nid generation:  0.028300046920776367
local_in_edges_tensor generation:  0.03922772407531738
mini_batch_src_global generation:  0.05910825729370117
r_  generation:  0.5024657249450684
local_output_nid generation:  0.02881312370300293
local_in_edges_tensor generation:  0.029809951782226562
mini_batch_src_global generation:  0.06042671203613281
r_  generation:  0.496502161026001
local_output_nid generation:  0.02789902687072754
local_in_edges_tensor generation:  0.029276609420776367
mini_batch_src_global generation:  0.05964922904968262
r_  generation:  0.4968235492706299
local_output_nid generation:  0.029431581497192383
local_in_edges_tensor generation:  0.036154747009277344
mini_batch_src_global generation:  0.06042122840881348
r_  generation:  0.50113844871521
local_output_nid generation:  0.02845168113708496
local_in_edges_tensor generation:  0.03802680969238281
mini_batch_src_global generation:  0.06382918357849121
r_  generation:  0.5098495483398438
local_output_nid generation:  0.028759479522705078
local_in_edges_tensor generation:  0.03993797302246094
mini_batch_src_global generation:  0.06288528442382812
r_  generation:  0.505850076675415
local_output_nid generation:  0.029085874557495117
local_in_edges_tensor generation:  0.03239583969116211
mini_batch_src_global generation:  0.0628654956817627
r_  generation:  0.5057802200317383
local_output_nid generation:  0.02816033363342285
local_in_edges_tensor generation:  0.03181624412536621
mini_batch_src_global generation:  0.0602269172668457
r_  generation:  0.495511531829834
local_output_nid generation:  0.02811431884765625
local_in_edges_tensor generation:  0.03480935096740723
mini_batch_src_global generation:  0.06320428848266602
r_  generation:  0.4987485408782959
local_output_nid generation:  0.028121232986450195
local_in_edges_tensor generation:  0.03966021537780762
mini_batch_src_global generation:  0.06245541572570801
r_  generation:  0.49991512298583984
local_output_nid generation:  0.028331518173217773
local_in_edges_tensor generation:  0.037946462631225586
mini_batch_src_global generation:  0.06326818466186523
r_  generation:  0.5243833065032959
local_output_nid generation:  0.030474424362182617
local_in_edges_tensor generation:  0.03224945068359375
mini_batch_src_global generation:  0.06249189376831055
r_  generation:  0.49199461936950684
local_output_nid generation:  0.028756380081176758
local_in_edges_tensor generation:  0.028986215591430664
mini_batch_src_global generation:  0.060606956481933594
r_  generation:  0.49944639205932617
local_output_nid generation:  0.028589725494384766
local_in_edges_tensor generation:  0.02988266944885254
mini_batch_src_global generation:  0.061192989349365234
r_  generation:  0.49417757987976074
local_output_nid generation:  0.029481172561645508
local_in_edges_tensor generation:  0.0329892635345459
mini_batch_src_global generation:  0.06360173225402832
r_  generation:  0.5053095817565918
local_output_nid generation:  0.028928041458129883
local_in_edges_tensor generation:  0.03777813911437988
mini_batch_src_global generation:  0.0610501766204834
r_  generation:  0.49887537956237793
local_output_nid generation:  0.02890467643737793
local_in_edges_tensor generation:  0.03258538246154785
mini_batch_src_global generation:  0.06008338928222656
r_  generation:  0.5065946578979492
local_output_nid generation:  0.028806447982788086
local_in_edges_tensor generation:  0.03717398643493652
mini_batch_src_global generation:  0.059927940368652344
r_  generation:  0.5017476081848145
----------------------check_connections_block total spend ----------------------------- 23.36158800125122
generate_one_block  0.7463977336883545
generate_one_block  0.6469898223876953
generate_one_block  0.65407395362854
generate_one_block  0.6402709484100342
generate_one_block  0.6784842014312744
generate_one_block  0.6806776523590088
generate_one_block  0.6592037677764893
generate_one_block  0.6546206474304199
generate_one_block  0.6362192630767822
generate_one_block  0.6442892551422119
generate_one_block  0.6709277629852295
generate_one_block  0.687856912612915
generate_one_block  0.6624376773834229
generate_one_block  0.6729297637939453
generate_one_block  0.6734628677368164
generate_one_block  0.6507797241210938
generate_one_block  0.640993595123291
generate_one_block  0.6574203968048096
generate_one_block  0.6494638919830322
generate_one_block  0.6659538745880127
generate_one_block  0.6555545330047607
generate_one_block  0.6386213302612305
generate_one_block  0.6497290134429932
generate_one_block  0.6365196704864502
generate_one_block  0.6422033309936523
generate_one_block  0.6456668376922607
generate_one_block  0.6421983242034912
generate_one_block  0.6478979587554932
generate_one_block  0.6491601467132568
generate_one_block  0.6509244441986084
generate_one_block  0.6595680713653564
generate_one_block  0.6321957111358643
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  31.67575478553772
block generation total time  28.34984827041626
average batch blocks generation time:  0.8859327584505081
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08894968032836914  GigaBytes
Max Memory Allocated: 0.08894968032836914  GigaBytes

torch.Size([149870, 128])
torch.Size([108827, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0955810546875 GB
    Memory Allocated: 12.959282398223877  GigaBytes
Max Memory Allocated: 12.967623710632324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1033935546875 GB
    Memory Allocated: 0.08922624588012695  GigaBytes
Max Memory Allocated: 12.967623710632324  GigaBytes

torch.Size([150075, 128])
torch.Size([109184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6658935546875 GB
    Memory Allocated: 12.998661518096924  GigaBytes
Max Memory Allocated: 13.00778579711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6658935546875 GB
    Memory Allocated: 0.09015655517578125  GigaBytes
Max Memory Allocated: 13.00778579711914  GigaBytes

torch.Size([150426, 128])
torch.Size([110254, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4588623046875 GB
    Memory Allocated: 13.10697603225708  GigaBytes
Max Memory Allocated: 13.115698337554932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4588623046875 GB
    Memory Allocated: 0.08937311172485352  GigaBytes
Max Memory Allocated: 13.115698337554932  GigaBytes

torch.Size([150095, 128])
torch.Size([110050, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4588623046875 GB
    Memory Allocated: 13.062814235687256  GigaBytes
Max Memory Allocated: 13.115698337554932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4588623046875 GB
    Memory Allocated: 0.09019947052001953  GigaBytes
Max Memory Allocated: 13.115698337554932  GigaBytes

torch.Size([150474, 128])
torch.Size([109841, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4764404296875 GB
    Memory Allocated: 13.121304035186768  GigaBytes
Max Memory Allocated: 13.131709575653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4764404296875 GB
    Memory Allocated: 0.08945226669311523  GigaBytes
Max Memory Allocated: 13.131709575653076  GigaBytes

torch.Size([149887, 128])
torch.Size([109869, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4803466796875 GB
    Memory Allocated: 13.116469383239746  GigaBytes
Max Memory Allocated: 13.131709575653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4803466796875 GB
    Memory Allocated: 0.09029579162597656  GigaBytes
Max Memory Allocated: 13.131709575653076  GigaBytes

torch.Size([150461, 128])
torch.Size([110962, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2537841796875 GB
    Memory Allocated: 13.169503688812256  GigaBytes
Max Memory Allocated: 13.179870128631592  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2537841796875 GB
    Memory Allocated: 0.0898137092590332  GigaBytes
Max Memory Allocated: 13.179870128631592  GigaBytes

torch.Size([150431, 128])
torch.Size([110380, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 13.172657489776611  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.09017086029052734  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150160, 128])
torch.Size([109905, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 13.091004848480225  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.08980417251586914  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150605, 128])
torch.Size([110833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 13.144890785217285  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.09028244018554688  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150610, 128])
torch.Size([110502, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 13.157055377960205  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.08922338485717773  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150153, 128])
torch.Size([109045, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 12.948247909545898  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.08994293212890625  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150097, 128])
torch.Size([108867, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 12.979966640472412  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.08936119079589844  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150064, 128])
torch.Size([109724, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 13.036272525787354  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2674560546875 GB
    Memory Allocated: 0.09047794342041016  GigaBytes
Max Memory Allocated: 13.182759284973145  GigaBytes

torch.Size([150315, 128])
torch.Size([111013, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.27594518661499  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08976507186889648  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150557, 128])
torch.Size([110480, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.121432304382324  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08996868133544922  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149796, 128])
torch.Size([108591, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.966830730438232  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08948659896850586  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150055, 128])
torch.Size([109878, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.122749328613281  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09038352966308594  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150442, 128])
torch.Size([110349, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.162662982940674  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08968639373779297  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150030, 128])
torch.Size([110748, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.205186367034912  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.0902566909790039  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150421, 128])
torch.Size([110048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.14712381362915  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08928728103637695  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150049, 128])
torch.Size([109508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.02741813659668  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08998680114746094  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150390, 128])
torch.Size([109376, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.01307201385498  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08939409255981445  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149923, 128])
torch.Size([109345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.06989049911499  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09026050567626953  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150800, 128])
torch.Size([110316, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.129315853118896  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08956480026245117  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150349, 128])
torch.Size([109772, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.081654071807861  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09004783630371094  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149957, 128])
torch.Size([109140, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.028139114379883  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08914804458618164  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150019, 128])
torch.Size([108673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.937880992889404  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09001350402832031  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149887, 128])
torch.Size([109102, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.044741153717041  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08983850479125977  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([151021, 128])
torch.Size([110368, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.086106777191162  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09024906158447266  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150317, 128])
torch.Size([110133, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.13853931427002  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.08927297592163086  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149941, 128])
torch.Size([108939, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.004697799682617  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03784427046775818 |0.03401593118906021 |0.6438322514295578 |0.00010898709297180176 |1.006472148001194 |0.01665019989013672 |
----------------------------------------------------------pseudo_mini_loss sum 4.408567428588867
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9161755
Number of first layer input nodes during this epoch:  4807677
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.11302757263183594  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030172348022460938
random selection method range initialization spend 0.005912065505981445
time for parepare:  0.01969003677368164
local_output_nid generation:  0.0013725757598876953
local_in_edges_tensor generation:  0.004419088363647461
mini_batch_src_global generation:  0.0019481182098388672
r_  generation:  0.010650873184204102
local_output_nid generation:  0.0016300678253173828
local_in_edges_tensor generation:  0.0011093616485595703
mini_batch_src_global generation:  0.0017223358154296875
r_  generation:  0.010349035263061523
local_output_nid generation:  0.0016372203826904297
local_in_edges_tensor generation:  0.0010530948638916016
mini_batch_src_global generation:  0.0012462139129638672
r_  generation:  0.010186910629272461
local_output_nid generation:  0.0016727447509765625
local_in_edges_tensor generation:  0.0010037422180175781
mini_batch_src_global generation:  0.0011706352233886719
r_  generation:  0.009685993194580078
local_output_nid generation:  0.0016100406646728516
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.009823799133300781
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0011894702911376953
r_  generation:  0.010122299194335938
local_output_nid generation:  0.0016257762908935547
local_in_edges_tensor generation:  0.0010068416595458984
mini_batch_src_global generation:  0.001260995864868164
r_  generation:  0.010704517364501953
local_output_nid generation:  0.0016024112701416016
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.009963274002075195
local_output_nid generation:  0.001619577407836914
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.0012176036834716797
r_  generation:  0.010487794876098633
local_output_nid generation:  0.0016779899597167969
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.0012004375457763672
r_  generation:  0.010229110717773438
local_output_nid generation:  0.0016200542449951172
local_in_edges_tensor generation:  0.0009801387786865234
mini_batch_src_global generation:  0.0012536048889160156
r_  generation:  0.010125160217285156
local_output_nid generation:  0.0015916824340820312
local_in_edges_tensor generation:  0.0009737014770507812
mini_batch_src_global generation:  0.0012328624725341797
r_  generation:  0.010522603988647461
local_output_nid generation:  0.0016155242919921875
local_in_edges_tensor generation:  0.0009932518005371094
mini_batch_src_global generation:  0.0012516975402832031
r_  generation:  0.010952949523925781
local_output_nid generation:  0.0016510486602783203
local_in_edges_tensor generation:  0.0009815692901611328
mini_batch_src_global generation:  0.0013120174407958984
r_  generation:  0.010178327560424805
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.0012462139129638672
r_  generation:  0.01061248779296875
local_output_nid generation:  0.0016257762908935547
local_in_edges_tensor generation:  0.0009419918060302734
mini_batch_src_global generation:  0.0011615753173828125
r_  generation:  0.010128974914550781
local_output_nid generation:  0.0016596317291259766
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.001336812973022461
r_  generation:  0.01040029525756836
local_output_nid generation:  0.0016217231750488281
local_in_edges_tensor generation:  0.0009851455688476562
mini_batch_src_global generation:  0.0012900829315185547
r_  generation:  0.010575294494628906
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.0009732246398925781
mini_batch_src_global generation:  0.0012924671173095703
r_  generation:  0.010785102844238281
local_output_nid generation:  0.0016176700592041016
local_in_edges_tensor generation:  0.0009760856628417969
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.009987115859985352
local_output_nid generation:  0.0016183853149414062
local_in_edges_tensor generation:  0.0009906291961669922
mini_batch_src_global generation:  0.00140380859375
r_  generation:  0.010557174682617188
local_output_nid generation:  0.0016248226165771484
local_in_edges_tensor generation:  0.0009672641754150391
mini_batch_src_global generation:  0.0012869834899902344
r_  generation:  0.010956287384033203
local_output_nid generation:  0.001603841781616211
local_in_edges_tensor generation:  0.0009758472442626953
mini_batch_src_global generation:  0.0013523101806640625
r_  generation:  0.011257410049438477
local_output_nid generation:  0.0016446113586425781
local_in_edges_tensor generation:  0.0010027885437011719
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.01093149185180664
local_output_nid generation:  0.0016338825225830078
local_in_edges_tensor generation:  0.0009891986846923828
mini_batch_src_global generation:  0.001352071762084961
r_  generation:  0.010729312896728516
local_output_nid generation:  0.0016298294067382812
local_in_edges_tensor generation:  0.0009903907775878906
mini_batch_src_global generation:  0.0011982917785644531
r_  generation:  0.0104217529296875
local_output_nid generation:  0.0016596317291259766
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0011792182922363281
r_  generation:  0.010289669036865234
local_output_nid generation:  0.0016591548919677734
local_in_edges_tensor generation:  0.0009779930114746094
mini_batch_src_global generation:  0.0013194084167480469
r_  generation:  0.010643243789672852
local_output_nid generation:  0.0016202926635742188
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0013072490692138672
r_  generation:  0.010638236999511719
local_output_nid generation:  0.0016329288482666016
local_in_edges_tensor generation:  0.0009894371032714844
mini_batch_src_global generation:  0.0013134479522705078
r_  generation:  0.010370492935180664
local_output_nid generation:  0.0016112327575683594
local_in_edges_tensor generation:  0.000988006591796875
mini_batch_src_global generation:  0.0012431144714355469
r_  generation:  0.010760784149169922
local_output_nid generation:  0.0016510486602783203
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.0013093948364257812
r_  generation:  0.010437965393066406
----------------------check_connections_block total spend ----------------------------- 0.5816986560821533
generate_one_block  0.025545120239257812
generate_one_block  0.02201080322265625
generate_one_block  0.020084381103515625
generate_one_block  0.01867961883544922
generate_one_block  0.018598079681396484
generate_one_block  0.018744945526123047
generate_one_block  0.019624948501586914
generate_one_block  0.01835322380065918
generate_one_block  0.0191500186920166
generate_one_block  0.018476009368896484
generate_one_block  0.01849055290222168
generate_one_block  0.019220352172851562
generate_one_block  0.019609928131103516
generate_one_block  0.018419742584228516
generate_one_block  0.01913142204284668
generate_one_block  0.018271684646606445
generate_one_block  0.018720388412475586
generate_one_block  0.01922464370727539
generate_one_block  0.01927042007446289
generate_one_block  0.018301725387573242
generate_one_block  0.019197940826416016
generate_one_block  0.019812822341918945
generate_one_block  0.02003335952758789
generate_one_block  0.019708633422851562
generate_one_block  0.019277572631835938
generate_one_block  0.018511533737182617
generate_one_block  0.018308162689208984
generate_one_block  0.019164085388183594
generate_one_block  0.01914691925048828
generate_one_block  0.018626928329467773
generate_one_block  0.019028663635253906
generate_one_block  0.018613338470458984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04418206214904785
gen group dst list time:  0.02218770980834961
time for parepare:  0.02000117301940918
local_output_nid generation:  0.006869792938232422
local_in_edges_tensor generation:  0.014588594436645508
mini_batch_src_global generation:  0.016548633575439453
r_  generation:  0.16454195976257324
local_output_nid generation:  0.009332418441772461
local_in_edges_tensor generation:  0.011561870574951172
mini_batch_src_global generation:  0.02271246910095215
r_  generation:  0.16957998275756836
local_output_nid generation:  0.0096282958984375
local_in_edges_tensor generation:  0.03354001045227051
mini_batch_src_global generation:  0.01960611343383789
r_  generation:  0.17270874977111816
local_output_nid generation:  0.009572982788085938
local_in_edges_tensor generation:  0.010555028915405273
mini_batch_src_global generation:  0.020183801651000977
r_  generation:  0.17166638374328613
local_output_nid generation:  0.009710550308227539
local_in_edges_tensor generation:  0.010473012924194336
mini_batch_src_global generation:  0.020648956298828125
r_  generation:  0.17729759216308594
local_output_nid generation:  0.00970005989074707
local_in_edges_tensor generation:  0.010467290878295898
mini_batch_src_global generation:  0.022868633270263672
r_  generation:  0.1755976676940918
local_output_nid generation:  0.009658098220825195
local_in_edges_tensor generation:  0.012705564498901367
mini_batch_src_global generation:  0.022975921630859375
r_  generation:  0.1879127025604248
local_output_nid generation:  0.009391069412231445
local_in_edges_tensor generation:  0.009135007858276367
mini_batch_src_global generation:  0.022187471389770508
r_  generation:  0.1781158447265625
local_output_nid generation:  0.0094146728515625
local_in_edges_tensor generation:  0.01180577278137207
mini_batch_src_global generation:  0.02277827262878418
r_  generation:  0.18647384643554688
local_output_nid generation:  0.00975179672241211
local_in_edges_tensor generation:  0.010581016540527344
mini_batch_src_global generation:  0.022937536239624023
r_  generation:  0.1805250644683838
local_output_nid generation:  0.009621620178222656
local_in_edges_tensor generation:  0.010430574417114258
mini_batch_src_global generation:  0.0222625732421875
r_  generation:  0.17955493927001953
local_output_nid generation:  0.009894132614135742
local_in_edges_tensor generation:  0.010990381240844727
mini_batch_src_global generation:  0.023613691329956055
r_  generation:  0.18633413314819336
local_output_nid generation:  0.010113716125488281
local_in_edges_tensor generation:  0.010699748992919922
mini_batch_src_global generation:  0.0253140926361084
r_  generation:  0.19273757934570312
local_output_nid generation:  0.009661197662353516
local_in_edges_tensor generation:  0.008991241455078125
mini_batch_src_global generation:  0.022804737091064453
r_  generation:  0.17786312103271484
local_output_nid generation:  0.009889841079711914
local_in_edges_tensor generation:  0.013345479965209961
mini_batch_src_global generation:  0.024680137634277344
r_  generation:  0.18914175033569336
local_output_nid generation:  0.00964045524597168
local_in_edges_tensor generation:  0.009366273880004883
mini_batch_src_global generation:  0.0224611759185791
r_  generation:  0.17799615859985352
local_output_nid generation:  0.009727001190185547
local_in_edges_tensor generation:  0.011056184768676758
mini_batch_src_global generation:  0.024171829223632812
r_  generation:  0.18423771858215332
local_output_nid generation:  0.01002812385559082
local_in_edges_tensor generation:  0.013815879821777344
mini_batch_src_global generation:  0.023371219635009766
r_  generation:  0.1850452423095703
local_output_nid generation:  0.01002192497253418
local_in_edges_tensor generation:  0.010783910751342773
mini_batch_src_global generation:  0.02390456199645996
r_  generation:  0.1902763843536377
local_output_nid generation:  0.009256362915039062
local_in_edges_tensor generation:  0.008993864059448242
mini_batch_src_global generation:  0.022159814834594727
r_  generation:  0.17383193969726562
local_output_nid generation:  0.009624004364013672
local_in_edges_tensor generation:  0.012021303176879883
mini_batch_src_global generation:  0.023469209671020508
r_  generation:  0.1866011619567871
local_output_nid generation:  0.0098114013671875
local_in_edges_tensor generation:  0.012815713882446289
mini_batch_src_global generation:  0.02422308921813965
r_  generation:  0.19276833534240723
local_output_nid generation:  0.009807109832763672
local_in_edges_tensor generation:  0.012916088104248047
mini_batch_src_global generation:  0.02463841438293457
r_  generation:  0.1933307647705078
local_output_nid generation:  0.009755611419677734
local_in_edges_tensor generation:  0.010862350463867188
mini_batch_src_global generation:  0.024058103561401367
r_  generation:  0.18754172325134277
local_output_nid generation:  0.00958561897277832
local_in_edges_tensor generation:  0.010505437850952148
mini_batch_src_global generation:  0.023660659790039062
r_  generation:  0.18737101554870605
local_output_nid generation:  0.009451627731323242
local_in_edges_tensor generation:  0.009290695190429688
mini_batch_src_global generation:  0.02300715446472168
r_  generation:  0.18140792846679688
local_output_nid generation:  0.009251832962036133
local_in_edges_tensor generation:  0.009306907653808594
mini_batch_src_global generation:  0.022311925888061523
r_  generation:  0.17878150939941406
local_output_nid generation:  0.009584903717041016
local_in_edges_tensor generation:  0.010424613952636719
mini_batch_src_global generation:  0.02355480194091797
r_  generation:  0.18834471702575684
local_output_nid generation:  0.009455442428588867
local_in_edges_tensor generation:  0.010875225067138672
mini_batch_src_global generation:  0.0235750675201416
r_  generation:  0.18679547309875488
local_output_nid generation:  0.009327888488769531
local_in_edges_tensor generation:  0.00924062728881836
mini_batch_src_global generation:  0.02317047119140625
r_  generation:  0.183119535446167
local_output_nid generation:  0.00934290885925293
local_in_edges_tensor generation:  0.01202392578125
mini_batch_src_global generation:  0.0248563289642334
r_  generation:  0.18643712997436523
local_output_nid generation:  0.009393930435180664
local_in_edges_tensor generation:  0.00929713249206543
mini_batch_src_global generation:  0.023357629776000977
r_  generation:  0.18552398681640625
----------------------check_connections_block total spend ----------------------------- 8.569501638412476
generate_one_block  0.23958468437194824
generate_one_block  0.23793816566467285
generate_one_block  0.24376463890075684
generate_one_block  0.23580694198608398
generate_one_block  0.2646958827972412
generate_one_block  0.24150466918945312
generate_one_block  0.2633390426635742
generate_one_block  0.23578906059265137
generate_one_block  0.25394773483276367
generate_one_block  0.24109411239624023
generate_one_block  0.2406330108642578
generate_one_block  0.2547025680541992
generate_one_block  0.2624959945678711
generate_one_block  0.23510050773620605
generate_one_block  0.25096726417541504
generate_one_block  0.23401403427124023
generate_one_block  0.24244117736816406
generate_one_block  0.25298070907592773
generate_one_block  0.25661420822143555
generate_one_block  0.23388934135437012
generate_one_block  0.24583196640014648
generate_one_block  0.267078161239624
generate_one_block  0.25895261764526367
generate_one_block  0.24802923202514648
generate_one_block  0.25068092346191406
generate_one_block  0.2414391040802002
generate_one_block  0.23503541946411133
generate_one_block  0.2589879035949707
generate_one_block  0.2570457458496094
generate_one_block  0.2504405975341797
generate_one_block  0.24973201751708984
generate_one_block  0.2460005283355713
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04187583923339844
gen group dst list time:  0.10206079483032227
time for parepare:  0.018537282943725586
local_output_nid generation:  0.026175737380981445
local_in_edges_tensor generation:  0.040177345275878906
mini_batch_src_global generation:  0.046262502670288086
r_  generation:  0.4816563129425049
local_output_nid generation:  0.03221487998962402
local_in_edges_tensor generation:  0.04857206344604492
mini_batch_src_global generation:  0.05934786796569824
r_  generation:  0.494234561920166
local_output_nid generation:  0.03143787384033203
local_in_edges_tensor generation:  0.04425764083862305
mini_batch_src_global generation:  0.05772900581359863
r_  generation:  0.5038306713104248
local_output_nid generation:  0.030419349670410156
local_in_edges_tensor generation:  0.030623435974121094
mini_batch_src_global generation:  0.05878329277038574
r_  generation:  0.4895639419555664
local_output_nid generation:  0.03040480613708496
local_in_edges_tensor generation:  0.03939008712768555
mini_batch_src_global generation:  0.05900907516479492
r_  generation:  0.5022046566009521
local_output_nid generation:  0.0303955078125
local_in_edges_tensor generation:  0.03922843933105469
mini_batch_src_global generation:  0.05981588363647461
r_  generation:  0.49421167373657227
local_output_nid generation:  0.031085491180419922
local_in_edges_tensor generation:  0.04008078575134277
mini_batch_src_global generation:  0.06311297416687012
r_  generation:  0.5066876411437988
local_output_nid generation:  0.030790090560913086
local_in_edges_tensor generation:  0.03075885772705078
mini_batch_src_global generation:  0.06001639366149902
r_  generation:  0.5021719932556152
local_output_nid generation:  0.03047800064086914
local_in_edges_tensor generation:  0.03032398223876953
mini_batch_src_global generation:  0.06385111808776855
r_  generation:  0.5111141204833984
local_output_nid generation:  0.030512094497680664
local_in_edges_tensor generation:  0.030855655670166016
mini_batch_src_global generation:  0.05972433090209961
r_  generation:  0.49314451217651367
local_output_nid generation:  0.03046870231628418
local_in_edges_tensor generation:  0.03467249870300293
mini_batch_src_global generation:  0.059520721435546875
r_  generation:  0.5066771507263184
local_output_nid generation:  0.030692100524902344
local_in_edges_tensor generation:  0.045714616775512695
mini_batch_src_global generation:  0.060053348541259766
r_  generation:  0.4973900318145752
local_output_nid generation:  0.03062748908996582
local_in_edges_tensor generation:  0.048681020736694336
mini_batch_src_global generation:  0.058792829513549805
r_  generation:  0.5038354396820068
local_output_nid generation:  0.030459165573120117
local_in_edges_tensor generation:  0.030658245086669922
mini_batch_src_global generation:  0.06050276756286621
r_  generation:  0.4905974864959717
local_output_nid generation:  0.030843019485473633
local_in_edges_tensor generation:  0.03115677833557129
mini_batch_src_global generation:  0.05994296073913574
r_  generation:  0.5025458335876465
local_output_nid generation:  0.034088850021362305
local_in_edges_tensor generation:  0.03367805480957031
mini_batch_src_global generation:  0.06035971641540527
r_  generation:  0.5018947124481201
local_output_nid generation:  0.030812740325927734
local_in_edges_tensor generation:  0.0348048210144043
mini_batch_src_global generation:  0.06254196166992188
r_  generation:  0.4983084201812744
local_output_nid generation:  0.030693531036376953
local_in_edges_tensor generation:  0.04385685920715332
mini_batch_src_global generation:  0.05988812446594238
r_  generation:  0.4981405735015869
local_output_nid generation:  0.03139662742614746
local_in_edges_tensor generation:  0.042203426361083984
mini_batch_src_global generation:  0.0631248950958252
r_  generation:  0.5038111209869385
local_output_nid generation:  0.030524253845214844
local_in_edges_tensor generation:  0.03750324249267578
mini_batch_src_global generation:  0.05995607376098633
r_  generation:  0.5120830535888672
local_output_nid generation:  0.032706499099731445
local_in_edges_tensor generation:  0.0445551872253418
mini_batch_src_global generation:  0.06314897537231445
r_  generation:  0.5049467086791992
local_output_nid generation:  0.031981468200683594
local_in_edges_tensor generation:  0.05225014686584473
mini_batch_src_global generation:  0.06549453735351562
r_  generation:  0.5083348751068115
local_output_nid generation:  0.03307914733886719
local_in_edges_tensor generation:  0.03754019737243652
mini_batch_src_global generation:  0.06126904487609863
r_  generation:  0.5027382373809814
local_output_nid generation:  0.03189516067504883
local_in_edges_tensor generation:  0.03495454788208008
mini_batch_src_global generation:  0.061006784439086914
r_  generation:  0.5007083415985107
local_output_nid generation:  0.031609296798706055
local_in_edges_tensor generation:  0.035516977310180664
mini_batch_src_global generation:  0.06337428092956543
r_  generation:  0.5027742385864258
local_output_nid generation:  0.03136563301086426
local_in_edges_tensor generation:  0.030947208404541016
mini_batch_src_global generation:  0.06063055992126465
r_  generation:  0.5045535564422607
local_output_nid generation:  0.033826351165771484
local_in_edges_tensor generation:  0.03169655799865723
mini_batch_src_global generation:  0.05982542037963867
r_  generation:  0.4974689483642578
local_output_nid generation:  0.03162407875061035
local_in_edges_tensor generation:  0.03084564208984375
mini_batch_src_global generation:  0.06061077117919922
r_  generation:  0.4973161220550537
local_output_nid generation:  0.03139901161193848
local_in_edges_tensor generation:  0.04000997543334961
mini_batch_src_global generation:  0.05966830253601074
r_  generation:  0.507286548614502
local_output_nid generation:  0.03125810623168945
local_in_edges_tensor generation:  0.030986785888671875
mini_batch_src_global generation:  0.06067085266113281
r_  generation:  0.4965078830718994
local_output_nid generation:  0.03141212463378906
local_in_edges_tensor generation:  0.030435562133789062
mini_batch_src_global generation:  0.06318044662475586
r_  generation:  0.5189716815948486
local_output_nid generation:  0.031217575073242188
local_in_edges_tensor generation:  0.04432225227355957
mini_batch_src_global generation:  0.059615373611450195
r_  generation:  0.5032474994659424
----------------------check_connections_block total spend ----------------------------- 23.65993356704712
generate_one_block  0.7033696174621582
generate_one_block  0.6894617080688477
generate_one_block  0.6852245330810547
generate_one_block  0.6687002182006836
generate_one_block  0.769702672958374
generate_one_block  0.6848495006561279
generate_one_block  0.6904234886169434
generate_one_block  0.6694269180297852
generate_one_block  0.6849031448364258
generate_one_block  0.6640970706939697
generate_one_block  0.6635837554931641
generate_one_block  0.7018053531646729
generate_one_block  0.6904251575469971
generate_one_block  0.6664555072784424
generate_one_block  0.6918878555297852
generate_one_block  0.6685671806335449
generate_one_block  0.6825942993164062
generate_one_block  0.6878015995025635
generate_one_block  0.6925733089447021
generate_one_block  0.6588013172149658
generate_one_block  0.6659095287322998
generate_one_block  0.6816954612731934
generate_one_block  0.6874105930328369
generate_one_block  0.6754772663116455
generate_one_block  0.7027285099029541
generate_one_block  0.6728343963623047
generate_one_block  0.6651389598846436
generate_one_block  0.70060133934021
generate_one_block  0.6789562702178955
generate_one_block  0.6644062995910645
generate_one_block  0.6651952266693115
generate_one_block  0.6832983493804932
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.11302757263183594  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

connection checking time:  32.229435205459595
block generation total time  29.788864374160767
average batch blocks generation time:  0.930902011692524
block dataloader generation time/epoch 65.93250608444214
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09127473831176758  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150072, 128])
torch.Size([109612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.053719520568848  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09062910079956055  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150279, 128])
torch.Size([109790, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.048634052276611  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09128761291503906  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150748, 128])
torch.Size([109920, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.064136981964111  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09046602249145508  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150191, 128])
torch.Size([108578, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.945187091827393  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09116077423095703  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150462, 128])
torch.Size([109648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.000460624694824  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09063577651977539  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150413, 128])
torch.Size([109630, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.026479244232178  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09160804748535156  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150576, 128])
torch.Size([111052, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.21521806716919  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09067344665527344  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150512, 128])
torch.Size([109332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.006993770599365  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.0914926528930664  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150189, 128])
torch.Size([109812, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.135149478912354  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09050798416137695  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149971, 128])
torch.Size([109147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.017410278320312  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.0911722183227539  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149961, 128])
torch.Size([108478, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.96581220626831  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09081840515136719  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150158, 128])
torch.Size([109911, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.147337913513184  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09158897399902344  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149574, 128])
torch.Size([109725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.176636695861816  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09036397933959961  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149915, 128])
torch.Size([108928, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.984160423278809  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09153079986572266  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150595, 128])
torch.Size([110569, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.193431854248047  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09052038192749023  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150361, 128])
torch.Size([109215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.946458339691162  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.0913248062133789  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150398, 128])
torch.Size([109613, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.060328006744385  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09087038040161133  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150329, 128])
torch.Size([110187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.109927654266357  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09158992767333984  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150597, 128])
torch.Size([111359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.21073579788208  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09009742736816406  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149800, 128])
torch.Size([107943, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 12.864392280578613  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.09141731262207031  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150007, 128])
torch.Size([110018, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 13.132962226867676  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0604248046875 GB
    Memory Allocated: 0.0911874771118164  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150508, 128])
torch.Size([110841, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.222729682922363  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.0916604995727539  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150444, 128])
torch.Size([110935, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.205210208892822  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09108829498291016  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150712, 128])
torch.Size([110492, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.141510486602783  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09150981903076172  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150543, 128])
torch.Size([110821, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.167415142059326  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09057378768920898  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150213, 128])
torch.Size([109741, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.043946266174316  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09106731414794922  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150160, 128])
torch.Size([108627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 12.935211658477783  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09098100662231445  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150477, 128])
torch.Size([110431, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.145604133605957  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09140968322753906  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([150394, 128])
torch.Size([109931, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.0764479637146  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09036684036254883  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149683, 128])
torch.Size([108426, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 12.985269546508789  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09141349792480469  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149843, 128])
torch.Size([109274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.097474098205566  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 0.09042978286743164  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

torch.Size([149779, 128])
torch.Size([109242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0643310546875 GB
    Memory Allocated: 13.029022693634033  GigaBytes
Max Memory Allocated: 13.287485122680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026612617075443268 |0.022755347192287445 |0.6121803671121597 |9.963661432266235e-05 |0.9968243315815926 |0.01367497444152832 |
----------------------------------------------------------pseudo_mini_loss sum 3.6914844512939453
Total (block generation + training)time/epoch 119.12701296806335
Training time/epoch 53.19423866271973
Training time without block to device /epoch 52.46606755256653
Training time without total dataloading part /epoch 51.50501370429993
load block tensor time/epoch 0.8516037464141846
block to device time/epoch 0.7281711101531982
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9158527
Number of first layer input nodes during this epoch:  4807864
