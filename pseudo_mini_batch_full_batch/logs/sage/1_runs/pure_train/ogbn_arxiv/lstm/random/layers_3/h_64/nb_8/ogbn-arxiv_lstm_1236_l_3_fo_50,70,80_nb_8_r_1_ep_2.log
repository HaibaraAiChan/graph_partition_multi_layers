Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648459003.4080656
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027164697647094727
random selection method range initialization spend 0.006378173828125
time for parepare:  0.019251108169555664
local_output_nid generation:  0.004348278045654297
local_in_edges_tensor generation:  0.005113124847412109
mini_batch_src_global generation:  0.003949642181396484
r_  generation:  0.04305434226989746
local_output_nid generation:  0.0060749053955078125
local_in_edges_tensor generation:  0.0033011436462402344
mini_batch_src_global generation:  0.004914999008178711
r_  generation:  0.04428887367248535
local_output_nid generation:  0.0061304569244384766
local_in_edges_tensor generation:  0.0032885074615478516
mini_batch_src_global generation:  0.003412008285522461
r_  generation:  0.04424333572387695
local_output_nid generation:  0.006220579147338867
local_in_edges_tensor generation:  0.0033164024353027344
mini_batch_src_global generation:  0.0036263465881347656
r_  generation:  0.047083377838134766
local_output_nid generation:  0.006117582321166992
local_in_edges_tensor generation:  0.003274202346801758
mini_batch_src_global generation:  0.0038886070251464844
r_  generation:  0.046744346618652344
local_output_nid generation:  0.006222963333129883
local_in_edges_tensor generation:  0.0033431053161621094
mini_batch_src_global generation:  0.0041637420654296875
r_  generation:  0.04835247993469238
local_output_nid generation:  0.006173849105834961
local_in_edges_tensor generation:  0.003252744674682617
mini_batch_src_global generation:  0.004184246063232422
r_  generation:  0.04813241958618164
local_output_nid generation:  0.006133556365966797
local_in_edges_tensor generation:  0.003293275833129883
mini_batch_src_global generation:  0.004103422164916992
r_  generation:  0.047818660736083984
----------------------check_connections_block total spend ----------------------------- 0.585371732711792
generate_one_block  0.06180882453918457
generate_one_block  0.06232023239135742
generate_one_block  0.06114697456359863
generate_one_block  0.06326413154602051
generate_one_block  0.0659630298614502
generate_one_block  0.0628366470336914
generate_one_block  0.0627291202545166
generate_one_block  0.06222963333129883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040578603744506836
gen group dst list time:  0.016600608825683594
time for parepare:  0.019814014434814453
local_output_nid generation:  0.014805793762207031
local_in_edges_tensor generation:  0.034934043884277344
mini_batch_src_global generation:  0.04003190994262695
r_  generation:  0.3642427921295166
local_output_nid generation:  0.02088332176208496
local_in_edges_tensor generation:  0.033674001693725586
mini_batch_src_global generation:  0.046256303787231445
r_  generation:  0.3736233711242676
local_output_nid generation:  0.01995539665222168
local_in_edges_tensor generation:  0.030550718307495117
mini_batch_src_global generation:  0.04573845863342285
r_  generation:  0.3982536792755127
local_output_nid generation:  0.02417898178100586
local_in_edges_tensor generation:  0.03621816635131836
mini_batch_src_global generation:  0.05545186996459961
r_  generation:  0.3826258182525635
local_output_nid generation:  0.020898103713989258
local_in_edges_tensor generation:  0.03245806694030762
mini_batch_src_global generation:  0.0469517707824707
r_  generation:  0.3799710273742676
local_output_nid generation:  0.021114826202392578
local_in_edges_tensor generation:  0.02468109130859375
mini_batch_src_global generation:  0.051047325134277344
r_  generation:  0.38344812393188477
local_output_nid generation:  0.02094435691833496
local_in_edges_tensor generation:  0.020570039749145508
mini_batch_src_global generation:  0.04784846305847168
r_  generation:  0.3839402198791504
local_output_nid generation:  0.02101898193359375
local_in_edges_tensor generation:  0.023839473724365234
mini_batch_src_global generation:  0.0480196475982666
r_  generation:  0.3815324306488037
----------------------check_connections_block total spend ----------------------------- 4.497185707092285
generate_one_block  0.5127131938934326
generate_one_block  0.5243637561798096
generate_one_block  0.5254511833190918
generate_one_block  0.5106017589569092
generate_one_block  0.5020933151245117
generate_one_block  0.5219781398773193
generate_one_block  0.4963083267211914
generate_one_block  0.48673248291015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039354801177978516
gen group dst list time:  0.037713050842285156
time for parepare:  0.021208763122558594
local_output_nid generation:  0.02985548973083496
local_in_edges_tensor generation:  0.06265497207641602
mini_batch_src_global generation:  0.05759382247924805
r_  generation:  0.5448610782623291
local_output_nid generation:  0.0355830192565918
local_in_edges_tensor generation:  0.05820155143737793
mini_batch_src_global generation:  0.0781095027923584
r_  generation:  0.605161190032959
local_output_nid generation:  0.03555107116699219
local_in_edges_tensor generation:  0.04104804992675781
mini_batch_src_global generation:  0.06808781623840332
r_  generation:  0.5641279220581055
local_output_nid generation:  0.03568911552429199
local_in_edges_tensor generation:  0.04664874076843262
mini_batch_src_global generation:  0.06865262985229492
r_  generation:  0.6021754741668701
local_output_nid generation:  0.037604331970214844
local_in_edges_tensor generation:  0.051453590393066406
mini_batch_src_global generation:  0.09092116355895996
r_  generation:  0.5862882137298584
local_output_nid generation:  0.0379488468170166
local_in_edges_tensor generation:  0.04612398147583008
mini_batch_src_global generation:  0.06780004501342773
r_  generation:  0.5738866329193115
local_output_nid generation:  0.03690218925476074
local_in_edges_tensor generation:  0.04023575782775879
mini_batch_src_global generation:  0.06394696235656738
r_  generation:  0.5751910209655762
local_output_nid generation:  0.03666329383850098
local_in_edges_tensor generation:  0.03570437431335449
mini_batch_src_global generation:  0.06541037559509277
r_  generation:  0.5696940422058105
----------------------check_connections_block total spend ----------------------------- 6.908758640289307
generate_one_block  0.7535402774810791
generate_one_block  0.7279052734375
generate_one_block  0.7008864879608154
generate_one_block  0.7256038188934326
generate_one_block  0.6947386264801025
generate_one_block  0.7179102897644043
generate_one_block  0.7734766006469727
generate_one_block  0.709963321685791
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  11.405944347381592
block generation total time  9.88426685333252
average batch blocks generation time:  1.235533356666565
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10242366790771484  GigaBytes
Max Memory Allocated: 0.10242366790771484  GigaBytes

torch.Size([162535, 128])
torch.Size([146092, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9490966796875 GB
    Memory Allocated: 18.46234655380249  GigaBytes
Max Memory Allocated: 18.494014739990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5545654296875 GB
    Memory Allocated: 0.10538911819458008  GigaBytes
Max Memory Allocated: 18.494014739990234  GigaBytes

torch.Size([162658, 128])
torch.Size([145935, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5780029296875 GB
    Memory Allocated: 18.441024780273438  GigaBytes
Max Memory Allocated: 18.494014739990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5780029296875 GB
    Memory Allocated: 0.10593652725219727  GigaBytes
Max Memory Allocated: 18.494014739990234  GigaBytes

torch.Size([162391, 128])
torch.Size([145419, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5780029296875 GB
    Memory Allocated: 18.363253116607666  GigaBytes
Max Memory Allocated: 18.494014739990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8651123046875 GB
    Memory Allocated: 0.1054997444152832  GigaBytes
Max Memory Allocated: 18.494014739990234  GigaBytes

torch.Size([162854, 128])
torch.Size([146700, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8651123046875 GB
    Memory Allocated: 18.531344890594482  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1600341796875 GB
    Memory Allocated: 0.10596036911010742  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162530, 128])
torch.Size([145931, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1600341796875 GB
    Memory Allocated: 18.443243503570557  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1600341796875 GB
    Memory Allocated: 0.10537385940551758  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162602, 128])
torch.Size([146011, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1600341796875 GB
    Memory Allocated: 18.500325679779053  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1600341796875 GB
    Memory Allocated: 0.10630178451538086  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162574, 128])
torch.Size([145720, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.447444915771484  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10491752624511719  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162475, 128])
torch.Size([145678, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.423999786376953  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04089900851249695 |0.06845834851264954 |0.7982175052165985 |0.00012895464897155762 |1.1906146109104156 |0.016445398330688477 |
----------------------------------------------------------pseudo_mini_loss sum 4.941246509552002
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057127
Number of first layer input nodes during this epoch:  1300619
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.14331817626953125  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029433250427246094
random selection method range initialization spend 0.005393028259277344
time for parepare:  0.018171072006225586
local_output_nid generation:  0.005133390426635742
local_in_edges_tensor generation:  0.009986162185668945
mini_batch_src_global generation:  0.004004001617431641
r_  generation:  0.04191923141479492
local_output_nid generation:  0.006355762481689453
local_in_edges_tensor generation:  0.0038743019104003906
mini_batch_src_global generation:  0.005000591278076172
r_  generation:  0.04603075981140137
local_output_nid generation:  0.00648808479309082
local_in_edges_tensor generation:  0.003937959671020508
mini_batch_src_global generation:  0.0034265518188476562
r_  generation:  0.04582977294921875
local_output_nid generation:  0.006564617156982422
local_in_edges_tensor generation:  0.00395965576171875
mini_batch_src_global generation:  0.0036411285400390625
r_  generation:  0.04706001281738281
local_output_nid generation:  0.00658106803894043
local_in_edges_tensor generation:  0.003939151763916016
mini_batch_src_global generation:  0.004016399383544922
r_  generation:  0.04874873161315918
local_output_nid generation:  0.006540060043334961
local_in_edges_tensor generation:  0.0038216114044189453
mini_batch_src_global generation:  0.004064798355102539
r_  generation:  0.048890113830566406
local_output_nid generation:  0.006567955017089844
local_in_edges_tensor generation:  0.003902435302734375
mini_batch_src_global generation:  0.0040912628173828125
r_  generation:  0.049173593521118164
local_output_nid generation:  0.006537914276123047
local_in_edges_tensor generation:  0.0038368701934814453
mini_batch_src_global generation:  0.00426030158996582
r_  generation:  0.049730539321899414
----------------------check_connections_block total spend ----------------------------- 0.605637788772583
generate_one_block  0.07764673233032227
generate_one_block  0.07660365104675293
generate_one_block  0.07664608955383301
generate_one_block  0.07946491241455078
generate_one_block  0.07665085792541504
generate_one_block  0.07867050170898438
generate_one_block  0.0865018367767334
generate_one_block  0.08001089096069336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042322635650634766
gen group dst list time:  0.016518354415893555
time for parepare:  0.022430419921875
local_output_nid generation:  0.015323638916015625
local_in_edges_tensor generation:  0.03806567192077637
mini_batch_src_global generation:  0.03853344917297363
r_  generation:  0.3651599884033203
local_output_nid generation:  0.021013975143432617
local_in_edges_tensor generation:  0.03514385223388672
mini_batch_src_global generation:  0.04790043830871582
r_  generation:  0.3895456790924072
local_output_nid generation:  0.02039194107055664
local_in_edges_tensor generation:  0.028732776641845703
mini_batch_src_global generation:  0.04784679412841797
r_  generation:  0.3985733985900879
local_output_nid generation:  0.021270275115966797
local_in_edges_tensor generation:  0.03998255729675293
mini_batch_src_global generation:  0.05938720703125
r_  generation:  0.376878023147583
local_output_nid generation:  0.021724462509155273
local_in_edges_tensor generation:  0.025383949279785156
mini_batch_src_global generation:  0.0469365119934082
r_  generation:  0.38037824630737305
local_output_nid generation:  0.020865678787231445
local_in_edges_tensor generation:  0.023966312408447266
mini_batch_src_global generation:  0.05031538009643555
r_  generation:  0.3820624351501465
local_output_nid generation:  0.020718097686767578
local_in_edges_tensor generation:  0.024697303771972656
mini_batch_src_global generation:  0.047411441802978516
r_  generation:  0.38138747215270996
local_output_nid generation:  0.02114701271057129
local_in_edges_tensor generation:  0.02861928939819336
mini_batch_src_global generation:  0.04836106300354004
r_  generation:  0.3844001293182373
----------------------check_connections_block total spend ----------------------------- 4.52363657951355
generate_one_block  0.5530440807342529
generate_one_block  0.5466070175170898
generate_one_block  0.5364518165588379
generate_one_block  0.5911030769348145
generate_one_block  0.5358421802520752
generate_one_block  0.5227575302124023
generate_one_block  0.5216479301452637
generate_one_block  0.5588312149047852
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04186391830444336
gen group dst list time:  0.03948616981506348
time for parepare:  0.019569873809814453
local_output_nid generation:  0.03186774253845215
local_in_edges_tensor generation:  0.06653928756713867
mini_batch_src_global generation:  0.053687095642089844
r_  generation:  0.5402095317840576
local_output_nid generation:  0.03706502914428711
local_in_edges_tensor generation:  0.05786275863647461
mini_batch_src_global generation:  0.06706047058105469
r_  generation:  0.5634937286376953
local_output_nid generation:  0.03651094436645508
local_in_edges_tensor generation:  0.05435538291931152
mini_batch_src_global generation:  0.06240510940551758
r_  generation:  0.5577189922332764
local_output_nid generation:  0.036407470703125
local_in_edges_tensor generation:  0.04349517822265625
mini_batch_src_global generation:  0.06098628044128418
r_  generation:  0.56315016746521
local_output_nid generation:  0.03641009330749512
local_in_edges_tensor generation:  0.04301905632019043
mini_batch_src_global generation:  0.062105655670166016
r_  generation:  0.5758352279663086
local_output_nid generation:  0.0362856388092041
local_in_edges_tensor generation:  0.0488278865814209
mini_batch_src_global generation:  0.06344938278198242
r_  generation:  0.5729410648345947
local_output_nid generation:  0.03757166862487793
local_in_edges_tensor generation:  0.04922771453857422
mini_batch_src_global generation:  0.06915116310119629
r_  generation:  0.5881562232971191
local_output_nid generation:  0.04014992713928223
local_in_edges_tensor generation:  0.05418896675109863
mini_batch_src_global generation:  0.06405830383300781
r_  generation:  0.5712082386016846
----------------------check_connections_block total spend ----------------------------- 6.80070948600769
generate_one_block  0.7869725227355957
generate_one_block  0.7583975791931152
generate_one_block  0.7470564842224121
generate_one_block  0.7513062953948975
generate_one_block  0.7633872032165527
generate_one_block  0.7485995292663574
generate_one_block  0.7476158142089844
generate_one_block  0.743544340133667
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.14331817626953125  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

connection checking time:  11.32434606552124
block generation total time  10.413164615631104
average batch blocks generation time:  1.301645576953888
block dataloader generation time/epoch 24.51587986946106
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10764408111572266  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162346, 128])
torch.Size([145384, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.39842987060547  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.1066446304321289  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162708, 128])
torch.Size([146122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.523760318756104  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10795974731445312  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162827, 128])
torch.Size([146171, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.51403284072876  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.1066446304321289  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162630, 128])
torch.Size([145932, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.421043872833252  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10766267776489258  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162691, 128])
torch.Size([145927, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.447906970977783  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10710668563842773  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162676, 128])
torch.Size([146105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.468669414520264  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10834312438964844  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162605, 128])
torch.Size([145784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.43432092666626  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 0.10709667205810547  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

torch.Size([162633, 128])
torch.Size([146350, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1697998046875 GB
    Memory Allocated: 18.50359344482422  GigaBytes
Max Memory Allocated: 18.56488609313965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035453349351882935 |0.02827274799346924 |0.6738008558750153 |0.00011339783668518066 |1.1676319241523743 |0.0031349658966064453 |
----------------------------------------------------------pseudo_mini_loss sum 3.796949863433838
Total (block generation + training)time/epoch 39.7951877117157
Training time/epoch 15.279051065444946
Training time without block to device /epoch 15.052869081497192
Training time without total dataloading part /epoch 14.735504388809204
load block tensor time/epoch 0.2836267948150635
block to device time/epoch 0.2261819839477539
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3058138
Number of first layer input nodes during this epoch:  1301116
