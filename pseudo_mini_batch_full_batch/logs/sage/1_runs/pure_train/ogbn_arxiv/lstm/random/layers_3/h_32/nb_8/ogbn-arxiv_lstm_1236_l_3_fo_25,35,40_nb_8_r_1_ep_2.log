Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648453555.6281784
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02533721923828125
random selection method range initialization spend 0.006135225296020508
time for parepare:  0.018094778060913086
local_output_nid generation:  0.004152059555053711
local_in_edges_tensor generation:  0.006510019302368164
mini_batch_src_global generation:  0.0030584335327148438
r_  generation:  0.035655975341796875
local_output_nid generation:  0.005385875701904297
local_in_edges_tensor generation:  0.0031294822692871094
mini_batch_src_global generation:  0.004068136215209961
r_  generation:  0.038225412368774414
local_output_nid generation:  0.005973339080810547
local_in_edges_tensor generation:  0.0032002925872802734
mini_batch_src_global generation:  0.0027985572814941406
r_  generation:  0.03826451301574707
local_output_nid generation:  0.006048917770385742
local_in_edges_tensor generation:  0.0031936168670654297
mini_batch_src_global generation:  0.002864360809326172
r_  generation:  0.038599491119384766
local_output_nid generation:  0.006039857864379883
local_in_edges_tensor generation:  0.002989530563354492
mini_batch_src_global generation:  0.0029802322387695312
r_  generation:  0.040166378021240234
local_output_nid generation:  0.006100177764892578
local_in_edges_tensor generation:  0.0032312870025634766
mini_batch_src_global generation:  0.0030813217163085938
r_  generation:  0.039644718170166016
local_output_nid generation:  0.006053924560546875
local_in_edges_tensor generation:  0.0029947757720947266
mini_batch_src_global generation:  0.0031633377075195312
r_  generation:  0.03980517387390137
local_output_nid generation:  0.006082773208618164
local_in_edges_tensor generation:  0.003118753433227539
mini_batch_src_global generation:  0.0030624866485595703
r_  generation:  0.03953099250793457
----------------------check_connections_block total spend ----------------------------- 0.5011746883392334
generate_one_block  0.05438733100891113
generate_one_block  0.05588531494140625
generate_one_block  0.05478858947753906
generate_one_block  0.055022478103637695
generate_one_block  0.058599233627319336
generate_one_block  0.05419516563415527
generate_one_block  0.05472397804260254
generate_one_block  0.0547335147857666
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04044508934020996
gen group dst list time:  0.014936447143554688
time for parepare:  0.019075870513916016
local_output_nid generation:  0.013052225112915039
local_in_edges_tensor generation:  0.034061431884765625
mini_batch_src_global generation:  0.026706457138061523
r_  generation:  0.2830312252044678
local_output_nid generation:  0.018656492233276367
local_in_edges_tensor generation:  0.029653549194335938
mini_batch_src_global generation:  0.034973859786987305
r_  generation:  0.29986047744750977
local_output_nid generation:  0.017942428588867188
local_in_edges_tensor generation:  0.0270841121673584
mini_batch_src_global generation:  0.03471827507019043
r_  generation:  0.30319690704345703
local_output_nid generation:  0.01808905601501465
local_in_edges_tensor generation:  0.01868891716003418
mini_batch_src_global generation:  0.035941123962402344
r_  generation:  0.30533361434936523
local_output_nid generation:  0.018107891082763672
local_in_edges_tensor generation:  0.022029638290405273
mini_batch_src_global generation:  0.037612199783325195
r_  generation:  0.31246209144592285
local_output_nid generation:  0.018248558044433594
local_in_edges_tensor generation:  0.021820545196533203
mini_batch_src_global generation:  0.03684115409851074
r_  generation:  0.3076634407043457
local_output_nid generation:  0.01810479164123535
local_in_edges_tensor generation:  0.019788742065429688
mini_batch_src_global generation:  0.037020206451416016
r_  generation:  0.3128018379211426
local_output_nid generation:  0.017992019653320312
local_in_edges_tensor generation:  0.024581432342529297
mini_batch_src_global generation:  0.03892636299133301
r_  generation:  0.3066880702972412
----------------------check_connections_block total spend ----------------------------- 3.592108726501465
generate_one_block  0.39365458488464355
generate_one_block  0.399733304977417
generate_one_block  0.394824743270874
generate_one_block  0.397136926651001
generate_one_block  0.40533447265625
generate_one_block  0.4011361598968506
generate_one_block  0.38402843475341797
generate_one_block  0.38916730880737305
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03668951988220215
gen group dst list time:  0.035643815994262695
time for parepare:  0.019040346145629883
local_output_nid generation:  0.028764009475708008
local_in_edges_tensor generation:  0.044356584548950195
mini_batch_src_global generation:  0.04421591758728027
r_  generation:  0.4795646667480469
local_output_nid generation:  0.03455495834350586
local_in_edges_tensor generation:  0.05336737632751465
mini_batch_src_global generation:  0.05499267578125
r_  generation:  0.487933874130249
local_output_nid generation:  0.03463411331176758
local_in_edges_tensor generation:  0.04004025459289551
mini_batch_src_global generation:  0.05098533630371094
r_  generation:  0.49162817001342773
local_output_nid generation:  0.03452324867248535
local_in_edges_tensor generation:  0.03927946090698242
mini_batch_src_global generation:  0.05480337142944336
r_  generation:  0.4852478504180908
local_output_nid generation:  0.03442072868347168
local_in_edges_tensor generation:  0.04510164260864258
mini_batch_src_global generation:  0.052993059158325195
r_  generation:  0.49895143508911133
local_output_nid generation:  0.034740447998046875
local_in_edges_tensor generation:  0.04356789588928223
mini_batch_src_global generation:  0.05586576461791992
r_  generation:  0.4901087284088135
local_output_nid generation:  0.0355076789855957
local_in_edges_tensor generation:  0.048906564712524414
mini_batch_src_global generation:  0.05309724807739258
r_  generation:  0.504814624786377
local_output_nid generation:  0.0348355770111084
local_in_edges_tensor generation:  0.03457760810852051
mini_batch_src_global generation:  0.06530022621154785
r_  generation:  0.48604345321655273
----------------------check_connections_block total spend ----------------------------- 5.858136892318726
generate_one_block  0.6243209838867188
generate_one_block  0.6288270950317383
generate_one_block  0.6064441204071045
generate_one_block  0.6213779449462891
generate_one_block  0.6213076114654541
generate_one_block  0.625546932220459
generate_one_block  0.6386408805847168
generate_one_block  0.6066524982452393
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  9.45024561882019
block generation total time  8.138134002685547
average batch blocks generation time:  1.0172667503356934
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09608078002929688  GigaBytes
Max Memory Allocated: 0.09608078002929688  GigaBytes

torch.Size([160444, 128])
torch.Size([141441, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5565185546875 GB
    Memory Allocated: 13.243605136871338  GigaBytes
Max Memory Allocated: 13.255816459655762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.5682373046875 GB
    Memory Allocated: 0.09917688369750977  GigaBytes
Max Memory Allocated: 13.255816459655762  GigaBytes

torch.Size([160484, 128])
torch.Size([141331, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8104248046875 GB
    Memory Allocated: 13.30289888381958  GigaBytes
Max Memory Allocated: 13.317172527313232  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8104248046875 GB
    Memory Allocated: 0.0990457534790039  GigaBytes
Max Memory Allocated: 13.317172527313232  GigaBytes

torch.Size([160519, 128])
torch.Size([141148, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8201904296875 GB
    Memory Allocated: 13.270942687988281  GigaBytes
Max Memory Allocated: 13.317172527313232  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8201904296875 GB
    Memory Allocated: 0.0990605354309082  GigaBytes
Max Memory Allocated: 13.317172527313232  GigaBytes

torch.Size([160364, 128])
torch.Size([141291, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8201904296875 GB
    Memory Allocated: 13.294849395751953  GigaBytes
Max Memory Allocated: 13.317172527313232  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8201904296875 GB
    Memory Allocated: 0.09920835494995117  GigaBytes
Max Memory Allocated: 13.317172527313232  GigaBytes

torch.Size([160592, 128])
torch.Size([141418, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8201904296875 GB
    Memory Allocated: 13.309476852416992  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8201904296875 GB
    Memory Allocated: 0.09912490844726562  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160611, 128])
torch.Size([141393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.28662395477295  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.09911823272705078  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160711, 128])
torch.Size([141360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.252615928649902  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.09899330139160156  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160453, 128])
torch.Size([140855, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.249033451080322  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04882407188415527 |0.05755901336669922 |0.3365529179573059 |0.0001138448715209961 |0.31254842877388 |0.00869894027709961 |
----------------------------------------------------------pseudo_mini_loss sum 4.4007086753845215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957704
Number of first layer input nodes during this epoch:  1284178
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.13062286376953125  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02163243293762207
random selection method range initialization spend 0.006225109100341797
time for parepare:  0.019617080688476562
local_output_nid generation:  0.004744291305541992
local_in_edges_tensor generation:  0.005667209625244141
mini_batch_src_global generation:  0.0038919448852539062
r_  generation:  0.03953075408935547
local_output_nid generation:  0.006179094314575195
local_in_edges_tensor generation:  0.002913236618041992
mini_batch_src_global generation:  0.004889726638793945
r_  generation:  0.040912628173828125
local_output_nid generation:  0.006178855895996094
local_in_edges_tensor generation:  0.002969026565551758
mini_batch_src_global generation:  0.003379344940185547
r_  generation:  0.0427091121673584
local_output_nid generation:  0.006279945373535156
local_in_edges_tensor generation:  0.0031120777130126953
mini_batch_src_global generation:  0.004844188690185547
r_  generation:  0.046477556228637695
local_output_nid generation:  0.008946895599365234
local_in_edges_tensor generation:  0.0040819644927978516
mini_batch_src_global generation:  0.003263711929321289
r_  generation:  0.04315495491027832
local_output_nid generation:  0.009055137634277344
local_in_edges_tensor generation:  0.0041501522064208984
mini_batch_src_global generation:  0.0038368701934814453
r_  generation:  0.04396367073059082
local_output_nid generation:  0.009153127670288086
local_in_edges_tensor generation:  0.0042803287506103516
mini_batch_src_global generation:  0.013409137725830078
r_  generation:  0.04349780082702637
local_output_nid generation:  0.009179115295410156
local_in_edges_tensor generation:  0.0041141510009765625
mini_batch_src_global generation:  0.0037043094635009766
r_  generation:  0.04372859001159668
----------------------check_connections_block total spend ----------------------------- 0.5888094902038574
generate_one_block  0.0735788345336914
generate_one_block  0.06242680549621582
generate_one_block  0.06098771095275879
generate_one_block  0.06102561950683594
generate_one_block  0.08843088150024414
generate_one_block  0.07102108001708984
generate_one_block  0.07521891593933105
generate_one_block  0.064544677734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041269779205322266
gen group dst list time:  0.015493392944335938
time for parepare:  0.020087718963623047
local_output_nid generation:  0.015176773071289062
local_in_edges_tensor generation:  0.05240035057067871
mini_batch_src_global generation:  0.02783656120300293
r_  generation:  0.3127140998840332
local_output_nid generation:  0.027150392532348633
local_in_edges_tensor generation:  0.03359365463256836
mini_batch_src_global generation:  0.042883872985839844
r_  generation:  0.3242635726928711
local_output_nid generation:  0.02729320526123047
local_in_edges_tensor generation:  0.028447866439819336
mini_batch_src_global generation:  0.03719353675842285
r_  generation:  0.3534362316131592
local_output_nid generation:  0.02881026268005371
local_in_edges_tensor generation:  0.03584456443786621
mini_batch_src_global generation:  0.047388315200805664
r_  generation:  0.35453057289123535
local_output_nid generation:  0.02906966209411621
local_in_edges_tensor generation:  0.027573823928833008
mini_batch_src_global generation:  0.03979921340942383
r_  generation:  0.33550286293029785
local_output_nid generation:  0.029010534286499023
local_in_edges_tensor generation:  0.026987314224243164
mini_batch_src_global generation:  0.04325437545776367
r_  generation:  0.3758831024169922
local_output_nid generation:  0.028056859970092773
local_in_edges_tensor generation:  0.034471988677978516
mini_batch_src_global generation:  0.04001045227050781
r_  generation:  0.3171567916870117
local_output_nid generation:  0.019049882888793945
local_in_edges_tensor generation:  0.024515151977539062
mini_batch_src_global generation:  0.04903769493103027
r_  generation:  0.3207089900970459
----------------------check_connections_block total spend ----------------------------- 4.103159189224243
generate_one_block  0.41635560989379883
generate_one_block  0.4102787971496582
generate_one_block  0.4426569938659668
generate_one_block  0.4156620502471924
generate_one_block  0.40583276748657227
generate_one_block  0.4170510768890381
generate_one_block  0.41113758087158203
generate_one_block  0.4540901184082031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037905216217041016
gen group dst list time:  0.03725719451904297
time for parepare:  0.020920991897583008
local_output_nid generation:  0.029300928115844727
local_in_edges_tensor generation:  0.060819387435913086
mini_batch_src_global generation:  0.04875373840332031
r_  generation:  0.4851255416870117
local_output_nid generation:  0.035567522048950195
local_in_edges_tensor generation:  0.048462867736816406
mini_batch_src_global generation:  0.053781986236572266
r_  generation:  0.4825012683868408
local_output_nid generation:  0.03535294532775879
local_in_edges_tensor generation:  0.044706106185913086
mini_batch_src_global generation:  0.05453801155090332
r_  generation:  0.4998910427093506
local_output_nid generation:  0.036783456802368164
local_in_edges_tensor generation:  0.04990530014038086
mini_batch_src_global generation:  0.054512977600097656
r_  generation:  0.5159075260162354
local_output_nid generation:  0.03845095634460449
local_in_edges_tensor generation:  0.0428011417388916
mini_batch_src_global generation:  0.059343814849853516
r_  generation:  0.4996457099914551
local_output_nid generation:  0.036535024642944336
local_in_edges_tensor generation:  0.040735721588134766
mini_batch_src_global generation:  0.05483365058898926
r_  generation:  0.4964413642883301
local_output_nid generation:  0.0366063117980957
local_in_edges_tensor generation:  0.04299020767211914
mini_batch_src_global generation:  0.053444623947143555
r_  generation:  0.5083730220794678
local_output_nid generation:  0.03660082817077637
local_in_edges_tensor generation:  0.0319976806640625
mini_batch_src_global generation:  0.057799339294433594
r_  generation:  0.495880126953125
----------------------check_connections_block total spend ----------------------------- 5.9571075439453125
generate_one_block  0.6624622344970703
generate_one_block  0.6383774280548096
generate_one_block  0.6357786655426025
generate_one_block  0.6332943439483643
generate_one_block  0.6260488033294678
generate_one_block  0.6420791149139404
generate_one_block  0.6303791999816895
generate_one_block  0.6177747249603271
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.13062286376953125  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

connection checking time:  10.060266733169556
block generation total time  8.459259510040283
average batch blocks generation time:  1.0574074387550354
block dataloader generation time/epoch 20.899221897125244
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.10006237030029297  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160274, 128])
torch.Size([140876, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.226019382476807  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.100128173828125  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160413, 128])
torch.Size([140862, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.226550102233887  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.1002354621887207  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160354, 128])
torch.Size([141028, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.262444496154785  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.10010766983032227  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160196, 128])
torch.Size([140942, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.263992309570312  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.10020256042480469  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160419, 128])
torch.Size([141047, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.24932336807251  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.1005258560180664  GigaBytes
Max Memory Allocated: 13.32362985610962  GigaBytes

torch.Size([160559, 128])
torch.Size([141634, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 13.339820384979248  GigaBytes
Max Memory Allocated: 13.354331016540527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8592529296875 GB
    Memory Allocated: 0.10075187683105469  GigaBytes
Max Memory Allocated: 13.354331016540527  GigaBytes

torch.Size([160581, 128])
torch.Size([141466, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5740966796875 GB
    Memory Allocated: 13.280267715454102  GigaBytes
Max Memory Allocated: 13.354331016540527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5740966796875 GB
    Memory Allocated: 0.10033130645751953  GigaBytes
Max Memory Allocated: 13.354331016540527  GigaBytes

torch.Size([160447, 128])
torch.Size([141099, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5740966796875 GB
    Memory Allocated: 13.303821086883545  GigaBytes
Max Memory Allocated: 13.354331016540527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04474726319313049 |0.018000125885009766 |0.25736740231513977 |9.849667549133301e-05 |0.3109736740589142 |0.006429910659790039 |
----------------------------------------------------------pseudo_mini_loss sum 3.7144417762756348
Total (block generation + training)time/epoch 25.981362104415894
Training time/epoch 5.081868410110474
Training time without block to device /epoch 4.9378674030303955
Training time without total dataloading part /epoch 4.553946495056152
load block tensor time/epoch 0.35797810554504395
block to device time/epoch 0.14400100708007812
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2955041
Number of first layer input nodes during this epoch:  1283243
