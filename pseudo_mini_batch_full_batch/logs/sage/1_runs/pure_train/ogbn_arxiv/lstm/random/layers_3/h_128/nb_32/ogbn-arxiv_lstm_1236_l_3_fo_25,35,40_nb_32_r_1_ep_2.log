Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648460126.983701
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02430105209350586
random selection method range initialization spend 0.007866621017456055
time for parepare:  0.018500804901123047
local_output_nid generation:  0.0011012554168701172
local_in_edges_tensor generation:  0.003953695297241211
mini_batch_src_global generation:  0.0014553070068359375
r_  generation:  0.009071588516235352
local_output_nid generation:  0.00135040283203125
local_in_edges_tensor generation:  0.0009753704071044922
mini_batch_src_global generation:  0.001432180404663086
r_  generation:  0.007858753204345703
local_output_nid generation:  0.0013988018035888672
local_in_edges_tensor generation:  0.0008482933044433594
mini_batch_src_global generation:  0.0009524822235107422
r_  generation:  0.007908105850219727
local_output_nid generation:  0.0014085769653320312
local_in_edges_tensor generation:  0.0008096694946289062
mini_batch_src_global generation:  0.0008375644683837891
r_  generation:  0.00749969482421875
local_output_nid generation:  0.001397848129272461
local_in_edges_tensor generation:  0.0007653236389160156
mini_batch_src_global generation:  0.0008051395416259766
r_  generation:  0.007711887359619141
local_output_nid generation:  0.0013599395751953125
local_in_edges_tensor generation:  0.0007526874542236328
mini_batch_src_global generation:  0.0008130073547363281
r_  generation:  0.008066654205322266
local_output_nid generation:  0.001375436782836914
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.007873058319091797
local_output_nid generation:  0.0014011859893798828
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.0008256435394287109
r_  generation:  0.008106470108032227
local_output_nid generation:  0.0013751983642578125
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0008447170257568359
r_  generation:  0.008295059204101562
local_output_nid generation:  0.0013642311096191406
local_in_edges_tensor generation:  0.0007469654083251953
mini_batch_src_global generation:  0.0008471012115478516
r_  generation:  0.007915496826171875
local_output_nid generation:  0.0014028549194335938
local_in_edges_tensor generation:  0.0007207393646240234
mini_batch_src_global generation:  0.0008358955383300781
r_  generation:  0.007994651794433594
local_output_nid generation:  0.0013592243194580078
local_in_edges_tensor generation:  0.0007376670837402344
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.008359193801879883
local_output_nid generation:  0.001375436782836914
local_in_edges_tensor generation:  0.0007231235504150391
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.008180618286132812
local_output_nid generation:  0.001402139663696289
local_in_edges_tensor generation:  0.0007264614105224609
mini_batch_src_global generation:  0.0008718967437744141
r_  generation:  0.008141756057739258
local_output_nid generation:  0.001344442367553711
local_in_edges_tensor generation:  0.0007145404815673828
mini_batch_src_global generation:  0.0008206367492675781
r_  generation:  0.008051156997680664
local_output_nid generation:  0.0013751983642578125
local_in_edges_tensor generation:  0.0007038116455078125
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.007790565490722656
local_output_nid generation:  0.0013921260833740234
local_in_edges_tensor generation:  0.0007030963897705078
mini_batch_src_global generation:  0.0007982254028320312
r_  generation:  0.0077555179595947266
local_output_nid generation:  0.0013475418090820312
local_in_edges_tensor generation:  0.0007083415985107422
mini_batch_src_global generation:  0.0008118152618408203
r_  generation:  0.007990598678588867
local_output_nid generation:  0.0013594627380371094
local_in_edges_tensor generation:  0.0007174015045166016
mini_batch_src_global generation:  0.0008473396301269531
r_  generation:  0.008432626724243164
local_output_nid generation:  0.0013849735260009766
local_in_edges_tensor generation:  0.0007355213165283203
mini_batch_src_global generation:  0.0008475780487060547
r_  generation:  0.007967948913574219
local_output_nid generation:  0.0013675689697265625
local_in_edges_tensor generation:  0.0007035732269287109
mini_batch_src_global generation:  0.0008511543273925781
r_  generation:  0.008132219314575195
local_output_nid generation:  0.0013568401336669922
local_in_edges_tensor generation:  0.0007085800170898438
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.008006572723388672
local_output_nid generation:  0.0013937950134277344
local_in_edges_tensor generation:  0.0007205009460449219
mini_batch_src_global generation:  0.0008146762847900391
r_  generation:  0.007983207702636719
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007200241088867188
mini_batch_src_global generation:  0.0008728504180908203
r_  generation:  0.008258342742919922
local_output_nid generation:  0.0013844966888427734
local_in_edges_tensor generation:  0.0006968975067138672
mini_batch_src_global generation:  0.0008311271667480469
r_  generation:  0.0080718994140625
local_output_nid generation:  0.001367807388305664
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0008409023284912109
r_  generation:  0.007863998413085938
local_output_nid generation:  0.0013666152954101562
local_in_edges_tensor generation:  0.0007038116455078125
mini_batch_src_global generation:  0.0008504390716552734
r_  generation:  0.008184432983398438
local_output_nid generation:  0.0013744831085205078
local_in_edges_tensor generation:  0.0007147789001464844
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.008183956146240234
local_output_nid generation:  0.0013699531555175781
local_in_edges_tensor generation:  0.0007159709930419922
mini_batch_src_global generation:  0.0008628368377685547
r_  generation:  0.007940530776977539
local_output_nid generation:  0.0013689994812011719
local_in_edges_tensor generation:  0.005130767822265625
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.008216381072998047
local_output_nid generation:  0.0012722015380859375
local_in_edges_tensor generation:  0.0007529258728027344
mini_batch_src_global generation:  0.0009670257568359375
r_  generation:  0.00822138786315918
local_output_nid generation:  0.0012562274932861328
local_in_edges_tensor generation:  0.0007059574127197266
mini_batch_src_global generation:  0.0009932518005371094
r_  generation:  0.008223533630371094
----------------------check_connections_block total spend ----------------------------- 0.4612088203430176
generate_one_block  0.013913631439208984
generate_one_block  0.013370037078857422
generate_one_block  0.013365745544433594
generate_one_block  0.012750864028930664
generate_one_block  0.013308286666870117
generate_one_block  0.013271570205688477
generate_one_block  0.01302480697631836
generate_one_block  0.013122081756591797
generate_one_block  0.013381481170654297
generate_one_block  0.013369560241699219
generate_one_block  0.012971162796020508
generate_one_block  0.013475179672241211
generate_one_block  0.013010025024414062
generate_one_block  0.013308286666870117
generate_one_block  0.01303410530090332
generate_one_block  0.012698173522949219
generate_one_block  0.012571573257446289
generate_one_block  0.0128021240234375
generate_one_block  0.013427734375
generate_one_block  0.012863874435424805
generate_one_block  0.013178586959838867
generate_one_block  0.01275777816772461
generate_one_block  0.01278233528137207
generate_one_block  0.013151407241821289
generate_one_block  0.012921571731567383
generate_one_block  0.012713909149169922
generate_one_block  0.013070106506347656
generate_one_block  0.013052940368652344
generate_one_block  0.012711048126220703
generate_one_block  0.013308525085449219
generate_one_block  0.013398170471191406
generate_one_block  0.013114213943481445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03823566436767578
gen group dst list time:  0.021376371383666992
time for parepare:  0.0189664363861084
local_output_nid generation:  0.004655122756958008
local_in_edges_tensor generation:  0.013562202453613281
mini_batch_src_global generation:  0.01157236099243164
r_  generation:  0.11645889282226562
local_output_nid generation:  0.007654905319213867
local_in_edges_tensor generation:  0.01213216781616211
mini_batch_src_global generation:  0.016215085983276367
r_  generation:  0.12394285202026367
local_output_nid generation:  0.007592916488647461
local_in_edges_tensor generation:  0.009837150573730469
mini_batch_src_global generation:  0.014007568359375
r_  generation:  0.12745308876037598
local_output_nid generation:  0.007071971893310547
local_in_edges_tensor generation:  0.008633852005004883
mini_batch_src_global generation:  0.014302492141723633
r_  generation:  0.12465548515319824
local_output_nid generation:  0.007249593734741211
local_in_edges_tensor generation:  0.009812593460083008
mini_batch_src_global generation:  0.01513361930847168
r_  generation:  0.13231825828552246
local_output_nid generation:  0.007289886474609375
local_in_edges_tensor generation:  0.007751941680908203
mini_batch_src_global generation:  0.015768051147460938
r_  generation:  0.13156652450561523
local_output_nid generation:  0.007272243499755859
local_in_edges_tensor generation:  0.0076787471771240234
mini_batch_src_global generation:  0.01566314697265625
r_  generation:  0.13121557235717773
local_output_nid generation:  0.007376909255981445
local_in_edges_tensor generation:  0.009696245193481445
mini_batch_src_global generation:  0.0170595645904541
r_  generation:  0.13306403160095215
local_output_nid generation:  0.0073986053466796875
local_in_edges_tensor generation:  0.010345458984375
mini_batch_src_global generation:  0.016489744186401367
r_  generation:  0.13853788375854492
local_output_nid generation:  0.010881900787353516
local_in_edges_tensor generation:  0.007856369018554688
mini_batch_src_global generation:  0.016479969024658203
r_  generation:  0.13449430465698242
local_output_nid generation:  0.007227420806884766
local_in_edges_tensor generation:  0.009805440902709961
mini_batch_src_global generation:  0.016051530838012695
r_  generation:  0.13393807411193848
local_output_nid generation:  0.007395267486572266
local_in_edges_tensor generation:  0.010177373886108398
mini_batch_src_global generation:  0.01649165153503418
r_  generation:  0.13674306869506836
local_output_nid generation:  0.0073320865631103516
local_in_edges_tensor generation:  0.0076863765716552734
mini_batch_src_global generation:  0.015898466110229492
r_  generation:  0.13114476203918457
local_output_nid generation:  0.007460594177246094
local_in_edges_tensor generation:  0.007918596267700195
mini_batch_src_global generation:  0.016586780548095703
r_  generation:  0.1374053955078125
local_output_nid generation:  0.007256746292114258
local_in_edges_tensor generation:  0.009655237197875977
mini_batch_src_global generation:  0.016306638717651367
r_  generation:  0.13209152221679688
local_output_nid generation:  0.007180213928222656
local_in_edges_tensor generation:  0.007733345031738281
mini_batch_src_global generation:  0.015839338302612305
r_  generation:  0.13116979598999023
local_output_nid generation:  0.007144451141357422
local_in_edges_tensor generation:  0.00834345817565918
mini_batch_src_global generation:  0.01543116569519043
r_  generation:  0.12968707084655762
local_output_nid generation:  0.007171154022216797
local_in_edges_tensor generation:  0.009740352630615234
mini_batch_src_global generation:  0.017024993896484375
r_  generation:  0.1335127353668213
local_output_nid generation:  0.007440805435180664
local_in_edges_tensor generation:  0.010010242462158203
mini_batch_src_global generation:  0.021366596221923828
r_  generation:  0.13705825805664062
local_output_nid generation:  0.007206916809082031
local_in_edges_tensor generation:  0.007727384567260742
mini_batch_src_global generation:  0.019878149032592773
r_  generation:  0.13060617446899414
local_output_nid generation:  0.007288217544555664
local_in_edges_tensor generation:  0.009063005447387695
mini_batch_src_global generation:  0.016309022903442383
r_  generation:  0.13477206230163574
local_output_nid generation:  0.007222414016723633
local_in_edges_tensor generation:  0.009816169738769531
mini_batch_src_global generation:  0.01661372184753418
r_  generation:  0.13530755043029785
local_output_nid generation:  0.007122993469238281
local_in_edges_tensor generation:  0.007668018341064453
mini_batch_src_global generation:  0.016089916229248047
r_  generation:  0.13349223136901855
local_output_nid generation:  0.007278919219970703
local_in_edges_tensor generation:  0.007939815521240234
mini_batch_src_global generation:  0.017425060272216797
r_  generation:  0.13718056678771973
local_output_nid generation:  0.007242441177368164
local_in_edges_tensor generation:  0.007721662521362305
mini_batch_src_global generation:  0.01638174057006836
r_  generation:  0.13350200653076172
local_output_nid generation:  0.007129669189453125
local_in_edges_tensor generation:  0.007766246795654297
mini_batch_src_global generation:  0.01613759994506836
r_  generation:  0.1304163932800293
local_output_nid generation:  0.007194042205810547
local_in_edges_tensor generation:  0.007733821868896484
mini_batch_src_global generation:  0.016398191452026367
r_  generation:  0.13786792755126953
local_output_nid generation:  0.007258415222167969
local_in_edges_tensor generation:  0.009710073471069336
mini_batch_src_global generation:  0.016264677047729492
r_  generation:  0.132676362991333
local_output_nid generation:  0.007084846496582031
local_in_edges_tensor generation:  0.0075228214263916016
mini_batch_src_global generation:  0.016207456588745117
r_  generation:  0.1343998908996582
local_output_nid generation:  0.007200956344604492
local_in_edges_tensor generation:  0.008803367614746094
mini_batch_src_global generation:  0.01662755012512207
r_  generation:  0.1368694305419922
local_output_nid generation:  0.007276058197021484
local_in_edges_tensor generation:  0.007836341857910156
mini_batch_src_global generation:  0.017551183700561523
r_  generation:  0.1378941535949707
local_output_nid generation:  0.00727391242980957
local_in_edges_tensor generation:  0.007681131362915039
mini_batch_src_global generation:  0.016346216201782227
r_  generation:  0.1365644931793213
----------------------check_connections_block total spend ----------------------------- 6.308839797973633
generate_one_block  0.16349387168884277
generate_one_block  0.16425490379333496
generate_one_block  0.1867678165435791
generate_one_block  0.1567554473876953
generate_one_block  0.16610169410705566
generate_one_block  0.16563129425048828
generate_one_block  0.16382694244384766
generate_one_block  0.1659104824066162
generate_one_block  0.1752164363861084
generate_one_block  0.16722846031188965
generate_one_block  0.16384196281433105
generate_one_block  0.1676502227783203
generate_one_block  0.1580359935760498
generate_one_block  0.17086219787597656
generate_one_block  0.16125059127807617
generate_one_block  0.18087315559387207
generate_one_block  0.1570723056793213
generate_one_block  0.16306281089782715
generate_one_block  0.17380666732788086
generate_one_block  0.15869975090026855
generate_one_block  0.16806721687316895
generate_one_block  0.16340231895446777
generate_one_block  0.15987491607666016
generate_one_block  0.17081332206726074
generate_one_block  0.16297245025634766
generate_one_block  0.15899276733398438
generate_one_block  0.17069578170776367
generate_one_block  0.1623837947845459
generate_one_block  0.16132402420043945
generate_one_block  0.1705484390258789
generate_one_block  0.17180657386779785
generate_one_block  0.16446638107299805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03587937355041504
gen group dst list time:  0.09282970428466797
time for parepare:  0.01881575584411621
local_output_nid generation:  0.020584583282470703
local_in_edges_tensor generation:  0.03745627403259277
mini_batch_src_global generation:  0.036005496978759766
r_  generation:  0.39087939262390137
local_output_nid generation:  0.0276947021484375
local_in_edges_tensor generation:  0.03990936279296875
mini_batch_src_global generation:  0.048928022384643555
r_  generation:  0.39261460304260254
local_output_nid generation:  0.02781057357788086
local_in_edges_tensor generation:  0.03649568557739258
mini_batch_src_global generation:  0.050215959548950195
r_  generation:  0.39463090896606445
local_output_nid generation:  0.02624201774597168
local_in_edges_tensor generation:  0.026119232177734375
mini_batch_src_global generation:  0.0484468936920166
r_  generation:  0.3925340175628662
local_output_nid generation:  0.02630162239074707
local_in_edges_tensor generation:  0.03584432601928711
mini_batch_src_global generation:  0.049714088439941406
r_  generation:  0.39831113815307617
local_output_nid generation:  0.02587270736694336
local_in_edges_tensor generation:  0.033685922622680664
mini_batch_src_global generation:  0.04796648025512695
r_  generation:  0.39556169509887695
local_output_nid generation:  0.02573990821838379
local_in_edges_tensor generation:  0.027907848358154297
mini_batch_src_global generation:  0.049956321716308594
r_  generation:  0.40286755561828613
local_output_nid generation:  0.027184009552001953
local_in_edges_tensor generation:  0.036559104919433594
mini_batch_src_global generation:  0.0480344295501709
r_  generation:  0.40419888496398926
local_output_nid generation:  0.026230335235595703
local_in_edges_tensor generation:  0.028661251068115234
mini_batch_src_global generation:  0.04820895195007324
r_  generation:  0.4070606231689453
local_output_nid generation:  0.026482820510864258
local_in_edges_tensor generation:  0.027851343154907227
mini_batch_src_global generation:  0.047446250915527344
r_  generation:  0.40461301803588867
local_output_nid generation:  0.02951669692993164
local_in_edges_tensor generation:  0.03345179557800293
mini_batch_src_global generation:  0.05111360549926758
r_  generation:  0.39943623542785645
local_output_nid generation:  0.02617645263671875
local_in_edges_tensor generation:  0.03164792060852051
mini_batch_src_global generation:  0.047423362731933594
r_  generation:  0.4029386043548584
local_output_nid generation:  0.0257112979888916
local_in_edges_tensor generation:  0.027620792388916016
mini_batch_src_global generation:  0.04626202583312988
r_  generation:  0.3956906795501709
local_output_nid generation:  0.026243209838867188
local_in_edges_tensor generation:  0.035410165786743164
mini_batch_src_global generation:  0.04736495018005371
r_  generation:  0.4205470085144043
local_output_nid generation:  0.02627396583557129
local_in_edges_tensor generation:  0.025177717208862305
mini_batch_src_global generation:  0.04734516143798828
r_  generation:  0.397996187210083
local_output_nid generation:  0.02648782730102539
local_in_edges_tensor generation:  0.028000831604003906
mini_batch_src_global generation:  0.04712367057800293
r_  generation:  0.3971884250640869
local_output_nid generation:  0.02650141716003418
local_in_edges_tensor generation:  0.027319908142089844
mini_batch_src_global generation:  0.0465397834777832
r_  generation:  0.4003109931945801
local_output_nid generation:  0.028502941131591797
local_in_edges_tensor generation:  0.028151988983154297
mini_batch_src_global generation:  0.04736804962158203
r_  generation:  0.3977189064025879
local_output_nid generation:  0.026812314987182617
local_in_edges_tensor generation:  0.03158211708068848
mini_batch_src_global generation:  0.04668068885803223
r_  generation:  0.40471982955932617
local_output_nid generation:  0.026837825775146484
local_in_edges_tensor generation:  0.0323338508605957
mini_batch_src_global generation:  0.047865867614746094
r_  generation:  0.39957618713378906
local_output_nid generation:  0.026435136795043945
local_in_edges_tensor generation:  0.024646759033203125
mini_batch_src_global generation:  0.047071218490600586
r_  generation:  0.3987843990325928
local_output_nid generation:  0.0267026424407959
local_in_edges_tensor generation:  0.028763294219970703
mini_batch_src_global generation:  0.04700469970703125
r_  generation:  0.40064144134521484
local_output_nid generation:  0.026238203048706055
local_in_edges_tensor generation:  0.024409770965576172
mini_batch_src_global generation:  0.04706406593322754
r_  generation:  0.397507905960083
local_output_nid generation:  0.026602506637573242
local_in_edges_tensor generation:  0.027701139450073242
mini_batch_src_global generation:  0.05040287971496582
r_  generation:  0.40435051918029785
local_output_nid generation:  0.02632761001586914
local_in_edges_tensor generation:  0.025036096572875977
mini_batch_src_global generation:  0.046367645263671875
r_  generation:  0.3980841636657715
local_output_nid generation:  0.02648782730102539
local_in_edges_tensor generation:  0.027764320373535156
mini_batch_src_global generation:  0.04726862907409668
r_  generation:  0.3961668014526367
local_output_nid generation:  0.026516199111938477
local_in_edges_tensor generation:  0.028566837310791016
mini_batch_src_global generation:  0.049495697021484375
r_  generation:  0.4046299457550049
local_output_nid generation:  0.02645587921142578
local_in_edges_tensor generation:  0.03623700141906738
mini_batch_src_global generation:  0.048793792724609375
r_  generation:  0.4012570381164551
local_output_nid generation:  0.026649951934814453
local_in_edges_tensor generation:  0.026977062225341797
mini_batch_src_global generation:  0.0472567081451416
r_  generation:  0.40233922004699707
local_output_nid generation:  0.026650667190551758
local_in_edges_tensor generation:  0.024784326553344727
mini_batch_src_global generation:  0.047142744064331055
r_  generation:  0.4041628837585449
local_output_nid generation:  0.02780747413635254
local_in_edges_tensor generation:  0.03483295440673828
mini_batch_src_global generation:  0.06185173988342285
r_  generation:  0.4019308090209961
local_output_nid generation:  0.026697158813476562
local_in_edges_tensor generation:  0.03049182891845703
mini_batch_src_global generation:  0.06316685676574707
r_  generation:  0.40715479850769043
----------------------check_connections_block total spend ----------------------------- 19.002484560012817
generate_one_block  0.612525224685669
generate_one_block  0.5227084159851074
generate_one_block  0.5253775119781494
generate_one_block  0.50738525390625
generate_one_block  0.530773401260376
generate_one_block  0.5131871700286865
generate_one_block  0.511927604675293
generate_one_block  0.522838830947876
generate_one_block  0.5252149105072021
generate_one_block  0.5065898895263672
generate_one_block  0.5068681240081787
generate_one_block  0.5083279609680176
generate_one_block  0.5105550289154053
generate_one_block  0.5359678268432617
generate_one_block  0.5378167629241943
generate_one_block  0.5221073627471924
generate_one_block  0.5245368480682373
generate_one_block  0.5249729156494141
generate_one_block  0.524299144744873
generate_one_block  0.5060656070709229
generate_one_block  0.5269050598144531
generate_one_block  0.5191080570220947
generate_one_block  0.5026278495788574
generate_one_block  0.5178167819976807
generate_one_block  0.5042116641998291
generate_one_block  0.5081601142883301
generate_one_block  0.5193023681640625
generate_one_block  0.5136287212371826
generate_one_block  0.501129150390625
generate_one_block  0.528057336807251
generate_one_block  0.506911039352417
generate_one_block  0.5190441608428955
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  25.31132435798645
block generation total time  21.962639093399048
average batch blocks generation time:  0.6863324716687202
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08331584930419922  GigaBytes
Max Memory Allocated: 0.08331584930419922  GigaBytes

torch.Size([145219, 128])
torch.Size([98906, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8944091796875 GB
    Memory Allocated: 12.433028221130371  GigaBytes
Max Memory Allocated: 12.447536945343018  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2615966796875 GB
    Memory Allocated: 0.08684539794921875  GigaBytes
Max Memory Allocated: 12.447536945343018  GigaBytes

torch.Size([145787, 128])
torch.Size([99881, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9334716796875 GB
    Memory Allocated: 12.63083267211914  GigaBytes
Max Memory Allocated: 12.646340370178223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1190185546875 GB
    Memory Allocated: 0.08764123916625977  GigaBytes
Max Memory Allocated: 12.646340370178223  GigaBytes

torch.Size([145887, 128])
torch.Size([99913, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.646271705627441  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08565950393676758  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

torch.Size([145839, 128])
torch.Size([98988, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.350486755371094  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08762216567993164  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

torch.Size([145680, 128])
torch.Size([99907, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.570175647735596  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08556747436523438  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

torch.Size([145268, 128])
torch.Size([98690, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.456197738647461  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08761453628540039  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

torch.Size([145603, 128])
torch.Size([99090, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.547683715820312  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08688735961914062  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

torch.Size([145901, 128])
torch.Size([100083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.614449977874756  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08668327331542969  GigaBytes
Max Memory Allocated: 12.661758422851562  GigaBytes

torch.Size([145390, 128])
torch.Size([100035, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.733902931213379  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08656787872314453  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145225, 128])
torch.Size([99194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.587647914886475  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08663272857666016  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145482, 128])
torch.Size([98796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.54278564453125  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08674144744873047  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145576, 128])
torch.Size([99508, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.553797245025635  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.0853581428527832  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145207, 128])
torch.Size([98466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.348706245422363  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08701372146606445  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([146126, 128])
torch.Size([100195, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.662772178649902  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08557844161987305  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145391, 128])
torch.Size([98552, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.485754013061523  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08557939529418945  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145479, 128])
torch.Size([99189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.389975547790527  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08538579940795898  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145407, 128])
torch.Size([98064, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.253615379333496  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08537673950195312  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145022, 128])
torch.Size([98768, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.390852928161621  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08766841888427734  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145408, 128])
torch.Size([99685, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.722877502441406  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.0858602523803711  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([146020, 128])
torch.Size([99855, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.459018230438232  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.0856170654296875  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145374, 128])
torch.Size([98990, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.473127841949463  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08683061599731445  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145832, 128])
torch.Size([99676, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.548068046569824  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08533525466918945  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145127, 128])
torch.Size([98182, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.323284149169922  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08676576614379883  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145633, 128])
torch.Size([99278, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.620099544525146  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08522367477416992  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([144679, 128])
torch.Size([98214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.438235759735107  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.0854802131652832  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145459, 128])
torch.Size([98322, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.362347602844238  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08661842346191406  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145310, 128])
torch.Size([99207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.599714279174805  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08574247360229492  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145757, 128])
torch.Size([99567, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.435810565948486  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08543777465820312  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145274, 128])
torch.Size([98288, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.356000900268555  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08651399612426758  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145099, 128])
torch.Size([99209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.58276891708374  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08657455444335938  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145212, 128])
torch.Size([99205, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.605638980865479  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.08669757843017578  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145526, 128])
torch.Size([99788, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 12.586266040802002  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03195187449455261 |0.0249289870262146 |0.2574395462870598 |9.655952453613281e-05 |0.43088357150554657 |0.007955551147460938 |
----------------------------------------------------------pseudo_mini_loss sum 4.990508556365967
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8580887
Number of first layer input nodes during this epoch:  4655199
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.10774087905883789  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02286982536315918
random selection method range initialization spend 0.007296323776245117
time for parepare:  0.01999807357788086
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0070953369140625
mini_batch_src_global generation:  0.0019397735595703125
r_  generation:  0.00996851921081543
local_output_nid generation:  0.0016956329345703125
local_in_edges_tensor generation:  0.0010371208190917969
mini_batch_src_global generation:  0.001699686050415039
r_  generation:  0.010952949523925781
local_output_nid generation:  0.0018193721771240234
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.008230447769165039
local_output_nid generation:  0.0018508434295654297
local_in_edges_tensor generation:  0.0009031295776367188
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.00801396369934082
local_output_nid generation:  0.0017752647399902344
local_in_edges_tensor generation:  0.0009129047393798828
mini_batch_src_global generation:  0.0010886192321777344
r_  generation:  0.008386850357055664
local_output_nid generation:  0.00185394287109375
local_in_edges_tensor generation:  0.0008754730224609375
mini_batch_src_global generation:  0.0010297298431396484
r_  generation:  0.008493185043334961
local_output_nid generation:  0.0017578601837158203
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.00103759765625
r_  generation:  0.008560419082641602
local_output_nid generation:  0.0018188953399658203
local_in_edges_tensor generation:  0.000919342041015625
mini_batch_src_global generation:  0.0010190010070800781
r_  generation:  0.008202791213989258
local_output_nid generation:  0.0017540454864501953
local_in_edges_tensor generation:  0.0008442401885986328
mini_batch_src_global generation:  0.0009732246398925781
r_  generation:  0.008344411849975586
local_output_nid generation:  0.003634214401245117
local_in_edges_tensor generation:  0.0009262561798095703
mini_batch_src_global generation:  0.0010042190551757812
r_  generation:  0.00855565071105957
local_output_nid generation:  0.001752614974975586
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.001074075698852539
r_  generation:  0.008362531661987305
local_output_nid generation:  0.001786947250366211
local_in_edges_tensor generation:  0.0008928775787353516
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.00826263427734375
local_output_nid generation:  0.0017986297607421875
local_in_edges_tensor generation:  0.0008807182312011719
mini_batch_src_global generation:  0.001027822494506836
r_  generation:  0.008524894714355469
local_output_nid generation:  0.0017786026000976562
local_in_edges_tensor generation:  0.0008537769317626953
mini_batch_src_global generation:  0.001071929931640625
r_  generation:  0.008152246475219727
local_output_nid generation:  0.001772165298461914
local_in_edges_tensor generation:  0.0008347034454345703
mini_batch_src_global generation:  0.0009889602661132812
r_  generation:  0.00848698616027832
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0009927749633789062
r_  generation:  0.00820612907409668
local_output_nid generation:  0.0018153190612792969
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.001013040542602539
r_  generation:  0.008224010467529297
local_output_nid generation:  0.0017547607421875
local_in_edges_tensor generation:  0.0008604526519775391
mini_batch_src_global generation:  0.0010898113250732422
r_  generation:  0.00846409797668457
local_output_nid generation:  0.0017859935760498047
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.001028299331665039
r_  generation:  0.00838017463684082
local_output_nid generation:  0.0017788410186767578
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0010137557983398438
r_  generation:  0.008507966995239258
local_output_nid generation:  0.0017924308776855469
local_in_edges_tensor generation:  0.0008935928344726562
mini_batch_src_global generation:  0.0010519027709960938
r_  generation:  0.008619308471679688
local_output_nid generation:  0.0017991065979003906
local_in_edges_tensor generation:  0.0008471012115478516
mini_batch_src_global generation:  0.0009913444519042969
r_  generation:  0.008301734924316406
local_output_nid generation:  0.0018231868743896484
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0009832382202148438
r_  generation:  0.008325576782226562
local_output_nid generation:  0.0017549991607666016
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.010884284973144531
local_output_nid generation:  0.001791238784790039
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.00113677978515625
r_  generation:  0.008561849594116211
local_output_nid generation:  0.0017664432525634766
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0010106563568115234
r_  generation:  0.008523941040039062
local_output_nid generation:  0.0017747879028320312
local_in_edges_tensor generation:  0.0008337497711181641
mini_batch_src_global generation:  0.0009887218475341797
r_  generation:  0.008414983749389648
local_output_nid generation:  0.0017559528350830078
local_in_edges_tensor generation:  0.0008518695831298828
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.008150100708007812
local_output_nid generation:  0.0018122196197509766
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.008595943450927734
local_output_nid generation:  0.0017547607421875
local_in_edges_tensor generation:  0.0008225440979003906
mini_batch_src_global generation:  0.0009698867797851562
r_  generation:  0.008308172225952148
local_output_nid generation:  0.0017654895782470703
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010809659957885742
local_output_nid generation:  0.0017571449279785156
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.008427619934082031
----------------------check_connections_block total spend ----------------------------- 0.5147559642791748
generate_one_block  0.021890878677368164
generate_one_block  0.01827692985534668
generate_one_block  0.01592707633972168
generate_one_block  0.014894247055053711
generate_one_block  0.017882823944091797
generate_one_block  0.015385627746582031
generate_one_block  0.015377998352050781
generate_one_block  0.014634132385253906
generate_one_block  0.014895200729370117
generate_one_block  0.015281438827514648
generate_one_block  0.014978170394897461
generate_one_block  0.01643514633178711
generate_one_block  0.014946222305297852
generate_one_block  0.014814615249633789
generate_one_block  0.01486063003540039
generate_one_block  0.014750957489013672
generate_one_block  0.014306068420410156
generate_one_block  0.015256404876708984
generate_one_block  0.02044391632080078
generate_one_block  0.015433788299560547
generate_one_block  0.014861106872558594
generate_one_block  0.01463937759399414
generate_one_block  0.01465296745300293
generate_one_block  0.014700174331665039
generate_one_block  0.017731428146362305
generate_one_block  0.015229463577270508
generate_one_block  0.01449131965637207
generate_one_block  0.014693975448608398
generate_one_block  0.014919281005859375
generate_one_block  0.014612913131713867
generate_one_block  0.014737367630004883
generate_one_block  0.01760387420654297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0352177619934082
gen group dst list time:  0.020169973373413086
time for parepare:  0.020071983337402344
local_output_nid generation:  0.005806446075439453
local_in_edges_tensor generation:  0.018192529678344727
mini_batch_src_global generation:  0.01209259033203125
r_  generation:  0.12393808364868164
local_output_nid generation:  0.00891423225402832
local_in_edges_tensor generation:  0.00944662094116211
mini_batch_src_global generation:  0.014523983001708984
r_  generation:  0.12446284294128418
local_output_nid generation:  0.0091552734375
local_in_edges_tensor generation:  0.028162240982055664
mini_batch_src_global generation:  0.01568889617919922
r_  generation:  0.13363146781921387
local_output_nid generation:  0.00911569595336914
local_in_edges_tensor generation:  0.008474111557006836
mini_batch_src_global generation:  0.014232397079467773
r_  generation:  0.13086891174316406
local_output_nid generation:  0.009299993515014648
local_in_edges_tensor generation:  0.009792089462280273
mini_batch_src_global generation:  0.016197681427001953
r_  generation:  0.1442093849182129
local_output_nid generation:  0.008804798126220703
local_in_edges_tensor generation:  0.008945465087890625
mini_batch_src_global generation:  0.01602768898010254
r_  generation:  0.15297198295593262
local_output_nid generation:  0.011989831924438477
local_in_edges_tensor generation:  0.01683783531188965
mini_batch_src_global generation:  0.017363309860229492
r_  generation:  0.13798189163208008
local_output_nid generation:  0.00906515121459961
local_in_edges_tensor generation:  0.01005411148071289
mini_batch_src_global generation:  0.015717029571533203
r_  generation:  0.13228368759155273
local_output_nid generation:  0.009117841720581055
local_in_edges_tensor generation:  0.008753061294555664
mini_batch_src_global generation:  0.0172884464263916
r_  generation:  0.1400620937347412
local_output_nid generation:  0.009226083755493164
local_in_edges_tensor generation:  0.008758544921875
mini_batch_src_global generation:  0.016588211059570312
r_  generation:  0.13790082931518555
local_output_nid generation:  0.009325981140136719
local_in_edges_tensor generation:  0.009523391723632812
mini_batch_src_global generation:  0.01660609245300293
r_  generation:  0.13634228706359863
local_output_nid generation:  0.009356021881103516
local_in_edges_tensor generation:  0.009588241577148438
mini_batch_src_global generation:  0.016092538833618164
r_  generation:  0.1342151165008545
local_output_nid generation:  0.009598970413208008
local_in_edges_tensor generation:  0.01083827018737793
mini_batch_src_global generation:  0.01654982566833496
r_  generation:  0.13923358917236328
local_output_nid generation:  0.009325742721557617
local_in_edges_tensor generation:  0.009396553039550781
mini_batch_src_global generation:  0.015935897827148438
r_  generation:  0.13187336921691895
local_output_nid generation:  0.00950479507446289
local_in_edges_tensor generation:  0.010450124740600586
mini_batch_src_global generation:  0.016311168670654297
r_  generation:  0.1371898651123047
local_output_nid generation:  0.009459972381591797
local_in_edges_tensor generation:  0.008281230926513672
mini_batch_src_global generation:  0.01608753204345703
r_  generation:  0.13463091850280762
local_output_nid generation:  0.009216070175170898
local_in_edges_tensor generation:  0.008468151092529297
mini_batch_src_global generation:  0.015802860260009766
r_  generation:  0.13047170639038086
local_output_nid generation:  0.009469032287597656
local_in_edges_tensor generation:  0.01053166389465332
mini_batch_src_global generation:  0.015990018844604492
r_  generation:  0.1369638442993164
local_output_nid generation:  0.009493350982666016
local_in_edges_tensor generation:  0.009531021118164062
mini_batch_src_global generation:  0.02005743980407715
r_  generation:  0.13905668258666992
local_output_nid generation:  0.00976705551147461
local_in_edges_tensor generation:  0.010195016860961914
mini_batch_src_global generation:  0.016908884048461914
r_  generation:  0.1405777931213379
local_output_nid generation:  0.009429693222045898
local_in_edges_tensor generation:  0.019460439682006836
mini_batch_src_global generation:  0.01690816879272461
r_  generation:  0.1400909423828125
local_output_nid generation:  0.012398481369018555
local_in_edges_tensor generation:  0.009749174118041992
mini_batch_src_global generation:  0.016593217849731445
r_  generation:  0.13565373420715332
local_output_nid generation:  0.010890483856201172
local_in_edges_tensor generation:  0.009521722793579102
mini_batch_src_global generation:  0.016341447830200195
r_  generation:  0.13750576972961426
local_output_nid generation:  0.010539054870605469
local_in_edges_tensor generation:  0.010557174682617188
mini_batch_src_global generation:  0.01651787757873535
r_  generation:  0.13514971733093262
local_output_nid generation:  0.009118080139160156
local_in_edges_tensor generation:  0.011929512023925781
mini_batch_src_global generation:  0.01742076873779297
r_  generation:  0.1365666389465332
local_output_nid generation:  0.009045839309692383
local_in_edges_tensor generation:  0.010201215744018555
mini_batch_src_global generation:  0.016419172286987305
r_  generation:  0.1366260051727295
local_output_nid generation:  0.008848190307617188
local_in_edges_tensor generation:  0.01699352264404297
mini_batch_src_global generation:  0.01637554168701172
r_  generation:  0.14609932899475098
local_output_nid generation:  0.012734413146972656
local_in_edges_tensor generation:  0.023155689239501953
mini_batch_src_global generation:  0.017185211181640625
r_  generation:  0.146712064743042
local_output_nid generation:  0.010221242904663086
local_in_edges_tensor generation:  0.011458396911621094
mini_batch_src_global generation:  0.01826953887939453
r_  generation:  0.14189934730529785
local_output_nid generation:  0.007932186126708984
local_in_edges_tensor generation:  0.008839607238769531
mini_batch_src_global generation:  0.01671314239501953
r_  generation:  0.13361430168151855
local_output_nid generation:  0.007871866226196289
local_in_edges_tensor generation:  0.008597612380981445
mini_batch_src_global generation:  0.016094684600830078
r_  generation:  0.1384296417236328
local_output_nid generation:  0.008030176162719727
local_in_edges_tensor generation:  0.0098419189453125
mini_batch_src_global generation:  0.0169985294342041
r_  generation:  0.14010214805603027
----------------------check_connections_block total spend ----------------------------- 6.636380672454834
generate_one_block  0.1939527988433838
generate_one_block  0.16968083381652832
generate_one_block  0.17389822006225586
generate_one_block  0.17025208473205566
generate_one_block  0.19127368927001953
generate_one_block  0.176591157913208
generate_one_block  0.1746361255645752
generate_one_block  0.17202258110046387
generate_one_block  0.17731285095214844
generate_one_block  0.18282556533813477
generate_one_block  0.17270898818969727
generate_one_block  0.18027734756469727
generate_one_block  0.17724394798278809
generate_one_block  0.1686723232269287
generate_one_block  0.17330098152160645
generate_one_block  0.17197155952453613
generate_one_block  0.16612982749938965
generate_one_block  0.17191314697265625
generate_one_block  0.1778872013092041
generate_one_block  0.2077651023864746
generate_one_block  0.17812347412109375
generate_one_block  0.17389726638793945
generate_one_block  0.1740272045135498
generate_one_block  0.1752183437347412
generate_one_block  0.173630952835083
generate_one_block  0.1791539192199707
generate_one_block  0.1793215274810791
generate_one_block  0.1791987419128418
generate_one_block  0.18421316146850586
generate_one_block  0.1792922019958496
generate_one_block  0.17567658424377441
generate_one_block  0.18091106414794922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.048046112060546875
gen group dst list time:  0.1065373420715332
time for parepare:  0.01787090301513672
local_output_nid generation:  0.023630619049072266
local_in_edges_tensor generation:  0.05783200263977051
mini_batch_src_global generation:  0.04033088684082031
r_  generation:  0.39551663398742676
local_output_nid generation:  0.028107881546020508
local_in_edges_tensor generation:  0.04173851013183594
mini_batch_src_global generation:  0.04595756530761719
r_  generation:  0.38946080207824707
local_output_nid generation:  0.02817988395690918
local_in_edges_tensor generation:  0.034372806549072266
mini_batch_src_global generation:  0.04590129852294922
r_  generation:  0.3989572525024414
local_output_nid generation:  0.0265958309173584
local_in_edges_tensor generation:  0.03483223915100098
mini_batch_src_global generation:  0.04694342613220215
r_  generation:  0.39577627182006836
local_output_nid generation:  0.026633262634277344
local_in_edges_tensor generation:  0.0322265625
mini_batch_src_global generation:  0.05024313926696777
r_  generation:  0.40435361862182617
local_output_nid generation:  0.026370525360107422
local_in_edges_tensor generation:  0.04199051856994629
mini_batch_src_global generation:  0.04748129844665527
r_  generation:  0.3944079875946045
local_output_nid generation:  0.026617050170898438
local_in_edges_tensor generation:  0.03139162063598633
mini_batch_src_global generation:  0.0502924919128418
r_  generation:  0.41280364990234375
local_output_nid generation:  0.026680707931518555
local_in_edges_tensor generation:  0.02754068374633789
mini_batch_src_global generation:  0.04692387580871582
r_  generation:  0.39623284339904785
local_output_nid generation:  0.026993751525878906
local_in_edges_tensor generation:  0.0347745418548584
mini_batch_src_global generation:  0.046956539154052734
r_  generation:  0.40838050842285156
local_output_nid generation:  0.0264742374420166
local_in_edges_tensor generation:  0.030645370483398438
mini_batch_src_global generation:  0.04984688758850098
r_  generation:  0.4023411273956299
local_output_nid generation:  0.026790618896484375
local_in_edges_tensor generation:  0.02744460105895996
mini_batch_src_global generation:  0.04774355888366699
r_  generation:  0.40641355514526367
local_output_nid generation:  0.026570558547973633
local_in_edges_tensor generation:  0.03121662139892578
mini_batch_src_global generation:  0.04801177978515625
r_  generation:  0.4057791233062744
local_output_nid generation:  0.026582002639770508
local_in_edges_tensor generation:  0.03513360023498535
mini_batch_src_global generation:  0.0496830940246582
r_  generation:  0.41396236419677734
local_output_nid generation:  0.026118993759155273
local_in_edges_tensor generation:  0.028570175170898438
mini_batch_src_global generation:  0.0474553108215332
r_  generation:  0.40267515182495117
local_output_nid generation:  0.026458263397216797
local_in_edges_tensor generation:  0.03290581703186035
mini_batch_src_global generation:  0.047930002212524414
r_  generation:  0.4076218605041504
local_output_nid generation:  0.026920080184936523
local_in_edges_tensor generation:  0.035241127014160156
mini_batch_src_global generation:  0.0469515323638916
r_  generation:  0.4044485092163086
local_output_nid generation:  0.0276644229888916
local_in_edges_tensor generation:  0.030984163284301758
mini_batch_src_global generation:  0.05270099639892578
r_  generation:  0.40366291999816895
local_output_nid generation:  0.026969194412231445
local_in_edges_tensor generation:  0.03163933753967285
mini_batch_src_global generation:  0.04740285873413086
r_  generation:  0.40979814529418945
local_output_nid generation:  0.028460025787353516
local_in_edges_tensor generation:  0.03743696212768555
mini_batch_src_global generation:  0.04996490478515625
r_  generation:  0.41242337226867676
local_output_nid generation:  0.028894662857055664
local_in_edges_tensor generation:  0.034555673599243164
mini_batch_src_global generation:  0.04945850372314453
r_  generation:  0.40601491928100586
local_output_nid generation:  0.027584314346313477
local_in_edges_tensor generation:  0.02834033966064453
mini_batch_src_global generation:  0.04816079139709473
r_  generation:  0.4030642509460449
local_output_nid generation:  0.027579307556152344
local_in_edges_tensor generation:  0.02792215347290039
mini_batch_src_global generation:  0.050246477127075195
r_  generation:  0.40318775177001953
local_output_nid generation:  0.02756810188293457
local_in_edges_tensor generation:  0.03492164611816406
mini_batch_src_global generation:  0.04992246627807617
r_  generation:  0.40674710273742676
local_output_nid generation:  0.027349472045898438
local_in_edges_tensor generation:  0.02743387222290039
mini_batch_src_global generation:  0.04816389083862305
r_  generation:  0.4001946449279785
local_output_nid generation:  0.02735161781311035
local_in_edges_tensor generation:  0.03074502944946289
mini_batch_src_global generation:  0.04722881317138672
r_  generation:  0.4028961658477783
local_output_nid generation:  0.027518272399902344
local_in_edges_tensor generation:  0.03868985176086426
mini_batch_src_global generation:  0.05972599983215332
r_  generation:  0.39832019805908203
local_output_nid generation:  0.02706456184387207
local_in_edges_tensor generation:  0.02692127227783203
mini_batch_src_global generation:  0.0491032600402832
r_  generation:  0.39975810050964355
local_output_nid generation:  0.027410268783569336
local_in_edges_tensor generation:  0.03102421760559082
mini_batch_src_global generation:  0.0512850284576416
r_  generation:  0.4051198959350586
local_output_nid generation:  0.027425765991210938
local_in_edges_tensor generation:  0.04700899124145508
mini_batch_src_global generation:  0.04773211479187012
r_  generation:  0.39995503425598145
local_output_nid generation:  0.02713179588317871
local_in_edges_tensor generation:  0.02476954460144043
mini_batch_src_global generation:  0.04715132713317871
r_  generation:  0.39578890800476074
local_output_nid generation:  0.027370691299438477
local_in_edges_tensor generation:  0.0321660041809082
mini_batch_src_global generation:  0.04686713218688965
r_  generation:  0.4020090103149414
local_output_nid generation:  0.027302265167236328
local_in_edges_tensor generation:  0.02838444709777832
mini_batch_src_global generation:  0.04821324348449707
r_  generation:  0.4079725742340088
----------------------check_connections_block total spend ----------------------------- 19.21107292175293
generate_one_block  0.5400052070617676
generate_one_block  0.5909609794616699
generate_one_block  0.5409772396087646
generate_one_block  0.5361402034759521
generate_one_block  0.6667554378509521
generate_one_block  0.5372376441955566
generate_one_block  0.5409793853759766
generate_one_block  0.5316660404205322
generate_one_block  0.5530381202697754
generate_one_block  0.5478293895721436
generate_one_block  0.5506415367126465
generate_one_block  0.5416111946105957
generate_one_block  0.5474879741668701
generate_one_block  0.5240187644958496
generate_one_block  0.5328488349914551
generate_one_block  0.541754961013794
generate_one_block  0.5444822311401367
generate_one_block  0.5336453914642334
generate_one_block  0.5473222732543945
generate_one_block  0.5376312732696533
generate_one_block  0.5415995121002197
generate_one_block  0.5361652374267578
generate_one_block  0.5394730567932129
generate_one_block  0.530827522277832
generate_one_block  0.5424215793609619
generate_one_block  0.5450537204742432
generate_one_block  0.5436031818389893
generate_one_block  0.5361659526824951
generate_one_block  0.5241265296936035
generate_one_block  0.5235719680786133
generate_one_block  0.5396113395690918
generate_one_block  0.5548622608184814
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.10774087905883789  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

connection checking time:  25.847453594207764
block generation total time  23.12749671936035
average batch blocks generation time:  0.722734272480011
block dataloader generation time/epoch 51.84182596206665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1737060546875 GB
    Memory Allocated: 0.09118413925170898  GigaBytes
Max Memory Allocated: 12.749584197998047  GigaBytes

torch.Size([145947, 128])
torch.Size([100662, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.734829425811768  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08891010284423828  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145314, 128])
torch.Size([97966, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.314449310302734  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08890914916992188  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([144850, 128])
torch.Size([98683, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.545241355895996  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08920049667358398  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145651, 128])
torch.Size([99282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.423645496368408  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09116363525390625  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([146264, 128])
torch.Size([100146, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.636212348937988  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08888673782348633  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([144819, 128])
torch.Size([98135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.496100902557373  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.0901346206665039  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145328, 128])
torch.Size([99292, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.560429096221924  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08901309967041016  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145406, 128])
torch.Size([98434, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.33396291732788  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09116172790527344  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145514, 128])
torch.Size([99851, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.678609371185303  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09015035629272461  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145275, 128])
torch.Size([99206, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.668342590332031  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09008026123046875  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145458, 128])
torch.Size([98668, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.460052490234375  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08900928497314453  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145182, 128])
torch.Size([98829, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.467938899993896  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09116172790527344  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145812, 128])
torch.Size([100091, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.654375076293945  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08865022659301758  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([144735, 128])
torch.Size([97986, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.317876815795898  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08895301818847656  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([144962, 128])
torch.Size([98870, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.498181819915771  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08923912048339844  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145610, 128])
torch.Size([99384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.510828495025635  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08985137939453125  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145824, 128])
torch.Size([98296, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.262837886810303  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08947992324829102  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([146171, 128])
torch.Size([99505, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.460187911987305  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09115028381347656  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([146080, 128])
torch.Size([100512, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.639978408813477  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09035968780517578  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145727, 128])
torch.Size([99928, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.626896858215332  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09015893936157227  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145366, 128])
torch.Size([99076, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.551698207855225  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.0905451774597168  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([146240, 128])
torch.Size([99863, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.521201133728027  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.0900869369506836  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145290, 128])
torch.Size([99561, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.536174774169922  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08883047103881836  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([144921, 128])
torch.Size([98437, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.40669298171997  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09011650085449219  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145421, 128])
torch.Size([99141, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.466498374938965  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08929204940795898  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145709, 128])
torch.Size([99521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.483528137207031  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08890008926391602  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145279, 128])
torch.Size([97960, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.330373764038086  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08908653259277344  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145352, 128])
torch.Size([99363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.447750568389893  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09012889862060547  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145434, 128])
torch.Size([99037, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.49451208114624  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.0886988639831543  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([144817, 128])
torch.Size([97942, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.32737398147583  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.08905839920043945  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145289, 128])
torch.Size([98759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.428069114685059  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 0.09001779556274414  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

torch.Size([145037, 128])
torch.Size([99264, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7772216796875 GB
    Memory Allocated: 12.651792049407959  GigaBytes
Max Memory Allocated: 12.750608444213867  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02436336874961853 |0.012854307889938354 |0.24050941318273544 |9.088218212127686e-05 |0.4194861277937889 |0.005182743072509766 |
----------------------------------------------------------pseudo_mini_loss sum 3.315748691558838
Total (block generation + training)time/epoch 74.20359420776367
Training time/epoch 22.361520767211914
Training time without block to device /epoch 21.950182914733887
Training time without total dataloading part /epoch 21.12794828414917
load block tensor time/epoch 0.779627799987793
block to device time/epoch 0.41133785247802734
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8577674
Number of first layer input nodes during this epoch:  4654084
