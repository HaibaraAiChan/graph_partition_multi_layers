Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648456932.9950483
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025038480758666992
random selection method range initialization spend 0.006391286849975586
time for parepare:  0.01855015754699707
local_output_nid generation:  0.0011267662048339844
local_in_edges_tensor generation:  0.0038919448852539062
mini_batch_src_global generation:  0.0014715194702148438
r_  generation:  0.00910329818725586
local_output_nid generation:  0.0012960433959960938
local_in_edges_tensor generation:  0.001008749008178711
mini_batch_src_global generation:  0.0013823509216308594
r_  generation:  0.008084535598754883
local_output_nid generation:  0.001302480697631836
local_in_edges_tensor generation:  0.0008587837219238281
mini_batch_src_global generation:  0.0008809566497802734
r_  generation:  0.007458209991455078
local_output_nid generation:  0.0013244152069091797
local_in_edges_tensor generation:  0.0008244514465332031
mini_batch_src_global generation:  0.0008149147033691406
r_  generation:  0.007717132568359375
local_output_nid generation:  0.0013282299041748047
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0008225440979003906
r_  generation:  0.007897377014160156
local_output_nid generation:  0.0013415813446044922
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.0007870197296142578
r_  generation:  0.0077152252197265625
local_output_nid generation:  0.0013439655303955078
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.0007998943328857422
r_  generation:  0.007777690887451172
local_output_nid generation:  0.0013358592987060547
local_in_edges_tensor generation:  0.0007631778717041016
mini_batch_src_global generation:  0.0007703304290771484
r_  generation:  0.007639884948730469
local_output_nid generation:  0.0013480186462402344
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0007894039154052734
r_  generation:  0.008098602294921875
local_output_nid generation:  0.0013401508331298828
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.0008225440979003906
r_  generation:  0.0077898502349853516
local_output_nid generation:  0.0013375282287597656
local_in_edges_tensor generation:  0.0007398128509521484
mini_batch_src_global generation:  0.0007669925689697266
r_  generation:  0.007557868957519531
local_output_nid generation:  0.001383066177368164
local_in_edges_tensor generation:  0.0007884502410888672
mini_batch_src_global generation:  0.0007967948913574219
r_  generation:  0.008051633834838867
local_output_nid generation:  0.0013599395751953125
local_in_edges_tensor generation:  0.0007243156433105469
mini_batch_src_global generation:  0.0008342266082763672
r_  generation:  0.00833892822265625
local_output_nid generation:  0.001374959945678711
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0008447170257568359
r_  generation:  0.008018016815185547
local_output_nid generation:  0.0013766288757324219
local_in_edges_tensor generation:  0.0007417201995849609
mini_batch_src_global generation:  0.0008113384246826172
r_  generation:  0.008020162582397461
local_output_nid generation:  0.0013728141784667969
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0008063316345214844
r_  generation:  0.008012533187866211
local_output_nid generation:  0.001360177993774414
local_in_edges_tensor generation:  0.0007264614105224609
mini_batch_src_global generation:  0.0007944107055664062
r_  generation:  0.007881641387939453
local_output_nid generation:  0.0013875961303710938
local_in_edges_tensor generation:  0.0007474422454833984
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.008406400680541992
local_output_nid generation:  0.0013515949249267578
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0008513927459716797
r_  generation:  0.008227348327636719
local_output_nid generation:  0.0013911724090576172
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0008301734924316406
r_  generation:  0.008167743682861328
local_output_nid generation:  0.0013546943664550781
local_in_edges_tensor generation:  0.0007328987121582031
mini_batch_src_global generation:  0.0008008480072021484
r_  generation:  0.007855653762817383
local_output_nid generation:  0.0013651847839355469
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0009713172912597656
r_  generation:  0.00834965705871582
local_output_nid generation:  0.0013718605041503906
local_in_edges_tensor generation:  0.0007302761077880859
mini_batch_src_global generation:  0.0008258819580078125
r_  generation:  0.008034706115722656
local_output_nid generation:  0.0013453960418701172
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0009632110595703125
r_  generation:  0.00830531120300293
local_output_nid generation:  0.0013592243194580078
local_in_edges_tensor generation:  0.00074005126953125
mini_batch_src_global generation:  0.0008387565612792969
r_  generation:  0.008099079132080078
local_output_nid generation:  0.0013875961303710938
local_in_edges_tensor generation:  0.0007565021514892578
mini_batch_src_global generation:  0.0008130073547363281
r_  generation:  0.007953166961669922
local_output_nid generation:  0.0013744831085205078
local_in_edges_tensor generation:  0.0007369518280029297
mini_batch_src_global generation:  0.0008420944213867188
r_  generation:  0.00808572769165039
local_output_nid generation:  0.0013909339904785156
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0008845329284667969
r_  generation:  0.009227514266967773
local_output_nid generation:  0.0013949871063232422
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.008407831192016602
local_output_nid generation:  0.0014111995697021484
local_in_edges_tensor generation:  0.0053119659423828125
mini_batch_src_global generation:  0.0011014938354492188
r_  generation:  0.008348703384399414
local_output_nid generation:  0.0012669563293457031
local_in_edges_tensor generation:  0.0007758140563964844
mini_batch_src_global generation:  0.0009453296661376953
r_  generation:  0.00811004638671875
local_output_nid generation:  0.0012969970703125
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0008788108825683594
r_  generation:  0.008120536804199219
----------------------check_connections_block total spend ----------------------------- 0.4623575210571289
generate_one_block  0.014035224914550781
generate_one_block  0.013613462448120117
generate_one_block  0.01286625862121582
generate_one_block  0.013152599334716797
generate_one_block  0.013359308242797852
generate_one_block  0.013190507888793945
generate_one_block  0.012876510620117188
generate_one_block  0.012924671173095703
generate_one_block  0.013327360153198242
generate_one_block  0.01343393325805664
generate_one_block  0.012529134750366211
generate_one_block  0.01309967041015625
generate_one_block  0.013376474380493164
generate_one_block  0.013008832931518555
generate_one_block  0.013302087783813477
generate_one_block  0.013097763061523438
generate_one_block  0.012799739837646484
generate_one_block  0.013393163681030273
generate_one_block  0.013263225555419922
generate_one_block  0.013085603713989258
generate_one_block  0.012883186340332031
generate_one_block  0.013370990753173828
generate_one_block  0.013030290603637695
generate_one_block  0.01349020004272461
generate_one_block  0.013083219528198242
generate_one_block  0.012775659561157227
generate_one_block  0.012934207916259766
generate_one_block  0.013613224029541016
generate_one_block  0.013407468795776367
generate_one_block  0.013427972793579102
generate_one_block  0.013128042221069336
generate_one_block  0.012920856475830078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041323184967041016
gen group dst list time:  0.021038055419921875
time for parepare:  0.01875448226928711
local_output_nid generation:  0.004755973815917969
local_in_edges_tensor generation:  0.01425313949584961
mini_batch_src_global generation:  0.011387825012207031
r_  generation:  0.11559224128723145
local_output_nid generation:  0.007738590240478516
local_in_edges_tensor generation:  0.011186838150024414
mini_batch_src_global generation:  0.015233039855957031
r_  generation:  0.12736725807189941
local_output_nid generation:  0.007123708724975586
local_in_edges_tensor generation:  0.00764012336730957
mini_batch_src_global generation:  0.013027191162109375
r_  generation:  0.12202787399291992
local_output_nid generation:  0.00726771354675293
local_in_edges_tensor generation:  0.008953094482421875
mini_batch_src_global generation:  0.01521921157836914
r_  generation:  0.12911033630371094
local_output_nid generation:  0.00737309455871582
local_in_edges_tensor generation:  0.010327816009521484
mini_batch_src_global generation:  0.015069723129272461
r_  generation:  0.12996387481689453
local_output_nid generation:  0.007175445556640625
local_in_edges_tensor generation:  0.008016824722290039
mini_batch_src_global generation:  0.01563858985900879
r_  generation:  0.12865400314331055
local_output_nid generation:  0.007119655609130859
local_in_edges_tensor generation:  0.008531570434570312
mini_batch_src_global generation:  0.015632152557373047
r_  generation:  0.13022136688232422
local_output_nid generation:  0.0071713924407958984
local_in_edges_tensor generation:  0.007752180099487305
mini_batch_src_global generation:  0.01581287384033203
r_  generation:  0.12582159042358398
local_output_nid generation:  0.007230281829833984
local_in_edges_tensor generation:  0.008331775665283203
mini_batch_src_global generation:  0.015497207641601562
r_  generation:  0.13266944885253906
local_output_nid generation:  0.007178306579589844
local_in_edges_tensor generation:  0.007885217666625977
mini_batch_src_global generation:  0.01542210578918457
r_  generation:  0.12870073318481445
local_output_nid generation:  0.006978511810302734
local_in_edges_tensor generation:  0.008031845092773438
mini_batch_src_global generation:  0.015296459197998047
r_  generation:  0.12425804138183594
local_output_nid generation:  0.007179737091064453
local_in_edges_tensor generation:  0.008731842041015625
mini_batch_src_global generation:  0.016591310501098633
r_  generation:  0.13300800323486328
local_output_nid generation:  0.007355690002441406
local_in_edges_tensor generation:  0.011114835739135742
mini_batch_src_global generation:  0.01663351058959961
r_  generation:  0.13492631912231445
local_output_nid generation:  0.007272958755493164
local_in_edges_tensor generation:  0.007974624633789062
mini_batch_src_global generation:  0.016355514526367188
r_  generation:  0.13296818733215332
local_output_nid generation:  0.00734400749206543
local_in_edges_tensor generation:  0.009023666381835938
mini_batch_src_global generation:  0.016047954559326172
r_  generation:  0.1333932876586914
local_output_nid generation:  0.0071909427642822266
local_in_edges_tensor generation:  0.009644746780395508
mini_batch_src_global generation:  0.01601862907409668
r_  generation:  0.1349644660949707
local_output_nid generation:  0.007119655609130859
local_in_edges_tensor generation:  0.007704019546508789
mini_batch_src_global generation:  0.0158536434173584
r_  generation:  0.1286764144897461
local_output_nid generation:  0.007334470748901367
local_in_edges_tensor generation:  0.010099649429321289
mini_batch_src_global generation:  0.016379117965698242
r_  generation:  0.1346147060394287
local_output_nid generation:  0.0073394775390625
local_in_edges_tensor generation:  0.010132789611816406
mini_batch_src_global generation:  0.016625165939331055
r_  generation:  0.13356900215148926
local_output_nid generation:  0.007230520248413086
local_in_edges_tensor generation:  0.008680105209350586
mini_batch_src_global generation:  0.016040563583374023
r_  generation:  0.13484644889831543
local_output_nid generation:  0.00710296630859375
local_in_edges_tensor generation:  0.009684085845947266
mini_batch_src_global generation:  0.01599287986755371
r_  generation:  0.1305396556854248
local_output_nid generation:  0.007245302200317383
local_in_edges_tensor generation:  0.007654905319213867
mini_batch_src_global generation:  0.0160977840423584
r_  generation:  0.13386917114257812
local_output_nid generation:  0.007202625274658203
local_in_edges_tensor generation:  0.008690357208251953
mini_batch_src_global generation:  0.016096115112304688
r_  generation:  0.13247156143188477
local_output_nid generation:  0.007376194000244141
local_in_edges_tensor generation:  0.011215925216674805
mini_batch_src_global generation:  0.016461610794067383
r_  generation:  0.13944768905639648
local_output_nid generation:  0.007182598114013672
local_in_edges_tensor generation:  0.007791042327880859
mini_batch_src_global generation:  0.01626276969909668
r_  generation:  0.13469529151916504
local_output_nid generation:  0.0070896148681640625
local_in_edges_tensor generation:  0.008336305618286133
mini_batch_src_global generation:  0.015623331069946289
r_  generation:  0.13005280494689941
local_output_nid generation:  0.007228851318359375
local_in_edges_tensor generation:  0.008789777755737305
mini_batch_src_global generation:  0.01574563980102539
r_  generation:  0.13557791709899902
local_output_nid generation:  0.007584095001220703
local_in_edges_tensor generation:  0.011592626571655273
mini_batch_src_global generation:  0.016904830932617188
r_  generation:  0.14133381843566895
local_output_nid generation:  0.007333517074584961
local_in_edges_tensor generation:  0.008031129837036133
mini_batch_src_global generation:  0.016288280487060547
r_  generation:  0.13374710083007812
local_output_nid generation:  0.00736689567565918
local_in_edges_tensor generation:  0.008772611618041992
mini_batch_src_global generation:  0.017305850982666016
r_  generation:  0.13710570335388184
local_output_nid generation:  0.007191896438598633
local_in_edges_tensor generation:  0.007977962493896484
mini_batch_src_global generation:  0.01633310317993164
r_  generation:  0.1330854892730713
local_output_nid generation:  0.007204532623291016
local_in_edges_tensor generation:  0.00775146484375
mini_batch_src_global generation:  0.015594005584716797
r_  generation:  0.13515591621398926
----------------------check_connections_block total spend ----------------------------- 6.247992992401123
generate_one_block  0.16944646835327148
generate_one_block  0.16649293899536133
generate_one_block  0.17796015739440918
generate_one_block  0.16848421096801758
generate_one_block  0.17215180397033691
generate_one_block  0.16302871704101562
generate_one_block  0.16114068031311035
generate_one_block  0.1598374843597412
generate_one_block  0.16644597053527832
generate_one_block  0.1655731201171875
generate_one_block  0.1559305191040039
generate_one_block  0.1635730266571045
generate_one_block  0.17070269584655762
generate_one_block  0.16384649276733398
generate_one_block  0.1656818389892578
generate_one_block  0.18722033500671387
generate_one_block  0.16386985778808594
generate_one_block  0.17259430885314941
generate_one_block  0.17258572578430176
generate_one_block  0.16568851470947266
generate_one_block  0.16259336471557617
generate_one_block  0.16796040534973145
generate_one_block  0.16762304306030273
generate_one_block  0.1778275966644287
generate_one_block  0.1650853157043457
generate_one_block  0.16322088241577148
generate_one_block  0.16558575630187988
generate_one_block  0.17659950256347656
generate_one_block  0.17581510543823242
generate_one_block  0.17268157005310059
generate_one_block  0.1627652645111084
generate_one_block  0.1628131866455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05627012252807617
gen group dst list time:  0.10060572624206543
time for parepare:  0.0211334228515625
local_output_nid generation:  0.021176815032958984
local_in_edges_tensor generation:  0.05065107345581055
mini_batch_src_global generation:  0.037077903747558594
r_  generation:  0.38992929458618164
local_output_nid generation:  0.028209209442138672
local_in_edges_tensor generation:  0.0421142578125
mini_batch_src_global generation:  0.04807472229003906
r_  generation:  0.4116806983947754
local_output_nid generation:  0.02738022804260254
local_in_edges_tensor generation:  0.03887939453125
mini_batch_src_global generation:  0.04602932929992676
r_  generation:  0.4010767936706543
local_output_nid generation:  0.028843402862548828
local_in_edges_tensor generation:  0.040602922439575195
mini_batch_src_global generation:  0.04742908477783203
r_  generation:  0.3969600200653076
local_output_nid generation:  0.026450157165527344
local_in_edges_tensor generation:  0.028304100036621094
mini_batch_src_global generation:  0.04692578315734863
r_  generation:  0.3999929428100586
local_output_nid generation:  0.02640509605407715
local_in_edges_tensor generation:  0.03491663932800293
mini_batch_src_global generation:  0.046802520751953125
r_  generation:  0.3965578079223633
local_output_nid generation:  0.02602076530456543
local_in_edges_tensor generation:  0.030313491821289062
mini_batch_src_global generation:  0.04623723030090332
r_  generation:  0.3957936763763428
local_output_nid generation:  0.026102781295776367
local_in_edges_tensor generation:  0.030390262603759766
mini_batch_src_global generation:  0.047002553939819336
r_  generation:  0.3953416347503662
local_output_nid generation:  0.026379823684692383
local_in_edges_tensor generation:  0.031196117401123047
mini_batch_src_global generation:  0.049517154693603516
r_  generation:  0.3992910385131836
local_output_nid generation:  0.02618265151977539
local_in_edges_tensor generation:  0.03413963317871094
mini_batch_src_global generation:  0.04642319679260254
r_  generation:  0.392824649810791
local_output_nid generation:  0.02625441551208496
local_in_edges_tensor generation:  0.027018070220947266
mini_batch_src_global generation:  0.07325053215026855
r_  generation:  0.39470672607421875
local_output_nid generation:  0.026230812072753906
local_in_edges_tensor generation:  0.030608177185058594
mini_batch_src_global generation:  0.047698020935058594
r_  generation:  0.39504122734069824
local_output_nid generation:  0.027492761611938477
local_in_edges_tensor generation:  0.054533958435058594
mini_batch_src_global generation:  0.05178356170654297
r_  generation:  0.42839717864990234
local_output_nid generation:  0.02843189239501953
local_in_edges_tensor generation:  0.03618502616882324
mini_batch_src_global generation:  0.04788517951965332
r_  generation:  0.40106964111328125
local_output_nid generation:  0.026467084884643555
local_in_edges_tensor generation:  0.02764153480529785
mini_batch_src_global generation:  0.047585487365722656
r_  generation:  0.40685009956359863
local_output_nid generation:  0.026360750198364258
local_in_edges_tensor generation:  0.027399063110351562
mini_batch_src_global generation:  0.047678470611572266
r_  generation:  0.3991091251373291
local_output_nid generation:  0.02633810043334961
local_in_edges_tensor generation:  0.027851343154907227
mini_batch_src_global generation:  0.04947710037231445
r_  generation:  0.4014158248901367
local_output_nid generation:  0.026825428009033203
local_in_edges_tensor generation:  0.03181314468383789
mini_batch_src_global generation:  0.047466278076171875
r_  generation:  0.4050743579864502
local_output_nid generation:  0.026536941528320312
local_in_edges_tensor generation:  0.031807899475097656
mini_batch_src_global generation:  0.04719090461730957
r_  generation:  0.409773588180542
local_output_nid generation:  0.026477336883544922
local_in_edges_tensor generation:  0.025015830993652344
mini_batch_src_global generation:  0.0476984977722168
r_  generation:  0.3972437381744385
local_output_nid generation:  0.02638387680053711
local_in_edges_tensor generation:  0.02429652214050293
mini_batch_src_global generation:  0.04708528518676758
r_  generation:  0.4021298885345459
local_output_nid generation:  0.026364803314208984
local_in_edges_tensor generation:  0.03156018257141113
mini_batch_src_global generation:  0.04782676696777344
r_  generation:  0.3967099189758301
local_output_nid generation:  0.026282072067260742
local_in_edges_tensor generation:  0.03183245658874512
mini_batch_src_global generation:  0.046874284744262695
r_  generation:  0.40143680572509766
local_output_nid generation:  0.0267789363861084
local_in_edges_tensor generation:  0.027572154998779297
mini_batch_src_global generation:  0.04982566833496094
r_  generation:  0.4217214584350586
local_output_nid generation:  0.026576757431030273
local_in_edges_tensor generation:  0.028165102005004883
mini_batch_src_global generation:  0.06079745292663574
r_  generation:  0.4052572250366211
local_output_nid generation:  0.026208162307739258
local_in_edges_tensor generation:  0.024225950241088867
mini_batch_src_global generation:  0.0480351448059082
r_  generation:  0.39796996116638184
local_output_nid generation:  0.026523828506469727
local_in_edges_tensor generation:  0.02741074562072754
mini_batch_src_global generation:  0.046773672103881836
r_  generation:  0.40517234802246094
local_output_nid generation:  0.026801109313964844
local_in_edges_tensor generation:  0.036762237548828125
mini_batch_src_global generation:  0.04775261878967285
r_  generation:  0.407177209854126
local_output_nid generation:  0.026644229888916016
local_in_edges_tensor generation:  0.028501272201538086
mini_batch_src_global generation:  0.0466761589050293
r_  generation:  0.40711307525634766
local_output_nid generation:  0.03407931327819824
local_in_edges_tensor generation:  0.028270483016967773
mini_batch_src_global generation:  0.05091714859008789
r_  generation:  0.40270042419433594
local_output_nid generation:  0.026291608810424805
local_in_edges_tensor generation:  0.027245759963989258
mini_batch_src_global generation:  0.04683804512023926
r_  generation:  0.40659022331237793
local_output_nid generation:  0.026441335678100586
local_in_edges_tensor generation:  0.02442646026611328
mini_batch_src_global generation:  0.04819178581237793
r_  generation:  0.39632320404052734
----------------------check_connections_block total spend ----------------------------- 19.130611419677734
generate_one_block  0.6123266220092773
generate_one_block  0.5185661315917969
generate_one_block  0.5031239986419678
generate_one_block  0.5192303657531738
generate_one_block  0.5173392295837402
generate_one_block  0.5180771350860596
generate_one_block  0.5127279758453369
generate_one_block  0.5012519359588623
generate_one_block  0.5152559280395508
generate_one_block  0.513768196105957
generate_one_block  0.507709264755249
generate_one_block  0.5091166496276855
generate_one_block  0.5302722454071045
generate_one_block  0.5045599937438965
generate_one_block  0.51719069480896
generate_one_block  0.5029034614562988
generate_one_block  0.5120434761047363
generate_one_block  0.524914026260376
generate_one_block  0.5139265060424805
generate_one_block  0.5004360675811768
generate_one_block  0.531501293182373
generate_one_block  0.5138468742370605
generate_one_block  0.5131254196166992
generate_one_block  0.5246150493621826
generate_one_block  0.5162711143493652
generate_one_block  0.5049490928649902
generate_one_block  0.572230339050293
generate_one_block  0.571173906326294
generate_one_block  0.5511033535003662
generate_one_block  0.5359094142913818
generate_one_block  0.5166120529174805
generate_one_block  0.5125994682312012
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  25.378604412078857
block generation total time  22.091503143310547
average batch blocks generation time:  0.6903594732284546
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08365774154663086  GigaBytes
Max Memory Allocated: 0.08365774154663086  GigaBytes

torch.Size([145839, 128])
torch.Size([100370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.4686279296875 GB
    Memory Allocated: 11.10761022567749  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.4744873046875 GB
    Memory Allocated: 0.08487558364868164  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145418, 128])
torch.Size([99956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 11.001459121704102  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 0.0846395492553711  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145738, 128])
torch.Size([98874, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 10.830727100372314  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 0.08486509323120117  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145436, 128])
torch.Size([99501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 11.065577030181885  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 0.08482122421264648  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145309, 128])
torch.Size([99664, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 11.060833930969238  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 0.08494043350219727  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145666, 128])
torch.Size([99638, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 11.052006721496582  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 0.0836019515991211  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145206, 128])
torch.Size([98230, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 10.84522294998169  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7733154296875 GB
    Memory Allocated: 0.08364343643188477  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145475, 128])
torch.Size([98279, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 10.75508451461792  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 0.0848073959350586  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([145783, 128])
torch.Size([99653, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 10.972973346710205  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 0.08343076705932617  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([144883, 128])
torch.Size([97960, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 10.81606149673462  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 0.08332347869873047  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([144926, 128])
torch.Size([98143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 10.730917930603027  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 0.08352327346801758  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([144961, 128])
torch.Size([98269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 10.827618598937988  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7830810546875 GB
    Memory Allocated: 0.08584070205688477  GigaBytes
Max Memory Allocated: 11.114636898040771  GigaBytes

torch.Size([146095, 128])
torch.Size([100161, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3865966796875 GB
    Memory Allocated: 11.124995231628418  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3865966796875 GB
    Memory Allocated: 0.0839385986328125  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145628, 128])
torch.Size([99152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3865966796875 GB
    Memory Allocated: 11.000528812408447  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3865966796875 GB
    Memory Allocated: 0.08479881286621094  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([146218, 128])
torch.Size([99822, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3865966796875 GB
    Memory Allocated: 10.955989837646484  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3865966796875 GB
    Memory Allocated: 0.08375740051269531  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145486, 128])
torch.Size([98918, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.84035873413086  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08469104766845703  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145622, 128])
torch.Size([99072, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.830003261566162  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08502531051635742  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145793, 128])
torch.Size([100248, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 11.089421272277832  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08581829071044922  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145539, 128])
torch.Size([99643, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 11.060546398162842  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08359193801879883  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145067, 128])
torch.Size([98669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.858198642730713  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08365297317504883  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145303, 128])
torch.Size([98556, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.832928657531738  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.0837717056274414  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145210, 128])
torch.Size([98900, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 11.00084638595581  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08356046676635742  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([144953, 128])
torch.Size([98623, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.942031860351562  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08475828170776367  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145177, 128])
torch.Size([99424, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 11.090449333190918  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08580589294433594  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145722, 128])
torch.Size([99523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 11.029982089996338  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08351469039916992  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([144977, 128])
torch.Size([98224, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.858595371246338  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.08475494384765625  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([145927, 128])
torch.Size([99323, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 10.89327621459961  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4022216796875 GB
    Memory Allocated: 0.085205078125  GigaBytes
Max Memory Allocated: 11.133238315582275  GigaBytes

torch.Size([146078, 128])
torch.Size([101021, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.20388412475586  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08362483978271484  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145004, 128])
torch.Size([98823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.925650119781494  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08509588241577148  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145889, 128])
torch.Size([100384, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.10566234588623  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08373355865478516  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145328, 128])
torch.Size([98977, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.90740442276001  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.0838465690612793  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145755, 128])
torch.Size([99051, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.80422830581665  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03166542947292328 |0.02525538206100464 |0.2500048354268074 |9.372830390930176e-05 |0.3161522001028061 |0.006678342819213867 |
----------------------------------------------------------pseudo_mini_loss sum 4.953402519226074
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8582568
Number of first layer input nodes during this epoch:  4655411
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.1023707389831543  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02043914794921875
random selection method range initialization spend 0.0056302547454833984
time for parepare:  0.018550634384155273
local_output_nid generation:  0.0014019012451171875
local_in_edges_tensor generation:  0.008411169052124023
mini_batch_src_global generation:  0.0015921592712402344
r_  generation:  0.008794784545898438
local_output_nid generation:  0.0016350746154785156
local_in_edges_tensor generation:  0.0010480880737304688
mini_batch_src_global generation:  0.0013179779052734375
r_  generation:  0.00804448127746582
local_output_nid generation:  0.0016236305236816406
local_in_edges_tensor generation:  0.0009453296661376953
mini_batch_src_global generation:  0.0009899139404296875
r_  generation:  0.007930755615234375
local_output_nid generation:  0.001600503921508789
local_in_edges_tensor generation:  0.0008718967437744141
mini_batch_src_global generation:  0.0009186267852783203
r_  generation:  0.00783848762512207
local_output_nid generation:  0.001581430435180664
local_in_edges_tensor generation:  0.0008344650268554688
mini_batch_src_global generation:  0.000896453857421875
r_  generation:  0.007950544357299805
local_output_nid generation:  0.0015621185302734375
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0009145736694335938
r_  generation:  0.008161544799804688
local_output_nid generation:  0.0015451908111572266
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0010020732879638672
r_  generation:  0.008393287658691406
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.0084381103515625
local_output_nid generation:  0.0015439987182617188
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0009214878082275391
r_  generation:  0.00828242301940918
local_output_nid generation:  0.0015583038330078125
local_in_edges_tensor generation:  0.0008516311645507812
mini_batch_src_global generation:  0.0009114742279052734
r_  generation:  0.008221626281738281
local_output_nid generation:  0.001539468765258789
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008272409439086914
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0007998943328857422
mini_batch_src_global generation:  0.0008575916290283203
r_  generation:  0.00818014144897461
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0008161067962646484
mini_batch_src_global generation:  0.0009276866912841797
r_  generation:  0.008580207824707031
local_output_nid generation:  0.0015513896942138672
local_in_edges_tensor generation:  0.0007774829864501953
mini_batch_src_global generation:  0.0008981227874755859
r_  generation:  0.008323192596435547
local_output_nid generation:  0.0015401840209960938
local_in_edges_tensor generation:  0.0008149147033691406
mini_batch_src_global generation:  0.0008940696716308594
r_  generation:  0.008245706558227539
local_output_nid generation:  0.0015153884887695312
local_in_edges_tensor generation:  0.0008072853088378906
mini_batch_src_global generation:  0.0008816719055175781
r_  generation:  0.007999181747436523
local_output_nid generation:  0.0015418529510498047
local_in_edges_tensor generation:  0.0008068084716796875
mini_batch_src_global generation:  0.0008857250213623047
r_  generation:  0.00812387466430664
local_output_nid generation:  0.0015959739685058594
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0009546279907226562
r_  generation:  0.008445262908935547
local_output_nid generation:  0.0015397071838378906
local_in_edges_tensor generation:  0.0007698535919189453
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.008553266525268555
local_output_nid generation:  0.0015380382537841797
local_in_edges_tensor generation:  0.0007903575897216797
mini_batch_src_global generation:  0.0009138584136962891
r_  generation:  0.00826716423034668
local_output_nid generation:  0.0015115737915039062
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0008947849273681641
r_  generation:  0.008266448974609375
local_output_nid generation:  0.001529693603515625
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0008864402770996094
r_  generation:  0.008143186569213867
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.00075531005859375
mini_batch_src_global generation:  0.000873565673828125
r_  generation:  0.008211135864257812
local_output_nid generation:  0.0015156269073486328
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0009057521820068359
r_  generation:  0.00845789909362793
local_output_nid generation:  0.001512289047241211
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.008317232131958008
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.00089263916015625
r_  generation:  0.008353471755981445
local_output_nid generation:  0.0014882087707519531
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0008747577667236328
r_  generation:  0.008442878723144531
local_output_nid generation:  0.0015270709991455078
local_in_edges_tensor generation:  0.0007877349853515625
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.008115053176879883
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.0007588863372802734
mini_batch_src_global generation:  0.0008556842803955078
r_  generation:  0.012154579162597656
local_output_nid generation:  0.0019140243530273438
local_in_edges_tensor generation:  0.0011610984802246094
mini_batch_src_global generation:  0.00104522705078125
r_  generation:  0.009223461151123047
local_output_nid generation:  0.0015535354614257812
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.0009875297546386719
r_  generation:  0.008572578430175781
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0008385181427001953
mini_batch_src_global generation:  0.0008959770202636719
r_  generation:  0.008264780044555664
----------------------check_connections_block total spend ----------------------------- 0.4894895553588867
generate_one_block  0.022490501403808594
generate_one_block  0.018108844757080078
generate_one_block  0.01528310775756836
generate_one_block  0.014806747436523438
generate_one_block  0.014738321304321289
generate_one_block  0.014969587326049805
generate_one_block  0.015197992324829102
generate_one_block  0.014956235885620117
generate_one_block  0.014782428741455078
generate_one_block  0.014727592468261719
generate_one_block  0.014598846435546875
generate_one_block  0.014822721481323242
generate_one_block  0.015187263488769531
generate_one_block  0.014893293380737305
generate_one_block  0.014378786087036133
generate_one_block  0.014333486557006836
generate_one_block  0.014423131942749023
generate_one_block  0.015050411224365234
generate_one_block  0.014969587326049805
generate_one_block  0.01454615592956543
generate_one_block  0.014585256576538086
generate_one_block  0.014593124389648438
generate_one_block  0.02161431312561035
generate_one_block  0.015117883682250977
generate_one_block  0.014707326889038086
generate_one_block  0.014722347259521484
generate_one_block  0.014936208724975586
generate_one_block  0.014230012893676758
generate_one_block  0.014366865158081055
generate_one_block  0.015131235122680664
generate_one_block  0.015167713165283203
generate_one_block  0.014608144760131836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051122426986694336
gen group dst list time:  0.020257234573364258
time for parepare:  0.021832704544067383
local_output_nid generation:  0.005942583084106445
local_in_edges_tensor generation:  0.024550199508666992
mini_batch_src_global generation:  0.012229442596435547
r_  generation:  0.1234598159790039
local_output_nid generation:  0.010623455047607422
local_in_edges_tensor generation:  0.010077238082885742
mini_batch_src_global generation:  0.014519453048706055
r_  generation:  0.12131071090698242
local_output_nid generation:  0.008914709091186523
local_in_edges_tensor generation:  0.03313732147216797
mini_batch_src_global generation:  0.013407230377197266
r_  generation:  0.12829899787902832
local_output_nid generation:  0.008716583251953125
local_in_edges_tensor generation:  0.011037826538085938
mini_batch_src_global generation:  0.014378786087036133
r_  generation:  0.13163518905639648
local_output_nid generation:  0.008872270584106445
local_in_edges_tensor generation:  0.010827302932739258
mini_batch_src_global generation:  0.015001296997070312
r_  generation:  0.13248324394226074
local_output_nid generation:  0.008879423141479492
local_in_edges_tensor generation:  0.008753061294555664
mini_batch_src_global generation:  0.015537261962890625
r_  generation:  0.132798433303833
local_output_nid generation:  0.008599281311035156
local_in_edges_tensor generation:  0.011675119400024414
mini_batch_src_global generation:  0.016110658645629883
r_  generation:  0.13929390907287598
local_output_nid generation:  0.008687734603881836
local_in_edges_tensor generation:  0.010903596878051758
mini_batch_src_global generation:  0.016184091567993164
r_  generation:  0.1355149745941162
local_output_nid generation:  0.008448600769042969
local_in_edges_tensor generation:  0.009880542755126953
mini_batch_src_global generation:  0.01726078987121582
r_  generation:  0.1376972198486328
local_output_nid generation:  0.00847005844116211
local_in_edges_tensor generation:  0.009806632995605469
mini_batch_src_global generation:  0.016301631927490234
r_  generation:  0.13498401641845703
local_output_nid generation:  0.008644580841064453
local_in_edges_tensor generation:  0.009937047958374023
mini_batch_src_global generation:  0.016129255294799805
r_  generation:  0.14159250259399414
local_output_nid generation:  0.008794784545898438
local_in_edges_tensor generation:  0.00875544548034668
mini_batch_src_global generation:  0.015959501266479492
r_  generation:  0.13275814056396484
local_output_nid generation:  0.009088754653930664
local_in_edges_tensor generation:  0.008870840072631836
mini_batch_src_global generation:  0.016811609268188477
r_  generation:  0.14432477951049805
local_output_nid generation:  0.008800983428955078
local_in_edges_tensor generation:  0.011748790740966797
mini_batch_src_global generation:  0.016472578048706055
r_  generation:  0.1354978084564209
local_output_nid generation:  0.008726835250854492
local_in_edges_tensor generation:  0.008785009384155273
mini_batch_src_global generation:  0.01583075523376465
r_  generation:  0.1364283561706543
local_output_nid generation:  0.008681535720825195
local_in_edges_tensor generation:  0.008508443832397461
mini_batch_src_global generation:  0.01555323600769043
r_  generation:  0.1307816505432129
local_output_nid generation:  0.008806228637695312
local_in_edges_tensor generation:  0.008756160736083984
mini_batch_src_global generation:  0.016139745712280273
r_  generation:  0.13576245307922363
local_output_nid generation:  0.008840084075927734
local_in_edges_tensor generation:  0.009659051895141602
mini_batch_src_global generation:  0.015996932983398438
r_  generation:  0.13701677322387695
local_output_nid generation:  0.00909733772277832
local_in_edges_tensor generation:  0.009935617446899414
mini_batch_src_global generation:  0.017409563064575195
r_  generation:  0.14134907722473145
local_output_nid generation:  0.008728742599487305
local_in_edges_tensor generation:  0.008747577667236328
mini_batch_src_global generation:  0.015974760055541992
r_  generation:  0.13515067100524902
local_output_nid generation:  0.008633852005004883
local_in_edges_tensor generation:  0.00880575180053711
mini_batch_src_global generation:  0.017161130905151367
r_  generation:  0.1383345127105713
local_output_nid generation:  0.00843954086303711
local_in_edges_tensor generation:  0.008735418319702148
mini_batch_src_global generation:  0.01607060432434082
r_  generation:  0.13723254203796387
local_output_nid generation:  0.008548736572265625
local_in_edges_tensor generation:  0.010639190673828125
mini_batch_src_global generation:  0.01631784439086914
r_  generation:  0.14068174362182617
local_output_nid generation:  0.008580684661865234
local_in_edges_tensor generation:  0.012067556381225586
mini_batch_src_global generation:  0.016981124877929688
r_  generation:  0.14061474800109863
local_output_nid generation:  0.008494138717651367
local_in_edges_tensor generation:  0.010998725891113281
mini_batch_src_global generation:  0.016512632369995117
r_  generation:  0.14002442359924316
local_output_nid generation:  0.008736133575439453
local_in_edges_tensor generation:  0.009891033172607422
mini_batch_src_global generation:  0.016508817672729492
r_  generation:  0.1379847526550293
local_output_nid generation:  0.008570671081542969
local_in_edges_tensor generation:  0.011133670806884766
mini_batch_src_global generation:  0.016788005828857422
r_  generation:  0.14398550987243652
local_output_nid generation:  0.008346796035766602
local_in_edges_tensor generation:  0.008544445037841797
mini_batch_src_global generation:  0.015839338302612305
r_  generation:  0.13237428665161133
local_output_nid generation:  0.008423089981079102
local_in_edges_tensor generation:  0.009641885757446289
mini_batch_src_global generation:  0.015477895736694336
r_  generation:  0.13457870483398438
local_output_nid generation:  0.00858759880065918
local_in_edges_tensor generation:  0.011091947555541992
mini_batch_src_global generation:  0.01758575439453125
r_  generation:  0.14159464836120605
local_output_nid generation:  0.008745431900024414
local_in_edges_tensor generation:  0.011229515075683594
mini_batch_src_global generation:  0.01674962043762207
r_  generation:  0.14558887481689453
local_output_nid generation:  0.00849151611328125
local_in_edges_tensor generation:  0.008900165557861328
mini_batch_src_global generation:  0.01640033721923828
r_  generation:  0.1381664276123047
----------------------check_connections_block total spend ----------------------------- 6.5314271450042725
generate_one_block  0.17969942092895508
generate_one_block  0.16762661933898926
generate_one_block  0.17399048805236816
generate_one_block  0.17346572875976562
generate_one_block  0.1865406036376953
generate_one_block  0.17069149017333984
generate_one_block  0.1766343116760254
generate_one_block  0.17786073684692383
generate_one_block  0.17731642723083496
generate_one_block  0.17107796669006348
generate_one_block  0.1726539134979248
generate_one_block  0.1684095859527588
generate_one_block  0.18317198753356934
generate_one_block  0.16987872123718262
generate_one_block  0.16820049285888672
generate_one_block  0.1651163101196289
generate_one_block  0.17329668998718262
generate_one_block  0.17120122909545898
generate_one_block  0.1769423484802246
generate_one_block  0.19208645820617676
generate_one_block  0.17520713806152344
generate_one_block  0.17812895774841309
generate_one_block  0.17689180374145508
generate_one_block  0.1830155849456787
generate_one_block  0.17786359786987305
generate_one_block  0.17400550842285156
generate_one_block  0.18135809898376465
generate_one_block  0.16688179969787598
generate_one_block  0.16842079162597656
generate_one_block  0.18494892120361328
generate_one_block  0.18517589569091797
generate_one_block  0.17114043235778809
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07437753677368164
gen group dst list time:  0.10405564308166504
time for parepare:  0.018039941787719727
local_output_nid generation:  0.02372145652770996
local_in_edges_tensor generation:  0.050026655197143555
mini_batch_src_global generation:  0.03556966781616211
r_  generation:  0.38865017890930176
local_output_nid generation:  0.028598546981811523
local_in_edges_tensor generation:  0.040685176849365234
mini_batch_src_global generation:  0.058014631271362305
r_  generation:  0.3909487724304199
local_output_nid generation:  0.028543949127197266
local_in_edges_tensor generation:  0.03408694267272949
mini_batch_src_global generation:  0.05151724815368652
r_  generation:  0.4004054069519043
local_output_nid generation:  0.026944875717163086
local_in_edges_tensor generation:  0.04035234451293945
mini_batch_src_global generation:  0.046783447265625
r_  generation:  0.4022088050842285
local_output_nid generation:  0.026929855346679688
local_in_edges_tensor generation:  0.026896953582763672
mini_batch_src_global generation:  0.04696297645568848
r_  generation:  0.40369629859924316
local_output_nid generation:  0.026812314987182617
local_in_edges_tensor generation:  0.02704477310180664
mini_batch_src_global generation:  0.04746127128601074
r_  generation:  0.4067368507385254
local_output_nid generation:  0.027203083038330078
local_in_edges_tensor generation:  0.04012727737426758
mini_batch_src_global generation:  0.04932451248168945
r_  generation:  0.40768957138061523
local_output_nid generation:  0.02727651596069336
local_in_edges_tensor generation:  0.03814578056335449
mini_batch_src_global generation:  0.04783058166503906
r_  generation:  0.4047548770904541
local_output_nid generation:  0.027199983596801758
local_in_edges_tensor generation:  0.026620864868164062
mini_batch_src_global generation:  0.047255516052246094
r_  generation:  0.4102449417114258
local_output_nid generation:  0.02704930305480957
local_in_edges_tensor generation:  0.02775096893310547
mini_batch_src_global generation:  0.047391414642333984
r_  generation:  0.40448999404907227
local_output_nid generation:  0.02681875228881836
local_in_edges_tensor generation:  0.027216196060180664
mini_batch_src_global generation:  0.04729795455932617
r_  generation:  0.4030168056488037
local_output_nid generation:  0.027106523513793945
local_in_edges_tensor generation:  0.03028249740600586
mini_batch_src_global generation:  0.05566287040710449
r_  generation:  0.40536928176879883
local_output_nid generation:  0.028174638748168945
local_in_edges_tensor generation:  0.0398404598236084
mini_batch_src_global generation:  0.05083799362182617
r_  generation:  0.4075169563293457
local_output_nid generation:  0.027308225631713867
local_in_edges_tensor generation:  0.027759552001953125
mini_batch_src_global generation:  0.04828143119812012
r_  generation:  0.4240734577178955
local_output_nid generation:  0.02979421615600586
local_in_edges_tensor generation:  0.0319066047668457
mini_batch_src_global generation:  0.04792952537536621
r_  generation:  0.40391969680786133
local_output_nid generation:  0.027705669403076172
local_in_edges_tensor generation:  0.030991077423095703
mini_batch_src_global generation:  0.047616004943847656
r_  generation:  0.39848971366882324
local_output_nid generation:  0.027751684188842773
local_in_edges_tensor generation:  0.037499427795410156
mini_batch_src_global generation:  0.04719352722167969
r_  generation:  0.40881824493408203
local_output_nid generation:  0.027770519256591797
local_in_edges_tensor generation:  0.026929616928100586
mini_batch_src_global generation:  0.047495126724243164
r_  generation:  0.401064395904541
local_output_nid generation:  0.027882814407348633
local_in_edges_tensor generation:  0.03426837921142578
mini_batch_src_global generation:  0.049616336822509766
r_  generation:  0.40717267990112305
local_output_nid generation:  0.02770066261291504
local_in_edges_tensor generation:  0.030247926712036133
mini_batch_src_global generation:  0.04925179481506348
r_  generation:  0.4026784896850586
local_output_nid generation:  0.027733325958251953
local_in_edges_tensor generation:  0.034912824630737305
mini_batch_src_global generation:  0.04975128173828125
r_  generation:  0.40726137161254883
local_output_nid generation:  0.02786540985107422
local_in_edges_tensor generation:  0.027034282684326172
mini_batch_src_global generation:  0.04750394821166992
r_  generation:  0.4002068042755127
local_output_nid generation:  0.028036117553710938
local_in_edges_tensor generation:  0.02687382698059082
mini_batch_src_global generation:  0.0478823184967041
r_  generation:  0.40604066848754883
local_output_nid generation:  0.027936935424804688
local_in_edges_tensor generation:  0.033748626708984375
mini_batch_src_global generation:  0.04742002487182617
r_  generation:  0.40546202659606934
local_output_nid generation:  0.02792668342590332
local_in_edges_tensor generation:  0.03493499755859375
mini_batch_src_global generation:  0.04956960678100586
r_  generation:  0.4088609218597412
local_output_nid generation:  0.02791905403137207
local_in_edges_tensor generation:  0.03080892562866211
mini_batch_src_global generation:  0.047431230545043945
r_  generation:  0.40328025817871094
local_output_nid generation:  0.027850866317749023
local_in_edges_tensor generation:  0.034241437911987305
mini_batch_src_global generation:  0.05005598068237305
r_  generation:  0.4074428081512451
local_output_nid generation:  0.027199745178222656
local_in_edges_tensor generation:  0.026512622833251953
mini_batch_src_global generation:  0.05657696723937988
r_  generation:  0.39719343185424805
local_output_nid generation:  0.02739238739013672
local_in_edges_tensor generation:  0.027529478073120117
mini_batch_src_global generation:  0.04722785949707031
r_  generation:  0.402606725692749
local_output_nid generation:  0.02800726890563965
local_in_edges_tensor generation:  0.03888368606567383
mini_batch_src_global generation:  0.048305511474609375
r_  generation:  0.40828990936279297
local_output_nid generation:  0.02810072898864746
local_in_edges_tensor generation:  0.03286123275756836
mini_batch_src_global generation:  0.046959877014160156
r_  generation:  0.41455078125
local_output_nid generation:  0.02893853187561035
local_in_edges_tensor generation:  0.034082889556884766
mini_batch_src_global generation:  0.052581071853637695
r_  generation:  0.40842461585998535
----------------------check_connections_block total spend ----------------------------- 19.259642362594604
generate_one_block  0.5342092514038086
generate_one_block  0.5383419990539551
generate_one_block  0.5430600643157959
generate_one_block  0.5389032363891602
generate_one_block  0.6346800327301025
generate_one_block  0.5292916297912598
generate_one_block  0.5459988117218018
generate_one_block  0.5392277240753174
generate_one_block  0.5917980670928955
generate_one_block  0.5611288547515869
generate_one_block  0.5709683895111084
generate_one_block  0.5395755767822266
generate_one_block  0.5657274723052979
generate_one_block  0.5366899967193604
generate_one_block  0.5359482765197754
generate_one_block  0.5443375110626221
generate_one_block  0.5572681427001953
generate_one_block  0.5364701747894287
generate_one_block  0.5475618839263916
generate_one_block  0.5233991146087646
generate_one_block  0.542792797088623
generate_one_block  0.549227237701416
generate_one_block  0.5364861488342285
generate_one_block  0.5392708778381348
generate_one_block  0.5647103786468506
generate_one_block  0.5308830738067627
generate_one_block  0.5447626113891602
generate_one_block  0.5212998390197754
generate_one_block  0.5312294960021973
generate_one_block  0.560563325881958
generate_one_block  0.545203447341919
generate_one_block  0.5260426998138428
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.1023707389831543  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

connection checking time:  25.791069507598877
block generation total time  23.12595820426941
average batch blocks generation time:  0.722686193883419
block dataloader generation time/epoch 51.667813301086426
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08644437789916992  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145458, 128])
torch.Size([98871, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.851332187652588  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08519315719604492  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([144873, 128])
torch.Size([98430, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.884206771850586  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08646965026855469  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145479, 128])
torch.Size([99071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.94322681427002  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08647918701171875  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145305, 128])
torch.Size([99173, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.012582778930664  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.0855097770690918  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145345, 128])
torch.Size([99249, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.990040302276611  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08527183532714844  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([144958, 128])
torch.Size([98751, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.946030616760254  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.0875391960144043  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145720, 128])
torch.Size([99945, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.107105255126953  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08675384521484375  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145839, 128])
torch.Size([99924, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.050886154174805  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08754110336303711  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145586, 128])
torch.Size([99452, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.049200534820557  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08568286895751953  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145718, 128])
torch.Size([99046, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.984989643096924  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.086456298828125  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145426, 128])
torch.Size([98652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.88726282119751  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.0856471061706543  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145879, 128])
torch.Size([99188, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.878599643707275  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08651971817016602  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145235, 128])
torch.Size([99463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.109003067016602  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08560800552368164  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145615, 128])
torch.Size([99215, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.946391582489014  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.085052490234375  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([144716, 128])
torch.Size([98230, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.823764324188232  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08506917953491211  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([144949, 128])
torch.Size([97926, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.723000526428223  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08646869659423828  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145624, 128])
torch.Size([98726, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.959026336669922  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08521509170532227  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145055, 128])
torch.Size([98456, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.828430652618408  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08752822875976562  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145945, 128])
torch.Size([99849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.054593563079834  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08525562286376953  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145084, 128])
torch.Size([98408, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.821911811828613  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08750534057617188  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([146011, 128])
torch.Size([99972, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.057010650634766  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08551931381225586  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145519, 128])
torch.Size([99113, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.8908371925354  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08643817901611328  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145855, 128])
torch.Size([99358, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.866334438323975  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08657217025756836  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145434, 128])
torch.Size([99655, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.056496620178223  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.0875253677368164  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145727, 128])
torch.Size([99901, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.066291332244873  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08571529388427734  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145816, 128])
torch.Size([99949, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.944996356964111  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08754682540893555  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145457, 128])
torch.Size([99499, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.079649925231934  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08480453491210938  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([144700, 128])
torch.Size([96823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.631872653961182  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08633613586425781  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145531, 128])
torch.Size([98442, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 10.797135829925537  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08656930923461914  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145394, 128])
torch.Size([100103, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.0868558883667  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08756303787231445  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([145662, 128])
torch.Size([100103, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 11.130278587341309  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0076904296875 GB
    Memory Allocated: 0.08580684661865234  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

torch.Size([146066, 128])
torch.Size([100019, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0135498046875 GB
    Memory Allocated: 10.881892204284668  GigaBytes
Max Memory Allocated: 11.211509704589844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028906099498271942 |0.01304338127374649 |0.2312474474310875 |8.871406316757202e-05 |0.31197113543748856 |0.0058040618896484375 |
----------------------------------------------------------pseudo_mini_loss sum 3.8000128269195557
Total (block generation + training)time/epoch 70.45072388648987
Training time/epoch 18.782665729522705
Training time without block to device /epoch 18.365277528762817
Training time without total dataloading part /epoch 17.391637563705444
load block tensor time/epoch 0.9249951839447021
block to device time/epoch 0.4173882007598877
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8580195
Number of first layer input nodes during this epoch:  4654981
