Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648463654.0277557
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02746868133544922
random selection method range initialization spend 0.006386756896972656
time for parepare:  0.018608808517456055
local_output_nid generation:  0.0011179447174072266
local_in_edges_tensor generation:  0.00425410270690918
mini_batch_src_global generation:  0.0016543865203857422
r_  generation:  0.010491132736206055
local_output_nid generation:  0.0013141632080078125
local_in_edges_tensor generation:  0.0010297298431396484
mini_batch_src_global generation:  0.0016574859619140625
r_  generation:  0.009776115417480469
local_output_nid generation:  0.001355886459350586
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.0010035037994384766
r_  generation:  0.009027957916259766
local_output_nid generation:  0.001470804214477539
local_in_edges_tensor generation:  0.0008914470672607422
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.009223461151123047
local_output_nid generation:  0.0014262199401855469
local_in_edges_tensor generation:  0.0008544921875
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.009370803833007812
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.0008225440979003906
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.00959157943725586
local_output_nid generation:  0.0014400482177734375
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.001013040542602539
r_  generation:  0.009669303894042969
local_output_nid generation:  0.001444101333618164
local_in_edges_tensor generation:  0.0008039474487304688
mini_batch_src_global generation:  0.000989675521850586
r_  generation:  0.009804010391235352
local_output_nid generation:  0.0014317035675048828
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.0009906291961669922
r_  generation:  0.009553194046020508
local_output_nid generation:  0.0014576911926269531
local_in_edges_tensor generation:  0.0007731914520263672
mini_batch_src_global generation:  0.0009706020355224609
r_  generation:  0.00965261459350586
local_output_nid generation:  0.0014362335205078125
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.01017141342163086
local_output_nid generation:  0.0014657974243164062
local_in_edges_tensor generation:  0.0007936954498291016
mini_batch_src_global generation:  0.001035928726196289
r_  generation:  0.009850263595581055
local_output_nid generation:  0.0014646053314208984
local_in_edges_tensor generation:  0.0007781982421875
mini_batch_src_global generation:  0.0010418891906738281
r_  generation:  0.00963139533996582
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0007674694061279297
mini_batch_src_global generation:  0.0010416507720947266
r_  generation:  0.009850740432739258
local_output_nid generation:  0.001445770263671875
local_in_edges_tensor generation:  0.0007724761962890625
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.009919881820678711
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0009717941284179688
r_  generation:  0.00983572006225586
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0008265972137451172
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010402917861938477
local_output_nid generation:  0.0014955997467041016
local_in_edges_tensor generation:  0.0007958412170410156
mini_batch_src_global generation:  0.0010437965393066406
r_  generation:  0.00984811782836914
local_output_nid generation:  0.0014543533325195312
local_in_edges_tensor generation:  0.0007576942443847656
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.009942770004272461
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0007548332214355469
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.009698152542114258
local_output_nid generation:  0.0014584064483642578
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.009845256805419922
local_output_nid generation:  0.0014452934265136719
local_in_edges_tensor generation:  0.000759124755859375
mini_batch_src_global generation:  0.001018524169921875
r_  generation:  0.009932518005371094
local_output_nid generation:  0.0014557838439941406
local_in_edges_tensor generation:  0.0007646083831787109
mini_batch_src_global generation:  0.0010628700256347656
r_  generation:  0.010380268096923828
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0007793903350830078
mini_batch_src_global generation:  0.0010514259338378906
r_  generation:  0.010228157043457031
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0007808208465576172
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.01024317741394043
local_output_nid generation:  0.0014827251434326172
local_in_edges_tensor generation:  0.0007710456848144531
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.009946346282958984
local_output_nid generation:  0.0014598369598388672
local_in_edges_tensor generation:  0.0007643699645996094
mini_batch_src_global generation:  0.0009953975677490234
r_  generation:  0.009731531143188477
local_output_nid generation:  0.001478433609008789
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.010133981704711914
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0007622241973876953
mini_batch_src_global generation:  0.0010533332824707031
r_  generation:  0.010578155517578125
local_output_nid generation:  0.001506805419921875
local_in_edges_tensor generation:  0.005619525909423828
mini_batch_src_global generation:  0.0012691020965576172
r_  generation:  0.010135173797607422
local_output_nid generation:  0.0013589859008789062
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0010960102081298828
r_  generation:  0.009520292282104492
local_output_nid generation:  0.0014040470123291016
local_in_edges_tensor generation:  0.0007452964782714844
mini_batch_src_global generation:  0.0010695457458496094
r_  generation:  0.009807586669921875
----------------------check_connections_block total spend ----------------------------- 0.5383079051971436
generate_one_block  0.01574563980102539
generate_one_block  0.015641212463378906
generate_one_block  0.014191389083862305
generate_one_block  0.01428842544555664
generate_one_block  0.014461755752563477
generate_one_block  0.015218019485473633
generate_one_block  0.014922618865966797
generate_one_block  0.015045642852783203
generate_one_block  0.01503133773803711
generate_one_block  0.015180587768554688
generate_one_block  0.015249490737915039
generate_one_block  0.014714241027832031
generate_one_block  0.014343500137329102
generate_one_block  0.014696598052978516
generate_one_block  0.01487278938293457
generate_one_block  0.014119148254394531
generate_one_block  0.015196561813354492
generate_one_block  0.01449441909790039
generate_one_block  0.01475214958190918
generate_one_block  0.014597415924072266
generate_one_block  0.01483464241027832
generate_one_block  0.014945745468139648
generate_one_block  0.015514612197875977
generate_one_block  0.015029668807983398
generate_one_block  0.015163183212280273
generate_one_block  0.014707565307617188
generate_one_block  0.014130592346191406
generate_one_block  0.015095949172973633
generate_one_block  0.015367984771728516
generate_one_block  0.014605045318603516
generate_one_block  0.01427602767944336
generate_one_block  0.014512777328491211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040289878845214844
gen group dst list time:  0.02358222007751465
time for parepare:  0.019611597061157227
local_output_nid generation:  0.005456686019897461
local_in_edges_tensor generation:  0.014337539672851562
mini_batch_src_global generation:  0.013759613037109375
r_  generation:  0.1394486427307129
local_output_nid generation:  0.010402917861938477
local_in_edges_tensor generation:  0.015006303787231445
mini_batch_src_global generation:  0.018656492233276367
r_  generation:  0.14705204963684082
local_output_nid generation:  0.009465217590332031
local_in_edges_tensor generation:  0.010505437850952148
mini_batch_src_global generation:  0.015164852142333984
r_  generation:  0.13819646835327148
local_output_nid generation:  0.00965118408203125
local_in_edges_tensor generation:  0.01284646987915039
mini_batch_src_global generation:  0.015606164932250977
r_  generation:  0.13901543617248535
local_output_nid generation:  0.009721755981445312
local_in_edges_tensor generation:  0.009282112121582031
mini_batch_src_global generation:  0.017452001571655273
r_  generation:  0.14345049858093262
local_output_nid generation:  0.010057210922241211
local_in_edges_tensor generation:  0.013281583786010742
mini_batch_src_global generation:  0.018795251846313477
r_  generation:  0.14919710159301758
local_output_nid generation:  0.010050535202026367
local_in_edges_tensor generation:  0.01093149185180664
mini_batch_src_global generation:  0.017802715301513672
r_  generation:  0.14946651458740234
local_output_nid generation:  0.010187625885009766
local_in_edges_tensor generation:  0.012180805206298828
mini_batch_src_global generation:  0.01818370819091797
r_  generation:  0.15238547325134277
local_output_nid generation:  0.010098457336425781
local_in_edges_tensor generation:  0.012118816375732422
mini_batch_src_global generation:  0.01808905601501465
r_  generation:  0.15001153945922852
local_output_nid generation:  0.009898662567138672
local_in_edges_tensor generation:  0.009531021118164062
mini_batch_src_global generation:  0.0178680419921875
r_  generation:  0.14710164070129395
local_output_nid generation:  0.010168313980102539
local_in_edges_tensor generation:  0.011046886444091797
mini_batch_src_global generation:  0.0185391902923584
r_  generation:  0.15340662002563477
local_output_nid generation:  0.009915590286254883
local_in_edges_tensor generation:  0.009841442108154297
mini_batch_src_global generation:  0.018623828887939453
r_  generation:  0.15135884284973145
local_output_nid generation:  0.009708881378173828
local_in_edges_tensor generation:  0.009255409240722656
mini_batch_src_global generation:  0.01762247085571289
r_  generation:  0.14802837371826172
local_output_nid generation:  0.009963750839233398
local_in_edges_tensor generation:  0.011243343353271484
mini_batch_src_global generation:  0.018093109130859375
r_  generation:  0.14760088920593262
local_output_nid generation:  0.010062217712402344
local_in_edges_tensor generation:  0.010683774948120117
mini_batch_src_global generation:  0.01848578453063965
r_  generation:  0.1531360149383545
local_output_nid generation:  0.009612321853637695
local_in_edges_tensor generation:  0.009318113327026367
mini_batch_src_global generation:  0.017000198364257812
r_  generation:  0.14178133010864258
local_output_nid generation:  0.010425329208374023
local_in_edges_tensor generation:  0.010284900665283203
mini_batch_src_global generation:  0.018110036849975586
r_  generation:  0.1585073471069336
local_output_nid generation:  0.009990215301513672
local_in_edges_tensor generation:  0.010848283767700195
mini_batch_src_global generation:  0.01848316192626953
r_  generation:  0.1480543613433838
local_output_nid generation:  0.010144472122192383
local_in_edges_tensor generation:  0.012038469314575195
mini_batch_src_global generation:  0.018545150756835938
r_  generation:  0.15197086334228516
local_output_nid generation:  0.010002851486206055
local_in_edges_tensor generation:  0.009598970413208008
mini_batch_src_global generation:  0.018108129501342773
r_  generation:  0.14682769775390625
local_output_nid generation:  0.009960174560546875
local_in_edges_tensor generation:  0.010746955871582031
mini_batch_src_global generation:  0.018009185791015625
r_  generation:  0.15296244621276855
local_output_nid generation:  0.009926557540893555
local_in_edges_tensor generation:  0.010655403137207031
mini_batch_src_global generation:  0.01857161521911621
r_  generation:  0.14893388748168945
local_output_nid generation:  0.010097980499267578
local_in_edges_tensor generation:  0.013290882110595703
mini_batch_src_global generation:  0.01895618438720703
r_  generation:  0.15263128280639648
local_output_nid generation:  0.010209321975708008
local_in_edges_tensor generation:  0.01101994514465332
mini_batch_src_global generation:  0.019220590591430664
r_  generation:  0.1583240032196045
local_output_nid generation:  0.010290145874023438
local_in_edges_tensor generation:  0.012209653854370117
mini_batch_src_global generation:  0.018824338912963867
r_  generation:  0.1555178165435791
local_output_nid generation:  0.010092973709106445
local_in_edges_tensor generation:  0.01074671745300293
mini_batch_src_global generation:  0.01904606819152832
r_  generation:  0.1576855182647705
local_output_nid generation:  0.009826421737670898
local_in_edges_tensor generation:  0.009202718734741211
mini_batch_src_global generation:  0.017641782760620117
r_  generation:  0.14472675323486328
local_output_nid generation:  0.010271310806274414
local_in_edges_tensor generation:  0.009922981262207031
mini_batch_src_global generation:  0.01952505111694336
r_  generation:  0.1537461280822754
local_output_nid generation:  0.010314464569091797
local_in_edges_tensor generation:  0.013544082641601562
mini_batch_src_global generation:  0.01873779296875
r_  generation:  0.15745759010314941
local_output_nid generation:  0.010088205337524414
local_in_edges_tensor generation:  0.009454727172851562
mini_batch_src_global generation:  0.018235206604003906
r_  generation:  0.1485276222229004
local_output_nid generation:  0.009734869003295898
local_in_edges_tensor generation:  0.009253501892089844
mini_batch_src_global generation:  0.017477989196777344
r_  generation:  0.14690208435058594
local_output_nid generation:  0.009963750839233398
local_in_edges_tensor generation:  0.012529611587524414
mini_batch_src_global generation:  0.018185138702392578
r_  generation:  0.15096664428710938
----------------------check_connections_block total spend ----------------------------- 7.16108775138855
generate_one_block  0.19800853729248047
generate_one_block  0.19701194763183594
generate_one_block  0.20450091361999512
generate_one_block  0.18343758583068848
generate_one_block  0.18482708930969238
generate_one_block  0.19143271446228027
generate_one_block  0.18895816802978516
generate_one_block  0.19316530227661133
generate_one_block  0.1897120475769043
generate_one_block  0.18681120872497559
generate_one_block  0.19397997856140137
generate_one_block  0.19085311889648438
generate_one_block  0.1894545555114746
generate_one_block  0.18904662132263184
generate_one_block  0.18993806838989258
generate_one_block  0.20094704627990723
generate_one_block  0.19199395179748535
generate_one_block  0.1898491382598877
generate_one_block  0.1907672882080078
generate_one_block  0.18619203567504883
generate_one_block  0.19021129608154297
generate_one_block  0.18835949897766113
generate_one_block  0.19246339797973633
generate_one_block  0.19640278816223145
generate_one_block  0.19487643241882324
generate_one_block  0.19241070747375488
generate_one_block  0.1791689395904541
generate_one_block  0.19381451606750488
generate_one_block  0.19554948806762695
generate_one_block  0.18735337257385254
generate_one_block  0.1824970245361328
generate_one_block  0.18955206871032715
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03648090362548828
gen group dst list time:  0.09611964225769043
time for parepare:  0.018970727920532227
local_output_nid generation:  0.021977901458740234
local_in_edges_tensor generation:  0.03995513916015625
mini_batch_src_global generation:  0.038048744201660156
r_  generation:  0.3908729553222656
local_output_nid generation:  0.0285799503326416
local_in_edges_tensor generation:  0.04408979415893555
mini_batch_src_global generation:  0.05012059211730957
r_  generation:  0.40317392349243164
local_output_nid generation:  0.02834177017211914
local_in_edges_tensor generation:  0.033091068267822266
mini_batch_src_global generation:  0.04626321792602539
r_  generation:  0.4017467498779297
local_output_nid generation:  0.027121305465698242
local_in_edges_tensor generation:  0.03285408020019531
mini_batch_src_global generation:  0.047692060470581055
r_  generation:  0.4022698402404785
local_output_nid generation:  0.026500463485717773
local_in_edges_tensor generation:  0.033090829849243164
mini_batch_src_global generation:  0.04675865173339844
r_  generation:  0.4054751396179199
local_output_nid generation:  0.02706289291381836
local_in_edges_tensor generation:  0.03737378120422363
mini_batch_src_global generation:  0.047590017318725586
r_  generation:  0.40480589866638184
local_output_nid generation:  0.027067899703979492
local_in_edges_tensor generation:  0.03055548667907715
mini_batch_src_global generation:  0.047354698181152344
r_  generation:  0.4101753234863281
local_output_nid generation:  0.027319908142089844
local_in_edges_tensor generation:  0.03656435012817383
mini_batch_src_global generation:  0.047902822494506836
r_  generation:  0.41025733947753906
local_output_nid generation:  0.027188777923583984
local_in_edges_tensor generation:  0.030650854110717773
mini_batch_src_global generation:  0.047882080078125
r_  generation:  0.41138434410095215
local_output_nid generation:  0.02701711654663086
local_in_edges_tensor generation:  0.0331263542175293
mini_batch_src_global generation:  0.04794740676879883
r_  generation:  0.40792155265808105
local_output_nid generation:  0.026992082595825195
local_in_edges_tensor generation:  0.03740072250366211
mini_batch_src_global generation:  0.04740715026855469
r_  generation:  0.41596436500549316
local_output_nid generation:  0.026784658432006836
local_in_edges_tensor generation:  0.03311944007873535
mini_batch_src_global generation:  0.04920649528503418
r_  generation:  0.4079711437225342
local_output_nid generation:  0.026711702346801758
local_in_edges_tensor generation:  0.0330042839050293
mini_batch_src_global generation:  0.04781293869018555
r_  generation:  0.4129679203033447
local_output_nid generation:  0.026929855346679688
local_in_edges_tensor generation:  0.02947235107421875
mini_batch_src_global generation:  0.04877448081970215
r_  generation:  0.4105222225189209
local_output_nid generation:  0.02681708335876465
local_in_edges_tensor generation:  0.03296923637390137
mini_batch_src_global generation:  0.048480987548828125
r_  generation:  0.4137401580810547
local_output_nid generation:  0.026622772216796875
local_in_edges_tensor generation:  0.033155202865600586
mini_batch_src_global generation:  0.04854130744934082
r_  generation:  0.4001579284667969
local_output_nid generation:  0.026991844177246094
local_in_edges_tensor generation:  0.033247947692871094
mini_batch_src_global generation:  0.05078935623168945
r_  generation:  0.41925907135009766
local_output_nid generation:  0.02763223648071289
local_in_edges_tensor generation:  0.047605037689208984
mini_batch_src_global generation:  0.056677818298339844
r_  generation:  0.41101670265197754
local_output_nid generation:  0.026738643646240234
local_in_edges_tensor generation:  0.029007434844970703
mini_batch_src_global generation:  0.0511932373046875
r_  generation:  0.4153144359588623
local_output_nid generation:  0.026981830596923828
local_in_edges_tensor generation:  0.03546309471130371
mini_batch_src_global generation:  0.049141883850097656
r_  generation:  0.40893983840942383
local_output_nid generation:  0.026812076568603516
local_in_edges_tensor generation:  0.03169536590576172
mini_batch_src_global generation:  0.04800844192504883
r_  generation:  0.41304564476013184
local_output_nid generation:  0.026866674423217773
local_in_edges_tensor generation:  0.02869439125061035
mini_batch_src_global generation:  0.05141139030456543
r_  generation:  0.4071478843688965
local_output_nid generation:  0.027177810668945312
local_in_edges_tensor generation:  0.03313469886779785
mini_batch_src_global generation:  0.048299551010131836
r_  generation:  0.4135434627532959
local_output_nid generation:  0.027113914489746094
local_in_edges_tensor generation:  0.03222846984863281
mini_batch_src_global generation:  0.04957914352416992
r_  generation:  0.4135298728942871
local_output_nid generation:  0.027126073837280273
local_in_edges_tensor generation:  0.026028871536254883
mini_batch_src_global generation:  0.04895496368408203
r_  generation:  0.4144594669342041
local_output_nid generation:  0.027043819427490234
local_in_edges_tensor generation:  0.025350570678710938
mini_batch_src_global generation:  0.04956173896789551
r_  generation:  0.4104931354522705
local_output_nid generation:  0.02672100067138672
local_in_edges_tensor generation:  0.025470972061157227
mini_batch_src_global generation:  0.04768776893615723
r_  generation:  0.4140019416809082
local_output_nid generation:  0.026833295822143555
local_in_edges_tensor generation:  0.034332275390625
mini_batch_src_global generation:  0.050485849380493164
r_  generation:  0.41057586669921875
local_output_nid generation:  0.02763223648071289
local_in_edges_tensor generation:  0.03683876991271973
mini_batch_src_global generation:  0.048352956771850586
r_  generation:  0.42415285110473633
local_output_nid generation:  0.02764606475830078
local_in_edges_tensor generation:  0.02668309211730957
mini_batch_src_global generation:  0.04884648323059082
r_  generation:  0.42382121086120605
local_output_nid generation:  0.028334379196166992
local_in_edges_tensor generation:  0.025467395782470703
mini_batch_src_global generation:  0.04911398887634277
r_  generation:  0.4179105758666992
local_output_nid generation:  0.02823948860168457
local_in_edges_tensor generation:  0.032404184341430664
mini_batch_src_global generation:  0.049269676208496094
r_  generation:  0.4100515842437744
----------------------check_connections_block total spend ----------------------------- 19.490123748779297
generate_one_block  0.6318728923797607
generate_one_block  0.5421688556671143
generate_one_block  0.5160768032073975
generate_one_block  0.5250895023345947
generate_one_block  0.5300350189208984
generate_one_block  0.532585859298706
generate_one_block  0.5282959938049316
generate_one_block  0.552588939666748
generate_one_block  0.5334000587463379
generate_one_block  0.5308921337127686
generate_one_block  0.5388193130493164
generate_one_block  0.5390622615814209
generate_one_block  0.5309345722198486
generate_one_block  0.530259370803833
generate_one_block  0.5385861396789551
generate_one_block  0.5150678157806396
generate_one_block  0.5332908630371094
generate_one_block  0.5285360813140869
generate_one_block  0.5680525302886963
generate_one_block  0.5564703941345215
generate_one_block  0.553020715713501
generate_one_block  0.5637118816375732
generate_one_block  0.5477888584136963
generate_one_block  0.5881755352020264
generate_one_block  0.5395386219024658
generate_one_block  0.5417532920837402
generate_one_block  0.540302038192749
generate_one_block  0.5354218482971191
generate_one_block  0.5617296695709229
generate_one_block  0.5316281318664551
generate_one_block  0.5197765827178955
generate_one_block  0.530179500579834
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  26.651211500167847
block generation total time  23.468658924102783
average batch blocks generation time:  0.733395591378212
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08881139755249023  GigaBytes
Max Memory Allocated: 0.08881139755249023  GigaBytes

torch.Size([146242, 128])
torch.Size([102747, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8494873046875 GB
    Memory Allocated: 17.18912172317505  GigaBytes
Max Memory Allocated: 17.22861337661743  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7303466796875 GB
    Memory Allocated: 0.0944528579711914  GigaBytes
Max Memory Allocated: 17.22861337661743  GigaBytes

torch.Size([146528, 128])
torch.Size([103257, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6951904296875 GB
    Memory Allocated: 17.33587884902954  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1385498046875 GB
    Memory Allocated: 0.09469413757324219  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146090, 128])
torch.Size([100972, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3221435546875 GB
    Memory Allocated: 16.410951137542725  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.09425973892211914  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146468, 128])
torch.Size([102041, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 16.59382438659668  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.09475040435791016  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145971, 128])
torch.Size([101745, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 16.686663150787354  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.09414529800415039  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146042, 128])
torch.Size([102460, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 17.126354217529297  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.09479427337646484  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145845, 128])
torch.Size([102265, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 16.868374824523926  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3240966796875 GB
    Memory Allocated: 0.09447097778320312  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146699, 128])
torch.Size([103498, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.21308994293213  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09480762481689453  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146197, 128])
torch.Size([102632, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.057065963745117  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0940852165222168  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146018, 128])
torch.Size([101788, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.748666763305664  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09485149383544922  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146303, 128])
torch.Size([102470, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.16579294204712  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0941014289855957  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145978, 128])
torch.Size([102156, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.013607025146484  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09368419647216797  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145199, 128])
torch.Size([101100, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.79749059677124  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09439229965209961  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146611, 128])
torch.Size([102339, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.889531135559082  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0948023796081543  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146303, 128])
torch.Size([102434, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.98188543319702  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0941152572631836  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146301, 128])
torch.Size([100429, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.206178188323975  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09482431411743164  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146101, 128])
torch.Size([102537, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.084818840026855  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09415054321289062  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146113, 128])
torch.Size([101600, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.89599323272705  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09480619430541992  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146515, 128])
torch.Size([102254, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.024123668670654  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09441041946411133  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146723, 128])
torch.Size([102842, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.79964828491211  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09479665756225586  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146065, 128])
torch.Size([102130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.931899547576904  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09426164627075195  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146366, 128])
torch.Size([102361, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.870296955108643  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09482574462890625  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146634, 128])
torch.Size([102877, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.109375476837158  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09441280364990234  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146574, 128])
torch.Size([103097, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.134315490722656  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09484624862670898  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146434, 128])
torch.Size([102772, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.158286094665527  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0941324234008789  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146009, 128])
torch.Size([102265, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.093257427215576  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09469175338745117  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146249, 128])
torch.Size([101502, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.431213855743408  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0942068099975586  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146140, 128])
torch.Size([102558, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.091245651245117  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09485006332397461  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146570, 128])
torch.Size([103573, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.274938106536865  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.0943760871887207  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146633, 128])
torch.Size([101880, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.87910032272339  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09471273422241211  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145762, 128])
torch.Size([101647, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.543439388275146  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.09415102005004883  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146097, 128])
torch.Size([101894, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.96422529220581  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0358755961060524 |0.029527418315410614 |0.437873438000679 |0.00010356307029724121 |0.7735269516706467 |0.010373115539550781 |
----------------------------------------------------------pseudo_mini_loss sum 5.387216091156006
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8791700
Number of first layer input nodes during this epoch:  4679780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.12240886688232422  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027822256088256836
random selection method range initialization spend 0.0055620670318603516
time for parepare:  0.018793106079101562
local_output_nid generation:  0.0013561248779296875
local_in_edges_tensor generation:  0.0074536800384521484
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.010404348373413086
local_output_nid generation:  0.0015971660614013672
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.0015416145324707031
r_  generation:  0.009911537170410156
local_output_nid generation:  0.0016078948974609375
local_in_edges_tensor generation:  0.0009706020355224609
mini_batch_src_global generation:  0.0011584758758544922
r_  generation:  0.009929418563842773
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.00990748405456543
local_output_nid generation:  0.0015790462493896484
local_in_edges_tensor generation:  0.0009036064147949219
mini_batch_src_global generation:  0.0010776519775390625
r_  generation:  0.010026693344116211
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0009102821350097656
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.010053634643554688
local_output_nid generation:  0.00157928466796875
local_in_edges_tensor generation:  0.0008947849273681641
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.009828805923461914
local_output_nid generation:  0.0016326904296875
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.0011298656463623047
r_  generation:  0.009790420532226562
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0008847713470458984
mini_batch_src_global generation:  0.0010552406311035156
r_  generation:  0.009742975234985352
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0010976791381835938
r_  generation:  0.010266780853271484
local_output_nid generation:  0.0015816688537597656
local_in_edges_tensor generation:  0.0008852481842041016
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010454893112182617
local_output_nid generation:  0.0015811920166015625
local_in_edges_tensor generation:  0.0008907318115234375
mini_batch_src_global generation:  0.0011119842529296875
r_  generation:  0.010244369506835938
local_output_nid generation:  0.0015666484832763672
local_in_edges_tensor generation:  0.0008740425109863281
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.009466886520385742
local_output_nid generation:  0.0015649795532226562
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.009648561477661133
local_output_nid generation:  0.0015687942504882812
local_in_edges_tensor generation:  0.0008795261383056641
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010544061660766602
local_output_nid generation:  0.0015921592712402344
local_in_edges_tensor generation:  0.0008428096771240234
mini_batch_src_global generation:  0.0011222362518310547
r_  generation:  0.009754657745361328
local_output_nid generation:  0.0015730857849121094
local_in_edges_tensor generation:  0.0008614063262939453
mini_batch_src_global generation:  0.001043081283569336
r_  generation:  0.009934663772583008
local_output_nid generation:  0.001590728759765625
local_in_edges_tensor generation:  0.0008671283721923828
mini_batch_src_global generation:  0.0011589527130126953
r_  generation:  0.0102996826171875
local_output_nid generation:  0.0015883445739746094
local_in_edges_tensor generation:  0.0008833408355712891
mini_batch_src_global generation:  0.0011522769927978516
r_  generation:  0.010513544082641602
local_output_nid generation:  0.0015954971313476562
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0011606216430664062
r_  generation:  0.010343313217163086
local_output_nid generation:  0.0015749931335449219
local_in_edges_tensor generation:  0.000865936279296875
mini_batch_src_global generation:  0.0011365413665771484
r_  generation:  0.010225772857666016
local_output_nid generation:  0.0015788078308105469
local_in_edges_tensor generation:  0.0008721351623535156
mini_batch_src_global generation:  0.001216888427734375
r_  generation:  0.010655403137207031
local_output_nid generation:  0.0015799999237060547
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.001165628433227539
r_  generation:  0.010536670684814453
local_output_nid generation:  0.0015745162963867188
local_in_edges_tensor generation:  0.0008640289306640625
mini_batch_src_global generation:  0.0010983943939208984
r_  generation:  0.010123729705810547
local_output_nid generation:  0.0015704631805419922
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.010065555572509766
local_output_nid generation:  0.0015671253204345703
local_in_edges_tensor generation:  0.0008668899536132812
mini_batch_src_global generation:  0.001134634017944336
r_  generation:  0.010209321975708008
local_output_nid generation:  0.0015516281127929688
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.010479450225830078
local_output_nid generation:  0.0015764236450195312
local_in_edges_tensor generation:  0.0008738040924072266
mini_batch_src_global generation:  0.0010979175567626953
r_  generation:  0.010174036026000977
local_output_nid generation:  0.0015721321105957031
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.010223865509033203
local_output_nid generation:  0.0016150474548339844
local_in_edges_tensor generation:  0.0008518695831298828
mini_batch_src_global generation:  0.0011053085327148438
r_  generation:  0.010365486145019531
local_output_nid generation:  0.0015900135040283203
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.01041269302368164
local_output_nid generation:  0.0015993118286132812
local_in_edges_tensor generation:  0.0008375644683837891
mini_batch_src_global generation:  0.0011534690856933594
r_  generation:  0.010407447814941406
----------------------check_connections_block total spend ----------------------------- 0.5592796802520752
generate_one_block  0.023555278778076172
generate_one_block  0.020439624786376953
generate_one_block  0.01896524429321289
generate_one_block  0.017886877059936523
generate_one_block  0.01821422576904297
generate_one_block  0.017714262008666992
generate_one_block  0.017360448837280273
generate_one_block  0.0171051025390625
generate_one_block  0.01722884178161621
generate_one_block  0.0178983211517334
generate_one_block  0.017992019653320312
generate_one_block  0.017793893814086914
generate_one_block  0.016353130340576172
generate_one_block  0.016706466674804688
generate_one_block  0.018250703811645508
generate_one_block  0.01667952537536621
generate_one_block  0.017154455184936523
generate_one_block  0.017585277557373047
generate_one_block  0.018177032470703125
generate_one_block  0.01744866371154785
generate_one_block  0.017573118209838867
generate_one_block  0.018139123916625977
generate_one_block  0.01795029640197754
generate_one_block  0.017306089401245117
generate_one_block  0.01723647117614746
generate_one_block  0.01745152473449707
generate_one_block  0.017725706100463867
generate_one_block  0.017277240753173828
generate_one_block  0.017447233200073242
generate_one_block  0.017561912536621094
generate_one_block  0.01759171485900879
generate_one_block  0.017405986785888672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03835892677307129
gen group dst list time:  0.02217555046081543
time for parepare:  0.019454479217529297
local_output_nid generation:  0.0061032772064208984
local_in_edges_tensor generation:  0.016640901565551758
mini_batch_src_global generation:  0.013486862182617188
r_  generation:  0.13280415534973145
local_output_nid generation:  0.009771585464477539
local_in_edges_tensor generation:  0.00994729995727539
mini_batch_src_global generation:  0.01654052734375
r_  generation:  0.13840818405151367
local_output_nid generation:  0.010394096374511719
local_in_edges_tensor generation:  0.028466224670410156
mini_batch_src_global generation:  0.017079591751098633
r_  generation:  0.15011835098266602
local_output_nid generation:  0.010197877883911133
local_in_edges_tensor generation:  0.00935983657836914
mini_batch_src_global generation:  0.016824722290039062
r_  generation:  0.14401030540466309
local_output_nid generation:  0.010415792465209961
local_in_edges_tensor generation:  0.010783195495605469
mini_batch_src_global generation:  0.019441604614257812
r_  generation:  0.15381193161010742
local_output_nid generation:  0.009615421295166016
local_in_edges_tensor generation:  0.01037740707397461
mini_batch_src_global generation:  0.01783585548400879
r_  generation:  0.1496109962463379
local_output_nid generation:  0.009661436080932617
local_in_edges_tensor generation:  0.009233474731445312
mini_batch_src_global generation:  0.018085956573486328
r_  generation:  0.14936423301696777
local_output_nid generation:  0.00959634780883789
local_in_edges_tensor generation:  0.010061979293823242
mini_batch_src_global generation:  0.01787853240966797
r_  generation:  0.14586806297302246
local_output_nid generation:  0.009901285171508789
local_in_edges_tensor generation:  0.010539531707763672
mini_batch_src_global generation:  0.018875598907470703
r_  generation:  0.14919042587280273
local_output_nid generation:  0.010356664657592773
local_in_edges_tensor generation:  0.009465456008911133
mini_batch_src_global generation:  0.0186004638671875
r_  generation:  0.15347862243652344
local_output_nid generation:  0.01062464714050293
local_in_edges_tensor generation:  0.011431217193603516
mini_batch_src_global generation:  0.019978046417236328
r_  generation:  0.1565241813659668
local_output_nid generation:  0.010512590408325195
local_in_edges_tensor generation:  0.009367942810058594
mini_batch_src_global generation:  0.018823862075805664
r_  generation:  0.15164709091186523
local_output_nid generation:  0.009732723236083984
local_in_edges_tensor generation:  0.010162591934204102
mini_batch_src_global generation:  0.016967296600341797
r_  generation:  0.13950276374816895
local_output_nid generation:  0.009776830673217773
local_in_edges_tensor generation:  0.009834527969360352
mini_batch_src_global generation:  0.01734638214111328
r_  generation:  0.14281487464904785
local_output_nid generation:  0.01057577133178711
local_in_edges_tensor generation:  0.013440370559692383
mini_batch_src_global generation:  0.01950836181640625
r_  generation:  0.16102075576782227
local_output_nid generation:  0.010164737701416016
local_in_edges_tensor generation:  0.008983373641967773
mini_batch_src_global generation:  0.01810741424560547
r_  generation:  0.14492368698120117
local_output_nid generation:  0.010044336318969727
local_in_edges_tensor generation:  0.009880542755126953
mini_batch_src_global generation:  0.019313812255859375
r_  generation:  0.15047097206115723
local_output_nid generation:  0.010514497756958008
local_in_edges_tensor generation:  0.009361743927001953
mini_batch_src_global generation:  0.018476247787475586
r_  generation:  0.15374040603637695
local_output_nid generation:  0.010693550109863281
local_in_edges_tensor generation:  0.011598825454711914
mini_batch_src_global generation:  0.019303321838378906
r_  generation:  0.15981221199035645
local_output_nid generation:  0.009923219680786133
local_in_edges_tensor generation:  0.010589838027954102
mini_batch_src_global generation:  0.018924951553344727
r_  generation:  0.15198135375976562
local_output_nid generation:  0.010011672973632812
local_in_edges_tensor generation:  0.010534524917602539
mini_batch_src_global generation:  0.019002676010131836
r_  generation:  0.15566062927246094
local_output_nid generation:  0.01007699966430664
local_in_edges_tensor generation:  0.010811090469360352
mini_batch_src_global generation:  0.021430492401123047
r_  generation:  0.1564490795135498
local_output_nid generation:  0.010200977325439453
local_in_edges_tensor generation:  0.010739803314208984
mini_batch_src_global generation:  0.01920175552368164
r_  generation:  0.15700602531433105
local_output_nid generation:  0.009844303131103516
local_in_edges_tensor generation:  0.009145498275756836
mini_batch_src_global generation:  0.018451690673828125
r_  generation:  0.15080881118774414
local_output_nid generation:  0.009807348251342773
local_in_edges_tensor generation:  0.01041555404663086
mini_batch_src_global generation:  0.01849985122680664
r_  generation:  0.1524219512939453
local_output_nid generation:  0.009893417358398438
local_in_edges_tensor generation:  0.012816667556762695
mini_batch_src_global generation:  0.01900649070739746
r_  generation:  0.15386104583740234
local_output_nid generation:  0.009961605072021484
local_in_edges_tensor generation:  0.01061391830444336
mini_batch_src_global generation:  0.018888235092163086
r_  generation:  0.1562483310699463
local_output_nid generation:  0.009763956069946289
local_in_edges_tensor generation:  0.01141810417175293
mini_batch_src_global generation:  0.019075632095336914
r_  generation:  0.15314030647277832
local_output_nid generation:  0.009844541549682617
local_in_edges_tensor generation:  0.010449886322021484
mini_batch_src_global generation:  0.0200350284576416
r_  generation:  0.15537118911743164
local_output_nid generation:  0.009891271591186523
local_in_edges_tensor generation:  0.009244680404663086
mini_batch_src_global generation:  0.019881725311279297
r_  generation:  0.1567544937133789
local_output_nid generation:  0.009999752044677734
local_in_edges_tensor generation:  0.012109518051147461
mini_batch_src_global generation:  0.01903080940246582
r_  generation:  0.1598365306854248
local_output_nid generation:  0.009807825088500977
local_in_edges_tensor generation:  0.009465932846069336
mini_batch_src_global generation:  0.018650293350219727
r_  generation:  0.15233206748962402
----------------------check_connections_block total spend ----------------------------- 7.225103855133057
generate_one_block  0.20210647583007812
generate_one_block  0.19484901428222656
generate_one_block  0.20286297798156738
generate_one_block  0.19955158233642578
generate_one_block  0.2338709831237793
generate_one_block  0.1986863613128662
generate_one_block  0.19654583930969238
generate_one_block  0.1918468475341797
generate_one_block  0.19480562210083008
generate_one_block  0.20540165901184082
generate_one_block  0.20854687690734863
generate_one_block  0.19815731048583984
generate_one_block  0.1799466609954834
generate_one_block  0.18511223793029785
generate_one_block  0.21003222465515137
generate_one_block  0.1861114501953125
generate_one_block  0.19925594329833984
generate_one_block  0.20283269882202148
generate_one_block  0.2118821144104004
generate_one_block  0.19977021217346191
generate_one_block  0.2044360637664795
generate_one_block  0.20658373832702637
generate_one_block  0.20772814750671387
generate_one_block  0.19344830513000488
generate_one_block  0.1980898380279541
generate_one_block  0.20322561264038086
generate_one_block  0.2046806812286377
generate_one_block  0.2001185417175293
generate_one_block  0.203399658203125
generate_one_block  0.20560002326965332
generate_one_block  0.20793771743774414
generate_one_block  0.19378876686096191
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03638601303100586
gen group dst list time:  0.0952444076538086
time for parepare:  0.018129348754882812
local_output_nid generation:  0.023502349853515625
local_in_edges_tensor generation:  0.03528451919555664
mini_batch_src_global generation:  0.036306142807006836
r_  generation:  0.39633941650390625
local_output_nid generation:  0.029100418090820312
local_in_edges_tensor generation:  0.04105019569396973
mini_batch_src_global generation:  0.046472787857055664
r_  generation:  0.3951847553253174
local_output_nid generation:  0.028855323791503906
local_in_edges_tensor generation:  0.0379481315612793
mini_batch_src_global generation:  0.047506093978881836
r_  generation:  0.4069671630859375
local_output_nid generation:  0.02770376205444336
local_in_edges_tensor generation:  0.030472278594970703
mini_batch_src_global generation:  0.047981977462768555
r_  generation:  0.40863513946533203
local_output_nid generation:  0.02779078483581543
local_in_edges_tensor generation:  0.030877351760864258
mini_batch_src_global generation:  0.05077409744262695
r_  generation:  0.40897583961486816
local_output_nid generation:  0.027627229690551758
local_in_edges_tensor generation:  0.027378559112548828
mini_batch_src_global generation:  0.04857039451599121
r_  generation:  0.40703511238098145
local_output_nid generation:  0.02749347686767578
local_in_edges_tensor generation:  0.028501510620117188
mini_batch_src_global generation:  0.04821896553039551
r_  generation:  0.40793418884277344
local_output_nid generation:  0.027200937271118164
local_in_edges_tensor generation:  0.0265352725982666
mini_batch_src_global generation:  0.04844498634338379
r_  generation:  0.4021904468536377
local_output_nid generation:  0.027588844299316406
local_in_edges_tensor generation:  0.030267715454101562
mini_batch_src_global generation:  0.05090022087097168
r_  generation:  0.40862512588500977
local_output_nid generation:  0.027636051177978516
local_in_edges_tensor generation:  0.034149169921875
mini_batch_src_global generation:  0.048330068588256836
r_  generation:  0.409893274307251
local_output_nid generation:  0.02801346778869629
local_in_edges_tensor generation:  0.034662485122680664
mini_batch_src_global generation:  0.04808354377746582
r_  generation:  0.41472935676574707
local_output_nid generation:  0.02773761749267578
local_in_edges_tensor generation:  0.03074812889099121
mini_batch_src_global generation:  0.04887080192565918
r_  generation:  0.4133286476135254
local_output_nid generation:  0.02693486213684082
local_in_edges_tensor generation:  0.026460886001586914
mini_batch_src_global generation:  0.04734659194946289
r_  generation:  0.40052366256713867
local_output_nid generation:  0.0272367000579834
local_in_edges_tensor generation:  0.026890039443969727
mini_batch_src_global generation:  0.05030226707458496
r_  generation:  0.40219736099243164
local_output_nid generation:  0.027884244918823242
local_in_edges_tensor generation:  0.033896446228027344
mini_batch_src_global generation:  0.047917842864990234
r_  generation:  0.4143190383911133
local_output_nid generation:  0.02735757827758789
local_in_edges_tensor generation:  0.026942729949951172
mini_batch_src_global generation:  0.048767805099487305
r_  generation:  0.40389561653137207
local_output_nid generation:  0.02764296531677246
local_in_edges_tensor generation:  0.02999258041381836
mini_batch_src_global generation:  0.047625064849853516
r_  generation:  0.4095139503479004
local_output_nid generation:  0.028049945831298828
local_in_edges_tensor generation:  0.03530597686767578
mini_batch_src_global generation:  0.05116915702819824
r_  generation:  0.4115135669708252
local_output_nid generation:  0.027808666229248047
local_in_edges_tensor generation:  0.031577110290527344
mini_batch_src_global generation:  0.051413536071777344
r_  generation:  0.4163246154785156
local_output_nid generation:  0.027681589126586914
local_in_edges_tensor generation:  0.026811599731445312
mini_batch_src_global generation:  0.049166202545166016
r_  generation:  0.4065070152282715
local_output_nid generation:  0.02773118019104004
local_in_edges_tensor generation:  0.027070999145507812
mini_batch_src_global generation:  0.049140214920043945
r_  generation:  0.4114565849304199
local_output_nid generation:  0.027775049209594727
local_in_edges_tensor generation:  0.03498530387878418
mini_batch_src_global generation:  0.04901123046875
r_  generation:  0.4131016731262207
local_output_nid generation:  0.028273344039916992
local_in_edges_tensor generation:  0.03524184226989746
mini_batch_src_global generation:  0.04863262176513672
r_  generation:  0.41693782806396484
local_output_nid generation:  0.027811288833618164
local_in_edges_tensor generation:  0.027438640594482422
mini_batch_src_global generation:  0.048316240310668945
r_  generation:  0.4076707363128662
local_output_nid generation:  0.02766132354736328
local_in_edges_tensor generation:  0.027135610580444336
mini_batch_src_global generation:  0.04765582084655762
r_  generation:  0.41262197494506836
local_output_nid generation:  0.02774977684020996
local_in_edges_tensor generation:  0.030093669891357422
mini_batch_src_global generation:  0.05378389358520508
r_  generation:  0.41327595710754395
local_output_nid generation:  0.027657270431518555
local_in_edges_tensor generation:  0.030568361282348633
mini_batch_src_global generation:  0.05291891098022461
r_  generation:  0.41609787940979004
local_output_nid generation:  0.027404069900512695
local_in_edges_tensor generation:  0.033905029296875
mini_batch_src_global generation:  0.05160808563232422
r_  generation:  0.40906858444213867
local_output_nid generation:  0.027873992919921875
local_in_edges_tensor generation:  0.03630328178405762
mini_batch_src_global generation:  0.05461239814758301
r_  generation:  0.421602725982666
local_output_nid generation:  0.028667211532592773
local_in_edges_tensor generation:  0.030994176864624023
mini_batch_src_global generation:  0.04837822914123535
r_  generation:  0.4110066890716553
local_output_nid generation:  0.027884960174560547
local_in_edges_tensor generation:  0.03424501419067383
mini_batch_src_global generation:  0.05117297172546387
r_  generation:  0.4141042232513428
local_output_nid generation:  0.027814865112304688
local_in_edges_tensor generation:  0.02740764617919922
mini_batch_src_global generation:  0.04836463928222656
r_  generation:  0.4077894687652588
----------------------check_connections_block total spend ----------------------------- 19.399272918701172
generate_one_block  0.5747530460357666
generate_one_block  0.5471980571746826
generate_one_block  0.5526046752929688
generate_one_block  0.5504236221313477
generate_one_block  0.6615433692932129
generate_one_block  0.5490801334381104
generate_one_block  0.5496115684509277
generate_one_block  0.5425682067871094
generate_one_block  0.5564227104187012
generate_one_block  0.5523717403411865
generate_one_block  0.5650477409362793
generate_one_block  0.560643196105957
generate_one_block  0.5288379192352295
generate_one_block  0.5439591407775879
generate_one_block  0.5669565200805664
generate_one_block  0.5404882431030273
generate_one_block  0.5545864105224609
generate_one_block  0.557112455368042
generate_one_block  0.5647006034851074
generate_one_block  0.552847146987915
generate_one_block  0.5423519611358643
generate_one_block  0.5550391674041748
generate_one_block  0.568903923034668
generate_one_block  0.5415236949920654
generate_one_block  0.5551266670227051
generate_one_block  0.5507156848907471
generate_one_block  0.5489153861999512
generate_one_block  0.5554020404815674
generate_one_block  0.6292154788970947
generate_one_block  0.562169075012207
generate_one_block  0.5837383270263672
generate_one_block  0.5843262672424316
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.12240886688232422  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

connection checking time:  26.62437677383423
block generation total time  24.380396366119385
average batch blocks generation time:  0.7618873864412308
block dataloader generation time/epoch 54.069457054138184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10521507263183594  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146174, 128])
torch.Size([102024, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.76754379272461  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10445690155029297  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145924, 128])
torch.Size([101423, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.58890724182129  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10531044006347656  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145877, 128])
torch.Size([102346, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.220131874084473  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10457563400268555  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146075, 128])
torch.Size([102470, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.840499877929688  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10531377792358398  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146698, 128])
torch.Size([102984, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.193827152252197  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10460805892944336  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146132, 128])
torch.Size([101876, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.945557117462158  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10523414611816406  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145972, 128])
torch.Size([101839, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.890746593475342  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10431814193725586  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145613, 128])
torch.Size([101119, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.63929271697998  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10520124435424805  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146198, 128])
torch.Size([101911, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.687017917633057  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10475969314575195  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146365, 128])
torch.Size([102422, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.093456745147705  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10530471801757812  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146812, 128])
torch.Size([103799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.263679027557373  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10479450225830078  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146505, 128])
torch.Size([102905, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.94237232208252  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10506343841552734  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145893, 128])
torch.Size([99865, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 15.93433952331543  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10429525375366211  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([145727, 128])
torch.Size([100591, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.2812237739563  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10535144805908203  GigaBytes
Max Memory Allocated: 17.372669219970703  GigaBytes

torch.Size([146234, 128])
torch.Size([103041, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.352396965026855  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10445642471313477  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

torch.Size([146054, 128])
torch.Size([100307, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.278839588165283  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10521125793457031  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

torch.Size([146125, 128])
torch.Size([102225, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.780150890350342  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10495328903198242  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

torch.Size([146839, 128])
torch.Size([103309, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.91449213027954  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10534524917602539  GigaBytes
Max Memory Allocated: 17.3896484375  GigaBytes

torch.Size([146441, 128])
torch.Size([103766, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.411123275756836  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10471630096435547  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146373, 128])
torch.Size([102352, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.93036127090454  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10527706146240234  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([145876, 128])
torch.Size([102238, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.090074062347412  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10457468032836914  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([145900, 128])
torch.Size([102516, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.25201654434204  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10531330108642578  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([147001, 128])
torch.Size([104183, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.31938648223877  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10465860366821289  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146303, 128])
torch.Size([102417, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.789419174194336  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.1052393913269043  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([145622, 128])
torch.Size([101558, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.84726858139038  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10464620590209961  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146175, 128])
torch.Size([102011, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.993529319763184  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10528373718261719  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146110, 128])
torch.Size([102013, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.08765411376953  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10430097579956055  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([145487, 128])
torch.Size([101031, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.86992120742798  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10526323318481445  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146470, 128])
torch.Size([102653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.057454586029053  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10472917556762695  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146289, 128])
torch.Size([102144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.10433006286621  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10530900955200195  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146623, 128])
torch.Size([102962, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 17.24251937866211  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 0.10463523864746094  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

torch.Size([146265, 128])
torch.Size([101808, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9451904296875 GB
    Memory Allocated: 16.686310291290283  GigaBytes
Max Memory Allocated: 17.45003032684326  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031123578548431396 |0.016663864254951477 |0.413285456597805 |9.438395500183105e-05 |0.7586799040436745 |0.005649089813232422 |
----------------------------------------------------------pseudo_mini_loss sum 3.9676578044891357
Total (block generation + training)time/epoch 93.16591119766235
Training time/epoch 39.09619450569153
Training time without block to device /epoch 38.56295084953308
Training time without total dataloading part /epoch 37.511560916900635
load block tensor time/epoch 0.9959545135498047
block to device time/epoch 0.5332436561584473
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8788154
Number of first layer input nodes during this epoch:  4678152
