Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648461323.486034
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028070688247680664
random selection method range initialization spend 0.006402730941772461
time for parepare:  0.018719196319580078
local_output_nid generation:  0.00220489501953125
local_in_edges_tensor generation:  0.0049991607666015625
mini_batch_src_global generation:  0.001966714859008789
r_  generation:  0.020462751388549805
local_output_nid generation:  0.002656698226928711
local_in_edges_tensor generation:  0.0017180442810058594
mini_batch_src_global generation:  0.0023260116577148438
r_  generation:  0.019786357879638672
local_output_nid generation:  0.0027654170989990234
local_in_edges_tensor generation:  0.0016453266143798828
mini_batch_src_global generation:  0.0015971660614013672
r_  generation:  0.02003192901611328
local_output_nid generation:  0.0028612613677978516
local_in_edges_tensor generation:  0.0016014575958251953
mini_batch_src_global generation:  0.0015513896942138672
r_  generation:  0.020621299743652344
local_output_nid generation:  0.0029082298278808594
local_in_edges_tensor generation:  0.0016014575958251953
mini_batch_src_global generation:  0.001466512680053711
r_  generation:  0.02057504653930664
local_output_nid generation:  0.003022909164428711
local_in_edges_tensor generation:  0.0016584396362304688
mini_batch_src_global generation:  0.0016710758209228516
r_  generation:  0.020662546157836914
local_output_nid generation:  0.0029358863830566406
local_in_edges_tensor generation:  0.001611948013305664
mini_batch_src_global generation:  0.0016453266143798828
r_  generation:  0.021375656127929688
local_output_nid generation:  0.0029375553131103516
local_in_edges_tensor generation:  0.0015826225280761719
mini_batch_src_global generation:  0.0016150474548339844
r_  generation:  0.020719051361083984
local_output_nid generation:  0.0029273033142089844
local_in_edges_tensor generation:  0.0015730857849121094
mini_batch_src_global generation:  0.0015912055969238281
r_  generation:  0.020182132720947266
local_output_nid generation:  0.0029261112213134766
local_in_edges_tensor generation:  0.0015332698822021484
mini_batch_src_global generation:  0.0017452239990234375
r_  generation:  0.021142959594726562
local_output_nid generation:  0.0029098987579345703
local_in_edges_tensor generation:  0.0015819072723388672
mini_batch_src_global generation:  0.001630544662475586
r_  generation:  0.021111726760864258
local_output_nid generation:  0.0029048919677734375
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.0017061233520507812
r_  generation:  0.021200180053710938
local_output_nid generation:  0.002923727035522461
local_in_edges_tensor generation:  0.0015871524810791016
mini_batch_src_global generation:  0.0017409324645996094
r_  generation:  0.021348953247070312
local_output_nid generation:  0.003011465072631836
local_in_edges_tensor generation:  0.0015676021575927734
mini_batch_src_global generation:  0.001817464828491211
r_  generation:  0.02158641815185547
local_output_nid generation:  0.002902984619140625
local_in_edges_tensor generation:  0.0015463829040527344
mini_batch_src_global generation:  0.0017116069793701172
r_  generation:  0.021334409713745117
local_output_nid generation:  0.002915620803833008
local_in_edges_tensor generation:  0.0016171932220458984
mini_batch_src_global generation:  0.0017533302307128906
r_  generation:  0.021994352340698242
----------------------check_connections_block total spend ----------------------------- 0.5400869846343994
generate_one_block  0.03070211410522461
generate_one_block  0.0312955379486084
generate_one_block  0.03475785255432129
generate_one_block  0.031600236892700195
generate_one_block  0.03131675720214844
generate_one_block  0.030903100967407227
generate_one_block  0.030976533889770508
generate_one_block  0.030056476593017578
generate_one_block  0.030080080032348633
generate_one_block  0.03103494644165039
generate_one_block  0.031091928482055664
generate_one_block  0.03108358383178711
generate_one_block  0.030383825302124023
generate_one_block  0.03151512145996094
generate_one_block  0.030600547790527344
generate_one_block  0.03161954879760742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04477524757385254
gen group dst list time:  0.020384550094604492
time for parepare:  0.019549131393432617
local_output_nid generation:  0.009380102157592773
local_in_edges_tensor generation:  0.022535085678100586
mini_batch_src_global generation:  0.027071714401245117
r_  generation:  0.2545278072357178
local_output_nid generation:  0.013228654861450195
local_in_edges_tensor generation:  0.023969411849975586
mini_batch_src_global generation:  0.031145811080932617
r_  generation:  0.25621843338012695
local_output_nid generation:  0.013080358505249023
local_in_edges_tensor generation:  0.019512176513671875
mini_batch_src_global generation:  0.04904818534851074
r_  generation:  0.2682526111602783
local_output_nid generation:  0.013042211532592773
local_in_edges_tensor generation:  0.01974344253540039
mini_batch_src_global generation:  0.03324151039123535
r_  generation:  0.27531909942626953
local_output_nid generation:  0.013076066970825195
local_in_edges_tensor generation:  0.017789602279663086
mini_batch_src_global generation:  0.03336930274963379
r_  generation:  0.27024149894714355
local_output_nid generation:  0.012910842895507812
local_in_edges_tensor generation:  0.015451192855834961
mini_batch_src_global generation:  0.03364109992980957
r_  generation:  0.26553893089294434
local_output_nid generation:  0.013118982315063477
local_in_edges_tensor generation:  0.016271352767944336
mini_batch_src_global generation:  0.03339028358459473
r_  generation:  0.2717461585998535
local_output_nid generation:  0.012910127639770508
local_in_edges_tensor generation:  0.019014835357666016
mini_batch_src_global generation:  0.033113718032836914
r_  generation:  0.2656419277191162
local_output_nid generation:  0.012856721878051758
local_in_edges_tensor generation:  0.016322851181030273
mini_batch_src_global generation:  0.033187150955200195
r_  generation:  0.26070427894592285
local_output_nid generation:  0.013156890869140625
local_in_edges_tensor generation:  0.017197608947753906
mini_batch_src_global generation:  0.034114837646484375
r_  generation:  0.26949501037597656
local_output_nid generation:  0.012928485870361328
local_in_edges_tensor generation:  0.02204275131225586
mini_batch_src_global generation:  0.03433942794799805
r_  generation:  0.2713503837585449
local_output_nid generation:  0.01292872428894043
local_in_edges_tensor generation:  0.01708817481994629
mini_batch_src_global generation:  0.034462690353393555
r_  generation:  0.270615816116333
local_output_nid generation:  0.013007164001464844
local_in_edges_tensor generation:  0.014316797256469727
mini_batch_src_global generation:  0.033927202224731445
r_  generation:  0.2677114009857178
local_output_nid generation:  0.013186931610107422
local_in_edges_tensor generation:  0.022486448287963867
mini_batch_src_global generation:  0.034467458724975586
r_  generation:  0.27274227142333984
local_output_nid generation:  0.012861490249633789
local_in_edges_tensor generation:  0.01934504508972168
mini_batch_src_global generation:  0.03476214408874512
r_  generation:  0.26954197883605957
local_output_nid generation:  0.013160943984985352
local_in_edges_tensor generation:  0.01788640022277832
mini_batch_src_global generation:  0.035216569900512695
r_  generation:  0.27545714378356934
----------------------check_connections_block total spend ----------------------------- 6.272220134735107
generate_one_block  0.35968899726867676
generate_one_block  0.35266971588134766
generate_one_block  0.35523533821105957
generate_one_block  0.3637988567352295
generate_one_block  0.3777458667755127
generate_one_block  0.34621405601501465
generate_one_block  0.3479142189025879
generate_one_block  0.3447246551513672
generate_one_block  0.34507179260253906
generate_one_block  0.35892152786254883
generate_one_block  0.36284375190734863
generate_one_block  0.3547179698944092
generate_one_block  0.34507250785827637
generate_one_block  0.36379098892211914
generate_one_block  0.36157679557800293
generate_one_block  0.3660547733306885
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.051386117935180664
gen group dst list time:  0.06642794609069824
time for parepare:  0.019745588302612305
local_output_nid generation:  0.027179718017578125
local_in_edges_tensor generation:  0.06332278251647949
mini_batch_src_global generation:  0.04609179496765137
r_  generation:  0.47492504119873047
local_output_nid generation:  0.03385186195373535
local_in_edges_tensor generation:  0.05112266540527344
mini_batch_src_global generation:  0.05302262306213379
r_  generation:  0.45929646492004395
local_output_nid generation:  0.03172731399536133
local_in_edges_tensor generation:  0.03867363929748535
mini_batch_src_global generation:  0.053788185119628906
r_  generation:  0.4706244468688965
local_output_nid generation:  0.031864166259765625
local_in_edges_tensor generation:  0.0402829647064209
mini_batch_src_global generation:  0.051480770111083984
r_  generation:  0.4865434169769287
local_output_nid generation:  0.034612178802490234
local_in_edges_tensor generation:  0.034896135330200195
mini_batch_src_global generation:  0.0548555850982666
r_  generation:  0.47013235092163086
local_output_nid generation:  0.03277254104614258
local_in_edges_tensor generation:  0.031323909759521484
mini_batch_src_global generation:  0.05281972885131836
r_  generation:  0.4767918586730957
local_output_nid generation:  0.03296256065368652
local_in_edges_tensor generation:  0.0403745174407959
mini_batch_src_global generation:  0.052744388580322266
r_  generation:  0.4729652404785156
local_output_nid generation:  0.03286266326904297
local_in_edges_tensor generation:  0.035985708236694336
mini_batch_src_global generation:  0.05316591262817383
r_  generation:  0.4708998203277588
local_output_nid generation:  0.0330195426940918
local_in_edges_tensor generation:  0.03204822540283203
mini_batch_src_global generation:  0.05367136001586914
r_  generation:  0.4768974781036377
local_output_nid generation:  0.033330678939819336
local_in_edges_tensor generation:  0.04379081726074219
mini_batch_src_global generation:  0.05591273307800293
r_  generation:  0.4721806049346924
local_output_nid generation:  0.03296494483947754
local_in_edges_tensor generation:  0.039426326751708984
mini_batch_src_global generation:  0.05294227600097656
r_  generation:  0.4778761863708496
local_output_nid generation:  0.03311324119567871
local_in_edges_tensor generation:  0.03211784362792969
mini_batch_src_global generation:  0.053902626037597656
r_  generation:  0.47663021087646484
local_output_nid generation:  0.03304553031921387
local_in_edges_tensor generation:  0.03192877769470215
mini_batch_src_global generation:  0.051992177963256836
r_  generation:  0.4704148769378662
local_output_nid generation:  0.03316926956176758
local_in_edges_tensor generation:  0.048133134841918945
mini_batch_src_global generation:  0.053121328353881836
r_  generation:  0.4746286869049072
local_output_nid generation:  0.03326082229614258
local_in_edges_tensor generation:  0.031940460205078125
mini_batch_src_global generation:  0.053061485290527344
r_  generation:  0.47577333450317383
local_output_nid generation:  0.03332400321960449
local_in_edges_tensor generation:  0.032378435134887695
mini_batch_src_global generation:  0.05336356163024902
r_  generation:  0.4681892395019531
----------------------check_connections_block total spend ----------------------------- 11.301968812942505
generate_one_block  0.6138384342193604
generate_one_block  0.6098549365997314
generate_one_block  0.5832376480102539
generate_one_block  0.6022050380706787
generate_one_block  0.5833702087402344
generate_one_block  0.60685133934021
generate_one_block  0.6427302360534668
generate_one_block  0.5825703144073486
generate_one_block  0.5863478183746338
generate_one_block  0.6039822101593018
generate_one_block  0.6021039485931396
generate_one_block  0.5855104923248291
generate_one_block  0.5875914096832275
generate_one_block  0.613396167755127
generate_one_block  0.5844063758850098
generate_one_block  0.5821306705474854
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  17.574188947677612
block generation total time  15.276169061660767
average batch blocks generation time:  0.9547605663537979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.0944223403930664  GigaBytes
Max Memory Allocated: 0.0944223403930664  GigaBytes

torch.Size([156931, 128])
torch.Size([130443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6385498046875 GB
    Memory Allocated: 18.061124801635742  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09712409973144531  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([157047, 128])
torch.Size([130192, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.96254539489746  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09778976440429688  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156860, 128])
torch.Size([129974, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 18.012147426605225  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09720420837402344  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156959, 128])
torch.Size([130099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 18.022714614868164  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09763145446777344  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156460, 128])
torch.Size([129440, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 18.024183750152588  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09714221954345703  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156892, 128])
torch.Size([129818, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.957419395446777  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09773445129394531  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156958, 128])
torch.Size([130238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.954628467559814  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09704017639160156  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156723, 128])
torch.Size([129689, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.843666076660156  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09755754470825195  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156853, 128])
torch.Size([129922, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.780282974243164  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09717941284179688  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156833, 128])
torch.Size([130173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 18.027880668640137  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09776496887207031  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156966, 128])
torch.Size([130102, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.973963737487793  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09717273712158203  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156740, 128])
torch.Size([129686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.945032596588135  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09754705429077148  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156587, 128])
torch.Size([129448, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 17.911270141601562  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.09724044799804688  GigaBytes
Max Memory Allocated: 18.09430742263794  GigaBytes

torch.Size([156930, 128])
torch.Size([130291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 18.069472312927246  GigaBytes
Max Memory Allocated: 18.10357427597046  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3045654296875 GB
    Memory Allocated: 0.09761667251586914  GigaBytes
Max Memory Allocated: 18.10357427597046  GigaBytes

torch.Size([156683, 128])
torch.Size([129162, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3045654296875 GB
    Memory Allocated: 17.91374397277832  GigaBytes
Max Memory Allocated: 18.10357427597046  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3045654296875 GB
    Memory Allocated: 0.09728622436523438  GigaBytes
Max Memory Allocated: 18.10357427597046  GigaBytes

torch.Size([156733, 128])
torch.Size([129995, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3045654296875 GB
    Memory Allocated: 18.07061195373535  GigaBytes
Max Memory Allocated: 18.1050443649292  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03758017718791962 |0.04640680551528931 |0.6302066594362259 |0.00011554360389709473 |1.0535775125026703 |0.008996725082397461 |
----------------------------------------------------------pseudo_mini_loss sum 4.995019912719727
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5318215
Number of first layer input nodes during this epoch:  2509155
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.12874269485473633  GigaBytes
Max Memory Allocated: 18.1050443649292  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026820898056030273
random selection method range initialization spend 0.0062787532806396484
time for parepare:  0.019626379013061523
local_output_nid generation:  0.0027437210083007812
local_in_edges_tensor generation:  0.011238336563110352
mini_batch_src_global generation:  0.00413203239440918
r_  generation:  0.02283763885498047
local_output_nid generation:  0.005091428756713867
local_in_edges_tensor generation:  0.0022928714752197266
mini_batch_src_global generation:  0.0026297569274902344
r_  generation:  0.020986080169677734
local_output_nid generation:  0.004837512969970703
local_in_edges_tensor generation:  0.0022046566009521484
mini_batch_src_global generation:  0.0015752315521240234
r_  generation:  0.02081298828125
local_output_nid generation:  0.004573822021484375
local_in_edges_tensor generation:  0.0021677017211914062
mini_batch_src_global generation:  0.001669168472290039
r_  generation:  0.020768404006958008
local_output_nid generation:  0.004386186599731445
local_in_edges_tensor generation:  0.002116680145263672
mini_batch_src_global generation:  0.0017018318176269531
r_  generation:  0.021266460418701172
local_output_nid generation:  0.004629373550415039
local_in_edges_tensor generation:  0.0021009445190429688
mini_batch_src_global generation:  0.001728057861328125
r_  generation:  0.02170562744140625
local_output_nid generation:  0.004484653472900391
local_in_edges_tensor generation:  0.002031564712524414
mini_batch_src_global generation:  0.0018048286437988281
r_  generation:  0.02118229866027832
local_output_nid generation:  0.004548788070678711
local_in_edges_tensor generation:  0.0020494461059570312
mini_batch_src_global generation:  0.0017588138580322266
r_  generation:  0.02167510986328125
local_output_nid generation:  0.00442814826965332
local_in_edges_tensor generation:  0.0021390914916992188
mini_batch_src_global generation:  0.001766204833984375
r_  generation:  0.021239757537841797
local_output_nid generation:  0.004564762115478516
local_in_edges_tensor generation:  0.003148317337036133
mini_batch_src_global generation:  0.0061190128326416016
r_  generation:  0.02663135528564453
local_output_nid generation:  0.0050961971282958984
local_in_edges_tensor generation:  0.0020017623901367188
mini_batch_src_global generation:  0.0019047260284423828
r_  generation:  0.03876686096191406
local_output_nid generation:  0.004681825637817383
local_in_edges_tensor generation:  0.0020339488983154297
mini_batch_src_global generation:  0.0019135475158691406
r_  generation:  0.021465063095092773
local_output_nid generation:  0.004621982574462891
local_in_edges_tensor generation:  0.0020875930786132812
mini_batch_src_global generation:  0.0018687248229980469
r_  generation:  0.02213144302368164
local_output_nid generation:  0.004752635955810547
local_in_edges_tensor generation:  0.002176523208618164
mini_batch_src_global generation:  0.0018224716186523438
r_  generation:  0.02168416976928711
local_output_nid generation:  0.004727602005004883
local_in_edges_tensor generation:  0.002127408981323242
mini_batch_src_global generation:  0.0018579959869384766
r_  generation:  0.02194952964782715
local_output_nid generation:  0.004632234573364258
local_in_edges_tensor generation:  0.0020465850830078125
mini_batch_src_global generation:  0.0018966197967529297
r_  generation:  0.02290797233581543
----------------------check_connections_block total spend ----------------------------- 0.6431398391723633
generate_one_block  0.06735467910766602
generate_one_block  0.038340091705322266
generate_one_block  0.053078413009643555
generate_one_block  0.04091048240661621
generate_one_block  0.04301118850708008
generate_one_block  0.04381966590881348
generate_one_block  0.04134964942932129
generate_one_block  0.03963947296142578
generate_one_block  0.0384979248046875
generate_one_block  0.04112672805786133
generate_one_block  0.04030036926269531
generate_one_block  0.039002180099487305
generate_one_block  0.03918600082397461
generate_one_block  0.038933753967285156
generate_one_block  0.03934907913208008
generate_one_block  0.040555715560913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04371142387390137
gen group dst list time:  0.02117609977722168
time for parepare:  0.019917011260986328
local_output_nid generation:  0.011962413787841797
local_in_edges_tensor generation:  0.030844449996948242
mini_batch_src_global generation:  0.027910709381103516
r_  generation:  0.2522099018096924
local_output_nid generation:  0.01521754264831543
local_in_edges_tensor generation:  0.028122425079345703
mini_batch_src_global generation:  0.032979726791381836
r_  generation:  0.2669055461883545
local_output_nid generation:  0.015375137329101562
local_in_edges_tensor generation:  0.023950576782226562
mini_batch_src_global generation:  0.031650543212890625
r_  generation:  0.31279563903808594
local_output_nid generation:  0.02135944366455078
local_in_edges_tensor generation:  0.024033308029174805
mini_batch_src_global generation:  0.04711747169494629
r_  generation:  0.29247188568115234
local_output_nid generation:  0.02175593376159668
local_in_edges_tensor generation:  0.024868011474609375
mini_batch_src_global generation:  0.04095888137817383
r_  generation:  0.30398082733154297
local_output_nid generation:  0.02315235137939453
local_in_edges_tensor generation:  0.02372455596923828
mini_batch_src_global generation:  0.03983283042907715
r_  generation:  0.32088804244995117
local_output_nid generation:  0.02325153350830078
local_in_edges_tensor generation:  0.022528409957885742
mini_batch_src_global generation:  0.03946661949157715
r_  generation:  0.2711210250854492
local_output_nid generation:  0.015341520309448242
local_in_edges_tensor generation:  0.017408132553100586
mini_batch_src_global generation:  0.03529071807861328
r_  generation:  0.27278637886047363
local_output_nid generation:  0.015456914901733398
local_in_edges_tensor generation:  0.015990734100341797
mini_batch_src_global generation:  0.033822059631347656
r_  generation:  0.2661142349243164
local_output_nid generation:  0.01573491096496582
local_in_edges_tensor generation:  0.01925826072692871
mini_batch_src_global generation:  0.034848928451538086
r_  generation:  0.2788834571838379
local_output_nid generation:  0.01587200164794922
local_in_edges_tensor generation:  0.018862485885620117
mini_batch_src_global generation:  0.03520607948303223
r_  generation:  0.27617979049682617
local_output_nid generation:  0.015303850173950195
local_in_edges_tensor generation:  0.016091585159301758
mini_batch_src_global generation:  0.03451895713806152
r_  generation:  0.27391743659973145
local_output_nid generation:  0.01545095443725586
local_in_edges_tensor generation:  0.013998746871948242
mini_batch_src_global generation:  0.036160945892333984
r_  generation:  0.28841614723205566
local_output_nid generation:  0.015487194061279297
local_in_edges_tensor generation:  0.017666339874267578
mini_batch_src_global generation:  0.0385746955871582
r_  generation:  0.2780156135559082
local_output_nid generation:  0.015580177307128906
local_in_edges_tensor generation:  0.01844167709350586
mini_batch_src_global generation:  0.03550267219543457
r_  generation:  0.27839112281799316
local_output_nid generation:  0.01636028289794922
local_in_edges_tensor generation:  0.024537324905395508
mini_batch_src_global generation:  0.04512453079223633
r_  generation:  0.2792644500732422
----------------------check_connections_block total spend ----------------------------- 6.722421646118164
generate_one_block  0.40341615676879883
generate_one_block  0.3877134323120117
generate_one_block  0.39324426651000977
generate_one_block  0.38729000091552734
generate_one_block  0.39800238609313965
generate_one_block  0.36618900299072266
generate_one_block  0.40987181663513184
generate_one_block  0.37926340103149414
generate_one_block  0.38109612464904785
generate_one_block  0.39360952377319336
generate_one_block  0.38826417922973633
generate_one_block  0.36985349655151367
generate_one_block  0.3722989559173584
generate_one_block  0.3673393726348877
generate_one_block  0.3696744441986084
generate_one_block  0.4095909595489502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039969682693481445
gen group dst list time:  0.06332135200500488
time for parepare:  0.021803855895996094
local_output_nid generation:  0.03276681900024414
local_in_edges_tensor generation:  0.061357736587524414
mini_batch_src_global generation:  0.049841880798339844
r_  generation:  0.47721028327941895
local_output_nid generation:  0.03884291648864746
local_in_edges_tensor generation:  0.05483198165893555
mini_batch_src_global generation:  0.05476713180541992
r_  generation:  0.46335649490356445
local_output_nid generation:  0.03546595573425293
local_in_edges_tensor generation:  0.03589367866516113
mini_batch_src_global generation:  0.05093646049499512
r_  generation:  0.47273683547973633
local_output_nid generation:  0.03540539741516113
local_in_edges_tensor generation:  0.03349494934082031
mini_batch_src_global generation:  0.05154728889465332
r_  generation:  0.4716818332672119
local_output_nid generation:  0.035373687744140625
local_in_edges_tensor generation:  0.08756685256958008
mini_batch_src_global generation:  0.05205202102661133
r_  generation:  0.4916379451751709
local_output_nid generation:  0.03398251533508301
local_in_edges_tensor generation:  0.036634206771850586
mini_batch_src_global generation:  0.05234694480895996
r_  generation:  0.47376561164855957
local_output_nid generation:  0.03415489196777344
local_in_edges_tensor generation:  0.03371429443359375
mini_batch_src_global generation:  0.05629396438598633
r_  generation:  0.48296189308166504
local_output_nid generation:  0.034156084060668945
local_in_edges_tensor generation:  0.04235410690307617
mini_batch_src_global generation:  0.05281972885131836
r_  generation:  0.48409080505371094
local_output_nid generation:  0.03561902046203613
local_in_edges_tensor generation:  0.03628420829772949
mini_batch_src_global generation:  0.05395674705505371
r_  generation:  0.49896693229675293
local_output_nid generation:  0.03778386116027832
local_in_edges_tensor generation:  0.03862428665161133
mini_batch_src_global generation:  0.054428815841674805
r_  generation:  0.4764130115509033
local_output_nid generation:  0.035106658935546875
local_in_edges_tensor generation:  0.03824114799499512
mini_batch_src_global generation:  0.05529594421386719
r_  generation:  0.4902303218841553
local_output_nid generation:  0.035372257232666016
local_in_edges_tensor generation:  0.032273054122924805
mini_batch_src_global generation:  0.053449392318725586
r_  generation:  0.476287841796875
local_output_nid generation:  0.035449981689453125
local_in_edges_tensor generation:  0.033828020095825195
mini_batch_src_global generation:  0.05395054817199707
r_  generation:  0.4853501319885254
local_output_nid generation:  0.03509664535522461
local_in_edges_tensor generation:  0.03397250175476074
mini_batch_src_global generation:  0.06708288192749023
r_  generation:  0.48131704330444336
local_output_nid generation:  0.03515172004699707
local_in_edges_tensor generation:  0.038602352142333984
mini_batch_src_global generation:  0.052622318267822266
r_  generation:  0.4921450614929199
local_output_nid generation:  0.03963780403137207
local_in_edges_tensor generation:  0.03384041786193848
mini_batch_src_global generation:  0.05719256401062012
r_  generation:  0.4766097068786621
----------------------check_connections_block total spend ----------------------------- 11.531395673751831
generate_one_block  0.6606020927429199
generate_one_block  0.653022050857544
generate_one_block  0.6268844604492188
generate_one_block  0.6249072551727295
generate_one_block  0.6277763843536377
generate_one_block  0.6217994689941406
generate_one_block  0.6272716522216797
generate_one_block  0.6429681777954102
generate_one_block  0.6685948371887207
generate_one_block  0.6382622718811035
generate_one_block  0.6383466720581055
generate_one_block  0.6190760135650635
generate_one_block  0.6188879013061523
generate_one_block  0.6222405433654785
generate_one_block  0.6242027282714844
generate_one_block  0.6280314922332764
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.12874269485473633  GigaBytes
Max Memory Allocated: 18.1050443649292  GigaBytes

connection checking time:  18.253817319869995
block generation total time  16.319591522216797
average batch blocks generation time:  1.0199744701385498
block dataloader generation time/epoch 37.521320104599
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.10125589370727539  GigaBytes
Max Memory Allocated: 18.1050443649292  GigaBytes

torch.Size([156732, 128])
torch.Size([130444, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 18.07723569869995  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.10065937042236328  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

torch.Size([156724, 128])
torch.Size([130075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 17.966330528259277  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.1012568473815918  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

torch.Size([156701, 128])
torch.Size([129819, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 18.048151969909668  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.10067939758300781  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

torch.Size([156611, 128])
torch.Size([129678, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 17.95955753326416  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 0.1013956069946289  GigaBytes
Max Memory Allocated: 18.111634254455566  GigaBytes

torch.Size([156802, 128])
torch.Size([130068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1365966796875 GB
    Memory Allocated: 18.12709903717041  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.10060977935791016  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

torch.Size([156672, 128])
torch.Size([129689, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 17.898972034454346  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.10123777389526367  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

torch.Size([156811, 128])
torch.Size([130129, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 18.006219387054443  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.10067367553710938  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

torch.Size([156795, 128])
torch.Size([130183, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 17.987374782562256  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.10122060775756836  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

torch.Size([157253, 128])
torch.Size([130180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 17.770458698272705  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.10086441040039062  GigaBytes
Max Memory Allocated: 18.16150426864624  GigaBytes

torch.Size([157215, 128])
torch.Size([130970, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 18.156376838684082  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1580810546875 GB
    Memory Allocated: 0.1008310317993164  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

torch.Size([157130, 128])
torch.Size([130538, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 18.13582754135132  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 0.1006174087524414  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

torch.Size([156551, 128])
torch.Size([129561, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 17.90575885772705  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 0.10062694549560547  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

torch.Size([156934, 128])
torch.Size([130203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 17.950321674346924  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 0.10056018829345703  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

torch.Size([156948, 128])
torch.Size([130147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 17.899142742156982  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 0.10057830810546875  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

torch.Size([156666, 128])
torch.Size([129591, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 17.889155864715576  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 0.10073280334472656  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

torch.Size([156702, 128])
torch.Size([129711, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3104248046875 GB
    Memory Allocated: 18.0196533203125  GigaBytes
Max Memory Allocated: 18.190786361694336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03926172852516174 |0.02415834367275238 |0.6392755508422852 |0.00010338425636291504 |1.0225851982831955 |0.005113124847412109 |
----------------------------------------------------------pseudo_mini_loss sum 3.315249443054199
Total (block generation + training)time/epoch 65.1655957698822
Training time/epoch 27.64401626586914
Training time without block to device /epoch 27.257482767105103
Training time without total dataloading part /epoch 26.59653925895691
load block tensor time/epoch 0.6281876564025879
block to device time/epoch 0.3865334987640381
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5321026
Number of first layer input nodes during this epoch:  2509247
