Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648485884.863561
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0010123252868652344  GigaBytes
Max Memory Allocated: 0.0010123252868652344  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023551225662231445
random selection method range initialization spend 0.005667686462402344
time for parepare:  0.01892876625061035
local_output_nid generation:  0.002217531204223633
local_in_edges_tensor generation:  0.003746509552001953
mini_batch_src_global generation:  0.0017440319061279297
r_  generation:  0.018442869186401367
local_output_nid generation:  0.0029947757720947266
local_in_edges_tensor generation:  0.0016357898712158203
mini_batch_src_global generation:  0.002170562744140625
r_  generation:  0.019051551818847656
local_output_nid generation:  0.003010272979736328
local_in_edges_tensor generation:  0.0015711784362792969
mini_batch_src_global generation:  0.001356363296508789
r_  generation:  0.018207788467407227
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0015521049499511719
mini_batch_src_global generation:  0.0013849735260009766
r_  generation:  0.018599748611450195
local_output_nid generation:  0.002965688705444336
local_in_edges_tensor generation:  0.0014958381652832031
mini_batch_src_global generation:  0.0013573169708251953
r_  generation:  0.018288373947143555
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.0015239715576171875
mini_batch_src_global generation:  0.0014047622680664062
r_  generation:  0.019246816635131836
local_output_nid generation:  0.002941131591796875
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0014789104461669922
r_  generation:  0.019641637802124023
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0014824867248535156
mini_batch_src_global generation:  0.001477956771850586
r_  generation:  0.018839359283447266
local_output_nid generation:  0.0029828548431396484
local_in_edges_tensor generation:  0.0014982223510742188
mini_batch_src_global generation:  0.0014579296112060547
r_  generation:  0.019587993621826172
local_output_nid generation:  0.0029561519622802734
local_in_edges_tensor generation:  0.001505136489868164
mini_batch_src_global generation:  0.0014853477478027344
r_  generation:  0.019218921661376953
local_output_nid generation:  0.002956867218017578
local_in_edges_tensor generation:  0.0014820098876953125
mini_batch_src_global generation:  0.0015320777893066406
r_  generation:  0.02025437355041504
local_output_nid generation:  0.0029494762420654297
local_in_edges_tensor generation:  0.001505136489868164
mini_batch_src_global generation:  0.0015444755554199219
r_  generation:  0.019549846649169922
local_output_nid generation:  0.002937793731689453
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.001546621322631836
r_  generation:  0.019763469696044922
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0015265941619873047
r_  generation:  0.019367694854736328
local_output_nid generation:  0.002957582473754883
local_in_edges_tensor generation:  0.0014872550964355469
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.019176006317138672
local_output_nid generation:  0.0029516220092773438
local_in_edges_tensor generation:  0.0014805793762207031
mini_batch_src_global generation:  0.0015137195587158203
r_  generation:  0.019017934799194336
----------------------check_connections_block total spend ----------------------------- 0.5021142959594727
generate_one_block  0.02713489532470703
generate_one_block  0.029670000076293945
generate_one_block  0.027987003326416016
generate_one_block  0.03122711181640625
generate_one_block  0.027542829513549805
generate_one_block  0.028185129165649414
generate_one_block  0.028530359268188477
generate_one_block  0.027472257614135742
generate_one_block  0.028672218322753906
generate_one_block  0.02829289436340332
generate_one_block  0.029094219207763672
generate_one_block  0.028153419494628906
generate_one_block  0.027688026428222656
generate_one_block  0.02811741828918457
generate_one_block  0.027055025100708008
generate_one_block  0.027376413345336914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03784346580505371
gen group dst list time:  0.019014358520507812
time for parepare:  0.01918792724609375
local_output_nid generation:  0.008203744888305664
local_in_edges_tensor generation:  0.017126083374023438
mini_batch_src_global generation:  0.01994776725769043
r_  generation:  0.20133352279663086
local_output_nid generation:  0.013013839721679688
local_in_edges_tensor generation:  0.02070760726928711
mini_batch_src_global generation:  0.026193857192993164
r_  generation:  0.2169327735900879
local_output_nid generation:  0.01243138313293457
local_in_edges_tensor generation:  0.01961970329284668
mini_batch_src_global generation:  0.02425837516784668
r_  generation:  0.2137751579284668
local_output_nid generation:  0.012499094009399414
local_in_edges_tensor generation:  0.01641845703125
mini_batch_src_global generation:  0.028258323669433594
r_  generation:  0.21898603439331055
local_output_nid generation:  0.012387752532958984
local_in_edges_tensor generation:  0.012432336807250977
mini_batch_src_global generation:  0.025714397430419922
r_  generation:  0.21563148498535156
local_output_nid generation:  0.013669252395629883
local_in_edges_tensor generation:  0.020078182220458984
mini_batch_src_global generation:  0.02847433090209961
r_  generation:  0.23359012603759766
local_output_nid generation:  0.015114307403564453
local_in_edges_tensor generation:  0.0171506404876709
mini_batch_src_global generation:  0.028762340545654297
r_  generation:  0.22204113006591797
local_output_nid generation:  0.012696981430053711
local_in_edges_tensor generation:  0.016676902770996094
mini_batch_src_global generation:  0.02681255340576172
r_  generation:  0.2187025547027588
local_output_nid generation:  0.01300668716430664
local_in_edges_tensor generation:  0.016678571701049805
mini_batch_src_global generation:  0.027271509170532227
r_  generation:  0.2198479175567627
local_output_nid generation:  0.01282191276550293
local_in_edges_tensor generation:  0.014306783676147461
mini_batch_src_global generation:  0.02718496322631836
r_  generation:  0.21688103675842285
local_output_nid generation:  0.013164043426513672
local_in_edges_tensor generation:  0.014670133590698242
mini_batch_src_global generation:  0.029538631439208984
r_  generation:  0.22470664978027344
local_output_nid generation:  0.012932062149047852
local_in_edges_tensor generation:  0.014535188674926758
mini_batch_src_global generation:  0.02780604362487793
r_  generation:  0.22145891189575195
local_output_nid generation:  0.012922048568725586
local_in_edges_tensor generation:  0.014394283294677734
mini_batch_src_global generation:  0.027579307556152344
r_  generation:  0.21962404251098633
local_output_nid generation:  0.013015270233154297
local_in_edges_tensor generation:  0.014533519744873047
mini_batch_src_global generation:  0.032503604888916016
r_  generation:  0.22373557090759277
local_output_nid generation:  0.012725114822387695
local_in_edges_tensor generation:  0.012918710708618164
mini_batch_src_global generation:  0.02723526954650879
r_  generation:  0.21726298332214355
local_output_nid generation:  0.012687206268310547
local_in_edges_tensor generation:  0.013841629028320312
mini_batch_src_global generation:  0.028340578079223633
r_  generation:  0.21937870979309082
----------------------check_connections_block total spend ----------------------------- 5.1812262535095215
generate_one_block  0.28790974617004395
generate_one_block  0.2915313243865967
generate_one_block  0.2794766426086426
generate_one_block  0.2840299606323242
generate_one_block  0.2895994186401367
generate_one_block  0.27666139602661133
generate_one_block  0.2877328395843506
generate_one_block  0.27265238761901855
generate_one_block  0.28521060943603516
generate_one_block  0.2789015769958496
generate_one_block  0.2915217876434326
generate_one_block  0.28117823600769043
generate_one_block  0.27632713317871094
generate_one_block  0.2913215160369873
generate_one_block  0.2796616554260254
generate_one_block  0.29047608375549316
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05858254432678223
gen group dst list time:  0.06762528419494629
time for parepare:  0.01903223991394043
local_output_nid generation:  0.02664923667907715
local_in_edges_tensor generation:  0.05641508102416992
mini_batch_src_global generation:  0.060105323791503906
r_  generation:  0.4857020378112793
local_output_nid generation:  0.03384661674499512
local_in_edges_tensor generation:  0.049117326736450195
mini_batch_src_global generation:  0.06040620803833008
r_  generation:  0.492053747177124
local_output_nid generation:  0.03183579444885254
local_in_edges_tensor generation:  0.04477572441101074
mini_batch_src_global generation:  0.05656290054321289
r_  generation:  0.5072731971740723
local_output_nid generation:  0.03119969367980957
local_in_edges_tensor generation:  0.04256916046142578
mini_batch_src_global generation:  0.07056188583374023
r_  generation:  0.492326021194458
local_output_nid generation:  0.03262495994567871
local_in_edges_tensor generation:  0.042700767517089844
mini_batch_src_global generation:  0.056432247161865234
r_  generation:  0.49326062202453613
local_output_nid generation:  0.031861066818237305
local_in_edges_tensor generation:  0.03521871566772461
mini_batch_src_global generation:  0.061211347579956055
r_  generation:  0.49852800369262695
local_output_nid generation:  0.03238177299499512
local_in_edges_tensor generation:  0.04038381576538086
mini_batch_src_global generation:  0.058962106704711914
r_  generation:  0.5020012855529785
local_output_nid generation:  0.03275275230407715
local_in_edges_tensor generation:  0.04006314277648926
mini_batch_src_global generation:  0.0589289665222168
r_  generation:  0.5190813541412354
local_output_nid generation:  0.0342707633972168
local_in_edges_tensor generation:  0.040944576263427734
mini_batch_src_global generation:  0.06251645088195801
r_  generation:  0.49904918670654297
local_output_nid generation:  0.03259634971618652
local_in_edges_tensor generation:  0.04518938064575195
mini_batch_src_global generation:  0.06517744064331055
r_  generation:  0.4923720359802246
local_output_nid generation:  0.032250404357910156
local_in_edges_tensor generation:  0.03436899185180664
mini_batch_src_global generation:  0.05890631675720215
r_  generation:  0.498516321182251
local_output_nid generation:  0.031879425048828125
local_in_edges_tensor generation:  0.03930926322937012
mini_batch_src_global generation:  0.057666778564453125
r_  generation:  0.5098474025726318
local_output_nid generation:  0.03223228454589844
local_in_edges_tensor generation:  0.04038381576538086
mini_batch_src_global generation:  0.061109304428100586
r_  generation:  0.5078670978546143
local_output_nid generation:  0.032068490982055664
local_in_edges_tensor generation:  0.03091740608215332
mini_batch_src_global generation:  0.05884552001953125
r_  generation:  0.4983940124511719
local_output_nid generation:  0.03296160697937012
local_in_edges_tensor generation:  0.036301374435424805
mini_batch_src_global generation:  0.058696746826171875
r_  generation:  0.5032198429107666
local_output_nid generation:  0.0324864387512207
local_in_edges_tensor generation:  0.03072381019592285
mini_batch_src_global generation:  0.05860424041748047
r_  generation:  0.4952816963195801
----------------------check_connections_block total spend ----------------------------- 11.848331451416016
generate_one_block  0.652651309967041
generate_one_block  0.6564431190490723
generate_one_block  0.6351070404052734
generate_one_block  0.6338553428649902
generate_one_block  0.6267256736755371
generate_one_block  0.6311860084533691
generate_one_block  0.7135534286499023
generate_one_block  0.6284682750701904
generate_one_block  0.6309447288513184
generate_one_block  0.6439988613128662
generate_one_block  0.6320047378540039
generate_one_block  0.6587131023406982
generate_one_block  0.6465849876403809
generate_one_block  0.6347239017486572
generate_one_block  0.6208946704864502
generate_one_block  0.6229767799377441
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050872802734375
gen group dst list time:  0.0868217945098877
time for parepare:  0.019641637802124023
local_output_nid generation:  0.03419828414916992
local_in_edges_tensor generation:  0.06920576095581055
mini_batch_src_global generation:  0.04667329788208008
r_  generation:  0.49659013748168945
local_output_nid generation:  0.03983902931213379
local_in_edges_tensor generation:  0.04116034507751465
mini_batch_src_global generation:  0.05616402626037598
r_  generation:  0.4972379207611084
local_output_nid generation:  0.038086652755737305
local_in_edges_tensor generation:  0.046483516693115234
mini_batch_src_global generation:  0.053671836853027344
r_  generation:  0.5052738189697266
local_output_nid generation:  0.04173445701599121
local_in_edges_tensor generation:  0.050096750259399414
mini_batch_src_global generation:  0.05333733558654785
r_  generation:  0.5075204372406006
local_output_nid generation:  0.03891181945800781
local_in_edges_tensor generation:  0.04777026176452637
mini_batch_src_global generation:  0.05408835411071777
r_  generation:  0.5139951705932617
local_output_nid generation:  0.038361310958862305
local_in_edges_tensor generation:  0.04160141944885254
mini_batch_src_global generation:  0.05428147315979004
r_  generation:  0.5140941143035889
local_output_nid generation:  0.038428306579589844
local_in_edges_tensor generation:  0.04152107238769531
mini_batch_src_global generation:  0.06972646713256836
r_  generation:  0.5283503532409668
local_output_nid generation:  0.04189753532409668
local_in_edges_tensor generation:  0.04909253120422363
mini_batch_src_global generation:  0.05468344688415527
r_  generation:  0.5133399963378906
local_output_nid generation:  0.03945589065551758
local_in_edges_tensor generation:  0.042201995849609375
mini_batch_src_global generation:  0.05549764633178711
r_  generation:  0.5185253620147705
local_output_nid generation:  0.03939104080200195
local_in_edges_tensor generation:  0.050803422927856445
mini_batch_src_global generation:  0.05521106719970703
r_  generation:  0.5162999629974365
local_output_nid generation:  0.03939008712768555
local_in_edges_tensor generation:  0.03795051574707031
mini_batch_src_global generation:  0.05498194694519043
r_  generation:  0.5239944458007812
local_output_nid generation:  0.03964853286743164
local_in_edges_tensor generation:  0.04203438758850098
mini_batch_src_global generation:  0.055818796157836914
r_  generation:  0.5160706043243408
local_output_nid generation:  0.03967452049255371
local_in_edges_tensor generation:  0.05103111267089844
mini_batch_src_global generation:  0.056046485900878906
r_  generation:  0.5236492156982422
local_output_nid generation:  0.03968524932861328
local_in_edges_tensor generation:  0.04249238967895508
mini_batch_src_global generation:  0.056314945220947266
r_  generation:  0.5137917995452881
local_output_nid generation:  0.04058694839477539
local_in_edges_tensor generation:  0.03883242607116699
mini_batch_src_global generation:  0.056322574615478516
r_  generation:  0.5203697681427002
local_output_nid generation:  0.03941702842712402
local_in_edges_tensor generation:  0.05484938621520996
mini_batch_src_global generation:  0.05639290809631348
r_  generation:  0.5267555713653564
----------------------check_connections_block total spend ----------------------------- 12.434467792510986
generate_one_block  0.6410207748413086
generate_one_block  0.7245266437530518
generate_one_block  0.64019775390625
generate_one_block  0.6178734302520752
generate_one_block  0.634998083114624
generate_one_block  0.6197669506072998
generate_one_block  0.6262872219085693
generate_one_block  0.6382033824920654
generate_one_block  0.6361551284790039
generate_one_block  0.6477653980255127
generate_one_block  0.6373236179351807
generate_one_block  0.620358943939209
generate_one_block  0.635089635848999
generate_one_block  0.62648606300354
generate_one_block  0.6452319622039795
generate_one_block  0.6287293434143066
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0010123252868652344  GigaBytes
Max Memory Allocated: 0.0010123252868652344  GigaBytes

connection checking time:  29.464025497436523
block generation total time  25.03303861618042
average batch blocks generation time:  1.5645649135112762
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10757064819335938  GigaBytes
Max Memory Allocated: 0.10757064819335938  GigaBytes

torch.Size([163502, 128])
torch.Size([155483, 64])
torch.Size([123956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6463623046875 GB
    Memory Allocated: 20.28281021118164  GigaBytes
Max Memory Allocated: 20.296547889709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.10982418060302734  GigaBytes
Max Memory Allocated: 20.296547889709473  GigaBytes

torch.Size([163575, 128])
torch.Size([155499, 64])
torch.Size([124161, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 20.451478958129883  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.10971593856811523  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163699, 128])
torch.Size([155647, 64])
torch.Size([123783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 20.32806968688965  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.10963058471679688  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163555, 128])
torch.Size([155294, 64])
torch.Size([123708, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 20.355406284332275  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.10955572128295898  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163713, 128])
torch.Size([155689, 64])
torch.Size([123500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 20.212153434753418  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.10953140258789062  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163525, 128])
torch.Size([155291, 64])
torch.Size([123212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 20.262625694274902  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.10982847213745117  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163449, 128])
torch.Size([155481, 64])
torch.Size([124374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 20.394612312316895  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.10947227478027344  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163527, 128])
torch.Size([155366, 64])
torch.Size([123113, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 20.238847255706787  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5467529296875 GB
    Memory Allocated: 0.1098027229309082  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163606, 128])
torch.Size([155364, 64])
torch.Size([123638, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.36186170578003  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1096806526184082  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163806, 128])
torch.Size([155782, 64])
torch.Size([123816, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.29679775238037  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.10987043380737305  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163650, 128])
torch.Size([155527, 64])
torch.Size([123692, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.397228717803955  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1096343994140625  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163537, 128])
torch.Size([155370, 64])
torch.Size([123811, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.355806827545166  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.10971403121948242  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163742, 128])
torch.Size([155991, 64])
torch.Size([124960, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.344768047332764  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.10960006713867188  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163543, 128])
torch.Size([155282, 64])
torch.Size([123283, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.33599328994751  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.10959672927856445  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163538, 128])
torch.Size([155458, 64])
torch.Size([123071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.266358375549316  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.10943889617919922  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163485, 128])
torch.Size([155306, 64])
torch.Size([123223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.265841007232666  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034469276666641235 |0.04703313112258911 |0.4048963636159897 |0.0001062154769897461 |0.5440205633640289 |0.010492324829101562 |
----------------------------------------------------------pseudo_mini_loss sum 4.7489013671875
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7745661
Number of first layer input nodes during this epoch:  2617452
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1601700782775879  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024095535278320312
random selection method range initialization spend 0.0056629180908203125
time for parepare:  0.018990278244018555
local_output_nid generation:  0.0028543472290039062
local_in_edges_tensor generation:  0.00755620002746582
mini_batch_src_global generation:  0.002042055130004883
r_  generation:  0.018911123275756836
local_output_nid generation:  0.003279447555541992
local_in_edges_tensor generation:  0.0017151832580566406
mini_batch_src_global generation:  0.0022046566009521484
r_  generation:  0.018915653228759766
local_output_nid generation:  0.0031604766845703125
local_in_edges_tensor generation:  0.0016074180603027344
mini_batch_src_global generation:  0.0015022754669189453
r_  generation:  0.01861286163330078
local_output_nid generation:  0.0031273365020751953
local_in_edges_tensor generation:  0.0016295909881591797
mini_batch_src_global generation:  0.00138092041015625
r_  generation:  0.01859450340270996
local_output_nid generation:  0.0031197071075439453
local_in_edges_tensor generation:  0.0015728473663330078
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.019196510314941406
local_output_nid generation:  0.0030939579010009766
local_in_edges_tensor generation:  0.001542806625366211
mini_batch_src_global generation:  0.0015223026275634766
r_  generation:  0.0193636417388916
local_output_nid generation:  0.003176450729370117
local_in_edges_tensor generation:  0.0015864372253417969
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.01932215690612793
local_output_nid generation:  0.0030748844146728516
local_in_edges_tensor generation:  0.0015451908111572266
mini_batch_src_global generation:  0.0015666484832763672
r_  generation:  0.01983189582824707
local_output_nid generation:  0.0030989646911621094
local_in_edges_tensor generation:  0.0015621185302734375
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.019869327545166016
local_output_nid generation:  0.0031180381774902344
local_in_edges_tensor generation:  0.0015535354614257812
mini_batch_src_global generation:  0.0014853477478027344
r_  generation:  0.019599199295043945
local_output_nid generation:  0.003103017807006836
local_in_edges_tensor generation:  0.0015168190002441406
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.020198822021484375
local_output_nid generation:  0.003114938735961914
local_in_edges_tensor generation:  0.0015664100646972656
mini_batch_src_global generation:  0.0015132427215576172
r_  generation:  0.01949286460876465
local_output_nid generation:  0.0031447410583496094
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0015377998352050781
r_  generation:  0.01923823356628418
local_output_nid generation:  0.003103017807006836
local_in_edges_tensor generation:  0.0015444755554199219
mini_batch_src_global generation:  0.001535177230834961
r_  generation:  0.020114660263061523
local_output_nid generation:  0.0031363964080810547
local_in_edges_tensor generation:  0.0016045570373535156
mini_batch_src_global generation:  0.0016095638275146484
r_  generation:  0.02066206932067871
local_output_nid generation:  0.0031652450561523438
local_in_edges_tensor generation:  0.0015501976013183594
mini_batch_src_global generation:  0.001622915267944336
r_  generation:  0.020066022872924805
----------------------check_connections_block total spend ----------------------------- 0.5202498435974121
generate_one_block  0.03782200813293457
generate_one_block  0.032330989837646484
generate_one_block  0.031952857971191406
generate_one_block  0.03168177604675293
generate_one_block  0.032453298568725586
generate_one_block  0.03550553321838379
generate_one_block  0.03303885459899902
generate_one_block  0.03284454345703125
generate_one_block  0.03277182579040527
generate_one_block  0.0324549674987793
generate_one_block  0.031586647033691406
generate_one_block  0.0316767692565918
generate_one_block  0.03177595138549805
generate_one_block  0.03265547752380371
generate_one_block  0.03362560272216797
generate_one_block  0.03286600112915039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0387876033782959
gen group dst list time:  0.016971111297607422
time for parepare:  0.019606828689575195
local_output_nid generation:  0.00934910774230957
local_in_edges_tensor generation:  0.01937270164489746
mini_batch_src_global generation:  0.020986557006835938
r_  generation:  0.19713926315307617
local_output_nid generation:  0.015111923217773438
local_in_edges_tensor generation:  0.01996016502380371
mini_batch_src_global generation:  0.0253446102142334
r_  generation:  0.20986008644104004
local_output_nid generation:  0.014539718627929688
local_in_edges_tensor generation:  0.017682552337646484
mini_batch_src_global generation:  0.024133682250976562
r_  generation:  0.21213364601135254
local_output_nid generation:  0.014162540435791016
local_in_edges_tensor generation:  0.012396097183227539
mini_batch_src_global generation:  0.028411388397216797
r_  generation:  0.21104979515075684
local_output_nid generation:  0.014862060546875
local_in_edges_tensor generation:  0.01611495018005371
mini_batch_src_global generation:  0.03209352493286133
r_  generation:  0.21739697456359863
local_output_nid generation:  0.015118598937988281
local_in_edges_tensor generation:  0.014235258102416992
mini_batch_src_global generation:  0.026830434799194336
r_  generation:  0.2189786434173584
local_output_nid generation:  0.015091896057128906
local_in_edges_tensor generation:  0.013813018798828125
mini_batch_src_global generation:  0.02705693244934082
r_  generation:  0.21509528160095215
local_output_nid generation:  0.015420198440551758
local_in_edges_tensor generation:  0.018934965133666992
mini_batch_src_global generation:  0.027849435806274414
r_  generation:  0.22320818901062012
local_output_nid generation:  0.015112161636352539
local_in_edges_tensor generation:  0.017882108688354492
mini_batch_src_global generation:  0.027452707290649414
r_  generation:  0.22100281715393066
local_output_nid generation:  0.01465296745300293
local_in_edges_tensor generation:  0.015794038772583008
mini_batch_src_global generation:  0.027883529663085938
r_  generation:  0.22153639793395996
local_output_nid generation:  0.014338016510009766
local_in_edges_tensor generation:  0.012270212173461914
mini_batch_src_global generation:  0.02735304832458496
r_  generation:  0.21970057487487793
local_output_nid generation:  0.014405488967895508
local_in_edges_tensor generation:  0.011985540390014648
mini_batch_src_global generation:  0.02686786651611328
r_  generation:  0.2174832820892334
local_output_nid generation:  0.01720261573791504
local_in_edges_tensor generation:  0.013980865478515625
mini_batch_src_global generation:  0.026960134506225586
r_  generation:  0.2203528881072998
local_output_nid generation:  0.014534711837768555
local_in_edges_tensor generation:  0.013859748840332031
mini_batch_src_global generation:  0.02748394012451172
r_  generation:  0.2182149887084961
local_output_nid generation:  0.014595746994018555
local_in_edges_tensor generation:  0.01623845100402832
mini_batch_src_global generation:  0.027868986129760742
r_  generation:  0.23076915740966797
local_output_nid generation:  0.014426469802856445
local_in_edges_tensor generation:  0.016284704208374023
mini_batch_src_global generation:  0.028034448623657227
r_  generation:  0.22220826148986816
----------------------check_connections_block total spend ----------------------------- 5.167462587356567
generate_one_block  0.29326605796813965
generate_one_block  0.2942690849304199
generate_one_block  0.2934072017669678
generate_one_block  0.29372382164001465
generate_one_block  0.2945518493652344
generate_one_block  0.2945709228515625
generate_one_block  0.3148987293243408
generate_one_block  0.3021676540374756
generate_one_block  0.299851655960083
generate_one_block  0.29295825958251953
generate_one_block  0.2884650230407715
generate_one_block  0.29213571548461914
generate_one_block  0.2901761531829834
generate_one_block  0.28978538513183594
generate_one_block  0.3086576461791992
generate_one_block  0.2913682460784912
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04076981544494629
gen group dst list time:  0.06000471115112305
time for parepare:  0.018248558044433594
local_output_nid generation:  0.02795886993408203
local_in_edges_tensor generation:  0.04187178611755371
mini_batch_src_global generation:  0.04928874969482422
r_  generation:  0.47515177726745605
local_output_nid generation:  0.0325169563293457
local_in_edges_tensor generation:  0.04836750030517578
mini_batch_src_global generation:  0.05634331703186035
r_  generation:  0.4860513210296631
local_output_nid generation:  0.03249049186706543
local_in_edges_tensor generation:  0.04449725151062012
mini_batch_src_global generation:  0.0545501708984375
r_  generation:  0.49359774589538574
local_output_nid generation:  0.03266716003417969
local_in_edges_tensor generation:  0.03595995903015137
mini_batch_src_global generation:  0.057064056396484375
r_  generation:  0.4922370910644531
local_output_nid generation:  0.03241610527038574
local_in_edges_tensor generation:  0.07966470718383789
mini_batch_src_global generation:  0.05614423751831055
r_  generation:  0.5018966197967529
local_output_nid generation:  0.0325930118560791
local_in_edges_tensor generation:  0.03520560264587402
mini_batch_src_global generation:  0.05930781364440918
r_  generation:  0.5029830932617188
local_output_nid generation:  0.032775163650512695
local_in_edges_tensor generation:  0.03840017318725586
mini_batch_src_global generation:  0.05684924125671387
r_  generation:  0.5023159980773926
local_output_nid generation:  0.034018754959106445
local_in_edges_tensor generation:  0.04863142967224121
mini_batch_src_global generation:  0.05794048309326172
r_  generation:  0.5003190040588379
local_output_nid generation:  0.032962799072265625
local_in_edges_tensor generation:  0.039968252182006836
mini_batch_src_global generation:  0.06712484359741211
r_  generation:  0.5019352436065674
local_output_nid generation:  0.0330662727355957
local_in_edges_tensor generation:  0.04798126220703125
mini_batch_src_global generation:  0.06801271438598633
r_  generation:  0.4955768585205078
local_output_nid generation:  0.03481650352478027
local_in_edges_tensor generation:  0.03191041946411133
mini_batch_src_global generation:  0.06322026252746582
r_  generation:  0.49796009063720703
local_output_nid generation:  0.03368949890136719
local_in_edges_tensor generation:  0.03242802619934082
mini_batch_src_global generation:  0.05752205848693848
r_  generation:  0.49091219902038574
local_output_nid generation:  0.03388333320617676
local_in_edges_tensor generation:  0.03698420524597168
mini_batch_src_global generation:  0.057431936264038086
r_  generation:  0.49873828887939453
local_output_nid generation:  0.033579349517822266
local_in_edges_tensor generation:  0.035532474517822266
mini_batch_src_global generation:  0.05771183967590332
r_  generation:  0.49642419815063477
local_output_nid generation:  0.03365063667297363
local_in_edges_tensor generation:  0.041205644607543945
mini_batch_src_global generation:  0.06079912185668945
r_  generation:  0.500206708908081
local_output_nid generation:  0.033648014068603516
local_in_edges_tensor generation:  0.03128504753112793
mini_batch_src_global generation:  0.06015634536743164
r_  generation:  0.5059123039245605
----------------------check_connections_block total spend ----------------------------- 11.788639783859253
generate_one_block  0.6809060573577881
generate_one_block  0.6684906482696533
generate_one_block  0.6513023376464844
generate_one_block  0.6565654277801514
generate_one_block  0.6595089435577393
generate_one_block  0.6588671207427979
generate_one_block  0.647510290145874
generate_one_block  0.6613192558288574
generate_one_block  0.6802115440368652
generate_one_block  0.6666574478149414
generate_one_block  0.641139030456543
generate_one_block  0.6542115211486816
generate_one_block  0.6562528610229492
generate_one_block  0.6430633068084717
generate_one_block  0.6658909320831299
generate_one_block  0.6400341987609863
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04353022575378418
gen group dst list time:  0.09011650085449219
time for parepare:  0.019774436950683594
local_output_nid generation:  0.03506016731262207
local_in_edges_tensor generation:  0.056624412536621094
mini_batch_src_global generation:  0.04506683349609375
r_  generation:  0.49692440032958984
local_output_nid generation:  0.04192996025085449
local_in_edges_tensor generation:  0.03976702690124512
mini_batch_src_global generation:  0.05634307861328125
r_  generation:  0.5018923282623291
local_output_nid generation:  0.04220008850097656
local_in_edges_tensor generation:  0.042183637619018555
mini_batch_src_global generation:  0.05436277389526367
r_  generation:  0.5075421333312988
local_output_nid generation:  0.040398597717285156
local_in_edges_tensor generation:  0.048113107681274414
mini_batch_src_global generation:  0.05397844314575195
r_  generation:  0.5091309547424316
local_output_nid generation:  0.03942990303039551
local_in_edges_tensor generation:  0.04192972183227539
mini_batch_src_global generation:  0.05321502685546875
r_  generation:  0.5241608619689941
local_output_nid generation:  0.039087772369384766
local_in_edges_tensor generation:  0.04683089256286621
mini_batch_src_global generation:  0.054618120193481445
r_  generation:  0.5110130310058594
local_output_nid generation:  0.03902840614318848
local_in_edges_tensor generation:  0.04181647300720215
mini_batch_src_global generation:  0.05388641357421875
r_  generation:  0.5192749500274658
local_output_nid generation:  0.03934764862060547
local_in_edges_tensor generation:  0.04889702796936035
mini_batch_src_global generation:  0.05496358871459961
r_  generation:  0.5180065631866455
local_output_nid generation:  0.04010319709777832
local_in_edges_tensor generation:  0.038949012756347656
mini_batch_src_global generation:  0.05583548545837402
r_  generation:  0.5253410339355469
local_output_nid generation:  0.03991508483886719
local_in_edges_tensor generation:  0.048459768295288086
mini_batch_src_global generation:  0.0598599910736084
r_  generation:  0.5184485912322998
local_output_nid generation:  0.03940320014953613
local_in_edges_tensor generation:  0.041951894760131836
mini_batch_src_global generation:  0.05698990821838379
r_  generation:  0.5274288654327393
local_output_nid generation:  0.040259599685668945
local_in_edges_tensor generation:  0.0422055721282959
mini_batch_src_global generation:  0.05688738822937012
r_  generation:  0.5215699672698975
local_output_nid generation:  0.03928017616271973
local_in_edges_tensor generation:  0.04683876037597656
mini_batch_src_global generation:  0.05596017837524414
r_  generation:  0.5264837741851807
local_output_nid generation:  0.03890037536621094
local_in_edges_tensor generation:  0.04238128662109375
mini_batch_src_global generation:  0.05673670768737793
r_  generation:  0.5423479080200195
local_output_nid generation:  0.03930830955505371
local_in_edges_tensor generation:  0.04163241386413574
mini_batch_src_global generation:  0.059350013732910156
r_  generation:  0.5252964496612549
local_output_nid generation:  0.03959989547729492
local_in_edges_tensor generation:  0.03878450393676758
mini_batch_src_global generation:  0.05549764633178711
r_  generation:  0.5240979194641113
----------------------check_connections_block total spend ----------------------------- 12.456404685974121
generate_one_block  0.6787075996398926
generate_one_block  0.6631958484649658
generate_one_block  0.6571757793426514
generate_one_block  0.655113935470581
generate_one_block  0.6553182601928711
generate_one_block  0.6494174003601074
generate_one_block  0.740215539932251
generate_one_block  0.6593742370605469
generate_one_block  0.6461737155914307
generate_one_block  0.6576576232910156
generate_one_block  0.6615860462188721
generate_one_block  0.6994867324829102
generate_one_block  0.6667888164520264
generate_one_block  0.6535711288452148
generate_one_block  0.6884164810180664
generate_one_block  0.6540839672088623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1601700782775879  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

connection checking time:  29.41250705718994
block generation total time  25.952467441558838
average batch blocks generation time:  1.6220292150974274
block dataloader generation time/epoch 58.38653254508972
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11168575286865234  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163424, 128])
torch.Size([155388, 64])
torch.Size([123105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.26518678665161  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11164999008178711  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163572, 128])
torch.Size([155424, 64])
torch.Size([123525, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.345144271850586  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1117405891418457  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163576, 128])
torch.Size([155485, 64])
torch.Size([123745, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.31130886077881  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11159086227416992  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163642, 128])
torch.Size([155649, 64])
torch.Size([124031, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.316044807434082  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11176156997680664  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163746, 128])
torch.Size([155615, 64])
torch.Size([123674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.327966690063477  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11159229278564453  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163483, 128])
torch.Size([155529, 64])
torch.Size([123730, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.336698532104492  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11170053482055664  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163685, 128])
torch.Size([155586, 64])
torch.Size([123783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.295101165771484  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11177206039428711  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163676, 128])
torch.Size([155727, 64])
torch.Size([124474, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.40085506439209  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1118016242980957  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163505, 128])
torch.Size([155276, 64])
torch.Size([123314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.347771167755127  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11169004440307617  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163656, 128])
torch.Size([155838, 64])
torch.Size([124497, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.346322059631348  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11169290542602539  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163606, 128])
torch.Size([155561, 64])
torch.Size([123560, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.29954719543457  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11162328720092773  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163754, 128])
torch.Size([155921, 64])
torch.Size([124278, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.282187938690186  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1117091178894043  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163795, 128])
torch.Size([155704, 64])
torch.Size([123963, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.31816005706787  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11154794692993164  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163590, 128])
torch.Size([155509, 64])
torch.Size([123741, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 20.293907642364502  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.11194372177124023  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163690, 128])
torch.Size([155814, 64])
torch.Size([124115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 20.442407608032227  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.11164379119873047  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

torch.Size([163525, 128])
torch.Size([155202, 64])
torch.Size([123409, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 20.330527782440186  GigaBytes
Max Memory Allocated: 20.46664810180664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02669772505760193 |0.026835933327674866 |0.36027945578098297 |9.621679782867432e-05 |0.6160897016525269 |0.008401155471801758 |
----------------------------------------------------------pseudo_mini_loss sum 3.743384599685669
Total (block generation + training)time/epoch 74.9022216796875
Training time/epoch 16.515410661697388
Training time without block to device /epoch 16.08603572845459
Training time without total dataloading part /epoch 15.631847143173218
load block tensor time/epoch 0.42716360092163086
block to device time/epoch 0.42937493324279785
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7749296
Number of first layer input nodes during this epoch:  2617925
