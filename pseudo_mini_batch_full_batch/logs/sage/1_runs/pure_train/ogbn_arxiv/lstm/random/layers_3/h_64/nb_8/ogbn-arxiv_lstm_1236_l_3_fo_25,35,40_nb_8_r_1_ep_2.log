Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648456780.3038888
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024161815643310547
random selection method range initialization spend 0.0057218074798583984
time for parepare:  0.01974034309387207
local_output_nid generation:  0.00430607795715332
local_in_edges_tensor generation:  0.005815982818603516
mini_batch_src_global generation:  0.003615856170654297
r_  generation:  0.03841257095336914
local_output_nid generation:  0.006081104278564453
local_in_edges_tensor generation:  0.003097057342529297
mini_batch_src_global generation:  0.00431513786315918
r_  generation:  0.04028677940368652
local_output_nid generation:  0.006268501281738281
local_in_edges_tensor generation:  0.003155946731567383
mini_batch_src_global generation:  0.002964019775390625
r_  generation:  0.04010319709777832
local_output_nid generation:  0.006193637847900391
local_in_edges_tensor generation:  0.003094911575317383
mini_batch_src_global generation:  0.0030820369720458984
r_  generation:  0.04166054725646973
local_output_nid generation:  0.006134510040283203
local_in_edges_tensor generation:  0.003204822540283203
mini_batch_src_global generation:  0.0032501220703125
r_  generation:  0.042578935623168945
local_output_nid generation:  0.006333589553833008
local_in_edges_tensor generation:  0.003228902816772461
mini_batch_src_global generation:  0.0034813880920410156
r_  generation:  0.04250621795654297
local_output_nid generation:  0.006214618682861328
local_in_edges_tensor generation:  0.003179311752319336
mini_batch_src_global generation:  0.003530263900756836
r_  generation:  0.0421597957611084
local_output_nid generation:  0.00624537467956543
local_in_edges_tensor generation:  0.003195524215698242
mini_batch_src_global generation:  0.0035674571990966797
r_  generation:  0.042597055435180664
----------------------check_connections_block total spend ----------------------------- 0.5327143669128418
generate_one_block  0.05449318885803223
generate_one_block  0.054959774017333984
generate_one_block  0.05429434776306152
generate_one_block  0.05517077445983887
generate_one_block  0.058855295181274414
generate_one_block  0.055362701416015625
generate_one_block  0.055497169494628906
generate_one_block  0.055397987365722656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037938833236694336
gen group dst list time:  0.015259027481079102
time for parepare:  0.01878809928894043
local_output_nid generation:  0.01309657096862793
local_in_edges_tensor generation:  0.03134012222290039
mini_batch_src_global generation:  0.03140974044799805
r_  generation:  0.2887570858001709
local_output_nid generation:  0.01852703094482422
local_in_edges_tensor generation:  0.028675079345703125
mini_batch_src_global generation:  0.03650474548339844
r_  generation:  0.2957267761230469
local_output_nid generation:  0.017646074295043945
local_in_edges_tensor generation:  0.023317337036132812
mini_batch_src_global generation:  0.043050527572631836
r_  generation:  0.29813432693481445
local_output_nid generation:  0.017998456954956055
local_in_edges_tensor generation:  0.01867222785949707
mini_batch_src_global generation:  0.04578852653503418
r_  generation:  0.30959391593933105
local_output_nid generation:  0.01767873764038086
local_in_edges_tensor generation:  0.02377629280090332
mini_batch_src_global generation:  0.03798794746398926
r_  generation:  0.3071122169494629
local_output_nid generation:  0.018007993698120117
local_in_edges_tensor generation:  0.023881196975708008
mini_batch_src_global generation:  0.03878521919250488
r_  generation:  0.3067171573638916
local_output_nid generation:  0.017765283584594727
local_in_edges_tensor generation:  0.02312445640563965
mini_batch_src_global generation:  0.03814339637756348
r_  generation:  0.30909299850463867
local_output_nid generation:  0.017901897430419922
local_in_edges_tensor generation:  0.018045663833618164
mini_batch_src_global generation:  0.03857707977294922
r_  generation:  0.3069496154785156
----------------------check_connections_block total spend ----------------------------- 3.612149953842163
generate_one_block  0.3917522430419922
generate_one_block  0.39154887199401855
generate_one_block  0.3868377208709717
generate_one_block  0.40020227432250977
generate_one_block  0.39435648918151855
generate_one_block  0.40453028678894043
generate_one_block  0.3962132930755615
generate_one_block  0.3857245445251465
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030912399291992188
gen group dst list time:  0.03581833839416504
time for parepare:  0.0192415714263916
local_output_nid generation:  0.02788710594177246
local_in_edges_tensor generation:  0.04148244857788086
mini_batch_src_global generation:  0.0457606315612793
r_  generation:  0.47695064544677734
local_output_nid generation:  0.037447214126586914
local_in_edges_tensor generation:  0.04990530014038086
mini_batch_src_global generation:  0.056792259216308594
r_  generation:  0.47951579093933105
local_output_nid generation:  0.03464031219482422
local_in_edges_tensor generation:  0.03717494010925293
mini_batch_src_global generation:  0.05246591567993164
r_  generation:  0.49205660820007324
local_output_nid generation:  0.03445243835449219
local_in_edges_tensor generation:  0.04608321189880371
mini_batch_src_global generation:  0.05547499656677246
r_  generation:  0.4858694076538086
local_output_nid generation:  0.034642934799194336
local_in_edges_tensor generation:  0.035576820373535156
mini_batch_src_global generation:  0.05458831787109375
r_  generation:  0.501178503036499
local_output_nid generation:  0.03451180458068848
local_in_edges_tensor generation:  0.035809993743896484
mini_batch_src_global generation:  0.05656623840332031
r_  generation:  0.48553895950317383
local_output_nid generation:  0.034976959228515625
local_in_edges_tensor generation:  0.05055379867553711
mini_batch_src_global generation:  0.06995272636413574
r_  generation:  0.4962291717529297
local_output_nid generation:  0.03536367416381836
local_in_edges_tensor generation:  0.039835453033447266
mini_batch_src_global generation:  0.0566403865814209
r_  generation:  0.4879138469696045
----------------------check_connections_block total spend ----------------------------- 5.8589184284210205
generate_one_block  0.6078426837921143
generate_one_block  0.6265783309936523
generate_one_block  0.5988876819610596
generate_one_block  0.6138725280761719
generate_one_block  0.6114237308502197
generate_one_block  0.6114158630371094
generate_one_block  0.6373646259307861
generate_one_block  0.6101336479187012
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  9.471068382263184
block generation total time  8.068684816360474
average batch blocks generation time:  1.0085856020450592
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09652233123779297  GigaBytes
Max Memory Allocated: 0.09652233123779297  GigaBytes

torch.Size([160516, 128])
torch.Size([141396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8533935546875 GB
    Memory Allocated: 15.351329803466797  GigaBytes
Max Memory Allocated: 15.378786087036133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3221435546875 GB
    Memory Allocated: 0.09978103637695312  GigaBytes
Max Memory Allocated: 15.378786087036133  GigaBytes

torch.Size([160624, 128])
torch.Size([141377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3221435546875 GB
    Memory Allocated: 15.290152549743652  GigaBytes
Max Memory Allocated: 15.378786087036133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3221435546875 GB
    Memory Allocated: 0.09950733184814453  GigaBytes
Max Memory Allocated: 15.378786087036133  GigaBytes

torch.Size([160331, 128])
torch.Size([140722, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0350341796875 GB
    Memory Allocated: 15.238534927368164  GigaBytes
Max Memory Allocated: 15.378786087036133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0350341796875 GB
    Memory Allocated: 0.1004486083984375  GigaBytes
Max Memory Allocated: 15.378786087036133  GigaBytes

torch.Size([160888, 128])
torch.Size([141949, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0565185546875 GB
    Memory Allocated: 15.349810123443604  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.09978818893432617  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

torch.Size([160494, 128])
torch.Size([141309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.297313690185547  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.0996556282043457  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

torch.Size([160624, 128])
torch.Size([141275, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.324136734008789  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.09976053237915039  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

torch.Size([160571, 128])
torch.Size([141142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.308091163635254  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.09958314895629883  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

torch.Size([160501, 128])
torch.Size([141197, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.30601453781128  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04212695360183716 |0.05605342984199524 |0.34728148579597473 |0.0001055300235748291 |0.3435511589050293 |0.006933927536010742 |
----------------------------------------------------------pseudo_mini_loss sum 4.951530933380127
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957705
Number of first layer input nodes during this epoch:  1284549
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.13215970993041992  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024237871170043945
random selection method range initialization spend 0.006206989288330078
time for parepare:  0.01935887336730957
local_output_nid generation:  0.004858255386352539
local_in_edges_tensor generation:  0.007770061492919922
mini_batch_src_global generation:  0.003999471664428711
r_  generation:  0.03883194923400879
local_output_nid generation:  0.006653547286987305
local_in_edges_tensor generation:  0.003495454788208008
mini_batch_src_global generation:  0.004715442657470703
r_  generation:  0.04055953025817871
local_output_nid generation:  0.006754875183105469
local_in_edges_tensor generation:  0.0035080909729003906
mini_batch_src_global generation:  0.0029935836791992188
r_  generation:  0.04098224639892578
local_output_nid generation:  0.006943464279174805
local_in_edges_tensor generation:  0.003637552261352539
mini_batch_src_global generation:  0.0030984878540039062
r_  generation:  0.04230141639709473
local_output_nid generation:  0.007129192352294922
local_in_edges_tensor generation:  0.003489971160888672
mini_batch_src_global generation:  0.003342151641845703
r_  generation:  0.04247784614562988
local_output_nid generation:  0.00695037841796875
local_in_edges_tensor generation:  0.0035839080810546875
mini_batch_src_global generation:  0.0035257339477539062
r_  generation:  0.04354453086853027
local_output_nid generation:  0.007048130035400391
local_in_edges_tensor generation:  0.003596067428588867
mini_batch_src_global generation:  0.0035982131958007812
r_  generation:  0.043677330017089844
local_output_nid generation:  0.007025241851806641
local_in_edges_tensor generation:  0.0035402774810791016
mini_batch_src_global generation:  0.003631591796875
r_  generation:  0.04418587684631348
----------------------check_connections_block total spend ----------------------------- 0.5525586605072021
generate_one_block  0.0640406608581543
generate_one_block  0.062323808670043945
generate_one_block  0.061499595642089844
generate_one_block  0.061489105224609375
generate_one_block  0.06167936325073242
generate_one_block  0.062036752700805664
generate_one_block  0.0654287338256836
generate_one_block  0.06273317337036133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03818178176879883
gen group dst list time:  0.014952898025512695
time for parepare:  0.021817684173583984
local_output_nid generation:  0.013823509216308594
local_in_edges_tensor generation:  0.02701425552368164
mini_batch_src_global generation:  0.031004905700683594
r_  generation:  0.2903738021850586
local_output_nid generation:  0.019316673278808594
local_in_edges_tensor generation:  0.029226064682006836
mini_batch_src_global generation:  0.03716778755187988
r_  generation:  0.3059999942779541
local_output_nid generation:  0.018361568450927734
local_in_edges_tensor generation:  0.024501562118530273
mini_batch_src_global generation:  0.03630495071411133
r_  generation:  0.3116340637207031
local_output_nid generation:  0.018191099166870117
local_in_edges_tensor generation:  0.02072310447692871
mini_batch_src_global generation:  0.03984189033508301
r_  generation:  0.30878210067749023
local_output_nid generation:  0.020468950271606445
local_in_edges_tensor generation:  0.023500442504882812
mini_batch_src_global generation:  0.03759431838989258
r_  generation:  0.3191232681274414
local_output_nid generation:  0.01852273941040039
local_in_edges_tensor generation:  0.020969867706298828
mini_batch_src_global generation:  0.038659095764160156
r_  generation:  0.3234438896179199
local_output_nid generation:  0.018899202346801758
local_in_edges_tensor generation:  0.02969980239868164
mini_batch_src_global generation:  0.03869485855102539
r_  generation:  0.3377835750579834
local_output_nid generation:  0.021572113037109375
local_in_edges_tensor generation:  0.027597904205322266
mini_batch_src_global generation:  0.04076576232910156
r_  generation:  0.3189997673034668
----------------------check_connections_block total spend ----------------------------- 3.743069648742676
generate_one_block  0.4190208911895752
generate_one_block  0.4331793785095215
generate_one_block  0.4550650119781494
generate_one_block  0.43918275833129883
generate_one_block  0.43306779861450195
generate_one_block  0.42429542541503906
generate_one_block  0.4102480411529541
generate_one_block  0.45540857315063477
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04199099540710449
gen group dst list time:  0.037100791931152344
time for parepare:  0.019001483917236328
local_output_nid generation:  0.02928614616394043
local_in_edges_tensor generation:  0.059215545654296875
mini_batch_src_global generation:  0.05161285400390625
r_  generation:  0.47704100608825684
local_output_nid generation:  0.037413597106933594
local_in_edges_tensor generation:  0.052866220474243164
mini_batch_src_global generation:  0.059359073638916016
r_  generation:  0.508582592010498
local_output_nid generation:  0.039511680603027344
local_in_edges_tensor generation:  0.0604856014251709
mini_batch_src_global generation:  0.06307864189147949
r_  generation:  0.49219250679016113
local_output_nid generation:  0.03617238998413086
local_in_edges_tensor generation:  0.042720794677734375
mini_batch_src_global generation:  0.05626535415649414
r_  generation:  0.4906623363494873
local_output_nid generation:  0.03626441955566406
local_in_edges_tensor generation:  0.04017782211303711
mini_batch_src_global generation:  0.054567575454711914
r_  generation:  0.5089156627655029
local_output_nid generation:  0.03618335723876953
local_in_edges_tensor generation:  0.04014992713928223
mini_batch_src_global generation:  0.05667448043823242
r_  generation:  0.4950840473175049
local_output_nid generation:  0.036173343658447266
local_in_edges_tensor generation:  0.04279041290283203
mini_batch_src_global generation:  0.05613207817077637
r_  generation:  0.5132541656494141
local_output_nid generation:  0.037132978439331055
local_in_edges_tensor generation:  0.054230690002441406
mini_batch_src_global generation:  0.05935549736022949
r_  generation:  0.5097639560699463
----------------------check_connections_block total spend ----------------------------- 6.059571266174316
generate_one_block  0.634119987487793
generate_one_block  0.6342213153839111
generate_one_block  0.6301455497741699
generate_one_block  0.6315128803253174
generate_one_block  0.6353397369384766
generate_one_block  0.6321210861206055
generate_one_block  0.6348474025726318
generate_one_block  0.6344552040100098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.13215970993041992  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

connection checking time:  9.802640914916992
block generation total time  8.53623104095459
average batch blocks generation time:  1.0670288801193237
block dataloader generation time/epoch 20.491843223571777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10108470916748047  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

torch.Size([160216, 128])
torch.Size([140652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.261550903320312  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10162878036499023  GigaBytes
Max Memory Allocated: 15.379315853118896  GigaBytes

torch.Size([160563, 128])
torch.Size([141508, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.378455638885498  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.1014547348022461  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

torch.Size([160756, 128])
torch.Size([141463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.328208923339844  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10121345520019531  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

torch.Size([160454, 128])
torch.Size([141271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.284914493560791  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10124397277832031  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

torch.Size([160523, 128])
torch.Size([141177, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.279687404632568  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10131549835205078  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

torch.Size([160599, 128])
torch.Size([141363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.295161724090576  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10120773315429688  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

torch.Size([160413, 128])
torch.Size([141045, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.2912278175354  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 0.10144424438476562  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

torch.Size([160540, 128])
torch.Size([141631, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0584716796875 GB
    Memory Allocated: 15.329672813415527  GigaBytes
Max Memory Allocated: 15.408202648162842  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045139849185943604 |0.017642050981521606 |0.25624677538871765 |9.259581565856934e-05 |0.3308228850364685 |0.005919456481933594 |
----------------------------------------------------------pseudo_mini_loss sum 3.803340435028076
Total (block generation + training)time/epoch 25.725963830947876
Training time/epoch 5.233851432800293
Training time without block to device /epoch 5.09271502494812
Training time without total dataloading part /epoch 4.703217506408691
load block tensor time/epoch 0.36111879348754883
block to device time/epoch 0.14113640785217285
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2957419
Number of first layer input nodes during this epoch:  1284064
