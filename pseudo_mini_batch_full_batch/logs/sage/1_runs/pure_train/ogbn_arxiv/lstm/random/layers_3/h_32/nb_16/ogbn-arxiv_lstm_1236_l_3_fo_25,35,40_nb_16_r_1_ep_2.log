Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648453614.9513607
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02287006378173828
random selection method range initialization spend 0.005644321441650391
time for parepare:  0.019147634506225586
local_output_nid generation:  0.0020971298217773438
local_in_edges_tensor generation:  0.0037009716033935547
mini_batch_src_global generation:  0.001699209213256836
r_  generation:  0.01821732521057129
local_output_nid generation:  0.0029654502868652344
local_in_edges_tensor generation:  0.0015711784362792969
mini_batch_src_global generation:  0.002071857452392578
r_  generation:  0.01822185516357422
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.0015530586242675781
mini_batch_src_global generation:  0.001394510269165039
r_  generation:  0.018511295318603516
local_output_nid generation:  0.0029799938201904297
local_in_edges_tensor generation:  0.0015196800231933594
mini_batch_src_global generation:  0.0014164447784423828
r_  generation:  0.018890857696533203
local_output_nid generation:  0.0030565261840820312
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0014350414276123047
r_  generation:  0.018815279006958008
local_output_nid generation:  0.0029654502868652344
local_in_edges_tensor generation:  0.0014619827270507812
mini_batch_src_global generation:  0.00141143798828125
r_  generation:  0.018702030181884766
local_output_nid generation:  0.0029489994049072266
local_in_edges_tensor generation:  0.0014307498931884766
mini_batch_src_global generation:  0.0014889240264892578
r_  generation:  0.018898963928222656
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0014469623565673828
mini_batch_src_global generation:  0.0015149116516113281
r_  generation:  0.019346952438354492
local_output_nid generation:  0.0029430389404296875
local_in_edges_tensor generation:  0.0014624595642089844
mini_batch_src_global generation:  0.001470804214477539
r_  generation:  0.018856048583984375
local_output_nid generation:  0.002969026565551758
local_in_edges_tensor generation:  0.0014781951904296875
mini_batch_src_global generation:  0.0014820098876953125
r_  generation:  0.019472360610961914
local_output_nid generation:  0.002928018569946289
local_in_edges_tensor generation:  0.0014505386352539062
mini_batch_src_global generation:  0.0016019344329833984
r_  generation:  0.018941164016723633
local_output_nid generation:  0.0029761791229248047
local_in_edges_tensor generation:  0.0014390945434570312
mini_batch_src_global generation:  0.0015201568603515625
r_  generation:  0.018982887268066406
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.0014786720275878906
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.019373178482055664
local_output_nid generation:  0.0030171871185302734
local_in_edges_tensor generation:  0.0014536380767822266
mini_batch_src_global generation:  0.0014431476593017578
r_  generation:  0.01903223991394043
local_output_nid generation:  0.0029833316802978516
local_in_edges_tensor generation:  0.0014977455139160156
mini_batch_src_global generation:  0.0014634132385253906
r_  generation:  0.018889188766479492
local_output_nid generation:  0.002962350845336914
local_in_edges_tensor generation:  0.001485586166381836
mini_batch_src_global generation:  0.0014910697937011719
r_  generation:  0.018978595733642578
----------------------check_connections_block total spend ----------------------------- 0.4971468448638916
generate_one_block  0.02651500701904297
generate_one_block  0.02870941162109375
generate_one_block  0.031074047088623047
generate_one_block  0.028864383697509766
generate_one_block  0.02777242660522461
generate_one_block  0.027795076370239258
generate_one_block  0.027419567108154297
generate_one_block  0.0280306339263916
generate_one_block  0.027353286743164062
generate_one_block  0.028234243392944336
generate_one_block  0.03112339973449707
generate_one_block  0.03157520294189453
generate_one_block  0.027682781219482422
generate_one_block  0.02690410614013672
generate_one_block  0.027358531951904297
generate_one_block  0.027428865432739258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036744117736816406
gen group dst list time:  0.019002914428710938
time for parepare:  0.018877506256103516
local_output_nid generation:  0.008053064346313477
local_in_edges_tensor generation:  0.01622605323791504
mini_batch_src_global generation:  0.018250703811645508
r_  generation:  0.18523526191711426
local_output_nid generation:  0.012395143508911133
local_in_edges_tensor generation:  0.018985271453857422
mini_batch_src_global generation:  0.02358269691467285
r_  generation:  0.19572210311889648
local_output_nid generation:  0.012272357940673828
local_in_edges_tensor generation:  0.015613317489624023
mini_batch_src_global generation:  0.02312183380126953
r_  generation:  0.2045915126800537
local_output_nid generation:  0.012238264083862305
local_in_edges_tensor generation:  0.017533063888549805
mini_batch_src_global generation:  0.02587151527404785
r_  generation:  0.20578360557556152
local_output_nid generation:  0.012319564819335938
local_in_edges_tensor generation:  0.012349843978881836
mini_batch_src_global generation:  0.02512669563293457
r_  generation:  0.2057511806488037
local_output_nid generation:  0.01208639144897461
local_in_edges_tensor generation:  0.013627052307128906
mini_batch_src_global generation:  0.025227069854736328
r_  generation:  0.20521879196166992
local_output_nid generation:  0.012167692184448242
local_in_edges_tensor generation:  0.012061357498168945
mini_batch_src_global generation:  0.026780128479003906
r_  generation:  0.20361661911010742
local_output_nid generation:  0.012380361557006836
local_in_edges_tensor generation:  0.017686843872070312
mini_batch_src_global generation:  0.031023263931274414
r_  generation:  0.21022725105285645
local_output_nid generation:  0.012149810791015625
local_in_edges_tensor generation:  0.012054204940795898
mini_batch_src_global generation:  0.029120922088623047
r_  generation:  0.20795106887817383
local_output_nid generation:  0.012588262557983398
local_in_edges_tensor generation:  0.012509822845458984
mini_batch_src_global generation:  0.030360937118530273
r_  generation:  0.21381735801696777
local_output_nid generation:  0.012232065200805664
local_in_edges_tensor generation:  0.012303352355957031
mini_batch_src_global generation:  0.02731037139892578
r_  generation:  0.20696568489074707
local_output_nid generation:  0.012252092361450195
local_in_edges_tensor generation:  0.013873815536499023
mini_batch_src_global generation:  0.0260312557220459
r_  generation:  0.2077953815460205
local_output_nid generation:  0.012261152267456055
local_in_edges_tensor generation:  0.013551950454711914
mini_batch_src_global generation:  0.027737855911254883
r_  generation:  0.21244335174560547
local_output_nid generation:  0.012057065963745117
local_in_edges_tensor generation:  0.011968612670898438
mini_batch_src_global generation:  0.025963306427001953
r_  generation:  0.20266461372375488
local_output_nid generation:  0.012109041213989258
local_in_edges_tensor generation:  0.013414382934570312
mini_batch_src_global generation:  0.025774002075195312
r_  generation:  0.20900487899780273
local_output_nid generation:  0.012215852737426758
local_in_edges_tensor generation:  0.015501976013183594
mini_batch_src_global generation:  0.026190996170043945
r_  generation:  0.20938420295715332
----------------------check_connections_block total spend ----------------------------- 4.867964744567871
generate_one_block  0.2596771717071533
generate_one_block  0.260723352432251
generate_one_block  0.27092409133911133
generate_one_block  0.2786252498626709
generate_one_block  0.2775540351867676
generate_one_block  0.2598226070404053
generate_one_block  0.26279354095458984
generate_one_block  0.27753210067749023
generate_one_block  0.26126599311828613
generate_one_block  0.2752242088317871
generate_one_block  0.2695958614349365
generate_one_block  0.26501989364624023
generate_one_block  0.2688143253326416
generate_one_block  0.26224684715270996
generate_one_block  0.26974916458129883
generate_one_block  0.2669668197631836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0348508358001709
gen group dst list time:  0.059439659118652344
time for parepare:  0.01873016357421875
local_output_nid generation:  0.024999618530273438
local_in_edges_tensor generation:  0.04238414764404297
mini_batch_src_global generation:  0.03998970985412598
r_  generation:  0.44984006881713867
local_output_nid generation:  0.031061887741088867
local_in_edges_tensor generation:  0.04476523399353027
mini_batch_src_global generation:  0.053574323654174805
r_  generation:  0.43805766105651855
local_output_nid generation:  0.030327558517456055
local_in_edges_tensor generation:  0.04203534126281738
mini_batch_src_global generation:  0.05235791206359863
r_  generation:  0.44467759132385254
local_output_nid generation:  0.0304718017578125
local_in_edges_tensor generation:  0.03759407997131348
mini_batch_src_global generation:  0.05170297622680664
r_  generation:  0.450272798538208
local_output_nid generation:  0.030764341354370117
local_in_edges_tensor generation:  0.03295397758483887
mini_batch_src_global generation:  0.0675652027130127
r_  generation:  0.5217065811157227
local_output_nid generation:  0.03676724433898926
local_in_edges_tensor generation:  0.04588961601257324
mini_batch_src_global generation:  0.06230282783508301
r_  generation:  0.4531393051147461
local_output_nid generation:  0.03196835517883301
local_in_edges_tensor generation:  0.04129290580749512
mini_batch_src_global generation:  0.05406379699707031
r_  generation:  0.4758448600769043
local_output_nid generation:  0.03264451026916504
local_in_edges_tensor generation:  0.040781497955322266
mini_batch_src_global generation:  0.05540108680725098
r_  generation:  0.48138928413391113
local_output_nid generation:  0.03295087814331055
local_in_edges_tensor generation:  0.0452725887298584
mini_batch_src_global generation:  0.0633399486541748
r_  generation:  0.46048760414123535
local_output_nid generation:  0.03302764892578125
local_in_edges_tensor generation:  0.038039207458496094
mini_batch_src_global generation:  0.057787418365478516
r_  generation:  0.4702460765838623
local_output_nid generation:  0.03215742111206055
local_in_edges_tensor generation:  0.033506155014038086
mini_batch_src_global generation:  0.0585942268371582
r_  generation:  0.4668610095977783
local_output_nid generation:  0.03323054313659668
local_in_edges_tensor generation:  0.03169536590576172
mini_batch_src_global generation:  0.05424237251281738
r_  generation:  0.4658780097961426
local_output_nid generation:  0.03258991241455078
local_in_edges_tensor generation:  0.04185819625854492
mini_batch_src_global generation:  0.05728602409362793
r_  generation:  0.47124218940734863
local_output_nid generation:  0.033689260482788086
local_in_edges_tensor generation:  0.03367900848388672
mini_batch_src_global generation:  0.0535736083984375
r_  generation:  0.4524357318878174
local_output_nid generation:  0.03242063522338867
local_in_edges_tensor generation:  0.03260684013366699
mini_batch_src_global generation:  0.05130290985107422
r_  generation:  0.46829938888549805
local_output_nid generation:  0.03168606758117676
local_in_edges_tensor generation:  0.04128694534301758
mini_batch_src_global generation:  0.05236196517944336
r_  generation:  0.4502279758453369
----------------------check_connections_block total spend ----------------------------- 11.051543235778809
generate_one_block  0.5810225009918213
generate_one_block  0.5708949565887451
generate_one_block  0.58980393409729
generate_one_block  0.5809581279754639
generate_one_block  0.615229606628418
generate_one_block  0.5918447971343994
generate_one_block  0.6328263282775879
generate_one_block  0.61903977394104
generate_one_block  0.5984728336334229
generate_one_block  0.5866353511810303
generate_one_block  0.58121657371521
generate_one_block  0.5712296962738037
generate_one_block  0.6000995635986328
generate_one_block  0.5828464031219482
generate_one_block  0.5815062522888184
generate_one_block  0.5932104587554932
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  15.91950798034668
block generation total time  13.763372421264648
average batch blocks generation time:  0.8602107763290405
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09027719497680664  GigaBytes
Max Memory Allocated: 0.09027719497680664  GigaBytes

torch.Size([154271, 128])
torch.Size([122069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4901123046875 GB
    Memory Allocated: 11.839380741119385  GigaBytes
Max Memory Allocated: 11.845441341400146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4979248046875 GB
    Memory Allocated: 0.0912160873413086  GigaBytes
Max Memory Allocated: 11.845441341400146  GigaBytes

torch.Size([154384, 128])
torch.Size([122654, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1834716796875 GB
    Memory Allocated: 11.885948657989502  GigaBytes
Max Memory Allocated: 11.892982959747314  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1834716796875 GB
    Memory Allocated: 0.09192371368408203  GigaBytes
Max Memory Allocated: 11.892982959747314  GigaBytes

torch.Size([154332, 128])
torch.Size([122488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1990966796875 GB
    Memory Allocated: 11.931337356567383  GigaBytes
Max Memory Allocated: 11.938472747802734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1990966796875 GB
    Memory Allocated: 0.09148550033569336  GigaBytes
Max Memory Allocated: 11.938472747802734  GigaBytes

torch.Size([154569, 128])
torch.Size([123007, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 11.955618858337402  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 0.09187126159667969  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

torch.Size([154460, 128])
torch.Size([122611, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 11.892982482910156  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 0.0911870002746582  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

torch.Size([154439, 128])
torch.Size([122216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 11.849666118621826  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 0.09176349639892578  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

torch.Size([154164, 128])
torch.Size([122028, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 11.844271659851074  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8787841796875 GB
    Memory Allocated: 0.09164762496948242  GigaBytes
Max Memory Allocated: 11.962789535522461  GigaBytes

torch.Size([154793, 128])
torch.Size([123375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 12.010591506958008  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09181976318359375  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154562, 128])
torch.Size([122359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.887763977050781  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09151506423950195  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154605, 128])
torch.Size([122593, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.933382987976074  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09188652038574219  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154624, 128])
torch.Size([122666, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.915581226348877  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09124088287353516  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154404, 128])
torch.Size([122268, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.862077236175537  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09189987182617188  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154681, 128])
torch.Size([122829, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.947216033935547  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09112358093261719  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154432, 128])
torch.Size([121714, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.824342727661133  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09177684783935547  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154649, 128])
torch.Size([122556, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.868935108184814  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09124898910522461  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154399, 128])
torch.Size([122069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.88430118560791  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03885737061500549 |0.03794991970062256 |0.2846997231245041 |0.00010165572166442871 |0.3219098001718521 |0.00854182243347168 |
----------------------------------------------------------pseudo_mini_loss sum 4.3963141441345215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5092810
Number of first layer input nodes during this epoch:  2471768
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.11538553237915039  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022877216339111328
random selection method range initialization spend 0.005858659744262695
time for parepare:  0.019123554229736328
local_output_nid generation:  0.0026650428771972656
local_in_edges_tensor generation:  0.008633136749267578
mini_batch_src_global generation:  0.0018754005432128906
r_  generation:  0.017855405807495117
local_output_nid generation:  0.0035898685455322266
local_in_edges_tensor generation:  0.0017616748809814453
mini_batch_src_global generation:  0.0021581649780273438
r_  generation:  0.01830744743347168
local_output_nid generation:  0.0036444664001464844
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.0013561248779296875
r_  generation:  0.01836991310119629
local_output_nid generation:  0.003559112548828125
local_in_edges_tensor generation:  0.0016732215881347656
mini_batch_src_global generation:  0.0013935565948486328
r_  generation:  0.01850748062133789
local_output_nid generation:  0.0036454200744628906
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.0014190673828125
r_  generation:  0.0188291072845459
local_output_nid generation:  0.0036344528198242188
local_in_edges_tensor generation:  0.0016705989837646484
mini_batch_src_global generation:  0.0014748573303222656
r_  generation:  0.018958330154418945
local_output_nid generation:  0.0037369728088378906
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.0015141963958740234
r_  generation:  0.019951820373535156
local_output_nid generation:  0.0037429332733154297
local_in_edges_tensor generation:  0.0017240047454833984
mini_batch_src_global generation:  0.0015041828155517578
r_  generation:  0.019398927688598633
local_output_nid generation:  0.003701925277709961
local_in_edges_tensor generation:  0.0016994476318359375
mini_batch_src_global generation:  0.0015606880187988281
r_  generation:  0.01952981948852539
local_output_nid generation:  0.003641843795776367
local_in_edges_tensor generation:  0.0016760826110839844
mini_batch_src_global generation:  0.001505136489868164
r_  generation:  0.01945638656616211
local_output_nid generation:  0.0036873817443847656
local_in_edges_tensor generation:  0.001634359359741211
mini_batch_src_global generation:  0.0015745162963867188
r_  generation:  0.020765066146850586
local_output_nid generation:  0.0037200450897216797
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.0016124248504638672
r_  generation:  0.020926952362060547
local_output_nid generation:  0.003721475601196289
local_in_edges_tensor generation:  0.0017087459564208984
mini_batch_src_global generation:  0.0015685558319091797
r_  generation:  0.019547700881958008
local_output_nid generation:  0.0037059783935546875
local_in_edges_tensor generation:  0.0016326904296875
mini_batch_src_global generation:  0.001542806625366211
r_  generation:  0.019873619079589844
local_output_nid generation:  0.0037152767181396484
local_in_edges_tensor generation:  0.001886129379272461
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.019637346267700195
local_output_nid generation:  0.003737926483154297
local_in_edges_tensor generation:  0.0016741752624511719
mini_batch_src_global generation:  0.001585245132446289
r_  generation:  0.02232527732849121
----------------------check_connections_block total spend ----------------------------- 0.5320982933044434
generate_one_block  0.03564286231994629
generate_one_block  0.031140565872192383
generate_one_block  0.03013753890991211
generate_one_block  0.030476808547973633
generate_one_block  0.03107428550720215
generate_one_block  0.033272743225097656
generate_one_block  0.032267093658447266
generate_one_block  0.031627655029296875
generate_one_block  0.031482696533203125
generate_one_block  0.030682086944580078
generate_one_block  0.034429073333740234
generate_one_block  0.04210805892944336
generate_one_block  0.030649423599243164
generate_one_block  0.03077220916748047
generate_one_block  0.030827760696411133
generate_one_block  0.031853675842285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04322528839111328
gen group dst list time:  0.019232749938964844
time for parepare:  0.02083420753479004
local_output_nid generation:  0.01066446304321289
local_in_edges_tensor generation:  0.024370193481445312
mini_batch_src_global generation:  0.018283605575561523
r_  generation:  0.19575881958007812
local_output_nid generation:  0.015453577041625977
local_in_edges_tensor generation:  0.023983240127563477
mini_batch_src_global generation:  0.024622678756713867
r_  generation:  0.20684003829956055
local_output_nid generation:  0.015895366668701172
local_in_edges_tensor generation:  0.016603946685791016
mini_batch_src_global generation:  0.022625446319580078
r_  generation:  0.20446562767028809
local_output_nid generation:  0.015684843063354492
local_in_edges_tensor generation:  0.01769399642944336
mini_batch_src_global generation:  0.02548956871032715
r_  generation:  0.2086632251739502
local_output_nid generation:  0.015117883682250977
local_in_edges_tensor generation:  0.015990495681762695
mini_batch_src_global generation:  0.026581525802612305
r_  generation:  0.21165871620178223
local_output_nid generation:  0.014973878860473633
local_in_edges_tensor generation:  0.014163017272949219
mini_batch_src_global generation:  0.02587580680847168
r_  generation:  0.21263694763183594
local_output_nid generation:  0.014853715896606445
local_in_edges_tensor generation:  0.014740228652954102
mini_batch_src_global generation:  0.029652118682861328
r_  generation:  0.21563148498535156
local_output_nid generation:  0.014864921569824219
local_in_edges_tensor generation:  0.01450800895690918
mini_batch_src_global generation:  0.026072263717651367
r_  generation:  0.2097787857055664
local_output_nid generation:  0.014880180358886719
local_in_edges_tensor generation:  0.017802000045776367
mini_batch_src_global generation:  0.025872468948364258
r_  generation:  0.22534656524658203
local_output_nid generation:  0.014858007431030273
local_in_edges_tensor generation:  0.01589369773864746
mini_batch_src_global generation:  0.026227951049804688
r_  generation:  0.21145129203796387
local_output_nid generation:  0.01500558853149414
local_in_edges_tensor generation:  0.0177764892578125
mini_batch_src_global generation:  0.027746200561523438
r_  generation:  0.21631932258605957
local_output_nid generation:  0.015317440032958984
local_in_edges_tensor generation:  0.019927501678466797
mini_batch_src_global generation:  0.027149438858032227
r_  generation:  0.22216105461120605
local_output_nid generation:  0.015081405639648438
local_in_edges_tensor generation:  0.014097213745117188
mini_batch_src_global generation:  0.026800870895385742
r_  generation:  0.2145862579345703
local_output_nid generation:  0.014943122863769531
local_in_edges_tensor generation:  0.013863086700439453
mini_batch_src_global generation:  0.02857804298400879
r_  generation:  0.22127437591552734
local_output_nid generation:  0.014930486679077148
local_in_edges_tensor generation:  0.021021127700805664
mini_batch_src_global generation:  0.028290271759033203
r_  generation:  0.21510815620422363
local_output_nid generation:  0.019227027893066406
local_in_edges_tensor generation:  0.022141218185424805
mini_batch_src_global generation:  0.030414819717407227
r_  generation:  0.22946381568908691
----------------------check_connections_block total spend ----------------------------- 5.140966176986694
generate_one_block  0.2927885055541992
generate_one_block  0.2783365249633789
generate_one_block  0.2703988552093506
generate_one_block  0.27790260314941406
generate_one_block  0.28816914558410645
generate_one_block  0.276836633682251
generate_one_block  0.3050367832183838
generate_one_block  0.269744873046875
generate_one_block  0.280686616897583
generate_one_block  0.2980341911315918
generate_one_block  0.3017158508300781
generate_one_block  0.29645323753356934
generate_one_block  0.27659177780151367
generate_one_block  0.27176332473754883
generate_one_block  0.28290843963623047
generate_one_block  0.28482913970947266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0744333267211914
gen group dst list time:  0.06685400009155273
time for parepare:  0.01887369155883789
local_output_nid generation:  0.027474403381347656
local_in_edges_tensor generation:  0.05195164680480957
mini_batch_src_global generation:  0.04396533966064453
r_  generation:  0.44095563888549805
local_output_nid generation:  0.0345919132232666
local_in_edges_tensor generation:  0.047054290771484375
mini_batch_src_global generation:  0.05029869079589844
r_  generation:  0.4506227970123291
local_output_nid generation:  0.03202176094055176
local_in_edges_tensor generation:  0.03550148010253906
mini_batch_src_global generation:  0.05072617530822754
r_  generation:  0.45443248748779297
local_output_nid generation:  0.03177237510681152
local_in_edges_tensor generation:  0.04318547248840332
mini_batch_src_global generation:  0.05213785171508789
r_  generation:  0.4638652801513672
local_output_nid generation:  0.03352642059326172
local_in_edges_tensor generation:  0.10216593742370605
mini_batch_src_global generation:  0.06266951560974121
r_  generation:  0.46404504776000977
local_output_nid generation:  0.033097267150878906
local_in_edges_tensor generation:  0.039981842041015625
mini_batch_src_global generation:  0.05260467529296875
r_  generation:  0.4545629024505615
local_output_nid generation:  0.032410383224487305
local_in_edges_tensor generation:  0.033987998962402344
mini_batch_src_global generation:  0.05224323272705078
r_  generation:  0.46250200271606445
local_output_nid generation:  0.03255105018615723
local_in_edges_tensor generation:  0.03509068489074707
mini_batch_src_global generation:  0.05289602279663086
r_  generation:  0.4579465389251709
local_output_nid generation:  0.03293180465698242
local_in_edges_tensor generation:  0.03526449203491211
mini_batch_src_global generation:  0.05530047416687012
r_  generation:  0.4729487895965576
local_output_nid generation:  0.03247880935668945
local_in_edges_tensor generation:  0.034598588943481445
mini_batch_src_global generation:  0.052727699279785156
r_  generation:  0.46007251739501953
local_output_nid generation:  0.032704830169677734
local_in_edges_tensor generation:  0.03910374641418457
mini_batch_src_global generation:  0.05130481719970703
r_  generation:  0.4639122486114502
local_output_nid generation:  0.03273177146911621
local_in_edges_tensor generation:  0.03980445861816406
mini_batch_src_global generation:  0.054358482360839844
r_  generation:  0.4650416374206543
local_output_nid generation:  0.03245210647583008
local_in_edges_tensor generation:  0.04649472236633301
mini_batch_src_global generation:  0.0520777702331543
r_  generation:  0.46043872833251953
local_output_nid generation:  0.03262138366699219
local_in_edges_tensor generation:  0.028931140899658203
mini_batch_src_global generation:  0.05205583572387695
r_  generation:  0.4567842483520508
local_output_nid generation:  0.032592058181762695
local_in_edges_tensor generation:  0.02879023551940918
mini_batch_src_global generation:  0.05188727378845215
r_  generation:  0.46356630325317383
local_output_nid generation:  0.03268718719482422
local_in_edges_tensor generation:  0.03268742561340332
mini_batch_src_global generation:  0.05211663246154785
r_  generation:  0.46053338050842285
----------------------check_connections_block total spend ----------------------------- 10.989241600036621
generate_one_block  0.6296823024749756
generate_one_block  0.5996806621551514
generate_one_block  0.5872738361358643
generate_one_block  0.5953116416931152
generate_one_block  0.593327522277832
generate_one_block  0.5920708179473877
generate_one_block  0.5948684215545654
generate_one_block  0.5953032970428467
generate_one_block  0.6256358623504639
generate_one_block  0.593867301940918
generate_one_block  0.594801664352417
generate_one_block  0.5966932773590088
generate_one_block  0.6004171371459961
generate_one_block  0.5812737941741943
generate_one_block  0.5940976142883301
generate_one_block  0.5877995491027832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.11538553237915039  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

connection checking time:  16.130207777023315
block generation total time  14.114301204681396
average batch blocks generation time:  0.8821438252925873
block dataloader generation time/epoch 32.69827437400818
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09294271469116211  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154121, 128])
torch.Size([122101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.844380378723145  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09238386154174805  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154477, 128])
torch.Size([122058, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.824523448944092  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.0928792953491211  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154318, 128])
torch.Size([122064, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.836399555206299  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09265756607055664  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154797, 128])
torch.Size([122946, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.91642141342163  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09309005737304688  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154386, 128])
torch.Size([122274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.89765977859497  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09238767623901367  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154239, 128])
torch.Size([122274, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.910755157470703  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09306144714355469  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([153851, 128])
torch.Size([121711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.890211582183838  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09233331680297852  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154275, 128])
torch.Size([122185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.882700443267822  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09307670593261719  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154492, 128])
torch.Size([122473, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.915190696716309  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09236717224121094  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154310, 128])
torch.Size([122392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 11.894785404205322  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5584716796875 GB
    Memory Allocated: 0.09322643280029297  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154478, 128])
torch.Size([122787, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5604248046875 GB
    Memory Allocated: 11.984640121459961  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5604248046875 GB
    Memory Allocated: 0.09278488159179688  GigaBytes
Max Memory Allocated: 12.017725467681885  GigaBytes

torch.Size([154566, 128])
torch.Size([123339, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 12.0136137008667  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 0.0930624008178711  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

torch.Size([154452, 128])
torch.Size([122858, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 11.930553913116455  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 0.09246635437011719  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

torch.Size([154534, 128])
torch.Size([122273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 11.862529277801514  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 0.09310245513916016  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

torch.Size([154413, 128])
torch.Size([122175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 11.886520862579346  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 0.09223318099975586  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

torch.Size([153883, 128])
torch.Size([122024, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5721435546875 GB
    Memory Allocated: 11.880518913269043  GigaBytes
Max Memory Allocated: 12.020908832550049  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03874202072620392 |0.01539100706577301 |0.24600957334041595 |9.666383266448975e-05 |0.31834639608860016 |0.0060176849365234375 |
----------------------------------------------------------pseudo_mini_loss sum 3.7037484645843506
Total (block generation + training)time/epoch 42.63306427001953
Training time/epoch 9.934529781341553
Training time without block to device /epoch 9.688273668289185
Training time without total dataloading part /epoch 9.037259817123413
load block tensor time/epoch 0.6198723316192627
block to device time/epoch 0.24625611305236816
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5088356
Number of first layer input nodes during this epoch:  2469592
