Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648465032.5052872
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025931835174560547
random selection method range initialization spend 0.0057544708251953125
time for parepare:  0.01975250244140625
local_output_nid generation:  0.0012078285217285156
local_in_edges_tensor generation:  0.003255128860473633
mini_batch_src_global generation:  0.0017032623291015625
r_  generation:  0.011168718338012695
local_output_nid generation:  0.001468658447265625
local_in_edges_tensor generation:  0.0010044574737548828
mini_batch_src_global generation:  0.0017139911651611328
r_  generation:  0.009877681732177734
local_output_nid generation:  0.0015194416046142578
local_in_edges_tensor generation:  0.0008637905120849609
mini_batch_src_global generation:  0.0011243820190429688
r_  generation:  0.009060144424438477
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0010135173797607422
r_  generation:  0.00910329818725586
local_output_nid generation:  0.0014798641204833984
local_in_edges_tensor generation:  0.0008096694946289062
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.009209632873535156
local_output_nid generation:  0.0014925003051757812
local_in_edges_tensor generation:  0.0007846355438232422
mini_batch_src_global generation:  0.0010120868682861328
r_  generation:  0.009796857833862305
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0007860660552978516
mini_batch_src_global generation:  0.0010523796081542969
r_  generation:  0.009759902954101562
local_output_nid generation:  0.001474618911743164
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.010064363479614258
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0007829666137695312
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.009781360626220703
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0007886886596679688
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.00972294807434082
local_output_nid generation:  0.0014903545379638672
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0010497570037841797
r_  generation:  0.010174989700317383
local_output_nid generation:  0.0015039443969726562
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.009964942932128906
local_output_nid generation:  0.0015120506286621094
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0009903907775878906
r_  generation:  0.009712457656860352
local_output_nid generation:  0.0014841556549072266
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0010192394256591797
r_  generation:  0.009929656982421875
local_output_nid generation:  0.0014727115631103516
local_in_edges_tensor generation:  0.0007677078247070312
mini_batch_src_global generation:  0.0010149478912353516
r_  generation:  0.010062932968139648
local_output_nid generation:  0.001485586166381836
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0010559558868408203
r_  generation:  0.009692907333374023
local_output_nid generation:  0.001493215560913086
local_in_edges_tensor generation:  0.0007753372192382812
mini_batch_src_global generation:  0.0010554790496826172
r_  generation:  0.010523796081542969
local_output_nid generation:  0.0015549659729003906
local_in_edges_tensor generation:  0.0007841587066650391
mini_batch_src_global generation:  0.0010383129119873047
r_  generation:  0.009876251220703125
local_output_nid generation:  0.0014948844909667969
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.01002955436706543
local_output_nid generation:  0.0015101432800292969
local_in_edges_tensor generation:  0.0007593631744384766
mini_batch_src_global generation:  0.0010232925415039062
r_  generation:  0.009752988815307617
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.009943723678588867
local_output_nid generation:  0.0014832019805908203
local_in_edges_tensor generation:  0.0007669925689697266
mini_batch_src_global generation:  0.0010199546813964844
r_  generation:  0.009997844696044922
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0007653236389160156
mini_batch_src_global generation:  0.0010981559753417969
r_  generation:  0.010486841201782227
local_output_nid generation:  0.0014874935150146484
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0010867118835449219
r_  generation:  0.010598182678222656
local_output_nid generation:  0.0015103816986083984
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0011141300201416016
r_  generation:  0.01034998893737793
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0007696151733398438
mini_batch_src_global generation:  0.0011246204376220703
r_  generation:  0.010041236877441406
local_output_nid generation:  0.0014891624450683594
local_in_edges_tensor generation:  0.0007717609405517578
mini_batch_src_global generation:  0.0010144710540771484
r_  generation:  0.009771347045898438
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0007922649383544922
mini_batch_src_global generation:  0.0010828971862792969
r_  generation:  0.010423660278320312
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.000782012939453125
mini_batch_src_global generation:  0.0010986328125
r_  generation:  0.010559558868408203
local_output_nid generation:  0.0014843940734863281
local_in_edges_tensor generation:  0.005795001983642578
mini_batch_src_global generation:  0.0012662410736083984
r_  generation:  0.010208845138549805
local_output_nid generation:  0.0013761520385742188
local_in_edges_tensor generation:  0.0008139610290527344
mini_batch_src_global generation:  0.0011055469512939453
r_  generation:  0.009801387786865234
local_output_nid generation:  0.0014126300811767578
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.009886980056762695
----------------------check_connections_block total spend ----------------------------- 0.5431709289550781
generate_one_block  0.016127824783325195
generate_one_block  0.01576828956604004
generate_one_block  0.014294624328613281
generate_one_block  0.014329910278320312
generate_one_block  0.014597415924072266
generate_one_block  0.015050649642944336
generate_one_block  0.014916658401489258
generate_one_block  0.015131235122680664
generate_one_block  0.014829158782958984
generate_one_block  0.015019416809082031
generate_one_block  0.015185832977294922
generate_one_block  0.014690876007080078
generate_one_block  0.014378070831298828
generate_one_block  0.014721393585205078
generate_one_block  0.014704227447509766
generate_one_block  0.0140838623046875
generate_one_block  0.015227556228637695
generate_one_block  0.014571189880371094
generate_one_block  0.014864444732666016
generate_one_block  0.014386653900146484
generate_one_block  0.014759302139282227
generate_one_block  0.01463007926940918
generate_one_block  0.015405654907226562
generate_one_block  0.015090703964233398
generate_one_block  0.015100479125976562
generate_one_block  0.014826297760009766
generate_one_block  0.014179706573486328
generate_one_block  0.01549673080444336
generate_one_block  0.015876293182373047
generate_one_block  0.014742612838745117
generate_one_block  0.014354228973388672
generate_one_block  0.014672517776489258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.041669368743896484
gen group dst list time:  0.023944854736328125
time for parepare:  0.01904439926147461
local_output_nid generation:  0.005454301834106445
local_in_edges_tensor generation:  0.01325535774230957
mini_batch_src_global generation:  0.018628358840942383
r_  generation:  0.16444087028503418
local_output_nid generation:  0.008640050888061523
local_in_edges_tensor generation:  0.015778064727783203
mini_batch_src_global generation:  0.021965980529785156
r_  generation:  0.17615604400634766
local_output_nid generation:  0.007865667343139648
local_in_edges_tensor generation:  0.01010441780090332
mini_batch_src_global generation:  0.019182682037353516
r_  generation:  0.16916370391845703
local_output_nid generation:  0.007868766784667969
local_in_edges_tensor generation:  0.01467752456665039
mini_batch_src_global generation:  0.021019458770751953
r_  generation:  0.17107391357421875
local_output_nid generation:  0.007963180541992188
local_in_edges_tensor generation:  0.0088348388671875
mini_batch_src_global generation:  0.022101402282714844
r_  generation:  0.1752181053161621
local_output_nid generation:  0.009093999862670898
local_in_edges_tensor generation:  0.012387275695800781
mini_batch_src_global generation:  0.02373361587524414
r_  generation:  0.19547295570373535
local_output_nid generation:  0.010507345199584961
local_in_edges_tensor generation:  0.01756143569946289
mini_batch_src_global generation:  0.02469015121459961
r_  generation:  0.17834138870239258
local_output_nid generation:  0.008503913879394531
local_in_edges_tensor generation:  0.01109457015991211
mini_batch_src_global generation:  0.022844552993774414
r_  generation:  0.18081355094909668
local_output_nid generation:  0.008401155471801758
local_in_edges_tensor generation:  0.012178897857666016
mini_batch_src_global generation:  0.02256035804748535
r_  generation:  0.17843222618103027
local_output_nid generation:  0.008327722549438477
local_in_edges_tensor generation:  0.01046133041381836
mini_batch_src_global generation:  0.022469043731689453
r_  generation:  0.17740535736083984
local_output_nid generation:  0.008512258529663086
local_in_edges_tensor generation:  0.010545730590820312
mini_batch_src_global generation:  0.024257421493530273
r_  generation:  0.1846928596496582
local_output_nid generation:  0.00824594497680664
local_in_edges_tensor generation:  0.010409832000732422
mini_batch_src_global generation:  0.0229794979095459
r_  generation:  0.1783614158630371
local_output_nid generation:  0.008147478103637695
local_in_edges_tensor generation:  0.00880122184753418
mini_batch_src_global generation:  0.02236461639404297
r_  generation:  0.17684102058410645
local_output_nid generation:  0.008259296417236328
local_in_edges_tensor generation:  0.008939743041992188
mini_batch_src_global generation:  0.022707462310791016
r_  generation:  0.18193888664245605
local_output_nid generation:  0.008289337158203125
local_in_edges_tensor generation:  0.012066841125488281
mini_batch_src_global generation:  0.026328086853027344
r_  generation:  0.1822960376739502
local_output_nid generation:  0.00797724723815918
local_in_edges_tensor generation:  0.009252548217773438
mini_batch_src_global generation:  0.021749019622802734
r_  generation:  0.1724097728729248
local_output_nid generation:  0.008475065231323242
local_in_edges_tensor generation:  0.013813495635986328
mini_batch_src_global generation:  0.022855043411254883
r_  generation:  0.18640851974487305
local_output_nid generation:  0.008213520050048828
local_in_edges_tensor generation:  0.010254144668579102
mini_batch_src_global generation:  0.026014328002929688
r_  generation:  0.18179082870483398
local_output_nid generation:  0.008349180221557617
local_in_edges_tensor generation:  0.009133100509643555
mini_batch_src_global generation:  0.02442765235900879
r_  generation:  0.1813206672668457
local_output_nid generation:  0.008267879486083984
local_in_edges_tensor generation:  0.008836984634399414
mini_batch_src_global generation:  0.02481555938720703
r_  generation:  0.1785411834716797
local_output_nid generation:  0.008274555206298828
local_in_edges_tensor generation:  0.010343790054321289
mini_batch_src_global generation:  0.024097919464111328
r_  generation:  0.18093633651733398
local_output_nid generation:  0.009016036987304688
local_in_edges_tensor generation:  0.01203012466430664
mini_batch_src_global generation:  0.02300882339477539
r_  generation:  0.17890715599060059
local_output_nid generation:  0.008511543273925781
local_in_edges_tensor generation:  0.010526895523071289
mini_batch_src_global generation:  0.023320436477661133
r_  generation:  0.1821730136871338
local_output_nid generation:  0.008466005325317383
local_in_edges_tensor generation:  0.010590314865112305
mini_batch_src_global generation:  0.024549007415771484
r_  generation:  0.18233418464660645
local_output_nid generation:  0.008512258529663086
local_in_edges_tensor generation:  0.010662317276000977
mini_batch_src_global generation:  0.024834394454956055
r_  generation:  0.18498492240905762
local_output_nid generation:  0.008337020874023438
local_in_edges_tensor generation:  0.00878763198852539
mini_batch_src_global generation:  0.023221254348754883
r_  generation:  0.1813819408416748
local_output_nid generation:  0.008047103881835938
local_in_edges_tensor generation:  0.00853586196899414
mini_batch_src_global generation:  0.022079944610595703
r_  generation:  0.17127537727355957
local_output_nid generation:  0.00851130485534668
local_in_edges_tensor generation:  0.008922576904296875
mini_batch_src_global generation:  0.022983789443969727
r_  generation:  0.18219900131225586
local_output_nid generation:  0.008652210235595703
local_in_edges_tensor generation:  0.013741493225097656
mini_batch_src_global generation:  0.023491859436035156
r_  generation:  0.18508625030517578
local_output_nid generation:  0.008194208145141602
local_in_edges_tensor generation:  0.010457515716552734
mini_batch_src_global generation:  0.022995471954345703
r_  generation:  0.17795705795288086
local_output_nid generation:  0.008101701736450195
local_in_edges_tensor generation:  0.008742094039916992
mini_batch_src_global generation:  0.022362947463989258
r_  generation:  0.17473196983337402
local_output_nid generation:  0.008212089538574219
local_in_edges_tensor generation:  0.008922100067138672
mini_batch_src_global generation:  0.02408766746520996
r_  generation:  0.18219614028930664
----------------------check_connections_block total spend ----------------------------- 8.395215034484863
generate_one_block  0.24219655990600586
generate_one_block  0.24110889434814453
generate_one_block  0.23762774467468262
generate_one_block  0.23427486419677734
generate_one_block  0.2243671417236328
generate_one_block  0.23148036003112793
generate_one_block  0.22752928733825684
generate_one_block  0.23074769973754883
generate_one_block  0.2303001880645752
generate_one_block  0.22313284873962402
generate_one_block  0.23668551445007324
generate_one_block  0.22925853729248047
generate_one_block  0.22416329383850098
generate_one_block  0.2292497158050537
generate_one_block  0.2308027744293213
generate_one_block  0.2424180507659912
generate_one_block  0.23235559463500977
generate_one_block  0.22974419593811035
generate_one_block  0.2307450771331787
generate_one_block  0.22081756591796875
generate_one_block  0.22869396209716797
generate_one_block  0.26017332077026367
generate_one_block  0.23552465438842773
generate_one_block  0.23755979537963867
generate_one_block  0.23621773719787598
generate_one_block  0.2311718463897705
generate_one_block  0.22010493278503418
generate_one_block  0.23643159866333008
generate_one_block  0.24059486389160156
generate_one_block  0.22390961647033691
generate_one_block  0.2182457447052002
generate_one_block  0.2278916835784912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05738687515258789
gen group dst list time:  0.13466095924377441
time for parepare:  0.020760774612426758
local_output_nid generation:  0.023516178131103516
local_in_edges_tensor generation:  0.06395101547241211
mini_batch_src_global generation:  0.05211019515991211
r_  generation:  0.4759795665740967
local_output_nid generation:  0.029866456985473633
local_in_edges_tensor generation:  0.04934883117675781
mini_batch_src_global generation:  0.0579380989074707
r_  generation:  0.4854462146759033
local_output_nid generation:  0.029534101486206055
local_in_edges_tensor generation:  0.03547787666320801
mini_batch_src_global generation:  0.05624890327453613
r_  generation:  0.4886665344238281
local_output_nid generation:  0.028255701065063477
local_in_edges_tensor generation:  0.029716968536376953
mini_batch_src_global generation:  0.05804848670959473
r_  generation:  0.5167438983917236
local_output_nid generation:  0.029088735580444336
local_in_edges_tensor generation:  0.04206991195678711
mini_batch_src_global generation:  0.059929847717285156
r_  generation:  0.5229637622833252
local_output_nid generation:  0.031000375747680664
local_in_edges_tensor generation:  0.04360556602478027
mini_batch_src_global generation:  0.061385154724121094
r_  generation:  0.4920938014984131
local_output_nid generation:  0.029093265533447266
local_in_edges_tensor generation:  0.04438424110412598
mini_batch_src_global generation:  0.057805538177490234
r_  generation:  0.4963710308074951
local_output_nid generation:  0.02932119369506836
local_in_edges_tensor generation:  0.03436684608459473
mini_batch_src_global generation:  0.06268692016601562
r_  generation:  0.4968986511230469
local_output_nid generation:  0.02928757667541504
local_in_edges_tensor generation:  0.03908944129943848
mini_batch_src_global generation:  0.05835604667663574
r_  generation:  0.5039513111114502
local_output_nid generation:  0.029062509536743164
local_in_edges_tensor generation:  0.030358552932739258
mini_batch_src_global generation:  0.05997037887573242
r_  generation:  0.5134003162384033
local_output_nid generation:  0.029183626174926758
local_in_edges_tensor generation:  0.029909372329711914
mini_batch_src_global generation:  0.06041121482849121
r_  generation:  0.5033061504364014
local_output_nid generation:  0.035265445709228516
local_in_edges_tensor generation:  0.05182003974914551
mini_batch_src_global generation:  0.07267236709594727
r_  generation:  0.5023634433746338
local_output_nid generation:  0.029764175415039062
local_in_edges_tensor generation:  0.03462529182434082
mini_batch_src_global generation:  0.0586094856262207
r_  generation:  0.49672746658325195
local_output_nid generation:  0.029090404510498047
local_in_edges_tensor generation:  0.03302168846130371
mini_batch_src_global generation:  0.062493085861206055
r_  generation:  0.5013368129730225
local_output_nid generation:  0.029220104217529297
local_in_edges_tensor generation:  0.03293299674987793
mini_batch_src_global generation:  0.05919337272644043
r_  generation:  0.49792027473449707
local_output_nid generation:  0.028644561767578125
local_in_edges_tensor generation:  0.03287553787231445
mini_batch_src_global generation:  0.05962967872619629
r_  generation:  0.4956388473510742
local_output_nid generation:  0.029051780700683594
local_in_edges_tensor generation:  0.03280448913574219
mini_batch_src_global generation:  0.058852195739746094
r_  generation:  0.5131213665008545
local_output_nid generation:  0.0334925651550293
local_in_edges_tensor generation:  0.033111572265625
mini_batch_src_global generation:  0.060355424880981445
r_  generation:  0.5025515556335449
local_output_nid generation:  0.02996993064880371
local_in_edges_tensor generation:  0.040102481842041016
mini_batch_src_global generation:  0.05910134315490723
r_  generation:  0.5085968971252441
local_output_nid generation:  0.029351234436035156
local_in_edges_tensor generation:  0.037682533264160156
mini_batch_src_global generation:  0.05858492851257324
r_  generation:  0.49961113929748535
local_output_nid generation:  0.029187440872192383
local_in_edges_tensor generation:  0.04271340370178223
mini_batch_src_global generation:  0.06454229354858398
r_  generation:  0.5292179584503174
local_output_nid generation:  0.03150486946105957
local_in_edges_tensor generation:  0.0432736873626709
mini_batch_src_global generation:  0.06067776679992676
r_  generation:  0.49780869483947754
local_output_nid generation:  0.029270410537719727
local_in_edges_tensor generation:  0.038558006286621094
mini_batch_src_global generation:  0.05797290802001953
r_  generation:  0.5025844573974609
local_output_nid generation:  0.029557466506958008
local_in_edges_tensor generation:  0.03881978988647461
mini_batch_src_global generation:  0.05849456787109375
r_  generation:  0.49817419052124023
local_output_nid generation:  0.029322385787963867
local_in_edges_tensor generation:  0.028321504592895508
mini_batch_src_global generation:  0.05768871307373047
r_  generation:  0.5013971328735352
local_output_nid generation:  0.0290529727935791
local_in_edges_tensor generation:  0.028316020965576172
mini_batch_src_global generation:  0.05838656425476074
r_  generation:  0.5008156299591064
local_output_nid generation:  0.028882265090942383
local_in_edges_tensor generation:  0.028186321258544922
mini_batch_src_global generation:  0.057100534439086914
r_  generation:  0.5171175003051758
local_output_nid generation:  0.028876304626464844
local_in_edges_tensor generation:  0.03380131721496582
mini_batch_src_global generation:  0.06257367134094238
r_  generation:  0.5035035610198975
local_output_nid generation:  0.02973151206970215
local_in_edges_tensor generation:  0.04215073585510254
mini_batch_src_global generation:  0.058110713958740234
r_  generation:  0.5062668323516846
local_output_nid generation:  0.029027462005615234
local_in_edges_tensor generation:  0.03812146186828613
mini_batch_src_global generation:  0.059702396392822266
r_  generation:  0.49689626693725586
local_output_nid generation:  0.029788494110107422
local_in_edges_tensor generation:  0.028702259063720703
mini_batch_src_global generation:  0.057488441467285156
r_  generation:  0.5011308193206787
local_output_nid generation:  0.02897047996520996
local_in_edges_tensor generation:  0.03130078315734863
mini_batch_src_global generation:  0.06325793266296387
r_  generation:  0.49655985832214355
----------------------check_connections_block total spend ----------------------------- 23.576300382614136
generate_one_block  0.8162612915039062
generate_one_block  0.6674034595489502
generate_one_block  0.6409542560577393
generate_one_block  0.6485602855682373
generate_one_block  0.6375656127929688
generate_one_block  0.6588134765625
generate_one_block  0.6413288116455078
generate_one_block  0.6537163257598877
generate_one_block  0.6546750068664551
generate_one_block  0.6416947841644287
generate_one_block  0.6404268741607666
generate_one_block  0.6559755802154541
generate_one_block  0.6352825164794922
generate_one_block  0.6419525146484375
generate_one_block  0.6496973037719727
generate_one_block  0.648141622543335
generate_one_block  0.6744344234466553
generate_one_block  0.6498055458068848
generate_one_block  0.6511416435241699
generate_one_block  0.6523866653442383
generate_one_block  0.6459317207336426
generate_one_block  0.6429686546325684
generate_one_block  0.6516661643981934
generate_one_block  0.649287223815918
generate_one_block  0.6418697834014893
generate_one_block  0.6466906070709229
generate_one_block  0.6369843482971191
generate_one_block  0.6400151252746582
generate_one_block  0.6675868034362793
generate_one_block  0.6381590366363525
generate_one_block  0.633439302444458
generate_one_block  0.6450114250183105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  31.971515417099
block generation total time  28.325353860855103
average batch blocks generation time:  0.885167308151722
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09392976760864258  GigaBytes
Max Memory Allocated: 0.09392976760864258  GigaBytes

torch.Size([150175, 128])
torch.Size([110114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0057373046875 GB
    Memory Allocated: 21.10686159133911  GigaBytes
Max Memory Allocated: 21.209103107452393  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4842529296875 GB
    Memory Allocated: 0.09915828704833984  GigaBytes
Max Memory Allocated: 21.209103107452393  GigaBytes

torch.Size([150412, 128])
torch.Size([110516, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 21.307279586791992  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9432373046875 GB
    Memory Allocated: 0.09910869598388672  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150189, 128])
torch.Size([108781, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2322998046875 GB
    Memory Allocated: 20.250717163085938  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09874486923217773  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150525, 128])
torch.Size([109874, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 20.45716381072998  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09920692443847656  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149893, 128])
torch.Size([109216, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 20.461008071899414  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09875631332397461  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150063, 128])
torch.Size([109799, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 20.904173851013184  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.0993356704711914  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149919, 128])
torch.Size([109854, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 20.669705390930176  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7264404296875 GB
    Memory Allocated: 0.09906578063964844  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150548, 128])
torch.Size([110745, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7283935546875 GB
    Memory Allocated: 20.995378494262695  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7303466796875 GB
    Memory Allocated: 0.09946918487548828  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150270, 128])
torch.Size([110382, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7713623046875 GB
    Memory Allocated: 20.883517265319824  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 0.09864997863769531  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150170, 128])
torch.Size([109496, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8084716796875 GB
    Memory Allocated: 20.64137887954712  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8123779296875 GB
    Memory Allocated: 0.0995168685913086  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150311, 128])
torch.Size([109918, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 21.026018619537354  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09867668151855469  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149976, 128])
torch.Size([109733, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.811384201049805  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09819936752319336  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149323, 128])
torch.Size([108667, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.57266616821289  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09891653060913086  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150585, 128])
torch.Size([109851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.7549786567688  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09942626953125  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150187, 128])
torch.Size([109856, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.812861442565918  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09838104248046875  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150388, 128])
torch.Size([108373, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.00852918624878  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.0994558334350586  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150104, 128])
torch.Size([110117, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.90029525756836  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09871721267700195  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150163, 128])
torch.Size([109412, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.778782844543457  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09944629669189453  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150481, 128])
torch.Size([110091, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.882712841033936  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09888076782226562  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150624, 128])
torch.Size([110154, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.61619281768799  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09939002990722656  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150109, 128])
torch.Size([109534, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.770111083984375  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09878730773925781  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150324, 128])
torch.Size([109857, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.719475269317627  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09947872161865234  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150508, 128])
torch.Size([110407, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.9432430267334  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.09902334213256836  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150525, 128])
torch.Size([110414, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 20.960850715637207  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9451904296875 GB
    Memory Allocated: 0.099517822265625  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150331, 128])
torch.Size([110056, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0174560546875 GB
    Memory Allocated: 20.988001823425293  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 0.09873580932617188  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150008, 128])
torch.Size([109635, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 20.914227962493896  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 0.09909820556640625  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150225, 128])
torch.Size([109308, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 20.260508060455322  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 0.09878301620483398  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150119, 128])
torch.Size([109887, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 20.893481254577637  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0194091796875 GB
    Memory Allocated: 0.09957027435302734  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150475, 128])
torch.Size([110895, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 21.07275676727295  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.09893560409545898  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150729, 128])
torch.Size([109743, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 20.657564163208008  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.0991678237915039  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149944, 128])
torch.Size([109137, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 20.372129440307617  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.09868049621582031  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150058, 128])
torch.Size([109192, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 20.800460815429688  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03736312687397003 |0.036234818398952484 |0.6876954585313797 |0.00011546909809112549 |1.269017644226551 |0.01625227928161621 |
----------------------------------------------------------pseudo_mini_loss sum 5.395457744598389
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9160712
Number of first layer input nodes during this epoch:  4807661
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.13119888305664062  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02949976921081543
random selection method range initialization spend 0.006459951400756836
time for parepare:  0.024242162704467773
local_output_nid generation:  0.00171661376953125
local_in_edges_tensor generation:  0.005574464797973633
mini_batch_src_global generation:  0.0024640560150146484
r_  generation:  0.010929584503173828
local_output_nid generation:  0.0017614364624023438
local_in_edges_tensor generation:  0.0011548995971679688
mini_batch_src_global generation:  0.0027151107788085938
r_  generation:  0.012169122695922852
local_output_nid generation:  0.0022344589233398438
local_in_edges_tensor generation:  0.0013077259063720703
mini_batch_src_global generation:  0.001428365707397461
r_  generation:  0.01048588752746582
local_output_nid generation:  0.0021522045135498047
local_in_edges_tensor generation:  0.001073598861694336
mini_batch_src_global generation:  0.0012726783752441406
r_  generation:  0.010080099105834961
local_output_nid generation:  0.002084970474243164
local_in_edges_tensor generation:  0.0010471343994140625
mini_batch_src_global generation:  0.0013005733489990234
r_  generation:  0.010260581970214844
local_output_nid generation:  0.0020847320556640625
local_in_edges_tensor generation:  0.0010478496551513672
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.010040521621704102
local_output_nid generation:  0.0020329952239990234
local_in_edges_tensor generation:  0.0010383129119873047
mini_batch_src_global generation:  0.0012011528015136719
r_  generation:  0.010116815567016602
local_output_nid generation:  0.0021164417266845703
local_in_edges_tensor generation:  0.0010480880737304688
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010026931762695312
local_output_nid generation:  0.002054452896118164
local_in_edges_tensor generation:  0.0010457038879394531
mini_batch_src_global generation:  0.0011878013610839844
r_  generation:  0.010265827178955078
local_output_nid generation:  0.002056598663330078
local_in_edges_tensor generation:  0.0010409355163574219
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.01055002212524414
local_output_nid generation:  0.0020956993103027344
local_in_edges_tensor generation:  0.0010366439819335938
mini_batch_src_global generation:  0.0012748241424560547
r_  generation:  0.010642290115356445
local_output_nid generation:  0.0021278858184814453
local_in_edges_tensor generation:  0.0010333061218261719
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010420560836791992
local_output_nid generation:  0.0020782947540283203
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.009695768356323242
local_output_nid generation:  0.0020804405212402344
local_in_edges_tensor generation:  0.0009996891021728516
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.009746551513671875
local_output_nid generation:  0.002075672149658203
local_in_edges_tensor generation:  0.0010442733764648438
mini_batch_src_global generation:  0.0012640953063964844
r_  generation:  0.010805845260620117
local_output_nid generation:  0.0021092891693115234
local_in_edges_tensor generation:  0.0009708404541015625
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.009956121444702148
local_output_nid generation:  0.0020689964294433594
local_in_edges_tensor generation:  0.000995635986328125
mini_batch_src_global generation:  0.0011897087097167969
r_  generation:  0.010081768035888672
local_output_nid generation:  0.0020787715911865234
local_in_edges_tensor generation:  0.0010106563568115234
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.010372400283813477
local_output_nid generation:  0.0020742416381835938
local_in_edges_tensor generation:  0.0010285377502441406
mini_batch_src_global generation:  0.0012264251708984375
r_  generation:  0.010742902755737305
local_output_nid generation:  0.0021359920501708984
local_in_edges_tensor generation:  0.0009980201721191406
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010422706604003906
local_output_nid generation:  0.0020809173583984375
local_in_edges_tensor generation:  0.0010325908660888672
mini_batch_src_global generation:  0.0012123584747314453
r_  generation:  0.010456323623657227
local_output_nid generation:  0.002084970474243164
local_in_edges_tensor generation:  0.0010154247283935547
mini_batch_src_global generation:  0.0012874603271484375
r_  generation:  0.010867118835449219
local_output_nid generation:  0.002068042755126953
local_in_edges_tensor generation:  0.0010118484497070312
mini_batch_src_global generation:  0.0012505054473876953
r_  generation:  0.010829925537109375
local_output_nid generation:  0.002099275588989258
local_in_edges_tensor generation:  0.0010025501251220703
mini_batch_src_global generation:  0.001239776611328125
r_  generation:  0.01034235954284668
local_output_nid generation:  0.0021216869354248047
local_in_edges_tensor generation:  0.001012563705444336
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010454654693603516
local_output_nid generation:  0.002073526382446289
local_in_edges_tensor generation:  0.001001596450805664
mini_batch_src_global generation:  0.001219034194946289
r_  generation:  0.010526895523071289
local_output_nid generation:  0.002066373825073242
local_in_edges_tensor generation:  0.0010113716125488281
mini_batch_src_global generation:  0.0011868476867675781
r_  generation:  0.01071310043334961
local_output_nid generation:  0.0020706653594970703
local_in_edges_tensor generation:  0.0009946823120117188
mini_batch_src_global generation:  0.0011630058288574219
r_  generation:  0.010345935821533203
local_output_nid generation:  0.002131223678588867
local_in_edges_tensor generation:  0.0010039806365966797
mini_batch_src_global generation:  0.0011754035949707031
r_  generation:  0.010486841201782227
local_output_nid generation:  0.0020940303802490234
local_in_edges_tensor generation:  0.0010116100311279297
mini_batch_src_global generation:  0.0011916160583496094
r_  generation:  0.010524749755859375
local_output_nid generation:  0.002087116241455078
local_in_edges_tensor generation:  0.000982046127319336
mini_batch_src_global generation:  0.0012257099151611328
r_  generation:  0.010479450225830078
local_output_nid generation:  0.0020897388458251953
local_in_edges_tensor generation:  0.0009853839874267578
mini_batch_src_global generation:  0.001171112060546875
r_  generation:  0.010395050048828125
----------------------check_connections_block total spend ----------------------------- 0.6106066703796387
generate_one_block  0.026648759841918945
generate_one_block  0.02252364158630371
generate_one_block  0.02056717872619629
generate_one_block  0.0193634033203125
generate_one_block  0.019622325897216797
generate_one_block  0.01891779899597168
generate_one_block  0.018814802169799805
generate_one_block  0.01868915557861328
generate_one_block  0.018578052520751953
generate_one_block  0.0192413330078125
generate_one_block  0.019629478454589844
generate_one_block  0.019372224807739258
generate_one_block  0.017649412155151367
generate_one_block  0.017982006072998047
generate_one_block  0.019783973693847656
generate_one_block  0.018179655075073242
generate_one_block  0.01847386360168457
generate_one_block  0.019278764724731445
generate_one_block  0.019739151000976562
generate_one_block  0.019232511520385742
generate_one_block  0.01930713653564453
generate_one_block  0.019620895385742188
generate_one_block  0.019595623016357422
generate_one_block  0.018862485885620117
generate_one_block  0.018737077713012695
generate_one_block  0.018929243087768555
generate_one_block  0.019207000732421875
generate_one_block  0.018671274185180664
generate_one_block  0.01883840560913086
generate_one_block  0.018923521041870117
generate_one_block  0.019107341766357422
generate_one_block  0.018680572509765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.06513833999633789
gen group dst list time:  0.022585391998291016
time for parepare:  0.019368648529052734
local_output_nid generation:  0.006371736526489258
local_in_edges_tensor generation:  0.016016244888305664
mini_batch_src_global generation:  0.016173124313354492
r_  generation:  0.16120290756225586
local_output_nid generation:  0.00888681411743164
local_in_edges_tensor generation:  0.012021064758300781
mini_batch_src_global generation:  0.020699262619018555
r_  generation:  0.16625261306762695
local_output_nid generation:  0.009554862976074219
local_in_edges_tensor generation:  0.03698444366455078
mini_batch_src_global generation:  0.020301103591918945
r_  generation:  0.18081402778625488
local_output_nid generation:  0.009948968887329102
local_in_edges_tensor generation:  0.010427713394165039
mini_batch_src_global generation:  0.02029728889465332
r_  generation:  0.1769576072692871
local_output_nid generation:  0.010203838348388672
local_in_edges_tensor generation:  0.010254859924316406
mini_batch_src_global generation:  0.023367881774902344
r_  generation:  0.22356152534484863
local_output_nid generation:  0.01492452621459961
local_in_edges_tensor generation:  0.012686014175415039
mini_batch_src_global generation:  0.02585911750793457
r_  generation:  0.19893860816955566
local_output_nid generation:  0.01707005500793457
local_in_edges_tensor generation:  0.013417720794677734
mini_batch_src_global generation:  0.025415897369384766
r_  generation:  0.2020740509033203
local_output_nid generation:  0.015871047973632812
local_in_edges_tensor generation:  0.011547327041625977
mini_batch_src_global generation:  0.02839207649230957
r_  generation:  0.18282389640808105
local_output_nid generation:  0.010312080383300781
local_in_edges_tensor generation:  0.011846780776977539
mini_batch_src_global generation:  0.021870136260986328
r_  generation:  0.18117499351501465
local_output_nid generation:  0.010486841201782227
local_in_edges_tensor generation:  0.012257099151611328
mini_batch_src_global generation:  0.02567267417907715
r_  generation:  0.18866586685180664
local_output_nid generation:  0.010157346725463867
local_in_edges_tensor generation:  0.015134572982788086
mini_batch_src_global generation:  0.02368021011352539
r_  generation:  0.19324827194213867
local_output_nid generation:  0.014018774032592773
local_in_edges_tensor generation:  0.012166738510131836
mini_batch_src_global generation:  0.023243427276611328
r_  generation:  0.19368314743041992
local_output_nid generation:  0.009345769882202148
local_in_edges_tensor generation:  0.009688615798950195
mini_batch_src_global generation:  0.0212857723236084
r_  generation:  0.20053839683532715
local_output_nid generation:  0.012278079986572266
local_in_edges_tensor generation:  0.01963067054748535
mini_batch_src_global generation:  0.022409677505493164
r_  generation:  0.1715695858001709
local_output_nid generation:  0.010161161422729492
local_in_edges_tensor generation:  0.012861251831054688
mini_batch_src_global generation:  0.02484440803527832
r_  generation:  0.1904773712158203
local_output_nid generation:  0.009465932846069336
local_in_edges_tensor generation:  0.010549306869506836
mini_batch_src_global generation:  0.022075176239013672
r_  generation:  0.17135858535766602
local_output_nid generation:  0.009525060653686523
local_in_edges_tensor generation:  0.010061264038085938
mini_batch_src_global generation:  0.023235321044921875
r_  generation:  0.18136167526245117
local_output_nid generation:  0.009972810745239258
local_in_edges_tensor generation:  0.012033939361572266
mini_batch_src_global generation:  0.02259993553161621
r_  generation:  0.17884588241577148
local_output_nid generation:  0.009801387786865234
local_in_edges_tensor generation:  0.01212620735168457
mini_batch_src_global generation:  0.025174617767333984
r_  generation:  0.18837237358093262
local_output_nid generation:  0.009298324584960938
local_in_edges_tensor generation:  0.010264396667480469
mini_batch_src_global generation:  0.022984027862548828
r_  generation:  0.17775797843933105
local_output_nid generation:  0.009292364120483398
local_in_edges_tensor generation:  0.01180124282836914
mini_batch_src_global generation:  0.02313995361328125
r_  generation:  0.18797016143798828
local_output_nid generation:  0.009588956832885742
local_in_edges_tensor generation:  0.013426542282104492
mini_batch_src_global generation:  0.023794889450073242
r_  generation:  0.18593049049377441
local_output_nid generation:  0.009589672088623047
local_in_edges_tensor generation:  0.011917352676391602
mini_batch_src_global generation:  0.023720264434814453
r_  generation:  0.18773841857910156
local_output_nid generation:  0.009218692779541016
local_in_edges_tensor generation:  0.010018348693847656
mini_batch_src_global generation:  0.022655248641967773
r_  generation:  0.1768639087677002
local_output_nid generation:  0.009016275405883789
local_in_edges_tensor generation:  0.010165691375732422
mini_batch_src_global generation:  0.022608280181884766
r_  generation:  0.1812741756439209
local_output_nid generation:  0.00932931900024414
local_in_edges_tensor generation:  0.011681556701660156
mini_batch_src_global generation:  0.023107290267944336
r_  generation:  0.18123793601989746
local_output_nid generation:  0.00943136215209961
local_in_edges_tensor generation:  0.014922142028808594
mini_batch_src_global generation:  0.024709701538085938
r_  generation:  0.18649864196777344
local_output_nid generation:  0.009159564971923828
local_in_edges_tensor generation:  0.010333776473999023
mini_batch_src_global generation:  0.022702455520629883
r_  generation:  0.18202638626098633
local_output_nid generation:  0.009272098541259766
local_in_edges_tensor generation:  0.010301828384399414
mini_batch_src_global generation:  0.023106098175048828
r_  generation:  0.18554234504699707
local_output_nid generation:  0.009232521057128906
local_in_edges_tensor generation:  0.03486037254333496
mini_batch_src_global generation:  0.023360252380371094
r_  generation:  0.1899580955505371
local_output_nid generation:  0.009422779083251953
local_in_edges_tensor generation:  0.011912107467651367
mini_batch_src_global generation:  0.02348041534423828
r_  generation:  0.18797850608825684
local_output_nid generation:  0.009248733520507812
local_in_edges_tensor generation:  0.01011347770690918
mini_batch_src_global generation:  0.022313594818115234
r_  generation:  0.1759476661682129
----------------------check_connections_block total spend ----------------------------- 8.762118577957153
generate_one_block  0.25769805908203125
generate_one_block  0.23859333992004395
generate_one_block  0.2589435577392578
generate_one_block  0.2542111873626709
generate_one_block  0.2878737449645996
generate_one_block  0.2438664436340332
generate_one_block  0.2429499626159668
generate_one_block  0.23784685134887695
generate_one_block  0.23784089088439941
generate_one_block  0.24996042251586914
generate_one_block  0.2530782222747803
generate_one_block  0.24628329277038574
generate_one_block  0.23327326774597168
generate_one_block  0.22829961776733398
generate_one_block  0.25890541076660156
generate_one_block  0.22724437713623047
generate_one_block  0.24475669860839844
generate_one_block  0.24905180931091309
generate_one_block  0.26300954818725586
generate_one_block  0.25917673110961914
generate_one_block  0.2601959705352783
generate_one_block  0.2537064552307129
generate_one_block  0.2537577152252197
generate_one_block  0.2417590618133545
generate_one_block  0.23978042602539062
generate_one_block  0.24808359146118164
generate_one_block  0.24989819526672363
generate_one_block  0.24745988845825195
generate_one_block  0.24854707717895508
generate_one_block  0.25312328338623047
generate_one_block  0.2567603588104248
generate_one_block  0.23686599731445312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05092787742614746
gen group dst list time:  0.10917019844055176
time for parepare:  0.01978278160095215
local_output_nid generation:  0.028349876403808594
local_in_edges_tensor generation:  0.05994439125061035
mini_batch_src_global generation:  0.04599714279174805
r_  generation:  0.47543954849243164
local_output_nid generation:  0.033690452575683594
local_in_edges_tensor generation:  0.05046844482421875
mini_batch_src_global generation:  0.058638811111450195
r_  generation:  0.4812042713165283
local_output_nid generation:  0.03354191780090332
local_in_edges_tensor generation:  0.048949480056762695
mini_batch_src_global generation:  0.05603671073913574
r_  generation:  0.5078186988830566
local_output_nid generation:  0.03260207176208496
local_in_edges_tensor generation:  0.041620731353759766
mini_batch_src_global generation:  0.06313419342041016
r_  generation:  0.4887511730194092
local_output_nid generation:  0.03037428855895996
local_in_edges_tensor generation:  0.03979325294494629
mini_batch_src_global generation:  0.06168341636657715
r_  generation:  0.4920511245727539
local_output_nid generation:  0.02974081039428711
local_in_edges_tensor generation:  0.032578468322753906
mini_batch_src_global generation:  0.05896425247192383
r_  generation:  0.4858670234680176
local_output_nid generation:  0.02971029281616211
local_in_edges_tensor generation:  0.03075385093688965
mini_batch_src_global generation:  0.059218406677246094
r_  generation:  0.4951512813568115
local_output_nid generation:  0.029756784439086914
local_in_edges_tensor generation:  0.031982421875
mini_batch_src_global generation:  0.05947756767272949
r_  generation:  0.49213123321533203
local_output_nid generation:  0.02994990348815918
local_in_edges_tensor generation:  0.04128766059875488
mini_batch_src_global generation:  0.061690330505371094
r_  generation:  0.49216556549072266
local_output_nid generation:  0.029867172241210938
local_in_edges_tensor generation:  0.03478407859802246
mini_batch_src_global generation:  0.05914664268493652
r_  generation:  0.489276647567749
local_output_nid generation:  0.029891014099121094
local_in_edges_tensor generation:  0.04376554489135742
mini_batch_src_global generation:  0.058116912841796875
r_  generation:  0.49825239181518555
local_output_nid generation:  0.030360698699951172
local_in_edges_tensor generation:  0.03498530387878418
mini_batch_src_global generation:  0.059626102447509766
r_  generation:  0.4973785877227783
local_output_nid generation:  0.029852867126464844
local_in_edges_tensor generation:  0.030373096466064453
mini_batch_src_global generation:  0.05827450752258301
r_  generation:  0.4923672676086426
local_output_nid generation:  0.0298001766204834
local_in_edges_tensor generation:  0.04413890838623047
mini_batch_src_global generation:  0.05799055099487305
r_  generation:  0.48679423332214355
local_output_nid generation:  0.03071451187133789
local_in_edges_tensor generation:  0.04438495635986328
mini_batch_src_global generation:  0.05828452110290527
r_  generation:  0.5084013938903809
local_output_nid generation:  0.029936552047729492
local_in_edges_tensor generation:  0.03026556968688965
mini_batch_src_global generation:  0.05902862548828125
r_  generation:  0.48632335662841797
local_output_nid generation:  0.030171632766723633
local_in_edges_tensor generation:  0.0366365909576416
mini_batch_src_global generation:  0.061656951904296875
r_  generation:  0.49771904945373535
local_output_nid generation:  0.031919240951538086
local_in_edges_tensor generation:  0.030576229095458984
mini_batch_src_global generation:  0.060565948486328125
r_  generation:  0.5000813007354736
local_output_nid generation:  0.030907154083251953
local_in_edges_tensor generation:  0.04135751724243164
mini_batch_src_global generation:  0.0658416748046875
r_  generation:  0.5101995468139648
local_output_nid generation:  0.030980348587036133
local_in_edges_tensor generation:  0.032657623291015625
mini_batch_src_global generation:  0.06119203567504883
r_  generation:  0.499891996383667
local_output_nid generation:  0.030920743942260742
local_in_edges_tensor generation:  0.03527379035949707
mini_batch_src_global generation:  0.06543207168579102
r_  generation:  0.5038242340087891
local_output_nid generation:  0.03098583221435547
local_in_edges_tensor generation:  0.031027793884277344
mini_batch_src_global generation:  0.06385111808776855
r_  generation:  0.5073165893554688
local_output_nid generation:  0.0311126708984375
local_in_edges_tensor generation:  0.0472559928894043
mini_batch_src_global generation:  0.06461453437805176
r_  generation:  0.5115375518798828
local_output_nid generation:  0.030991554260253906
local_in_edges_tensor generation:  0.029831647872924805
mini_batch_src_global generation:  0.06131744384765625
r_  generation:  0.5043487548828125
local_output_nid generation:  0.03165411949157715
local_in_edges_tensor generation:  0.0368654727935791
mini_batch_src_global generation:  0.061382293701171875
r_  generation:  0.5059919357299805
local_output_nid generation:  0.030697107315063477
local_in_edges_tensor generation:  0.04020810127258301
mini_batch_src_global generation:  0.059140682220458984
r_  generation:  0.5210692882537842
local_output_nid generation:  0.03186392784118652
local_in_edges_tensor generation:  0.04306173324584961
mini_batch_src_global generation:  0.0602269172668457
r_  generation:  0.5023279190063477
local_output_nid generation:  0.031659603118896484
local_in_edges_tensor generation:  0.041413068771362305
mini_batch_src_global generation:  0.05971860885620117
r_  generation:  0.4980275630950928
local_output_nid generation:  0.03099822998046875
local_in_edges_tensor generation:  0.033387184143066406
mini_batch_src_global generation:  0.05978584289550781
r_  generation:  0.5000941753387451
local_output_nid generation:  0.030703306198120117
local_in_edges_tensor generation:  0.03244519233703613
mini_batch_src_global generation:  0.059992313385009766
r_  generation:  0.5022110939025879
local_output_nid generation:  0.030863046646118164
local_in_edges_tensor generation:  0.03760504722595215
mini_batch_src_global generation:  0.06285929679870605
r_  generation:  0.503986120223999
local_output_nid generation:  0.03081536293029785
local_in_edges_tensor generation:  0.02908039093017578
mini_batch_src_global generation:  0.05961728096008301
r_  generation:  0.4989612102508545
----------------------check_connections_block total spend ----------------------------- 23.53600001335144
generate_one_block  0.7119808197021484
generate_one_block  0.6865553855895996
generate_one_block  0.682025671005249
generate_one_block  0.6832809448242188
generate_one_block  0.7938928604125977
generate_one_block  0.672034502029419
generate_one_block  0.6807634830474854
generate_one_block  0.6744115352630615
generate_one_block  0.6746654510498047
generate_one_block  0.6770129203796387
generate_one_block  0.6907036304473877
generate_one_block  0.685992956161499
generate_one_block  0.6554536819458008
generate_one_block  0.6624007225036621
generate_one_block  0.6945033073425293
generate_one_block  0.6689071655273438
generate_one_block  0.6824278831481934
generate_one_block  0.6956095695495605
generate_one_block  0.6906230449676514
generate_one_block  0.6687676906585693
generate_one_block  0.6702396869659424
generate_one_block  0.6973261833190918
generate_one_block  0.6881484985351562
generate_one_block  0.6972048282623291
generate_one_block  0.7201812267303467
generate_one_block  0.6789209842681885
generate_one_block  0.6746268272399902
generate_one_block  0.6825587749481201
generate_one_block  0.72878098487854
generate_one_block  0.701904296875
generate_one_block  0.6959030628204346
generate_one_block  0.689199686050415
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.13119888305664062  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

connection checking time:  32.298118591308594
block generation total time  30.01980972290039
average batch blocks generation time:  0.9381190538406372
block dataloader generation time/epoch 66.16822552680969
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.10974359512329102  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150186, 128])
torch.Size([109419, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 20.598217487335205  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.10894298553466797  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150062, 128])
torch.Size([109248, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 20.455190181732178  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 0.10999584197998047  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149897, 128])
torch.Size([109957, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1697998046875 GB
    Memory Allocated: 21.08232021331787  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.1091618537902832  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150199, 128])
torch.Size([110063, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.67653799057007  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.11005783081054688  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150677, 128])
torch.Size([110525, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 21.15554666519165  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.109283447265625  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150388, 128])
torch.Size([109620, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.775750637054443  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.10978984832763672  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150021, 128])
torch.Size([109534, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.68018913269043  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.10889720916748047  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([149868, 128])
torch.Size([109024, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.547847270965576  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.10970306396484375  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150352, 128])
torch.Size([109478, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.51990032196045  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.10931921005249023  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150295, 128])
torch.Size([109527, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 20.908140659332275  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1737060546875 GB
    Memory Allocated: 0.110076904296875  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150761, 128])
torch.Size([111288, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 21.225143909454346  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6131591796875 GB
    Memory Allocated: 0.10945415496826172  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150616, 128])
torch.Size([110674, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6424560546875 GB
    Memory Allocated: 20.883826732635498  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6444091796875 GB
    Memory Allocated: 0.10924625396728516  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150215, 128])
torch.Size([108066, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6444091796875 GB
    Memory Allocated: 19.810734748840332  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1092529296875 GB
    Memory Allocated: 0.10875082015991211  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150055, 128])
torch.Size([108563, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1912841796875 GB
    Memory Allocated: 20.145838260650635  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.11013221740722656  GigaBytes
Max Memory Allocated: 21.40934705734253  GigaBytes

torch.Size([150398, 128])
torch.Size([110466, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2596435546875 GB
    Memory Allocated: 21.315861701965332  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6776123046875 GB
    Memory Allocated: 0.1087946891784668  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

torch.Size([150245, 128])
torch.Size([108103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9393310546875 GB
    Memory Allocated: 20.066737174987793  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9412841796875 GB
    Memory Allocated: 0.10977458953857422  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

torch.Size([150253, 128])
torch.Size([109588, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0389404296875 GB
    Memory Allocated: 20.645828247070312  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0408935546875 GB
    Memory Allocated: 0.10947227478027344  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

torch.Size([150694, 128])
torch.Size([110823, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0858154296875 GB
    Memory Allocated: 20.85242986679077  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 0.1101846694946289  GigaBytes
Max Memory Allocated: 21.41646099090576  GigaBytes

torch.Size([150449, 128])
torch.Size([111175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2518310546875 GB
    Memory Allocated: 21.3596248626709  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6600341796875 GB
    Memory Allocated: 0.10932350158691406  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150552, 128])
torch.Size([109915, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1209716796875 GB
    Memory Allocated: 20.733015537261963  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 0.10991191864013672  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([149967, 128])
torch.Size([109686, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1346435546875 GB
    Memory Allocated: 20.917705059051514  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10918521881103516  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([149842, 128])
torch.Size([109650, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 21.085204601287842  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.11007499694824219  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150780, 128])
torch.Size([111444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 21.17711067199707  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10920143127441406  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150392, 128])
torch.Size([110196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 20.637332916259766  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10980224609375  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([149740, 128])
torch.Size([109266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 20.73951768875122  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10927963256835938  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150366, 128])
torch.Size([109477, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 20.82009220123291  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10987377166748047  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150301, 128])
torch.Size([109566, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 20.89601182937622  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10892963409423828  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([149758, 128])
torch.Size([108650, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 20.717031955718994  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1365966796875 GB
    Memory Allocated: 0.10991859436035156  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150488, 128])
torch.Size([110088, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1424560546875 GB
    Memory Allocated: 20.906168937683105  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 0.10936546325683594  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150334, 128])
torch.Size([109645, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 20.972333431243896  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 0.11004066467285156  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150685, 128])
torch.Size([110414, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 21.147355556488037  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 0.10912799835205078  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

torch.Size([150378, 128])
torch.Size([109461, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 20.516942024230957  GigaBytes
Max Memory Allocated: 21.46578550338745  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027919158339500427 |0.025721222162246704 |0.7029235512018204 |0.00010208785533905029 |1.242502748966217 |0.005281209945678711 |
----------------------------------------------------------pseudo_mini_loss sum 3.964345693588257
Total (block generation + training)time/epoch 130.22222065925598
Training time/epoch 64.05368852615356
Training time without block to device /epoch 63.23060941696167
Training time without total dataloading part /epoch 62.262189626693726
load block tensor time/epoch 0.8934130668640137
block to device time/epoch 0.8230791091918945
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9161654
Number of first layer input nodes during this epoch:  4809214
