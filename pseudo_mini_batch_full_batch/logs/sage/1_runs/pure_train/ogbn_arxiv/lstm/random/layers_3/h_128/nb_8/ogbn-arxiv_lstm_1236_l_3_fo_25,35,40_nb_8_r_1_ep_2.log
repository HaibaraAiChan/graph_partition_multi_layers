Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648459971.7390704
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02443671226501465
random selection method range initialization spend 0.006573200225830078
time for parepare:  0.018975496292114258
local_output_nid generation:  0.0042765140533447266
local_in_edges_tensor generation:  0.0060231685638427734
mini_batch_src_global generation:  0.0032944679260253906
r_  generation:  0.03804206848144531
local_output_nid generation:  0.0057528018951416016
local_in_edges_tensor generation:  0.0032987594604492188
mini_batch_src_global generation:  0.004231929779052734
r_  generation:  0.04030489921569824
local_output_nid generation:  0.006068229675292969
local_in_edges_tensor generation:  0.0032660961151123047
mini_batch_src_global generation:  0.0028972625732421875
r_  generation:  0.0404515266418457
local_output_nid generation:  0.006064414978027344
local_in_edges_tensor generation:  0.0031821727752685547
mini_batch_src_global generation:  0.0030722618103027344
r_  generation:  0.04059147834777832
local_output_nid generation:  0.0060558319091796875
local_in_edges_tensor generation:  0.0031604766845703125
mini_batch_src_global generation:  0.0031778812408447266
r_  generation:  0.04140043258666992
local_output_nid generation:  0.006124734878540039
local_in_edges_tensor generation:  0.0033082962036132812
mini_batch_src_global generation:  0.003428936004638672
r_  generation:  0.041449546813964844
local_output_nid generation:  0.006076335906982422
local_in_edges_tensor generation:  0.0032300949096679688
mini_batch_src_global generation:  0.0033729076385498047
r_  generation:  0.04196500778198242
local_output_nid generation:  0.006012916564941406
local_in_edges_tensor generation:  0.0032601356506347656
mini_batch_src_global generation:  0.003406047821044922
r_  generation:  0.04305553436279297
----------------------check_connections_block total spend ----------------------------- 0.5261380672454834
generate_one_block  0.05451202392578125
generate_one_block  0.05604958534240723
generate_one_block  0.05636954307556152
generate_one_block  0.055744171142578125
generate_one_block  0.05838322639465332
generate_one_block  0.05553913116455078
generate_one_block  0.05583953857421875
generate_one_block  0.055335283279418945
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040771484375
gen group dst list time:  0.01541280746459961
time for parepare:  0.020065784454345703
local_output_nid generation:  0.013737201690673828
local_in_edges_tensor generation:  0.03248763084411621
mini_batch_src_global generation:  0.027461528778076172
r_  generation:  0.2892730236053467
local_output_nid generation:  0.021059274673461914
local_in_edges_tensor generation:  0.03051280975341797
mini_batch_src_global generation:  0.03586602210998535
r_  generation:  0.3012235164642334
local_output_nid generation:  0.020833969116210938
local_in_edges_tensor generation:  0.025043010711669922
mini_batch_src_global generation:  0.035195350646972656
r_  generation:  0.30501747131347656
local_output_nid generation:  0.02104473114013672
local_in_edges_tensor generation:  0.020122766494750977
mini_batch_src_global generation:  0.03658795356750488
r_  generation:  0.3072209358215332
local_output_nid generation:  0.021057605743408203
local_in_edges_tensor generation:  0.02241206169128418
mini_batch_src_global generation:  0.036986351013183594
r_  generation:  0.3097808361053467
local_output_nid generation:  0.021088600158691406
local_in_edges_tensor generation:  0.027634859085083008
mini_batch_src_global generation:  0.037787437438964844
r_  generation:  0.308241605758667
local_output_nid generation:  0.020952939987182617
local_in_edges_tensor generation:  0.019794464111328125
mini_batch_src_global generation:  0.037680625915527344
r_  generation:  0.3106098175048828
local_output_nid generation:  0.020939350128173828
local_in_edges_tensor generation:  0.021924257278442383
mini_batch_src_global generation:  0.037561655044555664
r_  generation:  0.3125619888305664
----------------------check_connections_block total spend ----------------------------- 3.6340324878692627
generate_one_block  0.40002942085266113
generate_one_block  0.40053796768188477
generate_one_block  0.40276503562927246
generate_one_block  0.39162111282348633
generate_one_block  0.3972327709197998
generate_one_block  0.40937304496765137
generate_one_block  0.39580202102661133
generate_one_block  0.39592480659484863
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0325322151184082
gen group dst list time:  0.03594803810119629
time for parepare:  0.019103050231933594
local_output_nid generation:  0.028783798217773438
local_in_edges_tensor generation:  0.04390692710876465
mini_batch_src_global generation:  0.047777652740478516
r_  generation:  0.4816255569458008
local_output_nid generation:  0.03447318077087402
local_in_edges_tensor generation:  0.0496518611907959
mini_batch_src_global generation:  0.05433964729309082
r_  generation:  0.48194026947021484
local_output_nid generation:  0.03477120399475098
local_in_edges_tensor generation:  0.03629493713378906
mini_batch_src_global generation:  0.0514681339263916
r_  generation:  0.4965794086456299
local_output_nid generation:  0.0347447395324707
local_in_edges_tensor generation:  0.042593955993652344
mini_batch_src_global generation:  0.05437898635864258
r_  generation:  0.49127697944641113
local_output_nid generation:  0.035076141357421875
local_in_edges_tensor generation:  0.041773080825805664
mini_batch_src_global generation:  0.052561283111572266
r_  generation:  0.4982907772064209
local_output_nid generation:  0.034716129302978516
local_in_edges_tensor generation:  0.03669333457946777
mini_batch_src_global generation:  0.05574655532836914
r_  generation:  0.4921152591705322
local_output_nid generation:  0.03478384017944336
local_in_edges_tensor generation:  0.036728858947753906
mini_batch_src_global generation:  0.053914546966552734
r_  generation:  0.5054893493652344
local_output_nid generation:  0.03481650352478027
local_in_edges_tensor generation:  0.03686785697937012
mini_batch_src_global generation:  0.05548286437988281
r_  generation:  0.4873640537261963
----------------------check_connections_block total spend ----------------------------- 5.831822633743286
generate_one_block  0.6074652671813965
generate_one_block  0.6245429515838623
generate_one_block  0.6106743812561035
generate_one_block  0.601207971572876
generate_one_block  0.6139519214630127
generate_one_block  0.6146361827850342
generate_one_block  0.6426331996917725
generate_one_block  0.6096341609954834
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  9.465855121612549
block generation total time  8.118032217025757
average batch blocks generation time:  1.0147540271282196
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09742879867553711  GigaBytes
Max Memory Allocated: 0.09742879867553711  GigaBytes

torch.Size([160567, 128])
torch.Size([141642, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7381591796875 GB
    Memory Allocated: 19.402028560638428  GigaBytes
Max Memory Allocated: 19.460021495819092  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1092529296875 GB
    Memory Allocated: 0.1014561653137207  GigaBytes
Max Memory Allocated: 19.460021495819092  GigaBytes

torch.Size([160592, 128])
torch.Size([141435, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 19.395566940307617  GigaBytes
Max Memory Allocated: 19.460021495819092  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 0.10143375396728516  GigaBytes
Max Memory Allocated: 19.460021495819092  GigaBytes

torch.Size([160415, 128])
torch.Size([141093, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0526123046875 GB
    Memory Allocated: 19.440404891967773  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10172033309936523  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160484, 128])
torch.Size([141117, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.326735973358154  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10187482833862305  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160608, 128])
torch.Size([141218, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.291533946990967  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10139036178588867  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160512, 128])
torch.Size([141156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.358706951141357  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10142040252685547  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160575, 128])
torch.Size([141332, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.37684679031372  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10134458541870117  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160444, 128])
torch.Size([141074, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.353046417236328  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043370336294174194 |0.053275614976882935 |0.36694931983947754 |0.00010377168655395508 |0.4410809874534607 |0.008377790451049805 |
----------------------------------------------------------pseudo_mini_loss sum 4.99363899230957
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957245
Number of first layer input nodes during this epoch:  1284197
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.13405609130859375  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024085521697998047
random selection method range initialization spend 0.005408287048339844
time for parepare:  0.017969131469726562
local_output_nid generation:  0.004791736602783203
local_in_edges_tensor generation:  0.010294675827026367
mini_batch_src_global generation:  0.003404378890991211
r_  generation:  0.037580251693725586
local_output_nid generation:  0.006369829177856445
local_in_edges_tensor generation:  0.0037071704864501953
mini_batch_src_global generation:  0.004652738571166992
r_  generation:  0.03923821449279785
local_output_nid generation:  0.006371498107910156
local_in_edges_tensor generation:  0.003762483596801758
mini_batch_src_global generation:  0.0030040740966796875
r_  generation:  0.04355573654174805
local_output_nid generation:  0.007176876068115234
local_in_edges_tensor generation:  0.010421514511108398
mini_batch_src_global generation:  0.003474712371826172
r_  generation:  0.042204856872558594
local_output_nid generation:  0.006302356719970703
local_in_edges_tensor generation:  0.0035886764526367188
mini_batch_src_global generation:  0.0032694339752197266
r_  generation:  0.0436711311340332
local_output_nid generation:  0.006943225860595703
local_in_edges_tensor generation:  0.0035791397094726562
mini_batch_src_global generation:  0.0034177303314208984
r_  generation:  0.042352914810180664
local_output_nid generation:  0.0062503814697265625
local_in_edges_tensor generation:  0.0035889148712158203
mini_batch_src_global generation:  0.003596782684326172
r_  generation:  0.04307746887207031
local_output_nid generation:  0.006282329559326172
local_in_edges_tensor generation:  0.0037882328033447266
mini_batch_src_global generation:  0.003529071807861328
r_  generation:  0.04304313659667969
----------------------check_connections_block total spend ----------------------------- 0.5642428398132324
generate_one_block  0.06876254081726074
generate_one_block  0.061865806579589844
generate_one_block  0.09221792221069336
generate_one_block  0.06436944007873535
generate_one_block  0.060970306396484375
generate_one_block  0.06102561950683594
generate_one_block  0.06490254402160645
generate_one_block  0.06190371513366699
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04805874824523926
gen group dst list time:  0.015059947967529297
time for parepare:  0.021728038787841797
local_output_nid generation:  0.01395869255065918
local_in_edges_tensor generation:  0.03669309616088867
mini_batch_src_global generation:  0.02974987030029297
r_  generation:  0.2915482521057129
local_output_nid generation:  0.019020795822143555
local_in_edges_tensor generation:  0.03034806251525879
mini_batch_src_global generation:  0.035543203353881836
r_  generation:  0.3058028221130371
local_output_nid generation:  0.01853346824645996
local_in_edges_tensor generation:  0.028012514114379883
mini_batch_src_global generation:  0.03478527069091797
r_  generation:  0.3090789318084717
local_output_nid generation:  0.018499135971069336
local_in_edges_tensor generation:  0.025162458419799805
mini_batch_src_global generation:  0.036489248275756836
r_  generation:  0.31224656105041504
local_output_nid generation:  0.018597841262817383
local_in_edges_tensor generation:  0.019402027130126953
mini_batch_src_global generation:  0.03709077835083008
r_  generation:  0.31353020668029785
local_output_nid generation:  0.018399477005004883
local_in_edges_tensor generation:  0.02477550506591797
mini_batch_src_global generation:  0.037172794342041016
r_  generation:  0.31450605392456055
local_output_nid generation:  0.01841449737548828
local_in_edges_tensor generation:  0.019339323043823242
mini_batch_src_global generation:  0.037355899810791016
r_  generation:  0.30817341804504395
local_output_nid generation:  0.01832270622253418
local_in_edges_tensor generation:  0.022003173828125
mini_batch_src_global generation:  0.039312124252319336
r_  generation:  0.30729150772094727
----------------------check_connections_block total spend ----------------------------- 3.64778470993042
generate_one_block  0.4078195095062256
generate_one_block  0.41236019134521484
generate_one_block  0.4152951240539551
generate_one_block  0.40781354904174805
generate_one_block  0.4037895202636719
generate_one_block  0.42342114448547363
generate_one_block  0.41187405586242676
generate_one_block  0.43506598472595215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04455876350402832
gen group dst list time:  0.03736686706542969
time for parepare:  0.019346237182617188
local_output_nid generation:  0.030360937118530273
local_in_edges_tensor generation:  0.057435035705566406
mini_batch_src_global generation:  0.043869972229003906
r_  generation:  0.48295068740844727
local_output_nid generation:  0.03551816940307617
local_in_edges_tensor generation:  0.052321672439575195
mini_batch_src_global generation:  0.05363774299621582
r_  generation:  0.49021148681640625
local_output_nid generation:  0.035669803619384766
local_in_edges_tensor generation:  0.03960299491882324
mini_batch_src_global generation:  0.05116844177246094
r_  generation:  0.4960041046142578
local_output_nid generation:  0.035565853118896484
local_in_edges_tensor generation:  0.05524253845214844
mini_batch_src_global generation:  0.05365633964538574
r_  generation:  0.49169182777404785
local_output_nid generation:  0.03532743453979492
local_in_edges_tensor generation:  0.03974342346191406
mini_batch_src_global generation:  0.05606985092163086
r_  generation:  0.49861741065979004
local_output_nid generation:  0.03554129600524902
local_in_edges_tensor generation:  0.0408635139465332
mini_batch_src_global generation:  0.05522322654724121
r_  generation:  0.49239516258239746
local_output_nid generation:  0.03550887107849121
local_in_edges_tensor generation:  0.04357194900512695
mini_batch_src_global generation:  0.05345964431762695
r_  generation:  0.4971640110015869
local_output_nid generation:  0.03521251678466797
local_in_edges_tensor generation:  0.044266700744628906
mini_batch_src_global generation:  0.05506086349487305
r_  generation:  0.48740601539611816
----------------------check_connections_block total spend ----------------------------- 5.8890814781188965
generate_one_block  0.6325938701629639
generate_one_block  0.642641544342041
generate_one_block  0.6338448524475098
generate_one_block  0.6492455005645752
generate_one_block  0.6376395225524902
generate_one_block  0.6392347812652588
generate_one_block  0.6268830299377441
generate_one_block  0.630948543548584
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.13405609130859375  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

connection checking time:  9.536866188049316
block generation total time  8.410470724105835
average batch blocks generation time:  1.0513088405132294
block dataloader generation time/epoch 20.14554190635681
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10492849349975586  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160535, 128])
torch.Size([141643, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.39268398284912  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10492992401123047  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160495, 128])
torch.Size([141257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.411241054534912  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10547685623168945  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160544, 128])
torch.Size([141297, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.427310943603516  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10499715805053711  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160634, 128])
torch.Size([141498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.422401905059814  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10546350479125977  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160656, 128])
torch.Size([141396, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.37946844100952  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10490036010742188  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160465, 128])
torch.Size([141213, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.380221366882324  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.1053304672241211  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160619, 128])
torch.Size([141095, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.281872272491455  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 0.10478353500366211  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

torch.Size([160336, 128])
torch.Size([140772, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5096435546875 GB
    Memory Allocated: 19.291621208190918  GigaBytes
Max Memory Allocated: 19.500765800476074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04471856355667114 |0.019539296627044678 |0.2738761007785797 |9.974837303161621e-05 |0.4383396804332733 |0.00615382194519043 |
----------------------------------------------------------pseudo_mini_loss sum 3.3150904178619385
Total (block generation + training)time/epoch 26.393121004104614
Training time/epoch 6.247300863265991
Training time without block to device /epoch 6.090986490249634
Training time without total dataloading part /epoch 5.704678058624268
load block tensor time/epoch 0.35774850845336914
block to device time/epoch 0.15631437301635742
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2957673
Number of first layer input nodes during this epoch:  1284284
