Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648457389.583447
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027879714965820312
random selection method range initialization spend 0.0076427459716796875
time for parepare:  0.019603967666625977
local_output_nid generation:  0.00427699089050293
local_in_edges_tensor generation:  0.0063762664794921875
mini_batch_src_global generation:  0.004506349563598633
r_  generation:  0.04334425926208496
local_output_nid generation:  0.006193399429321289
local_in_edges_tensor generation:  0.003175497055053711
mini_batch_src_global generation:  0.007063388824462891
r_  generation:  0.04398536682128906
local_output_nid generation:  0.0061037540435791016
local_in_edges_tensor generation:  0.0032067298889160156
mini_batch_src_global generation:  0.0032196044921875
r_  generation:  0.04352569580078125
local_output_nid generation:  0.006145477294921875
local_in_edges_tensor generation:  0.0032558441162109375
mini_batch_src_global generation:  0.00350189208984375
r_  generation:  0.04710102081298828
local_output_nid generation:  0.00618433952331543
local_in_edges_tensor generation:  0.0032825469970703125
mini_batch_src_global generation:  0.0037260055541992188
r_  generation:  0.04738211631774902
local_output_nid generation:  0.0061571598052978516
local_in_edges_tensor generation:  0.0033359527587890625
mini_batch_src_global generation:  0.003924369812011719
r_  generation:  0.04728960990905762
local_output_nid generation:  0.006232261657714844
local_in_edges_tensor generation:  0.0032570362091064453
mini_batch_src_global generation:  0.003930091857910156
r_  generation:  0.047125816345214844
local_output_nid generation:  0.006193399429321289
local_in_edges_tensor generation:  0.0032567977905273438
mini_batch_src_global generation:  0.004002094268798828
r_  generation:  0.04710102081298828
----------------------check_connections_block total spend ----------------------------- 0.5887370109558105
generate_one_block  0.06133460998535156
generate_one_block  0.06185126304626465
generate_one_block  0.06076955795288086
generate_one_block  0.06219673156738281
generate_one_block  0.06515622138977051
generate_one_block  0.06205105781555176
generate_one_block  0.061896562576293945
generate_one_block  0.06168007850646973
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036435842514038086
gen group dst list time:  0.016412973403930664
time for parepare:  0.019361257553100586
local_output_nid generation:  0.01452493667602539
local_in_edges_tensor generation:  0.029898881912231445
mini_batch_src_global generation:  0.030530691146850586
r_  generation:  0.3164401054382324
local_output_nid generation:  0.021955251693725586
local_in_edges_tensor generation:  0.03215599060058594
mini_batch_src_global generation:  0.039208412170410156
r_  generation:  0.32570505142211914
local_output_nid generation:  0.021256685256958008
local_in_edges_tensor generation:  0.026500701904296875
mini_batch_src_global generation:  0.03781008720397949
r_  generation:  0.325376033782959
local_output_nid generation:  0.02185988426208496
local_in_edges_tensor generation:  0.033086299896240234
mini_batch_src_global generation:  0.04206085205078125
r_  generation:  0.33891892433166504
local_output_nid generation:  0.021678924560546875
local_in_edges_tensor generation:  0.02138543128967285
mini_batch_src_global generation:  0.04010486602783203
r_  generation:  0.33435869216918945
local_output_nid generation:  0.021553993225097656
local_in_edges_tensor generation:  0.020389080047607422
mini_batch_src_global generation:  0.04356026649475098
r_  generation:  0.33891916275024414
local_output_nid generation:  0.02163863182067871
local_in_edges_tensor generation:  0.020393848419189453
mini_batch_src_global generation:  0.0408787727355957
r_  generation:  0.33942079544067383
local_output_nid generation:  0.021398544311523438
local_in_edges_tensor generation:  0.023478984832763672
mini_batch_src_global generation:  0.04131197929382324
r_  generation:  0.3359849452972412
----------------------check_connections_block total spend ----------------------------- 3.930518627166748
generate_one_block  0.4416961669921875
generate_one_block  0.4245448112487793
generate_one_block  0.4277925491333008
generate_one_block  0.4442610740661621
generate_one_block  0.43190813064575195
generate_one_block  0.4505908489227295
generate_one_block  0.4232468605041504
generate_one_block  0.4246985912322998
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03412675857543945
gen group dst list time:  0.03949236869812012
time for parepare:  0.019329547882080078
local_output_nid generation:  0.02890491485595703
local_in_edges_tensor generation:  0.04313540458679199
mini_batch_src_global generation:  0.04666590690612793
r_  generation:  0.473067045211792
local_output_nid generation:  0.037233591079711914
local_in_edges_tensor generation:  0.05112481117248535
mini_batch_src_global generation:  0.05386161804199219
r_  generation:  0.4880819320678711
local_output_nid generation:  0.03740048408508301
local_in_edges_tensor generation:  0.0382540225982666
mini_batch_src_global generation:  0.05040097236633301
r_  generation:  0.4939126968383789
local_output_nid generation:  0.03767657279968262
local_in_edges_tensor generation:  0.04293179512023926
mini_batch_src_global generation:  0.053560733795166016
r_  generation:  0.48602843284606934
local_output_nid generation:  0.03742384910583496
local_in_edges_tensor generation:  0.03805875778198242
mini_batch_src_global generation:  0.05245709419250488
r_  generation:  0.5000839233398438
local_output_nid generation:  0.03765368461608887
local_in_edges_tensor generation:  0.03841662406921387
mini_batch_src_global generation:  0.05785012245178223
r_  generation:  0.4899892807006836
local_output_nid generation:  0.03755474090576172
local_in_edges_tensor generation:  0.03853774070739746
mini_batch_src_global generation:  0.053955793380737305
r_  generation:  0.5044429302215576
local_output_nid generation:  0.037421464920043945
local_in_edges_tensor generation:  0.0346529483795166
mini_batch_src_global generation:  0.05530381202697754
r_  generation:  0.49025392532348633
----------------------check_connections_block total spend ----------------------------- 5.841608047485352
generate_one_block  0.6133041381835938
generate_one_block  0.6556820869445801
generate_one_block  0.608428955078125
generate_one_block  0.6180663108825684
generate_one_block  0.6185150146484375
generate_one_block  0.617894172668457
generate_one_block  0.635322093963623
generate_one_block  0.6140005588531494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  9.7721266746521
block generation total time  8.449952363967896
average batch blocks generation time:  1.056244045495987
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09807538986206055  GigaBytes
Max Memory Allocated: 0.09807538986206055  GigaBytes

torch.Size([160831, 128])
torch.Size([143042, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.4061279296875 GB
    Memory Allocated: 15.847853183746338  GigaBytes
Max Memory Allocated: 15.878619194030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9276123046875 GB
    Memory Allocated: 0.10107231140136719  GigaBytes
Max Memory Allocated: 15.878619194030762  GigaBytes

torch.Size([160930, 128])
torch.Size([143003, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 15.788408279418945  GigaBytes
Max Memory Allocated: 15.878619194030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.10037517547607422  GigaBytes
Max Memory Allocated: 15.878619194030762  GigaBytes

torch.Size([160593, 128])
torch.Size([142309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 15.701300144195557  GigaBytes
Max Memory Allocated: 15.878619194030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.10091590881347656  GigaBytes
Max Memory Allocated: 15.878619194030762  GigaBytes

torch.Size([161187, 128])
torch.Size([143832, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6893310546875 GB
    Memory Allocated: 15.891801834106445  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6893310546875 GB
    Memory Allocated: 0.10057544708251953  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160753, 128])
torch.Size([142803, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.795408725738525  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10119915008544922  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160862, 128])
torch.Size([142921, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.855183124542236  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10096406936645508  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160853, 128])
torch.Size([142633, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.785808086395264  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10113954544067383  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160740, 128])
torch.Size([142604, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.774525165557861  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0392000675201416 |0.06246033310890198 |0.528625100851059 |0.0001099705696105957 |0.7028088867664337 |0.010457038879394531 |
----------------------------------------------------------pseudo_mini_loss sum 4.936203956604004
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3018848
Number of first layer input nodes during this epoch:  1286749
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.13594675064086914  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02745819091796875
random selection method range initialization spend 0.00493931770324707
time for parepare:  0.0179903507232666
local_output_nid generation:  0.004936933517456055
local_in_edges_tensor generation:  0.008742570877075195
mini_batch_src_global generation:  0.003718137741088867
r_  generation:  0.04691576957702637
local_output_nid generation:  0.006498575210571289
local_in_edges_tensor generation:  0.00565648078918457
mini_batch_src_global generation:  0.005414247512817383
r_  generation:  0.04573416709899902
local_output_nid generation:  0.006366252899169922
local_in_edges_tensor generation:  0.0035479068756103516
mini_batch_src_global generation:  0.0033283233642578125
r_  generation:  0.05216693878173828
local_output_nid generation:  0.007584571838378906
local_in_edges_tensor generation:  0.006611347198486328
mini_batch_src_global generation:  0.0036306381225585938
r_  generation:  0.046952009201049805
local_output_nid generation:  0.006467580795288086
local_in_edges_tensor generation:  0.0034279823303222656
mini_batch_src_global generation:  0.0039293766021728516
r_  generation:  0.04957771301269531
local_output_nid generation:  0.007109642028808594
local_in_edges_tensor generation:  0.003498077392578125
mini_batch_src_global generation:  0.004129171371459961
r_  generation:  0.048734188079833984
local_output_nid generation:  0.006470680236816406
local_in_edges_tensor generation:  0.003325939178466797
mini_batch_src_global generation:  0.004147052764892578
r_  generation:  0.049050331115722656
local_output_nid generation:  0.006480693817138672
local_in_edges_tensor generation:  0.0034749507904052734
mini_batch_src_global generation:  0.004349708557128906
r_  generation:  0.049108028411865234
----------------------check_connections_block total spend ----------------------------- 0.6195769309997559
generate_one_block  0.07835078239440918
generate_one_block  0.07158231735229492
generate_one_block  0.07415509223937988
generate_one_block  0.07480430603027344
generate_one_block  0.07199978828430176
generate_one_block  0.07202386856079102
generate_one_block  0.07555150985717773
generate_one_block  0.07343626022338867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04758262634277344
gen group dst list time:  0.016328096389770508
time for parepare:  0.02129387855529785
local_output_nid generation:  0.015155792236328125
local_in_edges_tensor generation:  0.039882659912109375
mini_batch_src_global generation:  0.030556201934814453
r_  generation:  0.31807994842529297
local_output_nid generation:  0.021048307418823242
local_in_edges_tensor generation:  0.03256630897521973
mini_batch_src_global generation:  0.039447784423828125
r_  generation:  0.3326873779296875
local_output_nid generation:  0.019927978515625
local_in_edges_tensor generation:  0.023119211196899414
mini_batch_src_global generation:  0.03860616683959961
r_  generation:  0.33710527420043945
local_output_nid generation:  0.019884824752807617
local_in_edges_tensor generation:  0.025974035263061523
mini_batch_src_global generation:  0.03958868980407715
r_  generation:  0.33458757400512695
local_output_nid generation:  0.019936561584472656
local_in_edges_tensor generation:  0.023192882537841797
mini_batch_src_global generation:  0.040879011154174805
r_  generation:  0.3392500877380371
local_output_nid generation:  0.020076751708984375
local_in_edges_tensor generation:  0.02694249153137207
mini_batch_src_global generation:  0.04085421562194824
r_  generation:  0.3434267044067383
local_output_nid generation:  0.0199129581451416
local_in_edges_tensor generation:  0.023239612579345703
mini_batch_src_global generation:  0.04119563102722168
r_  generation:  0.34156012535095215
local_output_nid generation:  0.02016472816467285
local_in_edges_tensor generation:  0.026255130767822266
mini_batch_src_global generation:  0.04326438903808594
r_  generation:  0.3445711135864258
----------------------check_connections_block total spend ----------------------------- 3.9766509532928467
generate_one_block  0.4535074234008789
generate_one_block  0.4617774486541748
generate_one_block  0.4697732925415039
generate_one_block  0.45009422302246094
generate_one_block  0.4531900882720947
generate_one_block  0.464993953704834
generate_one_block  0.4866335391998291
generate_one_block  0.4937286376953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04370713233947754
gen group dst list time:  0.038537025451660156
time for parepare:  0.019266605377197266
local_output_nid generation:  0.031241893768310547
local_in_edges_tensor generation:  0.05624985694885254
mini_batch_src_global generation:  0.05101203918457031
r_  generation:  0.4776172637939453
local_output_nid generation:  0.03839397430419922
local_in_edges_tensor generation:  0.051514387130737305
mini_batch_src_global generation:  0.0541377067565918
r_  generation:  0.4949972629547119
local_output_nid generation:  0.03820180892944336
local_in_edges_tensor generation:  0.043380022048950195
mini_batch_src_global generation:  0.05051708221435547
r_  generation:  0.499068021774292
local_output_nid generation:  0.03826618194580078
local_in_edges_tensor generation:  0.03837442398071289
mini_batch_src_global generation:  0.053838491439819336
r_  generation:  0.4907393455505371
local_output_nid generation:  0.03794670104980469
local_in_edges_tensor generation:  0.03966927528381348
mini_batch_src_global generation:  0.05329132080078125
r_  generation:  0.5012695789337158
local_output_nid generation:  0.03821253776550293
local_in_edges_tensor generation:  0.044222354888916016
mini_batch_src_global generation:  0.054579973220825195
r_  generation:  0.49546003341674805
local_output_nid generation:  0.037932634353637695
local_in_edges_tensor generation:  0.03811335563659668
mini_batch_src_global generation:  0.0532686710357666
r_  generation:  0.5118217468261719
local_output_nid generation:  0.03865480422973633
local_in_edges_tensor generation:  0.03868389129638672
mini_batch_src_global generation:  0.05525684356689453
r_  generation:  0.49907422065734863
----------------------check_connections_block total spend ----------------------------- 5.926137924194336
generate_one_block  0.6504132747650146
generate_one_block  0.6520953178405762
generate_one_block  0.6660759449005127
generate_one_block  0.6546604633331299
generate_one_block  0.6470057964324951
generate_one_block  0.6568198204040527
generate_one_block  0.6450824737548828
generate_one_block  0.6491801738739014
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.13594675064086914  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

connection checking time:  9.902788877487183
block generation total time  8.955031871795654
average batch blocks generation time:  1.1193789839744568
block dataloader generation time/epoch 21.293142795562744
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10242176055908203  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160451, 128])
torch.Size([142279, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.770799160003662  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10194921493530273  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160854, 128])
torch.Size([143047, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.861632823944092  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.1029062271118164  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([161064, 128])
torch.Size([143174, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.85614824295044  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.1026296615600586  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160742, 128])
torch.Size([142792, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.777554035186768  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.1023564338684082  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160934, 128])
torch.Size([142858, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.793982028961182  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10235595703125  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160883, 128])
torch.Size([143096, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.818044185638428  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10227108001708984  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160763, 128])
torch.Size([142764, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.7967848777771  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 0.10236883163452148  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

torch.Size([160796, 128])
torch.Size([143247, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 15.84902572631836  GigaBytes
Max Memory Allocated: 15.925343036651611  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0446162223815918 |0.021365612745285034 |0.4362679123878479 |0.00010025501251220703 |0.6591010987758636 |0.006050825119018555 |
----------------------------------------------------------pseudo_mini_loss sum 3.7952537536621094
Total (block generation + training)time/epoch 30.618284940719604
Training time/epoch 9.324857234954834
Training time without block to device /epoch 9.153932332992554
Training time without total dataloading part /epoch 8.769804954528809
load block tensor time/epoch 0.3569297790527344
block to device time/epoch 0.17092490196228027
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3019084
Number of first layer input nodes during this epoch:  1286487
