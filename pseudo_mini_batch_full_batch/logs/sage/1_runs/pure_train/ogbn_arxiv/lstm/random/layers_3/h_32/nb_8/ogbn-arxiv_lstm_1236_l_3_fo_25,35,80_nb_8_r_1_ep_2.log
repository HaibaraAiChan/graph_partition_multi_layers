Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648454161.8920987
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027776241302490234
random selection method range initialization spend 0.005602836608886719
time for parepare:  0.019239187240600586
local_output_nid generation:  0.004240751266479492
local_in_edges_tensor generation:  0.0064697265625
mini_batch_src_global generation:  0.004050016403198242
r_  generation:  0.04103994369506836
local_output_nid generation:  0.0057833194732666016
local_in_edges_tensor generation:  0.003255128860473633
mini_batch_src_global generation:  0.00511932373046875
r_  generation:  0.0448300838470459
local_output_nid generation:  0.006086111068725586
local_in_edges_tensor generation:  0.0032396316528320312
mini_batch_src_global generation:  0.0037665367126464844
r_  generation:  0.04509592056274414
local_output_nid generation:  0.006104469299316406
local_in_edges_tensor generation:  0.0032377243041992188
mini_batch_src_global generation:  0.0038394927978515625
r_  generation:  0.04632878303527832
local_output_nid generation:  0.006161928176879883
local_in_edges_tensor generation:  0.003305196762084961
mini_batch_src_global generation:  0.004103422164916992
r_  generation:  0.04772639274597168
local_output_nid generation:  0.006167173385620117
local_in_edges_tensor generation:  0.0032820701599121094
mini_batch_src_global generation:  0.004298686981201172
r_  generation:  0.04713559150695801
local_output_nid generation:  0.006106853485107422
local_in_edges_tensor generation:  0.0033206939697265625
mini_batch_src_global generation:  0.004384756088256836
r_  generation:  0.047182559967041016
local_output_nid generation:  0.006186246871948242
local_in_edges_tensor generation:  0.003287792205810547
mini_batch_src_global generation:  0.0044422149658203125
r_  generation:  0.05778837203979492
----------------------check_connections_block total spend ----------------------------- 0.5960102081298828
generate_one_block  0.0605165958404541
generate_one_block  0.06291699409484863
generate_one_block  0.06228017807006836
generate_one_block  0.0617985725402832
generate_one_block  0.06615948677062988
generate_one_block  0.06134390830993652
generate_one_block  0.061173439025878906
generate_one_block  0.06016373634338379
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03832602500915527
gen group dst list time:  0.016457796096801758
time for parepare:  0.020240068435668945
local_output_nid generation:  0.014293193817138672
local_in_edges_tensor generation:  0.0332026481628418
mini_batch_src_global generation:  0.0328061580657959
r_  generation:  0.3098597526550293
local_output_nid generation:  0.023673534393310547
local_in_edges_tensor generation:  0.03300881385803223
mini_batch_src_global generation:  0.04401373863220215
r_  generation:  0.32558250427246094
local_output_nid generation:  0.02320551872253418
local_in_edges_tensor generation:  0.023142576217651367
mini_batch_src_global generation:  0.040883541107177734
r_  generation:  0.33263611793518066
local_output_nid generation:  0.023383617401123047
local_in_edges_tensor generation:  0.02676558494567871
mini_batch_src_global generation:  0.043227434158325195
r_  generation:  0.3326411247253418
local_output_nid generation:  0.023222684860229492
local_in_edges_tensor generation:  0.026607275009155273
mini_batch_src_global generation:  0.04515242576599121
r_  generation:  0.33687591552734375
local_output_nid generation:  0.02363443374633789
local_in_edges_tensor generation:  0.020610809326171875
mini_batch_src_global generation:  0.04393815994262695
r_  generation:  0.33588433265686035
local_output_nid generation:  0.023157119750976562
local_in_edges_tensor generation:  0.02363872528076172
mini_batch_src_global generation:  0.042643070220947266
r_  generation:  0.3328828811645508
local_output_nid generation:  0.027176856994628906
local_in_edges_tensor generation:  0.02349543571472168
mini_batch_src_global generation:  0.04261279106140137
r_  generation:  0.3306252956390381
----------------------check_connections_block total spend ----------------------------- 3.9716806411743164
generate_one_block  0.42763209342956543
generate_one_block  0.4440796375274658
generate_one_block  0.43555378913879395
generate_one_block  0.4439418315887451
generate_one_block  0.4385397434234619
generate_one_block  0.4451746940612793
generate_one_block  0.4304215908050537
generate_one_block  0.43259143829345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03325605392456055
gen group dst list time:  0.036492109298706055
time for parepare:  0.019214391708374023
local_output_nid generation:  0.027943849563598633
local_in_edges_tensor generation:  0.043541908264160156
mini_batch_src_global generation:  0.048367977142333984
r_  generation:  0.4722273349761963
local_output_nid generation:  0.034609317779541016
local_in_edges_tensor generation:  0.04798603057861328
mini_batch_src_global generation:  0.05783987045288086
r_  generation:  0.47493696212768555
local_output_nid generation:  0.0341184139251709
local_in_edges_tensor generation:  0.03705596923828125
mini_batch_src_global generation:  0.05513286590576172
r_  generation:  0.4937903881072998
local_output_nid generation:  0.034448862075805664
local_in_edges_tensor generation:  0.035773515701293945
mini_batch_src_global generation:  0.0574498176574707
r_  generation:  0.48687005043029785
local_output_nid generation:  0.03466176986694336
local_in_edges_tensor generation:  0.041004180908203125
mini_batch_src_global generation:  0.0556638240814209
r_  generation:  0.49994659423828125
local_output_nid generation:  0.034258127212524414
local_in_edges_tensor generation:  0.03697371482849121
mini_batch_src_global generation:  0.058823585510253906
r_  generation:  0.4924039840698242
local_output_nid generation:  0.03466653823852539
local_in_edges_tensor generation:  0.03180885314941406
mini_batch_src_global generation:  0.057329654693603516
r_  generation:  0.5018317699432373
local_output_nid generation:  0.03430533409118652
local_in_edges_tensor generation:  0.03198885917663574
mini_batch_src_global generation:  0.058657169342041016
r_  generation:  0.493117094039917
----------------------check_connections_block total spend ----------------------------- 5.845612049102783
generate_one_block  0.6159744262695312
generate_one_block  0.6267435550689697
generate_one_block  0.6226398944854736
generate_one_block  0.6257598400115967
generate_one_block  0.6294870376586914
generate_one_block  0.6326050758361816
generate_one_block  0.637030839920044
generate_one_block  0.6086258888244629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  9.8172926902771
block generation total time  8.496801376342773
average batch blocks generation time:  1.0621001720428467
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.09775257110595703  GigaBytes
Max Memory Allocated: 0.09775257110595703  GigaBytes

torch.Size([160714, 128])
torch.Size([142989, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8670654296875 GB
    Memory Allocated: 13.538143157958984  GigaBytes
Max Memory Allocated: 13.552932262420654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 0.10023164749145508  GigaBytes
Max Memory Allocated: 13.552932262420654  GigaBytes

torch.Size([160794, 128])
torch.Size([142978, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1541748046875 GB
    Memory Allocated: 13.58725643157959  GigaBytes
Max Memory Allocated: 13.603532791137695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1541748046875 GB
    Memory Allocated: 0.10015869140625  GigaBytes
Max Memory Allocated: 13.603532791137695  GigaBytes

torch.Size([160849, 128])
torch.Size([142903, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1541748046875 GB
    Memory Allocated: 13.553622245788574  GigaBytes
Max Memory Allocated: 13.603532791137695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1541748046875 GB
    Memory Allocated: 0.10015344619750977  GigaBytes
Max Memory Allocated: 13.603532791137695  GigaBytes

torch.Size([160724, 128])
torch.Size([142988, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1541748046875 GB
    Memory Allocated: 13.576963424682617  GigaBytes
Max Memory Allocated: 13.603532791137695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1541748046875 GB
    Memory Allocated: 0.10038900375366211  GigaBytes
Max Memory Allocated: 13.603532791137695  GigaBytes

torch.Size([161088, 128])
torch.Size([143265, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.589975833892822  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10023021697998047  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160965, 128])
torch.Size([143087, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.56044864654541  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.1002049446105957  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([161090, 128])
torch.Size([143117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.543121814727783  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10007381439208984  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160887, 128])
torch.Size([142638, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.524007320404053  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040407806634902954 |0.05646064877510071 |0.509910374879837 |0.00010958313941955566 |0.7103849649429321 |0.008998632431030273 |
----------------------------------------------------------pseudo_mini_loss sum 4.402548313140869
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021111
Number of first layer input nodes during this epoch:  1287111
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.13282299041748047  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02329540252685547
random selection method range initialization spend 0.004997730255126953
time for parepare:  0.018485307693481445
local_output_nid generation:  0.0050356388092041016
local_in_edges_tensor generation:  0.008996248245239258
mini_batch_src_global generation:  0.00403141975402832
r_  generation:  0.041311025619506836
local_output_nid generation:  0.006918907165527344
local_in_edges_tensor generation:  0.0034317970275878906
mini_batch_src_global generation:  0.005017995834350586
r_  generation:  0.04477190971374512
local_output_nid generation:  0.0070629119873046875
local_in_edges_tensor generation:  0.003359079360961914
mini_batch_src_global generation:  0.0035288333892822266
r_  generation:  0.04546689987182617
local_output_nid generation:  0.007180690765380859
local_in_edges_tensor generation:  0.0035867691040039062
mini_batch_src_global generation:  0.0038504600524902344
r_  generation:  0.04725980758666992
local_output_nid generation:  0.007170438766479492
local_in_edges_tensor generation:  0.0034668445587158203
mini_batch_src_global generation:  0.0039539337158203125
r_  generation:  0.0475313663482666
local_output_nid generation:  0.007197856903076172
local_in_edges_tensor generation:  0.003735065460205078
mini_batch_src_global generation:  0.004580020904541016
r_  generation:  0.05067014694213867
local_output_nid generation:  0.00724482536315918
local_in_edges_tensor generation:  0.0034596920013427734
mini_batch_src_global generation:  0.004430055618286133
r_  generation:  0.05121779441833496
local_output_nid generation:  0.007268190383911133
local_in_edges_tensor generation:  0.0035314559936523438
mini_batch_src_global generation:  0.0043261051177978516
r_  generation:  0.04864835739135742
----------------------check_connections_block total spend ----------------------------- 0.6099560260772705
generate_one_block  0.07473349571228027
generate_one_block  0.07127523422241211
generate_one_block  0.07123422622680664
generate_one_block  0.07210159301757812
generate_one_block  0.0731201171875
generate_one_block  0.07571196556091309
generate_one_block  0.07599639892578125
generate_one_block  0.07371282577514648
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03248882293701172
gen group dst list time:  0.016417264938354492
time for parepare:  0.022324800491333008
local_output_nid generation:  0.015074729919433594
local_in_edges_tensor generation:  0.031232595443725586
mini_batch_src_global generation:  0.03258228302001953
r_  generation:  0.31610846519470215
local_output_nid generation:  0.020658493041992188
local_in_edges_tensor generation:  0.031061887741088867
mini_batch_src_global generation:  0.04284262657165527
r_  generation:  0.3297102451324463
local_output_nid generation:  0.019742488861083984
local_in_edges_tensor generation:  0.026370525360107422
mini_batch_src_global generation:  0.040395498275756836
r_  generation:  0.3372802734375
local_output_nid generation:  0.020089387893676758
local_in_edges_tensor generation:  0.026372909545898438
mini_batch_src_global generation:  0.04200601577758789
r_  generation:  0.341249942779541
local_output_nid generation:  0.019849538803100586
local_in_edges_tensor generation:  0.02050614356994629
mini_batch_src_global generation:  0.04241132736206055
r_  generation:  0.33981943130493164
local_output_nid generation:  0.020168781280517578
local_in_edges_tensor generation:  0.027724027633666992
mini_batch_src_global generation:  0.045729875564575195
r_  generation:  0.3538632392883301
local_output_nid generation:  0.020061969757080078
local_in_edges_tensor generation:  0.023768186569213867
mini_batch_src_global generation:  0.04323267936706543
r_  generation:  0.35115933418273926
local_output_nid generation:  0.020174741744995117
local_in_edges_tensor generation:  0.022719144821166992
mini_batch_src_global generation:  0.04588437080383301
r_  generation:  0.35288214683532715
----------------------check_connections_block total spend ----------------------------- 4.042171955108643
generate_one_block  0.4829139709472656
generate_one_block  0.4573855400085449
generate_one_block  0.46790099143981934
generate_one_block  0.45994114875793457
generate_one_block  0.4771084785461426
generate_one_block  0.4897031784057617
generate_one_block  0.4626200199127197
generate_one_block  0.4872171878814697
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04800891876220703
gen group dst list time:  0.03688335418701172
time for parepare:  0.019510269165039062
local_output_nid generation:  0.02887868881225586
local_in_edges_tensor generation:  0.058161258697509766
mini_batch_src_global generation:  0.048517465591430664
r_  generation:  0.4799306392669678
local_output_nid generation:  0.035817623138427734
local_in_edges_tensor generation:  0.05188894271850586
mini_batch_src_global generation:  0.05806612968444824
r_  generation:  0.4848930835723877
local_output_nid generation:  0.03507351875305176
local_in_edges_tensor generation:  0.04801177978515625
mini_batch_src_global generation:  0.05471611022949219
r_  generation:  0.4966702461242676
local_output_nid generation:  0.035135746002197266
local_in_edges_tensor generation:  0.039463043212890625
mini_batch_src_global generation:  0.05759739875793457
r_  generation:  0.5019965171813965
local_output_nid generation:  0.0349576473236084
local_in_edges_tensor generation:  0.04008960723876953
mini_batch_src_global generation:  0.057159423828125
r_  generation:  0.5107204914093018
local_output_nid generation:  0.036951303482055664
local_in_edges_tensor generation:  0.050137996673583984
mini_batch_src_global generation:  0.05829596519470215
r_  generation:  0.4986684322357178
local_output_nid generation:  0.035578250885009766
local_in_edges_tensor generation:  0.03964567184448242
mini_batch_src_global generation:  0.05735182762145996
r_  generation:  0.5199975967407227
local_output_nid generation:  0.03527235984802246
local_in_edges_tensor generation:  0.047728538513183594
mini_batch_src_global generation:  0.06469082832336426
r_  generation:  0.49697375297546387
----------------------check_connections_block total spend ----------------------------- 6.0229716300964355
generate_one_block  0.6545484066009521
generate_one_block  0.6411001682281494
generate_one_block  0.6527178287506104
generate_one_block  0.6497371196746826
generate_one_block  0.6430096626281738
generate_one_block  0.6594786643981934
generate_one_block  0.6445341110229492
generate_one_block  0.628485918045044
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.13282299041748047  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

connection checking time:  10.065143585205078
block generation total time  8.958402395248413
average batch blocks generation time:  1.1198002994060516
block dataloader generation time/epoch 21.455634355545044
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10117578506469727  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160741, 128])
torch.Size([142571, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.506793975830078  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10123872756958008  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160844, 128])
torch.Size([142651, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.510162353515625  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10136079788208008  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160792, 128])
torch.Size([142794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.565323829650879  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10123968124389648  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160648, 128])
torch.Size([142646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.549914836883545  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.10131454467773438  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([160847, 128])
torch.Size([142686, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 13.546068668365479  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 0.1016836166381836  GigaBytes
Max Memory Allocated: 13.606169700622559  GigaBytes

torch.Size([161017, 128])
torch.Size([143409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8983154296875 GB
    Memory Allocated: 13.632168769836426  GigaBytes
Max Memory Allocated: 13.648818969726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8983154296875 GB
    Memory Allocated: 0.10146856307983398  GigaBytes
Max Memory Allocated: 13.648818969726562  GigaBytes

torch.Size([161114, 128])
torch.Size([143328, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8983154296875 GB
    Memory Allocated: 13.557502269744873  GigaBytes
Max Memory Allocated: 13.648818969726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8983154296875 GB
    Memory Allocated: 0.1013784408569336  GigaBytes
Max Memory Allocated: 13.648818969726562  GigaBytes

torch.Size([160835, 128])
torch.Size([142661, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8983154296875 GB
    Memory Allocated: 13.551141738891602  GigaBytes
Max Memory Allocated: 13.648818969726562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04048207402229309 |0.018613040447235107 |0.44005587697029114 |0.00010016560554504395 |0.7005917429924011 |0.003970623016357422 |
----------------------------------------------------------pseudo_mini_loss sum 3.705739974975586
Total (block generation + training)time/epoch 31.078591108322144
Training time/epoch 9.622735261917114
Training time without block to device /epoch 9.473830938339233
Training time without total dataloading part /epoch 9.129952907562256
load block tensor time/epoch 0.3238565921783447
block to device time/epoch 0.14890432357788086
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3018668
Number of first layer input nodes during this epoch:  1286838
