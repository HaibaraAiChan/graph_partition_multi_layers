Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648459091.6938279
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026845216751098633
random selection method range initialization spend 0.006425142288208008
time for parepare:  0.018665552139282227
local_output_nid generation:  0.00215911865234375
local_in_edges_tensor generation:  0.005155801773071289
mini_batch_src_global generation:  0.0020554065704345703
r_  generation:  0.020963191986083984
local_output_nid generation:  0.0027112960815429688
local_in_edges_tensor generation:  0.0017468929290771484
mini_batch_src_global generation:  0.0024051666259765625
r_  generation:  0.020535707473754883
local_output_nid generation:  0.002907991409301758
local_in_edges_tensor generation:  0.0016183853149414062
mini_batch_src_global generation:  0.0015990734100341797
r_  generation:  0.020533323287963867
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0015587806701660156
mini_batch_src_global generation:  0.0015437602996826172
r_  generation:  0.020105361938476562
local_output_nid generation:  0.0029344558715820312
local_in_edges_tensor generation:  0.0016241073608398438
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.0204160213470459
local_output_nid generation:  0.002910137176513672
local_in_edges_tensor generation:  0.001486063003540039
mini_batch_src_global generation:  0.014596939086914062
r_  generation:  0.02040386199951172
local_output_nid generation:  0.002949953079223633
local_in_edges_tensor generation:  0.0015254020690917969
mini_batch_src_global generation:  0.0017075538635253906
r_  generation:  0.022119760513305664
local_output_nid generation:  0.002951383590698242
local_in_edges_tensor generation:  0.0015377998352050781
mini_batch_src_global generation:  0.012946605682373047
r_  generation:  0.021482229232788086
local_output_nid generation:  0.0029900074005126953
local_in_edges_tensor generation:  0.0015249252319335938
mini_batch_src_global generation:  0.00478363037109375
r_  generation:  0.021160364151000977
local_output_nid generation:  0.002980947494506836
local_in_edges_tensor generation:  0.0014920234680175781
mini_batch_src_global generation:  0.0016980171203613281
r_  generation:  0.02202892303466797
local_output_nid generation:  0.002945423126220703
local_in_edges_tensor generation:  0.0014929771423339844
mini_batch_src_global generation:  0.0017464160919189453
r_  generation:  0.02145862579345703
local_output_nid generation:  0.0029604434967041016
local_in_edges_tensor generation:  0.0015118122100830078
mini_batch_src_global generation:  0.0017712116241455078
r_  generation:  0.022249460220336914
local_output_nid generation:  0.0030183792114257812
local_in_edges_tensor generation:  0.0015838146209716797
mini_batch_src_global generation:  0.0017859935760498047
r_  generation:  0.021771907806396484
local_output_nid generation:  0.0029752254486083984
local_in_edges_tensor generation:  0.0015397071838378906
mini_batch_src_global generation:  0.001837015151977539
r_  generation:  0.02223348617553711
local_output_nid generation:  0.0030167102813720703
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.0018610954284667969
r_  generation:  0.022014617919921875
local_output_nid generation:  0.002950906753540039
local_in_edges_tensor generation:  0.0014994144439697266
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.02161240577697754
----------------------check_connections_block total spend ----------------------------- 0.5763285160064697
generate_one_block  0.031554222106933594
generate_one_block  0.03155827522277832
generate_one_block  0.035024166107177734
generate_one_block  0.031629323959350586
generate_one_block  0.031586408615112305
generate_one_block  0.030178546905517578
generate_one_block  0.032460689544677734
generate_one_block  0.032071590423583984
generate_one_block  0.03183555603027344
generate_one_block  0.031638145446777344
generate_one_block  0.031378746032714844
generate_one_block  0.032198190689086914
generate_one_block  0.031517982482910156
generate_one_block  0.032119035720825195
generate_one_block  0.03229856491088867
generate_one_block  0.031048297882080078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04090714454650879
gen group dst list time:  0.02076244354248047
time for parepare:  0.01993107795715332
local_output_nid generation:  0.009398698806762695
local_in_edges_tensor generation:  0.022854089736938477
mini_batch_src_global generation:  0.02792048454284668
r_  generation:  0.25430798530578613
local_output_nid generation:  0.01582503318786621
local_in_edges_tensor generation:  0.02529287338256836
mini_batch_src_global generation:  0.03275775909423828
r_  generation:  0.2735118865966797
local_output_nid generation:  0.01649928092956543
local_in_edges_tensor generation:  0.02104496955871582
mini_batch_src_global generation:  0.0343170166015625
r_  generation:  0.28701257705688477
local_output_nid generation:  0.016362667083740234
local_in_edges_tensor generation:  0.03468513488769531
mini_batch_src_global generation:  0.039328813552856445
r_  generation:  0.26160740852355957
local_output_nid generation:  0.01345515251159668
local_in_edges_tensor generation:  0.020358800888061523
mini_batch_src_global generation:  0.03287053108215332
r_  generation:  0.26671385765075684
local_output_nid generation:  0.01305246353149414
local_in_edges_tensor generation:  0.013851642608642578
mini_batch_src_global generation:  0.032689809799194336
r_  generation:  0.2610149383544922
local_output_nid generation:  0.013906240463256836
local_in_edges_tensor generation:  0.020050048828125
mini_batch_src_global generation:  0.03553295135498047
r_  generation:  0.2764265537261963
local_output_nid generation:  0.013672828674316406
local_in_edges_tensor generation:  0.019097566604614258
mini_batch_src_global generation:  0.034089088439941406
r_  generation:  0.2713191509246826
local_output_nid generation:  0.013502836227416992
local_in_edges_tensor generation:  0.016840219497680664
mini_batch_src_global generation:  0.034380435943603516
r_  generation:  0.272658109664917
local_output_nid generation:  0.013695478439331055
local_in_edges_tensor generation:  0.016103744506835938
mini_batch_src_global generation:  0.03365898132324219
r_  generation:  0.2787632942199707
local_output_nid generation:  0.013355731964111328
local_in_edges_tensor generation:  0.016340017318725586
mini_batch_src_global generation:  0.03401637077331543
r_  generation:  0.2691636085510254
local_output_nid generation:  0.013692855834960938
local_in_edges_tensor generation:  0.019379377365112305
mini_batch_src_global generation:  0.034356117248535156
r_  generation:  0.2781648635864258
local_output_nid generation:  0.013405561447143555
local_in_edges_tensor generation:  0.018527746200561523
mini_batch_src_global generation:  0.0345613956451416
r_  generation:  0.27161097526550293
local_output_nid generation:  0.013764142990112305
local_in_edges_tensor generation:  0.014350175857543945
mini_batch_src_global generation:  0.038537025451660156
r_  generation:  0.2824382781982422
local_output_nid generation:  0.013616323471069336
local_in_edges_tensor generation:  0.02176070213317871
mini_batch_src_global generation:  0.03487586975097656
r_  generation:  0.2778291702270508
local_output_nid generation:  0.016091346740722656
local_in_edges_tensor generation:  0.014327526092529297
mini_batch_src_global generation:  0.03439068794250488
r_  generation:  0.2695882320404053
----------------------check_connections_block total spend ----------------------------- 6.38064169883728
generate_one_block  0.3863525390625
generate_one_block  0.3603694438934326
generate_one_block  0.36330699920654297
generate_one_block  0.344829797744751
generate_one_block  0.3746497631072998
generate_one_block  0.34503936767578125
generate_one_block  0.3752763271331787
generate_one_block  0.3613765239715576
generate_one_block  0.35674476623535156
generate_one_block  0.3582801818847656
generate_one_block  0.3525252342224121
generate_one_block  0.38234400749206543
generate_one_block  0.362041711807251
generate_one_block  0.36847424507141113
generate_one_block  0.39925622940063477
generate_one_block  0.3511335849761963
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08204078674316406
gen group dst list time:  0.06706404685974121
time for parepare:  0.022131919860839844
local_output_nid generation:  0.039560794830322266
local_in_edges_tensor generation:  0.05832695960998535
mini_batch_src_global generation:  0.04965662956237793
r_  generation:  0.5248048305511475
local_output_nid generation:  0.03239035606384277
local_in_edges_tensor generation:  0.05405139923095703
mini_batch_src_global generation:  0.061156511306762695
r_  generation:  0.5230870246887207
local_output_nid generation:  0.03312230110168457
local_in_edges_tensor generation:  0.04948687553405762
mini_batch_src_global generation:  0.06229829788208008
r_  generation:  0.5325586795806885
local_output_nid generation:  0.032338619232177734
local_in_edges_tensor generation:  0.04519319534301758
mini_batch_src_global generation:  0.06373357772827148
r_  generation:  0.5466556549072266
local_output_nid generation:  0.03402900695800781
local_in_edges_tensor generation:  0.047695159912109375
mini_batch_src_global generation:  0.06356406211853027
r_  generation:  0.5326294898986816
local_output_nid generation:  0.03280043601989746
local_in_edges_tensor generation:  0.03501248359680176
mini_batch_src_global generation:  0.06042146682739258
r_  generation:  0.529125452041626
local_output_nid generation:  0.033856868743896484
local_in_edges_tensor generation:  0.03971982002258301
mini_batch_src_global generation:  0.06595730781555176
r_  generation:  0.5414013862609863
local_output_nid generation:  0.0333406925201416
local_in_edges_tensor generation:  0.04008746147155762
mini_batch_src_global generation:  0.06382942199707031
r_  generation:  0.5445950031280518
local_output_nid generation:  0.03485417366027832
local_in_edges_tensor generation:  0.057860374450683594
mini_batch_src_global generation:  0.06218910217285156
r_  generation:  0.557741641998291
local_output_nid generation:  0.03365778923034668
local_in_edges_tensor generation:  0.03894352912902832
mini_batch_src_global generation:  0.0685124397277832
r_  generation:  0.5397953987121582
local_output_nid generation:  0.033501625061035156
local_in_edges_tensor generation:  0.03929901123046875
mini_batch_src_global generation:  0.06600451469421387
r_  generation:  0.5381112098693848
local_output_nid generation:  0.034145355224609375
local_in_edges_tensor generation:  0.03180360794067383
mini_batch_src_global generation:  0.061109066009521484
r_  generation:  0.5389480590820312
local_output_nid generation:  0.033385515213012695
local_in_edges_tensor generation:  0.03629326820373535
mini_batch_src_global generation:  0.062068939208984375
r_  generation:  0.5406389236450195
local_output_nid generation:  0.03364443778991699
local_in_edges_tensor generation:  0.036307334899902344
mini_batch_src_global generation:  0.06535100936889648
r_  generation:  0.5423433780670166
local_output_nid generation:  0.03364992141723633
local_in_edges_tensor generation:  0.04175829887390137
mini_batch_src_global generation:  0.06108713150024414
r_  generation:  0.5390081405639648
local_output_nid generation:  0.033242225646972656
local_in_edges_tensor generation:  0.03128480911254883
mini_batch_src_global generation:  0.06560873985290527
r_  generation:  0.5414113998413086
----------------------check_connections_block total spend ----------------------------- 12.771124839782715
generate_one_block  0.6890575885772705
generate_one_block  0.6878986358642578
generate_one_block  0.6881427764892578
generate_one_block  0.6756801605224609
generate_one_block  0.6705067157745361
generate_one_block  0.6756765842437744
generate_one_block  0.7514712810516357
generate_one_block  0.6852269172668457
generate_one_block  0.6788387298583984
generate_one_block  0.678002119064331
generate_one_block  0.6798155307769775
generate_one_block  0.6832311153411865
generate_one_block  0.669215202331543
generate_one_block  0.6975095272064209
generate_one_block  0.681143045425415
generate_one_block  0.678656816482544
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  19.151766538619995
block generation total time  16.812073469161987
average batch blocks generation time:  1.0507545918226242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09600639343261719  GigaBytes
Max Memory Allocated: 0.09600639343261719  GigaBytes

torch.Size([157523, 128])
torch.Size([130523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.8416748046875 GB
    Memory Allocated: 16.420639038085938  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4803466796875 GB
    Memory Allocated: 0.09731864929199219  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

torch.Size([157672, 128])
torch.Size([129694, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 16.315932750701904  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 0.0974884033203125  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

torch.Size([157622, 128])
torch.Size([130346, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 16.412402629852295  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 0.09711122512817383  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

torch.Size([157541, 128])
torch.Size([129284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 16.220884323120117  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 0.09720659255981445  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

torch.Size([157477, 128])
torch.Size([129724, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 16.303703784942627  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 0.09693670272827148  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

torch.Size([157337, 128])
torch.Size([128784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 16.15959644317627  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5096435546875 GB
    Memory Allocated: 0.09857177734375  GigaBytes
Max Memory Allocated: 16.436737060546875  GigaBytes

torch.Size([157843, 128])
torch.Size([130539, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.440693855285645  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09749031066894531  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157832, 128])
torch.Size([130619, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.364153385162354  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09738588333129883  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157661, 128])
torch.Size([130336, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.35580015182495  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.0973353385925293  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157585, 128])
torch.Size([129757, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.340482711791992  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09729671478271484  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157566, 128])
torch.Size([129577, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.319725513458252  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09746217727661133  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157471, 128])
torch.Size([129832, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.424092292785645  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09721803665161133  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157415, 128])
torch.Size([129285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.312133312225342  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09768962860107422  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([158004, 128])
torch.Size([130900, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.419185161590576  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.0973367691040039  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157426, 128])
torch.Size([129976, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.368208408355713  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09725427627563477  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157647, 128])
torch.Size([130170, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.266270637512207  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03702685236930847 |0.044851914048194885 |0.6920620054006577 |0.00011210143566131592 |1.0507319867610931 |0.014085054397583008 |
----------------------------------------------------------pseudo_mini_loss sum 4.94920539855957
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5331576
Number of first layer input nodes during this epoch:  2521622
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.1280379295349121  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030502796173095703
random selection method range initialization spend 0.006048679351806641
time for parepare:  0.01932668685913086
local_output_nid generation:  0.00409698486328125
local_in_edges_tensor generation:  0.013213872909545898
mini_batch_src_global generation:  0.0023424625396728516
r_  generation:  0.020164966583251953
local_output_nid generation:  0.003432035446166992
local_in_edges_tensor generation:  0.0021469593048095703
mini_batch_src_global generation:  0.0025267601013183594
r_  generation:  0.021221637725830078
local_output_nid generation:  0.003328084945678711
local_in_edges_tensor generation:  0.002125263214111328
mini_batch_src_global generation:  0.0015726089477539062
r_  generation:  0.02131199836730957
local_output_nid generation:  0.003302335739135742
local_in_edges_tensor generation:  0.0020210742950439453
mini_batch_src_global generation:  0.0016856193542480469
r_  generation:  0.021764278411865234
local_output_nid generation:  0.0032367706298828125
local_in_edges_tensor generation:  0.001935720443725586
mini_batch_src_global generation:  0.0016787052154541016
r_  generation:  0.02200484275817871
local_output_nid generation:  0.0033228397369384766
local_in_edges_tensor generation:  0.0021026134490966797
mini_batch_src_global generation:  0.0017414093017578125
r_  generation:  0.021817445755004883
local_output_nid generation:  0.003289461135864258
local_in_edges_tensor generation:  0.001994609832763672
mini_batch_src_global generation:  0.0017654895782470703
r_  generation:  0.022559165954589844
local_output_nid generation:  0.0032546520233154297
local_in_edges_tensor generation:  0.001962423324584961
mini_batch_src_global generation:  0.0017511844635009766
r_  generation:  0.02149510383605957
local_output_nid generation:  0.003264904022216797
local_in_edges_tensor generation:  0.0019154548645019531
mini_batch_src_global generation:  0.0017726421356201172
r_  generation:  0.02344799041748047
local_output_nid generation:  0.004784822463989258
local_in_edges_tensor generation:  0.0036804676055908203
mini_batch_src_global generation:  0.002274751663208008
r_  generation:  0.022695302963256836
local_output_nid generation:  0.003244161605834961
local_in_edges_tensor generation:  0.002081155776977539
mini_batch_src_global generation:  0.0018846988677978516
r_  generation:  0.022582054138183594
local_output_nid generation:  0.0033283233642578125
local_in_edges_tensor generation:  0.0019440650939941406
mini_batch_src_global generation:  0.0018985271453857422
r_  generation:  0.022775650024414062
local_output_nid generation:  0.003269672393798828
local_in_edges_tensor generation:  0.0019121170043945312
mini_batch_src_global generation:  0.001766204833984375
r_  generation:  0.023297786712646484
local_output_nid generation:  0.0034029483795166016
local_in_edges_tensor generation:  0.001995563507080078
mini_batch_src_global generation:  0.0018346309661865234
r_  generation:  0.02297186851501465
local_output_nid generation:  0.0032677650451660156
local_in_edges_tensor generation:  0.0020449161529541016
mini_batch_src_global generation:  0.0019507408142089844
r_  generation:  0.02298903465270996
local_output_nid generation:  0.003286600112915039
local_in_edges_tensor generation:  0.0020279884338378906
mini_batch_src_global generation:  0.0018970966339111328
r_  generation:  0.02292490005493164
----------------------check_connections_block total spend ----------------------------- 0.6034858226776123
generate_one_block  0.04896807670593262
generate_one_block  0.03818559646606445
generate_one_block  0.03800797462463379
generate_one_block  0.03916049003601074
generate_one_block  0.03891444206237793
generate_one_block  0.04142260551452637
generate_one_block  0.0400385856628418
generate_one_block  0.03843855857849121
generate_one_block  0.0383913516998291
generate_one_block  0.03892254829406738
generate_one_block  0.03843545913696289
generate_one_block  0.03870558738708496
generate_one_block  0.038947343826293945
generate_one_block  0.03770756721496582
generate_one_block  0.03861236572265625
generate_one_block  0.04058122634887695
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05201077461242676
gen group dst list time:  0.019486665725708008
time for parepare:  0.021218299865722656
local_output_nid generation:  0.010824918746948242
local_in_edges_tensor generation:  0.03294539451599121
mini_batch_src_global generation:  0.026415586471557617
r_  generation:  0.24730706214904785
local_output_nid generation:  0.013947725296020508
local_in_edges_tensor generation:  0.024033784866333008
mini_batch_src_global generation:  0.03377842903137207
r_  generation:  0.2563893795013428
local_output_nid generation:  0.014329195022583008
local_in_edges_tensor generation:  0.017168045043945312
mini_batch_src_global generation:  0.03112006187438965
r_  generation:  0.2605781555175781
local_output_nid generation:  0.014795541763305664
local_in_edges_tensor generation:  0.022172927856445312
mini_batch_src_global generation:  0.03430747985839844
r_  generation:  0.27172183990478516
local_output_nid generation:  0.014176368713378906
local_in_edges_tensor generation:  0.01751255989074707
mini_batch_src_global generation:  0.03577995300292969
r_  generation:  0.272261381149292
local_output_nid generation:  0.01382899284362793
local_in_edges_tensor generation:  0.014873266220092773
mini_batch_src_global generation:  0.033907413482666016
r_  generation:  0.2685856819152832
local_output_nid generation:  0.013907194137573242
local_in_edges_tensor generation:  0.015110254287719727
mini_batch_src_global generation:  0.03613591194152832
r_  generation:  0.27382540702819824
local_output_nid generation:  0.013772726058959961
local_in_edges_tensor generation:  0.01709151268005371
mini_batch_src_global generation:  0.03372073173522949
r_  generation:  0.2633373737335205
local_output_nid generation:  0.013875484466552734
local_in_edges_tensor generation:  0.01715993881225586
mini_batch_src_global generation:  0.03627467155456543
r_  generation:  0.273193359375
local_output_nid generation:  0.013747453689575195
local_in_edges_tensor generation:  0.01942300796508789
mini_batch_src_global generation:  0.03436088562011719
r_  generation:  0.27075743675231934
local_output_nid generation:  0.013763904571533203
local_in_edges_tensor generation:  0.017035961151123047
mini_batch_src_global generation:  0.03625798225402832
r_  generation:  0.2710416316986084
local_output_nid generation:  0.013931035995483398
local_in_edges_tensor generation:  0.017078638076782227
mini_batch_src_global generation:  0.03711724281311035
r_  generation:  0.27458691596984863
local_output_nid generation:  0.013969659805297852
local_in_edges_tensor generation:  0.014626741409301758
mini_batch_src_global generation:  0.03509879112243652
r_  generation:  0.27698349952697754
local_output_nid generation:  0.013664007186889648
local_in_edges_tensor generation:  0.014289617538452148
mini_batch_src_global generation:  0.03446650505065918
r_  generation:  0.267531156539917
local_output_nid generation:  0.013895034790039062
local_in_edges_tensor generation:  0.01742267608642578
mini_batch_src_global generation:  0.03446841239929199
r_  generation:  0.2722814083099365
local_output_nid generation:  0.014125347137451172
local_in_edges_tensor generation:  0.019625425338745117
mini_batch_src_global generation:  0.039041757583618164
r_  generation:  0.2778301239013672
----------------------check_connections_block total spend ----------------------------- 6.302121162414551
generate_one_block  0.37584519386291504
generate_one_block  0.3731191158294678
generate_one_block  0.37670040130615234
generate_one_block  0.3841071128845215
generate_one_block  0.3847813606262207
generate_one_block  0.37479114532470703
generate_one_block  0.4043843746185303
generate_one_block  0.36472082138061523
generate_one_block  0.375258207321167
generate_one_block  0.3690497875213623
generate_one_block  0.37421441078186035
generate_one_block  0.3826320171356201
generate_one_block  0.38475918769836426
generate_one_block  0.36519813537597656
generate_one_block  0.37111473083496094
generate_one_block  0.3860352039337158
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05132722854614258
gen group dst list time:  0.06305527687072754
time for parepare:  0.018435001373291016
local_output_nid generation:  0.028209447860717773
local_in_edges_tensor generation:  0.04740190505981445
mini_batch_src_global generation:  0.05330467224121094
r_  generation:  0.5135858058929443
local_output_nid generation:  0.033661603927612305
local_in_edges_tensor generation:  0.05390644073486328
mini_batch_src_global generation:  0.0616145133972168
r_  generation:  0.5212063789367676
local_output_nid generation:  0.03334236145019531
local_in_edges_tensor generation:  0.04955744743347168
mini_batch_src_global generation:  0.05875372886657715
r_  generation:  0.5276284217834473
local_output_nid generation:  0.03343939781188965
local_in_edges_tensor generation:  0.03992772102355957
mini_batch_src_global generation:  0.06332182884216309
r_  generation:  0.535400390625
local_output_nid generation:  0.03376507759094238
local_in_edges_tensor generation:  0.08856773376464844
mini_batch_src_global generation:  0.06019759178161621
r_  generation:  0.5372974872589111
local_output_nid generation:  0.03358650207519531
local_in_edges_tensor generation:  0.03482699394226074
mini_batch_src_global generation:  0.06205415725708008
r_  generation:  0.5431680679321289
local_output_nid generation:  0.03355002403259277
local_in_edges_tensor generation:  0.035433292388916016
mini_batch_src_global generation:  0.061824798583984375
r_  generation:  0.541499137878418
local_output_nid generation:  0.03377127647399902
local_in_edges_tensor generation:  0.03910636901855469
mini_batch_src_global generation:  0.06220674514770508
r_  generation:  0.5455038547515869
local_output_nid generation:  0.03390359878540039
local_in_edges_tensor generation:  0.039427995681762695
mini_batch_src_global generation:  0.06491732597351074
r_  generation:  0.5434131622314453
local_output_nid generation:  0.033823490142822266
local_in_edges_tensor generation:  0.043833255767822266
mini_batch_src_global generation:  0.06200265884399414
r_  generation:  0.5440683364868164
local_output_nid generation:  0.03403186798095703
local_in_edges_tensor generation:  0.03945660591125488
mini_batch_src_global generation:  0.06204032897949219
r_  generation:  0.5440309047698975
local_output_nid generation:  0.03411865234375
local_in_edges_tensor generation:  0.04461479187011719
mini_batch_src_global generation:  0.061109066009521484
r_  generation:  0.5460777282714844
local_output_nid generation:  0.03432345390319824
local_in_edges_tensor generation:  0.03964352607727051
mini_batch_src_global generation:  0.06526732444763184
r_  generation:  0.547844648361206
local_output_nid generation:  0.03408551216125488
local_in_edges_tensor generation:  0.03513956069946289
mini_batch_src_global generation:  0.060977935791015625
r_  generation:  0.543424129486084
local_output_nid generation:  0.033812761306762695
local_in_edges_tensor generation:  0.04886484146118164
mini_batch_src_global generation:  0.06584906578063965
r_  generation:  0.5408775806427002
local_output_nid generation:  0.033980607986450195
local_in_edges_tensor generation:  0.04877281188964844
mini_batch_src_global generation:  0.0652627944946289
r_  generation:  0.549741268157959
----------------------check_connections_block total spend ----------------------------- 12.766424655914307
generate_one_block  0.7072494029998779
generate_one_block  0.7108478546142578
generate_one_block  0.7197141647338867
generate_one_block  0.7321376800537109
generate_one_block  0.7124185562133789
generate_one_block  0.7124307155609131
generate_one_block  0.7092764377593994
generate_one_block  0.7029750347137451
generate_one_block  0.7548213005065918
generate_one_block  0.7128257751464844
generate_one_block  0.7455863952636719
generate_one_block  0.7168762683868408
generate_one_block  0.7220554351806641
generate_one_block  0.7045612335205078
generate_one_block  0.7019972801208496
generate_one_block  0.7243256568908691
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.1280379295349121  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

connection checking time:  19.068545818328857
block generation total time  17.536810398101807
average batch blocks generation time:  1.096050649881363
block dataloader generation time/epoch 39.55974340438843
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09872245788574219  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157223, 128])
torch.Size([129363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.26401662826538  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09893608093261719  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157444, 128])
torch.Size([129626, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.317115306854248  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09898996353149414  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157543, 128])
torch.Size([129810, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.32376527786255  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.099334716796875  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157826, 128])
torch.Size([130576, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.43066120147705  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.10022735595703125  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157811, 128])
torch.Size([130118, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.414036750793457  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09912919998168945  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157807, 128])
torch.Size([130226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.32839059829712  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09904146194458008  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157461, 128])
torch.Size([129624, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.338095664978027  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09869050979614258  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157261, 128])
torch.Size([129409, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.21120595932007  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.10006427764892578  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157734, 128])
torch.Size([129984, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.33613681793213  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09901142120361328  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157702, 128])
torch.Size([129791, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.30929708480835  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.10004615783691406  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157714, 128])
torch.Size([130318, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.320086002349854  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09929800033569336  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157953, 128])
torch.Size([130504, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.386905670166016  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.10017967224121094  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([158028, 128])
torch.Size([130858, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.389240741729736  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.0987691879272461  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157318, 128])
torch.Size([129041, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.254364013671875  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09901189804077148  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157595, 128])
torch.Size([129958, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.320576190948486  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 0.09925174713134766  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

torch.Size([157714, 128])
torch.Size([130744, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5408935546875 GB
    Memory Allocated: 16.432487964630127  GigaBytes
Max Memory Allocated: 16.457934379577637  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029606088995933533 |0.025148779153823853 |0.6275105625391006 |0.00010132789611816406 |1.0200209766626358 |0.004857063293457031 |
----------------------------------------------------------pseudo_mini_loss sum 3.7914834022521973
Total (block generation + training)time/epoch 66.84049367904663
Training time/epoch 27.28049898147583
Training time without block to device /epoch 26.87811851501465
Training time without total dataloading part /epoch 26.36698293685913
load block tensor time/epoch 0.4736974239349365
block to device time/epoch 0.40238046646118164
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5332390
Number of first layer input nodes during this epoch:  2522134
