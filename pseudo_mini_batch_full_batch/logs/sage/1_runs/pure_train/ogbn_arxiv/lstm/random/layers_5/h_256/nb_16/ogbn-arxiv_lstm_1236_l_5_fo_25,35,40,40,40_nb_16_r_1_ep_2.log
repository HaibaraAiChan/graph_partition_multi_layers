Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648503720.9711456
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02432537078857422
random selection method range initialization spend 0.006353616714477539
time for parepare:  0.01840066909790039
local_output_nid generation:  0.0021429061889648438
local_in_edges_tensor generation:  0.0050678253173828125
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.0178375244140625
local_output_nid generation:  0.002547740936279297
local_in_edges_tensor generation:  0.0016314983367919922
mini_batch_src_global generation:  0.0021715164184570312
r_  generation:  0.01787567138671875
local_output_nid generation:  0.0028002262115478516
local_in_edges_tensor generation:  0.0016126632690429688
mini_batch_src_global generation:  0.0014712810516357422
r_  generation:  0.017745256423950195
local_output_nid generation:  0.002815723419189453
local_in_edges_tensor generation:  0.001516580581665039
mini_batch_src_global generation:  0.0013279914855957031
r_  generation:  0.01798725128173828
local_output_nid generation:  0.002824068069458008
local_in_edges_tensor generation:  0.001474142074584961
mini_batch_src_global generation:  0.0014324188232421875
r_  generation:  0.01850581169128418
local_output_nid generation:  0.002913236618041992
local_in_edges_tensor generation:  0.001468658447265625
mini_batch_src_global generation:  0.0014548301696777344
r_  generation:  0.018690824508666992
local_output_nid generation:  0.0027894973754882812
local_in_edges_tensor generation:  0.0014553070068359375
mini_batch_src_global generation:  0.0014793872833251953
r_  generation:  0.01904439926147461
local_output_nid generation:  0.0028314590454101562
local_in_edges_tensor generation:  0.001415252685546875
mini_batch_src_global generation:  0.001461029052734375
r_  generation:  0.01840972900390625
local_output_nid generation:  0.0028040409088134766
local_in_edges_tensor generation:  0.001440286636352539
mini_batch_src_global generation:  0.0014138221740722656
r_  generation:  0.01780104637145996
local_output_nid generation:  0.0028302669525146484
local_in_edges_tensor generation:  0.001356363296508789
mini_batch_src_global generation:  0.0014758110046386719
r_  generation:  0.018762588500976562
local_output_nid generation:  0.002881765365600586
local_in_edges_tensor generation:  0.0013895034790039062
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.018579721450805664
local_output_nid generation:  0.0028476715087890625
local_in_edges_tensor generation:  0.001373291015625
mini_batch_src_global generation:  0.0014760494232177734
r_  generation:  0.018393516540527344
local_output_nid generation:  0.0028009414672851562
local_in_edges_tensor generation:  0.0013720989227294922
mini_batch_src_global generation:  0.0015566349029541016
r_  generation:  0.018665790557861328
local_output_nid generation:  0.0028192996978759766
local_in_edges_tensor generation:  0.0013813972473144531
mini_batch_src_global generation:  0.0015554428100585938
r_  generation:  0.022892475128173828
local_output_nid generation:  0.0028820037841796875
local_in_edges_tensor generation:  0.00153350830078125
mini_batch_src_global generation:  0.0015559196472167969
r_  generation:  0.018912792205810547
local_output_nid generation:  0.002953767776489258
local_in_edges_tensor generation:  0.0014424324035644531
mini_batch_src_global generation:  0.0015647411346435547
r_  generation:  0.018738985061645508
----------------------check_connections_block total spend ----------------------------- 0.4899771213531494
generate_one_block  0.031993865966796875
generate_one_block  0.02851390838623047
generate_one_block  0.027524948120117188
generate_one_block  0.030489206314086914
generate_one_block  0.028078079223632812
generate_one_block  0.0278475284576416
generate_one_block  0.028731584548950195
generate_one_block  0.02841496467590332
generate_one_block  0.026967287063598633
generate_one_block  0.027334213256835938
generate_one_block  0.02748274803161621
generate_one_block  0.026877641677856445
generate_one_block  0.02739262580871582
generate_one_block  0.027399063110351562
generate_one_block  0.027011871337890625
generate_one_block  0.027281999588012695
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03847384452819824
gen group dst list time:  0.01899123191833496
time for parepare:  0.019137859344482422
local_output_nid generation:  0.0082550048828125
local_in_edges_tensor generation:  0.01885986328125
mini_batch_src_global generation:  0.01994943618774414
r_  generation:  0.20078325271606445
local_output_nid generation:  0.012041091918945312
local_in_edges_tensor generation:  0.02015089988708496
mini_batch_src_global generation:  0.02919316291809082
r_  generation:  0.20702457427978516
local_output_nid generation:  0.011703968048095703
local_in_edges_tensor generation:  0.01641535758972168
mini_batch_src_global generation:  0.02417922019958496
r_  generation:  0.210252046585083
local_output_nid generation:  0.011984586715698242
local_in_edges_tensor generation:  0.016371965408325195
mini_batch_src_global generation:  0.024794816970825195
r_  generation:  0.21061396598815918
local_output_nid generation:  0.011867284774780273
local_in_edges_tensor generation:  0.016037940979003906
mini_batch_src_global generation:  0.03490424156188965
r_  generation:  0.2197864055633545
local_output_nid generation:  0.011948823928833008
local_in_edges_tensor generation:  0.0164034366607666
mini_batch_src_global generation:  0.028922319412231445
r_  generation:  0.21985769271850586
local_output_nid generation:  0.01212763786315918
local_in_edges_tensor generation:  0.0163576602935791
mini_batch_src_global generation:  0.027364253997802734
r_  generation:  0.22008991241455078
local_output_nid generation:  0.01177215576171875
local_in_edges_tensor generation:  0.012509346008300781
mini_batch_src_global generation:  0.02713632583618164
r_  generation:  0.21254730224609375
local_output_nid generation:  0.01152181625366211
local_in_edges_tensor generation:  0.01213526725769043
mini_batch_src_global generation:  0.0259702205657959
r_  generation:  0.20932340621948242
local_output_nid generation:  0.01183772087097168
local_in_edges_tensor generation:  0.012630462646484375
mini_batch_src_global generation:  0.02892589569091797
r_  generation:  0.21798491477966309
local_output_nid generation:  0.011666536331176758
local_in_edges_tensor generation:  0.015984296798706055
mini_batch_src_global generation:  0.02666783332824707
r_  generation:  0.2200765609741211
local_output_nid generation:  0.01160287857055664
local_in_edges_tensor generation:  0.012433528900146484
mini_batch_src_global generation:  0.02713179588317871
r_  generation:  0.21228504180908203
local_output_nid generation:  0.011841297149658203
local_in_edges_tensor generation:  0.015614509582519531
mini_batch_src_global generation:  0.028980731964111328
r_  generation:  0.2195112705230713
local_output_nid generation:  0.01172494888305664
local_in_edges_tensor generation:  0.01418924331665039
mini_batch_src_global generation:  0.027734041213989258
r_  generation:  0.21384787559509277
local_output_nid generation:  0.011795759201049805
local_in_edges_tensor generation:  0.014324188232421875
mini_batch_src_global generation:  0.027515172958374023
r_  generation:  0.21929550170898438
local_output_nid generation:  0.011778116226196289
local_in_edges_tensor generation:  0.012224674224853516
mini_batch_src_global generation:  0.027317523956298828
r_  generation:  0.21345233917236328
----------------------check_connections_block total spend ----------------------------- 5.0667195320129395
generate_one_block  0.2811427116394043
generate_one_block  0.2796201705932617
generate_one_block  0.2778456211090088
generate_one_block  0.2935779094696045
generate_one_block  0.31060791015625
generate_one_block  0.29177141189575195
generate_one_block  0.28818440437316895
generate_one_block  0.2730998992919922
generate_one_block  0.26940345764160156
generate_one_block  0.2815852165222168
generate_one_block  0.27317357063293457
generate_one_block  0.27351951599121094
generate_one_block  0.2813699245452881
generate_one_block  0.26996684074401855
generate_one_block  0.2754948139190674
generate_one_block  0.277313232421875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.040705204010009766
gen group dst list time:  0.06183218955993652
time for parepare:  0.019314050674438477
local_output_nid generation:  0.025733232498168945
local_in_edges_tensor generation:  0.042130470275878906
mini_batch_src_global generation:  0.05071377754211426
r_  generation:  0.48100924491882324
local_output_nid generation:  0.031738996505737305
local_in_edges_tensor generation:  0.04747271537780762
mini_batch_src_global generation:  0.05749940872192383
r_  generation:  0.4901566505432129
local_output_nid generation:  0.030452251434326172
local_in_edges_tensor generation:  0.03487992286682129
mini_batch_src_global generation:  0.05773210525512695
r_  generation:  0.49252796173095703
local_output_nid generation:  0.030745267868041992
local_in_edges_tensor generation:  0.03878664970397949
mini_batch_src_global generation:  0.07301950454711914
r_  generation:  0.5127537250518799
local_output_nid generation:  0.03229045867919922
local_in_edges_tensor generation:  0.03807377815246582
mini_batch_src_global generation:  0.06364560127258301
r_  generation:  0.5065724849700928
local_output_nid generation:  0.03429126739501953
local_in_edges_tensor generation:  0.03479480743408203
mini_batch_src_global generation:  0.0606844425201416
r_  generation:  0.5057201385498047
local_output_nid generation:  0.03119182586669922
local_in_edges_tensor generation:  0.03913426399230957
mini_batch_src_global generation:  0.05911540985107422
r_  generation:  0.5060749053955078
local_output_nid generation:  0.031016111373901367
local_in_edges_tensor generation:  0.0302121639251709
mini_batch_src_global generation:  0.05991816520690918
r_  generation:  0.5082554817199707
local_output_nid generation:  0.030974149703979492
local_in_edges_tensor generation:  0.0426030158996582
mini_batch_src_global generation:  0.06683993339538574
r_  generation:  0.5072264671325684
local_output_nid generation:  0.03113269805908203
local_in_edges_tensor generation:  0.043250083923339844
mini_batch_src_global generation:  0.06291365623474121
r_  generation:  0.5056054592132568
local_output_nid generation:  0.030646800994873047
local_in_edges_tensor generation:  0.034842729568481445
mini_batch_src_global generation:  0.06099891662597656
r_  generation:  0.5309088230133057
local_output_nid generation:  0.031139850616455078
local_in_edges_tensor generation:  0.0393214225769043
mini_batch_src_global generation:  0.06303739547729492
r_  generation:  0.5102419853210449
local_output_nid generation:  0.031121015548706055
local_in_edges_tensor generation:  0.04200887680053711
mini_batch_src_global generation:  0.06451272964477539
r_  generation:  0.5083673000335693
local_output_nid generation:  0.03072357177734375
local_in_edges_tensor generation:  0.033050537109375
mini_batch_src_global generation:  0.07322478294372559
r_  generation:  0.5042567253112793
local_output_nid generation:  0.03237771987915039
local_in_edges_tensor generation:  0.03439831733703613
mini_batch_src_global generation:  0.06099557876586914
r_  generation:  0.5063979625701904
local_output_nid generation:  0.031744956970214844
local_in_edges_tensor generation:  0.03910088539123535
mini_batch_src_global generation:  0.06091117858886719
r_  generation:  0.5042204856872559
----------------------check_connections_block total spend ----------------------------- 11.933167219161987
generate_one_block  0.6390619277954102
generate_one_block  0.6953344345092773
generate_one_block  0.6895678043365479
generate_one_block  0.6618087291717529
generate_one_block  0.6732513904571533
generate_one_block  0.6855809688568115
generate_one_block  0.7520067691802979
generate_one_block  0.6631441116333008
generate_one_block  0.6642603874206543
generate_one_block  0.6542842388153076
generate_one_block  0.6395242214202881
generate_one_block  0.6461396217346191
generate_one_block  0.6572067737579346
generate_one_block  0.6537332534790039
generate_one_block  0.646465539932251
generate_one_block  0.649390697479248
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07130169868469238
gen group dst list time:  0.10661029815673828
time for parepare:  0.020905494689941406
local_output_nid generation:  0.03499627113342285
local_in_edges_tensor generation:  0.06344318389892578
mini_batch_src_global generation:  0.05314135551452637
r_  generation:  0.5451376438140869
local_output_nid generation:  0.04093742370605469
local_in_edges_tensor generation:  0.06252241134643555
mini_batch_src_global generation:  0.06530475616455078
r_  generation:  0.5378875732421875
local_output_nid generation:  0.04001212120056152
local_in_edges_tensor generation:  0.04846000671386719
mini_batch_src_global generation:  0.058595895767211914
r_  generation:  0.5371334552764893
local_output_nid generation:  0.03917503356933594
local_in_edges_tensor generation:  0.04502272605895996
mini_batch_src_global generation:  0.058450937271118164
r_  generation:  0.5422391891479492
local_output_nid generation:  0.03903079032897949
local_in_edges_tensor generation:  0.05464005470275879
mini_batch_src_global generation:  0.05832076072692871
r_  generation:  0.5438539981842041
local_output_nid generation:  0.03899741172790527
local_in_edges_tensor generation:  0.045397043228149414
mini_batch_src_global generation:  0.06171607971191406
r_  generation:  0.5485174655914307
local_output_nid generation:  0.03926253318786621
local_in_edges_tensor generation:  0.040679931640625
mini_batch_src_global generation:  0.05834460258483887
r_  generation:  0.556255578994751
local_output_nid generation:  0.0390629768371582
local_in_edges_tensor generation:  0.045496225357055664
mini_batch_src_global generation:  0.05881237983703613
r_  generation:  0.5619626045227051
local_output_nid generation:  0.038832664489746094
local_in_edges_tensor generation:  0.04499626159667969
mini_batch_src_global generation:  0.06027483940124512
r_  generation:  0.5583953857421875
local_output_nid generation:  0.03935647010803223
local_in_edges_tensor generation:  0.0504915714263916
mini_batch_src_global generation:  0.06426024436950684
r_  generation:  0.5576722621917725
local_output_nid generation:  0.03885316848754883
local_in_edges_tensor generation:  0.044681549072265625
mini_batch_src_global generation:  0.06093454360961914
r_  generation:  0.5638363361358643
local_output_nid generation:  0.03897714614868164
local_in_edges_tensor generation:  0.04999065399169922
mini_batch_src_global generation:  0.06800675392150879
r_  generation:  0.56522536277771
local_output_nid generation:  0.03957533836364746
local_in_edges_tensor generation:  0.04409074783325195
mini_batch_src_global generation:  0.06053018569946289
r_  generation:  0.566401481628418
local_output_nid generation:  0.040413856506347656
local_in_edges_tensor generation:  0.041480064392089844
mini_batch_src_global generation:  0.060106754302978516
r_  generation:  0.5637016296386719
local_output_nid generation:  0.03935503959655762
local_in_edges_tensor generation:  0.04543876647949219
mini_batch_src_global generation:  0.06069016456604004
r_  generation:  0.5692973136901855
local_output_nid generation:  0.03963828086853027
local_in_edges_tensor generation:  0.04862642288208008
mini_batch_src_global generation:  0.06802725791931152
r_  generation:  0.5840058326721191
----------------------check_connections_block total spend ----------------------------- 13.366524934768677
generate_one_block  0.7010083198547363
generate_one_block  0.6958198547363281
generate_one_block  0.7648448944091797
generate_one_block  0.673790693283081
generate_one_block  0.6987264156341553
generate_one_block  0.6870017051696777
generate_one_block  0.6736631393432617
generate_one_block  0.6721196174621582
generate_one_block  0.6984958648681641
generate_one_block  0.6985988616943359
generate_one_block  0.6942501068115234
generate_one_block  0.7003076076507568
generate_one_block  0.6722204685211182
generate_one_block  0.675684928894043
generate_one_block  0.6842310428619385
generate_one_block  0.6963348388671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03948020935058594
gen group dst list time:  0.09843087196350098
time for parepare:  0.02091503143310547
local_output_nid generation:  0.037331581115722656
local_in_edges_tensor generation:  0.05916309356689453
mini_batch_src_global generation:  0.04535174369812012
r_  generation:  0.5057790279388428
local_output_nid generation:  0.04311847686767578
local_in_edges_tensor generation:  0.04483604431152344
mini_batch_src_global generation:  0.0579676628112793
r_  generation:  0.5082483291625977
local_output_nid generation:  0.04009699821472168
local_in_edges_tensor generation:  0.040827274322509766
mini_batch_src_global generation:  0.06805539131164551
r_  generation:  0.5113265514373779
local_output_nid generation:  0.04020285606384277
local_in_edges_tensor generation:  0.04964900016784668
mini_batch_src_global generation:  0.06411266326904297
r_  generation:  0.5188355445861816
local_output_nid generation:  0.04249882698059082
local_in_edges_tensor generation:  0.04787111282348633
mini_batch_src_global generation:  0.06351876258850098
r_  generation:  0.5085000991821289
local_output_nid generation:  0.04142594337463379
local_in_edges_tensor generation:  0.04510784149169922
mini_batch_src_global generation:  0.057615041732788086
r_  generation:  0.5117306709289551
local_output_nid generation:  0.0413360595703125
local_in_edges_tensor generation:  0.04247879981994629
mini_batch_src_global generation:  0.05762290954589844
r_  generation:  0.5146923065185547
local_output_nid generation:  0.04169273376464844
local_in_edges_tensor generation:  0.04278445243835449
mini_batch_src_global generation:  0.06045985221862793
r_  generation:  0.5152997970581055
local_output_nid generation:  0.04148697853088379
local_in_edges_tensor generation:  0.04253745079040527
mini_batch_src_global generation:  0.05762338638305664
r_  generation:  0.513373851776123
local_output_nid generation:  0.04164838790893555
local_in_edges_tensor generation:  0.042993783950805664
mini_batch_src_global generation:  0.07193326950073242
r_  generation:  0.5159118175506592
local_output_nid generation:  0.042018890380859375
local_in_edges_tensor generation:  0.03865385055541992
mini_batch_src_global generation:  0.05751848220825195
r_  generation:  0.5149109363555908
local_output_nid generation:  0.04160308837890625
local_in_edges_tensor generation:  0.051160335540771484
mini_batch_src_global generation:  0.057679176330566406
r_  generation:  0.520322322845459
local_output_nid generation:  0.041628360748291016
local_in_edges_tensor generation:  0.038434743881225586
mini_batch_src_global generation:  0.05720973014831543
r_  generation:  0.5142824649810791
local_output_nid generation:  0.041574716567993164
local_in_edges_tensor generation:  0.04232668876647949
mini_batch_src_global generation:  0.057404279708862305
r_  generation:  0.5200905799865723
local_output_nid generation:  0.041567325592041016
local_in_edges_tensor generation:  0.05143928527832031
mini_batch_src_global generation:  0.06050515174865723
r_  generation:  0.5169234275817871
local_output_nid generation:  0.04140639305114746
local_in_edges_tensor generation:  0.042668819427490234
mini_batch_src_global generation:  0.05724692344665527
r_  generation:  0.5216693878173828
----------------------check_connections_block total spend ----------------------------- 12.548655033111572
generate_one_block  0.6385855674743652
generate_one_block  0.6430623531341553
generate_one_block  0.6340739727020264
generate_one_block  0.6461350917816162
generate_one_block  0.6472940444946289
generate_one_block  0.7346386909484863
generate_one_block  0.6499083042144775
generate_one_block  0.6484441757202148
generate_one_block  0.6465461254119873
generate_one_block  0.6403520107269287
generate_one_block  0.6597728729248047
generate_one_block  0.6604804992675781
generate_one_block  0.6326110363006592
generate_one_block  0.6337158679962158
generate_one_block  0.631821870803833
generate_one_block  0.6606364250183105
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0272216796875 GB
    Memory Allocated: 0.010137557983398438  GigaBytes
Max Memory Allocated: 0.010137557983398438  GigaBytes

connection checking time:  42.915066719055176
block generation total time  36.66361474990845
average batch blocks generation time:  2.291475921869278
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.13181161880493164  GigaBytes
Max Memory Allocated: 0.13181161880493164  GigaBytes

torch.Size([166373, 128])
torch.Size([164137, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 21.92 GiB already allocated; 20.44 MiB free; 22.40 GiB reserved in total by PyTorch)
