Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648453708.0633595
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024914026260375977
random selection method range initialization spend 0.006364345550537109
time for parepare:  0.018619298934936523
local_output_nid generation:  0.0011360645294189453
local_in_edges_tensor generation:  0.003992557525634766
mini_batch_src_global generation:  0.001420736312866211
r_  generation:  0.008788347244262695
local_output_nid generation:  0.0012848377227783203
local_in_edges_tensor generation:  0.000988006591796875
mini_batch_src_global generation:  0.0013928413391113281
r_  generation:  0.007857322692871094
local_output_nid generation:  0.0013096332550048828
local_in_edges_tensor generation:  0.0008404254913330078
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.0078008174896240234
local_output_nid generation:  0.0013120174407958984
local_in_edges_tensor generation:  0.0008132457733154297
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.007559537887573242
local_output_nid generation:  0.0013337135314941406
local_in_edges_tensor generation:  0.0007824897766113281
mini_batch_src_global generation:  0.000835418701171875
r_  generation:  0.007760763168334961
local_output_nid generation:  0.0013184547424316406
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0010445117950439453
r_  generation:  0.008130550384521484
local_output_nid generation:  0.0013194084167480469
local_in_edges_tensor generation:  0.0008177757263183594
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.008034706115722656
local_output_nid generation:  0.0013377666473388672
local_in_edges_tensor generation:  0.0007855892181396484
mini_batch_src_global generation:  0.0008699893951416016
r_  generation:  0.00828862190246582
local_output_nid generation:  0.0013468265533447266
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0008335113525390625
r_  generation:  0.008085966110229492
local_output_nid generation:  0.0013475418090820312
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.008130550384521484
local_output_nid generation:  0.0013647079467773438
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0008459091186523438
r_  generation:  0.008110523223876953
local_output_nid generation:  0.0013391971588134766
local_in_edges_tensor generation:  0.0007116794586181641
mini_batch_src_global generation:  0.0008115768432617188
r_  generation:  0.007976770401000977
local_output_nid generation:  0.0013778209686279297
local_in_edges_tensor generation:  0.0007107257843017578
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.008017301559448242
local_output_nid generation:  0.0013628005981445312
local_in_edges_tensor generation:  0.0007724761962890625
mini_batch_src_global generation:  0.0008630752563476562
r_  generation:  0.008011579513549805
local_output_nid generation:  0.0013649463653564453
local_in_edges_tensor generation:  0.0007276535034179688
mini_batch_src_global generation:  0.0008611679077148438
r_  generation:  0.008376598358154297
local_output_nid generation:  0.001354217529296875
local_in_edges_tensor generation:  0.0007023811340332031
mini_batch_src_global generation:  0.0008358955383300781
r_  generation:  0.007997274398803711
local_output_nid generation:  0.0013883113861083984
local_in_edges_tensor generation:  0.0007266998291015625
mini_batch_src_global generation:  0.000835418701171875
r_  generation:  0.0079498291015625
local_output_nid generation:  0.0013582706451416016
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0008211135864257812
r_  generation:  0.008113861083984375
local_output_nid generation:  0.0013654232025146484
local_in_edges_tensor generation:  0.0007061958312988281
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008410215377807617
local_output_nid generation:  0.0014734268188476562
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.0009334087371826172
r_  generation:  0.008464813232421875
local_output_nid generation:  0.0013949871063232422
local_in_edges_tensor generation:  0.0007190704345703125
mini_batch_src_global generation:  0.0008749961853027344
r_  generation:  0.007954120635986328
local_output_nid generation:  0.0013852119445800781
local_in_edges_tensor generation:  0.000701904296875
mini_batch_src_global generation:  0.0008361339569091797
r_  generation:  0.007988691329956055
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0008387565612792969
r_  generation:  0.008177995681762695
local_output_nid generation:  0.0013647079467773438
local_in_edges_tensor generation:  0.0007002353668212891
mini_batch_src_global generation:  0.0008587837219238281
r_  generation:  0.008196353912353516
local_output_nid generation:  0.0013663768768310547
local_in_edges_tensor generation:  0.0006861686706542969
mini_batch_src_global generation:  0.0009655952453613281
r_  generation:  0.008229255676269531
local_output_nid generation:  0.0013957023620605469
local_in_edges_tensor generation:  0.0007221698760986328
mini_batch_src_global generation:  0.0008523464202880859
r_  generation:  0.008279085159301758
local_output_nid generation:  0.001379251480102539
local_in_edges_tensor generation:  0.0006947517395019531
mini_batch_src_global generation:  0.0008425712585449219
r_  generation:  0.008093118667602539
local_output_nid generation:  0.0013992786407470703
local_in_edges_tensor generation:  0.0006911754608154297
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.0078008174896240234
local_output_nid generation:  0.001405477523803711
local_in_edges_tensor generation:  0.0007002353668212891
mini_batch_src_global generation:  0.0008697509765625
r_  generation:  0.008025646209716797
local_output_nid generation:  0.0013506412506103516
local_in_edges_tensor generation:  0.0051441192626953125
mini_batch_src_global generation:  0.0010499954223632812
r_  generation:  0.007817983627319336
local_output_nid generation:  0.0013089179992675781
local_in_edges_tensor generation:  0.0007534027099609375
mini_batch_src_global generation:  0.0010249614715576172
r_  generation:  0.008176326751708984
local_output_nid generation:  0.001280069351196289
local_in_edges_tensor generation:  0.0006840229034423828
mini_batch_src_global generation:  0.0009002685546875
r_  generation:  0.008069753646850586
----------------------check_connections_block total spend ----------------------------- 0.4620492458343506
generate_one_block  0.013632535934448242
generate_one_block  0.013014793395996094
generate_one_block  0.013305425643920898
generate_one_block  0.013035058975219727
generate_one_block  0.013420820236206055
generate_one_block  0.013812541961669922
generate_one_block  0.013371467590332031
generate_one_block  0.013620853424072266
generate_one_block  0.013247013092041016
generate_one_block  0.013616800308227539
generate_one_block  0.013242721557617188
generate_one_block  0.012774467468261719
generate_one_block  0.013035774230957031
generate_one_block  0.012868642807006836
generate_one_block  0.0136871337890625
generate_one_block  0.012982606887817383
generate_one_block  0.012819528579711914
generate_one_block  0.013004779815673828
generate_one_block  0.013426780700683594
generate_one_block  0.013592004776000977
generate_one_block  0.012985706329345703
generate_one_block  0.01295161247253418
generate_one_block  0.013027191162109375
generate_one_block  0.013105154037475586
generate_one_block  0.013136625289916992
generate_one_block  0.01312708854675293
generate_one_block  0.012929677963256836
generate_one_block  0.012706756591796875
generate_one_block  0.012984275817871094
generate_one_block  0.012757062911987305
generate_one_block  0.013598918914794922
generate_one_block  0.012829065322875977
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03980517387390137
gen group dst list time:  0.02109837532043457
time for parepare:  0.019326448440551758
local_output_nid generation:  0.004552602767944336
local_in_edges_tensor generation:  0.012491941452026367
mini_batch_src_global generation:  0.011419057846069336
r_  generation:  0.1154789924621582
local_output_nid generation:  0.007418632507324219
local_in_edges_tensor generation:  0.011577844619750977
mini_batch_src_global generation:  0.014230728149414062
r_  generation:  0.11936807632446289
local_output_nid generation:  0.007246971130371094
local_in_edges_tensor generation:  0.010908126831054688
mini_batch_src_global generation:  0.013467550277709961
r_  generation:  0.12435293197631836
local_output_nid generation:  0.00717473030090332
local_in_edges_tensor generation:  0.010013103485107422
mini_batch_src_global generation:  0.014856815338134766
r_  generation:  0.12465929985046387
local_output_nid generation:  0.007245063781738281
local_in_edges_tensor generation:  0.00869131088256836
mini_batch_src_global generation:  0.015230894088745117
r_  generation:  0.13738393783569336
local_output_nid generation:  0.007296323776245117
local_in_edges_tensor generation:  0.011054754257202148
mini_batch_src_global generation:  0.016054391860961914
r_  generation:  0.13895702362060547
local_output_nid generation:  0.007384061813354492
local_in_edges_tensor generation:  0.009974002838134766
mini_batch_src_global generation:  0.015915393829345703
r_  generation:  0.1446974277496338
local_output_nid generation:  0.007420778274536133
local_in_edges_tensor generation:  0.011282920837402344
mini_batch_src_global generation:  0.016786575317382812
r_  generation:  0.13965368270874023
local_output_nid generation:  0.010219573974609375
local_in_edges_tensor generation:  0.007887840270996094
mini_batch_src_global generation:  0.016168594360351562
r_  generation:  0.1363518238067627
local_output_nid generation:  0.007361888885498047
local_in_edges_tensor generation:  0.01317143440246582
mini_batch_src_global generation:  0.016236066818237305
r_  generation:  0.13843655586242676
local_output_nid generation:  0.008171319961547852
local_in_edges_tensor generation:  0.010614156723022461
mini_batch_src_global generation:  0.022935152053833008
r_  generation:  0.14980196952819824
local_output_nid generation:  0.011456727981567383
local_in_edges_tensor generation:  0.02168726921081543
mini_batch_src_global generation:  0.017143726348876953
r_  generation:  0.12986469268798828
local_output_nid generation:  0.007511615753173828
local_in_edges_tensor generation:  0.007655620574951172
mini_batch_src_global generation:  0.015996456146240234
r_  generation:  0.13296961784362793
local_output_nid generation:  0.007521152496337891
local_in_edges_tensor generation:  0.007556915283203125
mini_batch_src_global generation:  0.01614522933959961
r_  generation:  0.1339108943939209
local_output_nid generation:  0.007837295532226562
local_in_edges_tensor generation:  0.008711576461791992
mini_batch_src_global generation:  0.01792168617248535
r_  generation:  0.13837933540344238
local_output_nid generation:  0.007538557052612305
local_in_edges_tensor generation:  0.007570028305053711
mini_batch_src_global generation:  0.01660013198852539
r_  generation:  0.13535022735595703
local_output_nid generation:  0.007460594177246094
local_in_edges_tensor generation:  0.0075550079345703125
mini_batch_src_global generation:  0.016285181045532227
r_  generation:  0.1321122646331787
local_output_nid generation:  0.0075092315673828125
local_in_edges_tensor generation:  0.009485721588134766
mini_batch_src_global generation:  0.0161592960357666
r_  generation:  0.13499832153320312
local_output_nid generation:  0.007718086242675781
local_in_edges_tensor generation:  0.008823871612548828
mini_batch_src_global generation:  0.01693415641784668
r_  generation:  0.13764095306396484
local_output_nid generation:  0.007719516754150391
local_in_edges_tensor generation:  0.009825468063354492
mini_batch_src_global generation:  0.01685810089111328
r_  generation:  0.1369633674621582
local_output_nid generation:  0.007462739944458008
local_in_edges_tensor generation:  0.007359981536865234
mini_batch_src_global generation:  0.01656508445739746
r_  generation:  0.13158512115478516
local_output_nid generation:  0.007561922073364258
local_in_edges_tensor generation:  0.0077936649322509766
mini_batch_src_global generation:  0.016403913497924805
r_  generation:  0.13586139678955078
local_output_nid generation:  0.007515668869018555
local_in_edges_tensor generation:  0.008622169494628906
mini_batch_src_global generation:  0.015998125076293945
r_  generation:  0.13482308387756348
local_output_nid generation:  0.007587909698486328
local_in_edges_tensor generation:  0.009735822677612305
mini_batch_src_global generation:  0.016361474990844727
r_  generation:  0.14844155311584473
local_output_nid generation:  0.00752711296081543
local_in_edges_tensor generation:  0.008486509323120117
mini_batch_src_global generation:  0.016327857971191406
r_  generation:  0.14129924774169922
local_output_nid generation:  0.00844264030456543
local_in_edges_tensor generation:  0.009028196334838867
mini_batch_src_global generation:  0.01665973663330078
r_  generation:  0.1395421028137207
local_output_nid generation:  0.007557868957519531
local_in_edges_tensor generation:  0.007329463958740234
mini_batch_src_global generation:  0.015915870666503906
r_  generation:  0.1323843002319336
local_output_nid generation:  0.0074841976165771484
local_in_edges_tensor generation:  0.007409334182739258
mini_batch_src_global generation:  0.015578269958496094
r_  generation:  0.13266587257385254
local_output_nid generation:  0.007598400115966797
local_in_edges_tensor generation:  0.008556365966796875
mini_batch_src_global generation:  0.017137527465820312
r_  generation:  0.13503289222717285
local_output_nid generation:  0.007430315017700195
local_in_edges_tensor generation:  0.007338762283325195
mini_batch_src_global generation:  0.016066551208496094
r_  generation:  0.13261985778808594
local_output_nid generation:  0.007670402526855469
local_in_edges_tensor generation:  0.007881402969360352
mini_batch_src_global generation:  0.01646876335144043
r_  generation:  0.1384272575378418
local_output_nid generation:  0.007371187210083008
local_in_edges_tensor generation:  0.009301900863647461
mini_batch_src_global generation:  0.015868663787841797
r_  generation:  0.13163518905639648
----------------------check_connections_block total spend ----------------------------- 6.416383743286133
generate_one_block  0.17048168182373047
generate_one_block  0.15971612930297852
generate_one_block  0.18985199928283691
generate_one_block  0.1663036346435547
generate_one_block  0.16902661323547363
generate_one_block  0.17095494270324707
generate_one_block  0.1704847812652588
generate_one_block  0.1720592975616455
generate_one_block  0.16686224937438965
generate_one_block  0.17017078399658203
generate_one_block  0.1699988842010498
generate_one_block  0.15746045112609863
generate_one_block  0.16282367706298828
generate_one_block  0.16812825202941895
generate_one_block  0.18895816802978516
generate_one_block  0.19806694984436035
generate_one_block  0.1634674072265625
generate_one_block  0.16966772079467773
generate_one_block  0.20382475852966309
generate_one_block  0.1713697910308838
generate_one_block  0.16310858726501465
generate_one_block  0.16682910919189453
generate_one_block  0.1625518798828125
generate_one_block  0.17080998420715332
generate_one_block  0.17643141746520996
generate_one_block  0.1668252944946289
generate_one_block  0.16374635696411133
generate_one_block  0.16118597984313965
generate_one_block  0.16530895233154297
generate_one_block  0.16403484344482422
generate_one_block  0.1779172420501709
generate_one_block  0.17629361152648926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08576202392578125
gen group dst list time:  0.1025242805480957
time for parepare:  0.018852710723876953
local_output_nid generation:  0.020848512649536133
local_in_edges_tensor generation:  0.04604506492614746
mini_batch_src_global generation:  0.03948974609375
r_  generation:  0.37501001358032227
local_output_nid generation:  0.03238725662231445
local_in_edges_tensor generation:  0.039664268493652344
mini_batch_src_global generation:  0.046732425689697266
r_  generation:  0.3867065906524658
local_output_nid generation:  0.027834653854370117
local_in_edges_tensor generation:  0.03728222846984863
mini_batch_src_global generation:  0.04585719108581543
r_  generation:  0.3975229263305664
local_output_nid generation:  0.026117801666259766
local_in_edges_tensor generation:  0.04632067680358887
mini_batch_src_global generation:  0.04733753204345703
r_  generation:  0.4004628658294678
local_output_nid generation:  0.026822328567504883
local_in_edges_tensor generation:  0.033707380294799805
mini_batch_src_global generation:  0.04712343215942383
r_  generation:  0.3946409225463867
local_output_nid generation:  0.02597975730895996
local_in_edges_tensor generation:  0.03829836845397949
mini_batch_src_global generation:  0.06290769577026367
r_  generation:  0.4020216464996338
local_output_nid generation:  0.026081085205078125
local_in_edges_tensor generation:  0.037781476974487305
mini_batch_src_global generation:  0.04925870895385742
r_  generation:  0.4099917411804199
local_output_nid generation:  0.028699874877929688
local_in_edges_tensor generation:  0.02777886390686035
mini_batch_src_global generation:  0.04864668846130371
r_  generation:  0.40033841133117676
local_output_nid generation:  0.0266263484954834
local_in_edges_tensor generation:  0.02780628204345703
mini_batch_src_global generation:  0.04767036437988281
r_  generation:  0.3994617462158203
local_output_nid generation:  0.02687692642211914
local_in_edges_tensor generation:  0.03017282485961914
mini_batch_src_global generation:  0.0486295223236084
r_  generation:  0.4039440155029297
local_output_nid generation:  0.026733875274658203
local_in_edges_tensor generation:  0.03388524055480957
mini_batch_src_global generation:  0.07139897346496582
r_  generation:  0.4042544364929199
local_output_nid generation:  0.02626943588256836
local_in_edges_tensor generation:  0.02597975730895996
mini_batch_src_global generation:  0.0483555793762207
r_  generation:  0.39487767219543457
local_output_nid generation:  0.027630090713500977
local_in_edges_tensor generation:  0.03992509841918945
mini_batch_src_global generation:  0.056105613708496094
r_  generation:  0.4214317798614502
local_output_nid generation:  0.028846263885498047
local_in_edges_tensor generation:  0.03835916519165039
mini_batch_src_global generation:  0.05131673812866211
r_  generation:  0.3935699462890625
local_output_nid generation:  0.026998519897460938
local_in_edges_tensor generation:  0.03437042236328125
mini_batch_src_global generation:  0.05100202560424805
r_  generation:  0.41321802139282227
local_output_nid generation:  0.026874780654907227
local_in_edges_tensor generation:  0.025135040283203125
mini_batch_src_global generation:  0.054247379302978516
r_  generation:  0.40488219261169434
local_output_nid generation:  0.02640986442565918
local_in_edges_tensor generation:  0.028874635696411133
mini_batch_src_global generation:  0.047332048416137695
r_  generation:  0.4046046733856201
local_output_nid generation:  0.027561187744140625
local_in_edges_tensor generation:  0.02795720100402832
mini_batch_src_global generation:  0.06710052490234375
r_  generation:  0.40285801887512207
local_output_nid generation:  0.02786731719970703
local_in_edges_tensor generation:  0.03529095649719238
mini_batch_src_global generation:  0.0503993034362793
r_  generation:  0.4072306156158447
local_output_nid generation:  0.02695178985595703
local_in_edges_tensor generation:  0.031693220138549805
mini_batch_src_global generation:  0.05069255828857422
r_  generation:  0.40251898765563965
local_output_nid generation:  0.02674555778503418
local_in_edges_tensor generation:  0.02526259422302246
mini_batch_src_global generation:  0.04781174659729004
r_  generation:  0.40375542640686035
local_output_nid generation:  0.026527881622314453
local_in_edges_tensor generation:  0.02457880973815918
mini_batch_src_global generation:  0.07358217239379883
r_  generation:  0.40073680877685547
local_output_nid generation:  0.026629924774169922
local_in_edges_tensor generation:  0.024688243865966797
mini_batch_src_global generation:  0.05098271369934082
r_  generation:  0.4041128158569336
local_output_nid generation:  0.02660393714904785
local_in_edges_tensor generation:  0.03446626663208008
mini_batch_src_global generation:  0.04822421073913574
r_  generation:  0.39915990829467773
local_output_nid generation:  0.02750539779663086
local_in_edges_tensor generation:  0.03217291831970215
mini_batch_src_global generation:  0.04706978797912598
r_  generation:  0.4054679870605469
local_output_nid generation:  0.026642322540283203
local_in_edges_tensor generation:  0.03133058547973633
mini_batch_src_global generation:  0.047986745834350586
r_  generation:  0.40041494369506836
local_output_nid generation:  0.026428937911987305
local_in_edges_tensor generation:  0.02428722381591797
mini_batch_src_global generation:  0.04679727554321289
r_  generation:  0.39952731132507324
local_output_nid generation:  0.026390790939331055
local_in_edges_tensor generation:  0.02772974967956543
mini_batch_src_global generation:  0.047534942626953125
r_  generation:  0.3953726291656494
local_output_nid generation:  0.02649688720703125
local_in_edges_tensor generation:  0.030663013458251953
mini_batch_src_global generation:  0.048918724060058594
r_  generation:  0.40505170822143555
local_output_nid generation:  0.026535749435424805
local_in_edges_tensor generation:  0.027768850326538086
mini_batch_src_global generation:  0.04809880256652832
r_  generation:  0.39458799362182617
local_output_nid generation:  0.026829004287719727
local_in_edges_tensor generation:  0.0277097225189209
mini_batch_src_global generation:  0.04740333557128906
r_  generation:  0.40557074546813965
local_output_nid generation:  0.026487350463867188
local_in_edges_tensor generation:  0.03153419494628906
mini_batch_src_global generation:  0.04775714874267578
r_  generation:  0.39538145065307617
----------------------check_connections_block total spend ----------------------------- 19.199113607406616
generate_one_block  0.6000196933746338
generate_one_block  0.5210559368133545
generate_one_block  0.5182852745056152
generate_one_block  0.5169277191162109
generate_one_block  0.508669376373291
generate_one_block  0.5257539749145508
generate_one_block  0.5263068675994873
generate_one_block  0.5161714553833008
generate_one_block  0.5035085678100586
generate_one_block  0.5109179019927979
generate_one_block  0.5228424072265625
generate_one_block  0.4997730255126953
generate_one_block  0.5028135776519775
generate_one_block  0.5021646022796631
generate_one_block  0.5319314002990723
generate_one_block  0.5185384750366211
generate_one_block  0.502760648727417
generate_one_block  0.513005256652832
generate_one_block  0.5318443775177002
generate_one_block  0.5347042083740234
generate_one_block  0.5179946422576904
generate_one_block  0.504056453704834
generate_one_block  0.510009765625
generate_one_block  0.5184173583984375
generate_one_block  0.5224573612213135
generate_one_block  0.5145277976989746
generate_one_block  0.506706714630127
generate_one_block  0.5030050277709961
generate_one_block  0.5130813121795654
generate_one_block  0.5213592052459717
generate_one_block  0.5339395999908447
generate_one_block  0.504436731338501
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  25.61549735069275
block generation total time  22.0527081489563
average batch blocks generation time:  0.6891471296548843
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08203840255737305  GigaBytes
Max Memory Allocated: 0.08203840255737305  GigaBytes

torch.Size([145136, 128])
torch.Size([98446, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8397216796875 GB
    Memory Allocated: 10.036507606506348  GigaBytes
Max Memory Allocated: 10.039557933807373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8475341796875 GB
    Memory Allocated: 0.08300352096557617  GigaBytes
Max Memory Allocated: 10.039557933807373  GigaBytes

torch.Size([145091, 128])
torch.Size([98231, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 10.023562908172607  GigaBytes
Max Memory Allocated: 10.039557933807373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.08530521392822266  GigaBytes
Max Memory Allocated: 10.039557933807373  GigaBytes

torch.Size([145510, 128])
torch.Size([99564, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7869873046875 GB
    Memory Allocated: 10.185418128967285  GigaBytes
Max Memory Allocated: 10.188989639282227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7869873046875 GB
    Memory Allocated: 0.08327865600585938  GigaBytes
Max Memory Allocated: 10.188989639282227  GigaBytes

torch.Size([145392, 128])
torch.Size([99314, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7889404296875 GB
    Memory Allocated: 10.09485673904419  GigaBytes
Max Memory Allocated: 10.188989639282227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7889404296875 GB
    Memory Allocated: 0.08531427383422852  GigaBytes
Max Memory Allocated: 10.188989639282227  GigaBytes

torch.Size([145810, 128])
torch.Size([99430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7889404296875 GB
    Memory Allocated: 10.167349338531494  GigaBytes
Max Memory Allocated: 10.188989639282227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7889404296875 GB
    Memory Allocated: 0.08427095413208008  GigaBytes
Max Memory Allocated: 10.188989639282227  GigaBytes

torch.Size([145205, 128])
torch.Size([99568, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3885498046875 GB
    Memory Allocated: 10.21091604232788  GigaBytes
Max Memory Allocated: 10.214537143707275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3885498046875 GB
    Memory Allocated: 0.08532428741455078  GigaBytes
Max Memory Allocated: 10.214537143707275  GigaBytes

torch.Size([145622, 128])
torch.Size([100020, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.171085357666016  GigaBytes
Max Memory Allocated: 10.214537143707275  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08439016342163086  GigaBytes
Max Memory Allocated: 10.214537143707275  GigaBytes

torch.Size([145434, 128])
torch.Size([99523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.226645469665527  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08326435089111328  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145312, 128])
torch.Size([98911, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.106353282928467  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08450651168823242  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145737, 128])
torch.Size([100131, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.180977821350098  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08532333374023438  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145866, 128])
torch.Size([99925, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.206291198730469  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08302593231201172  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145346, 128])
torch.Size([98002, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 9.978899478912354  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08312273025512695  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145267, 128])
torch.Size([98292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.025478839874268  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.0830678939819336  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145048, 128])
torch.Size([98729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 10.06667184829712  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3983154296875 GB
    Memory Allocated: 0.08537673950195312  GigaBytes
Max Memory Allocated: 10.230440139770508  GigaBytes

torch.Size([145850, 128])
torch.Size([100861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.310348987579346  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08449697494506836  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145754, 128])
torch.Size([99723, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.166996955871582  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08292388916015625  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([144940, 128])
torch.Size([97900, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.019813060760498  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08420991897583008  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145146, 128])
torch.Size([99164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.177938461303711  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08535909652709961  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145510, 128])
torch.Size([99396, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.219298839569092  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08431816101074219  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145309, 128])
torch.Size([99832, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.21454381942749  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08428001403808594  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145648, 128])
torch.Size([99015, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.111175060272217  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08318138122558594  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145310, 128])
torch.Size([98735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.057795524597168  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0841827392578125  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145608, 128])
torch.Size([98769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.036912441253662  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08318710327148438  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145040, 128])
torch.Size([98731, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.109418392181396  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08531379699707031  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([146163, 128])
torch.Size([99572, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.177134037017822  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08342599868774414  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145569, 128])
torch.Size([99334, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.13902473449707  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0830082893371582  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145009, 128])
torch.Size([98350, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.05675983428955  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08293581008911133  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145015, 128])
torch.Size([98022, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 9.989860534667969  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08314037322998047  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145120, 128])
torch.Size([98627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.118200302124023  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0835733413696289  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([146142, 128])
torch.Size([99152, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.070265769958496  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08533239364624023  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145601, 128])
torch.Size([99765, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.225834846496582  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08301448822021484  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145038, 128])
torch.Size([98160, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.014532089233398  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030870184302330017 |0.02533784508705139 |0.2470034882426262 |9.895116090774536e-05 |0.30845973640680313 |0.0076329708099365234 |
----------------------------------------------------------pseudo_mini_loss sum 4.405405521392822
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8576684
Number of first layer input nodes during this epoch:  4653548
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.10059547424316406  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02280116081237793
random selection method range initialization spend 0.0068624019622802734
time for parepare:  0.01986837387084961
local_output_nid generation:  0.001359701156616211
local_in_edges_tensor generation:  0.008109807968139648
mini_batch_src_global generation:  0.002183198928833008
r_  generation:  0.01283884048461914
local_output_nid generation:  0.0017440319061279297
local_in_edges_tensor generation:  0.0011706352233886719
mini_batch_src_global generation:  0.0014674663543701172
r_  generation:  0.008298397064208984
local_output_nid generation:  0.0016777515411376953
local_in_edges_tensor generation:  0.0010440349578857422
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.00793147087097168
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.0010063648223876953
mini_batch_src_global generation:  0.0010373592376708984
r_  generation:  0.007908344268798828
local_output_nid generation:  0.0015609264373779297
local_in_edges_tensor generation:  0.0009579658508300781
mini_batch_src_global generation:  0.0009686946868896484
r_  generation:  0.007729530334472656
local_output_nid generation:  0.0015652179718017578
local_in_edges_tensor generation:  0.0009834766387939453
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.008260488510131836
local_output_nid generation:  0.0015254020690917969
local_in_edges_tensor generation:  0.0009777545928955078
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.008158683776855469
local_output_nid generation:  0.001516103744506836
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.008051156997680664
local_output_nid generation:  0.0014884471893310547
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0009086132049560547
r_  generation:  0.008157491683959961
local_output_nid generation:  0.0014815330505371094
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0009009838104248047
r_  generation:  0.008242130279541016
local_output_nid generation:  0.0014772415161132812
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0009365081787109375
r_  generation:  0.008021116256713867
local_output_nid generation:  0.0014963150024414062
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.008310556411743164
local_output_nid generation:  0.0014731884002685547
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.0011451244354248047
r_  generation:  0.008519172668457031
local_output_nid generation:  0.0014829635620117188
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.008220434188842773
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0009095668792724609
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.008195638656616211
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0008823871612548828
mini_batch_src_global generation:  0.0009191036224365234
r_  generation:  0.008126258850097656
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0009257793426513672
r_  generation:  0.008234739303588867
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0009562969207763672
r_  generation:  0.008396148681640625
local_output_nid generation:  0.0014705657958984375
local_in_edges_tensor generation:  0.0008912086486816406
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.008346080780029297
local_output_nid generation:  0.0014488697052001953
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.00824284553527832
local_output_nid generation:  0.0015215873718261719
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.00831913948059082
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0009210109710693359
mini_batch_src_global generation:  0.0010461807250976562
r_  generation:  0.009653091430664062
local_output_nid generation:  0.0015447139739990234
local_in_edges_tensor generation:  0.0009813308715820312
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.009482860565185547
local_output_nid generation:  0.0015413761138916016
local_in_edges_tensor generation:  0.0009546279907226562
mini_batch_src_global generation:  0.0010364055633544922
r_  generation:  0.008704423904418945
local_output_nid generation:  0.001596689224243164
local_in_edges_tensor generation:  0.0009639263153076172
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.008362770080566406
local_output_nid generation:  0.0015225410461425781
local_in_edges_tensor generation:  0.0009429454803466797
mini_batch_src_global generation:  0.0009479522705078125
r_  generation:  0.008265256881713867
local_output_nid generation:  0.001497030258178711
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.008040428161621094
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.008540630340576172
local_output_nid generation:  0.0015311241149902344
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.011202335357666016
local_output_nid generation:  0.0015034675598144531
local_in_edges_tensor generation:  0.0009391307830810547
mini_batch_src_global generation:  0.0009367465972900391
r_  generation:  0.008389949798583984
local_output_nid generation:  0.0014967918395996094
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0009317398071289062
r_  generation:  0.008418083190917969
local_output_nid generation:  0.0015304088592529297
local_in_edges_tensor generation:  0.0009076595306396484
mini_batch_src_global generation:  0.0009071826934814453
r_  generation:  0.008378744125366211
----------------------check_connections_block total spend ----------------------------- 0.4985084533691406
generate_one_block  0.020604610443115234
generate_one_block  0.017493486404418945
generate_one_block  0.015150785446166992
generate_one_block  0.014444351196289062
generate_one_block  0.014231681823730469
generate_one_block  0.014477729797363281
generate_one_block  0.014782190322875977
generate_one_block  0.014376640319824219
generate_one_block  0.014571905136108398
generate_one_block  0.014220237731933594
generate_one_block  0.014127969741821289
generate_one_block  0.014719486236572266
generate_one_block  0.01489114761352539
generate_one_block  0.01438760757446289
generate_one_block  0.014468908309936523
generate_one_block  0.014167070388793945
generate_one_block  0.014374971389770508
generate_one_block  0.014645099639892578
generate_one_block  0.014581441879272461
generate_one_block  0.014123678207397461
generate_one_block  0.014467239379882812
generate_one_block  0.01525259017944336
generate_one_block  0.015009641647338867
generate_one_block  0.016180992126464844
generate_one_block  0.01444387435913086
generate_one_block  0.014158487319946289
generate_one_block  0.014091014862060547
generate_one_block  0.014700174331665039
generate_one_block  0.014642000198364258
generate_one_block  0.014447689056396484
generate_one_block  0.014768600463867188
generate_one_block  0.014353275299072266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03292036056518555
gen group dst list time:  0.01967763900756836
time for parepare:  0.020851850509643555
local_output_nid generation:  0.005194664001464844
local_in_edges_tensor generation:  0.015148162841796875
mini_batch_src_global generation:  0.011708736419677734
r_  generation:  0.11730337142944336
local_output_nid generation:  0.007831096649169922
local_in_edges_tensor generation:  0.007858753204345703
mini_batch_src_global generation:  0.017148971557617188
r_  generation:  0.12249350547790527
local_output_nid generation:  0.008236169815063477
local_in_edges_tensor generation:  0.026609420776367188
mini_batch_src_global generation:  0.01359248161315918
r_  generation:  0.1531224250793457
local_output_nid generation:  0.012957572937011719
local_in_edges_tensor generation:  0.014323711395263672
mini_batch_src_global generation:  0.0165555477142334
r_  generation:  0.13993382453918457
local_output_nid generation:  0.013139724731445312
local_in_edges_tensor generation:  0.010009288787841797
mini_batch_src_global generation:  0.01745748519897461
r_  generation:  0.14294695854187012
local_output_nid generation:  0.018951892852783203
local_in_edges_tensor generation:  0.015190362930297852
mini_batch_src_global generation:  0.02087998390197754
r_  generation:  0.13609528541564941
local_output_nid generation:  0.011400938034057617
local_in_edges_tensor generation:  0.0106201171875
mini_batch_src_global generation:  0.01619410514831543
r_  generation:  0.1398773193359375
local_output_nid generation:  0.010095357894897461
local_in_edges_tensor generation:  0.016979455947875977
mini_batch_src_global generation:  0.020060300827026367
r_  generation:  0.13968682289123535
local_output_nid generation:  0.009852886199951172
local_in_edges_tensor generation:  0.011491537094116211
mini_batch_src_global generation:  0.01650857925415039
r_  generation:  0.13732409477233887
local_output_nid generation:  0.008478403091430664
local_in_edges_tensor generation:  0.008026599884033203
mini_batch_src_global generation:  0.01638031005859375
r_  generation:  0.1340043544769287
local_output_nid generation:  0.008647918701171875
local_in_edges_tensor generation:  0.008400917053222656
mini_batch_src_global generation:  0.015959501266479492
r_  generation:  0.13235116004943848
local_output_nid generation:  0.008780956268310547
local_in_edges_tensor generation:  0.009982585906982422
mini_batch_src_global generation:  0.01765298843383789
r_  generation:  0.1355597972869873
local_output_nid generation:  0.008812665939331055
local_in_edges_tensor generation:  0.010230302810668945
mini_batch_src_global generation:  0.017034292221069336
r_  generation:  0.1392049789428711
local_output_nid generation:  0.008556365966796875
local_in_edges_tensor generation:  0.008016109466552734
mini_batch_src_global generation:  0.016358613967895508
r_  generation:  0.13393092155456543
local_output_nid generation:  0.00870823860168457
local_in_edges_tensor generation:  0.007792949676513672
mini_batch_src_global generation:  0.016461849212646484
r_  generation:  0.13498377799987793
local_output_nid generation:  0.008558034896850586
local_in_edges_tensor generation:  0.008174896240234375
mini_batch_src_global generation:  0.01640629768371582
r_  generation:  0.13405537605285645
local_output_nid generation:  0.008623123168945312
local_in_edges_tensor generation:  0.009888172149658203
mini_batch_src_global generation:  0.016717910766601562
r_  generation:  0.13672590255737305
local_output_nid generation:  0.008547306060791016
local_in_edges_tensor generation:  0.010848283767700195
mini_batch_src_global generation:  0.016984224319458008
r_  generation:  0.1361861228942871
local_output_nid generation:  0.008791685104370117
local_in_edges_tensor generation:  0.007752180099487305
mini_batch_src_global generation:  0.016857385635375977
r_  generation:  0.1381673812866211
local_output_nid generation:  0.008390665054321289
local_in_edges_tensor generation:  0.008512496948242188
mini_batch_src_global generation:  0.016295194625854492
r_  generation:  0.13340234756469727
local_output_nid generation:  0.008186578750610352
local_in_edges_tensor generation:  0.008880138397216797
mini_batch_src_global generation:  0.016832590103149414
r_  generation:  0.13802886009216309
local_output_nid generation:  0.008546113967895508
local_in_edges_tensor generation:  0.010708808898925781
mini_batch_src_global generation:  0.018464326858520508
r_  generation:  0.14450931549072266
local_output_nid generation:  0.008542776107788086
local_in_edges_tensor generation:  0.010330438613891602
mini_batch_src_global generation:  0.017609596252441406
r_  generation:  0.14199471473693848
local_output_nid generation:  0.008337020874023438
local_in_edges_tensor generation:  0.008858680725097656
mini_batch_src_global generation:  0.017438650131225586
r_  generation:  0.14066123962402344
local_output_nid generation:  0.008344411849975586
local_in_edges_tensor generation:  0.0076906681060791016
mini_batch_src_global generation:  0.016915082931518555
r_  generation:  0.13795852661132812
local_output_nid generation:  0.008217573165893555
local_in_edges_tensor generation:  0.00896763801574707
mini_batch_src_global generation:  0.016505718231201172
r_  generation:  0.13827037811279297
local_output_nid generation:  0.00803065299987793
local_in_edges_tensor generation:  0.008661031723022461
mini_batch_src_global generation:  0.015973806381225586
r_  generation:  0.1366126537322998
local_output_nid generation:  0.008272886276245117
local_in_edges_tensor generation:  0.008988380432128906
mini_batch_src_global generation:  0.017769813537597656
r_  generation:  0.1439683437347412
local_output_nid generation:  0.00825190544128418
local_in_edges_tensor generation:  0.011194467544555664
mini_batch_src_global generation:  0.016927242279052734
r_  generation:  0.1415235996246338
local_output_nid generation:  0.008163213729858398
local_in_edges_tensor generation:  0.00903630256652832
mini_batch_src_global generation:  0.01658463478088379
r_  generation:  0.14115262031555176
local_output_nid generation:  0.008173227310180664
local_in_edges_tensor generation:  0.01017618179321289
mini_batch_src_global generation:  0.016772747039794922
r_  generation:  0.14275383949279785
local_output_nid generation:  0.008063316345214844
local_in_edges_tensor generation:  0.007819414138793945
mini_batch_src_global generation:  0.01650857925415039
r_  generation:  0.13713359832763672
----------------------check_connections_block total spend ----------------------------- 6.632955312728882
generate_one_block  0.18404603004455566
generate_one_block  0.19170427322387695
generate_one_block  0.17185187339782715
generate_one_block  0.1676616668701172
generate_one_block  0.18008828163146973
generate_one_block  0.17020916938781738
generate_one_block  0.18509459495544434
generate_one_block  0.1764202117919922
generate_one_block  0.18213295936584473
generate_one_block  0.1786811351776123
generate_one_block  0.1674177646636963
generate_one_block  0.1823561191558838
generate_one_block  0.18143653869628906
generate_one_block  0.16726136207580566
generate_one_block  0.17340779304504395
generate_one_block  0.16775774955749512
generate_one_block  0.17526602745056152
generate_one_block  0.17557549476623535
generate_one_block  0.17864155769348145
generate_one_block  0.1964282989501953
generate_one_block  0.17264437675476074
generate_one_block  0.18621397018432617
generate_one_block  0.18285155296325684
generate_one_block  0.18178677558898926
generate_one_block  0.1795659065246582
generate_one_block  0.16980981826782227
generate_one_block  0.16590189933776855
generate_one_block  0.1797027587890625
generate_one_block  0.18024468421936035
generate_one_block  0.18204307556152344
generate_one_block  0.17888379096984863
generate_one_block  0.17240071296691895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04753589630126953
gen group dst list time:  0.09431123733520508
time for parepare:  0.01790618896484375
local_output_nid generation:  0.022943973541259766
local_in_edges_tensor generation:  0.05387616157531738
mini_batch_src_global generation:  0.03948497772216797
r_  generation:  0.39667272567749023
local_output_nid generation:  0.028588533401489258
local_in_edges_tensor generation:  0.048250436782836914
mini_batch_src_global generation:  0.047309160232543945
r_  generation:  0.415179967880249
local_output_nid generation:  0.03171133995056152
local_in_edges_tensor generation:  0.03979229927062988
mini_batch_src_global generation:  0.0519716739654541
r_  generation:  0.396198034286499
local_output_nid generation:  0.02704477310180664
local_in_edges_tensor generation:  0.03250837326049805
mini_batch_src_global generation:  0.04718661308288574
r_  generation:  0.3911745548248291
local_output_nid generation:  0.027300596237182617
local_in_edges_tensor generation:  0.030030012130737305
mini_batch_src_global generation:  0.04991483688354492
r_  generation:  0.3953557014465332
local_output_nid generation:  0.02719855308532715
local_in_edges_tensor generation:  0.029862642288208008
mini_batch_src_global generation:  0.04784703254699707
r_  generation:  0.39817142486572266
local_output_nid generation:  0.02732253074645996
local_in_edges_tensor generation:  0.0341341495513916
mini_batch_src_global generation:  0.047702789306640625
r_  generation:  0.4225926399230957
local_output_nid generation:  0.02730584144592285
local_in_edges_tensor generation:  0.03046417236328125
mini_batch_src_global generation:  0.04858088493347168
r_  generation:  0.4072127342224121
local_output_nid generation:  0.027614116668701172
local_in_edges_tensor generation:  0.030292987823486328
mini_batch_src_global generation:  0.05083203315734863
r_  generation:  0.40548181533813477
local_output_nid generation:  0.027387380599975586
local_in_edges_tensor generation:  0.03334403038024902
mini_batch_src_global generation:  0.0481569766998291
r_  generation:  0.40354204177856445
local_output_nid generation:  0.02719283103942871
local_in_edges_tensor generation:  0.02630448341369629
mini_batch_src_global generation:  0.04803967475891113
r_  generation:  0.40643763542175293
local_output_nid generation:  0.029482603073120117
local_in_edges_tensor generation:  0.026906490325927734
mini_batch_src_global generation:  0.04845118522644043
r_  generation:  0.41092538833618164
local_output_nid generation:  0.02749180793762207
local_in_edges_tensor generation:  0.051918983459472656
mini_batch_src_global generation:  0.0488276481628418
r_  generation:  0.4151957035064697
local_output_nid generation:  0.02841639518737793
local_in_edges_tensor generation:  0.030831336975097656
mini_batch_src_global generation:  0.048491477966308594
r_  generation:  0.4227330684661865
local_output_nid generation:  0.0299375057220459
local_in_edges_tensor generation:  0.03252744674682617
mini_batch_src_global generation:  0.052658796310424805
r_  generation:  0.4107346534729004
local_output_nid generation:  0.027560710906982422
local_in_edges_tensor generation:  0.028062105178833008
mini_batch_src_global generation:  0.048340797424316406
r_  generation:  0.40285325050354004
local_output_nid generation:  0.027310609817504883
local_in_edges_tensor generation:  0.025540590286254883
mini_batch_src_global generation:  0.04785966873168945
r_  generation:  0.40253472328186035
local_output_nid generation:  0.02763962745666504
local_in_edges_tensor generation:  0.03210592269897461
mini_batch_src_global generation:  0.04802584648132324
r_  generation:  0.40250182151794434
local_output_nid generation:  0.02779841423034668
local_in_edges_tensor generation:  0.03549385070800781
mini_batch_src_global generation:  0.0512385368347168
r_  generation:  0.41060709953308105
local_output_nid generation:  0.026971817016601562
local_in_edges_tensor generation:  0.02448892593383789
mini_batch_src_global generation:  0.06059908866882324
r_  generation:  0.40283703804016113
local_output_nid generation:  0.027393579483032227
local_in_edges_tensor generation:  0.02470111846923828
mini_batch_src_global generation:  0.04766368865966797
r_  generation:  0.4060215950012207
local_output_nid generation:  0.02760601043701172
local_in_edges_tensor generation:  0.03349423408508301
mini_batch_src_global generation:  0.048639774322509766
r_  generation:  0.4131028652191162
local_output_nid generation:  0.028213977813720703
local_in_edges_tensor generation:  0.03296685218811035
mini_batch_src_global generation:  0.047821760177612305
r_  generation:  0.41181445121765137
local_output_nid generation:  0.02787327766418457
local_in_edges_tensor generation:  0.025406599044799805
mini_batch_src_global generation:  0.04870867729187012
r_  generation:  0.4054241180419922
local_output_nid generation:  0.027760744094848633
local_in_edges_tensor generation:  0.028145551681518555
mini_batch_src_global generation:  0.05131721496582031
r_  generation:  0.4140045642852783
local_output_nid generation:  0.02953314781188965
local_in_edges_tensor generation:  0.02532482147216797
mini_batch_src_global generation:  0.04844355583190918
r_  generation:  0.39776015281677246
local_output_nid generation:  0.027003765106201172
local_in_edges_tensor generation:  0.028151988983154297
mini_batch_src_global generation:  0.047692298889160156
r_  generation:  0.396756649017334
local_output_nid generation:  0.027382373809814453
local_in_edges_tensor generation:  0.03710031509399414
mini_batch_src_global generation:  0.04851794242858887
r_  generation:  0.4044468402862549
local_output_nid generation:  0.02770519256591797
local_in_edges_tensor generation:  0.03168749809265137
mini_batch_src_global generation:  0.047821998596191406
r_  generation:  0.40541672706604004
local_output_nid generation:  0.02822113037109375
local_in_edges_tensor generation:  0.02782583236694336
mini_batch_src_global generation:  0.04822850227355957
r_  generation:  0.3986661434173584
local_output_nid generation:  0.027547597885131836
local_in_edges_tensor generation:  0.03150463104248047
mini_batch_src_global generation:  0.04855227470397949
r_  generation:  0.4102644920349121
local_output_nid generation:  0.027625083923339844
local_in_edges_tensor generation:  0.030224323272705078
mini_batch_src_global generation:  0.06544828414916992
r_  generation:  0.40381431579589844
----------------------check_connections_block total spend ----------------------------- 19.342349767684937
generate_one_block  0.5507757663726807
generate_one_block  0.5370264053344727
generate_one_block  0.5330715179443359
generate_one_block  0.518937349319458
generate_one_block  0.629723310470581
generate_one_block  0.5333757400512695
generate_one_block  0.5412163734436035
generate_one_block  0.5220801830291748
generate_one_block  0.5509276390075684
generate_one_block  0.5217351913452148
generate_one_block  0.5148990154266357
generate_one_block  0.5460033416748047
generate_one_block  0.541722297668457
generate_one_block  0.5207822322845459
generate_one_block  0.5332531929016113
generate_one_block  0.5163936614990234
generate_one_block  0.5273792743682861
generate_one_block  0.5357353687286377
generate_one_block  0.5446975231170654
generate_one_block  0.513049840927124
generate_one_block  0.5249075889587402
generate_one_block  0.5425693988800049
generate_one_block  0.5452802181243896
generate_one_block  0.5637786388397217
generate_one_block  0.550234317779541
generate_one_block  0.5292396545410156
generate_one_block  0.5463168621063232
generate_one_block  0.5573348999023438
generate_one_block  0.5386695861816406
generate_one_block  0.5224645137786865
generate_one_block  0.5392861366271973
generate_one_block  0.5248816013336182
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.10059547424316406  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

connection checking time:  25.97530508041382
block generation total time  22.903236865997314
average batch blocks generation time:  0.7157261520624161
block dataloader generation time/epoch 51.528510332107544
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08442878723144531  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145317, 128])
torch.Size([99052, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.085773944854736  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08446216583251953  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145480, 128])
torch.Size([98957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.074339866638184  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08547401428222656  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([146119, 128])
torch.Size([99485, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.121813774108887  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0843505859375  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145418, 128])
torch.Size([97930, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.02891492843628  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0843038558959961  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145388, 128])
torch.Size([98529, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.01827621459961  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08440542221069336  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145403, 128])
torch.Size([98863, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.059163570404053  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08652305603027344  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145586, 128])
torch.Size([99607, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.166320323944092  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08457660675048828  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145754, 128])
torch.Size([98833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.070788383483887  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08654499053955078  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145454, 128])
torch.Size([99781, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.246074676513672  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08436203002929688  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145186, 128])
torch.Size([98746, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.085055351257324  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08407449722290039  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([144841, 128])
torch.Size([97649, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 9.979074478149414  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08547401428222656  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145258, 128])
torch.Size([99284, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.205232620239258  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0853128433227539  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([144822, 128])
torch.Size([99265, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.199727535247803  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08420562744140625  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145002, 128])
torch.Size([98440, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.032901287078857  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08652210235595703  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145785, 128])
torch.Size([99735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.213126182556152  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08441638946533203  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145500, 128])
torch.Size([98636, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.017063617706299  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08549213409423828  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145545, 128])
torch.Size([98867, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.090150833129883  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08451557159423828  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145334, 128])
torch.Size([99247, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.167564392089844  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08654069900512695  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145887, 128])
torch.Size([100662, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.251227855682373  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0839076042175293  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([144741, 128])
torch.Size([97475, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 9.951818466186523  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08432340621948242  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([144999, 128])
torch.Size([99036, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.080399990081787  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08582925796508789  GigaBytes
Max Memory Allocated: 10.314019680023193  GigaBytes

torch.Size([145822, 128])
torch.Size([100657, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.317429065704346  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08659076690673828  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([145730, 128])
torch.Size([100536, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.280404090881348  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08587646484375  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([146023, 128])
torch.Size([99896, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.157546520233154  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.086517333984375  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([145881, 128])
torch.Size([99828, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.182222843170166  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0845484733581543  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([145579, 128])
torch.Size([99279, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.085349082946777  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08414411544799805  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([145141, 128])
torch.Size([97761, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 9.97956132888794  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08565998077392578  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([145610, 128])
torch.Size([99851, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.18215274810791  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08553409576416016  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([145537, 128])
torch.Size([99250, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.116567134857178  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08421897888183594  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([144852, 128])
torch.Size([98163, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.04704236984253  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.08537006378173828  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([144977, 128])
torch.Size([99088, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.199613094329834  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 0.0842132568359375  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

torch.Size([144886, 128])
torch.Size([98672, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0057373046875 GB
    Memory Allocated: 10.05580759048462  GigaBytes
Max Memory Allocated: 10.321151733398438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03437739610671997 |0.013213470578193665 |0.2318851575255394 |9.442120790481567e-05 |0.2906891033053398 |0.0058269500732421875 |
----------------------------------------------------------pseudo_mini_loss sum 3.7065136432647705
Total (block generation + training)time/epoch 69.83401894569397
Training time/epoch 18.305226802825928
Training time without block to device /epoch 17.88239574432373
Training time without total dataloading part /epoch 16.73122477531433
load block tensor time/epoch 1.100076675415039
block to device time/epoch 0.42283105850219727
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8575579
Number of first layer input nodes during this epoch:  4652857
