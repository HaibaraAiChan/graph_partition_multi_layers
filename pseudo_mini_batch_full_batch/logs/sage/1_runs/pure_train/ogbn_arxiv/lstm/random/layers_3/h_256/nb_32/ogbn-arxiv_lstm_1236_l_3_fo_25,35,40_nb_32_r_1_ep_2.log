Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648463142.1722088
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023823976516723633
random selection method range initialization spend 0.00576472282409668
time for parepare:  0.019601821899414062
local_output_nid generation:  0.0011413097381591797
local_in_edges_tensor generation:  0.0031652450561523438
mini_batch_src_global generation:  0.0015027523040771484
r_  generation:  0.009534597396850586
local_output_nid generation:  0.0014581680297851562
local_in_edges_tensor generation:  0.0009524822235107422
mini_batch_src_global generation:  0.0014905929565429688
r_  generation:  0.008095026016235352
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0009324550628662109
r_  generation:  0.007364749908447266
local_output_nid generation:  0.0014905929565429688
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  0.0009343624114990234
r_  generation:  0.007591962814331055
local_output_nid generation:  0.0014362335205078125
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.0008246898651123047
r_  generation:  0.007744312286376953
local_output_nid generation:  0.0014150142669677734
local_in_edges_tensor generation:  0.0007603168487548828
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.008126258850097656
local_output_nid generation:  0.0013995170593261719
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.00818014144897461
local_output_nid generation:  0.0013852119445800781
local_in_edges_tensor generation:  0.0007441043853759766
mini_batch_src_global generation:  0.00099945068359375
r_  generation:  0.008153200149536133
local_output_nid generation:  0.0013794898986816406
local_in_edges_tensor generation:  0.0007269382476806641
mini_batch_src_global generation:  0.0008573532104492188
r_  generation:  0.008116483688354492
local_output_nid generation:  0.0013904571533203125
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008869171142578125
r_  generation:  0.008124113082885742
local_output_nid generation:  0.001402139663696289
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0009810924530029297
r_  generation:  0.008399248123168945
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.0007271766662597656
mini_batch_src_global generation:  0.0008566379547119141
r_  generation:  0.008408069610595703
local_output_nid generation:  0.0014023780822753906
local_in_edges_tensor generation:  0.0007224082946777344
mini_batch_src_global generation:  0.0008482933044433594
r_  generation:  0.008015155792236328
local_output_nid generation:  0.0013699531555175781
local_in_edges_tensor generation:  0.0007119178771972656
mini_batch_src_global generation:  0.0008668899536132812
r_  generation:  0.008336067199707031
local_output_nid generation:  0.0013844966888427734
local_in_edges_tensor generation:  0.0007193088531494141
mini_batch_src_global generation:  0.0008535385131835938
r_  generation:  0.008221864700317383
local_output_nid generation:  0.001432180404663086
local_in_edges_tensor generation:  0.0006954669952392578
mini_batch_src_global generation:  0.0008516311645507812
r_  generation:  0.007910490036010742
local_output_nid generation:  0.0013988018035888672
local_in_edges_tensor generation:  0.0007047653198242188
mini_batch_src_global generation:  0.0008718967437744141
r_  generation:  0.008525609970092773
local_output_nid generation:  0.0014009475708007812
local_in_edges_tensor generation:  0.0007250308990478516
mini_batch_src_global generation:  0.0008647441864013672
r_  generation:  0.00816965103149414
local_output_nid generation:  0.0014233589172363281
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0008678436279296875
r_  generation:  0.008153915405273438
local_output_nid generation:  0.0014028549194335938
local_in_edges_tensor generation:  0.0006997585296630859
mini_batch_src_global generation:  0.0008382797241210938
r_  generation:  0.00801849365234375
local_output_nid generation:  0.0013761520385742188
local_in_edges_tensor generation:  0.0007016658782958984
mini_batch_src_global generation:  0.0008327960968017578
r_  generation:  0.0081787109375
local_output_nid generation:  0.0014357566833496094
local_in_edges_tensor generation:  0.0007066726684570312
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.008178234100341797
local_output_nid generation:  0.0013689994812011719
local_in_edges_tensor generation:  0.0007150173187255859
mini_batch_src_global generation:  0.0008678436279296875
r_  generation:  0.008573293685913086
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.0007183551788330078
mini_batch_src_global generation:  0.0009107589721679688
r_  generation:  0.008535385131835938
local_output_nid generation:  0.0013957023620605469
local_in_edges_tensor generation:  0.0007038116455078125
mini_batch_src_global generation:  0.0008673667907714844
r_  generation:  0.008373498916625977
local_output_nid generation:  0.0013885498046875
local_in_edges_tensor generation:  0.0007061958312988281
mini_batch_src_global generation:  0.0009047985076904297
r_  generation:  0.008134603500366211
local_output_nid generation:  0.0013916492462158203
local_in_edges_tensor generation:  0.0007071495056152344
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.008141040802001953
local_output_nid generation:  0.0013773441314697266
local_in_edges_tensor generation:  0.0007123947143554688
mini_batch_src_global generation:  0.0008673667907714844
r_  generation:  0.00846552848815918
local_output_nid generation:  0.0014476776123046875
local_in_edges_tensor generation:  0.0007221698760986328
mini_batch_src_global generation:  0.0008978843688964844
r_  generation:  0.008600950241088867
local_output_nid generation:  0.001390695571899414
local_in_edges_tensor generation:  0.005474090576171875
mini_batch_src_global generation:  0.0011098384857177734
r_  generation:  0.00832056999206543
local_output_nid generation:  0.0012989044189453125
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.008100032806396484
local_output_nid generation:  0.0012900829315185547
local_in_edges_tensor generation:  0.0007357597351074219
mini_batch_src_global generation:  0.0008904933929443359
r_  generation:  0.008105993270874023
----------------------check_connections_block total spend ----------------------------- 0.46906042098999023
generate_one_block  0.014390707015991211
generate_one_block  0.013654232025146484
generate_one_block  0.012648820877075195
generate_one_block  0.012845516204833984
generate_one_block  0.012818098068237305
generate_one_block  0.013327836990356445
generate_one_block  0.013168573379516602
generate_one_block  0.013319015502929688
generate_one_block  0.013171195983886719
generate_one_block  0.013438701629638672
generate_one_block  0.01361083984375
generate_one_block  0.013068437576293945
generate_one_block  0.012701034545898438
generate_one_block  0.013151168823242188
generate_one_block  0.013105154037475586
generate_one_block  0.012626409530639648
generate_one_block  0.01357269287109375
generate_one_block  0.012819766998291016
generate_one_block  0.012899160385131836
generate_one_block  0.01268625259399414
generate_one_block  0.012885808944702148
generate_one_block  0.013028144836425781
generate_one_block  0.013634443283081055
generate_one_block  0.013273954391479492
generate_one_block  0.01313638687133789
generate_one_block  0.012987136840820312
generate_one_block  0.012685775756835938
generate_one_block  0.013336181640625
generate_one_block  0.013618946075439453
generate_one_block  0.013055562973022461
generate_one_block  0.012951850891113281
generate_one_block  0.01277017593383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03840947151184082
gen group dst list time:  0.021564483642578125
time for parepare:  0.019063949584960938
local_output_nid generation:  0.004724264144897461
local_in_edges_tensor generation:  0.011554241180419922
mini_batch_src_global generation:  0.012127161026000977
r_  generation:  0.12087106704711914
local_output_nid generation:  0.007832527160644531
local_in_edges_tensor generation:  0.012030601501464844
mini_batch_src_global generation:  0.015476226806640625
r_  generation:  0.12785077095031738
local_output_nid generation:  0.007169008255004883
local_in_edges_tensor generation:  0.00819706916809082
mini_batch_src_global generation:  0.013173103332519531
r_  generation:  0.12381839752197266
local_output_nid generation:  0.007181882858276367
local_in_edges_tensor generation:  0.007285594940185547
mini_batch_src_global generation:  0.014126062393188477
r_  generation:  0.1261444091796875
local_output_nid generation:  0.0070934295654296875
local_in_edges_tensor generation:  0.007593631744384766
mini_batch_src_global generation:  0.01567864418029785
r_  generation:  0.130950927734375
local_output_nid generation:  0.007401466369628906
local_in_edges_tensor generation:  0.008553028106689453
mini_batch_src_global generation:  0.01672983169555664
r_  generation:  0.1370863914489746
local_output_nid generation:  0.00734710693359375
local_in_edges_tensor generation:  0.009727239608764648
mini_batch_src_global generation:  0.01882457733154297
r_  generation:  0.13512754440307617
local_output_nid generation:  0.008352994918823242
local_in_edges_tensor generation:  0.009137392044067383
mini_batch_src_global generation:  0.018484115600585938
r_  generation:  0.13892483711242676
local_output_nid generation:  0.007537126541137695
local_in_edges_tensor generation:  0.014507770538330078
mini_batch_src_global generation:  0.01836228370666504
r_  generation:  0.13955307006835938
local_output_nid generation:  0.008530616760253906
local_in_edges_tensor generation:  0.00820159912109375
mini_batch_src_global generation:  0.01638650894165039
r_  generation:  0.13253068923950195
local_output_nid generation:  0.007733583450317383
local_in_edges_tensor generation:  0.01077890396118164
mini_batch_src_global generation:  0.01785731315612793
r_  generation:  0.13882040977478027
local_output_nid generation:  0.007529497146606445
local_in_edges_tensor generation:  0.007518291473388672
mini_batch_src_global generation:  0.016579866409301758
r_  generation:  0.1345205307006836
local_output_nid generation:  0.007357358932495117
local_in_edges_tensor generation:  0.008286237716674805
mini_batch_src_global generation:  0.015897035598754883
r_  generation:  0.1322765350341797
local_output_nid generation:  0.007619619369506836
local_in_edges_tensor generation:  0.008431673049926758
mini_batch_src_global generation:  0.01726984977722168
r_  generation:  0.1350870132446289
local_output_nid generation:  0.00752568244934082
local_in_edges_tensor generation:  0.009654998779296875
mini_batch_src_global generation:  0.016564607620239258
r_  generation:  0.1343517303466797
local_output_nid generation:  0.00733184814453125
local_in_edges_tensor generation:  0.008195638656616211
mini_batch_src_global generation:  0.015703678131103516
r_  generation:  0.12876677513122559
local_output_nid generation:  0.00775456428527832
local_in_edges_tensor generation:  0.007568836212158203
mini_batch_src_global generation:  0.016141414642333984
r_  generation:  0.13619232177734375
local_output_nid generation:  0.007428646087646484
local_in_edges_tensor generation:  0.009442567825317383
mini_batch_src_global generation:  0.016444921493530273
r_  generation:  0.13387298583984375
local_output_nid generation:  0.007536172866821289
local_in_edges_tensor generation:  0.009543657302856445
mini_batch_src_global generation:  0.01624917984008789
r_  generation:  0.13799285888671875
local_output_nid generation:  0.0075168609619140625
local_in_edges_tensor generation:  0.008518695831298828
mini_batch_src_global generation:  0.016212940216064453
r_  generation:  0.13290190696716309
local_output_nid generation:  0.007550716400146484
local_in_edges_tensor generation:  0.009536504745483398
mini_batch_src_global generation:  0.016193866729736328
r_  generation:  0.1349318027496338
local_output_nid generation:  0.007383108139038086
local_in_edges_tensor generation:  0.0074307918548583984
mini_batch_src_global generation:  0.015956640243530273
r_  generation:  0.1346726417541504
local_output_nid generation:  0.007578849792480469
local_in_edges_tensor generation:  0.009995698928833008
mini_batch_src_global generation:  0.016520261764526367
r_  generation:  0.1383063793182373
local_output_nid generation:  0.007578611373901367
local_in_edges_tensor generation:  0.00980997085571289
mini_batch_src_global generation:  0.016358613967895508
r_  generation:  0.1369915008544922
local_output_nid generation:  0.007627964019775391
local_in_edges_tensor generation:  0.007531881332397461
mini_batch_src_global generation:  0.016488313674926758
r_  generation:  0.1377561092376709
local_output_nid generation:  0.007476329803466797
local_in_edges_tensor generation:  0.008501052856445312
mini_batch_src_global generation:  0.016409635543823242
r_  generation:  0.13650798797607422
local_output_nid generation:  0.0073337554931640625
local_in_edges_tensor generation:  0.008295536041259766
mini_batch_src_global generation:  0.01569986343383789
r_  generation:  0.13212800025939941
local_output_nid generation:  0.007638692855834961
local_in_edges_tensor generation:  0.0074198246002197266
mini_batch_src_global generation:  0.017100095748901367
r_  generation:  0.13744521141052246
local_output_nid generation:  0.007651805877685547
local_in_edges_tensor generation:  0.00872802734375
mini_batch_src_global generation:  0.01743006706237793
r_  generation:  0.13814330101013184
local_output_nid generation:  0.0074405670166015625
local_in_edges_tensor generation:  0.007475376129150391
mini_batch_src_global generation:  0.0165860652923584
r_  generation:  0.13558030128479004
local_output_nid generation:  0.007378339767456055
local_in_edges_tensor generation:  0.008032798767089844
mini_batch_src_global generation:  0.01567816734313965
r_  generation:  0.13251018524169922
local_output_nid generation:  0.0073316097259521484
local_in_edges_tensor generation:  0.007334232330322266
mini_batch_src_global generation:  0.016051054000854492
r_  generation:  0.13478851318359375
----------------------check_connections_block total spend ----------------------------- 6.357920408248901
generate_one_block  0.17559432983398438
generate_one_block  0.17249488830566406
generate_one_block  0.17635536193847656
generate_one_block  0.15949034690856934
generate_one_block  0.16237092018127441
generate_one_block  0.16906046867370605
generate_one_block  0.16856932640075684
generate_one_block  0.16926169395446777
generate_one_block  0.16942930221557617
generate_one_block  0.1625831127166748
generate_one_block  0.1735982894897461
generate_one_block  0.16492748260498047
generate_one_block  0.15952467918395996
generate_one_block  0.16511178016662598
generate_one_block  0.16659975051879883
generate_one_block  0.1765737533569336
generate_one_block  0.16900181770324707
generate_one_block  0.1647171974182129
generate_one_block  0.1649937629699707
generate_one_block  0.15976762771606445
generate_one_block  0.16284966468811035
generate_one_block  0.1632535457611084
generate_one_block  0.18872570991516113
generate_one_block  0.17261123657226562
generate_one_block  0.1677718162536621
generate_one_block  0.16746807098388672
generate_one_block  0.15758109092712402
generate_one_block  0.17817258834838867
generate_one_block  0.1767139434814453
generate_one_block  0.16337347030639648
generate_one_block  0.16984987258911133
generate_one_block  0.16420269012451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06110215187072754
gen group dst list time:  0.10759592056274414
time for parepare:  0.020088911056518555
local_output_nid generation:  0.021541833877563477
local_in_edges_tensor generation:  0.059067487716674805
mini_batch_src_global generation:  0.042104244232177734
r_  generation:  0.3852424621582031
local_output_nid generation:  0.027832746505737305
local_in_edges_tensor generation:  0.040166378021240234
mini_batch_src_global generation:  0.04661083221435547
r_  generation:  0.4031953811645508
local_output_nid generation:  0.026922941207885742
local_in_edges_tensor generation:  0.032407283782958984
mini_batch_src_global generation:  0.045944929122924805
r_  generation:  0.39075398445129395
local_output_nid generation:  0.026154041290283203
local_in_edges_tensor generation:  0.03280472755432129
mini_batch_src_global generation:  0.04644775390625
r_  generation:  0.39919209480285645
local_output_nid generation:  0.025668621063232422
local_in_edges_tensor generation:  0.026079416275024414
mini_batch_src_global generation:  0.046509504318237305
r_  generation:  0.39701199531555176
local_output_nid generation:  0.025908708572387695
local_in_edges_tensor generation:  0.029213666915893555
mini_batch_src_global generation:  0.05081367492675781
r_  generation:  0.406008243560791
local_output_nid generation:  0.02866673469543457
local_in_edges_tensor generation:  0.029833316802978516
mini_batch_src_global generation:  0.04721856117248535
r_  generation:  0.412839412689209
local_output_nid generation:  0.02622056007385254
local_in_edges_tensor generation:  0.03374004364013672
mini_batch_src_global generation:  0.05106544494628906
r_  generation:  0.4113290309906006
local_output_nid generation:  0.0270688533782959
local_in_edges_tensor generation:  0.04426217079162598
mini_batch_src_global generation:  0.05305123329162598
r_  generation:  0.4234950542449951
local_output_nid generation:  0.02957916259765625
local_in_edges_tensor generation:  0.03288984298706055
mini_batch_src_global generation:  0.04790759086608887
r_  generation:  0.40117955207824707
local_output_nid generation:  0.026622295379638672
local_in_edges_tensor generation:  0.02975773811340332
mini_batch_src_global generation:  0.0470888614654541
r_  generation:  0.4028489589691162
local_output_nid generation:  0.026575326919555664
local_in_edges_tensor generation:  0.03339743614196777
mini_batch_src_global generation:  0.04712629318237305
r_  generation:  0.39835047721862793
local_output_nid generation:  0.026182174682617188
local_in_edges_tensor generation:  0.029252052307128906
mini_batch_src_global generation:  0.04671597480773926
r_  generation:  0.3990962505340576
local_output_nid generation:  0.02651500701904297
local_in_edges_tensor generation:  0.02930903434753418
mini_batch_src_global generation:  0.05047154426574707
r_  generation:  0.40042948722839355
local_output_nid generation:  0.02654409408569336
local_in_edges_tensor generation:  0.025913476943969727
mini_batch_src_global generation:  0.046819448471069336
r_  generation:  0.404620885848999
local_output_nid generation:  0.02640509605407715
local_in_edges_tensor generation:  0.027036666870117188
mini_batch_src_global generation:  0.061511993408203125
r_  generation:  0.4005444049835205
local_output_nid generation:  0.026556730270385742
local_in_edges_tensor generation:  0.03309154510498047
mini_batch_src_global generation:  0.04713606834411621
r_  generation:  0.40507054328918457
local_output_nid generation:  0.02673649787902832
local_in_edges_tensor generation:  0.043169260025024414
mini_batch_src_global generation:  0.047486305236816406
r_  generation:  0.4034280776977539
local_output_nid generation:  0.027487993240356445
local_in_edges_tensor generation:  0.031115293502807617
mini_batch_src_global generation:  0.05194997787475586
r_  generation:  0.4201180934906006
local_output_nid generation:  0.026579856872558594
local_in_edges_tensor generation:  0.03208589553833008
mini_batch_src_global generation:  0.05048322677612305
r_  generation:  0.4070005416870117
local_output_nid generation:  0.02767777442932129
local_in_edges_tensor generation:  0.027914047241210938
mini_batch_src_global generation:  0.04736447334289551
r_  generation:  0.4022698402404785
local_output_nid generation:  0.02663588523864746
local_in_edges_tensor generation:  0.031072616577148438
mini_batch_src_global generation:  0.049483299255371094
r_  generation:  0.4047856330871582
local_output_nid generation:  0.026901960372924805
local_in_edges_tensor generation:  0.03279471397399902
mini_batch_src_global generation:  0.04681134223937988
r_  generation:  0.4076671600341797
local_output_nid generation:  0.02716517448425293
local_in_edges_tensor generation:  0.03406810760498047
mini_batch_src_global generation:  0.0598907470703125
r_  generation:  0.448199987411499
local_output_nid generation:  0.03022003173828125
local_in_edges_tensor generation:  0.035179853439331055
mini_batch_src_global generation:  0.060631513595581055
r_  generation:  0.41240739822387695
local_output_nid generation:  0.026854991912841797
local_in_edges_tensor generation:  0.03213334083557129
mini_batch_src_global generation:  0.05050539970397949
r_  generation:  0.41653966903686523
local_output_nid generation:  0.026828527450561523
local_in_edges_tensor generation:  0.03370046615600586
mini_batch_src_global generation:  0.04986119270324707
r_  generation:  0.4163048267364502
local_output_nid generation:  0.02770376205444336
local_in_edges_tensor generation:  0.03459596633911133
mini_batch_src_global generation:  0.05515432357788086
r_  generation:  0.41492319107055664
local_output_nid generation:  0.028197288513183594
local_in_edges_tensor generation:  0.03905153274536133
mini_batch_src_global generation:  0.049219608306884766
r_  generation:  0.4101722240447998
local_output_nid generation:  0.02689361572265625
local_in_edges_tensor generation:  0.028762102127075195
mini_batch_src_global generation:  0.05003046989440918
r_  generation:  0.41117167472839355
local_output_nid generation:  0.02671980857849121
local_in_edges_tensor generation:  0.02459430694580078
mini_batch_src_global generation:  0.04878592491149902
r_  generation:  0.40814781188964844
local_output_nid generation:  0.02679920196533203
local_in_edges_tensor generation:  0.024209976196289062
mini_batch_src_global generation:  0.05057358741760254
r_  generation:  0.4031851291656494
----------------------check_connections_block total spend ----------------------------- 19.430745124816895
generate_one_block  0.6330256462097168
generate_one_block  0.5339477062225342
generate_one_block  0.5201010704040527
generate_one_block  0.5118370056152344
generate_one_block  0.5113210678100586
generate_one_block  0.5549869537353516
generate_one_block  0.515789270401001
generate_one_block  0.5574586391448975
generate_one_block  0.5504729747772217
generate_one_block  0.5124611854553223
generate_one_block  0.5207827091217041
generate_one_block  0.5372538566589355
generate_one_block  0.5062863826751709
generate_one_block  0.5247368812561035
generate_one_block  0.5243468284606934
generate_one_block  0.5014104843139648
generate_one_block  0.5111098289489746
generate_one_block  0.5072124004364014
generate_one_block  0.5098962783813477
generate_one_block  0.5081019401550293
generate_one_block  0.5242059230804443
generate_one_block  0.5161709785461426
generate_one_block  0.5294926166534424
generate_one_block  0.5271327495574951
generate_one_block  0.5039899349212646
generate_one_block  0.5097064971923828
generate_one_block  0.5092415809631348
generate_one_block  0.5231020450592041
generate_one_block  0.5318739414215088
generate_one_block  0.5067558288574219
generate_one_block  0.4992406368255615
generate_one_block  0.5034406185150146
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  25.788665533065796
block generation total time  22.119492053985596
average batch blocks generation time:  0.6912341266870499
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08707141876220703  GigaBytes
Max Memory Allocated: 0.08707141876220703  GigaBytes

torch.Size([145311, 128])
torch.Size([99847, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7635498046875 GB
    Memory Allocated: 16.11770009994507  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5252685546875 GB
    Memory Allocated: 0.09371566772460938  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145596, 128])
torch.Size([99637, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6971435546875 GB
    Memory Allocated: 16.003468990325928  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 0.0921635627746582  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145095, 128])
torch.Size([97792, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 15.32850694656372  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 0.0925741195678711  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145660, 128])
torch.Size([99103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 15.47266674041748  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 0.09226655960083008  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145025, 128])
torch.Size([98594, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 15.515403270721436  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6990966796875 GB
    Memory Allocated: 0.09349441528320312  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145193, 128])
torch.Size([99331, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7596435546875 GB
    Memory Allocated: 15.87046480178833  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09244203567504883  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145167, 128])
torch.Size([99314, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.706087112426758  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09376668930053711  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145754, 128])
torch.Size([100051, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.926642894744873  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09457159042358398  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145478, 128])
torch.Size([99867, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.876965522766113  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09253787994384766  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145398, 128])
torch.Size([98874, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.699828147888184  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09358835220336914  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145327, 128])
torch.Size([99278, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.957930088043213  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.0934901237487793  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145201, 128])
torch.Size([99420, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.852496147155762  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09199094772338867  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([144257, 128])
torch.Size([97661, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.439497470855713  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09277868270874023  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145833, 128])
torch.Size([99203, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.738106727600098  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09356498718261719  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145424, 128])
torch.Size([99271, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.74698257446289  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09229040145874023  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145567, 128])
torch.Size([97578, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.157617092132568  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.0925297737121582  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145247, 128])
torch.Size([99296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.832154273986816  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09242820739746094  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145282, 128])
torch.Size([98566, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.58698558807373  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09354305267333984  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145724, 128])
torch.Size([99082, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.7192063331604  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09260988235473633  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145733, 128])
torch.Size([98956, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.514162063598633  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09240436553955078  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145226, 128])
torch.Size([98571, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.601188659667969  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09246444702148438  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145346, 128])
torch.Size([98822, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.55995798110962  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09359169006347656  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145820, 128])
torch.Size([99528, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.827411651611328  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09372758865356445  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145690, 128])
torch.Size([99853, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.880388259887695  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09357833862304688  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145414, 128])
torch.Size([99188, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.778284072875977  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09346961975097656  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145178, 128])
torch.Size([99006, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.756322860717773  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.0933084487915039  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145408, 128])
torch.Size([98543, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.36584758758545  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09353399276733398  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145292, 128])
torch.Size([99295, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.776445388793945  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09458398818969727  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145589, 128])
torch.Size([99959, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.968401908874512  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.09275197982788086  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145885, 128])
torch.Size([98977, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.643465042114258  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.0923299789428711  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145198, 128])
torch.Size([98758, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.497611045837402  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.0923457145690918  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145109, 128])
torch.Size([98342, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.59692668914795  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025856368243694305 |0.023437947034835815 |0.2909161224961281 |0.00010035187005996704 |0.448618583381176 |0.006645679473876953 |
----------------------------------------------------------pseudo_mini_loss sum 5.382789134979248
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8573973
Number of first layer input nodes during this epoch:  4652427
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.11951541900634766  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021668195724487305
random selection method range initialization spend 0.006346940994262695
time for parepare:  0.019825458526611328
local_output_nid generation:  0.0013625621795654297
local_in_edges_tensor generation:  0.004066944122314453
mini_batch_src_global generation:  0.0020551681518554688
r_  generation:  0.009552001953125
local_output_nid generation:  0.00159454345703125
local_in_edges_tensor generation:  0.0010166168212890625
mini_batch_src_global generation:  0.0015206336975097656
r_  generation:  0.008296966552734375
local_output_nid generation:  0.0016546249389648438
local_in_edges_tensor generation:  0.0009150505065917969
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.00809931755065918
local_output_nid generation:  0.0015780925750732422
local_in_edges_tensor generation:  0.0008838176727294922
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.008105039596557617
local_output_nid generation:  0.0015268325805664062
local_in_edges_tensor generation:  0.0008349418640136719
mini_batch_src_global generation:  0.0010340213775634766
r_  generation:  0.008130788803100586
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0008208751678466797
mini_batch_src_global generation:  0.0009319782257080078
r_  generation:  0.007993459701538086
local_output_nid generation:  0.001514434814453125
local_in_edges_tensor generation:  0.0008530616760253906
mini_batch_src_global generation:  0.0009148120880126953
r_  generation:  0.007899045944213867
local_output_nid generation:  0.0014901161193847656
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.0008852481842041016
r_  generation:  0.007968425750732422
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0008985996246337891
r_  generation:  0.007912874221801758
local_output_nid generation:  0.0014922618865966797
local_in_edges_tensor generation:  0.0007853507995605469
mini_batch_src_global generation:  0.0009379386901855469
r_  generation:  0.008233070373535156
local_output_nid generation:  0.0014929771423339844
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0010035037994384766
r_  generation:  0.008308649063110352
local_output_nid generation:  0.0014863014221191406
local_in_edges_tensor generation:  0.0007905960083007812
mini_batch_src_global generation:  0.0009150505065917969
r_  generation:  0.008137226104736328
local_output_nid generation:  0.0015201568603515625
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.0008966922760009766
r_  generation:  0.00791168212890625
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.000804901123046875
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.007866382598876953
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008111000061035156
mini_batch_src_global generation:  0.0009412765502929688
r_  generation:  0.00845789909362793
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0008072853088378906
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.007867813110351562
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0009331703186035156
r_  generation:  0.008010625839233398
local_output_nid generation:  0.0014972686767578125
local_in_edges_tensor generation:  0.0008118152618408203
mini_batch_src_global generation:  0.0009317398071289062
r_  generation:  0.008264780044555664
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.0007901191711425781
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.008307218551635742
local_output_nid generation:  0.001489400863647461
local_in_edges_tensor generation:  0.0007815361022949219
mini_batch_src_global generation:  0.0009119510650634766
r_  generation:  0.008280515670776367
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0007688999176025391
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.008231163024902344
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.008585691452026367
local_output_nid generation:  0.001500844955444336
local_in_edges_tensor generation:  0.0007729530334472656
mini_batch_src_global generation:  0.0009152889251708984
r_  generation:  0.008330583572387695
local_output_nid generation:  0.0014700889587402344
local_in_edges_tensor generation:  0.0007760524749755859
mini_batch_src_global generation:  0.0008921623229980469
r_  generation:  0.008147954940795898
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.0008955001831054688
r_  generation:  0.008310079574584961
local_output_nid generation:  0.0014641284942626953
local_in_edges_tensor generation:  0.0007779598236083984
mini_batch_src_global generation:  0.0008873939514160156
r_  generation:  0.008174896240234375
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.0009105205535888672
r_  generation:  0.008450984954833984
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.0008897781372070312
r_  generation:  0.008242368698120117
local_output_nid generation:  0.0014827251434326172
local_in_edges_tensor generation:  0.0008008480072021484
mini_batch_src_global generation:  0.0009431838989257812
r_  generation:  0.00831913948059082
local_output_nid generation:  0.0014674663543701172
local_in_edges_tensor generation:  0.0007603168487548828
mini_batch_src_global generation:  0.0009007453918457031
r_  generation:  0.008245468139648438
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.0007660388946533203
mini_batch_src_global generation:  0.0009303092956542969
r_  generation:  0.008254051208496094
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.0008864402770996094
r_  generation:  0.008272886276245117
----------------------check_connections_block total spend ----------------------------- 0.4758188724517822
generate_one_block  0.020336151123046875
generate_one_block  0.01790785789489746
generate_one_block  0.015548229217529297
generate_one_block  0.014978170394897461
generate_one_block  0.014954566955566406
generate_one_block  0.014445304870605469
generate_one_block  0.014245986938476562
generate_one_block  0.014281749725341797
generate_one_block  0.01432347297668457
generate_one_block  0.014625310897827148
generate_one_block  0.014825820922851562
generate_one_block  0.014634847640991211
generate_one_block  0.014071226119995117
generate_one_block  0.01396036148071289
generate_one_block  0.014894723892211914
generate_one_block  0.013915538787841797
generate_one_block  0.014194965362548828
generate_one_block  0.014661788940429688
generate_one_block  0.014775991439819336
generate_one_block  0.01452326774597168
generate_one_block  0.014497995376586914
generate_one_block  0.01482391357421875
generate_one_block  0.014579296112060547
generate_one_block  0.014390707015991211
generate_one_block  0.014305830001831055
generate_one_block  0.014297246932983398
generate_one_block  0.014625310897827148
generate_one_block  0.014261722564697266
generate_one_block  0.01440119743347168
generate_one_block  0.014458179473876953
generate_one_block  0.01449131965637207
generate_one_block  0.014264106750488281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03879141807556152
gen group dst list time:  0.01970958709716797
time for parepare:  0.01934361457824707
local_output_nid generation:  0.005213260650634766
local_in_edges_tensor generation:  0.016198396682739258
mini_batch_src_global generation:  0.01128077507019043
r_  generation:  0.11619234085083008
local_output_nid generation:  0.008285760879516602
local_in_edges_tensor generation:  0.007996082305908203
mini_batch_src_global generation:  0.014397382736206055
r_  generation:  0.14679718017578125
local_output_nid generation:  0.013040304183959961
local_in_edges_tensor generation:  0.040018320083618164
mini_batch_src_global generation:  0.018030643463134766
r_  generation:  0.1496598720550537
local_output_nid generation:  0.013330221176147461
local_in_edges_tensor generation:  0.01154327392578125
mini_batch_src_global generation:  0.01859736442565918
r_  generation:  0.14954805374145508
local_output_nid generation:  0.01323699951171875
local_in_edges_tensor generation:  0.012768983840942383
mini_batch_src_global generation:  0.02047586441040039
r_  generation:  0.15939640998840332
local_output_nid generation:  0.012881278991699219
local_in_edges_tensor generation:  0.012594938278198242
mini_batch_src_global generation:  0.020577192306518555
r_  generation:  0.15189552307128906
local_output_nid generation:  0.012016057968139648
local_in_edges_tensor generation:  0.01107168197631836
mini_batch_src_global generation:  0.0209348201751709
r_  generation:  0.17260313034057617
local_output_nid generation:  0.011554479598999023
local_in_edges_tensor generation:  0.00946497917175293
mini_batch_src_global generation:  0.017412900924682617
r_  generation:  0.13593673706054688
local_output_nid generation:  0.009660959243774414
local_in_edges_tensor generation:  0.009738922119140625
mini_batch_src_global generation:  0.016117572784423828
r_  generation:  0.13795948028564453
local_output_nid generation:  0.009388208389282227
local_in_edges_tensor generation:  0.009866476058959961
mini_batch_src_global generation:  0.016503095626831055
r_  generation:  0.14409184455871582
local_output_nid generation:  0.010028839111328125
local_in_edges_tensor generation:  0.009330034255981445
mini_batch_src_global generation:  0.017612934112548828
r_  generation:  0.14322447776794434
local_output_nid generation:  0.009743213653564453
local_in_edges_tensor generation:  0.008421659469604492
mini_batch_src_global generation:  0.0167844295501709
r_  generation:  0.13868451118469238
local_output_nid generation:  0.009319067001342773
local_in_edges_tensor generation:  0.008411169052124023
mini_batch_src_global generation:  0.01557779312133789
r_  generation:  0.1341414451599121
local_output_nid generation:  0.009238958358764648
local_in_edges_tensor generation:  0.010850667953491211
mini_batch_src_global generation:  0.015636920928955078
r_  generation:  0.1338961124420166
local_output_nid generation:  0.009707450866699219
local_in_edges_tensor generation:  0.010541439056396484
mini_batch_src_global generation:  0.019960403442382812
r_  generation:  0.14348411560058594
local_output_nid generation:  0.009259462356567383
local_in_edges_tensor generation:  0.008751630783081055
mini_batch_src_global generation:  0.016064167022705078
r_  generation:  0.13381004333496094
local_output_nid generation:  0.009432077407836914
local_in_edges_tensor generation:  0.010030508041381836
mini_batch_src_global generation:  0.01632523536682129
r_  generation:  0.1364283561706543
local_output_nid generation:  0.009404897689819336
local_in_edges_tensor generation:  0.010172843933105469
mini_batch_src_global generation:  0.017987966537475586
r_  generation:  0.14269638061523438
local_output_nid generation:  0.009778499603271484
local_in_edges_tensor generation:  0.009401559829711914
mini_batch_src_global generation:  0.021722078323364258
r_  generation:  0.14836359024047852
local_output_nid generation:  0.009706974029541016
local_in_edges_tensor generation:  0.010385274887084961
mini_batch_src_global generation:  0.016907215118408203
r_  generation:  0.1409893035888672
local_output_nid generation:  0.010233640670776367
local_in_edges_tensor generation:  0.015980958938598633
mini_batch_src_global generation:  0.019955873489379883
r_  generation:  0.14562153816223145
local_output_nid generation:  0.009945869445800781
local_in_edges_tensor generation:  0.010969877243041992
mini_batch_src_global generation:  0.017642736434936523
r_  generation:  0.14634466171264648
local_output_nid generation:  0.009127616882324219
local_in_edges_tensor generation:  0.00829625129699707
mini_batch_src_global generation:  0.01698589324951172
r_  generation:  0.139115571975708
local_output_nid generation:  0.008836746215820312
local_in_edges_tensor generation:  0.008099794387817383
mini_batch_src_global generation:  0.01638317108154297
r_  generation:  0.13802003860473633
local_output_nid generation:  0.008907079696655273
local_in_edges_tensor generation:  0.008869171142578125
mini_batch_src_global generation:  0.016169309616088867
r_  generation:  0.1377711296081543
local_output_nid generation:  0.00896143913269043
local_in_edges_tensor generation:  0.010624408721923828
mini_batch_src_global generation:  0.016497135162353516
r_  generation:  0.1383655071258545
local_output_nid generation:  0.008965253829956055
local_in_edges_tensor generation:  0.010453939437866211
mini_batch_src_global generation:  0.016703128814697266
r_  generation:  0.14040660858154297
local_output_nid generation:  0.008784294128417969
local_in_edges_tensor generation:  0.009307146072387695
mini_batch_src_global generation:  0.016832351684570312
r_  generation:  0.13970470428466797
local_output_nid generation:  0.008905172348022461
local_in_edges_tensor generation:  0.009302377700805664
mini_batch_src_global generation:  0.01659870147705078
r_  generation:  0.13851356506347656
local_output_nid generation:  0.008800029754638672
local_in_edges_tensor generation:  0.009324312210083008
mini_batch_src_global generation:  0.017543554306030273
r_  generation:  0.14162802696228027
local_output_nid generation:  0.009018182754516602
local_in_edges_tensor generation:  0.008308887481689453
mini_batch_src_global generation:  0.01659679412841797
r_  generation:  0.14080071449279785
local_output_nid generation:  0.008798837661743164
local_in_edges_tensor generation:  0.00848698616027832
mini_batch_src_global generation:  0.016649246215820312
r_  generation:  0.13756966590881348
----------------------check_connections_block total spend ----------------------------- 6.8442816734313965
generate_one_block  0.182936429977417
generate_one_block  0.16765236854553223
generate_one_block  0.1792435646057129
generate_one_block  0.17577767372131348
generate_one_block  0.19544720649719238
generate_one_block  0.17265844345092773
generate_one_block  0.17121672630310059
generate_one_block  0.17285847663879395
generate_one_block  0.17226839065551758
generate_one_block  0.17877459526062012
generate_one_block  0.18090486526489258
generate_one_block  0.17265915870666504
generate_one_block  0.1628272533416748
generate_one_block  0.16589784622192383
generate_one_block  0.18866610527038574
generate_one_block  0.16399765014648438
generate_one_block  0.16970324516296387
generate_one_block  0.1798844337463379
generate_one_block  0.19980645179748535
generate_one_block  0.20728564262390137
generate_one_block  0.17810583114624023
generate_one_block  0.18065333366394043
generate_one_block  0.17925620079040527
generate_one_block  0.17511391639709473
generate_one_block  0.17243218421936035
generate_one_block  0.17444634437561035
generate_one_block  0.18972039222717285
generate_one_block  0.18408894538879395
generate_one_block  0.18345355987548828
generate_one_block  0.18371272087097168
generate_one_block  0.18017053604125977
generate_one_block  0.1718769073486328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.09939026832580566
gen group dst list time:  0.1083676815032959
time for parepare:  0.018207788467407227
local_output_nid generation:  0.023914575576782227
local_in_edges_tensor generation:  0.05120730400085449
mini_batch_src_global generation:  0.04102611541748047
r_  generation:  0.38919901847839355
local_output_nid generation:  0.028586387634277344
local_in_edges_tensor generation:  0.04001283645629883
mini_batch_src_global generation:  0.047730207443237305
r_  generation:  0.3936755657196045
local_output_nid generation:  0.028659582138061523
local_in_edges_tensor generation:  0.03388357162475586
mini_batch_src_global generation:  0.047714948654174805
r_  generation:  0.40041184425354004
local_output_nid generation:  0.027121543884277344
local_in_edges_tensor generation:  0.030572891235351562
mini_batch_src_global generation:  0.04937481880187988
r_  generation:  0.4080328941345215
local_output_nid generation:  0.027540206909179688
local_in_edges_tensor generation:  0.027053356170654297
mini_batch_src_global generation:  0.05255913734436035
r_  generation:  0.42247724533081055
local_output_nid generation:  0.026917695999145508
local_in_edges_tensor generation:  0.02957940101623535
mini_batch_src_global generation:  0.04970240592956543
r_  generation:  0.4065592288970947
local_output_nid generation:  0.02703118324279785
local_in_edges_tensor generation:  0.03353524208068848
mini_batch_src_global generation:  0.04693198204040527
r_  generation:  0.4085509777069092
local_output_nid generation:  0.02694392204284668
local_in_edges_tensor generation:  0.029577970504760742
mini_batch_src_global generation:  0.047414541244506836
r_  generation:  0.40326714515686035
local_output_nid generation:  0.02695488929748535
local_in_edges_tensor generation:  0.030149221420288086
mini_batch_src_global generation:  0.04982161521911621
r_  generation:  0.4074692726135254
local_output_nid generation:  0.02724170684814453
local_in_edges_tensor generation:  0.030216455459594727
mini_batch_src_global generation:  0.0474240779876709
r_  generation:  0.4082450866699219
local_output_nid generation:  0.02820110321044922
local_in_edges_tensor generation:  0.04465484619140625
mini_batch_src_global generation:  0.04781317710876465
r_  generation:  0.4174306392669678
local_output_nid generation:  0.028087139129638672
local_in_edges_tensor generation:  0.03313016891479492
mini_batch_src_global generation:  0.05100536346435547
r_  generation:  0.4179399013519287
local_output_nid generation:  0.02924799919128418
local_in_edges_tensor generation:  0.03139472007751465
mini_batch_src_global generation:  0.05053257942199707
r_  generation:  0.39461255073547363
local_output_nid generation:  0.027358531951904297
local_in_edges_tensor generation:  0.030948400497436523
mini_batch_src_global generation:  0.049727439880371094
r_  generation:  0.4004824161529541
local_output_nid generation:  0.027777671813964844
local_in_edges_tensor generation:  0.034214019775390625
mini_batch_src_global generation:  0.046885013580322266
r_  generation:  0.4084615707397461
local_output_nid generation:  0.027234554290771484
local_in_edges_tensor generation:  0.02620983123779297
mini_batch_src_global generation:  0.04805564880371094
r_  generation:  0.3968644142150879
local_output_nid generation:  0.027630329132080078
local_in_edges_tensor generation:  0.03044748306274414
mini_batch_src_global generation:  0.04699826240539551
r_  generation:  0.40376996994018555
local_output_nid generation:  0.027922868728637695
local_in_edges_tensor generation:  0.0341792106628418
mini_batch_src_global generation:  0.04773235321044922
r_  generation:  0.4060089588165283
local_output_nid generation:  0.028107881546020508
local_in_edges_tensor generation:  0.030478477478027344
mini_batch_src_global generation:  0.05040788650512695
r_  generation:  0.4089391231536865
local_output_nid generation:  0.028215646743774414
local_in_edges_tensor generation:  0.02708745002746582
mini_batch_src_global generation:  0.04782247543334961
r_  generation:  0.40312838554382324
local_output_nid generation:  0.028250932693481445
local_in_edges_tensor generation:  0.02723526954650879
mini_batch_src_global generation:  0.05239057540893555
r_  generation:  0.41257238388061523
local_output_nid generation:  0.027985334396362305
local_in_edges_tensor generation:  0.03772330284118652
mini_batch_src_global generation:  0.04726982116699219
r_  generation:  0.40730929374694824
local_output_nid generation:  0.030125141143798828
local_in_edges_tensor generation:  0.03104567527770996
mini_batch_src_global generation:  0.050600290298461914
r_  generation:  0.40817809104919434
local_output_nid generation:  0.027791738510131836
local_in_edges_tensor generation:  0.02665543556213379
mini_batch_src_global generation:  0.04719662666320801
r_  generation:  0.40384578704833984
local_output_nid generation:  0.028103113174438477
local_in_edges_tensor generation:  0.03734874725341797
mini_batch_src_global generation:  0.047586679458618164
r_  generation:  0.40321898460388184
local_output_nid generation:  0.028000354766845703
local_in_edges_tensor generation:  0.03192853927612305
mini_batch_src_global generation:  0.04780316352844238
r_  generation:  0.4041016101837158
local_output_nid generation:  0.02794361114501953
local_in_edges_tensor generation:  0.02463555335998535
mini_batch_src_global generation:  0.04691052436828613
r_  generation:  0.40146780014038086
local_output_nid generation:  0.02789306640625
local_in_edges_tensor generation:  0.030896425247192383
mini_batch_src_global generation:  0.04743838310241699
r_  generation:  0.4011342525482178
local_output_nid generation:  0.028008699417114258
local_in_edges_tensor generation:  0.03194284439086914
mini_batch_src_global generation:  0.04705619812011719
r_  generation:  0.41361498832702637
local_output_nid generation:  0.029218673706054688
local_in_edges_tensor generation:  0.036275386810302734
mini_batch_src_global generation:  0.050603389739990234
r_  generation:  0.40679168701171875
local_output_nid generation:  0.032103776931762695
local_in_edges_tensor generation:  0.030385732650756836
mini_batch_src_global generation:  0.05910682678222656
r_  generation:  0.4108736515045166
local_output_nid generation:  0.02792644500732422
local_in_edges_tensor generation:  0.02576589584350586
mini_batch_src_global generation:  0.047102928161621094
r_  generation:  0.40230226516723633
----------------------check_connections_block total spend ----------------------------- 19.308818340301514
generate_one_block  0.5419809818267822
generate_one_block  0.5262975692749023
generate_one_block  0.5319876670837402
generate_one_block  0.5360233783721924
generate_one_block  0.6435778141021729
generate_one_block  0.5253357887268066
generate_one_block  0.5330781936645508
generate_one_block  0.5329372882843018
generate_one_block  0.5302169322967529
generate_one_block  0.5541386604309082
generate_one_block  0.5476925373077393
generate_one_block  0.5360219478607178
generate_one_block  0.5197374820709229
generate_one_block  0.5179274082183838
generate_one_block  0.5337212085723877
generate_one_block  0.5146768093109131
generate_one_block  0.5375707149505615
generate_one_block  0.5402624607086182
generate_one_block  0.5490837097167969
generate_one_block  0.526010274887085
generate_one_block  0.5297274589538574
generate_one_block  0.5425925254821777
generate_one_block  0.546328067779541
generate_one_block  0.5230422019958496
generate_one_block  0.5390849113464355
generate_one_block  0.5298464298248291
generate_one_block  0.527763843536377
generate_one_block  0.5377378463745117
generate_one_block  0.5483541488647461
generate_one_block  0.5403175354003906
generate_one_block  0.5439331531524658
generate_one_block  0.5189027786254883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.11951541900634766  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

connection checking time:  26.15310001373291
block generation total time  22.91940712928772
average batch blocks generation time:  0.7162314727902412
block dataloader generation time/epoch 51.852192878723145
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10292243957519531  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145363, 128])
torch.Size([99083, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.573002815246582  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10273408889770508  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145163, 128])
torch.Size([98373, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.453831195831299  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10288572311401367  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145003, 128])
torch.Size([99246, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.829060554504395  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10292434692382812  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145172, 128])
torch.Size([99448, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.749105453491211  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10505533218383789  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145873, 128])
torch.Size([100138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 16.048327922821045  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.1029667854309082  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145323, 128])
torch.Size([98921, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.692941665649414  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.1028299331665039  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145104, 128])
torch.Size([98789, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.65198564529419  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10274028778076172  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145008, 128])
torch.Size([98486, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.567398071289062  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10390281677246094  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145408, 128])
torch.Size([98671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.571607112884521  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10404396057128906  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145392, 128])
torch.Size([99286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 15.877637386322021  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1307373046875 GB
    Memory Allocated: 0.10503673553466797  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145879, 128])
torch.Size([100577, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.990759372711182  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10412406921386719  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145636, 128])
torch.Size([99710, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.731404304504395  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.1024637222290039  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145112, 128])
torch.Size([97402, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.08970832824707  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10251665115356445  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([144951, 128])
torch.Size([97896, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.297250270843506  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10406732559204102  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145379, 128])
torch.Size([99601, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.996511936187744  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10255622863769531  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145194, 128])
torch.Size([97115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.146379947662354  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10284805297851562  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145166, 128])
torch.Size([98870, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.614278316497803  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10430622100830078  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145989, 128])
torch.Size([100304, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.839659214019775  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10505104064941406  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145436, 128])
torch.Size([100331, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 16.048691749572754  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10312652587890625  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145642, 128])
torch.Size([99483, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.729064464569092  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.1039423942565918  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145191, 128])
torch.Size([99597, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.860644340515137  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10389518737792969  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145043, 128])
torch.Size([99256, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.944037914276123  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10502815246582031  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145864, 128])
torch.Size([100539, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.969478607177734  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10290813446044922  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145422, 128])
torch.Size([99072, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.553919792175293  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.1026611328125  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([144774, 128])
torch.Size([98438, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.657706260681152  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.1030421257019043  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145475, 128])
torch.Size([99069, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.709043502807617  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.102996826171875  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145334, 128])
torch.Size([99130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.760368824005127  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10259056091308594  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([144666, 128])
torch.Size([97906, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.586232662200928  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10501432418823242  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145655, 128])
torch.Size([99657, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.85834264755249  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10406351089477539  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145457, 128])
torch.Size([99031, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.810505390167236  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10502433776855469  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145814, 128])
torch.Size([99813, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.897459030151367  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 0.10282611846923828  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

torch.Size([145332, 128])
torch.Size([98380, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7342529296875 GB
    Memory Allocated: 15.521634101867676  GigaBytes
Max Memory Allocated: 16.148383617401123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021647289395332336 |0.011218629777431488 |0.270145058631897 |9.232759475708008e-05 |0.44915080070495605 |0.006184816360473633 |
----------------------------------------------------------pseudo_mini_loss sum 3.8418619632720947
Total (block generation + training)time/epoch 75.97688031196594
Training time/epoch 24.124416828155518
Training time without block to device /epoch 23.76542067527771
Training time without total dataloading part /epoch 23.026606798171997
load block tensor time/epoch 0.6927132606506348
block to device time/epoch 0.3589961528778076
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8574464
Number of first layer input nodes during this epoch:  4651220
