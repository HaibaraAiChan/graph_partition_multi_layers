Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648521341.818966
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0007319450378417969  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024496793746948242
random selection method range initialization spend 0.00573420524597168
time for parepare:  0.01890707015991211
local_output_nid generation:  0.002342700958251953
local_in_edges_tensor generation:  0.004684925079345703
mini_batch_src_global generation:  0.0018210411071777344
r_  generation:  0.018790721893310547
local_output_nid generation:  0.003021240234375
local_in_edges_tensor generation:  0.0016634464263916016
mini_batch_src_global generation:  0.0022687911987304688
r_  generation:  0.019147157669067383
local_output_nid generation:  0.0031387805938720703
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0014541149139404297
r_  generation:  0.018251419067382812
local_output_nid generation:  0.0031349658966064453
local_in_edges_tensor generation:  0.00154876708984375
mini_batch_src_global generation:  0.0014743804931640625
r_  generation:  0.01898479461669922
local_output_nid generation:  0.003091573715209961
local_in_edges_tensor generation:  0.0015759468078613281
mini_batch_src_global generation:  0.0014278888702392578
r_  generation:  0.01879572868347168
local_output_nid generation:  0.003050088882446289
local_in_edges_tensor generation:  0.0015132427215576172
mini_batch_src_global generation:  0.0014336109161376953
r_  generation:  0.019287109375
local_output_nid generation:  0.003045797348022461
local_in_edges_tensor generation:  0.0014777183532714844
mini_batch_src_global generation:  0.0014443397521972656
r_  generation:  0.019423723220825195
local_output_nid generation:  0.0030345916748046875
local_in_edges_tensor generation:  0.0015299320220947266
mini_batch_src_global generation:  0.0015015602111816406
r_  generation:  0.01967453956604004
local_output_nid generation:  0.0030286312103271484
local_in_edges_tensor generation:  0.001495361328125
mini_batch_src_global generation:  0.0015075206756591797
r_  generation:  0.019614458084106445
local_output_nid generation:  0.003050088882446289
local_in_edges_tensor generation:  0.0015158653259277344
mini_batch_src_global generation:  0.0015249252319335938
r_  generation:  0.019634485244750977
local_output_nid generation:  0.0030443668365478516
local_in_edges_tensor generation:  0.0014948844909667969
mini_batch_src_global generation:  0.001600503921508789
r_  generation:  0.01977705955505371
local_output_nid generation:  0.0030579566955566406
local_in_edges_tensor generation:  0.0015387535095214844
mini_batch_src_global generation:  0.0015645027160644531
r_  generation:  0.019609451293945312
local_output_nid generation:  0.0030379295349121094
local_in_edges_tensor generation:  0.001508951187133789
mini_batch_src_global generation:  0.0016112327575683594
r_  generation:  0.02014899253845215
local_output_nid generation:  0.003064393997192383
local_in_edges_tensor generation:  0.0015637874603271484
mini_batch_src_global generation:  0.0015380382537841797
r_  generation:  0.019665956497192383
local_output_nid generation:  0.0031228065490722656
local_in_edges_tensor generation:  0.0015094280242919922
mini_batch_src_global generation:  0.0015590190887451172
r_  generation:  0.01972174644470215
local_output_nid generation:  0.003141641616821289
local_in_edges_tensor generation:  0.0014650821685791016
mini_batch_src_global generation:  0.0015251636505126953
r_  generation:  0.01982569694519043
----------------------check_connections_block total spend ----------------------------- 0.5097324848175049
generate_one_block  0.02719426155090332
generate_one_block  0.029035568237304688
generate_one_block  0.02743244171142578
generate_one_block  0.03082752227783203
generate_one_block  0.027989864349365234
generate_one_block  0.02751326560974121
generate_one_block  0.027719736099243164
generate_one_block  0.02848339080810547
generate_one_block  0.027879714965820312
generate_one_block  0.02782583236694336
generate_one_block  0.027559518814086914
generate_one_block  0.027356624603271484
generate_one_block  0.027750492095947266
generate_one_block  0.02795243263244629
generate_one_block  0.02800607681274414
generate_one_block  0.027377843856811523
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03909015655517578
gen group dst list time:  0.019405841827392578
time for parepare:  0.019391775131225586
local_output_nid generation:  0.008425712585449219
local_in_edges_tensor generation:  0.016992807388305664
mini_batch_src_global generation:  0.01978898048400879
r_  generation:  0.1983778476715088
local_output_nid generation:  0.01324915885925293
local_in_edges_tensor generation:  0.020551681518554688
mini_batch_src_global generation:  0.025364160537719727
r_  generation:  0.21815156936645508
local_output_nid generation:  0.016491174697875977
local_in_edges_tensor generation:  0.012731552124023438
mini_batch_src_global generation:  0.02405571937561035
r_  generation:  0.21475672721862793
local_output_nid generation:  0.013129234313964844
local_in_edges_tensor generation:  0.020082473754882812
mini_batch_src_global generation:  0.027334213256835938
r_  generation:  0.22959637641906738
local_output_nid generation:  0.016221046447753906
local_in_edges_tensor generation:  0.014870643615722656
mini_batch_src_global generation:  0.026332378387451172
r_  generation:  0.22363972663879395
local_output_nid generation:  0.01792454719543457
local_in_edges_tensor generation:  0.017579317092895508
mini_batch_src_global generation:  0.029289960861206055
r_  generation:  0.23416900634765625
local_output_nid generation:  0.014176130294799805
local_in_edges_tensor generation:  0.022655963897705078
mini_batch_src_global generation:  0.0301816463470459
r_  generation:  0.2183971405029297
local_output_nid generation:  0.01257467269897461
local_in_edges_tensor generation:  0.01677870750427246
mini_batch_src_global generation:  0.02718067169189453
r_  generation:  0.22127318382263184
local_output_nid generation:  0.01231837272644043
local_in_edges_tensor generation:  0.015669822692871094
mini_batch_src_global generation:  0.026880741119384766
r_  generation:  0.21862220764160156
local_output_nid generation:  0.012216567993164062
local_in_edges_tensor generation:  0.013750791549682617
mini_batch_src_global generation:  0.02756977081298828
r_  generation:  0.21965456008911133
local_output_nid generation:  0.012293338775634766
local_in_edges_tensor generation:  0.01756143569946289
mini_batch_src_global generation:  0.028973817825317383
r_  generation:  0.22075462341308594
local_output_nid generation:  0.012160062789916992
local_in_edges_tensor generation:  0.012041807174682617
mini_batch_src_global generation:  0.02772808074951172
r_  generation:  0.2162327766418457
local_output_nid generation:  0.012262344360351562
local_in_edges_tensor generation:  0.011973142623901367
mini_batch_src_global generation:  0.033995628356933594
r_  generation:  0.2197432518005371
local_output_nid generation:  0.012123584747314453
local_in_edges_tensor generation:  0.013979196548461914
mini_batch_src_global generation:  0.027506351470947266
r_  generation:  0.21909856796264648
local_output_nid generation:  0.012190580368041992
local_in_edges_tensor generation:  0.017521142959594727
mini_batch_src_global generation:  0.027855873107910156
r_  generation:  0.22301626205444336
local_output_nid generation:  0.012154102325439453
local_in_edges_tensor generation:  0.012056827545166016
mini_batch_src_global generation:  0.027139663696289062
r_  generation:  0.21831059455871582
----------------------check_connections_block total spend ----------------------------- 5.200924873352051
generate_one_block  0.28163957595825195
generate_one_block  0.28054022789001465
generate_one_block  0.27496910095214844
generate_one_block  0.2926161289215088
generate_one_block  0.2993013858795166
generate_one_block  0.27709245681762695
generate_one_block  0.27796316146850586
generate_one_block  0.2837061882019043
generate_one_block  0.2764420509338379
generate_one_block  0.28083181381225586
generate_one_block  0.2823669910430908
generate_one_block  0.2722306251525879
generate_one_block  0.27889394760131836
generate_one_block  0.28313565254211426
generate_one_block  0.3024296760559082
generate_one_block  0.27806997299194336
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.06049633026123047
gen group dst list time:  0.06481671333312988
time for parepare:  0.01919865608215332
local_output_nid generation:  0.026636838912963867
local_in_edges_tensor generation:  0.06873130798339844
mini_batch_src_global generation:  0.04873299598693848
r_  generation:  0.5202019214630127
local_output_nid generation:  0.03550291061401367
local_in_edges_tensor generation:  0.052443742752075195
mini_batch_src_global generation:  0.05932331085205078
r_  generation:  0.5027163028717041
local_output_nid generation:  0.034053802490234375
local_in_edges_tensor generation:  0.038182973861694336
mini_batch_src_global generation:  0.05778956413269043
r_  generation:  0.5130844116210938
local_output_nid generation:  0.03237724304199219
local_in_edges_tensor generation:  0.035762786865234375
mini_batch_src_global generation:  0.059870004653930664
r_  generation:  0.5093410015106201
local_output_nid generation:  0.03256487846374512
local_in_edges_tensor generation:  0.03965640068054199
mini_batch_src_global generation:  0.06099724769592285
r_  generation:  0.5334131717681885
local_output_nid generation:  0.03545379638671875
local_in_edges_tensor generation:  0.04640960693359375
mini_batch_src_global generation:  0.06361818313598633
r_  generation:  0.5018537044525146
local_output_nid generation:  0.03209114074707031
local_in_edges_tensor generation:  0.03610968589782715
mini_batch_src_global generation:  0.0590357780456543
r_  generation:  0.5058398246765137
local_output_nid generation:  0.03277468681335449
local_in_edges_tensor generation:  0.04044604301452637
mini_batch_src_global generation:  0.06012296676635742
r_  generation:  0.5166146755218506
local_output_nid generation:  0.03229117393493652
local_in_edges_tensor generation:  0.03604006767272949
mini_batch_src_global generation:  0.05981850624084473
r_  generation:  0.513009786605835
local_output_nid generation:  0.031970977783203125
local_in_edges_tensor generation:  0.03126120567321777
mini_batch_src_global generation:  0.06160306930541992
r_  generation:  0.5074360370635986
local_output_nid generation:  0.03212380409240723
local_in_edges_tensor generation:  0.041024208068847656
mini_batch_src_global generation:  0.05936241149902344
r_  generation:  0.5125851631164551
local_output_nid generation:  0.032254934310913086
local_in_edges_tensor generation:  0.04312610626220703
mini_batch_src_global generation:  0.059311866760253906
r_  generation:  0.5047390460968018
local_output_nid generation:  0.033220529556274414
local_in_edges_tensor generation:  0.03840208053588867
mini_batch_src_global generation:  0.06214118003845215
r_  generation:  0.5263941287994385
local_output_nid generation:  0.03249311447143555
local_in_edges_tensor generation:  0.04226231575012207
mini_batch_src_global generation:  0.0664680004119873
r_  generation:  0.5065920352935791
local_output_nid generation:  0.03473782539367676
local_in_edges_tensor generation:  0.042913198471069336
mini_batch_src_global generation:  0.0635671615600586
r_  generation:  0.5139882564544678
local_output_nid generation:  0.03248286247253418
local_in_edges_tensor generation:  0.03503775596618652
mini_batch_src_global generation:  0.060608625411987305
r_  generation:  0.506317138671875
----------------------check_connections_block total spend ----------------------------- 12.108014345169067
generate_one_block  0.6554930210113525
generate_one_block  0.6480064392089844
generate_one_block  0.6483151912689209
generate_one_block  0.6481802463531494
generate_one_block  0.6549053192138672
generate_one_block  0.638573169708252
generate_one_block  0.7230191230773926
generate_one_block  0.6466560363769531
generate_one_block  0.6523451805114746
generate_one_block  0.6463909149169922
generate_one_block  0.6551353931427002
generate_one_block  0.6387295722961426
generate_one_block  0.6504480838775635
generate_one_block  0.6456203460693359
generate_one_block  0.6465287208557129
generate_one_block  0.6557822227478027
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04774975776672363
gen group dst list time:  0.09302806854248047
time for parepare:  0.020105838775634766
local_output_nid generation:  0.03438830375671387
local_in_edges_tensor generation:  0.06276130676269531
mini_batch_src_global generation:  0.0549166202545166
r_  generation:  0.5372731685638428
local_output_nid generation:  0.03950786590576172
local_in_edges_tensor generation:  0.05688977241516113
mini_batch_src_global generation:  0.06355738639831543
r_  generation:  0.5467195510864258
local_output_nid generation:  0.038765907287597656
local_in_edges_tensor generation:  0.04520821571350098
mini_batch_src_global generation:  0.06097698211669922
r_  generation:  0.5476949214935303
local_output_nid generation:  0.03843951225280762
local_in_edges_tensor generation:  0.052274227142333984
mini_batch_src_global generation:  0.0604097843170166
r_  generation:  0.5522310733795166
local_output_nid generation:  0.03869438171386719
local_in_edges_tensor generation:  0.04225611686706543
mini_batch_src_global generation:  0.05969810485839844
r_  generation:  0.5548722743988037
local_output_nid generation:  0.03839683532714844
local_in_edges_tensor generation:  0.04131579399108887
mini_batch_src_global generation:  0.06153154373168945
r_  generation:  0.5700674057006836
local_output_nid generation:  0.03855085372924805
local_in_edges_tensor generation:  0.04737496376037598
mini_batch_src_global generation:  0.06876444816589355
r_  generation:  0.5659329891204834
local_output_nid generation:  0.03857707977294922
local_in_edges_tensor generation:  0.048818349838256836
mini_batch_src_global generation:  0.06202554702758789
r_  generation:  0.5800294876098633
local_output_nid generation:  0.04037904739379883
local_in_edges_tensor generation:  0.04688096046447754
mini_batch_src_global generation:  0.061493873596191406
r_  generation:  0.567218542098999
local_output_nid generation:  0.03988242149353027
local_in_edges_tensor generation:  0.038228511810302734
mini_batch_src_global generation:  0.0671842098236084
r_  generation:  0.5690364837646484
local_output_nid generation:  0.04030776023864746
local_in_edges_tensor generation:  0.04199934005737305
mini_batch_src_global generation:  0.06319999694824219
r_  generation:  0.5689010620117188
local_output_nid generation:  0.04086446762084961
local_in_edges_tensor generation:  0.048851966857910156
mini_batch_src_global generation:  0.06287956237792969
r_  generation:  0.5674331188201904
local_output_nid generation:  0.039433956146240234
local_in_edges_tensor generation:  0.03759026527404785
mini_batch_src_global generation:  0.06252813339233398
r_  generation:  0.5681149959564209
local_output_nid generation:  0.039750099182128906
local_in_edges_tensor generation:  0.03735470771789551
mini_batch_src_global generation:  0.06319141387939453
r_  generation:  0.5655968189239502
local_output_nid generation:  0.03938746452331543
local_in_edges_tensor generation:  0.04724240303039551
mini_batch_src_global generation:  0.06236577033996582
r_  generation:  0.5718495845794678
local_output_nid generation:  0.03930020332336426
local_in_edges_tensor generation:  0.03733348846435547
mini_batch_src_global generation:  0.06337451934814453
r_  generation:  0.5657389163970947
----------------------check_connections_block total spend ----------------------------- 13.48915982246399
generate_one_block  0.7019946575164795
generate_one_block  0.69997239112854
generate_one_block  0.6997790336608887
generate_one_block  0.780634880065918
generate_one_block  0.7064526081085205
generate_one_block  0.7042579650878906
generate_one_block  0.6866860389709473
generate_one_block  0.7117264270782471
generate_one_block  0.6996736526489258
generate_one_block  0.6955552101135254
generate_one_block  0.7093520164489746
generate_one_block  0.6875884532928467
generate_one_block  0.6864862442016602
generate_one_block  0.6891024112701416
generate_one_block  0.707711935043335
generate_one_block  0.6923174858093262
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04398512840270996
gen group dst list time:  0.10126590728759766
time for parepare:  0.01953125
local_output_nid generation:  0.03705406188964844
local_in_edges_tensor generation:  0.055773019790649414
mini_batch_src_global generation:  0.049988746643066406
r_  generation:  0.5356979370117188
local_output_nid generation:  0.04214978218078613
local_in_edges_tensor generation:  0.04717087745666504
mini_batch_src_global generation:  0.06560659408569336
r_  generation:  0.5552327632904053
local_output_nid generation:  0.04132413864135742
local_in_edges_tensor generation:  0.04351615905761719
mini_batch_src_global generation:  0.06533432006835938
r_  generation:  0.5463433265686035
local_output_nid generation:  0.04202723503112793
local_in_edges_tensor generation:  0.04387545585632324
mini_batch_src_global generation:  0.06268048286437988
r_  generation:  0.54555344581604
local_output_nid generation:  0.04153084754943848
local_in_edges_tensor generation:  0.04163622856140137
mini_batch_src_global generation:  0.06251931190490723
r_  generation:  0.5467789173126221
local_output_nid generation:  0.04148221015930176
local_in_edges_tensor generation:  0.04212474822998047
mini_batch_src_global generation:  0.06164383888244629
r_  generation:  0.5506076812744141
local_output_nid generation:  0.04139423370361328
local_in_edges_tensor generation:  0.04096102714538574
mini_batch_src_global generation:  0.061858415603637695
r_  generation:  0.5487985610961914
local_output_nid generation:  0.04177069664001465
local_in_edges_tensor generation:  0.046799659729003906
mini_batch_src_global generation:  0.06212139129638672
r_  generation:  0.5479919910430908
local_output_nid generation:  0.04146242141723633
local_in_edges_tensor generation:  0.0387117862701416
mini_batch_src_global generation:  0.06184887886047363
r_  generation:  0.5702178478240967
local_output_nid generation:  0.04136991500854492
local_in_edges_tensor generation:  0.04167652130126953
mini_batch_src_global generation:  0.06258201599121094
r_  generation:  0.552952766418457
local_output_nid generation:  0.0411829948425293
local_in_edges_tensor generation:  0.046346426010131836
mini_batch_src_global generation:  0.06179952621459961
r_  generation:  0.55312180519104
local_output_nid generation:  0.042237281799316406
local_in_edges_tensor generation:  0.04161262512207031
mini_batch_src_global generation:  0.0633842945098877
r_  generation:  0.5629334449768066
local_output_nid generation:  0.041716814041137695
local_in_edges_tensor generation:  0.04078793525695801
mini_batch_src_global generation:  0.06335043907165527
r_  generation:  0.5595624446868896
local_output_nid generation:  0.04148054122924805
local_in_edges_tensor generation:  0.047469377517700195
mini_batch_src_global generation:  0.06217312812805176
r_  generation:  0.565915584564209
local_output_nid generation:  0.04175066947937012
local_in_edges_tensor generation:  0.041623830795288086
mini_batch_src_global generation:  0.0665438175201416
r_  generation:  0.561246395111084
local_output_nid generation:  0.04173684120178223
local_in_edges_tensor generation:  0.04148745536804199
mini_batch_src_global generation:  0.06337809562683105
r_  generation:  0.5616340637207031
----------------------check_connections_block total spend ----------------------------- 13.330851316452026
generate_one_block  0.7122781276702881
generate_one_block  0.6995346546173096
generate_one_block  0.6897642612457275
generate_one_block  0.6974568367004395
generate_one_block  0.6785926818847656
generate_one_block  0.6857266426086426
generate_one_block  0.7343757152557373
generate_one_block  0.7054026126861572
generate_one_block  0.7045321464538574
generate_one_block  0.6783480644226074
generate_one_block  0.690781831741333
generate_one_block  0.7009224891662598
generate_one_block  0.6799497604370117
generate_one_block  0.6812193393707275
generate_one_block  0.7039361000061035
generate_one_block  0.6903233528137207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03886151313781738
gen group dst list time:  0.09887981414794922
time for parepare:  0.01944112777709961
local_output_nid generation:  0.03850841522216797
local_in_edges_tensor generation:  0.05277204513549805
mini_batch_src_global generation:  0.04609990119934082
r_  generation:  0.5046525001525879
local_output_nid generation:  0.044841766357421875
local_in_edges_tensor generation:  0.041608572006225586
mini_batch_src_global generation:  0.05885195732116699
r_  generation:  0.5114181041717529
local_output_nid generation:  0.04233145713806152
local_in_edges_tensor generation:  0.037392377853393555
mini_batch_src_global generation:  0.058450937271118164
r_  generation:  0.510352373123169
local_output_nid generation:  0.04119443893432617
local_in_edges_tensor generation:  0.047556161880493164
mini_batch_src_global generation:  0.05771994590759277
r_  generation:  0.5099573135375977
local_output_nid generation:  0.041272878646850586
local_in_edges_tensor generation:  0.03965020179748535
mini_batch_src_global generation:  0.05817008018493652
r_  generation:  0.5093975067138672
local_output_nid generation:  0.04169726371765137
local_in_edges_tensor generation:  0.04121518135070801
mini_batch_src_global generation:  0.061847686767578125
r_  generation:  0.5104060173034668
local_output_nid generation:  0.04221940040588379
local_in_edges_tensor generation:  0.04140615463256836
mini_batch_src_global generation:  0.05814409255981445
r_  generation:  0.5077657699584961
local_output_nid generation:  0.04163002967834473
local_in_edges_tensor generation:  0.04269886016845703
mini_batch_src_global generation:  0.058600425720214844
r_  generation:  0.5098059177398682
local_output_nid generation:  0.041431427001953125
local_in_edges_tensor generation:  0.046418190002441406
mini_batch_src_global generation:  0.06109929084777832
r_  generation:  0.5115060806274414
local_output_nid generation:  0.041312456130981445
local_in_edges_tensor generation:  0.03747916221618652
mini_batch_src_global generation:  0.05911970138549805
r_  generation:  0.5108213424682617
local_output_nid generation:  0.04149889945983887
local_in_edges_tensor generation:  0.0416259765625
mini_batch_src_global generation:  0.058533430099487305
r_  generation:  0.5124924182891846
local_output_nid generation:  0.04172348976135254
local_in_edges_tensor generation:  0.04159116744995117
mini_batch_src_global generation:  0.05933094024658203
r_  generation:  0.5158267021179199
local_output_nid generation:  0.04204726219177246
local_in_edges_tensor generation:  0.04900646209716797
mini_batch_src_global generation:  0.058945417404174805
r_  generation:  0.5178072452545166
local_output_nid generation:  0.041620492935180664
local_in_edges_tensor generation:  0.046302080154418945
mini_batch_src_global generation:  0.05804753303527832
r_  generation:  0.5173752307891846
local_output_nid generation:  0.041663408279418945
local_in_edges_tensor generation:  0.04812026023864746
mini_batch_src_global generation:  0.057982683181762695
r_  generation:  0.5175614356994629
local_output_nid generation:  0.04200339317321777
local_in_edges_tensor generation:  0.04642367362976074
mini_batch_src_global generation:  0.06427812576293945
r_  generation:  0.5379483699798584
----------------------check_connections_block total spend ----------------------------- 12.50211787223816
generate_one_block  0.6446554660797119
generate_one_block  0.6441283226013184
generate_one_block  0.64998459815979
generate_one_block  0.6455249786376953
generate_one_block  0.6344060897827148
generate_one_block  0.6453416347503662
generate_one_block  0.6427881717681885
generate_one_block  0.6557443141937256
generate_one_block  0.743220329284668
generate_one_block  0.6388115882873535
generate_one_block  0.6535513401031494
generate_one_block  0.6503169536590576
generate_one_block  0.7149953842163086
generate_one_block  0.6462240219116211
generate_one_block  0.6623094081878662
generate_one_block  0.6630504131317139
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007319450378417969  GigaBytes
Max Memory Allocated: 0.0007319450378417969  GigaBytes

connection checking time:  56.63106822967529
block generation total time  47.903846979141235
average batch blocks generation time:  2.993990436196327
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.1356639862060547  GigaBytes
Max Memory Allocated: 0.1356639862060547  GigaBytes

torch.Size([167311, 128])
torch.Size([166502, 32])
torch.Size([164062, 32])
torch.Size([155953, 32])
torch.Size([124174, 32])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 22.39 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
