Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648455899.69564
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027181625366210938
random selection method range initialization spend 0.005858898162841797
time for parepare:  0.018467187881469727
local_output_nid generation:  0.002145528793334961
local_in_edges_tensor generation:  0.0050351619720458984
mini_batch_src_global generation:  0.0018525123596191406
r_  generation:  0.019365549087524414
local_output_nid generation:  0.0026328563690185547
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.002302885055541992
r_  generation:  0.020273923873901367
local_output_nid generation:  0.003195047378540039
local_in_edges_tensor generation:  0.0018267631530761719
mini_batch_src_global generation:  0.0016870498657226562
r_  generation:  0.02230668067932129
local_output_nid generation:  0.003402233123779297
local_in_edges_tensor generation:  0.0018491744995117188
mini_batch_src_global generation:  0.0018455982208251953
r_  generation:  0.02366495132446289
local_output_nid generation:  0.003330230712890625
local_in_edges_tensor generation:  0.0018815994262695312
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.021982908248901367
local_output_nid generation:  0.003244161605834961
local_in_edges_tensor generation:  0.0017414093017578125
mini_batch_src_global generation:  0.0016522407531738281
r_  generation:  0.020730018615722656
local_output_nid generation:  0.0030786991119384766
local_in_edges_tensor generation:  0.0016460418701171875
mini_batch_src_global generation:  0.0016207695007324219
r_  generation:  0.020378828048706055
local_output_nid generation:  0.003031492233276367
local_in_edges_tensor generation:  0.0015189647674560547
mini_batch_src_global generation:  0.0016319751739501953
r_  generation:  0.0215303897857666
local_output_nid generation:  0.0029811859130859375
local_in_edges_tensor generation:  0.001552581787109375
mini_batch_src_global generation:  0.00164031982421875
r_  generation:  0.020626068115234375
local_output_nid generation:  0.0029752254486083984
local_in_edges_tensor generation:  0.0015609264373779297
mini_batch_src_global generation:  0.0017635822296142578
r_  generation:  0.022285938262939453
local_output_nid generation:  0.0030524730682373047
local_in_edges_tensor generation:  0.0015528202056884766
mini_batch_src_global generation:  0.0017349720001220703
r_  generation:  0.021045923233032227
local_output_nid generation:  0.002967357635498047
local_in_edges_tensor generation:  0.0015902519226074219
mini_batch_src_global generation:  0.0017588138580322266
r_  generation:  0.021685361862182617
local_output_nid generation:  0.002992868423461914
local_in_edges_tensor generation:  0.001491546630859375
mini_batch_src_global generation:  0.0017123222351074219
r_  generation:  0.02167510986328125
local_output_nid generation:  0.0030181407928466797
local_in_edges_tensor generation:  0.0015749931335449219
mini_batch_src_global generation:  0.0017466545104980469
r_  generation:  0.020947933197021484
local_output_nid generation:  0.003040790557861328
local_in_edges_tensor generation:  0.001546621322631836
mini_batch_src_global generation:  0.00168609619140625
r_  generation:  0.020937442779541016
local_output_nid generation:  0.002953052520751953
local_in_edges_tensor generation:  0.0015065670013427734
mini_batch_src_global generation:  0.0017812252044677734
r_  generation:  0.021996021270751953
----------------------check_connections_block total spend ----------------------------- 0.5520906448364258
generate_one_block  0.030864477157592773
generate_one_block  0.0318448543548584
generate_one_block  0.03464913368225098
generate_one_block  0.032442331314086914
generate_one_block  0.03162050247192383
generate_one_block  0.03059864044189453
generate_one_block  0.029846668243408203
generate_one_block  0.03134274482727051
generate_one_block  0.030327796936035156
generate_one_block  0.03208518028259277
generate_one_block  0.03068828582763672
generate_one_block  0.03066086769104004
generate_one_block  0.031030893325805664
generate_one_block  0.030136823654174805
generate_one_block  0.030043363571166992
generate_one_block  0.030614376068115234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04159379005432129
gen group dst list time:  0.020348548889160156
time for parepare:  0.019885778427124023
local_output_nid generation:  0.009213447570800781
local_in_edges_tensor generation:  0.022277116775512695
mini_batch_src_global generation:  0.02670001983642578
r_  generation:  0.24121880531311035
local_output_nid generation:  0.015642404556274414
local_in_edges_tensor generation:  0.02408456802368164
mini_batch_src_global generation:  0.03364372253417969
r_  generation:  0.26275157928466797
local_output_nid generation:  0.015555858612060547
local_in_edges_tensor generation:  0.019931793212890625
mini_batch_src_global generation:  0.031023025512695312
r_  generation:  0.27062034606933594
local_output_nid generation:  0.01588153839111328
local_in_edges_tensor generation:  0.023380756378173828
mini_batch_src_global generation:  0.034623146057128906
r_  generation:  0.2780337333679199
local_output_nid generation:  0.015758991241455078
local_in_edges_tensor generation:  0.01705336570739746
mini_batch_src_global generation:  0.03740668296813965
r_  generation:  0.2977476119995117
local_output_nid generation:  0.017284870147705078
local_in_edges_tensor generation:  0.035717010498046875
mini_batch_src_global generation:  0.03718972206115723
r_  generation:  0.2669649124145508
local_output_nid generation:  0.013255834579467773
local_in_edges_tensor generation:  0.01910543441772461
mini_batch_src_global generation:  0.03361320495605469
r_  generation:  0.27309513092041016
local_output_nid generation:  0.013765335083007812
local_in_edges_tensor generation:  0.021533489227294922
mini_batch_src_global generation:  0.03703188896179199
r_  generation:  0.2776315212249756
local_output_nid generation:  0.01346588134765625
local_in_edges_tensor generation:  0.014538764953613281
mini_batch_src_global generation:  0.03414297103881836
r_  generation:  0.27234745025634766
local_output_nid generation:  0.013704061508178711
local_in_edges_tensor generation:  0.016740798950195312
mini_batch_src_global generation:  0.03690958023071289
r_  generation:  0.27983546257019043
local_output_nid generation:  0.013613224029541016
local_in_edges_tensor generation:  0.018949270248413086
mini_batch_src_global generation:  0.0343472957611084
r_  generation:  0.2732064723968506
local_output_nid generation:  0.013338088989257812
local_in_edges_tensor generation:  0.014058113098144531
mini_batch_src_global generation:  0.03502297401428223
r_  generation:  0.26624512672424316
local_output_nid generation:  0.013552188873291016
local_in_edges_tensor generation:  0.01401972770690918
mini_batch_src_global generation:  0.035971641540527344
r_  generation:  0.27338218688964844
local_output_nid generation:  0.013404369354248047
local_in_edges_tensor generation:  0.013999223709106445
mini_batch_src_global generation:  0.034053802490234375
r_  generation:  0.2645905017852783
local_output_nid generation:  0.013312578201293945
local_in_edges_tensor generation:  0.01822662353515625
mini_batch_src_global generation:  0.03328657150268555
r_  generation:  0.2673029899597168
local_output_nid generation:  0.013396501541137695
local_in_edges_tensor generation:  0.021462202072143555
mini_batch_src_global generation:  0.034212589263916016
r_  generation:  0.2825496196746826
----------------------check_connections_block total spend ----------------------------- 6.391508340835571
generate_one_block  0.36243200302124023
generate_one_block  0.35393714904785156
generate_one_block  0.36051249504089355
generate_one_block  0.3690049648284912
generate_one_block  0.37540650367736816
generate_one_block  0.3484680652618408
generate_one_block  0.34482765197753906
generate_one_block  0.36960530281066895
generate_one_block  0.3479650020599365
generate_one_block  0.36801862716674805
generate_one_block  0.35914015769958496
generate_one_block  0.3638947010040283
generate_one_block  0.3598916530609131
generate_one_block  0.3482828140258789
generate_one_block  0.3852999210357666
generate_one_block  0.3736581802368164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.1284472942352295
gen group dst list time:  0.07450366020202637
time for parepare:  0.02161383628845215
local_output_nid generation:  0.028286218643188477
local_in_edges_tensor generation:  0.0554964542388916
mini_batch_src_global generation:  0.051421403884887695
r_  generation:  0.5344691276550293
local_output_nid generation:  0.03942251205444336
local_in_edges_tensor generation:  0.053446054458618164
mini_batch_src_global generation:  0.06366991996765137
r_  generation:  0.524240255355835
local_output_nid generation:  0.033506155014038086
local_in_edges_tensor generation:  0.05861520767211914
mini_batch_src_global generation:  0.06082940101623535
r_  generation:  0.5393369197845459
local_output_nid generation:  0.03478360176086426
local_in_edges_tensor generation:  0.04748892784118652
mini_batch_src_global generation:  0.06494879722595215
r_  generation:  0.560814619064331
local_output_nid generation:  0.03585386276245117
local_in_edges_tensor generation:  0.04415488243103027
mini_batch_src_global generation:  0.06818437576293945
r_  generation:  0.5387578010559082
local_output_nid generation:  0.03340291976928711
local_in_edges_tensor generation:  0.04535961151123047
mini_batch_src_global generation:  0.06651163101196289
r_  generation:  0.5463495254516602
local_output_nid generation:  0.03340411186218262
local_in_edges_tensor generation:  0.03363204002380371
mini_batch_src_global generation:  0.06313109397888184
r_  generation:  0.5483014583587646
local_output_nid generation:  0.03495979309082031
local_in_edges_tensor generation:  0.05973458290100098
mini_batch_src_global generation:  0.0677790641784668
r_  generation:  0.5596199035644531
local_output_nid generation:  0.033319950103759766
local_in_edges_tensor generation:  0.04621624946594238
mini_batch_src_global generation:  0.06929612159729004
r_  generation:  0.5498318672180176
local_output_nid generation:  0.03437232971191406
local_in_edges_tensor generation:  0.04146909713745117
mini_batch_src_global generation:  0.06754446029663086
r_  generation:  0.5425112247467041
local_output_nid generation:  0.033760786056518555
local_in_edges_tensor generation:  0.03597378730773926
mini_batch_src_global generation:  0.06408119201660156
r_  generation:  0.5461592674255371
local_output_nid generation:  0.03348112106323242
local_in_edges_tensor generation:  0.033919572830200195
mini_batch_src_global generation:  0.06449699401855469
r_  generation:  0.5483851432800293
local_output_nid generation:  0.03366208076477051
local_in_edges_tensor generation:  0.03143191337585449
mini_batch_src_global generation:  0.06781005859375
r_  generation:  0.5442767143249512
local_output_nid generation:  0.033252716064453125
local_in_edges_tensor generation:  0.04241514205932617
mini_batch_src_global generation:  0.06482291221618652
r_  generation:  0.617903470993042
local_output_nid generation:  0.03469538688659668
local_in_edges_tensor generation:  0.03181862831115723
mini_batch_src_global generation:  0.08637595176696777
r_  generation:  0.5583946704864502
local_output_nid generation:  0.03645181655883789
local_in_edges_tensor generation:  0.04949188232421875
mini_batch_src_global generation:  0.07729935646057129
r_  generation:  0.5423729419708252
----------------------check_connections_block total spend ----------------------------- 13.069135665893555
generate_one_block  0.696138858795166
generate_one_block  0.7005820274353027
generate_one_block  0.6962118148803711
generate_one_block  0.6959774494171143
generate_one_block  0.7210485935211182
generate_one_block  0.7091245651245117
generate_one_block  0.745337724685669
generate_one_block  0.7037358283996582
generate_one_block  0.6736798286437988
generate_one_block  0.6899580955505371
generate_one_block  0.6850595474243164
generate_one_block  0.6779086589813232
generate_one_block  0.7118823528289795
generate_one_block  0.6862356662750244
generate_one_block  0.6832270622253418
generate_one_block  0.7055413722991943
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  19.460644006729126
block generation total time  16.971994638442993
average batch blocks generation time:  1.060749664902687
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09573030471801758  GigaBytes
Max Memory Allocated: 0.09573030471801758  GigaBytes

torch.Size([157514, 128])
torch.Size([129598, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3690185546875 GB
    Memory Allocated: 14.541538715362549  GigaBytes
Max Memory Allocated: 14.548486232757568  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3787841796875 GB
    Memory Allocated: 0.09671735763549805  GigaBytes
Max Memory Allocated: 14.548486232757568  GigaBytes

torch.Size([157491, 128])
torch.Size([130254, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1990966796875 GB
    Memory Allocated: 14.599613189697266  GigaBytes
Max Memory Allocated: 14.607674598693848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1990966796875 GB
    Memory Allocated: 0.09691762924194336  GigaBytes
Max Memory Allocated: 14.607674598693848  GigaBytes

torch.Size([157557, 128])
torch.Size([130018, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2264404296875 GB
    Memory Allocated: 14.624417781829834  GigaBytes
Max Memory Allocated: 14.632540702819824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2283935546875 GB
    Memory Allocated: 0.09704780578613281  GigaBytes
Max Memory Allocated: 14.632540702819824  GigaBytes

torch.Size([157630, 128])
torch.Size([130424, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 14.65777063369751  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 0.09695863723754883  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

torch.Size([157667, 128])
torch.Size([130269, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 14.633846759796143  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 0.09671926498413086  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

torch.Size([157553, 128])
torch.Size([129635, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 14.583078384399414  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 0.09659624099731445  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

torch.Size([157367, 128])
torch.Size([129561, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 14.560058116912842  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2440185546875 GB
    Memory Allocated: 0.09721899032592773  GigaBytes
Max Memory Allocated: 14.66600513458252  GigaBytes

torch.Size([157877, 128])
torch.Size([130689, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0780029296875 GB
    Memory Allocated: 14.671536445617676  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0780029296875 GB
    Memory Allocated: 0.09682083129882812  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157644, 128])
torch.Size([129927, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0780029296875 GB
    Memory Allocated: 14.562891006469727  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0780029296875 GB
    Memory Allocated: 0.09716081619262695  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157737, 128])
torch.Size([130309, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.668459415435791  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09692001342773438  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157622, 128])
torch.Size([129975, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.621321678161621  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09679937362670898  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157641, 128])
torch.Size([129688, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.594192504882812  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09790611267089844  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157821, 128])
torch.Size([130304, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.624992370605469  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.0966949462890625  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157666, 128])
torch.Size([129360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.54768419265747  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09773731231689453  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157800, 128])
torch.Size([130012, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.580665588378906  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09688758850097656  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157662, 128])
torch.Size([129699, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.585402965545654  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03529134392738342 |0.04607775807380676 |0.7152750343084335 |0.0001256316900253296 |1.112619161605835 |0.017949819564819336 |
----------------------------------------------------------pseudo_mini_loss sum 4.387177467346191
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5332326
Number of first layer input nodes during this epoch:  2522249
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.12663602828979492  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03331160545349121
random selection method range initialization spend 0.006300926208496094
time for parepare:  0.019205093383789062
local_output_nid generation:  0.00304412841796875
local_in_edges_tensor generation:  0.010342597961425781
mini_batch_src_global generation:  0.002480030059814453
r_  generation:  0.021996498107910156
local_output_nid generation:  0.003610372543334961
local_in_edges_tensor generation:  0.001710653305053711
mini_batch_src_global generation:  0.002911806106567383
r_  generation:  0.023219823837280273
local_output_nid generation:  0.003482818603515625
local_in_edges_tensor generation:  0.0016560554504394531
mini_batch_src_global generation:  0.0017955303192138672
r_  generation:  0.022876977920532227
local_output_nid generation:  0.0033750534057617188
local_in_edges_tensor generation:  0.001756906509399414
mini_batch_src_global generation:  0.001993417739868164
r_  generation:  0.023038864135742188
local_output_nid generation:  0.003321409225463867
local_in_edges_tensor generation:  0.001600027084350586
mini_batch_src_global generation:  0.0035593509674072266
r_  generation:  0.02591562271118164
local_output_nid generation:  0.004883766174316406
local_in_edges_tensor generation:  0.002209186553955078
mini_batch_src_global generation:  0.0017867088317871094
r_  generation:  0.02024221420288086
local_output_nid generation:  0.004437923431396484
local_in_edges_tensor generation:  0.0020258426666259766
mini_batch_src_global generation:  0.0017309188842773438
r_  generation:  0.021373510360717773
local_output_nid generation:  0.004541873931884766
local_in_edges_tensor generation:  0.002153158187866211
mini_batch_src_global generation:  0.0017385482788085938
r_  generation:  0.02143549919128418
local_output_nid generation:  0.0044651031494140625
local_in_edges_tensor generation:  0.002052783966064453
mini_batch_src_global generation:  0.0017387866973876953
r_  generation:  0.022854328155517578
local_output_nid generation:  0.0051190853118896484
local_in_edges_tensor generation:  0.0023903846740722656
mini_batch_src_global generation:  0.016001462936401367
r_  generation:  0.02192401885986328
local_output_nid generation:  0.005045413970947266
local_in_edges_tensor generation:  0.0023822784423828125
mini_batch_src_global generation:  0.0036809444427490234
r_  generation:  0.023318767547607422
local_output_nid generation:  0.004925251007080078
local_in_edges_tensor generation:  0.0022509098052978516
mini_batch_src_global generation:  0.0020716190338134766
r_  generation:  0.022905588150024414
local_output_nid generation:  0.0046825408935546875
local_in_edges_tensor generation:  0.0022051334381103516
mini_batch_src_global generation:  0.0018312931060791016
r_  generation:  0.021854400634765625
local_output_nid generation:  0.004642009735107422
local_in_edges_tensor generation:  0.002238035202026367
mini_batch_src_global generation:  0.0017642974853515625
r_  generation:  0.022011756896972656
local_output_nid generation:  0.004632711410522461
local_in_edges_tensor generation:  0.0022993087768554688
mini_batch_src_global generation:  0.0018720626831054688
r_  generation:  0.021514177322387695
local_output_nid generation:  0.004602670669555664
local_in_edges_tensor generation:  0.0021047592163085938
mini_batch_src_global generation:  0.0018701553344726562
r_  generation:  0.021594762802124023
----------------------check_connections_block total spend ----------------------------- 0.6389727592468262
generate_one_block  0.04674816131591797
generate_one_block  0.0385279655456543
generate_one_block  0.03902482986450195
generate_one_block  0.039879560470581055
generate_one_block  0.03969454765319824
generate_one_block  0.04392671585083008
generate_one_block  0.04218626022338867
generate_one_block  0.039803504943847656
generate_one_block  0.0401303768157959
generate_one_block  0.03937721252441406
generate_one_block  0.04104161262512207
generate_one_block  0.04281926155090332
generate_one_block  0.03996562957763672
generate_one_block  0.039587974548339844
generate_one_block  0.04229235649108887
generate_one_block  0.04094266891479492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0444636344909668
gen group dst list time:  0.020923614501953125
time for parepare:  0.019386768341064453
local_output_nid generation:  0.011416196823120117
local_in_edges_tensor generation:  0.031926870346069336
mini_batch_src_global generation:  0.026700496673583984
r_  generation:  0.24849605560302734
local_output_nid generation:  0.014886856079101562
local_in_edges_tensor generation:  0.0253753662109375
mini_batch_src_global generation:  0.031449079513549805
r_  generation:  0.256502628326416
local_output_nid generation:  0.014590978622436523
local_in_edges_tensor generation:  0.02090167999267578
mini_batch_src_global generation:  0.030141353607177734
r_  generation:  0.25875186920166016
local_output_nid generation:  0.016117095947265625
local_in_edges_tensor generation:  0.021181106567382812
mini_batch_src_global generation:  0.03200173377990723
r_  generation:  0.27364039421081543
local_output_nid generation:  0.01563715934753418
local_in_edges_tensor generation:  0.0182344913482666
mini_batch_src_global generation:  0.03319883346557617
r_  generation:  0.2744114398956299
local_output_nid generation:  0.015114784240722656
local_in_edges_tensor generation:  0.01898932456970215
mini_batch_src_global generation:  0.05419588088989258
r_  generation:  0.30764293670654297
local_output_nid generation:  0.020322084426879883
local_in_edges_tensor generation:  0.02152252197265625
mini_batch_src_global generation:  0.04929924011230469
r_  generation:  0.3027160167694092
local_output_nid generation:  0.02007126808166504
local_in_edges_tensor generation:  0.019845008850097656
mini_batch_src_global generation:  0.04006528854370117
r_  generation:  0.30187439918518066
local_output_nid generation:  0.020183563232421875
local_in_edges_tensor generation:  0.018970489501953125
mini_batch_src_global generation:  0.04382658004760742
r_  generation:  0.3128180503845215
local_output_nid generation:  0.019970178604125977
local_in_edges_tensor generation:  0.018593311309814453
mini_batch_src_global generation:  0.046430110931396484
r_  generation:  0.33591270446777344
local_output_nid generation:  0.02613234519958496
local_in_edges_tensor generation:  0.03633713722229004
mini_batch_src_global generation:  0.04335665702819824
r_  generation:  0.2882091999053955
local_output_nid generation:  0.016210079193115234
local_in_edges_tensor generation:  0.024779081344604492
mini_batch_src_global generation:  0.04252457618713379
r_  generation:  0.2869687080383301
local_output_nid generation:  0.01595330238342285
local_in_edges_tensor generation:  0.01870107650756836
mini_batch_src_global generation:  0.03685617446899414
r_  generation:  0.2800295352935791
local_output_nid generation:  0.015583276748657227
local_in_edges_tensor generation:  0.01360774040222168
mini_batch_src_global generation:  0.0368189811706543
r_  generation:  0.27541375160217285
local_output_nid generation:  0.015933513641357422
local_in_edges_tensor generation:  0.020494461059570312
mini_batch_src_global generation:  0.0345458984375
r_  generation:  0.27805662155151367
local_output_nid generation:  0.01567983627319336
local_in_edges_tensor generation:  0.01870107650756836
mini_batch_src_global generation:  0.03467726707458496
r_  generation:  0.27983784675598145
----------------------check_connections_block total spend ----------------------------- 6.820823431015015
generate_one_block  0.3926053047180176
generate_one_block  0.38364267349243164
generate_one_block  0.3811936378479004
generate_one_block  0.39745640754699707
generate_one_block  0.3964543342590332
generate_one_block  0.4005568027496338
generate_one_block  0.4282491207122803
generate_one_block  0.3876783847808838
generate_one_block  0.4021484851837158
generate_one_block  0.38451170921325684
generate_one_block  0.39342474937438965
generate_one_block  0.39769959449768066
generate_one_block  0.37738728523254395
generate_one_block  0.37410521507263184
generate_one_block  0.4177076816558838
generate_one_block  0.3940732479095459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040009260177612305
gen group dst list time:  0.0740518569946289
time for parepare:  0.02050614356994629
local_output_nid generation:  0.032439231872558594
local_in_edges_tensor generation:  0.061907052993774414
mini_batch_src_global generation:  0.05595541000366211
r_  generation:  0.5524756908416748
local_output_nid generation:  0.034285545349121094
local_in_edges_tensor generation:  0.05665421485900879
mini_batch_src_global generation:  0.08194136619567871
r_  generation:  0.5446233749389648
local_output_nid generation:  0.03373861312866211
local_in_edges_tensor generation:  0.03861522674560547
mini_batch_src_global generation:  0.06670665740966797
r_  generation:  0.5797805786132812
local_output_nid generation:  0.03385424613952637
local_in_edges_tensor generation:  0.04174613952636719
mini_batch_src_global generation:  0.06489920616149902
r_  generation:  0.5574212074279785
local_output_nid generation:  0.033661842346191406
local_in_edges_tensor generation:  0.09436583518981934
mini_batch_src_global generation:  0.07019162178039551
r_  generation:  0.5884201526641846
local_output_nid generation:  0.035115957260131836
local_in_edges_tensor generation:  0.04933476448059082
mini_batch_src_global generation:  0.07716894149780273
r_  generation:  0.5576810836791992
local_output_nid generation:  0.03595709800720215
local_in_edges_tensor generation:  0.042261362075805664
mini_batch_src_global generation:  0.06514334678649902
r_  generation:  0.5415699481964111
local_output_nid generation:  0.03496050834655762
local_in_edges_tensor generation:  0.03387093544006348
mini_batch_src_global generation:  0.06490540504455566
r_  generation:  0.542449951171875
local_output_nid generation:  0.035025835037231445
local_in_edges_tensor generation:  0.04135608673095703
mini_batch_src_global generation:  0.06385159492492676
r_  generation:  0.5451202392578125
local_output_nid generation:  0.035088539123535156
local_in_edges_tensor generation:  0.03654026985168457
mini_batch_src_global generation:  0.07926058769226074
r_  generation:  0.5665805339813232
local_output_nid generation:  0.035042762756347656
local_in_edges_tensor generation:  0.04136347770690918
mini_batch_src_global generation:  0.06587076187133789
r_  generation:  0.5467703342437744
local_output_nid generation:  0.03596210479736328
local_in_edges_tensor generation:  0.04499053955078125
mini_batch_src_global generation:  0.06460857391357422
r_  generation:  0.543351411819458
local_output_nid generation:  0.035303354263305664
local_in_edges_tensor generation:  0.03158307075500488
mini_batch_src_global generation:  0.06407499313354492
r_  generation:  0.5512778759002686
local_output_nid generation:  0.03513336181640625
local_in_edges_tensor generation:  0.03520798683166504
mini_batch_src_global generation:  0.07654213905334473
r_  generation:  0.5639059543609619
local_output_nid generation:  0.03703188896179199
local_in_edges_tensor generation:  0.04139375686645508
mini_batch_src_global generation:  0.06780052185058594
r_  generation:  0.5515909194946289
local_output_nid generation:  0.03502631187438965
local_in_edges_tensor generation:  0.036003828048706055
mini_batch_src_global generation:  0.06390595436096191
r_  generation:  0.5446977615356445
----------------------check_connections_block total spend ----------------------------- 13.241453886032104
generate_one_block  0.7426028251647949
generate_one_block  0.7293126583099365
generate_one_block  0.7498877048492432
generate_one_block  0.733597993850708
generate_one_block  0.7197396755218506
generate_one_block  0.719022274017334
generate_one_block  0.715660572052002
generate_one_block  0.7418322563171387
generate_one_block  0.7648608684539795
generate_one_block  0.7458360195159912
generate_one_block  0.7392241954803467
generate_one_block  0.7319350242614746
generate_one_block  0.7250649929046631
generate_one_block  0.7151656150817871
generate_one_block  0.7225520610809326
generate_one_block  0.723778486251831
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.12663602828979492  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

connection checking time:  20.06227731704712
block generation total time  18.02896785736084
average batch blocks generation time:  1.1268104910850525
block dataloader generation time/epoch 41.34898662567139
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09784269332885742  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157434, 128])
torch.Size([129783, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.572402477264404  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09795475006103516  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157750, 128])
torch.Size([129680, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.556477069854736  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09785175323486328  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157610, 128])
torch.Size([129735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.556033611297607  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09831666946411133  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([158011, 128])
torch.Size([130658, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.632866382598877  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09808874130249023  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157587, 128])
torch.Size([129676, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.610610961914062  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09811019897460938  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157608, 128])
torch.Size([129883, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.594093322753906  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09794282913208008  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157289, 128])
torch.Size([129394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.602238178253174  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09795618057250977  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157549, 128])
torch.Size([129777, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.58691692352295  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09910774230957031  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157732, 128])
torch.Size([129958, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.613038063049316  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09797191619873047  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157568, 128])
torch.Size([129828, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.597400188446045  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09822463989257812  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157566, 128])
torch.Size([130135, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.649752616882324  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09839248657226562  GigaBytes
Max Memory Allocated: 14.679722785949707  GigaBytes

torch.Size([157754, 128])
torch.Size([130626, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.685333251953125  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09910106658935547  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

torch.Size([157760, 128])
torch.Size([130360, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.626360893249512  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09804439544677734  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

torch.Size([157772, 128])
torch.Size([129713, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.587943077087402  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09814023971557617  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

torch.Size([157673, 128])
torch.Size([129589, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.620932579040527  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 0.09779214859008789  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

torch.Size([157067, 128])
torch.Size([129394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0799560546875 GB
    Memory Allocated: 14.56651782989502  GigaBytes
Max Memory Allocated: 14.693764686584473  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030549243092536926 |0.026756569743156433 |0.6602459698915482 |0.0001112818717956543 |1.0981321930885315 |0.00492095947265625 |
----------------------------------------------------------pseudo_mini_loss sum 3.699962854385376
Total (block generation + training)time/epoch 70.45930457115173
Training time/epoch 29.11007046699524
Training time without block to device /epoch 28.681965351104736
Training time without total dataloading part /epoch 28.14075207710266
load block tensor time/epoch 0.4887878894805908
block to device time/epoch 0.42810511589050293
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5330345
Number of first layer input nodes during this epoch:  2521730
