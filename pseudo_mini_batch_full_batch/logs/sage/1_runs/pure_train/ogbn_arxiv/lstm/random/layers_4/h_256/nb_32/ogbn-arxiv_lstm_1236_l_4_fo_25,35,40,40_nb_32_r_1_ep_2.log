Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648487428.3740263
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.007684230804443359  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024793148040771484
random selection method range initialization spend 0.006537437438964844
time for parepare:  0.018588781356811523
local_output_nid generation:  0.001116037368774414
local_in_edges_tensor generation:  0.0037794113159179688
mini_batch_src_global generation:  0.0014767646789550781
r_  generation:  0.009335041046142578
local_output_nid generation:  0.0013570785522460938
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0014052391052246094
r_  generation:  0.007972955703735352
local_output_nid generation:  0.0013890266418457031
local_in_edges_tensor generation:  0.0008513927459716797
mini_batch_src_global generation:  0.0009815692901611328
r_  generation:  0.007523298263549805
local_output_nid generation:  0.0014188289642333984
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0008177757263183594
r_  generation:  0.0076253414154052734
local_output_nid generation:  0.0013890266418457031
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0007805824279785156
r_  generation:  0.007549285888671875
local_output_nid generation:  0.0013585090637207031
local_in_edges_tensor generation:  0.0007586479187011719
mini_batch_src_global generation:  0.0007712841033935547
r_  generation:  0.007512807846069336
local_output_nid generation:  0.0013751983642578125
local_in_edges_tensor generation:  0.0007808208465576172
mini_batch_src_global generation:  0.0008268356323242188
r_  generation:  0.007950544357299805
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0007867813110351562
r_  generation:  0.007847785949707031
local_output_nid generation:  0.0013539791107177734
local_in_edges_tensor generation:  0.0007452964782714844
mini_batch_src_global generation:  0.0007882118225097656
r_  generation:  0.007737636566162109
local_output_nid generation:  0.0013728141784667969
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0008678436279296875
r_  generation:  0.008262157440185547
local_output_nid generation:  0.0013723373413085938
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.0008308887481689453
r_  generation:  0.008113384246826172
local_output_nid generation:  0.0013582706451416016
local_in_edges_tensor generation:  0.0007424354553222656
mini_batch_src_global generation:  0.000827789306640625
r_  generation:  0.008220672607421875
local_output_nid generation:  0.0013713836669921875
local_in_edges_tensor generation:  0.0007421970367431641
mini_batch_src_global generation:  0.0008990764617919922
r_  generation:  0.009245157241821289
local_output_nid generation:  0.0013976097106933594
local_in_edges_tensor generation:  0.0007748603820800781
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008295059204101562
local_output_nid generation:  0.0014073848724365234
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0009164810180664062
r_  generation:  0.008417367935180664
local_output_nid generation:  0.0014367103576660156
local_in_edges_tensor generation:  0.0007460117340087891
mini_batch_src_global generation:  0.0008206367492675781
r_  generation:  0.00805807113647461
local_output_nid generation:  0.0013883113861083984
local_in_edges_tensor generation:  0.0007309913635253906
mini_batch_src_global generation:  0.0008172988891601562
r_  generation:  0.008154630661010742
local_output_nid generation:  0.0013933181762695312
local_in_edges_tensor generation:  0.0007376670837402344
mini_batch_src_global generation:  0.0008487701416015625
r_  generation:  0.008325338363647461
local_output_nid generation:  0.001405477523803711
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008270740509033203
r_  generation:  0.007921695709228516
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.0007359981536865234
mini_batch_src_global generation:  0.0008482933044433594
r_  generation:  0.008189916610717773
local_output_nid generation:  0.001378774642944336
local_in_edges_tensor generation:  0.0007259845733642578
mini_batch_src_global generation:  0.0008230209350585938
r_  generation:  0.008044719696044922
local_output_nid generation:  0.00141143798828125
local_in_edges_tensor generation:  0.0007274150848388672
mini_batch_src_global generation:  0.0008594989776611328
r_  generation:  0.008340597152709961
local_output_nid generation:  0.0013866424560546875
local_in_edges_tensor generation:  0.0007288455963134766
mini_batch_src_global generation:  0.0008454322814941406
r_  generation:  0.008101224899291992
local_output_nid generation:  0.0013854503631591797
local_in_edges_tensor generation:  0.0007252693176269531
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.00809621810913086
local_output_nid generation:  0.0014150142669677734
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.007870197296142578
local_output_nid generation:  0.0013782978057861328
local_in_edges_tensor generation:  0.0007262229919433594
mini_batch_src_global generation:  0.0008473396301269531
r_  generation:  0.008212804794311523
local_output_nid generation:  0.0013513565063476562
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  0.0008528232574462891
r_  generation:  0.008264303207397461
local_output_nid generation:  0.0013968944549560547
local_in_edges_tensor generation:  0.0007257461547851562
mini_batch_src_global generation:  0.0008199214935302734
r_  generation:  0.007956743240356445
local_output_nid generation:  0.001397848129272461
local_in_edges_tensor generation:  0.0007200241088867188
mini_batch_src_global generation:  0.0008535385131835938
r_  generation:  0.00826716423034668
local_output_nid generation:  0.001373291015625
local_in_edges_tensor generation:  0.0007126331329345703
mini_batch_src_global generation:  0.0008149147033691406
r_  generation:  0.007681131362915039
local_output_nid generation:  0.0013942718505859375
local_in_edges_tensor generation:  0.005091428756713867
mini_batch_src_global generation:  0.00107574462890625
r_  generation:  0.008124589920043945
local_output_nid generation:  0.0012426376342773438
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.008241891860961914
----------------------check_connections_block total spend ----------------------------- 0.462414026260376
generate_one_block  0.013976573944091797
generate_one_block  0.013326168060302734
generate_one_block  0.01301264762878418
generate_one_block  0.012879371643066406
generate_one_block  0.01277613639831543
generate_one_block  0.012457132339477539
generate_one_block  0.013052225112915039
generate_one_block  0.012822389602661133
generate_one_block  0.012872695922851562
generate_one_block  0.013693809509277344
generate_one_block  0.013245105743408203
generate_one_block  0.013222217559814453
generate_one_block  0.013540029525756836
generate_one_block  0.013293027877807617
generate_one_block  0.013174772262573242
generate_one_block  0.012919187545776367
generate_one_block  0.012887239456176758
generate_one_block  0.013331174850463867
generate_one_block  0.012691259384155273
generate_one_block  0.01327061653137207
generate_one_block  0.012821197509765625
generate_one_block  0.013243436813354492
generate_one_block  0.01299142837524414
generate_one_block  0.012943267822265625
generate_one_block  0.012611150741577148
generate_one_block  0.013453960418701172
generate_one_block  0.013204574584960938
generate_one_block  0.012766361236572266
generate_one_block  0.013261079788208008
generate_one_block  0.01238870620727539
generate_one_block  0.013206005096435547
generate_one_block  0.0131988525390625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.042388200759887695
gen group dst list time:  0.02135491371154785
time for parepare:  0.01921367645263672
local_output_nid generation:  0.004806995391845703
local_in_edges_tensor generation:  0.012556791305541992
mini_batch_src_global generation:  0.012502431869506836
r_  generation:  0.1205754280090332
local_output_nid generation:  0.008776664733886719
local_in_edges_tensor generation:  0.008367061614990234
mini_batch_src_global generation:  0.015510082244873047
r_  generation:  0.12804651260375977
local_output_nid generation:  0.008394241333007812
local_in_edges_tensor generation:  0.01055288314819336
mini_batch_src_global generation:  0.01409912109375
r_  generation:  0.12763261795043945
local_output_nid generation:  0.008277416229248047
local_in_edges_tensor generation:  0.009407997131347656
mini_batch_src_global generation:  0.014923810958862305
r_  generation:  0.12872529029846191
local_output_nid generation:  0.008132457733154297
local_in_edges_tensor generation:  0.010380744934082031
mini_batch_src_global generation:  0.015120744705200195
r_  generation:  0.12897539138793945
local_output_nid generation:  0.008112192153930664
local_in_edges_tensor generation:  0.008059024810791016
mini_batch_src_global generation:  0.015304088592529297
r_  generation:  0.12565207481384277
local_output_nid generation:  0.008258581161499023
local_in_edges_tensor generation:  0.011963367462158203
mini_batch_src_global generation:  0.01654839515686035
r_  generation:  0.1371173858642578
local_output_nid generation:  0.008237361907958984
local_in_edges_tensor generation:  0.00857400894165039
mini_batch_src_global generation:  0.0166933536529541
r_  generation:  0.13353180885314941
local_output_nid generation:  0.008224964141845703
local_in_edges_tensor generation:  0.00946354866027832
mini_batch_src_global generation:  0.01637721061706543
r_  generation:  0.13865041732788086
local_output_nid generation:  0.008506059646606445
local_in_edges_tensor generation:  0.011043310165405273
mini_batch_src_global generation:  0.01817488670349121
r_  generation:  0.1400928497314453
local_output_nid generation:  0.008477926254272461
local_in_edges_tensor generation:  0.008566617965698242
mini_batch_src_global generation:  0.016925334930419922
r_  generation:  0.1388702392578125
local_output_nid generation:  0.0084228515625
local_in_edges_tensor generation:  0.009309530258178711
mini_batch_src_global generation:  0.01817607879638672
r_  generation:  0.14213347434997559
local_output_nid generation:  0.008646011352539062
local_in_edges_tensor generation:  0.00995635986328125
mini_batch_src_global generation:  0.01827526092529297
r_  generation:  0.14352059364318848
local_output_nid generation:  0.008588552474975586
local_in_edges_tensor generation:  0.00972437858581543
mini_batch_src_global generation:  0.01707744598388672
r_  generation:  0.13970518112182617
local_output_nid generation:  0.008585214614868164
local_in_edges_tensor generation:  0.00881814956665039
mini_batch_src_global generation:  0.017389774322509766
r_  generation:  0.14273834228515625
local_output_nid generation:  0.008260011672973633
local_in_edges_tensor generation:  0.008466482162475586
mini_batch_src_global generation:  0.016754150390625
r_  generation:  0.13675498962402344
local_output_nid generation:  0.008292436599731445
local_in_edges_tensor generation:  0.009874820709228516
mini_batch_src_global generation:  0.01644301414489746
r_  generation:  0.1352839469909668
local_output_nid generation:  0.008597850799560547
local_in_edges_tensor generation:  0.009626388549804688
mini_batch_src_global generation:  0.018525362014770508
r_  generation:  0.14252042770385742
local_output_nid generation:  0.008181333541870117
local_in_edges_tensor generation:  0.00939321517944336
mini_batch_src_global generation:  0.01680469512939453
r_  generation:  0.13431501388549805
local_output_nid generation:  0.008601665496826172
local_in_edges_tensor generation:  0.01216745376586914
mini_batch_src_global generation:  0.017037630081176758
r_  generation:  0.14109110832214355
local_output_nid generation:  0.008369684219360352
local_in_edges_tensor generation:  0.008623361587524414
mini_batch_src_global generation:  0.016758203506469727
r_  generation:  0.1373603343963623
local_output_nid generation:  0.008402824401855469
local_in_edges_tensor generation:  0.009858131408691406
mini_batch_src_global generation:  0.016981840133666992
r_  generation:  0.14322972297668457
local_output_nid generation:  0.008451700210571289
local_in_edges_tensor generation:  0.008550405502319336
mini_batch_src_global generation:  0.016876935958862305
r_  generation:  0.14129400253295898
local_output_nid generation:  0.00836944580078125
local_in_edges_tensor generation:  0.009978771209716797
mini_batch_src_global generation:  0.01701188087463379
r_  generation:  0.14110088348388672
local_output_nid generation:  0.008219003677368164
local_in_edges_tensor generation:  0.008415937423706055
mini_batch_src_global generation:  0.016135215759277344
r_  generation:  0.13378453254699707
local_output_nid generation:  0.008571863174438477
local_in_edges_tensor generation:  0.009888172149658203
mini_batch_src_global generation:  0.017331838607788086
r_  generation:  0.1471571922302246
local_output_nid generation:  0.00858449935913086
local_in_edges_tensor generation:  0.011011838912963867
mini_batch_src_global generation:  0.01735067367553711
r_  generation:  0.14278507232666016
local_output_nid generation:  0.008185148239135742
local_in_edges_tensor generation:  0.008464813232421875
mini_batch_src_global generation:  0.016413450241088867
r_  generation:  0.14170455932617188
local_output_nid generation:  0.008440494537353516
local_in_edges_tensor generation:  0.00972127914428711
mini_batch_src_global generation:  0.01691579818725586
r_  generation:  0.1431727409362793
local_output_nid generation:  0.008164644241333008
local_in_edges_tensor generation:  0.008325815200805664
mini_batch_src_global generation:  0.016677379608154297
r_  generation:  0.13416171073913574
local_output_nid generation:  0.00852060317993164
local_in_edges_tensor generation:  0.009070396423339844
mini_batch_src_global generation:  0.018072128295898438
r_  generation:  0.14484548568725586
local_output_nid generation:  0.008485555648803711
local_in_edges_tensor generation:  0.012031316757202148
mini_batch_src_global generation:  0.017338275909423828
r_  generation:  0.14241313934326172
----------------------check_connections_block total spend ----------------------------- 6.547889947891235
generate_one_block  0.17380309104919434
generate_one_block  0.17148995399475098
generate_one_block  0.1886749267578125
generate_one_block  0.1684098243713379
generate_one_block  0.16558218002319336
generate_one_block  0.1597139835357666
generate_one_block  0.1793811321258545
generate_one_block  0.1702580451965332
generate_one_block  0.1670997142791748
generate_one_block  0.1776278018951416
generate_one_block  0.17176532745361328
generate_one_block  0.1752009391784668
generate_one_block  0.17928171157836914
generate_one_block  0.17253613471984863
generate_one_block  0.17686200141906738
generate_one_block  0.17134881019592285
generate_one_block  0.16794729232788086
generate_one_block  0.1820840835571289
generate_one_block  0.16549444198608398
generate_one_block  0.17656755447387695
generate_one_block  0.1726832389831543
generate_one_block  0.17729759216308594
generate_one_block  0.17695260047912598
generate_one_block  0.17202329635620117
generate_one_block  0.1648721694946289
generate_one_block  0.18172192573547363
generate_one_block  0.17838215827941895
generate_one_block  0.16777539253234863
generate_one_block  0.1752176284790039
generate_one_block  0.16760849952697754
generate_one_block  0.17608261108398438
generate_one_block  0.1784663200378418
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035004377365112305
gen group dst list time:  0.0938425064086914
time for parepare:  0.018851757049560547
local_output_nid generation:  0.021329402923583984
local_in_edges_tensor generation:  0.03406977653503418
mini_batch_src_global generation:  0.0410313606262207
r_  generation:  0.41817593574523926
local_output_nid generation:  0.027411460876464844
local_in_edges_tensor generation:  0.04122328758239746
mini_batch_src_global generation:  0.05058932304382324
r_  generation:  0.43021130561828613
local_output_nid generation:  0.027503490447998047
local_in_edges_tensor generation:  0.029727458953857422
mini_batch_src_global generation:  0.050273895263671875
r_  generation:  0.43191981315612793
local_output_nid generation:  0.026136398315429688
local_in_edges_tensor generation:  0.030671119689941406
mini_batch_src_global generation:  0.05421638488769531
r_  generation:  0.42912983894348145
local_output_nid generation:  0.025826215744018555
local_in_edges_tensor generation:  0.02617335319519043
mini_batch_src_global generation:  0.05088019371032715
r_  generation:  0.4483346939086914
local_output_nid generation:  0.026055335998535156
local_in_edges_tensor generation:  0.03265094757080078
mini_batch_src_global generation:  0.05243539810180664
r_  generation:  0.4307730197906494
local_output_nid generation:  0.026211023330688477
local_in_edges_tensor generation:  0.03485846519470215
mini_batch_src_global generation:  0.054506778717041016
r_  generation:  0.4386165142059326
local_output_nid generation:  0.02638983726501465
local_in_edges_tensor generation:  0.03343772888183594
mini_batch_src_global generation:  0.05229473114013672
r_  generation:  0.4392130374908447
local_output_nid generation:  0.026257753372192383
local_in_edges_tensor generation:  0.0259091854095459
mini_batch_src_global generation:  0.054541587829589844
r_  generation:  0.44691967964172363
local_output_nid generation:  0.027980327606201172
local_in_edges_tensor generation:  0.04327225685119629
mini_batch_src_global generation:  0.05872392654418945
r_  generation:  0.4415595531463623
local_output_nid generation:  0.026612281799316406
local_in_edges_tensor generation:  0.03649640083312988
mini_batch_src_global generation:  0.052915096282958984
r_  generation:  0.4421823024749756
local_output_nid generation:  0.02656841278076172
local_in_edges_tensor generation:  0.03163480758666992
mini_batch_src_global generation:  0.053179025650024414
r_  generation:  0.44240903854370117
local_output_nid generation:  0.02702784538269043
local_in_edges_tensor generation:  0.0339505672454834
mini_batch_src_global generation:  0.05275869369506836
r_  generation:  0.4412665367126465
local_output_nid generation:  0.026659488677978516
local_in_edges_tensor generation:  0.03224825859069824
mini_batch_src_global generation:  0.05292224884033203
r_  generation:  0.43456554412841797
local_output_nid generation:  0.026403188705444336
local_in_edges_tensor generation:  0.026106595993041992
mini_batch_src_global generation:  0.05600857734680176
r_  generation:  0.4571559429168701
local_output_nid generation:  0.028858423233032227
local_in_edges_tensor generation:  0.0330810546875
mini_batch_src_global generation:  0.05261850357055664
r_  generation:  0.43619227409362793
local_output_nid generation:  0.026865482330322266
local_in_edges_tensor generation:  0.025681495666503906
mini_batch_src_global generation:  0.053174495697021484
r_  generation:  0.43489766120910645
local_output_nid generation:  0.027097225189208984
local_in_edges_tensor generation:  0.030030012130737305
mini_batch_src_global generation:  0.05593276023864746
r_  generation:  0.4364464282989502
local_output_nid generation:  0.026729345321655273
local_in_edges_tensor generation:  0.025953054428100586
mini_batch_src_global generation:  0.053176164627075195
r_  generation:  0.4331197738647461
local_output_nid generation:  0.02696371078491211
local_in_edges_tensor generation:  0.03324604034423828
mini_batch_src_global generation:  0.056025028228759766
r_  generation:  0.44125819206237793
local_output_nid generation:  0.027415990829467773
local_in_edges_tensor generation:  0.030003786087036133
mini_batch_src_global generation:  0.052495479583740234
r_  generation:  0.4374818801879883
local_output_nid generation:  0.026767253875732422
local_in_edges_tensor generation:  0.02965855598449707
mini_batch_src_global generation:  0.053496360778808594
r_  generation:  0.4376509189605713
local_output_nid generation:  0.026999711990356445
local_in_edges_tensor generation:  0.03408217430114746
mini_batch_src_global generation:  0.05568504333496094
r_  generation:  0.43834495544433594
local_output_nid generation:  0.026862144470214844
local_in_edges_tensor generation:  0.025900602340698242
mini_batch_src_global generation:  0.05318450927734375
r_  generation:  0.43602728843688965
local_output_nid generation:  0.026850461959838867
local_in_edges_tensor generation:  0.024876832962036133
mini_batch_src_global generation:  0.05271339416503906
r_  generation:  0.4359440803527832
local_output_nid generation:  0.027207374572753906
local_in_edges_tensor generation:  0.037817955017089844
mini_batch_src_global generation:  0.056826114654541016
r_  generation:  0.4447188377380371
local_output_nid generation:  0.027173519134521484
local_in_edges_tensor generation:  0.0345151424407959
mini_batch_src_global generation:  0.05332207679748535
r_  generation:  0.44297337532043457
local_output_nid generation:  0.02675318717956543
local_in_edges_tensor generation:  0.025226831436157227
mini_batch_src_global generation:  0.05337786674499512
r_  generation:  0.4381732940673828
local_output_nid generation:  0.02704477310180664
local_in_edges_tensor generation:  0.029691219329833984
mini_batch_src_global generation:  0.05233168601989746
r_  generation:  0.44364213943481445
local_output_nid generation:  0.0265805721282959
local_in_edges_tensor generation:  0.02593517303466797
mini_batch_src_global generation:  0.05346202850341797
r_  generation:  0.435530424118042
local_output_nid generation:  0.02703404426574707
local_in_edges_tensor generation:  0.025591373443603516
mini_batch_src_global generation:  0.05562233924865723
r_  generation:  0.44423699378967285
local_output_nid generation:  0.027555227279663086
local_in_edges_tensor generation:  0.04157876968383789
mini_batch_src_global generation:  0.05655813217163086
r_  generation:  0.44213008880615234
----------------------check_connections_block total spend ----------------------------- 20.613800048828125
generate_one_block  0.6652321815490723
generate_one_block  0.5798137187957764
generate_one_block  0.5582618713378906
generate_one_block  0.5785222053527832
generate_one_block  0.5594079494476318
generate_one_block  0.5615966320037842
generate_one_block  0.5779356956481934
generate_one_block  0.5871596336364746
generate_one_block  0.5647430419921875
generate_one_block  0.5917675495147705
generate_one_block  0.5829892158508301
generate_one_block  0.5611066818237305
generate_one_block  0.5783083438873291
generate_one_block  0.5611758232116699
generate_one_block  0.577256441116333
generate_one_block  0.586575984954834
generate_one_block  0.559586763381958
generate_one_block  0.5800137519836426
generate_one_block  0.5534396171569824
generate_one_block  0.5793991088867188
generate_one_block  0.5866427421569824
generate_one_block  0.5686159133911133
generate_one_block  0.5795180797576904
generate_one_block  0.5563945770263672
generate_one_block  0.5565545558929443
generate_one_block  0.5864980220794678
generate_one_block  0.5807244777679443
generate_one_block  0.5615532398223877
generate_one_block  0.5684545040130615
generate_one_block  0.5525302886962891
generate_one_block  0.567399263381958
generate_one_block  0.583214521408081
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07551360130310059
gen group dst list time:  0.17922759056091309
time for parepare:  0.020298242568969727
local_output_nid generation:  0.03292489051818848
local_in_edges_tensor generation:  0.057187557220458984
mini_batch_src_global generation:  0.04872274398803711
r_  generation:  0.4828836917877197
local_output_nid generation:  0.03977370262145996
local_in_edges_tensor generation:  0.05200934410095215
mini_batch_src_global generation:  0.05512833595275879
r_  generation:  0.48587679862976074
local_output_nid generation:  0.03760480880737305
local_in_edges_tensor generation:  0.038942813873291016
mini_batch_src_global generation:  0.051482200622558594
r_  generation:  0.496105432510376
local_output_nid generation:  0.0369720458984375
local_in_edges_tensor generation:  0.04378008842468262
mini_batch_src_global generation:  0.05463838577270508
r_  generation:  0.4974813461303711
local_output_nid generation:  0.03834700584411621
local_in_edges_tensor generation:  0.04375624656677246
mini_batch_src_global generation:  0.053223609924316406
r_  generation:  0.5019266605377197
local_output_nid generation:  0.03679013252258301
local_in_edges_tensor generation:  0.03520011901855469
mini_batch_src_global generation:  0.0542302131652832
r_  generation:  0.49866795539855957
local_output_nid generation:  0.036205291748046875
local_in_edges_tensor generation:  0.03538799285888672
mini_batch_src_global generation:  0.052837371826171875
r_  generation:  0.502239465713501
local_output_nid generation:  0.036942481994628906
local_in_edges_tensor generation:  0.04030323028564453
mini_batch_src_global generation:  0.053960561752319336
r_  generation:  0.5115313529968262
local_output_nid generation:  0.03717947006225586
local_in_edges_tensor generation:  0.03528094291687012
mini_batch_src_global generation:  0.05311322212219238
r_  generation:  0.5116574764251709
local_output_nid generation:  0.03738880157470703
local_in_edges_tensor generation:  0.04424166679382324
mini_batch_src_global generation:  0.05718517303466797
r_  generation:  0.5070252418518066
local_output_nid generation:  0.037220001220703125
local_in_edges_tensor generation:  0.04367566108703613
mini_batch_src_global generation:  0.053969383239746094
r_  generation:  0.5101251602172852
local_output_nid generation:  0.036550283432006836
local_in_edges_tensor generation:  0.03549003601074219
mini_batch_src_global generation:  0.053848981857299805
r_  generation:  0.5051937103271484
local_output_nid generation:  0.03684210777282715
local_in_edges_tensor generation:  0.03516364097595215
mini_batch_src_global generation:  0.05372953414916992
r_  generation:  0.5102291107177734
local_output_nid generation:  0.03722262382507324
local_in_edges_tensor generation:  0.038796424865722656
mini_batch_src_global generation:  0.055356502532958984
r_  generation:  0.5068647861480713
local_output_nid generation:  0.03771185874938965
local_in_edges_tensor generation:  0.0382990837097168
mini_batch_src_global generation:  0.05774426460266113
r_  generation:  0.5126354694366455
local_output_nid generation:  0.037238359451293945
local_in_edges_tensor generation:  0.04335641860961914
mini_batch_src_global generation:  0.054234981536865234
r_  generation:  0.5054030418395996
local_output_nid generation:  0.0372164249420166
local_in_edges_tensor generation:  0.03501749038696289
mini_batch_src_global generation:  0.05468583106994629
r_  generation:  0.5129284858703613
local_output_nid generation:  0.038062334060668945
local_in_edges_tensor generation:  0.04764509201049805
mini_batch_src_global generation:  0.07311606407165527
r_  generation:  0.5048067569732666
local_output_nid generation:  0.03891873359680176
local_in_edges_tensor generation:  0.042382240295410156
mini_batch_src_global generation:  0.05489325523376465
r_  generation:  0.5069139003753662
local_output_nid generation:  0.038349151611328125
local_in_edges_tensor generation:  0.03501439094543457
mini_batch_src_global generation:  0.056557416915893555
r_  generation:  0.5047309398651123
local_output_nid generation:  0.03832745552062988
local_in_edges_tensor generation:  0.04789924621582031
mini_batch_src_global generation:  0.054337263107299805
r_  generation:  0.5069849491119385
local_output_nid generation:  0.03832292556762695
local_in_edges_tensor generation:  0.034978628158569336
mini_batch_src_global generation:  0.05520820617675781
r_  generation:  0.5259561538696289
local_output_nid generation:  0.038320302963256836
local_in_edges_tensor generation:  0.03899121284484863
mini_batch_src_global generation:  0.05451178550720215
r_  generation:  0.5110385417938232
local_output_nid generation:  0.0377345085144043
local_in_edges_tensor generation:  0.0356597900390625
mini_batch_src_global generation:  0.05577659606933594
r_  generation:  0.5029091835021973
local_output_nid generation:  0.03829836845397949
local_in_edges_tensor generation:  0.03539276123046875
mini_batch_src_global generation:  0.05372428894042969
r_  generation:  0.5142512321472168
local_output_nid generation:  0.03790879249572754
local_in_edges_tensor generation:  0.04801344871520996
mini_batch_src_global generation:  0.05464982986450195
r_  generation:  0.5057635307312012
local_output_nid generation:  0.03824162483215332
local_in_edges_tensor generation:  0.0355069637298584
mini_batch_src_global generation:  0.05442667007446289
r_  generation:  0.5090994834899902
local_output_nid generation:  0.03797340393066406
local_in_edges_tensor generation:  0.038846731185913086
mini_batch_src_global generation:  0.055558204650878906
r_  generation:  0.5056111812591553
local_output_nid generation:  0.04083538055419922
local_in_edges_tensor generation:  0.035408973693847656
mini_batch_src_global generation:  0.05527925491333008
r_  generation:  0.5085411071777344
local_output_nid generation:  0.037899017333984375
local_in_edges_tensor generation:  0.03477334976196289
mini_batch_src_global generation:  0.055350303649902344
r_  generation:  0.501274585723877
local_output_nid generation:  0.0378108024597168
local_in_edges_tensor generation:  0.03883814811706543
mini_batch_src_global generation:  0.058135271072387695
r_  generation:  0.5150659084320068
local_output_nid generation:  0.037795305252075195
local_in_edges_tensor generation:  0.03905487060546875
mini_batch_src_global generation:  0.05545377731323242
r_  generation:  0.5010132789611816
----------------------check_connections_block total spend ----------------------------- 24.184353828430176
generate_one_block  0.620978832244873
generate_one_block  0.6247203350067139
generate_one_block  0.6203641891479492
generate_one_block  0.6248674392700195
generate_one_block  0.6374938488006592
generate_one_block  0.6109731197357178
generate_one_block  0.7606766223907471
generate_one_block  0.6293110847473145
generate_one_block  0.6149239540100098
generate_one_block  0.6378052234649658
generate_one_block  0.6411311626434326
generate_one_block  0.6091251373291016
generate_one_block  0.6107223033905029
generate_one_block  0.6190707683563232
generate_one_block  0.623037576675415
generate_one_block  0.6231441497802734
generate_one_block  0.610163688659668
generate_one_block  0.615896463394165
generate_one_block  0.6291892528533936
generate_one_block  0.6326403617858887
generate_one_block  0.6327176094055176
generate_one_block  0.6173923015594482
generate_one_block  0.6193704605102539
generate_one_block  0.6248085498809814
generate_one_block  0.6219758987426758
generate_one_block  0.6391022205352783
generate_one_block  0.6390457153320312
generate_one_block  0.6182396411895752
generate_one_block  0.6114451885223389
generate_one_block  0.6164968013763428
generate_one_block  0.6223034858703613
generate_one_block  0.6235260963439941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.007684230804443359  GigaBytes

connection checking time:  51.346043825149536
block generation total time  44.025264263153076
average batch blocks generation time:  1.3757895082235336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.10953569412231445  GigaBytes
Max Memory Allocated: 0.10953569412231445  GigaBytes

torch.Size([160969, 128])
torch.Size([147384, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 21.93 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
