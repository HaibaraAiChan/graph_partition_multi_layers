Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648458212.147432
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027298688888549805
random selection method range initialization spend 0.006162166595458984
time for parepare:  0.018700599670410156
local_output_nid generation:  0.002160787582397461
local_in_edges_tensor generation:  0.0040509700775146484
mini_batch_src_global generation:  0.0020160675048828125
r_  generation:  0.021463394165039062
local_output_nid generation:  0.003023862838745117
local_in_edges_tensor generation:  0.0016472339630126953
mini_batch_src_global generation:  0.0023734569549560547
r_  generation:  0.021013975143432617
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.0015783309936523438
mini_batch_src_global generation:  0.0015773773193359375
r_  generation:  0.02080225944519043
local_output_nid generation:  0.0030035972595214844
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0015597343444824219
r_  generation:  0.020467042922973633
local_output_nid generation:  0.0029637813568115234
local_in_edges_tensor generation:  0.0016214847564697266
mini_batch_src_global generation:  0.0015594959259033203
r_  generation:  0.02092742919921875
local_output_nid generation:  0.0029735565185546875
local_in_edges_tensor generation:  0.001577138900756836
mini_batch_src_global generation:  0.0016093254089355469
r_  generation:  0.020528316497802734
local_output_nid generation:  0.0030167102813720703
local_in_edges_tensor generation:  0.0015826225280761719
mini_batch_src_global generation:  0.0016937255859375
r_  generation:  0.022060632705688477
local_output_nid generation:  0.0030088424682617188
local_in_edges_tensor generation:  0.0015721321105957031
mini_batch_src_global generation:  0.0016639232635498047
r_  generation:  0.022118806838989258
local_output_nid generation:  0.003023386001586914
local_in_edges_tensor generation:  0.0015711784362792969
mini_batch_src_global generation:  0.0016701221466064453
r_  generation:  0.021693706512451172
local_output_nid generation:  0.0030088424682617188
local_in_edges_tensor generation:  0.0015711784362792969
mini_batch_src_global generation:  0.0016856193542480469
r_  generation:  0.021950721740722656
local_output_nid generation:  0.002971172332763672
local_in_edges_tensor generation:  0.0015919208526611328
mini_batch_src_global generation:  0.0016980171203613281
r_  generation:  0.021982669830322266
local_output_nid generation:  0.002979755401611328
local_in_edges_tensor generation:  0.0015463829040527344
mini_batch_src_global generation:  0.001741170883178711
r_  generation:  0.022031307220458984
local_output_nid generation:  0.0030279159545898438
local_in_edges_tensor generation:  0.0015845298767089844
mini_batch_src_global generation:  0.001741647720336914
r_  generation:  0.021761417388916016
local_output_nid generation:  0.0030028820037841797
local_in_edges_tensor generation:  0.001554727554321289
mini_batch_src_global generation:  0.0017442703247070312
r_  generation:  0.022422313690185547
local_output_nid generation:  0.0029947757720947266
local_in_edges_tensor generation:  0.0015518665313720703
mini_batch_src_global generation:  0.0017893314361572266
r_  generation:  0.022260427474975586
local_output_nid generation:  0.003033876419067383
local_in_edges_tensor generation:  0.0016028881072998047
mini_batch_src_global generation:  0.0018012523651123047
r_  generation:  0.021477222442626953
----------------------check_connections_block total spend ----------------------------- 0.5537834167480469
generate_one_block  0.031148672103881836
generate_one_block  0.031513214111328125
generate_one_block  0.03453207015991211
generate_one_block  0.03109288215637207
generate_one_block  0.03170013427734375
generate_one_block  0.029822111129760742
generate_one_block  0.03188204765319824
generate_one_block  0.03133082389831543
generate_one_block  0.03109598159790039
generate_one_block  0.031412363052368164
generate_one_block  0.031191349029541016
generate_one_block  0.03180408477783203
generate_one_block  0.030936241149902344
generate_one_block  0.03160214424133301
generate_one_block  0.031716346740722656
generate_one_block  0.030666589736938477
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04239487648010254
gen group dst list time:  0.020600318908691406
time for parepare:  0.01911759376525879
local_output_nid generation:  0.009389162063598633
local_in_edges_tensor generation:  0.020757675170898438
mini_batch_src_global generation:  0.027749061584472656
r_  generation:  0.2598230838775635
local_output_nid generation:  0.013144731521606445
local_in_edges_tensor generation:  0.023694276809692383
mini_batch_src_global generation:  0.03248310089111328
r_  generation:  0.25615930557250977
local_output_nid generation:  0.013025522232055664
local_in_edges_tensor generation:  0.01933884620666504
mini_batch_src_global generation:  0.03341555595397949
r_  generation:  0.2654719352722168
local_output_nid generation:  0.012761592864990234
local_in_edges_tensor generation:  0.016323566436767578
mini_batch_src_global generation:  0.03146529197692871
r_  generation:  0.2586503028869629
local_output_nid generation:  0.012787103652954102
local_in_edges_tensor generation:  0.016461610794067383
mini_batch_src_global generation:  0.03320670127868652
r_  generation:  0.2723727226257324
local_output_nid generation:  0.012726306915283203
local_in_edges_tensor generation:  0.018353939056396484
mini_batch_src_global generation:  0.03294968605041504
r_  generation:  0.2610180377960205
local_output_nid generation:  0.013308286666870117
local_in_edges_tensor generation:  0.019394874572753906
mini_batch_src_global generation:  0.036657094955444336
r_  generation:  0.2779524326324463
local_output_nid generation:  0.013160943984985352
local_in_edges_tensor generation:  0.018947601318359375
mini_batch_src_global generation:  0.042008161544799805
r_  generation:  0.26980161666870117
local_output_nid generation:  0.012908458709716797
local_in_edges_tensor generation:  0.01638507843017578
mini_batch_src_global generation:  0.03420138359069824
r_  generation:  0.2719459533691406
local_output_nid generation:  0.01306009292602539
local_in_edges_tensor generation:  0.01669931411743164
mini_batch_src_global generation:  0.03606438636779785
r_  generation:  0.27641844749450684
local_output_nid generation:  0.012945890426635742
local_in_edges_tensor generation:  0.014163970947265625
mini_batch_src_global generation:  0.0343472957611084
r_  generation:  0.27106785774230957
local_output_nid generation:  0.013025522232055664
local_in_edges_tensor generation:  0.017346858978271484
mini_batch_src_global generation:  0.03466796875
r_  generation:  0.27846741676330566
local_output_nid generation:  0.012703418731689453
local_in_edges_tensor generation:  0.016663074493408203
mini_batch_src_global generation:  0.03456759452819824
r_  generation:  0.2755248546600342
local_output_nid generation:  0.012990236282348633
local_in_edges_tensor generation:  0.014671802520751953
mini_batch_src_global generation:  0.03693222999572754
r_  generation:  0.2768399715423584
local_output_nid generation:  0.012920856475830078
local_in_edges_tensor generation:  0.019034624099731445
mini_batch_src_global generation:  0.03451371192932129
r_  generation:  0.2754213809967041
local_output_nid generation:  0.012863874435424805
local_in_edges_tensor generation:  0.014482975006103516
mini_batch_src_global generation:  0.03434109687805176
r_  generation:  0.27197790145874023
----------------------check_connections_block total spend ----------------------------- 6.282945394515991
generate_one_block  0.36119651794433594
generate_one_block  0.35198283195495605
generate_one_block  0.3620631694793701
generate_one_block  0.34407711029052734
generate_one_block  0.3624305725097656
generate_one_block  0.3413987159729004
generate_one_block  0.3691103458404541
generate_one_block  0.3476290702819824
generate_one_block  0.3496108055114746
generate_one_block  0.35515737533569336
generate_one_block  0.3504486083984375
generate_one_block  0.3689539432525635
generate_one_block  0.34465646743774414
generate_one_block  0.35847997665405273
generate_one_block  0.36522722244262695
generate_one_block  0.3403799533843994
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03295421600341797
gen group dst list time:  0.0625762939453125
time for parepare:  0.018885374069213867
local_output_nid generation:  0.026764869689941406
local_in_edges_tensor generation:  0.04010963439941406
mini_batch_src_global generation:  0.0419158935546875
r_  generation:  0.46009325981140137
local_output_nid generation:  0.032570838928222656
local_in_edges_tensor generation:  0.04697299003601074
mini_batch_src_global generation:  0.058284759521484375
r_  generation:  0.466322660446167
local_output_nid generation:  0.0331416130065918
local_in_edges_tensor generation:  0.0513768196105957
mini_batch_src_global generation:  0.07325959205627441
r_  generation:  0.46459388732910156
local_output_nid generation:  0.03244829177856445
local_in_edges_tensor generation:  0.03648805618286133
mini_batch_src_global generation:  0.06366848945617676
r_  generation:  0.46931886672973633
local_output_nid generation:  0.0341188907623291
local_in_edges_tensor generation:  0.03422188758850098
mini_batch_src_global generation:  0.05244278907775879
r_  generation:  0.4721107482910156
local_output_nid generation:  0.03341388702392578
local_in_edges_tensor generation:  0.03403425216674805
mini_batch_src_global generation:  0.0537869930267334
r_  generation:  0.4694039821624756
local_output_nid generation:  0.03342318534851074
local_in_edges_tensor generation:  0.038152456283569336
mini_batch_src_global generation:  0.053575992584228516
r_  generation:  0.47808051109313965
local_output_nid generation:  0.034039974212646484
local_in_edges_tensor generation:  0.033623695373535156
mini_batch_src_global generation:  0.05496072769165039
r_  generation:  0.4777193069458008
local_output_nid generation:  0.033127784729003906
local_in_edges_tensor generation:  0.033765554428100586
mini_batch_src_global generation:  0.053670644760131836
r_  generation:  0.48335933685302734
local_output_nid generation:  0.03441333770751953
local_in_edges_tensor generation:  0.042168378829956055
mini_batch_src_global generation:  0.06632065773010254
r_  generation:  0.4823446273803711
local_output_nid generation:  0.034345388412475586
local_in_edges_tensor generation:  0.03845953941345215
mini_batch_src_global generation:  0.05412697792053223
r_  generation:  0.4801175594329834
local_output_nid generation:  0.033579349517822266
local_in_edges_tensor generation:  0.03958606719970703
mini_batch_src_global generation:  0.053363800048828125
r_  generation:  0.4757425785064697
local_output_nid generation:  0.033056020736694336
local_in_edges_tensor generation:  0.032874107360839844
mini_batch_src_global generation:  0.053798675537109375
r_  generation:  0.4766499996185303
local_output_nid generation:  0.03341197967529297
local_in_edges_tensor generation:  0.037764787673950195
mini_batch_src_global generation:  0.05335354804992676
r_  generation:  0.47843074798583984
local_output_nid generation:  0.033393144607543945
local_in_edges_tensor generation:  0.03048396110534668
mini_batch_src_global generation:  0.053646087646484375
r_  generation:  0.47763919830322266
local_output_nid generation:  0.03320598602294922
local_in_edges_tensor generation:  0.033942461013793945
mini_batch_src_global generation:  0.05420207977294922
r_  generation:  0.4766232967376709
----------------------check_connections_block total spend ----------------------------- 11.350533723831177
generate_one_block  0.620048999786377
generate_one_block  0.5973377227783203
generate_one_block  0.5929117202758789
generate_one_block  0.5919873714447021
generate_one_block  0.5995385646820068
generate_one_block  0.5939373970031738
generate_one_block  0.653698205947876
generate_one_block  0.6020388603210449
generate_one_block  0.5922229290008545
generate_one_block  0.5844485759735107
generate_one_block  0.596686601638794
generate_one_block  0.6079633235931396
generate_one_block  0.5821268558502197
generate_one_block  0.613896369934082
generate_one_block  0.590019941329956
generate_one_block  0.5972895622253418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  17.633479118347168
block generation total time  15.288955688476562
average batch blocks generation time:  0.9555597305297852
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09353113174438477  GigaBytes
Max Memory Allocated: 0.09353113174438477  GigaBytes

torch.Size([156812, 128])
torch.Size([130604, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9471435546875 GB
    Memory Allocated: 14.545374870300293  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5858154296875 GB
    Memory Allocated: 0.09589004516601562  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

torch.Size([156888, 128])
torch.Size([129652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 14.428908824920654  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 0.09598779678344727  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

torch.Size([156763, 128])
torch.Size([130315, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 14.538515567779541  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 0.09569883346557617  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

torch.Size([156737, 128])
torch.Size([129312, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 14.35466718673706  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 0.09578990936279297  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

torch.Size([156724, 128])
torch.Size([129732, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 14.42265510559082  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 0.09552192687988281  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

torch.Size([156494, 128])
torch.Size([128815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 14.317025184631348  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6170654296875 GB
    Memory Allocated: 0.09620380401611328  GigaBytes
Max Memory Allocated: 14.56238079071045  GigaBytes

torch.Size([157102, 128])
torch.Size([130400, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.561224937438965  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09606313705444336  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([157107, 128])
torch.Size([130727, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.490100860595703  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09593486785888672  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156888, 128])
torch.Size([130270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.471213817596436  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09584617614746094  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156660, 128])
torch.Size([129628, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.447210311889648  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09584951400756836  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156777, 128])
torch.Size([129731, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.43726396560669  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09601926803588867  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156727, 128])
torch.Size([129798, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.543998718261719  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09580135345458984  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156668, 128])
torch.Size([129350, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.431562900543213  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09621286392211914  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([157245, 128])
torch.Size([130792, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.549100875854492  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.0958852767944336  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156668, 128])
torch.Size([129899, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.491133689880371  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09578227996826172  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156828, 128])
torch.Size([130222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.407233238220215  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038779616355895996 |0.04393923282623291 |0.6197105646133423 |0.00010998547077178955 |0.9666554182767868 |0.013376235961914062 |
----------------------------------------------------------pseudo_mini_loss sum 4.950273513793945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5319160
Number of first layer input nodes during this epoch:  2509088
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.12392711639404297  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02915477752685547
random selection method range initialization spend 0.005529880523681641
time for parepare:  0.020000219345092773
local_output_nid generation:  0.003941059112548828
local_in_edges_tensor generation:  0.008378028869628906
mini_batch_src_global generation:  0.0032067298889160156
r_  generation:  0.020148277282714844
local_output_nid generation:  0.003287076950073242
local_in_edges_tensor generation:  0.0018112659454345703
mini_batch_src_global generation:  0.0024919509887695312
r_  generation:  0.020943880081176758
local_output_nid generation:  0.003347635269165039
local_in_edges_tensor generation:  0.0017249584197998047
mini_batch_src_global generation:  0.0015616416931152344
r_  generation:  0.02111077308654785
local_output_nid generation:  0.0033817291259765625
local_in_edges_tensor generation:  0.0017857551574707031
mini_batch_src_global generation:  0.0016636848449707031
r_  generation:  0.021842479705810547
local_output_nid generation:  0.0033233165740966797
local_in_edges_tensor generation:  0.0017669200897216797
mini_batch_src_global generation:  0.001707315444946289
r_  generation:  0.022946596145629883
local_output_nid generation:  0.003923177719116211
local_in_edges_tensor generation:  0.0049364566802978516
mini_batch_src_global generation:  0.0022830963134765625
r_  generation:  0.03344988822937012
local_output_nid generation:  0.005696773529052734
local_in_edges_tensor generation:  0.004453897476196289
mini_batch_src_global generation:  0.0021257400512695312
r_  generation:  0.02285909652709961
local_output_nid generation:  0.004981279373168945
local_in_edges_tensor generation:  0.002524137496948242
mini_batch_src_global generation:  0.0019176006317138672
r_  generation:  0.02267003059387207
local_output_nid generation:  0.0047795772552490234
local_in_edges_tensor generation:  0.0024454593658447266
mini_batch_src_global generation:  0.0019261837005615234
r_  generation:  0.03819584846496582
local_output_nid generation:  0.007093191146850586
local_in_edges_tensor generation:  0.002504587173461914
mini_batch_src_global generation:  0.021428823471069336
r_  generation:  0.026191234588623047
local_output_nid generation:  0.004872322082519531
local_in_edges_tensor generation:  0.002552509307861328
mini_batch_src_global generation:  0.0018763542175292969
r_  generation:  0.021634817123413086
local_output_nid generation:  0.00478363037109375
local_in_edges_tensor generation:  0.002214670181274414
mini_batch_src_global generation:  0.0018687248229980469
r_  generation:  0.02486443519592285
local_output_nid generation:  0.005908966064453125
local_in_edges_tensor generation:  0.0068111419677734375
mini_batch_src_global generation:  0.00514984130859375
r_  generation:  0.026528358459472656
local_output_nid generation:  0.004771709442138672
local_in_edges_tensor generation:  0.0022611618041992188
mini_batch_src_global generation:  0.0019609928131103516
r_  generation:  0.022912263870239258
local_output_nid generation:  0.0042629241943359375
local_in_edges_tensor generation:  0.001959562301635742
mini_batch_src_global generation:  0.0019249916076660156
r_  generation:  0.022635698318481445
local_output_nid generation:  0.00396418571472168
local_in_edges_tensor generation:  0.0019757747650146484
mini_batch_src_global generation:  0.0020411014556884766
r_  generation:  0.023088693618774414
----------------------check_connections_block total spend ----------------------------- 0.6989760398864746
generate_one_block  0.04913210868835449
generate_one_block  0.037804603576660156
generate_one_block  0.03757905960083008
generate_one_block  0.03867530822753906
generate_one_block  0.03863692283630371
generate_one_block  0.041473388671875
generate_one_block  0.039977073669433594
generate_one_block  0.06146836280822754
generate_one_block  0.04066586494445801
generate_one_block  0.0578761100769043
generate_one_block  0.03880143165588379
generate_one_block  0.03975272178649902
generate_one_block  0.03964638710021973
generate_one_block  0.03767848014831543
generate_one_block  0.03765058517456055
generate_one_block  0.04023265838623047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05309319496154785
gen group dst list time:  0.020005464553833008
time for parepare:  0.021740198135375977
local_output_nid generation:  0.01068258285522461
local_in_edges_tensor generation:  0.03491497039794922
mini_batch_src_global generation:  0.02649068832397461
r_  generation:  0.24498629570007324
local_output_nid generation:  0.013854742050170898
local_in_edges_tensor generation:  0.024307966232299805
mini_batch_src_global generation:  0.03206229209899902
r_  generation:  0.25883984565734863
local_output_nid generation:  0.014356851577758789
local_in_edges_tensor generation:  0.01875758171081543
mini_batch_src_global generation:  0.031009435653686523
r_  generation:  0.2626831531524658
local_output_nid generation:  0.014397621154785156
local_in_edges_tensor generation:  0.019252777099609375
mini_batch_src_global generation:  0.0324857234954834
r_  generation:  0.271817684173584
local_output_nid generation:  0.013979434967041016
local_in_edges_tensor generation:  0.014415264129638672
mini_batch_src_global generation:  0.033952951431274414
r_  generation:  0.27402520179748535
local_output_nid generation:  0.013820886611938477
local_in_edges_tensor generation:  0.01606583595275879
mini_batch_src_global generation:  0.03405952453613281
r_  generation:  0.2723395824432373
local_output_nid generation:  0.013693094253540039
local_in_edges_tensor generation:  0.018998146057128906
mini_batch_src_global generation:  0.03413105010986328
r_  generation:  0.28057026863098145
local_output_nid generation:  0.013552188873291016
local_in_edges_tensor generation:  0.01571822166442871
mini_batch_src_global generation:  0.033797264099121094
r_  generation:  0.26967883110046387
local_output_nid generation:  0.013782501220703125
local_in_edges_tensor generation:  0.019425392150878906
mini_batch_src_global generation:  0.0378260612487793
r_  generation:  0.2787351608276367
local_output_nid generation:  0.013775825500488281
local_in_edges_tensor generation:  0.013968944549560547
mini_batch_src_global generation:  0.03394651412963867
r_  generation:  0.273728609085083
local_output_nid generation:  0.015289545059204102
local_in_edges_tensor generation:  0.016333580017089844
mini_batch_src_global generation:  0.03408384323120117
r_  generation:  0.2797737121582031
local_output_nid generation:  0.013837814331054688
local_in_edges_tensor generation:  0.0192413330078125
mini_batch_src_global generation:  0.03615736961364746
r_  generation:  0.2943251132965088
local_output_nid generation:  0.01491546630859375
local_in_edges_tensor generation:  0.031174898147583008
mini_batch_src_global generation:  0.039597511291503906
r_  generation:  0.27893900871276855
local_output_nid generation:  0.015102386474609375
local_in_edges_tensor generation:  0.01834416389465332
mini_batch_src_global generation:  0.03423762321472168
r_  generation:  0.2716529369354248
local_output_nid generation:  0.014194011688232422
local_in_edges_tensor generation:  0.015114784240722656
mini_batch_src_global generation:  0.0342710018157959
r_  generation:  0.2718820571899414
local_output_nid generation:  0.014464616775512695
local_in_edges_tensor generation:  0.021643877029418945
mini_batch_src_global generation:  0.034688472747802734
r_  generation:  0.28017568588256836
----------------------check_connections_block total spend ----------------------------- 6.39873480796814
generate_one_block  0.3849525451660156
generate_one_block  0.373720645904541
generate_one_block  0.37897181510925293
generate_one_block  0.4024674892425537
generate_one_block  0.394747257232666
generate_one_block  0.3769850730895996
generate_one_block  0.4121818542480469
generate_one_block  0.37007856369018555
generate_one_block  0.3868672847747803
generate_one_block  0.40048813819885254
generate_one_block  0.37943005561828613
generate_one_block  0.37958240509033203
generate_one_block  0.3875753879547119
generate_one_block  0.3694930076599121
generate_one_block  0.37486958503723145
generate_one_block  0.386521577835083
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.046649932861328125
gen group dst list time:  0.07136821746826172
time for parepare:  0.018514633178710938
local_output_nid generation:  0.02938675880432129
local_in_edges_tensor generation:  0.05252814292907715
mini_batch_src_global generation:  0.04597282409667969
r_  generation:  0.4508848190307617
local_output_nid generation:  0.03365373611450195
local_in_edges_tensor generation:  0.04869389533996582
mini_batch_src_global generation:  0.05246090888977051
r_  generation:  0.4698524475097656
local_output_nid generation:  0.03381752967834473
local_in_edges_tensor generation:  0.04064178466796875
mini_batch_src_global generation:  0.050905704498291016
r_  generation:  0.4722771644592285
local_output_nid generation:  0.03440737724304199
local_in_edges_tensor generation:  0.04136204719543457
mini_batch_src_global generation:  0.05166435241699219
r_  generation:  0.4690558910369873
local_output_nid generation:  0.03323769569396973
local_in_edges_tensor generation:  0.08433771133422852
mini_batch_src_global generation:  0.052390098571777344
r_  generation:  0.47463130950927734
local_output_nid generation:  0.0332951545715332
local_in_edges_tensor generation:  0.03181648254394531
mini_batch_src_global generation:  0.05308961868286133
r_  generation:  0.47797727584838867
local_output_nid generation:  0.033583641052246094
local_in_edges_tensor generation:  0.03201007843017578
mini_batch_src_global generation:  0.05266141891479492
r_  generation:  0.486281156539917
local_output_nid generation:  0.03423476219177246
local_in_edges_tensor generation:  0.03883981704711914
mini_batch_src_global generation:  0.05336594581604004
r_  generation:  0.4834787845611572
local_output_nid generation:  0.033759117126464844
local_in_edges_tensor generation:  0.0428919792175293
mini_batch_src_global generation:  0.05427074432373047
r_  generation:  0.49892449378967285
local_output_nid generation:  0.035804033279418945
local_in_edges_tensor generation:  0.044539690017700195
mini_batch_src_global generation:  0.05883955955505371
r_  generation:  0.48380517959594727
local_output_nid generation:  0.03522467613220215
local_in_edges_tensor generation:  0.03791546821594238
mini_batch_src_global generation:  0.05384087562561035
r_  generation:  0.4850771427154541
local_output_nid generation:  0.03457522392272949
local_in_edges_tensor generation:  0.03977251052856445
mini_batch_src_global generation:  0.053260087966918945
r_  generation:  0.4773213863372803
local_output_nid generation:  0.03465557098388672
local_in_edges_tensor generation:  0.035790205001831055
mini_batch_src_global generation:  0.05302929878234863
r_  generation:  0.4817695617675781
local_output_nid generation:  0.034381866455078125
local_in_edges_tensor generation:  0.03574657440185547
mini_batch_src_global generation:  0.05334305763244629
r_  generation:  0.48241138458251953
local_output_nid generation:  0.03464841842651367
local_in_edges_tensor generation:  0.040489912033081055
mini_batch_src_global generation:  0.05334591865539551
r_  generation:  0.4817063808441162
local_output_nid generation:  0.03520679473876953
local_in_edges_tensor generation:  0.035733938217163086
mini_batch_src_global generation:  0.06085610389709473
r_  generation:  0.4809122085571289
----------------------check_connections_block total spend ----------------------------- 11.440499067306519
generate_one_block  0.6515192985534668
generate_one_block  0.6324589252471924
generate_one_block  0.6268672943115234
generate_one_block  0.6344625949859619
generate_one_block  0.6273798942565918
generate_one_block  0.6265513896942139
generate_one_block  0.618666410446167
generate_one_block  0.6155755519866943
generate_one_block  0.6695172786712646
generate_one_block  0.6277594566345215
generate_one_block  0.6443324089050293
generate_one_block  0.6549134254455566
generate_one_block  0.6527025699615479
generate_one_block  0.6275968551635742
generate_one_block  0.6251599788665771
generate_one_block  0.6508471965789795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.12392711639404297  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

connection checking time:  17.839233875274658
block generation total time  16.345243215560913
average batch blocks generation time:  1.021577700972557
block dataloader generation time/epoch 37.24665951728821
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09727239608764648  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156388, 128])
torch.Size([129289, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.38969898223877  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09752130508422852  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156681, 128])
torch.Size([129580, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.443188667297363  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09756898880004883  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156781, 128])
torch.Size([129854, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.45529556274414  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09787845611572266  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([157096, 128])
torch.Size([130613, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.557345867156982  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09781980514526367  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156993, 128])
torch.Size([129999, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.532426357269287  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09768390655517578  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([157038, 128])
torch.Size([130194, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.462923526763916  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09761381149291992  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156693, 128])
torch.Size([129676, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.487287998199463  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09729766845703125  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156550, 128])
torch.Size([129523, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.37579345703125  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09763813018798828  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156916, 128])
torch.Size([129896, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.456680297851562  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09755516052246094  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156888, 128])
torch.Size([129692, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.407715320587158  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09759283065795898  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156865, 128])
torch.Size([130349, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.455682277679443  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09785032272338867  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([157163, 128])
torch.Size([130420, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.515761852264404  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09789371490478516  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([157282, 128])
torch.Size([130806, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.515607357025146  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09734010696411133  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156503, 128])
torch.Size([128879, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.365402221679688  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09756851196289062  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156844, 128])
torch.Size([129942, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.433144092559814  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 0.09779691696166992  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

torch.Size([156985, 128])
torch.Size([130665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6424560546875 GB
    Memory Allocated: 14.542788028717041  GigaBytes
Max Memory Allocated: 14.5789213180542  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03451898694038391 |0.022927895188331604 |0.570726215839386 |0.00010600686073303223 |0.9099548757076263 |0.005284547805786133 |
----------------------------------------------------------pseudo_mini_loss sum 3.7956387996673584
Total (block generation + training)time/epoch 61.89590764045715
Training time/epoch 24.648988723754883
Training time without block to device /epoch 24.282142400741577
Training time without total dataloading part /epoch 23.697878122329712
load block tensor time/epoch 0.5523037910461426
block to device time/epoch 0.36684632301330566
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5319402
Number of first layer input nodes during this epoch:  2509666
