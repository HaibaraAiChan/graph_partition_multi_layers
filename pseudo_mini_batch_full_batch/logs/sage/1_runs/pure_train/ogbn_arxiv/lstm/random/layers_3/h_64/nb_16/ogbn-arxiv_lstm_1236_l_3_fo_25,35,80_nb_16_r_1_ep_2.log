Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648457458.9012437
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026194334030151367
random selection method range initialization spend 0.005697965621948242
time for parepare:  0.019119739532470703
local_output_nid generation:  0.002095460891723633
local_in_edges_tensor generation:  0.003785371780395508
mini_batch_src_global generation:  0.002007007598876953
r_  generation:  0.021402597427368164
local_output_nid generation:  0.002989530563354492
local_in_edges_tensor generation:  0.0016231536865234375
mini_batch_src_global generation:  0.0023453235626220703
r_  generation:  0.02060532569885254
local_output_nid generation:  0.0030012130737304688
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.001567840576171875
r_  generation:  0.02079033851623535
local_output_nid generation:  0.003026247024536133
local_in_edges_tensor generation:  0.0015828609466552734
mini_batch_src_global generation:  0.0015347003936767578
r_  generation:  0.022626876831054688
local_output_nid generation:  0.0030562877655029297
local_in_edges_tensor generation:  0.0015332698822021484
mini_batch_src_global generation:  0.0017704963684082031
r_  generation:  0.021097898483276367
local_output_nid generation:  0.0029845237731933594
local_in_edges_tensor generation:  0.0015003681182861328
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.020284414291381836
local_output_nid generation:  0.0029914379119873047
local_in_edges_tensor generation:  0.0014846324920654297
mini_batch_src_global generation:  0.0016362667083740234
r_  generation:  0.02201080322265625
local_output_nid generation:  0.00299072265625
local_in_edges_tensor generation:  0.0015025138854980469
mini_batch_src_global generation:  0.0016901493072509766
r_  generation:  0.021514177322387695
local_output_nid generation:  0.003093719482421875
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0016307830810546875
r_  generation:  0.021660566329956055
local_output_nid generation:  0.0030286312103271484
local_in_edges_tensor generation:  0.0015292167663574219
mini_batch_src_global generation:  0.0016667842864990234
r_  generation:  0.021744251251220703
local_output_nid generation:  0.0030002593994140625
local_in_edges_tensor generation:  0.0015273094177246094
mini_batch_src_global generation:  0.0016918182373046875
r_  generation:  0.021504640579223633
local_output_nid generation:  0.0030252933502197266
local_in_edges_tensor generation:  0.0015285015106201172
mini_batch_src_global generation:  0.0017435550689697266
r_  generation:  0.021979093551635742
local_output_nid generation:  0.0030355453491210938
local_in_edges_tensor generation:  0.0015358924865722656
mini_batch_src_global generation:  0.0017054080963134766
r_  generation:  0.021591663360595703
local_output_nid generation:  0.0030090808868408203
local_in_edges_tensor generation:  0.0015010833740234375
mini_batch_src_global generation:  0.0017476081848144531
r_  generation:  0.02204751968383789
local_output_nid generation:  0.003003835678100586
local_in_edges_tensor generation:  0.0015511512756347656
mini_batch_src_global generation:  0.0018165111541748047
r_  generation:  0.022513866424560547
local_output_nid generation:  0.0030312538146972656
local_in_edges_tensor generation:  0.0015201568603515625
mini_batch_src_global generation:  0.001733541488647461
r_  generation:  0.021570682525634766
----------------------check_connections_block total spend ----------------------------- 0.552513599395752
generate_one_block  0.030800580978393555
generate_one_block  0.03142714500427246
generate_one_block  0.03410172462463379
generate_one_block  0.03122568130493164
generate_one_block  0.03134417533874512
generate_one_block  0.029837369918823242
generate_one_block  0.03200864791870117
generate_one_block  0.031531572341918945
generate_one_block  0.03083348274230957
generate_one_block  0.031880855560302734
generate_one_block  0.03134584426879883
generate_one_block  0.031757354736328125
generate_one_block  0.030522823333740234
generate_one_block  0.03148221969604492
generate_one_block  0.03171133995056152
generate_one_block  0.030710458755493164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03715085983276367
gen group dst list time:  0.02118206024169922
time for parepare:  0.018683195114135742
local_output_nid generation:  0.00901174545288086
local_in_edges_tensor generation:  0.018861770629882812
mini_batch_src_global generation:  0.023363828659057617
r_  generation:  0.2198939323425293
local_output_nid generation:  0.013057231903076172
local_in_edges_tensor generation:  0.020246028900146484
mini_batch_src_global generation:  0.027013063430786133
r_  generation:  0.2201673984527588
local_output_nid generation:  0.012873172760009766
local_in_edges_tensor generation:  0.01722264289855957
mini_batch_src_global generation:  0.02643561363220215
r_  generation:  0.22762393951416016
local_output_nid generation:  0.012601375579833984
local_in_edges_tensor generation:  0.01638031005859375
mini_batch_src_global generation:  0.026848316192626953
r_  generation:  0.2201533317565918
local_output_nid generation:  0.012673139572143555
local_in_edges_tensor generation:  0.01655125617980957
mini_batch_src_global generation:  0.027852296829223633
r_  generation:  0.234177827835083
local_output_nid generation:  0.01250314712524414
local_in_edges_tensor generation:  0.012430191040039062
mini_batch_src_global generation:  0.028123855590820312
r_  generation:  0.22262334823608398
local_output_nid generation:  0.013006925582885742
local_in_edges_tensor generation:  0.015086650848388672
mini_batch_src_global generation:  0.029164552688598633
r_  generation:  0.2385389804840088
local_output_nid generation:  0.013002634048461914
local_in_edges_tensor generation:  0.014833688735961914
mini_batch_src_global generation:  0.02936577796936035
r_  generation:  0.2327582836151123
local_output_nid generation:  0.01274728775024414
local_in_edges_tensor generation:  0.014924764633178711
mini_batch_src_global generation:  0.029199838638305664
r_  generation:  0.2397937774658203
local_output_nid generation:  0.012794017791748047
local_in_edges_tensor generation:  0.014904022216796875
mini_batch_src_global generation:  0.03088974952697754
r_  generation:  0.23577523231506348
local_output_nid generation:  0.012786388397216797
local_in_edges_tensor generation:  0.014660120010375977
mini_batch_src_global generation:  0.02863454818725586
r_  generation:  0.2361133098602295
local_output_nid generation:  0.012835979461669922
local_in_edges_tensor generation:  0.019062519073486328
mini_batch_src_global generation:  0.03172016143798828
r_  generation:  0.23400163650512695
local_output_nid generation:  0.01256251335144043
local_in_edges_tensor generation:  0.013064146041870117
mini_batch_src_global generation:  0.02934861183166504
r_  generation:  0.2315356731414795
local_output_nid generation:  0.012914657592773438
local_in_edges_tensor generation:  0.013013839721679688
mini_batch_src_global generation:  0.02976512908935547
r_  generation:  0.23497867584228516
local_output_nid generation:  0.012972354888916016
local_in_edges_tensor generation:  0.01859736442565918
mini_batch_src_global generation:  0.029456615447998047
r_  generation:  0.23702001571655273
local_output_nid generation:  0.012694597244262695
local_in_edges_tensor generation:  0.013035058975219727
mini_batch_src_global generation:  0.02927398681640625
r_  generation:  0.228285551071167
----------------------check_connections_block total spend ----------------------------- 5.427409887313843
generate_one_block  0.3107285499572754
generate_one_block  0.29726624488830566
generate_one_block  0.3034489154815674
generate_one_block  0.28742241859436035
generate_one_block  0.3125169277191162
generate_one_block  0.2907712459564209
generate_one_block  0.3098320960998535
generate_one_block  0.30901455879211426
generate_one_block  0.2993752956390381
generate_one_block  0.30026936531066895
generate_one_block  0.2989678382873535
generate_one_block  0.3087160587310791
generate_one_block  0.29475903511047363
generate_one_block  0.3107447624206543
generate_one_block  0.31172728538513184
generate_one_block  0.2928328514099121
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.035068511962890625
gen group dst list time:  0.061386823654174805
time for parepare:  0.01870417594909668
local_output_nid generation:  0.02544546127319336
local_in_edges_tensor generation:  0.0387117862701416
mini_batch_src_global generation:  0.04127049446105957
r_  generation:  0.43691229820251465
local_output_nid generation:  0.03139209747314453
local_in_edges_tensor generation:  0.045319318771362305
mini_batch_src_global generation:  0.05139946937561035
r_  generation:  0.4643878936767578
local_output_nid generation:  0.030602455139160156
local_in_edges_tensor generation:  0.03433704376220703
mini_batch_src_global generation:  0.05352616310119629
r_  generation:  0.4493067264556885
local_output_nid generation:  0.030936241149902344
local_in_edges_tensor generation:  0.02951359748840332
mini_batch_src_global generation:  0.05210399627685547
r_  generation:  0.4436049461364746
local_output_nid generation:  0.03071308135986328
local_in_edges_tensor generation:  0.03375744819641113
mini_batch_src_global generation:  0.054546356201171875
r_  generation:  0.4578421115875244
local_output_nid generation:  0.03047657012939453
local_in_edges_tensor generation:  0.029481172561645508
mini_batch_src_global generation:  0.052411794662475586
r_  generation:  0.4481995105743408
local_output_nid generation:  0.030899524688720703
local_in_edges_tensor generation:  0.0375216007232666
mini_batch_src_global generation:  0.05168914794921875
r_  generation:  0.46154212951660156
local_output_nid generation:  0.031223058700561523
local_in_edges_tensor generation:  0.03383064270019531
mini_batch_src_global generation:  0.05253410339355469
r_  generation:  0.4577653408050537
local_output_nid generation:  0.03104996681213379
local_in_edges_tensor generation:  0.03336930274963379
mini_batch_src_global generation:  0.05206584930419922
r_  generation:  0.4609043598175049
local_output_nid generation:  0.031108379364013672
local_in_edges_tensor generation:  0.03374981880187988
mini_batch_src_global generation:  0.05318403244018555
r_  generation:  0.4552180767059326
local_output_nid generation:  0.0313565731048584
local_in_edges_tensor generation:  0.033818721771240234
mini_batch_src_global generation:  0.05483436584472656
r_  generation:  0.4638204574584961
local_output_nid generation:  0.0313878059387207
local_in_edges_tensor generation:  0.03814268112182617
mini_batch_src_global generation:  0.052541494369506836
r_  generation:  0.45749783515930176
local_output_nid generation:  0.03132367134094238
local_in_edges_tensor generation:  0.030269384384155273
mini_batch_src_global generation:  0.0528101921081543
r_  generation:  0.45775365829467773
local_output_nid generation:  0.03167986869812012
local_in_edges_tensor generation:  0.03397989273071289
mini_batch_src_global generation:  0.05573558807373047
r_  generation:  0.46222662925720215
local_output_nid generation:  0.031161069869995117
local_in_edges_tensor generation:  0.04860091209411621
mini_batch_src_global generation:  0.05292844772338867
r_  generation:  0.46576547622680664
local_output_nid generation:  0.031137704849243164
local_in_edges_tensor generation:  0.0286865234375
mini_batch_src_global generation:  0.053827524185180664
r_  generation:  0.45922017097473145
----------------------check_connections_block total spend ----------------------------- 10.776655912399292
generate_one_block  0.5933823585510254
generate_one_block  0.5711982250213623
generate_one_block  0.5878455638885498
generate_one_block  0.6046185493469238
generate_one_block  0.6208682060241699
generate_one_block  0.6179084777832031
generate_one_block  0.67527174949646
generate_one_block  0.6122753620147705
generate_one_block  0.5918035507202148
generate_one_block  0.5849418640136719
generate_one_block  0.5983905792236328
generate_one_block  0.6103525161743164
generate_one_block  0.5783219337463379
generate_one_block  0.5980982780456543
generate_one_block  0.5928475856781006
generate_one_block  0.599905252456665
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  16.204065799713135
block generation total time  14.476423501968384
average batch blocks generation time:  0.904776468873024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09171247482299805  GigaBytes
Max Memory Allocated: 0.09171247482299805  GigaBytes

torch.Size([155080, 128])
torch.Size([125707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3709716796875 GB
    Memory Allocated: 13.818696022033691  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7342529296875 GB
    Memory Allocated: 0.09290742874145508  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

torch.Size([155141, 128])
torch.Size([124656, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.65915298461914  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09334087371826172  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

torch.Size([155135, 128])
torch.Size([125445, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.808185577392578  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09272050857543945  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

torch.Size([155035, 128])
torch.Size([124193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.596733093261719  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09312725067138672  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

torch.Size([154947, 128])
torch.Size([124634, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.65579080581665  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09248113632202148  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

torch.Size([154681, 128])
torch.Size([123568, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.555634021759033  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.0933847427368164  GigaBytes
Max Memory Allocated: 13.835573673248291  GigaBytes

torch.Size([155444, 128])
torch.Size([125550, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.824926376342773  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.0931248664855957  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([155425, 128])
torch.Size([125555, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.719404220581055  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.0932016372680664  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([155134, 128])
torch.Size([125222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.721866130828857  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09284019470214844  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([154920, 128])
torch.Size([124586, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.700013637542725  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09316825866699219  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([155041, 128])
torch.Size([124627, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.691187381744385  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09301233291625977  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([154903, 128])
torch.Size([124860, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.811466693878174  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09313297271728516  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([154873, 128])
torch.Size([124273, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.683566093444824  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09325933456420898  GigaBytes
Max Memory Allocated: 13.842090606689453  GigaBytes

torch.Size([155437, 128])
torch.Size([125877, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.833219528198242  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09327507019042969  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

torch.Size([154893, 128])
torch.Size([124892, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.772358894348145  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09286355972290039  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

torch.Size([155131, 128])
torch.Size([125223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.663087844848633  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036277174949645996 |0.0420185923576355 |0.46051502227783203 |0.00011020898818969727 |0.674015000462532 |0.011621475219726562 |
----------------------------------------------------------pseudo_mini_loss sum 4.94955587387085
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5210680
Number of first layer input nodes during this epoch:  2481220
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.11975955963134766  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026002168655395508
random selection method range initialization spend 0.005046367645263672
time for parepare:  0.018162012100219727
local_output_nid generation:  0.0027854442596435547
local_in_edges_tensor generation:  0.009233474731445312
mini_batch_src_global generation:  0.0021865367889404297
r_  generation:  0.020093917846679688
local_output_nid generation:  0.003233671188354492
local_in_edges_tensor generation:  0.0018863677978515625
mini_batch_src_global generation:  0.0024530887603759766
r_  generation:  0.02098822593688965
local_output_nid generation:  0.0034623146057128906
local_in_edges_tensor generation:  0.0018584728240966797
mini_batch_src_global generation:  0.0015707015991210938
r_  generation:  0.0211029052734375
local_output_nid generation:  0.0032312870025634766
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0016694068908691406
r_  generation:  0.021942615509033203
local_output_nid generation:  0.0032494068145751953
local_in_edges_tensor generation:  0.0017421245574951172
mini_batch_src_global generation:  0.0016896724700927734
r_  generation:  0.02162766456604004
local_output_nid generation:  0.0032541751861572266
local_in_edges_tensor generation:  0.0016536712646484375
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.02150702476501465
local_output_nid generation:  0.003242015838623047
local_in_edges_tensor generation:  0.001653432846069336
mini_batch_src_global generation:  0.0017247200012207031
r_  generation:  0.022619009017944336
local_output_nid generation:  0.0032541751861572266
local_in_edges_tensor generation:  0.0017690658569335938
mini_batch_src_global generation:  0.001714468002319336
r_  generation:  0.021586894989013672
local_output_nid generation:  0.0032651424407958984
local_in_edges_tensor generation:  0.0016672611236572266
mini_batch_src_global generation:  0.0017056465148925781
r_  generation:  0.021867990493774414
local_output_nid generation:  0.0032410621643066406
local_in_edges_tensor generation:  0.0017833709716796875
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.022318124771118164
local_output_nid generation:  0.0031855106353759766
local_in_edges_tensor generation:  0.0016858577728271484
mini_batch_src_global generation:  0.0017535686492919922
r_  generation:  0.02179884910583496
local_output_nid generation:  0.0031948089599609375
local_in_edges_tensor generation:  0.0016222000122070312
mini_batch_src_global generation:  0.0018155574798583984
r_  generation:  0.02249908447265625
local_output_nid generation:  0.003209829330444336
local_in_edges_tensor generation:  0.0016112327575683594
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.02264118194580078
local_output_nid generation:  0.003209352493286133
local_in_edges_tensor generation:  0.0016057491302490234
mini_batch_src_global generation:  0.0018172264099121094
r_  generation:  0.02249002456665039
local_output_nid generation:  0.003229856491088867
local_in_edges_tensor generation:  0.0016436576843261719
mini_batch_src_global generation:  0.0018167495727539062
r_  generation:  0.022301197052001953
local_output_nid generation:  0.003191709518432617
local_in_edges_tensor generation:  0.0016331672668457031
mini_batch_src_global generation:  0.001861572265625
r_  generation:  0.022730588912963867
----------------------check_connections_block total spend ----------------------------- 0.5766923427581787
generate_one_block  0.04070639610290527
generate_one_block  0.0364990234375
generate_one_block  0.03658342361450195
generate_one_block  0.03790283203125
generate_one_block  0.03698992729187012
generate_one_block  0.03998136520385742
generate_one_block  0.03817105293273926
generate_one_block  0.03607773780822754
generate_one_block  0.03698110580444336
generate_one_block  0.03728914260864258
generate_one_block  0.03608226776123047
generate_one_block  0.037543296813964844
generate_one_block  0.03820657730102539
generate_one_block  0.03626871109008789
generate_one_block  0.045433759689331055
generate_one_block  0.04005861282348633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03769493103027344
gen group dst list time:  0.02397942543029785
time for parepare:  0.021291017532348633
local_output_nid generation:  0.01243281364440918
local_in_edges_tensor generation:  0.04231595993041992
mini_batch_src_global generation:  0.022362709045410156
r_  generation:  0.20931267738342285
local_output_nid generation:  0.013903617858886719
local_in_edges_tensor generation:  0.021598100662231445
mini_batch_src_global generation:  0.03456997871398926
r_  generation:  0.2329723834991455
local_output_nid generation:  0.016937971115112305
local_in_edges_tensor generation:  0.019474267959594727
mini_batch_src_global generation:  0.0302884578704834
r_  generation:  0.22706961631774902
local_output_nid generation:  0.01748204231262207
local_in_edges_tensor generation:  0.018416881561279297
mini_batch_src_global generation:  0.028105497360229492
r_  generation:  0.23331189155578613
local_output_nid generation:  0.014673471450805664
local_in_edges_tensor generation:  0.018374204635620117
mini_batch_src_global generation:  0.02936553955078125
r_  generation:  0.23723959922790527
local_output_nid generation:  0.014156818389892578
local_in_edges_tensor generation:  0.016031980514526367
mini_batch_src_global generation:  0.030451297760009766
r_  generation:  0.23443388938903809
local_output_nid generation:  0.014195680618286133
local_in_edges_tensor generation:  0.01618218421936035
mini_batch_src_global generation:  0.03218722343444824
r_  generation:  0.23646116256713867
local_output_nid generation:  0.013905763626098633
local_in_edges_tensor generation:  0.015313148498535156
mini_batch_src_global generation:  0.029071807861328125
r_  generation:  0.23050689697265625
local_output_nid generation:  0.014106273651123047
local_in_edges_tensor generation:  0.0157468318939209
mini_batch_src_global generation:  0.03093743324279785
r_  generation:  0.23447036743164062
local_output_nid generation:  0.014199256896972656
local_in_edges_tensor generation:  0.015851259231567383
mini_batch_src_global generation:  0.029376745223999023
r_  generation:  0.2329542636871338
local_output_nid generation:  0.01642155647277832
local_in_edges_tensor generation:  0.015711307525634766
mini_batch_src_global generation:  0.029132843017578125
r_  generation:  0.23610997200012207
local_output_nid generation:  0.01449131965637207
local_in_edges_tensor generation:  0.016200780868530273
mini_batch_src_global generation:  0.029640913009643555
r_  generation:  0.2368183135986328
local_output_nid generation:  0.014295339584350586
local_in_edges_tensor generation:  0.020429611206054688
mini_batch_src_global generation:  0.029945850372314453
r_  generation:  0.2401893138885498
local_output_nid generation:  0.013940572738647461
local_in_edges_tensor generation:  0.013646602630615234
mini_batch_src_global generation:  0.0296783447265625
r_  generation:  0.2315809726715088
local_output_nid generation:  0.013937950134277344
local_in_edges_tensor generation:  0.016068458557128906
mini_batch_src_global generation:  0.03299975395202637
r_  generation:  0.23573541641235352
local_output_nid generation:  0.014290332794189453
local_in_edges_tensor generation:  0.014312982559204102
mini_batch_src_global generation:  0.030111312866210938
r_  generation:  0.24300336837768555
----------------------check_connections_block total spend ----------------------------- 5.585803747177124
generate_one_block  0.3274562358856201
generate_one_block  0.31807494163513184
generate_one_block  0.31772661209106445
generate_one_block  0.32897472381591797
generate_one_block  0.3283238410949707
generate_one_block  0.31812548637390137
generate_one_block  0.3434295654296875
generate_one_block  0.3054947853088379
generate_one_block  0.31837892532348633
generate_one_block  0.3146815299987793
generate_one_block  0.3174705505371094
generate_one_block  0.32191038131713867
generate_one_block  0.323807954788208
generate_one_block  0.30988526344299316
generate_one_block  0.3160278797149658
generate_one_block  0.33165407180786133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045136213302612305
gen group dst list time:  0.06207394599914551
time for parepare:  0.0182344913482666
local_output_nid generation:  0.02641129493713379
local_in_edges_tensor generation:  0.05451607704162598
mini_batch_src_global generation:  0.045876264572143555
r_  generation:  0.44290661811828613
local_output_nid generation:  0.034110307693481445
local_in_edges_tensor generation:  0.04750227928161621
mini_batch_src_global generation:  0.05153822898864746
r_  generation:  0.4461040496826172
local_output_nid generation:  0.03158974647521973
local_in_edges_tensor generation:  0.03942680358886719
mini_batch_src_global generation:  0.052468299865722656
r_  generation:  0.4578073024749756
local_output_nid generation:  0.03209042549133301
local_in_edges_tensor generation:  0.03537249565124512
mini_batch_src_global generation:  0.05310392379760742
r_  generation:  0.46308016777038574
local_output_nid generation:  0.0325169563293457
local_in_edges_tensor generation:  0.08399415016174316
mini_batch_src_global generation:  0.05257987976074219
r_  generation:  0.4676060676574707
local_output_nid generation:  0.03367209434509277
local_in_edges_tensor generation:  0.03772759437561035
mini_batch_src_global generation:  0.05670642852783203
r_  generation:  0.4823598861694336
local_output_nid generation:  0.03283357620239258
local_in_edges_tensor generation:  0.039528846740722656
mini_batch_src_global generation:  0.05469083786010742
r_  generation:  0.4721260070800781
local_output_nid generation:  0.03505086898803711
local_in_edges_tensor generation:  0.03745293617248535
mini_batch_src_global generation:  0.05427908897399902
r_  generation:  0.4588634967803955
local_output_nid generation:  0.033300161361694336
local_in_edges_tensor generation:  0.03920102119445801
mini_batch_src_global generation:  0.052973031997680664
r_  generation:  0.46625351905822754
local_output_nid generation:  0.03327798843383789
local_in_edges_tensor generation:  0.038553714752197266
mini_batch_src_global generation:  0.05337715148925781
r_  generation:  0.46063971519470215
local_output_nid generation:  0.033277034759521484
local_in_edges_tensor generation:  0.034476280212402344
mini_batch_src_global generation:  0.057825326919555664
r_  generation:  0.467120885848999
local_output_nid generation:  0.033330440521240234
local_in_edges_tensor generation:  0.034880876541137695
mini_batch_src_global generation:  0.05766654014587402
r_  generation:  0.4617118835449219
local_output_nid generation:  0.03310441970825195
local_in_edges_tensor generation:  0.03500771522521973
mini_batch_src_global generation:  0.05475163459777832
r_  generation:  0.4723234176635742
local_output_nid generation:  0.03293013572692871
local_in_edges_tensor generation:  0.03067493438720703
mini_batch_src_global generation:  0.055272579193115234
r_  generation:  0.4618501663208008
local_output_nid generation:  0.03342032432556152
local_in_edges_tensor generation:  0.03468608856201172
mini_batch_src_global generation:  0.054367780685424805
r_  generation:  0.48558759689331055
local_output_nid generation:  0.033554792404174805
local_in_edges_tensor generation:  0.03896975517272949
mini_batch_src_global generation:  0.05516505241394043
r_  generation:  0.472667932510376
----------------------check_connections_block total spend ----------------------------- 11.126357555389404
generate_one_block  0.6168501377105713
generate_one_block  0.6053025722503662
generate_one_block  0.6109333038330078
generate_one_block  0.6148490905761719
generate_one_block  0.6117467880249023
generate_one_block  0.6111404895782471
generate_one_block  0.6005914211273193
generate_one_block  0.5965297222137451
generate_one_block  0.6251354217529297
generate_one_block  0.6025125980377197
generate_one_block  0.6100974082946777
generate_one_block  0.6153042316436768
generate_one_block  0.6164367198944092
generate_one_block  0.5886971950531006
generate_one_block  0.5987389087677002
generate_one_block  0.6136600971221924
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.11975955963134766  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

connection checking time:  16.71216130256653
block generation total time  14.879948854446411
average batch blocks generation time:  0.9299968034029007
block dataloader generation time/epoch 34.29370188713074
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09476995468139648  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

torch.Size([154505, 128])
torch.Size([124179, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.621953964233398  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09445333480834961  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

torch.Size([154777, 128])
torch.Size([124500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 13.710334777832031  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8260498046875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

torch.Size([154921, 128])
torch.Size([124695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.697064876556396  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09488487243652344  GigaBytes
Max Memory Allocated: 13.85015058517456  GigaBytes

torch.Size([155230, 128])
torch.Size([125559, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.835156917572021  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09506988525390625  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155262, 128])
torch.Size([125016, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.80159616470337  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09476661682128906  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155310, 128])
torch.Size([125260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.739301681518555  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09495830535888672  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([154819, 128])
torch.Size([124597, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.770936965942383  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09425640106201172  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([154676, 128])
torch.Size([124178, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.608981132507324  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09488105773925781  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155025, 128])
torch.Size([124598, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.692960262298584  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09460592269897461  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155161, 128])
torch.Size([124665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.671397686004639  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09488773345947266  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155172, 128])
torch.Size([125245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.705047130584717  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09483575820922852  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155383, 128])
torch.Size([125285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.763720989227295  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09503459930419922  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155575, 128])
torch.Size([126028, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.822213172912598  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09429311752319336  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([154669, 128])
torch.Size([123770, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.600665092468262  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.0948648452758789  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([154978, 128])
torch.Size([124793, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.680714130401611  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 0.09485578536987305  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

torch.Size([155193, 128])
torch.Size([125814, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8358154296875 GB
    Memory Allocated: 13.811061382293701  GigaBytes
Max Memory Allocated: 13.85215711593628  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03257773816585541 |0.01934722065925598 |0.4178154021501541 |0.00010181963443756104 |0.6676473766565323 |0.006215095520019531 |
----------------------------------------------------------pseudo_mini_loss sum 3.7984468936920166
Total (block generation + training)time/epoch 52.52981948852539
Training time/epoch 18.235860586166382
Training time without block to device /epoch 17.926305055618286
Training time without total dataloading part /epoch 17.375248670578003
load block tensor time/epoch 0.5212438106536865
block to device time/epoch 0.3095555305480957
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5209088
Number of first layer input nodes during this epoch:  2480656
