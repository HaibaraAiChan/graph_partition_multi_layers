Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648486930.586375
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002379894256591797  GigaBytes
Max Memory Allocated: 0.002379894256591797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024918556213378906
random selection method range initialization spend 0.00641179084777832
time for parepare:  0.01841259002685547
local_output_nid generation:  0.0010881423950195312
local_in_edges_tensor generation:  0.0041043758392333984
mini_batch_src_global generation:  0.001375436782836914
r_  generation:  0.008493661880493164
local_output_nid generation:  0.0012216567993164062
local_in_edges_tensor generation:  0.0012040138244628906
mini_batch_src_global generation:  0.0014088153839111328
r_  generation:  0.008013248443603516
local_output_nid generation:  0.0012636184692382812
local_in_edges_tensor generation:  0.0009751319885253906
mini_batch_src_global generation:  0.0009014606475830078
r_  generation:  0.007348537445068359
local_output_nid generation:  0.0012857913970947266
local_in_edges_tensor generation:  0.0009286403656005859
mini_batch_src_global generation:  0.0008056163787841797
r_  generation:  0.007442474365234375
local_output_nid generation:  0.0012824535369873047
local_in_edges_tensor generation:  0.0008897781372070312
mini_batch_src_global generation:  0.0008764266967773438
r_  generation:  0.007513999938964844
local_output_nid generation:  0.0013098716735839844
local_in_edges_tensor generation:  0.0008654594421386719
mini_batch_src_global generation:  0.0007917881011962891
r_  generation:  0.007756233215332031
local_output_nid generation:  0.001317739486694336
local_in_edges_tensor generation:  0.0008556842803955078
mini_batch_src_global generation:  0.0008339881896972656
r_  generation:  0.007978439331054688
local_output_nid generation:  0.0013227462768554688
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0008251667022705078
r_  generation:  0.00891256332397461
local_output_nid generation:  0.0013427734375
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0008234977722167969
r_  generation:  0.007919788360595703
local_output_nid generation:  0.0013384819030761719
local_in_edges_tensor generation:  0.0008075237274169922
mini_batch_src_global generation:  0.0007767677307128906
r_  generation:  0.007323265075683594
local_output_nid generation:  0.0013320446014404297
local_in_edges_tensor generation:  0.0008091926574707031
mini_batch_src_global generation:  0.0007791519165039062
r_  generation:  0.00771331787109375
local_output_nid generation:  0.0013277530670166016
local_in_edges_tensor generation:  0.0008020401000976562
mini_batch_src_global generation:  0.000797271728515625
r_  generation:  0.007959842681884766
local_output_nid generation:  0.0013275146484375
local_in_edges_tensor generation:  0.0007920265197753906
mini_batch_src_global generation:  0.0008072853088378906
r_  generation:  0.008048772811889648
local_output_nid generation:  0.001332998275756836
local_in_edges_tensor generation:  0.0008029937744140625
mini_batch_src_global generation:  0.0008220672607421875
r_  generation:  0.008056163787841797
local_output_nid generation:  0.0013556480407714844
local_in_edges_tensor generation:  0.0007865428924560547
mini_batch_src_global generation:  0.0007836818695068359
r_  generation:  0.007590293884277344
local_output_nid generation:  0.001321554183959961
local_in_edges_tensor generation:  0.0007860660552978516
mini_batch_src_global generation:  0.0007932186126708984
r_  generation:  0.00795602798461914
local_output_nid generation:  0.001329183578491211
local_in_edges_tensor generation:  0.0008001327514648438
mini_batch_src_global generation:  0.0008625984191894531
r_  generation:  0.007920980453491211
local_output_nid generation:  0.0013442039489746094
local_in_edges_tensor generation:  0.0007860660552978516
mini_batch_src_global generation:  0.0008237361907958984
r_  generation:  0.008077621459960938
local_output_nid generation:  0.001333475112915039
local_in_edges_tensor generation:  0.0007915496826171875
mini_batch_src_global generation:  0.0008358955383300781
r_  generation:  0.008044004440307617
local_output_nid generation:  0.0013146400451660156
local_in_edges_tensor generation:  0.0007748603820800781
mini_batch_src_global generation:  0.0009474754333496094
r_  generation:  0.008234500885009766
local_output_nid generation:  0.0013358592987060547
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.007910490036010742
local_output_nid generation:  0.001325368881225586
local_in_edges_tensor generation:  0.0007817745208740234
mini_batch_src_global generation:  0.0008187294006347656
r_  generation:  0.00790548324584961
local_output_nid generation:  0.0013284683227539062
local_in_edges_tensor generation:  0.0007822513580322266
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.008060693740844727
local_output_nid generation:  0.0013496875762939453
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0008139610290527344
r_  generation:  0.007956266403198242
local_output_nid generation:  0.0013785362243652344
local_in_edges_tensor generation:  0.0007989406585693359
mini_batch_src_global generation:  0.0009441375732421875
r_  generation:  0.008131980895996094
local_output_nid generation:  0.001341104507446289
local_in_edges_tensor generation:  0.0008065700531005859
mini_batch_src_global generation:  0.0008578300476074219
r_  generation:  0.008307456970214844
local_output_nid generation:  0.0013620853424072266
local_in_edges_tensor generation:  0.0007932186126708984
mini_batch_src_global generation:  0.0008227825164794922
r_  generation:  0.008027791976928711
local_output_nid generation:  0.001338958740234375
local_in_edges_tensor generation:  0.000789642333984375
mini_batch_src_global generation:  0.0008289813995361328
r_  generation:  0.008249998092651367
local_output_nid generation:  0.001346588134765625
local_in_edges_tensor generation:  0.0007953643798828125
mini_batch_src_global generation:  0.0008013248443603516
r_  generation:  0.007928609848022461
local_output_nid generation:  0.0013422966003417969
local_in_edges_tensor generation:  0.0007746219635009766
mini_batch_src_global generation:  0.0008203983306884766
r_  generation:  0.008109092712402344
local_output_nid generation:  0.0013473033905029297
local_in_edges_tensor generation:  0.005166053771972656
mini_batch_src_global generation:  0.0010647773742675781
r_  generation:  0.007967233657836914
local_output_nid generation:  0.001222848892211914
local_in_edges_tensor generation:  0.0008521080017089844
mini_batch_src_global generation:  0.0009443759918212891
r_  generation:  0.008240699768066406
----------------------check_connections_block total spend ----------------------------- 0.4576609134674072
generate_one_block  0.013537168502807617
generate_one_block  0.013453245162963867
generate_one_block  0.012824058532714844
generate_one_block  0.01269078254699707
generate_one_block  0.012883424758911133
generate_one_block  0.01294255256652832
generate_one_block  0.013535022735595703
generate_one_block  0.01353311538696289
generate_one_block  0.01300048828125
generate_one_block  0.012443780899047852
generate_one_block  0.012719154357910156
generate_one_block  0.01301264762878418
generate_one_block  0.012958765029907227
generate_one_block  0.013049840927124023
generate_one_block  0.012382745742797852
generate_one_block  0.012671709060668945
generate_one_block  0.012916326522827148
generate_one_block  0.013171195983886719
generate_one_block  0.013149261474609375
generate_one_block  0.013161897659301758
generate_one_block  0.012951374053955078
generate_one_block  0.012908697128295898
generate_one_block  0.013038873672485352
generate_one_block  0.012861967086791992
generate_one_block  0.013324260711669922
generate_one_block  0.013525247573852539
generate_one_block  0.01291513442993164
generate_one_block  0.013275623321533203
generate_one_block  0.012783050537109375
generate_one_block  0.012999296188354492
generate_one_block  0.01316523551940918
generate_one_block  0.013280153274536133
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04323410987854004
gen group dst list time:  0.020862817764282227
time for parepare:  0.019603490829467773
local_output_nid generation:  0.004751443862915039
local_in_edges_tensor generation:  0.012738227844238281
mini_batch_src_global generation:  0.0113525390625
r_  generation:  0.1167459487915039
local_output_nid generation:  0.009577035903930664
local_in_edges_tensor generation:  0.012929916381835938
mini_batch_src_global generation:  0.016113996505737305
r_  generation:  0.12636852264404297
local_output_nid generation:  0.009340286254882812
local_in_edges_tensor generation:  0.010306119918823242
mini_batch_src_global generation:  0.014001131057739258
r_  generation:  0.12783479690551758
local_output_nid generation:  0.009145259857177734
local_in_edges_tensor generation:  0.008193731307983398
mini_batch_src_global generation:  0.01456594467163086
r_  generation:  0.12621402740478516
local_output_nid generation:  0.009194612503051758
local_in_edges_tensor generation:  0.010576725006103516
mini_batch_src_global generation:  0.015207529067993164
r_  generation:  0.1333141326904297
local_output_nid generation:  0.009285926818847656
local_in_edges_tensor generation:  0.009483814239501953
mini_batch_src_global generation:  0.015711307525634766
r_  generation:  0.13054561614990234
local_output_nid generation:  0.009523630142211914
local_in_edges_tensor generation:  0.009755611419677734
mini_batch_src_global generation:  0.01720118522644043
r_  generation:  0.13744282722473145
local_output_nid generation:  0.00971531867980957
local_in_edges_tensor generation:  0.008677482604980469
mini_batch_src_global generation:  0.018079280853271484
r_  generation:  0.14038920402526855
local_output_nid generation:  0.009444952011108398
local_in_edges_tensor generation:  0.011762619018554688
mini_batch_src_global generation:  0.016399383544921875
r_  generation:  0.1340017318725586
local_output_nid generation:  0.008964776992797852
local_in_edges_tensor generation:  0.008029460906982422
mini_batch_src_global generation:  0.0159914493560791
r_  generation:  0.12774395942687988
local_output_nid generation:  0.00934600830078125
local_in_edges_tensor generation:  0.010791778564453125
mini_batch_src_global generation:  0.01621389389038086
r_  generation:  0.13425254821777344
local_output_nid generation:  0.009426355361938477
local_in_edges_tensor generation:  0.008576631546020508
mini_batch_src_global generation:  0.01752328872680664
r_  generation:  0.1351299285888672
local_output_nid generation:  0.009330987930297852
local_in_edges_tensor generation:  0.008319616317749023
mini_batch_src_global generation:  0.01645493507385254
r_  generation:  0.13634634017944336
local_output_nid generation:  0.00944066047668457
local_in_edges_tensor generation:  0.01038050651550293
mini_batch_src_global generation:  0.016547679901123047
r_  generation:  0.13788509368896484
local_output_nid generation:  0.00907588005065918
local_in_edges_tensor generation:  0.010438680648803711
mini_batch_src_global generation:  0.016144752502441406
r_  generation:  0.13095664978027344
local_output_nid generation:  0.009264945983886719
local_in_edges_tensor generation:  0.008222103118896484
mini_batch_src_global generation:  0.016072750091552734
r_  generation:  0.13197565078735352
local_output_nid generation:  0.009464263916015625
local_in_edges_tensor generation:  0.010724306106567383
mini_batch_src_global generation:  0.017484664916992188
r_  generation:  0.13717198371887207
local_output_nid generation:  0.009561300277709961
local_in_edges_tensor generation:  0.010977745056152344
mini_batch_src_global generation:  0.017302274703979492
r_  generation:  0.1394810676574707
local_output_nid generation:  0.00943613052368164
local_in_edges_tensor generation:  0.009906768798828125
mini_batch_src_global generation:  0.01681995391845703
r_  generation:  0.13906049728393555
local_output_nid generation:  0.009474992752075195
local_in_edges_tensor generation:  0.009760856628417969
mini_batch_src_global generation:  0.017139911651611328
r_  generation:  0.14286398887634277
local_output_nid generation:  0.009378910064697266
local_in_edges_tensor generation:  0.00834035873413086
mini_batch_src_global generation:  0.01627516746520996
r_  generation:  0.1357250213623047
local_output_nid generation:  0.009455442428588867
local_in_edges_tensor generation:  0.01050257682800293
mini_batch_src_global generation:  0.017853498458862305
r_  generation:  0.1388535499572754
local_output_nid generation:  0.00943756103515625
local_in_edges_tensor generation:  0.009767770767211914
mini_batch_src_global generation:  0.01647019386291504
r_  generation:  0.13892292976379395
local_output_nid generation:  0.009340286254882812
local_in_edges_tensor generation:  0.009405374526977539
mini_batch_src_global generation:  0.01655864715576172
r_  generation:  0.13559269905090332
local_output_nid generation:  0.009395122528076172
local_in_edges_tensor generation:  0.010562658309936523
mini_batch_src_global generation:  0.016986608505249023
r_  generation:  0.13926982879638672
local_output_nid generation:  0.009550333023071289
local_in_edges_tensor generation:  0.012338638305664062
mini_batch_src_global generation:  0.017681360244750977
r_  generation:  0.14944696426391602
local_output_nid generation:  0.00949406623840332
local_in_edges_tensor generation:  0.008608579635620117
mini_batch_src_global generation:  0.01661229133605957
r_  generation:  0.1388530731201172
local_output_nid generation:  0.009626626968383789
local_in_edges_tensor generation:  0.009008646011352539
mini_batch_src_global generation:  0.017200946807861328
r_  generation:  0.14247870445251465
local_output_nid generation:  0.009299516677856445
local_in_edges_tensor generation:  0.008539915084838867
mini_batch_src_global generation:  0.01686549186706543
r_  generation:  0.13860464096069336
local_output_nid generation:  0.00951528549194336
local_in_edges_tensor generation:  0.009476900100708008
mini_batch_src_global generation:  0.017751693725585938
r_  generation:  0.13796401023864746
local_output_nid generation:  0.009429454803466797
local_in_edges_tensor generation:  0.008647680282592773
mini_batch_src_global generation:  0.01628899574279785
r_  generation:  0.13825607299804688
local_output_nid generation:  0.009386539459228516
local_in_edges_tensor generation:  0.011493921279907227
mini_batch_src_global generation:  0.01775193214416504
r_  generation:  0.1410989761352539
----------------------check_connections_block total spend ----------------------------- 6.508131980895996
generate_one_block  0.16858673095703125
generate_one_block  0.17111825942993164
generate_one_block  0.19022250175476074
generate_one_block  0.16940879821777344
generate_one_block  0.1701197624206543
generate_one_block  0.16877079010009766
generate_one_block  0.17595362663269043
generate_one_block  0.1794123649597168
generate_one_block  0.1682121753692627
generate_one_block  0.16422414779663086
generate_one_block  0.1721816062927246
generate_one_block  0.17650604248046875
generate_one_block  0.17498326301574707
generate_one_block  0.17026138305664062
generate_one_block  0.16381287574768066
generate_one_block  0.17534780502319336
generate_one_block  0.17235112190246582
generate_one_block  0.1791064739227295
generate_one_block  0.17422866821289062
generate_one_block  0.18164658546447754
generate_one_block  0.1662886142730713
generate_one_block  0.17254900932312012
generate_one_block  0.17157387733459473
generate_one_block  0.16707992553710938
generate_one_block  0.17321228981018066
generate_one_block  0.18416428565979004
generate_one_block  0.17000985145568848
generate_one_block  0.17922472953796387
generate_one_block  0.17620420455932617
generate_one_block  0.17173981666564941
generate_one_block  0.16930198669433594
generate_one_block  0.18297505378723145
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0629119873046875
gen group dst list time:  0.10846781730651855
time for parepare:  0.019452333450317383
local_output_nid generation:  0.0224001407623291
local_in_edges_tensor generation:  0.05242776870727539
mini_batch_src_global generation:  0.04195284843444824
r_  generation:  0.4187743663787842
local_output_nid generation:  0.0276336669921875
local_in_edges_tensor generation:  0.04423093795776367
mini_batch_src_global generation:  0.05369234085083008
r_  generation:  0.4248521327972412
local_output_nid generation:  0.02783679962158203
local_in_edges_tensor generation:  0.04105114936828613
mini_batch_src_global generation:  0.05037975311279297
r_  generation:  0.4293482303619385
local_output_nid generation:  0.026479721069335938
local_in_edges_tensor generation:  0.032964468002319336
mini_batch_src_global generation:  0.052392005920410156
r_  generation:  0.44266176223754883
local_output_nid generation:  0.02716994285583496
local_in_edges_tensor generation:  0.03933215141296387
mini_batch_src_global generation:  0.06107378005981445
r_  generation:  0.4308350086212158
local_output_nid generation:  0.025957584381103516
local_in_edges_tensor generation:  0.03613567352294922
mini_batch_src_global generation:  0.053554534912109375
r_  generation:  0.4372563362121582
local_output_nid generation:  0.026386022567749023
local_in_edges_tensor generation:  0.03363204002380371
mini_batch_src_global generation:  0.05573320388793945
r_  generation:  0.4480721950531006
local_output_nid generation:  0.026423931121826172
local_in_edges_tensor generation:  0.03989100456237793
mini_batch_src_global generation:  0.052574872970581055
r_  generation:  0.457763671875
local_output_nid generation:  0.02907252311706543
local_in_edges_tensor generation:  0.031053781509399414
mini_batch_src_global generation:  0.05701947212219238
r_  generation:  0.44376349449157715
local_output_nid generation:  0.026772499084472656
local_in_edges_tensor generation:  0.029273271560668945
mini_batch_src_global generation:  0.05243873596191406
r_  generation:  0.4445667266845703
local_output_nid generation:  0.02647686004638672
local_in_edges_tensor generation:  0.037056922912597656
mini_batch_src_global generation:  0.05179858207702637
r_  generation:  0.4379279613494873
local_output_nid generation:  0.0274507999420166
local_in_edges_tensor generation:  0.033292293548583984
mini_batch_src_global generation:  0.05519723892211914
r_  generation:  0.4358232021331787
local_output_nid generation:  0.02650618553161621
local_in_edges_tensor generation:  0.03284311294555664
mini_batch_src_global generation:  0.05156230926513672
r_  generation:  0.4394245147705078
local_output_nid generation:  0.02664971351623535
local_in_edges_tensor generation:  0.03321051597595215
mini_batch_src_global generation:  0.05652141571044922
r_  generation:  0.4327051639556885
local_output_nid generation:  0.026219606399536133
local_in_edges_tensor generation:  0.028625011444091797
mini_batch_src_global generation:  0.051619529724121094
r_  generation:  0.43025898933410645
local_output_nid generation:  0.026463985443115234
local_in_edges_tensor generation:  0.033182621002197266
mini_batch_src_global generation:  0.05282711982727051
r_  generation:  0.43314671516418457
local_output_nid generation:  0.026935577392578125
local_in_edges_tensor generation:  0.041399478912353516
mini_batch_src_global generation:  0.05228400230407715
r_  generation:  0.44322919845581055
local_output_nid generation:  0.026870250701904297
local_in_edges_tensor generation:  0.0357365608215332
mini_batch_src_global generation:  0.05265188217163086
r_  generation:  0.46156811714172363
local_output_nid generation:  0.02781200408935547
local_in_edges_tensor generation:  0.03812289237976074
mini_batch_src_global generation:  0.05690264701843262
r_  generation:  0.44219493865966797
local_output_nid generation:  0.027476072311401367
local_in_edges_tensor generation:  0.038312435150146484
mini_batch_src_global generation:  0.05443286895751953
r_  generation:  0.4358377456665039
local_output_nid generation:  0.02666616439819336
local_in_edges_tensor generation:  0.033898353576660156
mini_batch_src_global generation:  0.05150032043457031
r_  generation:  0.4369068145751953
local_output_nid generation:  0.026890993118286133
local_in_edges_tensor generation:  0.03686690330505371
mini_batch_src_global generation:  0.052573204040527344
r_  generation:  0.4395771026611328
local_output_nid generation:  0.02665567398071289
local_in_edges_tensor generation:  0.037680864334106445
mini_batch_src_global generation:  0.05155038833618164
r_  generation:  0.43815112113952637
local_output_nid generation:  0.02652883529663086
local_in_edges_tensor generation:  0.02873682975769043
mini_batch_src_global generation:  0.05187511444091797
r_  generation:  0.43163275718688965
local_output_nid generation:  0.026761531829833984
local_in_edges_tensor generation:  0.03246283531188965
mini_batch_src_global generation:  0.0520777702331543
r_  generation:  0.4379000663757324
local_output_nid generation:  0.027167081832885742
local_in_edges_tensor generation:  0.03713870048522949
mini_batch_src_global generation:  0.05248379707336426
r_  generation:  0.4435272216796875
local_output_nid generation:  0.026758193969726562
local_in_edges_tensor generation:  0.029958009719848633
mini_batch_src_global generation:  0.0785062313079834
r_  generation:  0.43810415267944336
local_output_nid generation:  0.026887893676757812
local_in_edges_tensor generation:  0.03674960136413574
mini_batch_src_global generation:  0.05357837677001953
r_  generation:  0.4447758197784424
local_output_nid generation:  0.02667856216430664
local_in_edges_tensor generation:  0.0299835205078125
mini_batch_src_global generation:  0.05195736885070801
r_  generation:  0.43792200088500977
local_output_nid generation:  0.026879072189331055
local_in_edges_tensor generation:  0.033307552337646484
mini_batch_src_global generation:  0.05316019058227539
r_  generation:  0.43869662284851074
local_output_nid generation:  0.02658700942993164
local_in_edges_tensor generation:  0.050856828689575195
mini_batch_src_global generation:  0.052455902099609375
r_  generation:  0.44532036781311035
local_output_nid generation:  0.027894020080566406
local_in_edges_tensor generation:  0.03351402282714844
mini_batch_src_global generation:  0.06156492233276367
r_  generation:  0.4385542869567871
----------------------check_connections_block total spend ----------------------------- 20.820255994796753
generate_one_block  0.671257495880127
generate_one_block  0.56864333152771
generate_one_block  0.571530818939209
generate_one_block  0.5826020240783691
generate_one_block  0.5631968975067139
generate_one_block  0.5619628429412842
generate_one_block  0.5830907821655273
generate_one_block  0.5795059204101562
generate_one_block  0.5698649883270264
generate_one_block  0.5535016059875488
generate_one_block  0.5560882091522217
generate_one_block  0.569955587387085
generate_one_block  0.5577490329742432
generate_one_block  0.5648400783538818
generate_one_block  0.5526542663574219
generate_one_block  0.5596108436584473
generate_one_block  0.5777356624603271
generate_one_block  0.576575517654419
generate_one_block  0.5677127838134766
generate_one_block  0.5624403953552246
generate_one_block  0.5671770572662354
generate_one_block  0.5806119441986084
generate_one_block  0.5584204196929932
generate_one_block  0.5698714256286621
generate_one_block  0.5580911636352539
generate_one_block  0.587498664855957
generate_one_block  0.5697224140167236
generate_one_block  0.5761687755584717
generate_one_block  0.5583028793334961
generate_one_block  0.5625195503234863
generate_one_block  0.5559096336364746
generate_one_block  0.5683014392852783
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0644843578338623
gen group dst list time:  0.17200160026550293
time for parepare:  0.018861055374145508
local_output_nid generation:  0.03192448616027832
local_in_edges_tensor generation:  0.05737733840942383
mini_batch_src_global generation:  0.04789280891418457
r_  generation:  0.4738321304321289
local_output_nid generation:  0.03857541084289551
local_in_edges_tensor generation:  0.05260634422302246
mini_batch_src_global generation:  0.055594682693481445
r_  generation:  0.4828157424926758
local_output_nid generation:  0.037455081939697266
local_in_edges_tensor generation:  0.04409003257751465
mini_batch_src_global generation:  0.05115628242492676
r_  generation:  0.493973970413208
local_output_nid generation:  0.036370277404785156
local_in_edges_tensor generation:  0.039990901947021484
mini_batch_src_global generation:  0.05163240432739258
r_  generation:  0.4934871196746826
local_output_nid generation:  0.036447763442993164
local_in_edges_tensor generation:  0.0360102653503418
mini_batch_src_global generation:  0.05256056785583496
r_  generation:  0.5027384757995605
local_output_nid generation:  0.03694343566894531
local_in_edges_tensor generation:  0.0394437313079834
mini_batch_src_global generation:  0.052704572677612305
r_  generation:  0.5028014183044434
local_output_nid generation:  0.03669929504394531
local_in_edges_tensor generation:  0.039752960205078125
mini_batch_src_global generation:  0.05342292785644531
r_  generation:  0.5056583881378174
local_output_nid generation:  0.03630805015563965
local_in_edges_tensor generation:  0.04031515121459961
mini_batch_src_global generation:  0.05368208885192871
r_  generation:  0.5073556900024414
local_output_nid generation:  0.0362703800201416
local_in_edges_tensor generation:  0.05133938789367676
mini_batch_src_global generation:  0.05299878120422363
r_  generation:  0.5079631805419922
local_output_nid generation:  0.03616595268249512
local_in_edges_tensor generation:  0.03866124153137207
mini_batch_src_global generation:  0.053347110748291016
r_  generation:  0.5043058395385742
local_output_nid generation:  0.036003828048706055
local_in_edges_tensor generation:  0.03878903388977051
mini_batch_src_global generation:  0.05335545539855957
r_  generation:  0.5041952133178711
local_output_nid generation:  0.03651237487792969
local_in_edges_tensor generation:  0.04445171356201172
mini_batch_src_global generation:  0.05676984786987305
r_  generation:  0.5114438533782959
local_output_nid generation:  0.03734421730041504
local_in_edges_tensor generation:  0.04383349418640137
mini_batch_src_global generation:  0.054144859313964844
r_  generation:  0.5038406848907471
local_output_nid generation:  0.03651618957519531
local_in_edges_tensor generation:  0.038858652114868164
mini_batch_src_global generation:  0.054085731506347656
r_  generation:  0.5054178237915039
local_output_nid generation:  0.03644871711730957
local_in_edges_tensor generation:  0.03589606285095215
mini_batch_src_global generation:  0.05434679985046387
r_  generation:  0.506591796875
local_output_nid generation:  0.036366939544677734
local_in_edges_tensor generation:  0.03472495079040527
mini_batch_src_global generation:  0.0541226863861084
r_  generation:  0.5032696723937988
local_output_nid generation:  0.03643035888671875
local_in_edges_tensor generation:  0.03862714767456055
mini_batch_src_global generation:  0.05394768714904785
r_  generation:  0.5089597702026367
local_output_nid generation:  0.03670239448547363
local_in_edges_tensor generation:  0.0441126823425293
mini_batch_src_global generation:  0.05375027656555176
r_  generation:  0.5041520595550537
local_output_nid generation:  0.03651928901672363
local_in_edges_tensor generation:  0.039841413497924805
mini_batch_src_global generation:  0.06037306785583496
r_  generation:  0.5143380165100098
local_output_nid generation:  0.036588430404663086
local_in_edges_tensor generation:  0.0381619930267334
mini_batch_src_global generation:  0.054935455322265625
r_  generation:  0.5076186656951904
local_output_nid generation:  0.03693127632141113
local_in_edges_tensor generation:  0.042629241943359375
mini_batch_src_global generation:  0.05803990364074707
r_  generation:  0.5087010860443115
local_output_nid generation:  0.03663897514343262
local_in_edges_tensor generation:  0.043653249740600586
mini_batch_src_global generation:  0.05431222915649414
r_  generation:  0.5069758892059326
local_output_nid generation:  0.036509037017822266
local_in_edges_tensor generation:  0.03525209426879883
mini_batch_src_global generation:  0.054618120193481445
r_  generation:  0.5111901760101318
local_output_nid generation:  0.03628349304199219
local_in_edges_tensor generation:  0.04407930374145508
mini_batch_src_global generation:  0.06065773963928223
r_  generation:  0.5048565864562988
local_output_nid generation:  0.03632521629333496
local_in_edges_tensor generation:  0.04165530204772949
mini_batch_src_global generation:  0.05426669120788574
r_  generation:  0.5040218830108643
local_output_nid generation:  0.036685943603515625
local_in_edges_tensor generation:  0.04426240921020508
mini_batch_src_global generation:  0.05370616912841797
r_  generation:  0.5213932991027832
local_output_nid generation:  0.03961610794067383
local_in_edges_tensor generation:  0.04415488243103027
mini_batch_src_global generation:  0.06105852127075195
r_  generation:  0.5096654891967773
local_output_nid generation:  0.03766942024230957
local_in_edges_tensor generation:  0.039119720458984375
mini_batch_src_global generation:  0.05772256851196289
r_  generation:  0.5054595470428467
local_output_nid generation:  0.037314653396606445
local_in_edges_tensor generation:  0.03530263900756836
mini_batch_src_global generation:  0.054586172103881836
r_  generation:  0.5091660022735596
local_output_nid generation:  0.03781533241271973
local_in_edges_tensor generation:  0.03908872604370117
mini_batch_src_global generation:  0.05450320243835449
r_  generation:  0.5050585269927979
local_output_nid generation:  0.037629127502441406
local_in_edges_tensor generation:  0.03975224494934082
mini_batch_src_global generation:  0.05439448356628418
r_  generation:  0.5124645233154297
local_output_nid generation:  0.03761720657348633
local_in_edges_tensor generation:  0.035614967346191406
mini_batch_src_global generation:  0.055207252502441406
r_  generation:  0.5082969665527344
----------------------check_connections_block total spend ----------------------------- 24.11809206008911
generate_one_block  0.6126358509063721
generate_one_block  0.6159415245056152
generate_one_block  0.6357128620147705
generate_one_block  0.6239960193634033
generate_one_block  0.6084690093994141
generate_one_block  0.6217601299285889
generate_one_block  0.7345919609069824
generate_one_block  0.6214203834533691
generate_one_block  0.6228523254394531
generate_one_block  0.6045634746551514
generate_one_block  0.61820387840271
generate_one_block  0.6286578178405762
generate_one_block  0.6322343349456787
generate_one_block  0.6186139583587646
generate_one_block  0.6068599224090576
generate_one_block  0.6096799373626709
generate_one_block  0.6202380657196045
generate_one_block  0.607764720916748
generate_one_block  0.6291122436523438
generate_one_block  0.6105153560638428
generate_one_block  0.6308281421661377
generate_one_block  0.6257281303405762
generate_one_block  0.6070187091827393
generate_one_block  0.6059422492980957
generate_one_block  0.6031179428100586
generate_one_block  0.6083953380584717
generate_one_block  0.6401960849761963
generate_one_block  0.6213066577911377
generate_one_block  0.608079195022583
generate_one_block  0.6202528476715088
generate_one_block  0.6244957447052002
generate_one_block  0.6062252521514893
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002379894256591797  GigaBytes
Max Memory Allocated: 0.002379894256591797  GigaBytes

connection checking time:  51.44648003578186
block generation total time  43.699303150177
average batch blocks generation time:  1.3656032234430313
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10387563705444336  GigaBytes
Max Memory Allocated: 0.10387563705444336  GigaBytes

torch.Size([160337, 128])
torch.Size([146581, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 22.00 MiB (GPU 0; 23.62 GiB total capacity; 22.29 GiB already allocated; 10.44 MiB free; 22.41 GiB reserved in total by PyTorch)
