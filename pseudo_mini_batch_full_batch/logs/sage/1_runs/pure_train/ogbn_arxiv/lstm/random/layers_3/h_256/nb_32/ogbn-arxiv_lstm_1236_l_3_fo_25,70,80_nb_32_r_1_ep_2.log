Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648464264.3315983
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027755022048950195
random selection method range initialization spend 0.006204366683959961
time for parepare:  0.018727540969848633
local_output_nid generation:  0.001085519790649414
local_in_edges_tensor generation:  0.003941059112548828
mini_batch_src_global generation:  0.0016911029815673828
r_  generation:  0.011106252670288086
local_output_nid generation:  0.0013914108276367188
local_in_edges_tensor generation:  0.0010123252868652344
mini_batch_src_global generation:  0.0016603469848632812
r_  generation:  0.00981283187866211
local_output_nid generation:  0.0014407634735107422
local_in_edges_tensor generation:  0.0008883476257324219
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.008749008178710938
local_output_nid generation:  0.0014355182647705078
local_in_edges_tensor generation:  0.0008299350738525391
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.008899450302124023
local_output_nid generation:  0.0014278888702392578
local_in_edges_tensor generation:  0.0008232593536376953
mini_batch_src_global generation:  0.0009818077087402344
r_  generation:  0.00913381576538086
local_output_nid generation:  0.0014197826385498047
local_in_edges_tensor generation:  0.0008053779602050781
mini_batch_src_global generation:  0.0010368824005126953
r_  generation:  0.009546756744384766
local_output_nid generation:  0.0014309883117675781
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  0.0010793209075927734
r_  generation:  0.009643077850341797
local_output_nid generation:  0.0014469623565673828
local_in_edges_tensor generation:  0.00079345703125
mini_batch_src_global generation:  0.0010595321655273438
r_  generation:  0.009680509567260742
local_output_nid generation:  0.0014486312866210938
local_in_edges_tensor generation:  0.0007770061492919922
mini_batch_src_global generation:  0.0010561943054199219
r_  generation:  0.009555816650390625
local_output_nid generation:  0.0014424324035644531
local_in_edges_tensor generation:  0.0007801055908203125
mini_batch_src_global generation:  0.00104522705078125
r_  generation:  0.009541749954223633
local_output_nid generation:  0.0014414787292480469
local_in_edges_tensor generation:  0.0007812976837158203
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.009951353073120117
local_output_nid generation:  0.0014462471008300781
local_in_edges_tensor generation:  0.0007662773132324219
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.00963282585144043
local_output_nid generation:  0.0014445781707763672
local_in_edges_tensor generation:  0.0007650852203369141
mini_batch_src_global generation:  0.0009946823120117188
r_  generation:  0.009546279907226562
local_output_nid generation:  0.0014357566833496094
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0010228157043457031
r_  generation:  0.009804964065551758
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0007684230804443359
mini_batch_src_global generation:  0.001026153564453125
r_  generation:  0.009850263595581055
local_output_nid generation:  0.0014369487762451172
local_in_edges_tensor generation:  0.0007352828979492188
mini_batch_src_global generation:  0.0009860992431640625
r_  generation:  0.009409666061401367
local_output_nid generation:  0.001451253890991211
local_in_edges_tensor generation:  0.0007669925689697266
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.010051488876342773
local_output_nid generation:  0.0014753341674804688
local_in_edges_tensor generation:  0.0007679462432861328
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.009745121002197266
local_output_nid generation:  0.0014519691467285156
local_in_edges_tensor generation:  0.0007574558258056641
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.009762287139892578
local_output_nid generation:  0.0014660358428955078
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0009970664978027344
r_  generation:  0.009474992752075195
local_output_nid generation:  0.001455068588256836
local_in_edges_tensor generation:  0.0007507801055908203
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.009909868240356445
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007464885711669922
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.009666204452514648
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0010256767272949219
r_  generation:  0.01018834114074707
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0010399818420410156
r_  generation:  0.010309219360351562
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0007505416870117188
mini_batch_src_global generation:  0.0010330677032470703
r_  generation:  0.01005244255065918
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0007493495941162109
mini_batch_src_global generation:  0.0009965896606445312
r_  generation:  0.00979161262512207
local_output_nid generation:  0.0014729499816894531
local_in_edges_tensor generation:  0.0007350444793701172
mini_batch_src_global generation:  0.0009405612945556641
r_  generation:  0.009514570236206055
local_output_nid generation:  0.0014622211456298828
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.010088920593261719
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0011057853698730469
r_  generation:  0.010217666625976562
local_output_nid generation:  0.0014679431915283203
local_in_edges_tensor generation:  0.005597591400146484
mini_batch_src_global generation:  0.001293182373046875
r_  generation:  0.009907722473144531
local_output_nid generation:  0.0013494491577148438
local_in_edges_tensor generation:  0.0007839202880859375
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.009392738342285156
local_output_nid generation:  0.0013742446899414062
local_in_edges_tensor generation:  0.0007503032684326172
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.009757757186889648
----------------------check_connections_block total spend ----------------------------- 0.5315053462982178
generate_one_block  0.015761852264404297
generate_one_block  0.015527009963989258
generate_one_block  0.013946294784545898
generate_one_block  0.014152765274047852
generate_one_block  0.014592647552490234
generate_one_block  0.014886140823364258
generate_one_block  0.014698505401611328
generate_one_block  0.01494455337524414
generate_one_block  0.014719009399414062
generate_one_block  0.014870643615722656
generate_one_block  0.01506352424621582
generate_one_block  0.014553070068359375
generate_one_block  0.014242410659790039
generate_one_block  0.014551401138305664
generate_one_block  0.014640331268310547
generate_one_block  0.013923883438110352
generate_one_block  0.015065670013427734
generate_one_block  0.014387130737304688
generate_one_block  0.014663457870483398
generate_one_block  0.014221906661987305
generate_one_block  0.014644861221313477
generate_one_block  0.014550924301147461
generate_one_block  0.015120983123779297
generate_one_block  0.0148773193359375
generate_one_block  0.015015125274658203
generate_one_block  0.014597892761230469
generate_one_block  0.014068841934204102
generate_one_block  0.014963865280151367
generate_one_block  0.015218734741210938
generate_one_block  0.014460325241088867
generate_one_block  0.01425933837890625
generate_one_block  0.014383792877197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042681217193603516
gen group dst list time:  0.023654937744140625
time for parepare:  0.0189669132232666
local_output_nid generation:  0.005173921585083008
local_in_edges_tensor generation:  0.01492166519165039
mini_batch_src_global generation:  0.016962528228759766
r_  generation:  0.16320371627807617
local_output_nid generation:  0.009433507919311523
local_in_edges_tensor generation:  0.01697063446044922
mini_batch_src_global generation:  0.02174210548400879
r_  generation:  0.17397260665893555
local_output_nid generation:  0.00847005844116211
local_in_edges_tensor generation:  0.011157989501953125
mini_batch_src_global generation:  0.018861770629882812
r_  generation:  0.16406750679016113
local_output_nid generation:  0.008702754974365234
local_in_edges_tensor generation:  0.012874603271484375
mini_batch_src_global generation:  0.02115774154663086
r_  generation:  0.16896724700927734
local_output_nid generation:  0.008800506591796875
local_in_edges_tensor generation:  0.011361122131347656
mini_batch_src_global generation:  0.021901845932006836
r_  generation:  0.16785502433776855
local_output_nid generation:  0.009003877639770508
local_in_edges_tensor generation:  0.01032400131225586
mini_batch_src_global generation:  0.021948814392089844
r_  generation:  0.1790468692779541
local_output_nid generation:  0.009019613265991211
local_in_edges_tensor generation:  0.011904239654541016
mini_batch_src_global generation:  0.022373676300048828
r_  generation:  0.17353463172912598
local_output_nid generation:  0.00901651382446289
local_in_edges_tensor generation:  0.014786005020141602
mini_batch_src_global generation:  0.022891521453857422
r_  generation:  0.1809074878692627
local_output_nid generation:  0.00908350944519043
local_in_edges_tensor generation:  0.01358938217163086
mini_batch_src_global generation:  0.02211904525756836
r_  generation:  0.18164944648742676
local_output_nid generation:  0.008880138397216797
local_in_edges_tensor generation:  0.010374307632446289
mini_batch_src_global generation:  0.022068262100219727
r_  generation:  0.1775825023651123
local_output_nid generation:  0.009128570556640625
local_in_edges_tensor generation:  0.010628461837768555
mini_batch_src_global generation:  0.025620222091674805
r_  generation:  0.18356919288635254
local_output_nid generation:  0.008975744247436523
local_in_edges_tensor generation:  0.011972427368164062
mini_batch_src_global generation:  0.02235722541809082
r_  generation:  0.180861234664917
local_output_nid generation:  0.008768558502197266
local_in_edges_tensor generation:  0.010192632675170898
mini_batch_src_global generation:  0.022130489349365234
r_  generation:  0.17603707313537598
local_output_nid generation:  0.009000062942504883
local_in_edges_tensor generation:  0.011538267135620117
mini_batch_src_global generation:  0.02387857437133789
r_  generation:  0.1787126064300537
local_output_nid generation:  0.008896350860595703
local_in_edges_tensor generation:  0.014861822128295898
mini_batch_src_global generation:  0.022890806198120117
r_  generation:  0.18210649490356445
local_output_nid generation:  0.008607864379882812
local_in_edges_tensor generation:  0.009894847869873047
mini_batch_src_global generation:  0.02138972282409668
r_  generation:  0.16778945922851562
local_output_nid generation:  0.009145259857177734
local_in_edges_tensor generation:  0.010419845581054688
mini_batch_src_global generation:  0.023584604263305664
r_  generation:  0.18297338485717773
local_output_nid generation:  0.008861780166625977
local_in_edges_tensor generation:  0.013158798217773438
mini_batch_src_global generation:  0.02272176742553711
r_  generation:  0.18270111083984375
local_output_nid generation:  0.009115219116210938
local_in_edges_tensor generation:  0.010612964630126953
mini_batch_src_global generation:  0.024393558502197266
r_  generation:  0.1806778907775879
local_output_nid generation:  0.008923768997192383
local_in_edges_tensor generation:  0.011907100677490234
mini_batch_src_global generation:  0.022511720657348633
r_  generation:  0.18537473678588867
local_output_nid generation:  0.009855508804321289
local_in_edges_tensor generation:  0.02180790901184082
mini_batch_src_global generation:  0.024193525314331055
r_  generation:  0.18940401077270508
local_output_nid generation:  0.00810384750366211
local_in_edges_tensor generation:  0.01394200325012207
mini_batch_src_global generation:  0.02711629867553711
r_  generation:  0.18024134635925293
local_output_nid generation:  0.008276939392089844
local_in_edges_tensor generation:  0.013368844985961914
mini_batch_src_global generation:  0.023151636123657227
r_  generation:  0.181382417678833
local_output_nid generation:  0.008213043212890625
local_in_edges_tensor generation:  0.014448881149291992
mini_batch_src_global generation:  0.023210525512695312
r_  generation:  0.18277597427368164
local_output_nid generation:  0.00828099250793457
local_in_edges_tensor generation:  0.010289192199707031
mini_batch_src_global generation:  0.02312493324279785
r_  generation:  0.18322324752807617
local_output_nid generation:  0.008096694946289062
local_in_edges_tensor generation:  0.011021614074707031
mini_batch_src_global generation:  0.023232460021972656
r_  generation:  0.18220043182373047
local_output_nid generation:  0.007869720458984375
local_in_edges_tensor generation:  0.01027822494506836
mini_batch_src_global generation:  0.02150726318359375
r_  generation:  0.17057394981384277
local_output_nid generation:  0.008306741714477539
local_in_edges_tensor generation:  0.011598348617553711
mini_batch_src_global generation:  0.023838043212890625
r_  generation:  0.18355393409729004
local_output_nid generation:  0.008393526077270508
local_in_edges_tensor generation:  0.011497974395751953
mini_batch_src_global generation:  0.02303934097290039
r_  generation:  0.18290400505065918
local_output_nid generation:  0.008043050765991211
local_in_edges_tensor generation:  0.009883403778076172
mini_batch_src_global generation:  0.02281045913696289
r_  generation:  0.1764519214630127
local_output_nid generation:  0.010849714279174805
local_in_edges_tensor generation:  0.010963678359985352
mini_batch_src_global generation:  0.023066997528076172
r_  generation:  0.17189812660217285
local_output_nid generation:  0.008248329162597656
local_in_edges_tensor generation:  0.012937784194946289
mini_batch_src_global generation:  0.02407979965209961
r_  generation:  0.18165206909179688
----------------------check_connections_block total spend ----------------------------- 8.378570795059204
generate_one_block  0.23831939697265625
generate_one_block  0.26253795623779297
generate_one_block  0.24413347244262695
generate_one_block  0.22140908241271973
generate_one_block  0.2247328758239746
generate_one_block  0.23556113243103027
generate_one_block  0.23345184326171875
generate_one_block  0.2320094108581543
generate_one_block  0.23215055465698242
generate_one_block  0.22388434410095215
generate_one_block  0.24151039123535156
generate_one_block  0.23091888427734375
generate_one_block  0.22432732582092285
generate_one_block  0.2269277572631836
generate_one_block  0.23206424713134766
generate_one_block  0.2334134578704834
generate_one_block  0.2469959259033203
generate_one_block  0.2391204833984375
generate_one_block  0.24129319190979004
generate_one_block  0.22619891166687012
generate_one_block  0.22810053825378418
generate_one_block  0.23010802268981934
generate_one_block  0.23316311836242676
generate_one_block  0.23461270332336426
generate_one_block  0.23607468605041504
generate_one_block  0.22841906547546387
generate_one_block  0.21735310554504395
generate_one_block  0.2316446304321289
generate_one_block  0.23685431480407715
generate_one_block  0.22360968589782715
generate_one_block  0.2164754867553711
generate_one_block  0.22856426239013672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0634450912475586
gen group dst list time:  0.11190581321716309
time for parepare:  0.02056264877319336
local_output_nid generation:  0.02362060546875
local_in_edges_tensor generation:  0.08770585060119629
mini_batch_src_global generation:  0.0397639274597168
r_  generation:  0.4206349849700928
local_output_nid generation:  0.030050039291381836
local_in_edges_tensor generation:  0.04491901397705078
mini_batch_src_global generation:  0.04937171936035156
r_  generation:  0.4345850944519043
local_output_nid generation:  0.03062129020690918
local_in_edges_tensor generation:  0.038713932037353516
mini_batch_src_global generation:  0.05022573471069336
r_  generation:  0.4521942138671875
local_output_nid generation:  0.030162811279296875
local_in_edges_tensor generation:  0.04066586494445801
mini_batch_src_global generation:  0.05489039421081543
r_  generation:  0.4319028854370117
local_output_nid generation:  0.029973983764648438
local_in_edges_tensor generation:  0.03630471229553223
mini_batch_src_global generation:  0.04991292953491211
r_  generation:  0.43165111541748047
local_output_nid generation:  0.029633522033691406
local_in_edges_tensor generation:  0.032906532287597656
mini_batch_src_global generation:  0.05028653144836426
r_  generation:  0.4333484172821045
local_output_nid generation:  0.029438018798828125
local_in_edges_tensor generation:  0.04075169563293457
mini_batch_src_global generation:  0.04992055892944336
r_  generation:  0.4330883026123047
local_output_nid generation:  0.02946019172668457
local_in_edges_tensor generation:  0.03360319137573242
mini_batch_src_global generation:  0.050693511962890625
r_  generation:  0.43805766105651855
local_output_nid generation:  0.02958822250366211
local_in_edges_tensor generation:  0.03689074516296387
mini_batch_src_global generation:  0.05065512657165527
r_  generation:  0.4372892379760742
local_output_nid generation:  0.038347482681274414
local_in_edges_tensor generation:  0.029692649841308594
mini_batch_src_global generation:  0.05010056495666504
r_  generation:  0.43396544456481934
local_output_nid generation:  0.02934861183166504
local_in_edges_tensor generation:  0.029621601104736328
mini_batch_src_global generation:  0.050699472427368164
r_  generation:  0.4381844997406006
local_output_nid generation:  0.029907703399658203
local_in_edges_tensor generation:  0.05213212966918945
mini_batch_src_global generation:  0.0509181022644043
r_  generation:  0.43622326850891113
local_output_nid generation:  0.029271364212036133
local_in_edges_tensor generation:  0.026650667190551758
mini_batch_src_global generation:  0.06508636474609375
r_  generation:  0.4416160583496094
local_output_nid generation:  0.03231096267700195
local_in_edges_tensor generation:  0.03242659568786621
mini_batch_src_global generation:  0.05167531967163086
r_  generation:  0.4391648769378662
local_output_nid generation:  0.029407739639282227
local_in_edges_tensor generation:  0.030532360076904297
mini_batch_src_global generation:  0.05109214782714844
r_  generation:  0.43927478790283203
local_output_nid generation:  0.029001474380493164
local_in_edges_tensor generation:  0.0304262638092041
mini_batch_src_global generation:  0.05071616172790527
r_  generation:  0.4324824810028076
local_output_nid generation:  0.030129671096801758
local_in_edges_tensor generation:  0.030753612518310547
mini_batch_src_global generation:  0.05348658561706543
r_  generation:  0.4459571838378906
local_output_nid generation:  0.029251575469970703
local_in_edges_tensor generation:  0.030826330184936523
mini_batch_src_global generation:  0.050766706466674805
r_  generation:  0.4365825653076172
local_output_nid generation:  0.030304670333862305
local_in_edges_tensor generation:  0.035715341567993164
mini_batch_src_global generation:  0.05168938636779785
r_  generation:  0.44205212593078613
local_output_nid generation:  0.02971625328063965
local_in_edges_tensor generation:  0.02992701530456543
mini_batch_src_global generation:  0.05120229721069336
r_  generation:  0.4406282901763916
local_output_nid generation:  0.029181480407714844
local_in_edges_tensor generation:  0.030519962310791016
mini_batch_src_global generation:  0.05080914497375488
r_  generation:  0.4384033679962158
local_output_nid generation:  0.029433012008666992
local_in_edges_tensor generation:  0.031105518341064453
mini_batch_src_global generation:  0.051070213317871094
r_  generation:  0.44028377532958984
local_output_nid generation:  0.029504776000976562
local_in_edges_tensor generation:  0.04119563102722168
mini_batch_src_global generation:  0.05640387535095215
r_  generation:  0.4574892520904541
local_output_nid generation:  0.03146934509277344
local_in_edges_tensor generation:  0.032932281494140625
mini_batch_src_global generation:  0.05307745933532715
r_  generation:  0.435070276260376
local_output_nid generation:  0.0291287899017334
local_in_edges_tensor generation:  0.030019760131835938
mini_batch_src_global generation:  0.05134272575378418
r_  generation:  0.43984484672546387
local_output_nid generation:  0.029026508331298828
local_in_edges_tensor generation:  0.033632755279541016
mini_batch_src_global generation:  0.05113840103149414
r_  generation:  0.43343114852905273
local_output_nid generation:  0.0290677547454834
local_in_edges_tensor generation:  0.0313417911529541
mini_batch_src_global generation:  0.05075788497924805
r_  generation:  0.43379664421081543
local_output_nid generation:  0.029193639755249023
local_in_edges_tensor generation:  0.030715227127075195
mini_batch_src_global generation:  0.053623199462890625
r_  generation:  0.436748743057251
local_output_nid generation:  0.030244827270507812
local_in_edges_tensor generation:  0.043233633041381836
mini_batch_src_global generation:  0.05117177963256836
r_  generation:  0.44810009002685547
local_output_nid generation:  0.02908945083618164
local_in_edges_tensor generation:  0.029970169067382812
mini_batch_src_global generation:  0.05097341537475586
r_  generation:  0.4345993995666504
local_output_nid generation:  0.02921295166015625
local_in_edges_tensor generation:  0.02738499641418457
mini_batch_src_global generation:  0.05077314376831055
r_  generation:  0.43633365631103516
local_output_nid generation:  0.029140233993530273
local_in_edges_tensor generation:  0.03458404541015625
mini_batch_src_global generation:  0.05084085464477539
r_  generation:  0.44892311096191406
----------------------check_connections_block total spend ----------------------------- 20.924129962921143
generate_one_block  0.6760914325714111
generate_one_block  0.5637068748474121
generate_one_block  0.5541737079620361
generate_one_block  0.5536584854125977
generate_one_block  0.5568809509277344
generate_one_block  0.5543384552001953
generate_one_block  0.5529937744140625
generate_one_block  0.556992769241333
generate_one_block  0.5603480339050293
generate_one_block  0.5658645629882812
generate_one_block  0.5523288249969482
generate_one_block  0.554448127746582
generate_one_block  0.5603334903717041
generate_one_block  0.5542740821838379
generate_one_block  0.5567779541015625
generate_one_block  0.5471897125244141
generate_one_block  0.5526778697967529
generate_one_block  0.5533146858215332
generate_one_block  0.5531916618347168
generate_one_block  0.5610921382904053
generate_one_block  0.56591796875
generate_one_block  0.5710291862487793
generate_one_block  0.5640316009521484
generate_one_block  0.5682389736175537
generate_one_block  0.5542871952056885
generate_one_block  0.5461101531982422
generate_one_block  0.5421919822692871
generate_one_block  0.5673329830169678
generate_one_block  0.5707955360412598
generate_one_block  0.5482003688812256
generate_one_block  0.5450060367584229
generate_one_block  0.5489256381988525
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  29.302700757980347
block generation total time  25.368685483932495
average batch blocks generation time:  0.7927714213728905
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09070730209350586  GigaBytes
Max Memory Allocated: 0.09070730209350586  GigaBytes

torch.Size([148840, 128])
torch.Size([110232, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1678466796875 GB
    Memory Allocated: 19.289541244506836  GigaBytes
Max Memory Allocated: 19.389390468597412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2479248046875 GB
    Memory Allocated: 0.09658479690551758  GigaBytes
Max Memory Allocated: 19.389390468597412  GigaBytes

torch.Size([149093, 128])
torch.Size([110540, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0174560546875 GB
    Memory Allocated: 19.483271598815918  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 0.09582853317260742  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148753, 128])
torch.Size([108653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 18.349283695220947  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 0.09614992141723633  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149091, 128])
torch.Size([109906, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 18.641706466674805  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 0.09584617614746094  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148510, 128])
torch.Size([109345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 18.544081687927246  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 0.09607791900634766  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148522, 128])
torch.Size([109786, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 19.052350521087646  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 0.09596395492553711  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148501, 128])
torch.Size([109858, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 18.78696632385254  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5643310546875 GB
    Memory Allocated: 0.09651041030883789  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149239, 128])
torch.Size([110781, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1131591796875 GB
    Memory Allocated: 19.14189624786377  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1658935546875 GB
    Memory Allocated: 0.09620952606201172  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148796, 128])
torch.Size([110272, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1990966796875 GB
    Memory Allocated: 19.101725578308105  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2010498046875 GB
    Memory Allocated: 0.09603452682495117  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148719, 128])
torch.Size([109477, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2010498046875 GB
    Memory Allocated: 18.7846941947937  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2010498046875 GB
    Memory Allocated: 0.09626245498657227  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148781, 128])
torch.Size([109774, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2010498046875 GB
    Memory Allocated: 19.217554092407227  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.09603738784790039  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148471, 128])
torch.Size([109713, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.05023765563965  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.09557199478149414  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([147855, 128])
torch.Size([108631, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 18.683953762054443  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.09632539749145508  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149191, 128])
torch.Size([109865, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3045654296875 GB
    Memory Allocated: 18.913151741027832  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3065185546875 GB
    Memory Allocated: 0.09624624252319336  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148865, 128])
torch.Size([110120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3065185546875 GB
    Memory Allocated: 19.099894046783447  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3065185546875 GB
    Memory Allocated: 0.0957646369934082  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148933, 128])
torch.Size([108412, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3065185546875 GB
    Memory Allocated: 18.09103488922119  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3065185546875 GB
    Memory Allocated: 0.09615707397460938  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148680, 128])
torch.Size([110123, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3553466796875 GB
    Memory Allocated: 19.031349658966064  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09613704681396484  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148748, 128])
torch.Size([109489, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.0072979927063  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09630060195922852  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149053, 128])
torch.Size([109839, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 18.995495319366455  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.0962066650390625  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149072, 128])
torch.Size([110019, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 18.783677577972412  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09601593017578125  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148526, 128])
torch.Size([109523, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 18.94312620162964  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09619522094726562  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148910, 128])
torch.Size([109957, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 18.886967182159424  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09640121459960938  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149140, 128])
torch.Size([110417, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.12614917755127  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09644794464111328  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149150, 128])
torch.Size([110564, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.187933444976807  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09640169143676758  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149035, 128])
torch.Size([110138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.243226528167725  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09607744216918945  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148535, 128])
torch.Size([109506, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.032586574554443  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.0958552360534668  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148761, 128])
torch.Size([109362, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 18.366700172424316  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.0961461067199707  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148617, 128])
torch.Size([109819, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.085103511810303  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09646129608154297  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149104, 128])
torch.Size([110834, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 19.201558113098145  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3572998046875 GB
    Memory Allocated: 0.09627723693847656  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149194, 128])
torch.Size([109658, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3612060546875 GB
    Memory Allocated: 18.74945068359375  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.09578275680541992  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148491, 128])
torch.Size([109278, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 18.52237033843994  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.09607934951782227  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148625, 128])
torch.Size([109250, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 19.008167266845703  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035609401762485504 |0.03389269858598709 |0.6446917057037354 |0.00011738389730453491 |1.287967637181282 |0.013980627059936523 |
----------------------------------------------------------pseudo_mini_loss sum 5.391883850097656
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9114902
Number of first layer input nodes during this epoch:  4761801
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1263570785522461  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025330305099487305
random selection method range initialization spend 0.0051996707916259766
time for parepare:  0.01918315887451172
local_output_nid generation:  0.0013949871063232422
local_in_edges_tensor generation:  0.005145072937011719
mini_batch_src_global generation:  0.0017852783203125
r_  generation:  0.010447502136230469
local_output_nid generation:  0.00167083740234375
local_in_edges_tensor generation:  0.0010714530944824219
mini_batch_src_global generation:  0.0017054080963134766
r_  generation:  0.010042905807495117
local_output_nid generation:  0.0017299652099609375
local_in_edges_tensor generation:  0.0009629726409912109
mini_batch_src_global generation:  0.0011892318725585938
r_  generation:  0.010049819946289062
local_output_nid generation:  0.001718282699584961
local_in_edges_tensor generation:  0.0009551048278808594
mini_batch_src_global generation:  0.0012054443359375
r_  generation:  0.009891271591186523
local_output_nid generation:  0.0016796588897705078
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.01003885269165039
local_output_nid generation:  0.0017070770263671875
local_in_edges_tensor generation:  0.0008985996246337891
mini_batch_src_global generation:  0.001191854476928711
r_  generation:  0.009899616241455078
local_output_nid generation:  0.0016796588897705078
local_in_edges_tensor generation:  0.0008859634399414062
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.009877681732177734
local_output_nid generation:  0.0016701221466064453
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0011081695556640625
r_  generation:  0.009817838668823242
local_output_nid generation:  0.0016674995422363281
local_in_edges_tensor generation:  0.0009114742279052734
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.009711265563964844
local_output_nid generation:  0.0016825199127197266
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.010223150253295898
local_output_nid generation:  0.0016775131225585938
local_in_edges_tensor generation:  0.0009064674377441406
mini_batch_src_global generation:  0.0011780261993408203
r_  generation:  0.010313987731933594
local_output_nid generation:  0.0016829967498779297
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0012371540069580078
r_  generation:  0.01025390625
local_output_nid generation:  0.001695871353149414
local_in_edges_tensor generation:  0.0008697509765625
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.009457826614379883
local_output_nid generation:  0.0017125606536865234
local_in_edges_tensor generation:  0.0008525848388671875
mini_batch_src_global generation:  0.001058816909790039
r_  generation:  0.00958251953125
local_output_nid generation:  0.0016841888427734375
local_in_edges_tensor generation:  0.0008726119995117188
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010483503341674805
local_output_nid generation:  0.001695394515991211
local_in_edges_tensor generation:  0.0008652210235595703
mini_batch_src_global generation:  0.0010857582092285156
r_  generation:  0.00973367691040039
local_output_nid generation:  0.0016813278198242188
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.0010869503021240234
r_  generation:  0.00980234146118164
local_output_nid generation:  0.001684427261352539
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.010195732116699219
local_output_nid generation:  0.0016875267028808594
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0011758804321289062
r_  generation:  0.010452985763549805
local_output_nid generation:  0.001708984375
local_in_edges_tensor generation:  0.0009038448333740234
mini_batch_src_global generation:  0.0011548995971679688
r_  generation:  0.010183572769165039
local_output_nid generation:  0.0016946792602539062
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0011315345764160156
r_  generation:  0.010149240493774414
local_output_nid generation:  0.0016982555389404297
local_in_edges_tensor generation:  0.0008890628814697266
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010646343231201172
local_output_nid generation:  0.0016980171203613281
local_in_edges_tensor generation:  0.0009124279022216797
mini_batch_src_global generation:  0.0011875629425048828
r_  generation:  0.010478496551513672
local_output_nid generation:  0.0016994476318359375
local_in_edges_tensor generation:  0.0008854866027832031
mini_batch_src_global generation:  0.0011801719665527344
r_  generation:  0.01004934310913086
local_output_nid generation:  0.0016951560974121094
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0011019706726074219
r_  generation:  0.010095357894897461
local_output_nid generation:  0.0016787052154541016
local_in_edges_tensor generation:  0.0008783340454101562
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.010192155838012695
local_output_nid generation:  0.0016896724700927734
local_in_edges_tensor generation:  0.000881195068359375
mini_batch_src_global generation:  0.0011506080627441406
r_  generation:  0.010418176651000977
local_output_nid generation:  0.0016880035400390625
local_in_edges_tensor generation:  0.0008347034454345703
mini_batch_src_global generation:  0.0011153221130371094
r_  generation:  0.010099172592163086
local_output_nid generation:  0.0016798973083496094
local_in_edges_tensor generation:  0.0008988380432128906
mini_batch_src_global generation:  0.001226663589477539
r_  generation:  0.010154962539672852
local_output_nid generation:  0.0016987323760986328
local_in_edges_tensor generation:  0.0008716583251953125
mini_batch_src_global generation:  0.0011403560638427734
r_  generation:  0.010239601135253906
local_output_nid generation:  0.001705169677734375
local_in_edges_tensor generation:  0.0008797645568847656
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.010267019271850586
local_output_nid generation:  0.0016851425170898438
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010137557983398438
----------------------check_connections_block total spend ----------------------------- 0.5606462955474854
generate_one_block  0.024382591247558594
generate_one_block  0.021064043045043945
generate_one_block  0.01985621452331543
generate_one_block  0.018757104873657227
generate_one_block  0.020273208618164062
generate_one_block  0.018254995346069336
generate_one_block  0.018114328384399414
generate_one_block  0.01791858673095703
generate_one_block  0.0179750919342041
generate_one_block  0.01859426498413086
generate_one_block  0.01885080337524414
generate_one_block  0.0186154842376709
generate_one_block  0.017052173614501953
generate_one_block  0.017334938049316406
generate_one_block  0.019058942794799805
generate_one_block  0.01747584342956543
generate_one_block  0.017958641052246094
generate_one_block  0.018513202667236328
generate_one_block  0.01887345314025879
generate_one_block  0.018271207809448242
generate_one_block  0.018458843231201172
generate_one_block  0.018904685974121094
generate_one_block  0.019048452377319336
generate_one_block  0.018151044845581055
generate_one_block  0.01805901527404785
generate_one_block  0.01836085319519043
generate_one_block  0.01855635643005371
generate_one_block  0.018008947372436523
generate_one_block  0.018267393112182617
generate_one_block  0.018290042877197266
generate_one_block  0.018504619598388672
generate_one_block  0.018117904663085938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038177490234375
gen group dst list time:  0.021539926528930664
time for parepare:  0.021762371063232422
local_output_nid generation:  0.006104946136474609
local_in_edges_tensor generation:  0.013242483139038086
mini_batch_src_global generation:  0.01593303680419922
r_  generation:  0.15681099891662598
local_output_nid generation:  0.008831262588500977
local_in_edges_tensor generation:  0.011252880096435547
mini_batch_src_global generation:  0.0204470157623291
r_  generation:  0.16318702697753906
local_output_nid generation:  0.009520292282104492
local_in_edges_tensor generation:  0.032636404037475586
mini_batch_src_global generation:  0.020037412643432617
r_  generation:  0.1764543056488037
local_output_nid generation:  0.009375333786010742
local_in_edges_tensor generation:  0.011874198913574219
mini_batch_src_global generation:  0.020353317260742188
r_  generation:  0.17256832122802734
local_output_nid generation:  0.009477853775024414
local_in_edges_tensor generation:  0.012264251708984375
mini_batch_src_global generation:  0.022080659866333008
r_  generation:  0.1835179328918457
local_output_nid generation:  0.008807897567749023
local_in_edges_tensor generation:  0.01045083999633789
mini_batch_src_global generation:  0.02185511589050293
r_  generation:  0.1762526035308838
local_output_nid generation:  0.008689641952514648
local_in_edges_tensor generation:  0.010516166687011719
mini_batch_src_global generation:  0.022061824798583984
r_  generation:  0.1765599250793457
local_output_nid generation:  0.008701562881469727
local_in_edges_tensor generation:  0.010206460952758789
mini_batch_src_global generation:  0.02184772491455078
r_  generation:  0.1744852066040039
local_output_nid generation:  0.008884668350219727
local_in_edges_tensor generation:  0.008917570114135742
mini_batch_src_global generation:  0.021990537643432617
r_  generation:  0.17449045181274414
local_output_nid generation:  0.009380578994750977
local_in_edges_tensor generation:  0.009680986404418945
mini_batch_src_global generation:  0.022385835647583008
r_  generation:  0.18343544006347656
local_output_nid generation:  0.009642839431762695
local_in_edges_tensor generation:  0.012200117111206055
mini_batch_src_global generation:  0.023114442825317383
r_  generation:  0.18394041061401367
local_output_nid generation:  0.00937962532043457
local_in_edges_tensor generation:  0.010595560073852539
mini_batch_src_global generation:  0.02275872230529785
r_  generation:  0.18011903762817383
local_output_nid generation:  0.008814811706542969
local_in_edges_tensor generation:  0.008403301239013672
mini_batch_src_global generation:  0.02086329460144043
r_  generation:  0.1658947467803955
local_output_nid generation:  0.008837461471557617
local_in_edges_tensor generation:  0.0086669921875
mini_batch_src_global generation:  0.021173954010009766
r_  generation:  0.1705176830291748
local_output_nid generation:  0.009593009948730469
local_in_edges_tensor generation:  0.010647296905517578
mini_batch_src_global generation:  0.023608922958374023
r_  generation:  0.19341015815734863
local_output_nid generation:  0.009014368057250977
local_in_edges_tensor generation:  0.009022235870361328
mini_batch_src_global generation:  0.02172565460205078
r_  generation:  0.1708841323852539
local_output_nid generation:  0.009177684783935547
local_in_edges_tensor generation:  0.008942842483520508
mini_batch_src_global generation:  0.022182464599609375
r_  generation:  0.18172931671142578
local_output_nid generation:  0.00946044921875
local_in_edges_tensor generation:  0.013463497161865234
mini_batch_src_global generation:  0.02273416519165039
r_  generation:  0.18111133575439453
local_output_nid generation:  0.009627342224121094
local_in_edges_tensor generation:  0.012341499328613281
mini_batch_src_global generation:  0.02505779266357422
r_  generation:  0.19030046463012695
local_output_nid generation:  0.009043693542480469
local_in_edges_tensor generation:  0.010582923889160156
mini_batch_src_global generation:  0.022930383682250977
r_  generation:  0.18047761917114258
local_output_nid generation:  0.008975028991699219
local_in_edges_tensor generation:  0.012162923812866211
mini_batch_src_global generation:  0.023090839385986328
r_  generation:  0.18398022651672363
local_output_nid generation:  0.009224176406860352
local_in_edges_tensor generation:  0.010744810104370117
mini_batch_src_global generation:  0.02454066276550293
r_  generation:  0.1861555576324463
local_output_nid generation:  0.009184122085571289
local_in_edges_tensor generation:  0.01062154769897461
mini_batch_src_global generation:  0.023958206176757812
r_  generation:  0.1894068717956543
local_output_nid generation:  0.008829355239868164
local_in_edges_tensor generation:  0.00941920280456543
mini_batch_src_global generation:  0.023297786712646484
r_  generation:  0.18011975288391113
local_output_nid generation:  0.008821964263916016
local_in_edges_tensor generation:  0.009125232696533203
mini_batch_src_global generation:  0.023772239685058594
r_  generation:  0.180128812789917
local_output_nid generation:  0.008948326110839844
local_in_edges_tensor generation:  0.012055635452270508
mini_batch_src_global generation:  0.0227353572845459
r_  generation:  0.18340539932250977
local_output_nid generation:  0.00907754898071289
local_in_edges_tensor generation:  0.012116432189941406
mini_batch_src_global generation:  0.023176193237304688
r_  generation:  0.18335747718811035
local_output_nid generation:  0.008779764175415039
local_in_edges_tensor generation:  0.010381460189819336
mini_batch_src_global generation:  0.022541522979736328
r_  generation:  0.1812589168548584
local_output_nid generation:  0.009039640426635742
local_in_edges_tensor generation:  0.01058197021484375
mini_batch_src_global generation:  0.024300813674926758
r_  generation:  0.18822908401489258
local_output_nid generation:  0.00893402099609375
local_in_edges_tensor generation:  0.012549161911010742
mini_batch_src_global generation:  0.02305912971496582
r_  generation:  0.18764400482177734
local_output_nid generation:  0.008996725082397461
local_in_edges_tensor generation:  0.012397289276123047
mini_batch_src_global generation:  0.023424625396728516
r_  generation:  0.1862328052520752
local_output_nid generation:  0.008952856063842773
local_in_edges_tensor generation:  0.009323358535766602
mini_batch_src_global generation:  0.022243022918701172
r_  generation:  0.17738723754882812
----------------------check_connections_block total spend ----------------------------- 8.408034563064575
generate_one_block  0.24777793884277344
generate_one_block  0.23648881912231445
generate_one_block  0.25348877906799316
generate_one_block  0.24953365325927734
generate_one_block  0.2836005687713623
generate_one_block  0.24630212783813477
generate_one_block  0.24262547492980957
generate_one_block  0.23825979232788086
generate_one_block  0.24530744552612305
generate_one_block  0.25498461723327637
generate_one_block  0.25525546073913574
generate_one_block  0.2427206039428711
generate_one_block  0.22197246551513672
generate_one_block  0.225813627243042
generate_one_block  0.2565586566925049
generate_one_block  0.23062586784362793
generate_one_block  0.24023079872131348
generate_one_block  0.2491927146911621
generate_one_block  0.2624855041503906
generate_one_block  0.250382661819458
generate_one_block  0.24972844123840332
generate_one_block  0.25693845748901367
generate_one_block  0.2554659843444824
generate_one_block  0.2377307415008545
generate_one_block  0.24370646476745605
generate_one_block  0.24904346466064453
generate_one_block  0.24831056594848633
generate_one_block  0.24469494819641113
generate_one_block  0.2490835189819336
generate_one_block  0.25327277183532715
generate_one_block  0.2545461654663086
generate_one_block  0.2362060546875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04358649253845215
gen group dst list time:  0.10808563232421875
time for parepare:  0.017720699310302734
local_output_nid generation:  0.025269269943237305
local_in_edges_tensor generation:  0.05319547653198242
mini_batch_src_global generation:  0.04086709022521973
r_  generation:  0.41109347343444824
local_output_nid generation:  0.030590534210205078
local_in_edges_tensor generation:  0.04152321815490723
mini_batch_src_global generation:  0.04906892776489258
r_  generation:  0.4120142459869385
local_output_nid generation:  0.029469013214111328
local_in_edges_tensor generation:  0.034570932388305664
mini_batch_src_global generation:  0.04909777641296387
r_  generation:  0.422351598739624
local_output_nid generation:  0.029021024703979492
local_in_edges_tensor generation:  0.030804157257080078
mini_batch_src_global generation:  0.0489649772644043
r_  generation:  0.4228084087371826
local_output_nid generation:  0.028905868530273438
local_in_edges_tensor generation:  0.030756235122680664
mini_batch_src_global generation:  0.050252437591552734
r_  generation:  0.43133091926574707
local_output_nid generation:  0.029027700424194336
local_in_edges_tensor generation:  0.0274202823638916
mini_batch_src_global generation:  0.05029749870300293
r_  generation:  0.4327418804168701
local_output_nid generation:  0.02901315689086914
local_in_edges_tensor generation:  0.027524232864379883
mini_batch_src_global generation:  0.049834251403808594
r_  generation:  0.4297499656677246
local_output_nid generation:  0.028634071350097656
local_in_edges_tensor generation:  0.027325868606567383
mini_batch_src_global generation:  0.04987692832946777
r_  generation:  0.42900824546813965
local_output_nid generation:  0.02886509895324707
local_in_edges_tensor generation:  0.030986547470092773
mini_batch_src_global generation:  0.04976248741149902
r_  generation:  0.4310014247894287
local_output_nid generation:  0.02906179428100586
local_in_edges_tensor generation:  0.0352482795715332
mini_batch_src_global generation:  0.050527095794677734
r_  generation:  0.4331014156341553
local_output_nid generation:  0.029352188110351562
local_in_edges_tensor generation:  0.03164029121398926
mini_batch_src_global generation:  0.05057334899902344
r_  generation:  0.43650341033935547
local_output_nid generation:  0.029326200485229492
local_in_edges_tensor generation:  0.034551382064819336
mini_batch_src_global generation:  0.05024075508117676
r_  generation:  0.43512511253356934
local_output_nid generation:  0.028645753860473633
local_in_edges_tensor generation:  0.026906967163085938
mini_batch_src_global generation:  0.04974794387817383
r_  generation:  0.4219815731048584
local_output_nid generation:  0.028769254684448242
local_in_edges_tensor generation:  0.02779078483581543
mini_batch_src_global generation:  0.04982399940490723
r_  generation:  0.42822933197021484
local_output_nid generation:  0.02953362464904785
local_in_edges_tensor generation:  0.037859201431274414
mini_batch_src_global generation:  0.05009126663208008
r_  generation:  0.43573975563049316
local_output_nid generation:  0.02877497673034668
local_in_edges_tensor generation:  0.03157997131347656
mini_batch_src_global generation:  0.05039668083190918
r_  generation:  0.43018126487731934
local_output_nid generation:  0.02908039093017578
local_in_edges_tensor generation:  0.030768632888793945
mini_batch_src_global generation:  0.050473928451538086
r_  generation:  0.4337787628173828
local_output_nid generation:  0.02918529510498047
local_in_edges_tensor generation:  0.031278371810913086
mini_batch_src_global generation:  0.05070972442626953
r_  generation:  0.4337925910949707
local_output_nid generation:  0.029395341873168945
local_in_edges_tensor generation:  0.03473472595214844
mini_batch_src_global generation:  0.04985761642456055
r_  generation:  0.43506526947021484
local_output_nid generation:  0.0295259952545166
local_in_edges_tensor generation:  0.027632713317871094
mini_batch_src_global generation:  0.050438642501831055
r_  generation:  0.43361639976501465
local_output_nid generation:  0.028964757919311523
local_in_edges_tensor generation:  0.034261226654052734
mini_batch_src_global generation:  0.04985213279724121
r_  generation:  0.4345059394836426
local_output_nid generation:  0.028814315795898438
local_in_edges_tensor generation:  0.03064250946044922
mini_batch_src_global generation:  0.05063509941101074
r_  generation:  0.4321417808532715
local_output_nid generation:  0.029261112213134766
local_in_edges_tensor generation:  0.0313420295715332
mini_batch_src_global generation:  0.053252220153808594
r_  generation:  0.43785572052001953
local_output_nid generation:  0.029158592224121094
local_in_edges_tensor generation:  0.030376434326171875
mini_batch_src_global generation:  0.050415754318237305
r_  generation:  0.43122196197509766
local_output_nid generation:  0.028933048248291016
local_in_edges_tensor generation:  0.02717876434326172
mini_batch_src_global generation:  0.05008363723754883
r_  generation:  0.43048715591430664
local_output_nid generation:  0.028863191604614258
local_in_edges_tensor generation:  0.030826807022094727
mini_batch_src_global generation:  0.04996299743652344
r_  generation:  0.4284331798553467
local_output_nid generation:  0.02897024154663086
local_in_edges_tensor generation:  0.02705240249633789
mini_batch_src_global generation:  0.049704790115356445
r_  generation:  0.4269833564758301
local_output_nid generation:  0.028705358505249023
local_in_edges_tensor generation:  0.03412318229675293
mini_batch_src_global generation:  0.052733421325683594
r_  generation:  0.4291212558746338
local_output_nid generation:  0.029059410095214844
local_in_edges_tensor generation:  0.035100698471069336
mini_batch_src_global generation:  0.05016279220581055
r_  generation:  0.43143391609191895
local_output_nid generation:  0.028972625732421875
local_in_edges_tensor generation:  0.030507564544677734
mini_batch_src_global generation:  0.05013704299926758
r_  generation:  0.4339165687561035
local_output_nid generation:  0.02921915054321289
local_in_edges_tensor generation:  0.0346379280090332
mini_batch_src_global generation:  0.050589799880981445
r_  generation:  0.43845629692077637
local_output_nid generation:  0.02907562255859375
local_in_edges_tensor generation:  0.027287960052490234
mini_batch_src_global generation:  0.05081486701965332
r_  generation:  0.4356689453125
----------------------check_connections_block total spend ----------------------------- 20.37336540222168
generate_one_block  0.5771386623382568
generate_one_block  0.583197832107544
generate_one_block  0.5844311714172363
generate_one_block  0.5799217224121094
generate_one_block  0.666018009185791
generate_one_block  0.5742039680480957
generate_one_block  0.5773305892944336
generate_one_block  0.5757322311401367
generate_one_block  0.5767667293548584
generate_one_block  0.5800526142120361
generate_one_block  0.5896086692810059
generate_one_block  0.5816748142242432
generate_one_block  0.5601089000701904
generate_one_block  0.5690059661865234
generate_one_block  0.5888895988464355
generate_one_block  0.5674681663513184
generate_one_block  0.5854249000549316
generate_one_block  0.5895075798034668
generate_one_block  0.5914106369018555
generate_one_block  0.5722901821136475
generate_one_block  0.5760362148284912
generate_one_block  0.5794723033905029
generate_one_block  0.5928432941436768
generate_one_block  0.569965124130249
generate_one_block  0.594613790512085
generate_one_block  0.5771219730377197
generate_one_block  0.5764155387878418
generate_one_block  0.5763990879058838
generate_one_block  0.5900042057037354
generate_one_block  0.5855586528778076
generate_one_block  0.59126877784729
generate_one_block  0.5705549716949463
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.1263570785522461  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

connection checking time:  28.781399965286255
block generation total time  26.562772035598755
average batch blocks generation time:  0.8300866261124611
block dataloader generation time/epoch 58.76248908042908
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10648679733276367  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148746, 128])
torch.Size([109465, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 18.783488750457764  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10634851455688477  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148667, 128])
torch.Size([109076, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 18.52115297317505  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 0.10663604736328125  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148570, 128])
torch.Size([109917, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3651123046875 GB
    Memory Allocated: 19.286552906036377  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2440185546875 GB
    Memory Allocated: 0.10650920867919922  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148712, 128])
torch.Size([109920, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6600341796875 GB
    Memory Allocated: 18.798495292663574  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6619873046875 GB
    Memory Allocated: 0.10708856582641602  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149309, 128])
torch.Size([110544, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1483154296875 GB
    Memory Allocated: 19.361531257629395  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 0.10664033889770508  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148903, 128])
torch.Size([109487, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 18.93766498565674  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 0.10645532608032227  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148583, 128])
torch.Size([109409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 18.79552984237671  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 0.10622692108154297  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148306, 128])
torch.Size([108950, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 18.664763927459717  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 0.1065053939819336  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148900, 128])
torch.Size([109411, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 18.5985107421875  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 0.1066899299621582  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148837, 128])
torch.Size([109636, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 19.03886318206787  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2303466796875 GB
    Memory Allocated: 0.1070704460144043  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149329, 128])
torch.Size([111255, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 19.28435468673706  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 0.10683727264404297  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149172, 128])
torch.Size([110626, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 19.02355146408081  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 0.10600614547729492  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148707, 128])
torch.Size([108012, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 17.83344841003418  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 0.10610818862915039  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148549, 128])
torch.Size([108543, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 18.179739475250244  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 0.10702943801879883  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149075, 128])
torch.Size([110525, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8807373046875 GB
    Memory Allocated: 19.43859624862671  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10616540908813477  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148769, 128])
torch.Size([108094, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.1165828704834  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.1065068244934082  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([148729, 128])
torch.Size([109653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.77571964263916  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10684823989868164  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149237, 128])
torch.Size([110722, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.99631404876709  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10706424713134766  GigaBytes
Max Memory Allocated: 19.58211660385132  GigaBytes

torch.Size([149090, 128])
torch.Size([111089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.488726139068604  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10670948028564453  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([149084, 128])
torch.Size([109933, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.89911413192749  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10654783248901367  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148539, 128])
torch.Size([109715, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.05933713912964  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.1065664291381836  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148398, 128])
torch.Size([109612, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.241390705108643  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10718965530395508  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([149487, 128])
torch.Size([111475, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.38237476348877  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10663270950317383  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([149061, 128])
torch.Size([110081, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.690516471862793  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10627889633178711  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148239, 128])
torch.Size([109046, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.828026294708252  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10660791397094727  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148795, 128])
torch.Size([109406, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.917201042175293  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10659313201904297  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148732, 128])
torch.Size([109402, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.99314308166504  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10631465911865234  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148320, 128])
torch.Size([108682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.851491928100586  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10682249069213867  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([149099, 128])
torch.Size([110108, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.06039047241211  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10675239562988281  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148852, 128])
torch.Size([109671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.16990852355957  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10698509216308594  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([149206, 128])
torch.Size([110347, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 19.23863697052002  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 0.10644721984863281  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

torch.Size([148872, 128])
torch.Size([109149, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4256591796875 GB
    Memory Allocated: 18.591976642608643  GigaBytes
Max Memory Allocated: 19.595319747924805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029870979487895966 |0.021954447031021118 |0.6487415283918381 |0.00011756271123886108 |1.1635605916380882 |0.006954669952392578 |
----------------------------------------------------------pseudo_mini_loss sum 3.9290120601654053
Total (block generation + training)time/epoch 118.48846411705017
Training time/epoch 59.72561526298523
Training time without block to device /epoch 59.023072957992554
Training time without total dataloading part /epoch 58.00438451766968
load block tensor time/epoch 0.9558713436126709
block to device time/epoch 0.7025423049926758
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9113771
Number of first layer input nodes during this epoch:  4762874
