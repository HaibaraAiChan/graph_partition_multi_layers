Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648454231.9429352
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0277097225189209
random selection method range initialization spend 0.0065762996673583984
time for parepare:  0.018837690353393555
local_output_nid generation:  0.0021505355834960938
local_in_edges_tensor generation:  0.004804372787475586
mini_batch_src_global generation:  0.002019643783569336
r_  generation:  0.020099163055419922
local_output_nid generation:  0.0028276443481445312
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.002417325973510742
r_  generation:  0.021126747131347656
local_output_nid generation:  0.002892017364501953
local_in_edges_tensor generation:  0.0016820430755615234
mini_batch_src_global generation:  0.0016303062438964844
r_  generation:  0.021146774291992188
local_output_nid generation:  0.0030541419982910156
local_in_edges_tensor generation:  0.0016989707946777344
mini_batch_src_global generation:  0.0016901493072509766
r_  generation:  0.021784543991088867
local_output_nid generation:  0.0029888153076171875
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.001682281494140625
r_  generation:  0.022120952606201172
local_output_nid generation:  0.0029549598693847656
local_in_edges_tensor generation:  0.0015590190887451172
mini_batch_src_global generation:  0.001739501953125
r_  generation:  0.02166152000427246
local_output_nid generation:  0.002963542938232422
local_in_edges_tensor generation:  0.0015399456024169922
mini_batch_src_global generation:  0.0016684532165527344
r_  generation:  0.021734237670898438
local_output_nid generation:  0.002969503402709961
local_in_edges_tensor generation:  0.0016200542449951172
mini_batch_src_global generation:  0.0017595291137695312
r_  generation:  0.02234792709350586
local_output_nid generation:  0.0029342174530029297
local_in_edges_tensor generation:  0.0015139579772949219
mini_batch_src_global generation:  0.0017085075378417969
r_  generation:  0.02183246612548828
local_output_nid generation:  0.0030317306518554688
local_in_edges_tensor generation:  0.001604318618774414
mini_batch_src_global generation:  0.0017790794372558594
r_  generation:  0.023052692413330078
local_output_nid generation:  0.0029807090759277344
local_in_edges_tensor generation:  0.0015261173248291016
mini_batch_src_global generation:  0.0017807483673095703
r_  generation:  0.021890878677368164
local_output_nid generation:  0.002958536148071289
local_in_edges_tensor generation:  0.0015685558319091797
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.021938085556030273
local_output_nid generation:  0.002964019775390625
local_in_edges_tensor generation:  0.0015583038330078125
mini_batch_src_global generation:  0.0017943382263183594
r_  generation:  0.022447824478149414
local_output_nid generation:  0.0030417442321777344
local_in_edges_tensor generation:  0.0015330314636230469
mini_batch_src_global generation:  0.0017991065979003906
r_  generation:  0.022197246551513672
local_output_nid generation:  0.0030078887939453125
local_in_edges_tensor generation:  0.001516580581665039
mini_batch_src_global generation:  0.0017812252044677734
r_  generation:  0.02154541015625
local_output_nid generation:  0.0030031204223632812
local_in_edges_tensor generation:  0.0015442371368408203
mini_batch_src_global generation:  0.0018062591552734375
r_  generation:  0.02191019058227539
----------------------check_connections_block total spend ----------------------------- 0.5600402355194092
generate_one_block  0.030164003372192383
generate_one_block  0.032593488693237305
generate_one_block  0.03473615646362305
generate_one_block  0.03305625915527344
generate_one_block  0.032639265060424805
generate_one_block  0.031381845474243164
generate_one_block  0.031020641326904297
generate_one_block  0.032045602798461914
generate_one_block  0.03180861473083496
generate_one_block  0.03314614295959473
generate_one_block  0.031220436096191406
generate_one_block  0.031148672103881836
generate_one_block  0.03157329559326172
generate_one_block  0.030704259872436523
generate_one_block  0.030580997467041016
generate_one_block  0.03099966049194336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03744173049926758
gen group dst list time:  0.020725727081298828
time for parepare:  0.019576549530029297
local_output_nid generation:  0.009147167205810547
local_in_edges_tensor generation:  0.01929783821105957
mini_batch_src_global generation:  0.02115654945373535
r_  generation:  0.2108442783355713
local_output_nid generation:  0.015134572982788086
local_in_edges_tensor generation:  0.02222275733947754
mini_batch_src_global generation:  0.027064085006713867
r_  generation:  0.22101378440856934
local_output_nid generation:  0.015164375305175781
local_in_edges_tensor generation:  0.021148204803466797
mini_batch_src_global generation:  0.02655172348022461
r_  generation:  0.23227834701538086
local_output_nid generation:  0.015272855758666992
local_in_edges_tensor generation:  0.016964197158813477
mini_batch_src_global generation:  0.028273344039916992
r_  generation:  0.23769140243530273
local_output_nid generation:  0.015258550643920898
local_in_edges_tensor generation:  0.0194852352142334
mini_batch_src_global generation:  0.02881336212158203
r_  generation:  0.24121928215026855
local_output_nid generation:  0.015245437622070312
local_in_edges_tensor generation:  0.016705751419067383
mini_batch_src_global generation:  0.028920650482177734
r_  generation:  0.22884702682495117
local_output_nid generation:  0.014955282211303711
local_in_edges_tensor generation:  0.018469810485839844
mini_batch_src_global generation:  0.028777360916137695
r_  generation:  0.2315380573272705
local_output_nid generation:  0.015254974365234375
local_in_edges_tensor generation:  0.018924474716186523
mini_batch_src_global generation:  0.03185725212097168
r_  generation:  0.2386014461517334
local_output_nid generation:  0.015250444412231445
local_in_edges_tensor generation:  0.01642608642578125
mini_batch_src_global generation:  0.029590129852294922
r_  generation:  0.23328232765197754
local_output_nid generation:  0.015438556671142578
local_in_edges_tensor generation:  0.01690387725830078
mini_batch_src_global generation:  0.030167579650878906
r_  generation:  0.24410223960876465
local_output_nid generation:  0.015190601348876953
local_in_edges_tensor generation:  0.01858663558959961
mini_batch_src_global generation:  0.030031204223632812
r_  generation:  0.23604607582092285
local_output_nid generation:  0.01809525489807129
local_in_edges_tensor generation:  0.014958381652832031
mini_batch_src_global generation:  0.031644582748413086
r_  generation:  0.23638653755187988
local_output_nid generation:  0.014814138412475586
local_in_edges_tensor generation:  0.026150941848754883
mini_batch_src_global generation:  0.030084848403930664
r_  generation:  0.25101375579833984
local_output_nid generation:  0.01537322998046875
local_in_edges_tensor generation:  0.016577482223510742
mini_batch_src_global generation:  0.03165626525878906
r_  generation:  0.23550963401794434
local_output_nid generation:  0.013264656066894531
local_in_edges_tensor generation:  0.017946958541870117
mini_batch_src_global generation:  0.029468774795532227
r_  generation:  0.2317655086517334
local_output_nid generation:  0.013239145278930664
local_in_edges_tensor generation:  0.0169525146484375
mini_batch_src_global generation:  0.029251575469970703
r_  generation:  0.23489022254943848
----------------------check_connections_block total spend ----------------------------- 5.589751482009888
generate_one_block  0.3066115379333496
generate_one_block  0.3083829879760742
generate_one_block  0.3141746520996094
generate_one_block  0.3199310302734375
generate_one_block  0.3291127681732178
generate_one_block  0.3039233684539795
generate_one_block  0.29903507232666016
generate_one_block  0.3361048698425293
generate_one_block  0.3061068058013916
generate_one_block  0.3187577724456787
generate_one_block  0.30701303482055664
generate_one_block  0.30194616317749023
generate_one_block  0.34723496437072754
generate_one_block  0.33367061614990234
generate_one_block  0.30782437324523926
generate_one_block  0.30854344367980957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06254863739013672
gen group dst list time:  0.06988525390625
time for parepare:  0.018819808959960938
local_output_nid generation:  0.02597641944885254
local_in_edges_tensor generation:  0.05170416831970215
mini_batch_src_global generation:  0.04296278953552246
r_  generation:  0.442108154296875
local_output_nid generation:  0.03196144104003906
local_in_edges_tensor generation:  0.04908418655395508
mini_batch_src_global generation:  0.05195021629333496
r_  generation:  0.4482424259185791
local_output_nid generation:  0.03136873245239258
local_in_edges_tensor generation:  0.049456119537353516
mini_batch_src_global generation:  0.0504755973815918
r_  generation:  0.45768260955810547
local_output_nid generation:  0.0312800407409668
local_in_edges_tensor generation:  0.037724971771240234
mini_batch_src_global generation:  0.05366373062133789
r_  generation:  0.4558863639831543
local_output_nid generation:  0.03113079071044922
local_in_edges_tensor generation:  0.03754615783691406
mini_batch_src_global generation:  0.05266547203063965
r_  generation:  0.478165864944458
local_output_nid generation:  0.03099370002746582
local_in_edges_tensor generation:  0.03349018096923828
mini_batch_src_global generation:  0.053731679916381836
r_  generation:  0.4632291793823242
local_output_nid generation:  0.03261375427246094
local_in_edges_tensor generation:  0.0422513484954834
mini_batch_src_global generation:  0.07456398010253906
r_  generation:  0.4778311252593994
local_output_nid generation:  0.03520536422729492
local_in_edges_tensor generation:  0.0420839786529541
mini_batch_src_global generation:  0.054590702056884766
r_  generation:  0.4624354839324951
local_output_nid generation:  0.032674312591552734
local_in_edges_tensor generation:  0.04556393623352051
mini_batch_src_global generation:  0.0521547794342041
r_  generation:  0.48441410064697266
local_output_nid generation:  0.03362870216369629
local_in_edges_tensor generation:  0.03341412544250488
mini_batch_src_global generation:  0.05335354804992676
r_  generation:  0.46347618103027344
local_output_nid generation:  0.032671451568603516
local_in_edges_tensor generation:  0.054440975189208984
mini_batch_src_global generation:  0.05339312553405762
r_  generation:  0.4658670425415039
local_output_nid generation:  0.03258824348449707
local_in_edges_tensor generation:  0.029540300369262695
mini_batch_src_global generation:  0.053803205490112305
r_  generation:  0.461108922958374
local_output_nid generation:  0.032715797424316406
local_in_edges_tensor generation:  0.034075260162353516
mini_batch_src_global generation:  0.052880287170410156
r_  generation:  0.465423583984375
local_output_nid generation:  0.03242135047912598
local_in_edges_tensor generation:  0.033004045486450195
mini_batch_src_global generation:  0.05359315872192383
r_  generation:  0.4621245861053467
local_output_nid generation:  0.03293013572692871
local_in_edges_tensor generation:  0.029009580612182617
mini_batch_src_global generation:  0.055873870849609375
r_  generation:  0.46746015548706055
local_output_nid generation:  0.033323049545288086
local_in_edges_tensor generation:  0.04225802421569824
mini_batch_src_global generation:  0.05368614196777344
r_  generation:  0.4841737747192383
----------------------check_connections_block total spend ----------------------------- 11.097330331802368
generate_one_block  0.5995938777923584
generate_one_block  0.5890555381774902
generate_one_block  0.5936644077301025
generate_one_block  0.5986275672912598
generate_one_block  0.5935816764831543
generate_one_block  0.576127290725708
generate_one_block  0.6304013729095459
generate_one_block  0.605004072189331
generate_one_block  0.5796718597412109
generate_one_block  0.593822717666626
generate_one_block  0.5936439037322998
generate_one_block  0.5853612422943115
generate_one_block  0.5991919040679932
generate_one_block  0.5838894844055176
generate_one_block  0.5748999118804932
generate_one_block  0.5873990058898926
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  16.687081813812256
block generation total time  14.532309293746948
average batch blocks generation time:  0.9082693308591843
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09108591079711914  GigaBytes
Max Memory Allocated: 0.09108591079711914  GigaBytes

torch.Size([154758, 128])
torch.Size([124361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7576904296875 GB
    Memory Allocated: 12.169848442077637  GigaBytes
Max Memory Allocated: 12.176795959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7694091796875 GB
    Memory Allocated: 0.09230232238769531  GigaBytes
Max Memory Allocated: 12.176795959472656  GigaBytes

torch.Size([154930, 128])
torch.Size([125224, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 12.230592250823975  GigaBytes
Max Memory Allocated: 12.238603591918945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.0927886962890625  GigaBytes
Max Memory Allocated: 12.238603591918945  GigaBytes

torch.Size([155073, 128])
torch.Size([124977, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 12.263926029205322  GigaBytes
Max Memory Allocated: 12.272048950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09262228012084961  GigaBytes
Max Memory Allocated: 12.272048950195312  GigaBytes

torch.Size([155109, 128])
torch.Size([125314, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 12.292371273040771  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09278488159179688  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

torch.Size([155075, 128])
torch.Size([125221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 12.266869068145752  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09230470657348633  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

torch.Size([154951, 128])
torch.Size([124567, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 12.206327438354492  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09259605407714844  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

torch.Size([154666, 128])
torch.Size([124369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 12.195572853088379  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09280776977539062  GigaBytes
Max Memory Allocated: 12.300605773925781  GigaBytes

torch.Size([155358, 128])
torch.Size([125883, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 12.329246520996094  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 0.09267616271972656  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155091, 128])
torch.Size([124852, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 12.22905158996582  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 0.09269571304321289  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155151, 128])
torch.Size([125206, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 12.324020385742188  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 0.09277629852294922  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155071, 128])
torch.Size([125087, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 12.248723983764648  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 0.09235143661499023  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155009, 128])
torch.Size([124733, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 12.229469776153564  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 0.09274005889892578  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155246, 128])
torch.Size([125184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 12.246521472930908  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1365966796875 GB
    Memory Allocated: 0.09223413467407227  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155017, 128])
torch.Size([124090, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1385498046875 GB
    Memory Allocated: 12.18133020401001  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1385498046875 GB
    Memory Allocated: 0.09256458282470703  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155218, 128])
torch.Size([124794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1385498046875 GB
    Memory Allocated: 12.206202983856201  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1385498046875 GB
    Memory Allocated: 0.09236812591552734  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155010, 128])
torch.Size([124478, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.210819244384766  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034668341279029846 |0.042047709226608276 |0.46043699979782104 |0.00011278688907623291 |0.6848219782114029 |0.010652303695678711 |
----------------------------------------------------------pseudo_mini_loss sum 4.40315055847168
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209424
Number of first layer input nodes during this epoch:  2480733
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.11871719360351562  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025872230529785156
random selection method range initialization spend 0.005666494369506836
time for parepare:  0.018525123596191406
local_output_nid generation:  0.002750873565673828
local_in_edges_tensor generation:  0.008685827255249023
mini_batch_src_global generation:  0.002138376235961914
r_  generation:  0.019999980926513672
local_output_nid generation:  0.0034668445587158203
local_in_edges_tensor generation:  0.0017828941345214844
mini_batch_src_global generation:  0.0023844242095947266
r_  generation:  0.020587444305419922
local_output_nid generation:  0.0033512115478515625
local_in_edges_tensor generation:  0.0017290115356445312
mini_batch_src_global generation:  0.0015056133270263672
r_  generation:  0.02224254608154297
local_output_nid generation:  0.0036666393280029297
local_in_edges_tensor generation:  0.0021758079528808594
mini_batch_src_global generation:  0.0016379356384277344
r_  generation:  0.02155590057373047
local_output_nid generation:  0.003385305404663086
local_in_edges_tensor generation:  0.001874685287475586
mini_batch_src_global generation:  0.0015902519226074219
r_  generation:  0.021383285522460938
local_output_nid generation:  0.0034799575805664062
local_in_edges_tensor generation:  0.0017085075378417969
mini_batch_src_global generation:  0.0016851425170898438
r_  generation:  0.021838903427124023
local_output_nid generation:  0.003522157669067383
local_in_edges_tensor generation:  0.0017223358154296875
mini_batch_src_global generation:  0.001745462417602539
r_  generation:  0.02241230010986328
local_output_nid generation:  0.0036292076110839844
local_in_edges_tensor generation:  0.0016984939575195312
mini_batch_src_global generation:  0.0017504692077636719
r_  generation:  0.022095918655395508
local_output_nid generation:  0.0034134387969970703
local_in_edges_tensor generation:  0.0017130374908447266
mini_batch_src_global generation:  0.0018498897552490234
r_  generation:  0.023569822311401367
local_output_nid generation:  0.004590272903442383
local_in_edges_tensor generation:  0.004529714584350586
mini_batch_src_global generation:  0.002862215042114258
r_  generation:  0.022446155548095703
local_output_nid generation:  0.0033986568450927734
local_in_edges_tensor generation:  0.002031087875366211
mini_batch_src_global generation:  0.002240419387817383
r_  generation:  0.023552894592285156
local_output_nid generation:  0.003500223159790039
local_in_edges_tensor generation:  0.0018625259399414062
mini_batch_src_global generation:  0.002033233642578125
r_  generation:  0.024254798889160156
local_output_nid generation:  0.003450632095336914
local_in_edges_tensor generation:  0.0018672943115234375
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.022528648376464844
local_output_nid generation:  0.003482818603515625
local_in_edges_tensor generation:  0.0017554759979248047
mini_batch_src_global generation:  0.0017845630645751953
r_  generation:  0.028884172439575195
local_output_nid generation:  0.0059566497802734375
local_in_edges_tensor generation:  0.0030465126037597656
mini_batch_src_global generation:  0.003313779830932617
r_  generation:  0.04242300987243652
local_output_nid generation:  0.004636526107788086
local_in_edges_tensor generation:  0.0022821426391601562
mini_batch_src_global generation:  0.0025620460510253906
r_  generation:  0.02288198471069336
----------------------check_connections_block total spend ----------------------------- 0.6455023288726807
generate_one_block  0.046262264251708984
generate_one_block  0.03892970085144043
generate_one_block  0.0357813835144043
generate_one_block  0.037017822265625
generate_one_block  0.03841447830200195
generate_one_block  0.04056668281555176
generate_one_block  0.03819632530212402
generate_one_block  0.03680276870727539
generate_one_block  0.03667449951171875
generate_one_block  0.03659343719482422
generate_one_block  0.03806424140930176
generate_one_block  0.03918051719665527
generate_one_block  0.03719830513000488
generate_one_block  0.03624677658081055
generate_one_block  0.03693556785583496
generate_one_block  0.037728071212768555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.048679351806640625
gen group dst list time:  0.019627809524536133
time for parepare:  0.021628379821777344
local_output_nid generation:  0.01082611083984375
local_in_edges_tensor generation:  0.031171083450317383
mini_batch_src_global generation:  0.022084474563598633
r_  generation:  0.21124029159545898
local_output_nid generation:  0.013886451721191406
local_in_edges_tensor generation:  0.021390914916992188
mini_batch_src_global generation:  0.026702404022216797
r_  generation:  0.21878623962402344
local_output_nid generation:  0.013907909393310547
local_in_edges_tensor generation:  0.017758607864379883
mini_batch_src_global generation:  0.02554464340209961
r_  generation:  0.22199010848999023
local_output_nid generation:  0.014609813690185547
local_in_edges_tensor generation:  0.020610570907592773
mini_batch_src_global generation:  0.027302980422973633
r_  generation:  0.23218178749084473
local_output_nid generation:  0.014094114303588867
local_in_edges_tensor generation:  0.01664423942565918
mini_batch_src_global generation:  0.028302907943725586
r_  generation:  0.23583316802978516
local_output_nid generation:  0.013707160949707031
local_in_edges_tensor generation:  0.016019821166992188
mini_batch_src_global generation:  0.028803586959838867
r_  generation:  0.23465347290039062
local_output_nid generation:  0.013751983642578125
local_in_edges_tensor generation:  0.0160520076751709
mini_batch_src_global generation:  0.03087472915649414
r_  generation:  0.2359480857849121
local_output_nid generation:  0.013634443283081055
local_in_edges_tensor generation:  0.014060020446777344
mini_batch_src_global generation:  0.031488895416259766
r_  generation:  0.23656964302062988
local_output_nid generation:  0.013735294342041016
local_in_edges_tensor generation:  0.016168594360351562
mini_batch_src_global generation:  0.029153823852539062
r_  generation:  0.23700737953186035
local_output_nid generation:  0.013703346252441406
local_in_edges_tensor generation:  0.01807689666748047
mini_batch_src_global generation:  0.028980493545532227
r_  generation:  0.23621916770935059
local_output_nid generation:  0.013935089111328125
local_in_edges_tensor generation:  0.018153667449951172
mini_batch_src_global generation:  0.029728412628173828
r_  generation:  0.2449626922607422
local_output_nid generation:  0.014065980911254883
local_in_edges_tensor generation:  0.018805265426635742
mini_batch_src_global generation:  0.03057551383972168
r_  generation:  0.2486429214477539
local_output_nid generation:  0.01642465591430664
local_in_edges_tensor generation:  0.014051437377929688
mini_batch_src_global generation:  0.030015945434570312
r_  generation:  0.24415278434753418
local_output_nid generation:  0.01390528678894043
local_in_edges_tensor generation:  0.0178985595703125
mini_batch_src_global generation:  0.03144693374633789
r_  generation:  0.2405698299407959
local_output_nid generation:  0.013921976089477539
local_in_edges_tensor generation:  0.01428532600402832
mini_batch_src_global generation:  0.02999281883239746
r_  generation:  0.24381375312805176
local_output_nid generation:  0.013900518417358398
local_in_edges_tensor generation:  0.020227909088134766
mini_batch_src_global generation:  0.02990269660949707
r_  generation:  0.2409374713897705
----------------------check_connections_block total spend ----------------------------- 5.578507423400879
generate_one_block  0.3266904354095459
generate_one_block  0.3381516933441162
generate_one_block  0.3222792148590088
generate_one_block  0.32532525062561035
generate_one_block  0.3161654472351074
generate_one_block  0.3210442066192627
generate_one_block  0.3540680408477783
generate_one_block  0.3176426887512207
generate_one_block  0.31834840774536133
generate_one_block  0.3160879611968994
generate_one_block  0.3307766914367676
generate_one_block  0.352466344833374
generate_one_block  0.32337021827697754
generate_one_block  0.34294915199279785
generate_one_block  0.3230457305908203
generate_one_block  0.3236970901489258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06303048133850098
gen group dst list time:  0.08468747138977051
time for parepare:  0.020379304885864258
local_output_nid generation:  0.031398773193359375
local_in_edges_tensor generation:  0.057274818420410156
mini_batch_src_global generation:  0.04537391662597656
r_  generation:  0.4436819553375244
local_output_nid generation:  0.03354954719543457
local_in_edges_tensor generation:  0.04644322395324707
mini_batch_src_global generation:  0.05264425277709961
r_  generation:  0.4713137149810791
local_output_nid generation:  0.03631281852722168
local_in_edges_tensor generation:  0.051927804946899414
mini_batch_src_global generation:  0.055376291275024414
r_  generation:  0.4481534957885742
local_output_nid generation:  0.033455848693847656
local_in_edges_tensor generation:  0.039730072021484375
mini_batch_src_global generation:  0.05244588851928711
r_  generation:  0.4536397457122803
local_output_nid generation:  0.03334498405456543
local_in_edges_tensor generation:  0.09707236289978027
mini_batch_src_global generation:  0.05149126052856445
r_  generation:  0.45322179794311523
local_output_nid generation:  0.03200960159301758
local_in_edges_tensor generation:  0.0306088924407959
mini_batch_src_global generation:  0.05302572250366211
r_  generation:  0.4564821720123291
local_output_nid generation:  0.03232622146606445
local_in_edges_tensor generation:  0.030648469924926758
mini_batch_src_global generation:  0.05237388610839844
r_  generation:  0.45648193359375
local_output_nid generation:  0.03177499771118164
local_in_edges_tensor generation:  0.03412818908691406
mini_batch_src_global generation:  0.05294203758239746
r_  generation:  0.4527246952056885
local_output_nid generation:  0.031874656677246094
local_in_edges_tensor generation:  0.0381770133972168
mini_batch_src_global generation:  0.051729679107666016
r_  generation:  0.4569840431213379
local_output_nid generation:  0.03193783760070801
local_in_edges_tensor generation:  0.034400224685668945
mini_batch_src_global generation:  0.05287647247314453
r_  generation:  0.4731285572052002
local_output_nid generation:  0.032361507415771484
local_in_edges_tensor generation:  0.03500771522521973
mini_batch_src_global generation:  0.053659677505493164
r_  generation:  0.46861791610717773
local_output_nid generation:  0.035123586654663086
local_in_edges_tensor generation:  0.04324913024902344
mini_batch_src_global generation:  0.052556753158569336
r_  generation:  0.4671962261199951
local_output_nid generation:  0.03397631645202637
local_in_edges_tensor generation:  0.04040050506591797
mini_batch_src_global generation:  0.052758216857910156
r_  generation:  0.4869976043701172
local_output_nid generation:  0.03510737419128418
local_in_edges_tensor generation:  0.03670907020568848
mini_batch_src_global generation:  0.05397534370422363
r_  generation:  0.4598579406738281
local_output_nid generation:  0.03368782997131348
local_in_edges_tensor generation:  0.03600001335144043
mini_batch_src_global generation:  0.0522770881652832
r_  generation:  0.47769618034362793
local_output_nid generation:  0.033539772033691406
local_in_edges_tensor generation:  0.03701615333557129
mini_batch_src_global generation:  0.05876350402832031
r_  generation:  0.4623584747314453
----------------------check_connections_block total spend ----------------------------- 11.09158444404602
generate_one_block  0.6117045879364014
generate_one_block  0.608328104019165
generate_one_block  0.6272716522216797
generate_one_block  0.6151013374328613
generate_one_block  0.6074244976043701
generate_one_block  0.5996396541595459
generate_one_block  0.5875239372253418
generate_one_block  0.5973188877105713
generate_one_block  0.6493825912475586
generate_one_block  0.6073672771453857
generate_one_block  0.6361641883850098
generate_one_block  0.6141760349273682
generate_one_block  0.5986158847808838
generate_one_block  0.5918147563934326
generate_one_block  0.5885636806488037
generate_one_block  0.5920114517211914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.11871719360351562  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

connection checking time:  16.6700918674469
block generation total time  14.984517097473145
average batch blocks generation time:  0.9365323185920715
block dataloader generation time/epoch 34.52268958091736
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.0937647819519043  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154703, 128])
torch.Size([124440, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.203627586364746  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.09348917007446289  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155101, 128])
torch.Size([124465, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.187319278717041  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.09374809265136719  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154996, 128])
torch.Size([124734, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.20908260345459  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.09389019012451172  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155446, 128])
torch.Size([125696, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.27709436416626  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.09393024444580078  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154910, 128])
torch.Size([124565, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.255370616912842  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.09354352951049805  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154829, 128])
torch.Size([124662, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 12.262341976165771  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1502685546875 GB
    Memory Allocated: 0.09393024444580078  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154578, 128])
torch.Size([124231, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 12.229602813720703  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 0.09348011016845703  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154870, 128])
torch.Size([124625, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 12.216227054595947  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 0.09392452239990234  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154893, 128])
torch.Size([124662, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 12.232248306274414  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 0.09347152709960938  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([154880, 128])
torch.Size([124735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 12.214799880981445  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 0.09411144256591797  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155020, 128])
torch.Size([125315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 12.317774772644043  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1639404296875 GB
    Memory Allocated: 0.09399032592773438  GigaBytes
Max Memory Allocated: 12.337432861328125  GigaBytes

torch.Size([155180, 128])
torch.Size([125912, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 12.337208271026611  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 0.09396076202392578  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

torch.Size([155163, 128])
torch.Size([125436, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 12.26747751235962  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 0.09358024597167969  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

torch.Size([155110, 128])
torch.Size([124706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 12.216480255126953  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 0.09397220611572266  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

torch.Size([155029, 128])
torch.Size([124534, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 12.245617866516113  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 0.09332275390625  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

torch.Size([154440, 128])
torch.Size([124407, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1717529296875 GB
    Memory Allocated: 12.251418113708496  GigaBytes
Max Memory Allocated: 12.345639705657959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03927384316921234 |0.018595129251480103 |0.41740232706069946 |9.788572788238525e-05 |0.6597646623849869 |0.0064046382904052734 |
----------------------------------------------------------pseudo_mini_loss sum 3.6961541175842285
Total (block generation + training)time/epoch 52.723488092422485
Training time/epoch 18.200560808181763
Training time without block to device /epoch 17.90303874015808
Training time without total dataloading part /epoch 17.242642641067505
load block tensor time/epoch 0.6283814907073975
block to device time/epoch 0.29752206802368164
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5206503
Number of first layer input nodes during this epoch:  2479148
