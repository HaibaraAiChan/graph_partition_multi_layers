Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648524459.0227332
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0291748046875 GB
    Memory Allocated: 0.012590885162353516  GigaBytes
Max Memory Allocated: 0.012590885162353516  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02481865882873535
random selection method range initialization spend 0.0065653324127197266
time for parepare:  0.01840496063232422
local_output_nid generation:  0.002138376235961914
local_in_edges_tensor generation:  0.004643917083740234
mini_batch_src_global generation:  0.001768350601196289
r_  generation:  0.01780533790588379
local_output_nid generation:  0.002541780471801758
local_in_edges_tensor generation:  0.0017282962799072266
mini_batch_src_global generation:  0.002197742462158203
r_  generation:  0.017961740493774414
local_output_nid generation:  0.002763986587524414
local_in_edges_tensor generation:  0.0016748905181884766
mini_batch_src_global generation:  0.0013852119445800781
r_  generation:  0.017920732498168945
local_output_nid generation:  0.0028204917907714844
local_in_edges_tensor generation:  0.001565694808959961
mini_batch_src_global generation:  0.0013089179992675781
r_  generation:  0.017360448837280273
local_output_nid generation:  0.0028514862060546875
local_in_edges_tensor generation:  0.0015208721160888672
mini_batch_src_global generation:  0.0013222694396972656
r_  generation:  0.017332792282104492
local_output_nid generation:  0.00281524658203125
local_in_edges_tensor generation:  0.001495361328125
mini_batch_src_global generation:  0.0014846324920654297
r_  generation:  0.018510103225708008
local_output_nid generation:  0.0028030872344970703
local_in_edges_tensor generation:  0.0015320777893066406
mini_batch_src_global generation:  0.0015277862548828125
r_  generation:  0.018567323684692383
local_output_nid generation:  0.002801656723022461
local_in_edges_tensor generation:  0.0014853477478027344
mini_batch_src_global generation:  0.00148773193359375
r_  generation:  0.01868605613708496
local_output_nid generation:  0.0028367042541503906
local_in_edges_tensor generation:  0.0014662742614746094
mini_batch_src_global generation:  0.0014128684997558594
r_  generation:  0.018746137619018555
local_output_nid generation:  0.002852201461791992
local_in_edges_tensor generation:  0.0014412403106689453
mini_batch_src_global generation:  0.0013759136199951172
r_  generation:  0.018489599227905273
local_output_nid generation:  0.0028073787689208984
local_in_edges_tensor generation:  0.001415252685546875
mini_batch_src_global generation:  0.0015273094177246094
r_  generation:  0.018761634826660156
local_output_nid generation:  0.0028781890869140625
local_in_edges_tensor generation:  0.0014338493347167969
mini_batch_src_global generation:  0.0014796257019042969
r_  generation:  0.018589496612548828
local_output_nid generation:  0.0028505325317382812
local_in_edges_tensor generation:  0.0014958381652832031
mini_batch_src_global generation:  0.0015227794647216797
r_  generation:  0.019215106964111328
local_output_nid generation:  0.002819538116455078
local_in_edges_tensor generation:  0.0015730857849121094
mini_batch_src_global generation:  0.0015091896057128906
r_  generation:  0.018879413604736328
local_output_nid generation:  0.002803802490234375
local_in_edges_tensor generation:  0.0014939308166503906
mini_batch_src_global generation:  0.0015614032745361328
r_  generation:  0.019295692443847656
local_output_nid generation:  0.0028226375579833984
local_in_edges_tensor generation:  0.001483917236328125
mini_batch_src_global generation:  0.0015230178833007812
r_  generation:  0.018833398818969727
----------------------check_connections_block total spend ----------------------------- 0.4858531951904297
generate_one_block  0.027373075485229492
generate_one_block  0.02816462516784668
generate_one_block  0.02784562110900879
generate_one_block  0.029954195022583008
generate_one_block  0.027338266372680664
generate_one_block  0.027978181838989258
generate_one_block  0.027864933013916016
generate_one_block  0.027942419052124023
generate_one_block  0.02817535400390625
generate_one_block  0.02697587013244629
generate_one_block  0.02729511260986328
generate_one_block  0.027051448822021484
generate_one_block  0.027898311614990234
generate_one_block  0.027898788452148438
generate_one_block  0.029188871383666992
generate_one_block  0.02867865562438965
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04160904884338379
gen group dst list time:  0.01891922950744629
time for parepare:  0.019355058670043945
local_output_nid generation:  0.008309125900268555
local_in_edges_tensor generation:  0.01986098289489746
mini_batch_src_global generation:  0.02129364013671875
r_  generation:  0.19818592071533203
local_output_nid generation:  0.012274026870727539
local_in_edges_tensor generation:  0.01981210708618164
mini_batch_src_global generation:  0.025586605072021484
r_  generation:  0.20541071891784668
local_output_nid generation:  0.012169599533081055
local_in_edges_tensor generation:  0.014456510543823242
mini_batch_src_global generation:  0.02438974380493164
r_  generation:  0.2117462158203125
local_output_nid generation:  0.011703014373779297
local_in_edges_tensor generation:  0.014616012573242188
mini_batch_src_global generation:  0.024572134017944336
r_  generation:  0.20508289337158203
local_output_nid generation:  0.011647701263427734
local_in_edges_tensor generation:  0.01606893539428711
mini_batch_src_global generation:  0.024859189987182617
r_  generation:  0.20791959762573242
local_output_nid generation:  0.012017965316772461
local_in_edges_tensor generation:  0.015413999557495117
mini_batch_src_global generation:  0.026907682418823242
r_  generation:  0.21623444557189941
local_output_nid generation:  0.011909961700439453
local_in_edges_tensor generation:  0.01674342155456543
mini_batch_src_global generation:  0.026648998260498047
r_  generation:  0.2211780548095703
local_output_nid generation:  0.012041330337524414
local_in_edges_tensor generation:  0.015161514282226562
mini_batch_src_global generation:  0.027940750122070312
r_  generation:  0.21796107292175293
local_output_nid generation:  0.011769533157348633
local_in_edges_tensor generation:  0.014590263366699219
mini_batch_src_global generation:  0.027213335037231445
r_  generation:  0.22199368476867676
local_output_nid generation:  0.011641740798950195
local_in_edges_tensor generation:  0.012737751007080078
mini_batch_src_global generation:  0.027179479598999023
r_  generation:  0.21520495414733887
local_output_nid generation:  0.01171565055847168
local_in_edges_tensor generation:  0.014261722564697266
mini_batch_src_global generation:  0.026940584182739258
r_  generation:  0.2141704559326172
local_output_nid generation:  0.011667728424072266
local_in_edges_tensor generation:  0.01446223258972168
mini_batch_src_global generation:  0.027091026306152344
r_  generation:  0.21548223495483398
local_output_nid generation:  0.012100696563720703
local_in_edges_tensor generation:  0.01658320426940918
mini_batch_src_global generation:  0.027397871017456055
r_  generation:  0.2263953685760498
local_output_nid generation:  0.011784076690673828
local_in_edges_tensor generation:  0.016433238983154297
mini_batch_src_global generation:  0.02800154685974121
r_  generation:  0.220900297164917
local_output_nid generation:  0.011920690536499023
local_in_edges_tensor generation:  0.01273655891418457
mini_batch_src_global generation:  0.027547597885131836
r_  generation:  0.22002410888671875
local_output_nid generation:  0.01184535026550293
local_in_edges_tensor generation:  0.014427900314331055
mini_batch_src_global generation:  0.02753448486328125
r_  generation:  0.21494102478027344
----------------------check_connections_block total spend ----------------------------- 5.065323114395142
generate_one_block  0.28443360328674316
generate_one_block  0.2845337390899658
generate_one_block  0.2835109233856201
generate_one_block  0.27678489685058594
generate_one_block  0.29830098152160645
generate_one_block  0.291637659072876
generate_one_block  0.2842705249786377
generate_one_block  0.2875850200653076
generate_one_block  0.2879951000213623
generate_one_block  0.2779395580291748
generate_one_block  0.27901268005371094
generate_one_block  0.2798726558685303
generate_one_block  0.2914407253265381
generate_one_block  0.28360939025878906
generate_one_block  0.28586888313293457
generate_one_block  0.28023624420166016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0435328483581543
gen group dst list time:  0.05942511558532715
time for parepare:  0.019532203674316406
local_output_nid generation:  0.02617359161376953
local_in_edges_tensor generation:  0.03915119171142578
mini_batch_src_global generation:  0.05286240577697754
r_  generation:  0.48673057556152344
local_output_nid generation:  0.03321647644042969
local_in_edges_tensor generation:  0.05075359344482422
mini_batch_src_global generation:  0.08114767074584961
r_  generation:  0.4898056983947754
local_output_nid generation:  0.032274484634399414
local_in_edges_tensor generation:  0.06362676620483398
mini_batch_src_global generation:  0.08449053764343262
r_  generation:  0.4941856861114502
local_output_nid generation:  0.03280973434448242
local_in_edges_tensor generation:  0.039223432540893555
mini_batch_src_global generation:  0.0583038330078125
r_  generation:  0.49422621726989746
local_output_nid generation:  0.032119035720825195
local_in_edges_tensor generation:  0.0345456600189209
mini_batch_src_global generation:  0.05794715881347656
r_  generation:  0.49918460845947266
local_output_nid generation:  0.03185129165649414
local_in_edges_tensor generation:  0.03887462615966797
mini_batch_src_global generation:  0.06117963790893555
r_  generation:  0.4978024959564209
local_output_nid generation:  0.0321354866027832
local_in_edges_tensor generation:  0.03436422348022461
mini_batch_src_global generation:  0.05905890464782715
r_  generation:  0.5022509098052979
local_output_nid generation:  0.032099008560180664
local_in_edges_tensor generation:  0.03053593635559082
mini_batch_src_global generation:  0.05886244773864746
r_  generation:  0.4989800453186035
local_output_nid generation:  0.03222393989562988
local_in_edges_tensor generation:  0.03987836837768555
mini_batch_src_global generation:  0.058507680892944336
r_  generation:  0.5042543411254883
local_output_nid generation:  0.03161263465881348
local_in_edges_tensor generation:  0.030453920364379883
mini_batch_src_global generation:  0.061280250549316406
r_  generation:  0.49674201011657715
local_output_nid generation:  0.03171086311340332
local_in_edges_tensor generation:  0.03405451774597168
mini_batch_src_global generation:  0.0624845027923584
r_  generation:  0.5003468990325928
local_output_nid generation:  0.03161120414733887
local_in_edges_tensor generation:  0.03408670425415039
mini_batch_src_global generation:  0.06517314910888672
r_  generation:  0.4992690086364746
local_output_nid generation:  0.0328068733215332
local_in_edges_tensor generation:  0.03526759147644043
mini_batch_src_global generation:  0.05902671813964844
r_  generation:  0.505896806716919
local_output_nid generation:  0.03188776969909668
local_in_edges_tensor generation:  0.0440678596496582
mini_batch_src_global generation:  0.07770967483520508
r_  generation:  0.5105547904968262
local_output_nid generation:  0.03342485427856445
local_in_edges_tensor generation:  0.041074275970458984
mini_batch_src_global generation:  0.062744140625
r_  generation:  0.5050549507141113
local_output_nid generation:  0.0322268009185791
local_in_edges_tensor generation:  0.039794206619262695
mini_batch_src_global generation:  0.05991864204406738
r_  generation:  0.5035958290100098
----------------------check_connections_block total spend ----------------------------- 11.906163930892944
generate_one_block  0.6726598739624023
generate_one_block  0.6575822830200195
generate_one_block  0.6514134407043457
generate_one_block  0.6505606174468994
generate_one_block  0.6517729759216309
generate_one_block  0.6763856410980225
generate_one_block  0.7190814018249512
generate_one_block  0.6503632068634033
generate_one_block  0.6611051559448242
generate_one_block  0.6390666961669922
generate_one_block  0.6512546539306641
generate_one_block  0.7130334377288818
generate_one_block  0.6709067821502686
generate_one_block  0.6450037956237793
generate_one_block  0.6759841442108154
generate_one_block  0.68670654296875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06338787078857422
gen group dst list time:  0.10343503952026367
time for parepare:  0.020647287368774414
local_output_nid generation:  0.03546333312988281
local_in_edges_tensor generation:  0.08010196685791016
mini_batch_src_global generation:  0.05404090881347656
r_  generation:  0.5391318798065186
local_output_nid generation:  0.04034256935119629
local_in_edges_tensor generation:  0.062218666076660156
mini_batch_src_global generation:  0.06398510932922363
r_  generation:  0.5559988021850586
local_output_nid generation:  0.04017376899719238
local_in_edges_tensor generation:  0.05874752998352051
mini_batch_src_global generation:  0.0761098861694336
r_  generation:  0.549802303314209
local_output_nid generation:  0.04078221321105957
local_in_edges_tensor generation:  0.05361676216125488
mini_batch_src_global generation:  0.059372663497924805
r_  generation:  0.563852071762085
local_output_nid generation:  0.03957009315490723
local_in_edges_tensor generation:  0.04174351692199707
mini_batch_src_global generation:  0.05889296531677246
r_  generation:  0.5577046871185303
local_output_nid generation:  0.0397038459777832
local_in_edges_tensor generation:  0.04253220558166504
mini_batch_src_global generation:  0.06161189079284668
r_  generation:  0.5635886192321777
local_output_nid generation:  0.0394899845123291
local_in_edges_tensor generation:  0.03602313995361328
mini_batch_src_global generation:  0.06100654602050781
r_  generation:  0.5672495365142822
local_output_nid generation:  0.04052567481994629
local_in_edges_tensor generation:  0.052407264709472656
mini_batch_src_global generation:  0.0650637149810791
r_  generation:  0.5779001712799072
local_output_nid generation:  0.039916276931762695
local_in_edges_tensor generation:  0.04867076873779297
mini_batch_src_global generation:  0.07249712944030762
r_  generation:  0.5741734504699707
local_output_nid generation:  0.04062986373901367
local_in_edges_tensor generation:  0.042877912521362305
mini_batch_src_global generation:  0.06359410285949707
r_  generation:  0.5648760795593262
local_output_nid generation:  0.04165339469909668
local_in_edges_tensor generation:  0.03855586051940918
mini_batch_src_global generation:  0.0628817081451416
r_  generation:  0.5809218883514404
local_output_nid generation:  0.039785146713256836
local_in_edges_tensor generation:  0.03804183006286621
mini_batch_src_global generation:  0.06299614906311035
r_  generation:  0.5661683082580566
local_output_nid generation:  0.039644718170166016
local_in_edges_tensor generation:  0.04482769966125488
mini_batch_src_global generation:  0.06673073768615723
r_  generation:  0.5714786052703857
local_output_nid generation:  0.03958296775817871
local_in_edges_tensor generation:  0.043364524841308594
mini_batch_src_global generation:  0.0633854866027832
r_  generation:  0.5659992694854736
local_output_nid generation:  0.03957319259643555
local_in_edges_tensor generation:  0.0458528995513916
mini_batch_src_global generation:  0.06608915328979492
r_  generation:  0.5738961696624756
local_output_nid generation:  0.03955507278442383
local_in_edges_tensor generation:  0.03951525688171387
mini_batch_src_global generation:  0.06354045867919922
r_  generation:  0.5716512203216553
----------------------check_connections_block total spend ----------------------------- 13.613545656204224
generate_one_block  0.7210028171539307
generate_one_block  0.7068202495574951
generate_one_block  0.7127089500427246
generate_one_block  0.7995510101318359
generate_one_block  0.6981103420257568
generate_one_block  0.6992228031158447
generate_one_block  0.6896166801452637
generate_one_block  0.7165927886962891
generate_one_block  0.7131657600402832
generate_one_block  0.6888282299041748
generate_one_block  0.6965553760528564
generate_one_block  0.6878654956817627
generate_one_block  0.7065391540527344
generate_one_block  0.7006015777587891
generate_one_block  0.7092297077178955
generate_one_block  0.7151975631713867
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04230690002441406
gen group dst list time:  0.1055595874786377
time for parepare:  0.01965618133544922
local_output_nid generation:  0.03722834587097168
local_in_edges_tensor generation:  0.05620312690734863
mini_batch_src_global generation:  0.05042004585266113
r_  generation:  0.5344448089599609
local_output_nid generation:  0.04481983184814453
local_in_edges_tensor generation:  0.044585466384887695
mini_batch_src_global generation:  0.06341958045959473
r_  generation:  0.5394184589385986
local_output_nid generation:  0.04074525833129883
local_in_edges_tensor generation:  0.03835153579711914
mini_batch_src_global generation:  0.06426048278808594
r_  generation:  0.5512220859527588
local_output_nid generation:  0.04083991050720215
local_in_edges_tensor generation:  0.03838014602661133
mini_batch_src_global generation:  0.06155514717102051
r_  generation:  0.5429761409759521
local_output_nid generation:  0.04065990447998047
local_in_edges_tensor generation:  0.04345393180847168
mini_batch_src_global generation:  0.06274628639221191
r_  generation:  0.5451290607452393
local_output_nid generation:  0.04140782356262207
local_in_edges_tensor generation:  0.04318499565124512
mini_batch_src_global generation:  0.06125450134277344
r_  generation:  0.5430049896240234
local_output_nid generation:  0.04059600830078125
local_in_edges_tensor generation:  0.043061017990112305
mini_batch_src_global generation:  0.06158614158630371
r_  generation:  0.5483040809631348
local_output_nid generation:  0.041046142578125
local_in_edges_tensor generation:  0.04407191276550293
mini_batch_src_global generation:  0.06152176856994629
r_  generation:  0.5501713752746582
local_output_nid generation:  0.04092884063720703
local_in_edges_tensor generation:  0.04866528511047363
mini_batch_src_global generation:  0.060463666915893555
r_  generation:  0.5598888397216797
local_output_nid generation:  0.04066610336303711
local_in_edges_tensor generation:  0.038316965103149414
mini_batch_src_global generation:  0.06181001663208008
r_  generation:  0.5513696670532227
local_output_nid generation:  0.04076981544494629
local_in_edges_tensor generation:  0.05029010772705078
mini_batch_src_global generation:  0.06183362007141113
r_  generation:  0.5558350086212158
local_output_nid generation:  0.04070878028869629
local_in_edges_tensor generation:  0.048435211181640625
mini_batch_src_global generation:  0.061194658279418945
r_  generation:  0.5641031265258789
local_output_nid generation:  0.04102063179016113
local_in_edges_tensor generation:  0.048302412033081055
mini_batch_src_global generation:  0.06476593017578125
r_  generation:  0.5613927841186523
local_output_nid generation:  0.04066920280456543
local_in_edges_tensor generation:  0.04215049743652344
mini_batch_src_global generation:  0.06123065948486328
r_  generation:  0.5558435916900635
local_output_nid generation:  0.04076647758483887
local_in_edges_tensor generation:  0.043920278549194336
mini_batch_src_global generation:  0.0616910457611084
r_  generation:  0.5654764175415039
local_output_nid generation:  0.04074430465698242
local_in_edges_tensor generation:  0.047466278076171875
mini_batch_src_global generation:  0.06488847732543945
r_  generation:  0.5572912693023682
----------------------check_connections_block total spend ----------------------------- 13.276572704315186
generate_one_block  0.6962804794311523
generate_one_block  0.6949751377105713
generate_one_block  0.6998608112335205
generate_one_block  0.6940836906433105
generate_one_block  0.6864871978759766
generate_one_block  0.6803829669952393
generate_one_block  0.7591309547424316
generate_one_block  0.7122616767883301
generate_one_block  0.7200100421905518
generate_one_block  0.6843788623809814
generate_one_block  0.6858344078063965
generate_one_block  0.6805229187011719
generate_one_block  0.7011370658874512
generate_one_block  0.6946685314178467
generate_one_block  0.7041878700256348
generate_one_block  0.6968762874603271
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.041841745376586914
gen group dst list time:  0.11085295677185059
time for parepare:  0.0196225643157959
local_output_nid generation:  0.0370335578918457
local_in_edges_tensor generation:  0.05256295204162598
mini_batch_src_global generation:  0.0472111701965332
r_  generation:  0.501000165939331
local_output_nid generation:  0.043709516525268555
local_in_edges_tensor generation:  0.03585362434387207
mini_batch_src_global generation:  0.057970523834228516
r_  generation:  0.5174341201782227
local_output_nid generation:  0.041784048080444336
local_in_edges_tensor generation:  0.04029273986816406
mini_batch_src_global generation:  0.05877041816711426
r_  generation:  0.5211517810821533
local_output_nid generation:  0.045517683029174805
local_in_edges_tensor generation:  0.0406646728515625
mini_batch_src_global generation:  0.060683488845825195
r_  generation:  0.5297622680664062
local_output_nid generation:  0.04487752914428711
local_in_edges_tensor generation:  0.05003976821899414
mini_batch_src_global generation:  0.0617218017578125
r_  generation:  0.5114903450012207
local_output_nid generation:  0.042412519454956055
local_in_edges_tensor generation:  0.03779768943786621
mini_batch_src_global generation:  0.060564517974853516
r_  generation:  0.5182080268859863
local_output_nid generation:  0.043467044830322266
local_in_edges_tensor generation:  0.04468131065368652
mini_batch_src_global generation:  0.05755424499511719
r_  generation:  0.5158069133758545
local_output_nid generation:  0.04244804382324219
local_in_edges_tensor generation:  0.039665937423706055
mini_batch_src_global generation:  0.05829215049743652
r_  generation:  0.5282037258148193
local_output_nid generation:  0.04667925834655762
local_in_edges_tensor generation:  0.05443286895751953
mini_batch_src_global generation:  0.06551170349121094
r_  generation:  0.5243091583251953
local_output_nid generation:  0.042582035064697266
local_in_edges_tensor generation:  0.04911971092224121
mini_batch_src_global generation:  0.05864739418029785
r_  generation:  0.5368387699127197
local_output_nid generation:  0.04248452186584473
local_in_edges_tensor generation:  0.03604745864868164
mini_batch_src_global generation:  0.05795645713806152
r_  generation:  0.5168673992156982
local_output_nid generation:  0.04266858100891113
local_in_edges_tensor generation:  0.040108680725097656
mini_batch_src_global generation:  0.05913257598876953
r_  generation:  0.5217206478118896
local_output_nid generation:  0.0426175594329834
local_in_edges_tensor generation:  0.04890775680541992
mini_batch_src_global generation:  0.057614803314208984
r_  generation:  0.521315336227417
local_output_nid generation:  0.043578147888183594
local_in_edges_tensor generation:  0.04604482650756836
mini_batch_src_global generation:  0.05851602554321289
r_  generation:  0.5244035720825195
local_output_nid generation:  0.042868852615356445
local_in_edges_tensor generation:  0.040384769439697266
mini_batch_src_global generation:  0.0583949089050293
r_  generation:  0.5225861072540283
local_output_nid generation:  0.04271388053894043
local_in_edges_tensor generation:  0.04459881782531738
mini_batch_src_global generation:  0.06140589714050293
r_  generation:  0.5208446979522705
----------------------check_connections_block total spend ----------------------------- 12.654249668121338
generate_one_block  0.6636388301849365
generate_one_block  0.6476919651031494
generate_one_block  0.6518940925598145
generate_one_block  0.6592724323272705
generate_one_block  0.6358530521392822
generate_one_block  0.6534481048583984
generate_one_block  0.6495025157928467
generate_one_block  0.6643779277801514
generate_one_block  0.7804696559906006
generate_one_block  0.6416773796081543
generate_one_block  0.6360101699829102
generate_one_block  0.6389584541320801
generate_one_block  0.659574031829834
generate_one_block  0.6538114547729492
generate_one_block  0.6425964832305908
generate_one_block  0.6674709320068359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0291748046875 GB
    Memory Allocated: 0.012590885162353516  GigaBytes
Max Memory Allocated: 0.012590885162353516  GigaBytes

connection checking time:  56.51585507392883
block generation total time  48.328848123550415
average batch blocks generation time:  3.020553007721901
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.14760589599609375  GigaBytes
Max Memory Allocated: 0.14760589599609375  GigaBytes

torch.Size([167211, 128])
torch.Size([166363, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 18.00 MiB (GPU 0; 23.62 GiB total capacity; 21.95 GiB already allocated; 16.44 MiB free; 22.41 GiB reserved in total by PyTorch)
