Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648456839.5261278
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02455449104309082
random selection method range initialization spend 0.0062103271484375
time for parepare:  0.019354820251464844
local_output_nid generation:  0.0022945404052734375
local_in_edges_tensor generation:  0.004588127136230469
mini_batch_src_global generation:  0.0019114017486572266
r_  generation:  0.01905655860900879
local_output_nid generation:  0.0029304027557373047
local_in_edges_tensor generation:  0.0016684532165527344
mini_batch_src_global generation:  0.00220489501953125
r_  generation:  0.018654346466064453
local_output_nid generation:  0.0029523372650146484
local_in_edges_tensor generation:  0.0015292167663574219
mini_batch_src_global generation:  0.0014011859893798828
r_  generation:  0.01856207847595215
local_output_nid generation:  0.00296783447265625
local_in_edges_tensor generation:  0.0015110969543457031
mini_batch_src_global generation:  0.0014157295227050781
r_  generation:  0.01839470863342285
local_output_nid generation:  0.0029418468475341797
local_in_edges_tensor generation:  0.0014944076538085938
mini_batch_src_global generation:  0.0013937950134277344
r_  generation:  0.018589496612548828
local_output_nid generation:  0.0029757022857666016
local_in_edges_tensor generation:  0.0014429092407226562
mini_batch_src_global generation:  0.001443624496459961
r_  generation:  0.01870441436767578
local_output_nid generation:  0.0029730796813964844
local_in_edges_tensor generation:  0.0014650821685791016
mini_batch_src_global generation:  0.0014977455139160156
r_  generation:  0.019381046295166016
local_output_nid generation:  0.0029082298278808594
local_in_edges_tensor generation:  0.0014452934265136719
mini_batch_src_global generation:  0.0014832019805908203
r_  generation:  0.01926422119140625
local_output_nid generation:  0.002973794937133789
local_in_edges_tensor generation:  0.0014388561248779297
mini_batch_src_global generation:  0.001481771469116211
r_  generation:  0.019265174865722656
local_output_nid generation:  0.0029366016387939453
local_in_edges_tensor generation:  0.001435995101928711
mini_batch_src_global generation:  0.0015168190002441406
r_  generation:  0.019640445709228516
local_output_nid generation:  0.0029091835021972656
local_in_edges_tensor generation:  0.0014147758483886719
mini_batch_src_global generation:  0.0015764236450195312
r_  generation:  0.01961350440979004
local_output_nid generation:  0.002955198287963867
local_in_edges_tensor generation:  0.0014314651489257812
mini_batch_src_global generation:  0.0015587806701660156
r_  generation:  0.019710063934326172
local_output_nid generation:  0.0030188560485839844
local_in_edges_tensor generation:  0.0014882087707519531
mini_batch_src_global generation:  0.0015780925750732422
r_  generation:  0.019405603408813477
local_output_nid generation:  0.002996683120727539
local_in_edges_tensor generation:  0.0014302730560302734
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.019861698150634766
local_output_nid generation:  0.0029671192169189453
local_in_edges_tensor generation:  0.001512765884399414
mini_batch_src_global generation:  0.0016145706176757812
r_  generation:  0.019917964935302734
local_output_nid generation:  0.0030090808868408203
local_in_edges_tensor generation:  0.0014622211456298828
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.019376039505004883
----------------------check_connections_block total spend ----------------------------- 0.5057449340820312
generate_one_block  0.027444839477539062
generate_one_block  0.028470993041992188
generate_one_block  0.03146839141845703
generate_one_block  0.028344154357910156
generate_one_block  0.02917766571044922
generate_one_block  0.02771139144897461
generate_one_block  0.028456926345825195
generate_one_block  0.027762889862060547
generate_one_block  0.02786731719970703
generate_one_block  0.028592348098754883
generate_one_block  0.028115034103393555
generate_one_block  0.02849125862121582
generate_one_block  0.027718782424926758
generate_one_block  0.0285184383392334
generate_one_block  0.028342485427856445
generate_one_block  0.027533531188964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036721229553222656
gen group dst list time:  0.019007205963134766
time for parepare:  0.019073009490966797
local_output_nid generation:  0.008590221405029297
local_in_edges_tensor generation:  0.018314599990844727
mini_batch_src_global generation:  0.02126455307006836
r_  generation:  0.19684290885925293
local_output_nid generation:  0.012186765670776367
local_in_edges_tensor generation:  0.018939495086669922
mini_batch_src_global generation:  0.024472713470458984
r_  generation:  0.19652056694030762
local_output_nid generation:  0.01215219497680664
local_in_edges_tensor generation:  0.01586437225341797
mini_batch_src_global generation:  0.023812294006347656
r_  generation:  0.216996431350708
local_output_nid generation:  0.014109611511230469
local_in_edges_tensor generation:  0.012017965316772461
mini_batch_src_global generation:  0.024630069732666016
r_  generation:  0.20308876037597656
local_output_nid generation:  0.012338399887084961
local_in_edges_tensor generation:  0.015409708023071289
mini_batch_src_global generation:  0.025261640548706055
r_  generation:  0.20921874046325684
local_output_nid generation:  0.0120086669921875
local_in_edges_tensor generation:  0.012099981307983398
mini_batch_src_global generation:  0.025496244430541992
r_  generation:  0.20631814002990723
local_output_nid generation:  0.012515783309936523
local_in_edges_tensor generation:  0.015528678894042969
mini_batch_src_global generation:  0.027738094329833984
r_  generation:  0.21446824073791504
local_output_nid generation:  0.012445211410522461
local_in_edges_tensor generation:  0.012572288513183594
mini_batch_src_global generation:  0.026678085327148438
r_  generation:  0.2093057632446289
local_output_nid generation:  0.013754129409790039
local_in_edges_tensor generation:  0.014115571975708008
mini_batch_src_global generation:  0.02660846710205078
r_  generation:  0.21252918243408203
local_output_nid generation:  0.012276887893676758
local_in_edges_tensor generation:  0.01381373405456543
mini_batch_src_global generation:  0.029401063919067383
r_  generation:  0.21494126319885254
local_output_nid generation:  0.013234138488769531
local_in_edges_tensor generation:  0.012535572052001953
mini_batch_src_global generation:  0.032807111740112305
r_  generation:  0.22380948066711426
local_output_nid generation:  0.014444351196289062
local_in_edges_tensor generation:  0.023403406143188477
mini_batch_src_global generation:  0.027920961380004883
r_  generation:  0.21408534049987793
local_output_nid generation:  0.012341976165771484
local_in_edges_tensor generation:  0.012296199798583984
mini_batch_src_global generation:  0.026891708374023438
r_  generation:  0.225968599319458
local_output_nid generation:  0.012549638748168945
local_in_edges_tensor generation:  0.014501810073852539
mini_batch_src_global generation:  0.028825759887695312
r_  generation:  0.2199711799621582
local_output_nid generation:  0.013381719589233398
local_in_edges_tensor generation:  0.018229246139526367
mini_batch_src_global generation:  0.028745174407958984
r_  generation:  0.22755837440490723
local_output_nid generation:  0.014452934265136719
local_in_edges_tensor generation:  0.024444103240966797
mini_batch_src_global generation:  0.02742791175842285
r_  generation:  0.21233177185058594
----------------------check_connections_block total spend ----------------------------- 5.062113523483276
generate_one_block  0.2862820625305176
generate_one_block  0.29741692543029785
generate_one_block  0.28024983406066895
generate_one_block  0.27855706214904785
generate_one_block  0.29425048828125
generate_one_block  0.2653815746307373
generate_one_block  0.2982504367828369
generate_one_block  0.29618239402770996
generate_one_block  0.2867710590362549
generate_one_block  0.27355051040649414
generate_one_block  0.2727959156036377
generate_one_block  0.29744648933410645
generate_one_block  0.2906038761138916
generate_one_block  0.27884912490844727
generate_one_block  0.284473180770874
generate_one_block  0.26865339279174805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08554410934448242
gen group dst list time:  0.06727766990661621
time for parepare:  0.019826173782348633
local_output_nid generation:  0.02633833885192871
local_in_edges_tensor generation:  0.0573887825012207
mini_batch_src_global generation:  0.042792320251464844
r_  generation:  0.46944212913513184
local_output_nid generation:  0.031499624252319336
local_in_edges_tensor generation:  0.0476069450378418
mini_batch_src_global generation:  0.0525209903717041
r_  generation:  0.44436049461364746
local_output_nid generation:  0.031053543090820312
local_in_edges_tensor generation:  0.04003167152404785
mini_batch_src_global generation:  0.051306724548339844
r_  generation:  0.4510343074798584
local_output_nid generation:  0.0313112735748291
local_in_edges_tensor generation:  0.034784555435180664
mini_batch_src_global generation:  0.052634477615356445
r_  generation:  0.4491744041442871
local_output_nid generation:  0.03106689453125
local_in_edges_tensor generation:  0.03182196617126465
mini_batch_src_global generation:  0.05524897575378418
r_  generation:  0.46965622901916504
local_output_nid generation:  0.030840396881103516
local_in_edges_tensor generation:  0.030982255935668945
mini_batch_src_global generation:  0.056403398513793945
r_  generation:  0.47600340843200684
local_output_nid generation:  0.036942243576049805
local_in_edges_tensor generation:  0.051130056381225586
mini_batch_src_global generation:  0.05831551551818848
r_  generation:  0.45813941955566406
local_output_nid generation:  0.03218340873718262
local_in_edges_tensor generation:  0.04220771789550781
mini_batch_src_global generation:  0.05370664596557617
r_  generation:  0.45346808433532715
local_output_nid generation:  0.03219270706176758
local_in_edges_tensor generation:  0.03541135787963867
mini_batch_src_global generation:  0.0525972843170166
r_  generation:  0.4605448246002197
local_output_nid generation:  0.03199052810668945
local_in_edges_tensor generation:  0.03629302978515625
mini_batch_src_global generation:  0.05437445640563965
r_  generation:  0.45136380195617676
local_output_nid generation:  0.03208589553833008
local_in_edges_tensor generation:  0.036685943603515625
mini_batch_src_global generation:  0.05315208435058594
r_  generation:  0.4608619213104248
local_output_nid generation:  0.034603118896484375
local_in_edges_tensor generation:  0.04380202293395996
mini_batch_src_global generation:  0.05382370948791504
r_  generation:  0.4691941738128662
local_output_nid generation:  0.03197193145751953
local_in_edges_tensor generation:  0.03545689582824707
mini_batch_src_global generation:  0.052869558334350586
r_  generation:  0.4626889228820801
local_output_nid generation:  0.03338479995727539
local_in_edges_tensor generation:  0.0520176887512207
mini_batch_src_global generation:  0.05467557907104492
r_  generation:  0.46544790267944336
local_output_nid generation:  0.032639265060424805
local_in_edges_tensor generation:  0.04093360900878906
mini_batch_src_global generation:  0.056835174560546875
r_  generation:  0.48160552978515625
local_output_nid generation:  0.03453564643859863
local_in_edges_tensor generation:  0.03341197967529297
mini_batch_src_global generation:  0.05495643615722656
r_  generation:  0.45456743240356445
----------------------check_connections_block total spend ----------------------------- 11.008275508880615
generate_one_block  0.580284833908081
generate_one_block  0.5772202014923096
generate_one_block  0.5800302028656006
generate_one_block  0.56606125831604
generate_one_block  0.6281073093414307
generate_one_block  0.6038687229156494
generate_one_block  0.6561236381530762
generate_one_block  0.5849876403808594
generate_one_block  0.5812942981719971
generate_one_block  0.566983699798584
generate_one_block  0.574547290802002
generate_one_block  0.5832781791687012
generate_one_block  0.6001591682434082
generate_one_block  0.6045856475830078
generate_one_block  0.6051218509674072
generate_one_block  0.5731894969940186
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  16.07038903236389
block generation total time  14.015557765960693
average batch blocks generation time:  0.8759723603725433
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0908207893371582  GigaBytes
Max Memory Allocated: 0.0908207893371582  GigaBytes

torch.Size([154534, 128])
torch.Size([123266, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6815185546875 GB
    Memory Allocated: 13.316009521484375  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9998779296875 GB
    Memory Allocated: 0.09175586700439453  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154528, 128])
torch.Size([122161, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0076904296875 GB
    Memory Allocated: 13.16822624206543  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0076904296875 GB
    Memory Allocated: 0.09247016906738281  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154547, 128])
torch.Size([122978, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.301466941833496  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09158945083618164  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154407, 128])
torch.Size([121685, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.097561359405518  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09229087829589844  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154344, 128])
torch.Size([122105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.160712242126465  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09140968322753906  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154120, 128])
torch.Size([121359, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.077490329742432  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09247493743896484  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154717, 128])
torch.Size([122862, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.305359363555908  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09186840057373047  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154706, 128])
torch.Size([122846, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.179070472717285  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09235286712646484  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154583, 128])
torch.Size([122925, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.217057704925537  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09170246124267578  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154320, 128])
torch.Size([122078, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.18751335144043  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.092315673828125  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154414, 128])
torch.Size([121972, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.166158676147461  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09175539016723633  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154235, 128])
torch.Size([122220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.230041027069092  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09231376647949219  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154353, 128])
torch.Size([122026, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 13.149352073669434  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0389404296875 GB
    Memory Allocated: 0.09211158752441406  GigaBytes
Max Memory Allocated: 13.330289363861084  GigaBytes

torch.Size([154858, 128])
torch.Size([123422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.32315969467163  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.0924520492553711  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154393, 128])
torch.Size([122752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.26767873764038  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.09177541732788086  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154525, 128])
torch.Size([122783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.185131072998047  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034208640456199646 |0.03562380373477936 |0.28730812668800354 |0.00010323524475097656 |0.31597255170345306 |0.006861209869384766 |
----------------------------------------------------------pseudo_mini_loss sum 4.953800201416016
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5092320
Number of first layer input nodes during this epoch:  2471584
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.11667490005493164  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025604724884033203
random selection method range initialization spend 0.007595062255859375
time for parepare:  0.019898176193237305
local_output_nid generation:  0.0027048587799072266
local_in_edges_tensor generation:  0.0069997310638427734
mini_batch_src_global generation:  0.002165079116821289
r_  generation:  0.0198667049407959
local_output_nid generation:  0.003942012786865234
local_in_edges_tensor generation:  0.0017437934875488281
mini_batch_src_global generation:  0.0024614334106445312
r_  generation:  0.018807649612426758
local_output_nid generation:  0.0038559436798095703
local_in_edges_tensor generation:  0.0016543865203857422
mini_batch_src_global generation:  0.0014200210571289062
r_  generation:  0.018770933151245117
local_output_nid generation:  0.0038328170776367188
local_in_edges_tensor generation:  0.001674652099609375
mini_batch_src_global generation:  0.0015306472778320312
r_  generation:  0.0323796272277832
local_output_nid generation:  0.0051233768463134766
local_in_edges_tensor generation:  0.00226593017578125
mini_batch_src_global generation:  0.001661539077758789
r_  generation:  0.019639968872070312
local_output_nid generation:  0.004492759704589844
local_in_edges_tensor generation:  0.002038240432739258
mini_batch_src_global generation:  0.0015578269958496094
r_  generation:  0.01881885528564453
local_output_nid generation:  0.0043315887451171875
local_in_edges_tensor generation:  0.0019409656524658203
mini_batch_src_global generation:  0.0016198158264160156
r_  generation:  0.019638538360595703
local_output_nid generation:  0.003973722457885742
local_in_edges_tensor generation:  0.0017786026000976562
mini_batch_src_global generation:  0.0016281604766845703
r_  generation:  0.01899123191833496
local_output_nid generation:  0.003916025161743164
local_in_edges_tensor generation:  0.0018613338470458984
mini_batch_src_global generation:  0.00160980224609375
r_  generation:  0.019107818603515625
local_output_nid generation:  0.0037870407104492188
local_in_edges_tensor generation:  0.0017876625061035156
mini_batch_src_global generation:  0.00164794921875
r_  generation:  0.019627809524536133
local_output_nid generation:  0.0038857460021972656
local_in_edges_tensor generation:  0.0018420219421386719
mini_batch_src_global generation:  0.0016813278198242188
r_  generation:  0.019556760787963867
local_output_nid generation:  0.0037910938262939453
local_in_edges_tensor generation:  0.002931833267211914
mini_batch_src_global generation:  0.003813028335571289
r_  generation:  0.022798776626586914
local_output_nid generation:  0.00460052490234375
local_in_edges_tensor generation:  0.0018448829650878906
mini_batch_src_global generation:  0.002048492431640625
r_  generation:  0.033193349838256836
local_output_nid generation:  0.004289150238037109
local_in_edges_tensor generation:  0.0018389225006103516
mini_batch_src_global generation:  0.0016858577728271484
r_  generation:  0.019975662231445312
local_output_nid generation:  0.0039098262786865234
local_in_edges_tensor generation:  0.0019245147705078125
mini_batch_src_global generation:  0.001676797866821289
r_  generation:  0.020112991333007812
local_output_nid generation:  0.003973484039306641
local_in_edges_tensor generation:  0.001802206039428711
mini_batch_src_global generation:  0.0017421245574951172
r_  generation:  0.020537614822387695
----------------------check_connections_block total spend ----------------------------- 0.5853118896484375
generate_one_block  0.03470778465270996
generate_one_block  0.036179304122924805
generate_one_block  0.033097028732299805
generate_one_block  0.03389286994934082
generate_one_block  0.03346586227416992
generate_one_block  0.03585028648376465
generate_one_block  0.03396892547607422
generate_one_block  0.030922412872314453
generate_one_block  0.03052234649658203
generate_one_block  0.030957698822021484
generate_one_block  0.030303955078125
generate_one_block  0.030753135681152344
generate_one_block  0.030764102935791016
generate_one_block  0.030308246612548828
generate_one_block  0.03075861930847168
generate_one_block  0.03170657157897949
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03518390655517578
gen group dst list time:  0.017689943313598633
time for parepare:  0.019524574279785156
local_output_nid generation:  0.008819103240966797
local_in_edges_tensor generation:  0.025094270706176758
mini_batch_src_global generation:  0.020062923431396484
r_  generation:  0.19663333892822266
local_output_nid generation:  0.015081405639648438
local_in_edges_tensor generation:  0.023843765258789062
mini_batch_src_global generation:  0.025233983993530273
r_  generation:  0.20531344413757324
local_output_nid generation:  0.0158083438873291
local_in_edges_tensor generation:  0.019031524658203125
mini_batch_src_global generation:  0.023412466049194336
r_  generation:  0.20436954498291016
local_output_nid generation:  0.015374183654785156
local_in_edges_tensor generation:  0.01587200164794922
mini_batch_src_global generation:  0.024878978729248047
r_  generation:  0.2104194164276123
local_output_nid generation:  0.015126228332519531
local_in_edges_tensor generation:  0.017513751983642578
mini_batch_src_global generation:  0.025845766067504883
r_  generation:  0.21151375770568848
local_output_nid generation:  0.014713048934936523
local_in_edges_tensor generation:  0.013716697692871094
mini_batch_src_global generation:  0.026027441024780273
r_  generation:  0.20842432975769043
local_output_nid generation:  0.014457225799560547
local_in_edges_tensor generation:  0.015462636947631836
mini_batch_src_global generation:  0.034448862075805664
r_  generation:  0.21588397026062012
local_output_nid generation:  0.014365434646606445
local_in_edges_tensor generation:  0.014223337173461914
mini_batch_src_global generation:  0.026112794876098633
r_  generation:  0.2090740203857422
local_output_nid generation:  0.01437687873840332
local_in_edges_tensor generation:  0.015691757202148438
mini_batch_src_global generation:  0.0276186466217041
r_  generation:  0.2128310203552246
local_output_nid generation:  0.014381647109985352
local_in_edges_tensor generation:  0.017078876495361328
mini_batch_src_global generation:  0.026214122772216797
r_  generation:  0.21025562286376953
local_output_nid generation:  0.016231775283813477
local_in_edges_tensor generation:  0.019332408905029297
mini_batch_src_global generation:  0.02628636360168457
r_  generation:  0.21367859840393066
local_output_nid generation:  0.014461278915405273
local_in_edges_tensor generation:  0.015364646911621094
mini_batch_src_global generation:  0.026734352111816406
r_  generation:  0.21729087829589844
local_output_nid generation:  0.01453852653503418
local_in_edges_tensor generation:  0.01555633544921875
mini_batch_src_global generation:  0.026892423629760742
r_  generation:  0.21782684326171875
local_output_nid generation:  0.014386892318725586
local_in_edges_tensor generation:  0.02486586570739746
mini_batch_src_global generation:  0.029434919357299805
r_  generation:  0.2117600440979004
local_output_nid generation:  0.014707565307617188
local_in_edges_tensor generation:  0.013934850692749023
mini_batch_src_global generation:  0.028740644454956055
r_  generation:  0.21281790733337402
local_output_nid generation:  0.01498103141784668
local_in_edges_tensor generation:  0.019721508026123047
mini_batch_src_global generation:  0.0353391170501709
r_  generation:  0.220412015914917
----------------------check_connections_block total spend ----------------------------- 5.108498573303223
generate_one_block  0.28563976287841797
generate_one_block  0.2793593406677246
generate_one_block  0.2788066864013672
generate_one_block  0.2833130359649658
generate_one_block  0.28417110443115234
generate_one_block  0.27387237548828125
generate_one_block  0.3110237121582031
generate_one_block  0.2767965793609619
generate_one_block  0.2804408073425293
generate_one_block  0.2967557907104492
generate_one_block  0.2833414077758789
generate_one_block  0.28345751762390137
generate_one_block  0.2837393283843994
generate_one_block  0.2709331512451172
generate_one_block  0.27412915229797363
generate_one_block  0.28498339653015137
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.049153804779052734
gen group dst list time:  0.05891275405883789
time for parepare:  0.01819777488708496
local_output_nid generation:  0.02613067626953125
local_in_edges_tensor generation:  0.06326580047607422
mini_batch_src_global generation:  0.05484485626220703
r_  generation:  0.48754239082336426
local_output_nid generation:  0.03588080406188965
local_in_edges_tensor generation:  0.05264472961425781
mini_batch_src_global generation:  0.06557798385620117
r_  generation:  0.4476001262664795
local_output_nid generation:  0.03262662887573242
local_in_edges_tensor generation:  0.037886857986450195
mini_batch_src_global generation:  0.05350017547607422
r_  generation:  0.45272088050842285
local_output_nid generation:  0.03263282775878906
local_in_edges_tensor generation:  0.0334320068359375
mini_batch_src_global generation:  0.06126523017883301
r_  generation:  0.46915555000305176
local_output_nid generation:  0.035561323165893555
local_in_edges_tensor generation:  0.0854029655456543
mini_batch_src_global generation:  0.054139137268066406
r_  generation:  0.4638690948486328
local_output_nid generation:  0.03157401084899902
local_in_edges_tensor generation:  0.033477067947387695
mini_batch_src_global generation:  0.060777902603149414
r_  generation:  0.4668710231781006
local_output_nid generation:  0.03299117088317871
local_in_edges_tensor generation:  0.05099153518676758
mini_batch_src_global generation:  0.06778073310852051
r_  generation:  0.46738696098327637
local_output_nid generation:  0.03413701057434082
local_in_edges_tensor generation:  0.03724932670593262
mini_batch_src_global generation:  0.055854082107543945
r_  generation:  0.4606778621673584
local_output_nid generation:  0.03250598907470703
local_in_edges_tensor generation:  0.03261137008666992
mini_batch_src_global generation:  0.057929039001464844
r_  generation:  0.46020030975341797
local_output_nid generation:  0.03254556655883789
local_in_edges_tensor generation:  0.03256034851074219
mini_batch_src_global generation:  0.05877804756164551
r_  generation:  0.4564344882965088
local_output_nid generation:  0.032675743103027344
local_in_edges_tensor generation:  0.03281879425048828
mini_batch_src_global generation:  0.05507302284240723
r_  generation:  0.4658489227294922
local_output_nid generation:  0.03276681900024414
local_in_edges_tensor generation:  0.0325775146484375
mini_batch_src_global generation:  0.05601859092712402
r_  generation:  0.4618818759918213
local_output_nid generation:  0.032715797424316406
local_in_edges_tensor generation:  0.03694272041320801
mini_batch_src_global generation:  0.05459952354431152
r_  generation:  0.4660344123840332
local_output_nid generation:  0.03232717514038086
local_in_edges_tensor generation:  0.028804779052734375
mini_batch_src_global generation:  0.057672739028930664
r_  generation:  0.45950961112976074
local_output_nid generation:  0.03265094757080078
local_in_edges_tensor generation:  0.0289914608001709
mini_batch_src_global generation:  0.05534029006958008
r_  generation:  0.4791693687438965
local_output_nid generation:  0.03293490409851074
local_in_edges_tensor generation:  0.044121742248535156
mini_batch_src_global generation:  0.05618882179260254
r_  generation:  0.4641087055206299
----------------------check_connections_block total spend ----------------------------- 11.17299747467041
generate_one_block  0.6281943321228027
generate_one_block  0.5939855575561523
generate_one_block  0.5949203968048096
generate_one_block  0.5994386672973633
generate_one_block  0.5904996395111084
generate_one_block  0.5859894752502441
generate_one_block  0.5963780879974365
generate_one_block  0.5885636806488037
generate_one_block  0.6152615547180176
generate_one_block  0.6057162284851074
generate_one_block  0.6106407642364502
generate_one_block  0.5922956466674805
generate_one_block  0.59690260887146
generate_one_block  0.5811572074890137
generate_one_block  0.5846736431121826
generate_one_block  0.6066763401031494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.11667490005493164  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

connection checking time:  16.281496047973633
block generation total time  14.102056980133057
average batch blocks generation time:  0.881378561258316
block dataloader generation time/epoch 32.81511092185974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.09397745132446289  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154012, 128])
torch.Size([121943, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.147517204284668  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.09338998794555664  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154301, 128])
torch.Size([122193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.188204765319824  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.09406566619873047  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154428, 128])
torch.Size([122452, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.22306203842163  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.09380483627319336  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154799, 128])
torch.Size([123215, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 13.292532444000244  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7147216796875 GB
    Memory Allocated: 0.09412860870361328  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154654, 128])
torch.Size([122307, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7186279296875 GB
    Memory Allocated: 13.236657619476318  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7186279296875 GB
    Memory Allocated: 0.09360361099243164  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154763, 128])
torch.Size([122678, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7186279296875 GB
    Memory Allocated: 13.207404613494873  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7186279296875 GB
    Memory Allocated: 0.09413337707519531  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154309, 128])
torch.Size([122308, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.241419315338135  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09323406219482422  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154238, 128])
torch.Size([121907, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.131843566894531  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09400463104248047  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154584, 128])
torch.Size([122309, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.166947841644287  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09356355667114258  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154627, 128])
torch.Size([122495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.236101627349854  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09406566619873047  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154579, 128])
torch.Size([122794, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.239384651184082  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09369134902954102  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154785, 128])
torch.Size([122890, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.231184005737305  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09411144256591797  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154851, 128])
torch.Size([123161, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.282692909240723  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09320402145385742  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154133, 128])
torch.Size([121339, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.124313354492188  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.0940561294555664  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154508, 128])
torch.Size([122467, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.192451477050781  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 0.09371614456176758  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

torch.Size([154675, 128])
torch.Size([123452, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7205810546875 GB
    Memory Allocated: 13.30576753616333  GigaBytes
Max Memory Allocated: 13.338030815124512  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03298555314540863 |0.013093113899230957 |0.24546821415424347 |9.463727474212646e-05 |0.306866317987442 |0.0064351558685302734 |
----------------------------------------------------------pseudo_mini_loss sum 3.8056609630584717
Total (block generation + training)time/epoch 42.433884382247925
Training time/epoch 9.618510961532593
Training time without block to device /epoch 9.409021139144897
Training time without total dataloading part /epoch 8.845301866531372
load block tensor time/epoch 0.5277688503265381
block to device time/epoch 0.2094898223876953
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5093423
Number of first layer input nodes during this epoch:  2472246
