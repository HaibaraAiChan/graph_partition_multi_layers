Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648460751.1291502
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027242422103881836
random selection method range initialization spend 0.0064640045166015625
time for parepare:  0.018529176712036133
local_output_nid generation:  0.0011005401611328125
local_in_edges_tensor generation:  0.004441738128662109
mini_batch_src_global generation:  0.0015807151794433594
r_  generation:  0.010636329650878906
local_output_nid generation:  0.0012786388397216797
local_in_edges_tensor generation:  0.0009698867797851562
mini_batch_src_global generation:  0.0016641616821289062
r_  generation:  0.010175466537475586
local_output_nid generation:  0.00136566162109375
local_in_edges_tensor generation:  0.0008902549743652344
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.009758949279785156
local_output_nid generation:  0.001390218734741211
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.009329795837402344
local_output_nid generation:  0.0013840198516845703
local_in_edges_tensor generation:  0.0008401870727539062
mini_batch_src_global generation:  0.0009570121765136719
r_  generation:  0.009636163711547852
local_output_nid generation:  0.001394510269165039
local_in_edges_tensor generation:  0.0008172988891601562
mini_batch_src_global generation:  0.0010223388671875
r_  generation:  0.010051727294921875
local_output_nid generation:  0.0014085769653320312
local_in_edges_tensor generation:  0.0007903575897216797
mini_batch_src_global generation:  0.0010013580322265625
r_  generation:  0.009872674942016602
local_output_nid generation:  0.0013942718505859375
local_in_edges_tensor generation:  0.0008175373077392578
mini_batch_src_global generation:  0.0009942054748535156
r_  generation:  0.009938478469848633
local_output_nid generation:  0.001405954360961914
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.010036945343017578
local_output_nid generation:  0.0014543533325195312
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0009870529174804688
r_  generation:  0.009954690933227539
local_output_nid generation:  0.0014147758483886719
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.009786844253540039
local_output_nid generation:  0.0014314651489257812
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.010167360305786133
local_output_nid generation:  0.0014858245849609375
local_in_edges_tensor generation:  0.000823974609375
mini_batch_src_global generation:  0.001058340072631836
r_  generation:  0.009865283966064453
local_output_nid generation:  0.0014634132385253906
local_in_edges_tensor generation:  0.0007762908935546875
mini_batch_src_global generation:  0.0010364055633544922
r_  generation:  0.01020503044128418
local_output_nid generation:  0.0014600753784179688
local_in_edges_tensor generation:  0.0007922649383544922
mini_batch_src_global generation:  0.0010209083557128906
r_  generation:  0.009746551513671875
local_output_nid generation:  0.0014312267303466797
local_in_edges_tensor generation:  0.000762939453125
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.009703874588012695
local_output_nid generation:  0.0014853477478027344
local_in_edges_tensor generation:  0.0007686614990234375
mini_batch_src_global generation:  0.0009770393371582031
r_  generation:  0.009762763977050781
local_output_nid generation:  0.0014541149139404297
local_in_edges_tensor generation:  0.0007834434509277344
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.009846925735473633
local_output_nid generation:  0.0014607906341552734
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.01024937629699707
local_output_nid generation:  0.0014157295227050781
local_in_edges_tensor generation:  0.0007586479187011719
mini_batch_src_global generation:  0.0010068416595458984
r_  generation:  0.009783029556274414
local_output_nid generation:  0.0014357566833496094
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0010063648223876953
r_  generation:  0.010086297988891602
local_output_nid generation:  0.0014243125915527344
local_in_edges_tensor generation:  0.0007519721984863281
mini_batch_src_global generation:  0.0010318756103515625
r_  generation:  0.00993037223815918
local_output_nid generation:  0.0014214515686035156
local_in_edges_tensor generation:  0.0007610321044921875
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.009731531143188477
local_output_nid generation:  0.0014348030090332031
local_in_edges_tensor generation:  0.0008072853088378906
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.010347127914428711
local_output_nid generation:  0.0014231204986572266
local_in_edges_tensor generation:  0.0007550716400146484
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.010143756866455078
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0007491111755371094
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.009849071502685547
local_output_nid generation:  0.001447916030883789
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0010755062103271484
r_  generation:  0.010281801223754883
local_output_nid generation:  0.001439809799194336
local_in_edges_tensor generation:  0.0007584095001220703
mini_batch_src_global generation:  0.0010285377502441406
r_  generation:  0.01013636589050293
local_output_nid generation:  0.0014395713806152344
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  0.0010237693786621094
r_  generation:  0.009914875030517578
local_output_nid generation:  0.001443624496459961
local_in_edges_tensor generation:  0.005495548248291016
mini_batch_src_global generation:  0.0012638568878173828
r_  generation:  0.01018834114074707
local_output_nid generation:  0.001318216323852539
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.00112152099609375
r_  generation:  0.010286092758178711
local_output_nid generation:  0.0013806819915771484
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.0010683536529541016
r_  generation:  0.01044154167175293
----------------------check_connections_block total spend ----------------------------- 0.540269136428833
generate_one_block  0.01577901840209961
generate_one_block  0.015622854232788086
generate_one_block  0.015527963638305664
generate_one_block  0.014674901962280273
generate_one_block  0.015102386474609375
generate_one_block  0.015416383743286133
generate_one_block  0.015220403671264648
generate_one_block  0.01520085334777832
generate_one_block  0.015217304229736328
generate_one_block  0.015354394912719727
generate_one_block  0.014772891998291016
generate_one_block  0.015196800231933594
generate_one_block  0.014750242233276367
generate_one_block  0.015494823455810547
generate_one_block  0.014823675155639648
generate_one_block  0.014466047286987305
generate_one_block  0.014312744140625
generate_one_block  0.014640569686889648
generate_one_block  0.015489578247070312
generate_one_block  0.014639616012573242
generate_one_block  0.015299558639526367
generate_one_block  0.014698028564453125
generate_one_block  0.014661788940429688
generate_one_block  0.015130281448364258
generate_one_block  0.015072345733642578
generate_one_block  0.014496326446533203
generate_one_block  0.01518106460571289
generate_one_block  0.015065431594848633
generate_one_block  0.014597415924072266
generate_one_block  0.015163898468017578
generate_one_block  0.015589237213134766
generate_one_block  0.015402793884277344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03951716423034668
gen group dst list time:  0.02333521842956543
time for parepare:  0.01955723762512207
local_output_nid generation:  0.0052602291107177734
local_in_edges_tensor generation:  0.014875411987304688
mini_batch_src_global generation:  0.013025522232055664
r_  generation:  0.13408327102661133
local_output_nid generation:  0.010419845581054688
local_in_edges_tensor generation:  0.014230489730834961
mini_batch_src_global generation:  0.018421411514282227
r_  generation:  0.14529657363891602
local_output_nid generation:  0.010515928268432617
local_in_edges_tensor generation:  0.012740612030029297
mini_batch_src_global generation:  0.015698671340942383
r_  generation:  0.14649081230163574
local_output_nid generation:  0.009871244430541992
local_in_edges_tensor generation:  0.009701013565063477
mini_batch_src_global generation:  0.016282320022583008
r_  generation:  0.1399707794189453
local_output_nid generation:  0.010202169418334961
local_in_edges_tensor generation:  0.01352834701538086
mini_batch_src_global generation:  0.017053842544555664
r_  generation:  0.15088748931884766
local_output_nid generation:  0.010208368301391602
local_in_edges_tensor generation:  0.011585235595703125
mini_batch_src_global generation:  0.018335580825805664
r_  generation:  0.14923596382141113
local_output_nid generation:  0.01023101806640625
local_in_edges_tensor generation:  0.01028895378112793
mini_batch_src_global generation:  0.01788330078125
r_  generation:  0.1530458927154541
local_output_nid generation:  0.010226726531982422
local_in_edges_tensor generation:  0.012844085693359375
mini_batch_src_global generation:  0.018290996551513672
r_  generation:  0.14800548553466797
local_output_nid generation:  0.010264873504638672
local_in_edges_tensor generation:  0.012913703918457031
mini_batch_src_global generation:  0.018491029739379883
r_  generation:  0.15438246726989746
local_output_nid generation:  0.010232210159301758
local_in_edges_tensor generation:  0.011601924896240234
mini_batch_src_global generation:  0.01824641227722168
r_  generation:  0.15193462371826172
local_output_nid generation:  0.010010480880737305
local_in_edges_tensor generation:  0.010040998458862305
mini_batch_src_global generation:  0.01787567138671875
r_  generation:  0.15102624893188477
local_output_nid generation:  0.010229825973510742
local_in_edges_tensor generation:  0.011608123779296875
mini_batch_src_global generation:  0.018310546875
r_  generation:  0.15124821662902832
local_output_nid generation:  0.010184288024902344
local_in_edges_tensor generation:  0.0123443603515625
mini_batch_src_global generation:  0.01798844337463379
r_  generation:  0.14635896682739258
local_output_nid generation:  0.010283470153808594
local_in_edges_tensor generation:  0.01279306411743164
mini_batch_src_global generation:  0.019728899002075195
r_  generation:  0.15353083610534668
local_output_nid generation:  0.010040044784545898
local_in_edges_tensor generation:  0.011267662048339844
mini_batch_src_global generation:  0.01851177215576172
r_  generation:  0.14953136444091797
local_output_nid generation:  0.010291814804077148
local_in_edges_tensor generation:  0.010036468505859375
mini_batch_src_global generation:  0.0181124210357666
r_  generation:  0.15197348594665527
local_output_nid generation:  0.00991511344909668
local_in_edges_tensor generation:  0.011050939559936523
mini_batch_src_global generation:  0.017655134201049805
r_  generation:  0.14635562896728516
local_output_nid generation:  0.010059833526611328
local_in_edges_tensor generation:  0.01374673843383789
mini_batch_src_global generation:  0.0180206298828125
r_  generation:  0.149566650390625
local_output_nid generation:  0.010348081588745117
local_in_edges_tensor generation:  0.01161050796508789
mini_batch_src_global generation:  0.019812583923339844
r_  generation:  0.1569356918334961
local_output_nid generation:  0.010118722915649414
local_in_edges_tensor generation:  0.009830713272094727
mini_batch_src_global generation:  0.018439531326293945
r_  generation:  0.14829564094543457
local_output_nid generation:  0.010138750076293945
local_in_edges_tensor generation:  0.011497735977172852
mini_batch_src_global generation:  0.018072843551635742
r_  generation:  0.15161561965942383
local_output_nid generation:  0.010045051574707031
local_in_edges_tensor generation:  0.011665105819702148
mini_batch_src_global generation:  0.018500089645385742
r_  generation:  0.151533842086792
local_output_nid generation:  0.009996175765991211
local_in_edges_tensor generation:  0.012357950210571289
mini_batch_src_global generation:  0.017780542373657227
r_  generation:  0.14739036560058594
local_output_nid generation:  0.010310888290405273
local_in_edges_tensor generation:  0.011950016021728516
mini_batch_src_global generation:  0.019685745239257812
r_  generation:  0.1537642478942871
local_output_nid generation:  0.010243892669677734
local_in_edges_tensor generation:  0.011430740356445312
mini_batch_src_global generation:  0.018491268157958984
r_  generation:  0.1577131748199463
local_output_nid generation:  0.01001596450805664
local_in_edges_tensor generation:  0.011261940002441406
mini_batch_src_global generation:  0.018015623092651367
r_  generation:  0.14762258529663086
local_output_nid generation:  0.010323762893676758
local_in_edges_tensor generation:  0.011783361434936523
mini_batch_src_global generation:  0.020046234130859375
r_  generation:  0.15688443183898926
local_output_nid generation:  0.01034688949584961
local_in_edges_tensor generation:  0.010233163833618164
mini_batch_src_global generation:  0.018200159072875977
r_  generation:  0.15151333808898926
local_output_nid generation:  0.010027647018432617
local_in_edges_tensor generation:  0.011802196502685547
mini_batch_src_global generation:  0.018097639083862305
r_  generation:  0.15006327629089355
local_output_nid generation:  0.010213375091552734
local_in_edges_tensor generation:  0.011402606964111328
mini_batch_src_global generation:  0.018631458282470703
r_  generation:  0.15548348426818848
local_output_nid generation:  0.010431528091430664
local_in_edges_tensor generation:  0.014219999313354492
mini_batch_src_global generation:  0.019392728805541992
r_  generation:  0.15699481964111328
local_output_nid generation:  0.010413408279418945
local_in_edges_tensor generation:  0.012812376022338867
mini_batch_src_global generation:  0.01866912841796875
r_  generation:  0.15494084358215332
----------------------check_connections_block total spend ----------------------------- 7.209298849105835
generate_one_block  0.19148921966552734
generate_one_block  0.19941139221191406
generate_one_block  0.21432995796203613
generate_one_block  0.18503117561340332
generate_one_block  0.19289731979370117
generate_one_block  0.19669699668884277
generate_one_block  0.19099760055541992
generate_one_block  0.1906447410583496
generate_one_block  0.19600963592529297
generate_one_block  0.19084548950195312
generate_one_block  0.19004011154174805
generate_one_block  0.19448232650756836
generate_one_block  0.18326449394226074
generate_one_block  0.19486093521118164
generate_one_block  0.18835234642028809
generate_one_block  0.2104175090789795
generate_one_block  0.1820361614227295
generate_one_block  0.1892073154449463
generate_one_block  0.2015213966369629
generate_one_block  0.18258190155029297
generate_one_block  0.19002509117126465
generate_one_block  0.19101786613464355
generate_one_block  0.18630576133728027
generate_one_block  0.19745731353759766
generate_one_block  0.19180893898010254
generate_one_block  0.18203401565551758
generate_one_block  0.2012486457824707
generate_one_block  0.1884632110595703
generate_one_block  0.18903088569641113
generate_one_block  0.20136713981628418
generate_one_block  0.20479106903076172
generate_one_block  0.19417881965637207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.056737661361694336
gen group dst list time:  0.11568045616149902
time for parepare:  0.019881725311279297
local_output_nid generation:  0.022221803665161133
local_in_edges_tensor generation:  0.0531926155090332
mini_batch_src_global generation:  0.038260459899902344
r_  generation:  0.401259183883667
local_output_nid generation:  0.028555631637573242
local_in_edges_tensor generation:  0.0422666072845459
mini_batch_src_global generation:  0.047041893005371094
r_  generation:  0.41272902488708496
local_output_nid generation:  0.028207778930664062
local_in_edges_tensor generation:  0.03863644599914551
mini_batch_src_global generation:  0.0466160774230957
r_  generation:  0.4146580696105957
local_output_nid generation:  0.026467323303222656
local_in_edges_tensor generation:  0.03121209144592285
mini_batch_src_global generation:  0.04819536209106445
r_  generation:  0.41078662872314453
local_output_nid generation:  0.026564836502075195
local_in_edges_tensor generation:  0.03139686584472656
mini_batch_src_global generation:  0.050943613052368164
r_  generation:  0.4158191680908203
local_output_nid generation:  0.026380538940429688
local_in_edges_tensor generation:  0.027469873428344727
mini_batch_src_global generation:  0.04807758331298828
r_  generation:  0.41652798652648926
local_output_nid generation:  0.026361942291259766
local_in_edges_tensor generation:  0.028239965438842773
mini_batch_src_global generation:  0.04842948913574219
r_  generation:  0.41629600524902344
local_output_nid generation:  0.026576995849609375
local_in_edges_tensor generation:  0.03542351722717285
mini_batch_src_global generation:  0.04871702194213867
r_  generation:  0.4166848659515381
local_output_nid generation:  0.026383161544799805
local_in_edges_tensor generation:  0.03142809867858887
mini_batch_src_global generation:  0.05110883712768555
r_  generation:  0.41953325271606445
local_output_nid generation:  0.026144742965698242
local_in_edges_tensor generation:  0.027530908584594727
mini_batch_src_global generation:  0.04876971244812012
r_  generation:  0.41680288314819336
local_output_nid generation:  0.02618551254272461
local_in_edges_tensor generation:  0.027808189392089844
mini_batch_src_global generation:  0.048920392990112305
r_  generation:  0.41514062881469727
local_output_nid generation:  0.026247262954711914
local_in_edges_tensor generation:  0.034552812576293945
mini_batch_src_global generation:  0.04816102981567383
r_  generation:  0.41834282875061035
local_output_nid generation:  0.026163339614868164
local_in_edges_tensor generation:  0.03092169761657715
mini_batch_src_global generation:  0.04828691482543945
r_  generation:  0.4157888889312744
local_output_nid generation:  0.026450157165527344
local_in_edges_tensor generation:  0.03498649597167969
mini_batch_src_global generation:  0.0481112003326416
r_  generation:  0.4192502498626709
local_output_nid generation:  0.026153087615966797
local_in_edges_tensor generation:  0.03495597839355469
mini_batch_src_global generation:  0.0476686954498291
r_  generation:  0.4162251949310303
local_output_nid generation:  0.026063203811645508
local_in_edges_tensor generation:  0.027744293212890625
mini_batch_src_global generation:  0.04826617240905762
r_  generation:  0.4132382869720459
local_output_nid generation:  0.02591228485107422
local_in_edges_tensor generation:  0.027450084686279297
mini_batch_src_global generation:  0.04749751091003418
r_  generation:  0.4111368656158447
local_output_nid generation:  0.026270389556884766
local_in_edges_tensor generation:  0.03499937057495117
mini_batch_src_global generation:  0.0508272647857666
r_  generation:  0.41518306732177734
local_output_nid generation:  0.02635788917541504
local_in_edges_tensor generation:  0.0350499153137207
mini_batch_src_global generation:  0.0476231575012207
r_  generation:  0.43059659004211426
local_output_nid generation:  0.02653217315673828
local_in_edges_tensor generation:  0.03896021842956543
mini_batch_src_global generation:  0.04797720909118652
r_  generation:  0.412982702255249
local_output_nid generation:  0.026377439498901367
local_in_edges_tensor generation:  0.028260231018066406
mini_batch_src_global generation:  0.05006575584411621
r_  generation:  0.41826653480529785
local_output_nid generation:  0.0266726016998291
local_in_edges_tensor generation:  0.03498506546020508
mini_batch_src_global generation:  0.04781484603881836
r_  generation:  0.4205780029296875
local_output_nid generation:  0.0262300968170166
local_in_edges_tensor generation:  0.02738213539123535
mini_batch_src_global generation:  0.04743599891662598
r_  generation:  0.41303420066833496
local_output_nid generation:  0.02642989158630371
local_in_edges_tensor generation:  0.02743840217590332
mini_batch_src_global generation:  0.04803943634033203
r_  generation:  0.4320552349090576
local_output_nid generation:  0.02652263641357422
local_in_edges_tensor generation:  0.03501486778259277
mini_batch_src_global generation:  0.04749608039855957
r_  generation:  0.4211244583129883
local_output_nid generation:  0.026154279708862305
local_in_edges_tensor generation:  0.027063369750976562
mini_batch_src_global generation:  0.04774069786071777
r_  generation:  0.4186439514160156
local_output_nid generation:  0.026394367218017578
local_in_edges_tensor generation:  0.031002521514892578
mini_batch_src_global generation:  0.05022406578063965
r_  generation:  0.4194672107696533
local_output_nid generation:  0.02650141716003418
local_in_edges_tensor generation:  0.03519439697265625
mini_batch_src_global generation:  0.048078060150146484
r_  generation:  0.4184606075286865
local_output_nid generation:  0.026287317276000977
local_in_edges_tensor generation:  0.027659893035888672
mini_batch_src_global generation:  0.04720497131347656
r_  generation:  0.4216480255126953
local_output_nid generation:  0.026450157165527344
local_in_edges_tensor generation:  0.03841114044189453
mini_batch_src_global generation:  0.0724790096282959
r_  generation:  0.4207942485809326
local_output_nid generation:  0.026424646377563477
local_in_edges_tensor generation:  0.039780616760253906
mini_batch_src_global generation:  0.0472407341003418
r_  generation:  0.41887497901916504
local_output_nid generation:  0.026541948318481445
local_in_edges_tensor generation:  0.03126215934753418
mini_batch_src_global generation:  0.05189347267150879
r_  generation:  0.4167013168334961
----------------------check_connections_block total spend ----------------------------- 19.663410902023315
generate_one_block  0.6136178970336914
generate_one_block  0.5417749881744385
generate_one_block  0.535214900970459
generate_one_block  0.5285739898681641
generate_one_block  0.5403311252593994
generate_one_block  0.5435099601745605
generate_one_block  0.5396504402160645
generate_one_block  0.5404448509216309
generate_one_block  0.5381917953491211
generate_one_block  0.5363707542419434
generate_one_block  0.527184009552002
generate_one_block  0.5380399227142334
generate_one_block  0.5302984714508057
generate_one_block  0.5740735530853271
generate_one_block  0.5310084819793701
generate_one_block  0.5216999053955078
generate_one_block  0.5253908634185791
generate_one_block  0.5325069427490234
generate_one_block  0.5510280132293701
generate_one_block  0.5399429798126221
generate_one_block  0.5428972244262695
generate_one_block  0.5338573455810547
generate_one_block  0.5313174724578857
generate_one_block  0.5334908962249756
generate_one_block  0.5365238189697266
generate_one_block  0.5172369480133057
generate_one_block  0.5389444828033447
generate_one_block  0.5396249294281006
generate_one_block  0.5256993770599365
generate_one_block  0.5414130687713623
generate_one_block  0.5844354629516602
generate_one_block  0.5482008457183838
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  26.87270975112915
block generation total time  23.485342502593994
average batch blocks generation time:  0.7339169532060623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08514642715454102  GigaBytes
Max Memory Allocated: 0.08514642715454102  GigaBytes

torch.Size([146084, 128])
torch.Size([102380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7283935546875 GB
    Memory Allocated: 13.188711643218994  GigaBytes
Max Memory Allocated: 13.205793380737305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1522216796875 GB
    Memory Allocated: 0.08765792846679688  GigaBytes
Max Memory Allocated: 13.205793380737305  GigaBytes

torch.Size([146801, 128])
torch.Size([103511, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 13.449141502380371  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 0.08790016174316406  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146748, 128])
torch.Size([103033, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.347086906433105  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08742141723632812  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146637, 128])
torch.Size([102252, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.07860803604126  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.0878896713256836  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146573, 128])
torch.Size([103304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.340024471282959  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08761405944824219  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146087, 128])
torch.Size([102200, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.319639205932617  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08788490295410156  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146413, 128])
torch.Size([102570, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.336566925048828  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08754348754882812  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146602, 128])
torch.Size([102869, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.259466648101807  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08790731430053711  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146213, 128])
torch.Size([102859, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.394048690795898  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08659791946411133  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([145833, 128])
torch.Size([102015, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.287004470825195  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08784914016723633  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146254, 128])
torch.Size([101559, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.221989631652832  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.0875558853149414  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146489, 128])
torch.Size([102852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.26951789855957  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.0878000259399414  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146059, 128])
torch.Size([101707, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.047653198242188  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08760356903076172  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146940, 128])
torch.Size([103378, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.379921913146973  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08783674240112305  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146162, 128])
torch.Size([101549, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.1587233543396  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08745098114013672  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146250, 128])
torch.Size([102349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.124745845794678  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08777952194213867  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146235, 128])
torch.Size([101271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 12.967008113861084  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.087493896484375  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146046, 128])
torch.Size([102295, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.15366792678833  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08793258666992188  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146256, 128])
torch.Size([102686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.394543170928955  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08742523193359375  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146777, 128])
torch.Size([102726, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.091172218322754  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.087860107421875  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146275, 128])
torch.Size([102180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.236321926116943  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08754158020019531  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146653, 128])
torch.Size([102921, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.281901836395264  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08781051635742188  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([145907, 128])
torch.Size([101095, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.020304679870605  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08760738372802734  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146387, 128])
torch.Size([102442, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.343946933746338  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08787822723388672  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([145634, 128])
torch.Size([101882, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 13.289863109588623  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08740615844726562  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146231, 128])
torch.Size([101122, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 12.985387325286865  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 0.08790826797485352  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146083, 128])
torch.Size([102361, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 13.347488403320312  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.08750438690185547  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146557, 128])
torch.Size([102949, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 13.206309795379639  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.08782243728637695  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146249, 128])
torch.Size([101418, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 13.091493606567383  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.087615966796875  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([145886, 128])
torch.Size([102305, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 13.351666450500488  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.08792257308959961  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146099, 128])
torch.Size([102533, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 13.3515944480896  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.08759117126464844  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146463, 128])
torch.Size([103227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 13.367311000823975  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03301958739757538 |0.02878967672586441 |0.41438787430524826 |0.00010321289300918579 |0.6916153281927109 |0.010774612426757812 |
----------------------------------------------------------pseudo_mini_loss sum 4.997934341430664
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8797910
Number of first layer input nodes during this epoch:  4681883
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.10901117324829102  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02377939224243164
random selection method range initialization spend 0.005751132965087891
time for parepare:  0.019318103790283203
local_output_nid generation:  0.001459360122680664
local_in_edges_tensor generation:  0.005834102630615234
mini_batch_src_global generation:  0.0047512054443359375
r_  generation:  0.022809743881225586
local_output_nid generation:  0.001957416534423828
local_in_edges_tensor generation:  0.0012023448944091797
mini_batch_src_global generation:  0.001924753189086914
r_  generation:  0.010863304138183594
local_output_nid generation:  0.0017108917236328125
local_in_edges_tensor generation:  0.0010161399841308594
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.01003885269165039
local_output_nid generation:  0.0017080307006835938
local_in_edges_tensor generation:  0.0009531974792480469
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.009671688079833984
local_output_nid generation:  0.0016918182373046875
local_in_edges_tensor generation:  0.0009760856628417969
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.010442018508911133
local_output_nid generation:  0.0017092227935791016
local_in_edges_tensor generation:  0.0009605884552001953
mini_batch_src_global generation:  0.0012764930725097656
r_  generation:  0.010432720184326172
local_output_nid generation:  0.0016753673553466797
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0011386871337890625
r_  generation:  0.010435104370117188
local_output_nid generation:  0.0017130374908447266
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.0100860595703125
local_output_nid generation:  0.0016841888427734375
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010249137878417969
local_output_nid generation:  0.001684427261352539
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.001241922378540039
r_  generation:  0.01074528694152832
local_output_nid generation:  0.0017099380493164062
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.01044607162475586
local_output_nid generation:  0.001708984375
local_in_edges_tensor generation:  0.0008876323699951172
mini_batch_src_global generation:  0.001096487045288086
r_  generation:  0.010184049606323242
local_output_nid generation:  0.0016798973083496094
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010500192642211914
local_output_nid generation:  0.0017290115356445312
local_in_edges_tensor generation:  0.000926971435546875
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.010373830795288086
local_output_nid generation:  0.0017070770263671875
local_in_edges_tensor generation:  0.0009512901306152344
mini_batch_src_global generation:  0.0011501312255859375
r_  generation:  0.010501384735107422
local_output_nid generation:  0.0016984939575195312
local_in_edges_tensor generation:  0.0008757114410400391
mini_batch_src_global generation:  0.0010809898376464844
r_  generation:  0.01021885871887207
local_output_nid generation:  0.0017786026000976562
local_in_edges_tensor generation:  0.0009086132049560547
mini_batch_src_global generation:  0.0010988712310791016
r_  generation:  0.010111570358276367
local_output_nid generation:  0.0017032623291015625
local_in_edges_tensor generation:  0.0009167194366455078
mini_batch_src_global generation:  0.0012006759643554688
r_  generation:  0.010556697845458984
local_output_nid generation:  0.0016787052154541016
local_in_edges_tensor generation:  0.0009379386901855469
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.010456562042236328
local_output_nid generation:  0.0017406940460205078
local_in_edges_tensor generation:  0.0009396076202392578
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.01078939437866211
local_output_nid generation:  0.0016622543334960938
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0012805461883544922
r_  generation:  0.01074671745300293
local_output_nid generation:  0.0017170906066894531
local_in_edges_tensor generation:  0.0008873939514160156
mini_batch_src_global generation:  0.0013210773468017578
r_  generation:  0.010483503341674805
local_output_nid generation:  0.0016722679138183594
local_in_edges_tensor generation:  0.0008800029754638672
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010236501693725586
local_output_nid generation:  0.0017015933990478516
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.001153707504272461
r_  generation:  0.010411500930786133
local_output_nid generation:  0.0016732215881347656
local_in_edges_tensor generation:  0.0008587837219238281
mini_batch_src_global generation:  0.0013496875762939453
r_  generation:  0.010568857192993164
local_output_nid generation:  0.0016474723815917969
local_in_edges_tensor generation:  0.0008976459503173828
mini_batch_src_global generation:  0.0011265277862548828
r_  generation:  0.010451316833496094
local_output_nid generation:  0.0017077922821044922
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.001119852066040039
r_  generation:  0.010432243347167969
local_output_nid generation:  0.001657247543334961
local_in_edges_tensor generation:  0.0008687973022460938
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010441780090332031
local_output_nid generation:  0.0016639232635498047
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0012083053588867188
r_  generation:  0.01074981689453125
local_output_nid generation:  0.0016782283782958984
local_in_edges_tensor generation:  0.0009026527404785156
mini_batch_src_global generation:  0.0011985301971435547
r_  generation:  0.010321378707885742
local_output_nid generation:  0.0016710758209228516
local_in_edges_tensor generation:  0.0008747577667236328
mini_batch_src_global generation:  0.0011487007141113281
r_  generation:  0.01040029525756836
local_output_nid generation:  0.001646280288696289
local_in_edges_tensor generation:  0.0008723735809326172
mini_batch_src_global generation:  0.0011746883392333984
r_  generation:  0.010619163513183594
----------------------check_connections_block total spend ----------------------------- 0.5958044528961182
generate_one_block  0.026590347290039062
generate_one_block  0.020632028579711914
generate_one_block  0.018782615661621094
generate_one_block  0.017565488815307617
generate_one_block  0.018279075622558594
generate_one_block  0.018210649490356445
generate_one_block  0.01832127571105957
generate_one_block  0.01748061180114746
generate_one_block  0.017795324325561523
generate_one_block  0.01824474334716797
generate_one_block  0.017615556716918945
generate_one_block  0.017673015594482422
generate_one_block  0.01822495460510254
generate_one_block  0.017277240753173828
generate_one_block  0.01762533187866211
generate_one_block  0.0172116756439209
generate_one_block  0.016886472702026367
generate_one_block  0.018264055252075195
generate_one_block  0.01771855354309082
generate_one_block  0.018140554428100586
generate_one_block  0.01797175407409668
generate_one_block  0.01777172088623047
generate_one_block  0.017401933670043945
generate_one_block  0.017322063446044922
generate_one_block  0.01767134666442871
generate_one_block  0.01743316650390625
generate_one_block  0.017280101776123047
generate_one_block  0.01742696762084961
generate_one_block  0.018082618713378906
generate_one_block  0.0169680118560791
generate_one_block  0.017525196075439453
generate_one_block  0.017820119857788086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03229880332946777
gen group dst list time:  0.022260665893554688
time for parepare:  0.019682645797729492
local_output_nid generation:  0.006709575653076172
local_in_edges_tensor generation:  0.012256383895874023
mini_batch_src_global generation:  0.019245147705078125
r_  generation:  0.14676308631896973
local_output_nid generation:  0.009868860244750977
local_in_edges_tensor generation:  0.010787725448608398
mini_batch_src_global generation:  0.016645193099975586
r_  generation:  0.14084815979003906
local_output_nid generation:  0.01038813591003418
local_in_edges_tensor generation:  0.029589176177978516
mini_batch_src_global generation:  0.015983104705810547
r_  generation:  0.15413355827331543
local_output_nid generation:  0.013109683990478516
local_in_edges_tensor generation:  0.01085209846496582
mini_batch_src_global generation:  0.016386747360229492
r_  generation:  0.15248394012451172
local_output_nid generation:  0.01072835922241211
local_in_edges_tensor generation:  0.01069331169128418
mini_batch_src_global generation:  0.017787456512451172
r_  generation:  0.160308837890625
local_output_nid generation:  0.010350942611694336
local_in_edges_tensor generation:  0.009856462478637695
mini_batch_src_global generation:  0.01922750473022461
r_  generation:  0.1608600616455078
local_output_nid generation:  0.010295867919921875
local_in_edges_tensor generation:  0.009779691696166992
mini_batch_src_global generation:  0.01869487762451172
r_  generation:  0.16214966773986816
local_output_nid generation:  0.009996175765991211
local_in_edges_tensor generation:  0.009458303451538086
mini_batch_src_global generation:  0.018269777297973633
r_  generation:  0.18590712547302246
local_output_nid generation:  0.015064477920532227
local_in_edges_tensor generation:  0.009745359420776367
mini_batch_src_global generation:  0.021884441375732422
r_  generation:  0.1641247272491455
local_output_nid generation:  0.010663270950317383
local_in_edges_tensor generation:  0.012221574783325195
mini_batch_src_global generation:  0.019150733947753906
r_  generation:  0.1672964096069336
local_output_nid generation:  0.01053309440612793
local_in_edges_tensor generation:  0.008475065231323242
mini_batch_src_global generation:  0.018851280212402344
r_  generation:  0.1639719009399414
local_output_nid generation:  0.010443449020385742
local_in_edges_tensor generation:  0.008649349212646484
mini_batch_src_global generation:  0.020266056060791016
r_  generation:  0.15671443939208984
local_output_nid generation:  0.011978864669799805
local_in_edges_tensor generation:  0.011931896209716797
mini_batch_src_global generation:  0.01928853988647461
r_  generation:  0.17089509963989258
local_output_nid generation:  0.012607812881469727
local_in_edges_tensor generation:  0.013592720031738281
mini_batch_src_global generation:  0.019191503524780273
r_  generation:  0.15352988243103027
local_output_nid generation:  0.010676383972167969
local_in_edges_tensor generation:  0.010795116424560547
mini_batch_src_global generation:  0.0206911563873291
r_  generation:  0.15624070167541504
local_output_nid generation:  0.010900259017944336
local_in_edges_tensor generation:  0.008939743041992188
mini_batch_src_global generation:  0.018430471420288086
r_  generation:  0.1543114185333252
local_output_nid generation:  0.010504007339477539
local_in_edges_tensor generation:  0.008127450942993164
mini_batch_src_global generation:  0.017977237701416016
r_  generation:  0.15015506744384766
local_output_nid generation:  0.011070489883422852
local_in_edges_tensor generation:  0.010287046432495117
mini_batch_src_global generation:  0.01825571060180664
r_  generation:  0.1565089225769043
local_output_nid generation:  0.010926008224487305
local_in_edges_tensor generation:  0.01127767562866211
mini_batch_src_global generation:  0.02003931999206543
r_  generation:  0.15930557250976562
local_output_nid generation:  0.010758161544799805
local_in_edges_tensor generation:  0.009975671768188477
mini_batch_src_global generation:  0.019252777099609375
r_  generation:  0.16220879554748535
local_output_nid generation:  0.010576009750366211
local_in_edges_tensor generation:  0.011281251907348633
mini_batch_src_global generation:  0.019362688064575195
r_  generation:  0.16051006317138672
local_output_nid generation:  0.010593891143798828
local_in_edges_tensor generation:  0.008747339248657227
mini_batch_src_global generation:  0.018886566162109375
r_  generation:  0.16055822372436523
local_output_nid generation:  0.01035308837890625
local_in_edges_tensor generation:  0.00901341438293457
mini_batch_src_global generation:  0.018805265426635742
r_  generation:  0.1555330753326416
local_output_nid generation:  0.010412454605102539
local_in_edges_tensor generation:  0.009629964828491211
mini_batch_src_global generation:  0.018296241760253906
r_  generation:  0.15415692329406738
local_output_nid generation:  0.012658834457397461
local_in_edges_tensor generation:  0.010236740112304688
mini_batch_src_global generation:  0.02026677131652832
r_  generation:  0.1686232089996338
local_output_nid generation:  0.010431051254272461
local_in_edges_tensor generation:  0.00992584228515625
mini_batch_src_global generation:  0.018950462341308594
r_  generation:  0.16069436073303223
local_output_nid generation:  0.010149478912353516
local_in_edges_tensor generation:  0.008617401123046875
mini_batch_src_global generation:  0.018570899963378906
r_  generation:  0.1585693359375
local_output_nid generation:  0.010358333587646484
local_in_edges_tensor generation:  0.009615898132324219
mini_batch_src_global generation:  0.01840972900390625
r_  generation:  0.15730977058410645
local_output_nid generation:  0.010550975799560547
local_in_edges_tensor generation:  0.010032176971435547
mini_batch_src_global generation:  0.0193023681640625
r_  generation:  0.1627039909362793
local_output_nid generation:  0.010015487670898438
local_in_edges_tensor generation:  0.00834512710571289
mini_batch_src_global generation:  0.018431901931762695
r_  generation:  0.1563091278076172
local_output_nid generation:  0.010099649429321289
local_in_edges_tensor generation:  0.00908041000366211
mini_batch_src_global generation:  0.019133567810058594
r_  generation:  0.1656043529510498
local_output_nid generation:  0.010247230529785156
local_in_edges_tensor generation:  0.015097856521606445
mini_batch_src_global generation:  0.020671844482421875
r_  generation:  0.17320036888122559
----------------------check_connections_block total spend ----------------------------- 7.577080488204956
generate_one_block  0.2361459732055664
generate_one_block  0.2024390697479248
generate_one_block  0.20618796348571777
generate_one_block  0.20253801345825195
generate_one_block  0.24263644218444824
generate_one_block  0.21042323112487793
generate_one_block  0.20934700965881348
generate_one_block  0.19920682907104492
generate_one_block  0.2087090015411377
generate_one_block  0.21466445922851562
generate_one_block  0.20177626609802246
generate_one_block  0.2006394863128662
generate_one_block  0.21558022499084473
generate_one_block  0.2003645896911621
generate_one_block  0.20532774925231934
generate_one_block  0.20177793502807617
generate_one_block  0.20403361320495605
generate_one_block  0.20633149147033691
generate_one_block  0.2170543670654297
generate_one_block  0.21935486793518066
generate_one_block  0.21413707733154297
generate_one_block  0.2066338062286377
generate_one_block  0.20319175720214844
generate_one_block  0.20278167724609375
generate_one_block  0.20997381210327148
generate_one_block  0.20382070541381836
generate_one_block  0.20137333869934082
generate_one_block  0.20464468002319336
generate_one_block  0.21454143524169922
generate_one_block  0.19597649574279785
generate_one_block  0.20996856689453125
generate_one_block  0.2151932716369629
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04642987251281738
gen group dst list time:  0.10355854034423828
time for parepare:  0.018701553344726562
local_output_nid generation:  0.025713205337524414
local_in_edges_tensor generation:  0.052549123764038086
mini_batch_src_global generation:  0.0402531623840332
r_  generation:  0.41891050338745117
local_output_nid generation:  0.032953500747680664
local_in_edges_tensor generation:  0.046219825744628906
mini_batch_src_global generation:  0.052521467208862305
r_  generation:  0.415712833404541
local_output_nid generation:  0.031433820724487305
local_in_edges_tensor generation:  0.03620338439941406
mini_batch_src_global generation:  0.047304630279541016
r_  generation:  0.4205033779144287
local_output_nid generation:  0.028690338134765625
local_in_edges_tensor generation:  0.03429055213928223
mini_batch_src_global generation:  0.050112009048461914
r_  generation:  0.4162442684173584
local_output_nid generation:  0.02903890609741211
local_in_edges_tensor generation:  0.03123760223388672
mini_batch_src_global generation:  0.04783439636230469
r_  generation:  0.42617177963256836
local_output_nid generation:  0.028584957122802734
local_in_edges_tensor generation:  0.030511856079101562
mini_batch_src_global generation:  0.04843735694885254
r_  generation:  0.41974854469299316
local_output_nid generation:  0.028616905212402344
local_in_edges_tensor generation:  0.034300804138183594
mini_batch_src_global generation:  0.05054020881652832
r_  generation:  0.4356727600097656
local_output_nid generation:  0.028498172760009766
local_in_edges_tensor generation:  0.02679896354675293
mini_batch_src_global generation:  0.0480189323425293
r_  generation:  0.42003440856933594
local_output_nid generation:  0.028771638870239258
local_in_edges_tensor generation:  0.028103113174438477
mini_batch_src_global generation:  0.05430722236633301
r_  generation:  0.4288487434387207
local_output_nid generation:  0.029160261154174805
local_in_edges_tensor generation:  0.034696340560913086
mini_batch_src_global generation:  0.048339128494262695
r_  generation:  0.42429685592651367
local_output_nid generation:  0.029142379760742188
local_in_edges_tensor generation:  0.026975631713867188
mini_batch_src_global generation:  0.04853200912475586
r_  generation:  0.4247274398803711
local_output_nid generation:  0.0288693904876709
local_in_edges_tensor generation:  0.02986001968383789
mini_batch_src_global generation:  0.047925710678100586
r_  generation:  0.42000722885131836
local_output_nid generation:  0.028835773468017578
local_in_edges_tensor generation:  0.039423227310180664
mini_batch_src_global generation:  0.04782390594482422
r_  generation:  0.43056797981262207
local_output_nid generation:  0.028411149978637695
local_in_edges_tensor generation:  0.02711653709411621
mini_batch_src_global generation:  0.04784822463989258
r_  generation:  0.4195823669433594
local_output_nid generation:  0.028725624084472656
local_in_edges_tensor generation:  0.026680707931518555
mini_batch_src_global generation:  0.050484657287597656
r_  generation:  0.4254496097564697
local_output_nid generation:  0.0287168025970459
local_in_edges_tensor generation:  0.030483245849609375
mini_batch_src_global generation:  0.0478057861328125
r_  generation:  0.42417073249816895
local_output_nid generation:  0.02975916862487793
local_in_edges_tensor generation:  0.029964447021484375
mini_batch_src_global generation:  0.04763507843017578
r_  generation:  0.42151594161987305
local_output_nid generation:  0.02892470359802246
local_in_edges_tensor generation:  0.03455376625061035
mini_batch_src_global generation:  0.04771709442138672
r_  generation:  0.42734622955322266
local_output_nid generation:  0.029124736785888672
local_in_edges_tensor generation:  0.038332223892211914
mini_batch_src_global generation:  0.047518014907836914
r_  generation:  0.4313497543334961
local_output_nid generation:  0.028841495513916016
local_in_edges_tensor generation:  0.031053543090820312
mini_batch_src_global generation:  0.049082279205322266
r_  generation:  0.42232608795166016
local_output_nid generation:  0.028741121292114258
local_in_edges_tensor generation:  0.02720475196838379
mini_batch_src_global generation:  0.04845762252807617
r_  generation:  0.4270040988922119
local_output_nid generation:  0.029048919677734375
local_in_edges_tensor generation:  0.033679962158203125
mini_batch_src_global generation:  0.049241065979003906
r_  generation:  0.4267268180847168
local_output_nid generation:  0.028917789459228516
local_in_edges_tensor generation:  0.03089618682861328
mini_batch_src_global generation:  0.048689842224121094
r_  generation:  0.42853498458862305
local_output_nid generation:  0.028799057006835938
local_in_edges_tensor generation:  0.03280448913574219
mini_batch_src_global generation:  0.04825592041015625
r_  generation:  0.42762279510498047
local_output_nid generation:  0.029638051986694336
local_in_edges_tensor generation:  0.030994176864624023
mini_batch_src_global generation:  0.05370378494262695
r_  generation:  0.44028544425964355
local_output_nid generation:  0.030125856399536133
local_in_edges_tensor generation:  0.0367436408996582
mini_batch_src_global generation:  0.05206942558288574
r_  generation:  0.42593884468078613
local_output_nid generation:  0.02847909927368164
local_in_edges_tensor generation:  0.033054351806640625
mini_batch_src_global generation:  0.04776120185852051
r_  generation:  0.4242978096008301
local_output_nid generation:  0.028963327407836914
local_in_edges_tensor generation:  0.030125856399536133
mini_batch_src_global generation:  0.04860854148864746
r_  generation:  0.42863965034484863
local_output_nid generation:  0.028652191162109375
local_in_edges_tensor generation:  0.033411502838134766
mini_batch_src_global generation:  0.04877972602844238
r_  generation:  0.4194154739379883
local_output_nid generation:  0.028316974639892578
local_in_edges_tensor generation:  0.029067277908325195
mini_batch_src_global generation:  0.04794621467590332
r_  generation:  0.4149620532989502
local_output_nid generation:  0.028944015502929688
local_in_edges_tensor generation:  0.02905106544494629
mini_batch_src_global generation:  0.048764944076538086
r_  generation:  0.42332887649536133
local_output_nid generation:  0.02899479866027832
local_in_edges_tensor generation:  0.032369136810302734
mini_batch_src_global generation:  0.0578465461730957
r_  generation:  0.42546820640563965
----------------------check_connections_block total spend ----------------------------- 20.0148708820343
generate_one_block  0.5908570289611816
generate_one_block  0.551281213760376
generate_one_block  0.5614213943481445
generate_one_block  0.563612699508667
generate_one_block  0.6665079593658447
generate_one_block  0.5554959774017334
generate_one_block  0.5682094097137451
generate_one_block  0.5644886493682861
generate_one_block  0.5803046226501465
generate_one_block  0.5666759014129639
generate_one_block  0.5518100261688232
generate_one_block  0.5655806064605713
generate_one_block  0.5843918323516846
generate_one_block  0.5516843795776367
generate_one_block  0.5619611740112305
generate_one_block  0.5848555564880371
generate_one_block  0.5477900505065918
generate_one_block  0.6023135185241699
generate_one_block  0.5865237712860107
generate_one_block  0.5711026191711426
generate_one_block  0.552886962890625
generate_one_block  0.5668759346008301
generate_one_block  0.5960302352905273
generate_one_block  0.5629630088806152
generate_one_block  0.575186014175415
generate_one_block  0.5695233345031738
generate_one_block  0.5608799457550049
generate_one_block  0.5789711475372314
generate_one_block  0.549797773361206
generate_one_block  0.5485866069793701
generate_one_block  0.5669901371002197
generate_one_block  0.5741744041442871
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.10901117324829102  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

connection checking time:  27.591951370239258
block generation total time  24.966509103775024
average batch blocks generation time:  0.7802034094929695
block dataloader generation time/epoch 55.85459041595459
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 0.09149169921875  GigaBytes
Max Memory Allocated: 13.466663360595703  GigaBytes

torch.Size([146856, 128])
torch.Size([104449, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.583836078643799  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.08989858627319336  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145983, 128])
torch.Size([101083, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 12.981573581695557  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09140634536743164  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145665, 128])
torch.Size([101882, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.269041538238525  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09100055694580078  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146499, 128])
torch.Size([102615, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.197347640991211  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09141349792480469  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([147088, 128])
torch.Size([103384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.361532211303711  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09010887145996094  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145812, 128])
torch.Size([101512, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.291011810302734  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09141397476196289  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146163, 128])
torch.Size([102701, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.34682559967041  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09099006652832031  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146439, 128])
torch.Size([101648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.101049423217773  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09141159057617188  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146331, 128])
torch.Size([102825, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.363783836364746  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09122180938720703  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146212, 128])
torch.Size([102621, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.435149192810059  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09137725830078125  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146354, 128])
torch.Size([101862, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.223718166351318  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.0900106430053711  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145860, 128])
torch.Size([101649, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.15656042098999  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09144067764282227  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146811, 128])
torch.Size([103548, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.459568500518799  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.08980655670166016  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145674, 128])
torch.Size([101172, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.009632587432861  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.0913839340209961  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145808, 128])
torch.Size([101903, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.21692180633545  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09096622467041016  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146307, 128])
torch.Size([102244, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.126479148864746  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09126472473144531  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146733, 128])
torch.Size([101546, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 12.92516279220581  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09101009368896484  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146959, 128])
torch.Size([103114, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.221773147583008  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09141206741333008  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146951, 128])
torch.Size([103685, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.395311832427979  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09119892120361328  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146440, 128])
torch.Size([103114, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.428294658660889  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09143781661987305  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146363, 128])
torch.Size([102428, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.38784122467041  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.091094970703125  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([147186, 128])
torch.Size([103364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.333663940429688  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09135675430297852  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146111, 128])
torch.Size([102721, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.298775672912598  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.08991479873657227  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145765, 128])
torch.Size([101415, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.112634658813477  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09138774871826172  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146463, 128])
torch.Size([102587, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.260213851928711  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09102535247802734  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146767, 128])
torch.Size([102669, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.22049856185913  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.0913395881652832  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146260, 128])
torch.Size([101239, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.061454772949219  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09101486206054688  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146211, 128])
torch.Size([102698, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.208240032196045  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09140920639038086  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146349, 128])
torch.Size([102266, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.252947330474854  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.08968925476074219  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145612, 128])
torch.Size([100732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 12.94315481185913  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09137916564941406  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([146285, 128])
torch.Size([102185, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.244625091552734  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 0.09117507934570312  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

torch.Size([145834, 128])
torch.Size([102384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4881591796875 GB
    Memory Allocated: 13.3653883934021  GigaBytes
Max Memory Allocated: 13.602381229400635  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026731230318546295 |0.016485892236232758 |0.3944747522473335 |9.814649820327759e-05 |0.6753504648804665 |0.0065953731536865234 |
----------------------------------------------------------pseudo_mini_loss sum 3.314481735229492
Total (block generation + training)time/epoch 91.52842688560486
Training time/epoch 35.67343997955322
Training time without block to device /epoch 35.145891427993774
Training time without total dataloading part /epoch 34.24414300918579
load block tensor time/epoch 0.8553993701934814
block to device time/epoch 0.5275485515594482
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8797310
Number of first layer input nodes during this epoch:  4682151
