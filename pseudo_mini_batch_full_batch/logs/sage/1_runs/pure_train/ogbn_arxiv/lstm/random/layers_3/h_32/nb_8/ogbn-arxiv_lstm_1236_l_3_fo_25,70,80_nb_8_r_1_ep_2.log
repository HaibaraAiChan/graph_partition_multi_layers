Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648454897.2963355
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026244401931762695
random selection method range initialization spend 0.005686283111572266
time for parepare:  0.019565820693969727
local_output_nid generation:  0.004232645034790039
local_in_edges_tensor generation:  0.0052051544189453125
mini_batch_src_global generation:  0.0037620067596435547
r_  generation:  0.04154634475708008
local_output_nid generation:  0.0059812068939208984
local_in_edges_tensor generation:  0.003134012222290039
mini_batch_src_global generation:  0.004823207855224609
r_  generation:  0.045101165771484375
local_output_nid generation:  0.006033182144165039
local_in_edges_tensor generation:  0.0033066272735595703
mini_batch_src_global generation:  0.003391742706298828
r_  generation:  0.04512286186218262
local_output_nid generation:  0.006049633026123047
local_in_edges_tensor generation:  0.003214597702026367
mini_batch_src_global generation:  0.003543853759765625
r_  generation:  0.04678535461425781
local_output_nid generation:  0.006180763244628906
local_in_edges_tensor generation:  0.003280162811279297
mini_batch_src_global generation:  0.0037763118743896484
r_  generation:  0.04729032516479492
local_output_nid generation:  0.006101369857788086
local_in_edges_tensor generation:  0.003213644027709961
mini_batch_src_global generation:  0.003980875015258789
r_  generation:  0.04672884941101074
local_output_nid generation:  0.0061490535736083984
local_in_edges_tensor generation:  0.0032541751861572266
mini_batch_src_global generation:  0.003987312316894531
r_  generation:  0.047574520111083984
local_output_nid generation:  0.006111621856689453
local_in_edges_tensor generation:  0.0031304359436035156
mini_batch_src_global generation:  0.004027843475341797
r_  generation:  0.04673457145690918
----------------------check_connections_block total spend ----------------------------- 0.5792272090911865
generate_one_block  0.05972862243652344
generate_one_block  0.06253790855407715
generate_one_block  0.06226539611816406
generate_one_block  0.06188535690307617
generate_one_block  0.06617021560668945
generate_one_block  0.061290740966796875
generate_one_block  0.06119680404663086
generate_one_block  0.060509443283081055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040604352951049805
gen group dst list time:  0.01670694351196289
time for parepare:  0.019287586212158203
local_output_nid generation:  0.014475345611572266
local_in_edges_tensor generation:  0.0342864990234375
mini_batch_src_global generation:  0.03446006774902344
r_  generation:  0.3501322269439697
local_output_nid generation:  0.020397424697875977
local_in_edges_tensor generation:  0.03399157524108887
mini_batch_src_global generation:  0.04528450965881348
r_  generation:  0.3690011501312256
local_output_nid generation:  0.019903898239135742
local_in_edges_tensor generation:  0.027601957321166992
mini_batch_src_global generation:  0.044114112854003906
r_  generation:  0.3722679615020752
local_output_nid generation:  0.0201113224029541
local_in_edges_tensor generation:  0.023590564727783203
mini_batch_src_global generation:  0.04577302932739258
r_  generation:  0.377230167388916
local_output_nid generation:  0.02024054527282715
local_in_edges_tensor generation:  0.030762910842895508
mini_batch_src_global generation:  0.046370506286621094
r_  generation:  0.38184213638305664
local_output_nid generation:  0.020067214965820312
local_in_edges_tensor generation:  0.023534059524536133
mini_batch_src_global generation:  0.046628475189208984
r_  generation:  0.37718629837036133
local_output_nid generation:  0.020079612731933594
local_in_edges_tensor generation:  0.02078413963317871
mini_batch_src_global generation:  0.04621553421020508
r_  generation:  0.3818972110748291
local_output_nid generation:  0.020018577575683594
local_in_edges_tensor generation:  0.023854494094848633
mini_batch_src_global generation:  0.04631781578063965
r_  generation:  0.3755819797515869
----------------------check_connections_block total spend ----------------------------- 4.358486890792847
generate_one_block  0.47922468185424805
generate_one_block  0.4959092140197754
generate_one_block  0.49318814277648926
generate_one_block  0.49786376953125
generate_one_block  0.5039286613464355
generate_one_block  0.5019924640655518
generate_one_block  0.48424410820007324
generate_one_block  0.4894578456878662
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.030719995498657227
gen group dst list time:  0.03682899475097656
time for parepare:  0.019155502319335938
local_output_nid generation:  0.030330896377563477
local_in_edges_tensor generation:  0.04317474365234375
mini_batch_src_global generation:  0.04420185089111328
r_  generation:  0.4807722568511963
local_output_nid generation:  0.036965370178222656
local_in_edges_tensor generation:  0.05091452598571777
mini_batch_src_global generation:  0.05487322807312012
r_  generation:  0.48772263526916504
local_output_nid generation:  0.03769803047180176
local_in_edges_tensor generation:  0.03787493705749512
mini_batch_src_global generation:  0.055277109146118164
r_  generation:  0.48975133895874023
local_output_nid generation:  0.0369563102722168
local_in_edges_tensor generation:  0.03762412071228027
mini_batch_src_global generation:  0.05256199836730957
r_  generation:  0.4932098388671875
local_output_nid generation:  0.037310123443603516
local_in_edges_tensor generation:  0.04642629623413086
mini_batch_src_global generation:  0.05642271041870117
r_  generation:  0.49690842628479004
local_output_nid generation:  0.03699469566345215
local_in_edges_tensor generation:  0.037989139556884766
mini_batch_src_global generation:  0.05364584922790527
r_  generation:  0.4994790554046631
local_output_nid generation:  0.037140846252441406
local_in_edges_tensor generation:  0.03751349449157715
mini_batch_src_global generation:  0.05348920822143555
r_  generation:  0.5046393871307373
local_output_nid generation:  0.03665566444396973
local_in_edges_tensor generation:  0.03373551368713379
mini_batch_src_global generation:  0.05398845672607422
r_  generation:  0.503021240234375
----------------------check_connections_block total spend ----------------------------- 5.89007043838501
generate_one_block  0.6063029766082764
generate_one_block  0.6205308437347412
generate_one_block  0.6189441680908203
generate_one_block  0.6147277355194092
generate_one_block  0.6257796287536621
generate_one_block  0.6213674545288086
generate_one_block  0.6380276679992676
generate_one_block  0.6064333915710449
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  10.248557329177856
block generation total time  8.89792275428772
average batch blocks generation time:  1.112240344285965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.09999752044677734  GigaBytes
Max Memory Allocated: 0.09999752044677734  GigaBytes

torch.Size([162079, 128])
torch.Size([146095, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2869873046875 GB
    Memory Allocated: 13.941512107849121  GigaBytes
Max Memory Allocated: 13.955543041229248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.1017923355102539  GigaBytes
Max Memory Allocated: 13.955543041229248  GigaBytes

torch.Size([162171, 128])
torch.Size([146078, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2225341796875 GB
    Memory Allocated: 14.032781600952148  GigaBytes
Max Memory Allocated: 14.049057960510254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2244873046875 GB
    Memory Allocated: 0.10282564163208008  GigaBytes
Max Memory Allocated: 14.049057960510254  GigaBytes

torch.Size([162181, 128])
torch.Size([145876, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2244873046875 GB
    Memory Allocated: 13.993454933166504  GigaBytes
Max Memory Allocated: 14.049057960510254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2244873046875 GB
    Memory Allocated: 0.102081298828125  GigaBytes
Max Memory Allocated: 14.049057960510254  GigaBytes

torch.Size([162071, 128])
torch.Size([145903, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2244873046875 GB
    Memory Allocated: 14.012345314025879  GigaBytes
Max Memory Allocated: 14.049057960510254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2244873046875 GB
    Memory Allocated: 0.10299539566040039  GigaBytes
Max Memory Allocated: 14.049057960510254  GigaBytes

torch.Size([162332, 128])
torch.Size([146273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 14.045563220977783  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.10214662551879883  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162306, 128])
torch.Size([146130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 14.010995864868164  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.1027989387512207  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162473, 128])
torch.Size([146266, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 13.991492748260498  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.10199642181396484  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162231, 128])
torch.Size([145717, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 13.969480991363525  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03701198101043701 |0.057930827140808105 |0.6842896342277527 |0.00011560320854187012 |0.9932750165462494 |0.012348413467407227 |
----------------------------------------------------------pseudo_mini_loss sum 4.4022321701049805
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3056049
Number of first layer input nodes during this epoch:  1297844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.13762617111206055  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024942398071289062
random selection method range initialization spend 0.004976987838745117
time for parepare:  0.018321990966796875
local_output_nid generation:  0.00512385368347168
local_in_edges_tensor generation:  0.006514787673950195
mini_batch_src_global generation:  0.0037050247192382812
r_  generation:  0.0416264533996582
local_output_nid generation:  0.006630420684814453
local_in_edges_tensor generation:  0.0034034252166748047
mini_batch_src_global generation:  0.00479888916015625
r_  generation:  0.04503154754638672
local_output_nid generation:  0.0067729949951171875
local_in_edges_tensor generation:  0.0035414695739746094
mini_batch_src_global generation:  0.003253936767578125
r_  generation:  0.04597783088684082
local_output_nid generation:  0.006871461868286133
local_in_edges_tensor generation:  0.003606557846069336
mini_batch_src_global generation:  0.003535747528076172
r_  generation:  0.04796433448791504
local_output_nid generation:  0.008555889129638672
local_in_edges_tensor generation:  0.003628969192504883
mini_batch_src_global generation:  0.0038061141967773438
r_  generation:  0.04866600036621094
local_output_nid generation:  0.006962299346923828
local_in_edges_tensor generation:  0.0036292076110839844
mini_batch_src_global generation:  0.0042171478271484375
r_  generation:  0.051451921463012695
local_output_nid generation:  0.006956577301025391
local_in_edges_tensor generation:  0.0035097599029541016
mini_batch_src_global generation:  0.004212379455566406
r_  generation:  0.04950404167175293
local_output_nid generation:  0.006992816925048828
local_in_edges_tensor generation:  0.0034682750701904297
mini_batch_src_global generation:  0.0041980743408203125
r_  generation:  0.04957103729248047
----------------------check_connections_block total spend ----------------------------- 0.6055798530578613
generate_one_block  0.07564902305603027
generate_one_block  0.07415509223937988
generate_one_block  0.07282376289367676
generate_one_block  0.07376337051391602
generate_one_block  0.07404136657714844
generate_one_block  0.07751059532165527
generate_one_block  0.08018279075622559
generate_one_block  0.07509326934814453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03901791572570801
gen group dst list time:  0.016391277313232422
time for parepare:  0.020069599151611328
local_output_nid generation:  0.015640974044799805
local_in_edges_tensor generation:  0.031668663024902344
mini_batch_src_global generation:  0.03471064567565918
r_  generation:  0.36235833168029785
local_output_nid generation:  0.021168231964111328
local_in_edges_tensor generation:  0.03437066078186035
mini_batch_src_global generation:  0.04481387138366699
r_  generation:  0.37575745582580566
local_output_nid generation:  0.020503759384155273
local_in_edges_tensor generation:  0.02759838104248047
mini_batch_src_global generation:  0.04445695877075195
r_  generation:  0.384143590927124
local_output_nid generation:  0.020425796508789062
local_in_edges_tensor generation:  0.02782440185546875
mini_batch_src_global generation:  0.045563459396362305
r_  generation:  0.3884890079498291
local_output_nid generation:  0.020284414291381836
local_in_edges_tensor generation:  0.024672269821166992
mini_batch_src_global generation:  0.04993844032287598
r_  generation:  0.3989143371582031
local_output_nid generation:  0.022477149963378906
local_in_edges_tensor generation:  0.04175758361816406
mini_batch_src_global generation:  0.048158884048461914
r_  generation:  0.39952802658081055
local_output_nid generation:  0.020519256591796875
local_in_edges_tensor generation:  0.02789306640625
mini_batch_src_global generation:  0.04892420768737793
r_  generation:  0.396930456161499
local_output_nid generation:  0.021801471710205078
local_in_edges_tensor generation:  0.026220083236694336
mini_batch_src_global generation:  0.04677176475524902
r_  generation:  0.385678768157959
----------------------check_connections_block total spend ----------------------------- 4.532987356185913
generate_one_block  0.5268969535827637
generate_one_block  0.5299773216247559
generate_one_block  0.5314295291900635
generate_one_block  0.5205435752868652
generate_one_block  0.5228633880615234
generate_one_block  0.5351743698120117
generate_one_block  0.52256178855896
generate_one_block  0.5505642890930176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04672384262084961
gen group dst list time:  0.03717660903930664
time for parepare:  0.019080638885498047
local_output_nid generation:  0.030098676681518555
local_in_edges_tensor generation:  0.06403183937072754
mini_batch_src_global generation:  0.04532217979431152
r_  generation:  0.48700761795043945
local_output_nid generation:  0.03648662567138672
local_in_edges_tensor generation:  0.0513913631439209
mini_batch_src_global generation:  0.05601382255554199
r_  generation:  0.49422717094421387
local_output_nid generation:  0.036684513092041016
local_in_edges_tensor generation:  0.04790377616882324
mini_batch_src_global generation:  0.058588266372680664
r_  generation:  0.49339914321899414
local_output_nid generation:  0.0364532470703125
local_in_edges_tensor generation:  0.043485164642333984
mini_batch_src_global generation:  0.05336332321166992
r_  generation:  0.5043468475341797
local_output_nid generation:  0.0367891788482666
local_in_edges_tensor generation:  0.04419994354248047
mini_batch_src_global generation:  0.05462026596069336
r_  generation:  0.5031828880310059
local_output_nid generation:  0.036763668060302734
local_in_edges_tensor generation:  0.038402557373046875
mini_batch_src_global generation:  0.05809593200683594
r_  generation:  0.512725830078125
local_output_nid generation:  0.036658525466918945
local_in_edges_tensor generation:  0.042840003967285156
mini_batch_src_global generation:  0.05475473403930664
r_  generation:  0.5109939575195312
local_output_nid generation:  0.03653979301452637
local_in_edges_tensor generation:  0.0381009578704834
mini_batch_src_global generation:  0.05585360527038574
r_  generation:  0.5094842910766602
----------------------check_connections_block total spend ----------------------------- 6.028340101242065
generate_one_block  0.6915738582611084
generate_one_block  0.6648976802825928
generate_one_block  0.6577816009521484
generate_one_block  0.6647729873657227
generate_one_block  0.6641311645507812
generate_one_block  0.6586687564849854
generate_one_block  0.6591894626617432
generate_one_block  0.6559133529663086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.13762617111206055  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

connection checking time:  10.561327457427979
block generation total time  9.556940078735352
average batch blocks generation time:  1.194617509841919
block dataloader generation time/epoch 22.664474487304688
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.10392379760742188  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162009, 128])
torch.Size([145595, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 13.952007293701172  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.1031808853149414  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162203, 128])
torch.Size([145724, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 13.959293365478516  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.1041111946105957  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162077, 128])
torch.Size([145691, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 14.000024318695068  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.1031341552734375  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([161937, 128])
torch.Size([145647, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 13.997013568878174  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.10403585433959961  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162141, 128])
torch.Size([145767, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 13.998388290405273  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2283935546875 GB
    Memory Allocated: 0.10357856750488281  GigaBytes
Max Memory Allocated: 14.06175708770752  GigaBytes

torch.Size([162289, 128])
torch.Size([146281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2518310546875 GB
    Memory Allocated: 14.072452068328857  GigaBytes
Max Memory Allocated: 14.089102268218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2518310546875 GB
    Memory Allocated: 0.10405111312866211  GigaBytes
Max Memory Allocated: 14.089102268218994  GigaBytes

torch.Size([162326, 128])
torch.Size([146218, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2518310546875 GB
    Memory Allocated: 14.003900051116943  GigaBytes
Max Memory Allocated: 14.089102268218994  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2518310546875 GB
    Memory Allocated: 0.10327291488647461  GigaBytes
Max Memory Allocated: 14.089102268218994  GigaBytes

torch.Size([162168, 128])
torch.Size([145776, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2518310546875 GB
    Memory Allocated: 13.997674465179443  GigaBytes
Max Memory Allocated: 14.089102268218994  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03830805420875549 |0.02149859070777893 |0.5997949540615082 |0.0001036226749420166 |0.985996276140213 |0.0043447017669677734 |
----------------------------------------------------------pseudo_mini_loss sum 3.6981852054595947
Total (block generation + training)time/epoch 35.85658288002014
Training time/epoch 13.191871166229248
Training time without block to device /epoch 13.019882440567017
Training time without total dataloading part /epoch 12.691503524780273
load block tensor time/epoch 0.30646443367004395
block to device time/epoch 0.17198872566223145
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3053147
Number of first layer input nodes during this epoch:  1297150
