Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648461460.1168342
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027389049530029297
random selection method range initialization spend 0.006060361862182617
time for parepare:  0.018601417541503906
local_output_nid generation:  0.00112152099609375
local_in_edges_tensor generation:  0.004031658172607422
mini_batch_src_global generation:  0.0015573501586914062
r_  generation:  0.010289907455444336
local_output_nid generation:  0.0012860298156738281
local_in_edges_tensor generation:  0.0010104179382324219
mini_batch_src_global generation:  0.0015649795532226562
r_  generation:  0.009638071060180664
local_output_nid generation:  0.001369476318359375
local_in_edges_tensor generation:  0.0009200572967529297
mini_batch_src_global generation:  0.0010848045349121094
r_  generation:  0.009459733963012695
local_output_nid generation:  0.0014047622680664062
local_in_edges_tensor generation:  0.0008642673492431641
mini_batch_src_global generation:  0.0009558200836181641
r_  generation:  0.009049654006958008
local_output_nid generation:  0.001407623291015625
local_in_edges_tensor generation:  0.0008628368377685547
mini_batch_src_global generation:  0.0009489059448242188
r_  generation:  0.009282588958740234
local_output_nid generation:  0.0014069080352783203
local_in_edges_tensor generation:  0.0008373260498046875
mini_batch_src_global generation:  0.0010027885437011719
r_  generation:  0.009741544723510742
local_output_nid generation:  0.0014455318450927734
local_in_edges_tensor generation:  0.0008387565612792969
mini_batch_src_global generation:  0.0009829998016357422
r_  generation:  0.009841203689575195
local_output_nid generation:  0.001477956771850586
local_in_edges_tensor generation:  0.0008802413940429688
mini_batch_src_global generation:  0.0009748935699462891
r_  generation:  0.009717464447021484
local_output_nid generation:  0.0014562606811523438
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0010700225830078125
r_  generation:  0.009906530380249023
local_output_nid generation:  0.0014650821685791016
local_in_edges_tensor generation:  0.0008158683776855469
mini_batch_src_global generation:  0.0010173320770263672
r_  generation:  0.009704113006591797
local_output_nid generation:  0.0014560222625732422
local_in_edges_tensor generation:  0.0008206367492675781
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.009927034378051758
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0008339881896972656
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.01021575927734375
local_output_nid generation:  0.0015234947204589844
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.001043081283569336
r_  generation:  0.009801387786865234
local_output_nid generation:  0.0014612674713134766
local_in_edges_tensor generation:  0.0008234977722167969
mini_batch_src_global generation:  0.0010228157043457031
r_  generation:  0.010139942169189453
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0007872581481933594
mini_batch_src_global generation:  0.001024007797241211
r_  generation:  0.009724617004394531
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0008056163787841797
mini_batch_src_global generation:  0.0010051727294921875
r_  generation:  0.009539127349853516
local_output_nid generation:  0.0014607906341552734
local_in_edges_tensor generation:  0.0007715225219726562
mini_batch_src_global generation:  0.0009856224060058594
r_  generation:  0.009589910507202148
local_output_nid generation:  0.001453399658203125
local_in_edges_tensor generation:  0.0007922649383544922
mini_batch_src_global generation:  0.0010006427764892578
r_  generation:  0.00975942611694336
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0008046627044677734
mini_batch_src_global generation:  0.0010738372802734375
r_  generation:  0.010240793228149414
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0008006095886230469
mini_batch_src_global generation:  0.0010242462158203125
r_  generation:  0.009728670120239258
local_output_nid generation:  0.0015177726745605469
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0010294914245605469
r_  generation:  0.010009288787841797
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0007891654968261719
mini_batch_src_global generation:  0.0010178089141845703
r_  generation:  0.009687423706054688
local_output_nid generation:  0.0014867782592773438
local_in_edges_tensor generation:  0.0007848739624023438
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.009689092636108398
local_output_nid generation:  0.0014750957489013672
local_in_edges_tensor generation:  0.0008068084716796875
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.010276317596435547
local_output_nid generation:  0.0014739036560058594
local_in_edges_tensor generation:  0.0007948875427246094
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.010056018829345703
local_output_nid generation:  0.0014808177947998047
local_in_edges_tensor generation:  0.0008203983306884766
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.009600162506103516
local_output_nid generation:  0.0015475749969482422
local_in_edges_tensor generation:  0.0008122920989990234
mini_batch_src_global generation:  0.0010344982147216797
r_  generation:  0.009925603866577148
local_output_nid generation:  0.0014688968658447266
local_in_edges_tensor generation:  0.0008153915405273438
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.00992274284362793
local_output_nid generation:  0.001463174819946289
local_in_edges_tensor generation:  0.0007808208465576172
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.0097808837890625
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0055196285247802734
mini_batch_src_global generation:  0.0012574195861816406
r_  generation:  0.01018214225769043
local_output_nid generation:  0.0013246536254882812
local_in_edges_tensor generation:  0.0008382797241210938
mini_batch_src_global generation:  0.0011227130889892578
r_  generation:  0.010132551193237305
local_output_nid generation:  0.0013859272003173828
local_in_edges_tensor generation:  0.0007939338684082031
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.01020050048828125
----------------------check_connections_block total spend ----------------------------- 0.5374925136566162
generate_one_block  0.015312433242797852
generate_one_block  0.01576685905456543
generate_one_block  0.015451431274414062
generate_one_block  0.014469623565673828
generate_one_block  0.01509404182434082
generate_one_block  0.015209436416625977
generate_one_block  0.01486515998840332
generate_one_block  0.014857292175292969
generate_one_block  0.014966249465942383
generate_one_block  0.015121221542358398
generate_one_block  0.014484643936157227
generate_one_block  0.014874696731567383
generate_one_block  0.014526128768920898
generate_one_block  0.015218496322631836
generate_one_block  0.014497518539428711
generate_one_block  0.014236688613891602
generate_one_block  0.014259815216064453
generate_one_block  0.014442205429077148
generate_one_block  0.015282154083251953
generate_one_block  0.014408111572265625
generate_one_block  0.014853477478027344
generate_one_block  0.014462471008300781
generate_one_block  0.014414072036743164
generate_one_block  0.015055179595947266
generate_one_block  0.014835596084594727
generate_one_block  0.01459193229675293
generate_one_block  0.015186071395874023
generate_one_block  0.014839649200439453
generate_one_block  0.014381647109985352
generate_one_block  0.01510167121887207
generate_one_block  0.01543879508972168
generate_one_block  0.014957427978515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04653286933898926
gen group dst list time:  0.0232846736907959
time for parepare:  0.019100427627563477
local_output_nid generation:  0.005276203155517578
local_in_edges_tensor generation:  0.014880180358886719
mini_batch_src_global generation:  0.01576542854309082
r_  generation:  0.1567058563232422
local_output_nid generation:  0.008592605590820312
local_in_edges_tensor generation:  0.01580977439880371
mini_batch_src_global generation:  0.020615816116333008
r_  generation:  0.1702890396118164
local_output_nid generation:  0.00826573371887207
local_in_edges_tensor generation:  0.012826681137084961
mini_batch_src_global generation:  0.01937580108642578
r_  generation:  0.1708979606628418
local_output_nid generation:  0.0078012943267822266
local_in_edges_tensor generation:  0.010742902755737305
mini_batch_src_global generation:  0.019269227981567383
r_  generation:  0.1649305820465088
local_output_nid generation:  0.008042097091674805
local_in_edges_tensor generation:  0.011048316955566406
mini_batch_src_global generation:  0.022179126739501953
r_  generation:  0.17849135398864746
local_output_nid generation:  0.008275508880615234
local_in_edges_tensor generation:  0.011303901672363281
mini_batch_src_global generation:  0.021769046783447266
r_  generation:  0.1783127784729004
local_output_nid generation:  0.008090734481811523
local_in_edges_tensor generation:  0.012711286544799805
mini_batch_src_global generation:  0.02586078643798828
r_  generation:  0.18010783195495605
local_output_nid generation:  0.008100748062133789
local_in_edges_tensor generation:  0.01110076904296875
mini_batch_src_global generation:  0.022072315216064453
r_  generation:  0.17770767211914062
local_output_nid generation:  0.008174657821655273
local_in_edges_tensor generation:  0.012855052947998047
mini_batch_src_global generation:  0.023875713348388672
r_  generation:  0.1827678680419922
local_output_nid generation:  0.008069753646850586
local_in_edges_tensor generation:  0.009451627731323242
mini_batch_src_global generation:  0.02244281768798828
r_  generation:  0.17974042892456055
local_output_nid generation:  0.007946014404296875
local_in_edges_tensor generation:  0.009493350982666016
mini_batch_src_global generation:  0.022552013397216797
r_  generation:  0.1814870834350586
local_output_nid generation:  0.008144855499267578
local_in_edges_tensor generation:  0.009694337844848633
mini_batch_src_global generation:  0.022055387496948242
r_  generation:  0.17851924896240234
local_output_nid generation:  0.007965803146362305
local_in_edges_tensor generation:  0.009441375732421875
mini_batch_src_global generation:  0.021625041961669922
r_  generation:  0.17387080192565918
local_output_nid generation:  0.008199930191040039
local_in_edges_tensor generation:  0.012246370315551758
mini_batch_src_global generation:  0.022521257400512695
r_  generation:  0.1839611530303955
local_output_nid generation:  0.008041858673095703
local_in_edges_tensor generation:  0.009732246398925781
mini_batch_src_global generation:  0.023005247116088867
r_  generation:  0.17692041397094727
local_output_nid generation:  0.007919788360595703
local_in_edges_tensor generation:  0.009428262710571289
mini_batch_src_global generation:  0.021584272384643555
r_  generation:  0.17682123184204102
local_output_nid generation:  0.007813453674316406
local_in_edges_tensor generation:  0.010823965072631836
mini_batch_src_global generation:  0.02203083038330078
r_  generation:  0.17214703559875488
local_output_nid generation:  0.007916688919067383
local_in_edges_tensor generation:  0.012312650680541992
mini_batch_src_global generation:  0.022161006927490234
r_  generation:  0.17459964752197266
local_output_nid generation:  0.008188724517822266
local_in_edges_tensor generation:  0.013004302978515625
mini_batch_src_global generation:  0.023037195205688477
r_  generation:  0.18329524993896484
local_output_nid generation:  0.007916688919067383
local_in_edges_tensor generation:  0.010703086853027344
mini_batch_src_global generation:  0.022365331649780273
r_  generation:  0.17291522026062012
local_output_nid generation:  0.008048772811889648
local_in_edges_tensor generation:  0.009522199630737305
mini_batch_src_global generation:  0.026674747467041016
r_  generation:  0.17685413360595703
local_output_nid generation:  0.007984399795532227
local_in_edges_tensor generation:  0.012592315673828125
mini_batch_src_global generation:  0.022362470626831055
r_  generation:  0.17882752418518066
local_output_nid generation:  0.007790803909301758
local_in_edges_tensor generation:  0.009559392929077148
mini_batch_src_global generation:  0.02199554443359375
r_  generation:  0.17406177520751953
local_output_nid generation:  0.008091449737548828
local_in_edges_tensor generation:  0.009822368621826172
mini_batch_src_global generation:  0.023990154266357422
r_  generation:  0.18148255348205566
local_output_nid generation:  0.008043289184570312
local_in_edges_tensor generation:  0.012558937072753906
mini_batch_src_global generation:  0.022260189056396484
r_  generation:  0.18497371673583984
local_output_nid generation:  0.007947683334350586
local_in_edges_tensor generation:  0.009686708450317383
mini_batch_src_global generation:  0.022846460342407227
r_  generation:  0.17040395736694336
local_output_nid generation:  0.008090496063232422
local_in_edges_tensor generation:  0.009924173355102539
mini_batch_src_global generation:  0.022666454315185547
r_  generation:  0.1856081485748291
local_output_nid generation:  0.008113622665405273
local_in_edges_tensor generation:  0.012638092041015625
mini_batch_src_global generation:  0.022797584533691406
r_  generation:  0.17736291885375977
local_output_nid generation:  0.007934093475341797
local_in_edges_tensor generation:  0.012290239334106445
mini_batch_src_global generation:  0.02213287353515625
r_  generation:  0.17650055885314941
local_output_nid generation:  0.008170366287231445
local_in_edges_tensor generation:  0.014272928237915039
mini_batch_src_global generation:  0.024393558502197266
r_  generation:  0.1818230152130127
local_output_nid generation:  0.00823211669921875
local_in_edges_tensor generation:  0.012686729431152344
mini_batch_src_global generation:  0.024669408798217773
r_  generation:  0.18357253074645996
local_output_nid generation:  0.008202791213989258
local_in_edges_tensor generation:  0.011295557022094727
mini_batch_src_global generation:  0.03319191932678223
r_  generation:  0.18044400215148926
----------------------check_connections_block total spend ----------------------------- 8.306390523910522
generate_one_block  0.22590970993041992
generate_one_block  0.2305004596710205
generate_one_block  0.25667428970336914
generate_one_block  0.2168257236480713
generate_one_block  0.22999191284179688
generate_one_block  0.2353367805480957
generate_one_block  0.22623705863952637
generate_one_block  0.2307138442993164
generate_one_block  0.23599815368652344
generate_one_block  0.22781872749328613
generate_one_block  0.2231895923614502
generate_one_block  0.22745728492736816
generate_one_block  0.22018194198608398
generate_one_block  0.23692011833190918
generate_one_block  0.2236325740814209
generate_one_block  0.24510431289672852
generate_one_block  0.2157142162322998
generate_one_block  0.23283815383911133
generate_one_block  0.24304676055908203
generate_one_block  0.21903634071350098
generate_one_block  0.22523212432861328
generate_one_block  0.23427939414978027
generate_one_block  0.22687625885009766
generate_one_block  0.2373206615447998
generate_one_block  0.23169302940368652
generate_one_block  0.22623467445373535
generate_one_block  0.24771785736083984
generate_one_block  0.22466111183166504
generate_one_block  0.2399129867553711
generate_one_block  0.2422332763671875
generate_one_block  0.24315381050109863
generate_one_block  0.22863054275512695
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0570528507232666
gen group dst list time:  0.11117315292358398
time for parepare:  0.020371198654174805
local_output_nid generation:  0.02343606948852539
local_in_edges_tensor generation:  0.06415367126464844
mini_batch_src_global generation:  0.0391695499420166
r_  generation:  0.41524410247802734
local_output_nid generation:  0.030028104782104492
local_in_edges_tensor generation:  0.045580387115478516
mini_batch_src_global generation:  0.04845595359802246
r_  generation:  0.4279048442840576
local_output_nid generation:  0.030337810516357422
local_in_edges_tensor generation:  0.03838706016540527
mini_batch_src_global generation:  0.04808807373046875
r_  generation:  0.42554163932800293
local_output_nid generation:  0.028088808059692383
local_in_edges_tensor generation:  0.034212350845336914
mini_batch_src_global generation:  0.04772186279296875
r_  generation:  0.4241750240325928
local_output_nid generation:  0.02828669548034668
local_in_edges_tensor generation:  0.035124778747558594
mini_batch_src_global generation:  0.05197501182556152
r_  generation:  0.4297950267791748
local_output_nid generation:  0.028099536895751953
local_in_edges_tensor generation:  0.03090357780456543
mini_batch_src_global generation:  0.05004286766052246
r_  generation:  0.43271780014038086
local_output_nid generation:  0.02833843231201172
local_in_edges_tensor generation:  0.03438210487365723
mini_batch_src_global generation:  0.04974484443664551
r_  generation:  0.43335604667663574
local_output_nid generation:  0.028538227081298828
local_in_edges_tensor generation:  0.0382688045501709
mini_batch_src_global generation:  0.06927609443664551
r_  generation:  0.43744969367980957
local_output_nid generation:  0.028231143951416016
local_in_edges_tensor generation:  0.03534412384033203
mini_batch_src_global generation:  0.049690961837768555
r_  generation:  0.43489599227905273
local_output_nid generation:  0.028027057647705078
local_in_edges_tensor generation:  0.03088831901550293
mini_batch_src_global generation:  0.05118870735168457
r_  generation:  0.43317151069641113
local_output_nid generation:  0.0285336971282959
local_in_edges_tensor generation:  0.030911922454833984
mini_batch_src_global generation:  0.0504453182220459
r_  generation:  0.4335618019104004
local_output_nid generation:  0.02828526496887207
local_in_edges_tensor generation:  0.041947126388549805
mini_batch_src_global generation:  0.050203800201416016
r_  generation:  0.4395778179168701
local_output_nid generation:  0.029088735580444336
local_in_edges_tensor generation:  0.03330183029174805
mini_batch_src_global generation:  0.050531625747680664
r_  generation:  0.4340653419494629
local_output_nid generation:  0.02829718589782715
local_in_edges_tensor generation:  0.038259267807006836
mini_batch_src_global generation:  0.05270886421203613
r_  generation:  0.43682217597961426
local_output_nid generation:  0.027950525283813477
local_in_edges_tensor generation:  0.03187155723571777
mini_batch_src_global generation:  0.04960513114929199
r_  generation:  0.43688368797302246
local_output_nid generation:  0.02848362922668457
local_in_edges_tensor generation:  0.03189659118652344
mini_batch_src_global generation:  0.049848318099975586
r_  generation:  0.4353184700012207
local_output_nid generation:  0.02820420265197754
local_in_edges_tensor generation:  0.03413558006286621
mini_batch_src_global generation:  0.05017805099487305
r_  generation:  0.4303090572357178
local_output_nid generation:  0.02806377410888672
local_in_edges_tensor generation:  0.037697553634643555
mini_batch_src_global generation:  0.04922318458557129
r_  generation:  0.43503284454345703
local_output_nid generation:  0.028436899185180664
local_in_edges_tensor generation:  0.034923553466796875
mini_batch_src_global generation:  0.04983973503112793
r_  generation:  0.44653773307800293
local_output_nid generation:  0.0288393497467041
local_in_edges_tensor generation:  0.04476475715637207
mini_batch_src_global generation:  0.05038261413574219
r_  generation:  0.43129563331604004
local_output_nid generation:  0.028478145599365234
local_in_edges_tensor generation:  0.030963897705078125
mini_batch_src_global generation:  0.049852848052978516
r_  generation:  0.43973827362060547
local_output_nid generation:  0.028717756271362305
local_in_edges_tensor generation:  0.03111433982849121
mini_batch_src_global generation:  0.053064823150634766
r_  generation:  0.4384326934814453
local_output_nid generation:  0.028296709060668945
local_in_edges_tensor generation:  0.03174233436584473
mini_batch_src_global generation:  0.049299001693725586
r_  generation:  0.44295763969421387
local_output_nid generation:  0.028350114822387695
local_in_edges_tensor generation:  0.03575539588928223
mini_batch_src_global generation:  0.050214529037475586
r_  generation:  0.44565248489379883
local_output_nid generation:  0.02832198143005371
local_in_edges_tensor generation:  0.04132699966430664
mini_batch_src_global generation:  0.05021309852600098
r_  generation:  0.4408142566680908
local_output_nid generation:  0.028164148330688477
local_in_edges_tensor generation:  0.03360581398010254
mini_batch_src_global generation:  0.05053997039794922
r_  generation:  0.435375452041626
local_output_nid generation:  0.02842569351196289
local_in_edges_tensor generation:  0.043938636779785156
mini_batch_src_global generation:  0.062125205993652344
r_  generation:  0.4415733814239502
local_output_nid generation:  0.029639005661010742
local_in_edges_tensor generation:  0.0431208610534668
mini_batch_src_global generation:  0.05172562599182129
r_  generation:  0.43665504455566406
local_output_nid generation:  0.028898954391479492
local_in_edges_tensor generation:  0.031795501708984375
mini_batch_src_global generation:  0.05045342445373535
r_  generation:  0.4349236488342285
local_output_nid generation:  0.029035091400146484
local_in_edges_tensor generation:  0.031453847885131836
mini_batch_src_global generation:  0.05285835266113281
r_  generation:  0.4445457458496094
local_output_nid generation:  0.03138470649719238
local_in_edges_tensor generation:  0.04001164436340332
mini_batch_src_global generation:  0.05050945281982422
r_  generation:  0.43836426734924316
local_output_nid generation:  0.029826641082763672
local_in_edges_tensor generation:  0.03840756416320801
mini_batch_src_global generation:  0.05060863494873047
r_  generation:  0.43856215476989746
----------------------check_connections_block total spend ----------------------------- 20.74156379699707
generate_one_block  0.6632957458496094
generate_one_block  0.5597434043884277
generate_one_block  0.5619139671325684
generate_one_block  0.5619339942932129
generate_one_block  0.5568435192108154
generate_one_block  0.5464096069335938
generate_one_block  0.5610761642456055
generate_one_block  0.5723850727081299
generate_one_block  0.5564675331115723
generate_one_block  0.542686939239502
generate_one_block  0.5415496826171875
generate_one_block  0.5656683444976807
generate_one_block  0.56821608543396
generate_one_block  0.5742928981781006
generate_one_block  0.5710816383361816
generate_one_block  0.5708673000335693
generate_one_block  0.5609424114227295
generate_one_block  0.5511150360107422
generate_one_block  0.5643384456634521
generate_one_block  0.5574197769165039
generate_one_block  0.5738403797149658
generate_one_block  0.5757403373718262
generate_one_block  0.5711045265197754
generate_one_block  0.5602483749389648
generate_one_block  0.559234619140625
generate_one_block  0.5411784648895264
generate_one_block  0.5549116134643555
generate_one_block  0.5650253295898438
generate_one_block  0.5609893798828125
generate_one_block  0.5700290203094482
generate_one_block  0.5675578117370605
generate_one_block  0.5941665172576904
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  29.047954320907593
block generation total time  25.513347625732422
average batch blocks generation time:  0.7972921133041382
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0868382453918457  GigaBytes
Max Memory Allocated: 0.0868382453918457  GigaBytes

torch.Size([148540, 128])
torch.Size([109547, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0135498046875 GB
    Memory Allocated: 14.425879001617432  GigaBytes
Max Memory Allocated: 14.46833324432373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 0.08967971801757812  GigaBytes
Max Memory Allocated: 14.46833324432373  GigaBytes

torch.Size([149322, 128])
torch.Size([110782, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2381591796875 GB
    Memory Allocated: 14.755496501922607  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2381591796875 GB
    Memory Allocated: 0.08954048156738281  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149252, 128])
torch.Size([110268, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2381591796875 GB
    Memory Allocated: 14.617326736450195  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2381591796875 GB
    Memory Allocated: 0.08918142318725586  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149157, 128])
torch.Size([109743, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2381591796875 GB
    Memory Allocated: 14.306773662567139  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2381591796875 GB
    Memory Allocated: 0.08949708938598633  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149165, 128])
torch.Size([110731, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.664558410644531  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08918285369873047  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148556, 128])
torch.Size([109476, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.601660251617432  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08941030502319336  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149033, 128])
torch.Size([109912, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.601818084716797  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08947181701660156  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149210, 128])
torch.Size([110588, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.595223903656006  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08929157257080078  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148652, 128])
torch.Size([110132, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.673905372619629  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08903980255126953  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148364, 128])
torch.Size([109379, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.55433988571167  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08925104141235352  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148899, 128])
torch.Size([109306, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.483958721160889  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08929014205932617  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148895, 128])
torch.Size([110079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.539583683013916  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08901166915893555  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148783, 128])
torch.Size([109414, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.260738849639893  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08969879150390625  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149510, 128])
torch.Size([110793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.681829452514648  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08913612365722656  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148744, 128])
torch.Size([109118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.476475238800049  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08909177780151367  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148775, 128])
torch.Size([109894, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.406036376953125  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08903169631958008  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148919, 128])
torch.Size([109086, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.169512271881104  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08895015716552734  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148466, 128])
torch.Size([109421, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 14.400980472564697  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2498779296875 GB
    Memory Allocated: 0.08944225311279297  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148834, 128])
torch.Size([110166, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.716896533966064  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.08936262130737305  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149389, 128])
torch.Size([110417, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.38969612121582  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.08921527862548828  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148886, 128])
torch.Size([109423, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.466410160064697  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.08947229385375977  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149249, 128])
torch.Size([110237, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.575278759002686  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.08894109725952148  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148619, 128])
torch.Size([108761, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.267367362976074  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.08939027786254883  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148931, 128])
torch.Size([109827, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.630995273590088  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.0889897346496582  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148231, 128])
torch.Size([109391, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.54909086227417  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.0890054702758789  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148816, 128])
torch.Size([108860, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 14.269664287567139  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2987060546875 GB
    Memory Allocated: 0.0892343521118164  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148520, 128])
torch.Size([109675, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 14.667486190795898  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.08935260772705078  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149146, 128])
torch.Size([110470, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 14.52771806716919  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.08914661407470703  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148884, 128])
torch.Size([109042, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 14.379927635192871  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.08920145034790039  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148517, 128])
torch.Size([109596, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 14.645395278930664  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.08929157257080078  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148606, 128])
torch.Size([109898, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 14.690773487091064  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.08939170837402344  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([148958, 128])
torch.Size([110476, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 14.646328449249268  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03693031519651413 |0.03460308909416199 |0.5686152875423431 |0.00010358542203903198 |1.0206838175654411 |0.016154050827026367 |
----------------------------------------------------------pseudo_mini_loss sum 4.999180793762207
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9117903
Number of first layer input nodes during this epoch:  4763828
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.11290216445922852  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02383255958557129
random selection method range initialization spend 0.006006479263305664
time for parepare:  0.019769906997680664
local_output_nid generation:  0.0015408992767333984
local_in_edges_tensor generation:  0.004131317138671875
mini_batch_src_global generation:  0.0019545555114746094
r_  generation:  0.011740684509277344
local_output_nid generation:  0.0018820762634277344
local_in_edges_tensor generation:  0.0010974407196044922
mini_batch_src_global generation:  0.0017364025115966797
r_  generation:  0.01066732406616211
local_output_nid generation:  0.0017895698547363281
local_in_edges_tensor generation:  0.0011091232299804688
mini_batch_src_global generation:  0.0013053417205810547
r_  generation:  0.010318279266357422
local_output_nid generation:  0.0017540454864501953
local_in_edges_tensor generation:  0.0009634494781494141
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.009879827499389648
local_output_nid generation:  0.0017628669738769531
local_in_edges_tensor generation:  0.0010080337524414062
mini_batch_src_global generation:  0.0012607574462890625
r_  generation:  0.01039266586303711
local_output_nid generation:  0.0017249584197998047
local_in_edges_tensor generation:  0.0010242462158203125
mini_batch_src_global generation:  0.0012536048889160156
r_  generation:  0.010510683059692383
local_output_nid generation:  0.0017292499542236328
local_in_edges_tensor generation:  0.0009815692901611328
mini_batch_src_global generation:  0.0012319087982177734
r_  generation:  0.010564804077148438
local_output_nid generation:  0.0017039775848388672
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010201215744018555
local_output_nid generation:  0.001771688461303711
local_in_edges_tensor generation:  0.0009927749633789062
mini_batch_src_global generation:  0.001256704330444336
r_  generation:  0.010349273681640625
local_output_nid generation:  0.0017347335815429688
local_in_edges_tensor generation:  0.0010013580322265625
mini_batch_src_global generation:  0.0012636184692382812
r_  generation:  0.010680913925170898
local_output_nid generation:  0.001710653305053711
local_in_edges_tensor generation:  0.0009806156158447266
mini_batch_src_global generation:  0.001260519027709961
r_  generation:  0.01054692268371582
local_output_nid generation:  0.001749277114868164
local_in_edges_tensor generation:  0.000965118408203125
mini_batch_src_global generation:  0.0012214183807373047
r_  generation:  0.010344266891479492
local_output_nid generation:  0.001737356185913086
local_in_edges_tensor generation:  0.0010023117065429688
mini_batch_src_global generation:  0.001379251480102539
r_  generation:  0.01057577133178711
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0011506080627441406
r_  generation:  0.010190725326538086
local_output_nid generation:  0.001714944839477539
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.0013315677642822266
r_  generation:  0.010539054870605469
local_output_nid generation:  0.0017886161804199219
local_in_edges_tensor generation:  0.0009205341339111328
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.010288476943969727
local_output_nid generation:  0.001722574234008789
local_in_edges_tensor generation:  0.0009417533874511719
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.009963750839233398
local_output_nid generation:  0.0017228126525878906
local_in_edges_tensor generation:  0.0009951591491699219
mini_batch_src_global generation:  0.0012259483337402344
r_  generation:  0.010552406311035156
local_output_nid generation:  0.0017745494842529297
local_in_edges_tensor generation:  0.0009515285491943359
mini_batch_src_global generation:  0.0012059211730957031
r_  generation:  0.010521888732910156
local_output_nid generation:  0.0017497539520263672
local_in_edges_tensor generation:  0.0009875297546386719
mini_batch_src_global generation:  0.0013060569763183594
r_  generation:  0.010767221450805664
local_output_nid generation:  0.0017361640930175781
local_in_edges_tensor generation:  0.0009646415710449219
mini_batch_src_global generation:  0.00125885009765625
r_  generation:  0.010749340057373047
local_output_nid generation:  0.0017371177673339844
local_in_edges_tensor generation:  0.0009791851043701172
mini_batch_src_global generation:  0.00121307373046875
r_  generation:  0.010557174682617188
local_output_nid generation:  0.0017881393432617188
local_in_edges_tensor generation:  0.000942230224609375
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.010506153106689453
local_output_nid generation:  0.0017499923706054688
local_in_edges_tensor generation:  0.00096893310546875
mini_batch_src_global generation:  0.001238107681274414
r_  generation:  0.010503053665161133
local_output_nid generation:  0.0017406940460205078
local_in_edges_tensor generation:  0.000986337661743164
mini_batch_src_global generation:  0.0012154579162597656
r_  generation:  0.010614156723022461
local_output_nid generation:  0.0017459392547607422
local_in_edges_tensor generation:  0.0009644031524658203
mini_batch_src_global generation:  0.0012631416320800781
r_  generation:  0.010566234588623047
local_output_nid generation:  0.0017218589782714844
local_in_edges_tensor generation:  0.0009992122650146484
mini_batch_src_global generation:  0.0011904239654541016
r_  generation:  0.01032567024230957
local_output_nid generation:  0.0017383098602294922
local_in_edges_tensor generation:  0.0009558200836181641
mini_batch_src_global generation:  0.0012133121490478516
r_  generation:  0.010403633117675781
local_output_nid generation:  0.0017347335815429688
local_in_edges_tensor generation:  0.0009472370147705078
mini_batch_src_global generation:  0.0012257099151611328
r_  generation:  0.010728836059570312
local_output_nid generation:  0.00176239013671875
local_in_edges_tensor generation:  0.0009431838989257812
mini_batch_src_global generation:  0.0011620521545410156
r_  generation:  0.010284662246704102
local_output_nid generation:  0.0017349720001220703
local_in_edges_tensor generation:  0.0009326934814453125
mini_batch_src_global generation:  0.0011932849884033203
r_  generation:  0.010340213775634766
local_output_nid generation:  0.0017344951629638672
local_in_edges_tensor generation:  0.0009388923645019531
mini_batch_src_global generation:  0.0011832714080810547
r_  generation:  0.01067972183227539
----------------------check_connections_block total spend ----------------------------- 0.5834629535675049
generate_one_block  0.02820277214050293
generate_one_block  0.021651268005371094
generate_one_block  0.020448923110961914
generate_one_block  0.018751144409179688
generate_one_block  0.01922440528869629
generate_one_block  0.01901388168334961
generate_one_block  0.019101858139038086
generate_one_block  0.01828169822692871
generate_one_block  0.01863837242126465
generate_one_block  0.01936483383178711
generate_one_block  0.01859736442565918
generate_one_block  0.018692731857299805
generate_one_block  0.019244670867919922
generate_one_block  0.0182802677154541
generate_one_block  0.018632888793945312
generate_one_block  0.018277645111083984
generate_one_block  0.017737627029418945
generate_one_block  0.018962383270263672
generate_one_block  0.01877617835998535
generate_one_block  0.019286155700683594
generate_one_block  0.019092321395874023
generate_one_block  0.018880605697631836
generate_one_block  0.018398046493530273
generate_one_block  0.018439531326293945
generate_one_block  0.018910646438598633
generate_one_block  0.018688201904296875
generate_one_block  0.018323898315429688
generate_one_block  0.018413305282592773
generate_one_block  0.01885366439819336
generate_one_block  0.017949581146240234
generate_one_block  0.018357276916503906
generate_one_block  0.01897454261779785
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.037774085998535156
gen group dst list time:  0.022061586380004883
time for parepare:  0.021337032318115234
local_output_nid generation:  0.007181882858276367
local_in_edges_tensor generation:  0.015822410583496094
mini_batch_src_global generation:  0.0173642635345459
r_  generation:  0.17291665077209473
local_output_nid generation:  0.009670019149780273
local_in_edges_tensor generation:  0.012285470962524414
mini_batch_src_global generation:  0.020457983016967773
r_  generation:  0.18424725532531738
local_output_nid generation:  0.01480245590209961
local_in_edges_tensor generation:  0.04290771484375
mini_batch_src_global generation:  0.020618677139282227
r_  generation:  0.17659926414489746
local_output_nid generation:  0.01166081428527832
local_in_edges_tensor generation:  0.014278888702392578
mini_batch_src_global generation:  0.022496461868286133
r_  generation:  0.1729581356048584
local_output_nid generation:  0.010157108306884766
local_in_edges_tensor generation:  0.012167930603027344
mini_batch_src_global generation:  0.021653175354003906
r_  generation:  0.1801455020904541
local_output_nid generation:  0.009562492370605469
local_in_edges_tensor generation:  0.011740684509277344
mini_batch_src_global generation:  0.02231431007385254
r_  generation:  0.18239283561706543
local_output_nid generation:  0.009475231170654297
local_in_edges_tensor generation:  0.013057470321655273
mini_batch_src_global generation:  0.02263164520263672
r_  generation:  0.210113525390625
local_output_nid generation:  0.013639211654663086
local_in_edges_tensor generation:  0.013206005096435547
mini_batch_src_global generation:  0.02665233612060547
r_  generation:  0.19571805000305176
local_output_nid generation:  0.01414799690246582
local_in_edges_tensor generation:  0.015258550643920898
mini_batch_src_global generation:  0.026869535446166992
r_  generation:  0.20140933990478516
local_output_nid generation:  0.015962600708007812
local_in_edges_tensor generation:  0.013879776000976562
mini_batch_src_global generation:  0.03112053871154785
r_  generation:  0.1917705535888672
local_output_nid generation:  0.010720968246459961
local_in_edges_tensor generation:  0.010673999786376953
mini_batch_src_global generation:  0.02797842025756836
r_  generation:  0.18532347679138184
local_output_nid generation:  0.010118961334228516
local_in_edges_tensor generation:  0.010861635208129883
mini_batch_src_global generation:  0.022710084915161133
r_  generation:  0.18083596229553223
local_output_nid generation:  0.010336637496948242
local_in_edges_tensor generation:  0.012183427810668945
mini_batch_src_global generation:  0.024571657180786133
r_  generation:  0.19071650505065918
local_output_nid generation:  0.009778261184692383
local_in_edges_tensor generation:  0.01004648208618164
mini_batch_src_global generation:  0.022575855255126953
r_  generation:  0.1831953525543213
local_output_nid generation:  0.009813547134399414
local_in_edges_tensor generation:  0.011617422103881836
mini_batch_src_global generation:  0.024275541305541992
r_  generation:  0.19055414199829102
local_output_nid generation:  0.009871482849121094
local_in_edges_tensor generation:  0.012739896774291992
mini_batch_src_global generation:  0.022591114044189453
r_  generation:  0.18164491653442383
local_output_nid generation:  0.00958561897277832
local_in_edges_tensor generation:  0.009373664855957031
mini_batch_src_global generation:  0.02178668975830078
r_  generation:  0.17856407165527344
local_output_nid generation:  0.009852409362792969
local_in_edges_tensor generation:  0.010503768920898438
mini_batch_src_global generation:  0.023048877716064453
r_  generation:  0.18198633193969727
local_output_nid generation:  0.009878396987915039
local_in_edges_tensor generation:  0.013044595718383789
mini_batch_src_global generation:  0.02363753318786621
r_  generation:  0.1887831687927246
local_output_nid generation:  0.012159347534179688
local_in_edges_tensor generation:  0.011728525161743164
mini_batch_src_global generation:  0.023625850677490234
r_  generation:  0.1916348934173584
local_output_nid generation:  0.009576559066772461
local_in_edges_tensor generation:  0.013059377670288086
mini_batch_src_global generation:  0.023824691772460938
r_  generation:  0.1886589527130127
local_output_nid generation:  0.009389877319335938
local_in_edges_tensor generation:  0.010494709014892578
mini_batch_src_global generation:  0.023604631423950195
r_  generation:  0.19001269340515137
local_output_nid generation:  0.009104251861572266
local_in_edges_tensor generation:  0.01011967658996582
mini_batch_src_global generation:  0.022867202758789062
r_  generation:  0.1910698413848877
local_output_nid generation:  0.00926518440246582
local_in_edges_tensor generation:  0.010834932327270508
mini_batch_src_global generation:  0.0230863094329834
r_  generation:  0.18499326705932617
local_output_nid generation:  0.009258031845092773
local_in_edges_tensor generation:  0.01390695571899414
mini_batch_src_global generation:  0.023372650146484375
r_  generation:  0.19878554344177246
local_output_nid generation:  0.012403726577758789
local_in_edges_tensor generation:  0.018945932388305664
mini_batch_src_global generation:  0.026561737060546875
r_  generation:  0.18301939964294434
local_output_nid generation:  0.009424686431884766
local_in_edges_tensor generation:  0.012225151062011719
mini_batch_src_global generation:  0.023376941680908203
r_  generation:  0.18024849891662598
local_output_nid generation:  0.009313583374023438
local_in_edges_tensor generation:  0.011785268783569336
mini_batch_src_global generation:  0.022782087326049805
r_  generation:  0.18265509605407715
local_output_nid generation:  0.009662389755249023
local_in_edges_tensor generation:  0.011712074279785156
mini_batch_src_global generation:  0.024765968322753906
r_  generation:  0.18689560890197754
local_output_nid generation:  0.009421586990356445
local_in_edges_tensor generation:  0.010139942169189453
mini_batch_src_global generation:  0.0226900577545166
r_  generation:  0.17707157135009766
local_output_nid generation:  0.009461164474487305
local_in_edges_tensor generation:  0.010014057159423828
mini_batch_src_global generation:  0.022779226303100586
r_  generation:  0.18674707412719727
local_output_nid generation:  0.009536981582641602
local_in_edges_tensor generation:  0.013317108154296875
mini_batch_src_global generation:  0.023666858673095703
r_  generation:  0.19042229652404785
----------------------check_connections_block total spend ----------------------------- 8.825391054153442
generate_one_block  0.2780120372772217
generate_one_block  0.2340998649597168
generate_one_block  0.2502133846282959
generate_one_block  0.25699710845947266
generate_one_block  0.30431222915649414
generate_one_block  0.2580101490020752
generate_one_block  0.2623469829559326
generate_one_block  0.24594926834106445
generate_one_block  0.2561056613922119
generate_one_block  0.26676321029663086
generate_one_block  0.25612592697143555
generate_one_block  0.24921154975891113
generate_one_block  0.2950890064239502
generate_one_block  0.24690842628479004
generate_one_block  0.2554900646209717
generate_one_block  0.2415313720703125
generate_one_block  0.22968292236328125
generate_one_block  0.23938536643981934
generate_one_block  0.25297093391418457
generate_one_block  0.2584187984466553
generate_one_block  0.2512948513031006
generate_one_block  0.24226164817810059
generate_one_block  0.24299001693725586
generate_one_block  0.23792481422424316
generate_one_block  0.2439577579498291
generate_one_block  0.24274158477783203
generate_one_block  0.2388935089111328
generate_one_block  0.2473602294921875
generate_one_block  0.25134873390197754
generate_one_block  0.23233747482299805
generate_one_block  0.2456378936767578
generate_one_block  0.2581801414489746
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042439937591552734
gen group dst list time:  0.1127617359161377
time for parepare:  0.017889022827148438
local_output_nid generation:  0.029940128326416016
local_in_edges_tensor generation:  0.05778646469116211
mini_batch_src_global generation:  0.03922605514526367
r_  generation:  0.4290947914123535
local_output_nid generation:  0.031731367111206055
local_in_edges_tensor generation:  0.04211068153381348
mini_batch_src_global generation:  0.049344778060913086
r_  generation:  0.42029857635498047
local_output_nid generation:  0.03058648109436035
local_in_edges_tensor generation:  0.031409502029418945
mini_batch_src_global generation:  0.05533957481384277
r_  generation:  0.43343591690063477
local_output_nid generation:  0.03021383285522461
local_in_edges_tensor generation:  0.03163266181945801
mini_batch_src_global generation:  0.050304412841796875
r_  generation:  0.43321824073791504
local_output_nid generation:  0.031099796295166016
local_in_edges_tensor generation:  0.038173675537109375
mini_batch_src_global generation:  0.04969334602355957
r_  generation:  0.43996262550354004
local_output_nid generation:  0.03027510643005371
local_in_edges_tensor generation:  0.03765153884887695
mini_batch_src_global generation:  0.050132036209106445
r_  generation:  0.4368720054626465
local_output_nid generation:  0.03136277198791504
local_in_edges_tensor generation:  0.04003620147705078
mini_batch_src_global generation:  0.05540871620178223
r_  generation:  0.45098400115966797
local_output_nid generation:  0.031551361083984375
local_in_edges_tensor generation:  0.03386974334716797
mini_batch_src_global generation:  0.05549216270446777
r_  generation:  0.4348866939544678
local_output_nid generation:  0.03138899803161621
local_in_edges_tensor generation:  0.03197836875915527
mini_batch_src_global generation:  0.053262948989868164
r_  generation:  0.438645601272583
local_output_nid generation:  0.031033754348754883
local_in_edges_tensor generation:  0.02810955047607422
mini_batch_src_global generation:  0.05063176155090332
r_  generation:  0.4388456344604492
local_output_nid generation:  0.030971527099609375
local_in_edges_tensor generation:  0.03441643714904785
mini_batch_src_global generation:  0.05036163330078125
r_  generation:  0.43831872940063477
local_output_nid generation:  0.03097844123840332
local_in_edges_tensor generation:  0.03239083290100098
mini_batch_src_global generation:  0.0523984432220459
r_  generation:  0.4334852695465088
local_output_nid generation:  0.031226634979248047
local_in_edges_tensor generation:  0.036568403244018555
mini_batch_src_global generation:  0.050153255462646484
r_  generation:  0.44107675552368164
local_output_nid generation:  0.03095102310180664
local_in_edges_tensor generation:  0.029520511627197266
mini_batch_src_global generation:  0.05056166648864746
r_  generation:  0.4375934600830078
local_output_nid generation:  0.031169652938842773
local_in_edges_tensor generation:  0.03136754035949707
mini_batch_src_global generation:  0.05295968055725098
r_  generation:  0.4386172294616699
local_output_nid generation:  0.03140878677368164
local_in_edges_tensor generation:  0.0355837345123291
mini_batch_src_global generation:  0.05023026466369629
r_  generation:  0.43494224548339844
local_output_nid generation:  0.031160593032836914
local_in_edges_tensor generation:  0.02842545509338379
mini_batch_src_global generation:  0.050661563873291016
r_  generation:  0.43836140632629395
local_output_nid generation:  0.03131389617919922
local_in_edges_tensor generation:  0.030879497528076172
mini_batch_src_global generation:  0.05017518997192383
r_  generation:  0.4398171901702881
local_output_nid generation:  0.03194904327392578
local_in_edges_tensor generation:  0.036513566970825195
mini_batch_src_global generation:  0.05040764808654785
r_  generation:  0.4462854862213135
local_output_nid generation:  0.03141140937805176
local_in_edges_tensor generation:  0.036185503005981445
mini_batch_src_global generation:  0.05093526840209961
r_  generation:  0.4383676052093506
local_output_nid generation:  0.03111433982849121
local_in_edges_tensor generation:  0.0281219482421875
mini_batch_src_global generation:  0.04997444152832031
r_  generation:  0.43915367126464844
local_output_nid generation:  0.03134799003601074
local_in_edges_tensor generation:  0.027791738510131836
mini_batch_src_global generation:  0.05144953727722168
r_  generation:  0.4411163330078125
local_output_nid generation:  0.03130698204040527
local_in_edges_tensor generation:  0.03146481513977051
mini_batch_src_global generation:  0.05059981346130371
r_  generation:  0.44608521461486816
local_output_nid generation:  0.030959129333496094
local_in_edges_tensor generation:  0.02812957763671875
mini_batch_src_global generation:  0.05042552947998047
r_  generation:  0.43479228019714355
local_output_nid generation:  0.03139925003051758
local_in_edges_tensor generation:  0.03336834907531738
mini_batch_src_global generation:  0.0493924617767334
r_  generation:  0.4435455799102783
local_output_nid generation:  0.031051158905029297
local_in_edges_tensor generation:  0.0415804386138916
mini_batch_src_global generation:  0.05133461952209473
r_  generation:  0.4376063346862793
local_output_nid generation:  0.030914783477783203
local_in_edges_tensor generation:  0.027637958526611328
mini_batch_src_global generation:  0.0497736930847168
r_  generation:  0.43807387351989746
local_output_nid generation:  0.03216552734375
local_in_edges_tensor generation:  0.030170679092407227
mini_batch_src_global generation:  0.05307626724243164
r_  generation:  0.44359779357910156
local_output_nid generation:  0.03143191337585449
local_in_edges_tensor generation:  0.04208660125732422
mini_batch_src_global generation:  0.055472612380981445
r_  generation:  0.45441508293151855
local_output_nid generation:  0.03156876564025879
local_in_edges_tensor generation:  0.03520941734313965
mini_batch_src_global generation:  0.055895090103149414
r_  generation:  0.43350768089294434
local_output_nid generation:  0.0309603214263916
local_in_edges_tensor generation:  0.03378009796142578
mini_batch_src_global generation:  0.05429673194885254
r_  generation:  0.43958163261413574
local_output_nid generation:  0.03195381164550781
local_in_edges_tensor generation:  0.03835415840148926
mini_batch_src_global generation:  0.05141615867614746
r_  generation:  0.4396395683288574
----------------------check_connections_block total spend ----------------------------- 20.883246183395386
generate_one_block  0.6223592758178711
generate_one_block  0.583859920501709
generate_one_block  0.5785531997680664
generate_one_block  0.5907108783721924
generate_one_block  0.7123868465423584
generate_one_block  0.6362974643707275
generate_one_block  0.5903708934783936
generate_one_block  0.5908136367797852
generate_one_block  0.5967147350311279
generate_one_block  0.623481035232544
generate_one_block  0.580411434173584
generate_one_block  0.5796337127685547
generate_one_block  0.6015346050262451
generate_one_block  0.5909757614135742
generate_one_block  0.5882031917572021
generate_one_block  0.6003870964050293
generate_one_block  0.5813291072845459
generate_one_block  0.5995895862579346
generate_one_block  0.6104469299316406
generate_one_block  0.5953030586242676
generate_one_block  0.5784246921539307
generate_one_block  0.5828604698181152
generate_one_block  0.5877981185913086
generate_one_block  0.5839378833770752
generate_one_block  0.6070096492767334
generate_one_block  0.589815616607666
generate_one_block  0.582512378692627
generate_one_block  0.5844016075134277
generate_one_block  0.5757920742034912
generate_one_block  0.5879640579223633
generate_one_block  0.5941140651702881
generate_one_block  0.6032686233520508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.11290216445922852  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

connection checking time:  29.708637237548828
block generation total time  27.183814525604248
average batch blocks generation time:  0.8494942039251328
block dataloader generation time/epoch 60.65313386917114
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3182373046875 GB
    Memory Allocated: 0.09331178665161133  GigaBytes
Max Memory Allocated: 14.804604530334473  GigaBytes

torch.Size([149264, 128])
torch.Size([111583, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.901959419250488  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09232902526855469  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148526, 128])
torch.Size([108656, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.233821868896484  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09256172180175781  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148288, 128])
torch.Size([109458, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.587010860443115  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09284067153930664  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149103, 128])
torch.Size([110168, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.48615550994873  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09415245056152344  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149546, 128])
torch.Size([110774, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.652838230133057  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09255456924438477  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148305, 128])
torch.Size([108993, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.58338975906372  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09278440475463867  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148689, 128])
torch.Size([110053, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.656169891357422  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09272241592407227  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148947, 128])
torch.Size([109508, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.449105262756348  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.092864990234375  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148810, 128])
torch.Size([110148, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.651356220245361  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09282112121582031  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148604, 128])
torch.Size([109731, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.715385913848877  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.0927724838256836  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148894, 128])
torch.Size([109565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.54430103302002  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09257316589355469  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148622, 128])
torch.Size([109370, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.425664901733398  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09318208694458008  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149285, 128])
torch.Size([110924, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.748390197753906  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09224414825439453  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148144, 128])
torch.Size([108906, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.321895122528076  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.0924844741821289  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148292, 128])
torch.Size([109262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.507086277008057  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.0926661491394043  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148855, 128])
torch.Size([109894, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.422266960144043  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09261465072631836  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149229, 128])
torch.Size([109324, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.15936279296875  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09297847747802734  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149438, 128])
torch.Size([110384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.477009773254395  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09315967559814453  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149388, 128])
torch.Size([111070, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.712143898010254  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09306144714355469  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149038, 128])
torch.Size([110709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.746286392211914  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09290361404418945  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148849, 128])
torch.Size([109741, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.697004795074463  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09315299987792969  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149526, 128])
torch.Size([110737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.617504119873047  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09272193908691406  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148712, 128])
torch.Size([110219, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.591647624969482  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09228086471557617  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148121, 128])
torch.Size([108917, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.376024723052979  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09281635284423828  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148956, 128])
torch.Size([110047, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.526686191558838  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09293222427368164  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([149285, 128])
torch.Size([110407, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.489535808563232  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09245157241821289  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148647, 128])
torch.Size([108702, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.212093830108643  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09265708923339844  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148696, 128])
torch.Size([110136, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.499977111816406  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09280061721801758  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148907, 128])
torch.Size([109852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.480051517486572  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09213447570800781  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148118, 128])
torch.Size([108316, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.1541109085083  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09283304214477539  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148965, 128])
torch.Size([109834, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 14.568776607513428  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9686279296875 GB
    Memory Allocated: 0.09273958206176758  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

torch.Size([148435, 128])
torch.Size([109765, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9822998046875 GB
    Memory Allocated: 14.700148105621338  GigaBytes
Max Memory Allocated: 14.9448823928833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02845478057861328 |0.02108205109834671 |0.5449957922101021 |9.926408529281616e-05 |0.9891203865408897 |0.005112648010253906 |
----------------------------------------------------------pseudo_mini_loss sum 3.3160436153411865
Total (block generation + training)time/epoch 111.40096759796143
Training time/epoch 50.747588872909546
Training time without block to device /epoch 50.07296323776245
Training time without total dataloading part /epoch 49.10000681877136
load block tensor time/epoch 0.910552978515625
block to device time/epoch 0.6746256351470947
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9117420
Number of first layer input nodes during this epoch:  4762484
