Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648523613.904574
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.003612995147705078  GigaBytes
Max Memory Allocated: 0.003612995147705078  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.045894622802734375
random selection method range initialization spend 0.005906581878662109
time for parepare:  0.018543243408203125
local_output_nid generation:  0.002268552780151367
local_in_edges_tensor generation:  0.004759073257446289
mini_batch_src_global generation:  0.0017855167388916016
r_  generation:  0.017832279205322266
local_output_nid generation:  0.002556324005126953
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.0021085739135742188
r_  generation:  0.017159700393676758
local_output_nid generation:  0.0027627944946289062
local_in_edges_tensor generation:  0.0016834735870361328
mini_batch_src_global generation:  0.0013017654418945312
r_  generation:  0.017161846160888672
local_output_nid generation:  0.002870321273803711
local_in_edges_tensor generation:  0.0015492439270019531
mini_batch_src_global generation:  0.0013670921325683594
r_  generation:  0.017803192138671875
local_output_nid generation:  0.0028531551361083984
local_in_edges_tensor generation:  0.0015430450439453125
mini_batch_src_global generation:  0.0013153553009033203
r_  generation:  0.017083406448364258
local_output_nid generation:  0.0028493404388427734
local_in_edges_tensor generation:  0.0014619827270507812
mini_batch_src_global generation:  0.0012667179107666016
r_  generation:  0.01773357391357422
local_output_nid generation:  0.0027875900268554688
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0013582706451416016
r_  generation:  0.018062353134155273
local_output_nid generation:  0.0028793811798095703
local_in_edges_tensor generation:  0.0014739036560058594
mini_batch_src_global generation:  0.001512765884399414
r_  generation:  0.01775979995727539
local_output_nid generation:  0.002784252166748047
local_in_edges_tensor generation:  0.0014834403991699219
mini_batch_src_global generation:  0.0014286041259765625
r_  generation:  0.017959117889404297
local_output_nid generation:  0.0028753280639648438
local_in_edges_tensor generation:  0.001493692398071289
mini_batch_src_global generation:  0.001519918441772461
r_  generation:  0.01811671257019043
local_output_nid generation:  0.0028836727142333984
local_in_edges_tensor generation:  0.0014696121215820312
mini_batch_src_global generation:  0.0014750957489013672
r_  generation:  0.018410921096801758
local_output_nid generation:  0.0028619766235351562
local_in_edges_tensor generation:  0.0015592575073242188
mini_batch_src_global generation:  0.0014390945434570312
r_  generation:  0.01788640022277832
local_output_nid generation:  0.002893209457397461
local_in_edges_tensor generation:  0.001522064208984375
mini_batch_src_global generation:  0.0014958381652832031
r_  generation:  0.01853322982788086
local_output_nid generation:  0.0028591156005859375
local_in_edges_tensor generation:  0.0014824867248535156
mini_batch_src_global generation:  0.001428842544555664
r_  generation:  0.01844477653503418
local_output_nid generation:  0.0028743743896484375
local_in_edges_tensor generation:  0.0014679431915283203
mini_batch_src_global generation:  0.001399993896484375
r_  generation:  0.018514394760131836
local_output_nid generation:  0.0028693675994873047
local_in_edges_tensor generation:  0.0015056133270263672
mini_batch_src_global generation:  0.0015473365783691406
r_  generation:  0.018768787384033203
----------------------check_connections_block total spend ----------------------------- 0.4777655601501465
generate_one_block  0.027477025985717773
generate_one_block  0.02773594856262207
generate_one_block  0.027504920959472656
generate_one_block  0.030793190002441406
generate_one_block  0.02778172492980957
generate_one_block  0.027927398681640625
generate_one_block  0.026872634887695312
generate_one_block  0.027045011520385742
generate_one_block  0.027248144149780273
generate_one_block  0.02738666534423828
generate_one_block  0.02681279182434082
generate_one_block  0.02641582489013672
generate_one_block  0.027664899826049805
generate_one_block  0.02728581428527832
generate_one_block  0.027253389358520508
generate_one_block  0.0272676944732666
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04177737236022949
gen group dst list time:  0.019021987915039062
time for parepare:  0.019211769104003906
local_output_nid generation:  0.008414983749389648
local_in_edges_tensor generation:  0.020013809204101562
mini_batch_src_global generation:  0.0215301513671875
r_  generation:  0.19991040229797363
local_output_nid generation:  0.012355804443359375
local_in_edges_tensor generation:  0.019956111907958984
mini_batch_src_global generation:  0.025368213653564453
r_  generation:  0.20792937278747559
local_output_nid generation:  0.011899471282958984
local_in_edges_tensor generation:  0.01432037353515625
mini_batch_src_global generation:  0.02474045753479004
r_  generation:  0.20913004875183105
local_output_nid generation:  0.012144088745117188
local_in_edges_tensor generation:  0.018972396850585938
mini_batch_src_global generation:  0.025646686553955078
r_  generation:  0.2170255184173584
local_output_nid generation:  0.011916160583496094
local_in_edges_tensor generation:  0.014870643615722656
mini_batch_src_global generation:  0.026780366897583008
r_  generation:  0.22087550163269043
local_output_nid generation:  0.011899709701538086
local_in_edges_tensor generation:  0.014669179916381836
mini_batch_src_global generation:  0.029453039169311523
r_  generation:  0.2213728427886963
local_output_nid generation:  0.011827945709228516
local_in_edges_tensor generation:  0.012623071670532227
mini_batch_src_global generation:  0.026679277420043945
r_  generation:  0.2121903896331787
local_output_nid generation:  0.011747121810913086
local_in_edges_tensor generation:  0.012327909469604492
mini_batch_src_global generation:  0.026792049407958984
r_  generation:  0.21271634101867676
local_output_nid generation:  0.011854171752929688
local_in_edges_tensor generation:  0.013946771621704102
mini_batch_src_global generation:  0.026795625686645508
r_  generation:  0.2177433967590332
local_output_nid generation:  0.01185750961303711
local_in_edges_tensor generation:  0.020073890686035156
mini_batch_src_global generation:  0.028104543685913086
r_  generation:  0.21973609924316406
local_output_nid generation:  0.011778593063354492
local_in_edges_tensor generation:  0.01261591911315918
mini_batch_src_global generation:  0.026948928833007812
r_  generation:  0.2185194492340088
local_output_nid generation:  0.011737585067749023
local_in_edges_tensor generation:  0.014144659042358398
mini_batch_src_global generation:  0.027081727981567383
r_  generation:  0.21143770217895508
local_output_nid generation:  0.01186680793762207
local_in_edges_tensor generation:  0.01256108283996582
mini_batch_src_global generation:  0.02888178825378418
r_  generation:  0.21919608116149902
local_output_nid generation:  0.01184225082397461
local_in_edges_tensor generation:  0.017731428146362305
mini_batch_src_global generation:  0.027600526809692383
r_  generation:  0.21512293815612793
local_output_nid generation:  0.011831045150756836
local_in_edges_tensor generation:  0.014459371566772461
mini_batch_src_global generation:  0.028905630111694336
r_  generation:  0.21931982040405273
local_output_nid generation:  0.011982917785644531
local_in_edges_tensor generation:  0.018267393112182617
mini_batch_src_global generation:  0.028073549270629883
r_  generation:  0.22066855430603027
----------------------check_connections_block total spend ----------------------------- 5.093314170837402
generate_one_block  0.28693056106567383
generate_one_block  0.27762460708618164
generate_one_block  0.2771592140197754
generate_one_block  0.287062406539917
generate_one_block  0.30670595169067383
generate_one_block  0.2876012325286865
generate_one_block  0.27208900451660156
generate_one_block  0.28050732612609863
generate_one_block  0.27854037284851074
generate_one_block  0.28667187690734863
generate_one_block  0.2745814323425293
generate_one_block  0.27431774139404297
generate_one_block  0.27906250953674316
generate_one_block  0.2763645648956299
generate_one_block  0.2868001461029053
generate_one_block  0.28704261779785156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04056429862976074
gen group dst list time:  0.060112714767456055
time for parepare:  0.01875162124633789
local_output_nid generation:  0.025387048721313477
local_in_edges_tensor generation:  0.04341387748718262
mini_batch_src_global generation:  0.050574302673339844
r_  generation:  0.48573970794677734
local_output_nid generation:  0.031198740005493164
local_in_edges_tensor generation:  0.05106854438781738
mini_batch_src_global generation:  0.058969974517822266
r_  generation:  0.4909474849700928
local_output_nid generation:  0.030579805374145508
local_in_edges_tensor generation:  0.038114070892333984
mini_batch_src_global generation:  0.0624387264251709
r_  generation:  0.5004279613494873
local_output_nid generation:  0.03060603141784668
local_in_edges_tensor generation:  0.042973995208740234
mini_batch_src_global generation:  0.06239485740661621
r_  generation:  0.49637675285339355
local_output_nid generation:  0.030889272689819336
local_in_edges_tensor generation:  0.04755902290344238
mini_batch_src_global generation:  0.06745529174804688
r_  generation:  0.5066394805908203
local_output_nid generation:  0.03077101707458496
local_in_edges_tensor generation:  0.03774714469909668
mini_batch_src_global generation:  0.07834219932556152
r_  generation:  0.510291576385498
local_output_nid generation:  0.030919790267944336
local_in_edges_tensor generation:  0.03434300422668457
mini_batch_src_global generation:  0.06125497817993164
r_  generation:  0.5101053714752197
local_output_nid generation:  0.031219959259033203
local_in_edges_tensor generation:  0.03418159484863281
mini_batch_src_global generation:  0.05984783172607422
r_  generation:  0.5219385623931885
local_output_nid generation:  0.03248310089111328
local_in_edges_tensor generation:  0.06626033782958984
mini_batch_src_global generation:  0.07223081588745117
r_  generation:  0.5125324726104736
local_output_nid generation:  0.03302288055419922
local_in_edges_tensor generation:  0.039473772048950195
mini_batch_src_global generation:  0.06002378463745117
r_  generation:  0.5107386112213135
local_output_nid generation:  0.03191804885864258
local_in_edges_tensor generation:  0.041013479232788086
mini_batch_src_global generation:  0.059383392333984375
r_  generation:  0.5375497341156006
local_output_nid generation:  0.03487277030944824
local_in_edges_tensor generation:  0.04868268966674805
mini_batch_src_global generation:  0.06157803535461426
r_  generation:  0.5071015357971191
local_output_nid generation:  0.03191423416137695
local_in_edges_tensor generation:  0.04058098793029785
mini_batch_src_global generation:  0.06109452247619629
r_  generation:  0.5216720104217529
local_output_nid generation:  0.03220796585083008
local_in_edges_tensor generation:  0.04071187973022461
mini_batch_src_global generation:  0.07077383995056152
r_  generation:  0.506061315536499
local_output_nid generation:  0.03191041946411133
local_in_edges_tensor generation:  0.044419288635253906
mini_batch_src_global generation:  0.05844473838806152
r_  generation:  0.516075849533081
local_output_nid generation:  0.03291511535644531
local_in_edges_tensor generation:  0.03787517547607422
mini_batch_src_global generation:  0.07091236114501953
r_  generation:  0.5443379878997803
----------------------check_connections_block total spend ----------------------------- 12.18052887916565
generate_one_block  0.6768028736114502
generate_one_block  0.6617565155029297
generate_one_block  0.6777088642120361
generate_one_block  0.7003500461578369
generate_one_block  0.678502082824707
generate_one_block  0.6617820262908936
generate_one_block  0.7574155330657959
generate_one_block  0.6546320915222168
generate_one_block  0.6826274394989014
generate_one_block  0.6419270038604736
generate_one_block  0.6373856067657471
generate_one_block  0.6418178081512451
generate_one_block  0.6773028373718262
generate_one_block  0.6551361083984375
generate_one_block  0.6521379947662354
generate_one_block  0.6499166488647461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.07751989364624023
gen group dst list time:  0.10387420654296875
time for parepare:  0.019850730895996094
local_output_nid generation:  0.0366060733795166
local_in_edges_tensor generation:  0.06286978721618652
mini_batch_src_global generation:  0.05094552040100098
r_  generation:  0.5505702495574951
local_output_nid generation:  0.03965353965759277
local_in_edges_tensor generation:  0.059926748275756836
mini_batch_src_global generation:  0.06400585174560547
r_  generation:  0.549431562423706
local_output_nid generation:  0.03919649124145508
local_in_edges_tensor generation:  0.04477810859680176
mini_batch_src_global generation:  0.06342792510986328
r_  generation:  0.5521402359008789
local_output_nid generation:  0.03876018524169922
local_in_edges_tensor generation:  0.050077199935913086
mini_batch_src_global generation:  0.0634012222290039
r_  generation:  0.5536987781524658
local_output_nid generation:  0.039325714111328125
local_in_edges_tensor generation:  0.050251007080078125
mini_batch_src_global generation:  0.05975222587585449
r_  generation:  0.5607194900512695
local_output_nid generation:  0.039008140563964844
local_in_edges_tensor generation:  0.051621198654174805
mini_batch_src_global generation:  0.05954170227050781
r_  generation:  0.5629174709320068
local_output_nid generation:  0.03995966911315918
local_in_edges_tensor generation:  0.044579267501831055
mini_batch_src_global generation:  0.06107044219970703
r_  generation:  0.5647361278533936
local_output_nid generation:  0.03900790214538574
local_in_edges_tensor generation:  0.04042768478393555
mini_batch_src_global generation:  0.06077432632446289
r_  generation:  0.5679895877838135
local_output_nid generation:  0.03921079635620117
local_in_edges_tensor generation:  0.043219804763793945
mini_batch_src_global generation:  0.06702780723571777
r_  generation:  0.5814042091369629
local_output_nid generation:  0.03989887237548828
local_in_edges_tensor generation:  0.050072431564331055
mini_batch_src_global generation:  0.07442378997802734
r_  generation:  0.5706996917724609
local_output_nid generation:  0.04188942909240723
local_in_edges_tensor generation:  0.05454373359680176
mini_batch_src_global generation:  0.06412601470947266
r_  generation:  0.5693538188934326
local_output_nid generation:  0.040322303771972656
local_in_edges_tensor generation:  0.04745602607727051
mini_batch_src_global generation:  0.061652421951293945
r_  generation:  0.5683515071868896
local_output_nid generation:  0.04006528854370117
local_in_edges_tensor generation:  0.04449462890625
mini_batch_src_global generation:  0.0625615119934082
r_  generation:  0.5687277317047119
local_output_nid generation:  0.03983020782470703
local_in_edges_tensor generation:  0.04452204704284668
mini_batch_src_global generation:  0.061239004135131836
r_  generation:  0.57228684425354
local_output_nid generation:  0.04032492637634277
local_in_edges_tensor generation:  0.044289350509643555
mini_batch_src_global generation:  0.06274843215942383
r_  generation:  0.569061279296875
local_output_nid generation:  0.039815425872802734
local_in_edges_tensor generation:  0.044589996337890625
mini_batch_src_global generation:  0.07117533683776855
r_  generation:  0.5721762180328369
----------------------check_connections_block total spend ----------------------------- 13.56688380241394
generate_one_block  0.7025697231292725
generate_one_block  0.7009577751159668
generate_one_block  0.704862117767334
generate_one_block  0.7860381603240967
generate_one_block  0.7108511924743652
generate_one_block  0.693779468536377
generate_one_block  0.7074475288391113
generate_one_block  0.6928884983062744
generate_one_block  0.6938605308532715
generate_one_block  0.7188477516174316
generate_one_block  0.7020101547241211
generate_one_block  0.7087593078613281
generate_one_block  0.6996128559112549
generate_one_block  0.7102484703063965
generate_one_block  0.6932835578918457
generate_one_block  0.7041234970092773
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05705547332763672
gen group dst list time:  0.09796690940856934
time for parepare:  0.01932811737060547
local_output_nid generation:  0.036580562591552734
local_in_edges_tensor generation:  0.06053781509399414
mini_batch_src_global generation:  0.049387216567993164
r_  generation:  0.5460493564605713
local_output_nid generation:  0.04247570037841797
local_in_edges_tensor generation:  0.04008316993713379
mini_batch_src_global generation:  0.06308865547180176
r_  generation:  0.5590105056762695
local_output_nid generation:  0.040390968322753906
local_in_edges_tensor generation:  0.04036307334899902
mini_batch_src_global generation:  0.06359195709228516
r_  generation:  0.5429627895355225
local_output_nid generation:  0.040293216705322266
local_in_edges_tensor generation:  0.04305577278137207
mini_batch_src_global generation:  0.06184530258178711
r_  generation:  0.5549051761627197
local_output_nid generation:  0.04366612434387207
local_in_edges_tensor generation:  0.043234825134277344
mini_batch_src_global generation:  0.06479716300964355
r_  generation:  0.5484628677368164
local_output_nid generation:  0.041202545166015625
local_in_edges_tensor generation:  0.03778696060180664
mini_batch_src_global generation:  0.06202983856201172
r_  generation:  0.5504062175750732
local_output_nid generation:  0.04140901565551758
local_in_edges_tensor generation:  0.043474435806274414
mini_batch_src_global generation:  0.06632876396179199
r_  generation:  0.5484058856964111
local_output_nid generation:  0.0412755012512207
local_in_edges_tensor generation:  0.03856611251831055
mini_batch_src_global generation:  0.0616762638092041
r_  generation:  0.5494592189788818
local_output_nid generation:  0.0413360595703125
local_in_edges_tensor generation:  0.04201912879943848
mini_batch_src_global generation:  0.06619572639465332
r_  generation:  0.554093599319458
local_output_nid generation:  0.041055917739868164
local_in_edges_tensor generation:  0.0383756160736084
mini_batch_src_global generation:  0.062026262283325195
r_  generation:  0.553502082824707
local_output_nid generation:  0.041105031967163086
local_in_edges_tensor generation:  0.042939186096191406
mini_batch_src_global generation:  0.06555414199829102
r_  generation:  0.5532987117767334
local_output_nid generation:  0.04125070571899414
local_in_edges_tensor generation:  0.03840374946594238
mini_batch_src_global generation:  0.06231856346130371
r_  generation:  0.5551431179046631
local_output_nid generation:  0.041188955307006836
local_in_edges_tensor generation:  0.047621726989746094
mini_batch_src_global generation:  0.062398672103881836
r_  generation:  0.5543563365936279
local_output_nid generation:  0.0409245491027832
local_in_edges_tensor generation:  0.042427778244018555
mini_batch_src_global generation:  0.06501913070678711
r_  generation:  0.5576784610748291
local_output_nid generation:  0.04097771644592285
local_in_edges_tensor generation:  0.04269695281982422
mini_batch_src_global generation:  0.06086444854736328
r_  generation:  0.560295820236206
local_output_nid generation:  0.04123687744140625
local_in_edges_tensor generation:  0.04242992401123047
mini_batch_src_global generation:  0.06621146202087402
r_  generation:  0.5640251636505127
----------------------check_connections_block total spend ----------------------------- 13.304825782775879
generate_one_block  0.688870906829834
generate_one_block  0.6854267120361328
generate_one_block  0.6856322288513184
generate_one_block  0.6941444873809814
generate_one_block  0.6919083595275879
generate_one_block  0.6864850521087646
generate_one_block  0.7486107349395752
generate_one_block  0.6736164093017578
generate_one_block  0.687432050704956
generate_one_block  0.6733229160308838
generate_one_block  0.6930642127990723
generate_one_block  0.7044522762298584
generate_one_block  0.6962118148803711
generate_one_block  0.6914589405059814
generate_one_block  0.6926255226135254
generate_one_block  0.691291332244873
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0427248477935791
gen group dst list time:  0.1008138656616211
time for parepare:  0.019174814224243164
local_output_nid generation:  0.03855276107788086
local_in_edges_tensor generation:  0.047857046127319336
mini_batch_src_global generation:  0.04549288749694824
r_  generation:  0.5011024475097656
local_output_nid generation:  0.044148921966552734
local_in_edges_tensor generation:  0.03513479232788086
mini_batch_src_global generation:  0.057895660400390625
r_  generation:  0.5088746547698975
local_output_nid generation:  0.04169130325317383
local_in_edges_tensor generation:  0.036521196365356445
mini_batch_src_global generation:  0.05850386619567871
r_  generation:  0.5072469711303711
local_output_nid generation:  0.04115748405456543
local_in_edges_tensor generation:  0.0358428955078125
mini_batch_src_global generation:  0.05830693244934082
r_  generation:  0.506486177444458
local_output_nid generation:  0.041322946548461914
local_in_edges_tensor generation:  0.035797119140625
mini_batch_src_global generation:  0.0584406852722168
r_  generation:  0.5071988105773926
local_output_nid generation:  0.04115605354309082
local_in_edges_tensor generation:  0.04140353202819824
mini_batch_src_global generation:  0.057926177978515625
r_  generation:  0.5088813304901123
local_output_nid generation:  0.041149139404296875
local_in_edges_tensor generation:  0.03587460517883301
mini_batch_src_global generation:  0.058283329010009766
r_  generation:  0.5118205547332764
local_output_nid generation:  0.041228532791137695
local_in_edges_tensor generation:  0.03612327575683594
mini_batch_src_global generation:  0.057842254638671875
r_  generation:  0.5127320289611816
local_output_nid generation:  0.04107522964477539
local_in_edges_tensor generation:  0.0401155948638916
mini_batch_src_global generation:  0.061872243881225586
r_  generation:  0.5150692462921143
local_output_nid generation:  0.0412747859954834
local_in_edges_tensor generation:  0.0378415584564209
mini_batch_src_global generation:  0.05803942680358887
r_  generation:  0.5176301002502441
local_output_nid generation:  0.041620731353759766
local_in_edges_tensor generation:  0.04450821876525879
mini_batch_src_global generation:  0.0613253116607666
r_  generation:  0.5163710117340088
local_output_nid generation:  0.04160141944885254
local_in_edges_tensor generation:  0.04480576515197754
mini_batch_src_global generation:  0.05807757377624512
r_  generation:  0.5193099975585938
local_output_nid generation:  0.04170489311218262
local_in_edges_tensor generation:  0.046713829040527344
mini_batch_src_global generation:  0.05836606025695801
r_  generation:  0.5201706886291504
local_output_nid generation:  0.041810035705566406
local_in_edges_tensor generation:  0.03613018989562988
mini_batch_src_global generation:  0.05874776840209961
r_  generation:  0.5157434940338135
local_output_nid generation:  0.04149007797241211
local_in_edges_tensor generation:  0.039896249771118164
mini_batch_src_global generation:  0.06236743927001953
r_  generation:  0.5157783031463623
local_output_nid generation:  0.042444705963134766
local_in_edges_tensor generation:  0.046781301498413086
mini_batch_src_global generation:  0.059850215911865234
r_  generation:  0.5186247825622559
----------------------check_connections_block total spend ----------------------------- 12.420336961746216
generate_one_block  0.6374413967132568
generate_one_block  0.7102596759796143
generate_one_block  0.6871190071105957
generate_one_block  0.665020227432251
generate_one_block  0.6583724021911621
generate_one_block  0.635469913482666
generate_one_block  0.6797130107879639
generate_one_block  0.6509957313537598
generate_one_block  0.7468142509460449
generate_one_block  0.6454777717590332
generate_one_block  0.6595969200134277
generate_one_block  0.6613845825195312
generate_one_block  0.6419057846069336
generate_one_block  0.6476762294769287
generate_one_block  0.651280403137207
generate_one_block  0.6514477729797363
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.003612995147705078  GigaBytes
Max Memory Allocated: 0.003612995147705078  GigaBytes

connection checking time:  56.56588959693909
block generation total time  48.27093267440796
average batch blocks generation time:  3.0169332921504974
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2244873046875 GB
    Memory Allocated: 0.13861989974975586  GigaBytes
Max Memory Allocated: 0.13861989974975586  GigaBytes

torch.Size([167140, 128])
torch.Size([166317, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.35 GiB already allocated; 6.44 MiB free; 22.42 GiB reserved in total by PyTorch)
