Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648460633.7795641
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026233196258544922
random selection method range initialization spend 0.005715370178222656
time for parepare:  0.019073963165283203
local_output_nid generation:  0.002222299575805664
local_in_edges_tensor generation:  0.003856658935546875
mini_batch_src_global generation:  0.001976490020751953
r_  generation:  0.021245956420898438
local_output_nid generation:  0.0029730796813964844
local_in_edges_tensor generation:  0.001672506332397461
mini_batch_src_global generation:  0.0023348331451416016
r_  generation:  0.020944595336914062
local_output_nid generation:  0.0030362606048583984
local_in_edges_tensor generation:  0.0016028881072998047
mini_batch_src_global generation:  0.0015671253204345703
r_  generation:  0.021196842193603516
local_output_nid generation:  0.0030753612518310547
local_in_edges_tensor generation:  0.0015633106231689453
mini_batch_src_global generation:  0.0016117095947265625
r_  generation:  0.021085023880004883
local_output_nid generation:  0.003000974655151367
local_in_edges_tensor generation:  0.0016255378723144531
mini_batch_src_global generation:  0.001550912857055664
r_  generation:  0.02129364013671875
local_output_nid generation:  0.002969026565551758
local_in_edges_tensor generation:  0.0015366077423095703
mini_batch_src_global generation:  0.0016355514526367188
r_  generation:  0.02150249481201172
local_output_nid generation:  0.002968311309814453
local_in_edges_tensor generation:  0.0015170574188232422
mini_batch_src_global generation:  0.0016491413116455078
r_  generation:  0.022036075592041016
local_output_nid generation:  0.002959728240966797
local_in_edges_tensor generation:  0.0015468597412109375
mini_batch_src_global generation:  0.0016417503356933594
r_  generation:  0.02137923240661621
local_output_nid generation:  0.003024578094482422
local_in_edges_tensor generation:  0.001543283462524414
mini_batch_src_global generation:  0.0015943050384521484
r_  generation:  0.02079629898071289
local_output_nid generation:  0.0030388832092285156
local_in_edges_tensor generation:  0.0015478134155273438
mini_batch_src_global generation:  0.0016560554504394531
r_  generation:  0.022019147872924805
local_output_nid generation:  0.0030095577239990234
local_in_edges_tensor generation:  0.0015101432800292969
mini_batch_src_global generation:  0.001741170883178711
r_  generation:  0.022022485733032227
local_output_nid generation:  0.0030117034912109375
local_in_edges_tensor generation:  0.0015213489532470703
mini_batch_src_global generation:  0.0016713142395019531
r_  generation:  0.02177286148071289
local_output_nid generation:  0.0030167102813720703
local_in_edges_tensor generation:  0.001535177230834961
mini_batch_src_global generation:  0.0017285346984863281
r_  generation:  0.022125959396362305
local_output_nid generation:  0.0030236244201660156
local_in_edges_tensor generation:  0.001537322998046875
mini_batch_src_global generation:  0.0017483234405517578
r_  generation:  0.022542238235473633
local_output_nid generation:  0.003082275390625
local_in_edges_tensor generation:  0.001516103744506836
mini_batch_src_global generation:  0.0017352104187011719
r_  generation:  0.02183246612548828
local_output_nid generation:  0.0030121803283691406
local_in_edges_tensor generation:  0.0014913082122802734
mini_batch_src_global generation:  0.004171848297119141
r_  generation:  0.022427082061767578
----------------------check_connections_block total spend ----------------------------- 0.5572752952575684
generate_one_block  0.03052544593811035
generate_one_block  0.03210115432739258
generate_one_block  0.03524327278137207
generate_one_block  0.032439470291137695
generate_one_block  0.03179645538330078
generate_one_block  0.031089305877685547
generate_one_block  0.031542301177978516
generate_one_block  0.030616044998168945
generate_one_block  0.030666351318359375
generate_one_block  0.03149914741516113
generate_one_block  0.031213760375976562
generate_one_block  0.03087782859802246
generate_one_block  0.03072667121887207
generate_one_block  0.031661272048950195
generate_one_block  0.03148078918457031
generate_one_block  0.0323638916015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03499722480773926
gen group dst list time:  0.020632028579711914
time for parepare:  0.01943206787109375
local_output_nid generation:  0.009345054626464844
local_in_edges_tensor generation:  0.02160358428955078
mini_batch_src_global generation:  0.021164417266845703
r_  generation:  0.21622228622436523
local_output_nid generation:  0.014948606491088867
local_in_edges_tensor generation:  0.021548032760620117
mini_batch_src_global generation:  0.027114152908325195
r_  generation:  0.2231905460357666
local_output_nid generation:  0.014962911605834961
local_in_edges_tensor generation:  0.01973271369934082
mini_batch_src_global generation:  0.02635812759399414
r_  generation:  0.2286379337310791
local_output_nid generation:  0.014956235885620117
local_in_edges_tensor generation:  0.013928651809692383
mini_batch_src_global generation:  0.02757096290588379
r_  generation:  0.2335951328277588
local_output_nid generation:  0.015069007873535156
local_in_edges_tensor generation:  0.015765666961669922
mini_batch_src_global generation:  0.03033161163330078
r_  generation:  0.2384040355682373
local_output_nid generation:  0.015019416809082031
local_in_edges_tensor generation:  0.014052152633666992
mini_batch_src_global generation:  0.028922319412231445
r_  generation:  0.2310023307800293
local_output_nid generation:  0.01479792594909668
local_in_edges_tensor generation:  0.017222166061401367
mini_batch_src_global generation:  0.02869391441345215
r_  generation:  0.23348164558410645
local_output_nid generation:  0.014711380004882812
local_in_edges_tensor generation:  0.0170900821685791
mini_batch_src_global generation:  0.028615713119506836
r_  generation:  0.22801709175109863
local_output_nid generation:  0.014548540115356445
local_in_edges_tensor generation:  0.015587091445922852
mini_batch_src_global generation:  0.02880120277404785
r_  generation:  0.23080873489379883
local_output_nid generation:  0.015004158020019531
local_in_edges_tensor generation:  0.01531839370727539
mini_batch_src_global generation:  0.031001806259155273
r_  generation:  0.23700976371765137
local_output_nid generation:  0.01483154296875
local_in_edges_tensor generation:  0.017673254013061523
mini_batch_src_global generation:  0.02925586700439453
r_  generation:  0.24031805992126465
local_output_nid generation:  0.014767646789550781
local_in_edges_tensor generation:  0.015465259552001953
mini_batch_src_global generation:  0.031458139419555664
r_  generation:  0.23550820350646973
local_output_nid generation:  0.01482701301574707
local_in_edges_tensor generation:  0.013569355010986328
mini_batch_src_global generation:  0.029317617416381836
r_  generation:  0.2342214584350586
local_output_nid generation:  0.014986038208007812
local_in_edges_tensor generation:  0.017349720001220703
mini_batch_src_global generation:  0.029961824417114258
r_  generation:  0.2379767894744873
local_output_nid generation:  0.014665365219116211
local_in_edges_tensor generation:  0.013146162033081055
mini_batch_src_global generation:  0.029650211334228516
r_  generation:  0.23381376266479492
local_output_nid generation:  0.015121936798095703
local_in_edges_tensor generation:  0.013583660125732422
mini_batch_src_global generation:  0.029903650283813477
r_  generation:  0.24167418479919434
----------------------check_connections_block total spend ----------------------------- 5.5102643966674805
generate_one_block  0.3123047351837158
generate_one_block  0.30488133430480957
generate_one_block  0.30730509757995605
generate_one_block  0.31048130989074707
generate_one_block  0.32406044006347656
generate_one_block  0.29930901527404785
generate_one_block  0.30222296714782715
generate_one_block  0.29804444313049316
generate_one_block  0.29928135871887207
generate_one_block  0.3060028553009033
generate_one_block  0.30695176124572754
generate_one_block  0.30512332916259766
generate_one_block  0.301893949508667
generate_one_block  0.3226327896118164
generate_one_block  0.30402541160583496
generate_one_block  0.31508302688598633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03365182876586914
gen group dst list time:  0.06087207794189453
time for parepare:  0.01946878433227539
local_output_nid generation:  0.02594470977783203
local_in_edges_tensor generation:  0.035712242126464844
mini_batch_src_global generation:  0.0440371036529541
r_  generation:  0.4433913230895996
local_output_nid generation:  0.03223991394042969
local_in_edges_tensor generation:  0.04720568656921387
mini_batch_src_global generation:  0.05102801322937012
r_  generation:  0.45267581939697266
local_output_nid generation:  0.03156590461730957
local_in_edges_tensor generation:  0.0352330207824707
mini_batch_src_global generation:  0.05052685737609863
r_  generation:  0.4581573009490967
local_output_nid generation:  0.03164482116699219
local_in_edges_tensor generation:  0.03905773162841797
mini_batch_src_global generation:  0.05145406723022461
r_  generation:  0.4559485912322998
local_output_nid generation:  0.03165078163146973
local_in_edges_tensor generation:  0.031197071075439453
mini_batch_src_global generation:  0.051927804946899414
r_  generation:  0.46402549743652344
local_output_nid generation:  0.031504154205322266
local_in_edges_tensor generation:  0.034876108169555664
mini_batch_src_global generation:  0.05266427993774414
r_  generation:  0.4604353904724121
local_output_nid generation:  0.031238794326782227
local_in_edges_tensor generation:  0.03943514823913574
mini_batch_src_global generation:  0.051676034927368164
r_  generation:  0.4666271209716797
local_output_nid generation:  0.031392574310302734
local_in_edges_tensor generation:  0.031031131744384766
mini_batch_src_global generation:  0.05308055877685547
r_  generation:  0.46146368980407715
local_output_nid generation:  0.03162264823913574
local_in_edges_tensor generation:  0.030993938446044922
mini_batch_src_global generation:  0.05211186408996582
r_  generation:  0.47046613693237305
local_output_nid generation:  0.031650543212890625
local_in_edges_tensor generation:  0.0390927791595459
mini_batch_src_global generation:  0.052681922912597656
r_  generation:  0.4611237049102783
local_output_nid generation:  0.03139615058898926
local_in_edges_tensor generation:  0.038829803466796875
mini_batch_src_global generation:  0.05190324783325195
r_  generation:  0.4725334644317627
local_output_nid generation:  0.03128862380981445
local_in_edges_tensor generation:  0.03084254264831543
mini_batch_src_global generation:  0.053400516510009766
r_  generation:  0.4637148380279541
local_output_nid generation:  0.03176164627075195
local_in_edges_tensor generation:  0.0340726375579834
mini_batch_src_global generation:  0.0514066219329834
r_  generation:  0.4690248966217041
local_output_nid generation:  0.03135561943054199
local_in_edges_tensor generation:  0.04694938659667969
mini_batch_src_global generation:  0.052741289138793945
r_  generation:  0.4601280689239502
local_output_nid generation:  0.03137612342834473
local_in_edges_tensor generation:  0.031035184860229492
mini_batch_src_global generation:  0.05215859413146973
r_  generation:  0.47329044342041016
local_output_nid generation:  0.0316469669342041
local_in_edges_tensor generation:  0.038314104080200195
mini_batch_src_global generation:  0.05497431755065918
r_  generation:  0.46686339378356934
----------------------check_connections_block total spend ----------------------------- 10.917850017547607
generate_one_block  0.6044046878814697
generate_one_block  0.6464123725891113
generate_one_block  0.6111037731170654
generate_one_block  0.5992527008056641
generate_one_block  0.6088070869445801
generate_one_block  0.6013174057006836
generate_one_block  0.6925227642059326
generate_one_block  0.5948331356048584
generate_one_block  0.594778299331665
generate_one_block  0.6102561950683594
generate_one_block  0.5946533679962158
generate_one_block  0.5853924751281738
generate_one_block  0.5849614143371582
generate_one_block  0.6071414947509766
generate_one_block  0.5721650123596191
generate_one_block  0.5956368446350098
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  16.428114414215088
block generation total time  14.623242855072021
average batch blocks generation time:  0.9139526784420013
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09252405166625977  GigaBytes
Max Memory Allocated: 0.09252405166625977  GigaBytes

torch.Size([155118, 128])
torch.Size([125519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4061279296875 GB
    Memory Allocated: 16.790130138397217  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09481334686279297  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155226, 128])
torch.Size([125206, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.715073585510254  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.0950918197631836  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155076, 128])
torch.Size([125055, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.78103017807007  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.0948476791381836  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155142, 128])
torch.Size([125195, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.77318286895752  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09508991241455078  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([154602, 128])
torch.Size([124386, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.761306285858154  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09473514556884766  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155064, 128])
torch.Size([124758, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.68840217590332  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09500789642333984  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155172, 128])
torch.Size([125311, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.7020263671875  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09450483322143555  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([154893, 128])
torch.Size([124381, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.546940326690674  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09487056732177734  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155126, 128])
torch.Size([124796, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.533081531524658  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09470510482788086  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([154943, 128])
torch.Size([125115, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.736717700958252  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09503936767578125  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155162, 128])
torch.Size([125180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.729430198669434  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09469938278198242  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([154983, 128])
torch.Size([124571, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.70881700515747  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.0949544906616211  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([154860, 128])
torch.Size([124373, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.634456634521484  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.0949101448059082  GigaBytes
Max Memory Allocated: 16.823312759399414  GigaBytes

torch.Size([155173, 128])
torch.Size([125394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.800817012786865  GigaBytes
Max Memory Allocated: 16.834918975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.0949411392211914  GigaBytes
Max Memory Allocated: 16.834918975830078  GigaBytes

torch.Size([154826, 128])
torch.Size([124031, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.61991310119629  GigaBytes
Max Memory Allocated: 16.834918975830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 0.09483098983764648  GigaBytes
Max Memory Allocated: 16.834918975830078  GigaBytes

torch.Size([155027, 128])
torch.Size([125068, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1072998046875 GB
    Memory Allocated: 16.81640625  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036996930837631226 |0.042527809739112854 |0.4802081137895584 |0.0001112222671508789 |0.7846815437078476 |0.012459754943847656 |
----------------------------------------------------------pseudo_mini_loss sum 4.998732089996338
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5209015
Number of first layer input nodes during this epoch:  2480393
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.12293672561645508  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02943110466003418
random selection method range initialization spend 0.005096912384033203
time for parepare:  0.018296003341674805
local_output_nid generation:  0.0028569698333740234
local_in_edges_tensor generation:  0.007786989212036133
mini_batch_src_global generation:  0.0022373199462890625
r_  generation:  0.021282672882080078
local_output_nid generation:  0.003207683563232422
local_in_edges_tensor generation:  0.0018000602722167969
mini_batch_src_global generation:  0.0023958683013916016
r_  generation:  0.02115631103515625
local_output_nid generation:  0.003212451934814453
local_in_edges_tensor generation:  0.0016810894012451172
mini_batch_src_global generation:  0.001558542251586914
r_  generation:  0.021473407745361328
local_output_nid generation:  0.0032477378845214844
local_in_edges_tensor generation:  0.0016949176788330078
mini_batch_src_global generation:  0.0016376972198486328
r_  generation:  0.022713422775268555
local_output_nid generation:  0.0035974979400634766
local_in_edges_tensor generation:  0.0019125938415527344
mini_batch_src_global generation:  0.0017707347869873047
r_  generation:  0.021833181381225586
local_output_nid generation:  0.003223896026611328
local_in_edges_tensor generation:  0.0017132759094238281
mini_batch_src_global generation:  0.0017762184143066406
r_  generation:  0.0217587947845459
local_output_nid generation:  0.003258228302001953
local_in_edges_tensor generation:  0.0016243457794189453
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.02279186248779297
local_output_nid generation:  0.004122257232666016
local_in_edges_tensor generation:  0.0035200119018554688
mini_batch_src_global generation:  0.0035817623138427734
r_  generation:  0.02287459373474121
local_output_nid generation:  0.003270864486694336
local_in_edges_tensor generation:  0.002061605453491211
mini_batch_src_global generation:  0.0017344951629638672
r_  generation:  0.022085189819335938
local_output_nid generation:  0.003321409225463867
local_in_edges_tensor generation:  0.0019652843475341797
mini_batch_src_global generation:  0.001811981201171875
r_  generation:  0.02246570587158203
local_output_nid generation:  0.003428220748901367
local_in_edges_tensor generation:  0.001749277114868164
mini_batch_src_global generation:  0.0018019676208496094
r_  generation:  0.023214340209960938
local_output_nid generation:  0.004831790924072266
local_in_edges_tensor generation:  0.003466367721557617
mini_batch_src_global generation:  0.0025615692138671875
r_  generation:  0.022306203842163086
local_output_nid generation:  0.003467082977294922
local_in_edges_tensor generation:  0.0018012523651123047
mini_batch_src_global generation:  0.0020110607147216797
r_  generation:  0.02270054817199707
local_output_nid generation:  0.0033578872680664062
local_in_edges_tensor generation:  0.0017399787902832031
mini_batch_src_global generation:  0.0018744468688964844
r_  generation:  0.02270364761352539
local_output_nid generation:  0.003346681594848633
local_in_edges_tensor generation:  0.001871347427368164
mini_batch_src_global generation:  0.001787424087524414
r_  generation:  0.024268150329589844
local_output_nid generation:  0.0035524368286132812
local_in_edges_tensor generation:  0.0020711421966552734
mini_batch_src_global generation:  0.0019011497497558594
r_  generation:  0.022530078887939453
----------------------check_connections_block total spend ----------------------------- 0.6091716289520264
generate_one_block  0.04867053031921387
generate_one_block  0.03671979904174805
generate_one_block  0.03776860237121582
generate_one_block  0.03763914108276367
generate_one_block  0.03890705108642578
generate_one_block  0.03965640068054199
generate_one_block  0.037667274475097656
generate_one_block  0.03680539131164551
generate_one_block  0.03607606887817383
generate_one_block  0.03795194625854492
generate_one_block  0.03768658638000488
generate_one_block  0.03628706932067871
generate_one_block  0.036879539489746094
generate_one_block  0.03657650947570801
generate_one_block  0.037101030349731445
generate_one_block  0.037869930267333984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.051149845123291016
gen group dst list time:  0.019688129425048828
time for parepare:  0.0190584659576416
local_output_nid generation:  0.011234760284423828
local_in_edges_tensor generation:  0.03589773178100586
mini_batch_src_global generation:  0.022945165634155273
r_  generation:  0.22182774543762207
local_output_nid generation:  0.014154434204101562
local_in_edges_tensor generation:  0.021930932998657227
mini_batch_src_global generation:  0.027194738388061523
r_  generation:  0.22538208961486816
local_output_nid generation:  0.014428853988647461
local_in_edges_tensor generation:  0.017931461334228516
mini_batch_src_global generation:  0.02636408805847168
r_  generation:  0.2336564064025879
local_output_nid generation:  0.014673948287963867
local_in_edges_tensor generation:  0.017964839935302734
mini_batch_src_global generation:  0.02729201316833496
r_  generation:  0.2343580722808838
local_output_nid generation:  0.014401674270629883
local_in_edges_tensor generation:  0.018207788467407227
mini_batch_src_global generation:  0.028892993927001953
r_  generation:  0.24230194091796875
local_output_nid generation:  0.014055728912353516
local_in_edges_tensor generation:  0.015841245651245117
mini_batch_src_global generation:  0.028948545455932617
r_  generation:  0.23311758041381836
local_output_nid generation:  0.013899564743041992
local_in_edges_tensor generation:  0.018245935440063477
mini_batch_src_global generation:  0.03217291831970215
r_  generation:  0.23989176750183105
local_output_nid generation:  0.01398158073425293
local_in_edges_tensor generation:  0.014171123504638672
mini_batch_src_global generation:  0.03157806396484375
r_  generation:  0.2353954315185547
local_output_nid generation:  0.01379704475402832
local_in_edges_tensor generation:  0.01594710350036621
mini_batch_src_global generation:  0.028654098510742188
r_  generation:  0.23636651039123535
local_output_nid generation:  0.014084100723266602
local_in_edges_tensor generation:  0.018388986587524414
mini_batch_src_global generation:  0.029794931411743164
r_  generation:  0.24638009071350098
local_output_nid generation:  0.01415395736694336
local_in_edges_tensor generation:  0.020652055740356445
mini_batch_src_global generation:  0.0302584171295166
r_  generation:  0.24518227577209473
local_output_nid generation:  0.013811111450195312
local_in_edges_tensor generation:  0.014226675033569336
mini_batch_src_global generation:  0.02920818328857422
r_  generation:  0.23594307899475098
local_output_nid generation:  0.013909578323364258
local_in_edges_tensor generation:  0.017931222915649414
mini_batch_src_global generation:  0.029120445251464844
r_  generation:  0.23868322372436523
local_output_nid generation:  0.013732433319091797
local_in_edges_tensor generation:  0.015492439270019531
mini_batch_src_global generation:  0.03141021728515625
r_  generation:  0.23332691192626953
local_output_nid generation:  0.013748645782470703
local_in_edges_tensor generation:  0.015919923782348633
mini_batch_src_global generation:  0.028932809829711914
r_  generation:  0.2346346378326416
local_output_nid generation:  0.013965368270874023
local_in_edges_tensor generation:  0.018051624298095703
mini_batch_src_global generation:  0.03116297721862793
r_  generation:  0.2427351474761963
----------------------check_connections_block total spend ----------------------------- 5.6005401611328125
generate_one_block  0.3274855613708496
generate_one_block  0.32050633430480957
generate_one_block  0.32300448417663574
generate_one_block  0.3180370330810547
generate_one_block  0.33147668838500977
generate_one_block  0.31256580352783203
generate_one_block  0.3449559211730957
generate_one_block  0.3224375247955322
generate_one_block  0.30946946144104004
generate_one_block  0.33287835121154785
generate_one_block  0.3300449848175049
generate_one_block  0.31729960441589355
generate_one_block  0.3142378330230713
generate_one_block  0.31856775283813477
generate_one_block  0.3185396194458008
generate_one_block  0.324537992477417
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04503202438354492
gen group dst list time:  0.06105232238769531
time for parepare:  0.018427610397338867
local_output_nid generation:  0.027553319931030273
local_in_edges_tensor generation:  0.04132342338562012
mini_batch_src_global generation:  0.04303312301635742
r_  generation:  0.4486393928527832
local_output_nid generation:  0.032975196838378906
local_in_edges_tensor generation:  0.04693198204040527
mini_batch_src_global generation:  0.051264286041259766
r_  generation:  0.45227694511413574
local_output_nid generation:  0.032909393310546875
local_in_edges_tensor generation:  0.035166025161743164
mini_batch_src_global generation:  0.05338716506958008
r_  generation:  0.4606781005859375
local_output_nid generation:  0.03273963928222656
local_in_edges_tensor generation:  0.03142666816711426
mini_batch_src_global generation:  0.05211687088012695
r_  generation:  0.45615077018737793
local_output_nid generation:  0.03311634063720703
local_in_edges_tensor generation:  0.08189916610717773
mini_batch_src_global generation:  0.05173063278198242
r_  generation:  0.4725942611694336
local_output_nid generation:  0.03242349624633789
local_in_edges_tensor generation:  0.0320429801940918
mini_batch_src_global generation:  0.052826642990112305
r_  generation:  0.46321916580200195
local_output_nid generation:  0.03603863716125488
local_in_edges_tensor generation:  0.035774946212768555
mini_batch_src_global generation:  0.055464982986450195
r_  generation:  0.4671056270599365
local_output_nid generation:  0.032654762268066406
local_in_edges_tensor generation:  0.043207406997680664
mini_batch_src_global generation:  0.05600547790527344
r_  generation:  0.46765971183776855
local_output_nid generation:  0.03365206718444824
local_in_edges_tensor generation:  0.03785967826843262
mini_batch_src_global generation:  0.05324745178222656
r_  generation:  0.4674053192138672
local_output_nid generation:  0.03380274772644043
local_in_edges_tensor generation:  0.03914356231689453
mini_batch_src_global generation:  0.07582616806030273
r_  generation:  0.468503475189209
local_output_nid generation:  0.034178972244262695
local_in_edges_tensor generation:  0.0402376651763916
mini_batch_src_global generation:  0.057341814041137695
r_  generation:  0.4689159393310547
local_output_nid generation:  0.03419327735900879
local_in_edges_tensor generation:  0.036994218826293945
mini_batch_src_global generation:  0.0538332462310791
r_  generation:  0.4673020839691162
local_output_nid generation:  0.033985137939453125
local_in_edges_tensor generation:  0.03244590759277344
mini_batch_src_global generation:  0.05256295204162598
r_  generation:  0.46796441078186035
local_output_nid generation:  0.034233808517456055
local_in_edges_tensor generation:  0.031807661056518555
mini_batch_src_global generation:  0.05362439155578613
r_  generation:  0.46654772758483887
local_output_nid generation:  0.0337526798248291
local_in_edges_tensor generation:  0.03948378562927246
mini_batch_src_global generation:  0.052056074142456055
r_  generation:  0.47302985191345215
local_output_nid generation:  0.033722639083862305
local_in_edges_tensor generation:  0.03519082069396973
mini_batch_src_global generation:  0.0592350959777832
r_  generation:  0.4704113006591797
----------------------check_connections_block total spend ----------------------------- 11.106553554534912
generate_one_block  0.6437966823577881
generate_one_block  0.6194453239440918
generate_one_block  0.6192572116851807
generate_one_block  0.6064789295196533
generate_one_block  0.6194839477539062
generate_one_block  0.6094865798950195
generate_one_block  0.6155264377593994
generate_one_block  0.6139976978302002
generate_one_block  0.6295123100280762
generate_one_block  0.6142265796661377
generate_one_block  0.6117990016937256
generate_one_block  0.5935678482055664
generate_one_block  0.5925109386444092
generate_one_block  0.6063745021820068
generate_one_block  0.6032726764678955
generate_one_block  0.606860876083374
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.12293672561645508  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

connection checking time:  16.707093715667725
block generation total time  14.97164249420166
average batch blocks generation time:  0.9357276558876038
block dataloader generation time/epoch 34.436598777770996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.09864377975463867  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

torch.Size([155087, 128])
torch.Size([125538, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 16.803903102874756  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.0981755256652832  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

torch.Size([154899, 128])
torch.Size([124855, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 16.7078218460083  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.09862327575683594  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

torch.Size([154908, 128])
torch.Size([124781, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 16.76930570602417  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.0981450080871582  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

torch.Size([154907, 128])
torch.Size([124429, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 16.655673027038574  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 0.0987081527709961  GigaBytes
Max Memory Allocated: 16.851237773895264  GigaBytes

torch.Size([154983, 128])
torch.Size([124918, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8026123046875 GB
    Memory Allocated: 16.868144035339355  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09811115264892578  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

torch.Size([154910, 128])
torch.Size([124468, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.614792823791504  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09855842590332031  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

torch.Size([155016, 128])
torch.Size([125053, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.725158214569092  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09825849533081055  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

torch.Size([155047, 128])
torch.Size([125099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.6978759765625  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09837627410888672  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

torch.Size([155591, 128])
torch.Size([125111, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.53321409225464  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09862327575683594  GigaBytes
Max Memory Allocated: 16.903239727020264  GigaBytes

torch.Size([155378, 128])
torch.Size([125835, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.90529203414917  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09869384765625  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

torch.Size([155392, 128])
torch.Size([125399, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.85651445388794  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.0980839729309082  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

torch.Size([154811, 128])
torch.Size([124521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.654808521270752  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09849262237548828  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

torch.Size([155142, 128])
torch.Size([124867, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.64760684967041  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09823465347290039  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

torch.Size([155191, 128])
torch.Size([124964, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.625155448913574  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09840679168701172  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

torch.Size([154930, 128])
torch.Size([124226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.573243141174316  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 0.09819793701171875  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

torch.Size([154876, 128])
torch.Size([124496, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5018310546875 GB
    Memory Allocated: 16.750073432922363  GigaBytes
Max Memory Allocated: 16.940398693084717  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03616894781589508 |0.019342944025993347 |0.43316908180713654 |0.00010178983211517334 |0.7666722387075424 |0.005822181701660156 |
----------------------------------------------------------pseudo_mini_loss sum 3.3094019889831543
Total (block generation + training)time/epoch 54.568063497543335
Training time/epoch 20.13120698928833
Training time without block to device /epoch 19.821719884872437
Training time without total dataloading part /epoch 19.204911947250366
load block tensor time/epoch 0.5787031650543213
block to device time/epoch 0.30948710441589355
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5210255
Number of first layer input nodes during this epoch:  2481068
