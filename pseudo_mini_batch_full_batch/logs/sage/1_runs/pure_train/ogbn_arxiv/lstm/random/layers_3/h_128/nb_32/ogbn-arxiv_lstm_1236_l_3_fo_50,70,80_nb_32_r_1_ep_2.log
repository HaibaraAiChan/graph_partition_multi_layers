Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648462296.5077066
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02562236785888672
random selection method range initialization spend 0.005703926086425781
time for parepare:  0.0195767879486084
local_output_nid generation:  0.0011067390441894531
local_in_edges_tensor generation:  0.003134012222290039
mini_batch_src_global generation:  0.0016639232635498047
r_  generation:  0.010787725448608398
local_output_nid generation:  0.00144195556640625
local_in_edges_tensor generation:  0.0009305477142333984
mini_batch_src_global generation:  0.0016880035400390625
r_  generation:  0.009767293930053711
local_output_nid generation:  0.0015175342559814453
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.0011074542999267578
r_  generation:  0.009530305862426758
local_output_nid generation:  0.0014996528625488281
local_in_edges_tensor generation:  0.0007727146148681641
mini_batch_src_global generation:  0.0009887218475341797
r_  generation:  0.009128570556640625
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0007619857788085938
mini_batch_src_global generation:  0.0009927749633789062
r_  generation:  0.009438037872314453
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0007638931274414062
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.009689092636108398
local_output_nid generation:  0.0014615058898925781
local_in_edges_tensor generation:  0.0007445812225341797
mini_batch_src_global generation:  0.0010058879852294922
r_  generation:  0.009833335876464844
local_output_nid generation:  0.0014538764953613281
local_in_edges_tensor generation:  0.0007557868957519531
mini_batch_src_global generation:  0.0009768009185791016
r_  generation:  0.009806394577026367
local_output_nid generation:  0.0014531612396240234
local_in_edges_tensor generation:  0.0007321834564208984
mini_batch_src_global generation:  0.000990152359008789
r_  generation:  0.010033369064331055
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.0007708072662353516
mini_batch_src_global generation:  0.0010187625885009766
r_  generation:  0.009660005569458008
local_output_nid generation:  0.0014662742614746094
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0009808540344238281
r_  generation:  0.009633302688598633
local_output_nid generation:  0.0014677047729492188
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.010204315185546875
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007567405700683594
mini_batch_src_global generation:  0.0010077953338623047
r_  generation:  0.009899377822875977
local_output_nid generation:  0.0015118122100830078
local_in_edges_tensor generation:  0.0007617473602294922
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.010037660598754883
local_output_nid generation:  0.0014629364013671875
local_in_edges_tensor generation:  0.0007636547088623047
mini_batch_src_global generation:  0.0010142326354980469
r_  generation:  0.009822845458984375
local_output_nid generation:  0.0014693737030029297
local_in_edges_tensor generation:  0.0007314682006835938
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.009624958038330078
local_output_nid generation:  0.0014500617980957031
local_in_edges_tensor generation:  0.0007457733154296875
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.009520292282104492
local_output_nid generation:  0.0014574527740478516
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0010044574737548828
r_  generation:  0.010001897811889648
local_output_nid generation:  0.0014498233795166016
local_in_edges_tensor generation:  0.0007355213165283203
mini_batch_src_global generation:  0.001110076904296875
r_  generation:  0.01022028923034668
local_output_nid generation:  0.001455545425415039
local_in_edges_tensor generation:  0.0007297992706298828
mini_batch_src_global generation:  0.0010454654693603516
r_  generation:  0.009766340255737305
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.0010402202606201172
r_  generation:  0.01016378402709961
local_output_nid generation:  0.001476287841796875
local_in_edges_tensor generation:  0.0007328987121582031
mini_batch_src_global generation:  0.0010371208190917969
r_  generation:  0.009742259979248047
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.0010080337524414062
r_  generation:  0.009717226028442383
local_output_nid generation:  0.0014636516571044922
local_in_edges_tensor generation:  0.0007383823394775391
mini_batch_src_global generation:  0.001047372817993164
r_  generation:  0.010241985321044922
local_output_nid generation:  0.0014483928680419922
local_in_edges_tensor generation:  0.0007300376892089844
mini_batch_src_global generation:  0.0010602474212646484
r_  generation:  0.010329484939575195
local_output_nid generation:  0.0015187263488769531
local_in_edges_tensor generation:  0.0007693767547607422
mini_batch_src_global generation:  0.0010652542114257812
r_  generation:  0.009770870208740234
local_output_nid generation:  0.0014731884002685547
local_in_edges_tensor generation:  0.0007634162902832031
mini_batch_src_global generation:  0.0010786056518554688
r_  generation:  0.01003408432006836
local_output_nid generation:  0.0014789104461669922
local_in_edges_tensor generation:  0.0007524490356445312
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.010062694549560547
local_output_nid generation:  0.001474142074584961
local_in_edges_tensor generation:  0.0007495880126953125
mini_batch_src_global generation:  0.001068115234375
r_  generation:  0.009797096252441406
local_output_nid generation:  0.0014603137969970703
local_in_edges_tensor generation:  0.0055081844329833984
mini_batch_src_global generation:  0.0012845993041992188
r_  generation:  0.010373115539550781
local_output_nid generation:  0.0013589859008789062
local_in_edges_tensor generation:  0.0008044242858886719
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010236024856567383
local_output_nid generation:  0.0013933181762695312
local_in_edges_tensor generation:  0.0007555484771728516
mini_batch_src_global generation:  0.0011305809020996094
r_  generation:  0.01042032241821289
----------------------check_connections_block total spend ----------------------------- 0.537102222442627
generate_one_block  0.015408754348754883
generate_one_block  0.01525568962097168
generate_one_block  0.015045166015625
generate_one_block  0.014219522476196289
generate_one_block  0.014969825744628906
generate_one_block  0.015166759490966797
generate_one_block  0.014818906784057617
generate_one_block  0.014731645584106445
generate_one_block  0.01490640640258789
generate_one_block  0.01495814323425293
generate_one_block  0.014438629150390625
generate_one_block  0.015032052993774414
generate_one_block  0.014379262924194336
generate_one_block  0.015039205551147461
generate_one_block  0.014296770095825195
generate_one_block  0.014094352722167969
generate_one_block  0.014026403427124023
generate_one_block  0.014347553253173828
generate_one_block  0.015350580215454102
generate_one_block  0.014293432235717773
generate_one_block  0.014720916748046875
generate_one_block  0.014303445816040039
generate_one_block  0.014314651489257812
generate_one_block  0.014912843704223633
generate_one_block  0.01463937759399414
generate_one_block  0.014157533645629883
generate_one_block  0.014907598495483398
generate_one_block  0.01500391960144043
generate_one_block  0.014434814453125
generate_one_block  0.015250444412231445
generate_one_block  0.015674829483032227
generate_one_block  0.015459537506103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04157733917236328
gen group dst list time:  0.023856639862060547
time for parepare:  0.018990516662597656
local_output_nid generation:  0.0052831172943115234
local_in_edges_tensor generation:  0.012816190719604492
mini_batch_src_global generation:  0.016407012939453125
r_  generation:  0.15800786018371582
local_output_nid generation:  0.0087738037109375
local_in_edges_tensor generation:  0.015169858932495117
mini_batch_src_global generation:  0.02132892608642578
r_  generation:  0.17296981811523438
local_output_nid generation:  0.008497476577758789
local_in_edges_tensor generation:  0.0105133056640625
mini_batch_src_global generation:  0.02002429962158203
r_  generation:  0.18047451972961426
local_output_nid generation:  0.007862329483032227
local_in_edges_tensor generation:  0.011412858963012695
mini_batch_src_global generation:  0.0198972225189209
r_  generation:  0.17085981369018555
local_output_nid generation:  0.008231878280639648
local_in_edges_tensor generation:  0.011980772018432617
mini_batch_src_global generation:  0.025870561599731445
r_  generation:  0.18423700332641602
local_output_nid generation:  0.008203268051147461
local_in_edges_tensor generation:  0.009012699127197266
mini_batch_src_global generation:  0.02367377281188965
r_  generation:  0.18610143661499023
local_output_nid generation:  0.00811004638671875
local_in_edges_tensor generation:  0.010397911071777344
mini_batch_src_global generation:  0.027792930603027344
r_  generation:  0.18729591369628906
local_output_nid generation:  0.009158849716186523
local_in_edges_tensor generation:  0.01862311363220215
mini_batch_src_global generation:  0.024221420288085938
r_  generation:  0.18460440635681152
local_output_nid generation:  0.009434938430786133
local_in_edges_tensor generation:  0.01291966438293457
mini_batch_src_global generation:  0.023093461990356445
r_  generation:  0.1807861328125
local_output_nid generation:  0.008290529251098633
local_in_edges_tensor generation:  0.011834859848022461
mini_batch_src_global generation:  0.022808551788330078
r_  generation:  0.18053507804870605
local_output_nid generation:  0.008123636245727539
local_in_edges_tensor generation:  0.010233640670776367
mini_batch_src_global generation:  0.02280139923095703
r_  generation:  0.17855024337768555
local_output_nid generation:  0.008424997329711914
local_in_edges_tensor generation:  0.010289907455444336
mini_batch_src_global generation:  0.022650718688964844
r_  generation:  0.17885875701904297
local_output_nid generation:  0.008223533630371094
local_in_edges_tensor generation:  0.009992599487304688
mini_batch_src_global generation:  0.021937847137451172
r_  generation:  0.1739637851715088
local_output_nid generation:  0.008483171463012695
local_in_edges_tensor generation:  0.01040339469909668
mini_batch_src_global generation:  0.02440023422241211
r_  generation:  0.1831059455871582
local_output_nid generation:  0.008293628692626953
local_in_edges_tensor generation:  0.010185718536376953
mini_batch_src_global generation:  0.022877216339111328
r_  generation:  0.17812395095825195
local_output_nid generation:  0.008244037628173828
local_in_edges_tensor generation:  0.008539438247680664
mini_batch_src_global generation:  0.02236151695251465
r_  generation:  0.17548131942749023
local_output_nid generation:  0.00805211067199707
local_in_edges_tensor generation:  0.010012626647949219
mini_batch_src_global generation:  0.02213287353515625
r_  generation:  0.17505550384521484
local_output_nid generation:  0.008216381072998047
local_in_edges_tensor generation:  0.010321617126464844
mini_batch_src_global generation:  0.023703336715698242
r_  generation:  0.1875286102294922
local_output_nid generation:  0.008415699005126953
local_in_edges_tensor generation:  0.011847257614135742
mini_batch_src_global generation:  0.02900242805480957
r_  generation:  0.18865084648132324
local_output_nid generation:  0.009074926376342773
local_in_edges_tensor generation:  0.01616215705871582
mini_batch_src_global generation:  0.0228271484375
r_  generation:  0.17491841316223145
local_output_nid generation:  0.008274078369140625
local_in_edges_tensor generation:  0.010350465774536133
mini_batch_src_global generation:  0.023880481719970703
r_  generation:  0.17943668365478516
local_output_nid generation:  0.008314132690429688
local_in_edges_tensor generation:  0.01019597053527832
mini_batch_src_global generation:  0.02312779426574707
r_  generation:  0.18064188957214355
local_output_nid generation:  0.008121013641357422
local_in_edges_tensor generation:  0.008657217025756836
mini_batch_src_global generation:  0.022223711013793945
r_  generation:  0.1784048080444336
local_output_nid generation:  0.00835871696472168
local_in_edges_tensor generation:  0.010212421417236328
mini_batch_src_global generation:  0.023284435272216797
r_  generation:  0.18357443809509277
local_output_nid generation:  0.008324146270751953
local_in_edges_tensor generation:  0.01331472396850586
mini_batch_src_global generation:  0.023142099380493164
r_  generation:  0.1825122833251953
local_output_nid generation:  0.008111715316772461
local_in_edges_tensor generation:  0.00831747055053711
mini_batch_src_global generation:  0.022150039672851562
r_  generation:  0.17446136474609375
local_output_nid generation:  0.008319854736328125
local_in_edges_tensor generation:  0.010039329528808594
mini_batch_src_global generation:  0.023233890533447266
r_  generation:  0.1872091293334961
local_output_nid generation:  0.008356809616088867
local_in_edges_tensor generation:  0.008838891983032227
mini_batch_src_global generation:  0.023043394088745117
r_  generation:  0.17758631706237793
local_output_nid generation:  0.008255481719970703
local_in_edges_tensor generation:  0.010121822357177734
mini_batch_src_global generation:  0.022362709045410156
r_  generation:  0.18020033836364746
local_output_nid generation:  0.008425235748291016
local_in_edges_tensor generation:  0.008941411972045898
mini_batch_src_global generation:  0.02317667007446289
r_  generation:  0.18424654006958008
local_output_nid generation:  0.008571863174438477
local_in_edges_tensor generation:  0.012085676193237305
mini_batch_src_global generation:  0.023509502410888672
r_  generation:  0.187117338180542
local_output_nid generation:  0.008578300476074219
local_in_edges_tensor generation:  0.012127161026000977
mini_batch_src_global generation:  0.023352384567260742
r_  generation:  0.18437600135803223
----------------------check_connections_block total spend ----------------------------- 8.420149087905884
generate_one_block  0.24125242233276367
generate_one_block  0.23808813095092773
generate_one_block  0.2635054588317871
generate_one_block  0.22186946868896484
generate_one_block  0.23073506355285645
generate_one_block  0.2361164093017578
generate_one_block  0.24158477783203125
generate_one_block  0.22257018089294434
generate_one_block  0.23856830596923828
generate_one_block  0.23055171966552734
generate_one_block  0.2267754077911377
generate_one_block  0.23646116256713867
generate_one_block  0.21597504615783691
generate_one_block  0.23660635948181152
generate_one_block  0.22184467315673828
generate_one_block  0.2518322467803955
generate_one_block  0.21822619438171387
generate_one_block  0.22881555557250977
generate_one_block  0.24461722373962402
generate_one_block  0.21749424934387207
generate_one_block  0.22353172302246094
generate_one_block  0.23250651359558105
generate_one_block  0.22063755989074707
generate_one_block  0.23390746116638184
generate_one_block  0.23212504386901855
generate_one_block  0.2233896255493164
generate_one_block  0.23973751068115234
generate_one_block  0.22381997108459473
generate_one_block  0.2273848056793213
generate_one_block  0.23882389068603516
generate_one_block  0.24152159690856934
generate_one_block  0.22904610633850098
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04225564002990723
gen group dst list time:  0.11462783813476562
time for parepare:  0.01910090446472168
local_output_nid generation:  0.023574113845825195
local_in_edges_tensor generation:  0.04816031455993652
mini_batch_src_global generation:  0.050305843353271484
r_  generation:  0.4731180667877197
local_output_nid generation:  0.030489206314086914
local_in_edges_tensor generation:  0.04582500457763672
mini_batch_src_global generation:  0.06790685653686523
r_  generation:  0.552509069442749
local_output_nid generation:  0.030898332595825195
local_in_edges_tensor generation:  0.03932332992553711
mini_batch_src_global generation:  0.06194877624511719
r_  generation:  0.541234016418457
local_output_nid generation:  0.03241086006164551
local_in_edges_tensor generation:  0.04367232322692871
mini_batch_src_global generation:  0.06327700614929199
r_  generation:  0.5030312538146973
local_output_nid generation:  0.02954268455505371
local_in_edges_tensor generation:  0.037735700607299805
mini_batch_src_global generation:  0.05816006660461426
r_  generation:  0.5003981590270996
local_output_nid generation:  0.03218197822570801
local_in_edges_tensor generation:  0.038635969161987305
mini_batch_src_global generation:  0.05879783630371094
r_  generation:  0.511366605758667
local_output_nid generation:  0.03128528594970703
local_in_edges_tensor generation:  0.042905330657958984
mini_batch_src_global generation:  0.06406354904174805
r_  generation:  0.4981505870819092
local_output_nid generation:  0.02936553955078125
local_in_edges_tensor generation:  0.03756546974182129
mini_batch_src_global generation:  0.05916547775268555
r_  generation:  0.49390745162963867
local_output_nid generation:  0.031216859817504883
local_in_edges_tensor generation:  0.03700447082519531
mini_batch_src_global generation:  0.06217002868652344
r_  generation:  0.5084443092346191
local_output_nid generation:  0.029117584228515625
local_in_edges_tensor generation:  0.028797388076782227
mini_batch_src_global generation:  0.06503820419311523
r_  generation:  0.49933624267578125
local_output_nid generation:  0.029393672943115234
local_in_edges_tensor generation:  0.04486489295959473
mini_batch_src_global generation:  0.05858588218688965
r_  generation:  0.4962155818939209
local_output_nid generation:  0.02994060516357422
local_in_edges_tensor generation:  0.03612208366394043
mini_batch_src_global generation:  0.06200885772705078
r_  generation:  0.5203578472137451
local_output_nid generation:  0.031203508377075195
local_in_edges_tensor generation:  0.04012870788574219
mini_batch_src_global generation:  0.06291794776916504
r_  generation:  0.49607372283935547
local_output_nid generation:  0.029538869857788086
local_in_edges_tensor generation:  0.03644418716430664
mini_batch_src_global generation:  0.06304216384887695
r_  generation:  0.49433422088623047
local_output_nid generation:  0.02914118766784668
local_in_edges_tensor generation:  0.028617382049560547
mini_batch_src_global generation:  0.05826163291931152
r_  generation:  0.49931788444519043
local_output_nid generation:  0.029324769973754883
local_in_edges_tensor generation:  0.03310728073120117
mini_batch_src_global generation:  0.05946540832519531
r_  generation:  0.4962337017059326
local_output_nid generation:  0.02904343605041504
local_in_edges_tensor generation:  0.03712916374206543
mini_batch_src_global generation:  0.05856204032897949
r_  generation:  0.5011963844299316
local_output_nid generation:  0.029217004776000977
local_in_edges_tensor generation:  0.03305935859680176
mini_batch_src_global generation:  0.05930638313293457
r_  generation:  0.50486159324646
local_output_nid generation:  0.029255151748657227
local_in_edges_tensor generation:  0.037528276443481445
mini_batch_src_global generation:  0.058563232421875
r_  generation:  0.5053362846374512
local_output_nid generation:  0.03543519973754883
local_in_edges_tensor generation:  0.03735470771789551
mini_batch_src_global generation:  0.05876612663269043
r_  generation:  0.49878954887390137
local_output_nid generation:  0.02919626235961914
local_in_edges_tensor generation:  0.02841472625732422
mini_batch_src_global generation:  0.061788082122802734
r_  generation:  0.5044472217559814
local_output_nid generation:  0.02937626838684082
local_in_edges_tensor generation:  0.035854339599609375
mini_batch_src_global generation:  0.05966830253601074
r_  generation:  0.5105915069580078
local_output_nid generation:  0.030326128005981445
local_in_edges_tensor generation:  0.036522865295410156
mini_batch_src_global generation:  0.08556246757507324
r_  generation:  0.5099549293518066
local_output_nid generation:  0.03021717071533203
local_in_edges_tensor generation:  0.04010510444641113
mini_batch_src_global generation:  0.05939674377441406
r_  generation:  0.5042402744293213
local_output_nid generation:  0.02921319007873535
local_in_edges_tensor generation:  0.03905844688415527
mini_batch_src_global generation:  0.05884432792663574
r_  generation:  0.5029439926147461
local_output_nid generation:  0.029236316680908203
local_in_edges_tensor generation:  0.02887582778930664
mini_batch_src_global generation:  0.05915379524230957
r_  generation:  0.4950551986694336
local_output_nid generation:  0.029315948486328125
local_in_edges_tensor generation:  0.028286218643188477
mini_batch_src_global generation:  0.06258201599121094
r_  generation:  0.5020220279693604
local_output_nid generation:  0.029349565505981445
local_in_edges_tensor generation:  0.03748583793640137
mini_batch_src_global generation:  0.05963778495788574
r_  generation:  0.4975888729095459
local_output_nid generation:  0.02928948402404785
local_in_edges_tensor generation:  0.028693437576293945
mini_batch_src_global generation:  0.060044050216674805
r_  generation:  0.5034849643707275
local_output_nid generation:  0.0292665958404541
local_in_edges_tensor generation:  0.03593921661376953
mini_batch_src_global generation:  0.059955596923828125
r_  generation:  0.501643180847168
local_output_nid generation:  0.029261112213134766
local_in_edges_tensor generation:  0.0382540225982666
mini_batch_src_global generation:  0.058972835540771484
r_  generation:  0.5063698291778564
local_output_nid generation:  0.02970290184020996
local_in_edges_tensor generation:  0.03730201721191406
mini_batch_src_global generation:  0.05896806716918945
r_  generation:  0.5036773681640625
----------------------check_connections_block total spend ----------------------------- 23.734339714050293
generate_one_block  0.759840726852417
generate_one_block  0.6703813076019287
generate_one_block  0.6470048427581787
generate_one_block  0.6420915126800537
generate_one_block  0.6471233367919922
generate_one_block  0.6521320343017578
generate_one_block  0.6526532173156738
generate_one_block  0.6555891036987305
generate_one_block  0.6673383712768555
generate_one_block  0.6373138427734375
generate_one_block  0.6492321491241455
generate_one_block  0.6416771411895752
generate_one_block  0.649031400680542
generate_one_block  0.662787675857544
generate_one_block  0.6294698715209961
generate_one_block  0.650094747543335
generate_one_block  0.6388866901397705
generate_one_block  0.6429591178894043
generate_one_block  0.66636061668396
generate_one_block  0.6506376266479492
generate_one_block  0.6506123542785645
generate_one_block  0.6521477699279785
generate_one_block  0.6330728530883789
generate_one_block  0.6494629383087158
generate_one_block  0.6524257659912109
generate_one_block  0.6413476467132568
generate_one_block  0.647454023361206
generate_one_block  0.649747371673584
generate_one_block  0.6312675476074219
generate_one_block  0.6516129970550537
generate_one_block  0.6478641033172607
generate_one_block  0.6684434413909912
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  32.15448880195618
block generation total time  28.317986011505127
average batch blocks generation time:  0.8849370628595352
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09020757675170898  GigaBytes
Max Memory Allocated: 0.09020757675170898  GigaBytes

torch.Size([149946, 128])
torch.Size([109604, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9588623046875 GB
    Memory Allocated: 16.296515941619873  GigaBytes
Max Memory Allocated: 16.339128017425537  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4783935546875 GB
    Memory Allocated: 0.09220695495605469  GigaBytes
Max Memory Allocated: 16.339128017425537  GigaBytes

torch.Size([150578, 128])
torch.Size([110806, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2615966796875 GB
    Memory Allocated: 16.612319946289062  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2615966796875 GB
    Memory Allocated: 0.09257316589355469  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150558, 128])
torch.Size([110309, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.475539684295654  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.0917654037475586  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150508, 128])
torch.Size([109827, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.18664026260376  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09256267547607422  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150408, 128])
torch.Size([110604, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.518473625183105  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09173870086669922  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149894, 128])
torch.Size([109454, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.45348310470581  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09256362915039062  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150310, 128])
torch.Size([109973, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.49381446838379  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09198808670043945  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150467, 128])
torch.Size([110484, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.40689516067505  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09261131286621094  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150096, 128])
torch.Size([110358, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.529621124267578  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09160470962524414  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149693, 128])
torch.Size([109520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.39762592315674  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09244060516357422  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150193, 128])
torch.Size([109264, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.377315044403076  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09187650680541992  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150301, 128])
torch.Size([110020, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.404961585998535  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09225940704345703  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149982, 128])
torch.Size([109375, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.156463146209717  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09221649169921875  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150752, 128])
torch.Size([110779, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.516374588012695  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09239673614501953  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150109, 128])
torch.Size([109259, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.34336233139038  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09168004989624023  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150157, 128])
torch.Size([110047, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.270636558532715  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09224700927734375  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150259, 128])
torch.Size([109368, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.137672901153564  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09157657623291016  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149868, 128])
torch.Size([109735, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 16.29800271987915  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3338623046875 GB
    Memory Allocated: 0.09267425537109375  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150134, 128])
torch.Size([110179, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.590184211730957  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.09191656112670898  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150697, 128])
torch.Size([110434, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.25375461578369  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.0924234390258789  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150265, 128])
torch.Size([109512, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.361323833465576  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.09206628799438477  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150619, 128])
torch.Size([110445, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.4395809173584  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.09226512908935547  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149982, 128])
torch.Size([108829, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.185750007629395  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.09194755554199219  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150214, 128])
torch.Size([109852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.515968322753906  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.09250259399414062  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149544, 128])
torch.Size([109460, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.428074836730957  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.0915684700012207  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150155, 128])
torch.Size([108968, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 16.137102127075195  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3631591796875 GB
    Memory Allocated: 0.09261608123779297  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149965, 128])
torch.Size([109872, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 16.5209641456604  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.09190797805786133  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150451, 128])
torch.Size([110427, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 16.378559589385986  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.09235668182373047  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150201, 128])
torch.Size([109144, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 16.284133911132812  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.09174203872680664  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149779, 128])
torch.Size([109791, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 16.523588180541992  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.09261322021484375  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([149943, 128])
torch.Size([109852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 16.529223918914795  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.09194231033325195  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150229, 128])
torch.Size([110533, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 16.52680778503418  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03717686980962753 |0.03409085422754288 |0.6402552053332329 |0.00011058151721954346 |1.0599697306752205 |0.014897346496582031 |
----------------------------------------------------------pseudo_mini_loss sum 5.001313209533691
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9162789
Number of first layer input nodes during this epoch:  4806257
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.11794376373291016  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026944875717163086
random selection method range initialization spend 0.00559544563293457
time for parepare:  0.01909494400024414
local_output_nid generation:  0.0013973712921142578
local_in_edges_tensor generation:  0.007680654525756836
mini_batch_src_global generation:  0.002001047134399414
r_  generation:  0.01175689697265625
local_output_nid generation:  0.001657724380493164
local_in_edges_tensor generation:  0.0010721683502197266
mini_batch_src_global generation:  0.0016741752624511719
r_  generation:  0.010335206985473633
local_output_nid generation:  0.0016186237335205078
local_in_edges_tensor generation:  0.0009999275207519531
mini_batch_src_global generation:  0.0012292861938476562
r_  generation:  0.010068893432617188
local_output_nid generation:  0.0016224384307861328
local_in_edges_tensor generation:  0.0009734630584716797
mini_batch_src_global generation:  0.001192331314086914
r_  generation:  0.0095977783203125
local_output_nid generation:  0.0016026496887207031
local_in_edges_tensor generation:  0.0009632110595703125
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010202407836914062
local_output_nid generation:  0.0015931129455566406
local_in_edges_tensor generation:  0.00095367431640625
mini_batch_src_global generation:  0.0011909008026123047
r_  generation:  0.010351181030273438
local_output_nid generation:  0.0015912055969238281
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0012497901916503906
r_  generation:  0.01042485237121582
local_output_nid generation:  0.0016045570373535156
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.0011837482452392578
r_  generation:  0.009941339492797852
local_output_nid generation:  0.0015838146209716797
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0011334419250488281
r_  generation:  0.010413646697998047
local_output_nid generation:  0.0015988349914550781
local_in_edges_tensor generation:  0.0009486675262451172
mini_batch_src_global generation:  0.0012362003326416016
r_  generation:  0.010707855224609375
local_output_nid generation:  0.0016109943389892578
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0012776851654052734
r_  generation:  0.010556936264038086
local_output_nid generation:  0.0015938282012939453
local_in_edges_tensor generation:  0.0009617805480957031
mini_batch_src_global generation:  0.001149892807006836
r_  generation:  0.011917829513549805
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0009438991546630859
mini_batch_src_global generation:  0.0011959075927734375
r_  generation:  0.010457992553710938
local_output_nid generation:  0.0016145706176757812
local_in_edges_tensor generation:  0.0009400844573974609
mini_batch_src_global generation:  0.001138925552368164
r_  generation:  0.010012149810791016
local_output_nid generation:  0.0015871524810791016
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0011496543884277344
r_  generation:  0.010459661483764648
local_output_nid generation:  0.0015826225280761719
local_in_edges_tensor generation:  0.0009136199951171875
mini_batch_src_global generation:  0.0011649131774902344
r_  generation:  0.010170459747314453
local_output_nid generation:  0.0015990734100341797
local_in_edges_tensor generation:  0.00091552734375
mini_batch_src_global generation:  0.00115203857421875
r_  generation:  0.009993791580200195
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0009343624114990234
mini_batch_src_global generation:  0.0011560916900634766
r_  generation:  0.01040029525756836
local_output_nid generation:  0.0015892982482910156
local_in_edges_tensor generation:  0.0009257793426513672
mini_batch_src_global generation:  0.0011851787567138672
r_  generation:  0.010478973388671875
local_output_nid generation:  0.0016016960144042969
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0012557506561279297
r_  generation:  0.01067042350769043
local_output_nid generation:  0.0015881061553955078
local_in_edges_tensor generation:  0.0009467601776123047
mini_batch_src_global generation:  0.0012192726135253906
r_  generation:  0.010834932327270508
local_output_nid generation:  0.0015952587127685547
local_in_edges_tensor generation:  0.0009393692016601562
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.010735750198364258
local_output_nid generation:  0.0016324520111083984
local_in_edges_tensor generation:  0.0009534358978271484
mini_batch_src_global generation:  0.0012035369873046875
r_  generation:  0.01023411750793457
local_output_nid generation:  0.0016021728515625
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.001146078109741211
r_  generation:  0.010201454162597656
local_output_nid generation:  0.001577615737915039
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0012209415435791016
r_  generation:  0.01043844223022461
local_output_nid generation:  0.0015842914581298828
local_in_edges_tensor generation:  0.0009260177612304688
mini_batch_src_global generation:  0.0012311935424804688
r_  generation:  0.010335206985473633
local_output_nid generation:  0.0015873908996582031
local_in_edges_tensor generation:  0.0009284019470214844
mini_batch_src_global generation:  0.0011208057403564453
r_  generation:  0.010295867919921875
local_output_nid generation:  0.0015978813171386719
local_in_edges_tensor generation:  0.0009198188781738281
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010148286819458008
local_output_nid generation:  0.0016055107116699219
local_in_edges_tensor generation:  0.0009407997131347656
mini_batch_src_global generation:  0.0011761188507080078
r_  generation:  0.010592460632324219
local_output_nid generation:  0.0015974044799804688
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0011525154113769531
r_  generation:  0.010051488876342773
local_output_nid generation:  0.0015926361083984375
local_in_edges_tensor generation:  0.0009348392486572266
mini_batch_src_global generation:  0.0011568069458007812
r_  generation:  0.010290145874023438
local_output_nid generation:  0.0015850067138671875
local_in_edges_tensor generation:  0.0009367465972900391
mini_batch_src_global generation:  0.0011873245239257812
r_  generation:  0.010539054870605469
----------------------check_connections_block total spend ----------------------------- 0.576707124710083
generate_one_block  0.026601314544677734
generate_one_block  0.021720170974731445
generate_one_block  0.02237105369567871
generate_one_block  0.018700599670410156
generate_one_block  0.01930975914001465
generate_one_block  0.019097089767456055
generate_one_block  0.019150257110595703
generate_one_block  0.01839303970336914
generate_one_block  0.01879715919494629
generate_one_block  0.01949310302734375
generate_one_block  0.019092559814453125
generate_one_block  0.018810510635375977
generate_one_block  0.019191265106201172
generate_one_block  0.018283367156982422
generate_one_block  0.018842458724975586
generate_one_block  0.018398046493530273
generate_one_block  0.017850875854492188
generate_one_block  0.01889634132385254
generate_one_block  0.018752336502075195
generate_one_block  0.019350290298461914
generate_one_block  0.019614219665527344
generate_one_block  0.019084930419921875
generate_one_block  0.01844644546508789
generate_one_block  0.02101874351501465
generate_one_block  0.0188906192779541
generate_one_block  0.01881122589111328
generate_one_block  0.018414020538330078
generate_one_block  0.01839470863342285
generate_one_block  0.018962860107421875
generate_one_block  0.018098115921020508
generate_one_block  0.018807172775268555
generate_one_block  0.01927328109741211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0446622371673584
gen group dst list time:  0.021723508834838867
time for parepare:  0.01924419403076172
local_output_nid generation:  0.0071659088134765625
local_in_edges_tensor generation:  0.017696857452392578
mini_batch_src_global generation:  0.017686128616333008
r_  generation:  0.17198967933654785
local_output_nid generation:  0.008919477462768555
local_in_edges_tensor generation:  0.011365890502929688
mini_batch_src_global generation:  0.020412921905517578
r_  generation:  0.16031455993652344
local_output_nid generation:  0.009277582168579102
local_in_edges_tensor generation:  0.031088590621948242
mini_batch_src_global generation:  0.01998162269592285
r_  generation:  0.17444586753845215
local_output_nid generation:  0.00943303108215332
local_in_edges_tensor generation:  0.011809587478637695
mini_batch_src_global generation:  0.0200650691986084
r_  generation:  0.17614197731018066
local_output_nid generation:  0.009690999984741211
local_in_edges_tensor generation:  0.010472536087036133
mini_batch_src_global generation:  0.021523714065551758
r_  generation:  0.1784684658050537
local_output_nid generation:  0.009572505950927734
local_in_edges_tensor generation:  0.010725975036621094
mini_batch_src_global generation:  0.02207350730895996
r_  generation:  0.18368315696716309
local_output_nid generation:  0.0092620849609375
local_in_edges_tensor generation:  0.012119054794311523
mini_batch_src_global generation:  0.022400617599487305
r_  generation:  0.18332552909851074
local_output_nid generation:  0.008873701095581055
local_in_edges_tensor generation:  0.009115219116210938
mini_batch_src_global generation:  0.021921634674072266
r_  generation:  0.1773538589477539
local_output_nid generation:  0.00914764404296875
local_in_edges_tensor generation:  0.009321928024291992
mini_batch_src_global generation:  0.02264714241027832
r_  generation:  0.18387126922607422
local_output_nid generation:  0.00986337661743164
local_in_edges_tensor generation:  0.012053489685058594
mini_batch_src_global generation:  0.023218393325805664
r_  generation:  0.1890108585357666
local_output_nid generation:  0.012353897094726562
local_in_edges_tensor generation:  0.009063005447387695
mini_batch_src_global generation:  0.02252674102783203
r_  generation:  0.18130064010620117
local_output_nid generation:  0.009423971176147461
local_in_edges_tensor generation:  0.011690378189086914
mini_batch_src_global generation:  0.022253751754760742
r_  generation:  0.18277883529663086
local_output_nid generation:  0.009799957275390625
local_in_edges_tensor generation:  0.009281635284423828
mini_batch_src_global generation:  0.023267030715942383
r_  generation:  0.1871790885925293
local_output_nid generation:  0.009429454803466797
local_in_edges_tensor generation:  0.011787652969360352
mini_batch_src_global generation:  0.022362232208251953
r_  generation:  0.1827378273010254
local_output_nid generation:  0.009675979614257812
local_in_edges_tensor generation:  0.009366035461425781
mini_batch_src_global generation:  0.023833751678466797
r_  generation:  0.19173169136047363
local_output_nid generation:  0.009425163269042969
local_in_edges_tensor generation:  0.009472370147705078
mini_batch_src_global generation:  0.022021055221557617
r_  generation:  0.18224048614501953
local_output_nid generation:  0.00932168960571289
local_in_edges_tensor generation:  0.008761882781982422
mini_batch_src_global generation:  0.024384260177612305
r_  generation:  0.1765904426574707
local_output_nid generation:  0.009786367416381836
local_in_edges_tensor generation:  0.01040029525756836
mini_batch_src_global generation:  0.023779869079589844
r_  generation:  0.18571162223815918
local_output_nid generation:  0.010694503784179688
local_in_edges_tensor generation:  0.019917964935302734
mini_batch_src_global generation:  0.023430347442626953
r_  generation:  0.18642354011535645
local_output_nid generation:  0.009688854217529297
local_in_edges_tensor generation:  0.010985612869262695
mini_batch_src_global generation:  0.03480124473571777
r_  generation:  0.19242358207702637
local_output_nid generation:  0.009771347045898438
local_in_edges_tensor generation:  0.012151479721069336
mini_batch_src_global generation:  0.026373863220214844
r_  generation:  0.18862581253051758
local_output_nid generation:  0.010298490524291992
local_in_edges_tensor generation:  0.010636568069458008
mini_batch_src_global generation:  0.02330327033996582
r_  generation:  0.1864616870880127
local_output_nid generation:  0.010968923568725586
local_in_edges_tensor generation:  0.010942935943603516
mini_batch_src_global generation:  0.022924184799194336
r_  generation:  0.18256759643554688
local_output_nid generation:  0.00949239730834961
local_in_edges_tensor generation:  0.00917506217956543
mini_batch_src_global generation:  0.022657155990600586
r_  generation:  0.1825559139251709
local_output_nid generation:  0.009583234786987305
local_in_edges_tensor generation:  0.010789632797241211
mini_batch_src_global generation:  0.022706031799316406
r_  generation:  0.18421578407287598
local_output_nid generation:  0.009398221969604492
local_in_edges_tensor generation:  0.012176513671875
mini_batch_src_global generation:  0.022432327270507812
r_  generation:  0.1832261085510254
local_output_nid generation:  0.009434700012207031
local_in_edges_tensor generation:  0.009374856948852539
mini_batch_src_global generation:  0.022404909133911133
r_  generation:  0.17869114875793457
local_output_nid generation:  0.009442806243896484
local_in_edges_tensor generation:  0.00916600227355957
mini_batch_src_global generation:  0.023705720901489258
r_  generation:  0.18295788764953613
local_output_nid generation:  0.009569883346557617
local_in_edges_tensor generation:  0.010691165924072266
mini_batch_src_global generation:  0.022730112075805664
r_  generation:  0.18450355529785156
local_output_nid generation:  0.009144306182861328
local_in_edges_tensor generation:  0.010015010833740234
mini_batch_src_global generation:  0.021729230880737305
r_  generation:  0.18045687675476074
local_output_nid generation:  0.009221076965332031
local_in_edges_tensor generation:  0.010534048080444336
mini_batch_src_global generation:  0.023043394088745117
r_  generation:  0.18373417854309082
local_output_nid generation:  0.009526729583740234
local_in_edges_tensor generation:  0.010915756225585938
mini_batch_src_global generation:  0.024427175521850586
r_  generation:  0.19028878211975098
----------------------check_connections_block total spend ----------------------------- 8.558691501617432
generate_one_block  0.2689955234527588
generate_one_block  0.23530125617980957
generate_one_block  0.2467193603515625
generate_one_block  0.24641180038452148
generate_one_block  0.28038883209228516
generate_one_block  0.2562706470489502
generate_one_block  0.2514965534210205
generate_one_block  0.2381136417388916
generate_one_block  0.2525339126586914
generate_one_block  0.2568626403808594
generate_one_block  0.24399781227111816
generate_one_block  0.2428112030029297
generate_one_block  0.25774550437927246
generate_one_block  0.23742151260375977
generate_one_block  0.2451462745666504
generate_one_block  0.241563081741333
generate_one_block  0.23093414306640625
generate_one_block  0.2565622329711914
generate_one_block  0.2578451633453369
generate_one_block  0.26310229301452637
generate_one_block  0.2532808780670166
generate_one_block  0.24770879745483398
generate_one_block  0.2446291446685791
generate_one_block  0.2388906478881836
generate_one_block  0.24918508529663086
generate_one_block  0.24381089210510254
generate_one_block  0.23661065101623535
generate_one_block  0.24417948722839355
generate_one_block  0.2513587474822998
generate_one_block  0.23514389991760254
generate_one_block  0.2458043098449707
generate_one_block  0.2580904960632324
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052014827728271484
gen group dst list time:  0.10313677787780762
time for parepare:  0.018112659454345703
local_output_nid generation:  0.026155948638916016
local_in_edges_tensor generation:  0.06016397476196289
mini_batch_src_global generation:  0.04719281196594238
r_  generation:  0.4876673221588135
local_output_nid generation:  0.03162860870361328
local_in_edges_tensor generation:  0.047532081604003906
mini_batch_src_global generation:  0.05854082107543945
r_  generation:  0.4859440326690674
local_output_nid generation:  0.03090524673461914
local_in_edges_tensor generation:  0.03924083709716797
mini_batch_src_global generation:  0.056406497955322266
r_  generation:  0.49544239044189453
local_output_nid generation:  0.030004262924194336
local_in_edges_tensor generation:  0.03882169723510742
mini_batch_src_global generation:  0.061656951904296875
r_  generation:  0.49413514137268066
local_output_nid generation:  0.030391454696655273
local_in_edges_tensor generation:  0.03446149826049805
mini_batch_src_global generation:  0.05837106704711914
r_  generation:  0.5039026737213135
local_output_nid generation:  0.029581069946289062
local_in_edges_tensor generation:  0.030269145965576172
mini_batch_src_global generation:  0.059767723083496094
r_  generation:  0.4951608180999756
local_output_nid generation:  0.03208661079406738
local_in_edges_tensor generation:  0.029625654220581055
mini_batch_src_global generation:  0.05942106246948242
r_  generation:  0.502119779586792
local_output_nid generation:  0.030354022979736328
local_in_edges_tensor generation:  0.03141045570373535
mini_batch_src_global generation:  0.06017637252807617
r_  generation:  0.4974358081817627
local_output_nid generation:  0.03003668785095215
local_in_edges_tensor generation:  0.03811478614807129
mini_batch_src_global generation:  0.06251764297485352
r_  generation:  0.5010128021240234
local_output_nid generation:  0.030939340591430664
local_in_edges_tensor generation:  0.04639911651611328
mini_batch_src_global generation:  0.059645891189575195
r_  generation:  0.510998010635376
local_output_nid generation:  0.02993488311767578
local_in_edges_tensor generation:  0.039154767990112305
mini_batch_src_global generation:  0.06573843955993652
r_  generation:  0.5082347393035889
local_output_nid generation:  0.0333864688873291
local_in_edges_tensor generation:  0.038116455078125
mini_batch_src_global generation:  0.06000924110412598
r_  generation:  0.5078983306884766
local_output_nid generation:  0.03142690658569336
local_in_edges_tensor generation:  0.0410609245300293
mini_batch_src_global generation:  0.05942344665527344
r_  generation:  0.5126171112060547
local_output_nid generation:  0.031160593032836914
local_in_edges_tensor generation:  0.030927181243896484
mini_batch_src_global generation:  0.060561180114746094
r_  generation:  0.5054149627685547
local_output_nid generation:  0.031032800674438477
local_in_edges_tensor generation:  0.03992748260498047
mini_batch_src_global generation:  0.06254720687866211
r_  generation:  0.508913516998291
local_output_nid generation:  0.03160572052001953
local_in_edges_tensor generation:  0.045568227767944336
mini_batch_src_global generation:  0.060430049896240234
r_  generation:  0.5055882930755615
local_output_nid generation:  0.03141331672668457
local_in_edges_tensor generation:  0.029741525650024414
mini_batch_src_global generation:  0.059034109115600586
r_  generation:  0.5045647621154785
local_output_nid generation:  0.03127694129943848
local_in_edges_tensor generation:  0.035422563552856445
mini_batch_src_global generation:  0.0630791187286377
r_  generation:  0.500948429107666
local_output_nid generation:  0.03167390823364258
local_in_edges_tensor generation:  0.0397181510925293
mini_batch_src_global generation:  0.058318138122558594
r_  generation:  0.505011796951294
local_output_nid generation:  0.031198740005493164
local_in_edges_tensor generation:  0.039697885513305664
mini_batch_src_global generation:  0.0601956844329834
r_  generation:  0.5013689994812012
local_output_nid generation:  0.034105777740478516
local_in_edges_tensor generation:  0.030659914016723633
mini_batch_src_global generation:  0.05896568298339844
r_  generation:  0.5089058876037598
local_output_nid generation:  0.03144431114196777
local_in_edges_tensor generation:  0.03409218788146973
mini_batch_src_global generation:  0.0600438117980957
r_  generation:  0.502852201461792
local_output_nid generation:  0.03181028366088867
local_in_edges_tensor generation:  0.03970956802368164
mini_batch_src_global generation:  0.06232166290283203
r_  generation:  0.5061812400817871
local_output_nid generation:  0.03127574920654297
local_in_edges_tensor generation:  0.030815839767456055
mini_batch_src_global generation:  0.06033158302307129
r_  generation:  0.49920153617858887
local_output_nid generation:  0.03124547004699707
local_in_edges_tensor generation:  0.043502092361450195
mini_batch_src_global generation:  0.05795907974243164
r_  generation:  0.507232666015625
local_output_nid generation:  0.031241416931152344
local_in_edges_tensor generation:  0.044103145599365234
mini_batch_src_global generation:  0.05922079086303711
r_  generation:  0.5042099952697754
local_output_nid generation:  0.030792713165283203
local_in_edges_tensor generation:  0.03124094009399414
mini_batch_src_global generation:  0.058825016021728516
r_  generation:  0.5037767887115479
local_output_nid generation:  0.03155112266540527
local_in_edges_tensor generation:  0.030640125274658203
mini_batch_src_global generation:  0.06042146682739258
r_  generation:  0.5048940181732178
local_output_nid generation:  0.031278371810913086
local_in_edges_tensor generation:  0.035221099853515625
mini_batch_src_global generation:  0.05848526954650879
r_  generation:  0.5044655799865723
local_output_nid generation:  0.03084278106689453
local_in_edges_tensor generation:  0.03047800064086914
mini_batch_src_global generation:  0.06024932861328125
r_  generation:  0.4993596076965332
local_output_nid generation:  0.031086206436157227
local_in_edges_tensor generation:  0.038668155670166016
mini_batch_src_global generation:  0.05851626396179199
r_  generation:  0.5057487487792969
local_output_nid generation:  0.03237724304199219
local_in_edges_tensor generation:  0.03554821014404297
mini_batch_src_global generation:  0.059715986251831055
r_  generation:  0.5095410346984863
----------------------check_connections_block total spend ----------------------------- 23.693613290786743
generate_one_block  0.7123034000396729
generate_one_block  0.6927342414855957
generate_one_block  0.6808199882507324
generate_one_block  0.6867282390594482
generate_one_block  0.7890722751617432
generate_one_block  0.6801097393035889
generate_one_block  0.6808023452758789
generate_one_block  0.674109697341919
generate_one_block  0.6914706230163574
generate_one_block  0.6782441139221191
generate_one_block  0.6800410747528076
generate_one_block  0.6810092926025391
generate_one_block  0.7056031227111816
generate_one_block  0.6761839389801025
generate_one_block  0.6834490299224854
generate_one_block  0.6834044456481934
generate_one_block  0.6757175922393799
generate_one_block  0.6872098445892334
generate_one_block  0.6938345432281494
generate_one_block  0.6884646415710449
generate_one_block  0.6752145290374756
generate_one_block  0.6877708435058594
generate_one_block  0.6876711845397949
generate_one_block  0.6690051555633545
generate_one_block  0.6978070735931396
generate_one_block  0.6850922107696533
generate_one_block  0.685870885848999
generate_one_block  0.684880256652832
generate_one_block  0.6872248649597168
generate_one_block  0.668858528137207
generate_one_block  0.6821563243865967
generate_one_block  0.6917154788970947
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.11794376373291016  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

connection checking time:  32.252304792404175
block generation total time  29.983495950698853
average batch blocks generation time:  0.9369842484593391
block dataloader generation time/epoch 65.90514326095581
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3787841796875 GB
    Memory Allocated: 0.09631586074829102  GigaBytes
Max Memory Allocated: 16.661139965057373  GigaBytes

torch.Size([150574, 128])
torch.Size([111413, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.78677797317505  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09498167037963867  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150037, 128])
torch.Size([108718, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.092796802520752  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09604263305664062  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149718, 128])
torch.Size([109495, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.451335906982422  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.0953984260559082  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150385, 128])
torch.Size([110235, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.33018445968628  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09609317779541016  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150845, 128])
torch.Size([110828, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.50278377532959  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.0951833724975586  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149742, 128])
torch.Size([109047, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.440094470977783  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09607124328613281  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150007, 128])
torch.Size([109955, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.50074005126953  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09523153305053711  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150257, 128])
torch.Size([109298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.238260746002197  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09610939025878906  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150213, 128])
torch.Size([110316, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.550053119659424  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09544563293457031  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150020, 128])
torch.Size([109813, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.60319948196411  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09594917297363281  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150287, 128])
torch.Size([109480, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.35053777694702  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09508848190307617  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149919, 128])
torch.Size([109253, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.276392459869385  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09618473052978516  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150563, 128])
torch.Size([110849, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.622041702270508  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.0948185920715332  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149527, 128])
torch.Size([108828, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.175835132598877  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09595298767089844  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149754, 128])
torch.Size([109227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.35222291946411  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09530019760131836  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150307, 128])
torch.Size([109951, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.30199384689331  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09566402435302734  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150600, 128])
torch.Size([109478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.051454067230225  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09555244445800781  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150762, 128])
torch.Size([110522, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.331615924835205  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09611701965332031  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150731, 128])
torch.Size([111057, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.57952642440796  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09563446044921875  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150440, 128])
torch.Size([110592, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.589580059051514  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.0961294174194336  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150249, 128])
torch.Size([109811, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.53605604171753  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09569263458251953  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150780, 128])
torch.Size([110624, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.47475528717041  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09601211547851562  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149989, 128])
torch.Size([110367, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.42528009414673  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09491252899169922  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149564, 128])
torch.Size([109090, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.246164798736572  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09597396850585938  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150297, 128])
torch.Size([109921, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.378224849700928  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09549903869628906  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150614, 128])
torch.Size([110400, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.349453449249268  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09577178955078125  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150140, 128])
torch.Size([108768, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.17084312438965  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.0952157974243164  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150074, 128])
torch.Size([110002, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.29966449737549  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09597110748291016  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150265, 128])
torch.Size([109640, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.36894416809082  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09479331970214844  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149608, 128])
torch.Size([108470, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.101718425750732  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09598445892333984  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([150232, 128])
torch.Size([109759, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 16.42338275909424  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1522216796875 GB
    Memory Allocated: 0.09527111053466797  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

torch.Size([149714, 128])
torch.Size([109864, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1678466796875 GB
    Memory Allocated: 16.567325592041016  GigaBytes
Max Memory Allocated: 16.828975200653076  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028024829924106598 |0.023160681128501892 |0.5974814221262932 |9.67755913734436e-05 |1.0413445606827736 |0.0054323673248291016 |
----------------------------------------------------------pseudo_mini_loss sum 3.3161604404449463
Total (block generation + training)time/epoch 120.09298086166382
Training time/epoch 54.187562704086304
Training time without block to device /epoch 53.44642090797424
Training time without total dataloading part /epoch 52.450960636138916
load block tensor time/epoch 0.8967945575714111
block to device time/epoch 0.7411417961120605
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9161115
Number of first layer input nodes during this epoch:  4806214
