Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648522765.5000682
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013260841369628906  GigaBytes
Max Memory Allocated: 0.0013260841369628906  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024592161178588867
random selection method range initialization spend 0.006446123123168945
time for parepare:  0.018528223037719727
local_output_nid generation:  0.0022034645080566406
local_in_edges_tensor generation:  0.004787445068359375
mini_batch_src_global generation:  0.0018353462219238281
r_  generation:  0.018448591232299805
local_output_nid generation:  0.0025801658630371094
local_in_edges_tensor generation:  0.0016856193542480469
mini_batch_src_global generation:  0.002183198928833008
r_  generation:  0.018028974533081055
local_output_nid generation:  0.0028374195098876953
local_in_edges_tensor generation:  0.001589059829711914
mini_batch_src_global generation:  0.0014297962188720703
r_  generation:  0.018090486526489258
local_output_nid generation:  0.002961874008178711
local_in_edges_tensor generation:  0.0016028881072998047
mini_batch_src_global generation:  0.00144195556640625
r_  generation:  0.0180208683013916
local_output_nid generation:  0.002867460250854492
local_in_edges_tensor generation:  0.001528024673461914
mini_batch_src_global generation:  0.0014233589172363281
r_  generation:  0.018221139907836914
local_output_nid generation:  0.002887725830078125
local_in_edges_tensor generation:  0.0014965534210205078
mini_batch_src_global generation:  0.001477956771850586
r_  generation:  0.018987655639648438
local_output_nid generation:  0.0028753280639648438
local_in_edges_tensor generation:  0.0015223026275634766
mini_batch_src_global generation:  0.0014867782592773438
r_  generation:  0.01894378662109375
local_output_nid generation:  0.0028667449951171875
local_in_edges_tensor generation:  0.001477956771850586
mini_batch_src_global generation:  0.00145721435546875
r_  generation:  0.018512248992919922
local_output_nid generation:  0.002833843231201172
local_in_edges_tensor generation:  0.0014581680297851562
mini_batch_src_global generation:  0.001474618911743164
r_  generation:  0.018465518951416016
local_output_nid generation:  0.002897977828979492
local_in_edges_tensor generation:  0.0014526844024658203
mini_batch_src_global generation:  0.0015020370483398438
r_  generation:  0.019147634506225586
local_output_nid generation:  0.0029163360595703125
local_in_edges_tensor generation:  0.0014491081237792969
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.019416332244873047
local_output_nid generation:  0.0029621124267578125
local_in_edges_tensor generation:  0.0015773773193359375
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.019139766693115234
local_output_nid generation:  0.0029268264770507812
local_in_edges_tensor generation:  0.0015037059783935547
mini_batch_src_global generation:  0.0015246868133544922
r_  generation:  0.019108057022094727
local_output_nid generation:  0.0029447078704833984
local_in_edges_tensor generation:  0.0014891624450683594
mini_batch_src_global generation:  0.0015151500701904297
r_  generation:  0.01876044273376465
local_output_nid generation:  0.002913236618041992
local_in_edges_tensor generation:  0.0015213489532470703
mini_batch_src_global generation:  0.0015642642974853516
r_  generation:  0.01926445960998535
local_output_nid generation:  0.002855062484741211
local_in_edges_tensor generation:  0.0015804767608642578
mini_batch_src_global generation:  0.0015251636505126953
r_  generation:  0.018722057342529297
----------------------check_connections_block total spend ----------------------------- 0.4935476779937744
generate_one_block  0.027553319931030273
generate_one_block  0.02793717384338379
generate_one_block  0.0277402400970459
generate_one_block  0.030264854431152344
generate_one_block  0.027586936950683594
generate_one_block  0.02799201011657715
generate_one_block  0.02743077278137207
generate_one_block  0.02694845199584961
generate_one_block  0.02695918083190918
generate_one_block  0.027842283248901367
generate_one_block  0.027708053588867188
generate_one_block  0.027948856353759766
generate_one_block  0.02770543098449707
generate_one_block  0.02751469612121582
generate_one_block  0.0278470516204834
generate_one_block  0.026812314987182617
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.039415597915649414
gen group dst list time:  0.018735885620117188
time for parepare:  0.018840789794921875
local_output_nid generation:  0.00836181640625
local_in_edges_tensor generation:  0.018086671829223633
mini_batch_src_global generation:  0.01997089385986328
r_  generation:  0.19927716255187988
local_output_nid generation:  0.01235055923461914
local_in_edges_tensor generation:  0.020111083984375
mini_batch_src_global generation:  0.02608346939086914
r_  generation:  0.205796480178833
local_output_nid generation:  0.01191258430480957
local_in_edges_tensor generation:  0.016562938690185547
mini_batch_src_global generation:  0.025223493576049805
r_  generation:  0.2136073112487793
local_output_nid generation:  0.011964797973632812
local_in_edges_tensor generation:  0.014172792434692383
mini_batch_src_global generation:  0.02601933479309082
r_  generation:  0.2131786346435547
local_output_nid generation:  0.011934280395507812
local_in_edges_tensor generation:  0.016597747802734375
mini_batch_src_global generation:  0.03010702133178711
r_  generation:  0.21272993087768555
local_output_nid generation:  0.012101888656616211
local_in_edges_tensor generation:  0.016622304916381836
mini_batch_src_global generation:  0.02698659896850586
r_  generation:  0.21907687187194824
local_output_nid generation:  0.01192164421081543
local_in_edges_tensor generation:  0.012603998184204102
mini_batch_src_global generation:  0.026719331741333008
r_  generation:  0.2144615650177002
local_output_nid generation:  0.011741161346435547
local_in_edges_tensor generation:  0.01597118377685547
mini_batch_src_global generation:  0.026706695556640625
r_  generation:  0.2189626693725586
local_output_nid generation:  0.011762857437133789
local_in_edges_tensor generation:  0.014482498168945312
mini_batch_src_global generation:  0.02737259864807129
r_  generation:  0.21639275550842285
local_output_nid generation:  0.011929035186767578
local_in_edges_tensor generation:  0.016749858856201172
mini_batch_src_global generation:  0.027811765670776367
r_  generation:  0.22114253044128418
local_output_nid generation:  0.011992931365966797
local_in_edges_tensor generation:  0.018358945846557617
mini_batch_src_global generation:  0.02823638916015625
r_  generation:  0.22640562057495117
local_output_nid generation:  0.012012720108032227
local_in_edges_tensor generation:  0.014674901962280273
mini_batch_src_global generation:  0.031951904296875
r_  generation:  0.22096896171569824
local_output_nid generation:  0.011864900588989258
local_in_edges_tensor generation:  0.012772798538208008
mini_batch_src_global generation:  0.027485370635986328
r_  generation:  0.22056937217712402
local_output_nid generation:  0.011860132217407227
local_in_edges_tensor generation:  0.012358665466308594
mini_batch_src_global generation:  0.027323007583618164
r_  generation:  0.21827077865600586
local_output_nid generation:  0.012102127075195312
local_in_edges_tensor generation:  0.014847755432128906
mini_batch_src_global generation:  0.029064655303955078
r_  generation:  0.22083020210266113
local_output_nid generation:  0.01171255111694336
local_in_edges_tensor generation:  0.012568235397338867
mini_batch_src_global generation:  0.027251720428466797
r_  generation:  0.21538019180297852
----------------------check_connections_block total spend ----------------------------- 5.103549957275391
generate_one_block  0.2891724109649658
generate_one_block  0.28136420249938965
generate_one_block  0.2868635654449463
generate_one_block  0.27788710594177246
generate_one_block  0.29889750480651855
generate_one_block  0.28152012825012207
generate_one_block  0.27454376220703125
generate_one_block  0.2780327796936035
generate_one_block  0.27370166778564453
generate_one_block  0.29407668113708496
generate_one_block  0.28508591651916504
generate_one_block  0.28588056564331055
generate_one_block  0.2754647731781006
generate_one_block  0.27414917945861816
generate_one_block  0.2935631275177002
generate_one_block  0.3052864074707031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05997633934020996
gen group dst list time:  0.06195664405822754
time for parepare:  0.019162893295288086
local_output_nid generation:  0.026407480239868164
local_in_edges_tensor generation:  0.06447315216064453
mini_batch_src_global generation:  0.052558183670043945
r_  generation:  0.48876190185546875
local_output_nid generation:  0.031821489334106445
local_in_edges_tensor generation:  0.04961252212524414
mini_batch_src_global generation:  0.05882573127746582
r_  generation:  0.49838709831237793
local_output_nid generation:  0.031260013580322266
local_in_edges_tensor generation:  0.04441356658935547
mini_batch_src_global generation:  0.08229613304138184
r_  generation:  0.505171537399292
local_output_nid generation:  0.03271007537841797
local_in_edges_tensor generation:  0.03865170478820801
mini_batch_src_global generation:  0.05919647216796875
r_  generation:  0.5006759166717529
local_output_nid generation:  0.032056570053100586
local_in_edges_tensor generation:  0.04087471961975098
mini_batch_src_global generation:  0.05885887145996094
r_  generation:  0.525648832321167
local_output_nid generation:  0.03263401985168457
local_in_edges_tensor generation:  0.03705263137817383
mini_batch_src_global generation:  0.06122779846191406
r_  generation:  0.5254838466644287
local_output_nid generation:  0.03530716896057129
local_in_edges_tensor generation:  0.03614974021911621
mini_batch_src_global generation:  0.06001877784729004
r_  generation:  0.5198132991790771
local_output_nid generation:  0.033103227615356445
local_in_edges_tensor generation:  0.04803109169006348
mini_batch_src_global generation:  0.08017587661743164
r_  generation:  0.51120924949646
local_output_nid generation:  0.03351712226867676
local_in_edges_tensor generation:  0.043872833251953125
mini_batch_src_global generation:  0.06353926658630371
r_  generation:  0.5157513618469238
local_output_nid generation:  0.032169342041015625
local_in_edges_tensor generation:  0.03570961952209473
mini_batch_src_global generation:  0.06483268737792969
r_  generation:  0.5078103542327881
local_output_nid generation:  0.03324604034423828
local_in_edges_tensor generation:  0.047989845275878906
mini_batch_src_global generation:  0.0595555305480957
r_  generation:  0.5397956371307373
local_output_nid generation:  0.032649993896484375
local_in_edges_tensor generation:  0.04757499694824219
mini_batch_src_global generation:  0.06375575065612793
r_  generation:  0.5048637390136719
local_output_nid generation:  0.03343605995178223
local_in_edges_tensor generation:  0.036336660385131836
mini_batch_src_global generation:  0.05962681770324707
r_  generation:  0.5102143287658691
local_output_nid generation:  0.03207135200500488
local_in_edges_tensor generation:  0.032016754150390625
mini_batch_src_global generation:  0.06017351150512695
r_  generation:  0.5042448043823242
local_output_nid generation:  0.04360532760620117
local_in_edges_tensor generation:  0.03956198692321777
mini_batch_src_global generation:  0.059134721755981445
r_  generation:  0.5112128257751465
local_output_nid generation:  0.03244733810424805
local_in_edges_tensor generation:  0.04807734489440918
mini_batch_src_global generation:  0.061739444732666016
r_  generation:  0.5064547061920166
----------------------check_connections_block total spend ----------------------------- 12.170913696289062
generate_one_block  0.6553618907928467
generate_one_block  0.6975612640380859
generate_one_block  0.6619749069213867
generate_one_block  0.6868698596954346
generate_one_block  0.6640815734863281
generate_one_block  0.6686146259307861
generate_one_block  0.7136023044586182
generate_one_block  0.6430647373199463
generate_one_block  0.6622521877288818
generate_one_block  0.6536269187927246
generate_one_block  0.6794147491455078
generate_one_block  0.6537179946899414
generate_one_block  0.6650271415710449
generate_one_block  0.6444892883300781
generate_one_block  0.660693883895874
generate_one_block  0.6613056659698486
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06436324119567871
gen group dst list time:  0.1016073226928711
time for parepare:  0.019795656204223633
local_output_nid generation:  0.03443098068237305
local_in_edges_tensor generation:  0.0599827766418457
mini_batch_src_global generation:  0.05504894256591797
r_  generation:  0.5479729175567627
local_output_nid generation:  0.038872718811035156
local_in_edges_tensor generation:  0.056293487548828125
mini_batch_src_global generation:  0.07828044891357422
r_  generation:  0.5482442378997803
local_output_nid generation:  0.03825664520263672
local_in_edges_tensor generation:  0.042501211166381836
mini_batch_src_global generation:  0.06039309501647949
r_  generation:  0.567326545715332
local_output_nid generation:  0.039499521255493164
local_in_edges_tensor generation:  0.0530085563659668
mini_batch_src_global generation:  0.06018543243408203
r_  generation:  0.567070484161377
local_output_nid generation:  0.03832244873046875
local_in_edges_tensor generation:  0.04179644584655762
mini_batch_src_global generation:  0.061858177185058594
r_  generation:  0.5631351470947266
local_output_nid generation:  0.038761138916015625
local_in_edges_tensor generation:  0.04746818542480469
mini_batch_src_global generation:  0.06084036827087402
r_  generation:  0.5625674724578857
local_output_nid generation:  0.03843283653259277
local_in_edges_tensor generation:  0.0367581844329834
mini_batch_src_global generation:  0.06054258346557617
r_  generation:  0.576474666595459
local_output_nid generation:  0.038603782653808594
local_in_edges_tensor generation:  0.05173611640930176
mini_batch_src_global generation:  0.06718254089355469
r_  generation:  0.5807509422302246
local_output_nid generation:  0.03961634635925293
local_in_edges_tensor generation:  0.047879695892333984
mini_batch_src_global generation:  0.0615541934967041
r_  generation:  0.58439040184021
local_output_nid generation:  0.040575504302978516
local_in_edges_tensor generation:  0.04221224784851074
mini_batch_src_global generation:  0.06380987167358398
r_  generation:  0.5674660205841064
local_output_nid generation:  0.039434194564819336
local_in_edges_tensor generation:  0.047225236892700195
mini_batch_src_global generation:  0.065826416015625
r_  generation:  0.578589916229248
local_output_nid generation:  0.04153752326965332
local_in_edges_tensor generation:  0.037601470947265625
mini_batch_src_global generation:  0.062441110610961914
r_  generation:  0.5662238597869873
local_output_nid generation:  0.039427757263183594
local_in_edges_tensor generation:  0.03809046745300293
mini_batch_src_global generation:  0.06301665306091309
r_  generation:  0.5899968147277832
local_output_nid generation:  0.03925204277038574
local_in_edges_tensor generation:  0.0518794059753418
mini_batch_src_global generation:  0.06262063980102539
r_  generation:  0.5682082176208496
local_output_nid generation:  0.03932380676269531
local_in_edges_tensor generation:  0.05178236961364746
mini_batch_src_global generation:  0.0629119873046875
r_  generation:  0.5833642482757568
local_output_nid generation:  0.03975629806518555
local_in_edges_tensor generation:  0.04275226593017578
mini_batch_src_global generation:  0.06383848190307617
r_  generation:  0.5788531303405762
----------------------check_connections_block total spend ----------------------------- 13.63689923286438
generate_one_block  0.7120959758758545
generate_one_block  0.6933348178863525
generate_one_block  0.7029166221618652
generate_one_block  0.78916335105896
generate_one_block  0.7091784477233887
generate_one_block  0.7030706405639648
generate_one_block  0.6957690715789795
generate_one_block  0.7049367427825928
generate_one_block  0.6897892951965332
generate_one_block  0.7046856880187988
generate_one_block  0.7049927711486816
generate_one_block  0.7074153423309326
generate_one_block  0.6974282264709473
generate_one_block  0.7082622051239014
generate_one_block  0.7196168899536133
generate_one_block  0.7144005298614502
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05984830856323242
gen group dst list time:  0.0990598201751709
time for parepare:  0.019202232360839844
local_output_nid generation:  0.04035663604736328
local_in_edges_tensor generation:  0.058774709701538086
mini_batch_src_global generation:  0.05113840103149414
r_  generation:  0.5399339199066162
local_output_nid generation:  0.04291248321533203
local_in_edges_tensor generation:  0.0475001335144043
mini_batch_src_global generation:  0.06378769874572754
r_  generation:  0.5537796020507812
local_output_nid generation:  0.04361081123352051
local_in_edges_tensor generation:  0.04032015800476074
mini_batch_src_global generation:  0.06881022453308105
r_  generation:  0.5452265739440918
local_output_nid generation:  0.04148149490356445
local_in_edges_tensor generation:  0.04249978065490723
mini_batch_src_global generation:  0.06186366081237793
r_  generation:  0.5458910465240479
local_output_nid generation:  0.04136157035827637
local_in_edges_tensor generation:  0.038526058197021484
mini_batch_src_global generation:  0.06813931465148926
r_  generation:  0.5493488311767578
local_output_nid generation:  0.04135465621948242
local_in_edges_tensor generation:  0.03840065002441406
mini_batch_src_global generation:  0.061979055404663086
r_  generation:  0.547579288482666
local_output_nid generation:  0.04149818420410156
local_in_edges_tensor generation:  0.040383338928222656
mini_batch_src_global generation:  0.06272149085998535
r_  generation:  0.5518674850463867
local_output_nid generation:  0.04128694534301758
local_in_edges_tensor generation:  0.0426020622253418
mini_batch_src_global generation:  0.06283736228942871
r_  generation:  0.5537617206573486
local_output_nid generation:  0.04160761833190918
local_in_edges_tensor generation:  0.04070591926574707
mini_batch_src_global generation:  0.07389497756958008
r_  generation:  0.5537574291229248
local_output_nid generation:  0.04100394248962402
local_in_edges_tensor generation:  0.03837394714355469
mini_batch_src_global generation:  0.062110185623168945
r_  generation:  0.561286211013794
local_output_nid generation:  0.04188203811645508
local_in_edges_tensor generation:  0.04826998710632324
mini_batch_src_global generation:  0.06177163124084473
r_  generation:  0.559673547744751
local_output_nid generation:  0.04136466979980469
local_in_edges_tensor generation:  0.0382077693939209
mini_batch_src_global generation:  0.06216907501220703
r_  generation:  0.559729814529419
local_output_nid generation:  0.04142451286315918
local_in_edges_tensor generation:  0.03874802589416504
mini_batch_src_global generation:  0.061682701110839844
r_  generation:  0.56569504737854
local_output_nid generation:  0.04145050048828125
local_in_edges_tensor generation:  0.05267524719238281
mini_batch_src_global generation:  0.06128334999084473
r_  generation:  0.5615649223327637
local_output_nid generation:  0.04135298728942871
local_in_edges_tensor generation:  0.04904675483703613
mini_batch_src_global generation:  0.060794830322265625
r_  generation:  0.5642380714416504
local_output_nid generation:  0.041168212890625
local_in_edges_tensor generation:  0.04306483268737793
mini_batch_src_global generation:  0.06563258171081543
r_  generation:  0.5650384426116943
----------------------check_connections_block total spend ----------------------------- 13.351094007492065
generate_one_block  0.7109818458557129
generate_one_block  0.6850509643554688
generate_one_block  0.6980397701263428
generate_one_block  0.7038373947143555
generate_one_block  0.7006516456604004
generate_one_block  0.6784679889678955
generate_one_block  0.7515523433685303
generate_one_block  0.6989047527313232
generate_one_block  0.6754944324493408
generate_one_block  0.6894073486328125
generate_one_block  0.7149147987365723
generate_one_block  0.6812961101531982
generate_one_block  0.6799197196960449
generate_one_block  0.6964082717895508
generate_one_block  0.6989345550537109
generate_one_block  0.7064332962036133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03639578819274902
gen group dst list time:  0.09389638900756836
time for parepare:  0.019286155700683594
local_output_nid generation:  0.03998446464538574
local_in_edges_tensor generation:  0.05033302307128906
mini_batch_src_global generation:  0.04671788215637207
r_  generation:  0.5028886795043945
local_output_nid generation:  0.043906450271606445
local_in_edges_tensor generation:  0.03536677360534668
mini_batch_src_global generation:  0.058618783950805664
r_  generation:  0.5067007541656494
local_output_nid generation:  0.041707754135131836
local_in_edges_tensor generation:  0.03580594062805176
mini_batch_src_global generation:  0.05994915962219238
r_  generation:  0.5065584182739258
local_output_nid generation:  0.04126381874084473
local_in_edges_tensor generation:  0.03591299057006836
mini_batch_src_global generation:  0.06014680862426758
r_  generation:  0.5084254741668701
local_output_nid generation:  0.04157400131225586
local_in_edges_tensor generation:  0.043447017669677734
mini_batch_src_global generation:  0.059952497482299805
r_  generation:  0.5096731185913086
local_output_nid generation:  0.04096579551696777
local_in_edges_tensor generation:  0.03798508644104004
mini_batch_src_global generation:  0.05936908721923828
r_  generation:  0.5106935501098633
local_output_nid generation:  0.041223764419555664
local_in_edges_tensor generation:  0.03586220741271973
mini_batch_src_global generation:  0.059867143630981445
r_  generation:  0.5144555568695068
local_output_nid generation:  0.041298866271972656
local_in_edges_tensor generation:  0.0416712760925293
mini_batch_src_global generation:  0.06481671333312988
r_  generation:  0.5191936492919922
local_output_nid generation:  0.04113411903381348
local_in_edges_tensor generation:  0.03997540473937988
mini_batch_src_global generation:  0.05894041061401367
r_  generation:  0.5130739212036133
local_output_nid generation:  0.04105067253112793
local_in_edges_tensor generation:  0.0403141975402832
mini_batch_src_global generation:  0.06252050399780273
r_  generation:  0.5356178283691406
local_output_nid generation:  0.041703224182128906
local_in_edges_tensor generation:  0.04718923568725586
mini_batch_src_global generation:  0.05891561508178711
r_  generation:  0.5214138031005859
local_output_nid generation:  0.04176950454711914
local_in_edges_tensor generation:  0.04089975357055664
mini_batch_src_global generation:  0.05978035926818848
r_  generation:  0.5197253227233887
local_output_nid generation:  0.042200326919555664
local_in_edges_tensor generation:  0.0441286563873291
mini_batch_src_global generation:  0.058681488037109375
r_  generation:  0.5282371044158936
local_output_nid generation:  0.04404330253601074
local_in_edges_tensor generation:  0.0408933162689209
mini_batch_src_global generation:  0.06000494956970215
r_  generation:  0.5193436145782471
local_output_nid generation:  0.04199624061584473
local_in_edges_tensor generation:  0.03648114204406738
mini_batch_src_global generation:  0.059865713119506836
r_  generation:  0.5245673656463623
local_output_nid generation:  0.042430877685546875
local_in_edges_tensor generation:  0.04540061950683594
mini_batch_src_global generation:  0.05930757522583008
r_  generation:  0.5238831043243408
----------------------check_connections_block total spend ----------------------------- 12.520301818847656
generate_one_block  0.6322872638702393
generate_one_block  0.6362249851226807
generate_one_block  0.6450710296630859
generate_one_block  0.6617913246154785
generate_one_block  0.6511292457580566
generate_one_block  0.6406404972076416
generate_one_block  0.6531975269317627
generate_one_block  0.6446115970611572
generate_one_block  0.7118997573852539
generate_one_block  0.6465969085693359
generate_one_block  0.6469707489013672
generate_one_block  0.6368889808654785
generate_one_block  0.657059907913208
generate_one_block  0.646536111831665
generate_one_block  0.6523215770721436
generate_one_block  0.6497607231140137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013260841369628906  GigaBytes
Max Memory Allocated: 0.0013260841369628906  GigaBytes

connection checking time:  56.782758712768555
block generation total time  48.16748881340027
average batch blocks generation time:  3.010468050837517
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.136383056640625  GigaBytes
Max Memory Allocated: 0.136383056640625  GigaBytes

torch.Size([167173, 128])
torch.Size([166369, 64])
torch.Size([163999, 64])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 23.62 GiB total capacity; 22.24 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
