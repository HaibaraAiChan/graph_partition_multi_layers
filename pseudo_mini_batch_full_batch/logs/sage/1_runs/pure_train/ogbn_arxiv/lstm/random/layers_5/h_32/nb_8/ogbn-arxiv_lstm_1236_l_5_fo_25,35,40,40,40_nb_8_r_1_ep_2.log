Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648500909.6915474
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0247650146484375
random selection method range initialization spend 0.006205081939697266
time for parepare:  0.018714427947998047
local_output_nid generation:  0.0041959285736083984
local_in_edges_tensor generation:  0.005938291549682617
mini_batch_src_global generation:  0.003400087356567383
r_  generation:  0.038407087326049805
local_output_nid generation:  0.005899667739868164
local_in_edges_tensor generation:  0.0031528472900390625
mini_batch_src_global generation:  0.0042955875396728516
r_  generation:  0.03933262825012207
local_output_nid generation:  0.006089925765991211
local_in_edges_tensor generation:  0.003198385238647461
mini_batch_src_global generation:  0.002847433090209961
r_  generation:  0.040350914001464844
local_output_nid generation:  0.006150007247924805
local_in_edges_tensor generation:  0.0031321048736572266
mini_batch_src_global generation:  0.0030982494354248047
r_  generation:  0.04057645797729492
local_output_nid generation:  0.00618290901184082
local_in_edges_tensor generation:  0.0033097267150878906
mini_batch_src_global generation:  0.0031936168670654297
r_  generation:  0.042035579681396484
local_output_nid generation:  0.006113529205322266
local_in_edges_tensor generation:  0.0031561851501464844
mini_batch_src_global generation:  0.0033791065216064453
r_  generation:  0.04195427894592285
local_output_nid generation:  0.006091117858886719
local_in_edges_tensor generation:  0.0033173561096191406
mini_batch_src_global generation:  0.003335714340209961
r_  generation:  0.041692495346069336
local_output_nid generation:  0.006124973297119141
local_in_edges_tensor generation:  0.003154754638671875
mini_batch_src_global generation:  0.003399372100830078
r_  generation:  0.0411067008972168
----------------------check_connections_block total spend ----------------------------- 0.5242648124694824
generate_one_block  0.054903268814086914
generate_one_block  0.0556643009185791
generate_one_block  0.05630373954772949
generate_one_block  0.05467391014099121
generate_one_block  0.0592045783996582
generate_one_block  0.0559086799621582
generate_one_block  0.05475354194641113
generate_one_block  0.053884267807006836
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04153251647949219
gen group dst list time:  0.015340089797973633
time for parepare:  0.01936054229736328
local_output_nid generation:  0.013643264770507812
local_in_edges_tensor generation:  0.032483577728271484
mini_batch_src_global generation:  0.0307919979095459
r_  generation:  0.29263758659362793
local_output_nid generation:  0.0201416015625
local_in_edges_tensor generation:  0.030331134796142578
mini_batch_src_global generation:  0.03639698028564453
r_  generation:  0.3096432685852051
local_output_nid generation:  0.02019214630126953
local_in_edges_tensor generation:  0.028342723846435547
mini_batch_src_global generation:  0.036011457443237305
r_  generation:  0.31011962890625
local_output_nid generation:  0.01996445655822754
local_in_edges_tensor generation:  0.02022695541381836
mini_batch_src_global generation:  0.03741335868835449
r_  generation:  0.3120150566101074
local_output_nid generation:  0.02024531364440918
local_in_edges_tensor generation:  0.02268075942993164
mini_batch_src_global generation:  0.038266897201538086
r_  generation:  0.31756067276000977
local_output_nid generation:  0.02020859718322754
local_in_edges_tensor generation:  0.026045560836791992
mini_batch_src_global generation:  0.03903985023498535
r_  generation:  0.31833434104919434
local_output_nid generation:  0.020307540893554688
local_in_edges_tensor generation:  0.022479772567749023
mini_batch_src_global generation:  0.03857541084289551
r_  generation:  0.3167600631713867
local_output_nid generation:  0.020080089569091797
local_in_edges_tensor generation:  0.0247042179107666
mini_batch_src_global generation:  0.03825020790100098
r_  generation:  0.31239962577819824
----------------------check_connections_block total spend ----------------------------- 3.6994688510894775
generate_one_block  0.40526819229125977
generate_one_block  0.41045594215393066
generate_one_block  0.4102802276611328
generate_one_block  0.39934706687927246
generate_one_block  0.4111945629119873
generate_one_block  0.4194159507751465
generate_one_block  0.40607571601867676
generate_one_block  0.3964102268218994
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04080533981323242
gen group dst list time:  0.035650014877319336
time for parepare:  0.01923847198486328
local_output_nid generation:  0.029452800750732422
local_in_edges_tensor generation:  0.04973340034484863
mini_batch_src_global generation:  0.05422782897949219
r_  generation:  0.5159997940063477
local_output_nid generation:  0.03780174255371094
local_in_edges_tensor generation:  0.053696393966674805
mini_batch_src_global generation:  0.060654640197753906
r_  generation:  0.5287895202636719
local_output_nid generation:  0.03819680213928223
local_in_edges_tensor generation:  0.03917407989501953
mini_batch_src_global generation:  0.05747342109680176
r_  generation:  0.5365684032440186
local_output_nid generation:  0.03821063041687012
local_in_edges_tensor generation:  0.04411602020263672
mini_batch_src_global generation:  0.0642554759979248
r_  generation:  0.5287871360778809
local_output_nid generation:  0.0381317138671875
local_in_edges_tensor generation:  0.03985738754272461
mini_batch_src_global generation:  0.06259584426879883
r_  generation:  0.5469207763671875
local_output_nid generation:  0.038074493408203125
local_in_edges_tensor generation:  0.035680294036865234
mini_batch_src_global generation:  0.06296229362487793
r_  generation:  0.5371732711791992
local_output_nid generation:  0.03834962844848633
local_in_edges_tensor generation:  0.04431486129760742
mini_batch_src_global generation:  0.059119224548339844
r_  generation:  0.5538680553436279
local_output_nid generation:  0.03817868232727051
local_in_edges_tensor generation:  0.03463435173034668
mini_batch_src_global generation:  0.06292510032653809
r_  generation:  0.5355639457702637
----------------------check_connections_block total spend ----------------------------- 6.34814453125
generate_one_block  0.7068803310394287
generate_one_block  0.6996467113494873
generate_one_block  0.6703622341156006
generate_one_block  0.6845278739929199
generate_one_block  0.6932616233825684
generate_one_block  0.6734824180603027
generate_one_block  0.706183910369873
generate_one_block  0.673262357711792
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03430056571960449
gen group dst list time:  0.04460453987121582
time for parepare:  0.01960897445678711
local_output_nid generation:  0.03458070755004883
local_in_edges_tensor generation:  0.04760479927062988
mini_batch_src_global generation:  0.05403470993041992
r_  generation:  0.5380942821502686
local_output_nid generation:  0.04027295112609863
local_in_edges_tensor generation:  0.060236454010009766
mini_batch_src_global generation:  0.07261490821838379
r_  generation:  0.5443642139434814
local_output_nid generation:  0.03942251205444336
local_in_edges_tensor generation:  0.05846762657165527
mini_batch_src_global generation:  0.06202888488769531
r_  generation:  0.5387654304504395
local_output_nid generation:  0.03926515579223633
local_in_edges_tensor generation:  0.036458492279052734
mini_batch_src_global generation:  0.05948638916015625
r_  generation:  0.5533950328826904
local_output_nid generation:  0.03922128677368164
local_in_edges_tensor generation:  0.05073285102844238
mini_batch_src_global generation:  0.05889463424682617
r_  generation:  0.5492734909057617
local_output_nid generation:  0.03939366340637207
local_in_edges_tensor generation:  0.04348015785217285
mini_batch_src_global generation:  0.059375762939453125
r_  generation:  0.553441047668457
local_output_nid generation:  0.038958072662353516
local_in_edges_tensor generation:  0.03945112228393555
mini_batch_src_global generation:  0.05933094024658203
r_  generation:  0.5804438591003418
local_output_nid generation:  0.042290449142456055
local_in_edges_tensor generation:  0.036318063735961914
mini_batch_src_global generation:  0.0662539005279541
r_  generation:  0.5586001873016357
----------------------check_connections_block total spend ----------------------------- 6.635780572891235
generate_one_block  0.6890401840209961
generate_one_block  0.6981682777404785
generate_one_block  0.6972436904907227
generate_one_block  0.6908445358276367
generate_one_block  0.7095239162445068
generate_one_block  0.6844160556793213
generate_one_block  0.7246148586273193
generate_one_block  0.6743083000183105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04930448532104492
gen group dst list time:  0.04775190353393555
time for parepare:  0.019345521926879883
local_output_nid generation:  0.035340309143066406
local_in_edges_tensor generation:  0.05528068542480469
mini_batch_src_global generation:  0.045905351638793945
r_  generation:  0.5042529106140137
local_output_nid generation:  0.0409085750579834
local_in_edges_tensor generation:  0.04942512512207031
mini_batch_src_global generation:  0.05754375457763672
r_  generation:  0.504234790802002
local_output_nid generation:  0.040422677993774414
local_in_edges_tensor generation:  0.0357668399810791
mini_batch_src_global generation:  0.05759572982788086
r_  generation:  0.5083792209625244
local_output_nid generation:  0.0402224063873291
local_in_edges_tensor generation:  0.03995704650878906
mini_batch_src_global generation:  0.057369232177734375
r_  generation:  0.5051007270812988
local_output_nid generation:  0.03964519500732422
local_in_edges_tensor generation:  0.04538869857788086
mini_batch_src_global generation:  0.057355403900146484
r_  generation:  0.5084643363952637
local_output_nid generation:  0.03990769386291504
local_in_edges_tensor generation:  0.045653581619262695
mini_batch_src_global generation:  0.05666375160217285
r_  generation:  0.5049993991851807
local_output_nid generation:  0.04013848304748535
local_in_edges_tensor generation:  0.03584742546081543
mini_batch_src_global generation:  0.05684947967529297
r_  generation:  0.5087544918060303
local_output_nid generation:  0.03976869583129883
local_in_edges_tensor generation:  0.04501032829284668
mini_batch_src_global generation:  0.05663657188415527
r_  generation:  0.5130503177642822
----------------------check_connections_block total spend ----------------------------- 6.133932590484619
generate_one_block  0.6406877040863037
generate_one_block  0.6442968845367432
generate_one_block  0.6406779289245605
generate_one_block  0.6318848133087158
generate_one_block  0.6545600891113281
generate_one_block  0.6479456424713135
generate_one_block  0.6277341842651367
generate_one_block  0.6783695220947266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

connection checking time:  22.817326545715332
block generation total time  19.5003719329834
average batch blocks generation time:  2.437546491622925
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12648773193359375  GigaBytes
Max Memory Allocated: 0.12648773193359375  GigaBytes

torch.Size([166989, 128])
torch.Size([165777, 32])
torch.Size([161254, 32])
torch.Size([141964, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7479248046875 GB
    Memory Allocated: 20.430041790008545  GigaBytes
Max Memory Allocated: 20.44209337234497  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4080810546875 GB
    Memory Allocated: 0.12793207168579102  GigaBytes
Max Memory Allocated: 20.44209337234497  GigaBytes

torch.Size([167082, 128])
torch.Size([165894, 32])
torch.Size([161509, 32])
torch.Size([142166, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4178466796875 GB
    Memory Allocated: 20.441842555999756  GigaBytes
Max Memory Allocated: 20.455854415893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4178466796875 GB
    Memory Allocated: 0.12838125228881836  GigaBytes
Max Memory Allocated: 20.455854415893555  GigaBytes

torch.Size([167049, 128])
torch.Size([165837, 32])
torch.Size([161361, 32])
torch.Size([141936, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4197998046875 GB
    Memory Allocated: 20.446320056915283  GigaBytes
Max Memory Allocated: 20.46045684814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4197998046875 GB
    Memory Allocated: 0.1278972625732422  GigaBytes
Max Memory Allocated: 20.46045684814453  GigaBytes

torch.Size([167019, 128])
torch.Size([165822, 32])
torch.Size([161444, 32])
torch.Size([142201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4197998046875 GB
    Memory Allocated: 20.42741346359253  GigaBytes
Max Memory Allocated: 20.46045684814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4197998046875 GB
    Memory Allocated: 0.12844228744506836  GigaBytes
Max Memory Allocated: 20.46045684814453  GigaBytes

torch.Size([167013, 128])
torch.Size([165829, 32])
torch.Size([161481, 32])
torch.Size([142179, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4276123046875 GB
    Memory Allocated: 20.46276569366455  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4276123046875 GB
    Memory Allocated: 0.12800025939941406  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([167061, 128])
torch.Size([165870, 32])
torch.Size([161422, 32])
torch.Size([141982, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4276123046875 GB
    Memory Allocated: 20.452229499816895  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4276123046875 GB
    Memory Allocated: 0.1283116340637207  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([167014, 128])
torch.Size([165771, 32])
torch.Size([161347, 32])
torch.Size([142034, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.42338800430298  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.12777233123779297  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([167001, 128])
torch.Size([165771, 32])
torch.Size([161319, 32])
torch.Size([141692, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.401162147521973  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03481405973434448 |0.07874521613121033 |0.5744784474372864 |0.00011143088340759277 |0.632709801197052 |0.014009475708007812 |
----------------------------------------------------------pseudo_mini_loss sum 4.5016865730285645
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5632987
Number of first layer input nodes during this epoch:  1336228
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.2148127555847168  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.022600173950195312
random selection method range initialization spend 0.005859375
time for parepare:  0.018123865127563477
local_output_nid generation:  0.005071163177490234
local_in_edges_tensor generation:  0.008467435836791992
mini_batch_src_global generation:  0.003311634063720703
r_  generation:  0.037421226501464844
local_output_nid generation:  0.006104707717895508
local_in_edges_tensor generation:  0.004396200180053711
mini_batch_src_global generation:  0.004254579544067383
r_  generation:  0.03999829292297363
local_output_nid generation:  0.006238698959350586
local_in_edges_tensor generation:  0.0031616687774658203
mini_batch_src_global generation:  0.0028460025787353516
r_  generation:  0.04104733467102051
local_output_nid generation:  0.006381034851074219
local_in_edges_tensor generation:  0.003126859664916992
mini_batch_src_global generation:  0.00302886962890625
r_  generation:  0.042310237884521484
local_output_nid generation:  0.0062863826751708984
local_in_edges_tensor generation:  0.0032575130462646484
mini_batch_src_global generation:  0.0030896663665771484
r_  generation:  0.04269552230834961
local_output_nid generation:  0.006279945373535156
local_in_edges_tensor generation:  0.003179311752319336
mini_batch_src_global generation:  0.003348112106323242
r_  generation:  0.043243408203125
local_output_nid generation:  0.006275653839111328
local_in_edges_tensor generation:  0.0031337738037109375
mini_batch_src_global generation:  0.00344085693359375
r_  generation:  0.0421907901763916
local_output_nid generation:  0.006323814392089844
local_in_edges_tensor generation:  0.0032029151916503906
mini_batch_src_global generation:  0.0034682750701904297
r_  generation:  0.04237818717956543
----------------------check_connections_block total spend ----------------------------- 0.5377626419067383
generate_one_block  0.07401156425476074
generate_one_block  0.06235647201538086
generate_one_block  0.06373333930969238
generate_one_block  0.06406283378601074
generate_one_block  0.0647590160369873
generate_one_block  0.0643150806427002
generate_one_block  0.06594729423522949
generate_one_block  0.06689834594726562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04034256935119629
gen group dst list time:  0.014218807220458984
time for parepare:  0.019563674926757812
local_output_nid generation:  0.014156341552734375
local_in_edges_tensor generation:  0.03221464157104492
mini_batch_src_global generation:  0.02844858169555664
r_  generation:  0.3014230728149414
local_output_nid generation:  0.021245241165161133
local_in_edges_tensor generation:  0.028809785842895508
mini_batch_src_global generation:  0.03665518760681152
r_  generation:  0.3130531311035156
local_output_nid generation:  0.021413326263427734
local_in_edges_tensor generation:  0.02330470085144043
mini_batch_src_global generation:  0.03584480285644531
r_  generation:  0.3149137496948242
local_output_nid generation:  0.021140575408935547
local_in_edges_tensor generation:  0.026285409927368164
mini_batch_src_global generation:  0.04617810249328613
r_  generation:  0.33053112030029297
local_output_nid generation:  0.024111509323120117
local_in_edges_tensor generation:  0.027274370193481445
mini_batch_src_global generation:  0.040251731872558594
r_  generation:  0.32074427604675293
local_output_nid generation:  0.021107196807861328
local_in_edges_tensor generation:  0.021370410919189453
mini_batch_src_global generation:  0.038779497146606445
r_  generation:  0.3184361457824707
local_output_nid generation:  0.02122354507446289
local_in_edges_tensor generation:  0.02632904052734375
mini_batch_src_global generation:  0.038338661193847656
r_  generation:  0.32237839698791504
local_output_nid generation:  0.02138352394104004
local_in_edges_tensor generation:  0.018552064895629883
mini_batch_src_global generation:  0.03900647163391113
r_  generation:  0.3339354991912842
----------------------check_connections_block total spend ----------------------------- 3.807220458984375
generate_one_block  0.4533381462097168
generate_one_block  0.44000935554504395
generate_one_block  0.4267594814300537
generate_one_block  0.4320642948150635
generate_one_block  0.4268920421600342
generate_one_block  0.42746543884277344
generate_one_block  0.42652249336242676
generate_one_block  0.45438647270202637
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04862403869628906
gen group dst list time:  0.0361170768737793
time for parepare:  0.018887996673583984
local_output_nid generation:  0.029369354248046875
local_in_edges_tensor generation:  0.061812639236450195
mini_batch_src_global generation:  0.05373096466064453
r_  generation:  0.5273435115814209
local_output_nid generation:  0.035776376724243164
local_in_edges_tensor generation:  0.05432534217834473
mini_batch_src_global generation:  0.060651302337646484
r_  generation:  0.5283808708190918
local_output_nid generation:  0.03552532196044922
local_in_edges_tensor generation:  0.045523881912231445
mini_batch_src_global generation:  0.05700945854187012
r_  generation:  0.5406460762023926
local_output_nid generation:  0.03576040267944336
local_in_edges_tensor generation:  0.039942026138305664
mini_batch_src_global generation:  0.06494998931884766
r_  generation:  0.5339856147766113
local_output_nid generation:  0.03558850288391113
local_in_edges_tensor generation:  0.0392606258392334
mini_batch_src_global generation:  0.05964946746826172
r_  generation:  0.5490789413452148
local_output_nid generation:  0.03562808036804199
local_in_edges_tensor generation:  0.039490699768066406
mini_batch_src_global generation:  0.062064170837402344
r_  generation:  0.5357911586761475
local_output_nid generation:  0.03551292419433594
local_in_edges_tensor generation:  0.04559922218322754
mini_batch_src_global generation:  0.060437679290771484
r_  generation:  0.5515875816345215
local_output_nid generation:  0.03594970703125
local_in_edges_tensor generation:  0.03612184524536133
mini_batch_src_global generation:  0.061832427978515625
r_  generation:  0.5417342185974121
----------------------check_connections_block total spend ----------------------------- 6.3801305294036865
generate_one_block  0.7177844047546387
generate_one_block  0.7139558792114258
generate_one_block  0.7036910057067871
generate_one_block  0.7047767639160156
generate_one_block  0.7036895751953125
generate_one_block  0.7039825916290283
generate_one_block  0.7039124965667725
generate_one_block  0.7200288772583008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04062819480895996
gen group dst list time:  0.045111656188964844
time for parepare:  0.019493818283081055
local_output_nid generation:  0.03667855262756348
local_in_edges_tensor generation:  0.05163264274597168
mini_batch_src_global generation:  0.0531773567199707
r_  generation:  0.541675329208374
local_output_nid generation:  0.043703317642211914
local_in_edges_tensor generation:  0.09130072593688965
mini_batch_src_global generation:  0.061420440673828125
r_  generation:  0.5430009365081787
local_output_nid generation:  0.0399928092956543
local_in_edges_tensor generation:  0.04480338096618652
mini_batch_src_global generation:  0.06406402587890625
r_  generation:  0.5651473999023438
local_output_nid generation:  0.03998255729675293
local_in_edges_tensor generation:  0.04995870590209961
mini_batch_src_global generation:  0.06285643577575684
r_  generation:  0.5513560771942139
local_output_nid generation:  0.04084944725036621
local_in_edges_tensor generation:  0.043273210525512695
mini_batch_src_global generation:  0.058118343353271484
r_  generation:  0.5506813526153564
local_output_nid generation:  0.040267229080200195
local_in_edges_tensor generation:  0.040303707122802734
mini_batch_src_global generation:  0.05848336219787598
r_  generation:  0.5546808242797852
local_output_nid generation:  0.04047656059265137
local_in_edges_tensor generation:  0.04614686965942383
mini_batch_src_global generation:  0.058684349060058594
r_  generation:  0.5580835342407227
local_output_nid generation:  0.03978705406188965
local_in_edges_tensor generation:  0.04036879539489746
mini_batch_src_global generation:  0.0602109432220459
r_  generation:  0.5674624443054199
----------------------check_connections_block total spend ----------------------------- 6.674667835235596
generate_one_block  0.7123816013336182
generate_one_block  0.718259334564209
generate_one_block  0.7245199680328369
generate_one_block  0.697563886642456
generate_one_block  0.7028706073760986
generate_one_block  0.7064430713653564
generate_one_block  0.7170071601867676
generate_one_block  0.7150130271911621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03952288627624512
gen group dst list time:  0.0503232479095459
time for parepare:  0.0193173885345459
local_output_nid generation:  0.03619670867919922
local_in_edges_tensor generation:  0.05182528495788574
mini_batch_src_global generation:  0.04764437675476074
r_  generation:  0.5017948150634766
local_output_nid generation:  0.040472984313964844
local_in_edges_tensor generation:  0.03863835334777832
mini_batch_src_global generation:  0.05723977088928223
r_  generation:  0.5087504386901855
local_output_nid generation:  0.0411839485168457
local_in_edges_tensor generation:  0.03996467590332031
mini_batch_src_global generation:  0.06111574172973633
r_  generation:  0.5114245414733887
local_output_nid generation:  0.04039883613586426
local_in_edges_tensor generation:  0.039911508560180664
mini_batch_src_global generation:  0.05753040313720703
r_  generation:  0.513084888458252
local_output_nid generation:  0.04050040245056152
local_in_edges_tensor generation:  0.04022693634033203
mini_batch_src_global generation:  0.058911800384521484
r_  generation:  0.5101330280303955
local_output_nid generation:  0.04233860969543457
local_in_edges_tensor generation:  0.07784080505371094
mini_batch_src_global generation:  0.05765891075134277
r_  generation:  0.5119471549987793
local_output_nid generation:  0.040418148040771484
local_in_edges_tensor generation:  0.045221805572509766
mini_batch_src_global generation:  0.0605928897857666
r_  generation:  0.5115013122558594
local_output_nid generation:  0.04045510292053223
local_in_edges_tensor generation:  0.040894269943237305
mini_batch_src_global generation:  0.05699777603149414
r_  generation:  0.5184590816497803
----------------------check_connections_block total spend ----------------------------- 6.213422775268555
generate_one_block  0.6640338897705078
generate_one_block  0.6833610534667969
generate_one_block  0.6668016910552979
generate_one_block  0.6637427806854248
generate_one_block  0.6579062938690186
generate_one_block  0.6635339260101318
generate_one_block  0.6686158180236816
generate_one_block  0.6690731048583984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.2148127555847168  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

connection checking time:  23.075441598892212
block generation total time  20.190386533737183
average batch blocks generation time:  2.523798316717148
block dataloader generation time/epoch 46.06758236885071
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.12972068786621094  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([167045, 128])
torch.Size([165865, 32])
torch.Size([161498, 32])
torch.Size([142233, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.43490171432495  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.12932491302490234  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([166965, 128])
torch.Size([165749, 32])
torch.Size([161354, 32])
torch.Size([141943, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.420400619506836  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.12967538833618164  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([167048, 128])
torch.Size([165842, 32])
torch.Size([161377, 32])
torch.Size([142055, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.42830467224121  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.1293168067932129  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([166970, 128])
torch.Size([165729, 32])
torch.Size([161238, 32])
torch.Size([141970, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.446890830993652  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.13045930862426758  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([166893, 128])
torch.Size([165603, 32])
torch.Size([161215, 32])
torch.Size([141847, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 20.43335485458374  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1756591796875 GB
    Memory Allocated: 0.1300673484802246  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([166990, 128])
torch.Size([165689, 32])
torch.Size([161237, 32])
torch.Size([141661, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.431556224822998  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.1297163963317871  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([167043, 128])
torch.Size([165862, 32])
torch.Size([161333, 32])
torch.Size([141771, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.437885284423828  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 0.12931585311889648  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

torch.Size([166928, 128])
torch.Size([165716, 32])
torch.Size([161321, 32])
torch.Size([142359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1990966796875 GB
    Memory Allocated: 20.456231117248535  GigaBytes
Max Memory Allocated: 20.476913452148438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04218575358390808 |0.045367687940597534 |0.4563533663749695 |9.930133819580078e-05 |0.5981563925743103 |0.008408784866333008 |
----------------------------------------------------------pseudo_mini_loss sum 4.012347221374512
Total (block generation + training)time/epoch 55.244099140167236
Training time/epoch 9.1762375831604
Training time without block to device /epoch 8.81329607963562
Training time without total dataloading part /epoch 8.445281267166138
load block tensor time/epoch 0.33748602867126465
block to device time/epoch 0.3629415035247803
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5631431
Number of first layer input nodes during this epoch:  1335882
