Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648458132.2924442
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02939128875732422
random selection method range initialization spend 0.007814645767211914
time for parepare:  0.01937246322631836
local_output_nid generation:  0.004286050796508789
local_in_edges_tensor generation:  0.007502079010009766
mini_batch_src_global generation:  0.004364728927612305
r_  generation:  0.05292654037475586
local_output_nid generation:  0.005766868591308594
local_in_edges_tensor generation:  0.0033845901489257812
mini_batch_src_global generation:  0.0047261714935302734
r_  generation:  0.04329848289489746
local_output_nid generation:  0.006047487258911133
local_in_edges_tensor generation:  0.0033283233642578125
mini_batch_src_global generation:  0.003297567367553711
r_  generation:  0.04363536834716797
local_output_nid generation:  0.0061724185943603516
local_in_edges_tensor generation:  0.0034248828887939453
mini_batch_src_global generation:  0.003522157669067383
r_  generation:  0.04587674140930176
local_output_nid generation:  0.0060863494873046875
local_in_edges_tensor generation:  0.003390073776245117
mini_batch_src_global generation:  0.003600597381591797
r_  generation:  0.04600095748901367
local_output_nid generation:  0.006131649017333984
local_in_edges_tensor generation:  0.003390789031982422
mini_batch_src_global generation:  0.0038406848907470703
r_  generation:  0.04661965370178223
local_output_nid generation:  0.006145954132080078
local_in_edges_tensor generation:  0.003451824188232422
mini_batch_src_global generation:  0.003902435302734375
r_  generation:  0.04598283767700195
local_output_nid generation:  0.006131887435913086
local_in_edges_tensor generation:  0.0034601688385009766
mini_batch_src_global generation:  0.003885507583618164
r_  generation:  0.04632735252380371
----------------------check_connections_block total spend ----------------------------- 0.5853824615478516
generate_one_block  0.06195807456970215
generate_one_block  0.06111454963684082
generate_one_block  0.06023216247558594
generate_one_block  0.06251811981201172
generate_one_block  0.0648961067199707
generate_one_block  0.06185555458068848
generate_one_block  0.061866044998168945
generate_one_block  0.061420440673828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04430699348449707
gen group dst list time:  0.016129493713378906
time for parepare:  0.018964529037475586
local_output_nid generation:  0.013916730880737305
local_in_edges_tensor generation:  0.037230491638183594
mini_batch_src_global generation:  0.03632164001464844
r_  generation:  0.36084628105163574
local_output_nid generation:  0.01970839500427246
local_in_edges_tensor generation:  0.0345003604888916
mini_batch_src_global generation:  0.04430675506591797
r_  generation:  0.3648254871368408
local_output_nid generation:  0.018802165985107422
local_in_edges_tensor generation:  0.0274198055267334
mini_batch_src_global generation:  0.04333806037902832
r_  generation:  0.3720712661743164
local_output_nid generation:  0.01948404312133789
local_in_edges_tensor generation:  0.02911233901977539
mini_batch_src_global generation:  0.04562020301818848
r_  generation:  0.3780081272125244
local_output_nid generation:  0.0188901424407959
local_in_edges_tensor generation:  0.027538061141967773
mini_batch_src_global generation:  0.04596686363220215
r_  generation:  0.3764173984527588
local_output_nid generation:  0.019271135330200195
local_in_edges_tensor generation:  0.028417110443115234
mini_batch_src_global generation:  0.046251535415649414
r_  generation:  0.3811330795288086
local_output_nid generation:  0.0190432071685791
local_in_edges_tensor generation:  0.02104640007019043
mini_batch_src_global generation:  0.049640655517578125
r_  generation:  0.37865209579467773
local_output_nid generation:  0.019048213958740234
local_in_edges_tensor generation:  0.024431705474853516
mini_batch_src_global generation:  0.04630231857299805
r_  generation:  0.38027215003967285
----------------------check_connections_block total spend ----------------------------- 4.3757524490356445
generate_one_block  0.5002033710479736
generate_one_block  0.49591922760009766
generate_one_block  0.4824490547180176
generate_one_block  0.5061073303222656
generate_one_block  0.4945967197418213
generate_one_block  0.5141599178314209
generate_one_block  0.4897139072418213
generate_one_block  0.4928772449493408
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03257608413696289
gen group dst list time:  0.03710150718688965
time for parepare:  0.018820762634277344
local_output_nid generation:  0.028810501098632812
local_in_edges_tensor generation:  0.04455399513244629
mini_batch_src_global generation:  0.04796719551086426
r_  generation:  0.48014283180236816
local_output_nid generation:  0.03524374961853027
local_in_edges_tensor generation:  0.05141639709472656
mini_batch_src_global generation:  0.057645320892333984
r_  generation:  0.48688673973083496
local_output_nid generation:  0.03515505790710449
local_in_edges_tensor generation:  0.03789162635803223
mini_batch_src_global generation:  0.05561232566833496
r_  generation:  0.48570990562438965
local_output_nid generation:  0.03528118133544922
local_in_edges_tensor generation:  0.0430757999420166
mini_batch_src_global generation:  0.0529329776763916
r_  generation:  0.501223087310791
local_output_nid generation:  0.03505563735961914
local_in_edges_tensor generation:  0.03851056098937988
mini_batch_src_global generation:  0.05390667915344238
r_  generation:  0.49920177459716797
local_output_nid generation:  0.035027265548706055
local_in_edges_tensor generation:  0.038712501525878906
mini_batch_src_global generation:  0.05780768394470215
r_  generation:  0.49825215339660645
local_output_nid generation:  0.03500175476074219
local_in_edges_tensor generation:  0.038501739501953125
mini_batch_src_global generation:  0.054984092712402344
r_  generation:  0.5108211040496826
local_output_nid generation:  0.03511762619018555
local_in_edges_tensor generation:  0.034113407135009766
mini_batch_src_global generation:  0.055242300033569336
r_  generation:  0.5038602352142334
----------------------check_connections_block total spend ----------------------------- 5.90212607383728
generate_one_block  0.6152589321136475
generate_one_block  0.6289925575256348
generate_one_block  0.6132152080535889
generate_one_block  0.6297769546508789
generate_one_block  0.6173410415649414
generate_one_block  0.6256017684936523
generate_one_block  0.6447165012359619
generate_one_block  0.617173433303833
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  10.277878522872925
block generation total time  8.968103170394897
average batch blocks generation time:  1.1210128962993622
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.1004800796508789  GigaBytes
Max Memory Allocated: 0.1004800796508789  GigaBytes

torch.Size([162107, 128])
torch.Size([146111, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0350341796875 GB
    Memory Allocated: 16.5885329246521  GigaBytes
Max Memory Allocated: 16.620201110839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6405029296875 GB
    Memory Allocated: 0.102508544921875  GigaBytes
Max Memory Allocated: 16.620201110839844  GigaBytes

torch.Size([162175, 128])
torch.Size([145956, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6737060546875 GB
    Memory Allocated: 16.53059482574463  GigaBytes
Max Memory Allocated: 16.620201110839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6737060546875 GB
    Memory Allocated: 0.10319185256958008  GigaBytes
Max Memory Allocated: 16.620201110839844  GigaBytes

torch.Size([161915, 128])
torch.Size([145428, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6737060546875 GB
    Memory Allocated: 16.449453830718994  GigaBytes
Max Memory Allocated: 16.620201110839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9627685546875 GB
    Memory Allocated: 0.10282325744628906  GigaBytes
Max Memory Allocated: 16.620201110839844  GigaBytes

torch.Size([162479, 128])
torch.Size([146809, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9627685546875 GB
    Memory Allocated: 16.643447875976562  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2596435546875 GB
    Memory Allocated: 0.1042318344116211  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162060, 128])
torch.Size([145939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.548574447631836  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10262203216552734  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162173, 128])
torch.Size([145964, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.598506450653076  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10332250595092773  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162180, 128])
torch.Size([145699, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.55240488052368  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10244083404541016  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162049, 128])
torch.Size([145729, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.534327030181885  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040541261434555054 |0.060356974601745605 |0.6906009018421173 |0.00011295080184936523 |1.018721491098404 |0.011984825134277344 |
----------------------------------------------------------pseudo_mini_loss sum 4.941981792449951
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3053982
Number of first layer input nodes during this epoch:  1297138
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.13864564895629883  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029065608978271484
random selection method range initialization spend 0.005378007888793945
time for parepare:  0.017985820770263672
local_output_nid generation:  0.005026817321777344
local_in_edges_tensor generation:  0.009670734405517578
mini_batch_src_global generation:  0.0038323402404785156
r_  generation:  0.04157590866088867
local_output_nid generation:  0.00636601448059082
local_in_edges_tensor generation:  0.0034186840057373047
mini_batch_src_global generation:  0.004880189895629883
r_  generation:  0.045493125915527344
local_output_nid generation:  0.0063784122467041016
local_in_edges_tensor generation:  0.003297567367553711
mini_batch_src_global generation:  0.0034189224243164062
r_  generation:  0.045568227767944336
local_output_nid generation:  0.0065038204193115234
local_in_edges_tensor generation:  0.0034689903259277344
mini_batch_src_global generation:  0.003530740737915039
r_  generation:  0.04781389236450195
local_output_nid generation:  0.006512880325317383
local_in_edges_tensor generation:  0.0035088062286376953
mini_batch_src_global generation:  0.003912448883056641
r_  generation:  0.04790019989013672
local_output_nid generation:  0.00648951530456543
local_in_edges_tensor generation:  0.003368854522705078
mini_batch_src_global generation:  0.004027605056762695
r_  generation:  0.04801344871520996
local_output_nid generation:  0.00647735595703125
local_in_edges_tensor generation:  0.0034110546112060547
mini_batch_src_global generation:  0.004036664962768555
r_  generation:  0.04850959777832031
local_output_nid generation:  0.006566047668457031
local_in_edges_tensor generation:  0.003448963165283203
mini_batch_src_global generation:  0.004252433776855469
r_  generation:  0.049043893814086914
----------------------check_connections_block total spend ----------------------------- 0.5959978103637695
generate_one_block  0.07826900482177734
generate_one_block  0.07421183586120605
generate_one_block  0.07358813285827637
generate_one_block  0.07359433174133301
generate_one_block  0.07443928718566895
generate_one_block  0.07452869415283203
generate_one_block  0.0812082290649414
generate_one_block  0.07599210739135742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04407978057861328
gen group dst list time:  0.016480684280395508
time for parepare:  0.01902937889099121
local_output_nid generation:  0.01495218276977539
local_in_edges_tensor generation:  0.03762197494506836
mini_batch_src_global generation:  0.03925347328186035
r_  generation:  0.36151981353759766
local_output_nid generation:  0.02092719078063965
local_in_edges_tensor generation:  0.03524446487426758
mini_batch_src_global generation:  0.04777121543884277
r_  generation:  0.3801612854003906
local_output_nid generation:  0.02011418342590332
local_in_edges_tensor generation:  0.02893829345703125
mini_batch_src_global generation:  0.04433941841125488
r_  generation:  0.38268446922302246
local_output_nid generation:  0.01997518539428711
local_in_edges_tensor generation:  0.02498006820678711
mini_batch_src_global generation:  0.044770002365112305
r_  generation:  0.3809630870819092
local_output_nid generation:  0.020090341567993164
local_in_edges_tensor generation:  0.03957796096801758
mini_batch_src_global generation:  0.04922199249267578
r_  generation:  0.39299941062927246
local_output_nid generation:  0.020865917205810547
local_in_edges_tensor generation:  0.029590606689453125
mini_batch_src_global generation:  0.0501093864440918
r_  generation:  0.4032883644104004
local_output_nid generation:  0.022742748260498047
local_in_edges_tensor generation:  0.02580857276916504
mini_batch_src_global generation:  0.0487515926361084
r_  generation:  0.3874828815460205
local_output_nid generation:  0.02080988883972168
local_in_edges_tensor generation:  0.030936241149902344
mini_batch_src_global generation:  0.046423912048339844
r_  generation:  0.38553404808044434
----------------------check_connections_block total spend ----------------------------- 4.5164735317230225
generate_one_block  0.5336191654205322
generate_one_block  0.5563910007476807
generate_one_block  0.5330901145935059
generate_one_block  0.5188181400299072
generate_one_block  0.5239906311035156
generate_one_block  0.5241773128509521
generate_one_block  0.5229887962341309
generate_one_block  0.5599148273468018
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.12967801094055176
gen group dst list time:  0.03929638862609863
time for parepare:  0.019499778747558594
local_output_nid generation:  0.030501365661621094
local_in_edges_tensor generation:  0.05382680892944336
mini_batch_src_global generation:  0.0490262508392334
r_  generation:  0.47952795028686523
local_output_nid generation:  0.036789655685424805
local_in_edges_tensor generation:  0.05092263221740723
mini_batch_src_global generation:  0.05656623840332031
r_  generation:  0.4924781322479248
local_output_nid generation:  0.03661370277404785
local_in_edges_tensor generation:  0.042716264724731445
mini_batch_src_global generation:  0.05722665786743164
r_  generation:  0.4956953525543213
local_output_nid generation:  0.036786794662475586
local_in_edges_tensor generation:  0.03906750679016113
mini_batch_src_global generation:  0.05522322654724121
r_  generation:  0.49771571159362793
local_output_nid generation:  0.036767005920410156
local_in_edges_tensor generation:  0.03800654411315918
mini_batch_src_global generation:  0.05674266815185547
r_  generation:  0.4976780414581299
local_output_nid generation:  0.03804421424865723
local_in_edges_tensor generation:  0.03923296928405762
mini_batch_src_global generation:  0.054198503494262695
r_  generation:  0.5034456253051758
local_output_nid generation:  0.036741018295288086
local_in_edges_tensor generation:  0.03776121139526367
mini_batch_src_global generation:  0.054300785064697266
r_  generation:  0.5062839984893799
local_output_nid generation:  0.03648805618286133
local_in_edges_tensor generation:  0.03838801383972168
mini_batch_src_global generation:  0.05803203582763672
r_  generation:  0.5080220699310303
----------------------check_connections_block total spend ----------------------------- 5.9512434005737305
generate_one_block  0.6564974784851074
generate_one_block  0.6567614078521729
generate_one_block  0.669830322265625
generate_one_block  0.6576533317565918
generate_one_block  0.651069164276123
generate_one_block  0.6602189540863037
generate_one_block  0.6507515907287598
generate_one_block  0.6591265201568604
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.13864564895629883  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

connection checking time:  10.467716932296753
block generation total time  9.53489875793457
average batch blocks generation time:  1.1918623447418213
block dataloader generation time/epoch 22.6318302154541
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10497093200683594  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([161997, 128])
torch.Size([145504, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.505484104156494  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10445022583007812  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162345, 128])
torch.Size([146121, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.625277996063232  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10513067245483398  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162525, 128])
torch.Size([146271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.6203293800354  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10418844223022461  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162226, 128])
torch.Size([145938, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.524322032928467  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10500955581665039  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162354, 128])
torch.Size([145997, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.55533218383789  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10431241989135742  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162322, 128])
torch.Size([146184, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.561407566070557  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10502862930297852  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162198, 128])
torch.Size([145918, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.547073364257812  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 0.10435962677001953  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

torch.Size([162287, 128])
torch.Size([146400, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2674560546875 GB
    Memory Allocated: 16.6033878326416  GigaBytes
Max Memory Allocated: 16.67608642578125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036180466413497925 |0.022426873445510864 |0.5811253488063812 |0.00010222196578979492 |1.004498451948166 |0.0037186145782470703 |
----------------------------------------------------------pseudo_mini_loss sum 3.7977728843688965
Total (block generation + training)time/epoch 35.81943082809448
Training time/epoch 13.187354564666748
Training time without block to device /epoch 13.007939577102661
Training time without total dataloading part /epoch 12.689526796340942
load block tensor time/epoch 0.2894437313079834
block to device time/epoch 0.17941498756408691
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3055955
Number of first layer input nodes during this epoch:  1298254
