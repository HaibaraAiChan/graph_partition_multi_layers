Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648484770.827951
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.02506399154663086
random selection method range initialization spend 0.0066547393798828125
time for parepare:  0.018563508987426758
local_output_nid generation:  0.008666038513183594
local_in_edges_tensor generation:  0.008885860443115234
mini_batch_src_global generation:  0.006674051284790039
r_  generation:  0.08177971839904785
local_output_nid generation:  0.012249946594238281
local_in_edges_tensor generation:  0.005962848663330078
mini_batch_src_global generation:  0.00877237319946289
r_  generation:  0.08901667594909668
local_output_nid generation:  0.012346982955932617
local_in_edges_tensor generation:  0.006006956100463867
mini_batch_src_global generation:  0.006808042526245117
r_  generation:  0.08976864814758301
local_output_nid generation:  0.012458324432373047
local_in_edges_tensor generation:  0.006104707717895508
mini_batch_src_global generation:  0.007451772689819336
r_  generation:  0.09256267547607422
----------------------check_connections_block total spend ----------------------------- 0.5568680763244629
generate_one_block  0.10180926322937012
generate_one_block  0.10272502899169922
generate_one_block  0.10282444953918457
generate_one_block  0.10285258293151855
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.038552045822143555
gen group dst list time:  0.011524438858032227
time for parepare:  0.01903390884399414
local_output_nid generation:  0.021658897399902344
local_in_edges_tensor generation:  0.040764808654785156
mini_batch_src_global generation:  0.039389610290527344
r_  generation:  0.40752625465393066
local_output_nid generation:  0.029035091400146484
local_in_edges_tensor generation:  0.03893160820007324
mini_batch_src_global generation:  0.04921722412109375
r_  generation:  0.41474056243896484
local_output_nid generation:  0.02932596206665039
local_in_edges_tensor generation:  0.031859636306762695
mini_batch_src_global generation:  0.05153822898864746
r_  generation:  0.427046537399292
local_output_nid generation:  0.029232263565063477
local_in_edges_tensor generation:  0.028307676315307617
mini_batch_src_global generation:  0.05013084411621094
r_  generation:  0.42255306243896484
----------------------check_connections_block total spend ----------------------------- 2.4996824264526367
generate_one_block  0.564826250076294
generate_one_block  0.5464043617248535
generate_one_block  0.5505900382995605
generate_one_block  0.5413377285003662
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034622907638549805
gen group dst list time:  0.02123284339904785
time for parepare:  0.019530057907104492
local_output_nid generation:  0.03417658805847168
local_in_edges_tensor generation:  0.04724597930908203
mini_batch_src_global generation:  0.053466081619262695
r_  generation:  0.531597375869751
local_output_nid generation:  0.04693436622619629
local_in_edges_tensor generation:  0.05698513984680176
mini_batch_src_global generation:  0.060074806213378906
r_  generation:  0.5350809097290039
local_output_nid generation:  0.04689621925354004
local_in_edges_tensor generation:  0.04243969917297363
mini_batch_src_global generation:  0.05652618408203125
r_  generation:  0.5458848476409912
local_output_nid generation:  0.04725027084350586
local_in_edges_tensor generation:  0.042562246322631836
mini_batch_src_global generation:  0.05717873573303223
r_  generation:  0.5518128871917725
----------------------check_connections_block total spend ----------------------------- 3.24841570854187
generate_one_block  0.6756060123443604
generate_one_block  0.6895978450775146
generate_one_block  0.6744720935821533
generate_one_block  0.6838843822479248
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026999473571777344
gen group dst list time:  0.023916006088256836
time for parepare:  0.018758773803710938
local_output_nid generation:  0.03700757026672363
local_in_edges_tensor generation:  0.04299306869506836
mini_batch_src_global generation:  0.04624438285827637
r_  generation:  0.5061278343200684
local_output_nid generation:  0.045554399490356445
local_in_edges_tensor generation:  0.05193352699279785
mini_batch_src_global generation:  0.05750298500061035
r_  generation:  0.5069360733032227
local_output_nid generation:  0.04510998725891113
local_in_edges_tensor generation:  0.037113189697265625
mini_batch_src_global generation:  0.05846667289733887
r_  generation:  0.517266035079956
local_output_nid generation:  0.04580259323120117
local_in_edges_tensor generation:  0.03919410705566406
mini_batch_src_global generation:  0.05830574035644531
r_  generation:  0.5244646072387695
----------------------check_connections_block total spend ----------------------------- 3.110466241836548
generate_one_block  0.665947437286377
generate_one_block  0.6460070610046387
generate_one_block  0.6347799301147461
generate_one_block  0.6370415687561035
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

connection checking time:  8.858564376831055
block generation total time  7.510494709014893
average batch blocks generation time:  1.8776236772537231
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11656904220581055  GigaBytes
Max Memory Allocated: 0.11656904220581055  GigaBytes

torch.Size([166714, 128])
torch.Size([164774, 32])
torch.Size([154935, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3221435546875 GB
    Memory Allocated: 17.986071586608887  GigaBytes
Max Memory Allocated: 18.010658740997314  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2186279296875 GB
    Memory Allocated: 0.12108278274536133  GigaBytes
Max Memory Allocated: 18.010658740997314  GigaBytes

torch.Size([166731, 128])
torch.Size([164816, 32])
torch.Size([155351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2186279296875 GB
    Memory Allocated: 18.003555297851562  GigaBytes
Max Memory Allocated: 18.031428337097168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2186279296875 GB
    Memory Allocated: 0.12166309356689453  GigaBytes
Max Memory Allocated: 18.031428337097168  GigaBytes

torch.Size([166656, 128])
torch.Size([164715, 32])
torch.Size([154857, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 18.01175355911255  GigaBytes
Max Memory Allocated: 18.03972101211548  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.12106513977050781  GigaBytes
Max Memory Allocated: 18.03972101211548  GigaBytes

torch.Size([166670, 128])
torch.Size([164710, 32])
torch.Size([155055, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 18.004090309143066  GigaBytes
Max Memory Allocated: 18.03972101211548  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03753179311752319 |0.09149879217147827 |0.5736234784126282 |0.00012362003326416016 |0.5011236667633057 |0.008139371871948242 |
----------------------------------------------------------pseudo_mini_loss sum 4.469374656677246
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2351514
Number of first layer input nodes during this epoch:  666771
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.18670225143432617  GigaBytes
Max Memory Allocated: 18.03972101211548  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.027016162872314453
random selection method range initialization spend 0.005360841751098633
time for parepare:  0.018442869186401367
local_output_nid generation:  0.009082555770874023
local_in_edges_tensor generation:  0.011190414428710938
mini_batch_src_global generation:  0.007241487503051758
r_  generation:  0.08179974555969238
local_output_nid generation:  0.012158870697021484
local_in_edges_tensor generation:  0.008680343627929688
mini_batch_src_global generation:  0.008893489837646484
r_  generation:  0.08852529525756836
local_output_nid generation:  0.012697458267211914
local_in_edges_tensor generation:  0.006543397903442383
mini_batch_src_global generation:  0.006699562072753906
r_  generation:  0.09212732315063477
local_output_nid generation:  0.012490272521972656
local_in_edges_tensor generation:  0.006360292434692383
mini_batch_src_global generation:  0.007400989532470703
r_  generation:  0.09259867668151855
----------------------check_connections_block total spend ----------------------------- 0.5673840045928955
generate_one_block  0.11902952194213867
generate_one_block  0.11566758155822754
generate_one_block  0.11497306823730469
generate_one_block  0.11448550224304199
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0390772819519043
gen group dst list time:  0.011258840560913086
time for parepare:  0.01922917366027832
local_output_nid generation:  0.022920846939086914
local_in_edges_tensor generation:  0.039594173431396484
mini_batch_src_global generation:  0.0383758544921875
r_  generation:  0.4073913097381592
local_output_nid generation:  0.02979588508605957
local_in_edges_tensor generation:  0.03943228721618652
mini_batch_src_global generation:  0.049503326416015625
r_  generation:  0.42521214485168457
local_output_nid generation:  0.029602527618408203
local_in_edges_tensor generation:  0.03217363357543945
mini_batch_src_global generation:  0.04917550086975098
r_  generation:  0.4253067970275879
local_output_nid generation:  0.031494855880737305
local_in_edges_tensor generation:  0.028384923934936523
mini_batch_src_global generation:  0.05021381378173828
r_  generation:  0.43206286430358887
----------------------check_connections_block total spend ----------------------------- 2.523437261581421
generate_one_block  0.5680716037750244
generate_one_block  0.5777533054351807
generate_one_block  0.6023805141448975
generate_one_block  0.6060779094696045
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04371976852416992
gen group dst list time:  0.025671720504760742
time for parepare:  0.02174091339111328
local_output_nid generation:  0.034757375717163086
local_in_edges_tensor generation:  0.06437969207763672
mini_batch_src_global generation:  0.05054497718811035
r_  generation:  0.5359663963317871
local_output_nid generation:  0.04238390922546387
local_in_edges_tensor generation:  0.05553388595581055
mini_batch_src_global generation:  0.062166452407836914
r_  generation:  0.5553460121154785
local_output_nid generation:  0.04279756546020508
local_in_edges_tensor generation:  0.046449899673461914
mini_batch_src_global generation:  0.06007885932922363
r_  generation:  0.5541155338287354
local_output_nid generation:  0.04313492774963379
local_in_edges_tensor generation:  0.04133296012878418
mini_batch_src_global generation:  0.056966543197631836
r_  generation:  0.5567572116851807
----------------------check_connections_block total spend ----------------------------- 3.3046677112579346
generate_one_block  0.7481510639190674
generate_one_block  0.769385576248169
generate_one_block  0.7180318832397461
generate_one_block  0.7100849151611328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040409088134765625
gen group dst list time:  0.0288693904876709
time for parepare:  0.01941061019897461
local_output_nid generation:  0.04084300994873047
local_in_edges_tensor generation:  0.05055546760559082
mini_batch_src_global generation:  0.04633307456970215
r_  generation:  0.5085361003875732
local_output_nid generation:  0.04646110534667969
local_in_edges_tensor generation:  0.05763077735900879
mini_batch_src_global generation:  0.05722546577453613
r_  generation:  0.5133876800537109
local_output_nid generation:  0.04661226272583008
local_in_edges_tensor generation:  0.05010533332824707
mini_batch_src_global generation:  0.06303715705871582
r_  generation:  0.5126426219940186
local_output_nid generation:  0.046512603759765625
local_in_edges_tensor generation:  0.04165458679199219
mini_batch_src_global generation:  0.05757713317871094
r_  generation:  0.5167856216430664
----------------------check_connections_block total spend ----------------------------- 3.157825469970703
generate_one_block  0.6748242378234863
generate_one_block  0.6650424003601074
generate_one_block  0.6809804439544678
generate_one_block  0.7074980735778809
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.18670225143432617  GigaBytes
Max Memory Allocated: 18.03972101211548  GigaBytes

connection checking time:  8.985930442810059
block generation total time  8.028281927108765
average batch blocks generation time:  2.007070481777191
block dataloader generation time/epoch 19.34607720375061
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.12296295166015625  GigaBytes
Max Memory Allocated: 18.03972101211548  GigaBytes

torch.Size([166690, 128])
torch.Size([164755, 32])
torch.Size([155198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 18.026313304901123  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 0.12238073348999023  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

torch.Size([166705, 128])
torch.Size([164699, 32])
torch.Size([154872, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 18.021920680999756  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 0.12294864654541016  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

torch.Size([166747, 128])
torch.Size([164903, 32])
torch.Size([155138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 18.001733779907227  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 0.12234210968017578  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

torch.Size([166700, 128])
torch.Size([164771, 32])
torch.Size([154946, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4705810546875 GB
    Memory Allocated: 17.988630771636963  GigaBytes
Max Memory Allocated: 18.054463863372803  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04173833131790161 |0.030636310577392578 |0.3643423318862915 |0.00010514259338378906 |0.4914417266845703 |0.0067138671875 |
----------------------------------------------------------pseudo_mini_loss sum 3.9627890586853027
Total (block generation + training)time/epoch 23.09178876876831
Training time/epoch 3.745440721511841
Training time without block to device /epoch 3.6228954792022705
Training time without total dataloading part /epoch 3.4302706718444824
load block tensor time/epoch 0.16695332527160645
block to device time/epoch 0.12254524230957031
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2351393
Number of first layer input nodes during this epoch:  666842
