Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648500839.1537328
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02412724494934082
random selection method range initialization spend 0.0064465999603271484
time for parepare:  0.018683433532714844
local_output_nid generation:  0.008211374282836914
local_in_edges_tensor generation:  0.009086847305297852
mini_batch_src_global generation:  0.006602048873901367
r_  generation:  0.08151984214782715
local_output_nid generation:  0.011556148529052734
local_in_edges_tensor generation:  0.006031990051269531
mini_batch_src_global generation:  0.008638858795166016
r_  generation:  0.08795285224914551
local_output_nid generation:  0.011848926544189453
local_in_edges_tensor generation:  0.006082773208618164
mini_batch_src_global generation:  0.006728410720825195
r_  generation:  0.08861398696899414
local_output_nid generation:  0.011688232421875
local_in_edges_tensor generation:  0.006122589111328125
mini_batch_src_global generation:  0.007285356521606445
r_  generation:  0.09175610542297363
----------------------check_connections_block total spend ----------------------------- 0.5498063564300537
generate_one_block  0.10149669647216797
generate_one_block  0.10204744338989258
generate_one_block  0.10341835021972656
generate_one_block  0.10254907608032227
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0410611629486084
gen group dst list time:  0.011274576187133789
time for parepare:  0.01990199089050293
local_output_nid generation:  0.019580364227294922
local_in_edges_tensor generation:  0.04308629035949707
mini_batch_src_global generation:  0.038968801498413086
r_  generation:  0.4007232189178467
local_output_nid generation:  0.028419971466064453
local_in_edges_tensor generation:  0.041007041931152344
mini_batch_src_global generation:  0.04805397987365723
r_  generation:  0.4180312156677246
local_output_nid generation:  0.02916860580444336
local_in_edges_tensor generation:  0.03457188606262207
mini_batch_src_global generation:  0.048972368240356445
r_  generation:  0.42055439949035645
local_output_nid generation:  0.02887868881225586
local_in_edges_tensor generation:  0.027057170867919922
mini_batch_src_global generation:  0.049677133560180664
r_  generation:  0.4189774990081787
----------------------check_connections_block total spend ----------------------------- 2.489680051803589
generate_one_block  0.5649263858795166
generate_one_block  0.5508229732513428
generate_one_block  0.5472605228424072
generate_one_block  0.5343263149261475
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.035605669021606445
gen group dst list time:  0.02086806297302246
time for parepare:  0.019500255584716797
local_output_nid generation:  0.030100584030151367
local_in_edges_tensor generation:  0.04766392707824707
mini_batch_src_global generation:  0.05581974983215332
r_  generation:  0.5416164398193359
local_output_nid generation:  0.04101276397705078
local_in_edges_tensor generation:  0.05792713165283203
mini_batch_src_global generation:  0.06326127052307129
r_  generation:  0.5495510101318359
local_output_nid generation:  0.0411372184753418
local_in_edges_tensor generation:  0.04328298568725586
mini_batch_src_global generation:  0.05814957618713379
r_  generation:  0.5615179538726807
local_output_nid generation:  0.0410921573638916
local_in_edges_tensor generation:  0.0438082218170166
mini_batch_src_global generation:  0.06018400192260742
r_  generation:  0.5599532127380371
----------------------check_connections_block total spend ----------------------------- 3.3022449016571045
generate_one_block  0.6970465183258057
generate_one_block  0.7144217491149902
generate_one_block  0.7229628562927246
generate_one_block  0.7066056728363037
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047936439514160156
gen group dst list time:  0.025795698165893555
time for parepare:  0.01956653594970703
local_output_nid generation:  0.033605337142944336
local_in_edges_tensor generation:  0.06934571266174316
mini_batch_src_global generation:  0.0541682243347168
r_  generation:  0.5506892204284668
local_output_nid generation:  0.03853869438171387
local_in_edges_tensor generation:  0.05773806571960449
mini_batch_src_global generation:  0.06316161155700684
r_  generation:  0.5673577785491943
local_output_nid generation:  0.04167819023132324
local_in_edges_tensor generation:  0.04128217697143555
mini_batch_src_global generation:  0.06377077102661133
r_  generation:  0.5573582649230957
local_output_nid generation:  0.039514780044555664
local_in_edges_tensor generation:  0.04176187515258789
mini_batch_src_global generation:  0.06606888771057129
r_  generation:  0.550323486328125
----------------------check_connections_block total spend ----------------------------- 3.360771894454956
generate_one_block  0.684938907623291
generate_one_block  0.7086341381072998
generate_one_block  0.6975960731506348
generate_one_block  0.698012113571167
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03849649429321289
gen group dst list time:  0.025620222091674805
time for parepare:  0.019286155700683594
local_output_nid generation:  0.03336668014526367
local_in_edges_tensor generation:  0.05705404281616211
mini_batch_src_global generation:  0.04680752754211426
r_  generation:  0.5105350017547607
local_output_nid generation:  0.03901791572570801
local_in_edges_tensor generation:  0.052530765533447266
mini_batch_src_global generation:  0.05886435508728027
r_  generation:  0.510509729385376
local_output_nid generation:  0.038861751556396484
local_in_edges_tensor generation:  0.03997302055358887
mini_batch_src_global generation:  0.058928728103637695
r_  generation:  0.5168631076812744
local_output_nid generation:  0.03897595405578613
local_in_edges_tensor generation:  0.0397794246673584
mini_batch_src_global generation:  0.0621182918548584
r_  generation:  0.5115358829498291
----------------------check_connections_block total spend ----------------------------- 3.1157495975494385
generate_one_block  0.6403112411499023
generate_one_block  0.6525495052337646
generate_one_block  0.6462552547454834
generate_one_block  0.6501810550689697
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

connection checking time:  12.268446445465088
block generation total time  10.416851282119751
average batch blocks generation time:  2.6042128205299377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12994003295898438  GigaBytes
Max Memory Allocated: 0.12994003295898438  GigaBytes

torch.Size([167400, 128])
torch.Size([166875, 32])
torch.Size([164830, 32])
torch.Size([155019, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7440185546875 GB
    Memory Allocated: 21.38732147216797  GigaBytes
Max Memory Allocated: 21.41196918487549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.13425397872924805  GigaBytes
Max Memory Allocated: 21.41196918487549  GigaBytes

torch.Size([167444, 128])
torch.Size([166888, 32])
torch.Size([164841, 32])
torch.Size([154866, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 21.393418312072754  GigaBytes
Max Memory Allocated: 21.421337604522705  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2479248046875 GB
    Memory Allocated: 0.1345067024230957  GigaBytes
Max Memory Allocated: 21.421337604522705  GigaBytes

torch.Size([167383, 128])
torch.Size([166815, 32])
torch.Size([164801, 32])
torch.Size([154987, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 21.41809844970703  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.13421058654785156  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

torch.Size([167387, 128])
torch.Size([166811, 32])
torch.Size([164820, 32])
torch.Size([154914, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 21.376643180847168  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04836833477020264 |0.12255483865737915 |0.8116400837898254 |0.00012481212615966797 |0.6833003759384155 |0.009908437728881836 |
----------------------------------------------------------pseudo_mini_loss sum 4.500892639160156
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3021388
Number of first layer input nodes during this epoch:  669614
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.22719240188598633  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.023189306259155273
random selection method range initialization spend 0.006536960601806641
time for parepare:  0.01904582977294922
local_output_nid generation:  0.008396148681640625
local_in_edges_tensor generation:  0.009485483169555664
mini_batch_src_global generation:  0.008324861526489258
r_  generation:  0.08405828475952148
local_output_nid generation:  0.011806488037109375
local_in_edges_tensor generation:  0.00850677490234375
mini_batch_src_global generation:  0.010829687118530273
r_  generation:  0.09028434753417969
local_output_nid generation:  0.011975526809692383
local_in_edges_tensor generation:  0.00618290901184082
mini_batch_src_global generation:  0.007790327072143555
r_  generation:  0.09327268600463867
local_output_nid generation:  0.012660503387451172
local_in_edges_tensor generation:  0.010423660278320312
mini_batch_src_global generation:  0.009880304336547852
r_  generation:  0.10404491424560547
----------------------check_connections_block total spend ----------------------------- 0.5995595455169678
generate_one_block  0.135054349899292
generate_one_block  0.11585283279418945
generate_one_block  0.11555814743041992
generate_one_block  0.1152341365814209
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.05128765106201172
gen group dst list time:  0.01122593879699707
time for parepare:  0.019412517547607422
local_output_nid generation:  0.019906282424926758
local_in_edges_tensor generation:  0.052186012268066406
mini_batch_src_global generation:  0.04277944564819336
r_  generation:  0.40457940101623535
local_output_nid generation:  0.025871753692626953
local_in_edges_tensor generation:  0.041686058044433594
mini_batch_src_global generation:  0.04861903190612793
r_  generation:  0.4145667552947998
local_output_nid generation:  0.02541327476501465
local_in_edges_tensor generation:  0.03266096115112305
mini_batch_src_global generation:  0.04959869384765625
r_  generation:  0.4237062931060791
local_output_nid generation:  0.025259017944335938
local_in_edges_tensor generation:  0.03097367286682129
mini_batch_src_global generation:  0.053386688232421875
r_  generation:  0.4299633502960205
----------------------check_connections_block total spend ----------------------------- 2.516493797302246
generate_one_block  0.5738046169281006
generate_one_block  0.5745973587036133
generate_one_block  0.5984365940093994
generate_one_block  0.6081604957580566
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04980278015136719
gen group dst list time:  0.03012394905090332
time for parepare:  0.019516468048095703
local_output_nid generation:  0.030870437622070312
local_in_edges_tensor generation:  0.06305551528930664
mini_batch_src_global generation:  0.05613112449645996
r_  generation:  0.5588459968566895
local_output_nid generation:  0.036835432052612305
local_in_edges_tensor generation:  0.05646491050720215
mini_batch_src_global generation:  0.06434464454650879
r_  generation:  0.5592198371887207
local_output_nid generation:  0.03851008415222168
local_in_edges_tensor generation:  0.04528188705444336
mini_batch_src_global generation:  0.06837773323059082
r_  generation:  0.5908124446868896
local_output_nid generation:  0.040459632873535156
local_in_edges_tensor generation:  0.05533313751220703
mini_batch_src_global generation:  0.06789183616638184
r_  generation:  0.5776369571685791
----------------------check_connections_block total spend ----------------------------- 3.4261162281036377
generate_one_block  0.756328821182251
generate_one_block  0.7630462646484375
generate_one_block  0.7440447807312012
generate_one_block  0.7398414611816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043456077575683594
gen group dst list time:  0.029474735260009766
time for parepare:  0.020235538482666016
local_output_nid generation:  0.03493857383728027
local_in_edges_tensor generation:  0.05870223045349121
mini_batch_src_global generation:  0.051885128021240234
r_  generation:  0.5662829875946045
local_output_nid generation:  0.038838863372802734
local_in_edges_tensor generation:  0.04128766059875488
mini_batch_src_global generation:  0.0630791187286377
r_  generation:  0.5569150447845459
local_output_nid generation:  0.03891706466674805
local_in_edges_tensor generation:  0.04661703109741211
mini_batch_src_global generation:  0.06552982330322266
r_  generation:  0.5570459365844727
local_output_nid generation:  0.043669700622558594
local_in_edges_tensor generation:  0.05284380912780762
mini_batch_src_global generation:  0.08162498474121094
r_  generation:  0.5753092765808105
----------------------check_connections_block total spend ----------------------------- 3.422605514526367
generate_one_block  0.7623822689056396
generate_one_block  0.7354598045349121
generate_one_block  0.7178037166595459
generate_one_block  0.7481827735900879
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03684544563293457
gen group dst list time:  0.024990081787109375
time for parepare:  0.019710063934326172
local_output_nid generation:  0.03395700454711914
local_in_edges_tensor generation:  0.05031394958496094
mini_batch_src_global generation:  0.04674935340881348
r_  generation:  0.5133135318756104
local_output_nid generation:  0.0409703254699707
local_in_edges_tensor generation:  0.05532097816467285
mini_batch_src_global generation:  0.05885195732116699
r_  generation:  0.5206196308135986
local_output_nid generation:  0.0437772274017334
local_in_edges_tensor generation:  0.054335594177246094
mini_batch_src_global generation:  0.05930137634277344
r_  generation:  0.5402765274047852
local_output_nid generation:  0.0438840389251709
local_in_edges_tensor generation:  0.050390005111694336
mini_batch_src_global generation:  0.059885501861572266
r_  generation:  0.5158669948577881
----------------------check_connections_block total spend ----------------------------- 3.2076966762542725
generate_one_block  0.685737133026123
generate_one_block  0.6805617809295654
generate_one_block  0.6773214340209961
generate_one_block  0.6745631694793701
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.22719240188598633  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

connection checking time:  12.572912216186523
block generation total time  11.04027247428894
average batch blocks generation time:  2.760068118572235
block dataloader generation time/epoch 26.23201584815979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.1358475685119629  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

torch.Size([167456, 128])
torch.Size([166911, 32])
torch.Size([164904, 32])
torch.Size([154953, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 21.391502380371094  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.1356220245361328  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

torch.Size([167423, 128])
torch.Size([166905, 32])
torch.Size([164771, 32])
torch.Size([154946, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 21.41002082824707  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.13586664199829102  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

torch.Size([167436, 128])
torch.Size([166880, 32])
torch.Size([164795, 32])
torch.Size([154833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 21.394981861114502  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 0.1356186866760254  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

torch.Size([167418, 128])
torch.Size([166864, 32])
torch.Size([164800, 32])
torch.Size([155026, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2557373046875 GB
    Memory Allocated: 21.412452220916748  GigaBytes
Max Memory Allocated: 21.446338176727295  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045389771461486816 |0.04522705078125 |0.46474558115005493 |0.0001093149185180664 |0.6576587557792664 |0.008092164993286133 |
----------------------------------------------------------pseudo_mini_loss sum 4.029879570007324
Total (block generation + training)time/epoch 31.115923166275024
Training time/epoch 4.883634805679321
Training time without block to device /epoch 4.702726602554321
Training time without total dataloading part /epoch 4.4981467723846436
load block tensor time/epoch 0.18155908584594727
block to device time/epoch 0.180908203125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3021615
Number of first layer input nodes during this epoch:  669733
