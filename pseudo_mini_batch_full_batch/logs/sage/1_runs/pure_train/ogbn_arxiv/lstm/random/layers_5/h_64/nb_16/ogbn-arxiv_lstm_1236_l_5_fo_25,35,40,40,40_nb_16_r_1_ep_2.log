Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648502439.4130294
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02473902702331543
random selection method range initialization spend 0.006345510482788086
time for parepare:  0.018535852432250977
local_output_nid generation:  0.0021855831146240234
local_in_edges_tensor generation:  0.0047566890716552734
mini_batch_src_global generation:  0.0017940998077392578
r_  generation:  0.01798725128173828
local_output_nid generation:  0.0025148391723632812
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.002087116241455078
r_  generation:  0.017374038696289062
local_output_nid generation:  0.0027823448181152344
local_in_edges_tensor generation:  0.0016407966613769531
mini_batch_src_global generation:  0.0014023780822753906
r_  generation:  0.01783013343811035
local_output_nid generation:  0.0028285980224609375
local_in_edges_tensor generation:  0.0015773773193359375
mini_batch_src_global generation:  0.00860452651977539
r_  generation:  0.01763010025024414
local_output_nid generation:  0.0028481483459472656
local_in_edges_tensor generation:  0.0014955997467041016
mini_batch_src_global generation:  0.001359701156616211
r_  generation:  0.017388105392456055
local_output_nid generation:  0.0028357505798339844
local_in_edges_tensor generation:  0.0014731884002685547
mini_batch_src_global generation:  0.0014317035675048828
r_  generation:  0.01813483238220215
local_output_nid generation:  0.0028417110443115234
local_in_edges_tensor generation:  0.0014846324920654297
mini_batch_src_global generation:  0.0014290809631347656
r_  generation:  0.017845869064331055
local_output_nid generation:  0.0028209686279296875
local_in_edges_tensor generation:  0.0014579296112060547
mini_batch_src_global generation:  0.0014727115631103516
r_  generation:  0.01862168312072754
local_output_nid generation:  0.002822399139404297
local_in_edges_tensor generation:  0.0014836788177490234
mini_batch_src_global generation:  0.0014615058898925781
r_  generation:  0.01848459243774414
local_output_nid generation:  0.0028328895568847656
local_in_edges_tensor generation:  0.0015451908111572266
mini_batch_src_global generation:  0.0014710426330566406
r_  generation:  0.01813364028930664
local_output_nid generation:  0.002856731414794922
local_in_edges_tensor generation:  0.0014858245849609375
mini_batch_src_global generation:  0.0014460086822509766
r_  generation:  0.01842951774597168
local_output_nid generation:  0.002827167510986328
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0014560222625732422
r_  generation:  0.018457651138305664
local_output_nid generation:  0.002898693084716797
local_in_edges_tensor generation:  0.0014574527740478516
mini_batch_src_global generation:  0.0014414787292480469
r_  generation:  0.01811695098876953
local_output_nid generation:  0.0029180049896240234
local_in_edges_tensor generation:  0.0014810562133789062
mini_batch_src_global generation:  0.001504659652709961
r_  generation:  0.0186612606048584
local_output_nid generation:  0.002880096435546875
local_in_edges_tensor generation:  0.0015158653259277344
mini_batch_src_global generation:  0.0015153884887695312
r_  generation:  0.019082069396972656
local_output_nid generation:  0.002893209457397461
local_in_edges_tensor generation:  0.0014925003051757812
mini_batch_src_global generation:  0.0015189647674560547
r_  generation:  0.019044876098632812
----------------------check_connections_block total spend ----------------------------- 0.4893310070037842
generate_one_block  0.027579784393310547
generate_one_block  0.027207374572753906
generate_one_block  0.027870655059814453
generate_one_block  0.030516386032104492
generate_one_block  0.027599811553955078
generate_one_block  0.02769327163696289
generate_one_block  0.028229713439941406
generate_one_block  0.029129981994628906
generate_one_block  0.028244733810424805
generate_one_block  0.027338743209838867
generate_one_block  0.027683496475219727
generate_one_block  0.026987075805664062
generate_one_block  0.026549577713012695
generate_one_block  0.027673721313476562
generate_one_block  0.028015613555908203
generate_one_block  0.027410030364990234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03985261917114258
gen group dst list time:  0.018712759017944336
time for parepare:  0.01967310905456543
local_output_nid generation:  0.00818014144897461
local_in_edges_tensor generation:  0.017715930938720703
mini_batch_src_global generation:  0.019248247146606445
r_  generation:  0.1987476348876953
local_output_nid generation:  0.014315366744995117
local_in_edges_tensor generation:  0.020811796188354492
mini_batch_src_global generation:  0.024364233016967773
r_  generation:  0.20093345642089844
local_output_nid generation:  0.014756917953491211
local_in_edges_tensor generation:  0.019256591796875
mini_batch_src_global generation:  0.02417922019958496
r_  generation:  0.2136228084564209
local_output_nid generation:  0.014587640762329102
local_in_edges_tensor generation:  0.019493818283081055
mini_batch_src_global generation:  0.02515697479248047
r_  generation:  0.21296405792236328
local_output_nid generation:  0.014393091201782227
local_in_edges_tensor generation:  0.0135650634765625
mini_batch_src_global generation:  0.026824474334716797
r_  generation:  0.20987725257873535
local_output_nid generation:  0.014682531356811523
local_in_edges_tensor generation:  0.013546466827392578
mini_batch_src_global generation:  0.027965784072875977
r_  generation:  0.21283435821533203
local_output_nid generation:  0.014381647109985352
local_in_edges_tensor generation:  0.017090320587158203
mini_batch_src_global generation:  0.030792951583862305
r_  generation:  0.214308500289917
local_output_nid generation:  0.01475214958190918
local_in_edges_tensor generation:  0.017737865447998047
mini_batch_src_global generation:  0.026842832565307617
r_  generation:  0.21948814392089844
local_output_nid generation:  0.014703512191772461
local_in_edges_tensor generation:  0.017541170120239258
mini_batch_src_global generation:  0.02716517448425293
r_  generation:  0.21725797653198242
local_output_nid generation:  0.014444828033447266
local_in_edges_tensor generation:  0.013856649398803711
mini_batch_src_global generation:  0.0267789363861084
r_  generation:  0.21148920059204102
local_output_nid generation:  0.014653444290161133
local_in_edges_tensor generation:  0.013206243515014648
mini_batch_src_global generation:  0.02674412727355957
r_  generation:  0.23337793350219727
local_output_nid generation:  0.01439976692199707
local_in_edges_tensor generation:  0.01880335807800293
mini_batch_src_global generation:  0.027291536331176758
r_  generation:  0.21444058418273926
local_output_nid generation:  0.014505863189697266
local_in_edges_tensor generation:  0.014063119888305664
mini_batch_src_global generation:  0.027077674865722656
r_  generation:  0.21678733825683594
local_output_nid generation:  0.014603137969970703
local_in_edges_tensor generation:  0.013257741928100586
mini_batch_src_global generation:  0.026967287063598633
r_  generation:  0.2117912769317627
local_output_nid generation:  0.014815092086791992
local_in_edges_tensor generation:  0.017348766326904297
mini_batch_src_global generation:  0.03206968307495117
r_  generation:  0.2252514362335205
local_output_nid generation:  0.01462411880493164
local_in_edges_tensor generation:  0.015230655670166016
mini_batch_src_global generation:  0.027867794036865234
r_  generation:  0.21773719787597656
----------------------check_connections_block total spend ----------------------------- 5.1178154945373535
generate_one_block  0.2815990447998047
generate_one_block  0.27616381645202637
generate_one_block  0.2893562316894531
generate_one_block  0.2867751121520996
generate_one_block  0.2947547435760498
generate_one_block  0.27757978439331055
generate_one_block  0.27481770515441895
generate_one_block  0.2876749038696289
generate_one_block  0.2825126647949219
generate_one_block  0.27313733100891113
generate_one_block  0.2757859230041504
generate_one_block  0.28246355056762695
generate_one_block  0.27550554275512695
generate_one_block  0.2760941982269287
generate_one_block  0.29306554794311523
generate_one_block  0.2813453674316406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03780722618103027
gen group dst list time:  0.05922055244445801
time for parepare:  0.01878833770751953
local_output_nid generation:  0.024898767471313477
local_in_edges_tensor generation:  0.042371511459350586
mini_batch_src_global generation:  0.05023002624511719
r_  generation:  0.4850428104400635
local_output_nid generation:  0.03277158737182617
local_in_edges_tensor generation:  0.04801607131958008
mini_batch_src_global generation:  0.07401323318481445
r_  generation:  0.505615234375
local_output_nid generation:  0.03083348274230957
local_in_edges_tensor generation:  0.04035162925720215
mini_batch_src_global generation:  0.06023740768432617
r_  generation:  0.5054740905761719
local_output_nid generation:  0.03091573715209961
local_in_edges_tensor generation:  0.04129981994628906
mini_batch_src_global generation:  0.05953240394592285
r_  generation:  0.5180690288543701
local_output_nid generation:  0.03579568862915039
local_in_edges_tensor generation:  0.05877518653869629
mini_batch_src_global generation:  0.08124518394470215
r_  generation:  0.5062408447265625
local_output_nid generation:  0.032924652099609375
local_in_edges_tensor generation:  0.03964352607727051
mini_batch_src_global generation:  0.05938410758972168
r_  generation:  0.5077297687530518
local_output_nid generation:  0.03180527687072754
local_in_edges_tensor generation:  0.0409398078918457
mini_batch_src_global generation:  0.059564828872680664
r_  generation:  0.5087659358978271
local_output_nid generation:  0.03179502487182617
local_in_edges_tensor generation:  0.03437471389770508
mini_batch_src_global generation:  0.06312417984008789
r_  generation:  0.518775224685669
local_output_nid generation:  0.03528738021850586
local_in_edges_tensor generation:  0.039205312728881836
mini_batch_src_global generation:  0.05964779853820801
r_  generation:  0.5159356594085693
local_output_nid generation:  0.032578229904174805
local_in_edges_tensor generation:  0.04303741455078125
mini_batch_src_global generation:  0.08436846733093262
r_  generation:  0.5063560009002686
local_output_nid generation:  0.03338623046875
local_in_edges_tensor generation:  0.03824973106384277
mini_batch_src_global generation:  0.058503150939941406
r_  generation:  0.5143470764160156
local_output_nid generation:  0.03241419792175293
local_in_edges_tensor generation:  0.04804039001464844
mini_batch_src_global generation:  0.058943748474121094
r_  generation:  0.5065114498138428
local_output_nid generation:  0.03174257278442383
local_in_edges_tensor generation:  0.03175497055053711
mini_batch_src_global generation:  0.05939984321594238
r_  generation:  0.5114083290100098
local_output_nid generation:  0.03330636024475098
local_in_edges_tensor generation:  0.03443121910095215
mini_batch_src_global generation:  0.06190037727355957
r_  generation:  0.5061385631561279
local_output_nid generation:  0.03174901008605957
local_in_edges_tensor generation:  0.04431033134460449
mini_batch_src_global generation:  0.06942129135131836
r_  generation:  0.5101685523986816
local_output_nid generation:  0.03455662727355957
local_in_edges_tensor generation:  0.0430448055267334
mini_batch_src_global generation:  0.06245827674865723
r_  generation:  0.503302812576294
----------------------check_connections_block total spend ----------------------------- 12.13110876083374
generate_one_block  0.7022171020507812
generate_one_block  0.6723370552062988
generate_one_block  0.6784660816192627
generate_one_block  0.6569852828979492
generate_one_block  0.6391191482543945
generate_one_block  0.6463990211486816
generate_one_block  0.7061705589294434
generate_one_block  0.6625850200653076
generate_one_block  0.6707532405853271
generate_one_block  0.6473782062530518
generate_one_block  0.6658725738525391
generate_one_block  0.6519012451171875
generate_one_block  0.6324577331542969
generate_one_block  0.6316235065460205
generate_one_block  0.6536970138549805
generate_one_block  0.6707868576049805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04578828811645508
gen group dst list time:  0.09818363189697266
time for parepare:  0.01959061622619629
local_output_nid generation:  0.03428077697753906
local_in_edges_tensor generation:  0.06055927276611328
mini_batch_src_global generation:  0.05057382583618164
r_  generation:  0.5256922245025635
local_output_nid generation:  0.03867793083190918
local_in_edges_tensor generation:  0.057781219482421875
mini_batch_src_global generation:  0.06302618980407715
r_  generation:  0.5415315628051758
local_output_nid generation:  0.03828835487365723
local_in_edges_tensor generation:  0.04878401756286621
mini_batch_src_global generation:  0.0588381290435791
r_  generation:  0.5381166934967041
local_output_nid generation:  0.0378572940826416
local_in_edges_tensor generation:  0.04329276084899902
mini_batch_src_global generation:  0.05836081504821777
r_  generation:  0.5465784072875977
local_output_nid generation:  0.0378718376159668
local_in_edges_tensor generation:  0.04611039161682129
mini_batch_src_global generation:  0.05948948860168457
r_  generation:  0.5427944660186768
local_output_nid generation:  0.0376584529876709
local_in_edges_tensor generation:  0.05296921730041504
mini_batch_src_global generation:  0.05771589279174805
r_  generation:  0.5452919006347656
local_output_nid generation:  0.038664817810058594
local_in_edges_tensor generation:  0.04380011558532715
mini_batch_src_global generation:  0.05922532081604004
r_  generation:  0.5460710525512695
local_output_nid generation:  0.03827023506164551
local_in_edges_tensor generation:  0.03825950622558594
mini_batch_src_global generation:  0.0585474967956543
r_  generation:  0.552539587020874
local_output_nid generation:  0.038306474685668945
local_in_edges_tensor generation:  0.04157590866088867
mini_batch_src_global generation:  0.05973243713378906
r_  generation:  0.554882287979126
local_output_nid generation:  0.0384218692779541
local_in_edges_tensor generation:  0.043825387954711914
mini_batch_src_global generation:  0.060307979583740234
r_  generation:  0.5569605827331543
local_output_nid generation:  0.038500070571899414
local_in_edges_tensor generation:  0.048825740814208984
mini_batch_src_global generation:  0.06023716926574707
r_  generation:  0.5557279586791992
local_output_nid generation:  0.03847861289978027
local_in_edges_tensor generation:  0.039208412170410156
mini_batch_src_global generation:  0.06091141700744629
r_  generation:  0.5590910911560059
local_output_nid generation:  0.038381099700927734
local_in_edges_tensor generation:  0.043193817138671875
mini_batch_src_global generation:  0.06457209587097168
r_  generation:  0.5592002868652344
local_output_nid generation:  0.03846001625061035
local_in_edges_tensor generation:  0.03850364685058594
mini_batch_src_global generation:  0.06005120277404785
r_  generation:  0.5623779296875
local_output_nid generation:  0.0382227897644043
local_in_edges_tensor generation:  0.05763864517211914
mini_batch_src_global generation:  0.06235337257385254
r_  generation:  0.5595409870147705
local_output_nid generation:  0.03869915008544922
local_in_edges_tensor generation:  0.05697345733642578
mini_batch_src_global generation:  0.07455062866210938
r_  generation:  0.5581538677215576
----------------------check_connections_block total spend ----------------------------- 13.234679222106934
generate_one_block  0.6793675422668457
generate_one_block  0.6943526268005371
generate_one_block  0.7701404094696045
generate_one_block  0.6716032028198242
generate_one_block  0.6918580532073975
generate_one_block  0.7030956745147705
generate_one_block  0.6808230876922607
generate_one_block  0.6692094802856445
generate_one_block  0.7015163898468018
generate_one_block  0.6765153408050537
generate_one_block  0.7005782127380371
generate_one_block  0.6772353649139404
generate_one_block  0.6762223243713379
generate_one_block  0.6732199192047119
generate_one_block  0.6839439868927002
generate_one_block  0.6843082904815674
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05507326126098633
gen group dst list time:  0.0925748348236084
time for parepare:  0.01929330825805664
local_output_nid generation:  0.035917043685913086
local_in_edges_tensor generation:  0.05635881423950195
mini_batch_src_global generation:  0.04510331153869629
r_  generation:  0.5008394718170166
local_output_nid generation:  0.04280686378479004
local_in_edges_tensor generation:  0.036432743072509766
mini_batch_src_global generation:  0.05747365951538086
r_  generation:  0.5116117000579834
local_output_nid generation:  0.04018044471740723
local_in_edges_tensor generation:  0.03978776931762695
mini_batch_src_global generation:  0.05754685401916504
r_  generation:  0.5143485069274902
local_output_nid generation:  0.03993391990661621
local_in_edges_tensor generation:  0.03920769691467285
mini_batch_src_global generation:  0.05716133117675781
r_  generation:  0.5048468112945557
local_output_nid generation:  0.04009604454040527
local_in_edges_tensor generation:  0.042118072509765625
mini_batch_src_global generation:  0.05720376968383789
r_  generation:  0.507953405380249
local_output_nid generation:  0.04014110565185547
local_in_edges_tensor generation:  0.04100322723388672
mini_batch_src_global generation:  0.05682992935180664
r_  generation:  0.5115234851837158
local_output_nid generation:  0.04015040397644043
local_in_edges_tensor generation:  0.04127311706542969
mini_batch_src_global generation:  0.0569767951965332
r_  generation:  0.5134973526000977
local_output_nid generation:  0.04022669792175293
local_in_edges_tensor generation:  0.045870304107666016
mini_batch_src_global generation:  0.056984663009643555
r_  generation:  0.5109343528747559
local_output_nid generation:  0.039960622787475586
local_in_edges_tensor generation:  0.042176008224487305
mini_batch_src_global generation:  0.05659794807434082
r_  generation:  0.5144710540771484
local_output_nid generation:  0.04151725769042969
local_in_edges_tensor generation:  0.04832339286804199
mini_batch_src_global generation:  0.05645251274108887
r_  generation:  0.5146660804748535
local_output_nid generation:  0.04039502143859863
local_in_edges_tensor generation:  0.041236162185668945
mini_batch_src_global generation:  0.0604090690612793
r_  generation:  0.5214812755584717
local_output_nid generation:  0.040377140045166016
local_in_edges_tensor generation:  0.04153013229370117
mini_batch_src_global generation:  0.0565645694732666
r_  generation:  0.5189106464385986
local_output_nid generation:  0.04185175895690918
local_in_edges_tensor generation:  0.0420374870300293
mini_batch_src_global generation:  0.06070566177368164
r_  generation:  0.517437219619751
local_output_nid generation:  0.04071974754333496
local_in_edges_tensor generation:  0.03781867027282715
mini_batch_src_global generation:  0.057776689529418945
r_  generation:  0.5218162536621094
local_output_nid generation:  0.04044032096862793
local_in_edges_tensor generation:  0.04474997520446777
mini_batch_src_global generation:  0.060048818588256836
r_  generation:  0.5188169479370117
local_output_nid generation:  0.04029965400695801
local_in_edges_tensor generation:  0.045598745346069336
mini_batch_src_global generation:  0.056729793548583984
r_  generation:  0.5227739810943604
----------------------check_connections_block total spend ----------------------------- 12.40856146812439
generate_one_block  0.6335580348968506
generate_one_block  0.6286489963531494
generate_one_block  0.6417703628540039
generate_one_block  0.6403214931488037
generate_one_block  0.6373953819274902
generate_one_block  0.7144474983215332
generate_one_block  0.6389119625091553
generate_one_block  0.6268723011016846
generate_one_block  0.6451151371002197
generate_one_block  0.6289763450622559
generate_one_block  0.6468093395233154
generate_one_block  0.6389594078063965
generate_one_block  0.627485990524292
generate_one_block  0.6416218280792236
generate_one_block  0.64569091796875
generate_one_block  0.6492140293121338
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

connection checking time:  42.89216494560242
block generation total time  36.41717004776001
average batch blocks generation time:  2.2760731279850006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12279558181762695  GigaBytes
Max Memory Allocated: 0.12279558181762695  GigaBytes

torch.Size([166165, 128])
torch.Size([163865, 64])
torch.Size([155737, 64])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.37 GiB already allocated; 8.44 MiB free; 22.41 GiB reserved in total by PyTorch)
