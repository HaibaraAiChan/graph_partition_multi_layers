Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648460032.6170483
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02494502067565918
random selection method range initialization spend 0.0063593387603759766
time for parepare:  0.018723249435424805
local_output_nid generation:  0.002141237258911133
local_in_edges_tensor generation:  0.004703521728515625
mini_batch_src_global generation:  0.0017518997192382812
r_  generation:  0.017864227294921875
local_output_nid generation:  0.0025129318237304688
local_in_edges_tensor generation:  0.0016849040985107422
mini_batch_src_global generation:  0.0020890235900878906
r_  generation:  0.017974138259887695
local_output_nid generation:  0.0027420520782470703
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.0014302730560302734
r_  generation:  0.017524003982543945
local_output_nid generation:  0.0027794837951660156
local_in_edges_tensor generation:  0.0015149116516113281
mini_batch_src_global generation:  0.0013911724090576172
r_  generation:  0.01764369010925293
local_output_nid generation:  0.0027942657470703125
local_in_edges_tensor generation:  0.0014777183532714844
mini_batch_src_global generation:  0.0013699531555175781
r_  generation:  0.0182187557220459
local_output_nid generation:  0.002838134765625
local_in_edges_tensor generation:  0.0015332698822021484
mini_batch_src_global generation:  0.0014767646789550781
r_  generation:  0.018554210662841797
local_output_nid generation:  0.002849102020263672
local_in_edges_tensor generation:  0.0014753341674804688
mini_batch_src_global generation:  0.0014393329620361328
r_  generation:  0.01860332489013672
local_output_nid generation:  0.0028438568115234375
local_in_edges_tensor generation:  0.0015218257904052734
mini_batch_src_global generation:  0.0015027523040771484
r_  generation:  0.01809859275817871
local_output_nid generation:  0.0027823448181152344
local_in_edges_tensor generation:  0.0015132427215576172
mini_batch_src_global generation:  0.0014030933380126953
r_  generation:  0.017786741256713867
local_output_nid generation:  0.0027616024017333984
local_in_edges_tensor generation:  0.0014655590057373047
mini_batch_src_global generation:  0.0014731884002685547
r_  generation:  0.018626689910888672
local_output_nid generation:  0.002783536911010742
local_in_edges_tensor generation:  0.0014166831970214844
mini_batch_src_global generation:  0.0014934539794921875
r_  generation:  0.018805980682373047
local_output_nid generation:  0.0028634071350097656
local_in_edges_tensor generation:  0.001468658447265625
mini_batch_src_global generation:  0.0014684200286865234
r_  generation:  0.018657445907592773
local_output_nid generation:  0.00281524658203125
local_in_edges_tensor generation:  0.001481771469116211
mini_batch_src_global generation:  0.0014803409576416016
r_  generation:  0.0184633731842041
local_output_nid generation:  0.0028548240661621094
local_in_edges_tensor generation:  0.0015139579772949219
mini_batch_src_global generation:  0.00152587890625
r_  generation:  0.01902008056640625
local_output_nid generation:  0.0028357505798339844
local_in_edges_tensor generation:  0.0014514923095703125
mini_batch_src_global generation:  0.0015158653259277344
r_  generation:  0.01899886131286621
local_output_nid generation:  0.002888202667236328
local_in_edges_tensor generation:  0.0014872550964355469
mini_batch_src_global generation:  0.0015711784362792969
r_  generation:  0.01894545555114746
----------------------check_connections_block total spend ----------------------------- 0.48491382598876953
generate_one_block  0.02722954750061035
generate_one_block  0.02798318862915039
generate_one_block  0.030495405197143555
generate_one_block  0.028218746185302734
generate_one_block  0.0280606746673584
generate_one_block  0.028069019317626953
generate_one_block  0.027759552001953125
generate_one_block  0.027109384536743164
generate_one_block  0.026673078536987305
generate_one_block  0.02822589874267578
generate_one_block  0.027651071548461914
generate_one_block  0.02804112434387207
generate_one_block  0.02739691734313965
generate_one_block  0.027999401092529297
generate_one_block  0.02771472930908203
generate_one_block  0.028102397918701172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.040361881256103516
gen group dst list time:  0.01888585090637207
time for parepare:  0.01945781707763672
local_output_nid generation:  0.00820469856262207
local_in_edges_tensor generation:  0.017533540725708008
mini_batch_src_global generation:  0.018909931182861328
r_  generation:  0.19106197357177734
local_output_nid generation:  0.014255046844482422
local_in_edges_tensor generation:  0.020434856414794922
mini_batch_src_global generation:  0.02383708953857422
r_  generation:  0.19478273391723633
local_output_nid generation:  0.014545440673828125
local_in_edges_tensor generation:  0.01665782928466797
mini_batch_src_global generation:  0.023222923278808594
r_  generation:  0.20115876197814941
local_output_nid generation:  0.014490842819213867
local_in_edges_tensor generation:  0.016346454620361328
mini_batch_src_global generation:  0.024207115173339844
r_  generation:  0.20310330390930176
local_output_nid generation:  0.014644145965576172
local_in_edges_tensor generation:  0.015059471130371094
mini_batch_src_global generation:  0.027165889739990234
r_  generation:  0.21060705184936523
local_output_nid generation:  0.014575719833374023
local_in_edges_tensor generation:  0.014839410781860352
mini_batch_src_global generation:  0.025983095169067383
r_  generation:  0.2094573974609375
local_output_nid generation:  0.01436471939086914
local_in_edges_tensor generation:  0.015283584594726562
mini_batch_src_global generation:  0.02582097053527832
r_  generation:  0.20559978485107422
local_output_nid generation:  0.014462709426879883
local_in_edges_tensor generation:  0.014748334884643555
mini_batch_src_global generation:  0.026185989379882812
r_  generation:  0.203995943069458
local_output_nid generation:  0.01448822021484375
local_in_edges_tensor generation:  0.016483545303344727
mini_batch_src_global generation:  0.025574922561645508
r_  generation:  0.20309114456176758
local_output_nid generation:  0.014579296112060547
local_in_edges_tensor generation:  0.015076160430908203
mini_batch_src_global generation:  0.026769399642944336
r_  generation:  0.21030020713806152
local_output_nid generation:  0.014729499816894531
local_in_edges_tensor generation:  0.014504671096801758
mini_batch_src_global generation:  0.02612757682800293
r_  generation:  0.20788216590881348
local_output_nid generation:  0.014487266540527344
local_in_edges_tensor generation:  0.014693021774291992
mini_batch_src_global generation:  0.02661442756652832
r_  generation:  0.2074265480041504
local_output_nid generation:  0.01445913314819336
local_in_edges_tensor generation:  0.014521360397338867
mini_batch_src_global generation:  0.026204824447631836
r_  generation:  0.2080225944519043
local_output_nid generation:  0.01470494270324707
local_in_edges_tensor generation:  0.014680147171020508
mini_batch_src_global generation:  0.028110027313232422
r_  generation:  0.20981884002685547
local_output_nid generation:  0.01442408561706543
local_in_edges_tensor generation:  0.014842033386230469
mini_batch_src_global generation:  0.025975704193115234
r_  generation:  0.20647120475769043
local_output_nid generation:  0.014644622802734375
local_in_edges_tensor generation:  0.014685869216918945
mini_batch_src_global generation:  0.02801799774169922
r_  generation:  0.2095487117767334
----------------------check_connections_block total spend ----------------------------- 4.912890672683716
generate_one_block  0.272036075592041
generate_one_block  0.26606273651123047
generate_one_block  0.2718348503112793
generate_one_block  0.2732508182525635
generate_one_block  0.28777527809143066
generate_one_block  0.27359914779663086
generate_one_block  0.2648148536682129
generate_one_block  0.2630009651184082
generate_one_block  0.26459431648254395
generate_one_block  0.2707333564758301
generate_one_block  0.2729499340057373
generate_one_block  0.27055859565734863
generate_one_block  0.26586413383483887
generate_one_block  0.27114248275756836
generate_one_block  0.2718076705932617
generate_one_block  0.2740664482116699
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.032694101333618164
gen group dst list time:  0.058994293212890625
time for parepare:  0.01946258544921875
local_output_nid generation:  0.02574467658996582
local_in_edges_tensor generation:  0.03909468650817871
mini_batch_src_global generation:  0.04058218002319336
r_  generation:  0.4359736442565918
local_output_nid generation:  0.035674095153808594
local_in_edges_tensor generation:  0.048116445541381836
mini_batch_src_global generation:  0.05005645751953125
r_  generation:  0.4384176731109619
local_output_nid generation:  0.03517317771911621
local_in_edges_tensor generation:  0.03608822822570801
mini_batch_src_global generation:  0.052715301513671875
r_  generation:  0.44547152519226074
local_output_nid generation:  0.03560972213745117
local_in_edges_tensor generation:  0.03651285171508789
mini_batch_src_global generation:  0.05081677436828613
r_  generation:  0.44730710983276367
local_output_nid generation:  0.035271644592285156
local_in_edges_tensor generation:  0.03650379180908203
mini_batch_src_global generation:  0.050691843032836914
r_  generation:  0.44696569442749023
local_output_nid generation:  0.03535914421081543
local_in_edges_tensor generation:  0.036051273345947266
mini_batch_src_global generation:  0.05227851867675781
r_  generation:  0.446002721786499
local_output_nid generation:  0.035277605056762695
local_in_edges_tensor generation:  0.04082894325256348
mini_batch_src_global generation:  0.05175209045410156
r_  generation:  0.4567270278930664
local_output_nid generation:  0.03551435470581055
local_in_edges_tensor generation:  0.03225517272949219
mini_batch_src_global generation:  0.052457332611083984
r_  generation:  0.44562268257141113
local_output_nid generation:  0.03542637825012207
local_in_edges_tensor generation:  0.03259849548339844
mini_batch_src_global generation:  0.05238747596740723
r_  generation:  0.45536208152770996
local_output_nid generation:  0.035529375076293945
local_in_edges_tensor generation:  0.04190969467163086
mini_batch_src_global generation:  0.05263257026672363
r_  generation:  0.45250654220581055
local_output_nid generation:  0.03565263748168945
local_in_edges_tensor generation:  0.03644418716430664
mini_batch_src_global generation:  0.05256080627441406
r_  generation:  0.46161532402038574
local_output_nid generation:  0.035216331481933594
local_in_edges_tensor generation:  0.03256940841674805
mini_batch_src_global generation:  0.05375981330871582
r_  generation:  0.4478633403778076
local_output_nid generation:  0.03536510467529297
local_in_edges_tensor generation:  0.036223411560058594
mini_batch_src_global generation:  0.05178236961364746
r_  generation:  0.45659780502319336
local_output_nid generation:  0.0356900691986084
local_in_edges_tensor generation:  0.04439711570739746
mini_batch_src_global generation:  0.05336809158325195
r_  generation:  0.4490196704864502
local_output_nid generation:  0.035036563873291016
local_in_edges_tensor generation:  0.035979270935058594
mini_batch_src_global generation:  0.05176830291748047
r_  generation:  0.45641016960144043
local_output_nid generation:  0.035115957260131836
local_in_edges_tensor generation:  0.0359349250793457
mini_batch_src_global generation:  0.05224418640136719
r_  generation:  0.45156192779541016
----------------------check_connections_block total spend ----------------------------- 10.734871625900269
generate_one_block  0.5708284378051758
generate_one_block  0.5721602439880371
generate_one_block  0.5747907161712646
generate_one_block  0.583857536315918
generate_one_block  0.5752749443054199
generate_one_block  0.605952262878418
generate_one_block  0.6615548133850098
generate_one_block  0.5876052379608154
generate_one_block  0.5974876880645752
generate_one_block  0.6125249862670898
generate_one_block  0.5981259346008301
generate_one_block  0.5870695114135742
generate_one_block  0.6109919548034668
generate_one_block  0.5986015796661377
generate_one_block  0.5830192565917969
generate_one_block  0.576775074005127
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  15.647762298583984
block generation total time  13.830711841583252
average batch blocks generation time:  0.8644194900989532
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09161901473999023  GigaBytes
Max Memory Allocated: 0.09161901473999023  GigaBytes

torch.Size([154501, 128])
torch.Size([122923, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6033935546875 GB
    Memory Allocated: 15.918825626373291  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2127685546875 GB
    Memory Allocated: 0.09366178512573242  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154647, 128])
torch.Size([122679, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2811279296875 GB
    Memory Allocated: 15.802992820739746  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2811279296875 GB
    Memory Allocated: 0.09421253204345703  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154501, 128])
torch.Size([122563, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2811279296875 GB
    Memory Allocated: 15.8635835647583  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 0.09365081787109375  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154474, 128])
torch.Size([122533, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 15.870939254760742  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 0.09425926208496094  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154166, 128])
torch.Size([122221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 15.916144371032715  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8885498046875 GB
    Memory Allocated: 0.09373712539672852  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154613, 128])
torch.Size([122564, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8885498046875 GB
    Memory Allocated: 15.881806373596191  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8885498046875 GB
    Memory Allocated: 0.09418106079101562  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154633, 128])
torch.Size([122891, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.845302104949951  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.0934152603149414  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154310, 128])
torch.Size([121951, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.713969230651855  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09402084350585938  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154446, 128])
torch.Size([122147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.708631992340088  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09368705749511719  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154524, 128])
torch.Size([122945, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.891890048980713  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.0941610336303711  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154542, 128])
torch.Size([122641, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.82928466796875  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09357261657714844  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154368, 128])
torch.Size([122271, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.873990535736084  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09407424926757812  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154300, 128])
torch.Size([121860, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.716105937957764  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.0936894416809082  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154557, 128])
torch.Size([122830, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.90776252746582  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09408950805664062  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154301, 128])
torch.Size([121787, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.708154201507568  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.0935831069946289  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154328, 128])
torch.Size([122453, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.894947528839111  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03971602022647858 |0.038632676005363464 |0.29965101182460785 |0.00010181963443756104 |0.37120482325553894 |0.005335807800292969 |
----------------------------------------------------------pseudo_mini_loss sum 4.995949745178223
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5091834
Number of first layer input nodes during this epoch:  2471211
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.1204690933227539  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.021927595138549805
random selection method range initialization spend 0.0049970149993896484
time for parepare:  0.018442153930664062
local_output_nid generation:  0.002682209014892578
local_in_edges_tensor generation:  0.004895448684692383
mini_batch_src_global generation:  0.0018069744110107422
r_  generation:  0.018275976181030273
local_output_nid generation:  0.003111600875854492
local_in_edges_tensor generation:  0.0017495155334472656
mini_batch_src_global generation:  0.0020856857299804688
r_  generation:  0.018443822860717773
local_output_nid generation:  0.0030968189239501953
local_in_edges_tensor generation:  0.0016245841979980469
mini_batch_src_global generation:  0.0013782978057861328
r_  generation:  0.01878976821899414
local_output_nid generation:  0.0030705928802490234
local_in_edges_tensor generation:  0.0015828609466552734
mini_batch_src_global generation:  0.0014338493347167969
r_  generation:  0.01897883415222168
local_output_nid generation:  0.0031251907348632812
local_in_edges_tensor generation:  0.0017261505126953125
mini_batch_src_global generation:  0.0014383792877197266
r_  generation:  0.018976211547851562
local_output_nid generation:  0.003080606460571289
local_in_edges_tensor generation:  0.001562356948852539
mini_batch_src_global generation:  0.0014476776123046875
r_  generation:  0.019124269485473633
local_output_nid generation:  0.0030846595764160156
local_in_edges_tensor generation:  0.001600027084350586
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.019324779510498047
local_output_nid generation:  0.003098011016845703
local_in_edges_tensor generation:  0.0015332698822021484
mini_batch_src_global generation:  0.0014820098876953125
r_  generation:  0.020015239715576172
local_output_nid generation:  0.0030946731567382812
local_in_edges_tensor generation:  0.001590728759765625
mini_batch_src_global generation:  0.0014295578002929688
r_  generation:  0.019742488861083984
local_output_nid generation:  0.003062725067138672
local_in_edges_tensor generation:  0.0015523433685302734
mini_batch_src_global generation:  0.0014946460723876953
r_  generation:  0.020051002502441406
local_output_nid generation:  0.003149271011352539
local_in_edges_tensor generation:  0.0016198158264160156
mini_batch_src_global generation:  0.0015079975128173828
r_  generation:  0.019952058792114258
local_output_nid generation:  0.0030961036682128906
local_in_edges_tensor generation:  0.0016171932220458984
mini_batch_src_global generation:  0.0015439987182617188
r_  generation:  0.0193178653717041
local_output_nid generation:  0.003070354461669922
local_in_edges_tensor generation:  0.001585245132446289
mini_batch_src_global generation:  0.001512765884399414
r_  generation:  0.019905805587768555
local_output_nid generation:  0.003128528594970703
local_in_edges_tensor generation:  0.0015256404876708984
mini_batch_src_global generation:  0.0015463829040527344
r_  generation:  0.019266366958618164
local_output_nid generation:  0.0030083656311035156
local_in_edges_tensor generation:  0.0016019344329833984
mini_batch_src_global generation:  0.0015728473663330078
r_  generation:  0.019790172576904297
local_output_nid generation:  0.0029964447021484375
local_in_edges_tensor generation:  0.0015404224395751953
mini_batch_src_global generation:  0.0015544891357421875
r_  generation:  0.020013809204101562
----------------------check_connections_block total spend ----------------------------- 0.514164924621582
generate_one_block  0.03849148750305176
generate_one_block  0.03079056739807129
generate_one_block  0.030705690383911133
generate_one_block  0.03009653091430664
generate_one_block  0.03087759017944336
generate_one_block  0.03388333320617676
generate_one_block  0.03181624412536621
generate_one_block  0.030875205993652344
generate_one_block  0.03023672103881836
generate_one_block  0.031005859375
generate_one_block  0.030792951583862305
generate_one_block  0.03045821189880371
generate_one_block  0.03103947639465332
generate_one_block  0.0305483341217041
generate_one_block  0.03121018409729004
generate_one_block  0.031384944915771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03635668754577637
gen group dst list time:  0.01778864860534668
time for parepare:  0.019127368927001953
local_output_nid generation:  0.009062051773071289
local_in_edges_tensor generation:  0.018415212631225586
mini_batch_src_global generation:  0.018803119659423828
r_  generation:  0.19199275970458984
local_output_nid generation:  0.013108491897583008
local_in_edges_tensor generation:  0.019025087356567383
mini_batch_src_global generation:  0.025720596313476562
r_  generation:  0.20300650596618652
local_output_nid generation:  0.012949228286743164
local_in_edges_tensor generation:  0.015514850616455078
mini_batch_src_global generation:  0.023472309112548828
r_  generation:  0.20643162727355957
local_output_nid generation:  0.013455629348754883
local_in_edges_tensor generation:  0.012113332748413086
mini_batch_src_global generation:  0.024258852005004883
r_  generation:  0.20573186874389648
local_output_nid generation:  0.01367640495300293
local_in_edges_tensor generation:  0.015687942504882812
mini_batch_src_global generation:  0.025557518005371094
r_  generation:  0.21381497383117676
local_output_nid generation:  0.013314008712768555
local_in_edges_tensor generation:  0.012293100357055664
mini_batch_src_global generation:  0.027808189392089844
r_  generation:  0.2068498134613037
local_output_nid generation:  0.012873172760009766
local_in_edges_tensor generation:  0.012422800064086914
mini_batch_src_global generation:  0.028424501419067383
r_  generation:  0.21040940284729004
local_output_nid generation:  0.01297450065612793
local_in_edges_tensor generation:  0.017208099365234375
mini_batch_src_global generation:  0.026162147521972656
r_  generation:  0.20992159843444824
local_output_nid generation:  0.012733936309814453
local_in_edges_tensor generation:  0.013634681701660156
mini_batch_src_global generation:  0.025478363037109375
r_  generation:  0.20735383033752441
local_output_nid generation:  0.013201475143432617
local_in_edges_tensor generation:  0.015606164932250977
mini_batch_src_global generation:  0.02920985221862793
r_  generation:  0.21795201301574707
local_output_nid generation:  0.012972116470336914
local_in_edges_tensor generation:  0.014087438583374023
mini_batch_src_global generation:  0.0267026424407959
r_  generation:  0.21435117721557617
local_output_nid generation:  0.012848615646362305
local_in_edges_tensor generation:  0.013998270034790039
mini_batch_src_global generation:  0.026531696319580078
r_  generation:  0.21045994758605957
local_output_nid generation:  0.013083219528198242
local_in_edges_tensor generation:  0.014019489288330078
mini_batch_src_global generation:  0.026396989822387695
r_  generation:  0.21130704879760742
local_output_nid generation:  0.01276087760925293
local_in_edges_tensor generation:  0.013943910598754883
mini_batch_src_global generation:  0.025998830795288086
r_  generation:  0.21360015869140625
local_output_nid generation:  0.012978792190551758
local_in_edges_tensor generation:  0.016687870025634766
mini_batch_src_global generation:  0.027451753616333008
r_  generation:  0.22671890258789062
local_output_nid generation:  0.016226768493652344
local_in_edges_tensor generation:  0.02038431167602539
mini_batch_src_global generation:  0.02692890167236328
r_  generation:  0.21274113655090332
----------------------check_connections_block total spend ----------------------------- 4.993142366409302
generate_one_block  0.28536295890808105
generate_one_block  0.2796139717102051
generate_one_block  0.2826352119445801
generate_one_block  0.29309749603271484
generate_one_block  0.29132652282714844
generate_one_block  0.28154659271240234
generate_one_block  0.31005120277404785
generate_one_block  0.2895779609680176
generate_one_block  0.2838172912597656
generate_one_block  0.29148292541503906
generate_one_block  0.2882704734802246
generate_one_block  0.288006067276001
generate_one_block  0.30013298988342285
generate_one_block  0.28217506408691406
generate_one_block  0.2850983142852783
generate_one_block  0.27867722511291504
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06668663024902344
gen group dst list time:  0.06940460205078125
time for parepare:  0.017372608184814453
local_output_nid generation:  0.02684926986694336
local_in_edges_tensor generation:  0.058681488037109375
mini_batch_src_global generation:  0.04144549369812012
r_  generation:  0.4313971996307373
local_output_nid generation:  0.030760526657104492
local_in_edges_tensor generation:  0.04492354393005371
mini_batch_src_global generation:  0.05121660232543945
r_  generation:  0.438488245010376
local_output_nid generation:  0.030725955963134766
local_in_edges_tensor generation:  0.03763246536254883
mini_batch_src_global generation:  0.05036640167236328
r_  generation:  0.448056697845459
local_output_nid generation:  0.04160809516906738
local_in_edges_tensor generation:  0.029497623443603516
mini_batch_src_global generation:  0.05458378791809082
r_  generation:  0.4570636749267578
local_output_nid generation:  0.03210306167602539
local_in_edges_tensor generation:  0.08897972106933594
mini_batch_src_global generation:  0.05414724349975586
r_  generation:  0.46671414375305176
local_output_nid generation:  0.03378176689147949
local_in_edges_tensor generation:  0.04975533485412598
mini_batch_src_global generation:  0.056982994079589844
r_  generation:  0.44161343574523926
local_output_nid generation:  0.03136610984802246
local_in_edges_tensor generation:  0.03485727310180664
mini_batch_src_global generation:  0.05474281311035156
r_  generation:  0.4500281810760498
local_output_nid generation:  0.03132224082946777
local_in_edges_tensor generation:  0.03748273849487305
mini_batch_src_global generation:  0.052095890045166016
r_  generation:  0.4536869525909424
local_output_nid generation:  0.03148531913757324
local_in_edges_tensor generation:  0.0330660343170166
mini_batch_src_global generation:  0.05217289924621582
r_  generation:  0.452282190322876
local_output_nid generation:  0.03157973289489746
local_in_edges_tensor generation:  0.03304910659790039
mini_batch_src_global generation:  0.055791616439819336
r_  generation:  0.46452951431274414
local_output_nid generation:  0.03250432014465332
local_in_edges_tensor generation:  0.03831601142883301
mini_batch_src_global generation:  0.05441141128540039
r_  generation:  0.47931909561157227
local_output_nid generation:  0.03452134132385254
local_in_edges_tensor generation:  0.0425107479095459
mini_batch_src_global generation:  0.0555729866027832
r_  generation:  0.4538905620574951
local_output_nid generation:  0.03203320503234863
local_in_edges_tensor generation:  0.03415632247924805
mini_batch_src_global generation:  0.05190300941467285
r_  generation:  0.46212053298950195
local_output_nid generation:  0.031960248947143555
local_in_edges_tensor generation:  0.028837203979492188
mini_batch_src_global generation:  0.053153276443481445
r_  generation:  0.4528977870941162
local_output_nid generation:  0.03159213066101074
local_in_edges_tensor generation:  0.035613298416137695
mini_batch_src_global generation:  0.05095958709716797
r_  generation:  0.45302271842956543
local_output_nid generation:  0.03199005126953125
local_in_edges_tensor generation:  0.03647279739379883
mini_batch_src_global generation:  0.054247140884399414
r_  generation:  0.4571342468261719
----------------------check_connections_block total spend ----------------------------- 10.89795184135437
generate_one_block  0.5924608707427979
generate_one_block  0.600651741027832
generate_one_block  0.5973718166351318
generate_one_block  0.5896697044372559
generate_one_block  0.6103003025054932
generate_one_block  0.5945541858673096
generate_one_block  0.5923914909362793
generate_one_block  0.5979924201965332
generate_one_block  0.6068887710571289
generate_one_block  0.5992641448974609
generate_one_block  0.5954749584197998
generate_one_block  0.580167293548584
generate_one_block  0.578118085861206
generate_one_block  0.5766968727111816
generate_one_block  0.5791454315185547
generate_one_block  0.5953934192657471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.1204690933227539  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

connection checking time:  15.891094207763672
block generation total time  14.097413778305054
average batch blocks generation time:  0.8810883611440659
block dataloader generation time/epoch 32.33226466178894
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09774255752563477  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154534, 128])
torch.Size([123037, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.9148850440979  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09704399108886719  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154310, 128])
torch.Size([122424, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.825664520263672  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09777450561523438  GigaBytes
Max Memory Allocated: 15.948034286499023  GigaBytes

torch.Size([154267, 128])
torch.Size([122374, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.921902656555176  GigaBytes
Max Memory Allocated: 15.952454090118408  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.0969552993774414  GigaBytes
Max Memory Allocated: 15.952454090118408  GigaBytes

torch.Size([154276, 128])
torch.Size([121943, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.739556789398193  GigaBytes
Max Memory Allocated: 15.952454090118408  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.09784889221191406  GigaBytes
Max Memory Allocated: 15.952454090118408  GigaBytes

torch.Size([154449, 128])
torch.Size([122733, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 15.991466522216797  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 0.09700965881347656  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

torch.Size([154314, 128])
torch.Size([122109, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 15.793261528015137  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 0.09768867492675781  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

torch.Size([154418, 128])
torch.Size([122621, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 15.836497783660889  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 0.09720468521118164  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

torch.Size([154533, 128])
torch.Size([122879, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 15.887885093688965  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 0.09752750396728516  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

torch.Size([154935, 128])
torch.Size([122500, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 15.683329582214355  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2498779296875 GB
    Memory Allocated: 0.09751033782958984  GigaBytes
Max Memory Allocated: 16.02185869216919  GigaBytes

torch.Size([154918, 128])
torch.Size([123429, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 16.033480644226074  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 0.0977621078491211  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

torch.Size([154743, 128])
torch.Size([122790, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 15.925786018371582  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 0.09699678421020508  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

torch.Size([154233, 128])
torch.Size([122229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 15.826229095458984  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 0.09766864776611328  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

torch.Size([154578, 128])
torch.Size([122552, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 15.820851802825928  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 0.09704923629760742  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

torch.Size([154517, 128])
torch.Size([122380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 15.73537826538086  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 0.097625732421875  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

torch.Size([154239, 128])
torch.Size([121873, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 15.766263484954834  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 0.0971217155456543  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

torch.Size([154389, 128])
torch.Size([122360, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9256591796875 GB
    Memory Allocated: 15.875500202178955  GigaBytes
Max Memory Allocated: 16.06389856338501  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.042309701442718506 |0.015664443373680115 |0.2531740814447403 |9.338557720184326e-05 |0.36030423641204834 |0.005607128143310547 |
----------------------------------------------------------pseudo_mini_loss sum 3.306464433670044
Total (block generation + training)time/epoch 43.11926031112671
Training time/epoch 10.786781311035156
Training time without block to device /epoch 10.536150217056274
Training time without total dataloading part /epoch 9.822754383087158
load block tensor time/epoch 0.6769552230834961
block to device time/epoch 0.25063109397888184
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5093569
Number of first layer input nodes during this epoch:  2471653
