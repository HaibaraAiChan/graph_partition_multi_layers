Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648725103.8667352
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

{'VmPeak': 20970.19921875, 'VmSize': 20970.19921875, 'VmHWM': 3746.33203125, 'VmRSS': 3746.33203125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024885892868041992
global_2_local 0.02805924415588379
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.010981082916259766
before graph partition 
		67991, 67389, 67435, 67672, 68987, 68131, 67882, 67893, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				11368, 11368, 11368, 11368, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.023205280303955078
	Initialize BitList time :  0.0017914772033691406
	getRedundancyCost: time   5.245208740234375e-06

					length of partitions 67991, 67389

	before terminate 1 the average redundancy rate is:  3.441740445789029
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.03805795130260137
			 the number of node to move is : 1623
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.4036824944864277,  3.1129726259859285,  3.6943923629869264
						 current side  1
			 redundancy will reduce  0.2897946472266888
			 the number of node to move is : 7655
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1519457985623403,  4.311658266545485,  1.9922333305791953
						 current side  0
			 redundancy will reduce  0.23035611005535817
			 the number of node to move is : 4274
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.211384335733671,  3.640445153458456,  2.7823235180088854
	walk terminate 1 spend time 37.327253341674805
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.26655819599717834
			 the number of node to move is : 5336
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1751822497918507,  2.6617176923712496,  3.6886468072124523
						 current side  1
			 redundancy will reduce  0.276371401877475
			 the number of node to move is : 4824
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.165369043911554,  3.4476385384424715,  2.8830995493806366
						 current side  0
			 redundancy will reduce  0.2972943771092993
			 the number of node to move is : 759
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1444460686797298,  3.215833328036914,  3.0730588093225455
	walk terminate 1 spend time 37.144938468933105
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		60439, 63247, 67435, 67672, 68987, 68131, 67882, 67893, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				10881, 11855, 11368, 11368, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.0249330997467041
	Initialize BitList time :  0.0023016929626464844
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 63247, 67435

	before terminate 1 the average redundancy rate is:  3.322304069556817
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03599870343652922
			 the number of node to move is : 1655
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.286305366120288,  3.4980773997546697,  3.074533332485906
						 current side  0
			 redundancy will reduce  0.15477408652654479
			 the number of node to move is : 5676
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1675299830302723,  2.4602164752540694,  3.8748434908064753
						 current side  1
			 redundancy will reduce  0.18446793229904923
			 the number of node to move is : 4927
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.137836137257768,  3.3098468911077354,  2.9658253834078008
	walk terminate 1 spend time 39.9843544960022
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.26671073287614666
			 the number of node to move is : 5342
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.0555933366806705,  2.297510471021171,  3.81367620234017
						 current side  1
			 redundancy will reduce  0.2600499558278626
			 the number of node to move is : 3613
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.0622541137289545,  2.859913943777449,  3.2645942836804607
						 current side  0
			 redundancy will reduce  0.284786353033895
			 the number of node to move is : 375
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.037517716522922,  2.7363082261867686,  3.338727206859075
	walk terminate 1 spend time 41.034013986587524
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		60439, 53816, 65664, 67672, 68987, 68131, 67882, 67893, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				10881, 10657, 12566, 11368, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.025646448135375977
	Initialize BitList time :  0.002089977264404297
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 65664, 67672

	before terminate 1 the average redundancy rate is:  3.3897762156871467
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03765118629201902
			 the number of node to move is : 1687
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3521250293951277,  3.629055733162153,  3.0751943256281025
						 current side  0
			 redundancy will reduce  0.1503250942233012
			 the number of node to move is : 5718
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2394511214638455,  2.590991426156261,  3.88791081677143
						 current side  1
			 redundancy will reduce  0.18660344860460487
			 the number of node to move is : 5074
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.203172767082542,  3.4833321681210636,  2.9230133660440196
	walk terminate 1 spend time 41.23748302459717
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.26681242412879147
			 the number of node to move is : 5579
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1229637915583552,  2.418370524790421,  3.8275570583262892
						 current side  1
			 redundancy will reduce  0.2541772859875806
			 the number of node to move is : 3711
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.135598929699566,  3.005078206928988,  3.266119652470144
						 current side  0
			 redundancy will reduce  0.27324439585862326
			 the number of node to move is : 385
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1165318198285235,  2.884218153159738,  3.3488454864973085
	walk terminate 1 spend time 41.78007650375366
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		60439, 53816, 56725, 65863, 68987, 68131, 67882, 67893, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				10881, 10657, 11356, 12578, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.05537128448486328
	Initialize BitList time :  0.0048618316650390625
	getRedundancyCost: time   6.9141387939453125e-06

					length of partitions 65863, 68987

	before terminate 1 the average redundancy rate is:  3.428266354813492
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.032744583351870915
			 the number of node to move is : 1653
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3955217714616213,  3.6384621740318677,  3.152581368891375
						 current side  0
			 redundancy will reduce  0.16326530612244916
			 the number of node to move is : 5930
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.265001048691043,  2.5159432817038367,  4.014058815678249
						 current side  1
			 redundancy will reduce  0.1794850609194163
			 the number of node to move is : 4760
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.248781293894076,  3.360133215540966,  3.137429372247186
	walk terminate 1 spend time 39.588287115097046
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.28577784274718976
			 the number of node to move is : 5680
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1424885120663024,  2.2264282854219233,  4.058548738710682
						 current side  1
			 redundancy will reduce  0.2537705209769987
			 the number of node to move is : 3632
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1744958338364935,  2.8145087994712057,  3.534482868201781
						 current side  0
			 redundancy will reduce  0.2892607681502999
			 the number of node to move is : 528
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1390055866631923,  2.6259223714400117,  3.652088801886373
	walk terminate 1 spend time 40.168087005615234
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		60439, 53816, 56725, 51645, 71827, 68131, 67882, 67893, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				10881, 10657, 11356, 10485, 13461, 11368, 11368, 11365, 


	preparing two sides time :  0.02721881866455078
	Initialize BitList time :  0.0022389888763427734
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 71827, 68131

	before terminate 1 the average redundancy rate is:  3.558126084441874
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.20536548471771132
			 the number of node to move is : 6633
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3527605997241627,  2.3075270594067585,  4.3979941400415665
						 current side  1
			 redundancy will reduce  0.16885832501795495
			 the number of node to move is : 5460
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.389267759423919,  3.2468491600938103,  3.531686358754028
						 current side  0
			 redundancy will reduce  0.2409828459568195
			 the number of node to move is : 1331
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3171432384850545,  2.856863206198082,  3.777423270772027
	walk terminate 1 spend time 40.41910934448242
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2659226256681433
			 the number of node to move is : 4125
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2922034587737308,  3.524212051684579,  3.060194865862882
						 current side  0
			 redundancy will reduce  0.29523512924322626
			 the number of node to move is : 4441
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.262890955198648,  2.7827811286457904,  3.7430007817515047
						 current side  1
			 redundancy will reduce  0.30331958382854873
			 the number of node to move is : 622
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2548065006133253,  2.941978784662417,  3.567634216564234
	walk terminate 1 spend time 40.58353900909424
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		60439, 53816, 56725, 51645, 57861, 70166, 67882, 67893, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				10881, 10657, 11356, 10485, 11263, 13566, 11368, 11365, 


	preparing two sides time :  0.027080535888671875
	Initialize BitList time :  0.0022084712982177734
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 70166, 67882

	before terminate 1 the average redundancy rate is:  3.5095685113036184
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.168654942512664
			 the number of node to move is : 6164
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3409135687909544,  2.424014389312249,  4.25781274826966
						 current side  1
			 redundancy will reduce  0.1597061122798542
			 the number of node to move is : 5809
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.349862399023764,  3.437215185046301,  3.2625096130012268
						 current side  0
			 redundancy will reduce  0.19837421109832887
			 the number of node to move is : 1032
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3111943002052895,  3.1788177120739296,  3.443570888336649
	walk terminate 1 spend time 42.79203391075134
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2597194592567642
			 the number of node to move is : 4199
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.249849052046854,  3.807930646565696,  2.691767457528013
						 current side  0
			 redundancy will reduce  0.2543552456797107
			 the number of node to move is : 4612
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2552132656239077,  3.0411277559918393,  3.469298775255976
						 current side  1
			 redundancy will reduce  0.2848626214733794
			 the number of node to move is : 759
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.224705889830239,  3.208206484088497,  3.2412052955719814
	walk terminate 1 spend time 40.75907373428345
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		60439, 53816, 56725, 51645, 57861, 63097, 63746, 67893, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				10881, 10657, 11356, 10485, 11263, 12525, 12409, 11365, 


	preparing two sides time :  0.024129867553710938
	Initialize BitList time :  0.0019996166229248047
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 63746, 67893

	before terminate 1 the average redundancy rate is:  3.3466337017522676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.02689733632475111
			 the number of node to move is : 1672
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3197363654275165,  3.536618384507338,  3.102854346347695
						 current side  0
			 redundancy will reduce  0.13057156839690087
			 the number of node to move is : 5472
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2160621333553667,  2.5837713472184265,  3.8483529194923065
						 current side  1
			 redundancy will reduce  0.16657027183342965
			 the number of node to move is : 4953
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.180063429918838,  3.4564348317963125,  2.903692028041363
	walk terminate 1 spend time 40.78463172912598
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.24888934085001235
			 the number of node to move is : 5637
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.0977443609022552,  2.348661171101888,  3.846827550702623
						 current side  1
			 redundancy will reduce  0.23488137079808613
			 the number of node to move is : 3593
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1117523309541815,  2.881421643711985,  3.3420830181963783
						 current side  0
			 redundancy will reduce  0.2602024927068305
			 the number of node to move is : 504
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.086431209045437,  2.700462059629208,  3.4724003584616656
	walk terminate 1 spend time 40.2653694152832
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		60439, 53816, 56725, 51645, 57861, 63097, 53111, 68293, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 565.3787155151367
partition_len_list
[60439, 53816, 56725, 51645, 57861, 63097, 53111, 68293]
random_init_graph_partition selection method range initialization spend 565.4605853557587
time for parepare:  0.01860785484313965
local_output_nid generation:  0.002768993377685547
local_in_edges_tensor generation:  0.018970966339111328
mini_batch_src_global generation:  0.0034322738647460938
r_  generation:  0.03896737098693848
local_output_nid generation:  0.004515886306762695
local_in_edges_tensor generation:  0.0035965442657470703
mini_batch_src_global generation:  0.004243612289428711
r_  generation:  0.038837432861328125
local_output_nid generation:  0.0049457550048828125
local_in_edges_tensor generation:  0.0033800601959228516
mini_batch_src_global generation:  0.0029745101928710938
r_  generation:  0.04105424880981445
local_output_nid generation:  0.004603862762451172
local_in_edges_tensor generation:  0.003311634063720703
mini_batch_src_global generation:  0.0029261112213134766
r_  generation:  0.035856008529663086
local_output_nid generation:  0.004836320877075195
local_in_edges_tensor generation:  0.0035288333892822266
mini_batch_src_global generation:  0.0033087730407714844
r_  generation:  0.0421299934387207
local_output_nid generation:  0.00541377067565918
local_in_edges_tensor generation:  0.004174947738647461
mini_batch_src_global generation:  0.004504680633544922
r_  generation:  0.04870772361755371
local_output_nid generation:  0.004884958267211914
local_in_edges_tensor generation:  0.003686666488647461
mini_batch_src_global generation:  0.0035698413848876953
r_  generation:  0.038332462310791016
local_output_nid generation:  0.005436897277832031
local_in_edges_tensor generation:  0.0038094520568847656
mini_batch_src_global generation:  0.0040187835693359375
r_  generation:  0.0465240478515625
----------------------check_connections_block total spend ----------------------------- 0.5415980815887451
generate_one_block  0.05979728698730469
generate_one_block  0.05032825469970703
generate_one_block  0.052248239517211914
generate_one_block  0.04549980163574219
generate_one_block  0.05967259407043457
generate_one_block  0.06427407264709473
generate_one_block  0.04802107810974121
generate_one_block  0.06372570991516113
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05374336242675781
gen group dst list time:  0.013083934783935547
time for parepare:  0.02383279800415039
local_output_nid generation:  0.012551069259643555
local_in_edges_tensor generation:  0.04018688201904297
mini_batch_src_global generation:  0.029001474380493164
r_  generation:  0.27051353454589844
local_output_nid generation:  0.01594400405883789
local_in_edges_tensor generation:  0.022903919219970703
mini_batch_src_global generation:  0.029212236404418945
r_  generation:  0.23769140243530273
local_output_nid generation:  0.015749454498291016
local_in_edges_tensor generation:  0.021255016326904297
mini_batch_src_global generation:  0.028825998306274414
r_  generation:  0.25618577003479004
local_output_nid generation:  0.014417409896850586
local_in_edges_tensor generation:  0.020043373107910156
mini_batch_src_global generation:  0.028803110122680664
r_  generation:  0.237473726272583
local_output_nid generation:  0.015827417373657227
local_in_edges_tensor generation:  0.0196683406829834
mini_batch_src_global generation:  0.03416156768798828
r_  generation:  0.27773261070251465
local_output_nid generation:  0.017285585403442383
local_in_edges_tensor generation:  0.02345418930053711
mini_batch_src_global generation:  0.03465080261230469
r_  generation:  0.29680490493774414
local_output_nid generation:  0.014898300170898438
local_in_edges_tensor generation:  0.016185998916625977
mini_batch_src_global generation:  0.03132915496826172
r_  generation:  0.24536395072937012
local_output_nid generation:  0.018047809600830078
local_in_edges_tensor generation:  0.02267742156982422
mini_batch_src_global generation:  0.05580306053161621
r_  generation:  0.32213878631591797
----------------------check_connections_block total spend ----------------------------- 3.2157089710235596
generate_one_block  0.3911104202270508
generate_one_block  0.3344452381134033
generate_one_block  0.3426065444946289
generate_one_block  0.31205034255981445
generate_one_block  0.3592996597290039
generate_one_block  0.41135334968566895
generate_one_block  0.30944299697875977
generate_one_block  0.40032434463500977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07012319564819336
gen group dst list time:  0.033559322357177734
time for parepare:  0.019199371337890625
local_output_nid generation:  0.028286218643188477
local_in_edges_tensor generation:  0.05615663528442383
mini_batch_src_global generation:  0.04375576972961426
r_  generation:  0.4660019874572754
local_output_nid generation:  0.03266549110412598
local_in_edges_tensor generation:  0.04865431785583496
mini_batch_src_global generation:  0.0511171817779541
r_  generation:  0.4891164302825928
local_output_nid generation:  0.03876328468322754
local_in_edges_tensor generation:  0.05026555061340332
mini_batch_src_global generation:  0.0554661750793457
r_  generation:  0.4912848472595215
local_output_nid generation:  0.03470802307128906
local_in_edges_tensor generation:  0.039101362228393555
mini_batch_src_global generation:  0.051293134689331055
r_  generation:  0.4660017490386963
local_output_nid generation:  0.035224199295043945
local_in_edges_tensor generation:  0.04465985298156738
mini_batch_src_global generation:  0.055667877197265625
r_  generation:  0.5126519203186035
local_output_nid generation:  0.037858009338378906
local_in_edges_tensor generation:  0.04502606391906738
mini_batch_src_global generation:  0.05710482597351074
r_  generation:  0.48680925369262695
local_output_nid generation:  0.03381657600402832
local_in_edges_tensor generation:  0.03761458396911621
mini_batch_src_global generation:  0.051714420318603516
r_  generation:  0.48476505279541016
local_output_nid generation:  0.035558223724365234
local_in_edges_tensor generation:  0.051468610763549805
mini_batch_src_global generation:  0.05484580993652344
r_  generation:  0.49390339851379395
----------------------check_connections_block total spend ----------------------------- 5.836528062820435
generate_one_block  0.6261196136474609
generate_one_block  0.6022195816040039
generate_one_block  0.5944919586181641
generate_one_block  0.587435245513916
generate_one_block  0.6111977100372314
generate_one_block  0.6094350814819336
generate_one_block  0.6196041107177734
generate_one_block  0.6209585666656494
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

{'VmPeak': 21852.1875, 'VmSize': 21766.9375, 'VmHWM': 4798.75, 'VmRSS': 4713.5}
connection checking time:  9.052237033843994
block generation total time  7.732094764709473
average batch blocks generation time:  0.9665118455886841
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09510946273803711  GigaBytes
Max Memory Allocated: 0.09510946273803711  GigaBytes

{'VmPeak': 21894.93359375, 'VmSize': 21862.9375, 'VmHWM': 4798.75, 'VmRSS': 4775.75}
torch.Size([158427, 128])
torch.Size([134809, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2518310546875 GB
    Memory Allocated: 12.938487529754639  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 38565.68359375, 'VmSize': 38538.97265625, 'VmHWM': 5051.23046875, 'VmRSS': 5051.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2635498046875 GB
    Memory Allocated: 0.09466886520385742  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 38616.02734375, 'VmSize': 38550.21875, 'VmHWM': 5128.71875, 'VmRSS': 5063.04296875}
torch.Size([156853, 128])
torch.Size([128698, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9451904296875 GB
    Memory Allocated: 12.420917987823486  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39286.21484375, 'VmSize': 39254.21875, 'VmHWM': 5128.71875, 'VmRSS': 5063.04296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9451904296875 GB
    Memory Allocated: 0.09740018844604492  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39331.3359375, 'VmSize': 39261.046875, 'VmHWM': 5140.75, 'VmRSS': 5070.60546875}
torch.Size([157935, 128])
torch.Size([131518, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9451904296875 GB
    Memory Allocated: 12.590189933776855  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39331.3359375, 'VmSize': 39261.046875, 'VmHWM': 5140.75, 'VmRSS': 5070.60546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9451904296875 GB
    Memory Allocated: 0.09417152404785156  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39337.38671875, 'VmSize': 39267.96484375, 'VmHWM': 5146.78515625, 'VmRSS': 5077.36328125}
torch.Size([156341, 128])
torch.Size([127613, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9451904296875 GB
    Memory Allocated: 12.297108173370361  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39337.38671875, 'VmSize': 39267.96484375, 'VmHWM': 5146.78515625, 'VmRSS': 5077.36328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9451904296875 GB
    Memory Allocated: 0.0970773696899414  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39344.90234375, 'VmSize': 39275.25390625, 'VmHWM': 5154.43359375, 'VmRSS': 5084.78515625}
torch.Size([157567, 128])
torch.Size([132052, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9530029296875 GB
    Memory Allocated: 12.839451789855957  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39344.90234375, 'VmSize': 39275.25390625, 'VmHWM': 5154.43359375, 'VmRSS': 5084.78515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9530029296875 GB
    Memory Allocated: 0.09760236740112305  GigaBytes
Max Memory Allocated: 12.950329780578613  GigaBytes

{'VmPeak': 39352.3125, 'VmSize': 39282.44140625, 'VmHWM': 5161.4296875, 'VmRSS': 5091.7265625}
torch.Size([157811, 128])
torch.Size([133997, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9959716796875 GB
    Memory Allocated: 13.031469821929932  GigaBytes
Max Memory Allocated: 13.04858922958374  GigaBytes

{'VmPeak': 39352.3125, 'VmSize': 39282.44140625, 'VmHWM': 5161.4296875, 'VmRSS': 5091.7265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9959716796875 GB
    Memory Allocated: 0.09490585327148438  GigaBytes
Max Memory Allocated: 13.04858922958374  GigaBytes

{'VmPeak': 39359.16796875, 'VmSize': 39289.3046875, 'VmHWM': 5168.51171875, 'VmRSS': 5098.66796875}
torch.Size([157130, 128])
torch.Size([129519, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9959716796875 GB
    Memory Allocated: 12.402184009552002  GigaBytes
Max Memory Allocated: 13.04858922958374  GigaBytes

{'VmPeak': 39359.16796875, 'VmSize': 39289.3046875, 'VmHWM': 5168.51171875, 'VmRSS': 5098.66796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9959716796875 GB
    Memory Allocated: 0.09900474548339844  GigaBytes
Max Memory Allocated: 13.04858922958374  GigaBytes

{'VmPeak': 39367.48828125, 'VmSize': 39296.7265625, 'VmHWM': 5176.88671875, 'VmRSS': 5106.30078125}
torch.Size([160112, 128])
torch.Size([139836, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.265961647033691  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 40064.72265625, 'VmSize': 40032.7265625, 'VmHWM': 5176.88671875, 'VmRSS': 5106.30078125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04240092635154724 |0.058594316244125366 |0.32851898670196533 |0.00011488795280456543 |0.32453352212905884 |0.008241891860961914 |
----------------------------------------------------------pseudo_mini_loss sum 4.39630126953125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2785205
Number of first layer input nodes during this epoch:  1262176
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.13111114501953125  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 40064.72265625, 'VmSize': 40032.7265625, 'VmHWM': 5176.88671875, 'VmRSS': 5106.86328125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02160334587097168
global_2_local 0.028368711471557617
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.011502981185913086
before graph partition 
		67924, 67851, 67334, 67667, 68641, 68083, 67763, 67542, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				11368, 11368, 11368, 11368, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.026202917098999023
	Initialize BitList time :  0.0020117759704589844
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 67924, 67851

	before terminate 1 the average redundancy rate is:  3.451277945120169
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.04224653982537063
			 the number of node to move is : 1673
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.4090314052947983,  3.0984354545570088,  3.7196273560325874
						 current side  1
			 redundancy will reduce  0.2629097240756977
			 the number of node to move is : 7394
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1883682210444713,  4.279610071046378,  2.0971263710425645
						 current side  0
			 redundancy will reduce  0.21240197760577573
			 the number of node to move is : 4401
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.238875967514393,  3.5682312121096578,  2.909520722919129
	walk terminate 1 spend time 38.768861293792725
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.26092703448100574
			 the number of node to move is : 5139
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.190350910639163,  2.5810551467317397,  3.7996466745465867
						 current side  1
			 redundancy will reduce  0.2610032917731093
			 the number of node to move is : 4692
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1902746533470596,  3.337527484399029,  3.04302182229509
						 current side  0
			 redundancy will reduce  0.2952428159276064
			 the number of node to move is : 902
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1560351291925626,  3.0498341403896747,  3.26223611799545
	walk terminate 1 spend time 39.62031841278076
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		59991, 64169, 67334, 67667, 68641, 68083, 67763, 67542, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				11339, 11397, 11368, 11368, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.024080753326416016
	Initialize BitList time :  0.0025255680084228516
	getRedundancyCost: time   2.0265579223632812e-05

					length of partitions 64169, 67334

	before terminate 1 the average redundancy rate is:  3.342687561164703
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.028113521688844845
			 the number of node to move is : 1654
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.314574039475858,  3.545964082815419,  3.083183996136297
						 current side  0
			 redundancy will reduce  0.13515334070487128
			 the number of node to move is : 5442
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2075342204598316,  2.53382646382227,  3.8812419770973934
						 current side  1
			 redundancy will reduce  0.16857945374359762
			 the number of node to move is : 4984
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1741081074211053,  3.4185635668077428,  2.9296526480344682
	walk terminate 1 spend time 39.51894021034241
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.24636189168922584
			 the number of node to move is : 5567
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.096325669475477,  2.3408446766055335,  3.85180666234542
						 current side  1
			 redundancy will reduce  0.24936134517863273
			 the number of node to move is : 3619
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.09332621598607,  2.9165363937926565,  3.2701160381794843
						 current side  0
			 redundancy will reduce  0.2743483178912314
			 the number of node to move is : 411
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.0683392432734715,  2.769105629059112,  3.3675728574878305
	walk terminate 1 spend time 40.7538275718689
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		59991, 54469, 66241, 67667, 68641, 68083, 67763, 67542, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				11339, 10234, 12531, 11368, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.024760007858276367
	Initialize BitList time :  0.0026636123657226562
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 66241, 67667

	before terminate 1 the average redundancy rate is:  3.4038204903343883
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03632389013866133
			 the number of node to move is : 1642
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.367496600195727,  3.635947687497617,  3.099045512893837
						 current side  0
			 redundancy will reduce  0.16969789402778312
			 the number of node to move is : 6015
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.234122596306605,  2.4820223433865864,  3.986222849226624
						 current side  1
			 redundancy will reduce  0.19397313201408206
			 the number of node to move is : 4691
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.209847358320306,  3.260355104790229,  3.1593396118503834
	walk terminate 1 spend time 40.86820936203003
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.3006062454722236
			 the number of node to move is : 5434
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1032142448621647,  2.212122367534729,  3.994306122189601
						 current side  1
			 redundancy will reduce  0.27803408700957055
			 the number of node to move is : 3666
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1257864033248177,  2.7945755646217,  3.456997242027936
						 current side  0
			 redundancy will reduce  0.30413950000635515
			 the number of node to move is : 506
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.099680990328033,  2.623149171972903,  3.5762128086831635
	walk terminate 1 spend time 40.7887442111969
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		59991, 54469, 51598, 70345, 68641, 68083, 67763, 67542, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				11339, 10234, 10575, 13324, 11368, 11368, 11368, 11365, 


	preparing two sides time :  0.033640146255493164
	Initialize BitList time :  0.0028972625732421875
	getRedundancyCost: time   5.9604644775390625e-06

					length of partitions 70345, 68641

	before terminate 1 the average redundancy rate is:  3.532898666768343
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.2049287629796268
			 the number of node to move is : 6510
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3279699037887163,  2.2781611824964094,  4.3777786250810236
						 current side  1
			 redundancy will reduce  0.16982498951462244
			 the number of node to move is : 5512
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3630736772537206,  3.261422706879679,  3.464724647627763
						 current side  0
			 redundancy will reduce  0.23383027668687495
			 the number of node to move is : 1327
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.299068390081468,  2.9061654020665726,  3.6919713780963637
	walk terminate 1 spend time 41.04020595550537
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2583851247442204
			 the number of node to move is : 4416
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2745135420241227,  3.6565371563655775,  2.892489927682668
						 current side  0
			 redundancy will reduce  0.2799659384095272
			 the number of node to move is : 4439
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.252932728358816,  2.9091140173612433,  3.5967514393563884
						 current side  1
			 redundancy will reduce  0.3034786034747907
			 the number of node to move is : 619
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2294200632935524,  3.0791677787521765,  3.379672347834928
	walk terminate 1 spend time 41.6849730014801
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		59991, 54469, 51598, 60568, 66479, 68083, 67763, 67542, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				11339, 10234, 10575, 11595, 13097, 11368, 11368, 11365, 


	preparing two sides time :  0.025362014770507812
	Initialize BitList time :  0.0024995803833007812
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 66479, 68083

	before terminate 1 the average redundancy rate is:  3.4204445800129637
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03764568320178974
			 the number of node to move is : 1674
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.382798896811174,  3.6649254584969686,  3.1006723351253798
						 current side  0
			 redundancy will reduce  0.13650055286536755
			 the number of node to move is : 5653
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.283944027147596,  2.6686493562613594,  3.899238698033833
						 current side  1
			 redundancy will reduce  0.185025609740598
			 the number of node to move is : 4899
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2354189702723657,  3.4690458941802977,  3.0017920463644336
	walk terminate 1 spend time 43.25248694419861
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.25581779591006715
			 the number of node to move is : 5407
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1646267841028966,  2.468651898171096,  3.860601670034697
						 current side  1
			 redundancy will reduce  0.24694653092868668
			 the number of node to move is : 3682
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.173498049084277,  3.0217714568955656,  3.3252246412729884
						 current side  0
			 redundancy will reduce  0.27292484843863196
			 the number of node to move is : 429
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.1475197315743317,  2.885931800561762,  3.4091076625869015
	walk terminate 1 spend time 42.91842842102051
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		59991, 54469, 51598, 60568, 56767, 67058, 67763, 67542, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				11339, 10234, 10575, 11595, 11863, 12602, 11368, 11365, 


	preparing two sides time :  0.025087594985961914
	Initialize BitList time :  0.002785205841064453
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 67058, 67763

	before terminate 1 the average redundancy rate is:  3.4270281262312374
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.039577534601745956
			 the number of node to move is : 1659
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.3874505916294915,  3.6897344975279927,  3.08516668573099
						 current side  0
			 redundancy will reduce  0.14476175950991976
			 the number of node to move is : 5715
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2822663667213177,  2.6373330283041647,  3.9271997051384706
						 current side  1
			 redundancy will reduce  0.18093313506437392
			 the number of node to move is : 4908
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2460949911668635,  3.481196222722131,  3.0109937596115963
	walk terminate 1 spend time 41.126816272735596
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.2530725333943393
			 the number of node to move is : 5567
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.173955592836898,  2.4397758035612154,  3.9081353821125813
						 current side  1
			 redundancy will reduce  0.24008337463936646
			 the number of node to move is : 3641
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.186944751591871,  3.0221273242587157,  3.3517621789250263
						 current side  0
			 redundancy will reduce  0.26283346678359454
			 the number of node to move is : 501
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.164194659447643,  2.8656473608622157,  3.46274195803307
	walk terminate 1 spend time 41.41369986534119
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		59991, 54469, 51598, 60568, 56767, 56368, 68113, 67542, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				11339, 10234, 10575, 11595, 11863, 11027, 12943, 11365, 


	preparing two sides time :  0.02521538734436035
	Initialize BitList time :  0.002384185791015625
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 68113, 67542

	before terminate 1 the average redundancy rate is:  3.4482276534360263
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.22211207280029477
			 the number of node to move is : 6646
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2261155806357316,  2.1079549065212695,  4.344276254750194
						 current side  1
			 redundancy will reduce  0.17284986210139675
			 the number of node to move is : 5390
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.2753777913346296,  3.0429201459056188,  3.5078354367636404
						 current side  0
			 redundancy will reduce  0.2560974059811132
			 the number of node to move is : 1353
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.192130247454913,  2.638654821367293,  3.7456056735425327
	walk terminate 1 spend time 41.210370779037476
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.2598848514889234
			 the number of node to move is : 3958
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.188342801947103,  3.24673046860106,  3.129955135293146
						 current side  0
			 redundancy will reduce  0.32813512792160715
			 the number of node to move is : 4776
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.120092525514419,  2.38243031989934,  3.8577547311294977
						 current side  1
			 redundancy will reduce  0.32129739072965524
			 the number of node to move is : 639
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 3.126930262706371,  2.5562461077007157,  3.697614417712027
	walk terminate 1 spend time 40.93421387672424
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		59991, 54469, 51598, 60568, 56767, 56368, 50282, 72733, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 575.3750326633453
partition_len_list
[59991, 54469, 51598, 60568, 56767, 56368, 50282, 72733]
random_init_graph_partition selection method range initialization spend 575.4616446495056
time for parepare:  0.016618967056274414
local_output_nid generation:  0.003804922103881836
local_in_edges_tensor generation:  0.019488811492919922
mini_batch_src_global generation:  0.0038628578186035156
r_  generation:  0.039037466049194336
local_output_nid generation:  0.004977703094482422
local_in_edges_tensor generation:  0.0048770904541015625
mini_batch_src_global generation:  0.005151271820068359
r_  generation:  0.03995466232299805
local_output_nid generation:  0.005371570587158203
local_in_edges_tensor generation:  0.0040073394775390625
mini_batch_src_global generation:  0.002639293670654297
r_  generation:  0.03784441947937012
local_output_nid generation:  0.005888223648071289
local_in_edges_tensor generation:  0.0036721229553222656
mini_batch_src_global generation:  0.003240823745727539
r_  generation:  0.042473793029785156
local_output_nid generation:  0.005849123001098633
local_in_edges_tensor generation:  0.0037758350372314453
mini_batch_src_global generation:  0.0036318302154541016
r_  generation:  0.0426485538482666
local_output_nid generation:  0.005558013916015625
local_in_edges_tensor generation:  0.0035164356231689453
mini_batch_src_global generation:  0.003509044647216797
r_  generation:  0.04054832458496094
local_output_nid generation:  0.005283355712890625
local_in_edges_tensor generation:  0.0032515525817871094
mini_batch_src_global generation:  0.0030028820037841797
r_  generation:  0.03448891639709473
local_output_nid generation:  0.007014274597167969
local_in_edges_tensor generation:  0.004271745681762695
mini_batch_src_global generation:  0.004376888275146484
r_  generation:  0.05371499061584473
----------------------check_connections_block total spend ----------------------------- 0.5547657012939453
generate_one_block  0.07218599319458008
generate_one_block  0.05476212501525879
generate_one_block  0.05033397674560547
generate_one_block  0.062033653259277344
generate_one_block  0.05843043327331543
generate_one_block  0.056955814361572266
generate_one_block  0.05344676971435547
generate_one_block  0.08065581321716309
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05066990852355957
gen group dst list time:  0.01376795768737793
time for parepare:  0.019342422485351562
local_output_nid generation:  0.012620210647583008
local_in_edges_tensor generation:  0.03871917724609375
mini_batch_src_global generation:  0.026799678802490234
r_  generation:  0.24760746955871582
local_output_nid generation:  0.01609635353088379
local_in_edges_tensor generation:  0.025640010833740234
mini_batch_src_global generation:  0.03203582763671875
r_  generation:  0.25649595260620117
local_output_nid generation:  0.014652490615844727
local_in_edges_tensor generation:  0.018014192581176758
mini_batch_src_global generation:  0.027425289154052734
r_  generation:  0.23360466957092285
local_output_nid generation:  0.016398191452026367
local_in_edges_tensor generation:  0.023044586181640625
mini_batch_src_global generation:  0.032561540603637695
r_  generation:  0.28578996658325195
local_output_nid generation:  0.015573978424072266
local_in_edges_tensor generation:  0.021271705627441406
mini_batch_src_global generation:  0.03085780143737793
r_  generation:  0.2693936824798584
local_output_nid generation:  0.015657424926757812
local_in_edges_tensor generation:  0.016286134719848633
mini_batch_src_global generation:  0.031355857849121094
r_  generation:  0.268326997756958
local_output_nid generation:  0.015532255172729492
local_in_edges_tensor generation:  0.01669764518737793
mini_batch_src_global generation:  0.028695344924926758
r_  generation:  0.2388627529144287
local_output_nid generation:  0.020979642868041992
local_in_edges_tensor generation:  0.032491207122802734
mini_batch_src_global generation:  0.04865145683288574
r_  generation:  0.34711170196533203
----------------------check_connections_block total spend ----------------------------- 3.2227823734283447
generate_one_block  0.36598658561706543
generate_one_block  0.3519606590270996
generate_one_block  0.31331634521484375
generate_one_block  0.3939692974090576
generate_one_block  0.33350372314453125
generate_one_block  0.3462247848510742
generate_one_block  0.30776023864746094
generate_one_block  0.4741244316101074
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04682731628417969
gen group dst list time:  0.0344240665435791
time for parepare:  0.02045893669128418
local_output_nid generation:  0.03177690505981445
local_in_edges_tensor generation:  0.05371570587158203
mini_batch_src_global generation:  0.04734468460083008
r_  generation:  0.47908544540405273
local_output_nid generation:  0.03826785087585449
local_in_edges_tensor generation:  0.05789804458618164
mini_batch_src_global generation:  0.06960773468017578
r_  generation:  0.4599764347076416
local_output_nid generation:  0.03625679016113281
local_in_edges_tensor generation:  0.03862762451171875
mini_batch_src_global generation:  0.049016475677490234
r_  generation:  0.4627799987792969
local_output_nid generation:  0.0346980094909668
local_in_edges_tensor generation:  0.03647947311401367
mini_batch_src_global generation:  0.05544161796569824
r_  generation:  0.4772000312805176
local_output_nid generation:  0.03403162956237793
local_in_edges_tensor generation:  0.04440188407897949
mini_batch_src_global generation:  0.05024981498718262
r_  generation:  0.47553205490112305
local_output_nid generation:  0.033951759338378906
local_in_edges_tensor generation:  0.038430213928222656
mini_batch_src_global generation:  0.056139469146728516
r_  generation:  0.4889376163482666
local_output_nid generation:  0.03358173370361328
local_in_edges_tensor generation:  0.032134294509887695
mini_batch_src_global generation:  0.05079340934753418
r_  generation:  0.4904518127441406
local_output_nid generation:  0.03723335266113281
local_in_edges_tensor generation:  0.049310922622680664
mini_batch_src_global generation:  0.05833911895751953
r_  generation:  0.5221555233001709
----------------------check_connections_block total spend ----------------------------- 5.7730348110198975
generate_one_block  0.639488935470581
generate_one_block  0.6080007553100586
generate_one_block  0.5886969566345215
generate_one_block  0.6235315799713135
generate_one_block  0.6035177707672119
generate_one_block  0.610508918762207
generate_one_block  0.5991396903991699
generate_one_block  0.6868340969085693
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.13111114501953125  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40947.21875, 'VmHWM': 6043.89453125, 'VmRSS': 5964.64453125}
connection checking time:  8.995817184448242
block generation total time  7.846564769744873
average batch blocks generation time:  0.9808205962181091
block dataloader generation time/epoch 594.4094929695129
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09901046752929688  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.96484375}
torch.Size([158950, 128])
torch.Size([135364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.740935802459717  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.96875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09621810913085938  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5960.87890625}
torch.Size([156344, 128])
torch.Size([128525, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.590463638305664  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5960.87890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09511661529541016  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.39453125}
torch.Size([156485, 128])
torch.Size([126554, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.128136157989502  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.39453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09926748275756836  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.12890625}
torch.Size([157631, 128])
torch.Size([133538, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.98430585861206  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.12890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09693431854248047  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5962.0546875}
torch.Size([157514, 128])
torch.Size([130929, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.49866247177124  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5962.0546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09771108627319336  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.2578125}
torch.Size([157362, 128])
torch.Size([131359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.638205528259277  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.2578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09517765045166016  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.42578125}
torch.Size([156417, 128])
torch.Size([127282, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 12.275779247283936  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.96875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.42578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.10091066360473633  GigaBytes
Max Memory Allocated: 13.281463623046875  GigaBytes

{'VmPeak': 41026.46875, 'VmSize': 40946.71875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.71875}
torch.Size([160501, 128])
torch.Size([141586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4432373046875 GB
    Memory Allocated: 13.483435153961182  GigaBytes
Max Memory Allocated: 13.502179145812988  GigaBytes

{'VmPeak': 41714.71484375, 'VmSize': 41682.71875, 'VmHWM': 6043.89453125, 'VmRSS': 5961.71875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04369303584098816 |0.01784461736679077 |0.25260022282600403 |0.0001119077205657959 |0.3130629360675812 |0.006211996078491211 |
----------------------------------------------------------pseudo_mini_loss sum 3.710753917694092
Total (block generation + training)time/epoch 599.4681706428528
Training time/epoch 5.0583953857421875
Training time without block to device /epoch 4.915638446807861
Training time without total dataloading part /epoch 4.532412528991699
load block tensor time/epoch 0.3495442867279053
block to device time/epoch 0.14275693893432617
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2779117
Number of first layer input nodes during this epoch:  1261204
