Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648468256.9947016
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026348114013671875
range selection method range initialization spend 0.01378178596496582
time for parepare:  0.017894268035888672
local_output_nid generation:  0.0007293224334716797
local_in_edges_tensor generation:  0.0029680728912353516
mini_batch_src_global generation:  0.0015783309936523438
r_  generation:  0.011290550231933594
local_output_nid generation:  0.0008225440979003906
local_in_edges_tensor generation:  0.0006389617919921875
mini_batch_src_global generation:  0.00147247314453125
r_  generation:  0.009690523147583008
local_output_nid generation:  0.0007898807525634766
local_in_edges_tensor generation:  0.0005674362182617188
mini_batch_src_global generation:  0.0009677410125732422
r_  generation:  0.009371757507324219
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0009245872497558594
r_  generation:  0.00927591323852539
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0009031295776367188
r_  generation:  0.009453773498535156
local_output_nid generation:  0.0007913112640380859
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0009095668792724609
r_  generation:  0.009589433670043945
local_output_nid generation:  0.000774383544921875
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0008757114410400391
r_  generation:  0.009448528289794922
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0009181499481201172
r_  generation:  0.009759902954101562
local_output_nid generation:  0.0007791519165039062
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.000982046127319336
r_  generation:  0.009945869445800781
local_output_nid generation:  0.0007891654968261719
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0009045600891113281
r_  generation:  0.00925135612487793
local_output_nid generation:  0.0007727146148681641
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.00091552734375
r_  generation:  0.00964498519897461
local_output_nid generation:  0.0008060932159423828
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.0009372234344482422
r_  generation:  0.00992131233215332
local_output_nid generation:  0.0007755756378173828
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0009608268737792969
r_  generation:  0.009893655776977539
local_output_nid generation:  0.0007710456848144531
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.009747743606567383
local_output_nid generation:  0.0007677078247070312
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0009541511535644531
r_  generation:  0.010025501251220703
local_output_nid generation:  0.0007739067077636719
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.009915828704833984
local_output_nid generation:  0.0007760524749755859
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0009508132934570312
r_  generation:  0.01000213623046875
local_output_nid generation:  0.0007688999176025391
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.0009622573852539062
r_  generation:  0.010152339935302734
local_output_nid generation:  0.000812530517578125
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0010950565338134766
r_  generation:  0.010057449340820312
local_output_nid generation:  0.0007650852203369141
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.0010001659393310547
r_  generation:  0.009661197662353516
local_output_nid generation:  0.0007750988006591797
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0010824203491210938
r_  generation:  0.010155200958251953
local_output_nid generation:  0.0007691383361816406
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.009883403778076172
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0010254383087158203
r_  generation:  0.01027226448059082
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.010174989700317383
local_output_nid generation:  0.000759124755859375
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.010028600692749023
local_output_nid generation:  0.0008320808410644531
local_in_edges_tensor generation:  0.00048279762268066406
mini_batch_src_global generation:  0.0009884834289550781
r_  generation:  0.010257244110107422
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0009868144989013672
r_  generation:  0.010023117065429688
local_output_nid generation:  0.0007610321044921875
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.0010099411010742188
r_  generation:  0.00982046127319336
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0010182857513427734
r_  generation:  0.011934995651245117
local_output_nid generation:  0.0008399486541748047
local_in_edges_tensor generation:  0.0045969486236572266
mini_batch_src_global generation:  0.0014052391052246094
r_  generation:  0.010361194610595703
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0011005401611328125
r_  generation:  0.010013818740844727
local_output_nid generation:  0.0008141994476318359
local_in_edges_tensor generation:  0.0005095005035400391
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.010032415390014648
----------------------check_connections_block total spend ----------------------------- 0.49187803268432617
generate_one_block  0.016180753707885742
generate_one_block  0.015366792678833008
generate_one_block  0.015114545822143555
generate_one_block  0.014999866485595703
generate_one_block  0.015160083770751953
generate_one_block  0.015264749526977539
generate_one_block  0.01445627212524414
generate_one_block  0.01537322998046875
generate_one_block  0.015110015869140625
generate_one_block  0.014378786087036133
generate_one_block  0.014731645584106445
generate_one_block  0.014873743057250977
generate_one_block  0.014889240264892578
generate_one_block  0.014588117599487305
generate_one_block  0.015053749084472656
generate_one_block  0.015158414840698242
generate_one_block  0.01481175422668457
generate_one_block  0.014759302139282227
generate_one_block  0.015285968780517578
generate_one_block  0.014534473419189453
generate_one_block  0.015308141708374023
generate_one_block  0.014847040176391602
generate_one_block  0.0154571533203125
generate_one_block  0.014947891235351562
generate_one_block  0.015117406845092773
generate_one_block  0.015182971954345703
generate_one_block  0.014841794967651367
generate_one_block  0.014748811721801758
generate_one_block  0.016469240188598633
generate_one_block  0.01653599739074707
generate_one_block  0.016129255294799805
generate_one_block  0.015072345733642578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04096698760986328
gen group dst list time:  0.0238344669342041
time for parepare:  0.01941847801208496
local_output_nid generation:  0.004488706588745117
local_in_edges_tensor generation:  0.01174020767211914
mini_batch_src_global generation:  0.016798734664916992
r_  generation:  0.16485261917114258
local_output_nid generation:  0.00792384147644043
local_in_edges_tensor generation:  0.014323711395263672
mini_batch_src_global generation:  0.021260738372802734
r_  generation:  0.17076349258422852
local_output_nid generation:  0.008199214935302734
local_in_edges_tensor generation:  0.011327981948852539
mini_batch_src_global generation:  0.019344091415405273
r_  generation:  0.17397141456604004
local_output_nid generation:  0.008115530014038086
local_in_edges_tensor generation:  0.012942314147949219
mini_batch_src_global generation:  0.02147531509399414
r_  generation:  0.17584753036499023
local_output_nid generation:  0.008320808410644531
local_in_edges_tensor generation:  0.009139776229858398
mini_batch_src_global generation:  0.021236419677734375
r_  generation:  0.1833798885345459
local_output_nid generation:  0.008438348770141602
local_in_edges_tensor generation:  0.011089563369750977
mini_batch_src_global generation:  0.022034406661987305
r_  generation:  0.18295574188232422
local_output_nid generation:  0.008084535598754883
local_in_edges_tensor generation:  0.010111331939697266
mini_batch_src_global generation:  0.024724721908569336
r_  generation:  0.1751561164855957
local_output_nid generation:  0.008602142333984375
local_in_edges_tensor generation:  0.009096384048461914
mini_batch_src_global generation:  0.02209782600402832
r_  generation:  0.18140959739685059
local_output_nid generation:  0.00884556770324707
local_in_edges_tensor generation:  0.012916326522827148
mini_batch_src_global generation:  0.02259540557861328
r_  generation:  0.1896345615386963
local_output_nid generation:  0.009333372116088867
local_in_edges_tensor generation:  0.017788410186767578
mini_batch_src_global generation:  0.02266383171081543
r_  generation:  0.1853647232055664
local_output_nid generation:  0.011685848236083984
local_in_edges_tensor generation:  0.012091875076293945
mini_batch_src_global generation:  0.022067546844482422
r_  generation:  0.18227577209472656
local_output_nid generation:  0.00885772705078125
local_in_edges_tensor generation:  0.010208606719970703
mini_batch_src_global generation:  0.02227926254272461
r_  generation:  0.1789870262145996
local_output_nid generation:  0.008910179138183594
local_in_edges_tensor generation:  0.011038780212402344
mini_batch_src_global generation:  0.022626399993896484
r_  generation:  0.1945633888244629
local_output_nid generation:  0.008721351623535156
local_in_edges_tensor generation:  0.009322166442871094
mini_batch_src_global generation:  0.021970033645629883
r_  generation:  0.17802810668945312
local_output_nid generation:  0.009173393249511719
local_in_edges_tensor generation:  0.012029170989990234
mini_batch_src_global generation:  0.02386951446533203
r_  generation:  0.18425464630126953
local_output_nid generation:  0.009429216384887695
local_in_edges_tensor generation:  0.021007537841796875
mini_batch_src_global generation:  0.024332284927368164
r_  generation:  0.18496131896972656
local_output_nid generation:  0.00971674919128418
local_in_edges_tensor generation:  0.013577461242675781
mini_batch_src_global generation:  0.023992538452148438
r_  generation:  0.1835472583770752
local_output_nid generation:  0.0078046321868896484
local_in_edges_tensor generation:  0.01192474365234375
mini_batch_src_global generation:  0.02254319190979004
r_  generation:  0.17358088493347168
local_output_nid generation:  0.007956266403198242
local_in_edges_tensor generation:  0.008712053298950195
mini_batch_src_global generation:  0.022557735443115234
r_  generation:  0.1836843490600586
local_output_nid generation:  0.007618904113769531
local_in_edges_tensor generation:  0.008741140365600586
mini_batch_src_global generation:  0.022408008575439453
r_  generation:  0.1771402359008789
local_output_nid generation:  0.008139371871948242
local_in_edges_tensor generation:  0.011827230453491211
mini_batch_src_global generation:  0.02421116828918457
r_  generation:  0.18413424491882324
local_output_nid generation:  0.00784611701965332
local_in_edges_tensor generation:  0.013183832168579102
mini_batch_src_global generation:  0.023222923278808594
r_  generation:  0.18333053588867188
local_output_nid generation:  0.008135795593261719
local_in_edges_tensor generation:  0.013600587844848633
mini_batch_src_global generation:  0.02370595932006836
r_  generation:  0.1869502067565918
local_output_nid generation:  0.007948875427246094
local_in_edges_tensor generation:  0.008774995803833008
mini_batch_src_global generation:  0.023221731185913086
r_  generation:  0.18191981315612793
local_output_nid generation:  0.008089303970336914
local_in_edges_tensor generation:  0.008990287780761719
mini_batch_src_global generation:  0.023043155670166016
r_  generation:  0.18515968322753906
local_output_nid generation:  0.008008003234863281
local_in_edges_tensor generation:  0.011805295944213867
mini_batch_src_global generation:  0.02321314811706543
r_  generation:  0.18361806869506836
local_output_nid generation:  0.007840871810913086
local_in_edges_tensor generation:  0.00865030288696289
mini_batch_src_global generation:  0.02253246307373047
r_  generation:  0.1769566535949707
local_output_nid generation:  0.007951498031616211
local_in_edges_tensor generation:  0.00886225700378418
mini_batch_src_global generation:  0.0225677490234375
r_  generation:  0.18078136444091797
local_output_nid generation:  0.00861215591430664
local_in_edges_tensor generation:  0.014203310012817383
mini_batch_src_global generation:  0.02433633804321289
r_  generation:  0.19347143173217773
local_output_nid generation:  0.007986783981323242
local_in_edges_tensor generation:  0.008593320846557617
mini_batch_src_global generation:  0.027533531188964844
r_  generation:  0.1945476531982422
local_output_nid generation:  0.007992267608642578
local_in_edges_tensor generation:  0.008745193481445312
mini_batch_src_global generation:  0.022646665573120117
r_  generation:  0.17963695526123047
local_output_nid generation:  0.007965803146362305
local_in_edges_tensor generation:  0.009913444519042969
mini_batch_src_global generation:  0.022864103317260742
r_  generation:  0.1817936897277832
----------------------check_connections_block total spend ----------------------------- 8.505555629730225
generate_one_block  0.2411952018737793
generate_one_block  0.2290353775024414
generate_one_block  0.25501012802124023
generate_one_block  0.22570323944091797
generate_one_block  0.2445673942565918
generate_one_block  0.23480463027954102
generate_one_block  0.22142648696899414
generate_one_block  0.2352595329284668
generate_one_block  0.23402190208435059
generate_one_block  0.21840858459472656
generate_one_block  0.22816133499145508
generate_one_block  0.2257375717163086
generate_one_block  0.2268373966217041
generate_one_block  0.22059321403503418
generate_one_block  0.22793149948120117
generate_one_block  0.26288819313049316
generate_one_block  0.2329254150390625
generate_one_block  0.2236320972442627
generate_one_block  0.23311185836791992
generate_one_block  0.2252030372619629
generate_one_block  0.2347733974456787
generate_one_block  0.23363399505615234
generate_one_block  0.2397463321685791
generate_one_block  0.24995064735412598
generate_one_block  0.2609701156616211
generate_one_block  0.23559045791625977
generate_one_block  0.22359323501586914
generate_one_block  0.22563791275024414
generate_one_block  0.25649189949035645
generate_one_block  0.2325456142425537
generate_one_block  0.2269899845123291
generate_one_block  0.2291269302368164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052104949951171875
gen group dst list time:  0.11611676216125488
time for parepare:  0.02072596549987793
local_output_nid generation:  0.02286815643310547
local_in_edges_tensor generation:  0.05968213081359863
mini_batch_src_global generation:  0.0469815731048584
r_  generation:  0.47646236419677734
local_output_nid generation:  0.02835369110107422
local_in_edges_tensor generation:  0.04839444160461426
mini_batch_src_global generation:  0.058129072189331055
r_  generation:  0.482602596282959
local_output_nid generation:  0.028638839721679688
local_in_edges_tensor generation:  0.039875030517578125
mini_batch_src_global generation:  0.05640912055969238
r_  generation:  0.49223852157592773
local_output_nid generation:  0.027175426483154297
local_in_edges_tensor generation:  0.03058314323425293
mini_batch_src_global generation:  0.05800318717956543
r_  generation:  0.4878268241882324
local_output_nid generation:  0.02742600440979004
local_in_edges_tensor generation:  0.03967642784118652
mini_batch_src_global generation:  0.06368350982666016
r_  generation:  0.49750471115112305
local_output_nid generation:  0.028021812438964844
local_in_edges_tensor generation:  0.04000449180603027
mini_batch_src_global generation:  0.08295011520385742
r_  generation:  0.5008821487426758
local_output_nid generation:  0.027416706085205078
local_in_edges_tensor generation:  0.031046152114868164
mini_batch_src_global generation:  0.05909419059753418
r_  generation:  0.49844789505004883
local_output_nid generation:  0.02930903434753418
local_in_edges_tensor generation:  0.03821301460266113
mini_batch_src_global generation:  0.06882023811340332
r_  generation:  0.5240192413330078
local_output_nid generation:  0.02907562255859375
local_in_edges_tensor generation:  0.046276092529296875
mini_batch_src_global generation:  0.06409120559692383
r_  generation:  0.5013384819030762
local_output_nid generation:  0.029635906219482422
local_in_edges_tensor generation:  0.03709077835083008
mini_batch_src_global generation:  0.06032228469848633
r_  generation:  0.49471354484558105
local_output_nid generation:  0.028530120849609375
local_in_edges_tensor generation:  0.04014420509338379
mini_batch_src_global generation:  0.05916905403137207
r_  generation:  0.5015356540679932
local_output_nid generation:  0.028622150421142578
local_in_edges_tensor generation:  0.03551316261291504
mini_batch_src_global generation:  0.05968880653381348
r_  generation:  0.49541497230529785
local_output_nid generation:  0.02889561653137207
local_in_edges_tensor generation:  0.04030132293701172
mini_batch_src_global generation:  0.06188678741455078
r_  generation:  0.5004162788391113
local_output_nid generation:  0.02854752540588379
local_in_edges_tensor generation:  0.031276702880859375
mini_batch_src_global generation:  0.05952715873718262
r_  generation:  0.4989356994628906
local_output_nid generation:  0.029125213623046875
local_in_edges_tensor generation:  0.03081536293029785
mini_batch_src_global generation:  0.06306743621826172
r_  generation:  0.5013525485992432
local_output_nid generation:  0.0297849178314209
local_in_edges_tensor generation:  0.06017041206359863
mini_batch_src_global generation:  0.061414480209350586
r_  generation:  0.498150110244751
local_output_nid generation:  0.02864837646484375
local_in_edges_tensor generation:  0.032715797424316406
mini_batch_src_global generation:  0.05867314338684082
r_  generation:  0.5007905960083008
local_output_nid generation:  0.028743743896484375
local_in_edges_tensor generation:  0.03286480903625488
mini_batch_src_global generation:  0.05931878089904785
r_  generation:  0.4950289726257324
local_output_nid generation:  0.028928279876708984
local_in_edges_tensor generation:  0.03757953643798828
mini_batch_src_global generation:  0.05891919136047363
r_  generation:  0.5041100978851318
local_output_nid generation:  0.02891373634338379
local_in_edges_tensor generation:  0.02826976776123047
mini_batch_src_global generation:  0.059354305267333984
r_  generation:  0.5036849975585938
local_output_nid generation:  0.02914142608642578
local_in_edges_tensor generation:  0.04008054733276367
mini_batch_src_global generation:  0.06258440017700195
r_  generation:  0.5018355846405029
local_output_nid generation:  0.028798818588256836
local_in_edges_tensor generation:  0.0353856086730957
mini_batch_src_global generation:  0.059775590896606445
r_  generation:  0.49851560592651367
local_output_nid generation:  0.029456377029418945
local_in_edges_tensor generation:  0.042964935302734375
mini_batch_src_global generation:  0.058429718017578125
r_  generation:  0.5037963390350342
local_output_nid generation:  0.028899192810058594
local_in_edges_tensor generation:  0.03407001495361328
mini_batch_src_global generation:  0.059503793716430664
r_  generation:  0.5216350555419922
local_output_nid generation:  0.02884364128112793
local_in_edges_tensor generation:  0.04234766960144043
mini_batch_src_global generation:  0.06005740165710449
r_  generation:  0.5018267631530762
local_output_nid generation:  0.0289456844329834
local_in_edges_tensor generation:  0.04377603530883789
mini_batch_src_global generation:  0.058623313903808594
r_  generation:  0.49658751487731934
local_output_nid generation:  0.02891850471496582
local_in_edges_tensor generation:  0.03053903579711914
mini_batch_src_global generation:  0.05884861946105957
r_  generation:  0.49542999267578125
local_output_nid generation:  0.029029130935668945
local_in_edges_tensor generation:  0.032973289489746094
mini_batch_src_global generation:  0.06278634071350098
r_  generation:  0.5024778842926025
local_output_nid generation:  0.03161501884460449
local_in_edges_tensor generation:  0.04620528221130371
mini_batch_src_global generation:  0.06048250198364258
r_  generation:  0.5039613246917725
local_output_nid generation:  0.028858661651611328
local_in_edges_tensor generation:  0.027928829193115234
mini_batch_src_global generation:  0.059375762939453125
r_  generation:  0.49528026580810547
local_output_nid generation:  0.028833627700805664
local_in_edges_tensor generation:  0.028882265090942383
mini_batch_src_global generation:  0.058196306228637695
r_  generation:  0.49905896186828613
local_output_nid generation:  0.028620243072509766
local_in_edges_tensor generation:  0.03228449821472168
mini_batch_src_global generation:  0.059252023696899414
r_  generation:  0.5013978481292725
----------------------check_connections_block total spend ----------------------------- 23.5346941947937
generate_one_block  0.7511386871337891
generate_one_block  0.638333797454834
generate_one_block  0.6425583362579346
generate_one_block  0.6464016437530518
generate_one_block  0.6488218307495117
generate_one_block  0.6516468524932861
generate_one_block  0.6328716278076172
generate_one_block  0.6508288383483887
generate_one_block  0.6484236717224121
generate_one_block  0.6418182849884033
generate_one_block  0.6408517360687256
generate_one_block  0.6441600322723389
generate_one_block  0.646052360534668
generate_one_block  0.6409904956817627
generate_one_block  0.6452078819274902
generate_one_block  0.6458678245544434
generate_one_block  0.6484072208404541
generate_one_block  0.6447896957397461
generate_one_block  0.6464419364929199
generate_one_block  0.6453008651733398
generate_one_block  0.6740872859954834
generate_one_block  0.6514542102813721
generate_one_block  0.6539082527160645
generate_one_block  0.6372697353363037
generate_one_block  0.6466178894042969
generate_one_block  0.6525313854217529
generate_one_block  0.6412591934204102
generate_one_block  0.6620111465454102
generate_one_block  0.6706435680389404
generate_one_block  0.6433546543121338
generate_one_block  0.6351697444915771
generate_one_block  0.6412949562072754
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  32.040249824523926
block generation total time  28.306020259857178
average batch blocks generation time:  0.8845631331205368
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08927202224731445  GigaBytes
Max Memory Allocated: 0.08927202224731445  GigaBytes

torch.Size([150462, 128])
torch.Size([110655, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3201904296875 GB
    Memory Allocated: 13.169686794281006  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3280029296875 GB
    Memory Allocated: 0.08945369720458984  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150020, 128])
torch.Size([109434, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 13.085264682769775  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 0.09005451202392578  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150133, 128])
torch.Size([109861, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 13.084670066833496  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.08934593200683594  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150056, 128])
torch.Size([109082, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 13.051436424255371  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.090240478515625  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150108, 128])
torch.Size([110180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.138264656066895  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.08962440490722656  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150312, 128])
torch.Size([110192, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.10704755783081  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.08987236022949219  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([149533, 128])
torch.Size([107763, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 12.940948009490967  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.08980369567871094  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150694, 128])
torch.Size([110116, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.10339641571045  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.09025859832763672  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150352, 128])
torch.Size([110558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.140241146087646  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.08944272994995117  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150657, 128])
torch.Size([109475, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 12.990046977996826  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.09012889862060547  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([149844, 128])
torch.Size([109005, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.085190296173096  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.08911466598510742  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([149659, 128])
torch.Size([108702, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.014640808105469  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.09009456634521484  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150251, 128])
torch.Size([109945, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.081938743591309  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.08923530578613281  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150202, 128])
torch.Size([108959, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 12.90627384185791  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.09012317657470703  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150209, 128])
torch.Size([110451, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.128699779510498  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.0896754264831543  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150511, 128])
torch.Size([110093, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.09241533279419  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.0901641845703125  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([149817, 128])
torch.Size([109353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.06425142288208  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.0894322395324707  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150427, 128])
torch.Size([109695, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.02272367477417  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.09019184112548828  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150224, 128])
torch.Size([109879, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.078177452087402  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.0894474983215332  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150309, 128])
torch.Size([109840, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.0694260597229  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.0902719497680664  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150861, 128])
torch.Size([110722, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.14852237701416  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.0895223617553711  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150116, 128])
torch.Size([109766, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 13.10981273651123  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 0.09038543701171875  GigaBytes
Max Memory Allocated: 13.179263591766357  GigaBytes

torch.Size([150396, 128])
torch.Size([111094, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 13.232887268066406  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 0.08966255187988281  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

torch.Size([150542, 128])
torch.Size([110140, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 13.079764366149902  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 0.09025001525878906  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

torch.Size([150230, 128])
torch.Size([109975, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 13.124058723449707  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 0.0895237922668457  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

torch.Size([149983, 128])
torch.Size([110203, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 13.134413719177246  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 0.0900411605834961  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

torch.Size([150362, 128])
torch.Size([109496, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 13.053065299987793  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 0.08962154388427734  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

torch.Size([150358, 128])
torch.Size([110591, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 13.145166397094727  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7557373046875 GB
    Memory Allocated: 0.09065628051757812  GigaBytes
Max Memory Allocated: 13.24357557296753  GigaBytes

torch.Size([150695, 128])
torch.Size([111725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.322279930114746  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.08947324752807617  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150213, 128])
torch.Size([109544, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.046306610107422  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09012985229492188  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150095, 128])
torch.Size([109567, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.08850383758545  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.0895695686340332  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150317, 128])
torch.Size([110343, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.108022689819336  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02943294495344162 |0.03111165761947632 |0.634708397090435 |0.00010834634304046631 |1.018451452255249 |0.01539158821105957 |
----------------------------------------------------------pseudo_mini_loss sum 4.404982089996338
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9164375
Number of first layer input nodes during this epoch:  4807948
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.11355733871459961  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.028838634490966797
range selection method range initialization spend 0.016602754592895508
time for parepare:  0.017911911010742188
local_output_nid generation:  0.0009541511535644531
local_in_edges_tensor generation:  0.008463382720947266
mini_batch_src_global generation:  0.003087759017944336
r_  generation:  0.01696610450744629
local_output_nid generation:  0.0014376640319824219
local_in_edges_tensor generation:  0.0008587837219238281
mini_batch_src_global generation:  0.001932382583618164
r_  generation:  0.02181077003479004
local_output_nid generation:  0.0016417503356933594
local_in_edges_tensor generation:  0.001004934310913086
mini_batch_src_global generation:  0.0018622875213623047
r_  generation:  0.01123666763305664
local_output_nid generation:  0.0010325908660888672
local_in_edges_tensor generation:  0.0006392002105712891
mini_batch_src_global generation:  0.001172780990600586
r_  generation:  0.00994110107421875
local_output_nid generation:  0.0009510517120361328
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.009717464447021484
local_output_nid generation:  0.0009400844573974609
local_in_edges_tensor generation:  0.0006368160247802734
mini_batch_src_global generation:  0.0011339187622070312
r_  generation:  0.010201692581176758
local_output_nid generation:  0.0009126663208007812
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.01000666618347168
local_output_nid generation:  0.0009174346923828125
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0010876655578613281
r_  generation:  0.01018524169921875
local_output_nid generation:  0.0008974075317382812
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.0011076927185058594
r_  generation:  0.010166406631469727
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005741119384765625
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.010186433792114258
local_output_nid generation:  0.0009138584136962891
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.001066446304321289
r_  generation:  0.00995635986328125
local_output_nid generation:  0.0009207725524902344
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.001087188720703125
r_  generation:  0.01037907600402832
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0005698204040527344
mini_batch_src_global generation:  0.0011608600616455078
r_  generation:  0.010241270065307617
local_output_nid generation:  0.0008847713470458984
local_in_edges_tensor generation:  0.0005826950073242188
mini_batch_src_global generation:  0.0011396408081054688
r_  generation:  0.010384082794189453
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0011286735534667969
r_  generation:  0.010632038116455078
local_output_nid generation:  0.0008671283721923828
local_in_edges_tensor generation:  0.0005736351013183594
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010241031646728516
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0011434555053710938
r_  generation:  0.010584592819213867
local_output_nid generation:  0.0008866786956787109
local_in_edges_tensor generation:  0.0005772113800048828
mini_batch_src_global generation:  0.0011005401611328125
r_  generation:  0.010117530822753906
local_output_nid generation:  0.002352476119995117
local_in_edges_tensor generation:  0.0006339550018310547
mini_batch_src_global generation:  0.0012254714965820312
r_  generation:  0.010459184646606445
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005803108215332031
mini_batch_src_global generation:  0.001123189926147461
r_  generation:  0.01025080680847168
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0006048679351806641
mini_batch_src_global generation:  0.0011310577392578125
r_  generation:  0.01057744026184082
local_output_nid generation:  0.0008723735809326172
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0011255741119384766
r_  generation:  0.010416507720947266
local_output_nid generation:  0.0009024143218994141
local_in_edges_tensor generation:  0.0005955696105957031
mini_batch_src_global generation:  0.0011930465698242188
r_  generation:  0.010574579238891602
local_output_nid generation:  0.0008788108825683594
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0011551380157470703
r_  generation:  0.010730743408203125
local_output_nid generation:  0.0008573532104492188
local_in_edges_tensor generation:  0.0005970001220703125
mini_batch_src_global generation:  0.0011715888977050781
r_  generation:  0.012032032012939453
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0005869865417480469
mini_batch_src_global generation:  0.0012094974517822266
r_  generation:  0.01061105728149414
local_output_nid generation:  0.0008790493011474609
local_in_edges_tensor generation:  0.0005710124969482422
mini_batch_src_global generation:  0.0011935234069824219
r_  generation:  0.010506868362426758
local_output_nid generation:  0.0008893013000488281
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.001201629638671875
r_  generation:  0.01035451889038086
local_output_nid generation:  0.0008649826049804688
local_in_edges_tensor generation:  0.0005729198455810547
mini_batch_src_global generation:  0.0011472702026367188
r_  generation:  0.010308027267456055
local_output_nid generation:  0.0009136199951171875
local_in_edges_tensor generation:  0.0006077289581298828
mini_batch_src_global generation:  0.0012104511260986328
r_  generation:  0.010821104049682617
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005719661712646484
mini_batch_src_global generation:  0.0012412071228027344
r_  generation:  0.010392427444458008
local_output_nid generation:  0.000873565673828125
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0012531280517578125
r_  generation:  0.012356281280517578
----------------------check_connections_block total spend ----------------------------- 0.5561380386352539
generate_one_block  0.02541351318359375
generate_one_block  0.02156519889831543
generate_one_block  0.019646167755126953
generate_one_block  0.019214868545532227
generate_one_block  0.020101547241210938
generate_one_block  0.019315004348754883
generate_one_block  0.01859450340270996
generate_one_block  0.0188906192779541
generate_one_block  0.018902301788330078
generate_one_block  0.020482540130615234
generate_one_block  0.018213748931884766
generate_one_block  0.01917576789855957
generate_one_block  0.01880955696105957
generate_one_block  0.01913309097290039
generate_one_block  0.018778562545776367
generate_one_block  0.020201683044433594
generate_one_block  0.019292116165161133
generate_one_block  0.0183408260345459
generate_one_block  0.018972396850585938
generate_one_block  0.01855325698852539
generate_one_block  0.020745038986206055
generate_one_block  0.018839120864868164
generate_one_block  0.0191957950592041
generate_one_block  0.01896214485168457
generate_one_block  0.018458843231201172
generate_one_block  0.019057750701904297
generate_one_block  0.020581960678100586
generate_one_block  0.018687725067138672
generate_one_block  0.018549680709838867
generate_one_block  0.01954960823059082
generate_one_block  0.01873183250427246
generate_one_block  0.022376060485839844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04312920570373535
gen group dst list time:  0.03324294090270996
time for parepare:  0.02556157112121582
local_output_nid generation:  0.0070648193359375
local_in_edges_tensor generation:  0.018299102783203125
mini_batch_src_global generation:  0.016962766647338867
r_  generation:  0.17714881896972656
local_output_nid generation:  0.00950312614440918
local_in_edges_tensor generation:  0.014686346054077148
mini_batch_src_global generation:  0.025208711624145508
r_  generation:  0.1846473217010498
local_output_nid generation:  0.009607315063476562
local_in_edges_tensor generation:  0.03634047508239746
mini_batch_src_global generation:  0.023042678833007812
r_  generation:  0.18190336227416992
local_output_nid generation:  0.010115623474121094
local_in_edges_tensor generation:  0.012156009674072266
mini_batch_src_global generation:  0.02437615394592285
r_  generation:  0.2199110984802246
local_output_nid generation:  0.010536432266235352
local_in_edges_tensor generation:  0.0182650089263916
mini_batch_src_global generation:  0.02444148063659668
r_  generation:  0.18622469902038574
local_output_nid generation:  0.01262211799621582
local_in_edges_tensor generation:  0.010389089584350586
mini_batch_src_global generation:  0.02324390411376953
r_  generation:  0.17850804328918457
local_output_nid generation:  0.008511543273925781
local_in_edges_tensor generation:  0.00978994369506836
mini_batch_src_global generation:  0.02147078514099121
r_  generation:  0.17323660850524902
local_output_nid generation:  0.008616924285888672
local_in_edges_tensor generation:  0.00854802131652832
mini_batch_src_global generation:  0.031136274337768555
r_  generation:  0.2164151668548584
local_output_nid generation:  0.008944988250732422
local_in_edges_tensor generation:  0.01015019416809082
mini_batch_src_global generation:  0.0225980281829834
r_  generation:  0.17983436584472656
local_output_nid generation:  0.009174585342407227
local_in_edges_tensor generation:  0.011513710021972656
mini_batch_src_global generation:  0.02180933952331543
r_  generation:  0.1753389835357666
local_output_nid generation:  0.008903264999389648
local_in_edges_tensor generation:  0.011276483535766602
mini_batch_src_global generation:  0.021313905715942383
r_  generation:  0.17395901679992676
local_output_nid generation:  0.009451866149902344
local_in_edges_tensor generation:  0.00878596305847168
mini_batch_src_global generation:  0.023940086364746094
r_  generation:  0.1818714141845703
local_output_nid generation:  0.009270906448364258
local_in_edges_tensor generation:  0.008565664291381836
mini_batch_src_global generation:  0.0222780704498291
r_  generation:  0.18406438827514648
local_output_nid generation:  0.009386301040649414
local_in_edges_tensor generation:  0.011344671249389648
mini_batch_src_global generation:  0.024454832077026367
r_  generation:  0.18770551681518555
local_output_nid generation:  0.009269952774047852
local_in_edges_tensor generation:  0.011635065078735352
mini_batch_src_global generation:  0.025276660919189453
r_  generation:  0.18294453620910645
local_output_nid generation:  0.009243488311767578
local_in_edges_tensor generation:  0.008777856826782227
mini_batch_src_global generation:  0.022609472274780273
r_  generation:  0.18706727027893066
local_output_nid generation:  0.00934290885925293
local_in_edges_tensor generation:  0.01070261001586914
mini_batch_src_global generation:  0.02654886245727539
r_  generation:  0.19549846649169922
local_output_nid generation:  0.009247541427612305
local_in_edges_tensor generation:  0.008737564086914062
mini_batch_src_global generation:  0.022880077362060547
r_  generation:  0.1797339916229248
local_output_nid generation:  0.009481430053710938
local_in_edges_tensor generation:  0.01052093505859375
mini_batch_src_global generation:  0.02294921875
r_  generation:  0.19410371780395508
local_output_nid generation:  0.009248495101928711
local_in_edges_tensor generation:  0.011950254440307617
mini_batch_src_global generation:  0.023192882537841797
r_  generation:  0.1979832649230957
local_output_nid generation:  0.012491464614868164
local_in_edges_tensor generation:  0.01901841163635254
mini_batch_src_global generation:  0.024137258529663086
r_  generation:  0.18633365631103516
local_output_nid generation:  0.009698629379272461
local_in_edges_tensor generation:  0.011194229125976562
mini_batch_src_global generation:  0.02294778823852539
r_  generation:  0.1827528476715088
local_output_nid generation:  0.009816408157348633
local_in_edges_tensor generation:  0.009825468063354492
mini_batch_src_global generation:  0.023282289505004883
r_  generation:  0.18717169761657715
local_output_nid generation:  0.00971674919128418
local_in_edges_tensor generation:  0.009171009063720703
mini_batch_src_global generation:  0.023297548294067383
r_  generation:  0.18518352508544922
local_output_nid generation:  0.00976109504699707
local_in_edges_tensor generation:  0.008932828903198242
mini_batch_src_global generation:  0.022678136825561523
r_  generation:  0.18522334098815918
local_output_nid generation:  0.009900808334350586
local_in_edges_tensor generation:  0.013701677322387695
mini_batch_src_global generation:  0.024071931838989258
r_  generation:  0.1909019947052002
local_output_nid generation:  0.010174751281738281
local_in_edges_tensor generation:  0.010699033737182617
mini_batch_src_global generation:  0.023699283599853516
r_  generation:  0.19000029563903809
local_output_nid generation:  0.009697437286376953
local_in_edges_tensor generation:  0.010460376739501953
mini_batch_src_global generation:  0.023532390594482422
r_  generation:  0.18326425552368164
local_output_nid generation:  0.011739969253540039
local_in_edges_tensor generation:  0.010677576065063477
mini_batch_src_global generation:  0.022745847702026367
r_  generation:  0.1969447135925293
local_output_nid generation:  0.010071516036987305
local_in_edges_tensor generation:  0.009058952331542969
mini_batch_src_global generation:  0.023433923721313477
r_  generation:  0.19335317611694336
local_output_nid generation:  0.009699344635009766
local_in_edges_tensor generation:  0.011965036392211914
mini_batch_src_global generation:  0.022992372512817383
r_  generation:  0.1827535629272461
local_output_nid generation:  0.010185956954956055
local_in_edges_tensor generation:  0.010596036911010742
mini_batch_src_global generation:  0.02504730224609375
r_  generation:  0.1935889720916748
----------------------check_connections_block total spend ----------------------------- 8.83202314376831
generate_one_block  0.2607429027557373
generate_one_block  0.2569448947906494
generate_one_block  0.24381732940673828
generate_one_block  0.26300907135009766
generate_one_block  0.2819380760192871
generate_one_block  0.24763894081115723
generate_one_block  0.23847317695617676
generate_one_block  0.24257373809814453
generate_one_block  0.24613380432128906
generate_one_block  0.2365860939025879
generate_one_block  0.23366284370422363
generate_one_block  0.24979043006896973
generate_one_block  0.24334502220153809
generate_one_block  0.2563002109527588
generate_one_block  0.2524070739746094
generate_one_block  0.2533855438232422
generate_one_block  0.25759363174438477
generate_one_block  0.23922467231750488
generate_one_block  0.2481977939605713
generate_one_block  0.2505011558532715
generate_one_block  0.2576613426208496
generate_one_block  0.24466514587402344
generate_one_block  0.25240135192871094
generate_one_block  0.24594473838806152
generate_one_block  0.24234676361083984
generate_one_block  0.26049089431762695
generate_one_block  0.2570614814758301
generate_one_block  0.2449798583984375
generate_one_block  0.24197053909301758
generate_one_block  0.2613248825073242
generate_one_block  0.25234150886535645
generate_one_block  0.2628026008605957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05063295364379883
gen group dst list time:  0.1091620922088623
time for parepare:  0.01779937744140625
local_output_nid generation:  0.025979280471801758
local_in_edges_tensor generation:  0.056352853775024414
mini_batch_src_global generation:  0.05154132843017578
r_  generation:  0.4911026954650879
local_output_nid generation:  0.03120136260986328
local_in_edges_tensor generation:  0.04829907417297363
mini_batch_src_global generation:  0.05945014953613281
r_  generation:  0.4876730442047119
local_output_nid generation:  0.03180336952209473
local_in_edges_tensor generation:  0.046515464782714844
mini_batch_src_global generation:  0.05615639686584473
r_  generation:  0.49817490577697754
local_output_nid generation:  0.029424190521240234
local_in_edges_tensor generation:  0.03032517433166504
mini_batch_src_global generation:  0.06165623664855957
r_  generation:  0.4942202568054199
local_output_nid generation:  0.029446840286254883
local_in_edges_tensor generation:  0.034477949142456055
mini_batch_src_global generation:  0.057717084884643555
r_  generation:  0.4981558322906494
local_output_nid generation:  0.029979944229125977
local_in_edges_tensor generation:  0.037355661392211914
mini_batch_src_global generation:  0.06265377998352051
r_  generation:  0.49404072761535645
local_output_nid generation:  0.03023052215576172
local_in_edges_tensor generation:  0.030205488204956055
mini_batch_src_global generation:  0.05846405029296875
r_  generation:  0.49779772758483887
local_output_nid generation:  0.029904842376708984
local_in_edges_tensor generation:  0.030020713806152344
mini_batch_src_global generation:  0.060053110122680664
r_  generation:  0.5079121589660645
local_output_nid generation:  0.030193805694580078
local_in_edges_tensor generation:  0.03943157196044922
mini_batch_src_global generation:  0.05815911293029785
r_  generation:  0.5046639442443848
local_output_nid generation:  0.029972553253173828
local_in_edges_tensor generation:  0.03469276428222656
mini_batch_src_global generation:  0.05971932411193848
r_  generation:  0.4982895851135254
local_output_nid generation:  0.029429197311401367
local_in_edges_tensor generation:  0.034132957458496094
mini_batch_src_global generation:  0.05788874626159668
r_  generation:  0.49860334396362305
local_output_nid generation:  0.029828786849975586
local_in_edges_tensor generation:  0.039259910583496094
mini_batch_src_global generation:  0.05936551094055176
r_  generation:  0.5039455890655518
local_output_nid generation:  0.029933691024780273
local_in_edges_tensor generation:  0.03430008888244629
mini_batch_src_global generation:  0.05792236328125
r_  generation:  0.499875545501709
local_output_nid generation:  0.030111074447631836
local_in_edges_tensor generation:  0.03429007530212402
mini_batch_src_global generation:  0.058838844299316406
r_  generation:  0.4991292953491211
local_output_nid generation:  0.03051924705505371
local_in_edges_tensor generation:  0.03428006172180176
mini_batch_src_global generation:  0.05861306190490723
r_  generation:  0.5017690658569336
local_output_nid generation:  0.03169560432434082
local_in_edges_tensor generation:  0.03431534767150879
mini_batch_src_global generation:  0.058957815170288086
r_  generation:  0.4993715286254883
local_output_nid generation:  0.030284404754638672
local_in_edges_tensor generation:  0.040283203125
mini_batch_src_global generation:  0.06022810935974121
r_  generation:  0.5041780471801758
local_output_nid generation:  0.030093908309936523
local_in_edges_tensor generation:  0.03459978103637695
mini_batch_src_global generation:  0.05979585647583008
r_  generation:  0.49640941619873047
local_output_nid generation:  0.030108213424682617
local_in_edges_tensor generation:  0.03995490074157715
mini_batch_src_global generation:  0.06146240234375
r_  generation:  0.5071029663085938
local_output_nid generation:  0.030151844024658203
local_in_edges_tensor generation:  0.04105329513549805
mini_batch_src_global generation:  0.0602879524230957
r_  generation:  0.4978206157684326
local_output_nid generation:  0.031035184860229492
local_in_edges_tensor generation:  0.030835628509521484
mini_batch_src_global generation:  0.06415510177612305
r_  generation:  0.5030717849731445
local_output_nid generation:  0.030656814575195312
local_in_edges_tensor generation:  0.04379630088806152
mini_batch_src_global generation:  0.07783746719360352
r_  generation:  0.50201416015625
local_output_nid generation:  0.031648874282836914
local_in_edges_tensor generation:  0.03564000129699707
mini_batch_src_global generation:  0.06518864631652832
r_  generation:  0.4981367588043213
local_output_nid generation:  0.030240535736083984
local_in_edges_tensor generation:  0.03501486778259277
mini_batch_src_global generation:  0.06264448165893555
r_  generation:  0.4982938766479492
local_output_nid generation:  0.030302762985229492
local_in_edges_tensor generation:  0.03502941131591797
mini_batch_src_global generation:  0.05881929397583008
r_  generation:  0.500499963760376
local_output_nid generation:  0.030455350875854492
local_in_edges_tensor generation:  0.044634103775024414
mini_batch_src_global generation:  0.07896828651428223
r_  generation:  0.5073235034942627
local_output_nid generation:  0.030503511428833008
local_in_edges_tensor generation:  0.03615164756774902
mini_batch_src_global generation:  0.05924487113952637
r_  generation:  0.5054903030395508
local_output_nid generation:  0.030616044998168945
local_in_edges_tensor generation:  0.030783653259277344
mini_batch_src_global generation:  0.059484243392944336
r_  generation:  0.500784158706665
local_output_nid generation:  0.030129671096801758
local_in_edges_tensor generation:  0.03372836112976074
mini_batch_src_global generation:  0.057793378829956055
r_  generation:  0.5002987384796143
local_output_nid generation:  0.030499935150146484
local_in_edges_tensor generation:  0.03532671928405762
mini_batch_src_global generation:  0.05963754653930664
r_  generation:  0.5014495849609375
local_output_nid generation:  0.030505657196044922
local_in_edges_tensor generation:  0.03501439094543457
mini_batch_src_global generation:  0.05968427658081055
r_  generation:  0.5097308158874512
local_output_nid generation:  0.03030681610107422
local_in_edges_tensor generation:  0.030838966369628906
mini_batch_src_global generation:  0.06274294853210449
r_  generation:  0.49936532974243164
----------------------check_connections_block total spend ----------------------------- 23.59221649169922
generate_one_block  0.701596736907959
generate_one_block  0.6933703422546387
generate_one_block  0.6846508979797363
generate_one_block  0.6937758922576904
generate_one_block  0.7689511775970459
generate_one_block  0.6856646537780762
generate_one_block  0.6801116466522217
generate_one_block  0.6699910163879395
generate_one_block  0.6848576068878174
generate_one_block  0.6676201820373535
generate_one_block  0.6633505821228027
generate_one_block  0.692716121673584
generate_one_block  0.6608314514160156
generate_one_block  0.6850244998931885
generate_one_block  0.6807026863098145
generate_one_block  0.670088529586792
generate_one_block  0.686793327331543
generate_one_block  0.6697220802307129
generate_one_block  0.6780385971069336
generate_one_block  0.6699497699737549
generate_one_block  0.686917781829834
generate_one_block  0.6936817169189453
generate_one_block  0.6665692329406738
generate_one_block  0.6800463199615479
generate_one_block  0.6889746189117432
generate_one_block  0.6982877254486084
generate_one_block  0.6954343318939209
generate_one_block  0.6651153564453125
generate_one_block  0.6649959087371826
generate_one_block  0.6755456924438477
generate_one_block  0.6759662628173828
generate_one_block  0.6752958297729492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.11355733871459961  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

connection checking time:  32.42423963546753
block generation total time  29.88089609146118
average batch blocks generation time:  0.9337780028581619
block dataloader generation time/epoch 66.02094554901123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09127187728881836  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150265, 128])
torch.Size([109531, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.048233032226562  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09079170227050781  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150150, 128])
torch.Size([110091, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.116714477539062  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09128665924072266  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150508, 128])
torch.Size([110162, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.069557666778564  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09090805053710938  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150336, 128])
torch.Size([110860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.16200876235962  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09128761291503906  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([149719, 128])
torch.Size([108727, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.027547359466553  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09093475341796875  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150582, 128])
torch.Size([110301, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.11430549621582  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09123802185058594  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150611, 128])
torch.Size([110187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.069343566894531  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09055280685424805  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150011, 128])
torch.Size([109154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.036379337310791  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09134292602539062  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150414, 128])
torch.Size([110558, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.116628646850586  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09059381484985352  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150329, 128])
torch.Size([109611, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.040996074676514  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09109115600585938  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150123, 128])
torch.Size([108555, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 12.955275058746338  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09066295623779297  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150066, 128])
torch.Size([110088, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.096717357635498  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09023094177246094  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([149484, 128])
torch.Size([108611, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 12.987224578857422  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09104299545288086  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150649, 128])
torch.Size([110598, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.156384468078613  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09136009216308594  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150511, 128])
torch.Size([110007, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.081599712371826  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09061908721923828  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150178, 128])
torch.Size([109369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.067793369293213  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09151744842529297  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150431, 128])
torch.Size([110104, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.146219730377197  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09051799774169922  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150194, 128])
torch.Size([109298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.00950574874878  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09138298034667969  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150274, 128])
torch.Size([109660, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.104216575622559  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.0907282829284668  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150335, 128])
torch.Size([109024, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.053844928741455  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09148693084716797  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150192, 128])
torch.Size([109955, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.137170791625977  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09076118469238281  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150280, 128])
torch.Size([110185, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.098783016204834  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09137630462646484  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([149922, 128])
torch.Size([108958, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.045384883880615  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09068107604980469  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150170, 128])
torch.Size([109599, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.072442531585693  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09131240844726562  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150247, 128])
torch.Size([109779, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.079628467559814  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09101247787475586  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150475, 128])
torch.Size([109992, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.173190593719482  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09153175354003906  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150641, 128])
torch.Size([110625, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.164365768432617  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09093570709228516  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150644, 128])
torch.Size([110258, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.099135875701904  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09119796752929688  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150103, 128])
torch.Size([108881, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 12.98917293548584  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09108781814575195  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150493, 128])
torch.Size([110762, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.20745038986206  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.09133052825927734  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150755, 128])
torch.Size([110311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.104313373565674  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 0.0908651351928711  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

torch.Size([150058, 128])
torch.Size([109611, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.5819091796875 GB
    Memory Allocated: 13.170507907867432  GigaBytes
Max Memory Allocated: 13.332682132720947  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021955914795398712 |0.018954597413539886 |0.5994694605469704 |9.514391422271729e-05 |0.9976910948753357 |0.010947704315185547 |
----------------------------------------------------------pseudo_mini_loss sum 3.701021909713745
Total (block generation + training)time/epoch 118.56873273849487
Training time/epoch 52.54745435714722
Training time without block to device /epoch 51.94090723991394
Training time without total dataloading part /epoch 51.123130083084106
load block tensor time/epoch 0.7025892734527588
block to device time/epoch 0.6065471172332764
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9162951
Number of first layer input nodes during this epoch:  4809150
