Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648469671.577541
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029951095581054688
range selection method range initialization spend 0.016588687896728516
time for parepare:  0.018553972244262695
local_output_nid generation:  0.0014336109161376953
local_in_edges_tensor generation:  0.004332780838012695
mini_batch_src_global generation:  0.0024068355560302734
r_  generation:  0.028516054153442383
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.0009405612945556641
mini_batch_src_global generation:  0.002560138702392578
r_  generation:  0.020245790481567383
local_output_nid generation:  0.0015406608581542969
local_in_edges_tensor generation:  0.0009160041809082031
mini_batch_src_global generation:  0.0015420913696289062
r_  generation:  0.019448280334472656
local_output_nid generation:  0.0015399456024169922
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.001651763916015625
r_  generation:  0.020017385482788086
local_output_nid generation:  0.0015285015106201172
local_in_edges_tensor generation:  0.0008878707885742188
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.020001888275146484
local_output_nid generation:  0.0015411376953125
local_in_edges_tensor generation:  0.0008585453033447266
mini_batch_src_global generation:  0.0017919540405273438
r_  generation:  0.02134227752685547
local_output_nid generation:  0.0015425682067871094
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0017924308776855469
r_  generation:  0.020853281021118164
local_output_nid generation:  0.0015819072723388672
local_in_edges_tensor generation:  0.0008785724639892578
mini_batch_src_global generation:  0.0017371177673339844
r_  generation:  0.021181583404541016
local_output_nid generation:  0.001627206802368164
local_in_edges_tensor generation:  0.0008816719055175781
mini_batch_src_global generation:  0.0017390251159667969
r_  generation:  0.021070003509521484
local_output_nid generation:  0.0016052722930908203
local_in_edges_tensor generation:  0.0008943080902099609
mini_batch_src_global generation:  0.0017917156219482422
r_  generation:  0.021573305130004883
local_output_nid generation:  0.0016067028045654297
local_in_edges_tensor generation:  0.0008792877197265625
mini_batch_src_global generation:  0.0018687248229980469
r_  generation:  0.02118682861328125
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.0008611679077148438
mini_batch_src_global generation:  0.001819610595703125
r_  generation:  0.021557092666625977
local_output_nid generation:  0.0015461444854736328
local_in_edges_tensor generation:  0.0008952617645263672
mini_batch_src_global generation:  0.0018672943115234375
r_  generation:  0.022263288497924805
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0009179115295410156
mini_batch_src_global generation:  0.0019321441650390625
r_  generation:  0.021895408630371094
local_output_nid generation:  0.0015485286712646484
local_in_edges_tensor generation:  0.0008780956268310547
mini_batch_src_global generation:  0.0019147396087646484
r_  generation:  0.022136211395263672
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0018205642700195312
r_  generation:  0.021740198135375977
----------------------check_connections_block total spend ----------------------------- 0.5168538093566895
generate_one_block  0.030283212661743164
generate_one_block  0.031104326248168945
generate_one_block  0.03196597099304199
generate_one_block  0.031024694442749023
generate_one_block  0.030709028244018555
generate_one_block  0.031508445739746094
generate_one_block  0.030178070068359375
generate_one_block  0.030596256256103516
generate_one_block  0.030495882034301758
generate_one_block  0.03143477439880371
generate_one_block  0.0308382511138916
generate_one_block  0.030855894088745117
generate_one_block  0.031842708587646484
generate_one_block  0.030935049057006836
generate_one_block  0.0315859317779541
generate_one_block  0.031415462493896484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03922772407531738
gen group dst list time:  0.02067708969116211
time for parepare:  0.02038097381591797
local_output_nid generation:  0.007371187210083008
local_in_edges_tensor generation:  0.02024531364440918
mini_batch_src_global generation:  0.02254486083984375
r_  generation:  0.21107721328735352
local_output_nid generation:  0.013528823852539062
local_in_edges_tensor generation:  0.020023345947265625
mini_batch_src_global generation:  0.029045820236206055
r_  generation:  0.22243332862854004
local_output_nid generation:  0.01370859146118164
local_in_edges_tensor generation:  0.01648092269897461
mini_batch_src_global generation:  0.028573274612426758
r_  generation:  0.2230379581451416
local_output_nid generation:  0.014322757720947266
local_in_edges_tensor generation:  0.01246190071105957
mini_batch_src_global generation:  0.0380556583404541
r_  generation:  0.22684884071350098
local_output_nid generation:  0.014725923538208008
local_in_edges_tensor generation:  0.016901254653930664
mini_batch_src_global generation:  0.04160785675048828
r_  generation:  0.23229193687438965
local_output_nid generation:  0.015130996704101562
local_in_edges_tensor generation:  0.01735091209411621
mini_batch_src_global generation:  0.031167984008789062
r_  generation:  0.2324235439300537
local_output_nid generation:  0.015059709548950195
local_in_edges_tensor generation:  0.019466638565063477
mini_batch_src_global generation:  0.030667781829833984
r_  generation:  0.22878623008728027
local_output_nid generation:  0.015359163284301758
local_in_edges_tensor generation:  0.01514744758605957
mini_batch_src_global generation:  0.03623795509338379
r_  generation:  0.23570036888122559
local_output_nid generation:  0.01532602310180664
local_in_edges_tensor generation:  0.01908564567565918
mini_batch_src_global generation:  0.03081655502319336
r_  generation:  0.23540353775024414
local_output_nid generation:  0.01550745964050293
local_in_edges_tensor generation:  0.013638734817504883
mini_batch_src_global generation:  0.0308840274810791
r_  generation:  0.23151040077209473
local_output_nid generation:  0.015299320220947266
local_in_edges_tensor generation:  0.013575315475463867
mini_batch_src_global generation:  0.031075477600097656
r_  generation:  0.23548293113708496
local_output_nid generation:  0.015436887741088867
local_in_edges_tensor generation:  0.015489578247070312
mini_batch_src_global generation:  0.031282901763916016
r_  generation:  0.23340415954589844
local_output_nid generation:  0.015461921691894531
local_in_edges_tensor generation:  0.017783641815185547
mini_batch_src_global generation:  0.030949831008911133
r_  generation:  0.2374577522277832
local_output_nid generation:  0.015509605407714844
local_in_edges_tensor generation:  0.019740819931030273
mini_batch_src_global generation:  0.031336069107055664
r_  generation:  0.23514652252197266
local_output_nid generation:  0.015784502029418945
local_in_edges_tensor generation:  0.013845205307006836
mini_batch_src_global generation:  0.03671908378601074
r_  generation:  0.2441103458404541
local_output_nid generation:  0.01571202278137207
local_in_edges_tensor generation:  0.015932321548461914
mini_batch_src_global generation:  0.032088279724121094
r_  generation:  0.2383577823638916
----------------------check_connections_block total spend ----------------------------- 5.577883958816528
generate_one_block  0.3079359531402588
generate_one_block  0.304119348526001
generate_one_block  0.29590630531311035
generate_one_block  0.29790830612182617
generate_one_block  0.31344032287597656
generate_one_block  0.30573439598083496
generate_one_block  0.30196309089660645
generate_one_block  0.304673433303833
generate_one_block  0.3061089515686035
generate_one_block  0.2969779968261719
generate_one_block  0.3135569095611572
generate_one_block  0.3048527240753174
generate_one_block  0.31464195251464844
generate_one_block  0.31508827209472656
generate_one_block  0.32578134536743164
generate_one_block  0.3136179447174072
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0640716552734375
gen group dst list time:  0.07474231719970703
time for parepare:  0.022164344787597656
local_output_nid generation:  0.02491593360900879
local_in_edges_tensor generation:  0.07042479515075684
mini_batch_src_global generation:  0.04570889472961426
r_  generation:  0.4627385139465332
local_output_nid generation:  0.03039717674255371
local_in_edges_tensor generation:  0.048604488372802734
mini_batch_src_global generation:  0.054625749588012695
r_  generation:  0.4525320529937744
local_output_nid generation:  0.03409910202026367
local_in_edges_tensor generation:  0.04325509071350098
mini_batch_src_global generation:  0.053835391998291016
r_  generation:  0.4747498035430908
local_output_nid generation:  0.03378152847290039
local_in_edges_tensor generation:  0.04281473159790039
mini_batch_src_global generation:  0.0673213005065918
r_  generation:  0.4511892795562744
local_output_nid generation:  0.031642913818359375
local_in_edges_tensor generation:  0.03828859329223633
mini_batch_src_global generation:  0.05486440658569336
r_  generation:  0.46990084648132324
local_output_nid generation:  0.03164076805114746
local_in_edges_tensor generation:  0.040673017501831055
mini_batch_src_global generation:  0.055976152420043945
r_  generation:  0.46088337898254395
local_output_nid generation:  0.03185582160949707
local_in_edges_tensor generation:  0.053205251693725586
mini_batch_src_global generation:  0.05691170692443848
r_  generation:  0.4663197994232178
local_output_nid generation:  0.033153533935546875
local_in_edges_tensor generation:  0.03438687324523926
mini_batch_src_global generation:  0.059065818786621094
r_  generation:  0.47573137283325195
local_output_nid generation:  0.03383469581604004
local_in_edges_tensor generation:  0.03972792625427246
mini_batch_src_global generation:  0.06374073028564453
r_  generation:  0.46750807762145996
local_output_nid generation:  0.032065629959106445
local_in_edges_tensor generation:  0.03529071807861328
mini_batch_src_global generation:  0.05646085739135742
r_  generation:  0.45861148834228516
local_output_nid generation:  0.031963348388671875
local_in_edges_tensor generation:  0.03714489936828613
mini_batch_src_global generation:  0.054923295974731445
r_  generation:  0.4716756343841553
local_output_nid generation:  0.032074689865112305
local_in_edges_tensor generation:  0.032718658447265625
mini_batch_src_global generation:  0.057013750076293945
r_  generation:  0.4763460159301758
local_output_nid generation:  0.03391242027282715
local_in_edges_tensor generation:  0.029831886291503906
mini_batch_src_global generation:  0.055651187896728516
r_  generation:  0.4687466621398926
local_output_nid generation:  0.035562992095947266
local_in_edges_tensor generation:  0.03357267379760742
mini_batch_src_global generation:  0.05657219886779785
r_  generation:  0.4609260559082031
local_output_nid generation:  0.03230428695678711
local_in_edges_tensor generation:  0.03844571113586426
mini_batch_src_global generation:  0.055510759353637695
r_  generation:  0.46689629554748535
local_output_nid generation:  0.03269076347351074
local_in_edges_tensor generation:  0.04764509201049805
mini_batch_src_global generation:  0.05699753761291504
r_  generation:  0.4636368751525879
----------------------check_connections_block total spend ----------------------------- 11.226158142089844
generate_one_block  0.5925135612487793
generate_one_block  0.5999431610107422
generate_one_block  0.5751376152038574
generate_one_block  0.5913395881652832
generate_one_block  0.5794010162353516
generate_one_block  0.5807623863220215
generate_one_block  0.639270544052124
generate_one_block  0.58199143409729
generate_one_block  0.5959594249725342
generate_one_block  0.5909409523010254
generate_one_block  0.5920543670654297
generate_one_block  0.5940027236938477
generate_one_block  0.583704948425293
generate_one_block  0.5853912830352783
generate_one_block  0.5944423675537109
generate_one_block  0.5965292453765869
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  16.804042100906372
block generation total time  14.395691871643066
average batch blocks generation time:  0.8997307419776917
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09147405624389648  GigaBytes
Max Memory Allocated: 0.09147405624389648  GigaBytes

torch.Size([154974, 128])
torch.Size([125076, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 13.671144962310791  GigaBytes
Max Memory Allocated: 13.68734359741211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6151123046875 GB
    Memory Allocated: 0.09297800064086914  GigaBytes
Max Memory Allocated: 13.68734359741211  GigaBytes

torch.Size([155053, 128])
torch.Size([125397, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6307373046875 GB
    Memory Allocated: 13.75058364868164  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6307373046875 GB
    Memory Allocated: 0.09304618835449219  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([154936, 128])
torch.Size([124567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 13.6272292137146  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 0.0927891731262207  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155129, 128])
torch.Size([124848, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6795654296875 GB
    Memory Allocated: 13.627540111541748  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6795654296875 GB
    Memory Allocated: 0.09305667877197266  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([154777, 128])
torch.Size([124377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.62609052658081  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09294891357421875  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155066, 128])
torch.Size([124996, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.733696460723877  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09307003021240234  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155050, 128])
torch.Size([124662, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.639089584350586  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09289073944091797  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155024, 128])
torch.Size([124584, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.697807788848877  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09323310852050781  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155029, 128])
torch.Size([124796, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.723652362823486  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09285783767700195  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155077, 128])
torch.Size([124800, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.676283836364746  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09324932098388672  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155027, 128])
torch.Size([124948, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.748932361602783  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09302711486816406  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([155244, 128])
torch.Size([125132, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.726789951324463  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09331893920898438  GigaBytes
Max Memory Allocated: 13.767474174499512  GigaBytes

torch.Size([154895, 128])
torch.Size([124867, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.794000148773193  GigaBytes
Max Memory Allocated: 13.81195068359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09308338165283203  GigaBytes
Max Memory Allocated: 13.81195068359375  GigaBytes

torch.Size([155180, 128])
torch.Size([125131, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 13.771796226501465  GigaBytes
Max Memory Allocated: 13.81195068359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 0.09342384338378906  GigaBytes
Max Memory Allocated: 13.81195068359375  GigaBytes

torch.Size([155170, 128])
torch.Size([125324, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.847951889038086  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09321212768554688  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155320, 128])
torch.Size([125571, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.815399646759033  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037483155727386475 |0.043092310428619385 |0.45661959052085876 |0.00010663270950317383 |0.6915854811668396 |0.011844158172607422 |
----------------------------------------------------------pseudo_mini_loss sum 4.9502692222595215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5210408
Number of first layer input nodes during this epoch:  2480951
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.12066841125488281  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0260775089263916
range selection method range initialization spend 0.012800931930541992
time for parepare:  0.017633914947509766
local_output_nid generation:  0.002002239227294922
local_in_edges_tensor generation:  0.004237651824951172
mini_batch_src_global generation:  0.002218484878540039
r_  generation:  0.020706892013549805
local_output_nid generation:  0.0019102096557617188
local_in_edges_tensor generation:  0.0010581016540527344
mini_batch_src_global generation:  0.0026509761810302734
r_  generation:  0.02180933952331543
local_output_nid generation:  0.0017702579498291016
local_in_edges_tensor generation:  0.0009319782257080078
mini_batch_src_global generation:  0.0016696453094482422
r_  generation:  0.02040553092956543
local_output_nid generation:  0.0017938613891601562
local_in_edges_tensor generation:  0.0009424686431884766
mini_batch_src_global generation:  0.0016863346099853516
r_  generation:  0.021185636520385742
local_output_nid generation:  0.0017628669738769531
local_in_edges_tensor generation:  0.0009562969207763672
mini_batch_src_global generation:  0.0017321109771728516
r_  generation:  0.021639585494995117
local_output_nid generation:  0.0017926692962646484
local_in_edges_tensor generation:  0.0009601116180419922
mini_batch_src_global generation:  0.0017745494842529297
r_  generation:  0.021561384201049805
local_output_nid generation:  0.001786947250366211
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0018298625946044922
r_  generation:  0.022438764572143555
local_output_nid generation:  0.0017960071563720703
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0018382072448730469
r_  generation:  0.022039413452148438
local_output_nid generation:  0.0017838478088378906
local_in_edges_tensor generation:  0.001008749008178711
mini_batch_src_global generation:  0.0018570423126220703
r_  generation:  0.02220320701599121
local_output_nid generation:  0.0018587112426757812
local_in_edges_tensor generation:  0.0009434223175048828
mini_batch_src_global generation:  0.0018146038055419922
r_  generation:  0.021486997604370117
local_output_nid generation:  0.0018169879913330078
local_in_edges_tensor generation:  0.0009648799896240234
mini_batch_src_global generation:  0.001855611801147461
r_  generation:  0.022614240646362305
local_output_nid generation:  0.0017273426055908203
local_in_edges_tensor generation:  0.0009171962738037109
mini_batch_src_global generation:  0.0018649101257324219
r_  generation:  0.022311925888061523
local_output_nid generation:  0.0017414093017578125
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.001819610595703125
r_  generation:  0.022284269332885742
local_output_nid generation:  0.0017039775848388672
local_in_edges_tensor generation:  0.001062154769897461
mini_batch_src_global generation:  0.0018105506896972656
r_  generation:  0.02157115936279297
local_output_nid generation:  0.0017285346984863281
local_in_edges_tensor generation:  0.0013031959533691406
mini_batch_src_global generation:  0.00189971923828125
r_  generation:  0.022684574127197266
local_output_nid generation:  0.0017826557159423828
local_in_edges_tensor generation:  0.0009675025939941406
mini_batch_src_global generation:  0.0018863677978515625
r_  generation:  0.021733522415161133
----------------------check_connections_block total spend ----------------------------- 0.5253500938415527
generate_one_block  0.04236745834350586
generate_one_block  0.03827023506164551
generate_one_block  0.036371469497680664
generate_one_block  0.03670668601989746
generate_one_block  0.038338422775268555
generate_one_block  0.03866934776306152
generate_one_block  0.03890395164489746
generate_one_block  0.038036346435546875
generate_one_block  0.0380549430847168
generate_one_block  0.036101341247558594
generate_one_block  0.03775620460510254
generate_one_block  0.03669929504394531
generate_one_block  0.03741598129272461
generate_one_block  0.03614544868469238
generate_one_block  0.03771328926086426
generate_one_block  0.03736090660095215
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03829312324523926
gen group dst list time:  0.019524097442626953
time for parepare:  0.019588232040405273
local_output_nid generation:  0.00845789909362793
local_in_edges_tensor generation:  0.01942753791809082
mini_batch_src_global generation:  0.02500128746032715
r_  generation:  0.21949243545532227
local_output_nid generation:  0.01221776008605957
local_in_edges_tensor generation:  0.01996779441833496
mini_batch_src_global generation:  0.0311124324798584
r_  generation:  0.23201298713684082
local_output_nid generation:  0.012837409973144531
local_in_edges_tensor generation:  0.01603221893310547
mini_batch_src_global generation:  0.027529478073120117
r_  generation:  0.2302401065826416
local_output_nid generation:  0.012861251831054688
local_in_edges_tensor generation:  0.017248868942260742
mini_batch_src_global generation:  0.029016971588134766
r_  generation:  0.23434185981750488
local_output_nid generation:  0.013197898864746094
local_in_edges_tensor generation:  0.01757979393005371
mini_batch_src_global generation:  0.030179977416992188
r_  generation:  0.23998761177062988
local_output_nid generation:  0.01287984848022461
local_in_edges_tensor generation:  0.013123512268066406
mini_batch_src_global generation:  0.030618667602539062
r_  generation:  0.23797917366027832
local_output_nid generation:  0.012751579284667969
local_in_edges_tensor generation:  0.021132707595825195
mini_batch_src_global generation:  0.03343391418457031
r_  generation:  0.24628639221191406
local_output_nid generation:  0.014075040817260742
local_in_edges_tensor generation:  0.02189469337463379
mini_batch_src_global generation:  0.032399654388427734
r_  generation:  0.2419261932373047
local_output_nid generation:  0.014560222625732422
local_in_edges_tensor generation:  0.015407562255859375
mini_batch_src_global generation:  0.033716440200805664
r_  generation:  0.23981690406799316
local_output_nid generation:  0.013347148895263672
local_in_edges_tensor generation:  0.014293432235717773
mini_batch_src_global generation:  0.030688047409057617
r_  generation:  0.23175978660583496
local_output_nid generation:  0.013738393783569336
local_in_edges_tensor generation:  0.014748096466064453
mini_batch_src_global generation:  0.030947446823120117
r_  generation:  0.2371535301208496
local_output_nid generation:  0.013518571853637695
local_in_edges_tensor generation:  0.01744246482849121
mini_batch_src_global generation:  0.030704259872436523
r_  generation:  0.23629212379455566
local_output_nid generation:  0.013613700866699219
local_in_edges_tensor generation:  0.013216495513916016
mini_batch_src_global generation:  0.03092479705810547
r_  generation:  0.23792338371276855
local_output_nid generation:  0.013554573059082031
local_in_edges_tensor generation:  0.013316154479980469
mini_batch_src_global generation:  0.030689716339111328
r_  generation:  0.23313617706298828
local_output_nid generation:  0.013939857482910156
local_in_edges_tensor generation:  0.015976905822753906
mini_batch_src_global generation:  0.030791044235229492
r_  generation:  0.24103021621704102
local_output_nid generation:  0.013645648956298828
local_in_edges_tensor generation:  0.015003204345703125
mini_batch_src_global generation:  0.030922651290893555
r_  generation:  0.2385878562927246
----------------------check_connections_block total spend ----------------------------- 5.621083736419678
generate_one_block  0.33283090591430664
generate_one_block  0.33426475524902344
generate_one_block  0.33020997047424316
generate_one_block  0.3240833282470703
generate_one_block  0.3309042453765869
generate_one_block  0.3203442096710205
generate_one_block  0.35022425651550293
generate_one_block  0.32069945335388184
generate_one_block  0.32503223419189453
generate_one_block  0.31238675117492676
generate_one_block  0.33136916160583496
generate_one_block  0.3512687683105469
generate_one_block  0.32021474838256836
generate_one_block  0.3177759647369385
generate_one_block  0.32812929153442383
generate_one_block  0.3123745918273926
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0459904670715332
gen group dst list time:  0.06950616836547852
time for parepare:  0.01904582977294922
local_output_nid generation:  0.028577089309692383
local_in_edges_tensor generation:  0.05370330810546875
mini_batch_src_global generation:  0.04825735092163086
r_  generation:  0.44057774543762207
local_output_nid generation:  0.030730247497558594
local_in_edges_tensor generation:  0.045612335205078125
mini_batch_src_global generation:  0.05434870719909668
r_  generation:  0.4508998394012451
local_output_nid generation:  0.03125190734863281
local_in_edges_tensor generation:  0.04249286651611328
mini_batch_src_global generation:  0.05261945724487305
r_  generation:  0.4610164165496826
local_output_nid generation:  0.0313720703125
local_in_edges_tensor generation:  0.03011322021484375
mini_batch_src_global generation:  0.05565619468688965
r_  generation:  0.4653618335723877
local_output_nid generation:  0.03192758560180664
local_in_edges_tensor generation:  0.07475924491882324
mini_batch_src_global generation:  0.05791068077087402
r_  generation:  0.47165894508361816
local_output_nid generation:  0.0319979190826416
local_in_edges_tensor generation:  0.046269893646240234
mini_batch_src_global generation:  0.05587625503540039
r_  generation:  0.4676060676574707
local_output_nid generation:  0.03188681602478027
local_in_edges_tensor generation:  0.030267000198364258
mini_batch_src_global generation:  0.05559849739074707
r_  generation:  0.46833252906799316
local_output_nid generation:  0.03207683563232422
local_in_edges_tensor generation:  0.030387401580810547
mini_batch_src_global generation:  0.057672739028930664
r_  generation:  0.46575307846069336
local_output_nid generation:  0.032063961029052734
local_in_edges_tensor generation:  0.038181304931640625
mini_batch_src_global generation:  0.05793452262878418
r_  generation:  0.4722425937652588
local_output_nid generation:  0.03193187713623047
local_in_edges_tensor generation:  0.030524253845214844
mini_batch_src_global generation:  0.055744171142578125
r_  generation:  0.4633803367614746
local_output_nid generation:  0.03221392631530762
local_in_edges_tensor generation:  0.03443598747253418
mini_batch_src_global generation:  0.05828857421875
r_  generation:  0.47478246688842773
local_output_nid generation:  0.0323028564453125
local_in_edges_tensor generation:  0.03118729591369629
mini_batch_src_global generation:  0.05624651908874512
r_  generation:  0.465411901473999
local_output_nid generation:  0.0321192741394043
local_in_edges_tensor generation:  0.0339353084564209
mini_batch_src_global generation:  0.05794954299926758
r_  generation:  0.46656203269958496
local_output_nid generation:  0.03320050239562988
local_in_edges_tensor generation:  0.04121065139770508
mini_batch_src_global generation:  0.055959224700927734
r_  generation:  0.4635636806488037
local_output_nid generation:  0.03191995620727539
local_in_edges_tensor generation:  0.03826117515563965
mini_batch_src_global generation:  0.057520389556884766
r_  generation:  0.4717566967010498
local_output_nid generation:  0.03315162658691406
local_in_edges_tensor generation:  0.03233504295349121
mini_batch_src_global generation:  0.057007551193237305
r_  generation:  0.46732616424560547
----------------------check_connections_block total spend ----------------------------- 11.151281356811523
generate_one_block  0.6480472087860107
generate_one_block  0.6600511074066162
generate_one_block  0.6160910129547119
generate_one_block  0.6013712882995605
generate_one_block  0.6162190437316895
generate_one_block  0.6133430004119873
generate_one_block  0.6032633781433105
generate_one_block  0.60237717628479
generate_one_block  0.6419010162353516
generate_one_block  0.6067214012145996
generate_one_block  0.6075530052185059
generate_one_block  0.6536746025085449
generate_one_block  0.6235675811767578
generate_one_block  0.648129940032959
generate_one_block  0.6235458850860596
generate_one_block  0.6008820533752441
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.12066841125488281  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

connection checking time:  16.7723650932312
block generation total time  15.208851337432861
average batch blocks generation time:  0.9505532085895538
block dataloader generation time/epoch 34.70660448074341
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.0949397087097168  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154899, 128])
torch.Size([124707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.756879806518555  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09483480453491211  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155105, 128])
torch.Size([125220, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.81743574142456  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09485054016113281  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155250, 128])
torch.Size([125148, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.675572872161865  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09456443786621094  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154928, 128])
torch.Size([124632, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.698273181915283  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09508800506591797  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155021, 128])
torch.Size([125647, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.830143451690674  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09474563598632812  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155394, 128])
torch.Size([125174, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.725435733795166  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09496212005615234  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154804, 128])
torch.Size([124690, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.75026798248291  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09466171264648438  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155152, 128])
torch.Size([124981, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.697322368621826  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09499168395996094  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154838, 128])
torch.Size([124779, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.762656688690186  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09436321258544922  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154924, 128])
torch.Size([124349, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.588304996490479  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09494400024414062  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154983, 128])
torch.Size([125020, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.749629974365234  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09459495544433594  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155092, 128])
torch.Size([124665, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.67711877822876  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.0948781967163086  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154732, 128])
torch.Size([124267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.685918807983398  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.0943746566772461  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154816, 128])
torch.Size([124631, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.646775245666504  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.0949850082397461  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([155186, 128])
torch.Size([125099, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.756933212280273  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 0.09450864791870117  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

torch.Size([154999, 128])
torch.Size([124510, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.665593147277832  GigaBytes
Max Memory Allocated: 13.86517333984375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035541832447052 |0.020102620124816895 |0.41986997425556183 |9.88394021987915e-05 |0.6629772931337357 |0.007396221160888672 |
----------------------------------------------------------pseudo_mini_loss sum 3.792482614517212
Total (block generation + training)time/epoch 52.96330451965332
Training time/epoch 18.25645136833191
Training time without block to device /epoch 17.93480944633484
Training time without total dataloading part /epoch 17.33453392982483
load block tensor time/epoch 0.568669319152832
block to device time/epoch 0.3216419219970703
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5207945
Number of first layer input nodes during this epoch:  2480123
