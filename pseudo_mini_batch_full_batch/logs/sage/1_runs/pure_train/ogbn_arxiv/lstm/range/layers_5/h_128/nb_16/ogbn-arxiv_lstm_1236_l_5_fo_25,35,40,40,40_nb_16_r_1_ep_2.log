Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648506520.4864066
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02498340606689453
range selection method range initialization spend 0.013380765914916992
time for parepare:  0.01790332794189453
local_output_nid generation:  0.0013458728790283203
local_in_edges_tensor generation:  0.0037696361541748047
mini_batch_src_global generation:  0.0017635822296142578
r_  generation:  0.01808619499206543
local_output_nid generation:  0.0014157295227050781
local_in_edges_tensor generation:  0.0008945465087890625
mini_batch_src_global generation:  0.002178192138671875
r_  generation:  0.017928123474121094
local_output_nid generation:  0.0014545917510986328
local_in_edges_tensor generation:  0.0008752346038818359
mini_batch_src_global generation:  0.001399993896484375
r_  generation:  0.018060922622680664
local_output_nid generation:  0.001455068588256836
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0013031959533691406
r_  generation:  0.018110990524291992
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0008804798126220703
mini_batch_src_global generation:  0.0013661384582519531
r_  generation:  0.017658710479736328
local_output_nid generation:  0.0015053749084472656
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.0012650489807128906
r_  generation:  0.018321752548217773
local_output_nid generation:  0.0014719963073730469
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0014901161193847656
r_  generation:  0.018500089645385742
local_output_nid generation:  0.0014355182647705078
local_in_edges_tensor generation:  0.0008409023284912109
mini_batch_src_global generation:  0.0013015270233154297
r_  generation:  0.018594026565551758
local_output_nid generation:  0.0014691352844238281
local_in_edges_tensor generation:  0.0008389949798583984
mini_batch_src_global generation:  0.0014734268188476562
r_  generation:  0.018934249877929688
local_output_nid generation:  0.0015075206756591797
local_in_edges_tensor generation:  0.0008616447448730469
mini_batch_src_global generation:  0.001346588134765625
r_  generation:  0.018479585647583008
local_output_nid generation:  0.0014629364013671875
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0014548301696777344
r_  generation:  0.01859903335571289
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0008089542388916016
mini_batch_src_global generation:  0.0013556480407714844
r_  generation:  0.018606901168823242
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.0008242130279541016
mini_batch_src_global generation:  0.00146484375
r_  generation:  0.018599748611450195
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0008349418640136719
mini_batch_src_global generation:  0.00150299072265625
r_  generation:  0.018768787384033203
local_output_nid generation:  0.001458883285522461
local_in_edges_tensor generation:  0.0008749961853027344
mini_batch_src_global generation:  0.0015099048614501953
r_  generation:  0.01895904541015625
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0008254051208496094
mini_batch_src_global generation:  0.001561880111694336
r_  generation:  0.01876664161682129
----------------------check_connections_block total spend ----------------------------- 0.44225621223449707
generate_one_block  0.02675461769104004
generate_one_block  0.02770090103149414
generate_one_block  0.027977943420410156
generate_one_block  0.02926015853881836
generate_one_block  0.02727961540222168
generate_one_block  0.027328968048095703
generate_one_block  0.027269840240478516
generate_one_block  0.027316808700561523
generate_one_block  0.02762150764465332
generate_one_block  0.026671648025512695
generate_one_block  0.027779102325439453
generate_one_block  0.027398347854614258
generate_one_block  0.02718377113342285
generate_one_block  0.02764892578125
generate_one_block  0.02797389030456543
generate_one_block  0.027215242385864258
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03999209403991699
gen group dst list time:  0.018723249435424805
time for parepare:  0.019469499588012695
local_output_nid generation:  0.006655216217041016
local_in_edges_tensor generation:  0.017282724380493164
mini_batch_src_global generation:  0.021188020706176758
r_  generation:  0.20147490501403809
local_output_nid generation:  0.011926412582397461
local_in_edges_tensor generation:  0.019025564193725586
mini_batch_src_global generation:  0.025223255157470703
r_  generation:  0.20682811737060547
local_output_nid generation:  0.012156009674072266
local_in_edges_tensor generation:  0.016036510467529297
mini_batch_src_global generation:  0.02458953857421875
r_  generation:  0.21399378776550293
local_output_nid generation:  0.012572288513183594
local_in_edges_tensor generation:  0.016155719757080078
mini_batch_src_global generation:  0.040537357330322266
r_  generation:  0.21327781677246094
local_output_nid generation:  0.012925386428833008
local_in_edges_tensor generation:  0.01217961311340332
mini_batch_src_global generation:  0.026034832000732422
r_  generation:  0.22077417373657227
local_output_nid generation:  0.012939691543579102
local_in_edges_tensor generation:  0.014387130737304688
mini_batch_src_global generation:  0.026560306549072266
r_  generation:  0.21599769592285156
local_output_nid generation:  0.013080120086669922
local_in_edges_tensor generation:  0.012747764587402344
mini_batch_src_global generation:  0.026447534561157227
r_  generation:  0.21674895286560059
local_output_nid generation:  0.013247251510620117
local_in_edges_tensor generation:  0.01615166664123535
mini_batch_src_global generation:  0.02686595916748047
r_  generation:  0.21588778495788574
local_output_nid generation:  0.01348876953125
local_in_edges_tensor generation:  0.014638900756835938
mini_batch_src_global generation:  0.029115676879882812
r_  generation:  0.22408127784729004
local_output_nid generation:  0.013421297073364258
local_in_edges_tensor generation:  0.013022422790527344
mini_batch_src_global generation:  0.029863357543945312
r_  generation:  0.21753144264221191
local_output_nid generation:  0.013524770736694336
local_in_edges_tensor generation:  0.014412879943847656
mini_batch_src_global generation:  0.02973651885986328
r_  generation:  0.2278599739074707
local_output_nid generation:  0.013393402099609375
local_in_edges_tensor generation:  0.016530275344848633
mini_batch_src_global generation:  0.030182361602783203
r_  generation:  0.2201244831085205
local_output_nid generation:  0.013478994369506836
local_in_edges_tensor generation:  0.0147552490234375
mini_batch_src_global generation:  0.029638290405273438
r_  generation:  0.22005081176757812
local_output_nid generation:  0.013516664505004883
local_in_edges_tensor generation:  0.014811038970947266
mini_batch_src_global generation:  0.027243375778198242
r_  generation:  0.2184762954711914
local_output_nid generation:  0.013586759567260742
local_in_edges_tensor generation:  0.01732182502746582
mini_batch_src_global generation:  0.029677867889404297
r_  generation:  0.22162914276123047
local_output_nid generation:  0.013405084609985352
local_in_edges_tensor generation:  0.014773130416870117
mini_batch_src_global generation:  0.027373790740966797
r_  generation:  0.21900582313537598
----------------------check_connections_block total spend ----------------------------- 5.150338172912598
generate_one_block  0.28146815299987793
generate_one_block  0.2866048812866211
generate_one_block  0.2875502109527588
generate_one_block  0.27986812591552734
generate_one_block  0.29561853408813477
generate_one_block  0.2793722152709961
generate_one_block  0.2751314640045166
generate_one_block  0.28081536293029785
generate_one_block  0.2916231155395508
generate_one_block  0.2704436779022217
generate_one_block  0.28298377990722656
generate_one_block  0.28167152404785156
generate_one_block  0.27827882766723633
generate_one_block  0.27829408645629883
generate_one_block  0.2874717712402344
generate_one_block  0.2789344787597656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04022789001464844
gen group dst list time:  0.059506893157958984
time for parepare:  0.0187532901763916
local_output_nid generation:  0.0235898494720459
local_in_edges_tensor generation:  0.03469252586364746
mini_batch_src_global generation:  0.04937887191772461
r_  generation:  0.49031805992126465
local_output_nid generation:  0.030426502227783203
local_in_edges_tensor generation:  0.048536062240600586
mini_batch_src_global generation:  0.05789899826049805
r_  generation:  0.49990129470825195
local_output_nid generation:  0.029822111129760742
local_in_edges_tensor generation:  0.04536318778991699
mini_batch_src_global generation:  0.05631279945373535
r_  generation:  0.5008935928344727
local_output_nid generation:  0.030365705490112305
local_in_edges_tensor generation:  0.03616762161254883
mini_batch_src_global generation:  0.05753970146179199
r_  generation:  0.5020933151245117
local_output_nid generation:  0.02999711036682129
local_in_edges_tensor generation:  0.03192853927612305
mini_batch_src_global generation:  0.05729937553405762
r_  generation:  0.5035278797149658
local_output_nid generation:  0.03016972541809082
local_in_edges_tensor generation:  0.034743309020996094
mini_batch_src_global generation:  0.058202266693115234
r_  generation:  0.5087335109710693
local_output_nid generation:  0.02976536750793457
local_in_edges_tensor generation:  0.040749311447143555
mini_batch_src_global generation:  0.05759286880493164
r_  generation:  0.5099868774414062
local_output_nid generation:  0.030608177185058594
local_in_edges_tensor generation:  0.04054975509643555
mini_batch_src_global generation:  0.05874919891357422
r_  generation:  0.5112619400024414
local_output_nid generation:  0.030457258224487305
local_in_edges_tensor generation:  0.036776065826416016
mini_batch_src_global generation:  0.05989861488342285
r_  generation:  0.5112385749816895
local_output_nid generation:  0.03107309341430664
local_in_edges_tensor generation:  0.03605008125305176
mini_batch_src_global generation:  0.05989193916320801
r_  generation:  0.5103814601898193
local_output_nid generation:  0.03058314323425293
local_in_edges_tensor generation:  0.03602337837219238
mini_batch_src_global generation:  0.059326171875
r_  generation:  0.5187835693359375
local_output_nid generation:  0.030455350875854492
local_in_edges_tensor generation:  0.04534173011779785
mini_batch_src_global generation:  0.059433698654174805
r_  generation:  0.5085601806640625
local_output_nid generation:  0.030200958251953125
local_in_edges_tensor generation:  0.03209805488586426
mini_batch_src_global generation:  0.059243202209472656
r_  generation:  0.5071682929992676
local_output_nid generation:  0.03008413314819336
local_in_edges_tensor generation:  0.03364062309265137
mini_batch_src_global generation:  0.062148094177246094
r_  generation:  0.49996018409729004
local_output_nid generation:  0.031419992446899414
local_in_edges_tensor generation:  0.04559898376464844
mini_batch_src_global generation:  0.05830979347229004
r_  generation:  0.5071249008178711
local_output_nid generation:  0.03042316436767578
local_in_edges_tensor generation:  0.03740096092224121
mini_batch_src_global generation:  0.06016993522644043
r_  generation:  0.5046443939208984
----------------------check_connections_block total spend ----------------------------- 11.832618236541748
generate_one_block  0.6552093029022217
generate_one_block  0.6515440940856934
generate_one_block  0.6601614952087402
generate_one_block  0.6531109809875488
generate_one_block  0.6874191761016846
generate_one_block  0.6623282432556152
generate_one_block  0.740333080291748
generate_one_block  0.6738290786743164
generate_one_block  0.6723766326904297
generate_one_block  0.6608078479766846
generate_one_block  0.6827957630157471
generate_one_block  0.6658473014831543
generate_one_block  0.6428372859954834
generate_one_block  0.6428306102752686
generate_one_block  0.6771245002746582
generate_one_block  0.6611149311065674
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04660177230834961
gen group dst list time:  0.10253190994262695
time for parepare:  0.019447803497314453
local_output_nid generation:  0.0327455997467041
local_in_edges_tensor generation:  0.07536172866821289
mini_batch_src_global generation:  0.05392313003540039
r_  generation:  0.5420291423797607
local_output_nid generation:  0.03829765319824219
local_in_edges_tensor generation:  0.05308103561401367
mini_batch_src_global generation:  0.06509757041931152
r_  generation:  0.5401046276092529
local_output_nid generation:  0.03705549240112305
local_in_edges_tensor generation:  0.03996610641479492
mini_batch_src_global generation:  0.05813121795654297
r_  generation:  0.5480072498321533
local_output_nid generation:  0.03744363784790039
local_in_edges_tensor generation:  0.047544002532958984
mini_batch_src_global generation:  0.059389352798461914
r_  generation:  0.545767068862915
local_output_nid generation:  0.03744673728942871
local_in_edges_tensor generation:  0.04370450973510742
mini_batch_src_global generation:  0.06113696098327637
r_  generation:  0.5526347160339355
local_output_nid generation:  0.03768777847290039
local_in_edges_tensor generation:  0.03577446937561035
mini_batch_src_global generation:  0.05836606025695801
r_  generation:  0.5615084171295166
local_output_nid generation:  0.0391545295715332
local_in_edges_tensor generation:  0.03928422927856445
mini_batch_src_global generation:  0.05904722213745117
r_  generation:  0.5682196617126465
local_output_nid generation:  0.03846621513366699
local_in_edges_tensor generation:  0.04178977012634277
mini_batch_src_global generation:  0.06346297264099121
r_  generation:  0.5602688789367676
local_output_nid generation:  0.03777670860290527
local_in_edges_tensor generation:  0.051853179931640625
mini_batch_src_global generation:  0.06385254859924316
r_  generation:  0.5787756443023682
local_output_nid generation:  0.041216135025024414
local_in_edges_tensor generation:  0.045479536056518555
mini_batch_src_global generation:  0.06696057319641113
r_  generation:  0.5692455768585205
local_output_nid generation:  0.03838968276977539
local_in_edges_tensor generation:  0.04092836380004883
mini_batch_src_global generation:  0.060172080993652344
r_  generation:  0.563056468963623
local_output_nid generation:  0.0387425422668457
local_in_edges_tensor generation:  0.04107093811035156
mini_batch_src_global generation:  0.06456494331359863
r_  generation:  0.5706162452697754
local_output_nid generation:  0.03935050964355469
local_in_edges_tensor generation:  0.04383230209350586
mini_batch_src_global generation:  0.06053638458251953
r_  generation:  0.5696799755096436
local_output_nid generation:  0.03889751434326172
local_in_edges_tensor generation:  0.03471517562866211
mini_batch_src_global generation:  0.06131911277770996
r_  generation:  0.5709939002990723
local_output_nid generation:  0.039018869400024414
local_in_edges_tensor generation:  0.03533315658569336
mini_batch_src_global generation:  0.06486630439758301
r_  generation:  0.5653769969940186
local_output_nid generation:  0.038893938064575195
local_in_edges_tensor generation:  0.03609609603881836
mini_batch_src_global generation:  0.060827016830444336
r_  generation:  0.5681889057159424
----------------------check_connections_block total spend ----------------------------- 13.364379644393921
generate_one_block  0.7136456966400146
generate_one_block  0.6982100009918213
generate_one_block  0.7637622356414795
generate_one_block  0.6838579177856445
generate_one_block  0.6860742568969727
generate_one_block  0.6753902435302734
generate_one_block  0.6808438301086426
generate_one_block  0.6860618591308594
generate_one_block  0.6892871856689453
generate_one_block  0.6695833206176758
generate_one_block  0.6812443733215332
generate_one_block  0.679365873336792
generate_one_block  0.6875972747802734
generate_one_block  0.6714622974395752
generate_one_block  0.6837022304534912
generate_one_block  0.675865888595581
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08806443214416504
gen group dst list time:  0.10283541679382324
time for parepare:  0.019079208374023438
local_output_nid generation:  0.03598976135253906
local_in_edges_tensor generation:  0.05233430862426758
mini_batch_src_global generation:  0.047538042068481445
r_  generation:  0.5013980865478516
local_output_nid generation:  0.0409238338470459
local_in_edges_tensor generation:  0.05005192756652832
mini_batch_src_global generation:  0.05765056610107422
r_  generation:  0.5103144645690918
local_output_nid generation:  0.04167294502258301
local_in_edges_tensor generation:  0.04661273956298828
mini_batch_src_global generation:  0.061194658279418945
r_  generation:  0.5122742652893066
local_output_nid generation:  0.03922414779663086
local_in_edges_tensor generation:  0.039856910705566406
mini_batch_src_global generation:  0.056925058364868164
r_  generation:  0.5147659778594971
local_output_nid generation:  0.039484500885009766
local_in_edges_tensor generation:  0.044326066970825195
mini_batch_src_global generation:  0.07809233665466309
r_  generation:  0.5205018520355225
local_output_nid generation:  0.04207110404968262
local_in_edges_tensor generation:  0.0431058406829834
mini_batch_src_global generation:  0.05866241455078125
r_  generation:  0.5155813694000244
local_output_nid generation:  0.04043006896972656
local_in_edges_tensor generation:  0.045149803161621094
mini_batch_src_global generation:  0.05707740783691406
r_  generation:  0.5180926322937012
local_output_nid generation:  0.040732622146606445
local_in_edges_tensor generation:  0.045905113220214844
mini_batch_src_global generation:  0.05703282356262207
r_  generation:  0.5188119411468506
local_output_nid generation:  0.04040074348449707
local_in_edges_tensor generation:  0.036478281021118164
mini_batch_src_global generation:  0.057477712631225586
r_  generation:  0.5168161392211914
local_output_nid generation:  0.04070305824279785
local_in_edges_tensor generation:  0.040574073791503906
mini_batch_src_global generation:  0.05705094337463379
r_  generation:  0.5194113254547119
local_output_nid generation:  0.040796756744384766
local_in_edges_tensor generation:  0.04040670394897461
mini_batch_src_global generation:  0.057546138763427734
r_  generation:  0.5213019847869873
local_output_nid generation:  0.04083585739135742
local_in_edges_tensor generation:  0.05330300331115723
mini_batch_src_global generation:  0.056584835052490234
r_  generation:  0.522491455078125
local_output_nid generation:  0.04089021682739258
local_in_edges_tensor generation:  0.04027056694030762
mini_batch_src_global generation:  0.05714988708496094
r_  generation:  0.5203688144683838
local_output_nid generation:  0.04076361656188965
local_in_edges_tensor generation:  0.035780906677246094
mini_batch_src_global generation:  0.05687856674194336
r_  generation:  0.5281999111175537
local_output_nid generation:  0.04074501991271973
local_in_edges_tensor generation:  0.03577160835266113
mini_batch_src_global generation:  0.06285429000854492
r_  generation:  0.51751708984375
local_output_nid generation:  0.04224419593811035
local_in_edges_tensor generation:  0.040283918380737305
mini_batch_src_global generation:  0.05968427658081055
r_  generation:  0.5285348892211914
----------------------check_connections_block total spend ----------------------------- 12.53643274307251
generate_one_block  0.653728723526001
generate_one_block  0.6449718475341797
generate_one_block  0.6449706554412842
generate_one_block  0.6409525871276855
generate_one_block  0.641925573348999
generate_one_block  0.699608564376831
generate_one_block  0.6388051509857178
generate_one_block  0.6517040729522705
generate_one_block  0.6390602588653564
generate_one_block  0.6386792659759521
generate_one_block  0.6342651844024658
generate_one_block  0.6525194644927979
generate_one_block  0.6502749919891357
generate_one_block  0.6355640888214111
generate_one_block  0.6451144218444824
generate_one_block  0.6435298919677734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0029964447021484375  GigaBytes
Max Memory Allocated: 0.0029964447021484375  GigaBytes

connection checking time:  42.883768796920776
block generation total time  36.5874297618866
average batch blocks generation time:  2.2867143601179123
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12470483779907227  GigaBytes
Max Memory Allocated: 0.12470483779907227  GigaBytes

torch.Size([166315, 128])
torch.Size([163921, 128])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.36 GiB already allocated; 6.44 MiB free; 22.42 GiB reserved in total by PyTorch)
