Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648465848.8426602
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02513909339904785
range selection method range initialization spend 0.013628244400024414
time for parepare:  0.018196582794189453
local_output_nid generation:  0.0013246536254882812
local_in_edges_tensor generation:  0.0038590431213378906
mini_batch_src_global generation:  0.0018694400787353516
r_  generation:  0.018859386444091797
local_output_nid generation:  0.0014235973358154297
local_in_edges_tensor generation:  0.0009016990661621094
mini_batch_src_global generation:  0.0022492408752441406
r_  generation:  0.0184476375579834
local_output_nid generation:  0.001558542251586914
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.01827406883239746
local_output_nid generation:  0.0014977455139160156
local_in_edges_tensor generation:  0.0008842945098876953
mini_batch_src_global generation:  0.0014204978942871094
r_  generation:  0.018119096755981445
local_output_nid generation:  0.0014989376068115234
local_in_edges_tensor generation:  0.0008053779602050781
mini_batch_src_global generation:  0.0013027191162109375
r_  generation:  0.01811814308166504
local_output_nid generation:  0.0015273094177246094
local_in_edges_tensor generation:  0.00081634521484375
mini_batch_src_global generation:  0.0014269351959228516
r_  generation:  0.018563508987426758
local_output_nid generation:  0.00151824951171875
local_in_edges_tensor generation:  0.0008223056793212891
mini_batch_src_global generation:  0.0015263557434082031
r_  generation:  0.019048213958740234
local_output_nid generation:  0.0014998912811279297
local_in_edges_tensor generation:  0.000850677490234375
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.019011735916137695
local_output_nid generation:  0.0015077590942382812
local_in_edges_tensor generation:  0.0008449554443359375
mini_batch_src_global generation:  0.001522064208984375
r_  generation:  0.018555641174316406
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0008025169372558594
mini_batch_src_global generation:  0.0014023780822753906
r_  generation:  0.01904296875
local_output_nid generation:  0.0015497207641601562
local_in_edges_tensor generation:  0.0008459091186523438
mini_batch_src_global generation:  0.0015540122985839844
r_  generation:  0.018979549407958984
local_output_nid generation:  0.0014765262603759766
local_in_edges_tensor generation:  0.0008335113525390625
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.019266366958618164
local_output_nid generation:  0.0015130043029785156
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.0015609264373779297
r_  generation:  0.0193789005279541
local_output_nid generation:  0.0015206336975097656
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0015499591827392578
r_  generation:  0.019236326217651367
local_output_nid generation:  0.001554250717163086
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0015406608581542969
r_  generation:  0.0198516845703125
local_output_nid generation:  0.0015184879302978516
local_in_edges_tensor generation:  0.0008473396301269531
mini_batch_src_global generation:  0.0016050338745117188
r_  generation:  0.019823074340820312
----------------------check_connections_block total spend ----------------------------- 0.4543159008026123
generate_one_block  0.026953935623168945
generate_one_block  0.028180837631225586
generate_one_block  0.02948284149169922
generate_one_block  0.028364181518554688
generate_one_block  0.02729177474975586
generate_one_block  0.027843475341796875
generate_one_block  0.027554750442504883
generate_one_block  0.02772355079650879
generate_one_block  0.027499914169311523
generate_one_block  0.028045654296875
generate_one_block  0.027985811233520508
generate_one_block  0.028122425079345703
generate_one_block  0.02812361717224121
generate_one_block  0.027516841888427734
generate_one_block  0.028753280639648438
generate_one_block  0.028257131576538086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03746318817138672
gen group dst list time:  0.018913984298706055
time for parepare:  0.019029617309570312
local_output_nid generation:  0.0067899227142333984
local_in_edges_tensor generation:  0.013644218444824219
mini_batch_src_global generation:  0.01959967613220215
r_  generation:  0.19150400161743164
local_output_nid generation:  0.009961843490600586
local_in_edges_tensor generation:  0.01743316650390625
mini_batch_src_global generation:  0.02430891990661621
r_  generation:  0.19743943214416504
local_output_nid generation:  0.010450124740600586
local_in_edges_tensor generation:  0.014537572860717773
mini_batch_src_global generation:  0.023656129837036133
r_  generation:  0.20174241065979004
local_output_nid generation:  0.01059269905090332
local_in_edges_tensor generation:  0.014507532119750977
mini_batch_src_global generation:  0.024564266204833984
r_  generation:  0.20397067070007324
local_output_nid generation:  0.010628938674926758
local_in_edges_tensor generation:  0.01284027099609375
mini_batch_src_global generation:  0.02606964111328125
r_  generation:  0.20476174354553223
local_output_nid generation:  0.010927200317382812
local_in_edges_tensor generation:  0.013262271881103516
mini_batch_src_global generation:  0.027333974838256836
r_  generation:  0.2078094482421875
local_output_nid generation:  0.011000871658325195
local_in_edges_tensor generation:  0.014464855194091797
mini_batch_src_global generation:  0.028899669647216797
r_  generation:  0.2053844928741455
local_output_nid generation:  0.011117696762084961
local_in_edges_tensor generation:  0.013580560684204102
mini_batch_src_global generation:  0.026336669921875
r_  generation:  0.20805001258850098
local_output_nid generation:  0.011107206344604492
local_in_edges_tensor generation:  0.016601085662841797
mini_batch_src_global generation:  0.026032209396362305
r_  generation:  0.20824265480041504
local_output_nid generation:  0.011205434799194336
local_in_edges_tensor generation:  0.011686563491821289
mini_batch_src_global generation:  0.02779698371887207
r_  generation:  0.20992040634155273
local_output_nid generation:  0.011377096176147461
local_in_edges_tensor generation:  0.01339578628540039
mini_batch_src_global generation:  0.027156591415405273
r_  generation:  0.21214914321899414
local_output_nid generation:  0.011380910873413086
local_in_edges_tensor generation:  0.015289783477783203
mini_batch_src_global generation:  0.027667999267578125
r_  generation:  0.21285605430603027
local_output_nid generation:  0.011495351791381836
local_in_edges_tensor generation:  0.011764287948608398
mini_batch_src_global generation:  0.028552532196044922
r_  generation:  0.21921062469482422
local_output_nid generation:  0.011368036270141602
local_in_edges_tensor generation:  0.011747121810913086
mini_batch_src_global generation:  0.02679610252380371
r_  generation:  0.20979619026184082
local_output_nid generation:  0.011662721633911133
local_in_edges_tensor generation:  0.01202082633972168
mini_batch_src_global generation:  0.02721858024597168
r_  generation:  0.21924519538879395
local_output_nid generation:  0.011434078216552734
local_in_edges_tensor generation:  0.015111207962036133
mini_batch_src_global generation:  0.026839256286621094
r_  generation:  0.21103692054748535
----------------------check_connections_block total spend ----------------------------- 4.890169143676758
generate_one_block  0.2723839282989502
generate_one_block  0.2631971836090088
generate_one_block  0.2693173885345459
generate_one_block  0.27251434326171875
generate_one_block  0.27753758430480957
generate_one_block  0.2669816017150879
generate_one_block  0.26509666442871094
generate_one_block  0.2672915458679199
generate_one_block  0.2653360366821289
generate_one_block  0.26671481132507324
generate_one_block  0.2765491008758545
generate_one_block  0.27495670318603516
generate_one_block  0.2719712257385254
generate_one_block  0.2626209259033203
generate_one_block  0.28714871406555176
generate_one_block  0.2654697895050049
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034830331802368164
gen group dst list time:  0.058483123779296875
time for parepare:  0.018848180770874023
local_output_nid generation:  0.02295231819152832
local_in_edges_tensor generation:  0.036011457443237305
mini_batch_src_global generation:  0.041220903396606445
r_  generation:  0.43589282035827637
local_output_nid generation:  0.02945685386657715
local_in_edges_tensor generation:  0.04405045509338379
mini_batch_src_global generation:  0.051149845123291016
r_  generation:  0.44105958938598633
local_output_nid generation:  0.0290682315826416
local_in_edges_tensor generation:  0.044512271881103516
mini_batch_src_global generation:  0.050385236740112305
r_  generation:  0.4464907646179199
local_output_nid generation:  0.029253244400024414
local_in_edges_tensor generation:  0.029509305953979492
mini_batch_src_global generation:  0.0522770881652832
r_  generation:  0.4495549201965332
local_output_nid generation:  0.02991318702697754
local_in_edges_tensor generation:  0.045202016830444336
mini_batch_src_global generation:  0.054610490798950195
r_  generation:  0.4499208927154541
local_output_nid generation:  0.029369115829467773
local_in_edges_tensor generation:  0.029387235641479492
mini_batch_src_global generation:  0.05322742462158203
r_  generation:  0.4515557289123535
local_output_nid generation:  0.02966785430908203
local_in_edges_tensor generation:  0.033670663833618164
mini_batch_src_global generation:  0.052741289138793945
r_  generation:  0.45938754081726074
local_output_nid generation:  0.030195236206054688
local_in_edges_tensor generation:  0.03703761100769043
mini_batch_src_global generation:  0.05288410186767578
r_  generation:  0.4525423049926758
local_output_nid generation:  0.029892921447753906
local_in_edges_tensor generation:  0.041368722915649414
mini_batch_src_global generation:  0.055333614349365234
r_  generation:  0.4569361209869385
local_output_nid generation:  0.029799938201904297
local_in_edges_tensor generation:  0.029792308807373047
mini_batch_src_global generation:  0.05343484878540039
r_  generation:  0.4556891918182373
local_output_nid generation:  0.029746294021606445
local_in_edges_tensor generation:  0.0335540771484375
mini_batch_src_global generation:  0.052640438079833984
r_  generation:  0.458559513092041
local_output_nid generation:  0.0299530029296875
local_in_edges_tensor generation:  0.04184985160827637
mini_batch_src_global generation:  0.052863359451293945
r_  generation:  0.45741915702819824
local_output_nid generation:  0.029983997344970703
local_in_edges_tensor generation:  0.029953718185424805
mini_batch_src_global generation:  0.05275416374206543
r_  generation:  0.46486687660217285
local_output_nid generation:  0.03012394905090332
local_in_edges_tensor generation:  0.04144454002380371
mini_batch_src_global generation:  0.054726362228393555
r_  generation:  0.4649083614349365
local_output_nid generation:  0.030533313751220703
local_in_edges_tensor generation:  0.03359532356262207
mini_batch_src_global generation:  0.05614304542541504
r_  generation:  0.46400022506713867
local_output_nid generation:  0.030091047286987305
local_in_edges_tensor generation:  0.030285358428955078
mini_batch_src_global generation:  0.05423426628112793
r_  generation:  0.4641561508178711
----------------------check_connections_block total spend ----------------------------- 10.746392965316772
generate_one_block  0.5658643245697021
generate_one_block  0.566817045211792
generate_one_block  0.5759353637695312
generate_one_block  0.5746147632598877
generate_one_block  0.5875978469848633
generate_one_block  0.5717599391937256
generate_one_block  0.6274924278259277
generate_one_block  0.5759885311126709
generate_one_block  0.5822842121124268
generate_one_block  0.5865020751953125
generate_one_block  0.5906543731689453
generate_one_block  0.5874450206756592
generate_one_block  0.5757942199707031
generate_one_block  0.575965404510498
generate_one_block  0.5850589275360107
generate_one_block  0.5667457580566406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  15.63656210899353
block generation total time  13.621607780456543
average batch blocks generation time:  0.8513504862785339
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09045171737670898  GigaBytes
Max Memory Allocated: 0.09045171737670898  GigaBytes

torch.Size([154318, 128])
torch.Size([122192, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5233154296875 GB
    Memory Allocated: 11.91682481765747  GigaBytes
Max Memory Allocated: 11.923060894012451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5330810546875 GB
    Memory Allocated: 0.09113502502441406  GigaBytes
Max Memory Allocated: 11.923060894012451  GigaBytes

torch.Size([154324, 128])
torch.Size([121962, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.847144603729248  GigaBytes
Max Memory Allocated: 11.923060894012451  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.0918741226196289  GigaBytes
Max Memory Allocated: 11.923060894012451  GigaBytes

torch.Size([154269, 128])
torch.Size([122539, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.93213176727295  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.0912165641784668  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154345, 128])
torch.Size([121915, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.863171100616455  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.09177494049072266  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154669, 128])
torch.Size([122806, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.895570278167725  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.0909886360168457  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([153975, 128])
torch.Size([121394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.844865798950195  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.09175682067871094  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154348, 128])
torch.Size([122060, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.851316452026367  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.09128761291503906  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154546, 128])
torch.Size([122212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.879227638244629  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.09179019927978516  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154449, 128])
torch.Size([122369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.885367393493652  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.09125280380249023  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154477, 128])
torch.Size([122315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 11.86280632019043  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7733154296875 GB
    Memory Allocated: 0.0919790267944336  GigaBytes
Max Memory Allocated: 11.939130306243896  GigaBytes

torch.Size([154681, 128])
torch.Size([123038, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 11.976294994354248  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09142255783081055  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154561, 128])
torch.Size([122821, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 11.936147689819336  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4510498046875 GB
    Memory Allocated: 0.09195423126220703  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154311, 128])
torch.Size([122526, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4549560546875 GB
    Memory Allocated: 11.918354034423828  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4549560546875 GB
    Memory Allocated: 0.09126472473144531  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154496, 128])
torch.Size([122750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4549560546875 GB
    Memory Allocated: 11.912190914154053  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4549560546875 GB
    Memory Allocated: 0.09204769134521484  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154473, 128])
torch.Size([122722, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.962529182434082  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09128284454345703  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154456, 128])
torch.Size([122337, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.919279098510742  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039852455258369446 |0.03672875463962555 |0.28302542865276337 |0.00010579824447631836 |0.30791492760181427 |0.0077707767486572266 |
----------------------------------------------------------pseudo_mini_loss sum 4.396765232086182
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5090233
Number of first layer input nodes during this epoch:  2470698
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.11502456665039062  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.019150972366333008
range selection method range initialization spend 0.015722036361694336
time for parepare:  0.01694488525390625
local_output_nid generation:  0.0016465187072753906
local_in_edges_tensor generation:  0.004481315612792969
mini_batch_src_global generation:  0.003556489944458008
r_  generation:  0.021082401275634766
local_output_nid generation:  0.0022516250610351562
local_in_edges_tensor generation:  0.0011262893676757812
mini_batch_src_global generation:  0.0022330284118652344
r_  generation:  0.01793980598449707
local_output_nid generation:  0.0022363662719726562
local_in_edges_tensor generation:  0.000972747802734375
mini_batch_src_global generation:  0.0012781620025634766
r_  generation:  0.016798734664916992
local_output_nid generation:  0.002037525177001953
local_in_edges_tensor generation:  0.0009713172912597656
mini_batch_src_global generation:  0.001361846923828125
r_  generation:  0.01734447479248047
local_output_nid generation:  0.0019729137420654297
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0012230873107910156
r_  generation:  0.01750469207763672
local_output_nid generation:  0.001975536346435547
local_in_edges_tensor generation:  0.0009555816650390625
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.01769876480102539
local_output_nid generation:  0.0019519329071044922
local_in_edges_tensor generation:  0.0009372234344482422
mini_batch_src_global generation:  0.0013582706451416016
r_  generation:  0.0179288387298584
local_output_nid generation:  0.0018792152404785156
local_in_edges_tensor generation:  0.0009603500366210938
mini_batch_src_global generation:  0.0014820098876953125
r_  generation:  0.018309593200683594
local_output_nid generation:  0.0018792152404785156
local_in_edges_tensor generation:  0.0009608268737792969
mini_batch_src_global generation:  0.0015256404876708984
r_  generation:  0.01832413673400879
local_output_nid generation:  0.0019321441650390625
local_in_edges_tensor generation:  0.0009508132934570312
mini_batch_src_global generation:  0.001407623291015625
r_  generation:  0.018602848052978516
local_output_nid generation:  0.001888275146484375
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0015163421630859375
r_  generation:  0.025243282318115234
local_output_nid generation:  0.0034554004669189453
local_in_edges_tensor generation:  0.0017490386962890625
mini_batch_src_global generation:  0.0025556087493896484
r_  generation:  0.021210670471191406
local_output_nid generation:  0.001961946487426758
local_in_edges_tensor generation:  0.0015304088592529297
mini_batch_src_global generation:  0.0015149116516113281
r_  generation:  0.018469810485839844
local_output_nid generation:  0.0019173622131347656
local_in_edges_tensor generation:  0.0015523433685302734
mini_batch_src_global generation:  0.0016396045684814453
r_  generation:  0.018868207931518555
local_output_nid generation:  0.0019266605377197266
local_in_edges_tensor generation:  0.002162456512451172
mini_batch_src_global generation:  0.0015459060668945312
r_  generation:  0.02274632453918457
local_output_nid generation:  0.0022919178009033203
local_in_edges_tensor generation:  0.0013461112976074219
mini_batch_src_global generation:  0.0022933483123779297
r_  generation:  0.021040916442871094
----------------------check_connections_block total spend ----------------------------- 0.4861912727355957
generate_one_block  0.04666304588317871
generate_one_block  0.03321099281311035
generate_one_block  0.030764341354370117
generate_one_block  0.030872583389282227
generate_one_block  0.03510713577270508
generate_one_block  0.051779747009277344
generate_one_block  0.03844022750854492
generate_one_block  0.04740452766418457
generate_one_block  0.034143686294555664
generate_one_block  0.03295159339904785
generate_one_block  0.04695868492126465
generate_one_block  0.03716421127319336
generate_one_block  0.05338692665100098
generate_one_block  0.03345632553100586
generate_one_block  0.03509378433227539
generate_one_block  0.049417734146118164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04107522964477539
gen group dst list time:  0.020527124404907227
time for parepare:  0.021764278411865234
local_output_nid generation:  0.008026599884033203
local_in_edges_tensor generation:  0.025693893432617188
mini_batch_src_global generation:  0.0204160213470459
r_  generation:  0.20082402229309082
local_output_nid generation:  0.010726690292358398
local_in_edges_tensor generation:  0.0175325870513916
mini_batch_src_global generation:  0.026892662048339844
r_  generation:  0.2045583724975586
local_output_nid generation:  0.011147737503051758
local_in_edges_tensor generation:  0.014189720153808594
mini_batch_src_global generation:  0.02353668212890625
r_  generation:  0.20930123329162598
local_output_nid generation:  0.01159811019897461
local_in_edges_tensor generation:  0.014208555221557617
mini_batch_src_global generation:  0.024312734603881836
r_  generation:  0.2096858024597168
local_output_nid generation:  0.01149129867553711
local_in_edges_tensor generation:  0.012601137161254883
mini_batch_src_global generation:  0.025249958038330078
r_  generation:  0.21170544624328613
local_output_nid generation:  0.012995243072509766
local_in_edges_tensor generation:  0.014428853988647461
mini_batch_src_global generation:  0.025894880294799805
r_  generation:  0.22204017639160156
local_output_nid generation:  0.015560626983642578
local_in_edges_tensor generation:  0.020586490631103516
mini_batch_src_global generation:  0.032282114028930664
r_  generation:  0.21599745750427246
local_output_nid generation:  0.012088775634765625
local_in_edges_tensor generation:  0.016637563705444336
mini_batch_src_global generation:  0.026526212692260742
r_  generation:  0.21303534507751465
local_output_nid generation:  0.012121200561523438
local_in_edges_tensor generation:  0.01347804069519043
mini_batch_src_global generation:  0.027977705001831055
r_  generation:  0.21468544006347656
local_output_nid generation:  0.012046098709106445
local_in_edges_tensor generation:  0.011473655700683594
mini_batch_src_global generation:  0.02664971351623535
r_  generation:  0.21424388885498047
local_output_nid generation:  0.012211084365844727
local_in_edges_tensor generation:  0.012628793716430664
mini_batch_src_global generation:  0.02866959571838379
r_  generation:  0.22716665267944336
local_output_nid generation:  0.012020349502563477
local_in_edges_tensor generation:  0.01570916175842285
mini_batch_src_global generation:  0.027225255966186523
r_  generation:  0.2209944725036621
local_output_nid generation:  0.013000726699829102
local_in_edges_tensor generation:  0.01654338836669922
mini_batch_src_global generation:  0.035494089126586914
r_  generation:  0.21691465377807617
local_output_nid generation:  0.01309347152709961
local_in_edges_tensor generation:  0.012830018997192383
mini_batch_src_global generation:  0.02854609489440918
r_  generation:  0.21679306030273438
local_output_nid generation:  0.014268159866333008
local_in_edges_tensor generation:  0.015326976776123047
mini_batch_src_global generation:  0.027034997940063477
r_  generation:  0.21488189697265625
local_output_nid generation:  0.012557744979858398
local_in_edges_tensor generation:  0.015327692031860352
mini_batch_src_global generation:  0.035480499267578125
r_  generation:  0.21626543998718262
----------------------check_connections_block total spend ----------------------------- 5.106249094009399
generate_one_block  0.29021382331848145
generate_one_block  0.2768728733062744
generate_one_block  0.2754507064819336
generate_one_block  0.275113582611084
generate_one_block  0.2758362293243408
generate_one_block  0.2743661403656006
generate_one_block  0.3034074306488037
generate_one_block  0.2792820930480957
generate_one_block  0.285266637802124
generate_one_block  0.2835710048675537
generate_one_block  0.29539918899536133
generate_one_block  0.2816894054412842
generate_one_block  0.27746057510375977
generate_one_block  0.2790036201477051
generate_one_block  0.28643083572387695
generate_one_block  0.2860136032104492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039891958236694336
gen group dst list time:  0.06609272956848145
time for parepare:  0.019374608993530273
local_output_nid generation:  0.02509927749633789
local_in_edges_tensor generation:  0.04187369346618652
mini_batch_src_global generation:  0.04116988182067871
r_  generation:  0.4480137825012207
local_output_nid generation:  0.02950596809387207
local_in_edges_tensor generation:  0.04328036308288574
mini_batch_src_global generation:  0.05159163475036621
r_  generation:  0.44846439361572266
local_output_nid generation:  0.029725313186645508
local_in_edges_tensor generation:  0.03999924659729004
mini_batch_src_global generation:  0.050884246826171875
r_  generation:  0.4549288749694824
local_output_nid generation:  0.030031442642211914
local_in_edges_tensor generation:  0.031890153884887695
mini_batch_src_global generation:  0.05270791053771973
r_  generation:  0.4599306583404541
local_output_nid generation:  0.030679941177368164
local_in_edges_tensor generation:  0.08784842491149902
mini_batch_src_global generation:  0.051911354064941406
r_  generation:  0.4542360305786133
local_output_nid generation:  0.03048419952392578
local_in_edges_tensor generation:  0.028255701065063477
mini_batch_src_global generation:  0.053351640701293945
r_  generation:  0.4533681869506836
local_output_nid generation:  0.030730724334716797
local_in_edges_tensor generation:  0.028253555297851562
mini_batch_src_global generation:  0.05238509178161621
r_  generation:  0.4606802463531494
local_output_nid generation:  0.030909299850463867
local_in_edges_tensor generation:  0.036864280700683594
mini_batch_src_global generation:  0.053327083587646484
r_  generation:  0.4599308967590332
local_output_nid generation:  0.030983924865722656
local_in_edges_tensor generation:  0.03219151496887207
mini_batch_src_global generation:  0.05303239822387695
r_  generation:  0.461071252822876
local_output_nid generation:  0.032233476638793945
local_in_edges_tensor generation:  0.03728604316711426
mini_batch_src_global generation:  0.056920528411865234
r_  generation:  0.4571378231048584
local_output_nid generation:  0.03367781639099121
local_in_edges_tensor generation:  0.03315472602844238
mini_batch_src_global generation:  0.05265688896179199
r_  generation:  0.45964932441711426
local_output_nid generation:  0.030875682830810547
local_in_edges_tensor generation:  0.032929182052612305
mini_batch_src_global generation:  0.05389690399169922
r_  generation:  0.458909273147583
local_output_nid generation:  0.031014204025268555
local_in_edges_tensor generation:  0.03854632377624512
mini_batch_src_global generation:  0.05635714530944824
r_  generation:  0.478928804397583
local_output_nid generation:  0.0341799259185791
local_in_edges_tensor generation:  0.04136538505554199
mini_batch_src_global generation:  0.053949594497680664
r_  generation:  0.46150994300842285
local_output_nid generation:  0.03175711631774902
local_in_edges_tensor generation:  0.03523087501525879
mini_batch_src_global generation:  0.053034305572509766
r_  generation:  0.4678466320037842
local_output_nid generation:  0.03199934959411621
local_in_edges_tensor generation:  0.032366037368774414
mini_batch_src_global generation:  0.05701637268066406
r_  generation:  0.4631791114807129
----------------------check_connections_block total spend ----------------------------- 10.910423517227173
generate_one_block  0.6045448780059814
generate_one_block  0.6099717617034912
generate_one_block  0.6010475158691406
generate_one_block  0.5944650173187256
generate_one_block  0.5954723358154297
generate_one_block  0.5904059410095215
generate_one_block  0.5882391929626465
generate_one_block  0.5993325710296631
generate_one_block  0.6129601001739502
generate_one_block  0.5894210338592529
generate_one_block  0.6080646514892578
generate_one_block  0.57692551612854
generate_one_block  0.5969724655151367
generate_one_block  0.6014940738677979
generate_one_block  0.581890344619751
generate_one_block  0.5997376441955566
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.11502456665039062  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

connection checking time:  16.016672611236572
block generation total time  14.076322793960571
average batch blocks generation time:  0.8797701746225357
block dataloader generation time/epoch 32.49325776100159
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09303617477416992  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154307, 128])
torch.Size([122201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.867790222167969  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09256267547607422  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154598, 128])
torch.Size([122860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.872436046600342  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09306907653808594  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154403, 128])
torch.Size([122264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.910670757293701  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09255361557006836  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154711, 128])
torch.Size([122586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.886710166931152  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.0930013656616211  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154693, 128])
torch.Size([122769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.88185167312622  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09248733520507812  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154574, 128])
torch.Size([122452, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.889420509338379  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09308338165283203  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154369, 128])
torch.Size([122478, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.938488483428955  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09251070022583008  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154551, 128])
torch.Size([122502, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.885910987854004  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09305953979492188  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154686, 128])
torch.Size([122537, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.897534370422363  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09264183044433594  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154708, 128])
torch.Size([122267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.907473087310791  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09313488006591797  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154334, 128])
torch.Size([122546, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.928143978118896  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09248971939086914  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154409, 128])
torch.Size([122093, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.878194808959961  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.0930948257446289  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154567, 128])
torch.Size([122696, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.912238597869873  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09272003173828125  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154774, 128])
torch.Size([123197, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.939369678497314  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09312629699707031  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154643, 128])
torch.Size([122720, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.89986801147461  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 0.09267187118530273  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

torch.Size([154563, 128])
torch.Size([123004, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4666748046875 GB
    Memory Allocated: 11.94872236251831  GigaBytes
Max Memory Allocated: 11.983290672302246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03667046129703522 |0.01436680555343628 |0.24467872083187103 |9.550154209136963e-05 |0.3049915134906769 |0.006635904312133789 |
----------------------------------------------------------pseudo_mini_loss sum 3.703840970993042
Total (block generation + training)time/epoch 42.1445152759552
Training time/epoch 9.650990724563599
Training time without block to device /epoch 9.421121835708618
Training time without total dataloading part /epoch 8.802887678146362
load block tensor time/epoch 0.5867273807525635
block to device time/epoch 0.22986888885498047
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5095835
Number of first layer input nodes during this epoch:  2472890
