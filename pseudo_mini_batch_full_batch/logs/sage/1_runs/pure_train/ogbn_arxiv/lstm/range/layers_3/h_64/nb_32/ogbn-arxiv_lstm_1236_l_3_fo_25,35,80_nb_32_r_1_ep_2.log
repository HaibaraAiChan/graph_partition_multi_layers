Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648469785.5908985
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027093172073364258
range selection method range initialization spend 0.01726841926574707
time for parepare:  0.01776885986328125
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.003162860870361328
mini_batch_src_global generation:  0.001950979232788086
r_  generation:  0.01208043098449707
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0015673637390136719
r_  generation:  0.009648799896240234
local_output_nid generation:  0.0008170604705810547
local_in_edges_tensor generation:  0.0005407333374023438
mini_batch_src_global generation:  0.0009813308715820312
r_  generation:  0.009177923202514648
local_output_nid generation:  0.0008018016815185547
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0009288787841796875
r_  generation:  0.009351730346679688
local_output_nid generation:  0.0007865428924560547
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0008752346038818359
r_  generation:  0.009188652038574219
local_output_nid generation:  0.0008056163787841797
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0009562969207763672
r_  generation:  0.009189605712890625
local_output_nid generation:  0.0007836818695068359
local_in_edges_tensor generation:  0.00047850608825683594
mini_batch_src_global generation:  0.0009558200836181641
r_  generation:  0.009918212890625
local_output_nid generation:  0.0007817745208740234
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.0009853839874267578
r_  generation:  0.009272575378417969
local_output_nid generation:  0.0007755756378173828
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0010471343994140625
r_  generation:  0.009819507598876953
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0009582042694091797
r_  generation:  0.009348154067993164
local_output_nid generation:  0.0007765293121337891
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0009944438934326172
r_  generation:  0.010092496871948242
local_output_nid generation:  0.0007491111755371094
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0010156631469726562
r_  generation:  0.010049104690551758
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.00047516822814941406
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.009874582290649414
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.009471416473388672
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.001008749008178711
r_  generation:  0.010578632354736328
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0009865760803222656
r_  generation:  0.009556055068969727
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0009751319885253906
r_  generation:  0.009552955627441406
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0010268688201904297
r_  generation:  0.010106801986694336
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0010061264038085938
r_  generation:  0.00997304916381836
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.001013040542602539
r_  generation:  0.010199785232543945
local_output_nid generation:  0.0007560253143310547
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.001012563705444336
r_  generation:  0.010112285614013672
local_output_nid generation:  0.0007531642913818359
local_in_edges_tensor generation:  0.0004673004150390625
mini_batch_src_global generation:  0.0009915828704833984
r_  generation:  0.009869813919067383
local_output_nid generation:  0.0007505416870117188
local_in_edges_tensor generation:  0.0004668235778808594
mini_batch_src_global generation:  0.0009834766387939453
r_  generation:  0.010070323944091797
local_output_nid generation:  0.0007512569427490234
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.001004934310913086
r_  generation:  0.010471343994140625
local_output_nid generation:  0.0007574558258056641
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0010628700256347656
r_  generation:  0.010361909866333008
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0010502338409423828
r_  generation:  0.010207414627075195
local_output_nid generation:  0.0007679462432861328
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0010385513305664062
r_  generation:  0.009932994842529297
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.010218381881713867
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.00046753883361816406
mini_batch_src_global generation:  0.001043081283569336
r_  generation:  0.010607481002807617
local_output_nid generation:  0.0007598400115966797
local_in_edges_tensor generation:  0.004415750503540039
mini_batch_src_global generation:  0.0012717247009277344
r_  generation:  0.010410547256469727
local_output_nid generation:  0.0008189678192138672
local_in_edges_tensor generation:  0.0005240440368652344
mini_batch_src_global generation:  0.001112222671508789
r_  generation:  0.010153055191040039
local_output_nid generation:  0.0007970333099365234
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.001049041748046875
r_  generation:  0.010042667388916016
----------------------check_connections_block total spend ----------------------------- 0.49142885208129883
generate_one_block  0.015128135681152344
generate_one_block  0.015122652053833008
generate_one_block  0.014546394348144531
generate_one_block  0.01494288444519043
generate_one_block  0.014244794845581055
generate_one_block  0.01414942741394043
generate_one_block  0.014823675155639648
generate_one_block  0.014235734939575195
generate_one_block  0.014807939529418945
generate_one_block  0.014391422271728516
generate_one_block  0.015043258666992188
generate_one_block  0.014764785766601562
generate_one_block  0.014668703079223633
generate_one_block  0.014031171798706055
generate_one_block  0.015393733978271484
generate_one_block  0.01431131362915039
generate_one_block  0.014066219329833984
generate_one_block  0.015014886856079102
generate_one_block  0.014589548110961914
generate_one_block  0.015005826950073242
generate_one_block  0.014865636825561523
generate_one_block  0.014521121978759766
generate_one_block  0.014495134353637695
generate_one_block  0.015046834945678711
generate_one_block  0.01517486572265625
generate_one_block  0.015057563781738281
generate_one_block  0.014702081680297852
generate_one_block  0.015113592147827148
generate_one_block  0.015620231628417969
generate_one_block  0.014942169189453125
generate_one_block  0.015439987182617188
generate_one_block  0.014814138412475586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03837728500366211
gen group dst list time:  0.02587413787841797
time for parepare:  0.018988609313964844
local_output_nid generation:  0.004204750061035156
local_in_edges_tensor generation:  0.012485980987548828
mini_batch_src_global generation:  0.015347480773925781
r_  generation:  0.12916803359985352
local_output_nid generation:  0.0068759918212890625
local_in_edges_tensor generation:  0.008546113967895508
mini_batch_src_global generation:  0.017317533493041992
r_  generation:  0.14124345779418945
local_output_nid generation:  0.0071527957916259766
local_in_edges_tensor generation:  0.009867429733276367
mini_batch_src_global generation:  0.015711069107055664
r_  generation:  0.14310479164123535
local_output_nid generation:  0.00709986686706543
local_in_edges_tensor generation:  0.011449813842773438
mini_batch_src_global generation:  0.016925334930419922
r_  generation:  0.15393376350402832
local_output_nid generation:  0.006956815719604492
local_in_edges_tensor generation:  0.010233163833618164
mini_batch_src_global generation:  0.017213821411132812
r_  generation:  0.14980602264404297
local_output_nid generation:  0.007137298583984375
local_in_edges_tensor generation:  0.0077381134033203125
mini_batch_src_global generation:  0.017320871353149414
r_  generation:  0.14656424522399902
local_output_nid generation:  0.007478475570678711
local_in_edges_tensor generation:  0.008610725402832031
mini_batch_src_global generation:  0.019125699996948242
r_  generation:  0.15370559692382812
local_output_nid generation:  0.007316112518310547
local_in_edges_tensor generation:  0.007962226867675781
mini_batch_src_global generation:  0.020644426345825195
r_  generation:  0.14664411544799805
local_output_nid generation:  0.0075931549072265625
local_in_edges_tensor generation:  0.008088350296020508
mini_batch_src_global generation:  0.02139759063720703
r_  generation:  0.15754199028015137
local_output_nid generation:  0.008222103118896484
local_in_edges_tensor generation:  0.017574548721313477
mini_batch_src_global generation:  0.025194883346557617
r_  generation:  0.1478278636932373
local_output_nid generation:  0.008799314498901367
local_in_edges_tensor generation:  0.01137232780456543
mini_batch_src_global generation:  0.018528223037719727
r_  generation:  0.15246844291687012
local_output_nid generation:  0.008058309555053711
local_in_edges_tensor generation:  0.010737895965576172
mini_batch_src_global generation:  0.01842665672302246
r_  generation:  0.15027737617492676
local_output_nid generation:  0.007998228073120117
local_in_edges_tensor generation:  0.009483575820922852
mini_batch_src_global generation:  0.019640445709228516
r_  generation:  0.15308833122253418
local_output_nid generation:  0.007796764373779297
local_in_edges_tensor generation:  0.009052753448486328
mini_batch_src_global generation:  0.01802659034729004
r_  generation:  0.1464691162109375
local_output_nid generation:  0.008178234100341797
local_in_edges_tensor generation:  0.009843111038208008
mini_batch_src_global generation:  0.019991397857666016
r_  generation:  0.1575183868408203
local_output_nid generation:  0.007835626602172852
local_in_edges_tensor generation:  0.008144378662109375
mini_batch_src_global generation:  0.01797008514404297
r_  generation:  0.14795851707458496
local_output_nid generation:  0.007929086685180664
local_in_edges_tensor generation:  0.008469581604003906
mini_batch_src_global generation:  0.01797628402709961
r_  generation:  0.14800572395324707
local_output_nid generation:  0.0082550048828125
local_in_edges_tensor generation:  0.012399911880493164
mini_batch_src_global generation:  0.020238399505615234
r_  generation:  0.1602771282196045
local_output_nid generation:  0.007993221282958984
local_in_edges_tensor generation:  0.008331298828125
mini_batch_src_global generation:  0.018509387969970703
r_  generation:  0.15020155906677246
local_output_nid generation:  0.008176803588867188
local_in_edges_tensor generation:  0.010241985321044922
mini_batch_src_global generation:  0.018750667572021484
r_  generation:  0.15198087692260742
local_output_nid generation:  0.008101463317871094
local_in_edges_tensor generation:  0.009722709655761719
mini_batch_src_global generation:  0.019196033477783203
r_  generation:  0.15445661544799805
local_output_nid generation:  0.008021116256713867
local_in_edges_tensor generation:  0.008390188217163086
mini_batch_src_global generation:  0.018435239791870117
r_  generation:  0.15221357345581055
local_output_nid generation:  0.008089542388916016
local_in_edges_tensor generation:  0.008613348007202148
mini_batch_src_global generation:  0.01842331886291504
r_  generation:  0.1506636142730713
local_output_nid generation:  0.008245229721069336
local_in_edges_tensor generation:  0.010874509811401367
mini_batch_src_global generation:  0.02005314826965332
r_  generation:  0.15660500526428223
local_output_nid generation:  0.008266210556030273
local_in_edges_tensor generation:  0.011010169982910156
mini_batch_src_global generation:  0.019292354583740234
r_  generation:  0.1579737663269043
local_output_nid generation:  0.008279561996459961
local_in_edges_tensor generation:  0.012301921844482422
mini_batch_src_global generation:  0.019225120544433594
r_  generation:  0.15678715705871582
local_output_nid generation:  0.008160829544067383
local_in_edges_tensor generation:  0.008514881134033203
mini_batch_src_global generation:  0.018815279006958008
r_  generation:  0.15755152702331543
local_output_nid generation:  0.00830698013305664
local_in_edges_tensor generation:  0.01001286506652832
mini_batch_src_global generation:  0.019223690032958984
r_  generation:  0.15778565406799316
local_output_nid generation:  0.008507490158081055
local_in_edges_tensor generation:  0.009914875030517578
mini_batch_src_global generation:  0.02043747901916504
r_  generation:  0.16277718544006348
local_output_nid generation:  0.008228778839111328
local_in_edges_tensor generation:  0.008673667907714844
mini_batch_src_global generation:  0.018957138061523438
r_  generation:  0.1542973518371582
local_output_nid generation:  0.008439064025878906
local_in_edges_tensor generation:  0.008813619613647461
mini_batch_src_global generation:  0.020638704299926758
r_  generation:  0.16121983528137207
local_output_nid generation:  0.008136272430419922
local_in_edges_tensor generation:  0.008491277694702148
mini_batch_src_global generation:  0.018819332122802734
r_  generation:  0.1524970531463623
----------------------check_connections_block total spend ----------------------------- 7.187639951705933
generate_one_block  0.18807387351989746
generate_one_block  0.18835830688476562
generate_one_block  0.20845603942871094
generate_one_block  0.1955704689025879
generate_one_block  0.18435359001159668
generate_one_block  0.18221235275268555
generate_one_block  0.190324068069458
generate_one_block  0.18085932731628418
generate_one_block  0.18847370147705078
generate_one_block  0.18018579483032227
generate_one_block  0.19198131561279297
generate_one_block  0.18852829933166504
generate_one_block  0.19033193588256836
generate_one_block  0.18132758140563965
generate_one_block  0.20035362243652344
generate_one_block  0.20267367362976074
generate_one_block  0.18143868446350098
generate_one_block  0.20054221153259277
generate_one_block  0.18312454223632812
generate_one_block  0.19204378128051758
generate_one_block  0.20158147811889648
generate_one_block  0.22804522514343262
generate_one_block  0.1896054744720459
generate_one_block  0.19695234298706055
generate_one_block  0.20415806770324707
generate_one_block  0.19774818420410156
generate_one_block  0.19256329536437988
generate_one_block  0.19188666343688965
generate_one_block  0.21492886543273926
generate_one_block  0.19357895851135254
generate_one_block  0.21201729774475098
generate_one_block  0.18798446655273438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03835606575012207
gen group dst list time:  0.11019420623779297
time for parepare:  0.019144535064697266
local_output_nid generation:  0.021051645278930664
local_in_edges_tensor generation:  0.04131627082824707
mini_batch_src_global generation:  0.03767967224121094
r_  generation:  0.3970608711242676
local_output_nid generation:  0.027112960815429688
local_in_edges_tensor generation:  0.043212175369262695
mini_batch_src_global generation:  0.05072641372680664
r_  generation:  0.4198760986328125
local_output_nid generation:  0.028144121170043945
local_in_edges_tensor generation:  0.036655426025390625
mini_batch_src_global generation:  0.05167365074157715
r_  generation:  0.415341854095459
local_output_nid generation:  0.028545379638671875
local_in_edges_tensor generation:  0.03783273696899414
mini_batch_src_global generation:  0.04878067970275879
r_  generation:  0.41455078125
local_output_nid generation:  0.026600122451782227
local_in_edges_tensor generation:  0.025678157806396484
mini_batch_src_global generation:  0.048226118087768555
r_  generation:  0.4129345417022705
local_output_nid generation:  0.026515483856201172
local_in_edges_tensor generation:  0.024609088897705078
mini_batch_src_global generation:  0.04894685745239258
r_  generation:  0.41393041610717773
local_output_nid generation:  0.02658534049987793
local_in_edges_tensor generation:  0.028229236602783203
mini_batch_src_global generation:  0.04868364334106445
r_  generation:  0.41454124450683594
local_output_nid generation:  0.026845455169677734
local_in_edges_tensor generation:  0.024559736251831055
mini_batch_src_global generation:  0.048859357833862305
r_  generation:  0.41580748558044434
local_output_nid generation:  0.02662491798400879
local_in_edges_tensor generation:  0.03150606155395508
mini_batch_src_global generation:  0.05077052116394043
r_  generation:  0.4187614917755127
local_output_nid generation:  0.026695728302001953
local_in_edges_tensor generation:  0.027937650680541992
mini_batch_src_global generation:  0.0487363338470459
r_  generation:  0.4204072952270508
local_output_nid generation:  0.02720355987548828
local_in_edges_tensor generation:  0.03394460678100586
mini_batch_src_global generation:  0.052466630935668945
r_  generation:  0.41602611541748047
local_output_nid generation:  0.027212858200073242
local_in_edges_tensor generation:  0.028429508209228516
mini_batch_src_global generation:  0.04907417297363281
r_  generation:  0.41724085807800293
local_output_nid generation:  0.026875019073486328
local_in_edges_tensor generation:  0.028650522232055664
mini_batch_src_global generation:  0.048966407775878906
r_  generation:  0.422534704208374
local_output_nid generation:  0.027937889099121094
local_in_edges_tensor generation:  0.029390811920166016
mini_batch_src_global generation:  0.05440783500671387
r_  generation:  0.4319603443145752
local_output_nid generation:  0.028363704681396484
local_in_edges_tensor generation:  0.03680157661437988
mini_batch_src_global generation:  0.053653717041015625
r_  generation:  0.41825032234191895
local_output_nid generation:  0.02713799476623535
local_in_edges_tensor generation:  0.031601905822753906
mini_batch_src_global generation:  0.04927682876586914
r_  generation:  0.4187610149383545
local_output_nid generation:  0.027719974517822266
local_in_edges_tensor generation:  0.032463788986206055
mini_batch_src_global generation:  0.04849410057067871
r_  generation:  0.41942524909973145
local_output_nid generation:  0.027588367462158203
local_in_edges_tensor generation:  0.032781124114990234
mini_batch_src_global generation:  0.0494844913482666
r_  generation:  0.41981935501098633
local_output_nid generation:  0.02722620964050293
local_in_edges_tensor generation:  0.02828693389892578
mini_batch_src_global generation:  0.04916667938232422
r_  generation:  0.41808462142944336
local_output_nid generation:  0.02726435661315918
local_in_edges_tensor generation:  0.02866220474243164
mini_batch_src_global generation:  0.048909664154052734
r_  generation:  0.4089078903198242
local_output_nid generation:  0.027353286743164062
local_in_edges_tensor generation:  0.031972408294677734
mini_batch_src_global generation:  0.04843711853027344
r_  generation:  0.41875791549682617
local_output_nid generation:  0.02715277671813965
local_in_edges_tensor generation:  0.02855539321899414
mini_batch_src_global generation:  0.04981732368469238
r_  generation:  0.42057204246520996
local_output_nid generation:  0.027651309967041016
local_in_edges_tensor generation:  0.025005102157592773
mini_batch_src_global generation:  0.04853200912475586
r_  generation:  0.4159431457519531
local_output_nid generation:  0.02757406234741211
local_in_edges_tensor generation:  0.029248714447021484
mini_batch_src_global generation:  0.05243635177612305
r_  generation:  0.4147002696990967
local_output_nid generation:  0.027445554733276367
local_in_edges_tensor generation:  0.032636165618896484
mini_batch_src_global generation:  0.0491185188293457
r_  generation:  0.4182412624359131
local_output_nid generation:  0.02774643898010254
local_in_edges_tensor generation:  0.033548831939697266
mini_batch_src_global generation:  0.048996686935424805
r_  generation:  0.41318655014038086
local_output_nid generation:  0.027367830276489258
local_in_edges_tensor generation:  0.02991771697998047
mini_batch_src_global generation:  0.049462080001831055
r_  generation:  0.4260830879211426
local_output_nid generation:  0.027411937713623047
local_in_edges_tensor generation:  0.025288105010986328
mini_batch_src_global generation:  0.04927253723144531
r_  generation:  0.41374945640563965
local_output_nid generation:  0.027634382247924805
local_in_edges_tensor generation:  0.03304266929626465
mini_batch_src_global generation:  0.04885053634643555
r_  generation:  0.42464327812194824
local_output_nid generation:  0.02739548683166504
local_in_edges_tensor generation:  0.029404401779174805
mini_batch_src_global generation:  0.04944491386413574
r_  generation:  0.42049288749694824
local_output_nid generation:  0.027702808380126953
local_in_edges_tensor generation:  0.03399181365966797
mini_batch_src_global generation:  0.052263498306274414
r_  generation:  0.41936683654785156
local_output_nid generation:  0.02753734588623047
local_in_edges_tensor generation:  0.025342941284179688
mini_batch_src_global generation:  0.04890727996826172
r_  generation:  0.4154667854309082
----------------------check_connections_block total spend ----------------------------- 19.70766592025757
generate_one_block  0.6262943744659424
generate_one_block  0.5240945816040039
generate_one_block  0.5261693000793457
generate_one_block  0.5387008190155029
generate_one_block  0.5175960063934326
generate_one_block  0.5313365459442139
generate_one_block  0.5285036563873291
generate_one_block  0.5213003158569336
generate_one_block  0.5366041660308838
generate_one_block  0.5199904441833496
generate_one_block  0.5270295143127441
generate_one_block  0.539691686630249
generate_one_block  0.525902509689331
generate_one_block  0.5153238773345947
generate_one_block  0.5446805953979492
generate_one_block  0.5138378143310547
generate_one_block  0.5155782699584961
generate_one_block  0.5448386669158936
generate_one_block  0.5196318626403809
generate_one_block  0.5259456634521484
generate_one_block  0.5534675121307373
generate_one_block  0.5278987884521484
generate_one_block  0.528156042098999
generate_one_block  0.5319421291351318
generate_one_block  0.5393438339233398
generate_one_block  0.5385138988494873
generate_one_block  0.529482364654541
generate_one_block  0.5235435962677002
generate_one_block  0.5478110313415527
generate_one_block  0.5465831756591797
generate_one_block  0.536618709564209
generate_one_block  0.5225265026092529
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  26.8953058719635
block generation total time  23.27920174598694
average batch blocks generation time:  0.7274750545620918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08412027359008789  GigaBytes
Max Memory Allocated: 0.08412027359008789  GigaBytes

torch.Size([146999, 128])
torch.Size([102878, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6971435546875 GB
    Memory Allocated: 11.37498664855957  GigaBytes
Max Memory Allocated: 11.382711410522461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.7049560546875 GB
    Memory Allocated: 0.08530282974243164  GigaBytes
Max Memory Allocated: 11.382711410522461  GigaBytes

torch.Size([145861, 128])
torch.Size([102014, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 11.457099914550781  GigaBytes
Max Memory Allocated: 11.465489864349365  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3768310546875 GB
    Memory Allocated: 0.08601665496826172  GigaBytes
Max Memory Allocated: 11.465489864349365  GigaBytes

torch.Size([145791, 128])
torch.Size([101621, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3768310546875 GB
    Memory Allocated: 11.36081600189209  GigaBytes
Max Memory Allocated: 11.465489864349365  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3768310546875 GB
    Memory Allocated: 0.08566904067993164  GigaBytes
Max Memory Allocated: 11.465489864349365  GigaBytes

torch.Size([146578, 128])
torch.Size([103153, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0330810546875 GB
    Memory Allocated: 11.546019554138184  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08600807189941406  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([145728, 128])
torch.Size([101365, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.363994121551514  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08539724349975586  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146253, 128])
torch.Size([101355, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.298823356628418  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08605051040649414  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146431, 128])
torch.Size([102417, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.41777753829956  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08547258377075195  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146459, 128])
torch.Size([101600, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.305676460266113  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08603525161743164  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([145603, 128])
torch.Size([101652, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.393983840942383  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08505487442016602  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([145568, 128])
torch.Size([100879, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.281272411346436  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.0860757827758789  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146266, 128])
torch.Size([102739, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.488203525543213  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08536434173583984  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146053, 128])
torch.Size([102480, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.427307605743408  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08604621887207031  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146068, 128])
torch.Size([102322, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.430981159210205  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08529329299926758  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146068, 128])
torch.Size([101324, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.291179656982422  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08610820770263672  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146142, 128])
torch.Size([102504, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.528092861175537  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08535337448120117  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146193, 128])
torch.Size([101235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.295780658721924  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08597183227539062  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([145606, 128])
torch.Size([100947, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 11.308264255523682  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0350341796875 GB
    Memory Allocated: 0.08569574356079102  GigaBytes
Max Memory Allocated: 11.55450439453125  GigaBytes

torch.Size([146567, 128])
torch.Size([103270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.580305576324463  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08599710464477539  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146601, 128])
torch.Size([102160, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.383625030517578  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08541250228881836  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146131, 128])
torch.Size([101836, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.372233867645264  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08606815338134766  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146135, 128])
torch.Size([102408, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.487269878387451  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08555221557617188  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146449, 128])
torch.Size([101932, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.428764820098877  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08601903915405273  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146458, 128])
torch.Size([102463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.411333084106445  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08541584014892578  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146066, 128])
torch.Size([102411, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.498637676239014  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08608818054199219  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146487, 128])
torch.Size([102547, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.477449893951416  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08552932739257812  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146286, 128])
torch.Size([103036, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.509882926940918  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.0860757827758789  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146389, 128])
torch.Size([102152, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.471106052398682  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08553934097290039  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146330, 128])
torch.Size([102551, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 11.46544885635376  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6541748046875 GB
    Memory Allocated: 0.08614826202392578  GigaBytes
Max Memory Allocated: 11.590372085571289  GigaBytes

torch.Size([146675, 128])
torch.Size([103414, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2889404296875 GB
    Memory Allocated: 11.618462562561035  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.0853276252746582  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([145893, 128])
torch.Size([102302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.505999565124512  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.0861353874206543  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146711, 128])
torch.Size([103458, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.600870132446289  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08547306060791016  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146280, 128])
torch.Size([102745, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.436538219451904  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027893908321857452 |0.028312280774116516 |0.4128171503543854 |0.00010760873556137085 |0.6165350154042244 |0.010910749435424805 |
----------------------------------------------------------pseudo_mini_loss sum 4.954838275909424
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8789383
Number of first layer input nodes during this epoch:  4679125
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.10606670379638672  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.023865222930908203
range selection method range initialization spend 0.013500452041625977
time for parepare:  0.018095970153808594
local_output_nid generation:  0.0009472370147705078
local_in_edges_tensor generation:  0.0053141117095947266
mini_batch_src_global generation:  0.0017538070678710938
r_  generation:  0.011118173599243164
local_output_nid generation:  0.0010023117065429688
local_in_edges_tensor generation:  0.0006964206695556641
mini_batch_src_global generation:  0.0015418529510498047
r_  generation:  0.010538101196289062
local_output_nid generation:  0.0009648799896240234
local_in_edges_tensor generation:  0.0006563663482666016
mini_batch_src_global generation:  0.001142740249633789
r_  generation:  0.009992361068725586
local_output_nid generation:  0.0009768009185791016
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0011453628540039062
r_  generation:  0.010550737380981445
local_output_nid generation:  0.0009262561798095703
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.0097503662109375
local_output_nid generation:  0.0009222030639648438
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.001249551773071289
r_  generation:  0.009750843048095703
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0006003379821777344
mini_batch_src_global generation:  0.0012159347534179688
r_  generation:  0.01007699966430664
local_output_nid generation:  0.0009057521820068359
local_in_edges_tensor generation:  0.0005927085876464844
mini_batch_src_global generation:  0.001108407974243164
r_  generation:  0.010285615921020508
local_output_nid generation:  0.0008966922760009766
local_in_edges_tensor generation:  0.000591278076171875
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.01074981689453125
local_output_nid generation:  0.0009291172027587891
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.0011186599731445312
r_  generation:  0.009989023208618164
local_output_nid generation:  0.0009183883666992188
local_in_edges_tensor generation:  0.0006208419799804688
mini_batch_src_global generation:  0.0011508464813232422
r_  generation:  0.010538101196289062
local_output_nid generation:  0.0009326934814453125
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.0011723041534423828
r_  generation:  0.00971364974975586
local_output_nid generation:  0.0009174346923828125
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.010719776153564453
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.001186370849609375
r_  generation:  0.010255575180053711
local_output_nid generation:  0.0009374618530273438
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0011467933654785156
r_  generation:  0.010501384735107422
local_output_nid generation:  0.0009431838989257812
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.0011029243469238281
r_  generation:  0.010304927825927734
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0011258125305175781
r_  generation:  0.010465860366821289
local_output_nid generation:  0.0009257793426513672
local_in_edges_tensor generation:  0.0005700588226318359
mini_batch_src_global generation:  0.0010919570922851562
r_  generation:  0.010411739349365234
local_output_nid generation:  0.0009021759033203125
local_in_edges_tensor generation:  0.0005903244018554688
mini_batch_src_global generation:  0.0011239051818847656
r_  generation:  0.010168075561523438
local_output_nid generation:  0.0009093284606933594
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0010972023010253906
r_  generation:  0.009980440139770508
local_output_nid generation:  0.0008976459503173828
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011112689971923828
r_  generation:  0.010213613510131836
local_output_nid generation:  0.0008988380432128906
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0011773109436035156
r_  generation:  0.01083683967590332
local_output_nid generation:  0.0009047985076904297
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.0011296272277832031
r_  generation:  0.009991168975830078
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0005810260772705078
mini_batch_src_global generation:  0.001155853271484375
r_  generation:  0.010247945785522461
local_output_nid generation:  0.0009045600891113281
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.0011718273162841797
r_  generation:  0.01013636589050293
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0005726814270019531
mini_batch_src_global generation:  0.0011401176452636719
r_  generation:  0.01026773452758789
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0005671977996826172
mini_batch_src_global generation:  0.0011093616485595703
r_  generation:  0.009953975677490234
local_output_nid generation:  0.0009236335754394531
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.001264333724975586
r_  generation:  0.010020256042480469
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0005974769592285156
mini_batch_src_global generation:  0.0011906623840332031
r_  generation:  0.010085582733154297
local_output_nid generation:  0.0009059906005859375
local_in_edges_tensor generation:  0.0006053447723388672
mini_batch_src_global generation:  0.0011882781982421875
r_  generation:  0.010685443878173828
local_output_nid generation:  0.0009057521820068359
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.001138448715209961
r_  generation:  0.010066032409667969
local_output_nid generation:  0.0009098052978515625
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.01007699966430664
----------------------check_connections_block total spend ----------------------------- 0.5168483257293701
generate_one_block  0.02430415153503418
generate_one_block  0.019957542419433594
generate_one_block  0.018102169036865234
generate_one_block  0.0185394287109375
generate_one_block  0.017464637756347656
generate_one_block  0.017226219177246094
generate_one_block  0.017200231552124023
generate_one_block  0.017590045928955078
generate_one_block  0.018341541290283203
generate_one_block  0.017130136489868164
generate_one_block  0.017974853515625
generate_one_block  0.016723155975341797
generate_one_block  0.01806354522705078
generate_one_block  0.01749563217163086
generate_one_block  0.019656896591186523
generate_one_block  0.017340660095214844
generate_one_block  0.01783895492553711
generate_one_block  0.017436981201171875
generate_one_block  0.01703643798828125
generate_one_block  0.016903162002563477
generate_one_block  0.017438173294067383
generate_one_block  0.017986059188842773
generate_one_block  0.01697397232055664
generate_one_block  0.017573118209838867
generate_one_block  0.017221927642822266
generate_one_block  0.01740717887878418
generate_one_block  0.016762733459472656
generate_one_block  0.01707911491394043
generate_one_block  0.0169675350189209
generate_one_block  0.018140316009521484
generate_one_block  0.01700448989868164
generate_one_block  0.01734328269958496
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03282451629638672
gen group dst list time:  0.02213144302368164
time for parepare:  0.019400596618652344
local_output_nid generation:  0.005437374114990234
local_in_edges_tensor generation:  0.014236688613891602
mini_batch_src_global generation:  0.013694286346435547
r_  generation:  0.13706016540527344
local_output_nid generation:  0.007584095001220703
local_in_edges_tensor generation:  0.011620044708251953
mini_batch_src_global generation:  0.017334461212158203
r_  generation:  0.14499878883361816
local_output_nid generation:  0.0076503753662109375
local_in_edges_tensor generation:  0.02731919288635254
mini_batch_src_global generation:  0.016236066818237305
r_  generation:  0.1480867862701416
local_output_nid generation:  0.008404016494750977
local_in_edges_tensor generation:  0.0094451904296875
mini_batch_src_global generation:  0.01753711700439453
r_  generation:  0.1554734706878662
local_output_nid generation:  0.008579254150390625
local_in_edges_tensor generation:  0.010635852813720703
mini_batch_src_global generation:  0.017650127410888672
r_  generation:  0.1493234634399414
local_output_nid generation:  0.008528709411621094
local_in_edges_tensor generation:  0.008249282836914062
mini_batch_src_global generation:  0.017659425735473633
r_  generation:  0.15079665184020996
local_output_nid generation:  0.008600234985351562
local_in_edges_tensor generation:  0.009761333465576172
mini_batch_src_global generation:  0.018207550048828125
r_  generation:  0.15399932861328125
local_output_nid generation:  0.008350133895874023
local_in_edges_tensor generation:  0.009783744812011719
mini_batch_src_global generation:  0.01849222183227539
r_  generation:  0.1552579402923584
local_output_nid generation:  0.008770942687988281
local_in_edges_tensor generation:  0.0099029541015625
mini_batch_src_global generation:  0.02043437957763672
r_  generation:  0.16045713424682617
local_output_nid generation:  0.008791446685791016
local_in_edges_tensor generation:  0.008476972579956055
mini_batch_src_global generation:  0.018490314483642578
r_  generation:  0.151123046875
local_output_nid generation:  0.009090900421142578
local_in_edges_tensor generation:  0.008358001708984375
mini_batch_src_global generation:  0.019082307815551758
r_  generation:  0.15800118446350098
local_output_nid generation:  0.008564949035644531
local_in_edges_tensor generation:  0.007990360260009766
mini_batch_src_global generation:  0.01769876480102539
r_  generation:  0.14623546600341797
local_output_nid generation:  0.009240865707397461
local_in_edges_tensor generation:  0.008604288101196289
mini_batch_src_global generation:  0.019431114196777344
r_  generation:  0.16164231300354004
local_output_nid generation:  0.00887441635131836
local_in_edges_tensor generation:  0.010820150375366211
mini_batch_src_global generation:  0.018671512603759766
r_  generation:  0.153519868850708
local_output_nid generation:  0.008976459503173828
local_in_edges_tensor generation:  0.00980830192565918
mini_batch_src_global generation:  0.020090341567993164
r_  generation:  0.15709853172302246
local_output_nid generation:  0.009018182754516602
local_in_edges_tensor generation:  0.008613824844360352
mini_batch_src_global generation:  0.01874089241027832
r_  generation:  0.15334510803222656
local_output_nid generation:  0.0092926025390625
local_in_edges_tensor generation:  0.011751413345336914
mini_batch_src_global generation:  0.02057647705078125
r_  generation:  0.1609339714050293
local_output_nid generation:  0.008863210678100586
local_in_edges_tensor generation:  0.008560895919799805
mini_batch_src_global generation:  0.01897716522216797
r_  generation:  0.1535646915435791
local_output_nid generation:  0.008701086044311523
local_in_edges_tensor generation:  0.008531808853149414
mini_batch_src_global generation:  0.01829838752746582
r_  generation:  0.14943957328796387
local_output_nid generation:  0.008423328399658203
local_in_edges_tensor generation:  0.009512186050415039
mini_batch_src_global generation:  0.019245386123657227
r_  generation:  0.1534438133239746
local_output_nid generation:  0.008571863174438477
local_in_edges_tensor generation:  0.009977579116821289
mini_batch_src_global generation:  0.018500804901123047
r_  generation:  0.1523728370666504
local_output_nid generation:  0.008843183517456055
local_in_edges_tensor generation:  0.011191844940185547
mini_batch_src_global generation:  0.019969940185546875
r_  generation:  0.15810298919677734
local_output_nid generation:  0.008550643920898438
local_in_edges_tensor generation:  0.008682489395141602
mini_batch_src_global generation:  0.01871657371520996
r_  generation:  0.15162134170532227
local_output_nid generation:  0.008758068084716797
local_in_edges_tensor generation:  0.009036779403686523
mini_batch_src_global generation:  0.019822359085083008
r_  generation:  0.15634441375732422
local_output_nid generation:  0.008651018142700195
local_in_edges_tensor generation:  0.009890079498291016
mini_batch_src_global generation:  0.018543243408203125
r_  generation:  0.15265560150146484
local_output_nid generation:  0.008783578872680664
local_in_edges_tensor generation:  0.010013818740844727
mini_batch_src_global generation:  0.018710613250732422
r_  generation:  0.15755271911621094
local_output_nid generation:  0.008623361587524414
local_in_edges_tensor generation:  0.009498834609985352
mini_batch_src_global generation:  0.018162012100219727
r_  generation:  0.15514183044433594
local_output_nid generation:  0.008765220642089844
local_in_edges_tensor generation:  0.010066986083984375
mini_batch_src_global generation:  0.018732070922851562
r_  generation:  0.15793132781982422
local_output_nid generation:  0.008641242980957031
local_in_edges_tensor generation:  0.008524894714355469
mini_batch_src_global generation:  0.01849365234375
r_  generation:  0.15126919746398926
local_output_nid generation:  0.009033203125
local_in_edges_tensor generation:  0.01093912124633789
mini_batch_src_global generation:  0.01929640769958496
r_  generation:  0.1603562831878662
local_output_nid generation:  0.008600234985351562
local_in_edges_tensor generation:  0.008564472198486328
mini_batch_src_global generation:  0.018442630767822266
r_  generation:  0.15026140213012695
local_output_nid generation:  0.008718729019165039
local_in_edges_tensor generation:  0.00907588005065918
mini_batch_src_global generation:  0.01949763298034668
r_  generation:  0.15540599822998047
----------------------check_connections_block total spend ----------------------------- 7.258406400680542
generate_one_block  0.20195412635803223
generate_one_block  0.2024703025817871
generate_one_block  0.2017216682434082
generate_one_block  0.21059274673461914
generate_one_block  0.2243509292602539
generate_one_block  0.19782280921936035
generate_one_block  0.2025604248046875
generate_one_block  0.20311570167541504
generate_one_block  0.21237874031066895
generate_one_block  0.1984410285949707
generate_one_block  0.20719170570373535
generate_one_block  0.18938469886779785
generate_one_block  0.20633172988891602
generate_one_block  0.20105719566345215
generate_one_block  0.20282769203186035
generate_one_block  0.19920110702514648
generate_one_block  0.210249662399292
generate_one_block  0.20030689239501953
generate_one_block  0.1956191062927246
generate_one_block  0.19916486740112305
generate_one_block  0.19953012466430664
generate_one_block  0.2075660228729248
generate_one_block  0.1982731819152832
generate_one_block  0.20437359809875488
generate_one_block  0.19926071166992188
generate_one_block  0.20471668243408203
generate_one_block  0.1963958740234375
generate_one_block  0.20029306411743164
generate_one_block  0.19812464714050293
generate_one_block  0.2127523422241211
generate_one_block  0.19276666641235352
generate_one_block  0.20374751091003418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03558063507080078
gen group dst list time:  0.09582328796386719
time for parepare:  0.017827749252319336
local_output_nid generation:  0.022939443588256836
local_in_edges_tensor generation:  0.034188270568847656
mini_batch_src_global generation:  0.038155317306518555
r_  generation:  0.412508487701416
local_output_nid generation:  0.0288848876953125
local_in_edges_tensor generation:  0.03942441940307617
mini_batch_src_global generation:  0.048239946365356445
r_  generation:  0.41254591941833496
local_output_nid generation:  0.02828073501586914
local_in_edges_tensor generation:  0.03317618370056152
mini_batch_src_global generation:  0.04726529121398926
r_  generation:  0.43128180503845215
local_output_nid generation:  0.027664661407470703
local_in_edges_tensor generation:  0.03276491165161133
mini_batch_src_global generation:  0.04859423637390137
r_  generation:  0.4221076965332031
local_output_nid generation:  0.0275881290435791
local_in_edges_tensor generation:  0.029602766036987305
mini_batch_src_global generation:  0.04799222946166992
r_  generation:  0.4280431270599365
local_output_nid generation:  0.027579069137573242
local_in_edges_tensor generation:  0.025721073150634766
mini_batch_src_global generation:  0.049035072326660156
r_  generation:  0.4228379726409912
local_output_nid generation:  0.02767491340637207
local_in_edges_tensor generation:  0.029124736785888672
mini_batch_src_global generation:  0.0516815185546875
r_  generation:  0.4194924831390381
local_output_nid generation:  0.027814149856567383
local_in_edges_tensor generation:  0.03284335136413574
mini_batch_src_global generation:  0.04855990409851074
r_  generation:  0.42555856704711914
local_output_nid generation:  0.028459548950195312
local_in_edges_tensor generation:  0.037137508392333984
mini_batch_src_global generation:  0.052073001861572266
r_  generation:  0.4290435314178467
local_output_nid generation:  0.02784895896911621
local_in_edges_tensor generation:  0.026370763778686523
mini_batch_src_global generation:  0.0489351749420166
r_  generation:  0.4174313545227051
local_output_nid generation:  0.02811288833618164
local_in_edges_tensor generation:  0.025939226150512695
mini_batch_src_global generation:  0.05159473419189453
r_  generation:  0.42792487144470215
local_output_nid generation:  0.02761054039001465
local_in_edges_tensor generation:  0.026165246963500977
mini_batch_src_global generation:  0.048157691955566406
r_  generation:  0.4102311134338379
local_output_nid generation:  0.02794504165649414
local_in_edges_tensor generation:  0.02614307403564453
mini_batch_src_global generation:  0.048522233963012695
r_  generation:  0.4195680618286133
local_output_nid generation:  0.027727842330932617
local_in_edges_tensor generation:  0.03620624542236328
mini_batch_src_global generation:  0.05060100555419922
r_  generation:  0.4160270690917969
local_output_nid generation:  0.027872323989868164
local_in_edges_tensor generation:  0.029657602310180664
mini_batch_src_global generation:  0.048660993576049805
r_  generation:  0.42045116424560547
local_output_nid generation:  0.02769160270690918
local_in_edges_tensor generation:  0.026000022888183594
mini_batch_src_global generation:  0.04806780815124512
r_  generation:  0.41897130012512207
local_output_nid generation:  0.0281522274017334
local_in_edges_tensor generation:  0.03342270851135254
mini_batch_src_global generation:  0.05139732360839844
r_  generation:  0.4259834289550781
local_output_nid generation:  0.02776360511779785
local_in_edges_tensor generation:  0.026098251342773438
mini_batch_src_global generation:  0.04865765571594238
r_  generation:  0.42052197456359863
local_output_nid generation:  0.02765202522277832
local_in_edges_tensor generation:  0.02642369270324707
mini_batch_src_global generation:  0.04880952835083008
r_  generation:  0.4299356937408447
local_output_nid generation:  0.027675390243530273
local_in_edges_tensor generation:  0.029287099838256836
mini_batch_src_global generation:  0.05097794532775879
r_  generation:  0.4176466464996338
local_output_nid generation:  0.027759552001953125
local_in_edges_tensor generation:  0.03347969055175781
mini_batch_src_global generation:  0.047985076904296875
r_  generation:  0.42011046409606934
local_output_nid generation:  0.03112316131591797
local_in_edges_tensor generation:  0.032914161682128906
mini_batch_src_global generation:  0.04894733428955078
r_  generation:  0.4215264320373535
local_output_nid generation:  0.027509689331054688
local_in_edges_tensor generation:  0.025966882705688477
mini_batch_src_global generation:  0.04787564277648926
r_  generation:  0.41718077659606934
local_output_nid generation:  0.027697324752807617
local_in_edges_tensor generation:  0.030076980590820312
mini_batch_src_global generation:  0.048560380935668945
r_  generation:  0.42583537101745605
local_output_nid generation:  0.02783799171447754
local_in_edges_tensor generation:  0.03314781188964844
mini_batch_src_global generation:  0.04805898666381836
r_  generation:  0.4268524646759033
local_output_nid generation:  0.02768874168395996
local_in_edges_tensor generation:  0.02598094940185547
mini_batch_src_global generation:  0.04826688766479492
r_  generation:  0.42615318298339844
local_output_nid generation:  0.027278900146484375
local_in_edges_tensor generation:  0.031720638275146484
mini_batch_src_global generation:  0.04731130599975586
r_  generation:  0.41818666458129883
local_output_nid generation:  0.02792501449584961
local_in_edges_tensor generation:  0.036611318588256836
mini_batch_src_global generation:  0.048159122467041016
r_  generation:  0.4310274124145508
local_output_nid generation:  0.027784347534179688
local_in_edges_tensor generation:  0.029822111129760742
mini_batch_src_global generation:  0.048287153244018555
r_  generation:  0.4229261875152588
local_output_nid generation:  0.029076814651489258
local_in_edges_tensor generation:  0.0363919734954834
mini_batch_src_global generation:  0.048589229583740234
r_  generation:  0.4306666851043701
local_output_nid generation:  0.027724266052246094
local_in_edges_tensor generation:  0.026337146759033203
mini_batch_src_global generation:  0.04790544509887695
r_  generation:  0.41578030586242676
local_output_nid generation:  0.02806401252746582
local_in_edges_tensor generation:  0.029337644577026367
mini_batch_src_global generation:  0.05135488510131836
r_  generation:  0.42258238792419434
----------------------check_connections_block total spend ----------------------------- 19.827313661575317
generate_one_block  0.5558266639709473
generate_one_block  0.5605556964874268
generate_one_block  0.561154842376709
generate_one_block  0.5677952766418457
generate_one_block  0.7060391902923584
generate_one_block  0.5469076633453369
generate_one_block  0.5797667503356934
generate_one_block  0.5759584903717041
generate_one_block  0.6153967380523682
generate_one_block  0.5558276176452637
generate_one_block  0.5842220783233643
generate_one_block  0.5441184043884277
generate_one_block  0.5554871559143066
generate_one_block  0.5684261322021484
generate_one_block  0.5777053833007812
generate_one_block  0.5517499446868896
generate_one_block  0.5612738132476807
generate_one_block  0.5476090908050537
generate_one_block  0.5700423717498779
generate_one_block  0.5614016056060791
generate_one_block  0.5902464389801025
generate_one_block  0.5719943046569824
generate_one_block  0.5709881782531738
generate_one_block  0.5645961761474609
generate_one_block  0.5791385173797607
generate_one_block  0.5542926788330078
generate_one_block  0.5614943504333496
generate_one_block  0.5711851119995117
generate_one_block  0.5462589263916016
generate_one_block  0.5697300434112549
generate_one_block  0.5449225902557373
generate_one_block  0.5541267395019531
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.10606670379638672  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

connection checking time:  27.08572006225586
block generation total time  24.710782527923584
average batch blocks generation time:  0.772211953997612
block dataloader generation time/epoch 55.1139702796936
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08777284622192383  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([145926, 128])
torch.Size([102488, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.490342617034912  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08708953857421875  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146021, 128])
torch.Size([102004, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.471217632293701  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08776664733886719  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146364, 128])
torch.Size([102511, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.46901798248291  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08732795715332031  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146372, 128])
torch.Size([102857, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.57483959197998  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08773612976074219  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146980, 128])
torch.Size([102797, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.426332473754883  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08701658248901367  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146015, 128])
torch.Size([101686, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.374468803405762  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08775711059570312  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146285, 128])
torch.Size([102187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.452910423278809  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.08726644515991211  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([146428, 128])
torch.Size([102277, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 11.421114921569824  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2908935546875 GB
    Memory Allocated: 0.0878610610961914  GigaBytes
Max Memory Allocated: 11.62715768814087  GigaBytes

torch.Size([147312, 128])
torch.Size([104779, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.691347599029541  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08708620071411133  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146119, 128])
torch.Size([102189, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.405645847320557  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08780574798583984  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146895, 128])
torch.Size([103794, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.56134843826294  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08686494827270508  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([145838, 128])
torch.Size([100657, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.271804332733154  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08780479431152344  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146031, 128])
torch.Size([102085, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.483836650848389  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08709383010864258  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146099, 128])
torch.Size([102099, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.432015419006348  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08777284622192383  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146443, 128])
torch.Size([102794, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.466489791870117  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08736038208007812  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146661, 128])
torch.Size([102360, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.41567611694336  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.0878305435180664  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146360, 128])
torch.Size([103506, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.596321105957031  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08686065673828125  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([145614, 128])
torch.Size([101253, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.389521598815918  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08768653869628906  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146406, 128])
torch.Size([101687, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.318033218383789  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08695173263549805  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([145924, 128])
torch.Size([101341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.322530746459961  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08772134780883789  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146125, 128])
torch.Size([102429, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.408373355865479  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08729743957519531  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146396, 128])
torch.Size([102950, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.524672508239746  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08771085739135742  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([145853, 128])
torch.Size([101553, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.399912357330322  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08736228942871094  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146600, 128])
torch.Size([102753, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.500192165374756  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08772754669189453  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146063, 128])
torch.Size([102178, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.431113719940186  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08688545227050781  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([145644, 128])
torch.Size([101563, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.391928672790527  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08768033981323242  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146038, 128])
torch.Size([101091, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.314350605010986  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08753108978271484  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([147036, 128])
torch.Size([103613, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.472336769104004  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08770036697387695  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146762, 128])
torch.Size([102227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.37566089630127  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08724832534790039  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146218, 128])
torch.Size([103429, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.617702960968018  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08767175674438477  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146460, 128])
torch.Size([101071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.293042182922363  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 0.08722639083862305  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

torch.Size([146354, 128])
torch.Size([102512, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9139404296875 GB
    Memory Allocated: 11.496352195739746  GigaBytes
Max Memory Allocated: 11.700478553771973  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02011619508266449 |0.015581093728542328 |0.39195308834314346 |9.607523679733276e-05 |0.6045699864625931 |0.007724761962890625 |
----------------------------------------------------------pseudo_mini_loss sum 3.792703866958618
Total (block generation + training)time/epoch 88.20447707176208
Training time/epoch 33.09023189544678
Training time without block to device /epoch 32.59163689613342
Training time without total dataloading part /epoch 31.899537563323975
load block tensor time/epoch 0.6437182426452637
block to device time/epoch 0.4985949993133545
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8796264
Number of first layer input nodes during this epoch:  4681642
