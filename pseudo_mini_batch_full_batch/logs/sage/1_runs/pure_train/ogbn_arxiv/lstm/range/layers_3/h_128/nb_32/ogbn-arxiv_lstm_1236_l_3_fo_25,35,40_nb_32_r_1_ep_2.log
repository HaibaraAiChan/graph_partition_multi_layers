Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648472292.0123532
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024457454681396484
range selection method range initialization spend 0.012938261032104492
time for parepare:  0.01777195930480957
local_output_nid generation:  0.0007042884826660156
local_in_edges_tensor generation:  0.0034537315368652344
mini_batch_src_global generation:  0.001255035400390625
r_  generation:  0.008100032806396484
local_output_nid generation:  0.0007638931274414062
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  0.0012464523315429688
r_  generation:  0.007921695709228516
local_output_nid generation:  0.0007030963897705078
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.0008099079132080078
r_  generation:  0.007604360580444336
local_output_nid generation:  0.0007340908050537109
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0007596015930175781
r_  generation:  0.007657527923583984
local_output_nid generation:  0.0007071495056152344
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.0007691383361816406
r_  generation:  0.008100032806396484
local_output_nid generation:  0.0007188320159912109
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0007898807525634766
r_  generation:  0.007874727249145508
local_output_nid generation:  0.0007090568542480469
local_in_edges_tensor generation:  0.00046896934509277344
mini_batch_src_global generation:  0.0008256435394287109
r_  generation:  0.00784158706665039
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0007765293121337891
r_  generation:  0.007994413375854492
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.0008361339569091797
r_  generation:  0.008343935012817383
local_output_nid generation:  0.0007169246673583984
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.0007889270782470703
r_  generation:  0.007699251174926758
local_output_nid generation:  0.0007195472717285156
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0007867813110351562
r_  generation:  0.008045434951782227
local_output_nid generation:  0.0007107257843017578
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.000774383544921875
r_  generation:  0.007844924926757812
local_output_nid generation:  0.0007102489471435547
local_in_edges_tensor generation:  0.0004711151123046875
mini_batch_src_global generation:  0.00084686279296875
r_  generation:  0.008141279220581055
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.0007812976837158203
r_  generation:  0.008012533187866211
local_output_nid generation:  0.0007100105285644531
local_in_edges_tensor generation:  0.00045871734619140625
mini_batch_src_global generation:  0.0008184909820556641
r_  generation:  0.008297204971313477
local_output_nid generation:  0.0007040500640869141
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  0.0007936954498291016
r_  generation:  0.007785320281982422
local_output_nid generation:  0.0007178783416748047
local_in_edges_tensor generation:  0.0004425048828125
mini_batch_src_global generation:  0.0007865428924560547
r_  generation:  0.008006811141967773
local_output_nid generation:  0.0007076263427734375
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.0009703636169433594
r_  generation:  0.008386373519897461
local_output_nid generation:  0.000743865966796875
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0008130073547363281
r_  generation:  0.008157491683959961
local_output_nid generation:  0.0007064342498779297
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0007979869842529297
r_  generation:  0.008136510848999023
local_output_nid generation:  0.000705718994140625
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0008823871612548828
r_  generation:  0.009183883666992188
local_output_nid generation:  0.0007393360137939453
local_in_edges_tensor generation:  0.0004730224609375
mini_batch_src_global generation:  0.0008699893951416016
r_  generation:  0.00806283950805664
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0009410381317138672
r_  generation:  0.008281707763671875
local_output_nid generation:  0.0007255077362060547
local_in_edges_tensor generation:  0.0004544258117675781
mini_batch_src_global generation:  0.0008134841918945312
r_  generation:  0.008001327514648438
local_output_nid generation:  0.0007331371307373047
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.0008311271667480469
r_  generation:  0.008196353912353516
local_output_nid generation:  0.0007174015045166016
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.0008270740509033203
r_  generation:  0.008080244064331055
local_output_nid generation:  0.0007214546203613281
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0008025169372558594
r_  generation:  0.008049249649047852
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.0008516311645507812
r_  generation:  0.008087873458862305
local_output_nid generation:  0.0007274150848388672
local_in_edges_tensor generation:  0.0004527568817138672
mini_batch_src_global generation:  0.0008237361907958984
r_  generation:  0.008217096328735352
local_output_nid generation:  0.0007185935974121094
local_in_edges_tensor generation:  0.003975391387939453
mini_batch_src_global generation:  0.000989675521850586
r_  generation:  0.008109092712402344
local_output_nid generation:  0.0007762908935546875
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.0009315013885498047
r_  generation:  0.008043527603149414
local_output_nid generation:  0.0007991790771484375
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0008656978607177734
r_  generation:  0.008327007293701172
----------------------check_connections_block total spend ----------------------------- 0.4129791259765625
generate_one_block  0.01335000991821289
generate_one_block  0.013319730758666992
generate_one_block  0.013147830963134766
generate_one_block  0.013159751892089844
generate_one_block  0.013624191284179688
generate_one_block  0.013345479965209961
generate_one_block  0.013321876525878906
generate_one_block  0.013219356536865234
generate_one_block  0.01360011100769043
generate_one_block  0.012975692749023438
generate_one_block  0.01317596435546875
generate_one_block  0.012950658798217773
generate_one_block  0.013431787490844727
generate_one_block  0.012935161590576172
generate_one_block  0.013531208038330078
generate_one_block  0.012753486633300781
generate_one_block  0.012991189956665039
generate_one_block  0.013381004333496094
generate_one_block  0.01318049430847168
generate_one_block  0.01290583610534668
generate_one_block  0.013763427734375
generate_one_block  0.013117551803588867
generate_one_block  0.013465404510498047
generate_one_block  0.012955665588378906
generate_one_block  0.013177156448364258
generate_one_block  0.01304483413696289
generate_one_block  0.012916088104248047
generate_one_block  0.013019561767578125
generate_one_block  0.013178825378417969
generate_one_block  0.012883186340332031
generate_one_block  0.013187408447265625
generate_one_block  0.013380765914916992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04229927062988281
gen group dst list time:  0.020675182342529297
time for parepare:  0.018735647201538086
local_output_nid generation:  0.003732442855834961
local_in_edges_tensor generation:  0.011798381805419922
mini_batch_src_global generation:  0.010850191116333008
r_  generation:  0.11235690116882324
local_output_nid generation:  0.006150722503662109
local_in_edges_tensor generation:  0.008868694305419922
mini_batch_src_global generation:  0.013795614242553711
r_  generation:  0.12085580825805664
local_output_nid generation:  0.0064601898193359375
local_in_edges_tensor generation:  0.009306907653808594
mini_batch_src_global generation:  0.012706279754638672
r_  generation:  0.12469601631164551
local_output_nid generation:  0.006270885467529297
local_in_edges_tensor generation:  0.009400129318237305
mini_batch_src_global generation:  0.0134124755859375
r_  generation:  0.12837815284729004
local_output_nid generation:  0.006403446197509766
local_in_edges_tensor generation:  0.007867097854614258
mini_batch_src_global generation:  0.01532125473022461
r_  generation:  0.13549184799194336
local_output_nid generation:  0.0065059661865234375
local_in_edges_tensor generation:  0.007673740386962891
mini_batch_src_global generation:  0.015529155731201172
r_  generation:  0.13374948501586914
local_output_nid generation:  0.00667572021484375
local_in_edges_tensor generation:  0.007824897766113281
mini_batch_src_global generation:  0.01570582389831543
r_  generation:  0.12903380393981934
local_output_nid generation:  0.0065228939056396484
local_in_edges_tensor generation:  0.008235692977905273
mini_batch_src_global generation:  0.015429258346557617
r_  generation:  0.1317739486694336
local_output_nid generation:  0.006739377975463867
local_in_edges_tensor generation:  0.009133100509643555
mini_batch_src_global generation:  0.015942811965942383
r_  generation:  0.1354084014892578
local_output_nid generation:  0.00643467903137207
local_in_edges_tensor generation:  0.007414340972900391
mini_batch_src_global generation:  0.015315771102905273
r_  generation:  0.1291954517364502
local_output_nid generation:  0.006681680679321289
local_in_edges_tensor generation:  0.008793354034423828
mini_batch_src_global generation:  0.01617121696472168
r_  generation:  0.13304543495178223
local_output_nid generation:  0.006572246551513672
local_in_edges_tensor generation:  0.008975028991699219
mini_batch_src_global generation:  0.015859603881835938
r_  generation:  0.13007569313049316
local_output_nid generation:  0.006844043731689453
local_in_edges_tensor generation:  0.010195016860961914
mini_batch_src_global generation:  0.016865015029907227
r_  generation:  0.1360619068145752
local_output_nid generation:  0.00664973258972168
local_in_edges_tensor generation:  0.008105993270874023
mini_batch_src_global generation:  0.015531301498413086
r_  generation:  0.12926149368286133
local_output_nid generation:  0.006949663162231445
local_in_edges_tensor generation:  0.008135318756103516
mini_batch_src_global generation:  0.016033172607421875
r_  generation:  0.1378800868988037
local_output_nid generation:  0.0066220760345458984
local_in_edges_tensor generation:  0.008745670318603516
mini_batch_src_global generation:  0.015897512435913086
r_  generation:  0.13049054145812988
local_output_nid generation:  0.006754159927368164
local_in_edges_tensor generation:  0.011053085327148438
mini_batch_src_global generation:  0.015586137771606445
r_  generation:  0.13140130043029785
local_output_nid generation:  0.006956815719604492
local_in_edges_tensor generation:  0.009450197219848633
mini_batch_src_global generation:  0.016292810440063477
r_  generation:  0.1377859115600586
local_output_nid generation:  0.006746530532836914
local_in_edges_tensor generation:  0.007955789566040039
mini_batch_src_global generation:  0.016028881072998047
r_  generation:  0.1351783275604248
local_output_nid generation:  0.0067899227142333984
local_in_edges_tensor generation:  0.007885932922363281
mini_batch_src_global generation:  0.015908002853393555
r_  generation:  0.13500475883483887
local_output_nid generation:  0.007103681564331055
local_in_edges_tensor generation:  0.008862733840942383
mini_batch_src_global generation:  0.016376256942749023
r_  generation:  0.13995575904846191
local_output_nid generation:  0.006989240646362305
local_in_edges_tensor generation:  0.009067296981811523
mini_batch_src_global generation:  0.01643967628479004
r_  generation:  0.13461732864379883
local_output_nid generation:  0.007050752639770508
local_in_edges_tensor generation:  0.010376453399658203
mini_batch_src_global generation:  0.01700115203857422
r_  generation:  0.13751935958862305
local_output_nid generation:  0.0067942142486572266
local_in_edges_tensor generation:  0.008113861083984375
mini_batch_src_global generation:  0.016227006912231445
r_  generation:  0.13125038146972656
local_output_nid generation:  0.006930828094482422
local_in_edges_tensor generation:  0.008258581161499023
mini_batch_src_global generation:  0.016339778900146484
r_  generation:  0.1367018222808838
local_output_nid generation:  0.006893157958984375
local_in_edges_tensor generation:  0.010108232498168945
mini_batch_src_global generation:  0.01664280891418457
r_  generation:  0.1355750560760498
local_output_nid generation:  0.00674128532409668
local_in_edges_tensor generation:  0.0077915191650390625
mini_batch_src_global generation:  0.015436410903930664
r_  generation:  0.13283944129943848
local_output_nid generation:  0.006898403167724609
local_in_edges_tensor generation:  0.008992433547973633
mini_batch_src_global generation:  0.01739048957824707
r_  generation:  0.13534283638000488
local_output_nid generation:  0.0069239139556884766
local_in_edges_tensor generation:  0.009204864501953125
mini_batch_src_global generation:  0.016247987747192383
r_  generation:  0.1348280906677246
local_output_nid generation:  0.006833553314208984
local_in_edges_tensor generation:  0.008879423141479492
mini_batch_src_global generation:  0.01617264747619629
r_  generation:  0.13602423667907715
local_output_nid generation:  0.0067958831787109375
local_in_edges_tensor generation:  0.00763249397277832
mini_batch_src_global generation:  0.01563119888305664
r_  generation:  0.13173294067382812
local_output_nid generation:  0.006904125213623047
local_in_edges_tensor generation:  0.010051488876342773
mini_batch_src_global generation:  0.017316818237304688
r_  generation:  0.13432073593139648
----------------------check_connections_block total spend ----------------------------- 6.253367185592651
generate_one_block  0.16207623481750488
generate_one_block  0.16047096252441406
generate_one_block  0.1817014217376709
generate_one_block  0.16650032997131348
generate_one_block  0.17212414741516113
generate_one_block  0.16710734367370605
generate_one_block  0.16269135475158691
generate_one_block  0.16683244705200195
generate_one_block  0.17541027069091797
generate_one_block  0.15423154830932617
generate_one_block  0.16324877738952637
generate_one_block  0.16297483444213867
generate_one_block  0.1710669994354248
generate_one_block  0.15865206718444824
generate_one_block  0.17194533348083496
generate_one_block  0.17814850807189941
generate_one_block  0.16193389892578125
generate_one_block  0.1746983528137207
generate_one_block  0.16462922096252441
generate_one_block  0.16029763221740723
generate_one_block  0.18071556091308594
generate_one_block  0.16391825675964355
generate_one_block  0.17066693305969238
generate_one_block  0.16123700141906738
generate_one_block  0.16744041442871094
generate_one_block  0.16858386993408203
generate_one_block  0.16074514389038086
generate_one_block  0.16715145111083984
generate_one_block  0.16847562789916992
generate_one_block  0.1610565185546875
generate_one_block  0.16270709037780762
generate_one_block  0.17211627960205078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03538107872009277
gen group dst list time:  0.0943915843963623
time for parepare:  0.01879739761352539
local_output_nid generation:  0.019814014434814453
local_in_edges_tensor generation:  0.03387022018432617
mini_batch_src_global generation:  0.03905940055847168
r_  generation:  0.3773770332336426
local_output_nid generation:  0.026038408279418945
local_in_edges_tensor generation:  0.039520263671875
mini_batch_src_global generation:  0.04533958435058594
r_  generation:  0.38672566413879395
local_output_nid generation:  0.026511430740356445
local_in_edges_tensor generation:  0.028809785842895508
mini_batch_src_global generation:  0.04584193229675293
r_  generation:  0.3903377056121826
local_output_nid generation:  0.025238037109375
local_in_edges_tensor generation:  0.033437490463256836
mini_batch_src_global generation:  0.046459197998046875
r_  generation:  0.3962423801422119
local_output_nid generation:  0.025278329849243164
local_in_edges_tensor generation:  0.03386950492858887
mini_batch_src_global generation:  0.04722118377685547
r_  generation:  0.4038541316986084
local_output_nid generation:  0.024999141693115234
local_in_edges_tensor generation:  0.025729656219482422
mini_batch_src_global generation:  0.047641754150390625
r_  generation:  0.39557838439941406
local_output_nid generation:  0.025144338607788086
local_in_edges_tensor generation:  0.025274276733398438
mini_batch_src_global generation:  0.046633005142211914
r_  generation:  0.3984181880950928
local_output_nid generation:  0.02542567253112793
local_in_edges_tensor generation:  0.032623291015625
mini_batch_src_global generation:  0.04754161834716797
r_  generation:  0.40163087844848633
local_output_nid generation:  0.02503347396850586
local_in_edges_tensor generation:  0.0327911376953125
mini_batch_src_global generation:  0.047061920166015625
r_  generation:  0.40068864822387695
local_output_nid generation:  0.024626731872558594
local_in_edges_tensor generation:  0.025595426559448242
mini_batch_src_global generation:  0.04653525352478027
r_  generation:  0.3859138488769531
local_output_nid generation:  0.025555133819580078
local_in_edges_tensor generation:  0.032662153244018555
mini_batch_src_global generation:  0.046717166900634766
r_  generation:  0.4006955623626709
local_output_nid generation:  0.02515244483947754
local_in_edges_tensor generation:  0.033234357833862305
mini_batch_src_global generation:  0.047263145446777344
r_  generation:  0.3956584930419922
local_output_nid generation:  0.025498628616333008
local_in_edges_tensor generation:  0.032907724380493164
mini_batch_src_global generation:  0.049678802490234375
r_  generation:  0.4045422077178955
local_output_nid generation:  0.025102853775024414
local_in_edges_tensor generation:  0.026133298873901367
mini_batch_src_global generation:  0.046782732009887695
r_  generation:  0.3972949981689453
local_output_nid generation:  0.02541375160217285
local_in_edges_tensor generation:  0.025750160217285156
mini_batch_src_global generation:  0.04725456237792969
r_  generation:  0.4034733772277832
local_output_nid generation:  0.025387287139892578
local_in_edges_tensor generation:  0.025848865509033203
mini_batch_src_global generation:  0.046494483947753906
r_  generation:  0.39464879035949707
local_output_nid generation:  0.02527475357055664
local_in_edges_tensor generation:  0.03259396553039551
mini_batch_src_global generation:  0.04587197303771973
r_  generation:  0.3974895477294922
local_output_nid generation:  0.025692224502563477
local_in_edges_tensor generation:  0.03684234619140625
mini_batch_src_global generation:  0.05080461502075195
r_  generation:  0.4076244831085205
local_output_nid generation:  0.025311946868896484
local_in_edges_tensor generation:  0.03617119789123535
mini_batch_src_global generation:  0.0498957633972168
r_  generation:  0.40445756912231445
local_output_nid generation:  0.026405811309814453
local_in_edges_tensor generation:  0.026100635528564453
mini_batch_src_global generation:  0.061814069747924805
r_  generation:  0.40262699127197266
local_output_nid generation:  0.028905868530273438
local_in_edges_tensor generation:  0.03771805763244629
mini_batch_src_global generation:  0.052736520767211914
r_  generation:  0.4086153507232666
local_output_nid generation:  0.02635359764099121
local_in_edges_tensor generation:  0.033685922622680664
mini_batch_src_global generation:  0.05154776573181152
r_  generation:  0.3973731994628906
local_output_nid generation:  0.026453018188476562
local_in_edges_tensor generation:  0.029356718063354492
mini_batch_src_global generation:  0.0467829704284668
r_  generation:  0.4053621292114258
local_output_nid generation:  0.02598738670349121
local_in_edges_tensor generation:  0.02766895294189453
mini_batch_src_global generation:  0.04679274559020996
r_  generation:  0.3983328342437744
local_output_nid generation:  0.026424646377563477
local_in_edges_tensor generation:  0.028137922286987305
mini_batch_src_global generation:  0.0491032600402832
r_  generation:  0.40392446517944336
local_output_nid generation:  0.026289701461791992
local_in_edges_tensor generation:  0.023975372314453125
mini_batch_src_global generation:  0.04697990417480469
r_  generation:  0.3987917900085449
local_output_nid generation:  0.02593684196472168
local_in_edges_tensor generation:  0.023749113082885742
mini_batch_src_global generation:  0.046704769134521484
r_  generation:  0.40086936950683594
local_output_nid generation:  0.026201725006103516
local_in_edges_tensor generation:  0.028350353240966797
mini_batch_src_global generation:  0.049933671951293945
r_  generation:  0.39952850341796875
local_output_nid generation:  0.02625560760498047
local_in_edges_tensor generation:  0.03558540344238281
mini_batch_src_global generation:  0.04561185836791992
r_  generation:  0.40218400955200195
local_output_nid generation:  0.026040315628051758
local_in_edges_tensor generation:  0.023863554000854492
mini_batch_src_global generation:  0.04719233512878418
r_  generation:  0.4061565399169922
local_output_nid generation:  0.026471853256225586
local_in_edges_tensor generation:  0.025211334228515625
mini_batch_src_global generation:  0.04914379119873047
r_  generation:  0.4019038677215576
local_output_nid generation:  0.026328086853027344
local_in_edges_tensor generation:  0.029241085052490234
mini_batch_src_global generation:  0.04695010185241699
r_  generation:  0.39790987968444824
----------------------check_connections_block total spend ----------------------------- 18.900184631347656
generate_one_block  0.6138148307800293
generate_one_block  0.5378196239471436
generate_one_block  0.5125269889831543
generate_one_block  0.5281546115875244
generate_one_block  0.5300462245941162
generate_one_block  0.5328285694122314
generate_one_block  0.5116448402404785
generate_one_block  0.5326337814331055
generate_one_block  0.5216279029846191
generate_one_block  0.4956066608428955
generate_one_block  0.513657808303833
generate_one_block  0.5064246654510498
generate_one_block  0.5324680805206299
generate_one_block  0.5035300254821777
generate_one_block  0.520827054977417
generate_one_block  0.5029757022857666
generate_one_block  0.5104315280914307
generate_one_block  0.5372185707092285
generate_one_block  0.5087497234344482
generate_one_block  0.5288960933685303
generate_one_block  0.5472004413604736
generate_one_block  0.4990987777709961
generate_one_block  0.5170681476593018
generate_one_block  0.5045769214630127
generate_one_block  0.5142056941986084
generate_one_block  0.5134468078613281
generate_one_block  0.49916529655456543
generate_one_block  0.5149238109588623
generate_one_block  0.5118043422698975
generate_one_block  0.5541059970855713
generate_one_block  0.5749363899230957
generate_one_block  0.5419228076934814
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  25.153551816940308
block generation total time  22.115894556045532
average batch blocks generation time:  0.6911217048764229
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08330440521240234  GigaBytes
Max Memory Allocated: 0.08330440521240234  GigaBytes

torch.Size([145299, 128])
torch.Size([98690, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.8905029296875 GB
    Memory Allocated: 12.384119033813477  GigaBytes
Max Memory Allocated: 12.398571491241455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2518310546875 GB
    Memory Allocated: 0.08658409118652344  GigaBytes
Max Memory Allocated: 12.398571491241455  GigaBytes

torch.Size([145990, 128])
torch.Size([99561, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8729248046875 GB
    Memory Allocated: 12.466955184936523  GigaBytes
Max Memory Allocated: 12.481926441192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8729248046875 GB
    Memory Allocated: 0.08656787872314453  GigaBytes
Max Memory Allocated: 12.481926441192627  GigaBytes

torch.Size([145492, 128])
torch.Size([99022, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8729248046875 GB
    Memory Allocated: 12.445882320404053  GigaBytes
Max Memory Allocated: 12.481926441192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8729248046875 GB
    Memory Allocated: 0.08650636672973633  GigaBytes
Max Memory Allocated: 12.481926441192627  GigaBytes

torch.Size([145092, 128])
torch.Size([99498, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4744873046875 GB
    Memory Allocated: 12.617176532745361  GigaBytes
Max Memory Allocated: 12.632674217224121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4744873046875 GB
    Memory Allocated: 0.08768415451049805  GigaBytes
Max Memory Allocated: 12.632674217224121  GigaBytes

torch.Size([145944, 128])
torch.Size([100652, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.787399768829346  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08763408660888672  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([146459, 128])
torch.Size([100260, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.608092308044434  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08549356460571289  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145253, 128])
torch.Size([98294, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.440479755401611  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08763313293457031  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145756, 128])
torch.Size([100302, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.625303745269775  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08665895462036133  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145335, 128])
torch.Size([99737, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.697485446929932  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08490610122680664  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([144415, 128])
torch.Size([96648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.155452728271484  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08662700653076172  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145741, 128])
torch.Size([99806, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.518940925598145  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08530235290527344  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([144956, 128])
torch.Size([98014, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.362695693969727  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08765983581542969  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([146068, 128])
torch.Size([100548, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.714927673339844  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08643245697021484  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145458, 128])
torch.Size([98414, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 12.311414241790771  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 0.08765220642089844  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145671, 128])
torch.Size([100065, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 12.644043445587158  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 0.08532047271728516  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145134, 128])
torch.Size([97900, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 12.306373596191406  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 0.08530473709106445  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145035, 128])
torch.Size([98167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 12.360881328582764  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 0.08767032623291016  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145436, 128])
torch.Size([100124, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 12.719854831695557  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0916748046875 GB
    Memory Allocated: 0.08658027648925781  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145524, 128])
torch.Size([98806, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 12.45262336730957  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0936279296875 GB
    Memory Allocated: 0.0854330062866211  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([145304, 128])
torch.Size([98441, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1053466796875 GB
    Memory Allocated: 12.338926792144775  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1053466796875 GB
    Memory Allocated: 0.08770036697387695  GigaBytes
Max Memory Allocated: 12.8031005859375  GigaBytes

torch.Size([146000, 128])
torch.Size([100793, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.81617259979248  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08657169342041016  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145636, 128])
torch.Size([99140, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.437412738800049  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08765935897827148  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145749, 128])
torch.Size([100170, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.683984756469727  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.0853118896484375  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([144910, 128])
torch.Size([98409, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.398953914642334  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08762216567993164  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([146038, 128])
torch.Size([99973, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.57429027557373  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08559322357177734  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145272, 128])
torch.Size([98944, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.523486137390137  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08526754379272461  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([144939, 128])
torch.Size([97963, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.335992336273193  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08761787414550781  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145508, 128])
torch.Size([99650, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.538256168365479  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.0856008529663086  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145370, 128])
torch.Size([99272, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.483977794647217  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08527469635009766  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([144980, 128])
torch.Size([97845, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.33330488204956  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08654117584228516  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145641, 128])
torch.Size([99450, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.443565845489502  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08662700653076172  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145534, 128])
torch.Size([99197, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.514459609985352  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031325437128543854 |0.02442622184753418 |0.25920774042606354 |9.761005640029907e-05 |0.3464190363883972 |0.006848335266113281 |
----------------------------------------------------------pseudo_mini_loss sum 4.998668670654297
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8580977
Number of first layer input nodes during this epoch:  4654939
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.10711193084716797  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.020654916763305664
range selection method range initialization spend 0.012827396392822266
time for parepare:  0.01769542694091797
local_output_nid generation:  0.0008726119995117188
local_in_edges_tensor generation:  0.0038220882415771484
mini_batch_src_global generation:  0.0014739036560058594
r_  generation:  0.00875997543334961
local_output_nid generation:  0.0009198188781738281
local_in_edges_tensor generation:  0.0006318092346191406
mini_batch_src_global generation:  0.0013761520385742188
r_  generation:  0.009024381637573242
local_output_nid generation:  0.0008902549743652344
local_in_edges_tensor generation:  0.0005819797515869141
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.00819087028503418
local_output_nid generation:  0.0008826255798339844
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.0009474754333496094
r_  generation:  0.007858037948608398
local_output_nid generation:  0.0008237361907958984
local_in_edges_tensor generation:  0.0005221366882324219
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.008217573165893555
local_output_nid generation:  0.0008301734924316406
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.0010571479797363281
r_  generation:  0.009375810623168945
local_output_nid generation:  0.00081634521484375
local_in_edges_tensor generation:  0.0005309581756591797
mini_batch_src_global generation:  0.0008878707885742188
r_  generation:  0.008021831512451172
local_output_nid generation:  0.0008740425109863281
local_in_edges_tensor generation:  0.0005505084991455078
mini_batch_src_global generation:  0.0008916854858398438
r_  generation:  0.00823211669921875
local_output_nid generation:  0.0008261203765869141
local_in_edges_tensor generation:  0.0005114078521728516
mini_batch_src_global generation:  0.0008816719055175781
r_  generation:  0.008337736129760742
local_output_nid generation:  0.0008294582366943359
local_in_edges_tensor generation:  0.0005199909210205078
mini_batch_src_global generation:  0.0008456707000732422
r_  generation:  0.008292436599731445
local_output_nid generation:  0.0009388923645019531
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0008602142333984375
r_  generation:  0.008349895477294922
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0005266666412353516
mini_batch_src_global generation:  0.0008885860443115234
r_  generation:  0.00806879997253418
local_output_nid generation:  0.0008101463317871094
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0008687973022460938
r_  generation:  0.008026599884033203
local_output_nid generation:  0.0008149147033691406
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0008502006530761719
r_  generation:  0.008246660232543945
local_output_nid generation:  0.0008070468902587891
local_in_edges_tensor generation:  0.0005154609680175781
mini_batch_src_global generation:  0.0010309219360351562
r_  generation:  0.00855565071105957
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0004949569702148438
mini_batch_src_global generation:  0.0009019374847412109
r_  generation:  0.008377552032470703
local_output_nid generation:  0.0008113384246826172
local_in_edges_tensor generation:  0.0005075931549072266
mini_batch_src_global generation:  0.001004934310913086
r_  generation:  0.00855398178100586
local_output_nid generation:  0.0008156299591064453
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0008881092071533203
r_  generation:  0.008425712585449219
local_output_nid generation:  0.0007948875427246094
local_in_edges_tensor generation:  0.0004906654357910156
mini_batch_src_global generation:  0.0008330345153808594
r_  generation:  0.00809335708618164
local_output_nid generation:  0.00080108642578125
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0008828639984130859
r_  generation:  0.00851893424987793
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0005042552947998047
mini_batch_src_global generation:  0.0008785724639892578
r_  generation:  0.008297443389892578
local_output_nid generation:  0.0007977485656738281
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.008158445358276367
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0005099773406982422
mini_batch_src_global generation:  0.0008642673492431641
r_  generation:  0.008325576782226562
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0005083084106445312
mini_batch_src_global generation:  0.0008561611175537109
r_  generation:  0.008323431015014648
local_output_nid generation:  0.0008327960968017578
local_in_edges_tensor generation:  0.0005135536193847656
mini_batch_src_global generation:  0.0008428096771240234
r_  generation:  0.008380413055419922
local_output_nid generation:  0.0007641315460205078
local_in_edges_tensor generation:  0.0005013942718505859
mini_batch_src_global generation:  0.0008685588836669922
r_  generation:  0.008316516876220703
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0008480548858642578
r_  generation:  0.008393049240112305
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.0005147457122802734
mini_batch_src_global generation:  0.0008742809295654297
r_  generation:  0.008280038833618164
local_output_nid generation:  0.0007910728454589844
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.000873565673828125
r_  generation:  0.00850057601928711
local_output_nid generation:  0.0008072853088378906
local_in_edges_tensor generation:  0.0005092620849609375
mini_batch_src_global generation:  0.0008921623229980469
r_  generation:  0.008351802825927734
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0008678436279296875
r_  generation:  0.008349418640136719
local_output_nid generation:  0.0007853507995605469
local_in_edges_tensor generation:  0.0005054473876953125
mini_batch_src_global generation:  0.0008716583251953125
r_  generation:  0.008235692977905273
----------------------check_connections_block total spend ----------------------------- 0.4317433834075928
generate_one_block  0.020032882690429688
generate_one_block  0.017074108123779297
generate_one_block  0.015237808227539062
generate_one_block  0.014329195022583008
generate_one_block  0.014760971069335938
generate_one_block  0.015131235122680664
generate_one_block  0.01426243782043457
generate_one_block  0.014475822448730469
generate_one_block  0.014861106872558594
generate_one_block  0.014418363571166992
generate_one_block  0.014452219009399414
generate_one_block  0.014196157455444336
generate_one_block  0.01403355598449707
generate_one_block  0.014562368392944336
generate_one_block  0.014987468719482422
generate_one_block  0.014512777328491211
generate_one_block  0.014748334884643555
generate_one_block  0.014558553695678711
generate_one_block  0.014103412628173828
generate_one_block  0.014660120010375977
generate_one_block  0.014353036880493164
generate_one_block  0.014192342758178711
generate_one_block  0.014508485794067383
generate_one_block  0.014482259750366211
generate_one_block  0.014564275741577148
generate_one_block  0.014310121536254883
generate_one_block  0.01447153091430664
generate_one_block  0.014394760131835938
generate_one_block  0.014586448669433594
generate_one_block  0.014464855194091797
generate_one_block  0.01440882682800293
generate_one_block  0.014247417449951172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036798715591430664
gen group dst list time:  0.020348072052001953
time for parepare:  0.019518136978149414
local_output_nid generation:  0.004482269287109375
local_in_edges_tensor generation:  0.013445377349853516
mini_batch_src_global generation:  0.01140451431274414
r_  generation:  0.11805558204650879
local_output_nid generation:  0.007270336151123047
local_in_edges_tensor generation:  0.00823831558227539
mini_batch_src_global generation:  0.01470637321472168
r_  generation:  0.12561821937561035
local_output_nid generation:  0.007483005523681641
local_in_edges_tensor generation:  0.02562999725341797
mini_batch_src_global generation:  0.013909578323364258
r_  generation:  0.1321556568145752
local_output_nid generation:  0.007649421691894531
local_in_edges_tensor generation:  0.006729841232299805
mini_batch_src_global generation:  0.013802528381347656
r_  generation:  0.12510228157043457
local_output_nid generation:  0.008200883865356445
local_in_edges_tensor generation:  0.008620738983154297
mini_batch_src_global generation:  0.015067815780639648
r_  generation:  0.1348731517791748
local_output_nid generation:  0.008468866348266602
local_in_edges_tensor generation:  0.00832223892211914
mini_batch_src_global generation:  0.022513151168823242
r_  generation:  0.13817977905273438
local_output_nid generation:  0.008069038391113281
local_in_edges_tensor generation:  0.008067846298217773
mini_batch_src_global generation:  0.015825986862182617
r_  generation:  0.1348860263824463
local_output_nid generation:  0.008024215698242188
local_in_edges_tensor generation:  0.009176969528198242
mini_batch_src_global generation:  0.015723466873168945
r_  generation:  0.13388991355895996
local_output_nid generation:  0.008128166198730469
local_in_edges_tensor generation:  0.007170677185058594
mini_batch_src_global generation:  0.016095638275146484
r_  generation:  0.13579893112182617
local_output_nid generation:  0.00849294662475586
local_in_edges_tensor generation:  0.007120847702026367
mini_batch_src_global generation:  0.01579427719116211
r_  generation:  0.13336563110351562
local_output_nid generation:  0.008632659912109375
local_in_edges_tensor generation:  0.008831024169921875
mini_batch_src_global generation:  0.01616382598876953
r_  generation:  0.13827228546142578
local_output_nid generation:  0.008352279663085938
local_in_edges_tensor generation:  0.006905317306518555
mini_batch_src_global generation:  0.017897367477416992
r_  generation:  0.13052988052368164
local_output_nid generation:  0.008471965789794922
local_in_edges_tensor generation:  0.008979320526123047
mini_batch_src_global generation:  0.015495061874389648
r_  generation:  0.13569974899291992
local_output_nid generation:  0.008773565292358398
local_in_edges_tensor generation:  0.008576154708862305
mini_batch_src_global generation:  0.01635289192199707
r_  generation:  0.13878941535949707
local_output_nid generation:  0.008908748626708984
local_in_edges_tensor generation:  0.009692192077636719
mini_batch_src_global generation:  0.0170133113861084
r_  generation:  0.1425464153289795
local_output_nid generation:  0.008768320083618164
local_in_edges_tensor generation:  0.007417201995849609
mini_batch_src_global generation:  0.016712188720703125
r_  generation:  0.14187955856323242
local_output_nid generation:  0.00902414321899414
local_in_edges_tensor generation:  0.009699583053588867
mini_batch_src_global generation:  0.016538143157958984
r_  generation:  0.1408073902130127
local_output_nid generation:  0.008938789367675781
local_in_edges_tensor generation:  0.009425163269042969
mini_batch_src_global generation:  0.016191959381103516
r_  generation:  0.13817143440246582
local_output_nid generation:  0.009808540344238281
local_in_edges_tensor generation:  0.013999223709106445
mini_batch_src_global generation:  0.01815485954284668
r_  generation:  0.1404423713684082
local_output_nid generation:  0.009924888610839844
local_in_edges_tensor generation:  0.009786367416381836
mini_batch_src_global generation:  0.021671533584594727
r_  generation:  0.14154624938964844
local_output_nid generation:  0.008993387222290039
local_in_edges_tensor generation:  0.0081634521484375
mini_batch_src_global generation:  0.016179800033569336
r_  generation:  0.13900446891784668
local_output_nid generation:  0.008584022521972656
local_in_edges_tensor generation:  0.010235786437988281
mini_batch_src_global generation:  0.015995502471923828
r_  generation:  0.13488984107971191
local_output_nid generation:  0.008663654327392578
local_in_edges_tensor generation:  0.008639097213745117
mini_batch_src_global generation:  0.01676774024963379
r_  generation:  0.1379694938659668
local_output_nid generation:  0.008656978607177734
local_in_edges_tensor generation:  0.0075223445892333984
mini_batch_src_global generation:  0.016312837600708008
r_  generation:  0.13735580444335938
local_output_nid generation:  0.008770227432250977
local_in_edges_tensor generation:  0.008971452713012695
mini_batch_src_global generation:  0.016310453414916992
r_  generation:  0.14023160934448242
local_output_nid generation:  0.008635997772216797
local_in_edges_tensor generation:  0.007682323455810547
mini_batch_src_global generation:  0.016051530838012695
r_  generation:  0.13599562644958496
local_output_nid generation:  0.008716583251953125
local_in_edges_tensor generation:  0.0074460506439208984
mini_batch_src_global generation:  0.016170978546142578
r_  generation:  0.13748717308044434
local_output_nid generation:  0.008725643157958984
local_in_edges_tensor generation:  0.008577585220336914
mini_batch_src_global generation:  0.016269683837890625
r_  generation:  0.13823246955871582
local_output_nid generation:  0.008756637573242188
local_in_edges_tensor generation:  0.010906457901000977
mini_batch_src_global generation:  0.0164639949798584
r_  generation:  0.14273786544799805
local_output_nid generation:  0.008710384368896484
local_in_edges_tensor generation:  0.007611274719238281
mini_batch_src_global generation:  0.0161592960357666
r_  generation:  0.13779234886169434
local_output_nid generation:  0.008531570434570312
local_in_edges_tensor generation:  0.00842738151550293
mini_batch_src_global generation:  0.015892982482910156
r_  generation:  0.13837575912475586
local_output_nid generation:  0.008607149124145508
local_in_edges_tensor generation:  0.010529041290283203
mini_batch_src_global generation:  0.01641249656677246
r_  generation:  0.1380608081817627
----------------------check_connections_block total spend ----------------------------- 6.506443977355957
generate_one_block  0.18218159675598145
generate_one_block  0.17372894287109375
generate_one_block  0.1797175407409668
generate_one_block  0.1652393341064453
generate_one_block  0.18968462944030762
generate_one_block  0.18252182006835938
generate_one_block  0.17292380332946777
generate_one_block  0.1717379093170166
generate_one_block  0.17448878288269043
generate_one_block  0.1697065830230713
generate_one_block  0.17815160751342773
generate_one_block  0.1669454574584961
generate_one_block  0.16959142684936523
generate_one_block  0.17945146560668945
generate_one_block  0.1845691204071045
generate_one_block  0.17176151275634766
generate_one_block  0.1773838996887207
generate_one_block  0.1721336841583252
generate_one_block  0.16951847076416016
generate_one_block  0.20242023468017578
generate_one_block  0.17651152610778809
generate_one_block  0.16859912872314453
generate_one_block  0.1713120937347412
generate_one_block  0.17750167846679688
generate_one_block  0.17789864540100098
generate_one_block  0.16993093490600586
generate_one_block  0.17430520057678223
generate_one_block  0.17662835121154785
generate_one_block  0.17772173881530762
generate_one_block  0.17699599266052246
generate_one_block  0.17119145393371582
generate_one_block  0.1711132526397705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.048102378845214844
gen group dst list time:  0.10866832733154297
time for parepare:  0.020272493362426758
local_output_nid generation:  0.021253585815429688
local_in_edges_tensor generation:  0.050202131271362305
mini_batch_src_global generation:  0.03747415542602539
r_  generation:  0.3953704833984375
local_output_nid generation:  0.03332328796386719
local_in_edges_tensor generation:  0.04057884216308594
mini_batch_src_global generation:  0.049344778060913086
r_  generation:  0.42386603355407715
local_output_nid generation:  0.03270220756530762
local_in_edges_tensor generation:  0.043428659439086914
mini_batch_src_global generation:  0.052832841873168945
r_  generation:  0.40244126319885254
local_output_nid generation:  0.02673053741455078
local_in_edges_tensor generation:  0.0300900936126709
mini_batch_src_global generation:  0.04678606986999512
r_  generation:  0.3934900760650635
local_output_nid generation:  0.027034521102905273
local_in_edges_tensor generation:  0.030644655227661133
mini_batch_src_global generation:  0.049057722091674805
r_  generation:  0.41304850578308105
local_output_nid generation:  0.04166102409362793
local_in_edges_tensor generation:  0.03753519058227539
mini_batch_src_global generation:  0.04745054244995117
r_  generation:  0.4051675796508789
local_output_nid generation:  0.029105424880981445
local_in_edges_tensor generation:  0.030266761779785156
mini_batch_src_global generation:  0.04699826240539551
r_  generation:  0.41238951683044434
local_output_nid generation:  0.03163766860961914
local_in_edges_tensor generation:  0.03045201301574707
mini_batch_src_global generation:  0.04715323448181152
r_  generation:  0.40819454193115234
local_output_nid generation:  0.02883148193359375
local_in_edges_tensor generation:  0.04858207702636719
mini_batch_src_global generation:  0.04731488227844238
r_  generation:  0.4263625144958496
local_output_nid generation:  0.028359651565551758
local_in_edges_tensor generation:  0.03750252723693848
mini_batch_src_global generation:  0.05178999900817871
r_  generation:  0.4079720973968506
local_output_nid generation:  0.027542591094970703
local_in_edges_tensor generation:  0.03378009796142578
mini_batch_src_global generation:  0.04706740379333496
r_  generation:  0.4143056869506836
local_output_nid generation:  0.026711463928222656
local_in_edges_tensor generation:  0.02728104591369629
mini_batch_src_global generation:  0.046891212463378906
r_  generation:  0.4013245105743408
local_output_nid generation:  0.02674722671508789
local_in_edges_tensor generation:  0.03132438659667969
mini_batch_src_global generation:  0.0464320182800293
r_  generation:  0.4032738208770752
local_output_nid generation:  0.02709197998046875
local_in_edges_tensor generation:  0.03153085708618164
mini_batch_src_global generation:  0.050121307373046875
r_  generation:  0.40352582931518555
local_output_nid generation:  0.027006149291992188
local_in_edges_tensor generation:  0.03115081787109375
mini_batch_src_global generation:  0.05739951133728027
r_  generation:  0.4118995666503906
local_output_nid generation:  0.027147293090820312
local_in_edges_tensor generation:  0.024663209915161133
mini_batch_src_global generation:  0.047783851623535156
r_  generation:  0.40603184700012207
local_output_nid generation:  0.02746438980102539
local_in_edges_tensor generation:  0.024821758270263672
mini_batch_src_global generation:  0.04952740669250488
r_  generation:  0.4149181842803955
local_output_nid generation:  0.027799129486083984
local_in_edges_tensor generation:  0.029661178588867188
mini_batch_src_global generation:  0.04873061180114746
r_  generation:  0.40000104904174805
local_output_nid generation:  0.026802539825439453
local_in_edges_tensor generation:  0.027290821075439453
mini_batch_src_global generation:  0.04651165008544922
r_  generation:  0.40747928619384766
local_output_nid generation:  0.027224302291870117
local_in_edges_tensor generation:  0.03155994415283203
mini_batch_src_global generation:  0.04979753494262695
r_  generation:  0.4046955108642578
local_output_nid generation:  0.027099132537841797
local_in_edges_tensor generation:  0.024600505828857422
mini_batch_src_global generation:  0.04698634147644043
r_  generation:  0.409527063369751
local_output_nid generation:  0.026764392852783203
local_in_edges_tensor generation:  0.027304649353027344
mini_batch_src_global generation:  0.04675173759460449
r_  generation:  0.4031827449798584
local_output_nid generation:  0.027260303497314453
local_in_edges_tensor generation:  0.02855396270751953
mini_batch_src_global generation:  0.04902172088623047
r_  generation:  0.4170191287994385
local_output_nid generation:  0.029160737991333008
local_in_edges_tensor generation:  0.03530383110046387
mini_batch_src_global generation:  0.04871320724487305
r_  generation:  0.4094858169555664
local_output_nid generation:  0.02729487419128418
local_in_edges_tensor generation:  0.029819726943969727
mini_batch_src_global generation:  0.0497746467590332
r_  generation:  0.4107668399810791
local_output_nid generation:  0.02695941925048828
local_in_edges_tensor generation:  0.027339696884155273
mini_batch_src_global generation:  0.0470280647277832
r_  generation:  0.4040060043334961
local_output_nid generation:  0.02722644805908203
local_in_edges_tensor generation:  0.027982234954833984
mini_batch_src_global generation:  0.04991769790649414
r_  generation:  0.4105706214904785
local_output_nid generation:  0.027261972427368164
local_in_edges_tensor generation:  0.03142237663269043
mini_batch_src_global generation:  0.04703354835510254
r_  generation:  0.40946364402770996
local_output_nid generation:  0.02734994888305664
local_in_edges_tensor generation:  0.028453588485717773
mini_batch_src_global generation:  0.0473177433013916
r_  generation:  0.40926194190979004
local_output_nid generation:  0.0269927978515625
local_in_edges_tensor generation:  0.028101205825805664
mini_batch_src_global generation:  0.06507205963134766
r_  generation:  0.4087390899658203
local_output_nid generation:  0.027118444442749023
local_in_edges_tensor generation:  0.02454209327697754
mini_batch_src_global generation:  0.0468907356262207
r_  generation:  0.40877389907836914
local_output_nid generation:  0.027133703231811523
local_in_edges_tensor generation:  0.02384781837463379
mini_batch_src_global generation:  0.04927396774291992
r_  generation:  0.4030284881591797
----------------------check_connections_block total spend ----------------------------- 19.378058195114136
generate_one_block  0.5352809429168701
generate_one_block  0.5446879863739014
generate_one_block  0.5327723026275635
generate_one_block  0.5187926292419434
generate_one_block  0.6573224067687988
generate_one_block  0.5445461273193359
generate_one_block  0.5399966239929199
generate_one_block  0.5229654312133789
generate_one_block  0.533851146697998
generate_one_block  0.5302062034606934
generate_one_block  0.5342862606048584
generate_one_block  0.5259554386138916
generate_one_block  0.5359866619110107
generate_one_block  0.5471019744873047
generate_one_block  0.5506761074066162
generate_one_block  0.5228865146636963
generate_one_block  0.5307726860046387
generate_one_block  0.5210840702056885
generate_one_block  0.5177507400512695
generate_one_block  0.5412201881408691
generate_one_block  0.5384261608123779
generate_one_block  0.5145931243896484
generate_one_block  0.5287401676177979
generate_one_block  0.5384504795074463
generate_one_block  0.5616040229797363
generate_one_block  0.5395820140838623
generate_one_block  0.5339312553405762
generate_one_block  0.537832498550415
generate_one_block  0.539665937423706
generate_one_block  0.5284225940704346
generate_one_block  0.5233128070831299
generate_one_block  0.5267302989959717
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.10711193084716797  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

connection checking time:  25.884502172470093
block generation total time  22.823001623153687
average batch blocks generation time:  0.7132188007235527
block dataloader generation time/epoch 51.27608394622803
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.08890581130981445  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145094, 128])
torch.Size([98553, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.404945373535156  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.09114599227905273  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([146204, 128])
torch.Size([100274, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 12.585566997528076  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1307373046875 GB
    Memory Allocated: 0.09011983871459961  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145237, 128])
torch.Size([99281, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.601447105407715  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08989810943603516  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145702, 128])
torch.Size([98570, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.30482292175293  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09116697311401367  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145805, 128])
torch.Size([100264, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.660867691040039  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09119939804077148  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145956, 128])
torch.Size([100063, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.711406230926514  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09112167358398438  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([146014, 128])
torch.Size([99740, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.54900074005127  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.0890188217163086  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145204, 128])
torch.Size([98921, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.465277671813965  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09013938903808594  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145960, 128])
torch.Size([99626, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.520569324493408  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09000587463378906  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145481, 128])
torch.Size([98713, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.363700866699219  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08915185928344727  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145343, 128])
torch.Size([98547, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.533317565917969  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08846902847290039  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([144478, 128])
torch.Size([96920, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.215869903564453  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08884477615356445  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145115, 128])
torch.Size([97686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.322567462921143  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.0900716781616211  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145178, 128])
torch.Size([99163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.586673736572266  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09120655059814453  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145419, 128])
torch.Size([100076, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.75194501876831  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09010982513427734  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145576, 128])
torch.Size([99039, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.461871147155762  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09114980697631836  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145978, 128])
torch.Size([100604, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.62448501586914  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08885049819946289  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([144909, 128])
torch.Size([98113, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.443316459655762  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08895254135131836  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145207, 128])
torch.Size([98301, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.38328218460083  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09015274047851562  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145622, 128])
torch.Size([99188, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.537100315093994  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.0901174545288086  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145551, 128])
torch.Size([98953, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.503291606903076  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.0886831283569336  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([144964, 128])
torch.Size([97219, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.271753311157227  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.090057373046875  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145467, 128])
torch.Size([98968, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.412128925323486  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09010124206542969  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145500, 128])
torch.Size([98932, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.482619285583496  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09115314483642578  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145991, 128])
torch.Size([99852, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.583538055419922  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08886432647705078  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145056, 128])
torch.Size([98565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.394730567932129  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.08917093276977539  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145391, 128])
torch.Size([99173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.538206577301025  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.09013938903808594  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145966, 128])
torch.Size([99593, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 12.49834156036377  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1483154296875 GB
    Memory Allocated: 0.0901341438293457  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145319, 128])
torch.Size([99108, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 12.531335830688477  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 0.09015083312988281  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145419, 128])
torch.Size([99183, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 12.523922443389893  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 0.08909368515014648  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145397, 128])
torch.Size([98874, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 12.429995059967041  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 0.08896636962890625  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

torch.Size([145174, 128])
torch.Size([98493, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1639404296875 GB
    Memory Allocated: 12.41148042678833  GigaBytes
Max Memory Allocated: 12.831801414489746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03386051952838898 |0.012905038893222809 |0.23860770463943481 |9.163469076156616e-05 |0.3267146572470665 |0.006021022796630859 |
----------------------------------------------------------pseudo_mini_loss sum 3.3100638389587402
Total (block generation + training)time/epoch 70.92387437820435
Training time/epoch 19.647513151168823
Training time without block to device /epoch 19.234551906585693
Training time without total dataloading part /epoch 18.099268913269043
load block tensor time/epoch 1.0835366249084473
block to device time/epoch 0.4129612445831299
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8574861
Number of first layer input nodes during this epoch:  4654677
