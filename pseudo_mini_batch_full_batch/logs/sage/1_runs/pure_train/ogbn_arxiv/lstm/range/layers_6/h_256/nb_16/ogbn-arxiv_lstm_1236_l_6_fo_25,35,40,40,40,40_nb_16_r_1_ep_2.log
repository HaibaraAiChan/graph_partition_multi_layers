Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648528426.7961178
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0291748046875 GB
    Memory Allocated: 0.012590885162353516  GigaBytes
Max Memory Allocated: 0.012590885162353516  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.024924278259277344
range selection method range initialization spend 0.01359248161315918
time for parepare:  0.017781972885131836
local_output_nid generation:  0.00139617919921875
local_in_edges_tensor generation:  0.0038230419158935547
mini_batch_src_global generation:  0.0017774105072021484
r_  generation:  0.018242597579956055
local_output_nid generation:  0.0014824867248535156
local_in_edges_tensor generation:  0.0009288787841796875
mini_batch_src_global generation:  0.002184152603149414
r_  generation:  0.018178701400756836
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0008618831634521484
mini_batch_src_global generation:  0.0013899803161621094
r_  generation:  0.017612695693969727
local_output_nid generation:  0.0015025138854980469
local_in_edges_tensor generation:  0.0008475780487060547
mini_batch_src_global generation:  0.0013566017150878906
r_  generation:  0.017740726470947266
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0008559226989746094
mini_batch_src_global generation:  0.0012624263763427734
r_  generation:  0.018135786056518555
local_output_nid generation:  0.0014698505401611328
local_in_edges_tensor generation:  0.00083160400390625
mini_batch_src_global generation:  0.0014312267303466797
r_  generation:  0.018602609634399414
local_output_nid generation:  0.0015230178833007812
local_in_edges_tensor generation:  0.0008387565612792969
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.01871323585510254
local_output_nid generation:  0.0014755725860595703
local_in_edges_tensor generation:  0.0008144378662109375
mini_batch_src_global generation:  0.001478433609008789
r_  generation:  0.019579410552978516
local_output_nid generation:  0.0015490055084228516
local_in_edges_tensor generation:  0.0009074211120605469
mini_batch_src_global generation:  0.0013790130615234375
r_  generation:  0.01868605613708496
local_output_nid generation:  0.0014884471893310547
local_in_edges_tensor generation:  0.0008308887481689453
mini_batch_src_global generation:  0.0014455318450927734
r_  generation:  0.018931150436401367
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.0008249282836914062
mini_batch_src_global generation:  0.0014772415161132812
r_  generation:  0.018684864044189453
local_output_nid generation:  0.00146484375
local_in_edges_tensor generation:  0.0008289813995361328
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.018552303314208984
local_output_nid generation:  0.0014772415161132812
local_in_edges_tensor generation:  0.0008137226104736328
mini_batch_src_global generation:  0.0015559196472167969
r_  generation:  0.01861715316772461
local_output_nid generation:  0.0015065670013427734
local_in_edges_tensor generation:  0.0008821487426757812
mini_batch_src_global generation:  0.0014064311981201172
r_  generation:  0.019175052642822266
local_output_nid generation:  0.001512765884399414
local_in_edges_tensor generation:  0.000843048095703125
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.018559694290161133
local_output_nid generation:  0.0014796257019042969
local_in_edges_tensor generation:  0.0008778572082519531
mini_batch_src_global generation:  0.0014908313751220703
r_  generation:  0.018247604370117188
----------------------check_connections_block total spend ----------------------------- 0.44497203826904297
generate_one_block  0.02671051025390625
generate_one_block  0.028129100799560547
generate_one_block  0.027057170867919922
generate_one_block  0.02864551544189453
generate_one_block  0.0277252197265625
generate_one_block  0.027374744415283203
generate_one_block  0.02742934226989746
generate_one_block  0.028008699417114258
generate_one_block  0.027266740798950195
generate_one_block  0.02724623680114746
generate_one_block  0.02694845199584961
generate_one_block  0.02690744400024414
generate_one_block  0.027256250381469727
generate_one_block  0.028092384338378906
generate_one_block  0.027173280715942383
generate_one_block  0.02650165557861328
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.03965306282043457
gen group dst list time:  0.018834590911865234
time for parepare:  0.019002437591552734
local_output_nid generation:  0.006502389907836914
local_in_edges_tensor generation:  0.014391422271728516
mini_batch_src_global generation:  0.019298076629638672
r_  generation:  0.196044921875
local_output_nid generation:  0.010072708129882812
local_in_edges_tensor generation:  0.018812179565429688
mini_batch_src_global generation:  0.02551126480102539
r_  generation:  0.20738744735717773
local_output_nid generation:  0.010174036026000977
local_in_edges_tensor generation:  0.013326168060302734
mini_batch_src_global generation:  0.02363443374633789
r_  generation:  0.21454334259033203
local_output_nid generation:  0.010399103164672852
local_in_edges_tensor generation:  0.01370859146118164
mini_batch_src_global generation:  0.024899005889892578
r_  generation:  0.21072983741760254
local_output_nid generation:  0.010758161544799805
local_in_edges_tensor generation:  0.017746448516845703
mini_batch_src_global generation:  0.027983903884887695
r_  generation:  0.21926546096801758
local_output_nid generation:  0.01093435287475586
local_in_edges_tensor generation:  0.01605224609375
mini_batch_src_global generation:  0.026842355728149414
r_  generation:  0.2205493450164795
local_output_nid generation:  0.01078486442565918
local_in_edges_tensor generation:  0.012434005737304688
mini_batch_src_global generation:  0.027119159698486328
r_  generation:  0.21480679512023926
local_output_nid generation:  0.01130533218383789
local_in_edges_tensor generation:  0.014450550079345703
mini_batch_src_global generation:  0.029477596282958984
r_  generation:  0.2241058349609375
local_output_nid generation:  0.011022090911865234
local_in_edges_tensor generation:  0.018084287643432617
mini_batch_src_global generation:  0.027481794357299805
r_  generation:  0.22925209999084473
local_output_nid generation:  0.011106014251708984
local_in_edges_tensor generation:  0.01273798942565918
mini_batch_src_global generation:  0.02740001678466797
r_  generation:  0.21819233894348145
local_output_nid generation:  0.01127171516418457
local_in_edges_tensor generation:  0.012650728225708008
mini_batch_src_global generation:  0.02700495719909668
r_  generation:  0.21685242652893066
local_output_nid generation:  0.011269807815551758
local_in_edges_tensor generation:  0.012327432632446289
mini_batch_src_global generation:  0.02718210220336914
r_  generation:  0.21270060539245605
local_output_nid generation:  0.011194229125976562
local_in_edges_tensor generation:  0.016031980514526367
mini_batch_src_global generation:  0.027053356170654297
r_  generation:  0.2205519676208496
local_output_nid generation:  0.011374711990356445
local_in_edges_tensor generation:  0.018341779708862305
mini_batch_src_global generation:  0.027789831161499023
r_  generation:  0.22410106658935547
local_output_nid generation:  0.014334917068481445
local_in_edges_tensor generation:  0.01264643669128418
mini_batch_src_global generation:  0.02714228630065918
r_  generation:  0.22310686111450195
local_output_nid generation:  0.011066913604736328
local_in_edges_tensor generation:  0.012629508972167969
mini_batch_src_global generation:  0.027405261993408203
r_  generation:  0.21510910987854004
----------------------check_connections_block total spend ----------------------------- 5.091963052749634
generate_one_block  0.2804281711578369
generate_one_block  0.28646326065063477
generate_one_block  0.2750089168548584
generate_one_block  0.27579283714294434
generate_one_block  0.3127319812774658
generate_one_block  0.2834198474884033
generate_one_block  0.27431392669677734
generate_one_block  0.2973825931549072
generate_one_block  0.28502583503723145
generate_one_block  0.2798583507537842
generate_one_block  0.27654194831848145
generate_one_block  0.27828550338745117
generate_one_block  0.2810094356536865
generate_one_block  0.2966125011444092
generate_one_block  0.2727234363555908
generate_one_block  0.2729024887084961
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03617978096008301
gen group dst list time:  0.05959010124206543
time for parepare:  0.019032716751098633
local_output_nid generation:  0.023835182189941406
local_in_edges_tensor generation:  0.040241241455078125
mini_batch_src_global generation:  0.05344796180725098
r_  generation:  0.4850444793701172
local_output_nid generation:  0.030600309371948242
local_in_edges_tensor generation:  0.04809761047363281
mini_batch_src_global generation:  0.05907607078552246
r_  generation:  0.5003843307495117
local_output_nid generation:  0.02993035316467285
local_in_edges_tensor generation:  0.03963518142700195
mini_batch_src_global generation:  0.0571284294128418
r_  generation:  0.5027368068695068
local_output_nid generation:  0.029651403427124023
local_in_edges_tensor generation:  0.0359647274017334
mini_batch_src_global generation:  0.05839037895202637
r_  generation:  0.5007429122924805
local_output_nid generation:  0.030496835708618164
local_in_edges_tensor generation:  0.05454540252685547
mini_batch_src_global generation:  0.06058096885681152
r_  generation:  0.5214428901672363
local_output_nid generation:  0.03482532501220703
local_in_edges_tensor generation:  0.03876352310180664
mini_batch_src_global generation:  0.07246017456054688
r_  generation:  0.500924825668335
local_output_nid generation:  0.030959367752075195
local_in_edges_tensor generation:  0.03032970428466797
mini_batch_src_global generation:  0.058681488037109375
r_  generation:  0.5051872730255127
local_output_nid generation:  0.031050920486450195
local_in_edges_tensor generation:  0.03827500343322754
mini_batch_src_global generation:  0.05919694900512695
r_  generation:  0.5039889812469482
local_output_nid generation:  0.03111124038696289
local_in_edges_tensor generation:  0.030655860900878906
mini_batch_src_global generation:  0.060037851333618164
r_  generation:  0.5074174404144287
local_output_nid generation:  0.031934261322021484
local_in_edges_tensor generation:  0.034192800521850586
mini_batch_src_global generation:  0.05962514877319336
r_  generation:  0.5015418529510498
local_output_nid generation:  0.031222105026245117
local_in_edges_tensor generation:  0.034960269927978516
mini_batch_src_global generation:  0.0588076114654541
r_  generation:  0.5101151466369629
local_output_nid generation:  0.03104996681213379
local_in_edges_tensor generation:  0.03407716751098633
mini_batch_src_global generation:  0.06020045280456543
r_  generation:  0.5040030479431152
local_output_nid generation:  0.031162500381469727
local_in_edges_tensor generation:  0.04344320297241211
mini_batch_src_global generation:  0.05836844444274902
r_  generation:  0.5058338642120361
local_output_nid generation:  0.03146100044250488
local_in_edges_tensor generation:  0.030994892120361328
mini_batch_src_global generation:  0.0812532901763916
r_  generation:  0.5073812007904053
local_output_nid generation:  0.032083988189697266
local_in_edges_tensor generation:  0.030109882354736328
mini_batch_src_global generation:  0.05927729606628418
r_  generation:  0.5068390369415283
local_output_nid generation:  0.03099989891052246
local_in_edges_tensor generation:  0.03520464897155762
mini_batch_src_global generation:  0.06000471115112305
r_  generation:  0.5138940811157227
----------------------check_connections_block total spend ----------------------------- 11.873361110687256
generate_one_block  0.6442239284515381
generate_one_block  0.6643235683441162
generate_one_block  0.6566970348358154
generate_one_block  0.6445052623748779
generate_one_block  0.6735994815826416
generate_one_block  0.6469669342041016
generate_one_block  0.7165305614471436
generate_one_block  0.6682729721069336
generate_one_block  0.6461055278778076
generate_one_block  0.6547367572784424
generate_one_block  0.6366262435913086
generate_one_block  0.6425881385803223
generate_one_block  0.6629397869110107
generate_one_block  0.6679627895355225
generate_one_block  0.6346466541290283
generate_one_block  0.6341989040374756
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06444883346557617
gen group dst list time:  0.09565615653991699
time for parepare:  0.019618511199951172
local_output_nid generation:  0.031781911849975586
local_in_edges_tensor generation:  0.06115365028381348
mini_batch_src_global generation:  0.05513906478881836
r_  generation:  0.5367469787597656
local_output_nid generation:  0.0372920036315918
local_in_edges_tensor generation:  0.05549979209899902
mini_batch_src_global generation:  0.06288647651672363
r_  generation:  0.5413963794708252
local_output_nid generation:  0.03664684295654297
local_in_edges_tensor generation:  0.046343088150024414
mini_batch_src_global generation:  0.05894017219543457
r_  generation:  0.5526938438415527
local_output_nid generation:  0.03674149513244629
local_in_edges_tensor generation:  0.03661608695983887
mini_batch_src_global generation:  0.059877634048461914
r_  generation:  0.5501677989959717
local_output_nid generation:  0.0367281436920166
local_in_edges_tensor generation:  0.04252123832702637
mini_batch_src_global generation:  0.0633544921875
r_  generation:  0.5635948181152344
local_output_nid generation:  0.03702950477600098
local_in_edges_tensor generation:  0.05053877830505371
mini_batch_src_global generation:  0.06081390380859375
r_  generation:  0.5584299564361572
local_output_nid generation:  0.03705000877380371
local_in_edges_tensor generation:  0.04282641410827637
mini_batch_src_global generation:  0.0610041618347168
r_  generation:  0.5655179023742676
local_output_nid generation:  0.037137746810913086
local_in_edges_tensor generation:  0.0577692985534668
mini_batch_src_global generation:  0.06182122230529785
r_  generation:  0.5572652816772461
local_output_nid generation:  0.03718090057373047
local_in_edges_tensor generation:  0.04588580131530762
mini_batch_src_global generation:  0.061498165130615234
r_  generation:  0.566824197769165
local_output_nid generation:  0.03719758987426758
local_in_edges_tensor generation:  0.03914594650268555
mini_batch_src_global generation:  0.06274104118347168
r_  generation:  0.5590229034423828
local_output_nid generation:  0.03718900680541992
local_in_edges_tensor generation:  0.03693032264709473
mini_batch_src_global generation:  0.06177210807800293
r_  generation:  0.5678818225860596
local_output_nid generation:  0.037229061126708984
local_in_edges_tensor generation:  0.03640580177307129
mini_batch_src_global generation:  0.06244802474975586
r_  generation:  0.5625760555267334
local_output_nid generation:  0.03776860237121582
local_in_edges_tensor generation:  0.05111575126647949
mini_batch_src_global generation:  0.062001705169677734
r_  generation:  0.5713095664978027
local_output_nid generation:  0.037363529205322266
local_in_edges_tensor generation:  0.03895759582519531
mini_batch_src_global generation:  0.06282472610473633
r_  generation:  0.5641365051269531
local_output_nid generation:  0.03766155242919922
local_in_edges_tensor generation:  0.03702259063720703
mini_batch_src_global generation:  0.06286406517028809
r_  generation:  0.5697095394134521
local_output_nid generation:  0.0373532772064209
local_in_edges_tensor generation:  0.039377450942993164
mini_batch_src_global generation:  0.0632939338684082
r_  generation:  0.5722916126251221
----------------------check_connections_block total spend ----------------------------- 13.354365110397339
generate_one_block  0.7141494750976562
generate_one_block  0.6812028884887695
generate_one_block  0.7048389911651611
generate_one_block  0.7512788772583008
generate_one_block  0.693652868270874
generate_one_block  0.6993680000305176
generate_one_block  0.6952898502349854
generate_one_block  0.7049336433410645
generate_one_block  0.6983580589294434
generate_one_block  0.6812515258789062
generate_one_block  0.6832015514373779
generate_one_block  0.710028886795044
generate_one_block  0.7114286422729492
generate_one_block  0.681039571762085
generate_one_block  0.6932241916656494
generate_one_block  0.6823039054870605
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04669547080993652
gen group dst list time:  0.09776544570922852
time for parepare:  0.019666194915771484
local_output_nid generation:  0.03559613227844238
local_in_edges_tensor generation:  0.0540468692779541
mini_batch_src_global generation:  0.050449371337890625
r_  generation:  0.533344030380249
local_output_nid generation:  0.040364980697631836
local_in_edges_tensor generation:  0.044757843017578125
mini_batch_src_global generation:  0.06326770782470703
r_  generation:  0.5516438484191895
local_output_nid generation:  0.03947639465332031
local_in_edges_tensor generation:  0.04641604423522949
mini_batch_src_global generation:  0.06582474708557129
r_  generation:  0.5420618057250977
local_output_nid generation:  0.040152549743652344
local_in_edges_tensor generation:  0.04192519187927246
mini_batch_src_global generation:  0.061301231384277344
r_  generation:  0.5453493595123291
local_output_nid generation:  0.03964948654174805
local_in_edges_tensor generation:  0.04163026809692383
mini_batch_src_global generation:  0.06240510940551758
r_  generation:  0.5469875335693359
local_output_nid generation:  0.03990983963012695
local_in_edges_tensor generation:  0.04144620895385742
mini_batch_src_global generation:  0.06118464469909668
r_  generation:  0.547523021697998
local_output_nid generation:  0.039839982986450195
local_in_edges_tensor generation:  0.04181027412414551
mini_batch_src_global generation:  0.062168121337890625
r_  generation:  0.5487320423126221
local_output_nid generation:  0.039919376373291016
local_in_edges_tensor generation:  0.04148554801940918
mini_batch_src_global generation:  0.06073141098022461
r_  generation:  0.5541059970855713
local_output_nid generation:  0.04076886177062988
local_in_edges_tensor generation:  0.04226326942443848
mini_batch_src_global generation:  0.06471037864685059
r_  generation:  0.5670957565307617
local_output_nid generation:  0.04037046432495117
local_in_edges_tensor generation:  0.04186844825744629
mini_batch_src_global generation:  0.06064271926879883
r_  generation:  0.55100417137146
local_output_nid generation:  0.04010415077209473
local_in_edges_tensor generation:  0.03687548637390137
mini_batch_src_global generation:  0.06505823135375977
r_  generation:  0.5520384311676025
local_output_nid generation:  0.040647029876708984
local_in_edges_tensor generation:  0.051052093505859375
mini_batch_src_global generation:  0.06237387657165527
r_  generation:  0.5574347972869873
local_output_nid generation:  0.04168081283569336
local_in_edges_tensor generation:  0.03699064254760742
mini_batch_src_global generation:  0.06125521659851074
r_  generation:  0.5678601264953613
local_output_nid generation:  0.04055500030517578
local_in_edges_tensor generation:  0.03736376762390137
mini_batch_src_global generation:  0.0615234375
r_  generation:  0.5571208000183105
local_output_nid generation:  0.04064226150512695
local_in_edges_tensor generation:  0.04179787635803223
mini_batch_src_global generation:  0.06142115592956543
r_  generation:  0.5637471675872803
local_output_nid generation:  0.04062652587890625
local_in_edges_tensor generation:  0.042151451110839844
mini_batch_src_global generation:  0.061463117599487305
r_  generation:  0.5631721019744873
----------------------check_connections_block total spend ----------------------------- 13.252249717712402
generate_one_block  0.6860179901123047
generate_one_block  0.6941123008728027
generate_one_block  0.6911830902099609
generate_one_block  0.6766128540039062
generate_one_block  0.685922384262085
generate_one_block  0.6934547424316406
generate_one_block  0.7494313716888428
generate_one_block  0.6695840358734131
generate_one_block  0.6941378116607666
generate_one_block  0.686903715133667
generate_one_block  0.6915156841278076
generate_one_block  0.693425178527832
generate_one_block  0.6935079097747803
generate_one_block  0.6842963695526123
generate_one_block  0.683234453201294
generate_one_block  0.680084228515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.037534236907958984
gen group dst list time:  0.09653115272521973
time for parepare:  0.019224882125854492
local_output_nid generation:  0.036560773849487305
local_in_edges_tensor generation:  0.053435564041137695
mini_batch_src_global generation:  0.04776597023010254
r_  generation:  0.5016491413116455
local_output_nid generation:  0.04129433631896973
local_in_edges_tensor generation:  0.03589963912963867
mini_batch_src_global generation:  0.05776166915893555
r_  generation:  0.5073647499084473
local_output_nid generation:  0.03964090347290039
local_in_edges_tensor generation:  0.03418421745300293
mini_batch_src_global generation:  0.061740875244140625
r_  generation:  0.506218671798706
local_output_nid generation:  0.039202213287353516
local_in_edges_tensor generation:  0.04743623733520508
mini_batch_src_global generation:  0.05853390693664551
r_  generation:  0.5076689720153809
local_output_nid generation:  0.03931117057800293
local_in_edges_tensor generation:  0.0348508358001709
mini_batch_src_global generation:  0.05897045135498047
r_  generation:  0.5085806846618652
local_output_nid generation:  0.039777278900146484
local_in_edges_tensor generation:  0.03886294364929199
mini_batch_src_global generation:  0.05854439735412598
r_  generation:  0.5157160758972168
local_output_nid generation:  0.03991556167602539
local_in_edges_tensor generation:  0.042038917541503906
mini_batch_src_global generation:  0.06191563606262207
r_  generation:  0.5085897445678711
local_output_nid generation:  0.040042877197265625
local_in_edges_tensor generation:  0.037937164306640625
mini_batch_src_global generation:  0.05839276313781738
r_  generation:  0.5081069469451904
local_output_nid generation:  0.03984689712524414
local_in_edges_tensor generation:  0.035247087478637695
mini_batch_src_global generation:  0.059523582458496094
r_  generation:  0.5216186046600342
local_output_nid generation:  0.041960716247558594
local_in_edges_tensor generation:  0.050848960876464844
mini_batch_src_global generation:  0.060285329818725586
r_  generation:  0.5068061351776123
local_output_nid generation:  0.04070925712585449
local_in_edges_tensor generation:  0.03942131996154785
mini_batch_src_global generation:  0.059545040130615234
r_  generation:  0.5101132392883301
local_output_nid generation:  0.04085707664489746
local_in_edges_tensor generation:  0.03936576843261719
mini_batch_src_global generation:  0.06241035461425781
r_  generation:  0.5155277252197266
local_output_nid generation:  0.042557477951049805
local_in_edges_tensor generation:  0.045049190521240234
mini_batch_src_global generation:  0.05988907814025879
r_  generation:  0.5080685615539551
local_output_nid generation:  0.041532278060913086
local_in_edges_tensor generation:  0.039519548416137695
mini_batch_src_global generation:  0.05934953689575195
r_  generation:  0.5175645351409912
local_output_nid generation:  0.0410921573638916
local_in_edges_tensor generation:  0.039047956466674805
mini_batch_src_global generation:  0.05880999565124512
r_  generation:  0.5143582820892334
local_output_nid generation:  0.04123544692993164
local_in_edges_tensor generation:  0.039782047271728516
mini_batch_src_global generation:  0.05903458595275879
r_  generation:  0.5108957290649414
----------------------check_connections_block total spend ----------------------------- 12.377215385437012
generate_one_block  0.6282827854156494
generate_one_block  0.6388475894927979
generate_one_block  0.6413452625274658
generate_one_block  0.6459901332855225
generate_one_block  0.6394209861755371
generate_one_block  0.6487970352172852
generate_one_block  0.6399731636047363
generate_one_block  0.6222732067108154
generate_one_block  0.7163214683532715
generate_one_block  0.6317310333251953
generate_one_block  0.6354820728302002
generate_one_block  0.6549375057220459
generate_one_block  0.65055251121521
generate_one_block  0.6405289173126221
generate_one_block  0.6335716247558594
generate_one_block  0.6385862827301025
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0291748046875 GB
    Memory Allocated: 0.012590885162353516  GigaBytes
Max Memory Allocated: 0.012590885162353516  GigaBytes

connection checking time:  55.94915437698364
block generation total time  47.56904220581055
average batch blocks generation time:  2.973065137863159
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.1475067138671875  GigaBytes
Max Memory Allocated: 0.1475067138671875  GigaBytes

torch.Size([167241, 128])
torch.Size([166482, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 438, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 434, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 253, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 18.00 MiB (GPU 0; 23.62 GiB total capacity; 21.95 GiB already allocated; 16.44 MiB free; 22.41 GiB reserved in total by PyTorch)
