Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648487802.9717336
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024676799774169922
range selection method range initialization spend 0.01341557502746582
time for parepare:  0.01812434196472168
local_output_nid generation:  0.002687215805053711
local_in_edges_tensor generation:  0.004385948181152344
mini_batch_src_global generation:  0.003374814987182617
r_  generation:  0.03748655319213867
local_output_nid generation:  0.003128528594970703
local_in_edges_tensor generation:  0.0016210079193115234
mini_batch_src_global generation:  0.004132509231567383
r_  generation:  0.03846621513366699
local_output_nid generation:  0.003163576126098633
local_in_edges_tensor generation:  0.0016100406646728516
mini_batch_src_global generation:  0.0027692317962646484
r_  generation:  0.03882265090942383
local_output_nid generation:  0.003162384033203125
local_in_edges_tensor generation:  0.0016753673553466797
mini_batch_src_global generation:  0.002857208251953125
r_  generation:  0.04000043869018555
local_output_nid generation:  0.0031747817993164062
local_in_edges_tensor generation:  0.001649618148803711
mini_batch_src_global generation:  0.0029714107513427734
r_  generation:  0.04121518135070801
local_output_nid generation:  0.003206968307495117
local_in_edges_tensor generation:  0.0016682147979736328
mini_batch_src_global generation:  0.003192424774169922
r_  generation:  0.04210400581359863
local_output_nid generation:  0.003177165985107422
local_in_edges_tensor generation:  0.001619100570678711
mini_batch_src_global generation:  0.0031664371490478516
r_  generation:  0.04125380516052246
local_output_nid generation:  0.0031702518463134766
local_in_edges_tensor generation:  0.0016775131225585938
mini_batch_src_global generation:  0.0031871795654296875
r_  generation:  0.04186892509460449
----------------------check_connections_block total spend ----------------------------- 0.47390294075012207
generate_one_block  0.054326534271240234
generate_one_block  0.05488157272338867
generate_one_block  0.055051565170288086
generate_one_block  0.0550994873046875
generate_one_block  0.05736064910888672
generate_one_block  0.05586743354797363
generate_one_block  0.05423688888549805
generate_one_block  0.054421186447143555
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.042093753814697266
gen group dst list time:  0.015211105346679688
time for parepare:  0.01941657066345215
local_output_nid generation:  0.010530471801757812
local_in_edges_tensor generation:  0.02954721450805664
mini_batch_src_global generation:  0.03134274482727051
r_  generation:  0.29756927490234375
local_output_nid generation:  0.015864849090576172
local_in_edges_tensor generation:  0.027750730514526367
mini_batch_src_global generation:  0.03675246238708496
r_  generation:  0.3037989139556885
local_output_nid generation:  0.016032695770263672
local_in_edges_tensor generation:  0.023047208786010742
mini_batch_src_global generation:  0.035903215408325195
r_  generation:  0.3103635311126709
local_output_nid generation:  0.01635909080505371
local_in_edges_tensor generation:  0.017763137817382812
mini_batch_src_global generation:  0.040199995040893555
r_  generation:  0.318068265914917
local_output_nid generation:  0.016374826431274414
local_in_edges_tensor generation:  0.020102977752685547
mini_batch_src_global generation:  0.040784597396850586
r_  generation:  0.3176424503326416
local_output_nid generation:  0.01693415641784668
local_in_edges_tensor generation:  0.0209505558013916
mini_batch_src_global generation:  0.0400547981262207
r_  generation:  0.32286572456359863
local_output_nid generation:  0.016849040985107422
local_in_edges_tensor generation:  0.02062821388244629
mini_batch_src_global generation:  0.03869295120239258
r_  generation:  0.31522464752197266
local_output_nid generation:  0.0167694091796875
local_in_edges_tensor generation:  0.021135807037353516
mini_batch_src_global generation:  0.04167652130126953
r_  generation:  0.322934627532959
----------------------check_connections_block total spend ----------------------------- 3.6796250343322754
generate_one_block  0.40665364265441895
generate_one_block  0.40191054344177246
generate_one_block  0.4072122573852539
generate_one_block  0.4231123924255371
generate_one_block  0.4170200824737549
generate_one_block  0.4287407398223877
generate_one_block  0.39942336082458496
generate_one_block  0.4034237861633301
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.035659074783325195
gen group dst list time:  0.03575706481933594
time for parepare:  0.019253969192504883
local_output_nid generation:  0.025471210479736328
local_in_edges_tensor generation:  0.04166436195373535
mini_batch_src_global generation:  0.05234885215759277
r_  generation:  0.5119221210479736
local_output_nid generation:  0.03220796585083008
local_in_edges_tensor generation:  0.05072641372680664
mini_batch_src_global generation:  0.05935215950012207
r_  generation:  0.5213148593902588
local_output_nid generation:  0.03265237808227539
local_in_edges_tensor generation:  0.04257655143737793
mini_batch_src_global generation:  0.05570197105407715
r_  generation:  0.527259111404419
local_output_nid generation:  0.03317523002624512
local_in_edges_tensor generation:  0.034564971923828125
mini_batch_src_global generation:  0.059574127197265625
r_  generation:  0.5297276973724365
local_output_nid generation:  0.03312397003173828
local_in_edges_tensor generation:  0.03760528564453125
mini_batch_src_global generation:  0.05861234664916992
r_  generation:  0.5342464447021484
local_output_nid generation:  0.03343987464904785
local_in_edges_tensor generation:  0.04426765441894531
mini_batch_src_global generation:  0.0604100227355957
r_  generation:  0.5288035869598389
local_output_nid generation:  0.033342599868774414
local_in_edges_tensor generation:  0.04822945594787598
mini_batch_src_global generation:  0.05859231948852539
r_  generation:  0.5379829406738281
local_output_nid generation:  0.03352975845336914
local_in_edges_tensor generation:  0.03442049026489258
mini_batch_src_global generation:  0.06093907356262207
r_  generation:  0.5221774578094482
----------------------check_connections_block total spend ----------------------------- 6.202796220779419
generate_one_block  0.6584851741790771
generate_one_block  0.663379430770874
generate_one_block  0.6675901412963867
generate_one_block  0.6606802940368652
generate_one_block  0.6580443382263184
generate_one_block  0.7191541194915771
generate_one_block  0.6558265686035156
generate_one_block  0.6567051410675049
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027072906494140625
gen group dst list time:  0.044640541076660156
time for parepare:  0.01923537254333496
local_output_nid generation:  0.030744552612304688
local_in_edges_tensor generation:  0.039330482482910156
mini_batch_src_global generation:  0.0469968318939209
r_  generation:  0.5076897144317627
local_output_nid generation:  0.036112308502197266
local_in_edges_tensor generation:  0.04953289031982422
mini_batch_src_global generation:  0.05761456489562988
r_  generation:  0.5043051242828369
local_output_nid generation:  0.036337852478027344
local_in_edges_tensor generation:  0.043004512786865234
mini_batch_src_global generation:  0.05715012550354004
r_  generation:  0.5132849216461182
local_output_nid generation:  0.036589860916137695
local_in_edges_tensor generation:  0.039055585861206055
mini_batch_src_global generation:  0.05522727966308594
r_  generation:  0.5339345932006836
local_output_nid generation:  0.03797101974487305
local_in_edges_tensor generation:  0.04162311553955078
mini_batch_src_global generation:  0.05578756332397461
r_  generation:  0.5250444412231445
local_output_nid generation:  0.037372589111328125
local_in_edges_tensor generation:  0.03710603713989258
mini_batch_src_global generation:  0.05576038360595703
r_  generation:  0.5167951583862305
local_output_nid generation:  0.037509918212890625
local_in_edges_tensor generation:  0.04278993606567383
mini_batch_src_global generation:  0.05876350402832031
r_  generation:  0.531928300857544
local_output_nid generation:  0.03776979446411133
local_in_edges_tensor generation:  0.03608226776123047
mini_batch_src_global generation:  0.07860851287841797
r_  generation:  0.5722870826721191
----------------------check_connections_block total spend ----------------------------- 6.293103933334351
generate_one_block  0.644428014755249
generate_one_block  0.6670780181884766
generate_one_block  0.6578752994537354
generate_one_block  0.6572215557098389
generate_one_block  0.6738348007202148
generate_one_block  0.6399214267730713
generate_one_block  0.727912425994873
generate_one_block  0.6528444290161133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006489753723144531  GigaBytes
Max Memory Allocated: 0.0006489753723144531  GigaBytes

connection checking time:  16.175525188446045
block generation total time  13.948477983474731
average batch blocks generation time:  1.7435597479343414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.111602783203125  GigaBytes
Max Memory Allocated: 0.111602783203125  GigaBytes

torch.Size([165497, 128])
torch.Size([161164, 32])
torch.Size([141895, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3162841796875 GB
    Memory Allocated: 16.987865924835205  GigaBytes
Max Memory Allocated: 17.000144004821777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2791748046875 GB
    Memory Allocated: 0.11404609680175781  GigaBytes
Max Memory Allocated: 17.000144004821777  GigaBytes

torch.Size([165544, 128])
torch.Size([161308, 32])
torch.Size([142389, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 16.986216068267822  GigaBytes
Max Memory Allocated: 17.000144004821777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.1140451431274414  GigaBytes
Max Memory Allocated: 17.000144004821777  GigaBytes

torch.Size([165470, 128])
torch.Size([161151, 32])
torch.Size([142231, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 16.99835968017578  GigaBytes
Max Memory Allocated: 17.01231288909912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.11479663848876953  GigaBytes
Max Memory Allocated: 17.01231288909912  GigaBytes

torch.Size([165531, 128])
torch.Size([161265, 32])
torch.Size([142042, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 17.006765365600586  GigaBytes
Max Memory Allocated: 17.02080488204956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.11411046981811523  GigaBytes
Max Memory Allocated: 17.02080488204956  GigaBytes

torch.Size([165571, 128])
torch.Size([161149, 32])
torch.Size([141598, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 17.00057601928711  GigaBytes
Max Memory Allocated: 17.02080488204956  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.11417913436889648  GigaBytes
Max Memory Allocated: 17.02080488204956  GigaBytes

torch.Size([165465, 128])
torch.Size([161137, 32])
torch.Size([142178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 17.024953842163086  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.11402320861816406  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165556, 128])
torch.Size([161240, 32])
torch.Size([142124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 16.977181911468506  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.11403465270996094  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165430, 128])
torch.Size([161011, 32])
torch.Size([141657, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 16.995376586914062  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05085068941116333 |0.07625776529312134 |0.4544265866279602 |0.00011053681373596191 |0.47318506240844727 |0.011240005493164062 |
----------------------------------------------------------pseudo_mini_loss sum 4.49061393737793
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4292672
Number of first layer input nodes during this epoch:  1324064
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.1722860336303711  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.024872779846191406
range selection method range initialization spend 0.011803865432739258
time for parepare:  0.016974687576293945
local_output_nid generation:  0.0029973983764648438
local_in_edges_tensor generation:  0.0064470767974853516
mini_batch_src_global generation:  0.0033266544342041016
r_  generation:  0.03703165054321289
local_output_nid generation:  0.003422260284423828
local_in_edges_tensor generation:  0.0017101764678955078
mini_batch_src_global generation:  0.0040891170501708984
r_  generation:  0.03905630111694336
local_output_nid generation:  0.0033795833587646484
local_in_edges_tensor generation:  0.0016934871673583984
mini_batch_src_global generation:  0.0027320384979248047
r_  generation:  0.03991818428039551
local_output_nid generation:  0.003397226333618164
local_in_edges_tensor generation:  0.0016872882843017578
mini_batch_src_global generation:  0.0029032230377197266
r_  generation:  0.0423738956451416
local_output_nid generation:  0.003278017044067383
local_in_edges_tensor generation:  0.0016465187072753906
mini_batch_src_global generation:  0.003011941909790039
r_  generation:  0.04264712333679199
local_output_nid generation:  0.0034646987915039062
local_in_edges_tensor generation:  0.0019333362579345703
mini_batch_src_global generation:  0.00482177734375
r_  generation:  0.0421757698059082
local_output_nid generation:  0.0035164356231689453
local_in_edges_tensor generation:  0.001706838607788086
mini_batch_src_global generation:  0.0031664371490478516
r_  generation:  0.045763492584228516
local_output_nid generation:  0.0037152767181396484
local_in_edges_tensor generation:  0.0022170543670654297
mini_batch_src_global generation:  0.003400087356567383
r_  generation:  0.04306221008300781
----------------------check_connections_block total spend ----------------------------- 0.505131721496582
generate_one_block  0.0700223445892334
generate_one_block  0.06276488304138184
generate_one_block  0.06194162368774414
generate_one_block  0.06424927711486816
generate_one_block  0.06305575370788574
generate_one_block  0.06267404556274414
generate_one_block  0.06525254249572754
generate_one_block  0.06250667572021484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04863095283508301
gen group dst list time:  0.01449275016784668
time for parepare:  0.02292037010192871
local_output_nid generation:  0.011348724365234375
local_in_edges_tensor generation:  0.04110383987426758
mini_batch_src_global generation:  0.03132200241088867
r_  generation:  0.30648303031921387
local_output_nid generation:  0.01885676383972168
local_in_edges_tensor generation:  0.027942895889282227
mini_batch_src_global generation:  0.03602933883666992
r_  generation:  0.31014299392700195
local_output_nid generation:  0.019043684005737305
local_in_edges_tensor generation:  0.020052433013916016
mini_batch_src_global generation:  0.03673267364501953
r_  generation:  0.3150453567504883
local_output_nid generation:  0.019289493560791016
local_in_edges_tensor generation:  0.026002168655395508
mini_batch_src_global generation:  0.03708672523498535
r_  generation:  0.3184850215911865
local_output_nid generation:  0.0193173885345459
local_in_edges_tensor generation:  0.023980140686035156
mini_batch_src_global generation:  0.037950754165649414
r_  generation:  0.3249356746673584
local_output_nid generation:  0.019748449325561523
local_in_edges_tensor generation:  0.02227640151977539
mini_batch_src_global generation:  0.03821849822998047
r_  generation:  0.32246994972229004
local_output_nid generation:  0.0199282169342041
local_in_edges_tensor generation:  0.017960309982299805
mini_batch_src_global generation:  0.038007259368896484
r_  generation:  0.31934332847595215
local_output_nid generation:  0.020145654678344727
local_in_edges_tensor generation:  0.02152729034423828
mini_batch_src_global generation:  0.03818058967590332
r_  generation:  0.33150792121887207
----------------------check_connections_block total spend ----------------------------- 3.7486965656280518
generate_one_block  0.4326610565185547
generate_one_block  0.4251711368560791
generate_one_block  0.42768025398254395
generate_one_block  0.43306684494018555
generate_one_block  0.42848944664001465
generate_one_block  0.4334065914154053
generate_one_block  0.4186995029449463
generate_one_block  0.46892738342285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.047547101974487305
gen group dst list time:  0.0391998291015625
time for parepare:  0.019129037857055664
local_output_nid generation:  0.026801347732543945
local_in_edges_tensor generation:  0.061602115631103516
mini_batch_src_global generation:  0.049257755279541016
r_  generation:  0.5081284046173096
local_output_nid generation:  0.03252911567687988
local_in_edges_tensor generation:  0.05357480049133301
mini_batch_src_global generation:  0.058481693267822266
r_  generation:  0.5132777690887451
local_output_nid generation:  0.03245997428894043
local_in_edges_tensor generation:  0.04054665565490723
mini_batch_src_global generation:  0.05523562431335449
r_  generation:  0.5312294960021973
local_output_nid generation:  0.03262209892272949
local_in_edges_tensor generation:  0.04041242599487305
mini_batch_src_global generation:  0.0591738224029541
r_  generation:  0.5177755355834961
local_output_nid generation:  0.03648114204406738
local_in_edges_tensor generation:  0.04995131492614746
mini_batch_src_global generation:  0.05632424354553223
r_  generation:  0.5322892665863037
local_output_nid generation:  0.03372526168823242
local_in_edges_tensor generation:  0.056005001068115234
mini_batch_src_global generation:  0.059967041015625
r_  generation:  0.5243074893951416
local_output_nid generation:  0.03378629684448242
local_in_edges_tensor generation:  0.043992042541503906
mini_batch_src_global generation:  0.05761837959289551
r_  generation:  0.5422358512878418
local_output_nid generation:  0.03401470184326172
local_in_edges_tensor generation:  0.040786027908325195
mini_batch_src_global generation:  0.061769962310791016
r_  generation:  0.5338530540466309
----------------------check_connections_block total spend ----------------------------- 6.237795352935791
generate_one_block  0.687899112701416
generate_one_block  0.6868283748626709
generate_one_block  0.6835408210754395
generate_one_block  0.6850740909576416
generate_one_block  0.6944780349731445
generate_one_block  0.6942625045776367
generate_one_block  0.6855170726776123
generate_one_block  0.6862940788269043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03628110885620117
gen group dst list time:  0.048590898513793945
time for parepare:  0.01974654197692871
local_output_nid generation:  0.03173995018005371
local_in_edges_tensor generation:  0.04617190361022949
mini_batch_src_global generation:  0.04555797576904297
r_  generation:  0.5346584320068359
local_output_nid generation:  0.03840017318725586
local_in_edges_tensor generation:  0.04802846908569336
mini_batch_src_global generation:  0.061693668365478516
r_  generation:  0.50893235206604
local_output_nid generation:  0.03710675239562988
local_in_edges_tensor generation:  0.04730868339538574
mini_batch_src_global generation:  0.07104039192199707
r_  generation:  0.5145723819732666
local_output_nid generation:  0.04078316688537598
local_in_edges_tensor generation:  0.0465087890625
mini_batch_src_global generation:  0.05376076698303223
r_  generation:  0.5132637023925781
local_output_nid generation:  0.0387730598449707
local_in_edges_tensor generation:  0.03714632987976074
mini_batch_src_global generation:  0.05427384376525879
r_  generation:  0.5190882682800293
local_output_nid generation:  0.038900136947631836
local_in_edges_tensor generation:  0.045180320739746094
mini_batch_src_global generation:  0.057932138442993164
r_  generation:  0.5168921947479248
local_output_nid generation:  0.03883767127990723
local_in_edges_tensor generation:  0.04537034034729004
mini_batch_src_global generation:  0.05408644676208496
r_  generation:  0.525230884552002
local_output_nid generation:  0.03910493850708008
local_in_edges_tensor generation:  0.04109930992126465
mini_batch_src_global generation:  0.05400395393371582
r_  generation:  0.5285155773162842
----------------------check_connections_block total spend ----------------------------- 6.238129377365112
generate_one_block  0.668956995010376
generate_one_block  0.6627047061920166
generate_one_block  0.6640322208404541
generate_one_block  0.654599666595459
generate_one_block  0.6416969299316406
generate_one_block  0.6595430374145508
generate_one_block  0.6589245796203613
generate_one_block  0.658879280090332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.1722860336303711  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

connection checking time:  16.224621295928955
block generation total time  14.241333723068237
average batch blocks generation time:  1.7801667153835297
block dataloader generation time/epoch 32.8711371421814
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0233154296875 GB
    Memory Allocated: 0.11548328399658203  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165651, 128])
torch.Size([161357, 32])
torch.Size([142361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 17.01408576965332  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.1153116226196289  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165554, 128])
torch.Size([161248, 32])
torch.Size([142240, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 16.979424476623535  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.11528396606445312  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165360, 128])
torch.Size([161040, 32])
torch.Size([141750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 16.998714923858643  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.11615228652954102  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165477, 128])
torch.Size([161137, 32])
torch.Size([142020, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 17.023797035217285  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.11538076400756836  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165437, 128])
torch.Size([161047, 32])
torch.Size([142151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 17.01329755783081  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.11541748046875  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165604, 128])
torch.Size([161492, 32])
torch.Size([142513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 17.007626056671143  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.11528730392456055  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165549, 128])
torch.Size([161271, 32])
torch.Size([142315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 16.975173473358154  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 0.11536693572998047  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

torch.Size([165434, 128])
torch.Size([161146, 32])
torch.Size([141978, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0311279296875 GB
    Memory Allocated: 16.994449138641357  GigaBytes
Max Memory Allocated: 17.039186477661133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046832114458084106 |0.03030085563659668 |0.35763221979141235 |9.962916374206543e-05 |0.45071497559547424 |0.005211353302001953 |
----------------------------------------------------------pseudo_mini_loss sum 3.9651317596435547
Total (block generation + training)time/epoch 39.99381756782532
Training time/epoch 7.12242579460144
Training time without block to device /epoch 6.880018949508667
Training time without total dataloading part /epoch 6.472785949707031
load block tensor time/epoch 0.37465691566467285
block to device time/epoch 0.24240684509277344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4294645
Number of first layer input nodes during this epoch:  1324066
