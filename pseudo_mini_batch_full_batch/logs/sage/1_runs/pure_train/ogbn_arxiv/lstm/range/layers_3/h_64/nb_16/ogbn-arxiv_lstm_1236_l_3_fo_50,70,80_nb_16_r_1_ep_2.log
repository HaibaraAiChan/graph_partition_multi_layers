Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648471293.866888
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02808403968811035
range selection method range initialization spend 0.013274192810058594
time for parepare:  0.01796746253967285
local_output_nid generation:  0.0013248920440673828
local_in_edges_tensor generation:  0.0041501522064208984
mini_batch_src_global generation:  0.001936197280883789
r_  generation:  0.02001023292541504
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0009529590606689453
mini_batch_src_global generation:  0.00244140625
r_  generation:  0.020012617111206055
local_output_nid generation:  0.0014929771423339844
local_in_edges_tensor generation:  0.0008990764617919922
mini_batch_src_global generation:  0.0015106201171875
r_  generation:  0.019295930862426758
local_output_nid generation:  0.0015110969543457031
local_in_edges_tensor generation:  0.0008594989776611328
mini_batch_src_global generation:  0.001438140869140625
r_  generation:  0.019435644149780273
local_output_nid generation:  0.0015287399291992188
local_in_edges_tensor generation:  0.0008921623229980469
mini_batch_src_global generation:  0.0015125274658203125
r_  generation:  0.020049333572387695
local_output_nid generation:  0.001544952392578125
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  0.0016815662384033203
r_  generation:  0.021269559860229492
local_output_nid generation:  0.0015368461608886719
local_in_edges_tensor generation:  0.0009543895721435547
mini_batch_src_global generation:  0.0016224384307861328
r_  generation:  0.0202634334564209
local_output_nid generation:  0.0015361309051513672
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  0.0016171932220458984
r_  generation:  0.020949125289916992
local_output_nid generation:  0.0015997886657714844
local_in_edges_tensor generation:  0.0008523464202880859
mini_batch_src_global generation:  0.001611948013305664
r_  generation:  0.020845413208007812
local_output_nid generation:  0.0015232563018798828
local_in_edges_tensor generation:  0.0008609294891357422
mini_batch_src_global generation:  0.0016360282897949219
r_  generation:  0.02094745635986328
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0008528232574462891
mini_batch_src_global generation:  0.0016260147094726562
r_  generation:  0.021366596221923828
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0008568763732910156
mini_batch_src_global generation:  0.0016722679138183594
r_  generation:  0.021202802658081055
local_output_nid generation:  0.0015292167663574219
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.0016963481903076172
r_  generation:  0.02191305160522461
local_output_nid generation:  0.0015571117401123047
local_in_edges_tensor generation:  0.0008788108825683594
mini_batch_src_global generation:  0.0018455982208251953
r_  generation:  0.021525859832763672
local_output_nid generation:  0.0015611648559570312
local_in_edges_tensor generation:  0.0008814334869384766
mini_batch_src_global generation:  0.001760244369506836
r_  generation:  0.022229671478271484
local_output_nid generation:  0.0015420913696289062
local_in_edges_tensor generation:  0.0008828639984130859
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.021526098251342773
----------------------check_connections_block total spend ----------------------------- 0.4941070079803467
generate_one_block  0.030324459075927734
generate_one_block  0.031613826751708984
generate_one_block  0.03190445899963379
generate_one_block  0.030910968780517578
generate_one_block  0.030528545379638672
generate_one_block  0.03139615058898926
generate_one_block  0.03044295310974121
generate_one_block  0.031085729598999023
generate_one_block  0.0310366153717041
generate_one_block  0.03128528594970703
generate_one_block  0.030787229537963867
generate_one_block  0.0309755802154541
generate_one_block  0.03159737586975098
generate_one_block  0.0312650203704834
generate_one_block  0.031731605529785156
generate_one_block  0.03110980987548828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043683767318725586
gen group dst list time:  0.020447254180908203
time for parepare:  0.019735097885131836
local_output_nid generation:  0.007325410842895508
local_in_edges_tensor generation:  0.022820234298706055
mini_batch_src_global generation:  0.024245023727416992
r_  generation:  0.24960732460021973
local_output_nid generation:  0.01228189468383789
local_in_edges_tensor generation:  0.024529695510864258
mini_batch_src_global generation:  0.03400564193725586
r_  generation:  0.2614402770996094
local_output_nid generation:  0.012215137481689453
local_in_edges_tensor generation:  0.01948237419128418
mini_batch_src_global generation:  0.03061056137084961
r_  generation:  0.26356983184814453
local_output_nid generation:  0.012750864028930664
local_in_edges_tensor generation:  0.017470836639404297
mini_batch_src_global generation:  0.03176522254943848
r_  generation:  0.2634415626525879
local_output_nid generation:  0.012904882431030273
local_in_edges_tensor generation:  0.01760244369506836
mini_batch_src_global generation:  0.032506704330444336
r_  generation:  0.274428129196167
local_output_nid generation:  0.013529062271118164
local_in_edges_tensor generation:  0.02022719383239746
mini_batch_src_global generation:  0.03344607353210449
r_  generation:  0.27034974098205566
local_output_nid generation:  0.013180971145629883
local_in_edges_tensor generation:  0.0181429386138916
mini_batch_src_global generation:  0.033045291900634766
r_  generation:  0.26789116859436035
local_output_nid generation:  0.013347387313842773
local_in_edges_tensor generation:  0.01990342140197754
mini_batch_src_global generation:  0.03395247459411621
r_  generation:  0.269176721572876
local_output_nid generation:  0.013533592224121094
local_in_edges_tensor generation:  0.015630483627319336
mini_batch_src_global generation:  0.036089181900024414
r_  generation:  0.276914119720459
local_output_nid generation:  0.013644218444824219
local_in_edges_tensor generation:  0.016143083572387695
mini_batch_src_global generation:  0.03353285789489746
r_  generation:  0.27164340019226074
local_output_nid generation:  0.013822317123413086
local_in_edges_tensor generation:  0.02332448959350586
mini_batch_src_global generation:  0.03406095504760742
r_  generation:  0.2758209705352783
local_output_nid generation:  0.013804912567138672
local_in_edges_tensor generation:  0.02041172981262207
mini_batch_src_global generation:  0.033829689025878906
r_  generation:  0.2721524238586426
local_output_nid generation:  0.014105796813964844
local_in_edges_tensor generation:  0.018564939498901367
mini_batch_src_global generation:  0.036357879638671875
r_  generation:  0.2774646282196045
local_output_nid generation:  0.013904809951782227
local_in_edges_tensor generation:  0.023729562759399414
mini_batch_src_global generation:  0.03500962257385254
r_  generation:  0.2737245559692383
local_output_nid generation:  0.014024019241333008
local_in_edges_tensor generation:  0.018794775009155273
mini_batch_src_global generation:  0.03862118721008301
r_  generation:  0.28350043296813965
local_output_nid generation:  0.014069795608520508
local_in_edges_tensor generation:  0.02346014976501465
mini_batch_src_global generation:  0.03538155555725098
r_  generation:  0.2768385410308838
----------------------check_connections_block total spend ----------------------------- 6.337520122528076
generate_one_block  0.35649943351745605
generate_one_block  0.35127854347229004
generate_one_block  0.34572553634643555
generate_one_block  0.3487548828125
generate_one_block  0.36147141456604004
generate_one_block  0.35850954055786133
generate_one_block  0.34745192527770996
generate_one_block  0.3547699451446533
generate_one_block  0.3575601577758789
generate_one_block  0.3444633483886719
generate_one_block  0.3649287223815918
generate_one_block  0.3507859706878662
generate_one_block  0.3699319362640381
generate_one_block  0.3630795478820801
generate_one_block  0.3752009868621826
generate_one_block  0.36703038215637207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05931377410888672
gen group dst list time:  0.07266020774841309
time for parepare:  0.020664453506469727
local_output_nid generation:  0.024692773818969727
local_in_edges_tensor generation:  0.044838905334472656
mini_batch_src_global generation:  0.06952571868896484
r_  generation:  0.5159003734588623
local_output_nid generation:  0.03065633773803711
local_in_edges_tensor generation:  0.05820727348327637
mini_batch_src_global generation:  0.0645761489868164
r_  generation:  0.5376665592193604
local_output_nid generation:  0.030286550521850586
local_in_edges_tensor generation:  0.039768218994140625
mini_batch_src_global generation:  0.06188082695007324
r_  generation:  0.5335655212402344
local_output_nid generation:  0.03420209884643555
local_in_edges_tensor generation:  0.03702878952026367
mini_batch_src_global generation:  0.0598139762878418
r_  generation:  0.5299379825592041
local_output_nid generation:  0.031603097915649414
local_in_edges_tensor generation:  0.03536343574523926
mini_batch_src_global generation:  0.06121659278869629
r_  generation:  0.5349230766296387
local_output_nid generation:  0.03214597702026367
local_in_edges_tensor generation:  0.03744196891784668
mini_batch_src_global generation:  0.06044316291809082
r_  generation:  0.5367677211761475
local_output_nid generation:  0.031839609146118164
local_in_edges_tensor generation:  0.03767991065979004
mini_batch_src_global generation:  0.06174898147583008
r_  generation:  0.5428285598754883
local_output_nid generation:  0.03209376335144043
local_in_edges_tensor generation:  0.038105010986328125
mini_batch_src_global generation:  0.0619657039642334
r_  generation:  0.5372457504272461
local_output_nid generation:  0.03223299980163574
local_in_edges_tensor generation:  0.05256462097167969
mini_batch_src_global generation:  0.061312198638916016
r_  generation:  0.5411617755889893
local_output_nid generation:  0.03214406967163086
local_in_edges_tensor generation:  0.03440141677856445
mini_batch_src_global generation:  0.06141066551208496
r_  generation:  0.5377435684204102
local_output_nid generation:  0.03218579292297363
local_in_edges_tensor generation:  0.05228829383850098
mini_batch_src_global generation:  0.061521291732788086
r_  generation:  0.5517046451568604
local_output_nid generation:  0.03228592872619629
local_in_edges_tensor generation:  0.04787158966064453
mini_batch_src_global generation:  0.06100630760192871
r_  generation:  0.5397500991821289
local_output_nid generation:  0.03210854530334473
local_in_edges_tensor generation:  0.03394651412963867
mini_batch_src_global generation:  0.062203168869018555
r_  generation:  0.5392434597015381
local_output_nid generation:  0.0324249267578125
local_in_edges_tensor generation:  0.03820300102233887
mini_batch_src_global generation:  0.0622403621673584
r_  generation:  0.5381321907043457
local_output_nid generation:  0.032315969467163086
local_in_edges_tensor generation:  0.047440528869628906
mini_batch_src_global generation:  0.06156182289123535
r_  generation:  0.5387203693389893
local_output_nid generation:  0.0327610969543457
local_in_edges_tensor generation:  0.04379701614379883
mini_batch_src_global generation:  0.06174159049987793
r_  generation:  0.5463171005249023
----------------------check_connections_block total spend ----------------------------- 12.695635318756104
generate_one_block  0.6857814788818359
generate_one_block  0.6761682033538818
generate_one_block  0.6784379482269287
generate_one_block  0.6850719451904297
generate_one_block  0.680952787399292
generate_one_block  0.6976158618927002
generate_one_block  0.7391135692596436
generate_one_block  0.7015938758850098
generate_one_block  0.6997108459472656
generate_one_block  0.6982958316802979
generate_one_block  0.697284460067749
generate_one_block  0.6966960430145264
generate_one_block  0.6946797370910645
generate_one_block  0.6854474544525146
generate_one_block  0.7090268135070801
generate_one_block  0.7047882080078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  19.03315544128418
block generation total time  16.84810733795166
average batch blocks generation time:  1.0530067086219788
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09595918655395508  GigaBytes
Max Memory Allocated: 0.09595918655395508  GigaBytes

torch.Size([157456, 128])
torch.Size([130129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7928466796875 GB
    Memory Allocated: 16.322088718414307  GigaBytes
Max Memory Allocated: 16.337708950042725  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.09732484817504883  GigaBytes
Max Memory Allocated: 16.337708950042725  GigaBytes

torch.Size([157447, 128])
torch.Size([130317, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2381591796875 GB
    Memory Allocated: 16.367603302001953  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.0971217155456543  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157447, 128])
torch.Size([129755, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.236548900604248  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09718942642211914  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157579, 128])
torch.Size([130047, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.246222496032715  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.0970149040222168  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157279, 128])
torch.Size([129501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.227592945098877  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09729385375976562  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157436, 128])
torch.Size([129977, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.361141204833984  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09715795516967773  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157477, 128])
torch.Size([129810, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.267489433288574  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09725189208984375  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157450, 128])
torch.Size([129528, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.32568597793579  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09731769561767578  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157516, 128])
torch.Size([129843, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.341535568237305  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09725046157836914  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157607, 128])
torch.Size([129923, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 16.264243125915527  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2401123046875 GB
    Memory Allocated: 0.09734630584716797  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157504, 128])
torch.Size([129985, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2518310546875 GB
    Memory Allocated: 16.350533962249756  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2518310546875 GB
    Memory Allocated: 0.09731340408325195  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157509, 128])
torch.Size([130062, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2811279296875 GB
    Memory Allocated: 16.341737747192383  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2811279296875 GB
    Memory Allocated: 0.09736299514770508  GigaBytes
Max Memory Allocated: 16.38444185256958  GigaBytes

torch.Size([157381, 128])
torch.Size([129823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 16.396461486816406  GigaBytes
Max Memory Allocated: 16.413779735565186  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.0974874496459961  GigaBytes
Max Memory Allocated: 16.413779735565186  GigaBytes

torch.Size([157678, 128])
torch.Size([130095, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 16.387593746185303  GigaBytes
Max Memory Allocated: 16.413779735565186  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.09762048721313477  GigaBytes
Max Memory Allocated: 16.413779735565186  GigaBytes

torch.Size([157677, 128])
torch.Size([130206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 16.446197986602783  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157671, 128])
torch.Size([130516, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 16.427494049072266  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03932489454746246 |0.04477125406265259 |0.69015172123909 |0.00011557340621948242 |1.0603310465812683 |0.03053426742553711 |
----------------------------------------------------------pseudo_mini_loss sum 4.955159664154053
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5330007
Number of first layer input nodes during this epoch:  2520114
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.12858247756958008  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026996374130249023
range selection method range initialization spend 0.013034820556640625
time for parepare:  0.017579317092895508
local_output_nid generation:  0.001832723617553711
local_in_edges_tensor generation:  0.006359577178955078
mini_batch_src_global generation:  0.0021390914916992188
r_  generation:  0.021035194396972656
local_output_nid generation:  0.0018382072448730469
local_in_edges_tensor generation:  0.0010309219360351562
mini_batch_src_global generation:  0.0025758743286132812
r_  generation:  0.022042512893676758
local_output_nid generation:  0.0018162727355957031
local_in_edges_tensor generation:  0.000985860824584961
mini_batch_src_global generation:  0.0015783309936523438
r_  generation:  0.02093338966369629
local_output_nid generation:  0.0018014907836914062
local_in_edges_tensor generation:  0.0009567737579345703
mini_batch_src_global generation:  0.001608133316040039
r_  generation:  0.021218061447143555
local_output_nid generation:  0.001772165298461914
local_in_edges_tensor generation:  0.0009899139404296875
mini_batch_src_global generation:  0.001653909683227539
r_  generation:  0.022218704223632812
local_output_nid generation:  0.0017905235290527344
local_in_edges_tensor generation:  0.0009682178497314453
mini_batch_src_global generation:  0.001689910888671875
r_  generation:  0.021638870239257812
local_output_nid generation:  0.0017895698547363281
local_in_edges_tensor generation:  0.0009500980377197266
mini_batch_src_global generation:  0.0017268657684326172
r_  generation:  0.022553443908691406
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.001734018325805664
r_  generation:  0.022621631622314453
local_output_nid generation:  0.0017590522766113281
local_in_edges_tensor generation:  0.0009241104125976562
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.022520065307617188
local_output_nid generation:  0.0017552375793457031
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0017108917236328125
r_  generation:  0.021253347396850586
local_output_nid generation:  0.0018305778503417969
local_in_edges_tensor generation:  0.0009226799011230469
mini_batch_src_global generation:  0.0017709732055664062
r_  generation:  0.022778749465942383
local_output_nid generation:  0.0018270015716552734
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.0018067359924316406
r_  generation:  0.021821975708007812
local_output_nid generation:  0.0018100738525390625
local_in_edges_tensor generation:  0.0009188652038574219
mini_batch_src_global generation:  0.0017459392547607422
r_  generation:  0.0223233699798584
local_output_nid generation:  0.0017848014831542969
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.0017313957214355469
r_  generation:  0.02234196662902832
local_output_nid generation:  0.0017704963684082031
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.001833200454711914
r_  generation:  0.022719383239746094
local_output_nid generation:  0.0017609596252441406
local_in_edges_tensor generation:  0.0009481906890869141
mini_batch_src_global generation:  0.001781463623046875
r_  generation:  0.022495031356811523
----------------------check_connections_block total spend ----------------------------- 0.5265350341796875
generate_one_block  0.05621457099914551
generate_one_block  0.03966474533081055
generate_one_block  0.037836313247680664
generate_one_block  0.03811812400817871
generate_one_block  0.038922786712646484
generate_one_block  0.04051804542541504
generate_one_block  0.03955888748168945
generate_one_block  0.03890633583068848
generate_one_block  0.03903818130493164
generate_one_block  0.037748098373413086
generate_one_block  0.03876471519470215
generate_one_block  0.038558244705200195
generate_one_block  0.03862929344177246
generate_one_block  0.037992000579833984
generate_one_block  0.03868818283081055
generate_one_block  0.038408517837524414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04164767265319824
gen group dst list time:  0.019857168197631836
time for parepare:  0.019149065017700195
local_output_nid generation:  0.00866389274597168
local_in_edges_tensor generation:  0.027550220489501953
mini_batch_src_global generation:  0.02483224868774414
r_  generation:  0.25365686416625977
local_output_nid generation:  0.01223134994506836
local_in_edges_tensor generation:  0.023166656494140625
mini_batch_src_global generation:  0.034364938735961914
r_  generation:  0.26576828956604004
local_output_nid generation:  0.012422561645507812
local_in_edges_tensor generation:  0.018235206604003906
mini_batch_src_global generation:  0.031011581420898438
r_  generation:  0.2630627155303955
local_output_nid generation:  0.013003349304199219
local_in_edges_tensor generation:  0.016134977340698242
mini_batch_src_global generation:  0.0322263240814209
r_  generation:  0.2682480812072754
local_output_nid generation:  0.013343334197998047
local_in_edges_tensor generation:  0.018542051315307617
mini_batch_src_global generation:  0.0355072021484375
r_  generation:  0.27933716773986816
local_output_nid generation:  0.012825965881347656
local_in_edges_tensor generation:  0.013722419738769531
mini_batch_src_global generation:  0.03354501724243164
r_  generation:  0.27364063262939453
local_output_nid generation:  0.013013362884521484
local_in_edges_tensor generation:  0.018713712692260742
mini_batch_src_global generation:  0.033798933029174805
r_  generation:  0.2772238254547119
local_output_nid generation:  0.013083696365356445
local_in_edges_tensor generation:  0.01646566390991211
mini_batch_src_global generation:  0.03425955772399902
r_  generation:  0.27773237228393555
local_output_nid generation:  0.013237714767456055
local_in_edges_tensor generation:  0.016859769821166992
mini_batch_src_global generation:  0.03433489799499512
r_  generation:  0.27700304985046387
local_output_nid generation:  0.012881755828857422
local_in_edges_tensor generation:  0.014160633087158203
mini_batch_src_global generation:  0.03402137756347656
r_  generation:  0.2694547176361084
local_output_nid generation:  0.013396501541137695
local_in_edges_tensor generation:  0.0184628963470459
mini_batch_src_global generation:  0.03438448905944824
r_  generation:  0.27686190605163574
local_output_nid generation:  0.013115644454956055
local_in_edges_tensor generation:  0.016957998275756836
mini_batch_src_global generation:  0.034389495849609375
r_  generation:  0.27308154106140137
local_output_nid generation:  0.01316070556640625
local_in_edges_tensor generation:  0.016215085983276367
mini_batch_src_global generation:  0.0341486930847168
r_  generation:  0.274580717086792
local_output_nid generation:  0.012953758239746094
local_in_edges_tensor generation:  0.016362428665161133
mini_batch_src_global generation:  0.03433680534362793
r_  generation:  0.2697327136993408
local_output_nid generation:  0.013298988342285156
local_in_edges_tensor generation:  0.018854141235351562
mini_batch_src_global generation:  0.036678314208984375
r_  generation:  0.2784907817840576
local_output_nid generation:  0.013014793395996094
local_in_edges_tensor generation:  0.014308691024780273
mini_batch_src_global generation:  0.03418254852294922
r_  generation:  0.2716710567474365
----------------------check_connections_block total spend ----------------------------- 6.310691595077515
generate_one_block  0.3817148208618164
generate_one_block  0.3883368968963623
generate_one_block  0.3715982437133789
generate_one_block  0.3772439956665039
generate_one_block  0.3836030960083008
generate_one_block  0.3761911392211914
generate_one_block  0.40082526206970215
generate_one_block  0.3774843215942383
generate_one_block  0.38028645515441895
generate_one_block  0.36731982231140137
generate_one_block  0.38048744201660156
generate_one_block  0.377941370010376
generate_one_block  0.37517809867858887
generate_one_block  0.3683662414550781
generate_one_block  0.38463902473449707
generate_one_block  0.36690378189086914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040320634841918945
gen group dst list time:  0.062300920486450195
time for parepare:  0.018400907516479492
local_output_nid generation:  0.025646686553955078
local_in_edges_tensor generation:  0.03681039810180664
mini_batch_src_global generation:  0.052164316177368164
r_  generation:  0.5139462947845459
local_output_nid generation:  0.03194403648376465
local_in_edges_tensor generation:  0.05078315734863281
mini_batch_src_global generation:  0.06267952919006348
r_  generation:  0.5191159248352051
local_output_nid generation:  0.031751394271850586
local_in_edges_tensor generation:  0.042484283447265625
mini_batch_src_global generation:  0.058313608169555664
r_  generation:  0.5326316356658936
local_output_nid generation:  0.032518625259399414
local_in_edges_tensor generation:  0.03187847137451172
mini_batch_src_global generation:  0.05913233757019043
r_  generation:  0.5327358245849609
local_output_nid generation:  0.03228950500488281
local_in_edges_tensor generation:  0.08738946914672852
mini_batch_src_global generation:  0.060714006423950195
r_  generation:  0.539294958114624
local_output_nid generation:  0.03235769271850586
local_in_edges_tensor generation:  0.04269671440124512
mini_batch_src_global generation:  0.06049942970275879
r_  generation:  0.5407559871673584
local_output_nid generation:  0.03242349624633789
local_in_edges_tensor generation:  0.03248453140258789
mini_batch_src_global generation:  0.06111645698547363
r_  generation:  0.5422370433807373
local_output_nid generation:  0.03255605697631836
local_in_edges_tensor generation:  0.03304433822631836
mini_batch_src_global generation:  0.060277700424194336
r_  generation:  0.5415701866149902
local_output_nid generation:  0.03287029266357422
local_in_edges_tensor generation:  0.04636645317077637
mini_batch_src_global generation:  0.06092405319213867
r_  generation:  0.5441722869873047
local_output_nid generation:  0.032556772232055664
local_in_edges_tensor generation:  0.032723188400268555
mini_batch_src_global generation:  0.06162667274475098
r_  generation:  0.5474412441253662
local_output_nid generation:  0.032637834548950195
local_in_edges_tensor generation:  0.03313612937927246
mini_batch_src_global generation:  0.06160998344421387
r_  generation:  0.543511152267456
local_output_nid generation:  0.032534122467041016
local_in_edges_tensor generation:  0.05184197425842285
mini_batch_src_global generation:  0.06136465072631836
r_  generation:  0.5443711280822754
local_output_nid generation:  0.03290390968322754
local_in_edges_tensor generation:  0.03366208076477051
mini_batch_src_global generation:  0.06138968467712402
r_  generation:  0.5476357936859131
local_output_nid generation:  0.032880544662475586
local_in_edges_tensor generation:  0.04647397994995117
mini_batch_src_global generation:  0.060416460037231445
r_  generation:  0.5480422973632812
local_output_nid generation:  0.03304696083068848
local_in_edges_tensor generation:  0.04712057113647461
mini_batch_src_global generation:  0.06094694137573242
r_  generation:  0.5475258827209473
local_output_nid generation:  0.0323178768157959
local_in_edges_tensor generation:  0.04251909255981445
mini_batch_src_global generation:  0.06109738349914551
r_  generation:  0.5525810718536377
----------------------check_connections_block total spend ----------------------------- 12.696717023849487
generate_one_block  0.7343342304229736
generate_one_block  0.7379782199859619
generate_one_block  0.7275228500366211
generate_one_block  0.7107861042022705
generate_one_block  0.7284255027770996
generate_one_block  0.7211043834686279
generate_one_block  0.7186105251312256
generate_one_block  0.7198481559753418
generate_one_block  0.7543168067932129
generate_one_block  0.722339391708374
generate_one_block  0.727797269821167
generate_one_block  0.719707727432251
generate_one_block  0.7062771320343018
generate_one_block  0.721076250076294
generate_one_block  0.7260067462921143
generate_one_block  0.7195684909820557
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.12858247756958008  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

connection checking time:  19.007408618927002
block generation total time  17.653819799423218
average batch blocks generation time:  1.103363737463951
block dataloader generation time/epoch 39.553473234176636
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.0989832878112793  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157392, 128])
torch.Size([129594, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 16.33872127532959  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 0.09926557540893555  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157639, 128])
torch.Size([130085, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3201904296875 GB
    Memory Allocated: 16.431486129760742  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5291748046875 GB
    Memory Allocated: 0.0999917984008789  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157709, 128])
torch.Size([130188, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5291748046875 GB
    Memory Allocated: 16.304363250732422  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5291748046875 GB
    Memory Allocated: 0.0989542007446289  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157434, 128])
torch.Size([129545, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5291748046875 GB
    Memory Allocated: 16.335063934326172  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5291748046875 GB
    Memory Allocated: 0.0991663932800293  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157485, 128])
torch.Size([130446, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.41666889190674  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09914922714233398  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157903, 128])
torch.Size([130135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.308918476104736  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.0990290641784668  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157439, 128])
torch.Size([129622, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.364665508270264  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09912252426147461  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157747, 128])
torch.Size([129997, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.36113214492798  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09903955459594727  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157391, 128])
torch.Size([129717, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.379934787750244  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09882736206054688  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157528, 128])
torch.Size([129715, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.25042963027954  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09908294677734375  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157608, 128])
torch.Size([130013, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.354355812072754  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09901142120361328  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157620, 128])
torch.Size([129806, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.324970722198486  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09888076782226562  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157342, 128])
torch.Size([129197, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.283148288726807  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09887218475341797  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157514, 128])
torch.Size([129822, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.28983783721924  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.0991506576538086  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157640, 128])
torch.Size([129992, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.38792848587036  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 0.09890460968017578  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

torch.Size([157564, 128])
torch.Size([129543, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3514404296875 GB
    Memory Allocated: 16.2809796333313  GigaBytes
Max Memory Allocated: 16.463366985321045  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03318391740322113 |0.025029659271240234 |0.6284540593624115 |0.00010289251804351807 |1.0192099660634995 |0.005207538604736328 |
----------------------------------------------------------pseudo_mini_loss sum 3.7893283367156982
Total (block generation + training)time/epoch 66.91791987419128
Training time/epoch 27.364197492599487
Training time without block to device /epoch 26.963722944259644
Training time without total dataloading part /epoch 26.369478225708008
load block tensor time/epoch 0.5309426784515381
block to device time/epoch 0.40047454833984375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5328715
Number of first layer input nodes during this epoch:  2520955
