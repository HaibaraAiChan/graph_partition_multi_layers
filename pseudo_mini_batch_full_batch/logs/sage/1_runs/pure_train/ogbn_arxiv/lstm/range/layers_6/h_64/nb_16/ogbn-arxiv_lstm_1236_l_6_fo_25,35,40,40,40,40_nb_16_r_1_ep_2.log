Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648526735.239334
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013260841369628906  GigaBytes
Max Memory Allocated: 0.0013260841369628906  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.02469658851623535
range selection method range initialization spend 0.013239860534667969
time for parepare:  0.018056631088256836
local_output_nid generation:  0.001394033432006836
local_in_edges_tensor generation:  0.0038573741912841797
mini_batch_src_global generation:  0.001767873764038086
r_  generation:  0.01847529411315918
local_output_nid generation:  0.0014851093292236328
local_in_edges_tensor generation:  0.0009670257568359375
mini_batch_src_global generation:  0.002148151397705078
r_  generation:  0.018159151077270508
local_output_nid generation:  0.0014643669128417969
local_in_edges_tensor generation:  0.0009162425994873047
mini_batch_src_global generation:  0.0013735294342041016
r_  generation:  0.017830610275268555
local_output_nid generation:  0.0015869140625
local_in_edges_tensor generation:  0.0009131431579589844
mini_batch_src_global generation:  0.0012519359588623047
r_  generation:  0.017979145050048828
local_output_nid generation:  0.0015299320220947266
local_in_edges_tensor generation:  0.0008981227874755859
mini_batch_src_global generation:  0.0014276504516601562
r_  generation:  0.018170595169067383
local_output_nid generation:  0.0015194416046142578
local_in_edges_tensor generation:  0.0009083747863769531
mini_batch_src_global generation:  0.0013604164123535156
r_  generation:  0.018607139587402344
local_output_nid generation:  0.0015070438385009766
local_in_edges_tensor generation:  0.0008938312530517578
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.018610477447509766
local_output_nid generation:  0.001516580581665039
local_in_edges_tensor generation:  0.0008366107940673828
mini_batch_src_global generation:  0.0013339519500732422
r_  generation:  0.01901078224182129
local_output_nid generation:  0.001500844955444336
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.018330812454223633
local_output_nid generation:  0.0014934539794921875
local_in_edges_tensor generation:  0.0008552074432373047
mini_batch_src_global generation:  0.0014994144439697266
r_  generation:  0.019005775451660156
local_output_nid generation:  0.0015118122100830078
local_in_edges_tensor generation:  0.0009148120880126953
mini_batch_src_global generation:  0.0013713836669921875
r_  generation:  0.019039630889892578
local_output_nid generation:  0.0015718936920166016
local_in_edges_tensor generation:  0.0008862018585205078
mini_batch_src_global generation:  0.001529693603515625
r_  generation:  0.018634796142578125
local_output_nid generation:  0.001499176025390625
local_in_edges_tensor generation:  0.0008425712585449219
mini_batch_src_global generation:  0.0014672279357910156
r_  generation:  0.018934249877929688
local_output_nid generation:  0.0014805793762207031
local_in_edges_tensor generation:  0.0008645057678222656
mini_batch_src_global generation:  0.0015528202056884766
r_  generation:  0.018867015838623047
local_output_nid generation:  0.0015001296997070312
local_in_edges_tensor generation:  0.0008473396301269531
mini_batch_src_global generation:  0.0015025138854980469
r_  generation:  0.018065214157104492
local_output_nid generation:  0.001489877700805664
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.0014691352844238281
r_  generation:  0.01901078224182129
----------------------check_connections_block total spend ----------------------------- 0.4466111660003662
generate_one_block  0.02731609344482422
generate_one_block  0.028009414672851562
generate_one_block  0.02707529067993164
generate_one_block  0.02894759178161621
generate_one_block  0.027592182159423828
generate_one_block  0.027570247650146484
generate_one_block  0.02737259864807129
generate_one_block  0.028078794479370117
generate_one_block  0.027089595794677734
generate_one_block  0.027478694915771484
generate_one_block  0.028070926666259766
generate_one_block  0.02747631072998047
generate_one_block  0.027495622634887695
generate_one_block  0.02793574333190918
generate_one_block  0.0270082950592041
generate_one_block  0.02765512466430664
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.04095602035522461
gen group dst list time:  0.0188906192779541
time for parepare:  0.019255638122558594
local_output_nid generation:  0.0065958499908447266
local_in_edges_tensor generation:  0.01649308204650879
mini_batch_src_global generation:  0.019779443740844727
r_  generation:  0.1989743709564209
local_output_nid generation:  0.010190486907958984
local_in_edges_tensor generation:  0.0197908878326416
mini_batch_src_global generation:  0.025445938110351562
r_  generation:  0.2086787223815918
local_output_nid generation:  0.010071754455566406
local_in_edges_tensor generation:  0.013697624206542969
mini_batch_src_global generation:  0.023972511291503906
r_  generation:  0.20789432525634766
local_output_nid generation:  0.01048898696899414
local_in_edges_tensor generation:  0.01433110237121582
mini_batch_src_global generation:  0.026836395263671875
r_  generation:  0.21290040016174316
local_output_nid generation:  0.01075291633605957
local_in_edges_tensor generation:  0.016345977783203125
mini_batch_src_global generation:  0.03419375419616699
r_  generation:  0.22115254402160645
local_output_nid generation:  0.011093854904174805
local_in_edges_tensor generation:  0.016527175903320312
mini_batch_src_global generation:  0.027173280715942383
r_  generation:  0.22176146507263184
local_output_nid generation:  0.010984420776367188
local_in_edges_tensor generation:  0.014651060104370117
mini_batch_src_global generation:  0.026692867279052734
r_  generation:  0.21866583824157715
local_output_nid generation:  0.011205434799194336
local_in_edges_tensor generation:  0.017058134078979492
mini_batch_src_global generation:  0.027503252029418945
r_  generation:  0.22010111808776855
local_output_nid generation:  0.01116180419921875
local_in_edges_tensor generation:  0.014544248580932617
mini_batch_src_global generation:  0.027037620544433594
r_  generation:  0.21535992622375488
local_output_nid generation:  0.011222600936889648
local_in_edges_tensor generation:  0.014856338500976562
mini_batch_src_global generation:  0.029173612594604492
r_  generation:  0.2173457145690918
local_output_nid generation:  0.011381387710571289
local_in_edges_tensor generation:  0.016762256622314453
mini_batch_src_global generation:  0.027635574340820312
r_  generation:  0.22434210777282715
local_output_nid generation:  0.011179208755493164
local_in_edges_tensor generation:  0.013185739517211914
mini_batch_src_global generation:  0.027939796447753906
r_  generation:  0.2148292064666748
local_output_nid generation:  0.011394739151000977
local_in_edges_tensor generation:  0.013141155242919922
mini_batch_src_global generation:  0.027544021606445312
r_  generation:  0.21896028518676758
local_output_nid generation:  0.011259317398071289
local_in_edges_tensor generation:  0.018602609634399414
mini_batch_src_global generation:  0.028192996978759766
r_  generation:  0.21788358688354492
local_output_nid generation:  0.011009454727172852
local_in_edges_tensor generation:  0.013199806213378906
mini_batch_src_global generation:  0.02646613121032715
r_  generation:  0.2112891674041748
local_output_nid generation:  0.01127934455871582
local_in_edges_tensor generation:  0.012889623641967773
mini_batch_src_global generation:  0.027197837829589844
r_  generation:  0.21613764762878418
----------------------check_connections_block total spend ----------------------------- 5.079279661178589
generate_one_block  0.28443384170532227
generate_one_block  0.29127955436706543
generate_one_block  0.27269649505615234
generate_one_block  0.2772059440612793
generate_one_block  0.2984483242034912
generate_one_block  0.2843441963195801
generate_one_block  0.2741553783416748
generate_one_block  0.2849242687225342
generate_one_block  0.28022098541259766
generate_one_block  0.2827746868133545
generate_one_block  0.287050724029541
generate_one_block  0.27189207077026367
generate_one_block  0.27713441848754883
generate_one_block  0.281510591506958
generate_one_block  0.2671334743499756
generate_one_block  0.28108811378479004
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04011869430541992
gen group dst list time:  0.059226274490356445
time for parepare:  0.01892828941345215
local_output_nid generation:  0.023101806640625
local_in_edges_tensor generation:  0.03968095779418945
mini_batch_src_global generation:  0.05030226707458496
r_  generation:  0.47978854179382324
local_output_nid generation:  0.029326915740966797
local_in_edges_tensor generation:  0.04648256301879883
mini_batch_src_global generation:  0.06172513961791992
r_  generation:  0.489346981048584
local_output_nid generation:  0.02822566032409668
local_in_edges_tensor generation:  0.02947211265563965
mini_batch_src_global generation:  0.05794548988342285
r_  generation:  0.4960165023803711
local_output_nid generation:  0.02849292755126953
local_in_edges_tensor generation:  0.03374910354614258
mini_batch_src_global generation:  0.06247425079345703
r_  generation:  0.5008065700531006
local_output_nid generation:  0.029740095138549805
local_in_edges_tensor generation:  0.0391237735748291
mini_batch_src_global generation:  0.05871248245239258
r_  generation:  0.5040261745452881
local_output_nid generation:  0.029731035232543945
local_in_edges_tensor generation:  0.04278826713562012
mini_batch_src_global generation:  0.06545495986938477
r_  generation:  0.49775028228759766
local_output_nid generation:  0.030445337295532227
local_in_edges_tensor generation:  0.03469276428222656
mini_batch_src_global generation:  0.058859825134277344
r_  generation:  0.5066232681274414
local_output_nid generation:  0.030123472213745117
local_in_edges_tensor generation:  0.037616729736328125
mini_batch_src_global generation:  0.08200645446777344
r_  generation:  0.5116837024688721
local_output_nid generation:  0.0312345027923584
local_in_edges_tensor generation:  0.0429537296295166
mini_batch_src_global generation:  0.0628206729888916
r_  generation:  0.5090391635894775
local_output_nid generation:  0.030438899993896484
local_in_edges_tensor generation:  0.04072737693786621
mini_batch_src_global generation:  0.05910897254943848
r_  generation:  0.5019786357879639
local_output_nid generation:  0.03078460693359375
local_in_edges_tensor generation:  0.034244537353515625
mini_batch_src_global generation:  0.05833148956298828
r_  generation:  0.518730640411377
local_output_nid generation:  0.032952308654785156
local_in_edges_tensor generation:  0.02984762191772461
mini_batch_src_global generation:  0.06039905548095703
r_  generation:  0.49724602699279785
local_output_nid generation:  0.030846834182739258
local_in_edges_tensor generation:  0.039254188537597656
mini_batch_src_global generation:  0.05880236625671387
r_  generation:  0.500985860824585
local_output_nid generation:  0.030997276306152344
local_in_edges_tensor generation:  0.042650699615478516
mini_batch_src_global generation:  0.06339550018310547
r_  generation:  0.5001752376556396
local_output_nid generation:  0.03162837028503418
local_in_edges_tensor generation:  0.03018045425415039
mini_batch_src_global generation:  0.059401750564575195
r_  generation:  0.5033097267150879
local_output_nid generation:  0.031260013580322266
local_in_edges_tensor generation:  0.029750585556030273
mini_batch_src_global generation:  0.06066536903381348
r_  generation:  0.4997901916503906
----------------------check_connections_block total spend ----------------------------- 11.813206434249878
generate_one_block  0.6488049030303955
generate_one_block  0.6732919216156006
generate_one_block  0.6483581066131592
generate_one_block  0.6555118560791016
generate_one_block  0.7070820331573486
generate_one_block  0.6549642086029053
generate_one_block  0.7202410697937012
generate_one_block  0.6567580699920654
generate_one_block  0.6441140174865723
generate_one_block  0.6969602108001709
generate_one_block  0.6901154518127441
generate_one_block  0.6619713306427002
generate_one_block  0.683814525604248
generate_one_block  0.6515860557556152
generate_one_block  0.6591522693634033
generate_one_block  0.6601166725158691
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06298017501831055
gen group dst list time:  0.10294890403747559
time for parepare:  0.020161867141723633
local_output_nid generation:  0.03248000144958496
local_in_edges_tensor generation:  0.058567047119140625
mini_batch_src_global generation:  0.05434370040893555
r_  generation:  0.5458652973175049
local_output_nid generation:  0.03816413879394531
local_in_edges_tensor generation:  0.05539679527282715
mini_batch_src_global generation:  0.08532500267028809
r_  generation:  0.552170991897583
local_output_nid generation:  0.03688454627990723
local_in_edges_tensor generation:  0.05325484275817871
mini_batch_src_global generation:  0.06606531143188477
r_  generation:  0.5763511657714844
local_output_nid generation:  0.040526628494262695
local_in_edges_tensor generation:  0.05068182945251465
mini_batch_src_global generation:  0.06405258178710938
r_  generation:  0.5545547008514404
local_output_nid generation:  0.038115501403808594
local_in_edges_tensor generation:  0.046430110931396484
mini_batch_src_global generation:  0.05864977836608887
r_  generation:  0.5623879432678223
local_output_nid generation:  0.03890538215637207
local_in_edges_tensor generation:  0.047020673751831055
mini_batch_src_global generation:  0.059242963790893555
r_  generation:  0.5692505836486816
local_output_nid generation:  0.038211822509765625
local_in_edges_tensor generation:  0.036727190017700195
mini_batch_src_global generation:  0.05998682975769043
r_  generation:  0.5696702003479004
local_output_nid generation:  0.038167715072631836
local_in_edges_tensor generation:  0.03674650192260742
mini_batch_src_global generation:  0.06054115295410156
r_  generation:  0.5651659965515137
local_output_nid generation:  0.03811454772949219
local_in_edges_tensor generation:  0.041336774826049805
mini_batch_src_global generation:  0.06171679496765137
r_  generation:  0.572350263595581
local_output_nid generation:  0.03850150108337402
local_in_edges_tensor generation:  0.05128049850463867
mini_batch_src_global generation:  0.06503677368164062
r_  generation:  0.5677433013916016
local_output_nid generation:  0.03945302963256836
local_in_edges_tensor generation:  0.03750753402709961
mini_batch_src_global generation:  0.06111502647399902
r_  generation:  0.5807268619537354
local_output_nid generation:  0.038636207580566406
local_in_edges_tensor generation:  0.03637194633483887
mini_batch_src_global generation:  0.06232953071594238
r_  generation:  0.572242259979248
local_output_nid generation:  0.03858542442321777
local_in_edges_tensor generation:  0.04644012451171875
mini_batch_src_global generation:  0.06491446495056152
r_  generation:  0.5718932151794434
local_output_nid generation:  0.03892040252685547
local_in_edges_tensor generation:  0.04847979545593262
mini_batch_src_global generation:  0.08279109001159668
r_  generation:  0.572561502456665
local_output_nid generation:  0.04204916954040527
local_in_edges_tensor generation:  0.044768571853637695
mini_batch_src_global generation:  0.06942915916442871
r_  generation:  0.5744442939758301
local_output_nid generation:  0.0386660099029541
local_in_edges_tensor generation:  0.038440704345703125
mini_batch_src_global generation:  0.0622711181640625
r_  generation:  0.5723869800567627
----------------------check_connections_block total spend ----------------------------- 13.61899733543396
generate_one_block  0.7070968151092529
generate_one_block  0.7148454189300537
generate_one_block  0.7059197425842285
generate_one_block  0.7657098770141602
generate_one_block  0.703376054763794
generate_one_block  0.7186987400054932
generate_one_block  0.6962940692901611
generate_one_block  0.6952881813049316
generate_one_block  0.7025887966156006
generate_one_block  0.7157037258148193
generate_one_block  0.6880357265472412
generate_one_block  0.6982021331787109
generate_one_block  0.715491533279419
generate_one_block  0.6844508647918701
generate_one_block  0.6923792362213135
generate_one_block  0.6868422031402588
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04283475875854492
gen group dst list time:  0.0968008041381836
time for parepare:  0.01946544647216797
local_output_nid generation:  0.03475832939147949
local_in_edges_tensor generation:  0.05811166763305664
mini_batch_src_global generation:  0.04941678047180176
r_  generation:  0.5341963768005371
local_output_nid generation:  0.0417017936706543
local_in_edges_tensor generation:  0.04215574264526367
mini_batch_src_global generation:  0.06460404396057129
r_  generation:  0.5648009777069092
local_output_nid generation:  0.03886246681213379
local_in_edges_tensor generation:  0.039713382720947266
mini_batch_src_global generation:  0.06293845176696777
r_  generation:  0.5454826354980469
local_output_nid generation:  0.03919076919555664
local_in_edges_tensor generation:  0.05309271812438965
mini_batch_src_global generation:  0.06215715408325195
r_  generation:  0.5486726760864258
local_output_nid generation:  0.039402008056640625
local_in_edges_tensor generation:  0.037363290786743164
mini_batch_src_global generation:  0.06200575828552246
r_  generation:  0.5520727634429932
local_output_nid generation:  0.03992724418640137
local_in_edges_tensor generation:  0.041701555252075195
mini_batch_src_global generation:  0.06168985366821289
r_  generation:  0.5548572540283203
local_output_nid generation:  0.039400339126586914
local_in_edges_tensor generation:  0.04399704933166504
mini_batch_src_global generation:  0.0622401237487793
r_  generation:  0.5561552047729492
local_output_nid generation:  0.04100775718688965
local_in_edges_tensor generation:  0.041788339614868164
mini_batch_src_global generation:  0.06162095069885254
r_  generation:  0.5507383346557617
local_output_nid generation:  0.04094743728637695
local_in_edges_tensor generation:  0.042362213134765625
mini_batch_src_global generation:  0.06429147720336914
r_  generation:  0.5589454174041748
local_output_nid generation:  0.04068493843078613
local_in_edges_tensor generation:  0.04776954650878906
mini_batch_src_global generation:  0.06147503852844238
r_  generation:  0.5544934272766113
local_output_nid generation:  0.04078388214111328
local_in_edges_tensor generation:  0.04130887985229492
mini_batch_src_global generation:  0.0619051456451416
r_  generation:  0.5531473159790039
local_output_nid generation:  0.04279446601867676
local_in_edges_tensor generation:  0.04222989082336426
mini_batch_src_global generation:  0.061598777770996094
r_  generation:  0.558603048324585
local_output_nid generation:  0.04043889045715332
local_in_edges_tensor generation:  0.05164313316345215
mini_batch_src_global generation:  0.06177949905395508
r_  generation:  0.5576317310333252
local_output_nid generation:  0.040622711181640625
local_in_edges_tensor generation:  0.041562795639038086
mini_batch_src_global generation:  0.06118273735046387
r_  generation:  0.5620338916778564
local_output_nid generation:  0.040552616119384766
local_in_edges_tensor generation:  0.04199624061584473
mini_batch_src_global generation:  0.061310529708862305
r_  generation:  0.5572068691253662
local_output_nid generation:  0.04054594039916992
local_in_edges_tensor generation:  0.041680097579956055
mini_batch_src_global generation:  0.06125926971435547
r_  generation:  0.5613973140716553
----------------------check_connections_block total spend ----------------------------- 13.321423053741455
generate_one_block  0.7031040191650391
generate_one_block  0.6938424110412598
generate_one_block  0.6933093070983887
generate_one_block  0.6942992210388184
generate_one_block  0.6988482475280762
generate_one_block  0.6952505111694336
generate_one_block  0.730729341506958
generate_one_block  0.6765787601470947
generate_one_block  0.7006359100341797
generate_one_block  0.6933679580688477
generate_one_block  0.6841781139373779
generate_one_block  0.6860530376434326
generate_one_block  0.6952595710754395
generate_one_block  0.6898708343505859
generate_one_block  0.687889814376831
generate_one_block  0.6785798072814941
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03935670852661133
gen group dst list time:  0.09624719619750977
time for parepare:  0.019149303436279297
local_output_nid generation:  0.03608131408691406
local_in_edges_tensor generation:  0.04596304893493652
mini_batch_src_global generation:  0.045587778091430664
r_  generation:  0.5077080726623535
local_output_nid generation:  0.04177236557006836
local_in_edges_tensor generation:  0.041202545166015625
mini_batch_src_global generation:  0.05901980400085449
r_  generation:  0.514859676361084
local_output_nid generation:  0.040892839431762695
local_in_edges_tensor generation:  0.036675214767456055
mini_batch_src_global generation:  0.05892348289489746
r_  generation:  0.5072362422943115
local_output_nid generation:  0.0400090217590332
local_in_edges_tensor generation:  0.04010295867919922
mini_batch_src_global generation:  0.0589289665222168
r_  generation:  0.5076587200164795
local_output_nid generation:  0.040014028549194336
local_in_edges_tensor generation:  0.04045510292053223
mini_batch_src_global generation:  0.05924820899963379
r_  generation:  0.5076632499694824
local_output_nid generation:  0.040117502212524414
local_in_edges_tensor generation:  0.04118776321411133
mini_batch_src_global generation:  0.06233620643615723
r_  generation:  0.506829023361206
local_output_nid generation:  0.04046201705932617
local_in_edges_tensor generation:  0.03658890724182129
mini_batch_src_global generation:  0.0588374137878418
r_  generation:  0.5078537464141846
local_output_nid generation:  0.03999018669128418
local_in_edges_tensor generation:  0.03588366508483887
mini_batch_src_global generation:  0.06241297721862793
r_  generation:  0.511763334274292
local_output_nid generation:  0.040257930755615234
local_in_edges_tensor generation:  0.04931521415710449
mini_batch_src_global generation:  0.05875039100646973
r_  generation:  0.5118842124938965
local_output_nid generation:  0.04106402397155762
local_in_edges_tensor generation:  0.04297757148742676
mini_batch_src_global generation:  0.062189579010009766
r_  generation:  0.5120413303375244
local_output_nid generation:  0.04061174392700195
local_in_edges_tensor generation:  0.04068899154663086
mini_batch_src_global generation:  0.06203913688659668
r_  generation:  0.5155978202819824
local_output_nid generation:  0.040556907653808594
local_in_edges_tensor generation:  0.04117107391357422
mini_batch_src_global generation:  0.05861210823059082
r_  generation:  0.512303352355957
local_output_nid generation:  0.040337562561035156
local_in_edges_tensor generation:  0.037314414978027344
mini_batch_src_global generation:  0.05976986885070801
r_  generation:  0.5217058658599854
local_output_nid generation:  0.040328025817871094
local_in_edges_tensor generation:  0.04061317443847656
mini_batch_src_global generation:  0.06227564811706543
r_  generation:  0.513127326965332
local_output_nid generation:  0.04235219955444336
local_in_edges_tensor generation:  0.03666520118713379
mini_batch_src_global generation:  0.05931711196899414
r_  generation:  0.5157475471496582
local_output_nid generation:  0.040262460708618164
local_in_edges_tensor generation:  0.03712105751037598
mini_batch_src_global generation:  0.05921816825866699
r_  generation:  0.5149672031402588
----------------------check_connections_block total spend ----------------------------- 12.393638372421265
generate_one_block  0.6353132724761963
generate_one_block  0.6420726776123047
generate_one_block  0.6416056156158447
generate_one_block  0.6422767639160156
generate_one_block  0.6406042575836182
generate_one_block  0.6455709934234619
generate_one_block  0.6360361576080322
generate_one_block  0.6577656269073486
generate_one_block  0.7438108921051025
generate_one_block  0.6506345272064209
generate_one_block  0.6595895290374756
generate_one_block  0.6473870277404785
generate_one_block  0.6442160606384277
generate_one_block  0.6502094268798828
generate_one_block  0.6314346790313721
generate_one_block  0.6346964836120605
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0013260841369628906  GigaBytes
Max Memory Allocated: 0.0013260841369628906  GigaBytes

connection checking time:  56.22654485702515
block generation total time  48.00507974624634
average batch blocks generation time:  3.000317484140396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.13631725311279297  GigaBytes
Max Memory Allocated: 0.13631725311279297  GigaBytes

torch.Size([167245, 128])
torch.Size([166434, 64])
torch.Size([164017, 64])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 438, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 434, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 253, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.26 GiB already allocated; 2.44 MiB free; 22.42 GiB reserved in total by PyTorch)
