Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648505876.5847898
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.025092363357543945
range selection method range initialization spend 0.013406991958618164
time for parepare:  0.017871618270874023
local_output_nid generation:  0.0013434886932373047
local_in_edges_tensor generation:  0.003926992416381836
mini_batch_src_global generation:  0.0017771720886230469
r_  generation:  0.018093585968017578
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0009222030639648438
mini_batch_src_global generation:  0.0020682811737060547
r_  generation:  0.017386198043823242
local_output_nid generation:  0.001451730728149414
local_in_edges_tensor generation:  0.0009069442749023438
mini_batch_src_global generation:  0.0013849735260009766
r_  generation:  0.01736593246459961
local_output_nid generation:  0.0014834403991699219
local_in_edges_tensor generation:  0.0009043216705322266
mini_batch_src_global generation:  0.0013496875762939453
r_  generation:  0.017650127410888672
local_output_nid generation:  0.0015294551849365234
local_in_edges_tensor generation:  0.0008864402770996094
mini_batch_src_global generation:  0.0012242794036865234
r_  generation:  0.0179290771484375
local_output_nid generation:  0.0016376972198486328
local_in_edges_tensor generation:  0.0009212493896484375
mini_batch_src_global generation:  0.00140380859375
r_  generation:  0.019197940826416016
local_output_nid generation:  0.0016789436340332031
local_in_edges_tensor generation:  0.0009412765502929688
mini_batch_src_global generation:  0.0014719963073730469
r_  generation:  0.018720388412475586
local_output_nid generation:  0.0015532970428466797
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0013651847839355469
r_  generation:  0.01940441131591797
local_output_nid generation:  0.001585245132446289
local_in_edges_tensor generation:  0.000885009765625
mini_batch_src_global generation:  0.0014374256134033203
r_  generation:  0.01920342445373535
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  0.0014636516571044922
r_  generation:  0.018778085708618164
local_output_nid generation:  0.001636505126953125
local_in_edges_tensor generation:  0.0008916854858398438
mini_batch_src_global generation:  0.0013720989227294922
r_  generation:  0.018840789794921875
local_output_nid generation:  0.001565694808959961
local_in_edges_tensor generation:  0.0009293556213378906
mini_batch_src_global generation:  0.0015079975128173828
r_  generation:  0.01962447166442871
local_output_nid generation:  0.0015213489532470703
local_in_edges_tensor generation:  0.0008521080017089844
mini_batch_src_global generation:  0.0015532970428466797
r_  generation:  0.01899266242980957
local_output_nid generation:  0.0015034675598144531
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.0014653205871582031
r_  generation:  0.01944732666015625
local_output_nid generation:  0.0015194416046142578
local_in_edges_tensor generation:  0.0008592605590820312
mini_batch_src_global generation:  0.0014810562133789062
r_  generation:  0.018657445907592773
local_output_nid generation:  0.0014874935150146484
local_in_edges_tensor generation:  0.0008625984191894531
mini_batch_src_global generation:  0.001508951187133789
r_  generation:  0.01842665672302246
----------------------check_connections_block total spend ----------------------------- 0.4474482536315918
generate_one_block  0.026967525482177734
generate_one_block  0.026723623275756836
generate_one_block  0.027073383331298828
generate_one_block  0.029044151306152344
generate_one_block  0.027114152908325195
generate_one_block  0.027332067489624023
generate_one_block  0.027051448822021484
generate_one_block  0.027814626693725586
generate_one_block  0.027736425399780273
generate_one_block  0.0271303653717041
generate_one_block  0.027608156204223633
generate_one_block  0.02793145179748535
generate_one_block  0.02817821502685547
generate_one_block  0.029110193252563477
generate_one_block  0.027128934860229492
generate_one_block  0.026508808135986328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.040032386779785156
gen group dst list time:  0.01862049102783203
time for parepare:  0.019387006759643555
local_output_nid generation:  0.0067865848541259766
local_in_edges_tensor generation:  0.015901565551757812
mini_batch_src_global generation:  0.019402265548706055
r_  generation:  0.19994449615478516
local_output_nid generation:  0.011871814727783203
local_in_edges_tensor generation:  0.017947912216186523
mini_batch_src_global generation:  0.024863719940185547
r_  generation:  0.2004251480102539
local_output_nid generation:  0.012476205825805664
local_in_edges_tensor generation:  0.016495227813720703
mini_batch_src_global generation:  0.023789405822753906
r_  generation:  0.21176743507385254
local_output_nid generation:  0.012825250625610352
local_in_edges_tensor generation:  0.013839244842529297
mini_batch_src_global generation:  0.024944782257080078
r_  generation:  0.20843839645385742
local_output_nid generation:  0.012796878814697266
local_in_edges_tensor generation:  0.011690378189086914
mini_batch_src_global generation:  0.025345563888549805
r_  generation:  0.2114548683166504
local_output_nid generation:  0.013221979141235352
local_in_edges_tensor generation:  0.015769243240356445
mini_batch_src_global generation:  0.029284000396728516
r_  generation:  0.2186446189880371
local_output_nid generation:  0.013369321823120117
local_in_edges_tensor generation:  0.01366114616394043
mini_batch_src_global generation:  0.026436567306518555
r_  generation:  0.2133805751800537
local_output_nid generation:  0.013592958450317383
local_in_edges_tensor generation:  0.013916015625
mini_batch_src_global generation:  0.02878713607788086
r_  generation:  0.22218823432922363
local_output_nid generation:  0.013812780380249023
local_in_edges_tensor generation:  0.01587057113647461
mini_batch_src_global generation:  0.027714252471923828
r_  generation:  0.22494149208068848
local_output_nid generation:  0.013575077056884766
local_in_edges_tensor generation:  0.01176595687866211
mini_batch_src_global generation:  0.027797460556030273
r_  generation:  0.21212291717529297
local_output_nid generation:  0.01395273208618164
local_in_edges_tensor generation:  0.01568913459777832
mini_batch_src_global generation:  0.027962684631347656
r_  generation:  0.22131061553955078
local_output_nid generation:  0.013682126998901367
local_in_edges_tensor generation:  0.01587700843811035
mini_batch_src_global generation:  0.02785181999206543
r_  generation:  0.22450923919677734
local_output_nid generation:  0.013735771179199219
local_in_edges_tensor generation:  0.013586282730102539
mini_batch_src_global generation:  0.027391433715820312
r_  generation:  0.21834897994995117
local_output_nid generation:  0.014047861099243164
local_in_edges_tensor generation:  0.01439523696899414
mini_batch_src_global generation:  0.029814958572387695
r_  generation:  0.22713375091552734
local_output_nid generation:  0.013606548309326172
local_in_edges_tensor generation:  0.01214289665222168
mini_batch_src_global generation:  0.030457496643066406
r_  generation:  0.21684861183166504
local_output_nid generation:  0.01355433464050293
local_in_edges_tensor generation:  0.013182401657104492
mini_batch_src_global generation:  0.026683330535888672
r_  generation:  0.21573305130004883
----------------------check_connections_block total spend ----------------------------- 5.0898942947387695
generate_one_block  0.28411149978637695
generate_one_block  0.27972888946533203
generate_one_block  0.2831845283508301
generate_one_block  0.27579522132873535
generate_one_block  0.297344446182251
generate_one_block  0.2790250778198242
generate_one_block  0.2759687900543213
generate_one_block  0.28978872299194336
generate_one_block  0.2886044979095459
generate_one_block  0.2717282772064209
generate_one_block  0.28713083267211914
generate_one_block  0.28476786613464355
generate_one_block  0.27760958671569824
generate_one_block  0.29681849479675293
generate_one_block  0.275554895401001
generate_one_block  0.26781225204467773
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04048633575439453
gen group dst list time:  0.05988311767578125
time for parepare:  0.018899202346801758
local_output_nid generation:  0.023935794830322266
local_in_edges_tensor generation:  0.04141116142272949
mini_batch_src_global generation:  0.05103492736816406
r_  generation:  0.489851713180542
local_output_nid generation:  0.03005671501159668
local_in_edges_tensor generation:  0.04817557334899902
mini_batch_src_global generation:  0.06009411811828613
r_  generation:  0.5050344467163086
local_output_nid generation:  0.029541969299316406
local_in_edges_tensor generation:  0.04527544975280762
mini_batch_src_global generation:  0.05940604209899902
r_  generation:  0.49951648712158203
local_output_nid generation:  0.031264543533325195
local_in_edges_tensor generation:  0.040048837661743164
mini_batch_src_global generation:  0.058489084243774414
r_  generation:  0.5028998851776123
local_output_nid generation:  0.030298233032226562
local_in_edges_tensor generation:  0.04329180717468262
mini_batch_src_global generation:  0.06334471702575684
r_  generation:  0.49840688705444336
local_output_nid generation:  0.02993035316467285
local_in_edges_tensor generation:  0.03543877601623535
mini_batch_src_global generation:  0.07744240760803223
r_  generation:  0.49709010124206543
local_output_nid generation:  0.0321049690246582
local_in_edges_tensor generation:  0.042105674743652344
mini_batch_src_global generation:  0.05843186378479004
r_  generation:  0.5024447441101074
local_output_nid generation:  0.031114578247070312
local_in_edges_tensor generation:  0.034612417221069336
mini_batch_src_global generation:  0.06013798713684082
r_  generation:  0.5034103393554688
local_output_nid generation:  0.03138542175292969
local_in_edges_tensor generation:  0.03956460952758789
mini_batch_src_global generation:  0.06282663345336914
r_  generation:  0.5209100246429443
local_output_nid generation:  0.03133583068847656
local_in_edges_tensor generation:  0.030907869338989258
mini_batch_src_global generation:  0.0602879524230957
r_  generation:  0.49681901931762695
local_output_nid generation:  0.03142738342285156
local_in_edges_tensor generation:  0.030656099319458008
mini_batch_src_global generation:  0.05921459197998047
r_  generation:  0.5073158740997314
local_output_nid generation:  0.031363725662231445
local_in_edges_tensor generation:  0.03830409049987793
mini_batch_src_global generation:  0.07072329521179199
r_  generation:  0.5065910816192627
local_output_nid generation:  0.03151226043701172
local_in_edges_tensor generation:  0.03345537185668945
mini_batch_src_global generation:  0.06017565727233887
r_  generation:  0.5043730735778809
local_output_nid generation:  0.03137564659118652
local_in_edges_tensor generation:  0.03787040710449219
mini_batch_src_global generation:  0.06267261505126953
r_  generation:  0.5068521499633789
local_output_nid generation:  0.03225064277648926
local_in_edges_tensor generation:  0.030987262725830078
mini_batch_src_global generation:  0.05992770195007324
r_  generation:  0.5144543647766113
local_output_nid generation:  0.031036376953125
local_in_edges_tensor generation:  0.03741598129272461
mini_batch_src_global generation:  0.06212472915649414
r_  generation:  0.512317419052124
----------------------check_connections_block total spend ----------------------------- 11.891911029815674
generate_one_block  0.6725893020629883
generate_one_block  0.6911745071411133
generate_one_block  0.7064449787139893
generate_one_block  0.6722297668457031
generate_one_block  0.6839132308959961
generate_one_block  0.6775603294372559
generate_one_block  0.7687551975250244
generate_one_block  0.6681652069091797
generate_one_block  0.6700003147125244
generate_one_block  0.6748950481414795
generate_one_block  0.6738729476928711
generate_one_block  0.6745016574859619
generate_one_block  0.654123067855835
generate_one_block  0.6783721446990967
generate_one_block  0.6478123664855957
generate_one_block  0.6622099876403809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07491803169250488
gen group dst list time:  0.10419917106628418
time for parepare:  0.01956772804260254
local_output_nid generation:  0.03245830535888672
local_in_edges_tensor generation:  0.06044173240661621
mini_batch_src_global generation:  0.053226470947265625
r_  generation:  0.5327575206756592
local_output_nid generation:  0.03833365440368652
local_in_edges_tensor generation:  0.06562018394470215
mini_batch_src_global generation:  0.06137585639953613
r_  generation:  0.5503277778625488
local_output_nid generation:  0.03794097900390625
local_in_edges_tensor generation:  0.05051159858703613
mini_batch_src_global generation:  0.07199525833129883
r_  generation:  0.5587880611419678
local_output_nid generation:  0.039510250091552734
local_in_edges_tensor generation:  0.04809260368347168
mini_batch_src_global generation:  0.05885577201843262
r_  generation:  0.5525686740875244
local_output_nid generation:  0.03842759132385254
local_in_edges_tensor generation:  0.05237698554992676
mini_batch_src_global generation:  0.062473297119140625
r_  generation:  0.549391508102417
local_output_nid generation:  0.03848719596862793
local_in_edges_tensor generation:  0.04294562339782715
mini_batch_src_global generation:  0.059155941009521484
r_  generation:  0.5592026710510254
local_output_nid generation:  0.038587093353271484
local_in_edges_tensor generation:  0.05981135368347168
mini_batch_src_global generation:  0.05919361114501953
r_  generation:  0.5555286407470703
local_output_nid generation:  0.040093183517456055
local_in_edges_tensor generation:  0.04449057579040527
mini_batch_src_global generation:  0.0684347152709961
r_  generation:  0.5749471187591553
local_output_nid generation:  0.04097414016723633
local_in_edges_tensor generation:  0.04443788528442383
mini_batch_src_global generation:  0.06997823715209961
r_  generation:  0.5566761493682861
local_output_nid generation:  0.038971662521362305
local_in_edges_tensor generation:  0.03788924217224121
mini_batch_src_global generation:  0.06717371940612793
r_  generation:  0.5624942779541016
local_output_nid generation:  0.03871798515319824
local_in_edges_tensor generation:  0.03452348709106445
mini_batch_src_global generation:  0.060442447662353516
r_  generation:  0.5603795051574707
local_output_nid generation:  0.039222002029418945
local_in_edges_tensor generation:  0.034560203552246094
mini_batch_src_global generation:  0.0652933120727539
r_  generation:  0.5682556629180908
local_output_nid generation:  0.039984941482543945
local_in_edges_tensor generation:  0.050618886947631836
mini_batch_src_global generation:  0.061026573181152344
r_  generation:  0.5615103244781494
local_output_nid generation:  0.038721561431884766
local_in_edges_tensor generation:  0.03498220443725586
mini_batch_src_global generation:  0.06354928016662598
r_  generation:  0.5801827907562256
local_output_nid generation:  0.04111981391906738
local_in_edges_tensor generation:  0.0441279411315918
mini_batch_src_global generation:  0.06705307960510254
r_  generation:  0.5606610774993896
local_output_nid generation:  0.04118466377258301
local_in_edges_tensor generation:  0.04114198684692383
mini_batch_src_global generation:  0.06115841865539551
r_  generation:  0.5723350048065186
----------------------check_connections_block total spend ----------------------------- 13.460768938064575
generate_one_block  0.6942520141601562
generate_one_block  0.6906073093414307
generate_one_block  0.7742569446563721
generate_one_block  0.6920967102050781
generate_one_block  0.7021260261535645
generate_one_block  0.6999554634094238
generate_one_block  0.6982283592224121
generate_one_block  0.6885337829589844
generate_one_block  0.6985533237457275
generate_one_block  0.6989474296569824
generate_one_block  0.6711266040802002
generate_one_block  0.6778771877288818
generate_one_block  0.6984226703643799
generate_one_block  0.6746420860290527
generate_one_block  0.6907052993774414
generate_one_block  0.706864595413208
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05032658576965332
gen group dst list time:  0.11446118354797363
time for parepare:  0.019917726516723633
local_output_nid generation:  0.03599715232849121
local_in_edges_tensor generation:  0.0653843879699707
mini_batch_src_global generation:  0.04553055763244629
r_  generation:  0.5054144859313965
local_output_nid generation:  0.04170846939086914
local_in_edges_tensor generation:  0.038904428482055664
mini_batch_src_global generation:  0.06269049644470215
r_  generation:  0.5191590785980225
local_output_nid generation:  0.03927731513977051
local_in_edges_tensor generation:  0.040346384048461914
mini_batch_src_global generation:  0.060202598571777344
r_  generation:  0.5222551822662354
local_output_nid generation:  0.04254460334777832
local_in_edges_tensor generation:  0.03859567642211914
mini_batch_src_global generation:  0.05953836441040039
r_  generation:  0.5110523700714111
local_output_nid generation:  0.04017925262451172
local_in_edges_tensor generation:  0.041686058044433594
mini_batch_src_global generation:  0.058150291442871094
r_  generation:  0.511962890625
local_output_nid generation:  0.04030203819274902
local_in_edges_tensor generation:  0.03874945640563965
mini_batch_src_global generation:  0.05702352523803711
r_  generation:  0.5157630443572998
local_output_nid generation:  0.04025745391845703
local_in_edges_tensor generation:  0.03958439826965332
mini_batch_src_global generation:  0.057737112045288086
r_  generation:  0.5305886268615723
local_output_nid generation:  0.04044508934020996
local_in_edges_tensor generation:  0.03976750373840332
mini_batch_src_global generation:  0.0567631721496582
r_  generation:  0.5201222896575928
local_output_nid generation:  0.04090714454650879
local_in_edges_tensor generation:  0.03924226760864258
mini_batch_src_global generation:  0.05717611312866211
r_  generation:  0.5201396942138672
local_output_nid generation:  0.04073834419250488
local_in_edges_tensor generation:  0.04087710380554199
mini_batch_src_global generation:  0.057739973068237305
r_  generation:  0.5216891765594482
local_output_nid generation:  0.04058957099914551
local_in_edges_tensor generation:  0.04610562324523926
mini_batch_src_global generation:  0.05694890022277832
r_  generation:  0.5204453468322754
local_output_nid generation:  0.04084467887878418
local_in_edges_tensor generation:  0.043385982513427734
mini_batch_src_global generation:  0.05819535255432129
r_  generation:  0.5225274562835693
local_output_nid generation:  0.041015625
local_in_edges_tensor generation:  0.04604339599609375
mini_batch_src_global generation:  0.05728650093078613
r_  generation:  0.5269412994384766
local_output_nid generation:  0.04209256172180176
local_in_edges_tensor generation:  0.04005742073059082
mini_batch_src_global generation:  0.0818488597869873
r_  generation:  0.5212559700012207
local_output_nid generation:  0.04258537292480469
local_in_edges_tensor generation:  0.04071545600891113
mini_batch_src_global generation:  0.060339927673339844
r_  generation:  0.5199799537658691
local_output_nid generation:  0.04429459571838379
local_in_edges_tensor generation:  0.050772666931152344
mini_batch_src_global generation:  0.061492204666137695
r_  generation:  0.5364871025085449
----------------------check_connections_block total spend ----------------------------- 12.59740686416626
generate_one_block  0.6824436187744141
generate_one_block  0.68538498878479
generate_one_block  0.6535086631774902
generate_one_block  0.6546506881713867
generate_one_block  0.6675412654876709
generate_one_block  0.7340185642242432
generate_one_block  0.629753828048706
generate_one_block  0.6439187526702881
generate_one_block  0.6462445259094238
generate_one_block  0.6272823810577393
generate_one_block  0.632171630859375
generate_one_block  0.6401371955871582
generate_one_block  0.6554152965545654
generate_one_block  0.6485629081726074
generate_one_block  0.6364989280700684
generate_one_block  0.659062385559082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0011692047119140625  GigaBytes
Max Memory Allocated: 0.0011692047119140625  GigaBytes

connection checking time:  43.03998112678528
block generation total time  37.04538536071777
average batch blocks generation time:  2.315336585044861
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12283945083618164  GigaBytes
Max Memory Allocated: 0.12283945083618164  GigaBytes

torch.Size([166308, 128])
torch.Size([163954, 64])
torch.Size([155916, 64])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 22.38 GiB already allocated; 4.44 MiB free; 22.42 GiB reserved in total by PyTorch)
