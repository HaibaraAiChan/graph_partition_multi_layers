Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648471436.67395
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0277862548828125
range selection method range initialization spend 0.013078689575195312
time for parepare:  0.018024921417236328
local_output_nid generation:  0.0006945133209228516
local_in_edges_tensor generation:  0.003850698471069336
mini_batch_src_global generation:  0.0014753341674804688
r_  generation:  0.009848594665527344
local_output_nid generation:  0.0007336139678955078
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.00144195556640625
r_  generation:  0.009578943252563477
local_output_nid generation:  0.0007333755493164062
local_in_edges_tensor generation:  0.0005266666412353516
mini_batch_src_global generation:  0.000993490219116211
r_  generation:  0.009178400039672852
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0009281635284423828
r_  generation:  0.009503364562988281
local_output_nid generation:  0.0007221698760986328
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0009016990661621094
r_  generation:  0.009103059768676758
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0009367465972900391
r_  generation:  0.009205341339111328
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0009546279907226562
r_  generation:  0.009788274765014648
local_output_nid generation:  0.0007312297821044922
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.009262800216674805
local_output_nid generation:  0.0007295608520507812
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0009207725524902344
r_  generation:  0.009788990020751953
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009565353393554688
r_  generation:  0.00947427749633789
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.0004792213439941406
mini_batch_src_global generation:  0.0009615421295166016
r_  generation:  0.010148763656616211
local_output_nid generation:  0.0007352828979492188
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.000997304916381836
r_  generation:  0.01005864143371582
local_output_nid generation:  0.0007331371307373047
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0009844303131103516
r_  generation:  0.009905576705932617
local_output_nid generation:  0.0007536411285400391
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0009398460388183594
r_  generation:  0.009477615356445312
local_output_nid generation:  0.0007436275482177734
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009996891021728516
r_  generation:  0.010248422622680664
local_output_nid generation:  0.0007441043853759766
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0010368824005126953
r_  generation:  0.009609699249267578
local_output_nid generation:  0.0007631778717041016
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0009596347808837891
r_  generation:  0.009458065032958984
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.0004749298095703125
mini_batch_src_global generation:  0.0009975433349609375
r_  generation:  0.010342597961425781
local_output_nid generation:  0.0007448196411132812
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.0010056495666503906
r_  generation:  0.009912252426147461
local_output_nid generation:  0.0007476806640625
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.01017308235168457
local_output_nid generation:  0.0007519721984863281
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0010204315185546875
r_  generation:  0.009994745254516602
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0009984970092773438
r_  generation:  0.009822368621826172
local_output_nid generation:  0.0007495880126953125
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0009806156158447266
r_  generation:  0.009835243225097656
local_output_nid generation:  0.0007369518280029297
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.00103759765625
r_  generation:  0.010091543197631836
local_output_nid generation:  0.0007550716400146484
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0010292530059814453
r_  generation:  0.010445356369018555
local_output_nid generation:  0.0007498264312744141
local_in_edges_tensor generation:  0.0005085468292236328
mini_batch_src_global generation:  0.001104593276977539
r_  generation:  0.010094404220581055
local_output_nid generation:  0.0007460117340087891
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.00106048583984375
r_  generation:  0.009918212890625
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.0010302066802978516
r_  generation:  0.010174036026000977
local_output_nid generation:  0.0007386207580566406
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.0010559558868408203
r_  generation:  0.010605335235595703
local_output_nid generation:  0.0007545948028564453
local_in_edges_tensor generation:  0.004389762878417969
mini_batch_src_global generation:  0.0012638568878173828
r_  generation:  0.010296344757080078
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0005209445953369141
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.01027822494506836
local_output_nid generation:  0.0008063316345214844
local_in_edges_tensor generation:  0.00048732757568359375
mini_batch_src_global generation:  0.0010585784912109375
r_  generation:  0.009892702102661133
----------------------check_connections_block total spend ----------------------------- 0.48664212226867676
generate_one_block  0.01508188247680664
generate_one_block  0.015044927597045898
generate_one_block  0.014760732650756836
generate_one_block  0.015183448791503906
generate_one_block  0.014412879943847656
generate_one_block  0.014335155487060547
generate_one_block  0.015031099319458008
generate_one_block  0.01435089111328125
generate_one_block  0.01507568359375
generate_one_block  0.01460123062133789
generate_one_block  0.01521921157836914
generate_one_block  0.014913797378540039
generate_one_block  0.014826297760009766
generate_one_block  0.014112472534179688
generate_one_block  0.015233039855957031
generate_one_block  0.014194965362548828
generate_one_block  0.014170646667480469
generate_one_block  0.015136241912841797
generate_one_block  0.014693737030029297
generate_one_block  0.014987945556640625
generate_one_block  0.014954090118408203
generate_one_block  0.014644384384155273
generate_one_block  0.014687538146972656
generate_one_block  0.015248537063598633
generate_one_block  0.015264034271240234
generate_one_block  0.015146493911743164
generate_one_block  0.014818191528320312
generate_one_block  0.015036582946777344
generate_one_block  0.015457391738891602
generate_one_block  0.015048980712890625
generate_one_block  0.015485763549804688
generate_one_block  0.01482391357421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04550933837890625
gen group dst list time:  0.023277759552001953
time for parepare:  0.01981377601623535
local_output_nid generation:  0.0041811466217041016
local_in_edges_tensor generation:  0.013586282730102539
mini_batch_src_global generation:  0.015664100646972656
r_  generation:  0.155106782913208
local_output_nid generation:  0.008393526077270508
local_in_edges_tensor generation:  0.014998435974121094
mini_batch_src_global generation:  0.02025127410888672
r_  generation:  0.16863274574279785
local_output_nid generation:  0.008854389190673828
local_in_edges_tensor generation:  0.010515451431274414
mini_batch_src_global generation:  0.019078969955444336
r_  generation:  0.1686258316040039
local_output_nid generation:  0.008980035781860352
local_in_edges_tensor generation:  0.012434720993041992
mini_batch_src_global generation:  0.020330429077148438
r_  generation:  0.17795300483703613
local_output_nid generation:  0.008819818496704102
local_in_edges_tensor generation:  0.009546995162963867
mini_batch_src_global generation:  0.020830631256103516
r_  generation:  0.17255234718322754
local_output_nid generation:  0.008899211883544922
local_in_edges_tensor generation:  0.010133504867553711
mini_batch_src_global generation:  0.021016836166381836
r_  generation:  0.17223429679870605
local_output_nid generation:  0.009387731552124023
local_in_edges_tensor generation:  0.014038562774658203
mini_batch_src_global generation:  0.02179718017578125
r_  generation:  0.1822671890258789
local_output_nid generation:  0.009248971939086914
local_in_edges_tensor generation:  0.009483098983764648
mini_batch_src_global generation:  0.021296262741088867
r_  generation:  0.1707441806793213
local_output_nid generation:  0.00944375991821289
local_in_edges_tensor generation:  0.011186361312866211
mini_batch_src_global generation:  0.022934913635253906
r_  generation:  0.1766660213470459
local_output_nid generation:  0.00912022590637207
local_in_edges_tensor generation:  0.011003494262695312
mini_batch_src_global generation:  0.02113652229309082
r_  generation:  0.17024850845336914
local_output_nid generation:  0.009487390518188477
local_in_edges_tensor generation:  0.013073921203613281
mini_batch_src_global generation:  0.03002786636352539
r_  generation:  0.18175745010375977
local_output_nid generation:  0.009608745574951172
local_in_edges_tensor generation:  0.011340141296386719
mini_batch_src_global generation:  0.022181272506713867
r_  generation:  0.17821717262268066
local_output_nid generation:  0.009736299514770508
local_in_edges_tensor generation:  0.011263132095336914
mini_batch_src_global generation:  0.022853851318359375
r_  generation:  0.1804032325744629
local_output_nid generation:  0.009433507919311523
local_in_edges_tensor generation:  0.009430170059204102
mini_batch_src_global generation:  0.021651506423950195
r_  generation:  0.17211127281188965
local_output_nid generation:  0.009981155395507812
local_in_edges_tensor generation:  0.012747049331665039
mini_batch_src_global generation:  0.023029088973999023
r_  generation:  0.190354585647583
local_output_nid generation:  0.009363889694213867
local_in_edges_tensor generation:  0.00975799560546875
mini_batch_src_global generation:  0.021995067596435547
r_  generation:  0.17263484001159668
local_output_nid generation:  0.009563684463500977
local_in_edges_tensor generation:  0.009640216827392578
mini_batch_src_global generation:  0.02213263511657715
r_  generation:  0.17609763145446777
local_output_nid generation:  0.009969234466552734
local_in_edges_tensor generation:  0.01183772087097168
mini_batch_src_global generation:  0.024807453155517578
r_  generation:  0.1890854835510254
local_output_nid generation:  0.009747505187988281
local_in_edges_tensor generation:  0.011346578598022461
mini_batch_src_global generation:  0.022797346115112305
r_  generation:  0.17475438117980957
local_output_nid generation:  0.010001420974731445
local_in_edges_tensor generation:  0.011441469192504883
mini_batch_src_global generation:  0.022403478622436523
r_  generation:  0.18022537231445312
local_output_nid generation:  0.009925365447998047
local_in_edges_tensor generation:  0.013056039810180664
mini_batch_src_global generation:  0.023333072662353516
r_  generation:  0.18320703506469727
local_output_nid generation:  0.009851217269897461
local_in_edges_tensor generation:  0.011377811431884766
mini_batch_src_global generation:  0.022484540939331055
r_  generation:  0.18538856506347656
local_output_nid generation:  0.009863138198852539
local_in_edges_tensor generation:  0.011348962783813477
mini_batch_src_global generation:  0.02231764793395996
r_  generation:  0.1804664134979248
local_output_nid generation:  0.010072946548461914
local_in_edges_tensor generation:  0.013142824172973633
mini_batch_src_global generation:  0.024911165237426758
r_  generation:  0.1863865852355957
local_output_nid generation:  0.01020669937133789
local_in_edges_tensor generation:  0.011901140213012695
mini_batch_src_global generation:  0.02343010902404785
r_  generation:  0.1865077018737793
local_output_nid generation:  0.010086536407470703
local_in_edges_tensor generation:  0.011838912963867188
mini_batch_src_global generation:  0.023285627365112305
r_  generation:  0.18723726272583008
local_output_nid generation:  0.010034561157226562
local_in_edges_tensor generation:  0.011879920959472656
mini_batch_src_global generation:  0.023769617080688477
r_  generation:  0.18692612648010254
local_output_nid generation:  0.010150909423828125
local_in_edges_tensor generation:  0.013449430465698242
mini_batch_src_global generation:  0.02293109893798828
r_  generation:  0.1869978904724121
local_output_nid generation:  0.010354757308959961
local_in_edges_tensor generation:  0.0122222900390625
mini_batch_src_global generation:  0.024414539337158203
r_  generation:  0.19332385063171387
local_output_nid generation:  0.010087966918945312
local_in_edges_tensor generation:  0.010001659393310547
mini_batch_src_global generation:  0.023842811584472656
r_  generation:  0.18363475799560547
local_output_nid generation:  0.010204076766967773
local_in_edges_tensor generation:  0.011596441268920898
mini_batch_src_global generation:  0.023874282836914062
r_  generation:  0.18716835975646973
local_output_nid generation:  0.009861469268798828
local_in_edges_tensor generation:  0.009926557540893555
mini_batch_src_global generation:  0.022981643676757812
r_  generation:  0.18045973777770996
----------------------check_connections_block total spend ----------------------------- 8.449645757675171
generate_one_block  0.22197389602661133
generate_one_block  0.22630667686462402
generate_one_block  0.24454045295715332
generate_one_block  0.23134231567382812
generate_one_block  0.22478842735290527
generate_one_block  0.22211647033691406
generate_one_block  0.22657084465026855
generate_one_block  0.21636366844177246
generate_one_block  0.22426748275756836
generate_one_block  0.21634650230407715
generate_one_block  0.22986984252929688
generate_one_block  0.2235403060913086
generate_one_block  0.22701573371887207
generate_one_block  0.21783852577209473
generate_one_block  0.2370285987854004
generate_one_block  0.23851680755615234
generate_one_block  0.2187802791595459
generate_one_block  0.23923659324645996
generate_one_block  0.22043228149414062
generate_one_block  0.2253279685974121
generate_one_block  0.23085808753967285
generate_one_block  0.22768378257751465
generate_one_block  0.22761154174804688
generate_one_block  0.2324821949005127
generate_one_block  0.23444771766662598
generate_one_block  0.23487424850463867
generate_one_block  0.23259234428405762
generate_one_block  0.232041597366333
generate_one_block  0.24293208122253418
generate_one_block  0.23054289817810059
generate_one_block  0.23905205726623535
generate_one_block  0.22739505767822266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04138827323913574
gen group dst list time:  0.10140538215637207
time for parepare:  0.01906895637512207
local_output_nid generation:  0.0221555233001709
local_in_edges_tensor generation:  0.03955078125
mini_batch_src_global generation:  0.050972700119018555
r_  generation:  0.47437524795532227
local_output_nid generation:  0.028522968292236328
local_in_edges_tensor generation:  0.048829078674316406
mini_batch_src_global generation:  0.058242082595825195
r_  generation:  0.4776115417480469
local_output_nid generation:  0.028707504272460938
local_in_edges_tensor generation:  0.039888858795166016
mini_batch_src_global generation:  0.0564877986907959
r_  generation:  0.4880790710449219
local_output_nid generation:  0.027580976486206055
local_in_edges_tensor generation:  0.03622126579284668
mini_batch_src_global generation:  0.06123161315917969
r_  generation:  0.49256324768066406
local_output_nid generation:  0.027339458465576172
local_in_edges_tensor generation:  0.03537702560424805
mini_batch_src_global generation:  0.05792856216430664
r_  generation:  0.48888468742370605
local_output_nid generation:  0.027231216430664062
local_in_edges_tensor generation:  0.03153538703918457
mini_batch_src_global generation:  0.06205153465270996
r_  generation:  0.4886035919189453
local_output_nid generation:  0.02752375602722168
local_in_edges_tensor generation:  0.03946566581726074
mini_batch_src_global generation:  0.05884099006652832
r_  generation:  0.493969202041626
local_output_nid generation:  0.02740001678466797
local_in_edges_tensor generation:  0.04096555709838867
mini_batch_src_global generation:  0.058855295181274414
r_  generation:  0.4913604259490967
local_output_nid generation:  0.027895212173461914
local_in_edges_tensor generation:  0.03595304489135742
mini_batch_src_global generation:  0.05886101722717285
r_  generation:  0.4991121292114258
local_output_nid generation:  0.027704238891601562
local_in_edges_tensor generation:  0.03596305847167969
mini_batch_src_global generation:  0.05914473533630371
r_  generation:  0.4919614791870117
local_output_nid generation:  0.02813243865966797
local_in_edges_tensor generation:  0.04525446891784668
mini_batch_src_global generation:  0.05878734588623047
r_  generation:  0.503242015838623
local_output_nid generation:  0.027692556381225586
local_in_edges_tensor generation:  0.060797691345214844
mini_batch_src_global generation:  0.06041884422302246
r_  generation:  0.4943084716796875
local_output_nid generation:  0.027743816375732422
local_in_edges_tensor generation:  0.03199148178100586
mini_batch_src_global generation:  0.05876040458679199
r_  generation:  0.49684667587280273
local_output_nid generation:  0.027345657348632812
local_in_edges_tensor generation:  0.02812361717224121
mini_batch_src_global generation:  0.05908799171447754
r_  generation:  0.5006179809570312
local_output_nid generation:  0.027770280838012695
local_in_edges_tensor generation:  0.031949520111083984
mini_batch_src_global generation:  0.05872631072998047
r_  generation:  0.49809837341308594
local_output_nid generation:  0.02781057357788086
local_in_edges_tensor generation:  0.02826857566833496
mini_batch_src_global generation:  0.058775901794433594
r_  generation:  0.49315309524536133
local_output_nid generation:  0.027637004852294922
local_in_edges_tensor generation:  0.02809929847717285
mini_batch_src_global generation:  0.061791419982910156
r_  generation:  0.4919285774230957
local_output_nid generation:  0.029004812240600586
local_in_edges_tensor generation:  0.037888288497924805
mini_batch_src_global generation:  0.05870866775512695
r_  generation:  0.5004997253417969
local_output_nid generation:  0.027826786041259766
local_in_edges_tensor generation:  0.032860755920410156
mini_batch_src_global generation:  0.05951666831970215
r_  generation:  0.5056426525115967
local_output_nid generation:  0.028179645538330078
local_in_edges_tensor generation:  0.03075861930847168
mini_batch_src_global generation:  0.061560630798339844
r_  generation:  0.490053653717041
local_output_nid generation:  0.0278165340423584
local_in_edges_tensor generation:  0.035898447036743164
mini_batch_src_global generation:  0.058882951736450195
r_  generation:  0.5022313594818115
local_output_nid generation:  0.027898550033569336
local_in_edges_tensor generation:  0.04117131233215332
mini_batch_src_global generation:  0.05916881561279297
r_  generation:  0.5106115341186523
local_output_nid generation:  0.02815532684326172
local_in_edges_tensor generation:  0.04035758972167969
mini_batch_src_global generation:  0.06029367446899414
r_  generation:  0.4944455623626709
local_output_nid generation:  0.02800130844116211
local_in_edges_tensor generation:  0.04204726219177246
mini_batch_src_global generation:  0.06301665306091309
r_  generation:  0.4970214366912842
local_output_nid generation:  0.028010129928588867
local_in_edges_tensor generation:  0.031456708908081055
mini_batch_src_global generation:  0.05857563018798828
r_  generation:  0.5160810947418213
local_output_nid generation:  0.030562162399291992
local_in_edges_tensor generation:  0.03248405456542969
mini_batch_src_global generation:  0.06114602088928223
r_  generation:  0.5037252902984619
local_output_nid generation:  0.0288236141204834
local_in_edges_tensor generation:  0.037435054779052734
mini_batch_src_global generation:  0.05884575843811035
r_  generation:  0.49624109268188477
local_output_nid generation:  0.028563976287841797
local_in_edges_tensor generation:  0.02874016761779785
mini_batch_src_global generation:  0.05944561958312988
r_  generation:  0.5013959407806396
local_output_nid generation:  0.02959609031677246
local_in_edges_tensor generation:  0.03197503089904785
mini_batch_src_global generation:  0.062470197677612305
r_  generation:  0.5036683082580566
local_output_nid generation:  0.0286867618560791
local_in_edges_tensor generation:  0.032984256744384766
mini_batch_src_global generation:  0.05968737602233887
r_  generation:  0.5045828819274902
local_output_nid generation:  0.028768539428710938
local_in_edges_tensor generation:  0.029499530792236328
mini_batch_src_global generation:  0.06291937828063965
r_  generation:  0.5027363300323486
local_output_nid generation:  0.028920412063598633
local_in_edges_tensor generation:  0.028687000274658203
mini_batch_src_global generation:  0.059560537338256836
r_  generation:  0.502286434173584
----------------------check_connections_block total spend ----------------------------- 23.296197414398193
generate_one_block  0.7520649433135986
generate_one_block  0.6431283950805664
generate_one_block  0.6421964168548584
generate_one_block  0.6625268459320068
generate_one_block  0.6307780742645264
generate_one_block  0.6348645687103271
generate_one_block  0.6516432762145996
generate_one_block  0.6452922821044922
generate_one_block  0.6463758945465088
generate_one_block  0.6413507461547852
generate_one_block  0.6655111312866211
generate_one_block  0.6820633411407471
generate_one_block  0.6787211894989014
generate_one_block  0.6330296993255615
generate_one_block  0.6684114933013916
generate_one_block  0.6756560802459717
generate_one_block  0.656296968460083
generate_one_block  0.7003655433654785
generate_one_block  0.6410698890686035
generate_one_block  0.6436200141906738
generate_one_block  0.7038660049438477
generate_one_block  0.6457991600036621
generate_one_block  0.6618664264678955
generate_one_block  0.6484794616699219
generate_one_block  0.6491091251373291
generate_one_block  0.6583764553070068
generate_one_block  0.6452345848083496
generate_one_block  0.644097089767456
generate_one_block  0.6771607398986816
generate_one_block  0.6453499794006348
generate_one_block  0.6502902507781982
generate_one_block  0.6423530578613281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  31.745843172073364
block generation total time  28.391666412353516
average batch blocks generation time:  0.8872395753860474
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.08924722671508789  GigaBytes
Max Memory Allocated: 0.08924722671508789  GigaBytes

torch.Size([150871, 128])
torch.Size([110705, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6737060546875 GB
    Memory Allocated: 14.1512451171875  GigaBytes
Max Memory Allocated: 14.171248435974121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6815185546875 GB
    Memory Allocated: 0.0898275375366211  GigaBytes
Max Memory Allocated: 14.171248435974121  GigaBytes

torch.Size([149790, 128])
torch.Size([109440, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2401123046875 GB
    Memory Allocated: 14.174456596374512  GigaBytes
Max Memory Allocated: 14.196539402008057  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 0.09053993225097656  GigaBytes
Max Memory Allocated: 14.196539402008057  GigaBytes

torch.Size([149669, 128])
torch.Size([109201, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3768310546875 GB
    Memory Allocated: 14.122343063354492  GigaBytes
Max Memory Allocated: 14.196539402008057  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3768310546875 GB
    Memory Allocated: 0.09019041061401367  GigaBytes
Max Memory Allocated: 14.196539402008057  GigaBytes

torch.Size([150313, 128])
torch.Size([110502, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.280708312988281  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.09055614471435547  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([149812, 128])
torch.Size([109195, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.120360374450684  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.08975696563720703  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150212, 128])
torch.Size([108971, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.013892650604248  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.09064292907714844  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150401, 128])
torch.Size([110206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.186992168426514  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.08983516693115234  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150436, 128])
torch.Size([109367, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.007556915283203  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.09056758880615234  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([149517, 128])
torch.Size([109195, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.135383129119873  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.08946657180786133  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([149691, 128])
torch.Size([108638, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.010889530181885  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.09072113037109375  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150086, 128])
torch.Size([110265, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.212665557861328  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.08979368209838867  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([149947, 128])
torch.Size([109800, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.125636577606201  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.09063434600830078  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([149946, 128])
torch.Size([109680, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.189305782318115  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.08964252471923828  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150044, 128])
torch.Size([108957, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 13.982017993927002  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 0.09077644348144531  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150062, 128])
torch.Size([109656, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1912841796875 GB
    Memory Allocated: 14.234082698822021  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1932373046875 GB
    Memory Allocated: 0.08967876434326172  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150138, 128])
torch.Size([108757, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1932373046875 GB
    Memory Allocated: 13.997109413146973  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1932373046875 GB
    Memory Allocated: 0.09040641784667969  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([149635, 128])
torch.Size([108592, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1932373046875 GB
    Memory Allocated: 14.021596431732178  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1932373046875 GB
    Memory Allocated: 0.09036874771118164  GigaBytes
Max Memory Allocated: 14.302276611328125  GigaBytes

torch.Size([150445, 128])
torch.Size([110780, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.323582649230957  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09049415588378906  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150550, 128])
torch.Size([109787, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.122941017150879  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.08981704711914062  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150054, 128])
torch.Size([109313, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.08958101272583  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09072208404541016  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([149970, 128])
torch.Size([109885, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.224915504455566  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09002017974853516  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150330, 128])
torch.Size([109483, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.13432264328003  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.0905618667602539  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150405, 128])
torch.Size([110133, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.116661548614502  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.0900120735168457  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150021, 128])
torch.Size([109914, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.235085487365723  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09072113037109375  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150318, 128])
torch.Size([109804, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.225395202636719  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09008359909057617  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150061, 128])
torch.Size([110370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.288323402404785  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09073448181152344  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150404, 128])
torch.Size([109773, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.236476421356201  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09003877639770508  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150165, 128])
torch.Size([109767, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 14.205952167510986  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9764404296875 GB
    Memory Allocated: 0.09093666076660156  GigaBytes
Max Memory Allocated: 14.347812175750732  GigaBytes

torch.Size([150639, 128])
torch.Size([110797, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9842529296875 GB
    Memory Allocated: 14.387146949768066  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.08996820449829102  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([149943, 128])
torch.Size([109656, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.22489881515503  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09088706970214844  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150451, 128])
torch.Size([110667, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.322181224822998  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.0899209976196289  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150078, 128])
torch.Size([110143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.185605525970459  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03585261106491089 |0.03342437744140625 |0.6257535666227341 |0.00010566413402557373 |0.9841469973325729 |0.015734434127807617 |
----------------------------------------------------------pseudo_mini_loss sum 4.958492279052734
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9154735
Number of first layer input nodes during this epoch:  4804404
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.11377382278442383  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.031078338623046875
range selection method range initialization spend 0.016725778579711914
time for parepare:  0.01786518096923828
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.010419845581054688
mini_batch_src_global generation:  0.0031044483184814453
r_  generation:  0.01414346694946289
local_output_nid generation:  0.0014374256134033203
local_in_edges_tensor generation:  0.0008831024169921875
mini_batch_src_global generation:  0.0018911361694335938
r_  generation:  0.011395454406738281
local_output_nid generation:  0.0012631416320800781
local_in_edges_tensor generation:  0.0007581710815429688
mini_batch_src_global generation:  0.0012831687927246094
r_  generation:  0.010311603546142578
local_output_nid generation:  0.0011920928955078125
local_in_edges_tensor generation:  0.0007436275482177734
mini_batch_src_global generation:  0.0013544559478759766
r_  generation:  0.010757684707641602
local_output_nid generation:  0.0011606216430664062
local_in_edges_tensor generation:  0.0007228851318359375
mini_batch_src_global generation:  0.0012788772583007812
r_  generation:  0.010042667388916016
local_output_nid generation:  0.0011453628540039062
local_in_edges_tensor generation:  0.0007135868072509766
mini_batch_src_global generation:  0.0012409687042236328
r_  generation:  0.01009988784790039
local_output_nid generation:  0.0011284351348876953
local_in_edges_tensor generation:  0.0006897449493408203
mini_batch_src_global generation:  0.0012404918670654297
r_  generation:  0.010303020477294922
local_output_nid generation:  0.0011222362518310547
local_in_edges_tensor generation:  0.0007042884826660156
mini_batch_src_global generation:  0.0013031959533691406
r_  generation:  0.010532855987548828
local_output_nid generation:  0.0011539459228515625
local_in_edges_tensor generation:  0.0007119178771972656
mini_batch_src_global generation:  0.0014767646789550781
r_  generation:  0.010939836502075195
local_output_nid generation:  0.0011188983917236328
local_in_edges_tensor generation:  0.0007059574127197266
mini_batch_src_global generation:  0.0012726783752441406
r_  generation:  0.010370731353759766
local_output_nid generation:  0.0011789798736572266
local_in_edges_tensor generation:  0.0007174015045166016
mini_batch_src_global generation:  0.0013439655303955078
r_  generation:  0.010940313339233398
local_output_nid generation:  0.0011789798736572266
local_in_edges_tensor generation:  0.0007264614105224609
mini_batch_src_global generation:  0.0012879371643066406
r_  generation:  0.010274648666381836
local_output_nid generation:  0.001142740249633789
local_in_edges_tensor generation:  0.0007407665252685547
mini_batch_src_global generation:  0.0012955665588378906
r_  generation:  0.010507583618164062
local_output_nid generation:  0.0011000633239746094
local_in_edges_tensor generation:  0.0006928443908691406
mini_batch_src_global generation:  0.0014514923095703125
r_  generation:  0.010535240173339844
local_output_nid generation:  0.0010728836059570312
local_in_edges_tensor generation:  0.0006959438323974609
mini_batch_src_global generation:  0.0013778209686279297
r_  generation:  0.01069331169128418
local_output_nid generation:  0.001085042953491211
local_in_edges_tensor generation:  0.0006628036499023438
mini_batch_src_global generation:  0.0014309883117675781
r_  generation:  0.010570049285888672
local_output_nid generation:  0.001047372817993164
local_in_edges_tensor generation:  0.0006766319274902344
mini_batch_src_global generation:  0.001302957534790039
r_  generation:  0.010801553726196289
local_output_nid generation:  0.0010585784912109375
local_in_edges_tensor generation:  0.0006866455078125
mini_batch_src_global generation:  0.0012714862823486328
r_  generation:  0.010676860809326172
local_output_nid generation:  0.0010755062103271484
local_in_edges_tensor generation:  0.0006954669952392578
mini_batch_src_global generation:  0.001322031021118164
r_  generation:  0.010464906692504883
local_output_nid generation:  0.001069784164428711
local_in_edges_tensor generation:  0.0006747245788574219
mini_batch_src_global generation:  0.0012955665588378906
r_  generation:  0.010230064392089844
local_output_nid generation:  0.0010526180267333984
local_in_edges_tensor generation:  0.0006723403930664062
mini_batch_src_global generation:  0.001280069351196289
r_  generation:  0.010584831237792969
local_output_nid generation:  0.0010404586791992188
local_in_edges_tensor generation:  0.0006797313690185547
mini_batch_src_global generation:  0.0013806819915771484
r_  generation:  0.011107683181762695
local_output_nid generation:  0.0010445117950439453
local_in_edges_tensor generation:  0.0006864070892333984
mini_batch_src_global generation:  0.0013599395751953125
r_  generation:  0.010324954986572266
local_output_nid generation:  0.0010409355163574219
local_in_edges_tensor generation:  0.0006937980651855469
mini_batch_src_global generation:  0.0014851093292236328
r_  generation:  0.010735273361206055
local_output_nid generation:  0.001010894775390625
local_in_edges_tensor generation:  0.0006918907165527344
mini_batch_src_global generation:  0.0013947486877441406
r_  generation:  0.010608911514282227
local_output_nid generation:  0.0010349750518798828
local_in_edges_tensor generation:  0.0006768703460693359
mini_batch_src_global generation:  0.0014677047729492188
r_  generation:  0.010702848434448242
local_output_nid generation:  0.0010366439819335938
local_in_edges_tensor generation:  0.0006835460662841797
mini_batch_src_global generation:  0.001291036605834961
r_  generation:  0.0102691650390625
local_output_nid generation:  0.001058340072631836
local_in_edges_tensor generation:  0.0006859302520751953
mini_batch_src_global generation:  0.001425027847290039
r_  generation:  0.010215044021606445
local_output_nid generation:  0.0010483264923095703
local_in_edges_tensor generation:  0.0006854534149169922
mini_batch_src_global generation:  0.0013408660888671875
r_  generation:  0.01039886474609375
local_output_nid generation:  0.0010416507720947266
local_in_edges_tensor generation:  0.0006947517395019531
mini_batch_src_global generation:  0.0015082359313964844
r_  generation:  0.01098489761352539
local_output_nid generation:  0.001081705093383789
local_in_edges_tensor generation:  0.0006814002990722656
mini_batch_src_global generation:  0.0014493465423583984
r_  generation:  0.010463237762451172
local_output_nid generation:  0.001047372817993164
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.001332998275756836
r_  generation:  0.010476350784301758
----------------------check_connections_block total spend ----------------------------- 0.5590980052947998
generate_one_block  0.029736995697021484
generate_one_block  0.02343916893005371
generate_one_block  0.03554224967956543
generate_one_block  0.020509958267211914
generate_one_block  0.019114255905151367
generate_one_block  0.018619298934936523
generate_one_block  0.01863384246826172
generate_one_block  0.019141435623168945
generate_one_block  0.019765138626098633
generate_one_block  0.01853489875793457
generate_one_block  0.019311189651489258
generate_one_block  0.0179595947265625
generate_one_block  0.019295930862426758
generate_one_block  0.018793821334838867
generate_one_block  0.019138574600219727
generate_one_block  0.018793582916259766
generate_one_block  0.019267797470092773
generate_one_block  0.01873302459716797
generate_one_block  0.01834249496459961
generate_one_block  0.018193721771240234
generate_one_block  0.018667221069335938
generate_one_block  0.01925373077392578
generate_one_block  0.018360137939453125
generate_one_block  0.0188751220703125
generate_one_block  0.018544435501098633
generate_one_block  0.018911361694335938
generate_one_block  0.018138647079467773
generate_one_block  0.018503665924072266
generate_one_block  0.01840496063232422
generate_one_block  0.01943182945251465
generate_one_block  0.018330812454223633
generate_one_block  0.018479108810424805
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04474067687988281
gen group dst list time:  0.02430105209350586
time for parepare:  0.019640445709228516
local_output_nid generation:  0.005517005920410156
local_in_edges_tensor generation:  0.019811391830444336
mini_batch_src_global generation:  0.016349315643310547
r_  generation:  0.1773219108581543
local_output_nid generation:  0.007820367813110352
local_in_edges_tensor generation:  0.010595083236694336
mini_batch_src_global generation:  0.021026134490966797
r_  generation:  0.17180800437927246
local_output_nid generation:  0.007978677749633789
local_in_edges_tensor generation:  0.031221389770507812
mini_batch_src_global generation:  0.022356748580932617
r_  generation:  0.17505908012390137
local_output_nid generation:  0.008728742599487305
local_in_edges_tensor generation:  0.011487483978271484
mini_batch_src_global generation:  0.0211639404296875
r_  generation:  0.18406248092651367
local_output_nid generation:  0.008536338806152344
local_in_edges_tensor generation:  0.008282661437988281
mini_batch_src_global generation:  0.02272772789001465
r_  generation:  0.18150711059570312
local_output_nid generation:  0.008501529693603516
local_in_edges_tensor generation:  0.008152008056640625
mini_batch_src_global generation:  0.021174192428588867
r_  generation:  0.1772007942199707
local_output_nid generation:  0.008353948593139648
local_in_edges_tensor generation:  0.008764505386352539
mini_batch_src_global generation:  0.023329734802246094
r_  generation:  0.18427515029907227
local_output_nid generation:  0.008564472198486328
local_in_edges_tensor generation:  0.014226198196411133
mini_batch_src_global generation:  0.022605180740356445
r_  generation:  0.1913444995880127
local_output_nid generation:  0.010301589965820312
local_in_edges_tensor generation:  0.017180204391479492
mini_batch_src_global generation:  0.02524256706237793
r_  generation:  0.19875216484069824
local_output_nid generation:  0.010033369064331055
local_in_edges_tensor generation:  0.011221647262573242
mini_batch_src_global generation:  0.022829771041870117
r_  generation:  0.18101978302001953
local_output_nid generation:  0.009634256362915039
local_in_edges_tensor generation:  0.009389162063598633
mini_batch_src_global generation:  0.02435922622680664
r_  generation:  0.1881570816040039
local_output_nid generation:  0.009014129638671875
local_in_edges_tensor generation:  0.009078264236450195
mini_batch_src_global generation:  0.021730422973632812
r_  generation:  0.17318415641784668
local_output_nid generation:  0.009663820266723633
local_in_edges_tensor generation:  0.010301351547241211
mini_batch_src_global generation:  0.02424144744873047
r_  generation:  0.1875905990600586
local_output_nid generation:  0.00931859016418457
local_in_edges_tensor generation:  0.010090351104736328
mini_batch_src_global generation:  0.023152828216552734
r_  generation:  0.23551225662231445
local_output_nid generation:  0.00928807258605957
local_in_edges_tensor generation:  0.012152910232543945
mini_batch_src_global generation:  0.02359795570373535
r_  generation:  0.18723702430725098
local_output_nid generation:  0.009468317031860352
local_in_edges_tensor generation:  0.008943796157836914
mini_batch_src_global generation:  0.022705554962158203
r_  generation:  0.18158793449401855
local_output_nid generation:  0.00972604751586914
local_in_edges_tensor generation:  0.010367631912231445
mini_batch_src_global generation:  0.024999380111694336
r_  generation:  0.19043660163879395
local_output_nid generation:  0.009346961975097656
local_in_edges_tensor generation:  0.010169267654418945
mini_batch_src_global generation:  0.02290654182434082
r_  generation:  0.1821444034576416
local_output_nid generation:  0.009302854537963867
local_in_edges_tensor generation:  0.00882101058959961
mini_batch_src_global generation:  0.022299766540527344
r_  generation:  0.17887258529663086
local_output_nid generation:  0.00915217399597168
local_in_edges_tensor generation:  0.008675336837768555
mini_batch_src_global generation:  0.022087812423706055
r_  generation:  0.17995071411132812
local_output_nid generation:  0.009127616882324219
local_in_edges_tensor generation:  0.010376691818237305
mini_batch_src_global generation:  0.022219181060791016
r_  generation:  0.1820240020751953
local_output_nid generation:  0.009324073791503906
local_in_edges_tensor generation:  0.010546684265136719
mini_batch_src_global generation:  0.0244901180267334
r_  generation:  0.18905854225158691
local_output_nid generation:  0.009024620056152344
local_in_edges_tensor generation:  0.008811473846435547
mini_batch_src_global generation:  0.022321701049804688
r_  generation:  0.18434834480285645
local_output_nid generation:  0.010890960693359375
local_in_edges_tensor generation:  0.009202957153320312
mini_batch_src_global generation:  0.023205280303955078
r_  generation:  0.18590879440307617
local_output_nid generation:  0.00898432731628418
local_in_edges_tensor generation:  0.010320186614990234
mini_batch_src_global generation:  0.02256155014038086
r_  generation:  0.1847684383392334
local_output_nid generation:  0.010606765747070312
local_in_edges_tensor generation:  0.012080192565917969
mini_batch_src_global generation:  0.0228271484375
r_  generation:  0.20651650428771973
local_output_nid generation:  0.008806228637695312
local_in_edges_tensor generation:  0.008780717849731445
mini_batch_src_global generation:  0.02201676368713379
r_  generation:  0.18073487281799316
local_output_nid generation:  0.009073495864868164
local_in_edges_tensor generation:  0.008855104446411133
mini_batch_src_global generation:  0.023063182830810547
r_  generation:  0.18248820304870605
local_output_nid generation:  0.00903010368347168
local_in_edges_tensor generation:  0.010204315185546875
mini_batch_src_global generation:  0.022302865982055664
r_  generation:  0.1808795928955078
local_output_nid generation:  0.009418487548828125
local_in_edges_tensor generation:  0.013541460037231445
mini_batch_src_global generation:  0.028763294219970703
r_  generation:  0.1986696720123291
local_output_nid generation:  0.008902788162231445
local_in_edges_tensor generation:  0.00888967514038086
mini_batch_src_global generation:  0.022001028060913086
r_  generation:  0.18356680870056152
local_output_nid generation:  0.009170293807983398
local_in_edges_tensor generation:  0.010749101638793945
mini_batch_src_global generation:  0.02326059341430664
r_  generation:  0.20024681091308594
----------------------check_connections_block total spend ----------------------------- 8.69717788696289
generate_one_block  0.26743340492248535
generate_one_block  0.24890756607055664
generate_one_block  0.25197291374206543
generate_one_block  0.2546977996826172
generate_one_block  0.2735307216644287
generate_one_block  0.24270105361938477
generate_one_block  0.24675798416137695
generate_one_block  0.24884724617004395
generate_one_block  0.2606351375579834
generate_one_block  0.24214959144592285
generate_one_block  0.27105259895324707
generate_one_block  0.23481488227844238
generate_one_block  0.25539588928222656
generate_one_block  0.24590682983398438
generate_one_block  0.250683069229126
generate_one_block  0.24513030052185059
generate_one_block  0.26026272773742676
generate_one_block  0.24798250198364258
generate_one_block  0.2410295009613037
generate_one_block  0.24606537818908691
generate_one_block  0.25272631645202637
generate_one_block  0.26419520378112793
generate_one_block  0.24925017356872559
generate_one_block  0.2519989013671875
generate_one_block  0.2428731918334961
generate_one_block  0.24701857566833496
generate_one_block  0.23715901374816895
generate_one_block  0.24751639366149902
generate_one_block  0.2412409782409668
generate_one_block  0.2621877193450928
generate_one_block  0.234605073928833
generate_one_block  0.247452974319458
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04545021057128906
gen group dst list time:  0.11372017860412598
time for parepare:  0.019617080688476562
local_output_nid generation:  0.025664091110229492
local_in_edges_tensor generation:  0.052335262298583984
mini_batch_src_global generation:  0.04925417900085449
r_  generation:  0.5003335475921631
local_output_nid generation:  0.030440330505371094
local_in_edges_tensor generation:  0.04620838165283203
mini_batch_src_global generation:  0.05834054946899414
r_  generation:  0.5013406276702881
local_output_nid generation:  0.029558658599853516
local_in_edges_tensor generation:  0.04518938064575195
mini_batch_src_global generation:  0.056627511978149414
r_  generation:  0.5030710697174072
local_output_nid generation:  0.029253721237182617
local_in_edges_tensor generation:  0.04193735122680664
mini_batch_src_global generation:  0.06118297576904297
r_  generation:  0.49783802032470703
local_output_nid generation:  0.02918076515197754
local_in_edges_tensor generation:  0.03303027153015137
mini_batch_src_global generation:  0.05762195587158203
r_  generation:  0.5057392120361328
local_output_nid generation:  0.028809547424316406
local_in_edges_tensor generation:  0.029514312744140625
mini_batch_src_global generation:  0.05983138084411621
r_  generation:  0.4957845211029053
local_output_nid generation:  0.029242277145385742
local_in_edges_tensor generation:  0.029035329818725586
mini_batch_src_global generation:  0.05783700942993164
r_  generation:  0.5026366710662842
local_output_nid generation:  0.029325246810913086
local_in_edges_tensor generation:  0.03290820121765137
mini_batch_src_global generation:  0.06106877326965332
r_  generation:  0.5050549507141113
local_output_nid generation:  0.029387950897216797
local_in_edges_tensor generation:  0.038599491119384766
mini_batch_src_global generation:  0.05902409553527832
r_  generation:  0.5116419792175293
local_output_nid generation:  0.030225753784179688
local_in_edges_tensor generation:  0.036469459533691406
mini_batch_src_global generation:  0.05920886993408203
r_  generation:  0.49802732467651367
local_output_nid generation:  0.029731035232543945
local_in_edges_tensor generation:  0.036370038986206055
mini_batch_src_global generation:  0.0618441104888916
r_  generation:  0.5178787708282471
local_output_nid generation:  0.02946758270263672
local_in_edges_tensor generation:  0.03939962387084961
mini_batch_src_global generation:  0.06748652458190918
r_  generation:  0.5062215328216553
local_output_nid generation:  0.03406333923339844
local_in_edges_tensor generation:  0.03533196449279785
mini_batch_src_global generation:  0.061261892318725586
r_  generation:  0.5024082660675049
local_output_nid generation:  0.030142545700073242
local_in_edges_tensor generation:  0.037835121154785156
mini_batch_src_global generation:  0.05912160873413086
r_  generation:  0.5025064945220947
local_output_nid generation:  0.030445575714111328
local_in_edges_tensor generation:  0.03411412239074707
mini_batch_src_global generation:  0.0622258186340332
r_  generation:  0.50423264503479
local_output_nid generation:  0.030304670333862305
local_in_edges_tensor generation:  0.02932143211364746
mini_batch_src_global generation:  0.059438228607177734
r_  generation:  0.49834656715393066
local_output_nid generation:  0.030492067337036133
local_in_edges_tensor generation:  0.03401923179626465
mini_batch_src_global generation:  0.06244468688964844
r_  generation:  0.5148358345031738
local_output_nid generation:  0.030133724212646484
local_in_edges_tensor generation:  0.033677101135253906
mini_batch_src_global generation:  0.05902242660522461
r_  generation:  0.5072579383850098
local_output_nid generation:  0.030745506286621094
local_in_edges_tensor generation:  0.02920985221862793
mini_batch_src_global generation:  0.05821537971496582
r_  generation:  0.5047857761383057
local_output_nid generation:  0.0301971435546875
local_in_edges_tensor generation:  0.03335881233215332
mini_batch_src_global generation:  0.06281924247741699
r_  generation:  0.49828290939331055
local_output_nid generation:  0.03072357177734375
local_in_edges_tensor generation:  0.03354310989379883
mini_batch_src_global generation:  0.05873727798461914
r_  generation:  0.5143618583679199
local_output_nid generation:  0.030530452728271484
local_in_edges_tensor generation:  0.038202762603759766
mini_batch_src_global generation:  0.05932879447937012
r_  generation:  0.5142881870269775
local_output_nid generation:  0.03057074546813965
local_in_edges_tensor generation:  0.029773473739624023
mini_batch_src_global generation:  0.059346675872802734
r_  generation:  0.5137014389038086
local_output_nid generation:  0.03289604187011719
local_in_edges_tensor generation:  0.03832578659057617
mini_batch_src_global generation:  0.05918312072753906
r_  generation:  0.4995744228363037
local_output_nid generation:  0.03333735466003418
local_in_edges_tensor generation:  0.03547859191894531
mini_batch_src_global generation:  0.05840444564819336
r_  generation:  0.5079610347747803
local_output_nid generation:  0.030246496200561523
local_in_edges_tensor generation:  0.04547381401062012
mini_batch_src_global generation:  0.05924057960510254
r_  generation:  0.5010888576507568
local_output_nid generation:  0.030174970626831055
local_in_edges_tensor generation:  0.03625822067260742
mini_batch_src_global generation:  0.05791330337524414
r_  generation:  0.5036609172821045
local_output_nid generation:  0.030938148498535156
local_in_edges_tensor generation:  0.03820300102233887
mini_batch_src_global generation:  0.05985522270202637
r_  generation:  0.51590895652771
local_output_nid generation:  0.030221939086914062
local_in_edges_tensor generation:  0.03615880012512207
mini_batch_src_global generation:  0.06092572212219238
r_  generation:  0.5183727741241455
local_output_nid generation:  0.032590389251708984
local_in_edges_tensor generation:  0.03574347496032715
mini_batch_src_global generation:  0.06348228454589844
r_  generation:  0.5090384483337402
local_output_nid generation:  0.03015875816345215
local_in_edges_tensor generation:  0.03567647933959961
mini_batch_src_global generation:  0.0583493709564209
r_  generation:  0.5042297840118408
local_output_nid generation:  0.0305478572845459
local_in_edges_tensor generation:  0.03344464302062988
mini_batch_src_global generation:  0.06285905838012695
r_  generation:  0.5076649188995361
----------------------check_connections_block total spend ----------------------------- 23.74972152709961
generate_one_block  0.700465202331543
generate_one_block  0.6785311698913574
generate_one_block  0.690004825592041
generate_one_block  0.6881487369537354
generate_one_block  0.7886075973510742
generate_one_block  0.6668314933776855
generate_one_block  0.6710066795349121
generate_one_block  0.6780672073364258
generate_one_block  0.699352502822876
generate_one_block  0.6689088344573975
generate_one_block  0.6849641799926758
generate_one_block  0.6682493686676025
generate_one_block  0.6698999404907227
generate_one_block  0.6846444606781006
generate_one_block  0.6812124252319336
generate_one_block  0.6668307781219482
generate_one_block  0.6924035549163818
generate_one_block  0.6669156551361084
generate_one_block  0.6653640270233154
generate_one_block  0.6700179576873779
generate_one_block  0.6889300346374512
generate_one_block  0.6940226554870605
generate_one_block  0.672619104385376
generate_one_block  0.6831865310668945
generate_one_block  0.7025432586669922
generate_one_block  0.6699402332305908
generate_one_block  0.6662578582763672
generate_one_block  0.6932508945465088
generate_one_block  0.6670737266540527
generate_one_block  0.690706729888916
generate_one_block  0.6746892929077148
generate_one_block  0.6847109794616699
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.11377382278442383  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

connection checking time:  32.4468994140625
block generation total time  29.88253951072693
average batch blocks generation time:  0.9338293597102165
block dataloader generation time/epoch 66.00542402267456
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09239530563354492  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150035, 128])
torch.Size([109809, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.199563026428223  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09165525436401367  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150023, 128])
torch.Size([109488, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.19884729385376  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09243392944335938  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150361, 128])
torch.Size([110144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.253543853759766  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09206151962280273  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150493, 128])
torch.Size([110274, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.323261260986328  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09234809875488281  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150870, 128])
torch.Size([110315, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.20339822769165  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09136390686035156  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([149892, 128])
torch.Size([108807, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.06370735168457  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09236621856689453  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150297, 128])
torch.Size([109654, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.181499004364014  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09176921844482422  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([150356, 128])
torch.Size([109731, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 14.152730941772461  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9862060546875 GB
    Memory Allocated: 0.09272384643554688  GigaBytes
Max Memory Allocated: 14.409424304962158  GigaBytes

torch.Size([151061, 128])
torch.Size([111863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.45263147354126  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.0915975570678711  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150120, 128])
torch.Size([109853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.149351119995117  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09251594543457031  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150795, 128])
torch.Size([111071, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.288967609405518  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09133529663085938  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150108, 128])
torch.Size([108408, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 13.978579044342041  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09247779846191406  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150179, 128])
torch.Size([109598, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.252444744110107  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09163618087768555  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150123, 128])
torch.Size([109654, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.149342060089111  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.0924215316772461  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150506, 128])
torch.Size([110302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.2283034324646  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09186649322509766  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150678, 128])
torch.Size([109815, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.144563674926758  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.0926218032836914  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150337, 128])
torch.Size([111017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.360005855560303  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09140825271606445  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([149727, 128])
torch.Size([108910, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.123768329620361  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.0921621322631836  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150444, 128])
torch.Size([109657, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.057968616485596  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09147119522094727  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150053, 128])
torch.Size([109045, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.090478897094727  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09227180480957031  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150182, 128])
torch.Size([110091, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.175137042999268  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09195327758789062  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150384, 128])
torch.Size([110428, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.295787334442139  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09223270416259766  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([149980, 128])
torch.Size([109105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.117139339447021  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09193849563598633  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150579, 128])
torch.Size([110235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.227876663208008  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09231948852539062  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150323, 128])
torch.Size([109635, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.160065174102783  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09148406982421875  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([149824, 128])
torch.Size([109227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.132994174957275  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09215831756591797  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150143, 128])
torch.Size([108895, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.057321071624756  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09221029281616211  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([151143, 128])
torch.Size([111389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.273854732513428  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09221076965332031  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150743, 128])
torch.Size([109775, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.110583305358887  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09197378158569336  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150209, 128])
torch.Size([110836, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.364891052246094  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09208011627197266  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150431, 128])
torch.Size([108787, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.000270366668701  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 0.09187889099121094  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

torch.Size([150484, 128])
torch.Size([110023, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7615966796875 GB
    Memory Allocated: 14.222597599029541  GigaBytes
Max Memory Allocated: 14.47533655166626  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029299862682819366 |0.023094825446605682 |0.5960629284381866 |9.849667549133301e-05 |0.9534483104944229 |0.0054781436920166016 |
----------------------------------------------------------pseudo_mini_loss sum 3.7913482189178467
Total (block generation + training)time/epoch 117.35906529426575
Training time/epoch 51.35332989692688
Training time without block to device /epoch 50.6142954826355
Training time without total dataloading part /epoch 49.592989683151245
load block tensor time/epoch 0.9375956058502197
block to device time/epoch 0.7390344142913818
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9166539
Number of first layer input nodes during this epoch:  4810883
