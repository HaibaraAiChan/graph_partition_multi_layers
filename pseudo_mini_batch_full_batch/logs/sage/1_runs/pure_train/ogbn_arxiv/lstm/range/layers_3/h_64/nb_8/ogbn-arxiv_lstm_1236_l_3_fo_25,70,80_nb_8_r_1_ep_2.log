Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648470339.9706242
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02699565887451172
range selection method range initialization spend 0.013085126876831055
time for parepare:  0.01805710792541504
local_output_nid generation:  0.0027251243591308594
local_in_edges_tensor generation:  0.0047321319580078125
mini_batch_src_global generation:  0.003635883331298828
r_  generation:  0.040918588638305664
local_output_nid generation:  0.0031561851501464844
local_in_edges_tensor generation:  0.00170135498046875
mini_batch_src_global generation:  0.004430055618286133
r_  generation:  0.041936635971069336
local_output_nid generation:  0.0032706260681152344
local_in_edges_tensor generation:  0.0017635822296142578
mini_batch_src_global generation:  0.003164529800415039
r_  generation:  0.04335165023803711
local_output_nid generation:  0.003224611282348633
local_in_edges_tensor generation:  0.001737356185913086
mini_batch_src_global generation:  0.00768589973449707
r_  generation:  0.048012733459472656
local_output_nid generation:  0.0032851696014404297
local_in_edges_tensor generation:  0.0018014907836914062
mini_batch_src_global generation:  0.010091066360473633
r_  generation:  0.04509401321411133
local_output_nid generation:  0.0031816959381103516
local_in_edges_tensor generation:  0.0017998218536376953
mini_batch_src_global generation:  0.003625631332397461
r_  generation:  0.04633355140686035
local_output_nid generation:  0.0032396316528320312
local_in_edges_tensor generation:  0.0018095970153808594
mini_batch_src_global generation:  0.003690004348754883
r_  generation:  0.04623818397521973
local_output_nid generation:  0.0032062530517578125
local_in_edges_tensor generation:  0.0017480850219726562
mini_batch_src_global generation:  0.003789186477661133
r_  generation:  0.04726409912109375
----------------------check_connections_block total spend ----------------------------- 0.5346071720123291
generate_one_block  0.06155204772949219
generate_one_block  0.06050848960876465
generate_one_block  0.061593055725097656
generate_one_block  0.06072282791137695
generate_one_block  0.06343960762023926
generate_one_block  0.06104135513305664
generate_one_block  0.06269359588623047
generate_one_block  0.0644235610961914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04550480842590332
gen group dst list time:  0.016180038452148438
time for parepare:  0.01917576789855957
local_output_nid generation:  0.011157512664794922
local_in_edges_tensor generation:  0.034218788146972656
mini_batch_src_global generation:  0.03512310981750488
r_  generation:  0.3552870750427246
local_output_nid generation:  0.017256736755371094
local_in_edges_tensor generation:  0.03189206123352051
mini_batch_src_global generation:  0.044359445571899414
r_  generation:  0.3617134094238281
local_output_nid generation:  0.017184019088745117
local_in_edges_tensor generation:  0.02670598030090332
mini_batch_src_global generation:  0.04603910446166992
r_  generation:  0.3716275691986084
local_output_nid generation:  0.017737865447998047
local_in_edges_tensor generation:  0.02716994285583496
mini_batch_src_global generation:  0.04479622840881348
r_  generation:  0.37746524810791016
local_output_nid generation:  0.017748117446899414
local_in_edges_tensor generation:  0.02335810661315918
mini_batch_src_global generation:  0.045617103576660156
r_  generation:  0.37428808212280273
local_output_nid generation:  0.018035411834716797
local_in_edges_tensor generation:  0.02675604820251465
mini_batch_src_global generation:  0.045737504959106445
r_  generation:  0.3859593868255615
local_output_nid generation:  0.018450498580932617
local_in_edges_tensor generation:  0.025494813919067383
mini_batch_src_global generation:  0.04994487762451172
r_  generation:  0.39098024368286133
local_output_nid generation:  0.01865386962890625
local_in_edges_tensor generation:  0.02127361297607422
mini_batch_src_global generation:  0.05001521110534668
r_  generation:  0.3952338695526123
----------------------check_connections_block total spend ----------------------------- 4.376945972442627
generate_one_block  0.4999992847442627
generate_one_block  0.48137903213500977
generate_one_block  0.4980494976043701
generate_one_block  0.4933607578277588
generate_one_block  0.4981861114501953
generate_one_block  0.5103979110717773
generate_one_block  0.5121254920959473
generate_one_block  0.5093390941619873
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03350400924682617
gen group dst list time:  0.036750078201293945
time for parepare:  0.019615888595581055
local_output_nid generation:  0.025644302368164062
local_in_edges_tensor generation:  0.042690277099609375
mini_batch_src_global generation:  0.04819893836975098
r_  generation:  0.4835379123687744
local_output_nid generation:  0.036743879318237305
local_in_edges_tensor generation:  0.05255246162414551
mini_batch_src_global generation:  0.054651498794555664
r_  generation:  0.4879593849182129
local_output_nid generation:  0.038085222244262695
local_in_edges_tensor generation:  0.039589881896972656
mini_batch_src_global generation:  0.05584383010864258
r_  generation:  0.5124173164367676
local_output_nid generation:  0.03871965408325195
local_in_edges_tensor generation:  0.04384565353393555
mini_batch_src_global generation:  0.0533602237701416
r_  generation:  0.5020148754119873
local_output_nid generation:  0.039731740951538086
local_in_edges_tensor generation:  0.03578591346740723
mini_batch_src_global generation:  0.057494163513183594
r_  generation:  0.4987063407897949
local_output_nid generation:  0.03972506523132324
local_in_edges_tensor generation:  0.04424881935119629
mini_batch_src_global generation:  0.05371904373168945
r_  generation:  0.508364200592041
local_output_nid generation:  0.03936338424682617
local_in_edges_tensor generation:  0.04491090774536133
mini_batch_src_global generation:  0.054151058197021484
r_  generation:  0.5045838356018066
local_output_nid generation:  0.039446115493774414
local_in_edges_tensor generation:  0.040016889572143555
mini_batch_src_global generation:  0.05522918701171875
r_  generation:  0.506084680557251
----------------------check_connections_block total spend ----------------------------- 5.974836587905884
generate_one_block  0.6157264709472656
generate_one_block  0.6221065521240234
generate_one_block  0.6223735809326172
generate_one_block  0.6276993751525879
generate_one_block  0.6281507015228271
generate_one_block  0.6321723461151123
generate_one_block  0.6538412570953369
generate_one_block  0.6340677738189697
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  10.35178256034851
block generation total time  9.038975238800049
average batch blocks generation time:  1.129871904850006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10039234161376953  GigaBytes
Max Memory Allocated: 0.10039234161376953  GigaBytes

torch.Size([162071, 128])
torch.Size([146079, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.0018310546875 GB
    Memory Allocated: 16.552565097808838  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6033935546875 GB
    Memory Allocated: 0.10234498977661133  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

torch.Size([162142, 128])
torch.Size([145845, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6033935546875 GB
    Memory Allocated: 16.452656745910645  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.1032710075378418  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

torch.Size([162123, 128])
torch.Size([145849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 16.528223991394043  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.10258293151855469  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

torch.Size([162065, 128])
torch.Size([145792, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 16.531350135803223  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.10327005386352539  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

torch.Size([162168, 128])
torch.Size([145730, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 16.515026569366455  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.10332489013671875  GigaBytes
Max Memory Allocated: 16.583954334259033  GigaBytes

torch.Size([162247, 128])
torch.Size([145916, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 16.563960552215576  GigaBytes
Max Memory Allocated: 16.597754955291748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.10354852676391602  GigaBytes
Max Memory Allocated: 16.597754955291748  GigaBytes

torch.Size([162237, 128])
torch.Size([146160, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 16.643030643463135  GigaBytes
Max Memory Allocated: 16.67679262161255  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1873779296875 GB
    Memory Allocated: 0.10279130935668945  GigaBytes
Max Memory Allocated: 16.67679262161255  GigaBytes

torch.Size([162292, 128])
torch.Size([146085, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1873779296875 GB
    Memory Allocated: 16.67051935195923  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.040041834115982056 |0.06118518114089966 |0.6857602000236511 |0.00011688470840454102 |0.9980506896972656 |0.01314401626586914 |
----------------------------------------------------------pseudo_mini_loss sum 4.947963714599609
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3053823
Number of first layer input nodes during this epoch:  1297345
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.1873779296875 GB
    Memory Allocated: 0.1400151252746582  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027708768844604492
range selection method range initialization spend 0.015507221221923828
time for parepare:  0.01687026023864746
local_output_nid generation:  0.0030448436737060547
local_in_edges_tensor generation:  0.006821155548095703
mini_batch_src_global generation:  0.004520416259765625
r_  generation:  0.04334259033203125
local_output_nid generation:  0.004968404769897461
local_in_edges_tensor generation:  0.0019512176513671875
mini_batch_src_global generation:  0.004807233810424805
r_  generation:  0.04409384727478027
local_output_nid generation:  0.003379344940185547
local_in_edges_tensor generation:  0.0018267631530761719
mini_batch_src_global generation:  0.0056765079498291016
r_  generation:  0.054357051849365234
local_output_nid generation:  0.004079341888427734
local_in_edges_tensor generation:  0.001988649368286133
mini_batch_src_global generation:  0.003612995147705078
r_  generation:  0.04904007911682129
local_output_nid generation:  0.004077911376953125
local_in_edges_tensor generation:  0.0018947124481201172
mini_batch_src_global generation:  0.006073713302612305
r_  generation:  0.04793429374694824
local_output_nid generation:  0.003993511199951172
local_in_edges_tensor generation:  0.0019123554229736328
mini_batch_src_global generation:  0.003984928131103516
r_  generation:  0.07272863388061523
local_output_nid generation:  0.0041294097900390625
local_in_edges_tensor generation:  0.0019390583038330078
mini_batch_src_global generation:  0.007088422775268555
r_  generation:  0.055655717849731445
local_output_nid generation:  0.0036950111389160156
local_in_edges_tensor generation:  0.0031118392944335938
mini_batch_src_global generation:  0.005219221115112305
r_  generation:  0.04934525489807129
----------------------check_connections_block total spend ----------------------------- 0.6210751533508301
generate_one_block  0.09171390533447266
generate_one_block  0.0759274959564209
generate_one_block  0.07485818862915039
generate_one_block  0.07516741752624512
generate_one_block  0.07458376884460449
generate_one_block  0.07550454139709473
generate_one_block  0.07811689376831055
generate_one_block  0.07508587837219238
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05274224281311035
gen group dst list time:  0.023953676223754883
time for parepare:  0.02153182029724121
local_output_nid generation:  0.012431859970092773
local_in_edges_tensor generation:  0.040033578872680664
mini_batch_src_global generation:  0.035275936126708984
r_  generation:  0.3635406494140625
local_output_nid generation:  0.01730632781982422
local_in_edges_tensor generation:  0.03254127502441406
mini_batch_src_global generation:  0.04469871520996094
r_  generation:  0.3719356060028076
local_output_nid generation:  0.020153522491455078
local_in_edges_tensor generation:  0.027037620544433594
mini_batch_src_global generation:  0.0443120002746582
r_  generation:  0.37824487686157227
local_output_nid generation:  0.019828319549560547
local_in_edges_tensor generation:  0.026405811309814453
mini_batch_src_global generation:  0.04526495933532715
r_  generation:  0.3856935501098633
local_output_nid generation:  0.01822829246520996
local_in_edges_tensor generation:  0.023845672607421875
mini_batch_src_global generation:  0.045508384704589844
r_  generation:  0.3936307430267334
local_output_nid generation:  0.020750045776367188
local_in_edges_tensor generation:  0.030370235443115234
mini_batch_src_global generation:  0.05689883232116699
r_  generation:  0.3918135166168213
local_output_nid generation:  0.023497343063354492
local_in_edges_tensor generation:  0.025620222091674805
mini_batch_src_global generation:  0.05620741844177246
r_  generation:  0.3854095935821533
local_output_nid generation:  0.019324541091918945
local_in_edges_tensor generation:  0.027056455612182617
mini_batch_src_global generation:  0.049542903900146484
r_  generation:  0.38519978523254395
----------------------check_connections_block total spend ----------------------------- 4.501753091812134
generate_one_block  0.5669450759887695
generate_one_block  0.5269806385040283
generate_one_block  0.5269780158996582
generate_one_block  0.5373702049255371
generate_one_block  0.5488622188568115
generate_one_block  0.5324363708496094
generate_one_block  0.5256922245025635
generate_one_block  0.5609598159790039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04088592529296875
gen group dst list time:  0.03908085823059082
time for parepare:  0.019500255584716797
local_output_nid generation:  0.027267932891845703
local_in_edges_tensor generation:  0.05367469787597656
mini_batch_src_global generation:  0.04473686218261719
r_  generation:  0.4771158695220947
local_output_nid generation:  0.03288555145263672
local_in_edges_tensor generation:  0.04962587356567383
mini_batch_src_global generation:  0.05477452278137207
r_  generation:  0.4860954284667969
local_output_nid generation:  0.03367972373962402
local_in_edges_tensor generation:  0.042029380798339844
mini_batch_src_global generation:  0.08215546607971191
r_  generation:  0.49732303619384766
local_output_nid generation:  0.03433346748352051
local_in_edges_tensor generation:  0.03811001777648926
mini_batch_src_global generation:  0.053212642669677734
r_  generation:  0.5063045024871826
local_output_nid generation:  0.034293413162231445
local_in_edges_tensor generation:  0.04069328308105469
mini_batch_src_global generation:  0.05419659614562988
r_  generation:  0.5262365341186523
local_output_nid generation:  0.03882956504821777
local_in_edges_tensor generation:  0.04410362243652344
mini_batch_src_global generation:  0.062345027923583984
r_  generation:  0.5075511932373047
local_output_nid generation:  0.035398244857788086
local_in_edges_tensor generation:  0.0405423641204834
mini_batch_src_global generation:  0.05459713935852051
r_  generation:  0.504037618637085
local_output_nid generation:  0.036199331283569336
local_in_edges_tensor generation:  0.03844952583312988
mini_batch_src_global generation:  0.0547482967376709
r_  generation:  0.504472017288208
----------------------check_connections_block total spend ----------------------------- 5.991595983505249
generate_one_block  0.6642067432403564
generate_one_block  0.6565377712249756
generate_one_block  0.6769528388977051
generate_one_block  0.6598153114318848
generate_one_block  0.6437201499938965
generate_one_block  0.6618678569793701
generate_one_block  0.6623899936676025
generate_one_block  0.6716945171356201
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.1873779296875 GB
    Memory Allocated: 0.1400151252746582  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

connection checking time:  10.493349075317383
block generation total time  9.623409748077393
average batch blocks generation time:  1.202926218509674
block dataloader generation time/epoch 22.70415472984314
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1873779296875 GB
    Memory Allocated: 0.10518360137939453  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162469, 128])
torch.Size([146160, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9139404296875 GB
    Memory Allocated: 16.652236461639404  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9139404296875 GB
    Memory Allocated: 0.10476016998291016  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162161, 128])
torch.Size([145991, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9139404296875 GB
    Memory Allocated: 16.553633213043213  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9139404296875 GB
    Memory Allocated: 0.10581445693969727  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162366, 128])
torch.Size([146485, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9139404296875 GB
    Memory Allocated: 16.618794918060303  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9139404296875 GB
    Memory Allocated: 0.10433673858642578  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162259, 128])
torch.Size([146042, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 16.57520818710327  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 0.10500192642211914  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([161986, 128])
torch.Size([145645, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 16.520349979400635  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 0.10428428649902344  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162303, 128])
torch.Size([146104, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 16.553241729736328  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 0.10496664047241211  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162104, 128])
torch.Size([145439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 16.505003929138184  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 0.10425758361816406  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

torch.Size([162203, 128])
torch.Size([145939, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9393310546875 GB
    Memory Allocated: 16.564236640930176  GigaBytes
Max Memory Allocated: 16.70465850830078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0434395968914032 |0.027175694704055786 |0.5743505656719208 |0.00010508298873901367 |0.9467732012271881 |0.003938198089599609 |
----------------------------------------------------------pseudo_mini_loss sum 3.7973756790161133
Total (block generation + training)time/epoch 35.470484018325806
Training time/epoch 12.766003608703613
Training time without block to device /epoch 12.548598051071167
Training time without total dataloading part /epoch 12.173768997192383
load block tensor time/epoch 0.3475167751312256
block to device time/epoch 0.2174055576324463
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3055336
Number of first layer input nodes during this epoch:  1297851
