Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648477159.6891418
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029342174530029297
range selection method range initialization spend 0.013300418853759766
time for parepare:  0.018131017684936523
local_output_nid generation:  0.0006875991821289062
local_in_edges_tensor generation:  0.003782510757446289
mini_batch_src_global generation:  0.0015120506286621094
r_  generation:  0.010579347610473633
local_output_nid generation:  0.0007653236389160156
local_in_edges_tensor generation:  0.0005745887756347656
mini_batch_src_global generation:  0.0015261173248291016
r_  generation:  0.009785890579223633
local_output_nid generation:  0.0007796287536621094
local_in_edges_tensor generation:  0.0005252361297607422
mini_batch_src_global generation:  0.000957489013671875
r_  generation:  0.009366750717163086
local_output_nid generation:  0.0007443428039550781
local_in_edges_tensor generation:  0.0004971027374267578
mini_batch_src_global generation:  0.0009076595306396484
r_  generation:  0.00873255729675293
local_output_nid generation:  0.000736236572265625
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0008943080902099609
r_  generation:  0.009144067764282227
local_output_nid generation:  0.0007550716400146484
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.009330272674560547
local_output_nid generation:  0.0007302761077880859
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0009167194366455078
r_  generation:  0.009419441223144531
local_output_nid generation:  0.0007421970367431641
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0009713172912597656
r_  generation:  0.009798765182495117
local_output_nid generation:  0.000762939453125
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.009435892105102539
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.0004832744598388672
mini_batch_src_global generation:  0.0010471343994140625
r_  generation:  0.009622573852539062
local_output_nid generation:  0.0007312297821044922
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.000986337661743164
r_  generation:  0.009875059127807617
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0009789466857910156
r_  generation:  0.009978055953979492
local_output_nid generation:  0.0007398128509521484
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.009865760803222656
local_output_nid generation:  0.0007584095001220703
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0010628700256347656
r_  generation:  0.010202169418334961
local_output_nid generation:  0.0007393360137939453
local_in_edges_tensor generation:  0.0005197525024414062
mini_batch_src_global generation:  0.0011038780212402344
r_  generation:  0.010272741317749023
local_output_nid generation:  0.0007660388946533203
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0009839534759521484
r_  generation:  0.010007381439208984
local_output_nid generation:  0.0007462501525878906
local_in_edges_tensor generation:  0.0004885196685791016
mini_batch_src_global generation:  0.0009951591491699219
r_  generation:  0.009610652923583984
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.001039266586303711
r_  generation:  0.010225057601928711
local_output_nid generation:  0.0007526874542236328
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.000997304916381836
r_  generation:  0.009751081466674805
local_output_nid generation:  0.0007462501525878906
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.001024484634399414
r_  generation:  0.009679555892944336
local_output_nid generation:  0.0007872581481933594
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0009949207305908203
r_  generation:  0.009758234024047852
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0010073184967041016
r_  generation:  0.010181188583374023
local_output_nid generation:  0.0007572174072265625
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.001013040542602539
r_  generation:  0.009903669357299805
local_output_nid generation:  0.0007691383361816406
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0009691715240478516
r_  generation:  0.009473562240600586
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004630088806152344
mini_batch_src_global generation:  0.0009796619415283203
r_  generation:  0.010006904602050781
local_output_nid generation:  0.0007748603820800781
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.001005411148071289
r_  generation:  0.00996088981628418
local_output_nid generation:  0.0007557868957519531
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0009822845458984375
r_  generation:  0.009663105010986328
local_output_nid generation:  0.0007600784301757812
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0010082721710205078
r_  generation:  0.010071516036987305
local_output_nid generation:  0.0007643699645996094
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0009851455688476562
r_  generation:  0.010051727294921875
local_output_nid generation:  0.0007588863372802734
local_in_edges_tensor generation:  0.004225015640258789
mini_batch_src_global generation:  0.001157999038696289
r_  generation:  0.009904861450195312
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.0010197162628173828
r_  generation:  0.009635210037231445
local_output_nid generation:  0.0007719993591308594
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.0010974407196044922
r_  generation:  0.01011204719543457
----------------------check_connections_block total spend ----------------------------- 0.4833564758300781
generate_one_block  0.015570402145385742
generate_one_block  0.015137195587158203
generate_one_block  0.014888286590576172
generate_one_block  0.014099836349487305
generate_one_block  0.014775753021240234
generate_one_block  0.014485597610473633
generate_one_block  0.014444112777709961
generate_one_block  0.015251874923706055
generate_one_block  0.014606237411499023
generate_one_block  0.015032291412353516
generate_one_block  0.015001058578491211
generate_one_block  0.015028238296508789
generate_one_block  0.014865636825561523
generate_one_block  0.015314102172851562
generate_one_block  0.015445470809936523
generate_one_block  0.01446843147277832
generate_one_block  0.014338016510009766
generate_one_block  0.015492439270019531
generate_one_block  0.014632940292358398
generate_one_block  0.014621973037719727
generate_one_block  0.014879226684570312
generate_one_block  0.015389442443847656
generate_one_block  0.01460123062133789
generate_one_block  0.014108657836914062
generate_one_block  0.015156269073486328
generate_one_block  0.014916658401489258
generate_one_block  0.014794349670410156
generate_one_block  0.015014886856079102
generate_one_block  0.014816761016845703
generate_one_block  0.014375448226928711
generate_one_block  0.014501333236694336
generate_one_block  0.015086174011230469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0470430850982666
gen group dst list time:  0.0234987735748291
time for parepare:  0.01968979835510254
local_output_nid generation:  0.004238605499267578
local_in_edges_tensor generation:  0.013714075088500977
mini_batch_src_global generation:  0.016489028930664062
r_  generation:  0.1588890552520752
local_output_nid generation:  0.008553504943847656
local_in_edges_tensor generation:  0.011817455291748047
mini_batch_src_global generation:  0.020395517349243164
r_  generation:  0.16347479820251465
local_output_nid generation:  0.008481264114379883
local_in_edges_tensor generation:  0.011994361877441406
mini_batch_src_global generation:  0.01894354820251465
r_  generation:  0.16324234008789062
local_output_nid generation:  0.008482933044433594
local_in_edges_tensor generation:  0.008855104446411133
mini_batch_src_global generation:  0.018903017044067383
r_  generation:  0.1598520278930664
local_output_nid generation:  0.00898122787475586
local_in_edges_tensor generation:  0.012514829635620117
mini_batch_src_global generation:  0.020676136016845703
r_  generation:  0.17155027389526367
local_output_nid generation:  0.008952140808105469
local_in_edges_tensor generation:  0.009461164474487305
mini_batch_src_global generation:  0.020953655242919922
r_  generation:  0.17094039916992188
local_output_nid generation:  0.008991003036499023
local_in_edges_tensor generation:  0.01216268539428711
mini_batch_src_global generation:  0.021587848663330078
r_  generation:  0.17517757415771484
local_output_nid generation:  0.009497404098510742
local_in_edges_tensor generation:  0.013135194778442383
mini_batch_src_global generation:  0.023497581481933594
r_  generation:  0.17741060256958008
local_output_nid generation:  0.009280204772949219
local_in_edges_tensor generation:  0.01015615463256836
mini_batch_src_global generation:  0.022025346755981445
r_  generation:  0.1728048324584961
local_output_nid generation:  0.009565591812133789
local_in_edges_tensor generation:  0.011350870132446289
mini_batch_src_global generation:  0.021803617477416992
r_  generation:  0.1775493621826172
local_output_nid generation:  0.009648799896240234
local_in_edges_tensor generation:  0.010471582412719727
mini_batch_src_global generation:  0.022401094436645508
r_  generation:  0.17998981475830078
local_output_nid generation:  0.00967717170715332
local_in_edges_tensor generation:  0.01328134536743164
mini_batch_src_global generation:  0.022537946701049805
r_  generation:  0.17872071266174316
local_output_nid generation:  0.009754419326782227
local_in_edges_tensor generation:  0.010305404663085938
mini_batch_src_global generation:  0.022231101989746094
r_  generation:  0.17934060096740723
local_output_nid generation:  0.009812593460083008
local_in_edges_tensor generation:  0.013061285018920898
mini_batch_src_global generation:  0.023001670837402344
r_  generation:  0.18122434616088867
local_output_nid generation:  0.0099945068359375
local_in_edges_tensor generation:  0.013586997985839844
mini_batch_src_global generation:  0.023678302764892578
r_  generation:  0.1853351593017578
local_output_nid generation:  0.009500741958618164
local_in_edges_tensor generation:  0.013016223907470703
mini_batch_src_global generation:  0.022632122039794922
r_  generation:  0.1765885353088379
local_output_nid generation:  0.009387016296386719
local_in_edges_tensor generation:  0.009723663330078125
mini_batch_src_global generation:  0.02122187614440918
r_  generation:  0.1705765724182129
local_output_nid generation:  0.010071992874145508
local_in_edges_tensor generation:  0.013344049453735352
mini_batch_src_global generation:  0.023242712020874023
r_  generation:  0.18366026878356934
local_output_nid generation:  0.009724140167236328
local_in_edges_tensor generation:  0.01029515266418457
mini_batch_src_global generation:  0.022494792938232422
r_  generation:  0.1761929988861084
local_output_nid generation:  0.009734153747558594
local_in_edges_tensor generation:  0.011214256286621094
mini_batch_src_global generation:  0.022025108337402344
r_  generation:  0.1752157211303711
local_output_nid generation:  0.009666204452514648
local_in_edges_tensor generation:  0.011784076690673828
mini_batch_src_global generation:  0.023734092712402344
r_  generation:  0.18005585670471191
local_output_nid generation:  0.009928226470947266
local_in_edges_tensor generation:  0.01203608512878418
mini_batch_src_global generation:  0.023639440536499023
r_  generation:  0.18928813934326172
local_output_nid generation:  0.009500503540039062
local_in_edges_tensor generation:  0.009849071502685547
mini_batch_src_global generation:  0.022609233856201172
r_  generation:  0.17509102821350098
local_output_nid generation:  0.009428024291992188
local_in_edges_tensor generation:  0.010653495788574219
mini_batch_src_global generation:  0.021550893783569336
r_  generation:  0.1708078384399414
local_output_nid generation:  0.009772777557373047
local_in_edges_tensor generation:  0.013354063034057617
mini_batch_src_global generation:  0.02297687530517578
r_  generation:  0.18197059631347656
local_output_nid generation:  0.009665727615356445
local_in_edges_tensor generation:  0.013025283813476562
mini_batch_src_global generation:  0.022950172424316406
r_  generation:  0.17903447151184082
local_output_nid generation:  0.009685754776000977
local_in_edges_tensor generation:  0.011522531509399414
mini_batch_src_global generation:  0.021882057189941406
r_  generation:  0.1729569435119629
local_output_nid generation:  0.009788036346435547
local_in_edges_tensor generation:  0.01175832748413086
mini_batch_src_global generation:  0.023684024810791016
r_  generation:  0.1799170970916748
local_output_nid generation:  0.009769916534423828
local_in_edges_tensor generation:  0.011729717254638672
mini_batch_src_global generation:  0.02232980728149414
r_  generation:  0.17728495597839355
local_output_nid generation:  0.009532690048217773
local_in_edges_tensor generation:  0.01276707649230957
mini_batch_src_global generation:  0.022042036056518555
r_  generation:  0.17996764183044434
local_output_nid generation:  0.009437322616577148
local_in_edges_tensor generation:  0.009925127029418945
mini_batch_src_global generation:  0.021714448928833008
r_  generation:  0.17441248893737793
local_output_nid generation:  0.009885787963867188
local_in_edges_tensor generation:  0.011883258819580078
mini_batch_src_global generation:  0.023737430572509766
r_  generation:  0.18291735649108887
----------------------check_connections_block total spend ----------------------------- 8.300997734069824
generate_one_block  0.23280715942382812
generate_one_block  0.22551393508911133
generate_one_block  0.24365997314453125
generate_one_block  0.21120619773864746
generate_one_block  0.2269454002380371
generate_one_block  0.2278892993927002
generate_one_block  0.22114086151123047
generate_one_block  0.2331554889678955
generate_one_block  0.22335171699523926
generate_one_block  0.22429299354553223
generate_one_block  0.23658418655395508
generate_one_block  0.2366933822631836
generate_one_block  0.22423839569091797
generate_one_block  0.23100566864013672
generate_one_block  0.2422337532043457
generate_one_block  0.24382781982421875
generate_one_block  0.21347641944885254
generate_one_block  0.2389066219329834
generate_one_block  0.22142744064331055
generate_one_block  0.2189655303955078
generate_one_block  0.2305002212524414
generate_one_block  0.2370615005493164
generate_one_block  0.2199385166168213
generate_one_block  0.21233034133911133
generate_one_block  0.23258423805236816
generate_one_block  0.22884297370910645
generate_one_block  0.21843266487121582
generate_one_block  0.2305281162261963
generate_one_block  0.22466635704040527
generate_one_block  0.21861815452575684
generate_one_block  0.21881985664367676
generate_one_block  0.23944997787475586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03816962242126465
gen group dst list time:  0.10284090042114258
time for parepare:  0.0189054012298584
local_output_nid generation:  0.02162337303161621
local_in_edges_tensor generation:  0.04358649253845215
mini_batch_src_global generation:  0.04685711860656738
r_  generation:  0.469590425491333
local_output_nid generation:  0.02797222137451172
local_in_edges_tensor generation:  0.04712700843811035
mini_batch_src_global generation:  0.05770230293273926
r_  generation:  0.48328685760498047
local_output_nid generation:  0.02849888801574707
local_in_edges_tensor generation:  0.04341316223144531
mini_batch_src_global generation:  0.05561327934265137
r_  generation:  0.4947984218597412
local_output_nid generation:  0.02677631378173828
local_in_edges_tensor generation:  0.029208660125732422
mini_batch_src_global generation:  0.05641603469848633
r_  generation:  0.47861599922180176
local_output_nid generation:  0.026867151260375977
local_in_edges_tensor generation:  0.04754757881164551
mini_batch_src_global generation:  0.057204484939575195
r_  generation:  0.49105405807495117
local_output_nid generation:  0.027360916137695312
local_in_edges_tensor generation:  0.043515682220458984
mini_batch_src_global generation:  0.05875420570373535
r_  generation:  0.4879591464996338
local_output_nid generation:  0.027103185653686523
local_in_edges_tensor generation:  0.02956414222717285
mini_batch_src_global generation:  0.05826449394226074
r_  generation:  0.4939131736755371
local_output_nid generation:  0.027469158172607422
local_in_edges_tensor generation:  0.03471684455871582
mini_batch_src_global generation:  0.05888772010803223
r_  generation:  0.48920226097106934
local_output_nid generation:  0.027175188064575195
local_in_edges_tensor generation:  0.046491146087646484
mini_batch_src_global generation:  0.05753636360168457
r_  generation:  0.4933152198791504
local_output_nid generation:  0.02729344367980957
local_in_edges_tensor generation:  0.031562089920043945
mini_batch_src_global generation:  0.05833578109741211
r_  generation:  0.4879164695739746
local_output_nid generation:  0.027237653732299805
local_in_edges_tensor generation:  0.04854536056518555
mini_batch_src_global generation:  0.062009572982788086
r_  generation:  0.49986839294433594
local_output_nid generation:  0.028652191162109375
local_in_edges_tensor generation:  0.05348992347717285
mini_batch_src_global generation:  0.06068587303161621
r_  generation:  0.49214935302734375
local_output_nid generation:  0.026999473571777344
local_in_edges_tensor generation:  0.032366037368774414
mini_batch_src_global generation:  0.05795788764953613
r_  generation:  0.4938313961029053
local_output_nid generation:  0.027390480041503906
local_in_edges_tensor generation:  0.03264904022216797
mini_batch_src_global generation:  0.05908703804016113
r_  generation:  0.49443888664245605
local_output_nid generation:  0.027834415435791016
local_in_edges_tensor generation:  0.04306387901306152
mini_batch_src_global generation:  0.05781912803649902
r_  generation:  0.502528190612793
local_output_nid generation:  0.02756953239440918
local_in_edges_tensor generation:  0.029139280319213867
mini_batch_src_global generation:  0.05992913246154785
r_  generation:  0.48918795585632324
local_output_nid generation:  0.027767419815063477
local_in_edges_tensor generation:  0.02867269515991211
mini_batch_src_global generation:  0.05804157257080078
r_  generation:  0.5023019313812256
local_output_nid generation:  0.028215646743774414
local_in_edges_tensor generation:  0.044316768646240234
mini_batch_src_global generation:  0.059012651443481445
r_  generation:  0.49503469467163086
local_output_nid generation:  0.02759528160095215
local_in_edges_tensor generation:  0.02945232391357422
mini_batch_src_global generation:  0.058779239654541016
r_  generation:  0.4956204891204834
local_output_nid generation:  0.02764296531677246
local_in_edges_tensor generation:  0.03256654739379883
mini_batch_src_global generation:  0.06496405601501465
r_  generation:  0.4943501949310303
local_output_nid generation:  0.02776622772216797
local_in_edges_tensor generation:  0.038330078125
mini_batch_src_global generation:  0.0580449104309082
r_  generation:  0.4952266216278076
local_output_nid generation:  0.027777671813964844
local_in_edges_tensor generation:  0.03356432914733887
mini_batch_src_global generation:  0.05932497978210449
r_  generation:  0.5029768943786621
local_output_nid generation:  0.027393102645874023
local_in_edges_tensor generation:  0.03670787811279297
mini_batch_src_global generation:  0.07490944862365723
r_  generation:  0.4897134304046631
local_output_nid generation:  0.027321577072143555
local_in_edges_tensor generation:  0.03514361381530762
mini_batch_src_global generation:  0.05916476249694824
r_  generation:  0.48731279373168945
local_output_nid generation:  0.027636289596557617
local_in_edges_tensor generation:  0.03760218620300293
mini_batch_src_global generation:  0.05773496627807617
r_  generation:  0.5137252807617188
local_output_nid generation:  0.028315305709838867
local_in_edges_tensor generation:  0.03260517120361328
mini_batch_src_global generation:  0.06316041946411133
r_  generation:  0.48992371559143066
local_output_nid generation:  0.028286218643188477
local_in_edges_tensor generation:  0.03234434127807617
mini_batch_src_global generation:  0.0648202896118164
r_  generation:  0.49471187591552734
local_output_nid generation:  0.02833104133605957
local_in_edges_tensor generation:  0.032527923583984375
mini_batch_src_global generation:  0.06183624267578125
r_  generation:  0.5101680755615234
local_output_nid generation:  0.030472755432128906
local_in_edges_tensor generation:  0.0331876277923584
mini_batch_src_global generation:  0.06184101104736328
r_  generation:  0.49902868270874023
local_output_nid generation:  0.028137922286987305
local_in_edges_tensor generation:  0.033023834228515625
mini_batch_src_global generation:  0.06176424026489258
r_  generation:  0.49477291107177734
local_output_nid generation:  0.028120756149291992
local_in_edges_tensor generation:  0.03258156776428223
mini_batch_src_global generation:  0.06250500679016113
r_  generation:  0.4962761402130127
local_output_nid generation:  0.028601884841918945
local_in_edges_tensor generation:  0.037644147872924805
mini_batch_src_global generation:  0.06526589393615723
r_  generation:  0.49451589584350586
----------------------check_connections_block total spend ----------------------------- 23.2400119304657
generate_one_block  0.7459075450897217
generate_one_block  0.6357009410858154
generate_one_block  0.6503403186798096
generate_one_block  0.6451456546783447
generate_one_block  0.6483056545257568
generate_one_block  0.643075704574585
generate_one_block  0.6418533325195312
generate_one_block  0.65970778465271
generate_one_block  0.6295597553253174
generate_one_block  0.6322808265686035
generate_one_block  0.6558420658111572
generate_one_block  0.6568961143493652
generate_one_block  0.6327147483825684
generate_one_block  0.6396157741546631
generate_one_block  0.6606438159942627
generate_one_block  0.6390547752380371
generate_one_block  0.6371400356292725
generate_one_block  0.6536688804626465
generate_one_block  0.6316211223602295
generate_one_block  0.6428413391113281
generate_one_block  0.6568622589111328
generate_one_block  0.652195930480957
generate_one_block  0.627450704574585
generate_one_block  0.6326172351837158
generate_one_block  0.6461915969848633
generate_one_block  0.6428682804107666
generate_one_block  0.6436896324157715
generate_one_block  0.6536259651184082
generate_one_block  0.6481938362121582
generate_one_block  0.6318314075469971
generate_one_block  0.6420252323150635
generate_one_block  0.6605789661407471
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  31.541009664535522
block generation total time  28.00914239883423
average batch blocks generation time:  0.8752856999635696
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09387063980102539  GigaBytes
Max Memory Allocated: 0.09387063980102539  GigaBytes

torch.Size([149927, 128])
torch.Size([109675, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0682373046875 GB
    Memory Allocated: 21.03667640686035  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5526123046875 GB
    Memory Allocated: 0.0989689826965332  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([150687, 128])
torch.Size([110089, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5174560546875 GB
    Memory Allocated: 20.736353874206543  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 0.09938716888427734  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([150587, 128])
torch.Size([110488, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.708824634552002  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09823226928710938  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([149916, 128])
torch.Size([108168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.13236093521118  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09938621520996094  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([150613, 128])
torch.Size([109591, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.792705059051514  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09889364242553711  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([150643, 128])
torch.Size([110025, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.648285388946533  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09924507141113281  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([150105, 128])
torch.Size([108962, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 20.532658100128174  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2908935546875 GB
    Memory Allocated: 0.09935617446899414  GigaBytes
Max Memory Allocated: 21.136268615722656  GigaBytes

torch.Size([151093, 128])
torch.Size([111662, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0135498046875 GB
    Memory Allocated: 21.101313591003418  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4744873046875 GB
    Memory Allocated: 0.09861516952514648  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([150031, 128])
torch.Size([109485, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4315185546875 GB
    Memory Allocated: 20.658326148986816  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4354248046875 GB
    Memory Allocated: 0.09874582290649414  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([150317, 128])
torch.Size([109503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4510498046875 GB
    Memory Allocated: 20.721130847930908  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.09885311126708984  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([150076, 128])
torch.Size([110296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8045654296875 GB
    Memory Allocated: 21.064505100250244  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2108154296875 GB
    Memory Allocated: 0.09901189804077148  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([150349, 128])
torch.Size([110903, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8338623046875 GB
    Memory Allocated: 21.08071804046631  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8358154296875 GB
    Memory Allocated: 0.09863615036010742  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([149897, 128])
torch.Size([109275, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8358154296875 GB
    Memory Allocated: 20.863240242004395  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8358154296875 GB
    Memory Allocated: 0.09916925430297852  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([150713, 128])
torch.Size([110610, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 21.085500240325928  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3377685546875 GB
    Memory Allocated: 0.09917640686035156  GigaBytes
Max Memory Allocated: 21.191402912139893  GigaBytes

torch.Size([150524, 128])
torch.Size([110699, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0291748046875 GB
    Memory Allocated: 21.257371425628662  GigaBytes
Max Memory Allocated: 21.353546142578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9295654296875 GB
    Memory Allocated: 0.09878253936767578  GigaBytes
Max Memory Allocated: 21.353546142578125  GigaBytes

torch.Size([150342, 128])
torch.Size([109461, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5545654296875 GB
    Memory Allocated: 20.718934059143066  GigaBytes
Max Memory Allocated: 21.353546142578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5565185546875 GB
    Memory Allocated: 0.09882116317749023  GigaBytes
Max Memory Allocated: 21.353546142578125  GigaBytes

torch.Size([150735, 128])
torch.Size([110306, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5565185546875 GB
    Memory Allocated: 20.4022798538208  GigaBytes
Max Memory Allocated: 21.353546142578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0487060546875 GB
    Memory Allocated: 0.09922313690185547  GigaBytes
Max Memory Allocated: 21.353546142578125  GigaBytes

torch.Size([150512, 128])
torch.Size([111276, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1873779296875 GB
    Memory Allocated: 21.342766761779785  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0662841796875 GB
    Memory Allocated: 0.09863471984863281  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150002, 128])
torch.Size([109532, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 20.733877658843994  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5155029296875 GB
    Memory Allocated: 0.09879112243652344  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150464, 128])
torch.Size([109733, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5233154296875 GB
    Memory Allocated: 20.590981006622314  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0350341796875 GB
    Memory Allocated: 0.09863996505737305  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149845, 128])
torch.Size([109718, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2049560546875 GB
    Memory Allocated: 20.905129432678223  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2069091796875 GB
    Memory Allocated: 0.09903860092163086  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150317, 128])
torch.Size([110851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2069091796875 GB
    Memory Allocated: 21.18423366546631  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3045654296875 GB
    Memory Allocated: 0.0984187126159668  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149963, 128])
torch.Size([108408, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6131591796875 GB
    Memory Allocated: 20.416529655456543  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6151123046875 GB
    Memory Allocated: 0.09826898574829102  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149831, 128])
torch.Size([108689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6151123046875 GB
    Memory Allocated: 20.247982501983643  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6151123046875 GB
    Memory Allocated: 0.09890985488891602  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150363, 128])
torch.Size([110151, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8280029296875 GB
    Memory Allocated: 20.955482482910156  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.09858083724975586  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149903, 128])
torch.Size([109066, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.764652252197266  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.09874868392944336  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150421, 128])
torch.Size([109568, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.57476234436035  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.09899044036865234  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150556, 128])
torch.Size([110354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.884428024291992  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.09882259368896484  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150426, 128])
torch.Size([110140, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.727623462677002  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.0983729362487793  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149845, 128])
torch.Size([108801, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.43685293197632  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.0984334945678711  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149958, 128])
torch.Size([108688, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.393581867218018  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.09882831573486328  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150126, 128])
torch.Size([110210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.97155523300171  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038616105914115906 |0.03680945932865143 |0.7482538595795631 |0.00010770559310913086 |1.499197892844677 |0.020348787307739258 |
----------------------------------------------------------pseudo_mini_loss sum 5.392922878265381
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9163445
Number of first layer input nodes during this epoch:  4809087
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.13155651092529297  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02838873863220215
range selection method range initialization spend 0.01833939552307129
time for parepare:  0.020133256912231445
local_output_nid generation:  0.0011594295501708984
local_in_edges_tensor generation:  0.0068776607513427734
mini_batch_src_global generation:  0.0017194747924804688
r_  generation:  0.010704278945922852
local_output_nid generation:  0.0010082721710205078
local_in_edges_tensor generation:  0.001276254653930664
mini_batch_src_global generation:  0.002050638198852539
r_  generation:  0.011133670806884766
local_output_nid generation:  0.0009293556213378906
local_in_edges_tensor generation:  0.0006496906280517578
mini_batch_src_global generation:  0.0013821125030517578
r_  generation:  0.00991368293762207
local_output_nid generation:  0.0009622573852539062
local_in_edges_tensor generation:  0.0006539821624755859
mini_batch_src_global generation:  0.0010538101196289062
r_  generation:  0.009697437286376953
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0008013248443603516
mini_batch_src_global generation:  0.0010280609130859375
r_  generation:  0.009500741958618164
local_output_nid generation:  0.0008873939514160156
local_in_edges_tensor generation:  0.0009357929229736328
mini_batch_src_global generation:  0.0012166500091552734
r_  generation:  0.010679244995117188
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0006129741668701172
mini_batch_src_global generation:  0.0010876655578613281
r_  generation:  0.010098457336425781
local_output_nid generation:  0.0009124279022216797
local_in_edges_tensor generation:  0.0007076263427734375
mini_batch_src_global generation:  0.00107574462890625
r_  generation:  0.009942054748535156
local_output_nid generation:  0.0008573532104492188
local_in_edges_tensor generation:  0.0007786750793457031
mini_batch_src_global generation:  0.0011413097381591797
r_  generation:  0.010136127471923828
local_output_nid generation:  0.0009262561798095703
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.0011751651763916016
r_  generation:  0.010463714599609375
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0007085800170898438
mini_batch_src_global generation:  0.0012683868408203125
r_  generation:  0.010762453079223633
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0006024837493896484
mini_batch_src_global generation:  0.001195669174194336
r_  generation:  0.01033329963684082
local_output_nid generation:  0.0008795261383056641
local_in_edges_tensor generation:  0.0005824565887451172
mini_batch_src_global generation:  0.0011048316955566406
r_  generation:  0.010751962661743164
local_output_nid generation:  0.0008702278137207031
local_in_edges_tensor generation:  0.0005805492401123047
mini_batch_src_global generation:  0.0011203289031982422
r_  generation:  0.010352849960327148
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0006017684936523438
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.010123968124389648
local_output_nid generation:  0.0008745193481445312
local_in_edges_tensor generation:  0.0005786418914794922
mini_batch_src_global generation:  0.0010762214660644531
r_  generation:  0.010132789611816406
local_output_nid generation:  0.0008647441864013672
local_in_edges_tensor generation:  0.0005834102630615234
mini_batch_src_global generation:  0.0010578632354736328
r_  generation:  0.010099649429321289
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.0006008148193359375
mini_batch_src_global generation:  0.0010614395141601562
r_  generation:  0.010067462921142578
local_output_nid generation:  0.0008664131164550781
local_in_edges_tensor generation:  0.0006110668182373047
mini_batch_src_global generation:  0.0010623931884765625
r_  generation:  0.010204792022705078
local_output_nid generation:  0.0008707046508789062
local_in_edges_tensor generation:  0.0005714893341064453
mini_batch_src_global generation:  0.001070261001586914
r_  generation:  0.010079622268676758
local_output_nid generation:  0.0008542537689208984
local_in_edges_tensor generation:  0.0006327629089355469
mini_batch_src_global generation:  0.0010843276977539062
r_  generation:  0.010253667831420898
local_output_nid generation:  0.0008513927459716797
local_in_edges_tensor generation:  0.0006284713745117188
mini_batch_src_global generation:  0.0010800361633300781
r_  generation:  0.010205507278442383
local_output_nid generation:  0.000858306884765625
local_in_edges_tensor generation:  0.0005757808685302734
mini_batch_src_global generation:  0.0011181831359863281
r_  generation:  0.010620594024658203
local_output_nid generation:  0.0008594989776611328
local_in_edges_tensor generation:  0.0005688667297363281
mini_batch_src_global generation:  0.0011944770812988281
r_  generation:  0.010800838470458984
local_output_nid generation:  0.0008549690246582031
local_in_edges_tensor generation:  0.000583648681640625
mini_batch_src_global generation:  0.0011563301086425781
r_  generation:  0.010290861129760742
local_output_nid generation:  0.0009360313415527344
local_in_edges_tensor generation:  0.0006651878356933594
mini_batch_src_global generation:  0.0010962486267089844
r_  generation:  0.01026463508605957
local_output_nid generation:  0.0008597373962402344
local_in_edges_tensor generation:  0.0006184577941894531
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.010381460189819336
local_output_nid generation:  0.0008673667907714844
local_in_edges_tensor generation:  0.0006203651428222656
mini_batch_src_global generation:  0.0010685920715332031
r_  generation:  0.010174036026000977
local_output_nid generation:  0.0008480548858642578
local_in_edges_tensor generation:  0.0008518695831298828
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.010278940200805664
local_output_nid generation:  0.0008413791656494141
local_in_edges_tensor generation:  0.0006325244903564453
mini_batch_src_global generation:  0.001294851303100586
r_  generation:  0.010269880294799805
local_output_nid generation:  0.0009632110595703125
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0012598037719726562
r_  generation:  0.010459184646606445
local_output_nid generation:  0.0008552074432373047
local_in_edges_tensor generation:  0.0006494522094726562
mini_batch_src_global generation:  0.0012445449829101562
r_  generation:  0.010616779327392578
----------------------check_connections_block total spend ----------------------------- 0.5256330966949463
generate_one_block  0.04193592071533203
generate_one_block  0.0213625431060791
generate_one_block  0.019530534744262695
generate_one_block  0.018776893615722656
generate_one_block  0.018462657928466797
generate_one_block  0.020087242126464844
generate_one_block  0.019036531448364258
generate_one_block  0.018856525421142578
generate_one_block  0.01923227310180664
generate_one_block  0.019742488861083984
generate_one_block  0.019834518432617188
generate_one_block  0.019306182861328125
generate_one_block  0.01994609832763672
generate_one_block  0.019141197204589844
generate_one_block  0.01869988441467285
generate_one_block  0.019110918045043945
generate_one_block  0.01884627342224121
generate_one_block  0.018622159957885742
generate_one_block  0.01909470558166504
generate_one_block  0.018520116806030273
generate_one_block  0.01893138885498047
generate_one_block  0.018812179565429688
generate_one_block  0.019684314727783203
generate_one_block  0.019847393035888672
generate_one_block  0.019072294235229492
generate_one_block  0.018949508666992188
generate_one_block  0.01946735382080078
generate_one_block  0.018771648406982422
generate_one_block  0.019042253494262695
generate_one_block  0.018775224685668945
generate_one_block  0.019176959991455078
generate_one_block  0.019275426864624023
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.056246280670166016
gen group dst list time:  0.023259878158569336
time for parepare:  0.020929574966430664
local_output_nid generation:  0.006138324737548828
local_in_edges_tensor generation:  0.039244651794433594
mini_batch_src_global generation:  0.01833629608154297
r_  generation:  0.15974068641662598
local_output_nid generation:  0.007827520370483398
local_in_edges_tensor generation:  0.011332988739013672
mini_batch_src_global generation:  0.028937816619873047
r_  generation:  0.17066073417663574
local_output_nid generation:  0.008963346481323242
local_in_edges_tensor generation:  0.03579306602478027
mini_batch_src_global generation:  0.024385452270507812
r_  generation:  0.17098116874694824
local_output_nid generation:  0.008097410202026367
local_in_edges_tensor generation:  0.010497331619262695
mini_batch_src_global generation:  0.021283864974975586
r_  generation:  0.17212653160095215
local_output_nid generation:  0.008429527282714844
local_in_edges_tensor generation:  0.010431766510009766
mini_batch_src_global generation:  0.020535707473754883
r_  generation:  0.17217612266540527
local_output_nid generation:  0.00905919075012207
local_in_edges_tensor generation:  0.010995626449584961
mini_batch_src_global generation:  0.023922204971313477
r_  generation:  0.18737053871154785
local_output_nid generation:  0.008744478225708008
local_in_edges_tensor generation:  0.012140035629272461
mini_batch_src_global generation:  0.021631240844726562
r_  generation:  0.1764848232269287
local_output_nid generation:  0.008739948272705078
local_in_edges_tensor generation:  0.009552955627441406
mini_batch_src_global generation:  0.021845579147338867
r_  generation:  0.175584077835083
local_output_nid generation:  0.008717775344848633
local_in_edges_tensor generation:  0.009605169296264648
mini_batch_src_global generation:  0.02294445037841797
r_  generation:  0.17927813529968262
local_output_nid generation:  0.009251832962036133
local_in_edges_tensor generation:  0.012944459915161133
mini_batch_src_global generation:  0.022961139678955078
r_  generation:  0.18599772453308105
local_output_nid generation:  0.00943136215209961
local_in_edges_tensor generation:  0.01308298110961914
mini_batch_src_global generation:  0.023227691650390625
r_  generation:  0.18951725959777832
local_output_nid generation:  0.00926661491394043
local_in_edges_tensor generation:  0.009879112243652344
mini_batch_src_global generation:  0.023019790649414062
r_  generation:  0.18320131301879883
local_output_nid generation:  0.009375572204589844
local_in_edges_tensor generation:  0.010903120040893555
mini_batch_src_global generation:  0.024646759033203125
r_  generation:  0.191880464553833
local_output_nid generation:  0.00926518440246582
local_in_edges_tensor generation:  0.011073112487792969
mini_batch_src_global generation:  0.0227813720703125
r_  generation:  0.18073487281799316
local_output_nid generation:  0.009067296981811523
local_in_edges_tensor generation:  0.009562492370605469
mini_batch_src_global generation:  0.02205634117126465
r_  generation:  0.17953968048095703
local_output_nid generation:  0.009226322174072266
local_in_edges_tensor generation:  0.01084756851196289
mini_batch_src_global generation:  0.022583961486816406
r_  generation:  0.18446779251098633
local_output_nid generation:  0.009218454360961914
local_in_edges_tensor generation:  0.010993242263793945
mini_batch_src_global generation:  0.022197961807250977
r_  generation:  0.18051552772521973
local_output_nid generation:  0.009158849716186523
local_in_edges_tensor generation:  0.009584665298461914
mini_batch_src_global generation:  0.022148609161376953
r_  generation:  0.17789816856384277
local_output_nid generation:  0.009052515029907227
local_in_edges_tensor generation:  0.012339353561401367
mini_batch_src_global generation:  0.022481918334960938
r_  generation:  0.1797926425933838
local_output_nid generation:  0.008668661117553711
local_in_edges_tensor generation:  0.009780645370483398
mini_batch_src_global generation:  0.022058963775634766
r_  generation:  0.1789860725402832
local_output_nid generation:  0.008694171905517578
local_in_edges_tensor generation:  0.009838342666625977
mini_batch_src_global generation:  0.022381067276000977
r_  generation:  0.18169856071472168
local_output_nid generation:  0.008866310119628906
local_in_edges_tensor generation:  0.012708187103271484
mini_batch_src_global generation:  0.0227203369140625
r_  generation:  0.18216300010681152
local_output_nid generation:  0.008998870849609375
local_in_edges_tensor generation:  0.013042688369750977
mini_batch_src_global generation:  0.02425098419189453
r_  generation:  0.18634796142578125
local_output_nid generation:  0.009043455123901367
local_in_edges_tensor generation:  0.013214826583862305
mini_batch_src_global generation:  0.023997783660888672
r_  generation:  0.1896364688873291
local_output_nid generation:  0.008903026580810547
local_in_edges_tensor generation:  0.009976387023925781
mini_batch_src_global generation:  0.02326226234436035
r_  generation:  0.18515229225158691
local_output_nid generation:  0.008776187896728516
local_in_edges_tensor generation:  0.009611845016479492
mini_batch_src_global generation:  0.022968769073486328
r_  generation:  0.18381714820861816
local_output_nid generation:  0.008931159973144531
local_in_edges_tensor generation:  0.011413335800170898
mini_batch_src_global generation:  0.024465084075927734
r_  generation:  0.18790292739868164
local_output_nid generation:  0.008751869201660156
local_in_edges_tensor generation:  0.009953737258911133
mini_batch_src_global generation:  0.022708654403686523
r_  generation:  0.17890477180480957
local_output_nid generation:  0.008879899978637695
local_in_edges_tensor generation:  0.011372089385986328
mini_batch_src_global generation:  0.022647380828857422
r_  generation:  0.18393349647521973
local_output_nid generation:  0.00884699821472168
local_in_edges_tensor generation:  0.01133584976196289
mini_batch_src_global generation:  0.02297234535217285
r_  generation:  0.18053603172302246
local_output_nid generation:  0.009039163589477539
local_in_edges_tensor generation:  0.011239051818847656
mini_batch_src_global generation:  0.02272963523864746
r_  generation:  0.18559765815734863
local_output_nid generation:  0.008924722671508789
local_in_edges_tensor generation:  0.012766599655151367
mini_batch_src_global generation:  0.023169755935668945
r_  generation:  0.18454337120056152
----------------------check_connections_block total spend ----------------------------- 8.541141748428345
generate_one_block  0.2522878646850586
generate_one_block  0.24383091926574707
generate_one_block  0.23833084106445312
generate_one_block  0.24410128593444824
generate_one_block  0.26050806045532227
generate_one_block  0.2674522399902344
generate_one_block  0.23807716369628906
generate_one_block  0.23936748504638672
generate_one_block  0.24865126609802246
generate_one_block  0.27173829078674316
generate_one_block  0.2639768123626709
generate_one_block  0.24449634552001953
generate_one_block  0.26900506019592285
generate_one_block  0.24303460121154785
generate_one_block  0.24359631538391113
generate_one_block  0.25038743019104004
generate_one_block  0.24373459815979004
generate_one_block  0.24417614936828613
generate_one_block  0.24275422096252441
generate_one_block  0.24276185035705566
generate_one_block  0.24564123153686523
generate_one_block  0.24893474578857422
generate_one_block  0.25614452362060547
generate_one_block  0.26046061515808105
generate_one_block  0.24851536750793457
generate_one_block  0.2455596923828125
generate_one_block  0.26094985008239746
generate_one_block  0.24445486068725586
generate_one_block  0.24590229988098145
generate_one_block  0.24657392501831055
generate_one_block  0.24879193305969238
generate_one_block  0.2525315284729004
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05513477325439453
gen group dst list time:  0.11491227149963379
time for parepare:  0.017612457275390625
local_output_nid generation:  0.025367259979248047
local_in_edges_tensor generation:  0.05259966850280762
mini_batch_src_global generation:  0.04885053634643555
r_  generation:  0.48290538787841797
local_output_nid generation:  0.03025531768798828
local_in_edges_tensor generation:  0.04701685905456543
mini_batch_src_global generation:  0.05878806114196777
r_  generation:  0.4828951358795166
local_output_nid generation:  0.029131412506103516
local_in_edges_tensor generation:  0.03859090805053711
mini_batch_src_global generation:  0.05642580986022949
r_  generation:  0.4906156063079834
local_output_nid generation:  0.028125524520874023
local_in_edges_tensor generation:  0.02985858917236328
mini_batch_src_global generation:  0.05973315238952637
r_  generation:  0.4854412078857422
local_output_nid generation:  0.028574705123901367
local_in_edges_tensor generation:  0.037789106369018555
mini_batch_src_global generation:  0.05672788619995117
r_  generation:  0.49690818786621094
local_output_nid generation:  0.028714418411254883
local_in_edges_tensor generation:  0.04340720176696777
mini_batch_src_global generation:  0.06276798248291016
r_  generation:  0.503166675567627
local_output_nid generation:  0.02862071990966797
local_in_edges_tensor generation:  0.034522294998168945
mini_batch_src_global generation:  0.0585784912109375
r_  generation:  0.5014162063598633
local_output_nid generation:  0.028873205184936523
local_in_edges_tensor generation:  0.029558897018432617
mini_batch_src_global generation:  0.06192207336425781
r_  generation:  0.4935910701751709
local_output_nid generation:  0.02927684783935547
local_in_edges_tensor generation:  0.04374408721923828
mini_batch_src_global generation:  0.06138134002685547
r_  generation:  0.5032594203948975
local_output_nid generation:  0.029667139053344727
local_in_edges_tensor generation:  0.029814720153808594
mini_batch_src_global generation:  0.06405353546142578
r_  generation:  0.5029125213623047
local_output_nid generation:  0.02945542335510254
local_in_edges_tensor generation:  0.039066314697265625
mini_batch_src_global generation:  0.058942556381225586
r_  generation:  0.5017116069793701
local_output_nid generation:  0.03183722496032715
local_in_edges_tensor generation:  0.03739213943481445
mini_batch_src_global generation:  0.05972003936767578
r_  generation:  0.4972248077392578
local_output_nid generation:  0.02918410301208496
local_in_edges_tensor generation:  0.030179262161254883
mini_batch_src_global generation:  0.057679176330566406
r_  generation:  0.5057835578918457
local_output_nid generation:  0.029079675674438477
local_in_edges_tensor generation:  0.030022621154785156
mini_batch_src_global generation:  0.05894160270690918
r_  generation:  0.49857354164123535
local_output_nid generation:  0.030183792114257812
local_in_edges_tensor generation:  0.03028273582458496
mini_batch_src_global generation:  0.05995488166809082
r_  generation:  0.4974327087402344
local_output_nid generation:  0.02924323081970215
local_in_edges_tensor generation:  0.034401655197143555
mini_batch_src_global generation:  0.0591585636138916
r_  generation:  0.49655652046203613
local_output_nid generation:  0.029104948043823242
local_in_edges_tensor generation:  0.04373359680175781
mini_batch_src_global generation:  0.05775952339172363
r_  generation:  0.5088381767272949
local_output_nid generation:  0.02921581268310547
local_in_edges_tensor generation:  0.03773641586303711
mini_batch_src_global generation:  0.06545472145080566
r_  generation:  0.4975566864013672
local_output_nid generation:  0.029308319091796875
local_in_edges_tensor generation:  0.03497743606567383
mini_batch_src_global generation:  0.057825565338134766
r_  generation:  0.4986567497253418
local_output_nid generation:  0.029183626174926758
local_in_edges_tensor generation:  0.03005194664001465
mini_batch_src_global generation:  0.060156822204589844
r_  generation:  0.5066277980804443
local_output_nid generation:  0.030159711837768555
local_in_edges_tensor generation:  0.03899264335632324
mini_batch_src_global generation:  0.05961799621582031
r_  generation:  0.5088553428649902
local_output_nid generation:  0.03083181381225586
local_in_edges_tensor generation:  0.04431939125061035
mini_batch_src_global generation:  0.058579206466674805
r_  generation:  0.5007574558258057
local_output_nid generation:  0.032166242599487305
local_in_edges_tensor generation:  0.034863948822021484
mini_batch_src_global generation:  0.06333255767822266
r_  generation:  0.5032522678375244
local_output_nid generation:  0.03090381622314453
local_in_edges_tensor generation:  0.03052067756652832
mini_batch_src_global generation:  0.059130191802978516
r_  generation:  0.5026144981384277
local_output_nid generation:  0.03021693229675293
local_in_edges_tensor generation:  0.03155064582824707
mini_batch_src_global generation:  0.058336734771728516
r_  generation:  0.503037691116333
local_output_nid generation:  0.030273914337158203
local_in_edges_tensor generation:  0.03514385223388672
mini_batch_src_global generation:  0.059156179428100586
r_  generation:  0.4970541000366211
local_output_nid generation:  0.0304257869720459
local_in_edges_tensor generation:  0.03891158103942871
mini_batch_src_global generation:  0.05807042121887207
r_  generation:  0.49973082542419434
local_output_nid generation:  0.030074119567871094
local_in_edges_tensor generation:  0.03424239158630371
mini_batch_src_global generation:  0.05894923210144043
r_  generation:  0.49498677253723145
local_output_nid generation:  0.02992868423461914
local_in_edges_tensor generation:  0.03400754928588867
mini_batch_src_global generation:  0.06125807762145996
r_  generation:  0.5004820823669434
local_output_nid generation:  0.030585050582885742
local_in_edges_tensor generation:  0.03512430191040039
mini_batch_src_global generation:  0.059942007064819336
r_  generation:  0.5168287754058838
local_output_nid generation:  0.030223608016967773
local_in_edges_tensor generation:  0.039624691009521484
mini_batch_src_global generation:  0.05879354476928711
r_  generation:  0.4982113838195801
local_output_nid generation:  0.02998495101928711
local_in_edges_tensor generation:  0.03411245346069336
mini_batch_src_global generation:  0.06370425224304199
r_  generation:  0.49842357635498047
----------------------check_connections_block total spend ----------------------------- 23.46291947364807
generate_one_block  0.7128946781158447
generate_one_block  0.688549280166626
generate_one_block  0.6766326427459717
generate_one_block  0.6710104942321777
generate_one_block  0.7767364978790283
generate_one_block  0.6880533695220947
generate_one_block  0.6665897369384766
generate_one_block  0.6836013793945312
generate_one_block  0.6846311092376709
generate_one_block  0.687631368637085
generate_one_block  0.6952238082885742
generate_one_block  0.6848995685577393
generate_one_block  0.6715874671936035
generate_one_block  0.6928060054779053
generate_one_block  0.7296156883239746
generate_one_block  0.6847074031829834
generate_one_block  0.6853909492492676
generate_one_block  0.6801080703735352
generate_one_block  0.7016255855560303
generate_one_block  0.6845145225524902
generate_one_block  0.6900038719177246
generate_one_block  0.7190394401550293
generate_one_block  0.7179758548736572
generate_one_block  0.7029216289520264
generate_one_block  0.7010703086853027
generate_one_block  0.6793644428253174
generate_one_block  0.678917646408081
generate_one_block  0.6849877834320068
generate_one_block  0.6848902702331543
generate_one_block  0.6787424087524414
generate_one_block  0.6786689758300781
generate_one_block  0.6805069446563721
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.13155651092529297  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

connection checking time:  32.004061222076416
block generation total time  30.140628576278687
average batch blocks generation time:  0.941894643008709
block dataloader generation time/epoch 66.18690609931946
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.10927772521972656  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150547, 128])
torch.Size([109518, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.635986804962158  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.10909080505371094  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150032, 128])
torch.Size([109780, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.733060359954834  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.10928630828857422  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150668, 128])
torch.Size([109822, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.53157949447632  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.10832357406616211  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([148781, 128])
torch.Size([107185, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.489784240722656  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.10901832580566406  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150260, 128])
torch.Size([108980, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 20.401466369628906  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8299560546875 GB
    Memory Allocated: 0.10940361022949219  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150076, 128])
torch.Size([109831, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 21.26513910293579  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10895729064941406  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149962, 128])
torch.Size([108931, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.56019401550293  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.1091909408569336  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150434, 128])
torch.Size([110388, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.540806770324707  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10955810546875  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([151002, 128])
torch.Size([110892, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.68637752532959  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10940122604370117  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150201, 128])
torch.Size([110752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 21.13315439224243  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10959482192993164  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150497, 128])
torch.Size([111090, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 21.2448148727417  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.1090536117553711  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149886, 128])
torch.Size([109454, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 20.788084506988525  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0447998046875 GB
    Memory Allocated: 0.10928535461425781  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149928, 128])
torch.Size([109874, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0760498046875 GB
    Memory Allocated: 21.203848361968994  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10906410217285156  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150206, 128])
torch.Size([109288, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.55342674255371  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10883331298828125  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149814, 128])
torch.Size([108934, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.469046115875244  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10937023162841797  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150554, 128])
torch.Size([109693, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.774385929107666  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10920143127441406  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150312, 128])
torch.Size([110319, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.660983085632324  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.1089019775390625  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149870, 128])
torch.Size([109251, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.54051923751831  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10889720916748047  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149902, 128])
torch.Size([108970, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.528106689453125  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10912656784057617  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150373, 128])
torch.Size([109687, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.50429916381836  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10921525955200195  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150445, 128])
torch.Size([109248, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.622965335845947  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10945558547973633  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150689, 128])
torch.Size([110682, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.763686656951904  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.1095123291015625  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150558, 128])
torch.Size([110712, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 21.00201177597046  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10935497283935547  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149970, 128])
torch.Size([110233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 21.26454210281372  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10947418212890625  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150570, 128])
torch.Size([110637, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.966137409210205  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10911417007446289  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149991, 128])
torch.Size([109849, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.799642086029053  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.1093297004699707  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150169, 128])
torch.Size([109707, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 21.052873611450195  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10927486419677734  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150494, 128])
torch.Size([110104, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.611894607543945  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10913658142089844  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150046, 128])
torch.Size([109499, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.808399200439453  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10938787460327148  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150669, 128])
torch.Size([110183, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.712209701538086  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10920095443725586  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([150231, 128])
torch.Size([109698, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.781364917755127  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 0.10909271240234375  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

torch.Size([149848, 128])
torch.Size([109491, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0780029296875 GB
    Memory Allocated: 20.88514757156372  GigaBytes
Max Memory Allocated: 21.448744297027588  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030291758477687836 |0.024285271763801575 |0.6518395990133286 |9.956210851669312e-05 |1.5421377792954445 |0.009002447128295898 |
----------------------------------------------------------pseudo_mini_loss sum 3.9562222957611084
Total (block generation + training)time/epoch 138.2237904071808
Training time/epoch 72.03661274909973
Training time without block to device /epoch 71.25948405265808
Training time without total dataloading part /epoch 70.21946454048157
load block tensor time/epoch 0.9693362712860107
block to device time/epoch 0.7771286964416504
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9159290
Number of first layer input nodes during this epoch:  4806985
