Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648468020.2437737
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027957677841186523
range selection method range initialization spend 0.01370096206665039
time for parepare:  0.018430709838867188
local_output_nid generation:  0.0027146339416503906
local_in_edges_tensor generation:  0.004891157150268555
mini_batch_src_global generation:  0.0038683414459228516
r_  generation:  0.04340791702270508
local_output_nid generation:  0.003130674362182617
local_in_edges_tensor generation:  0.0016589164733886719
mini_batch_src_global generation:  0.004961490631103516
r_  generation:  0.04349541664123535
local_output_nid generation:  0.003154754638671875
local_in_edges_tensor generation:  0.001678466796875
mini_batch_src_global generation:  0.003164052963256836
r_  generation:  0.04384660720825195
local_output_nid generation:  0.003209352493286133
local_in_edges_tensor generation:  0.00171661376953125
mini_batch_src_global generation:  0.003351449966430664
r_  generation:  0.04538416862487793
local_output_nid generation:  0.0031921863555908203
local_in_edges_tensor generation:  0.0016956329345703125
mini_batch_src_global generation:  0.003476858139038086
r_  generation:  0.0460357666015625
local_output_nid generation:  0.0032033920288085938
local_in_edges_tensor generation:  0.0017867088317871094
mini_batch_src_global generation:  0.0036585330963134766
r_  generation:  0.04726004600524902
local_output_nid generation:  0.0031473636627197266
local_in_edges_tensor generation:  0.0016989707946777344
mini_batch_src_global generation:  0.0036869049072265625
r_  generation:  0.04720354080200195
local_output_nid generation:  0.003170013427734375
local_in_edges_tensor generation:  0.0017502307891845703
mini_batch_src_global generation:  0.003871440887451172
r_  generation:  0.04832768440246582
----------------------check_connections_block total spend ----------------------------- 0.5318202972412109
generate_one_block  0.061580657958984375
generate_one_block  0.06170010566711426
generate_one_block  0.0605618953704834
generate_one_block  0.061350107192993164
generate_one_block  0.06299424171447754
generate_one_block  0.0619359016418457
generate_one_block  0.06155061721801758
generate_one_block  0.06344437599182129
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0439300537109375
gen group dst list time:  0.01670360565185547
time for parepare:  0.019989013671875
local_output_nid generation:  0.011849403381347656
local_in_edges_tensor generation:  0.03230619430541992
mini_batch_src_global generation:  0.034364938735961914
r_  generation:  0.3575153350830078
local_output_nid generation:  0.0200197696685791
local_in_edges_tensor generation:  0.03323554992675781
mini_batch_src_global generation:  0.044477224349975586
r_  generation:  0.37773895263671875
local_output_nid generation:  0.020522117614746094
local_in_edges_tensor generation:  0.023415327072143555
mini_batch_src_global generation:  0.044118642807006836
r_  generation:  0.37244558334350586
local_output_nid generation:  0.021187305450439453
local_in_edges_tensor generation:  0.023940563201904297
mini_batch_src_global generation:  0.04499459266662598
r_  generation:  0.3780653476715088
local_output_nid generation:  0.02134084701538086
local_in_edges_tensor generation:  0.027591705322265625
mini_batch_src_global generation:  0.04521989822387695
r_  generation:  0.3789536952972412
local_output_nid generation:  0.02153944969177246
local_in_edges_tensor generation:  0.03248286247253418
mini_batch_src_global generation:  0.049401044845581055
r_  generation:  0.38855910301208496
local_output_nid generation:  0.021597862243652344
local_in_edges_tensor generation:  0.021756649017333984
mini_batch_src_global generation:  0.046233415603637695
r_  generation:  0.3904566764831543
local_output_nid generation:  0.02203679084777832
local_in_edges_tensor generation:  0.024380922317504883
mini_batch_src_global generation:  0.04961729049682617
r_  generation:  0.38484764099121094
----------------------check_connections_block total spend ----------------------------- 4.422290086746216
generate_one_block  0.49659061431884766
generate_one_block  0.4945526123046875
generate_one_block  0.49591755867004395
generate_one_block  0.4962286949157715
generate_one_block  0.49705052375793457
generate_one_block  0.5310122966766357
generate_one_block  0.4994223117828369
generate_one_block  0.5089423656463623
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03746175765991211
gen group dst list time:  0.037305593490600586
time for parepare:  0.01947307586669922
local_output_nid generation:  0.025704622268676758
local_in_edges_tensor generation:  0.04483461380004883
mini_batch_src_global generation:  0.052278757095336914
r_  generation:  0.5561039447784424
local_output_nid generation:  0.032932281494140625
local_in_edges_tensor generation:  0.055516719818115234
mini_batch_src_global generation:  0.06449723243713379
r_  generation:  0.5562899112701416
local_output_nid generation:  0.03374814987182617
local_in_edges_tensor generation:  0.04204893112182617
mini_batch_src_global generation:  0.06167149543762207
r_  generation:  0.5694506168365479
local_output_nid generation:  0.0358281135559082
local_in_edges_tensor generation:  0.04869556427001953
mini_batch_src_global generation:  0.06669116020202637
r_  generation:  0.5694057941436768
local_output_nid generation:  0.03465676307678223
local_in_edges_tensor generation:  0.055762529373168945
mini_batch_src_global generation:  0.06199312210083008
r_  generation:  0.5694952011108398
local_output_nid generation:  0.03831124305725098
local_in_edges_tensor generation:  0.04546213150024414
mini_batch_src_global generation:  0.06843090057373047
r_  generation:  0.570965051651001
local_output_nid generation:  0.03495311737060547
local_in_edges_tensor generation:  0.051911115646362305
mini_batch_src_global generation:  0.0791628360748291
r_  generation:  0.5748307704925537
local_output_nid generation:  0.03553438186645508
local_in_edges_tensor generation:  0.03497147560119629
mini_batch_src_global generation:  0.06682157516479492
r_  generation:  0.5755867958068848
----------------------check_connections_block total spend ----------------------------- 6.743494033813477
generate_one_block  0.7233970165252686
generate_one_block  0.7130908966064453
generate_one_block  0.7185771465301514
generate_one_block  0.7258892059326172
generate_one_block  0.7350425720214844
generate_one_block  0.7358012199401855
generate_one_block  0.744549036026001
generate_one_block  0.7174561023712158
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  11.165784120559692
block generation total time  9.83352017402649
average batch blocks generation time:  1.2291900217533112
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10201454162597656  GigaBytes
Max Memory Allocated: 0.10201454162597656  GigaBytes

torch.Size([162568, 128])
torch.Size([145665, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3123779296875 GB
    Memory Allocated: 15.847937107086182  GigaBytes
Max Memory Allocated: 15.862296104431152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3280029296875 GB
    Memory Allocated: 0.10482931137084961  GigaBytes
Max Memory Allocated: 15.862296104431152  GigaBytes

torch.Size([162516, 128])
torch.Size([145851, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 15.914551258087158  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 0.10544252395629883  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

torch.Size([162473, 128])
torch.Size([145490, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 15.876315593719482  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 0.10486316680908203  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

torch.Size([162601, 128])
torch.Size([145754, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 15.875726699829102  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 0.10544729232788086  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

torch.Size([162673, 128])
torch.Size([145938, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 15.886725425720215  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1912841796875 GB
    Memory Allocated: 0.10490751266479492  GigaBytes
Max Memory Allocated: 15.930464267730713  GigaBytes

torch.Size([162662, 128])
torch.Size([146045, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.951562881469727  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10546064376831055  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162464, 128])
torch.Size([145967, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.929474830627441  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.1048588752746582  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162522, 128])
torch.Size([145903, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.938557624816895  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034216612577438354 |0.061946362257003784 |0.7752075791358948 |0.00012570619583129883 |1.4760088920593262 |0.014577865600585938 |
----------------------------------------------------------pseudo_mini_loss sum 4.3970842361450195
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3056184
Number of first layer input nodes during this epoch:  1300479
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.14224672317504883  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026407957077026367
range selection method range initialization spend 0.012064456939697266
time for parepare:  0.017380237579345703
local_output_nid generation:  0.0032062530517578125
local_in_edges_tensor generation:  0.0048868656158447266
mini_batch_src_global generation:  0.003783702850341797
r_  generation:  0.04350781440734863
local_output_nid generation:  0.0035233497619628906
local_in_edges_tensor generation:  0.0019440650939941406
mini_batch_src_global generation:  0.004776477813720703
r_  generation:  0.044602155685424805
local_output_nid generation:  0.0034835338592529297
local_in_edges_tensor generation:  0.0018854141235351562
mini_batch_src_global generation:  0.004438638687133789
r_  generation:  0.05234813690185547
local_output_nid generation:  0.004056692123413086
local_in_edges_tensor generation:  0.001973867416381836
mini_batch_src_global generation:  0.004059553146362305
r_  generation:  0.048467397689819336
local_output_nid generation:  0.003994941711425781
local_in_edges_tensor generation:  0.0018579959869384766
mini_batch_src_global generation:  0.00420379638671875
r_  generation:  0.049120187759399414
local_output_nid generation:  0.003966331481933594
local_in_edges_tensor generation:  0.0019061565399169922
mini_batch_src_global generation:  0.004606723785400391
r_  generation:  0.057430267333984375
local_output_nid generation:  0.0048274993896484375
local_in_edges_tensor generation:  0.0018825531005859375
mini_batch_src_global generation:  0.004679203033447266
r_  generation:  0.07570075988769531
local_output_nid generation:  0.004985332489013672
local_in_edges_tensor generation:  0.002313852310180664
mini_batch_src_global generation:  0.004706382751464844
r_  generation:  0.05119585990905762
----------------------check_connections_block total spend ----------------------------- 0.6216568946838379
generate_one_block  0.10172605514526367
generate_one_block  0.0776374340057373
generate_one_block  0.07573509216308594
generate_one_block  0.07637882232666016
generate_one_block  0.07638406753540039
generate_one_block  0.07762527465820312
generate_one_block  0.08097672462463379
generate_one_block  0.0787353515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043006181716918945
gen group dst list time:  0.017060518264770508
time for parepare:  0.01971125602722168
local_output_nid generation:  0.013036012649536133
local_in_edges_tensor generation:  0.0463261604309082
mini_batch_src_global generation:  0.03853487968444824
r_  generation:  0.367084264755249
local_output_nid generation:  0.018315792083740234
local_in_edges_tensor generation:  0.037801265716552734
mini_batch_src_global generation:  0.04491162300109863
r_  generation:  0.3736908435821533
local_output_nid generation:  0.018355369567871094
local_in_edges_tensor generation:  0.02884507179260254
mini_batch_src_global generation:  0.04366707801818848
r_  generation:  0.3777024745941162
local_output_nid generation:  0.021280765533447266
local_in_edges_tensor generation:  0.028665781021118164
mini_batch_src_global generation:  0.04497265815734863
r_  generation:  0.3846709728240967
local_output_nid generation:  0.019237518310546875
local_in_edges_tensor generation:  0.02556443214416504
mini_batch_src_global generation:  0.04861569404602051
r_  generation:  0.3902902603149414
local_output_nid generation:  0.01933884620666504
local_in_edges_tensor generation:  0.025553226470947266
mini_batch_src_global generation:  0.04698348045349121
r_  generation:  0.3954277038574219
local_output_nid generation:  0.022813081741333008
local_in_edges_tensor generation:  0.0352175235748291
mini_batch_src_global generation:  0.04718279838562012
r_  generation:  0.4138922691345215
local_output_nid generation:  0.022862672805786133
local_in_edges_tensor generation:  0.03330373764038086
mini_batch_src_global generation:  0.05010533332824707
r_  generation:  0.3845796585083008
----------------------check_connections_block total spend ----------------------------- 4.540306568145752
generate_one_block  0.5481038093566895
generate_one_block  0.5238783359527588
generate_one_block  0.5776181221008301
generate_one_block  0.5892784595489502
generate_one_block  0.5688250064849854
generate_one_block  0.5365016460418701
generate_one_block  0.5314805507659912
generate_one_block  0.5601866245269775
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04923391342163086
gen group dst list time:  0.039343833923339844
time for parepare:  0.01985001564025879
local_output_nid generation:  0.02930450439453125
local_in_edges_tensor generation:  0.07106518745422363
mini_batch_src_global generation:  0.05529642105102539
r_  generation:  0.553755521774292
local_output_nid generation:  0.03440046310424805
local_in_edges_tensor generation:  0.05274653434753418
mini_batch_src_global generation:  0.06321167945861816
r_  generation:  0.5775852203369141
local_output_nid generation:  0.038333892822265625
local_in_edges_tensor generation:  0.05653810501098633
mini_batch_src_global generation:  0.07669186592102051
r_  generation:  0.5633533000946045
local_output_nid generation:  0.03552865982055664
local_in_edges_tensor generation:  0.0430905818939209
mini_batch_src_global generation:  0.060692548751831055
r_  generation:  0.5800154209136963
local_output_nid generation:  0.03652358055114746
local_in_edges_tensor generation:  0.03911328315734863
mini_batch_src_global generation:  0.06507468223571777
r_  generation:  0.5786457061767578
local_output_nid generation:  0.036176204681396484
local_in_edges_tensor generation:  0.03991985321044922
mini_batch_src_global generation:  0.06555652618408203
r_  generation:  0.5695478916168213
local_output_nid generation:  0.03733229637145996
local_in_edges_tensor generation:  0.050917863845825195
mini_batch_src_global generation:  0.06323432922363281
r_  generation:  0.5767488479614258
local_output_nid generation:  0.03636765480041504
local_in_edges_tensor generation:  0.038515567779541016
mini_batch_src_global generation:  0.0645895004272461
r_  generation:  0.572514533996582
----------------------check_connections_block total spend ----------------------------- 6.7814719676971436
generate_one_block  0.7795789241790771
generate_one_block  0.7712554931640625
generate_one_block  0.7578589916229248
generate_one_block  0.7371041774749756
generate_one_block  0.7515146732330322
generate_one_block  0.758561372756958
generate_one_block  0.7744410037994385
generate_one_block  0.7623989582061768
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.14224672317504883  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

connection checking time:  11.321778535842896
block generation total time  10.528586149215698
average batch blocks generation time:  1.3160732686519623
block dataloader generation time/epoch 24.621572971343994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10667133331298828  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162651, 128])
torch.Size([146137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.908114910125732  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10612678527832031  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162721, 128])
torch.Size([146016, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.912934303283691  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10665369033813477  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162666, 128])
torch.Size([146227, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.90044355392456  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10598087310791016  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162401, 128])
torch.Size([145676, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.893921375274658  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10666799545288086  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162738, 128])
torch.Size([146061, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.916648387908936  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10616588592529297  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162753, 128])
torch.Size([146075, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.930391311645508  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.1066737174987793  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162707, 128])
torch.Size([146162, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.927677154541016  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 0.10616445541381836  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

torch.Size([162748, 128])
torch.Size([146212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2108154296875 GB
    Memory Allocated: 15.94136381149292  GigaBytes
Max Memory Allocated: 15.967613220214844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031423091888427734 |0.030628889799118042 |0.6659924685955048 |0.00011563301086425781 |1.3329496681690216 |0.004783153533935547 |
----------------------------------------------------------pseudo_mini_loss sum 3.7033097743988037
Total (block generation + training)time/epoch 41.15066838264465
Training time/epoch 16.528826236724854
Training time without block to device /epoch 16.28379511833191
Training time without total dataloading part /epoch 15.99724531173706
load block tensor time/epoch 0.2513847351074219
block to device time/epoch 0.24503111839294434
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3059947
Number of first layer input nodes during this epoch:  1301385
