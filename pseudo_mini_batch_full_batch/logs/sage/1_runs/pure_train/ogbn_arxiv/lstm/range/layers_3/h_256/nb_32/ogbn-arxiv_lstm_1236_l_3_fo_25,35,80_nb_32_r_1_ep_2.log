Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648475787.6610668
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.027921676635742188
range selection method range initialization spend 0.01328420639038086
time for parepare:  0.017925262451171875
local_output_nid generation:  0.0006895065307617188
local_in_edges_tensor generation:  0.004023551940917969
mini_batch_src_global generation:  0.0014722347259521484
r_  generation:  0.010671615600585938
local_output_nid generation:  0.00074005126953125
local_in_edges_tensor generation:  0.000576019287109375
mini_batch_src_global generation:  0.0015048980712890625
r_  generation:  0.009838342666625977
local_output_nid generation:  0.0007405281066894531
local_in_edges_tensor generation:  0.0005121231079101562
mini_batch_src_global generation:  0.0009672641754150391
r_  generation:  0.00930333137512207
local_output_nid generation:  0.0007331371307373047
local_in_edges_tensor generation:  0.0005137920379638672
mini_batch_src_global generation:  0.0008890628814697266
r_  generation:  0.008676290512084961
local_output_nid generation:  0.0007190704345703125
local_in_edges_tensor generation:  0.0004892349243164062
mini_batch_src_global generation:  0.0008862018585205078
r_  generation:  0.009332656860351562
local_output_nid generation:  0.0007517337799072266
local_in_edges_tensor generation:  0.0005321502685546875
mini_batch_src_global generation:  0.0009164810180664062
r_  generation:  0.00943446159362793
local_output_nid generation:  0.0007379055023193359
local_in_edges_tensor generation:  0.00048041343688964844
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.009474754333496094
local_output_nid generation:  0.0007410049438476562
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.001050710678100586
r_  generation:  0.009911537170410156
local_output_nid generation:  0.0007402896881103516
local_in_edges_tensor generation:  0.00047469139099121094
mini_batch_src_global generation:  0.0009257793426513672
r_  generation:  0.00958704948425293
local_output_nid generation:  0.00074005126953125
local_in_edges_tensor generation:  0.00047707557678222656
mini_batch_src_global generation:  0.0009520053863525391
r_  generation:  0.009926557540893555
local_output_nid generation:  0.0007359981536865234
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0010259151458740234
r_  generation:  0.009986162185668945
local_output_nid generation:  0.0007395744323730469
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0010268688201904297
r_  generation:  0.01020956039428711
local_output_nid generation:  0.0007407665252685547
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0009801387786865234
r_  generation:  0.010150909423828125
local_output_nid generation:  0.0007956027984619141
local_in_edges_tensor generation:  0.000484466552734375
mini_batch_src_global generation:  0.0010225772857666016
r_  generation:  0.010347127914428711
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.010355472564697266
local_output_nid generation:  0.0007617473602294922
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0010104179382324219
r_  generation:  0.009733915328979492
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0004715919494628906
mini_batch_src_global generation:  0.0009701251983642578
r_  generation:  0.00968623161315918
local_output_nid generation:  0.0007543563842773438
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0010635852813720703
r_  generation:  0.010299205780029297
local_output_nid generation:  0.0007529258728027344
local_in_edges_tensor generation:  0.0004742145538330078
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.010001897811889648
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.001064300537109375
r_  generation:  0.009908437728881836
local_output_nid generation:  0.0007746219635009766
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.001016378402709961
r_  generation:  0.009870290756225586
local_output_nid generation:  0.0007441043853759766
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0010137557983398438
r_  generation:  0.010176420211791992
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.00977468490600586
local_output_nid generation:  0.0007839202880859375
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.0009446144104003906
r_  generation:  0.00959324836730957
local_output_nid generation:  0.0007445812225341797
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0010080337524414062
r_  generation:  0.010195016860961914
local_output_nid generation:  0.0007548332214355469
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0010075569152832031
r_  generation:  0.010336875915527344
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.001035451889038086
r_  generation:  0.009734392166137695
local_output_nid generation:  0.0007431507110595703
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0010113716125488281
r_  generation:  0.009989500045776367
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0010447502136230469
r_  generation:  0.010166406631469727
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0041844844818115234
mini_batch_src_global generation:  0.0012004375457763672
r_  generation:  0.009764432907104492
local_output_nid generation:  0.0007884502410888672
local_in_edges_tensor generation:  0.0005118846893310547
mini_batch_src_global generation:  0.0010704994201660156
r_  generation:  0.009572267532348633
local_output_nid generation:  0.0007772445678710938
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.001092672348022461
r_  generation:  0.010310888290405273
----------------------check_connections_block total spend ----------------------------- 0.48636865615844727
generate_one_block  0.01579594612121582
generate_one_block  0.015221118927001953
generate_one_block  0.0146636962890625
generate_one_block  0.013869047164916992
generate_one_block  0.01471567153930664
generate_one_block  0.014419317245483398
generate_one_block  0.014469146728515625
generate_one_block  0.015329599380493164
generate_one_block  0.01467275619506836
generate_one_block  0.014984846115112305
generate_one_block  0.015156745910644531
generate_one_block  0.01510000228881836
generate_one_block  0.014937639236450195
generate_one_block  0.015404224395751953
generate_one_block  0.015585184097290039
generate_one_block  0.014515399932861328
generate_one_block  0.014251947402954102
generate_one_block  0.015591144561767578
generate_one_block  0.014572858810424805
generate_one_block  0.014544963836669922
generate_one_block  0.014816522598266602
generate_one_block  0.01510167121887207
generate_one_block  0.01439356803894043
generate_one_block  0.014086246490478516
generate_one_block  0.015073299407958984
generate_one_block  0.014806747436523438
generate_one_block  0.014549493789672852
generate_one_block  0.015012502670288086
generate_one_block  0.015055656433105469
generate_one_block  0.014311075210571289
generate_one_block  0.01446223258972168
generate_one_block  0.015135049819946289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04033517837524414
gen group dst list time:  0.02327418327331543
time for parepare:  0.01949930191040039
local_output_nid generation:  0.004236698150634766
local_in_edges_tensor generation:  0.012376070022583008
mini_batch_src_global generation:  0.013742208480834961
r_  generation:  0.13474321365356445
local_output_nid generation:  0.008188009262084961
local_in_edges_tensor generation:  0.012528181076049805
mini_batch_src_global generation:  0.016588687896728516
r_  generation:  0.14002370834350586
local_output_nid generation:  0.008335113525390625
local_in_edges_tensor generation:  0.008152484893798828
mini_batch_src_global generation:  0.015172958374023438
r_  generation:  0.1435692310333252
local_output_nid generation:  0.008036613464355469
local_in_edges_tensor generation:  0.008823633193969727
mini_batch_src_global generation:  0.019347429275512695
r_  generation:  0.13650274276733398
local_output_nid generation:  0.008480072021484375
local_in_edges_tensor generation:  0.010265350341796875
mini_batch_src_global generation:  0.01658916473388672
r_  generation:  0.1466388702392578
local_output_nid generation:  0.008438825607299805
local_in_edges_tensor generation:  0.009306192398071289
mini_batch_src_global generation:  0.017296314239501953
r_  generation:  0.14240789413452148
local_output_nid generation:  0.008632183074951172
local_in_edges_tensor generation:  0.009074211120605469
mini_batch_src_global generation:  0.01743602752685547
r_  generation:  0.14443707466125488
local_output_nid generation:  0.009151935577392578
local_in_edges_tensor generation:  0.00973200798034668
mini_batch_src_global generation:  0.019323110580444336
r_  generation:  0.1510913372039795
local_output_nid generation:  0.008716344833374023
local_in_edges_tensor generation:  0.009659290313720703
mini_batch_src_global generation:  0.017697811126708984
r_  generation:  0.14756321907043457
local_output_nid generation:  0.008985757827758789
local_in_edges_tensor generation:  0.009628772735595703
mini_batch_src_global generation:  0.018509626388549805
r_  generation:  0.14863944053649902
local_output_nid generation:  0.009144783020019531
local_in_edges_tensor generation:  0.010878324508666992
mini_batch_src_global generation:  0.01841878890991211
r_  generation:  0.15284419059753418
local_output_nid generation:  0.009320974349975586
local_in_edges_tensor generation:  0.008637666702270508
mini_batch_src_global generation:  0.018820524215698242
r_  generation:  0.15118074417114258
local_output_nid generation:  0.009127140045166016
local_in_edges_tensor generation:  0.009789228439331055
mini_batch_src_global generation:  0.01851630210876465
r_  generation:  0.15015554428100586
local_output_nid generation:  0.009243011474609375
local_in_edges_tensor generation:  0.009553670883178711
mini_batch_src_global generation:  0.019175291061401367
r_  generation:  0.15190696716308594
local_output_nid generation:  0.00951385498046875
local_in_edges_tensor generation:  0.012378692626953125
mini_batch_src_global generation:  0.020346879959106445
r_  generation:  0.1574857234954834
local_output_nid generation:  0.009010553359985352
local_in_edges_tensor generation:  0.00816035270690918
mini_batch_src_global generation:  0.018375635147094727
r_  generation:  0.1472938060760498
local_output_nid generation:  0.009011983871459961
local_in_edges_tensor generation:  0.009120702743530273
mini_batch_src_global generation:  0.018071413040161133
r_  generation:  0.14556121826171875
local_output_nid generation:  0.009682893753051758
local_in_edges_tensor generation:  0.010261774063110352
mini_batch_src_global generation:  0.02002739906311035
r_  generation:  0.1547095775604248
local_output_nid generation:  0.0091552734375
local_in_edges_tensor generation:  0.012229681015014648
mini_batch_src_global generation:  0.01900315284729004
r_  generation:  0.15009355545043945
local_output_nid generation:  0.009205818176269531
local_in_edges_tensor generation:  0.008415460586547852
mini_batch_src_global generation:  0.01958775520324707
r_  generation:  0.14735794067382812
local_output_nid generation:  0.009314298629760742
local_in_edges_tensor generation:  0.011036872863769531
mini_batch_src_global generation:  0.019511938095092773
r_  generation:  0.1496295928955078
local_output_nid generation:  0.009449243545532227
local_in_edges_tensor generation:  0.009884357452392578
mini_batch_src_global generation:  0.01932358741760254
r_  generation:  0.153700590133667
local_output_nid generation:  0.00909733772277832
local_in_edges_tensor generation:  0.008787393569946289
mini_batch_src_global generation:  0.02120232582092285
r_  generation:  0.14980196952819824
local_output_nid generation:  0.010189056396484375
local_in_edges_tensor generation:  0.021068572998046875
mini_batch_src_global generation:  0.02223801612854004
r_  generation:  0.15296006202697754
local_output_nid generation:  0.009873628616333008
local_in_edges_tensor generation:  0.011154413223266602
mini_batch_src_global generation:  0.020801305770874023
r_  generation:  0.15528297424316406
local_output_nid generation:  0.00774073600769043
local_in_edges_tensor generation:  0.011058568954467773
mini_batch_src_global generation:  0.018422603607177734
r_  generation:  0.15021610260009766
local_output_nid generation:  0.007761716842651367
local_in_edges_tensor generation:  0.008109331130981445
mini_batch_src_global generation:  0.018755435943603516
r_  generation:  0.14911699295043945
local_output_nid generation:  0.007894515991210938
local_in_edges_tensor generation:  0.009197235107421875
mini_batch_src_global generation:  0.018526792526245117
r_  generation:  0.1518549919128418
local_output_nid generation:  0.008019685745239258
local_in_edges_tensor generation:  0.009435176849365234
mini_batch_src_global generation:  0.018556833267211914
r_  generation:  0.15077781677246094
local_output_nid generation:  0.007707357406616211
local_in_edges_tensor generation:  0.008027791976928711
mini_batch_src_global generation:  0.017907381057739258
r_  generation:  0.14581298828125
local_output_nid generation:  0.007768154144287109
local_in_edges_tensor generation:  0.009068012237548828
mini_batch_src_global generation:  0.017797231674194336
r_  generation:  0.1489396095275879
local_output_nid generation:  0.008263111114501953
local_in_edges_tensor generation:  0.010637044906616211
mini_batch_src_global generation:  0.019779205322265625
r_  generation:  0.15328311920166016
----------------------check_connections_block total spend ----------------------------- 7.101256608963013
generate_one_block  0.19530725479125977
generate_one_block  0.18612241744995117
generate_one_block  0.21692728996276855
generate_one_block  0.1768474578857422
generate_one_block  0.19161415100097656
generate_one_block  0.2055361270904541
generate_one_block  0.18554997444152832
generate_one_block  0.20244956016540527
generate_one_block  0.1900186538696289
generate_one_block  0.1942451000213623
generate_one_block  0.1954798698425293
generate_one_block  0.19579696655273438
generate_one_block  0.19021034240722656
generate_one_block  0.19570016860961914
generate_one_block  0.2318742275238037
generate_one_block  0.21474075317382812
generate_one_block  0.1805706024169922
generate_one_block  0.1992201805114746
generate_one_block  0.18710780143737793
generate_one_block  0.1897122859954834
generate_one_block  0.19051766395568848
generate_one_block  0.19940900802612305
generate_one_block  0.18181300163269043
generate_one_block  0.18067073822021484
generate_one_block  0.19419288635253906
generate_one_block  0.1890859603881836
generate_one_block  0.18448185920715332
generate_one_block  0.19488906860351562
generate_one_block  0.19309663772583008
generate_one_block  0.18195366859436035
generate_one_block  0.1843109130859375
generate_one_block  0.19581961631774902
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.12304258346557617
gen group dst list time:  0.11706256866455078
time for parepare:  0.021765947341918945
local_output_nid generation:  0.021158933639526367
local_in_edges_tensor generation:  0.04299592971801758
mini_batch_src_global generation:  0.03980660438537598
r_  generation:  0.38983798027038574
local_output_nid generation:  0.02654862403869629
local_in_edges_tensor generation:  0.040258169174194336
mini_batch_src_global generation:  0.04879927635192871
r_  generation:  0.4019029140472412
local_output_nid generation:  0.026866912841796875
local_in_edges_tensor generation:  0.0371396541595459
mini_batch_src_global generation:  0.048574209213256836
r_  generation:  0.40874814987182617
local_output_nid generation:  0.024965286254882812
local_in_edges_tensor generation:  0.025867462158203125
mini_batch_src_global generation:  0.049184322357177734
r_  generation:  0.39925384521484375
local_output_nid generation:  0.025474071502685547
local_in_edges_tensor generation:  0.029513835906982422
mini_batch_src_global generation:  0.06126141548156738
r_  generation:  0.409135103225708
local_output_nid generation:  0.025578737258911133
local_in_edges_tensor generation:  0.02963852882385254
mini_batch_src_global generation:  0.04976606369018555
r_  generation:  0.4071352481842041
local_output_nid generation:  0.026127338409423828
local_in_edges_tensor generation:  0.0293271541595459
mini_batch_src_global generation:  0.04706740379333496
r_  generation:  0.4064629077911377
local_output_nid generation:  0.02649235725402832
local_in_edges_tensor generation:  0.03110337257385254
mini_batch_src_global generation:  0.048592329025268555
r_  generation:  0.4108541011810303
local_output_nid generation:  0.026102304458618164
local_in_edges_tensor generation:  0.03354191780090332
mini_batch_src_global generation:  0.04778599739074707
r_  generation:  0.4087564945220947
local_output_nid generation:  0.02616143226623535
local_in_edges_tensor generation:  0.029819726943969727
mini_batch_src_global generation:  0.04829668998718262
r_  generation:  0.40505433082580566
local_output_nid generation:  0.02625727653503418
local_in_edges_tensor generation:  0.03348493576049805
mini_batch_src_global generation:  0.04750990867614746
r_  generation:  0.41319751739501953
local_output_nid generation:  0.02653956413269043
local_in_edges_tensor generation:  0.03412222862243652
mini_batch_src_global generation:  0.05125927925109863
r_  generation:  0.4131636619567871
local_output_nid generation:  0.027193546295166016
local_in_edges_tensor generation:  0.03214573860168457
mini_batch_src_global generation:  0.05974006652832031
r_  generation:  0.41576218605041504
local_output_nid generation:  0.02923274040222168
local_in_edges_tensor generation:  0.03390693664550781
mini_batch_src_global generation:  0.05154013633728027
r_  generation:  0.4074132442474365
local_output_nid generation:  0.027131319046020508
local_in_edges_tensor generation:  0.03423714637756348
mini_batch_src_global generation:  0.04821920394897461
r_  generation:  0.4118471145629883
local_output_nid generation:  0.026735305786132812
local_in_edges_tensor generation:  0.028066635131835938
mini_batch_src_global generation:  0.061113834381103516
r_  generation:  0.4024472236633301
local_output_nid generation:  0.026845455169677734
local_in_edges_tensor generation:  0.02673053741455078
mini_batch_src_global generation:  0.0479736328125
r_  generation:  0.41063523292541504
local_output_nid generation:  0.027170419692993164
local_in_edges_tensor generation:  0.0453944206237793
mini_batch_src_global generation:  0.05224800109863281
r_  generation:  0.42826032638549805
local_output_nid generation:  0.02849268913269043
local_in_edges_tensor generation:  0.03450345993041992
mini_batch_src_global generation:  0.05207014083862305
r_  generation:  0.4130270481109619
local_output_nid generation:  0.02829456329345703
local_in_edges_tensor generation:  0.030015230178833008
mini_batch_src_global generation:  0.04825711250305176
r_  generation:  0.4024012088775635
local_output_nid generation:  0.02704000473022461
local_in_edges_tensor generation:  0.028122901916503906
mini_batch_src_global generation:  0.050542593002319336
r_  generation:  0.41222047805786133
local_output_nid generation:  0.027601003646850586
local_in_edges_tensor generation:  0.03259682655334473
mini_batch_src_global generation:  0.048436880111694336
r_  generation:  0.41077208518981934
local_output_nid generation:  0.02678394317626953
local_in_edges_tensor generation:  0.02460026741027832
mini_batch_src_global generation:  0.04740190505981445
r_  generation:  0.4072568416595459
local_output_nid generation:  0.026824235916137695
local_in_edges_tensor generation:  0.02451777458190918
mini_batch_src_global generation:  0.04765582084655762
r_  generation:  0.4026825428009033
local_output_nid generation:  0.027070283889770508
local_in_edges_tensor generation:  0.0279693603515625
mini_batch_src_global generation:  0.04792070388793945
r_  generation:  0.41365575790405273
local_output_nid generation:  0.02675318717956543
local_in_edges_tensor generation:  0.02822566032409668
mini_batch_src_global generation:  0.06766867637634277
r_  generation:  0.4044666290283203
local_output_nid generation:  0.02693772315979004
local_in_edges_tensor generation:  0.0281522274017334
mini_batch_src_global generation:  0.05400800704956055
r_  generation:  0.48506665229797363
local_output_nid generation:  0.028177499771118164
local_in_edges_tensor generation:  0.03366899490356445
mini_batch_src_global generation:  0.0689690113067627
r_  generation:  0.4396076202392578
local_output_nid generation:  0.03148388862609863
local_in_edges_tensor generation:  0.034957170486450195
mini_batch_src_global generation:  0.04890727996826172
r_  generation:  0.41683220863342285
local_output_nid generation:  0.02724623680114746
local_in_edges_tensor generation:  0.029979467391967773
mini_batch_src_global generation:  0.04861807823181152
r_  generation:  0.41016697883605957
local_output_nid generation:  0.02723383903503418
local_in_edges_tensor generation:  0.02480483055114746
mini_batch_src_global generation:  0.050554752349853516
r_  generation:  0.414539098739624
local_output_nid generation:  0.027473926544189453
local_in_edges_tensor generation:  0.028783559799194336
mini_batch_src_global generation:  0.0513606071472168
r_  generation:  0.41294050216674805
----------------------check_connections_block total spend ----------------------------- 19.62178897857666
generate_one_block  0.6430881023406982
generate_one_block  0.5455789566040039
generate_one_block  0.5386288166046143
generate_one_block  0.5388920307159424
generate_one_block  0.5375466346740723
generate_one_block  0.5194010734558105
generate_one_block  0.5222227573394775
generate_one_block  0.5393002033233643
generate_one_block  0.5215151309967041
generate_one_block  0.5377757549285889
generate_one_block  0.5300145149230957
generate_one_block  0.5425305366516113
generate_one_block  0.5215823650360107
generate_one_block  0.536090612411499
generate_one_block  0.5364539623260498
generate_one_block  0.5326988697052002
generate_one_block  0.5255444049835205
generate_one_block  0.5424332618713379
generate_one_block  0.5196118354797363
generate_one_block  0.520099401473999
generate_one_block  0.5399093627929688
generate_one_block  0.5450830459594727
generate_one_block  0.5168948173522949
generate_one_block  0.5211291313171387
generate_one_block  0.5465066432952881
generate_one_block  0.5286152362823486
generate_one_block  0.5288350582122803
generate_one_block  0.535991907119751
generate_one_block  0.526437520980835
generate_one_block  0.5159330368041992
generate_one_block  0.5271685123443604
generate_one_block  0.5372829437255859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  26.723045587539673
block generation total time  23.316068649291992
average batch blocks generation time:  0.7286271452903748
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08873605728149414  GigaBytes
Max Memory Allocated: 0.08873605728149414  GigaBytes

torch.Size([145943, 128])
torch.Size([102400, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7557373046875 GB
    Memory Allocated: 17.090299606323242  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6248779296875 GB
    Memory Allocated: 0.09436321258544922  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([146549, 128])
torch.Size([102503, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6580810546875 GB
    Memory Allocated: 16.87214469909668  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 0.09477615356445312  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([146505, 128])
torch.Size([103007, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 16.840559482574463  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 0.09380865097045898  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([145652, 128])
torch.Size([100109, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 16.27908945083618  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 0.09479427337646484  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([146614, 128])
torch.Size([102309, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 16.983455181121826  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 0.09439373016357422  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([146683, 128])
torch.Size([102386, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 16.77135419845581  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 0.09475374221801758  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([146013, 128])
torch.Size([101500, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 16.67632484436035  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0780029296875 GB
    Memory Allocated: 0.09483194351196289  GigaBytes
Max Memory Allocated: 17.13101577758789  GigaBytes

torch.Size([147430, 128])
torch.Size([104488, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6990966796875 GB
    Memory Allocated: 17.247349739074707  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6990966796875 GB
    Memory Allocated: 0.09477996826171875  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([145899, 128])
torch.Size([102110, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7186279296875 GB
    Memory Allocated: 16.90388250350952  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 0.09426021575927734  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([146340, 128])
torch.Size([102096, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 16.930413246154785  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 0.09484481811523438  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([145944, 128])
torch.Size([102700, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 17.1204776763916  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 0.09438276290893555  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([146480, 128])
torch.Size([103767, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7205810546875 GB
    Memory Allocated: 17.225708484649658  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1522216796875 GB
    Memory Allocated: 0.09482336044311523  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([145855, 128])
torch.Size([101858, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1522216796875 GB
    Memory Allocated: 17.061735153198242  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1522216796875 GB
    Memory Allocated: 0.0945582389831543  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([146835, 128])
torch.Size([103247, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1522216796875 GB
    Memory Allocated: 17.2153000831604  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1522216796875 GB
    Memory Allocated: 0.09488487243652344  GigaBytes
Max Memory Allocated: 17.282355308532715  GigaBytes

torch.Size([146554, 128])
torch.Size([103403, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1522216796875 GB
    Memory Allocated: 17.2855806350708  GigaBytes
Max Memory Allocated: 17.32115602493286  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5916748046875 GB
    Memory Allocated: 0.09420299530029297  GigaBytes
Max Memory Allocated: 17.32115602493286  GigaBytes

torch.Size([146266, 128])
torch.Size([101694, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6365966796875 GB
    Memory Allocated: 16.85309886932373  GigaBytes
Max Memory Allocated: 17.32115602493286  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6405029296875 GB
    Memory Allocated: 0.09471464157104492  GigaBytes
Max Memory Allocated: 17.32115602493286  GigaBytes

torch.Size([146738, 128])
torch.Size([102623, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6405029296875 GB
    Memory Allocated: 16.57116460800171  GigaBytes
Max Memory Allocated: 17.32115602493286  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6405029296875 GB
    Memory Allocated: 0.09449911117553711  GigaBytes
Max Memory Allocated: 17.32115602493286  GigaBytes

torch.Size([146614, 128])
torch.Size([104051, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6405029296875 GB
    Memory Allocated: 17.404194831848145  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09479045867919922  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146075, 128])
torch.Size([102210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 16.87225580215454  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09424066543579102  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146348, 128])
torch.Size([102048, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 16.78211498260498  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09481382369995117  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145972, 128])
torch.Size([102469, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 17.004868507385254  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09436178207397461  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146406, 128])
torch.Size([103681, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 17.234083652496338  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09473705291748047  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145812, 128])
torch.Size([100798, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 16.56021499633789  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09388256072998047  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145741, 128])
torch.Size([101285, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 16.459696292877197  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09482288360595703  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146357, 128])
torch.Size([102605, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 17.048662662506104  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.0940699577331543  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145913, 128])
torch.Size([101774, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 16.91787576675415  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09475851058959961  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146307, 128])
torch.Size([101994, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 16.746830463409424  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.09438276290893555  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146558, 128])
torch.Size([102946, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 17.10631036758423  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0838623046875 GB
    Memory Allocated: 0.0947880744934082  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146537, 128])
torch.Size([102807, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0936279296875 GB
    Memory Allocated: 16.853857040405273  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.09397411346435547  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145862, 128])
torch.Size([101375, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.58902406692505  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.09473562240600586  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145902, 128])
torch.Size([101345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.616209506988525  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.09427022933959961  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146284, 128])
torch.Size([103008, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 17.139769554138184  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03193935751914978 |0.028635986149311066 |0.44318821281194687 |0.00010611861944198608 |0.803332582116127 |0.01119542121887207 |
----------------------------------------------------------pseudo_mini_loss sum 5.400110244750977
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8797600
Number of first layer input nodes during this epoch:  4680988
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.12358474731445312  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030029296875
range selection method range initialization spend 0.013092041015625
time for parepare:  0.017826557159423828
local_output_nid generation:  0.0009627342224121094
local_in_edges_tensor generation:  0.009461402893066406
mini_batch_src_global generation:  0.001667022705078125
r_  generation:  0.010791778564453125
local_output_nid generation:  0.001127004623413086
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.0016243457794189453
r_  generation:  0.010363578796386719
local_output_nid generation:  0.001010894775390625
local_in_edges_tensor generation:  0.0006339550018310547
mini_batch_src_global generation:  0.0011980533599853516
r_  generation:  0.009842634201049805
local_output_nid generation:  0.0009531974792480469
local_in_edges_tensor generation:  0.0005691051483154297
mini_batch_src_global generation:  0.0010442733764648438
r_  generation:  0.009705543518066406
local_output_nid generation:  0.0009603500366210938
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0011494159698486328
r_  generation:  0.009432792663574219
local_output_nid generation:  0.0009253025054931641
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.010596036911010742
local_output_nid generation:  0.0008995532989501953
local_in_edges_tensor generation:  0.0005550384521484375
mini_batch_src_global generation:  0.0010607242584228516
r_  generation:  0.010102987289428711
local_output_nid generation:  0.0009548664093017578
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0010576248168945312
r_  generation:  0.009855270385742188
local_output_nid generation:  0.0008914470672607422
local_in_edges_tensor generation:  0.000560760498046875
mini_batch_src_global generation:  0.0010535717010498047
r_  generation:  0.009972333908081055
local_output_nid generation:  0.0009281635284423828
local_in_edges_tensor generation:  0.0005660057067871094
mini_batch_src_global generation:  0.0011196136474609375
r_  generation:  0.010542631149291992
local_output_nid generation:  0.0009002685546875
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.0011303424835205078
r_  generation:  0.010684013366699219
local_output_nid generation:  0.0008785724639892578
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.001188516616821289
r_  generation:  0.010244369506835938
local_output_nid generation:  0.0008797645568847656
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0011150836944580078
r_  generation:  0.010609865188598633
local_output_nid generation:  0.0008807182312011719
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.00110626220703125
r_  generation:  0.01031351089477539
local_output_nid generation:  0.0008642673492431641
local_in_edges_tensor generation:  0.0005500316619873047
mini_batch_src_global generation:  0.0011973381042480469
r_  generation:  0.010071516036987305
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0005466938018798828
mini_batch_src_global generation:  0.0011060237884521484
r_  generation:  0.010107040405273438
local_output_nid generation:  0.0008640289306640625
local_in_edges_tensor generation:  0.0005490779876708984
mini_batch_src_global generation:  0.0011072158813476562
r_  generation:  0.01014399528503418
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005438327789306641
mini_batch_src_global generation:  0.0010743141174316406
r_  generation:  0.009967565536499023
local_output_nid generation:  0.0008931159973144531
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.01024770736694336
local_output_nid generation:  0.0008802413940429688
local_in_edges_tensor generation:  0.0005342960357666016
mini_batch_src_global generation:  0.0010612010955810547
r_  generation:  0.010049104690551758
local_output_nid generation:  0.0009007453918457031
local_in_edges_tensor generation:  0.0005481243133544922
mini_batch_src_global generation:  0.0011229515075683594
r_  generation:  0.01013493537902832
local_output_nid generation:  0.0009541511535644531
local_in_edges_tensor generation:  0.0005207061767578125
mini_batch_src_global generation:  0.0010771751403808594
r_  generation:  0.010083675384521484
local_output_nid generation:  0.0009102821350097656
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.0011587142944335938
r_  generation:  0.01050877571105957
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0005717277526855469
mini_batch_src_global generation:  0.0011546611785888672
r_  generation:  0.01077127456665039
local_output_nid generation:  0.0008766651153564453
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.001214742660522461
r_  generation:  0.010325193405151367
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0005483627319335938
mini_batch_src_global generation:  0.001089334487915039
r_  generation:  0.010132312774658203
local_output_nid generation:  0.0009016990661621094
local_in_edges_tensor generation:  0.0005478858947753906
mini_batch_src_global generation:  0.0011661052703857422
r_  generation:  0.010435104370117188
local_output_nid generation:  0.0008404254913330078
local_in_edges_tensor generation:  0.0005414485931396484
mini_batch_src_global generation:  0.0010831356048583984
r_  generation:  0.01015019416809082
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.0005352497100830078
mini_batch_src_global generation:  0.0011200904846191406
r_  generation:  0.010223150253295898
local_output_nid generation:  0.0009152889251708984
local_in_edges_tensor generation:  0.0005326271057128906
mini_batch_src_global generation:  0.0010690689086914062
r_  generation:  0.010025739669799805
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.0011439323425292969
r_  generation:  0.010343074798583984
local_output_nid generation:  0.0009398460388183594
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.0011031627655029297
r_  generation:  0.01045083999633789
----------------------check_connections_block total spend ----------------------------- 0.5160267353057861
generate_one_block  0.023911714553833008
generate_one_block  0.01962566375732422
generate_one_block  0.017705917358398438
generate_one_block  0.01712203025817871
generate_one_block  0.016901731491088867
generate_one_block  0.018406152725219727
generate_one_block  0.017223834991455078
generate_one_block  0.017076969146728516
generate_one_block  0.017268657684326172
generate_one_block  0.018033981323242188
generate_one_block  0.018148422241210938
generate_one_block  0.017684459686279297
generate_one_block  0.017977476119995117
generate_one_block  0.017441511154174805
generate_one_block  0.017110586166381836
generate_one_block  0.017281055450439453
generate_one_block  0.017104387283325195
generate_one_block  0.019710779190063477
generate_one_block  0.017253398895263672
generate_one_block  0.017045021057128906
generate_one_block  0.0172879695892334
generate_one_block  0.017199993133544922
generate_one_block  0.017796039581298828
generate_one_block  0.017946243286132812
generate_one_block  0.01733851432800293
generate_one_block  0.017147064208984375
generate_one_block  0.01745462417602539
generate_one_block  0.01700115203857422
generate_one_block  0.017293930053710938
generate_one_block  0.01716899871826172
generate_one_block  0.0174562931060791
generate_one_block  0.017449378967285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036550045013427734
gen group dst list time:  0.021892547607421875
time for parepare:  0.019392967224121094
local_output_nid generation:  0.005194187164306641
local_in_edges_tensor generation:  0.0160367488861084
mini_batch_src_global generation:  0.013214588165283203
r_  generation:  0.13424968719482422
local_output_nid generation:  0.0075719356536865234
local_in_edges_tensor generation:  0.009245634078979492
mini_batch_src_global generation:  0.016889095306396484
r_  generation:  0.14023303985595703
local_output_nid generation:  0.007636308670043945
local_in_edges_tensor generation:  0.0272979736328125
mini_batch_src_global generation:  0.015247583389282227
r_  generation:  0.14116239547729492
local_output_nid generation:  0.00772547721862793
local_in_edges_tensor generation:  0.00978708267211914
mini_batch_src_global generation:  0.016210556030273438
r_  generation:  0.14376497268676758
local_output_nid generation:  0.008127927780151367
local_in_edges_tensor generation:  0.007530689239501953
mini_batch_src_global generation:  0.016663789749145508
r_  generation:  0.14563822746276855
local_output_nid generation:  0.008756399154663086
local_in_edges_tensor generation:  0.008528947830200195
mini_batch_src_global generation:  0.019535303115844727
r_  generation:  0.16002798080444336
local_output_nid generation:  0.008053302764892578
local_in_edges_tensor generation:  0.0077495574951171875
mini_batch_src_global generation:  0.017928123474121094
r_  generation:  0.14693570137023926
local_output_nid generation:  0.008281230926513672
local_in_edges_tensor generation:  0.008680343627929688
mini_batch_src_global generation:  0.017954349517822266
r_  generation:  0.14835166931152344
local_output_nid generation:  0.008809328079223633
local_in_edges_tensor generation:  0.009171247482299805
mini_batch_src_global generation:  0.017862558364868164
r_  generation:  0.15236496925354004
local_output_nid generation:  0.009029150009155273
local_in_edges_tensor generation:  0.011594533920288086
mini_batch_src_global generation:  0.019199132919311523
r_  generation:  0.1569976806640625
local_output_nid generation:  0.009340286254882812
local_in_edges_tensor generation:  0.007984638214111328
mini_batch_src_global generation:  0.019107341766357422
r_  generation:  0.15819597244262695
local_output_nid generation:  0.009131669998168945
local_in_edges_tensor generation:  0.009270429611206055
mini_batch_src_global generation:  0.018987178802490234
r_  generation:  0.15323925018310547
local_output_nid generation:  0.009237051010131836
local_in_edges_tensor generation:  0.010653018951416016
mini_batch_src_global generation:  0.02050614356994629
r_  generation:  0.15901446342468262
local_output_nid generation:  0.010546207427978516
local_in_edges_tensor generation:  0.008365631103515625
mini_batch_src_global generation:  0.018576860427856445
r_  generation:  0.1515977382659912
local_output_nid generation:  0.008903980255126953
local_in_edges_tensor generation:  0.008156776428222656
mini_batch_src_global generation:  0.01827549934387207
r_  generation:  0.1495227813720703
local_output_nid generation:  0.009261369705200195
local_in_edges_tensor generation:  0.008089303970336914
mini_batch_src_global generation:  0.018779993057250977
r_  generation:  0.1539604663848877
local_output_nid generation:  0.009108304977416992
local_in_edges_tensor generation:  0.01053166389465332
mini_batch_src_global generation:  0.018172025680541992
r_  generation:  0.15150046348571777
local_output_nid generation:  0.009037256240844727
local_in_edges_tensor generation:  0.008258342742919922
mini_batch_src_global generation:  0.018286466598510742
r_  generation:  0.1502399444580078
local_output_nid generation:  0.008997917175292969
local_in_edges_tensor generation:  0.008088350296020508
mini_batch_src_global generation:  0.018718719482421875
r_  generation:  0.15088367462158203
local_output_nid generation:  0.008488893508911133
local_in_edges_tensor generation:  0.00807952880859375
mini_batch_src_global generation:  0.01822209358215332
r_  generation:  0.15014886856079102
local_output_nid generation:  0.00874471664428711
local_in_edges_tensor generation:  0.009955406188964844
mini_batch_src_global generation:  0.019591093063354492
r_  generation:  0.15161538124084473
local_output_nid generation:  0.008773565292358398
local_in_edges_tensor generation:  0.011654376983642578
mini_batch_src_global generation:  0.018733978271484375
r_  generation:  0.15330076217651367
local_output_nid generation:  0.00894618034362793
local_in_edges_tensor generation:  0.009553670883178711
mini_batch_src_global generation:  0.01900005340576172
r_  generation:  0.1568460464477539
local_output_nid generation:  0.008971214294433594
local_in_edges_tensor generation:  0.010761737823486328
mini_batch_src_global generation:  0.02047109603881836
r_  generation:  0.1603245735168457
local_output_nid generation:  0.008856534957885742
local_in_edges_tensor generation:  0.00842738151550293
mini_batch_src_global generation:  0.0188291072845459
r_  generation:  0.1552579402923584
local_output_nid generation:  0.00878596305847168
local_in_edges_tensor generation:  0.00852203369140625
mini_batch_src_global generation:  0.019083499908447266
r_  generation:  0.15321850776672363
local_output_nid generation:  0.008991241455078125
local_in_edges_tensor generation:  0.00952768325805664
mini_batch_src_global generation:  0.020233154296875
r_  generation:  0.16052007675170898
local_output_nid generation:  0.00869894027709961
local_in_edges_tensor generation:  0.008137226104736328
mini_batch_src_global generation:  0.01864147186279297
r_  generation:  0.1514272689819336
local_output_nid generation:  0.008785009384155273
local_in_edges_tensor generation:  0.008220195770263672
mini_batch_src_global generation:  0.018370866775512695
r_  generation:  0.1534574031829834
local_output_nid generation:  0.00878596305847168
local_in_edges_tensor generation:  0.009924173355102539
mini_batch_src_global generation:  0.018644332885742188
r_  generation:  0.15380430221557617
local_output_nid generation:  0.00897073745727539
local_in_edges_tensor generation:  0.009448766708374023
mini_batch_src_global generation:  0.01980757713317871
r_  generation:  0.15419268608093262
local_output_nid generation:  0.008758306503295898
local_in_edges_tensor generation:  0.009310007095336914
mini_batch_src_global generation:  0.02010345458984375
r_  generation:  0.15473222732543945
----------------------check_connections_block total spend ----------------------------- 7.194016456604004
generate_one_block  0.19371628761291504
generate_one_block  0.19626164436340332
generate_one_block  0.19383931159973145
generate_one_block  0.19498848915100098
generate_one_block  0.21681499481201172
generate_one_block  0.2111072540283203
generate_one_block  0.19316458702087402
generate_one_block  0.19540166854858398
generate_one_block  0.19777655601501465
generate_one_block  0.20758485794067383
generate_one_block  0.21065616607666016
generate_one_block  0.19989013671875
generate_one_block  0.21006441116333008
generate_one_block  0.1953129768371582
generate_one_block  0.19468092918395996
generate_one_block  0.2019188404083252
generate_one_block  0.20060944557189941
generate_one_block  0.1965653896331787
generate_one_block  0.20096802711486816
generate_one_block  0.20007753372192383
generate_one_block  0.20026016235351562
generate_one_block  0.20307588577270508
generate_one_block  0.2074604034423828
generate_one_block  0.21293210983276367
generate_one_block  0.20293021202087402
generate_one_block  0.19929242134094238
generate_one_block  0.2084803581237793
generate_one_block  0.19599294662475586
generate_one_block  0.19911885261535645
generate_one_block  0.20183372497558594
generate_one_block  0.2024846076965332
generate_one_block  0.20613813400268555
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03657102584838867
gen group dst list time:  0.09572577476501465
time for parepare:  0.017395734786987305
local_output_nid generation:  0.021994352340698242
local_in_edges_tensor generation:  0.03404545783996582
mini_batch_src_global generation:  0.0388791561126709
r_  generation:  0.40360045433044434
local_output_nid generation:  0.028296470642089844
local_in_edges_tensor generation:  0.0388638973236084
mini_batch_src_global generation:  0.046722412109375
r_  generation:  0.4032473564147949
local_output_nid generation:  0.02805352210998535
local_in_edges_tensor generation:  0.028499126434326172
mini_batch_src_global generation:  0.049817562103271484
r_  generation:  0.4088602066040039
local_output_nid generation:  0.026460647583007812
local_in_edges_tensor generation:  0.03054070472717285
mini_batch_src_global generation:  0.04749178886413574
r_  generation:  0.40064477920532227
local_output_nid generation:  0.027103900909423828
local_in_edges_tensor generation:  0.02897191047668457
mini_batch_src_global generation:  0.052216529846191406
r_  generation:  0.4121716022491455
local_output_nid generation:  0.027348041534423828
local_in_edges_tensor generation:  0.02862715721130371
mini_batch_src_global generation:  0.04904341697692871
r_  generation:  0.4139866828918457
local_output_nid generation:  0.027055978775024414
local_in_edges_tensor generation:  0.028307199478149414
mini_batch_src_global generation:  0.04840683937072754
r_  generation:  0.41416501998901367
local_output_nid generation:  0.027390718460083008
local_in_edges_tensor generation:  0.02886962890625
mini_batch_src_global generation:  0.04873919486999512
r_  generation:  0.41323041915893555
local_output_nid generation:  0.027554988861083984
local_in_edges_tensor generation:  0.03633880615234375
mini_batch_src_global generation:  0.048227548599243164
r_  generation:  0.4246494770050049
local_output_nid generation:  0.027596473693847656
local_in_edges_tensor generation:  0.02573370933532715
mini_batch_src_global generation:  0.05215597152709961
r_  generation:  0.4130401611328125
local_output_nid generation:  0.027791738510131836
local_in_edges_tensor generation:  0.029248714447021484
mini_batch_src_global generation:  0.05098700523376465
r_  generation:  0.4207732677459717
local_output_nid generation:  0.02894449234008789
local_in_edges_tensor generation:  0.029002904891967773
mini_batch_src_global generation:  0.04937744140625
r_  generation:  0.40825772285461426
local_output_nid generation:  0.027850627899169922
local_in_edges_tensor generation:  0.026105165481567383
mini_batch_src_global generation:  0.05098986625671387
r_  generation:  0.4219214916229248
local_output_nid generation:  0.027684926986694336
local_in_edges_tensor generation:  0.0283660888671875
mini_batch_src_global generation:  0.048372507095336914
r_  generation:  0.40947890281677246
local_output_nid generation:  0.027586936950683594
local_in_edges_tensor generation:  0.03203892707824707
mini_batch_src_global generation:  0.05083441734313965
r_  generation:  0.4127209186553955
local_output_nid generation:  0.02760171890258789
local_in_edges_tensor generation:  0.029020309448242188
mini_batch_src_global generation:  0.04921579360961914
r_  generation:  0.4122326374053955
local_output_nid generation:  0.027729272842407227
local_in_edges_tensor generation:  0.02867865562438965
mini_batch_src_global generation:  0.04827451705932617
r_  generation:  0.41693806648254395
local_output_nid generation:  0.028461694717407227
local_in_edges_tensor generation:  0.028728723526000977
mini_batch_src_global generation:  0.04841780662536621
r_  generation:  0.408905029296875
local_output_nid generation:  0.027628660202026367
local_in_edges_tensor generation:  0.02881026268005371
mini_batch_src_global generation:  0.04766654968261719
r_  generation:  0.41636037826538086
local_output_nid generation:  0.02809882164001465
local_in_edges_tensor generation:  0.035718441009521484
mini_batch_src_global generation:  0.050195932388305664
r_  generation:  0.4150676727294922
local_output_nid generation:  0.02779221534729004
local_in_edges_tensor generation:  0.03430438041687012
mini_batch_src_global generation:  0.047573089599609375
r_  generation:  0.41554784774780273
local_output_nid generation:  0.028092384338378906
local_in_edges_tensor generation:  0.02924513816833496
mini_batch_src_global generation:  0.051531076431274414
r_  generation:  0.43556880950927734
local_output_nid generation:  0.029944181442260742
local_in_edges_tensor generation:  0.03595280647277832
mini_batch_src_global generation:  0.0480954647064209
r_  generation:  0.4235670566558838
local_output_nid generation:  0.028524160385131836
local_in_edges_tensor generation:  0.025592803955078125
mini_batch_src_global generation:  0.04937148094177246
r_  generation:  0.415130615234375
local_output_nid generation:  0.028843402862548828
local_in_edges_tensor generation:  0.028905630111694336
mini_batch_src_global generation:  0.05382084846496582
r_  generation:  0.4203062057495117
local_output_nid generation:  0.028982877731323242
local_in_edges_tensor generation:  0.025659561157226562
mini_batch_src_global generation:  0.04919099807739258
r_  generation:  0.4143359661102295
local_output_nid generation:  0.028450489044189453
local_in_edges_tensor generation:  0.025563716888427734
mini_batch_src_global generation:  0.048928260803222656
r_  generation:  0.419858455657959
local_output_nid generation:  0.028363704681396484
local_in_edges_tensor generation:  0.0292203426361084
mini_batch_src_global generation:  0.04916501045227051
r_  generation:  0.4125828742980957
local_output_nid generation:  0.028343677520751953
local_in_edges_tensor generation:  0.032468318939208984
mini_batch_src_global generation:  0.0481112003326416
r_  generation:  0.41487765312194824
local_output_nid generation:  0.028643131256103516
local_in_edges_tensor generation:  0.028545379638671875
mini_batch_src_global generation:  0.05178403854370117
r_  generation:  0.4126412868499756
local_output_nid generation:  0.02841043472290039
local_in_edges_tensor generation:  0.02523660659790039
mini_batch_src_global generation:  0.04779815673828125
r_  generation:  0.4192168712615967
local_output_nid generation:  0.02828669548034668
local_in_edges_tensor generation:  0.033102989196777344
mini_batch_src_global generation:  0.04855704307556152
r_  generation:  0.41035938262939453
----------------------check_connections_block total spend ----------------------------- 19.556118965148926
generate_one_block  0.5492372512817383
generate_one_block  0.5577969551086426
generate_one_block  0.5506560802459717
generate_one_block  0.5397434234619141
generate_one_block  0.6461427211761475
generate_one_block  0.5614957809448242
generate_one_block  0.5411810874938965
generate_one_block  0.5511324405670166
generate_one_block  0.5591058731079102
generate_one_block  0.5598394870758057
generate_one_block  0.5584197044372559
generate_one_block  0.5501573085784912
generate_one_block  0.5479862689971924
generate_one_block  0.5372815132141113
generate_one_block  0.5423824787139893
generate_one_block  0.5554704666137695
generate_one_block  0.5562591552734375
generate_one_block  0.5385856628417969
generate_one_block  0.5409231185913086
generate_one_block  0.5478048324584961
generate_one_block  0.5432825088500977
generate_one_block  0.5620028972625732
generate_one_block  0.5680830478668213
generate_one_block  0.5429151058197021
generate_one_block  0.5655477046966553
generate_one_block  0.546424150466919
generate_one_block  0.5554368495941162
generate_one_block  0.5437955856323242
generate_one_block  0.5473899841308594
generate_one_block  0.553147554397583
generate_one_block  0.5427544116973877
generate_one_block  0.5520467758178711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.12358474731445312  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

connection checking time:  26.75013542175293
block generation total time  24.16582751274109
average batch blocks generation time:  0.755182109773159
block dataloader generation time/epoch 53.963294506073
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10521411895751953  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146642, 128])
torch.Size([101879, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.726354598999023  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10465478897094727  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146240, 128])
torch.Size([102333, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.9253249168396  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.1051936149597168  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146812, 128])
torch.Size([102244, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.63144540786743  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10381507873535156  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([144517, 128])
torch.Size([99659, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.632997512817383  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10516977310180664  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146247, 128])
torch.Size([101370, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.561184883117676  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10468387603759766  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146056, 128])
torch.Size([102614, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 17.340078830718994  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10520172119140625  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145979, 128])
torch.Size([101435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.647235870361328  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10477972030639648  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146582, 128])
torch.Size([102689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.690855503082275  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 0.10522842407226562  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([147077, 128])
torch.Size([103450, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0955810546875 GB
    Memory Allocated: 16.840247631072998  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 0.10481691360473633  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146419, 128])
torch.Size([103437, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 17.242623329162598  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 0.10532569885253906  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146626, 128])
torch.Size([103641, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 17.275172233581543  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 0.10456371307373047  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145997, 128])
torch.Size([102043, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 16.931139945983887  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 0.10533714294433594  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146089, 128])
torch.Size([102780, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 17.27794313430786  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 0.10465288162231445  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146254, 128])
torch.Size([101697, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 16.735372066497803  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0975341796875 GB
    Memory Allocated: 0.10519695281982422  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145702, 128])
torch.Size([101340, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1033935546875 GB
    Memory Allocated: 16.654533863067627  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10488414764404297  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146687, 128])
torch.Size([102552, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 17.02959680557251  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10521602630615234  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146452, 128])
torch.Size([102570, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.793303966522217  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10444259643554688  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145858, 128])
torch.Size([101694, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.692039489746094  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10521888732910156  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145913, 128])
torch.Size([101570, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.738770961761475  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.1046743392944336  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146369, 128])
torch.Size([102143, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.653979778289795  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10522270202636719  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146452, 128])
torch.Size([101590, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.732040882110596  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10494756698608398  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146842, 128])
torch.Size([103307, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.927613735198975  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10528707504272461  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146738, 128])
torch.Size([103444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 17.199446201324463  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10471487045288086  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146153, 128])
torch.Size([102769, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 17.261226654052734  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10526132583618164  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146749, 128])
torch.Size([103286, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 17.065107345581055  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10458707809448242  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146074, 128])
torch.Size([102500, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.982162475585938  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10529899597167969  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146119, 128])
torch.Size([102345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 17.16560983657837  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10479116439819336  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146573, 128])
torch.Size([102302, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.73070001602173  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10524749755859375  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146034, 128])
torch.Size([101714, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.986842155456543  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10496854782104492  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146907, 128])
torch.Size([102764, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.85458517074585  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.1052556037902832  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([146143, 128])
torch.Size([102169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 16.923305988311768  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 0.10448169708251953  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

torch.Size([145792, 128])
torch.Size([101882, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1072998046875 GB
    Memory Allocated: 17.027519702911377  GigaBytes
Max Memory Allocated: 17.44428300857544  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027442753314971924 |0.014717109501361847 |0.42518556863069534 |9.942054748535156e-05 |0.796637661755085 |0.0058934688568115234 |
----------------------------------------------------------pseudo_mini_loss sum 3.962869167327881
Total (block generation + training)time/epoch 94.47436857223511
Training time/epoch 40.51077485084534
Training time without block to device /epoch 40.03982734680176
Training time without total dataloading part /epoch 39.10741829872131
load block tensor time/epoch 0.8781681060791016
block to device time/epoch 0.4709475040435791
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8794076
Number of first layer input nodes during this epoch:  4681094
