Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648504275.555766
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024619340896606445
range selection method range initialization spend 0.01360940933227539
time for parepare:  0.0177309513092041
local_output_nid generation:  0.005313396453857422
local_in_edges_tensor generation:  0.005891561508178711
mini_batch_src_global generation:  0.006521701812744141
r_  generation:  0.0818490982055664
local_output_nid generation:  0.006123781204223633
local_in_edges_tensor generation:  0.003003358840942383
mini_batch_src_global generation:  0.008672237396240234
r_  generation:  0.08756351470947266
local_output_nid generation:  0.00617671012878418
local_in_edges_tensor generation:  0.0030364990234375
mini_batch_src_global generation:  0.0065076351165771484
r_  generation:  0.08857131004333496
local_output_nid generation:  0.006205320358276367
local_in_edges_tensor generation:  0.0030965805053710938
mini_batch_src_global generation:  0.00674128532409668
r_  generation:  0.09082555770874023
----------------------check_connections_block total spend ----------------------------- 0.5034880638122559
generate_one_block  0.10170221328735352
generate_one_block  0.10148286819458008
generate_one_block  0.10299825668334961
generate_one_block  0.10183429718017578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.04090523719787598
gen group dst list time:  0.011283636093139648
time for parepare:  0.018990039825439453
local_output_nid generation:  0.014777898788452148
local_in_edges_tensor generation:  0.0371403694152832
mini_batch_src_global generation:  0.03885006904602051
r_  generation:  0.406419038772583
local_output_nid generation:  0.021551847457885742
local_in_edges_tensor generation:  0.03789877891540527
mini_batch_src_global generation:  0.04802536964416504
r_  generation:  0.41864967346191406
local_output_nid generation:  0.022031545639038086
local_in_edges_tensor generation:  0.030919313430786133
mini_batch_src_global generation:  0.04831361770629883
r_  generation:  0.42363715171813965
local_output_nid generation:  0.022540569305419922
local_in_edges_tensor generation:  0.027799367904663086
mini_batch_src_global generation:  0.04962754249572754
r_  generation:  0.42203259468078613
----------------------check_connections_block total spend ----------------------------- 2.4473178386688232
generate_one_block  0.5637185573577881
generate_one_block  0.5482189655303955
generate_one_block  0.5440673828125
generate_one_block  0.5288243293762207
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03742337226867676
gen group dst list time:  0.02074599266052246
time for parepare:  0.019236326217651367
local_output_nid generation:  0.024251699447631836
local_in_edges_tensor generation:  0.05170178413391113
mini_batch_src_global generation:  0.05013322830200195
r_  generation:  0.5398340225219727
local_output_nid generation:  0.033239126205444336
local_in_edges_tensor generation:  0.05283093452453613
mini_batch_src_global generation:  0.06242084503173828
r_  generation:  0.5445034503936768
local_output_nid generation:  0.03407096862792969
local_in_edges_tensor generation:  0.03419828414916992
mini_batch_src_global generation:  0.05765128135681152
r_  generation:  0.5578780174255371
local_output_nid generation:  0.03415107727050781
local_in_edges_tensor generation:  0.03893256187438965
mini_batch_src_global generation:  0.06022524833679199
r_  generation:  0.5633645057678223
----------------------check_connections_block total spend ----------------------------- 3.2299723625183105
generate_one_block  0.6948566436767578
generate_one_block  0.7085766792297363
generate_one_block  0.6928889751434326
generate_one_block  0.6975212097167969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03009343147277832
gen group dst list time:  0.023384809494018555
time for parepare:  0.01880788803100586
local_output_nid generation:  0.027678251266479492
local_in_edges_tensor generation:  0.03933382034301758
mini_batch_src_global generation:  0.0498814582824707
r_  generation:  0.5448360443115234
local_output_nid generation:  0.03516244888305664
local_in_edges_tensor generation:  0.05175161361694336
mini_batch_src_global generation:  0.062169790267944336
r_  generation:  0.5446569919586182
local_output_nid generation:  0.035555362701416016
local_in_edges_tensor generation:  0.03998231887817383
mini_batch_src_global generation:  0.06321358680725098
r_  generation:  0.5521342754364014
local_output_nid generation:  0.0361940860748291
local_in_edges_tensor generation:  0.03882455825805664
mini_batch_src_global generation:  0.06302094459533691
r_  generation:  0.5490150451660156
----------------------check_connections_block total spend ----------------------------- 3.243269205093384
generate_one_block  0.6822106838226318
generate_one_block  0.7112314701080322
generate_one_block  0.6927978992462158
generate_one_block  0.6886067390441895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.027363061904907227
gen group dst list time:  0.024377822875976562
time for parepare:  0.01889324188232422
local_output_nid generation:  0.02774524688720703
local_in_edges_tensor generation:  0.037937164306640625
mini_batch_src_global generation:  0.04878497123718262
r_  generation:  0.5433797836303711
local_output_nid generation:  0.03502202033996582
local_in_edges_tensor generation:  0.049585580825805664
mini_batch_src_global generation:  0.058431386947631836
r_  generation:  0.5133395195007324
local_output_nid generation:  0.03596925735473633
local_in_edges_tensor generation:  0.03737616539001465
mini_batch_src_global generation:  0.06246805191040039
r_  generation:  0.5158460140228271
local_output_nid generation:  0.03676605224609375
local_in_edges_tensor generation:  0.03782296180725098
mini_batch_src_global generation:  0.05840301513671875
r_  generation:  0.5189566612243652
----------------------check_connections_block total spend ----------------------------- 3.112323045730591
generate_one_block  0.6542787551879883
generate_one_block  0.6523880958557129
generate_one_block  0.6735427379608154
generate_one_block  0.6446146965026855
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

connection checking time:  12.032882452011108
block generation total time  10.3783438205719
average batch blocks generation time:  2.594585955142975
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12996625900268555  GigaBytes
Max Memory Allocated: 0.12996625900268555  GigaBytes

torch.Size([167438, 128])
torch.Size([166854, 32])
torch.Size([164820, 32])
torch.Size([155290, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7459716796875 GB
    Memory Allocated: 21.387093544006348  GigaBytes
Max Memory Allocated: 21.411811351776123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9158935546875 GB
    Memory Allocated: 0.1342306137084961  GigaBytes
Max Memory Allocated: 21.411811351776123  GigaBytes

torch.Size([167389, 128])
torch.Size([166850, 32])
torch.Size([164974, 32])
torch.Size([155460, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7752685546875 GB
    Memory Allocated: 21.405944347381592  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2498779296875 GB
    Memory Allocated: 0.13450384140014648  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

torch.Size([167411, 128])
torch.Size([166829, 32])
torch.Size([164767, 32])
torch.Size([154879, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2518310546875 GB
    Memory Allocated: 21.40567684173584  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.13420629501342773  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

torch.Size([167380, 128])
torch.Size([166839, 32])
torch.Size([164718, 32])
torch.Size([154775, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 21.389759063720703  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044671475887298584 |0.1197478175163269 |0.8180892467498779 |0.00012308359146118164 |0.785269021987915 |0.007931232452392578 |
----------------------------------------------------------pseudo_mini_loss sum 4.50825834274292
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3022751
Number of first layer input nodes during this epoch:  669618
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.2272357940673828  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.026044845581054688
range selection method range initialization spend 0.011425971984863281
time for parepare:  0.01727437973022461
local_output_nid generation:  0.005347728729248047
local_in_edges_tensor generation:  0.010871171951293945
mini_batch_src_global generation:  0.007232666015625
r_  generation:  0.08057022094726562
local_output_nid generation:  0.0061795711517333984
local_in_edges_tensor generation:  0.005408525466918945
mini_batch_src_global generation:  0.008835077285766602
r_  generation:  0.08583545684814453
local_output_nid generation:  0.006301403045654297
local_in_edges_tensor generation:  0.0030252933502197266
mini_batch_src_global generation:  0.006835222244262695
r_  generation:  0.09047985076904297
local_output_nid generation:  0.006243705749511719
local_in_edges_tensor generation:  0.003083944320678711
mini_batch_src_global generation:  0.010037899017333984
r_  generation:  0.09632706642150879
----------------------check_connections_block total spend ----------------------------- 0.5237212181091309
generate_one_block  0.11854100227355957
generate_one_block  0.11531567573547363
generate_one_block  0.11654543876647949
generate_one_block  0.11839556694030762
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.040450096130371094
gen group dst list time:  0.01260066032409668
time for parepare:  0.01906728744506836
local_output_nid generation:  0.01446390151977539
local_in_edges_tensor generation:  0.04062700271606445
mini_batch_src_global generation:  0.03870391845703125
r_  generation:  0.41084766387939453
local_output_nid generation:  0.0215756893157959
local_in_edges_tensor generation:  0.037432193756103516
mini_batch_src_global generation:  0.05004143714904785
r_  generation:  0.4170339107513428
local_output_nid generation:  0.022240877151489258
local_in_edges_tensor generation:  0.027077198028564453
mini_batch_src_global generation:  0.05183839797973633
r_  generation:  0.42875194549560547
local_output_nid generation:  0.02279067039489746
local_in_edges_tensor generation:  0.03528308868408203
mini_batch_src_global generation:  0.05559039115905762
r_  generation:  0.4348602294921875
----------------------check_connections_block total spend ----------------------------- 2.487074851989746
generate_one_block  0.5716001987457275
generate_one_block  0.5721828937530518
generate_one_block  0.6203610897064209
generate_one_block  0.5911743640899658
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04198861122131348
gen group dst list time:  0.02420496940612793
time for parepare:  0.019175291061401367
local_output_nid generation:  0.0245208740234375
local_in_edges_tensor generation:  0.05827188491821289
mini_batch_src_global generation:  0.051180362701416016
r_  generation:  0.5430433750152588
local_output_nid generation:  0.032355546951293945
local_in_edges_tensor generation:  0.05321002006530762
mini_batch_src_global generation:  0.06308126449584961
r_  generation:  0.5517940521240234
local_output_nid generation:  0.03382229804992676
local_in_edges_tensor generation:  0.04424762725830078
mini_batch_src_global generation:  0.05770230293273926
r_  generation:  0.5644142627716064
local_output_nid generation:  0.03438901901245117
local_in_edges_tensor generation:  0.04381608963012695
mini_batch_src_global generation:  0.05893135070800781
r_  generation:  0.562002420425415
----------------------check_connections_block total spend ----------------------------- 3.29152512550354
generate_one_block  0.7390530109405518
generate_one_block  0.7255985736846924
generate_one_block  0.7290923595428467
generate_one_block  0.7338266372680664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.042993783950805664
gen group dst list time:  0.024028301239013672
time for parepare:  0.019483566284179688
local_output_nid generation:  0.028009891510009766
local_in_edges_tensor generation:  0.046853065490722656
mini_batch_src_global generation:  0.05066967010498047
r_  generation:  0.5485110282897949
local_output_nid generation:  0.03524613380432129
local_in_edges_tensor generation:  0.051163673400878906
mini_batch_src_global generation:  0.06538772583007812
r_  generation:  0.5582549571990967
local_output_nid generation:  0.03583788871765137
local_in_edges_tensor generation:  0.0543208122253418
mini_batch_src_global generation:  0.06733369827270508
r_  generation:  0.559065580368042
local_output_nid generation:  0.03709292411804199
local_in_edges_tensor generation:  0.04440188407897949
mini_batch_src_global generation:  0.08803820610046387
r_  generation:  0.5545387268066406
----------------------check_connections_block total spend ----------------------------- 3.369884967803955
generate_one_block  0.7323861122131348
generate_one_block  0.7316312789916992
generate_one_block  0.7370996475219727
generate_one_block  0.7308738231658936
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04038381576538086
gen group dst list time:  0.024809837341308594
time for parepare:  0.01969623565673828
local_output_nid generation:  0.028368711471557617
local_in_edges_tensor generation:  0.04577064514160156
mini_batch_src_global generation:  0.04518413543701172
r_  generation:  0.5067832469940186
local_output_nid generation:  0.036267757415771484
local_in_edges_tensor generation:  0.04282236099243164
mini_batch_src_global generation:  0.057646751403808594
r_  generation:  0.5264170169830322
local_output_nid generation:  0.03724169731140137
local_in_edges_tensor generation:  0.039563655853271484
mini_batch_src_global generation:  0.06178116798400879
r_  generation:  0.5194993019104004
local_output_nid generation:  0.037717342376708984
local_in_edges_tensor generation:  0.03503298759460449
mini_batch_src_global generation:  0.05843782424926758
r_  generation:  0.5231523513793945
----------------------check_connections_block total spend ----------------------------- 3.087012529373169
generate_one_block  0.6585865020751953
generate_one_block  0.6843678951263428
generate_one_block  0.6741306781768799
generate_one_block  0.6574490070343018
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.2272357940673828  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

connection checking time:  12.23549747467041
block generation total time  10.889414072036743
average batch blocks generation time:  2.722353518009186
block dataloader generation time/epoch 25.59841299057007
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.13586091995239258  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

torch.Size([167442, 128])
torch.Size([166880, 32])
torch.Size([164807, 32])
torch.Size([154913, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 21.402554988861084  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.13562870025634766  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

torch.Size([167469, 128])
torch.Size([166888, 32])
torch.Size([164895, 32])
torch.Size([155205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 21.390278816223145  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.13585805892944336  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

torch.Size([167502, 128])
torch.Size([166975, 32])
torch.Size([164936, 32])
torch.Size([154981, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 21.39869451522827  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 0.13560962677001953  GigaBytes
Max Memory Allocated: 21.433879852294922  GigaBytes

torch.Size([167379, 128])
torch.Size([166802, 32])
torch.Size([164791, 32])
torch.Size([155158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2537841796875 GB
    Memory Allocated: 21.409400463104248  GigaBytes
Max Memory Allocated: 21.43760919570923  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05205744504928589 |0.04361230134963989 |0.47093474864959717 |0.00010949373245239258 |0.6313807368278503 |0.008933544158935547 |
----------------------------------------------------------pseudo_mini_loss sum 4.0229315757751465
Total (block generation + training)time/epoch 30.42912268638611
Training time/epoch 4.830151796340942
Training time without block to device /epoch 4.655702590942383
Training time without total dataloading part /epoch 4.418633460998535
load block tensor time/epoch 0.20822978019714355
block to device time/epoch 0.17444920539855957
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3022548
Number of first layer input nodes during this epoch:  669792
