Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648467324.327082
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02771925926208496
range selection method range initialization spend 0.013527393341064453
time for parepare:  0.017899036407470703
local_output_nid generation:  0.0007300376892089844
local_in_edges_tensor generation:  0.003935575485229492
mini_batch_src_global generation:  0.001550436019897461
r_  generation:  0.01121830940246582
local_output_nid generation:  0.0008327960968017578
local_in_edges_tensor generation:  0.0006401538848876953
mini_batch_src_global generation:  0.0015521049499511719
r_  generation:  0.009910106658935547
local_output_nid generation:  0.0008020401000976562
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0009968280792236328
r_  generation:  0.009436368942260742
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.0004956722259521484
mini_batch_src_global generation:  0.0009000301361083984
r_  generation:  0.009495735168457031
local_output_nid generation:  0.0007724761962890625
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.0010406970977783203
r_  generation:  0.009608745574951172
local_output_nid generation:  0.0007832050323486328
local_in_edges_tensor generation:  0.0004944801330566406
mini_batch_src_global generation:  0.0009274482727050781
r_  generation:  0.009787797927856445
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0005192756652832031
mini_batch_src_global generation:  0.0008783340454101562
r_  generation:  0.009418010711669922
local_output_nid generation:  0.0008034706115722656
local_in_edges_tensor generation:  0.0005123615264892578
mini_batch_src_global generation:  0.0009403228759765625
r_  generation:  0.010007619857788086
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0009355545043945312
r_  generation:  0.009912729263305664
local_output_nid generation:  0.0007898807525634766
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0009164810180664062
r_  generation:  0.009393453598022461
local_output_nid generation:  0.0007824897766113281
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.0009255409240722656
r_  generation:  0.009985923767089844
local_output_nid generation:  0.000782012939453125
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0009784698486328125
r_  generation:  0.010245084762573242
local_output_nid generation:  0.0008339881896972656
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.000957489013671875
r_  generation:  0.009942770004272461
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009326934814453125
r_  generation:  0.010025739669799805
local_output_nid generation:  0.0007877349853515625
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.0010170936584472656
r_  generation:  0.010074615478515625
local_output_nid generation:  0.0007870197296142578
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  0.0009791851043701172
r_  generation:  0.010123968124389648
local_output_nid generation:  0.0007770061492919922
local_in_edges_tensor generation:  0.0004839897155761719
mini_batch_src_global generation:  0.0009627342224121094
r_  generation:  0.00996708869934082
local_output_nid generation:  0.0007867813110351562
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.0009472370147705078
r_  generation:  0.010133504867553711
local_output_nid generation:  0.0007827281951904297
local_in_edges_tensor generation:  0.00047969818115234375
mini_batch_src_global generation:  0.0009775161743164062
r_  generation:  0.01021885871887207
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0004773139953613281
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.009807586669921875
local_output_nid generation:  0.0007777214050292969
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.0009832382202148438
r_  generation:  0.01036691665649414
local_output_nid generation:  0.0008144378662109375
local_in_edges_tensor generation:  0.0005037784576416016
mini_batch_src_global generation:  0.0009958744049072266
r_  generation:  0.010028362274169922
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.00101470947265625
r_  generation:  0.010582447052001953
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0004956722259521484
mini_batch_src_global generation:  0.0010597705841064453
r_  generation:  0.010337591171264648
local_output_nid generation:  0.0007996559143066406
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0010342597961425781
r_  generation:  0.01021265983581543
local_output_nid generation:  0.0008029937744140625
local_in_edges_tensor generation:  0.0005006790161132812
mini_batch_src_global generation:  0.0010652542114257812
r_  generation:  0.010491609573364258
local_output_nid generation:  0.0008001327514648438
local_in_edges_tensor generation:  0.0004820823669433594
mini_batch_src_global generation:  0.0010151863098144531
r_  generation:  0.010030031204223633
local_output_nid generation:  0.0008022785186767578
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.009995698928833008
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0005080699920654297
mini_batch_src_global generation:  0.00109100341796875
r_  generation:  0.01195669174194336
local_output_nid generation:  0.0008909702301025391
local_in_edges_tensor generation:  0.004606485366821289
mini_batch_src_global generation:  0.0013911724090576172
r_  generation:  0.01068258285522461
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0005249977111816406
mini_batch_src_global generation:  0.001125335693359375
r_  generation:  0.010270833969116211
local_output_nid generation:  0.0008232593536376953
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.0010509490966796875
r_  generation:  0.010593652725219727
----------------------check_connections_block total spend ----------------------------- 0.4985971450805664
generate_one_block  0.01602935791015625
generate_one_block  0.015123844146728516
generate_one_block  0.014857292175292969
generate_one_block  0.01494288444519043
generate_one_block  0.015160560607910156
generate_one_block  0.014911174774169922
generate_one_block  0.014191865921020508
generate_one_block  0.015213489532470703
generate_one_block  0.01526188850402832
generate_one_block  0.014245271682739258
generate_one_block  0.014533042907714844
generate_one_block  0.014791011810302734
generate_one_block  0.014844179153442383
generate_one_block  0.014441967010498047
generate_one_block  0.01498723030090332
generate_one_block  0.014882564544677734
generate_one_block  0.014643669128417969
generate_one_block  0.014490365982055664
generate_one_block  0.015047788619995117
generate_one_block  0.014317989349365234
generate_one_block  0.015155315399169922
generate_one_block  0.014642953872680664
generate_one_block  0.015343666076660156
generate_one_block  0.014712095260620117
generate_one_block  0.014962434768676758
generate_one_block  0.015018701553344727
generate_one_block  0.014653682708740234
generate_one_block  0.014479637145996094
generate_one_block  0.016219615936279297
generate_one_block  0.016371726989746094
generate_one_block  0.015829801559448242
generate_one_block  0.014814138412475586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04435467720031738
gen group dst list time:  0.024228811264038086
time for parepare:  0.019121170043945312
local_output_nid generation:  0.004413127899169922
local_in_edges_tensor generation:  0.013386249542236328
mini_batch_src_global generation:  0.017355680465698242
r_  generation:  0.16326546669006348
local_output_nid generation:  0.00705718994140625
local_in_edges_tensor generation:  0.014778852462768555
mini_batch_src_global generation:  0.021823644638061523
r_  generation:  0.16829371452331543
local_output_nid generation:  0.007012128829956055
local_in_edges_tensor generation:  0.011172056198120117
mini_batch_src_global generation:  0.019839763641357422
r_  generation:  0.1771707534790039
local_output_nid generation:  0.007005929946899414
local_in_edges_tensor generation:  0.010363340377807617
mini_batch_src_global generation:  0.025480985641479492
r_  generation:  0.18159246444702148
local_output_nid generation:  0.0072231292724609375
local_in_edges_tensor generation:  0.012013435363769531
mini_batch_src_global generation:  0.021541595458984375
r_  generation:  0.18210816383361816
local_output_nid generation:  0.0074083805084228516
local_in_edges_tensor generation:  0.01230311393737793
mini_batch_src_global generation:  0.024935245513916016
r_  generation:  0.18296027183532715
local_output_nid generation:  0.0070416927337646484
local_in_edges_tensor generation:  0.01015019416809082
mini_batch_src_global generation:  0.021195411682128906
r_  generation:  0.17829322814941406
local_output_nid generation:  0.008410453796386719
local_in_edges_tensor generation:  0.018791675567626953
mini_batch_src_global generation:  0.030621767044067383
r_  generation:  0.18801188468933105
local_output_nid generation:  0.008742570877075195
local_in_edges_tensor generation:  0.013800621032714844
mini_batch_src_global generation:  0.023190975189208984
r_  generation:  0.20180368423461914
local_output_nid generation:  0.007490396499633789
local_in_edges_tensor generation:  0.011347532272338867
mini_batch_src_global generation:  0.02221965789794922
r_  generation:  0.19137358665466309
local_output_nid generation:  0.00786447525024414
local_in_edges_tensor generation:  0.009665966033935547
mini_batch_src_global generation:  0.026523828506469727
r_  generation:  0.19632530212402344
local_output_nid generation:  0.010399103164672852
local_in_edges_tensor generation:  0.028456687927246094
mini_batch_src_global generation:  0.025987863540649414
r_  generation:  0.1794443130493164
local_output_nid generation:  0.007843017578125
local_in_edges_tensor generation:  0.011903762817382812
mini_batch_src_global generation:  0.02471303939819336
r_  generation:  0.18229126930236816
local_output_nid generation:  0.007585048675537109
local_in_edges_tensor generation:  0.009474039077758789
mini_batch_src_global generation:  0.022375822067260742
r_  generation:  0.17834949493408203
local_output_nid generation:  0.007843255996704102
local_in_edges_tensor generation:  0.008954048156738281
mini_batch_src_global generation:  0.025093555450439453
r_  generation:  0.19298672676086426
local_output_nid generation:  0.012178182601928711
local_in_edges_tensor generation:  0.018982410430908203
mini_batch_src_global generation:  0.02462315559387207
r_  generation:  0.1798245906829834
local_output_nid generation:  0.007711648941040039
local_in_edges_tensor generation:  0.011241674423217773
mini_batch_src_global generation:  0.024216413497924805
r_  generation:  0.18235397338867188
local_output_nid generation:  0.007815122604370117
local_in_edges_tensor generation:  0.011065959930419922
mini_batch_src_global generation:  0.022429227828979492
r_  generation:  0.17488455772399902
local_output_nid generation:  0.007921934127807617
local_in_edges_tensor generation:  0.008960962295532227
mini_batch_src_global generation:  0.026590585708618164
r_  generation:  0.1806640625
local_output_nid generation:  0.0077648162841796875
local_in_edges_tensor generation:  0.011645317077636719
mini_batch_src_global generation:  0.0225982666015625
r_  generation:  0.1922471523284912
local_output_nid generation:  0.008116960525512695
local_in_edges_tensor generation:  0.011961221694946289
mini_batch_src_global generation:  0.023035049438476562
r_  generation:  0.18952608108520508
local_output_nid generation:  0.007790088653564453
local_in_edges_tensor generation:  0.010565042495727539
mini_batch_src_global generation:  0.02389693260192871
r_  generation:  0.1848001480102539
local_output_nid generation:  0.009022712707519531
local_in_edges_tensor generation:  0.018424510955810547
mini_batch_src_global generation:  0.025070905685424805
r_  generation:  0.1942281723022461
local_output_nid generation:  0.008858919143676758
local_in_edges_tensor generation:  0.012038469314575195
mini_batch_src_global generation:  0.02620863914489746
r_  generation:  0.18140196800231934
local_output_nid generation:  0.008109807968139648
local_in_edges_tensor generation:  0.010846138000488281
mini_batch_src_global generation:  0.024080753326416016
r_  generation:  0.18449687957763672
local_output_nid generation:  0.007993221282958984
local_in_edges_tensor generation:  0.010081768035888672
mini_batch_src_global generation:  0.023342609405517578
r_  generation:  0.18433332443237305
local_output_nid generation:  0.007861614227294922
local_in_edges_tensor generation:  0.008976936340332031
mini_batch_src_global generation:  0.02268075942993164
r_  generation:  0.17885279655456543
local_output_nid generation:  0.00777888298034668
local_in_edges_tensor generation:  0.008568286895751953
mini_batch_src_global generation:  0.02266860008239746
r_  generation:  0.17883968353271484
local_output_nid generation:  0.008433341979980469
local_in_edges_tensor generation:  0.01253962516784668
mini_batch_src_global generation:  0.024396181106567383
r_  generation:  0.1945812702178955
local_output_nid generation:  0.008020162582397461
local_in_edges_tensor generation:  0.00917816162109375
mini_batch_src_global generation:  0.02341914176940918
r_  generation:  0.18110060691833496
local_output_nid generation:  0.008119583129882812
local_in_edges_tensor generation:  0.008934974670410156
mini_batch_src_global generation:  0.022857189178466797
r_  generation:  0.18212199211120605
local_output_nid generation:  0.008084535598754883
local_in_edges_tensor generation:  0.011819124221801758
mini_batch_src_global generation:  0.02254033088684082
r_  generation:  0.17957043647766113
----------------------check_connections_block total spend ----------------------------- 8.637053489685059
generate_one_block  0.23844480514526367
generate_one_block  0.22673392295837402
generate_one_block  0.24767780303955078
generate_one_block  0.22266793251037598
generate_one_block  0.22934603691101074
generate_one_block  0.2287743091583252
generate_one_block  0.22913789749145508
generate_one_block  0.22789287567138672
generate_one_block  0.2341289520263672
generate_one_block  0.21186232566833496
generate_one_block  0.23580288887023926
generate_one_block  0.22606635093688965
generate_one_block  0.22669601440429688
generate_one_block  0.21634650230407715
generate_one_block  0.2278308868408203
generate_one_block  0.26520395278930664
generate_one_block  0.2354111671447754
generate_one_block  0.21796846389770508
generate_one_block  0.22595524787902832
generate_one_block  0.22040987014770508
generate_one_block  0.23516130447387695
generate_one_block  0.22989773750305176
generate_one_block  0.23875212669372559
generate_one_block  0.22347140312194824
generate_one_block  0.2360219955444336
generate_one_block  0.2342817783355713
generate_one_block  0.22063016891479492
generate_one_block  0.22434782981872559
generate_one_block  0.2865719795227051
generate_one_block  0.22350144386291504
generate_one_block  0.22536349296569824
generate_one_block  0.22838234901428223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05278658866882324
gen group dst list time:  0.10545611381530762
time for parepare:  0.022226572036743164
local_output_nid generation:  0.023157596588134766
local_in_edges_tensor generation:  0.06429886817932129
mini_batch_src_global generation:  0.04035639762878418
r_  generation:  0.41350698471069336
local_output_nid generation:  0.02827310562133789
local_in_edges_tensor generation:  0.04346728324890137
mini_batch_src_global generation:  0.04922676086425781
r_  generation:  0.4195106029510498
local_output_nid generation:  0.028662681579589844
local_in_edges_tensor generation:  0.037836313247680664
mini_batch_src_global generation:  0.0514218807220459
r_  generation:  0.4268174171447754
local_output_nid generation:  0.029799699783325195
local_in_edges_tensor generation:  0.02905559539794922
mini_batch_src_global generation:  0.04897594451904297
r_  generation:  0.42828869819641113
local_output_nid generation:  0.02753281593322754
local_in_edges_tensor generation:  0.03258061408996582
mini_batch_src_global generation:  0.04976224899291992
r_  generation:  0.43364953994750977
local_output_nid generation:  0.029233217239379883
local_in_edges_tensor generation:  0.03364968299865723
mini_batch_src_global generation:  0.055603981018066406
r_  generation:  0.43294239044189453
local_output_nid generation:  0.027250289916992188
local_in_edges_tensor generation:  0.03667116165161133
mini_batch_src_global generation:  0.061840057373046875
r_  generation:  0.42537450790405273
local_output_nid generation:  0.027716398239135742
local_in_edges_tensor generation:  0.03697562217712402
mini_batch_src_global generation:  0.05049896240234375
r_  generation:  0.4378664493560791
local_output_nid generation:  0.030917644500732422
local_in_edges_tensor generation:  0.040776968002319336
mini_batch_src_global generation:  0.051516056060791016
r_  generation:  0.4368927478790283
local_output_nid generation:  0.028450965881347656
local_in_edges_tensor generation:  0.031226396560668945
mini_batch_src_global generation:  0.0505986213684082
r_  generation:  0.4380309581756592
local_output_nid generation:  0.02863025665283203
local_in_edges_tensor generation:  0.029164791107177734
mini_batch_src_global generation:  0.053688764572143555
r_  generation:  0.43408703804016113
local_output_nid generation:  0.028308868408203125
local_in_edges_tensor generation:  0.029120683670043945
mini_batch_src_global generation:  0.0503535270690918
r_  generation:  0.4314262866973877
local_output_nid generation:  0.02881598472595215
local_in_edges_tensor generation:  0.03340482711791992
mini_batch_src_global generation:  0.05051231384277344
r_  generation:  0.4367825984954834
local_output_nid generation:  0.028322458267211914
local_in_edges_tensor generation:  0.02979302406311035
mini_batch_src_global generation:  0.05094575881958008
r_  generation:  0.4307258129119873
local_output_nid generation:  0.02862834930419922
local_in_edges_tensor generation:  0.03662991523742676
mini_batch_src_global generation:  0.05350303649902344
r_  generation:  0.43795132637023926
local_output_nid generation:  0.028742551803588867
local_in_edges_tensor generation:  0.033341169357299805
mini_batch_src_global generation:  0.05057883262634277
r_  generation:  0.4366898536682129
local_output_nid generation:  0.028410673141479492
local_in_edges_tensor generation:  0.0331575870513916
mini_batch_src_global generation:  0.05037236213684082
r_  generation:  0.4344058036804199
local_output_nid generation:  0.029047489166259766
local_in_edges_tensor generation:  0.036947011947631836
mini_batch_src_global generation:  0.05766868591308594
r_  generation:  0.4344775676727295
local_output_nid generation:  0.03079533576965332
local_in_edges_tensor generation:  0.04548239707946777
mini_batch_src_global generation:  0.0565643310546875
r_  generation:  0.4365706443786621
local_output_nid generation:  0.02876114845275879
local_in_edges_tensor generation:  0.030539751052856445
mini_batch_src_global generation:  0.055417537689208984
r_  generation:  0.4367213249206543
local_output_nid generation:  0.02898693084716797
local_in_edges_tensor generation:  0.03450751304626465
mini_batch_src_global generation:  0.053025245666503906
r_  generation:  0.4405076503753662
local_output_nid generation:  0.028940200805664062
local_in_edges_tensor generation:  0.026886701583862305
mini_batch_src_global generation:  0.05375480651855469
r_  generation:  0.43581342697143555
local_output_nid generation:  0.029163360595703125
local_in_edges_tensor generation:  0.035048484802246094
mini_batch_src_global generation:  0.050603628158569336
r_  generation:  0.44043445587158203
local_output_nid generation:  0.0291595458984375
local_in_edges_tensor generation:  0.02648162841796875
mini_batch_src_global generation:  0.05078458786010742
r_  generation:  0.4421820640563965
local_output_nid generation:  0.02972865104675293
local_in_edges_tensor generation:  0.031923532485961914
mini_batch_src_global generation:  0.05004405975341797
r_  generation:  0.4339442253112793
local_output_nid generation:  0.02908611297607422
local_in_edges_tensor generation:  0.037773847579956055
mini_batch_src_global generation:  0.050748586654663086
r_  generation:  0.436326265335083
local_output_nid generation:  0.028902292251586914
local_in_edges_tensor generation:  0.02903151512145996
mini_batch_src_global generation:  0.05003499984741211
r_  generation:  0.4480314254760742
local_output_nid generation:  0.02892756462097168
local_in_edges_tensor generation:  0.03436541557312012
mini_batch_src_global generation:  0.05527949333190918
r_  generation:  0.44188570976257324
local_output_nid generation:  0.0295412540435791
local_in_edges_tensor generation:  0.038295745849609375
mini_batch_src_global generation:  0.05083346366882324
r_  generation:  0.443190336227417
local_output_nid generation:  0.02890801429748535
local_in_edges_tensor generation:  0.02931690216064453
mini_batch_src_global generation:  0.051311492919921875
r_  generation:  0.44150757789611816
local_output_nid generation:  0.030884981155395508
local_in_edges_tensor generation:  0.02855229377746582
mini_batch_src_global generation:  0.0515439510345459
r_  generation:  0.43622612953186035
local_output_nid generation:  0.029015541076660156
local_in_edges_tensor generation:  0.034191131591796875
mini_batch_src_global generation:  0.050243377685546875
r_  generation:  0.440091609954834
----------------------check_connections_block total spend ----------------------------- 20.69846534729004
generate_one_block  0.666914701461792
generate_one_block  0.5601789951324463
generate_one_block  0.5572612285614014
generate_one_block  0.5475826263427734
generate_one_block  0.5546715259552002
generate_one_block  0.5587038993835449
generate_one_block  0.5388195514678955
generate_one_block  0.5583150386810303
generate_one_block  0.5586366653442383
generate_one_block  0.5437312126159668
generate_one_block  0.5517590045928955
generate_one_block  0.5409698486328125
generate_one_block  0.5494534969329834
generate_one_block  0.5936009883880615
generate_one_block  0.561377763748169
generate_one_block  0.5538079738616943
generate_one_block  0.5838546752929688
generate_one_block  0.5523829460144043
generate_one_block  0.5512752532958984
generate_one_block  0.5544764995574951
generate_one_block  0.584303617477417
generate_one_block  0.5490000247955322
generate_one_block  0.590033769607544
generate_one_block  0.5732729434967041
generate_one_block  0.5789220333099365
generate_one_block  0.5578815937042236
generate_one_block  0.5519328117370605
generate_one_block  0.5765891075134277
generate_one_block  0.5854980945587158
generate_one_block  0.5500297546386719
generate_one_block  0.5726392269134521
generate_one_block  0.5558123588562012
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  29.335518836975098
block generation total time  25.464431047439575
average batch blocks generation time:  0.7957634702324867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1737060546875 GB
    Memory Allocated: 0.0861968994140625  GigaBytes
Max Memory Allocated: 0.0861968994140625  GigaBytes

torch.Size([149159, 128])
torch.Size([110646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3592529296875 GB
    Memory Allocated: 11.28358793258667  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.08678913116455078  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

torch.Size([148512, 128])
torch.Size([109239, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.226605892181396  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.0867462158203125  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

torch.Size([148640, 128])
torch.Size([109815, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.238692283630371  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.0866856575012207  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

torch.Size([148519, 128])
torch.Size([109014, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.185410976409912  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08691692352294922  GigaBytes
Max Memory Allocated: 11.293406963348389  GigaBytes

torch.Size([148632, 128])
torch.Size([110198, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.286565780639648  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08702468872070312  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

torch.Size([148908, 128])
torch.Size([110097, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.2388277053833  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08622169494628906  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

torch.Size([147964, 128])
torch.Size([107616, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 10.98902416229248  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08724451065063477  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

torch.Size([149371, 128])
torch.Size([110174, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.272109508514404  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08708477020263672  GigaBytes
Max Memory Allocated: 11.296911716461182  GigaBytes

torch.Size([148944, 128])
torch.Size([110491, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.288205623626709  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08677053451538086  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([149115, 128])
torch.Size([109311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.126533508300781  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08676004409790039  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148513, 128])
torch.Size([109139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.2493896484375  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08644390106201172  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148156, 128])
torch.Size([108548, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.139376640319824  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08685493469238281  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148828, 128])
torch.Size([109824, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.236991882324219  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.0865941047668457  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148695, 128])
torch.Size([108785, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.018180847167969  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08695173263549805  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148887, 128])
torch.Size([110404, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.259297370910645  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.0870060920715332  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148999, 128])
torch.Size([109882, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.217515468597412  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.086761474609375  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148430, 128])
torch.Size([109348, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.20934534072876  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08681154251098633  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148981, 128])
torch.Size([109645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.15595531463623  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08693361282348633  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148793, 128])
torch.Size([109807, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.248848915100098  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08687114715576172  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([148928, 128])
torch.Size([109789, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.197092056274414  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08735990524291992  GigaBytes
Max Memory Allocated: 11.299264430999756  GigaBytes

torch.Size([149465, 128])
torch.Size([110750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.310326099395752  GigaBytes
Max Memory Allocated: 11.319759845733643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08690214157104492  GigaBytes
Max Memory Allocated: 11.319759845733643  GigaBytes

torch.Size([148673, 128])
torch.Size([109719, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 11.243080615997314  GigaBytes
Max Memory Allocated: 11.319759845733643  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6072998046875 GB
    Memory Allocated: 0.08727407455444336  GigaBytes
Max Memory Allocated: 11.319759845733643  GigaBytes

torch.Size([149051, 128])
torch.Size([111026, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 11.365705490112305  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.08708667755126953  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

torch.Size([149214, 128])
torch.Size([110080, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 11.213905811309814  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.08701753616333008  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

torch.Size([148821, 128])
torch.Size([109846, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 11.247761726379395  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.08696413040161133  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

torch.Size([148641, 128])
torch.Size([110250, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 11.306731224060059  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.0868692398071289  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

torch.Size([148948, 128])
torch.Size([109545, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 11.210174560546875  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.08709716796875  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

torch.Size([149120, 128])
torch.Size([110537, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 11.293887615203857  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2713623046875 GB
    Memory Allocated: 0.08768939971923828  GigaBytes
Max Memory Allocated: 11.377212524414062  GigaBytes

torch.Size([149382, 128])
torch.Size([111626, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.457425117492676  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08689165115356445  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148841, 128])
torch.Size([109597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.19840955734253  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08680152893066406  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148624, 128])
torch.Size([109522, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.21822452545166  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08695268630981445  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148901, 128])
torch.Size([110196, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.263933181762695  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.036973364651203156 |0.03432583063840866 |0.558825358748436 |0.00011263042688369751 |0.8682493194937706 |0.0142059326171875 |
----------------------------------------------------------pseudo_mini_loss sum 4.40339469909668
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9117005
Number of first layer input nodes during this epoch:  4762655
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.10825157165527344  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03171515464782715
range selection method range initialization spend 0.01684737205505371
time for parepare:  0.0186154842376709
local_output_nid generation:  0.0009984970092773438
local_in_edges_tensor generation:  0.004054546356201172
mini_batch_src_global generation:  0.0021829605102539062
r_  generation:  0.01220083236694336
local_output_nid generation:  0.0010178089141845703
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0015707015991210938
r_  generation:  0.010726213455200195
local_output_nid generation:  0.0009822845458984375
local_in_edges_tensor generation:  0.0006663799285888672
mini_batch_src_global generation:  0.0011627674102783203
r_  generation:  0.009964227676391602
local_output_nid generation:  0.0009377002716064453
local_in_edges_tensor generation:  0.0006351470947265625
mini_batch_src_global generation:  0.0011248588562011719
r_  generation:  0.010049581527709961
local_output_nid generation:  0.0009086132049560547
local_in_edges_tensor generation:  0.0006453990936279297
mini_batch_src_global generation:  0.0011653900146484375
r_  generation:  0.00983738899230957
local_output_nid generation:  0.0009310245513916016
local_in_edges_tensor generation:  0.0006029605865478516
mini_batch_src_global generation:  0.0011570453643798828
r_  generation:  0.010190963745117188
local_output_nid generation:  0.0009095668792724609
local_in_edges_tensor generation:  0.0006363391876220703
mini_batch_src_global generation:  0.0011849403381347656
r_  generation:  0.00999593734741211
local_output_nid generation:  0.0009071826934814453
local_in_edges_tensor generation:  0.0006043910980224609
mini_batch_src_global generation:  0.0011017322540283203
r_  generation:  0.010172367095947266
local_output_nid generation:  0.0009064674377441406
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.001184225082397461
r_  generation:  0.010172367095947266
local_output_nid generation:  0.0009160041809082031
local_in_edges_tensor generation:  0.0006031990051269531
mini_batch_src_global generation:  0.001191854476928711
r_  generation:  0.010310888290405273
local_output_nid generation:  0.0009353160858154297
local_in_edges_tensor generation:  0.0006113052368164062
mini_batch_src_global generation:  0.0011336803436279297
r_  generation:  0.010097026824951172
local_output_nid generation:  0.0009036064147949219
local_in_edges_tensor generation:  0.0006039142608642578
mini_batch_src_global generation:  0.0011696815490722656
r_  generation:  0.010455608367919922
local_output_nid generation:  0.0009026527404785156
local_in_edges_tensor generation:  0.0006351470947265625
mini_batch_src_global generation:  0.0012116432189941406
r_  generation:  0.010126590728759766
local_output_nid generation:  0.0009133815765380859
local_in_edges_tensor generation:  0.0006124973297119141
mini_batch_src_global generation:  0.001148223876953125
r_  generation:  0.010471343994140625
local_output_nid generation:  0.0009307861328125
local_in_edges_tensor generation:  0.0006251335144042969
mini_batch_src_global generation:  0.0011675357818603516
r_  generation:  0.010289192199707031
local_output_nid generation:  0.0009233951568603516
local_in_edges_tensor generation:  0.0006186962127685547
mini_batch_src_global generation:  0.0011763572692871094
r_  generation:  0.010232686996459961
local_output_nid generation:  0.0009541511535644531
local_in_edges_tensor generation:  0.0006647109985351562
mini_batch_src_global generation:  0.0011987686157226562
r_  generation:  0.010513544082641602
local_output_nid generation:  0.0008959770202636719
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.001184701919555664
r_  generation:  0.010100841522216797
local_output_nid generation:  0.000949859619140625
local_in_edges_tensor generation:  0.0005979537963867188
mini_batch_src_global generation:  0.0011920928955078125
r_  generation:  0.010549306869506836
local_output_nid generation:  0.0009021759033203125
local_in_edges_tensor generation:  0.0005986690521240234
mini_batch_src_global generation:  0.0011529922485351562
r_  generation:  0.010117530822753906
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.000606536865234375
mini_batch_src_global generation:  0.0012328624725341797
r_  generation:  0.010534286499023438
local_output_nid generation:  0.0009162425994873047
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0012023448944091797
r_  generation:  0.010395288467407227
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.001262664794921875
r_  generation:  0.010528802871704102
local_output_nid generation:  0.0009164810180664062
local_in_edges_tensor generation:  0.0005872249603271484
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.010529041290283203
local_output_nid generation:  0.0009043216705322266
local_in_edges_tensor generation:  0.0006041526794433594
mini_batch_src_global generation:  0.0011768341064453125
r_  generation:  0.010040760040283203
local_output_nid generation:  0.0009083747863769531
local_in_edges_tensor generation:  0.0005905628204345703
mini_batch_src_global generation:  0.0012316703796386719
r_  generation:  0.010547161102294922
local_output_nid generation:  0.0008985996246337891
local_in_edges_tensor generation:  0.0005974769592285156
mini_batch_src_global generation:  0.0011830329895019531
r_  generation:  0.01047372817993164
local_output_nid generation:  0.0008974075317382812
local_in_edges_tensor generation:  0.0006234645843505859
mini_batch_src_global generation:  0.0012135505676269531
r_  generation:  0.010265111923217773
local_output_nid generation:  0.0009031295776367188
local_in_edges_tensor generation:  0.0005877017974853516
mini_batch_src_global generation:  0.0011594295501708984
r_  generation:  0.01030588150024414
local_output_nid generation:  0.0009188652038574219
local_in_edges_tensor generation:  0.0006444454193115234
mini_batch_src_global generation:  0.0012469291687011719
r_  generation:  0.010702848434448242
local_output_nid generation:  0.0009002685546875
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0013570785522460938
r_  generation:  0.010236501693725586
local_output_nid generation:  0.0009393692016601562
local_in_edges_tensor generation:  0.0005962848663330078
mini_batch_src_global generation:  0.0011730194091796875
r_  generation:  0.010487556457519531
----------------------check_connections_block total spend ----------------------------- 0.5233733654022217
generate_one_block  0.02535557746887207
generate_one_block  0.02113938331604004
generate_one_block  0.018925189971923828
generate_one_block  0.018544673919677734
generate_one_block  0.01816534996032715
generate_one_block  0.0186007022857666
generate_one_block  0.018099308013916016
generate_one_block  0.018248558044433594
generate_one_block  0.018311738967895508
generate_one_block  0.018173933029174805
generate_one_block  0.017572641372680664
generate_one_block  0.018531322479248047
generate_one_block  0.018232107162475586
generate_one_block  0.018500804901123047
generate_one_block  0.018305540084838867
generate_one_block  0.018065929412841797
generate_one_block  0.018813371658325195
generate_one_block  0.01817035675048828
generate_one_block  0.018686532974243164
generate_one_block  0.018163442611694336
generate_one_block  0.018695831298828125
generate_one_block  0.018280982971191406
generate_one_block  0.018692970275878906
generate_one_block  0.018384933471679688
generate_one_block  0.018078088760375977
generate_one_block  0.018674612045288086
generate_one_block  0.01864147186279297
generate_one_block  0.018253803253173828
generate_one_block  0.01817488670349121
generate_one_block  0.019142866134643555
generate_one_block  0.018213748931884766
generate_one_block  0.018796443939208984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04438948631286621
gen group dst list time:  0.024566173553466797
time for parepare:  0.0208437442779541
local_output_nid generation:  0.0056078433990478516
local_in_edges_tensor generation:  0.01362156867980957
mini_batch_src_global generation:  0.018616914749145508
r_  generation:  0.16366243362426758
local_output_nid generation:  0.00989079475402832
local_in_edges_tensor generation:  0.011394739151000977
mini_batch_src_global generation:  0.0236361026763916
r_  generation:  0.17799901962280273
local_output_nid generation:  0.010449409484863281
local_in_edges_tensor generation:  0.030626535415649414
mini_batch_src_global generation:  0.01959061622619629
r_  generation:  0.17310214042663574
local_output_nid generation:  0.010663509368896484
local_in_edges_tensor generation:  0.010149240493774414
mini_batch_src_global generation:  0.022116899490356445
r_  generation:  0.1814720630645752
local_output_nid generation:  0.011042356491088867
local_in_edges_tensor generation:  0.011245965957641602
mini_batch_src_global generation:  0.02147841453552246
r_  generation:  0.1832125186920166
local_output_nid generation:  0.011454582214355469
local_in_edges_tensor generation:  0.010163068771362305
mini_batch_src_global generation:  0.023318052291870117
r_  generation:  0.17992115020751953
local_output_nid generation:  0.011284351348876953
local_in_edges_tensor generation:  0.00886988639831543
mini_batch_src_global generation:  0.021826505661010742
r_  generation:  0.1763477325439453
local_output_nid generation:  0.011161565780639648
local_in_edges_tensor generation:  0.008828163146972656
mini_batch_src_global generation:  0.02248978614807129
r_  generation:  0.178131103515625
local_output_nid generation:  0.011155843734741211
local_in_edges_tensor generation:  0.011691808700561523
mini_batch_src_global generation:  0.022616147994995117
r_  generation:  0.18314838409423828
local_output_nid generation:  0.013309001922607422
local_in_edges_tensor generation:  0.008922338485717773
mini_batch_src_global generation:  0.0223081111907959
r_  generation:  0.18802309036254883
local_output_nid generation:  0.0125732421875
local_in_edges_tensor generation:  0.009336471557617188
mini_batch_src_global generation:  0.02166914939880371
r_  generation:  0.17987298965454102
local_output_nid generation:  0.012044191360473633
local_in_edges_tensor generation:  0.01995372772216797
mini_batch_src_global generation:  0.0314176082611084
r_  generation:  0.18754911422729492
local_output_nid generation:  0.01327371597290039
local_in_edges_tensor generation:  0.011438846588134766
mini_batch_src_global generation:  0.022336721420288086
r_  generation:  0.1839601993560791
local_output_nid generation:  0.012410402297973633
local_in_edges_tensor generation:  0.010934829711914062
mini_batch_src_global generation:  0.02429509162902832
r_  generation:  0.18567824363708496
local_output_nid generation:  0.012106895446777344
local_in_edges_tensor generation:  0.012420892715454102
mini_batch_src_global generation:  0.022778749465942383
r_  generation:  0.18454694747924805
local_output_nid generation:  0.012043952941894531
local_in_edges_tensor generation:  0.009511232376098633
mini_batch_src_global generation:  0.022245407104492188
r_  generation:  0.18173980712890625
local_output_nid generation:  0.01249837875366211
local_in_edges_tensor generation:  0.009606599807739258
mini_batch_src_global generation:  0.024531126022338867
r_  generation:  0.18937420845031738
local_output_nid generation:  0.012176990509033203
local_in_edges_tensor generation:  0.009627103805541992
mini_batch_src_global generation:  0.022889375686645508
r_  generation:  0.17920279502868652
local_output_nid generation:  0.01192331314086914
local_in_edges_tensor generation:  0.009682178497314453
mini_batch_src_global generation:  0.02318096160888672
r_  generation:  0.1863851547241211
local_output_nid generation:  0.011806249618530273
local_in_edges_tensor generation:  0.013800859451293945
mini_batch_src_global generation:  0.0230257511138916
r_  generation:  0.1842508316040039
local_output_nid generation:  0.012090444564819336
local_in_edges_tensor generation:  0.011127471923828125
mini_batch_src_global generation:  0.024413347244262695
r_  generation:  0.19127345085144043
local_output_nid generation:  0.012101173400878906
local_in_edges_tensor generation:  0.011016607284545898
mini_batch_src_global generation:  0.023162841796875
r_  generation:  0.18298697471618652
local_output_nid generation:  0.011901617050170898
local_in_edges_tensor generation:  0.010973453521728516
mini_batch_src_global generation:  0.023211956024169922
r_  generation:  0.18670058250427246
local_output_nid generation:  0.011906862258911133
local_in_edges_tensor generation:  0.01076507568359375
mini_batch_src_global generation:  0.0231020450592041
r_  generation:  0.18294024467468262
local_output_nid generation:  0.011800289154052734
local_in_edges_tensor generation:  0.009153604507446289
mini_batch_src_global generation:  0.02252340316772461
r_  generation:  0.18826723098754883
local_output_nid generation:  0.012098312377929688
local_in_edges_tensor generation:  0.012339353561401367
mini_batch_src_global generation:  0.02351975440979004
r_  generation:  0.19057345390319824
local_output_nid generation:  0.01209259033203125
local_in_edges_tensor generation:  0.013848304748535156
mini_batch_src_global generation:  0.023611068725585938
r_  generation:  0.19251608848571777
local_output_nid generation:  0.011875629425048828
local_in_edges_tensor generation:  0.009408950805664062
mini_batch_src_global generation:  0.02280282974243164
r_  generation:  0.1931915283203125
local_output_nid generation:  0.011634349822998047
local_in_edges_tensor generation:  0.009388208389282227
mini_batch_src_global generation:  0.025117874145507812
r_  generation:  0.18346047401428223
local_output_nid generation:  0.012487411499023438
local_in_edges_tensor generation:  0.009615659713745117
mini_batch_src_global generation:  0.023780345916748047
r_  generation:  0.1939859390258789
local_output_nid generation:  0.011847257614135742
local_in_edges_tensor generation:  0.012340068817138672
mini_batch_src_global generation:  0.022922277450561523
r_  generation:  0.18693923950195312
local_output_nid generation:  0.012323379516601562
local_in_edges_tensor generation:  0.012542247772216797
mini_batch_src_global generation:  0.02513885498046875
r_  generation:  0.19281363487243652
----------------------check_connections_block total spend ----------------------------- 8.732421398162842
generate_one_block  0.2612175941467285
generate_one_block  0.2563331127166748
generate_one_block  0.2542417049407959
generate_one_block  0.2676568031311035
generate_one_block  0.2791256904602051
generate_one_block  0.24394536018371582
generate_one_block  0.23583531379699707
generate_one_block  0.2416093349456787
generate_one_block  0.243818998336792
generate_one_block  0.232804536819458
generate_one_block  0.23251557350158691
generate_one_block  0.24704599380493164
generate_one_block  0.24425125122070312
generate_one_block  0.2504134178161621
generate_one_block  0.2475266456604004
generate_one_block  0.2445688247680664
generate_one_block  0.2576282024383545
generate_one_block  0.2607572078704834
generate_one_block  0.24286460876464844
generate_one_block  0.25134968757629395
generate_one_block  0.2541313171386719
generate_one_block  0.2428727149963379
generate_one_block  0.2482891082763672
generate_one_block  0.2451341152191162
generate_one_block  0.24177813529968262
generate_one_block  0.25884485244750977
generate_one_block  0.2515695095062256
generate_one_block  0.24241328239440918
generate_one_block  0.23880767822265625
generate_one_block  0.25481104850769043
generate_one_block  0.24321866035461426
generate_one_block  0.26006078720092773
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038663625717163086
gen group dst list time:  0.10645079612731934
time for parepare:  0.018362045288085938
local_output_nid generation:  0.026916027069091797
local_in_edges_tensor generation:  0.0520174503326416
mini_batch_src_global generation:  0.04159188270568848
r_  generation:  0.42125606536865234
local_output_nid generation:  0.032118797302246094
local_in_edges_tensor generation:  0.04543733596801758
mini_batch_src_global generation:  0.0532529354095459
r_  generation:  0.4303417205810547
local_output_nid generation:  0.030003070831298828
local_in_edges_tensor generation:  0.045772552490234375
mini_batch_src_global generation:  0.05057048797607422
r_  generation:  0.44281482696533203
local_output_nid generation:  0.029738664627075195
local_in_edges_tensor generation:  0.04565715789794922
mini_batch_src_global generation:  0.05239391326904297
r_  generation:  0.44526004791259766
local_output_nid generation:  0.032865285873413086
local_in_edges_tensor generation:  0.0351107120513916
mini_batch_src_global generation:  0.05530142784118652
r_  generation:  0.43706417083740234
local_output_nid generation:  0.029744386672973633
local_in_edges_tensor generation:  0.034618377685546875
mini_batch_src_global generation:  0.05008244514465332
r_  generation:  0.4323127269744873
local_output_nid generation:  0.02960062026977539
local_in_edges_tensor generation:  0.03596067428588867
mini_batch_src_global generation:  0.05087900161743164
r_  generation:  0.43953442573547363
local_output_nid generation:  0.02949047088623047
local_in_edges_tensor generation:  0.03512716293334961
mini_batch_src_global generation:  0.05060100555419922
r_  generation:  0.43523335456848145
local_output_nid generation:  0.0300900936126709
local_in_edges_tensor generation:  0.03565049171447754
mini_batch_src_global generation:  0.050694942474365234
r_  generation:  0.4391634464263916
local_output_nid generation:  0.029943227767944336
local_in_edges_tensor generation:  0.03474998474121094
mini_batch_src_global generation:  0.05105710029602051
r_  generation:  0.4342927932739258
local_output_nid generation:  0.029635190963745117
local_in_edges_tensor generation:  0.03442049026489258
mini_batch_src_global generation:  0.05277061462402344
r_  generation:  0.4522280693054199
local_output_nid generation:  0.030051469802856445
local_in_edges_tensor generation:  0.03986930847167969
mini_batch_src_global generation:  0.05062460899353027
r_  generation:  0.43779635429382324
local_output_nid generation:  0.029883861541748047
local_in_edges_tensor generation:  0.041886091232299805
mini_batch_src_global generation:  0.05022239685058594
r_  generation:  0.4370005130767822
local_output_nid generation:  0.030282258987426758
local_in_edges_tensor generation:  0.03488492965698242
mini_batch_src_global generation:  0.0513463020324707
r_  generation:  0.4419713020324707
local_output_nid generation:  0.030123233795166016
local_in_edges_tensor generation:  0.03474140167236328
mini_batch_src_global generation:  0.05066728591918945
r_  generation:  0.4407196044921875
local_output_nid generation:  0.030132532119750977
local_in_edges_tensor generation:  0.03476905822753906
mini_batch_src_global generation:  0.050783395767211914
r_  generation:  0.4432647228240967
local_output_nid generation:  0.030214309692382812
local_in_edges_tensor generation:  0.0349881649017334
mini_batch_src_global generation:  0.050771236419677734
r_  generation:  0.44534897804260254
local_output_nid generation:  0.02983546257019043
local_in_edges_tensor generation:  0.034926414489746094
mini_batch_src_global generation:  0.05073690414428711
r_  generation:  0.4368870258331299
local_output_nid generation:  0.029891252517700195
local_in_edges_tensor generation:  0.038511037826538086
mini_batch_src_global generation:  0.05017495155334473
r_  generation:  0.440415620803833
local_output_nid generation:  0.029695749282836914
local_in_edges_tensor generation:  0.03507351875305176
mini_batch_src_global generation:  0.05069875717163086
r_  generation:  0.4353160858154297
local_output_nid generation:  0.030020713806152344
local_in_edges_tensor generation:  0.03494715690612793
mini_batch_src_global generation:  0.050501346588134766
r_  generation:  0.44641542434692383
local_output_nid generation:  0.030123233795166016
local_in_edges_tensor generation:  0.0385739803314209
mini_batch_src_global generation:  0.05402970314025879
r_  generation:  0.4386870861053467
local_output_nid generation:  0.031098365783691406
local_in_edges_tensor generation:  0.031624555587768555
mini_batch_src_global generation:  0.0508265495300293
r_  generation:  0.4340682029724121
local_output_nid generation:  0.0298919677734375
local_in_edges_tensor generation:  0.03319072723388672
mini_batch_src_global generation:  0.053766489028930664
r_  generation:  0.43654441833496094
local_output_nid generation:  0.029906749725341797
local_in_edges_tensor generation:  0.0389552116394043
mini_batch_src_global generation:  0.04998373985290527
r_  generation:  0.43578243255615234
local_output_nid generation:  0.03012537956237793
local_in_edges_tensor generation:  0.03881430625915527
mini_batch_src_global generation:  0.05261707305908203
r_  generation:  0.44389867782592773
local_output_nid generation:  0.0300600528717041
local_in_edges_tensor generation:  0.04312467575073242
mini_batch_src_global generation:  0.05098104476928711
r_  generation:  0.4418942928314209
local_output_nid generation:  0.030237674713134766
local_in_edges_tensor generation:  0.03308391571044922
mini_batch_src_global generation:  0.050615787506103516
r_  generation:  0.44119811058044434
local_output_nid generation:  0.02988910675048828
local_in_edges_tensor generation:  0.029439687728881836
mini_batch_src_global generation:  0.05313706398010254
r_  generation:  0.4373598098754883
local_output_nid generation:  0.031093358993530273
local_in_edges_tensor generation:  0.03289437294006348
mini_batch_src_global generation:  0.05096721649169922
r_  generation:  0.44523143768310547
local_output_nid generation:  0.03022623062133789
local_in_edges_tensor generation:  0.038912296295166016
mini_batch_src_global generation:  0.05019807815551758
r_  generation:  0.4440474510192871
local_output_nid generation:  0.030267000198364258
local_in_edges_tensor generation:  0.0331113338470459
mini_batch_src_global generation:  0.0516819953918457
r_  generation:  0.4646456241607666
----------------------check_connections_block total spend ----------------------------- 20.97957181930542
generate_one_block  0.6011991500854492
generate_one_block  0.5856084823608398
generate_one_block  0.5836255550384521
generate_one_block  0.5922551155090332
generate_one_block  0.6824564933776855
generate_one_block  0.5889856815338135
generate_one_block  0.5866529941558838
generate_one_block  0.5834853649139404
generate_one_block  0.5859506130218506
generate_one_block  0.572674036026001
generate_one_block  0.5695953369140625
generate_one_block  0.5857479572296143
generate_one_block  0.5731072425842285
generate_one_block  0.59623122215271
generate_one_block  0.570490837097168
generate_one_block  0.5817253589630127
generate_one_block  0.5876646041870117
generate_one_block  0.5695595741271973
generate_one_block  0.5798399448394775
generate_one_block  0.5702764987945557
generate_one_block  0.5920751094818115
generate_one_block  0.5920207500457764
generate_one_block  0.5678896903991699
generate_one_block  0.5717575550079346
generate_one_block  0.5955955982208252
generate_one_block  0.5878605842590332
generate_one_block  0.5906879901885986
generate_one_block  0.5778615474700928
generate_one_block  0.5714213848114014
generate_one_block  0.5909872055053711
generate_one_block  0.578253984451294
generate_one_block  0.5897009372711182
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.10825157165527344  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

connection checking time:  29.71199321746826
block generation total time  26.730685472488403
average batch blocks generation time:  0.8353339210152626
block dataloader generation time/epoch 60.03816080093384
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08799600601196289  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148704, 128])
torch.Size([109469, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.169618129730225  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.0881814956665039  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148718, 128])
torch.Size([110030, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.264816284179688  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08817481994628906  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149040, 128])
torch.Size([110229, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.244079113006592  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.0883326530456543  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149007, 128])
torch.Size([110712, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.314001560211182  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08777999877929688  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148238, 128])
torch.Size([108682, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.182517051696777  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.0882711410522461  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149014, 128])
torch.Size([110310, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.254394054412842  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08819293975830078  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149200, 128])
torch.Size([110158, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.215954780578613  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08791065216064453  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148550, 128])
torch.Size([109058, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.15395736694336  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08814287185668945  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148917, 128])
torch.Size([110427, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.270493984222412  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08796072006225586  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148841, 128])
torch.Size([109710, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.195150375366211  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08779335021972656  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148632, 128])
torch.Size([108701, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.100777626037598  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08798646926879883  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148531, 128])
torch.Size([109904, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.240694999694824  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08758401870727539  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([147959, 128])
torch.Size([108625, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.125146389007568  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08843564987182617  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149227, 128])
torch.Size([110576, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.30126667022705  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08815240859985352  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148883, 128])
torch.Size([109833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.246114253997803  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.0879983901977539  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148720, 128])
torch.Size([109457, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.193516731262207  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.0884242057800293  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149081, 128])
torch.Size([110187, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.3154878616333  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08792400360107422  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148766, 128])
torch.Size([109290, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.160840511322021  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08820486068725586  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148891, 128])
torch.Size([109833, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.259160041809082  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08803558349609375  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148754, 128])
torch.Size([109017, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.176542282104492  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08818674087524414  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148673, 128])
torch.Size([109850, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.289570331573486  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08819055557250977  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148887, 128])
torch.Size([110296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.2755446434021  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08799219131469727  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148497, 128])
torch.Size([108922, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.181411743164062  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08805465698242188  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148746, 128])
torch.Size([109453, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.18349027633667  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08809137344360352  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148825, 128])
torch.Size([109845, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.243756771087646  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08838605880737305  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148969, 128])
torch.Size([110070, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.31541633605957  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08845281600952148  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149193, 128])
torch.Size([110508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.31783151626587  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08830833435058594  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149186, 128])
torch.Size([110207, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.267871379852295  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08787965774536133  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148577, 128])
torch.Size([108987, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.157275676727295  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.0884242057800293  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148971, 128])
torch.Size([110609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.329765796661377  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08827352523803711  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([149179, 128])
torch.Size([110101, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.221286296844482  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 0.08825874328613281  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

torch.Size([148626, 128])
torch.Size([109639, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9686279296875 GB
    Memory Allocated: 11.332775592803955  GigaBytes
Max Memory Allocated: 11.467130184173584  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026972971856594086 |0.019446007907390594 |0.5362236201763153 |9.800493717193604e-05 |0.8554611057043076 |0.003220796585083008 |
----------------------------------------------------------pseudo_mini_loss sum 3.6974918842315674
Total (block generation + training)time/epoch 106.12112641334534
Training time/epoch 46.08271145820618
Training time without block to device /epoch 45.46043920516968
Training time without total dataloading part /epoch 44.54026818275452
load block tensor time/epoch 0.8631350994110107
block to device time/epoch 0.622272253036499
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9115025
Number of first layer input nodes during this epoch:  4762002
