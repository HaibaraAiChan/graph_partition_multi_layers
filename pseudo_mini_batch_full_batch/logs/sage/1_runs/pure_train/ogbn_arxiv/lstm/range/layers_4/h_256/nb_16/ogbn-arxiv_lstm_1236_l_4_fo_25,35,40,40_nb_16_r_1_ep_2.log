Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648490298.5762842
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.007684230804443359  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.023694515228271484
range selection method range initialization spend 0.01366567611694336
time for parepare:  0.017693042755126953
local_output_nid generation:  0.0013196468353271484
local_in_edges_tensor generation:  0.0031328201293945312
mini_batch_src_global generation:  0.0017249584197998047
r_  generation:  0.018596649169921875
local_output_nid generation:  0.0015103816986083984
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0021288394927978516
r_  generation:  0.018398523330688477
local_output_nid generation:  0.0015172958374023438
local_in_edges_tensor generation:  0.0009109973907470703
mini_batch_src_global generation:  0.0013279914855957031
r_  generation:  0.01785445213317871
local_output_nid generation:  0.0015363693237304688
local_in_edges_tensor generation:  0.0008325576782226562
mini_batch_src_global generation:  0.0013244152069091797
r_  generation:  0.017986059188842773
local_output_nid generation:  0.0015175342559814453
local_in_edges_tensor generation:  0.0008647441864013672
mini_batch_src_global generation:  0.0013356208801269531
r_  generation:  0.01813054084777832
local_output_nid generation:  0.0015707015991210938
local_in_edges_tensor generation:  0.00084686279296875
mini_batch_src_global generation:  0.0013856887817382812
r_  generation:  0.018935203552246094
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.0008358955383300781
mini_batch_src_global generation:  0.0013790130615234375
r_  generation:  0.018566608428955078
local_output_nid generation:  0.0015063285827636719
local_in_edges_tensor generation:  0.0008435249328613281
mini_batch_src_global generation:  0.001413106918334961
r_  generation:  0.019099712371826172
local_output_nid generation:  0.0015192031860351562
local_in_edges_tensor generation:  0.0008463859558105469
mini_batch_src_global generation:  0.00139617919921875
r_  generation:  0.018948793411254883
local_output_nid generation:  0.001600027084350586
local_in_edges_tensor generation:  0.0008871555328369141
mini_batch_src_global generation:  0.0013988018035888672
r_  generation:  0.0190584659576416
local_output_nid generation:  0.001508474349975586
local_in_edges_tensor generation:  0.0008103847503662109
mini_batch_src_global generation:  0.0014863014221191406
r_  generation:  0.019593477249145508
local_output_nid generation:  0.0015437602996826172
local_in_edges_tensor generation:  0.0008158683776855469
mini_batch_src_global generation:  0.0014986991882324219
r_  generation:  0.019367456436157227
local_output_nid generation:  0.00154876708984375
local_in_edges_tensor generation:  0.0008394718170166016
mini_batch_src_global generation:  0.001451730728149414
r_  generation:  0.0191037654876709
local_output_nid generation:  0.0015096664428710938
local_in_edges_tensor generation:  0.0008287429809570312
mini_batch_src_global generation:  0.0014109611511230469
r_  generation:  0.019105911254882812
local_output_nid generation:  0.0015087127685546875
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0014638900756835938
r_  generation:  0.018856525421142578
local_output_nid generation:  0.0015311241149902344
local_in_edges_tensor generation:  0.0008294582366943359
mini_batch_src_global generation:  0.0014743804931640625
r_  generation:  0.01974177360534668
----------------------check_connections_block total spend ----------------------------- 0.450272798538208
generate_one_block  0.026900053024291992
generate_one_block  0.028230905532836914
generate_one_block  0.027230262756347656
generate_one_block  0.02869892120361328
generate_one_block  0.027753114700317383
generate_one_block  0.027971982955932617
generate_one_block  0.027298450469970703
generate_one_block  0.028293848037719727
generate_one_block  0.02729320526123047
generate_one_block  0.02799248695373535
generate_one_block  0.028399944305419922
generate_one_block  0.027988195419311523
generate_one_block  0.0277407169342041
generate_one_block  0.027719974517822266
generate_one_block  0.027344703674316406
generate_one_block  0.028020858764648438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.038681745529174805
gen group dst list time:  0.018741130828857422
time for parepare:  0.01914191246032715
local_output_nid generation:  0.006520748138427734
local_in_edges_tensor generation:  0.014721870422363281
mini_batch_src_global generation:  0.01977705955505371
r_  generation:  0.1988050937652588
local_output_nid generation:  0.010538339614868164
local_in_edges_tensor generation:  0.018021821975708008
mini_batch_src_global generation:  0.025166034698486328
r_  generation:  0.20494580268859863
local_output_nid generation:  0.010843753814697266
local_in_edges_tensor generation:  0.011099100112915039
mini_batch_src_global generation:  0.023778915405273438
r_  generation:  0.2123253345489502
local_output_nid generation:  0.011295080184936523
local_in_edges_tensor generation:  0.014713764190673828
mini_batch_src_global generation:  0.024699687957763672
r_  generation:  0.20681428909301758
local_output_nid generation:  0.011602163314819336
local_in_edges_tensor generation:  0.014880895614624023
mini_batch_src_global generation:  0.02577066421508789
r_  generation:  0.21057391166687012
local_output_nid generation:  0.011803865432739258
local_in_edges_tensor generation:  0.013151884078979492
mini_batch_src_global generation:  0.0278470516204834
r_  generation:  0.2164163589477539
local_output_nid generation:  0.011611700057983398
local_in_edges_tensor generation:  0.01338958740234375
mini_batch_src_global generation:  0.026430130004882812
r_  generation:  0.2084674835205078
local_output_nid generation:  0.012012481689453125
local_in_edges_tensor generation:  0.017736434936523438
mini_batch_src_global generation:  0.02742600440979004
r_  generation:  0.21717238426208496
local_output_nid generation:  0.01176142692565918
local_in_edges_tensor generation:  0.012016773223876953
mini_batch_src_global generation:  0.026419639587402344
r_  generation:  0.20999550819396973
local_output_nid generation:  0.012001752853393555
local_in_edges_tensor generation:  0.012258768081665039
mini_batch_src_global generation:  0.02704787254333496
r_  generation:  0.21602821350097656
local_output_nid generation:  0.012142658233642578
local_in_edges_tensor generation:  0.017446279525756836
mini_batch_src_global generation:  0.029083251953125
r_  generation:  0.2180190086364746
local_output_nid generation:  0.012153148651123047
local_in_edges_tensor generation:  0.01218414306640625
mini_batch_src_global generation:  0.027035951614379883
r_  generation:  0.21651482582092285
local_output_nid generation:  0.01207423210144043
local_in_edges_tensor generation:  0.012056827545166016
mini_batch_src_global generation:  0.027221202850341797
r_  generation:  0.21564006805419922
local_output_nid generation:  0.012034177780151367
local_in_edges_tensor generation:  0.013844490051269531
mini_batch_src_global generation:  0.026906490325927734
r_  generation:  0.21538019180297852
local_output_nid generation:  0.01214146614074707
local_in_edges_tensor generation:  0.01574420928955078
mini_batch_src_global generation:  0.02854180335998535
r_  generation:  0.21585631370544434
local_output_nid generation:  0.012288331985473633
local_in_edges_tensor generation:  0.014003753662109375
mini_batch_src_global generation:  0.029107332229614258
r_  generation:  0.21821165084838867
----------------------check_connections_block total spend ----------------------------- 5.000816345214844
generate_one_block  0.2813875675201416
generate_one_block  0.2802083492279053
generate_one_block  0.27944183349609375
generate_one_block  0.27538204193115234
generate_one_block  0.29261064529418945
generate_one_block  0.2789192199707031
generate_one_block  0.273021936416626
generate_one_block  0.28593969345092773
generate_one_block  0.27039051055908203
generate_one_block  0.2855069637298584
generate_one_block  0.2854466438293457
generate_one_block  0.271561861038208
generate_one_block  0.2770857810974121
generate_one_block  0.27105236053466797
generate_one_block  0.2876458168029785
generate_one_block  0.28493309020996094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.038102149963378906
gen group dst list time:  0.062154531478881836
time for parepare:  0.01888728141784668
local_output_nid generation:  0.023485422134399414
local_in_edges_tensor generation:  0.037840843200683594
mini_batch_src_global generation:  0.04455280303955078
r_  generation:  0.46764492988586426
local_output_nid generation:  0.030668258666992188
local_in_edges_tensor generation:  0.04653573036193848
mini_batch_src_global generation:  0.05622982978820801
r_  generation:  0.48015332221984863
local_output_nid generation:  0.031011104583740234
local_in_edges_tensor generation:  0.03909778594970703
mini_batch_src_global generation:  0.05431008338928223
r_  generation:  0.4873497486114502
local_output_nid generation:  0.031186819076538086
local_in_edges_tensor generation:  0.030233144760131836
mini_batch_src_global generation:  0.056897878646850586
r_  generation:  0.4822268486022949
local_output_nid generation:  0.03145432472229004
local_in_edges_tensor generation:  0.030129432678222656
mini_batch_src_global generation:  0.05581331253051758
r_  generation:  0.48911046981811523
local_output_nid generation:  0.031618595123291016
local_in_edges_tensor generation:  0.0386052131652832
mini_batch_src_global generation:  0.05733299255371094
r_  generation:  0.48844456672668457
local_output_nid generation:  0.031584739685058594
local_in_edges_tensor generation:  0.03493309020996094
mini_batch_src_global generation:  0.056417226791381836
r_  generation:  0.4884822368621826
local_output_nid generation:  0.03157305717468262
local_in_edges_tensor generation:  0.03441309928894043
mini_batch_src_global generation:  0.05742239952087402
r_  generation:  0.4841275215148926
local_output_nid generation:  0.03125953674316406
local_in_edges_tensor generation:  0.034363508224487305
mini_batch_src_global generation:  0.05604720115661621
r_  generation:  0.48841428756713867
local_output_nid generation:  0.03149247169494629
local_in_edges_tensor generation:  0.03852105140686035
mini_batch_src_global generation:  0.05741119384765625
r_  generation:  0.4837820529937744
local_output_nid generation:  0.031920433044433594
local_in_edges_tensor generation:  0.034108877182006836
mini_batch_src_global generation:  0.059824466705322266
r_  generation:  0.48912763595581055
local_output_nid generation:  0.03160905838012695
local_in_edges_tensor generation:  0.030318021774291992
mini_batch_src_global generation:  0.057161569595336914
r_  generation:  0.4837336540222168
local_output_nid generation:  0.031883955001831055
local_in_edges_tensor generation:  0.03406786918640137
mini_batch_src_global generation:  0.05982017517089844
r_  generation:  0.48844313621520996
local_output_nid generation:  0.031769514083862305
local_in_edges_tensor generation:  0.03444719314575195
mini_batch_src_global generation:  0.05718588829040527
r_  generation:  0.4817788600921631
local_output_nid generation:  0.03152322769165039
local_in_edges_tensor generation:  0.03450489044189453
mini_batch_src_global generation:  0.06273651123046875
r_  generation:  0.48903942108154297
local_output_nid generation:  0.03195762634277344
local_in_edges_tensor generation:  0.039170026779174805
mini_batch_src_global generation:  0.06027531623840332
r_  generation:  0.48938608169555664
----------------------check_connections_block total spend ----------------------------- 11.407467126846313
generate_one_block  0.6390273571014404
generate_one_block  0.6364099979400635
generate_one_block  0.6294684410095215
generate_one_block  0.6183650493621826
generate_one_block  0.6267693042755127
generate_one_block  0.6214103698730469
generate_one_block  0.6687719821929932
generate_one_block  0.623999834060669
generate_one_block  0.6130883693695068
generate_one_block  0.6213033199310303
generate_one_block  0.6480128765106201
generate_one_block  0.6123566627502441
generate_one_block  0.6142253875732422
generate_one_block  0.6257836818695068
generate_one_block  0.6328790187835693
generate_one_block  0.641963005065918
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04125261306762695
gen group dst list time:  0.08819246292114258
time for parepare:  0.019054889678955078
local_output_nid generation:  0.031180620193481445
local_in_edges_tensor generation:  0.04884958267211914
mini_batch_src_global generation:  0.0453188419342041
r_  generation:  0.4825131893157959
local_output_nid generation:  0.036707401275634766
local_in_edges_tensor generation:  0.037863731384277344
mini_batch_src_global generation:  0.061688899993896484
r_  generation:  0.48958754539489746
local_output_nid generation:  0.03569626808166504
local_in_edges_tensor generation:  0.04067087173461914
mini_batch_src_global generation:  0.05397963523864746
r_  generation:  0.4947359561920166
local_output_nid generation:  0.03609895706176758
local_in_edges_tensor generation:  0.04230809211730957
mini_batch_src_global generation:  0.058062076568603516
r_  generation:  0.49788975715637207
local_output_nid generation:  0.0362856388092041
local_in_edges_tensor generation:  0.04325723648071289
mini_batch_src_global generation:  0.054181814193725586
r_  generation:  0.5033912658691406
local_output_nid generation:  0.03623175621032715
local_in_edges_tensor generation:  0.03801155090332031
mini_batch_src_global generation:  0.05419468879699707
r_  generation:  0.5063109397888184
local_output_nid generation:  0.03957533836364746
local_in_edges_tensor generation:  0.03803753852844238
mini_batch_src_global generation:  0.06012701988220215
r_  generation:  0.5062875747680664
local_output_nid generation:  0.03741455078125
local_in_edges_tensor generation:  0.04374098777770996
mini_batch_src_global generation:  0.05532670021057129
r_  generation:  0.5040552616119385
local_output_nid generation:  0.03730201721191406
local_in_edges_tensor generation:  0.03888249397277832
mini_batch_src_global generation:  0.05551004409790039
r_  generation:  0.5096609592437744
local_output_nid generation:  0.037207603454589844
local_in_edges_tensor generation:  0.042883872985839844
mini_batch_src_global generation:  0.05588531494140625
r_  generation:  0.5136377811431885
local_output_nid generation:  0.037789344787597656
local_in_edges_tensor generation:  0.0390167236328125
mini_batch_src_global generation:  0.05701923370361328
r_  generation:  0.5232188701629639
local_output_nid generation:  0.03798079490661621
local_in_edges_tensor generation:  0.043769121170043945
mini_batch_src_global generation:  0.05735278129577637
r_  generation:  0.5205626487731934
local_output_nid generation:  0.038454294204711914
local_in_edges_tensor generation:  0.03952598571777344
mini_batch_src_global generation:  0.05562257766723633
r_  generation:  0.5148935317993164
local_output_nid generation:  0.03759646415710449
local_in_edges_tensor generation:  0.0384373664855957
mini_batch_src_global generation:  0.05566859245300293
r_  generation:  0.5097036361694336
local_output_nid generation:  0.03733634948730469
local_in_edges_tensor generation:  0.04370522499084473
mini_batch_src_global generation:  0.05500602722167969
r_  generation:  0.5156588554382324
local_output_nid generation:  0.03766751289367676
local_in_edges_tensor generation:  0.04444742202758789
mini_batch_src_global generation:  0.05603456497192383
r_  generation:  0.5124161243438721
----------------------check_connections_block total spend ----------------------------- 12.17532205581665
generate_one_block  0.624955415725708
generate_one_block  0.6912539005279541
generate_one_block  0.6326560974121094
generate_one_block  0.6250839233398438
generate_one_block  0.620922327041626
generate_one_block  0.6159253120422363
generate_one_block  0.6262810230255127
generate_one_block  0.6363480091094971
generate_one_block  0.6273493766784668
generate_one_block  0.6307535171508789
generate_one_block  0.6291298866271973
generate_one_block  0.6331019401550293
generate_one_block  0.6238927841186523
generate_one_block  0.6419789791107178
generate_one_block  0.6306872367858887
generate_one_block  0.6341485977172852
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007684230804443359  GigaBytes
Max Memory Allocated: 0.007684230804443359  GigaBytes

connection checking time:  28.583605527877808
block generation total time  24.678837299346924
average batch blocks generation time:  1.5424273312091827
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2069091796875 GB
    Memory Allocated: 0.11432838439941406  GigaBytes
Max Memory Allocated: 0.11432838439941406  GigaBytes

torch.Size([163631, 128])
torch.Size([155530, 256])
Traceback (most recent call last):
  File "pseudo_mini_batch_range_arxiv_sage.py", line 435, in <module>
    main()
  File "pseudo_mini_batch_range_arxiv_sage.py", line 431, in main
    best_test = run(args, device, data)
  File "pseudo_mini_batch_range_arxiv_sage.py", line 251, in run
    batch_pred = model(blocks, batch_inputs)#------------*
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/graph_partition_multi_layers/pseudo_mini_batch_full_batch/SAGE/graphsage_model_arxiv.py", line 182, in forward
    x = layer(block, x)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 258, in forward
    graph.update_all(msg_fn, self._lstm_reducer)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/heterograph.py", line 4849, in update_all
    ndata = core.message_passing(g, message_func, reduce_func, apply_node_func)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 337, in message_passing
    ndata = invoke_udf_reduce(g, rfunc, msgdata, orig_nid=orig_nid)
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/core.py", line 143, in invoke_udf_reduce
    bkt_rsts.append(func(nbatch))
  File "/home/cc/.local/lib/python3.6/site-packages/dgl/nn/pytorch/conv/sageconv.py", line 173, in _lstm_reducer
    _, (rst, _) = self.lstm(m, h)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 582, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.62 GiB total capacity; 21.93 GiB already allocated; 14.44 MiB free; 22.41 GiB reserved in total by PyTorch)
