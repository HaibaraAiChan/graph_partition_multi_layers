Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648465940.692789
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02353191375732422
range selection method range initialization spend 0.013663530349731445
time for parepare:  0.01782083511352539
local_output_nid generation:  0.0006968975067138672
local_in_edges_tensor generation:  0.0027081966400146484
mini_batch_src_global generation:  0.00141143798828125
r_  generation:  0.009419441223144531
local_output_nid generation:  0.0007803440093994141
local_in_edges_tensor generation:  0.0005867481231689453
mini_batch_src_global generation:  0.0013241767883300781
r_  generation:  0.008100271224975586
local_output_nid generation:  0.0007524490356445312
local_in_edges_tensor generation:  0.0005309581756591797
mini_batch_src_global generation:  0.0009217262268066406
r_  generation:  0.007680654525756836
local_output_nid generation:  0.0007486343383789062
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.0007944107055664062
r_  generation:  0.007650613784790039
local_output_nid generation:  0.0007276535034179688
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.0007987022399902344
r_  generation:  0.007638692855834961
local_output_nid generation:  0.0007419586181640625
local_in_edges_tensor generation:  0.0004634857177734375
mini_batch_src_global generation:  0.0007424354553222656
r_  generation:  0.00768733024597168
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.0004601478576660156
mini_batch_src_global generation:  0.0007348060607910156
r_  generation:  0.0076601505279541016
local_output_nid generation:  0.0007245540618896484
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0007734298706054688
r_  generation:  0.007899999618530273
local_output_nid generation:  0.0007321834564208984
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0007658004760742188
r_  generation:  0.007879018783569336
local_output_nid generation:  0.0007193088531494141
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  0.0007410049438476562
r_  generation:  0.0076198577880859375
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0007574558258056641
r_  generation:  0.007832050323486328
local_output_nid generation:  0.0007238388061523438
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0008156299591064453
r_  generation:  0.008078575134277344
local_output_nid generation:  0.0007050037384033203
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.000797271728515625
r_  generation:  0.00800776481628418
local_output_nid generation:  0.0007102489471435547
local_in_edges_tensor generation:  0.0004436969757080078
mini_batch_src_global generation:  0.0007965564727783203
r_  generation:  0.007903337478637695
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0004444122314453125
mini_batch_src_global generation:  0.0008060932159423828
r_  generation:  0.008099555969238281
local_output_nid generation:  0.0007193088531494141
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0008177757263183594
r_  generation:  0.008069515228271484
local_output_nid generation:  0.0007112026214599609
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0008325576782226562
r_  generation:  0.008035898208618164
local_output_nid generation:  0.0007297992706298828
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0008268356323242188
r_  generation:  0.008023262023925781
local_output_nid generation:  0.0007219314575195312
local_in_edges_tensor generation:  0.0004634857177734375
mini_batch_src_global generation:  0.0008592605590820312
r_  generation:  0.00818943977355957
local_output_nid generation:  0.0007312297821044922
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.007766246795654297
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.0004534721374511719
mini_batch_src_global generation:  0.0008323192596435547
r_  generation:  0.008114814758300781
local_output_nid generation:  0.0007166862487792969
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008106231689453125
r_  generation:  0.007892608642578125
local_output_nid generation:  0.0006997585296630859
local_in_edges_tensor generation:  0.00044035911560058594
mini_batch_src_global generation:  0.0009424686431884766
r_  generation:  0.008121252059936523
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.0004382133483886719
mini_batch_src_global generation:  0.0009534358978271484
r_  generation:  0.008294343948364258
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.0004477500915527344
mini_batch_src_global generation:  0.0008411407470703125
r_  generation:  0.008126020431518555
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.0004432201385498047
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.008358955383300781
local_output_nid generation:  0.0007221698760986328
local_in_edges_tensor generation:  0.000446319580078125
mini_batch_src_global generation:  0.0008313655853271484
r_  generation:  0.008105993270874023
local_output_nid generation:  0.00072479248046875
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0008180141448974609
r_  generation:  0.007953405380249023
local_output_nid generation:  0.0007164478302001953
local_in_edges_tensor generation:  0.0004413127899169922
mini_batch_src_global generation:  0.0009136199951171875
r_  generation:  0.009355783462524414
local_output_nid generation:  0.0007219314575195312
local_in_edges_tensor generation:  0.004022359848022461
mini_batch_src_global generation:  0.0010671615600585938
r_  generation:  0.00825643539428711
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0009012222290039062
r_  generation:  0.008135080337524414
local_output_nid generation:  0.0007448196411132812
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0009570121765136719
r_  generation:  0.008240938186645508
----------------------check_connections_block total spend ----------------------------- 0.41243886947631836
generate_one_block  0.014073848724365234
generate_one_block  0.013151407241821289
generate_one_block  0.013018608093261719
generate_one_block  0.013044357299804688
generate_one_block  0.012964963912963867
generate_one_block  0.012959480285644531
generate_one_block  0.012700080871582031
generate_one_block  0.013326883316040039
generate_one_block  0.013077497482299805
generate_one_block  0.012585163116455078
generate_one_block  0.012839555740356445
generate_one_block  0.01300048828125
generate_one_block  0.012911796569824219
generate_one_block  0.012764930725097656
generate_one_block  0.012955665588378906
generate_one_block  0.013013601303100586
generate_one_block  0.01281118392944336
generate_one_block  0.012709617614746094
generate_one_block  0.013184070587158203
generate_one_block  0.012581586837768555
generate_one_block  0.013120651245117188
generate_one_block  0.012721538543701172
generate_one_block  0.012976884841918945
generate_one_block  0.013020992279052734
generate_one_block  0.01297616958618164
generate_one_block  0.013199329376220703
generate_one_block  0.012833595275878906
generate_one_block  0.01275944709777832
generate_one_block  0.013784170150756836
generate_one_block  0.013112545013427734
generate_one_block  0.01324319839477539
generate_one_block  0.013041496276855469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03993511199951172
gen group dst list time:  0.021459579467773438
time for parepare:  0.018911361694335938
local_output_nid generation:  0.003866434097290039
local_in_edges_tensor generation:  0.011150598526000977
mini_batch_src_global generation:  0.011867761611938477
r_  generation:  0.11688089370727539
local_output_nid generation:  0.0060613155364990234
local_in_edges_tensor generation:  0.006592750549316406
mini_batch_src_global generation:  0.01511240005493164
r_  generation:  0.12144708633422852
local_output_nid generation:  0.006412982940673828
local_in_edges_tensor generation:  0.00882101058959961
mini_batch_src_global generation:  0.013544559478759766
r_  generation:  0.12668848037719727
local_output_nid generation:  0.006240367889404297
local_in_edges_tensor generation:  0.007895231246948242
mini_batch_src_global generation:  0.015371322631835938
r_  generation:  0.12670445442199707
local_output_nid generation:  0.006371736526489258
local_in_edges_tensor generation:  0.00919795036315918
mini_batch_src_global generation:  0.015061616897583008
r_  generation:  0.13032293319702148
local_output_nid generation:  0.006319522857666016
local_in_edges_tensor generation:  0.007115602493286133
mini_batch_src_global generation:  0.015496492385864258
r_  generation:  0.1300816535949707
local_output_nid generation:  0.00616765022277832
local_in_edges_tensor generation:  0.007976293563842773
mini_batch_src_global generation:  0.015219926834106445
r_  generation:  0.12823033332824707
local_output_nid generation:  0.0065457820892333984
local_in_edges_tensor generation:  0.00938725471496582
mini_batch_src_global generation:  0.01686716079711914
r_  generation:  0.1316661834716797
local_output_nid generation:  0.0065708160400390625
local_in_edges_tensor generation:  0.008381128311157227
mini_batch_src_global generation:  0.015967607498168945
r_  generation:  0.1306900978088379
local_output_nid generation:  0.006331443786621094
local_in_edges_tensor generation:  0.006986141204833984
mini_batch_src_global generation:  0.015462160110473633
r_  generation:  0.13000106811523438
local_output_nid generation:  0.00657200813293457
local_in_edges_tensor generation:  0.007228851318359375
mini_batch_src_global generation:  0.015964031219482422
r_  generation:  0.1315171718597412
local_output_nid generation:  0.006624460220336914
local_in_edges_tensor generation:  0.008378982543945312
mini_batch_src_global generation:  0.015822649002075195
r_  generation:  0.13039326667785645
local_output_nid generation:  0.006727695465087891
local_in_edges_tensor generation:  0.008203744888305664
mini_batch_src_global generation:  0.016852855682373047
r_  generation:  0.13103222846984863
local_output_nid generation:  0.006567478179931641
local_in_edges_tensor generation:  0.00932168960571289
mini_batch_src_global generation:  0.015572071075439453
r_  generation:  0.12981414794921875
local_output_nid generation:  0.006796836853027344
local_in_edges_tensor generation:  0.008366584777832031
mini_batch_src_global generation:  0.01603984832763672
r_  generation:  0.13409996032714844
local_output_nid generation:  0.006806373596191406
local_in_edges_tensor generation:  0.007428169250488281
mini_batch_src_global generation:  0.01596522331237793
r_  generation:  0.1352531909942627
local_output_nid generation:  0.006649017333984375
local_in_edges_tensor generation:  0.007302045822143555
mini_batch_src_global generation:  0.016256093978881836
r_  generation:  0.1332683563232422
local_output_nid generation:  0.006689310073852539
local_in_edges_tensor generation:  0.007241725921630859
mini_batch_src_global generation:  0.015378952026367188
r_  generation:  0.13092708587646484
local_output_nid generation:  0.006935834884643555
local_in_edges_tensor generation:  0.00967860221862793
mini_batch_src_global generation:  0.016477584838867188
r_  generation:  0.13354277610778809
local_output_nid generation:  0.006655693054199219
local_in_edges_tensor generation:  0.007296085357666016
mini_batch_src_global generation:  0.016018390655517578
r_  generation:  0.1322498321533203
local_output_nid generation:  0.006918907165527344
local_in_edges_tensor generation:  0.013265609741210938
mini_batch_src_global generation:  0.016425371170043945
r_  generation:  0.13440656661987305
local_output_nid generation:  0.006824493408203125
local_in_edges_tensor generation:  0.008404970169067383
mini_batch_src_global generation:  0.01606583595275879
r_  generation:  0.13316893577575684
local_output_nid generation:  0.006830930709838867
local_in_edges_tensor generation:  0.00969386100769043
mini_batch_src_global generation:  0.016468524932861328
r_  generation:  0.13537812232971191
local_output_nid generation:  0.0068738460540771484
local_in_edges_tensor generation:  0.008486747741699219
mini_batch_src_global generation:  0.016515016555786133
r_  generation:  0.13396716117858887
local_output_nid generation:  0.006888628005981445
local_in_edges_tensor generation:  0.007465362548828125
mini_batch_src_global generation:  0.016455888748168945
r_  generation:  0.13494300842285156
local_output_nid generation:  0.006921052932739258
local_in_edges_tensor generation:  0.008591413497924805
mini_batch_src_global generation:  0.01652073860168457
r_  generation:  0.13708257675170898
local_output_nid generation:  0.006802797317504883
local_in_edges_tensor generation:  0.008563995361328125
mini_batch_src_global generation:  0.016317367553710938
r_  generation:  0.13564014434814453
local_output_nid generation:  0.006792306900024414
local_in_edges_tensor generation:  0.008362293243408203
mini_batch_src_global generation:  0.016003847122192383
r_  generation:  0.1333320140838623
local_output_nid generation:  0.0071887969970703125
local_in_edges_tensor generation:  0.010128021240234375
mini_batch_src_global generation:  0.017023801803588867
r_  generation:  0.1423511505126953
local_output_nid generation:  0.006934404373168945
local_in_edges_tensor generation:  0.007565021514892578
mini_batch_src_global generation:  0.016306638717651367
r_  generation:  0.1358633041381836
local_output_nid generation:  0.006894826889038086
local_in_edges_tensor generation:  0.011663675308227539
mini_batch_src_global generation:  0.016408443450927734
r_  generation:  0.13690805435180664
local_output_nid generation:  0.006915569305419922
local_in_edges_tensor generation:  0.009655475616455078
mini_batch_src_global generation:  0.016172170639038086
r_  generation:  0.1347815990447998
----------------------check_connections_block total spend ----------------------------- 6.234552383422852
generate_one_block  0.16658926010131836
generate_one_block  0.1619248390197754
generate_one_block  0.18015122413635254
generate_one_block  0.16204380989074707
generate_one_block  0.16476917266845703
generate_one_block  0.16365742683410645
generate_one_block  0.15832042694091797
generate_one_block  0.1653299331665039
generate_one_block  0.16506195068359375
generate_one_block  0.1589674949645996
generate_one_block  0.1639387607574463
generate_one_block  0.16241884231567383
generate_one_block  0.1626145839691162
generate_one_block  0.159959077835083
generate_one_block  0.16256260871887207
generate_one_block  0.1848299503326416
generate_one_block  0.16558361053466797
generate_one_block  0.15787363052368164
generate_one_block  0.16686439514160156
generate_one_block  0.16057085990905762
generate_one_block  0.16856098175048828
generate_one_block  0.16810035705566406
generate_one_block  0.16788125038146973
generate_one_block  0.1668398380279541
generate_one_block  0.16607666015625
generate_one_block  0.16882729530334473
generate_one_block  0.16109156608581543
generate_one_block  0.1626427173614502
generate_one_block  0.17928671836853027
generate_one_block  0.16478419303894043
generate_one_block  0.1647791862487793
generate_one_block  0.16501164436340332
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03568124771118164
gen group dst list time:  0.09159421920776367
time for parepare:  0.018719911575317383
local_output_nid generation:  0.01963043212890625
local_in_edges_tensor generation:  0.03650808334350586
mini_batch_src_global generation:  0.0394892692565918
r_  generation:  0.37615251541137695
local_output_nid generation:  0.02572154998779297
local_in_edges_tensor generation:  0.03768038749694824
mini_batch_src_global generation:  0.04650688171386719
r_  generation:  0.3841207027435303
local_output_nid generation:  0.026380538940429688
local_in_edges_tensor generation:  0.03162837028503418
mini_batch_src_global generation:  0.04573965072631836
r_  generation:  0.388948917388916
local_output_nid generation:  0.024521827697753906
local_in_edges_tensor generation:  0.02404332160949707
mini_batch_src_global generation:  0.04689216613769531
r_  generation:  0.40435361862182617
local_output_nid generation:  0.02507805824279785
local_in_edges_tensor generation:  0.03172445297241211
mini_batch_src_global generation:  0.046292781829833984
r_  generation:  0.3937525749206543
local_output_nid generation:  0.02517414093017578
local_in_edges_tensor generation:  0.03470492362976074
mini_batch_src_global generation:  0.04711771011352539
r_  generation:  0.39944887161254883
local_output_nid generation:  0.02456068992614746
local_in_edges_tensor generation:  0.024230480194091797
mini_batch_src_global generation:  0.04674267768859863
r_  generation:  0.3940143585205078
local_output_nid generation:  0.024965524673461914
local_in_edges_tensor generation:  0.025342941284179688
mini_batch_src_global generation:  0.05003833770751953
r_  generation:  0.39858388900756836
local_output_nid generation:  0.025089740753173828
local_in_edges_tensor generation:  0.03520560264587402
mini_batch_src_global generation:  0.04694843292236328
r_  generation:  0.40495753288269043
local_output_nid generation:  0.025863170623779297
local_in_edges_tensor generation:  0.03297281265258789
mini_batch_src_global generation:  0.0482785701751709
r_  generation:  0.39786505699157715
local_output_nid generation:  0.02511429786682129
local_in_edges_tensor generation:  0.0361783504486084
mini_batch_src_global generation:  0.05935239791870117
r_  generation:  0.4004671573638916
local_output_nid generation:  0.027756690979003906
local_in_edges_tensor generation:  0.031148910522460938
mini_batch_src_global generation:  0.048607587814331055
r_  generation:  0.39091968536376953
local_output_nid generation:  0.02610301971435547
local_in_edges_tensor generation:  0.027827739715576172
mini_batch_src_global generation:  0.047754526138305664
r_  generation:  0.39856719970703125
local_output_nid generation:  0.025707006454467773
local_in_edges_tensor generation:  0.027277469635009766
mini_batch_src_global generation:  0.04733443260192871
r_  generation:  0.39702677726745605
local_output_nid generation:  0.026421070098876953
local_in_edges_tensor generation:  0.027342796325683594
mini_batch_src_global generation:  0.04997754096984863
r_  generation:  0.3962395191192627
local_output_nid generation:  0.026065349578857422
local_in_edges_tensor generation:  0.03410816192626953
mini_batch_src_global generation:  0.04761934280395508
r_  generation:  0.39313459396362305
local_output_nid generation:  0.025797128677368164
local_in_edges_tensor generation:  0.027413368225097656
mini_batch_src_global generation:  0.04695415496826172
r_  generation:  0.39598774909973145
local_output_nid generation:  0.026049137115478516
local_in_edges_tensor generation:  0.023885250091552734
mini_batch_src_global generation:  0.047605276107788086
r_  generation:  0.3944509029388428
local_output_nid generation:  0.02602672576904297
local_in_edges_tensor generation:  0.030971527099609375
mini_batch_src_global generation:  0.046424150466918945
r_  generation:  0.40082693099975586
local_output_nid generation:  0.02603626251220703
local_in_edges_tensor generation:  0.027457714080810547
mini_batch_src_global generation:  0.0482029914855957
r_  generation:  0.3950514793395996
local_output_nid generation:  0.02708292007446289
local_in_edges_tensor generation:  0.030795812606811523
mini_batch_src_global generation:  0.05116915702819824
r_  generation:  0.404463529586792
local_output_nid generation:  0.02613067626953125
local_in_edges_tensor generation:  0.024422645568847656
mini_batch_src_global generation:  0.04797506332397461
r_  generation:  0.4000895023345947
local_output_nid generation:  0.026462078094482422
local_in_edges_tensor generation:  0.027174949645996094
mini_batch_src_global generation:  0.06038403511047363
r_  generation:  0.4056212902069092
local_output_nid generation:  0.028620004653930664
local_in_edges_tensor generation:  0.03247833251953125
mini_batch_src_global generation:  0.055051326751708984
r_  generation:  0.39787769317626953
local_output_nid generation:  0.02630138397216797
local_in_edges_tensor generation:  0.03134799003601074
mini_batch_src_global generation:  0.04630780220031738
r_  generation:  0.3978602886199951
local_output_nid generation:  0.02643132209777832
local_in_edges_tensor generation:  0.03157520294189453
mini_batch_src_global generation:  0.04742932319641113
r_  generation:  0.39793968200683594
local_output_nid generation:  0.026297807693481445
local_in_edges_tensor generation:  0.024762630462646484
mini_batch_src_global generation:  0.0469965934753418
r_  generation:  0.3990206718444824
local_output_nid generation:  0.026356220245361328
local_in_edges_tensor generation:  0.029768943786621094
mini_batch_src_global generation:  0.047942161560058594
r_  generation:  0.4020707607269287
local_output_nid generation:  0.02657032012939453
local_in_edges_tensor generation:  0.028027057647705078
mini_batch_src_global generation:  0.047614336013793945
r_  generation:  0.40975117683410645
local_output_nid generation:  0.026236295700073242
local_in_edges_tensor generation:  0.030704975128173828
mini_batch_src_global generation:  0.059980154037475586
r_  generation:  0.3992893695831299
local_output_nid generation:  0.026271581649780273
local_in_edges_tensor generation:  0.027101993560791016
mini_batch_src_global generation:  0.047661781311035156
r_  generation:  0.4017159938812256
local_output_nid generation:  0.026287317276000977
local_in_edges_tensor generation:  0.02715301513671875
mini_batch_src_global generation:  0.050353050231933594
r_  generation:  0.39757227897644043
----------------------check_connections_block total spend ----------------------------- 18.889222383499146
generate_one_block  0.6130838394165039
generate_one_block  0.51419997215271
generate_one_block  0.514603853225708
generate_one_block  0.5185506343841553
generate_one_block  0.5147101879119873
generate_one_block  0.514045000076294
generate_one_block  0.5040571689605713
generate_one_block  0.5394797325134277
generate_one_block  0.5245232582092285
generate_one_block  0.500946044921875
generate_one_block  0.5135600566864014
generate_one_block  0.5054066181182861
generate_one_block  0.5111513137817383
generate_one_block  0.5104427337646484
generate_one_block  0.5177936553955078
generate_one_block  0.5175702571868896
generate_one_block  0.5071337223052979
generate_one_block  0.505779504776001
generate_one_block  0.5163173675537109
generate_one_block  0.4996912479400635
generate_one_block  0.5332562923431396
generate_one_block  0.5195834636688232
generate_one_block  0.5182135105133057
generate_one_block  0.5026340484619141
generate_one_block  0.5142161846160889
generate_one_block  0.5130369663238525
generate_one_block  0.507434606552124
generate_one_block  0.5298693180084229
generate_one_block  0.5317275524139404
generate_one_block  0.5505268573760986
generate_one_block  0.5130391120910645
generate_one_block  0.5106010437011719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0006074905395507812  GigaBytes
Max Memory Allocated: 0.0006074905395507812  GigaBytes

connection checking time:  25.123774766921997
block generation total time  21.905099391937256
average batch blocks generation time:  0.6845343559980392
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.0833582878112793  GigaBytes
Max Memory Allocated: 0.0833582878112793  GigaBytes

torch.Size([145621, 128])
torch.Size([99612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0682373046875 GB
    Memory Allocated: 10.162067413330078  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0740966796875 GB
    Memory Allocated: 0.0831761360168457  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([145071, 128])
torch.Size([98830, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 10.124507427215576  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08317136764526367  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([145203, 128])
torch.Size([99099, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 10.113842487335205  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08310174942016602  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([145157, 128])
torch.Size([98159, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 10.036558151245117  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08326053619384766  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([145220, 128])
torch.Size([99128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 10.138038635253906  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08326148986816406  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([145290, 128])
torch.Size([99215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 10.13880968093872  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08274269104003906  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([144642, 128])
torch.Size([97039, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 9.945723056793213  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08467721939086914  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([146099, 128])
torch.Size([99518, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 10.149471282958984  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3065185546875 GB
    Memory Allocated: 0.08531475067138672  GigaBytes
Max Memory Allocated: 10.165231704711914  GigaBytes

torch.Size([145606, 128])
torch.Size([99885, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 10.193966388702393  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 0.08326339721679688  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145744, 128])
torch.Size([98527, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 10.026474475860596  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 0.08315420150756836  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145041, 128])
torch.Size([98666, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 10.135166645050049  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 0.08287191390991211  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([144663, 128])
torch.Size([98191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 10.0367431640625  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 0.08325052261352539  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145327, 128])
torch.Size([99309, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 10.12446117401123  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9061279296875 GB
    Memory Allocated: 0.08309078216552734  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145288, 128])
torch.Size([98384, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9256591796875 GB
    Memory Allocated: 10.02701997756958  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9256591796875 GB
    Memory Allocated: 0.08310604095458984  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145090, 128])
torch.Size([99175, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.065855979919434  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.08341407775878906  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145574, 128])
torch.Size([99371, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.137159824371338  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.08304786682128906  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([144844, 128])
torch.Size([98686, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.111066818237305  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.0832056999206543  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145503, 128])
torch.Size([98704, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.031311511993408  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.08533334732055664  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145519, 128])
torch.Size([99241, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.153757095336914  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.08321809768676758  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145383, 128])
torch.Size([99049, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.095892906188965  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.08533763885498047  GigaBytes
Max Memory Allocated: 10.19751262664795  GigaBytes

torch.Size([145952, 128])
torch.Size([99849, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.208428859710693  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.084228515625  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

torch.Size([145215, 128])
torch.Size([99110, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.160799980163574  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.0853281021118164  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

torch.Size([145631, 128])
torch.Size([100034, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.181574821472168  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.0835413932800293  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

torch.Size([145811, 128])
torch.Size([99535, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 10.1258544921875  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9315185546875 GB
    Memory Allocated: 0.08320808410644531  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

torch.Size([145162, 128])
torch.Size([98913, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9393310546875 GB
    Memory Allocated: 10.07831335067749  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9393310546875 GB
    Memory Allocated: 0.08421945571899414  GigaBytes
Max Memory Allocated: 10.212003231048584  GigaBytes

torch.Size([145106, 128])
torch.Size([99603, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9393310546875 GB
    Memory Allocated: 10.208831787109375  GigaBytes
Max Memory Allocated: 10.212435722351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9393310546875 GB
    Memory Allocated: 0.08324003219604492  GigaBytes
Max Memory Allocated: 10.212435722351074  GigaBytes

torch.Size([145391, 128])
torch.Size([98893, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9393310546875 GB
    Memory Allocated: 10.07139539718628  GigaBytes
Max Memory Allocated: 10.212435722351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.9393310546875 GB
    Memory Allocated: 0.08438587188720703  GigaBytes
Max Memory Allocated: 10.212435722351074  GigaBytes

torch.Size([145580, 128])
torch.Size([99815, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5408935546875 GB
    Memory Allocated: 10.18477201461792  GigaBytes
Max Memory Allocated: 10.212435722351074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5408935546875 GB
    Memory Allocated: 0.08541059494018555  GigaBytes
Max Memory Allocated: 10.212435722351074  GigaBytes

torch.Size([145887, 128])
torch.Size([101039, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 10.332353591918945  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.0833892822265625  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145488, 128])
torch.Size([99341, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 10.156405448913574  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.08326959609985352  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145277, 128])
torch.Size([99064, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 10.132906913757324  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.08340978622436523  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145543, 128])
torch.Size([99699, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 10.138262271881104  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03287915140390396 |0.0239509716629982 |0.24931155890226364 |9.835511445999146e-05 |0.29972317814826965 |0.008314371109008789 |
----------------------------------------------------------pseudo_mini_loss sum 4.404873371124268
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8576657
Number of first layer input nodes during this epoch:  4651928
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.10124015808105469  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022998332977294922
range selection method range initialization spend 0.012845277786254883
time for parepare:  0.017389535903930664
local_output_nid generation:  0.0009114742279052734
local_in_edges_tensor generation:  0.007800579071044922
mini_batch_src_global generation:  0.0014917850494384766
r_  generation:  0.008834123611450195
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0006268024444580078
mini_batch_src_global generation:  0.001299142837524414
r_  generation:  0.00855875015258789
local_output_nid generation:  0.0008876323699951172
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.0009477138519287109
r_  generation:  0.008145809173583984
local_output_nid generation:  0.0008652210235595703
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  0.0008320808410644531
r_  generation:  0.007944583892822266
local_output_nid generation:  0.0008461475372314453
local_in_edges_tensor generation:  0.0005128383636474609
mini_batch_src_global generation:  0.0008172988891601562
r_  generation:  0.007807493209838867
local_output_nid generation:  0.0008449554443359375
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.0008661746978759766
r_  generation:  0.008198976516723633
local_output_nid generation:  0.0008485317230224609
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.0008406639099121094
r_  generation:  0.008105993270874023
local_output_nid generation:  0.0008182525634765625
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.0008525848388671875
r_  generation:  0.00803685188293457
local_output_nid generation:  0.0008175373077392578
local_in_edges_tensor generation:  0.0005190372467041016
mini_batch_src_global generation:  0.0009083747863769531
r_  generation:  0.008148431777954102
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0008215904235839844
r_  generation:  0.008140325546264648
local_output_nid generation:  0.0008478164672851562
local_in_edges_tensor generation:  0.0005261898040771484
mini_batch_src_global generation:  0.000858306884765625
r_  generation:  0.007799863815307617
local_output_nid generation:  0.0008411407470703125
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0008447170257568359
r_  generation:  0.008272171020507812
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.0005044937133789062
mini_batch_src_global generation:  0.0008397102355957031
r_  generation:  0.008115053176879883
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.0008802413940429688
r_  generation:  0.008199930191040039
local_output_nid generation:  0.0008313655853271484
local_in_edges_tensor generation:  0.0004937648773193359
mini_batch_src_global generation:  0.0008394718170166016
r_  generation:  0.008296966552734375
local_output_nid generation:  0.0008175373077392578
local_in_edges_tensor generation:  0.0005025863647460938
mini_batch_src_global generation:  0.0008604526519775391
r_  generation:  0.008134841918945312
local_output_nid generation:  0.0008003711700439453
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0011456012725830078
r_  generation:  0.008250236511230469
local_output_nid generation:  0.0008208751678466797
local_in_edges_tensor generation:  0.0004932880401611328
mini_batch_src_global generation:  0.0008594989776611328
r_  generation:  0.008225679397583008
local_output_nid generation:  0.0008103847503662109
local_in_edges_tensor generation:  0.00052642822265625
mini_batch_src_global generation:  0.0008814334869384766
r_  generation:  0.008263587951660156
local_output_nid generation:  0.0008070468902587891
local_in_edges_tensor generation:  0.0004961490631103516
mini_batch_src_global generation:  0.000850677490234375
r_  generation:  0.010784387588500977
local_output_nid generation:  0.0008087158203125
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0010712146759033203
r_  generation:  0.008343935012817383
local_output_nid generation:  0.0008223056793212891
local_in_edges_tensor generation:  0.0005064010620117188
mini_batch_src_global generation:  0.0008609294891357422
r_  generation:  0.008266448974609375
local_output_nid generation:  0.0008108615875244141
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0008673667907714844
r_  generation:  0.008339881896972656
local_output_nid generation:  0.0008146762847900391
local_in_edges_tensor generation:  0.0005097389221191406
mini_batch_src_global generation:  0.0008778572082519531
r_  generation:  0.008316993713378906
local_output_nid generation:  0.0008015632629394531
local_in_edges_tensor generation:  0.0004925727844238281
mini_batch_src_global generation:  0.0008444786071777344
r_  generation:  0.00807499885559082
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.0008847713470458984
r_  generation:  0.00819706916809082
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.0008771419525146484
r_  generation:  0.00823974609375
local_output_nid generation:  0.0007998943328857422
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0008821487426757812
r_  generation:  0.008158683776855469
local_output_nid generation:  0.0008199214935302734
local_in_edges_tensor generation:  0.0004754066467285156
mini_batch_src_global generation:  0.0008614063262939453
r_  generation:  0.008127689361572266
local_output_nid generation:  0.0007901191711425781
local_in_edges_tensor generation:  0.0004982948303222656
mini_batch_src_global generation:  0.0009336471557617188
r_  generation:  0.008379936218261719
local_output_nid generation:  0.0007946491241455078
local_in_edges_tensor generation:  0.0004980564117431641
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.008193254470825195
local_output_nid generation:  0.0008077621459960938
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0008547306060791016
r_  generation:  0.008382081985473633
----------------------check_connections_block total spend ----------------------------- 0.4290299415588379
generate_one_block  0.0205838680267334
generate_one_block  0.016799211502075195
generate_one_block  0.014844655990600586
generate_one_block  0.01448512077331543
generate_one_block  0.014286994934082031
generate_one_block  0.014579057693481445
generate_one_block  0.014213323593139648
generate_one_block  0.014162302017211914
generate_one_block  0.01449275016784668
generate_one_block  0.014153718948364258
generate_one_block  0.013801097869873047
generate_one_block  0.014698982238769531
generate_one_block  0.014241933822631836
generate_one_block  0.014401912689208984
generate_one_block  0.014307737350463867
generate_one_block  0.016563892364501953
generate_one_block  0.014483451843261719
generate_one_block  0.014016151428222656
generate_one_block  0.014403343200683594
generate_one_block  0.014128923416137695
generate_one_block  0.014559030532836914
generate_one_block  0.014224529266357422
generate_one_block  0.014418363571166992
generate_one_block  0.014264345169067383
generate_one_block  0.014039039611816406
generate_one_block  0.014288187026977539
generate_one_block  0.014515399932861328
generate_one_block  0.014534950256347656
generate_one_block  0.01438450813293457
generate_one_block  0.01460409164428711
generate_one_block  0.014333724975585938
generate_one_block  0.014453887939453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03675198554992676
gen group dst list time:  0.01978588104248047
time for parepare:  0.019516468048095703
local_output_nid generation:  0.004500865936279297
local_in_edges_tensor generation:  0.017472028732299805
mini_batch_src_global generation:  0.011849403381347656
r_  generation:  0.1186971664428711
local_output_nid generation:  0.007313251495361328
local_in_edges_tensor generation:  0.008835315704345703
mini_batch_src_global generation:  0.014923095703125
r_  generation:  0.1257174015045166
local_output_nid generation:  0.007704257965087891
local_in_edges_tensor generation:  0.027161598205566406
mini_batch_src_global generation:  0.01370692253112793
r_  generation:  0.1286449432373047
local_output_nid generation:  0.00778961181640625
local_in_edges_tensor generation:  0.008665323257446289
mini_batch_src_global generation:  0.014562845230102539
r_  generation:  0.1287236213684082
local_output_nid generation:  0.008201837539672852
local_in_edges_tensor generation:  0.008770942687988281
mini_batch_src_global generation:  0.015025138854980469
r_  generation:  0.1364891529083252
local_output_nid generation:  0.008504867553710938
local_in_edges_tensor generation:  0.010083198547363281
mini_batch_src_global generation:  0.015645742416381836
r_  generation:  0.13768768310546875
local_output_nid generation:  0.008464574813842773
local_in_edges_tensor generation:  0.00770878791809082
mini_batch_src_global generation:  0.015464544296264648
r_  generation:  0.1333904266357422
local_output_nid generation:  0.008455514907836914
local_in_edges_tensor generation:  0.008582115173339844
mini_batch_src_global generation:  0.016658306121826172
r_  generation:  0.13144373893737793
local_output_nid generation:  0.008476495742797852
local_in_edges_tensor generation:  0.010204553604125977
mini_batch_src_global generation:  0.01582503318786621
r_  generation:  0.13691926002502441
local_output_nid generation:  0.008237123489379883
local_in_edges_tensor generation:  0.007957935333251953
mini_batch_src_global generation:  0.015517711639404297
r_  generation:  0.13275885581970215
local_output_nid generation:  0.008404970169067383
local_in_edges_tensor generation:  0.00948476791381836
mini_batch_src_global generation:  0.015238761901855469
r_  generation:  0.1338636875152588
local_output_nid generation:  0.008812665939331055
local_in_edges_tensor generation:  0.010401487350463867
mini_batch_src_global generation:  0.015861034393310547
r_  generation:  0.1331174373626709
local_output_nid generation:  0.008873224258422852
local_in_edges_tensor generation:  0.010265111923217773
mini_batch_src_global generation:  0.01594710350036621
r_  generation:  0.13540029525756836
local_output_nid generation:  0.009025335311889648
local_in_edges_tensor generation:  0.00940847396850586
mini_batch_src_global generation:  0.015885114669799805
r_  generation:  0.1364455223083496
local_output_nid generation:  0.008928537368774414
local_in_edges_tensor generation:  0.01035308837890625
mini_batch_src_global generation:  0.01625537872314453
r_  generation:  0.14087653160095215
local_output_nid generation:  0.008824586868286133
local_in_edges_tensor generation:  0.008010387420654297
mini_batch_src_global generation:  0.015630245208740234
r_  generation:  0.13820457458496094
local_output_nid generation:  0.009064435958862305
local_in_edges_tensor generation:  0.009363651275634766
mini_batch_src_global generation:  0.017327070236206055
r_  generation:  0.13957834243774414
local_output_nid generation:  0.008952617645263672
local_in_edges_tensor generation:  0.009097576141357422
mini_batch_src_global generation:  0.015662431716918945
r_  generation:  0.13630914688110352
local_output_nid generation:  0.009115219116210938
local_in_edges_tensor generation:  0.009405851364135742
mini_batch_src_global generation:  0.016122817993164062
r_  generation:  0.1412363052368164
local_output_nid generation:  0.009056568145751953
local_in_edges_tensor generation:  0.010364532470703125
mini_batch_src_global generation:  0.01650071144104004
r_  generation:  0.13639259338378906
local_output_nid generation:  0.009204387664794922
local_in_edges_tensor generation:  0.010838031768798828
mini_batch_src_global generation:  0.016611576080322266
r_  generation:  0.1423964500427246
local_output_nid generation:  0.00868082046508789
local_in_edges_tensor generation:  0.008109569549560547
mini_batch_src_global generation:  0.015938758850097656
r_  generation:  0.13463616371154785
local_output_nid generation:  0.008881092071533203
local_in_edges_tensor generation:  0.010080099105834961
mini_batch_src_global generation:  0.01654982566833496
r_  generation:  0.1444690227508545
local_output_nid generation:  0.009313583374023438
local_in_edges_tensor generation:  0.009391307830810547
mini_batch_src_global generation:  0.015874147415161133
r_  generation:  0.13635754585266113
local_output_nid generation:  0.008655786514282227
local_in_edges_tensor generation:  0.009287357330322266
mini_batch_src_global generation:  0.01571035385131836
r_  generation:  0.1418437957763672
local_output_nid generation:  0.009826183319091797
local_in_edges_tensor generation:  0.01666426658630371
mini_batch_src_global generation:  0.017850875854492188
r_  generation:  0.13743948936462402
local_output_nid generation:  0.00889730453491211
local_in_edges_tensor generation:  0.010056495666503906
mini_batch_src_global generation:  0.017281770706176758
r_  generation:  0.1518840789794922
local_output_nid generation:  0.009688377380371094
local_in_edges_tensor generation:  0.010471582412719727
mini_batch_src_global generation:  0.01729750633239746
r_  generation:  0.1387159824371338
local_output_nid generation:  0.008764266967773438
local_in_edges_tensor generation:  0.009942293167114258
mini_batch_src_global generation:  0.01606607437133789
r_  generation:  0.1364901065826416
local_output_nid generation:  0.01026010513305664
local_in_edges_tensor generation:  0.00905299186706543
mini_batch_src_global generation:  0.017566680908203125
r_  generation:  0.1403343677520752
local_output_nid generation:  0.008996009826660156
local_in_edges_tensor generation:  0.010537385940551758
mini_batch_src_global generation:  0.0162045955657959
r_  generation:  0.13895845413208008
local_output_nid generation:  0.008976221084594727
local_in_edges_tensor generation:  0.009923219680786133
mini_batch_src_global generation:  0.017475128173828125
r_  generation:  0.1411898136138916
----------------------check_connections_block total spend ----------------------------- 6.527864694595337
generate_one_block  0.17516016960144043
generate_one_block  0.17174458503723145
generate_one_block  0.17090296745300293
generate_one_block  0.17392683029174805
generate_one_block  0.18506121635437012
generate_one_block  0.1748361587524414
generate_one_block  0.16853713989257812
generate_one_block  0.1717078685760498
generate_one_block  0.17628097534179688
generate_one_block  0.1667957305908203
generate_one_block  0.16583728790283203
generate_one_block  0.17397761344909668
generate_one_block  0.1734623908996582
generate_one_block  0.1763904094696045
generate_one_block  0.173537015914917
generate_one_block  0.17638468742370605
generate_one_block  0.17781829833984375
generate_one_block  0.1700267791748047
generate_one_block  0.1765003204345703
generate_one_block  0.20395469665527344
generate_one_block  0.17989540100097656
generate_one_block  0.17065763473510742
generate_one_block  0.17577099800109863
generate_one_block  0.17304658889770508
generate_one_block  0.17292237281799316
generate_one_block  0.1759474277496338
generate_one_block  0.17943954467773438
generate_one_block  0.18894028663635254
generate_one_block  0.17056703567504883
generate_one_block  0.18314623832702637
generate_one_block  0.1774754524230957
generate_one_block  0.18199563026428223
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08243346214294434
gen group dst list time:  0.10849976539611816
time for parepare:  0.020435810089111328
local_output_nid generation:  0.023488521575927734
local_in_edges_tensor generation:  0.04703259468078613
mini_batch_src_global generation:  0.03859710693359375
r_  generation:  0.3869285583496094
local_output_nid generation:  0.02765798568725586
local_in_edges_tensor generation:  0.038846492767333984
mini_batch_src_global generation:  0.04857230186462402
r_  generation:  0.3976149559020996
local_output_nid generation:  0.0280606746673584
local_in_edges_tensor generation:  0.028389453887939453
mini_batch_src_global generation:  0.046138763427734375
r_  generation:  0.4008631706237793
local_output_nid generation:  0.02660846710205078
local_in_edges_tensor generation:  0.03488492965698242
mini_batch_src_global generation:  0.04966378211975098
r_  generation:  0.40050649642944336
local_output_nid generation:  0.026489973068237305
local_in_edges_tensor generation:  0.02410602569580078
mini_batch_src_global generation:  0.04745984077453613
r_  generation:  0.4079275131225586
local_output_nid generation:  0.026481151580810547
local_in_edges_tensor generation:  0.025358200073242188
mini_batch_src_global generation:  0.04775261878967285
r_  generation:  0.40398287773132324
local_output_nid generation:  0.02656269073486328
local_in_edges_tensor generation:  0.03200960159301758
mini_batch_src_global generation:  0.046949148178100586
r_  generation:  0.4024975299835205
local_output_nid generation:  0.039179325103759766
local_in_edges_tensor generation:  0.024625778198242188
mini_batch_src_global generation:  0.0477137565612793
r_  generation:  0.41448259353637695
local_output_nid generation:  0.027019739151000977
local_in_edges_tensor generation:  0.031793832778930664
mini_batch_src_global generation:  0.047052860260009766
r_  generation:  0.40263962745666504
local_output_nid generation:  0.026662349700927734
local_in_edges_tensor generation:  0.024498701095581055
mini_batch_src_global generation:  0.04768013954162598
r_  generation:  0.4061729907989502
local_output_nid generation:  0.02659463882446289
local_in_edges_tensor generation:  0.027575016021728516
mini_batch_src_global generation:  0.04671502113342285
r_  generation:  0.4034557342529297
local_output_nid generation:  0.027010440826416016
local_in_edges_tensor generation:  0.028272390365600586
mini_batch_src_global generation:  0.050004005432128906
r_  generation:  0.4181206226348877
local_output_nid generation:  0.026643037796020508
local_in_edges_tensor generation:  0.027852535247802734
mini_batch_src_global generation:  0.046631813049316406
r_  generation:  0.4017350673675537
local_output_nid generation:  0.027223825454711914
local_in_edges_tensor generation:  0.02889108657836914
mini_batch_src_global generation:  0.05076479911804199
r_  generation:  0.4051525592803955
local_output_nid generation:  0.02673196792602539
local_in_edges_tensor generation:  0.028040409088134766
mini_batch_src_global generation:  0.04833507537841797
r_  generation:  0.40662050247192383
local_output_nid generation:  0.02671504020690918
local_in_edges_tensor generation:  0.0278472900390625
mini_batch_src_global generation:  0.049988508224487305
r_  generation:  0.3996908664703369
local_output_nid generation:  0.026930809020996094
local_in_edges_tensor generation:  0.0317533016204834
mini_batch_src_global generation:  0.046936988830566406
r_  generation:  0.40415143966674805
local_output_nid generation:  0.026668310165405273
local_in_edges_tensor generation:  0.024115800857543945
mini_batch_src_global generation:  0.04808926582336426
r_  generation:  0.4063680171966553
local_output_nid generation:  0.02691364288330078
local_in_edges_tensor generation:  0.02802586555480957
mini_batch_src_global generation:  0.04987215995788574
r_  generation:  0.40745019912719727
local_output_nid generation:  0.026653289794921875
local_in_edges_tensor generation:  0.03186917304992676
mini_batch_src_global generation:  0.04762005805969238
r_  generation:  0.3999168872833252
local_output_nid generation:  0.026909828186035156
local_in_edges_tensor generation:  0.02469158172607422
mini_batch_src_global generation:  0.04759955406188965
r_  generation:  0.40836548805236816
local_output_nid generation:  0.026999711990356445
local_in_edges_tensor generation:  0.02833700180053711
mini_batch_src_global generation:  0.04814648628234863
r_  generation:  0.4099249839782715
local_output_nid generation:  0.026755094528198242
local_in_edges_tensor generation:  0.027651071548461914
mini_batch_src_global generation:  0.04692578315734863
r_  generation:  0.40478014945983887
local_output_nid generation:  0.02695322036743164
local_in_edges_tensor generation:  0.027962207794189453
mini_batch_src_global generation:  0.05035519599914551
r_  generation:  0.3986337184906006
local_output_nid generation:  0.026862621307373047
local_in_edges_tensor generation:  0.02507305145263672
mini_batch_src_global generation:  0.04749155044555664
r_  generation:  0.40651917457580566
local_output_nid generation:  0.0271146297454834
local_in_edges_tensor generation:  0.03224992752075195
mini_batch_src_global generation:  0.04774880409240723
r_  generation:  0.4072906970977783
local_output_nid generation:  0.02906942367553711
local_in_edges_tensor generation:  0.0287935733795166
mini_batch_src_global generation:  0.04740285873413086
r_  generation:  0.4118788242340088
local_output_nid generation:  0.026960372924804688
local_in_edges_tensor generation:  0.025175094604492188
mini_batch_src_global generation:  0.04788470268249512
r_  generation:  0.4036729335784912
local_output_nid generation:  0.026710033416748047
local_in_edges_tensor generation:  0.02767181396484375
mini_batch_src_global generation:  0.04660177230834961
r_  generation:  0.4049694538116455
local_output_nid generation:  0.02718663215637207
local_in_edges_tensor generation:  0.034848690032958984
mini_batch_src_global generation:  0.05072426795959473
r_  generation:  0.40530848503112793
local_output_nid generation:  0.02695298194885254
local_in_edges_tensor generation:  0.025226593017578125
mini_batch_src_global generation:  0.04731011390686035
r_  generation:  0.40421485900878906
local_output_nid generation:  0.026882171630859375
local_in_edges_tensor generation:  0.028291702270507812
mini_batch_src_global generation:  0.05043315887451172
r_  generation:  0.40403223037719727
----------------------check_connections_block total spend ----------------------------- 19.115724086761475
generate_one_block  0.5275979042053223
generate_one_block  0.5258541107177734
generate_one_block  0.5306928157806396
generate_one_block  0.5354595184326172
generate_one_block  0.6130983829498291
generate_one_block  0.5341081619262695
generate_one_block  0.5314958095550537
generate_one_block  0.5404844284057617
generate_one_block  0.5638973712921143
generate_one_block  0.5378572940826416
generate_one_block  0.5379984378814697
generate_one_block  0.5396499633789062
generate_one_block  0.5329573154449463
generate_one_block  0.5396087169647217
generate_one_block  0.534980058670044
generate_one_block  0.5454189777374268
generate_one_block  0.5757904052734375
generate_one_block  0.5524051189422607
generate_one_block  0.5512895584106445
generate_one_block  0.5383131504058838
generate_one_block  0.5335729122161865
generate_one_block  0.537816047668457
generate_one_block  0.5234332084655762
generate_one_block  0.5447776317596436
generate_one_block  0.5550234317779541
generate_one_block  0.5530354976654053
generate_one_block  0.5606715679168701
generate_one_block  0.5572123527526855
generate_one_block  0.5421085357666016
generate_one_block  0.544675350189209
generate_one_block  0.5444228649139404
generate_one_block  0.5535106658935547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.10124015808105469  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

connection checking time:  25.64358878135681
block generation total time  23.07186532020569
average batch blocks generation time:  0.7209957912564278
block dataloader generation time/epoch 51.42482662200928
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.0854649543762207  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145426, 128])
torch.Size([98728, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 10.084923267364502  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 0.08453607559204102  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145371, 128])
torch.Size([99327, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.121013164520264  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08547210693359375  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145597, 128])
torch.Size([99450, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.085193157196045  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0855722427368164  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145476, 128])
torch.Size([99781, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.184253215789795  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08418416976928711  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([144813, 128])
torch.Size([98014, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.059425830841064  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08471870422363281  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145740, 128])
torch.Size([99551, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.140748500823975  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08541584014892578  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145692, 128])
torch.Size([99170, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.069395542144775  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0843663215637207  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145229, 128])
torch.Size([98482, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.036571502685547  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08553695678710938  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145664, 128])
torch.Size([99814, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.123958110809326  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08444738388061523  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145539, 128])
torch.Size([98844, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.038266658782959  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08423137664794922  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145224, 128])
torch.Size([97877, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.001855850219727  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08452796936035156  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145336, 128])
torch.Size([99509, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.158426761627197  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08410406112670898  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([144689, 128])
torch.Size([98178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.032118797302246  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0857229232788086  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145765, 128])
torch.Size([100147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.21215534210205  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0854959487915039  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145705, 128])
torch.Size([99367, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.120518207550049  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08439302444458008  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145315, 128])
torch.Size([98637, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.062799453735352  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08654069900512695  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145667, 128])
torch.Size([99600, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.200277328491211  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08435249328613281  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145310, 128])
torch.Size([98529, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.052541732788086  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08652639389038086  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145589, 128])
torch.Size([99497, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.189838409423828  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08446455001831055  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145295, 128])
torch.Size([98554, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.11506175994873  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08656120300292969  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145425, 128])
torch.Size([99348, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.20896291732788  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08455896377563477  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145487, 128])
torch.Size([99572, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.112614154815674  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08429765701293945  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([144973, 128])
torch.Size([98221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.056443691253662  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08446598052978516  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145372, 128])
torch.Size([98805, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.096078872680664  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08544540405273438  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145461, 128])
torch.Size([98957, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.076948642730713  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0856623649597168  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145646, 128])
torch.Size([99145, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.187820434570312  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08654642105102539  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145823, 128])
torch.Size([99813, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.206376075744629  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0847325325012207  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145791, 128])
torch.Size([99507, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.139723777770996  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08430910110473633  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145227, 128])
torch.Size([98112, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.007891178131104  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08568000793457031  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145601, 128])
torch.Size([100048, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.246503353118896  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.08551216125488281  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145982, 128])
torch.Size([99623, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.1466383934021  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 0.0855875015258789  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

torch.Size([145408, 128])
torch.Size([99549, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1483154296875 GB
    Memory Allocated: 10.238579273223877  GigaBytes
Max Memory Allocated: 10.336251258850098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030919961631298065 |0.013055436313152313 |0.23491564393043518 |9.375810623168945e-05 |0.2929653376340866 |0.005981922149658203 |
----------------------------------------------------------pseudo_mini_loss sum 3.7023403644561768
Total (block generation + training)time/epoch 69.78409671783447
Training time/epoch 18.359015941619873
Training time without block to device /epoch 17.941241979599
Training time without total dataloading part /epoch 16.90117359161377
load block tensor time/epoch 0.9894387722015381
block to device time/epoch 0.417773962020874
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8578620
Number of first layer input nodes during this epoch:  4654638
