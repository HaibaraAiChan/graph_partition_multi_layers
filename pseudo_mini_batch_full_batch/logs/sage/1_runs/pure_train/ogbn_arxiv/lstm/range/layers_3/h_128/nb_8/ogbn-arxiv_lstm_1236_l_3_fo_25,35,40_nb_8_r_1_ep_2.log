Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648472136.584399
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025005102157592773
range selection method range initialization spend 0.012681961059570312
time for parepare:  0.01798844337463379
local_output_nid generation:  0.0026543140411376953
local_in_edges_tensor generation:  0.004546165466308594
mini_batch_src_global generation:  0.003047466278076172
r_  generation:  0.035780906677246094
local_output_nid generation:  0.0030710697174072266
local_in_edges_tensor generation:  0.0015861988067626953
mini_batch_src_global generation:  0.004069805145263672
r_  generation:  0.038747549057006836
local_output_nid generation:  0.003065347671508789
local_in_edges_tensor generation:  0.0016651153564453125
mini_batch_src_global generation:  0.0027511119842529297
r_  generation:  0.03760552406311035
local_output_nid generation:  0.0031270980834960938
local_in_edges_tensor generation:  0.0016417503356933594
mini_batch_src_global generation:  0.002768278121948242
r_  generation:  0.03872251510620117
local_output_nid generation:  0.003106355667114258
local_in_edges_tensor generation:  0.0016138553619384766
mini_batch_src_global generation:  0.0026824474334716797
r_  generation:  0.03977799415588379
local_output_nid generation:  0.0031321048736572266
local_in_edges_tensor generation:  0.0016140937805175781
mini_batch_src_global generation:  0.0031006336212158203
r_  generation:  0.040964365005493164
local_output_nid generation:  0.0031015872955322266
local_in_edges_tensor generation:  0.0016241073608398438
mini_batch_src_global generation:  0.0030002593994140625
r_  generation:  0.03973507881164551
local_output_nid generation:  0.003076791763305664
local_in_edges_tensor generation:  0.0016222000122070312
mini_batch_src_global generation:  0.0031456947326660156
r_  generation:  0.040702104568481445
----------------------check_connections_block total spend ----------------------------- 0.4603428840637207
generate_one_block  0.053741455078125
generate_one_block  0.05521798133850098
generate_one_block  0.05436444282531738
generate_one_block  0.054451942443847656
generate_one_block  0.056793212890625
generate_one_block  0.05520176887512207
generate_one_block  0.053893327713012695
generate_one_block  0.054299116134643555
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04100775718688965
gen group dst list time:  0.015072822570800781
time for parepare:  0.01911640167236328
local_output_nid generation:  0.010427713394165039
local_in_edges_tensor generation:  0.027377843856811523
mini_batch_src_global generation:  0.027118682861328125
r_  generation:  0.2864718437194824
local_output_nid generation:  0.01610541343688965
local_in_edges_tensor generation:  0.026434898376464844
mini_batch_src_global generation:  0.035117387771606445
r_  generation:  0.29990124702453613
local_output_nid generation:  0.015591859817504883
local_in_edges_tensor generation:  0.021535396575927734
mini_batch_src_global generation:  0.03438234329223633
r_  generation:  0.30043530464172363
local_output_nid generation:  0.016208171844482422
local_in_edges_tensor generation:  0.016654491424560547
mini_batch_src_global generation:  0.03610682487487793
r_  generation:  0.30516743659973145
local_output_nid generation:  0.016292095184326172
local_in_edges_tensor generation:  0.021956920623779297
mini_batch_src_global generation:  0.036829233169555664
r_  generation:  0.30826759338378906
local_output_nid generation:  0.01661229133605957
local_in_edges_tensor generation:  0.024764060974121094
mini_batch_src_global generation:  0.03800320625305176
r_  generation:  0.31162309646606445
local_output_nid generation:  0.016567230224609375
local_in_edges_tensor generation:  0.024671077728271484
mini_batch_src_global generation:  0.037311553955078125
r_  generation:  0.31235837936401367
local_output_nid generation:  0.016707897186279297
local_in_edges_tensor generation:  0.017882585525512695
mini_batch_src_global generation:  0.0374455451965332
r_  generation:  0.3061106204986572
----------------------check_connections_block total spend ----------------------------- 3.5589523315429688
generate_one_block  0.3952932357788086
generate_one_block  0.4016444683074951
generate_one_block  0.3904688358306885
generate_one_block  0.39537644386291504
generate_one_block  0.39326906204223633
generate_one_block  0.41544485092163086
generate_one_block  0.39365315437316895
generate_one_block  0.38889312744140625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03347373008728027
gen group dst list time:  0.03554821014404297
time for parepare:  0.0191192626953125
local_output_nid generation:  0.025029420852661133
local_in_edges_tensor generation:  0.04055500030517578
mini_batch_src_global generation:  0.0444178581237793
r_  generation:  0.4705216884613037
local_output_nid generation:  0.031887054443359375
local_in_edges_tensor generation:  0.04938220977783203
mini_batch_src_global generation:  0.05427098274230957
r_  generation:  0.47771120071411133
local_output_nid generation:  0.03254961967468262
local_in_edges_tensor generation:  0.03753972053527832
mini_batch_src_global generation:  0.054949283599853516
r_  generation:  0.4866912364959717
local_output_nid generation:  0.03330349922180176
local_in_edges_tensor generation:  0.03740429878234863
mini_batch_src_global generation:  0.05688881874084473
r_  generation:  0.4869115352630615
local_output_nid generation:  0.033010244369506836
local_in_edges_tensor generation:  0.04194831848144531
mini_batch_src_global generation:  0.0520780086517334
r_  generation:  0.5014824867248535
local_output_nid generation:  0.03308391571044922
local_in_edges_tensor generation:  0.03752446174621582
mini_batch_src_global generation:  0.05704236030578613
r_  generation:  0.4925816059112549
local_output_nid generation:  0.03428339958190918
local_in_edges_tensor generation:  0.053348541259765625
mini_batch_src_global generation:  0.05583071708679199
r_  generation:  0.4987313747406006
local_output_nid generation:  0.03362393379211426
local_in_edges_tensor generation:  0.034627676010131836
mini_batch_src_global generation:  0.06025099754333496
r_  generation:  0.4988729953765869
----------------------check_connections_block total spend ----------------------------- 5.811835289001465
generate_one_block  0.6295077800750732
generate_one_block  0.6377389430999756
generate_one_block  0.6082625389099121
generate_one_block  0.6153655052185059
generate_one_block  0.6353774070739746
generate_one_block  0.6229262351989746
generate_one_block  0.6388978958129883
generate_one_block  0.6007075309753418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017633438110351562  GigaBytes
Max Memory Allocated: 0.0017633438110351562  GigaBytes

connection checking time:  9.370787620544434
block generation total time  8.162827014923096
average batch blocks generation time:  1.020353376865387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.0973505973815918  GigaBytes
Max Memory Allocated: 0.0973505973815918  GigaBytes

torch.Size([160571, 128])
torch.Size([141113, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6483154296875 GB
    Memory Allocated: 19.262161254882812  GigaBytes
Max Memory Allocated: 19.319448947906494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0076904296875 GB
    Memory Allocated: 0.10158395767211914  GigaBytes
Max Memory Allocated: 19.319448947906494  GigaBytes

torch.Size([160688, 128])
torch.Size([141971, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7225341796875 GB
    Memory Allocated: 19.484591484069824  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 0.10156011581420898  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160396, 128])
torch.Size([140999, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 19.29913330078125  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 0.10145282745361328  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160675, 128])
torch.Size([141468, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 19.350809574127197  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 0.10137319564819336  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160526, 128])
torch.Size([141080, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 19.331596851348877  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 0.10177850723266602  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160533, 128])
torch.Size([141480, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 19.472774982452393  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2010498046875 GB
    Memory Allocated: 0.1018218994140625  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160425, 128])
torch.Size([140940, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2244873046875 GB
    Memory Allocated: 19.337993621826172  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2244873046875 GB
    Memory Allocated: 0.10132789611816406  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160479, 128])
torch.Size([141110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.32101058959961  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04575890302658081 |0.06117337942123413 |0.3746963143348694 |0.00010836124420166016 |0.44118326902389526 |0.007133960723876953 |
----------------------------------------------------------pseudo_mini_loss sum 4.996859550476074
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2957749
Number of first layer input nodes during this epoch:  1284293
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.13434982299804688  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.022414445877075195
range selection method range initialization spend 0.011671304702758789
time for parepare:  0.01711726188659668
local_output_nid generation:  0.0029468536376953125
local_in_edges_tensor generation:  0.006329536437988281
mini_batch_src_global generation:  0.003897428512573242
r_  generation:  0.03986835479736328
local_output_nid generation:  0.0033643245697021484
local_in_edges_tensor generation:  0.0016596317291259766
mini_batch_src_global generation:  0.005094766616821289
r_  generation:  0.04095602035522461
local_output_nid generation:  0.0034723281860351562
local_in_edges_tensor generation:  0.0016143321990966797
mini_batch_src_global generation:  0.002751588821411133
r_  generation:  0.04026675224304199
local_output_nid generation:  0.003404378890991211
local_in_edges_tensor generation:  0.001651763916015625
mini_batch_src_global generation:  0.0029153823852539062
r_  generation:  0.040743112564086914
local_output_nid generation:  0.003435850143432617
local_in_edges_tensor generation:  0.0016870498657226562
mini_batch_src_global generation:  0.0029714107513427734
r_  generation:  0.04102134704589844
local_output_nid generation:  0.0034749507904052734
local_in_edges_tensor generation:  0.0017056465148925781
mini_batch_src_global generation:  0.003181934356689453
r_  generation:  0.04159045219421387
local_output_nid generation:  0.0034241676330566406
local_in_edges_tensor generation:  0.0017333030700683594
mini_batch_src_global generation:  0.0031108856201171875
r_  generation:  0.04169201850891113
local_output_nid generation:  0.0033881664276123047
local_in_edges_tensor generation:  0.0016760826110839844
mini_batch_src_global generation:  0.003265857696533203
r_  generation:  0.04239153861999512
----------------------check_connections_block total spend ----------------------------- 0.49633193016052246
generate_one_block  0.07444119453430176
generate_one_block  0.06060218811035156
generate_one_block  0.05950212478637695
generate_one_block  0.06083083152770996
generate_one_block  0.06139516830444336
generate_one_block  0.061151981353759766
generate_one_block  0.06363034248352051
generate_one_block  0.06188368797302246
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03920102119445801
gen group dst list time:  0.01769113540649414
time for parepare:  0.021760940551757812
local_output_nid generation:  0.010915279388427734
local_in_edges_tensor generation:  0.024475812911987305
mini_batch_src_global generation:  0.029272079467773438
r_  generation:  0.30200910568237305
local_output_nid generation:  0.01918768882751465
local_in_edges_tensor generation:  0.03244733810424805
mini_batch_src_global generation:  0.0402677059173584
r_  generation:  0.30724382400512695
local_output_nid generation:  0.016959667205810547
local_in_edges_tensor generation:  0.024546384811401367
mini_batch_src_global generation:  0.03529047966003418
r_  generation:  0.3145790100097656
local_output_nid generation:  0.017452716827392578
local_in_edges_tensor generation:  0.020550966262817383
mini_batch_src_global generation:  0.03823709487915039
r_  generation:  0.3149418830871582
local_output_nid generation:  0.01778435707092285
local_in_edges_tensor generation:  0.023121356964111328
mini_batch_src_global generation:  0.04358053207397461
r_  generation:  0.31987500190734863
local_output_nid generation:  0.02359747886657715
local_in_edges_tensor generation:  0.029921293258666992
mini_batch_src_global generation:  0.048163414001464844
r_  generation:  0.31029725074768066
local_output_nid generation:  0.01772451400756836
local_in_edges_tensor generation:  0.02355790138244629
mini_batch_src_global generation:  0.037110328674316406
r_  generation:  0.3105783462524414
local_output_nid generation:  0.01755976676940918
local_in_edges_tensor generation:  0.022745132446289062
mini_batch_src_global generation:  0.03748774528503418
r_  generation:  0.3079993724822998
----------------------check_connections_block total spend ----------------------------- 3.7002317905426025
generate_one_block  0.4180119037628174
generate_one_block  0.41506266593933105
generate_one_block  0.40146780014038086
generate_one_block  0.409252405166626
generate_one_block  0.40894031524658203
generate_one_block  0.411592960357666
generate_one_block  0.41919422149658203
generate_one_block  0.4423103332519531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.045867919921875
gen group dst list time:  0.037130117416381836
time for parepare:  0.01893138885498047
local_output_nid generation:  0.02568960189819336
local_in_edges_tensor generation:  0.06039786338806152
mini_batch_src_global generation:  0.04372572898864746
r_  generation:  0.4692237377166748
local_output_nid generation:  0.03150296211242676
local_in_edges_tensor generation:  0.04749631881713867
mini_batch_src_global generation:  0.053224802017211914
r_  generation:  0.47284698486328125
local_output_nid generation:  0.03191375732421875
local_in_edges_tensor generation:  0.03613138198852539
mini_batch_src_global generation:  0.05051994323730469
r_  generation:  0.486987829208374
local_output_nid generation:  0.03263425827026367
local_in_edges_tensor generation:  0.035552024841308594
mini_batch_src_global generation:  0.0577549934387207
r_  generation:  0.4997556209564209
local_output_nid generation:  0.032713890075683594
local_in_edges_tensor generation:  0.04042172431945801
mini_batch_src_global generation:  0.055928707122802734
r_  generation:  0.49517321586608887
local_output_nid generation:  0.033106088638305664
local_in_edges_tensor generation:  0.032012224197387695
mini_batch_src_global generation:  0.05521655082702637
r_  generation:  0.4849672317504883
local_output_nid generation:  0.03278994560241699
local_in_edges_tensor generation:  0.031896352767944336
mini_batch_src_global generation:  0.0570523738861084
r_  generation:  0.4984114170074463
local_output_nid generation:  0.033110618591308594
local_in_edges_tensor generation:  0.037697553634643555
mini_batch_src_global generation:  0.054677724838256836
r_  generation:  0.48366427421569824
----------------------check_connections_block total spend ----------------------------- 5.760833024978638
generate_one_block  0.627403736114502
generate_one_block  0.6374852657318115
generate_one_block  0.6226809024810791
generate_one_block  0.6335873603820801
generate_one_block  0.637218713760376
generate_one_block  0.6255254745483398
generate_one_block  0.6260342597961426
generate_one_block  0.6323754787445068
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.13434982299804688  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

connection checking time:  9.46106481552124
block generation total time  8.368143796920776
average batch blocks generation time:  1.046017974615097
block dataloader generation time/epoch 19.97908306121826
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.10484933853149414  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160443, 128])
torch.Size([141251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.33283567428589  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.10444164276123047  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160509, 128])
torch.Size([141213, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.459667205810547  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.10509538650512695  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160450, 128])
torch.Size([141118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.27976894378662  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.10500049591064453  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160515, 128])
torch.Size([141156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.443003177642822  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.1051473617553711  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160613, 128])
torch.Size([141443, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.402724266052246  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.1048440933227539  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160487, 128])
torch.Size([141123, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.29509925842285  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.10495519638061523  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160582, 128])
torch.Size([141198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 19.38051700592041  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2635498046875 GB
    Memory Allocated: 0.10571432113647461  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

torch.Size([160506, 128])
torch.Size([141162, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2947998046875 GB
    Memory Allocated: 19.367496967315674  GigaBytes
Max Memory Allocated: 19.545104026794434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04724082350730896 |0.01853927969932556 |0.27993467450141907 |9.649991989135742e-05 |0.43733635544776917 |0.005988597869873047 |
----------------------------------------------------------pseudo_mini_loss sum 3.3116698265075684
Total (block generation + training)time/epoch 26.276358604431152
Training time/epoch 6.297032117843628
Training time without block to device /epoch 6.148717880249023
Training time without total dataloading part /epoch 5.74492883682251
load block tensor time/epoch 0.3779265880584717
block to device time/epoch 0.1483142375946045
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2956808
Number of first layer input nodes during this epoch:  1284105
