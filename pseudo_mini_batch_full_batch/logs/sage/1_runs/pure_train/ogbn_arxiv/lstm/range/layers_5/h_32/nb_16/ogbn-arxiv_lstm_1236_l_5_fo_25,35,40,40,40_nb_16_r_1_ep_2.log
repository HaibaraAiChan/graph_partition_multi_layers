Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648504465.22952
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.024380207061767578
range selection method range initialization spend 0.013194561004638672
time for parepare:  0.017864704132080078
local_output_nid generation:  0.0013587474822998047
local_in_edges_tensor generation:  0.0038678646087646484
mini_batch_src_global generation:  0.001705169677734375
r_  generation:  0.016994237899780273
local_output_nid generation:  0.0015156269073486328
local_in_edges_tensor generation:  0.0009458065032958984
mini_batch_src_global generation:  0.0020411014556884766
r_  generation:  0.01773357391357422
local_output_nid generation:  0.0014355182647705078
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.0013535022735595703
r_  generation:  0.017410993576049805
local_output_nid generation:  0.0014865398406982422
local_in_edges_tensor generation:  0.0008597373962402344
mini_batch_src_global generation:  0.0012118816375732422
r_  generation:  0.017546653747558594
local_output_nid generation:  0.0014760494232177734
local_in_edges_tensor generation:  0.0008211135864257812
mini_batch_src_global generation:  0.0013782978057861328
r_  generation:  0.017503023147583008
local_output_nid generation:  0.0015518665313720703
local_in_edges_tensor generation:  0.0008511543273925781
mini_batch_src_global generation:  0.0012865066528320312
r_  generation:  0.01799774169921875
local_output_nid generation:  0.00147247314453125
local_in_edges_tensor generation:  0.0008003711700439453
mini_batch_src_global generation:  0.0014705657958984375
r_  generation:  0.018880128860473633
local_output_nid generation:  0.0015456676483154297
local_in_edges_tensor generation:  0.0008156299591064453
mini_batch_src_global generation:  0.0014162063598632812
r_  generation:  0.018244266510009766
local_output_nid generation:  0.0014939308166503906
local_in_edges_tensor generation:  0.0008347034454345703
mini_batch_src_global generation:  0.0014865398406982422
r_  generation:  0.018495559692382812
local_output_nid generation:  0.0015630722045898438
local_in_edges_tensor generation:  0.0008566379547119141
mini_batch_src_global generation:  0.0014050006866455078
r_  generation:  0.019215106964111328
local_output_nid generation:  0.0015854835510253906
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.0015301704406738281
r_  generation:  0.018368959426879883
local_output_nid generation:  0.0015048980712890625
local_in_edges_tensor generation:  0.0008330345153808594
mini_batch_src_global generation:  0.001356363296508789
r_  generation:  0.01874995231628418
local_output_nid generation:  0.0015888214111328125
local_in_edges_tensor generation:  0.0008199214935302734
mini_batch_src_global generation:  0.0014998912811279297
r_  generation:  0.018466472625732422
local_output_nid generation:  0.0014836788177490234
local_in_edges_tensor generation:  0.0008714199066162109
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.018426895141601562
local_output_nid generation:  0.0014955997467041016
local_in_edges_tensor generation:  0.0008275508880615234
mini_batch_src_global generation:  0.00146484375
r_  generation:  0.018451929092407227
local_output_nid generation:  0.0015349388122558594
local_in_edges_tensor generation:  0.0008165836334228516
mini_batch_src_global generation:  0.0015673637390136719
r_  generation:  0.018428564071655273
----------------------check_connections_block total spend ----------------------------- 0.43832993507385254
generate_one_block  0.027024507522583008
generate_one_block  0.027811050415039062
generate_one_block  0.027145862579345703
generate_one_block  0.029270172119140625
generate_one_block  0.02739858627319336
generate_one_block  0.0273282527923584
generate_one_block  0.027737855911254883
generate_one_block  0.026953935623168945
generate_one_block  0.027359724044799805
generate_one_block  0.027877092361450195
generate_one_block  0.02719879150390625
generate_one_block  0.027809619903564453
generate_one_block  0.027035236358642578
generate_one_block  0.027073383331298828
generate_one_block  0.0273284912109375
generate_one_block  0.026764869689941406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03986692428588867
gen group dst list time:  0.0186460018157959
time for parepare:  0.019936084747314453
local_output_nid generation:  0.00671839714050293
local_in_edges_tensor generation:  0.01595330238342285
mini_batch_src_global generation:  0.019446611404418945
r_  generation:  0.19928574562072754
local_output_nid generation:  0.012438297271728516
local_in_edges_tensor generation:  0.01955699920654297
mini_batch_src_global generation:  0.02474665641784668
r_  generation:  0.20512151718139648
local_output_nid generation:  0.01259303092956543
local_in_edges_tensor generation:  0.01550745964050293
mini_batch_src_global generation:  0.023602724075317383
r_  generation:  0.20588970184326172
local_output_nid generation:  0.013047933578491211
local_in_edges_tensor generation:  0.014615774154663086
mini_batch_src_global generation:  0.026361703872680664
r_  generation:  0.21149659156799316
local_output_nid generation:  0.01339864730834961
local_in_edges_tensor generation:  0.012859821319580078
mini_batch_src_global generation:  0.033960819244384766
r_  generation:  0.21347975730895996
local_output_nid generation:  0.013614654541015625
local_in_edges_tensor generation:  0.020041942596435547
mini_batch_src_global generation:  0.027768850326538086
r_  generation:  0.21925997734069824
local_output_nid generation:  0.013558149337768555
local_in_edges_tensor generation:  0.014839887619018555
mini_batch_src_global generation:  0.028327465057373047
r_  generation:  0.21845507621765137
local_output_nid generation:  0.01360940933227539
local_in_edges_tensor generation:  0.013364791870117188
mini_batch_src_global generation:  0.026754379272460938
r_  generation:  0.21266555786132812
local_output_nid generation:  0.01381373405456543
local_in_edges_tensor generation:  0.014694452285766602
mini_batch_src_global generation:  0.026684045791625977
r_  generation:  0.21628499031066895
local_output_nid generation:  0.014026165008544922
local_in_edges_tensor generation:  0.017415285110473633
mini_batch_src_global generation:  0.027623653411865234
r_  generation:  0.22462773323059082
local_output_nid generation:  0.013714075088500977
local_in_edges_tensor generation:  0.013303518295288086
mini_batch_src_global generation:  0.026956796646118164
r_  generation:  0.2140345573425293
local_output_nid generation:  0.014277935028076172
local_in_edges_tensor generation:  0.013503789901733398
mini_batch_src_global generation:  0.028764963150024414
r_  generation:  0.22126221656799316
local_output_nid generation:  0.014264583587646484
local_in_edges_tensor generation:  0.013446331024169922
mini_batch_src_global generation:  0.02724933624267578
r_  generation:  0.2189788818359375
local_output_nid generation:  0.014061689376831055
local_in_edges_tensor generation:  0.014871597290039062
mini_batch_src_global generation:  0.027341842651367188
r_  generation:  0.21627545356750488
local_output_nid generation:  0.014437198638916016
local_in_edges_tensor generation:  0.01894378662109375
mini_batch_src_global generation:  0.028924942016601562
r_  generation:  0.21888256072998047
local_output_nid generation:  0.013878107070922852
local_in_edges_tensor generation:  0.013221979141235352
mini_batch_src_global generation:  0.02732086181640625
r_  generation:  0.21569561958312988
----------------------check_connections_block total spend ----------------------------- 5.094956159591675
generate_one_block  0.2857210636138916
generate_one_block  0.2887747287750244
generate_one_block  0.2713637351989746
generate_one_block  0.277371883392334
generate_one_block  0.29593944549560547
generate_one_block  0.28086400032043457
generate_one_block  0.2861907482147217
generate_one_block  0.27572059631347656
generate_one_block  0.2851684093475342
generate_one_block  0.29150986671447754
generate_one_block  0.27629971504211426
generate_one_block  0.287933349609375
generate_one_block  0.2774055004119873
generate_one_block  0.27760910987854004
generate_one_block  0.28530287742614746
generate_one_block  0.285106897354126
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.04127144813537598
gen group dst list time:  0.059889793395996094
time for parepare:  0.01925039291381836
local_output_nid generation:  0.024048805236816406
local_in_edges_tensor generation:  0.04204154014587402
mini_batch_src_global generation:  0.0471959114074707
r_  generation:  0.49226999282836914
local_output_nid generation:  0.030681133270263672
local_in_edges_tensor generation:  0.04692363739013672
mini_batch_src_global generation:  0.058071136474609375
r_  generation:  0.5074689388275146
local_output_nid generation:  0.030039310455322266
local_in_edges_tensor generation:  0.030251026153564453
mini_batch_src_global generation:  0.05781841278076172
r_  generation:  0.5018060207366943
local_output_nid generation:  0.030000686645507812
local_in_edges_tensor generation:  0.03357219696044922
mini_batch_src_global generation:  0.05866503715515137
r_  generation:  0.5018260478973389
local_output_nid generation:  0.029937028884887695
local_in_edges_tensor generation:  0.039505720138549805
mini_batch_src_global generation:  0.061356306076049805
r_  generation:  0.5001034736633301
local_output_nid generation:  0.030120134353637695
local_in_edges_tensor generation:  0.03016519546508789
mini_batch_src_global generation:  0.06263303756713867
r_  generation:  0.5061824321746826
local_output_nid generation:  0.03047800064086914
local_in_edges_tensor generation:  0.03432893753051758
mini_batch_src_global generation:  0.05856657028198242
r_  generation:  0.5098845958709717
local_output_nid generation:  0.030305862426757812
local_in_edges_tensor generation:  0.03457069396972656
mini_batch_src_global generation:  0.060411691665649414
r_  generation:  0.503389835357666
local_output_nid generation:  0.03015756607055664
local_in_edges_tensor generation:  0.03873085975646973
mini_batch_src_global generation:  0.05825328826904297
r_  generation:  0.5022716522216797
local_output_nid generation:  0.03031754493713379
local_in_edges_tensor generation:  0.033843994140625
mini_batch_src_global generation:  0.06264162063598633
r_  generation:  0.5026698112487793
local_output_nid generation:  0.03007650375366211
local_in_edges_tensor generation:  0.03329634666442871
mini_batch_src_global generation:  0.05854320526123047
r_  generation:  0.5042729377746582
local_output_nid generation:  0.030210494995117188
local_in_edges_tensor generation:  0.03339815139770508
mini_batch_src_global generation:  0.05942273139953613
r_  generation:  0.49900102615356445
local_output_nid generation:  0.03024125099182129
local_in_edges_tensor generation:  0.03412890434265137
mini_batch_src_global generation:  0.0582277774810791
r_  generation:  0.5059995651245117
local_output_nid generation:  0.030491113662719727
local_in_edges_tensor generation:  0.03444671630859375
mini_batch_src_global generation:  0.05962371826171875
r_  generation:  0.5111618041992188
local_output_nid generation:  0.030514240264892578
local_in_edges_tensor generation:  0.03930187225341797
mini_batch_src_global generation:  0.05971193313598633
r_  generation:  0.5103225708007812
local_output_nid generation:  0.030524253845214844
local_in_edges_tensor generation:  0.030607938766479492
mini_batch_src_global generation:  0.059678077697753906
r_  generation:  0.5045478343963623
----------------------check_connections_block total spend ----------------------------- 11.781545400619507
generate_one_block  0.6636533737182617
generate_one_block  0.6639230251312256
generate_one_block  0.634127140045166
generate_one_block  0.6497995853424072
generate_one_block  0.6481478214263916
generate_one_block  0.6841294765472412
generate_one_block  0.766564130783081
generate_one_block  0.6770014762878418
generate_one_block  0.6677989959716797
generate_one_block  0.682579517364502
generate_one_block  0.6514763832092285
generate_one_block  0.6805558204650879
generate_one_block  0.6829259395599365
generate_one_block  0.6618874073028564
generate_one_block  0.6937911510467529
generate_one_block  0.6513845920562744
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0509953498840332
gen group dst list time:  0.1013479232788086
time for parepare:  0.01914215087890625
local_output_nid generation:  0.03153347969055176
local_in_edges_tensor generation:  0.08874678611755371
mini_batch_src_global generation:  0.049948692321777344
r_  generation:  0.5263268947601318
local_output_nid generation:  0.038065433502197266
local_in_edges_tensor generation:  0.057126522064208984
mini_batch_src_global generation:  0.061196088790893555
r_  generation:  0.5436182022094727
local_output_nid generation:  0.03658413887023926
local_in_edges_tensor generation:  0.05832195281982422
mini_batch_src_global generation:  0.0685422420501709
r_  generation:  0.5332183837890625
local_output_nid generation:  0.03838515281677246
local_in_edges_tensor generation:  0.04226064682006836
mini_batch_src_global generation:  0.058267831802368164
r_  generation:  0.5352425575256348
local_output_nid generation:  0.037748098373413086
local_in_edges_tensor generation:  0.039031982421875
mini_batch_src_global generation:  0.058782339096069336
r_  generation:  0.5418071746826172
local_output_nid generation:  0.03766059875488281
local_in_edges_tensor generation:  0.03945779800415039
mini_batch_src_global generation:  0.05991411209106445
r_  generation:  0.5547573566436768
local_output_nid generation:  0.038458824157714844
local_in_edges_tensor generation:  0.04706263542175293
mini_batch_src_global generation:  0.058194637298583984
r_  generation:  0.5505945682525635
local_output_nid generation:  0.038568973541259766
local_in_edges_tensor generation:  0.0403897762298584
mini_batch_src_global generation:  0.06066727638244629
r_  generation:  0.5559418201446533
local_output_nid generation:  0.037979841232299805
local_in_edges_tensor generation:  0.03917217254638672
mini_batch_src_global generation:  0.06095409393310547
r_  generation:  0.5548064708709717
local_output_nid generation:  0.038169145584106445
local_in_edges_tensor generation:  0.047547101974487305
mini_batch_src_global generation:  0.06963491439819336
r_  generation:  0.5705664157867432
local_output_nid generation:  0.04188346862792969
local_in_edges_tensor generation:  0.04887247085571289
mini_batch_src_global generation:  0.07230305671691895
r_  generation:  0.5589151382446289
local_output_nid generation:  0.038155317306518555
local_in_edges_tensor generation:  0.03785896301269531
mini_batch_src_global generation:  0.06131339073181152
r_  generation:  0.5510475635528564
local_output_nid generation:  0.0379335880279541
local_in_edges_tensor generation:  0.034562110900878906
mini_batch_src_global generation:  0.05939793586730957
r_  generation:  0.5533511638641357
local_output_nid generation:  0.03801321983337402
local_in_edges_tensor generation:  0.04396867752075195
mini_batch_src_global generation:  0.05949854850769043
r_  generation:  0.5529515743255615
local_output_nid generation:  0.038908958435058594
local_in_edges_tensor generation:  0.03771495819091797
mini_batch_src_global generation:  0.06293177604675293
r_  generation:  0.5559911727905273
local_output_nid generation:  0.0384976863861084
local_in_edges_tensor generation:  0.03847932815551758
mini_batch_src_global generation:  0.05955862998962402
r_  generation:  0.5555381774902344
----------------------check_connections_block total spend ----------------------------- 13.21869421005249
generate_one_block  0.7083911895751953
generate_one_block  0.6908810138702393
generate_one_block  0.7566781044006348
generate_one_block  0.6796741485595703
generate_one_block  0.6817808151245117
generate_one_block  0.6961719989776611
generate_one_block  0.6961202621459961
generate_one_block  0.6863386631011963
generate_one_block  0.6667096614837646
generate_one_block  0.6770966053009033
generate_one_block  0.6820430755615234
generate_one_block  0.6891896724700928
generate_one_block  0.6778340339660645
generate_one_block  0.6765034198760986
generate_one_block  0.681908369064331
generate_one_block  0.6712830066680908
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03969526290893555
gen group dst list time:  0.09404540061950684
time for parepare:  0.01918768882751465
local_output_nid generation:  0.03402900695800781
local_in_edges_tensor generation:  0.04777717590332031
mini_batch_src_global generation:  0.044899940490722656
r_  generation:  0.49266886711120605
local_output_nid generation:  0.04103231430053711
local_in_edges_tensor generation:  0.0350949764251709
mini_batch_src_global generation:  0.056505680084228516
r_  generation:  0.4995079040527344
local_output_nid generation:  0.03814268112182617
local_in_edges_tensor generation:  0.03524613380432129
mini_batch_src_global generation:  0.05706667900085449
r_  generation:  0.5020508766174316
local_output_nid generation:  0.03799128532409668
local_in_edges_tensor generation:  0.039652109146118164
mini_batch_src_global generation:  0.05631399154663086
r_  generation:  0.5043554306030273
local_output_nid generation:  0.03820347785949707
local_in_edges_tensor generation:  0.04488873481750488
mini_batch_src_global generation:  0.057054758071899414
r_  generation:  0.5067367553710938
local_output_nid generation:  0.03820681571960449
local_in_edges_tensor generation:  0.04722404479980469
mini_batch_src_global generation:  0.06830096244812012
r_  generation:  0.5130023956298828
local_output_nid generation:  0.04223966598510742
local_in_edges_tensor generation:  0.05232357978820801
mini_batch_src_global generation:  0.05815935134887695
r_  generation:  0.5063989162445068
local_output_nid generation:  0.03995203971862793
local_in_edges_tensor generation:  0.0425567626953125
mini_batch_src_global generation:  0.05613446235656738
r_  generation:  0.5165445804595947
local_output_nid generation:  0.039832115173339844
local_in_edges_tensor generation:  0.03993487358093262
mini_batch_src_global generation:  0.05587196350097656
r_  generation:  0.5171420574188232
local_output_nid generation:  0.04029560089111328
local_in_edges_tensor generation:  0.04018139839172363
mini_batch_src_global generation:  0.05625629425048828
r_  generation:  0.5148513317108154
local_output_nid generation:  0.040013790130615234
local_in_edges_tensor generation:  0.04518532752990723
mini_batch_src_global generation:  0.05592083930969238
r_  generation:  0.5214231014251709
local_output_nid generation:  0.03991293907165527
local_in_edges_tensor generation:  0.04533958435058594
mini_batch_src_global generation:  0.0563197135925293
r_  generation:  0.5142879486083984
local_output_nid generation:  0.039734601974487305
local_in_edges_tensor generation:  0.03634381294250488
mini_batch_src_global generation:  0.057029008865356445
r_  generation:  0.5178377628326416
local_output_nid generation:  0.039513587951660156
local_in_edges_tensor generation:  0.03743600845336914
mini_batch_src_global generation:  0.05667567253112793
r_  generation:  0.5283517837524414
local_output_nid generation:  0.0397493839263916
local_in_edges_tensor generation:  0.04117536544799805
mini_batch_src_global generation:  0.05684971809387207
r_  generation:  0.5172953605651855
local_output_nid generation:  0.04023289680480957
local_in_edges_tensor generation:  0.04440188407897949
mini_batch_src_global generation:  0.057027578353881836
r_  generation:  0.5172054767608643
----------------------check_connections_block total spend ----------------------------- 12.352179527282715
generate_one_block  0.6308488845825195
generate_one_block  0.637894868850708
generate_one_block  0.6414680480957031
generate_one_block  0.6371762752532959
generate_one_block  0.6323375701904297
generate_one_block  0.70650315284729
generate_one_block  0.6355624198913574
generate_one_block  0.6320371627807617
generate_one_block  0.6316473484039307
generate_one_block  0.6219477653503418
generate_one_block  0.6334261894226074
generate_one_block  0.6378722190856934
generate_one_block  0.6218771934509277
generate_one_block  0.6247689723968506
generate_one_block  0.6300437450408936
generate_one_block  0.6489129066467285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000690460205078125  GigaBytes
Max Memory Allocated: 0.000690460205078125  GigaBytes

connection checking time:  42.44737529754639
block generation total time  36.51095652580261
average batch blocks generation time:  2.2819347828626633
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2205810546875 GB
    Memory Allocated: 0.12235879898071289  GigaBytes
Max Memory Allocated: 0.12235879898071289  GigaBytes

torch.Size([166208, 128])
torch.Size([163842, 32])
torch.Size([155525, 32])
torch.Size([123902, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8065185546875 GB
    Memory Allocated: 19.462881088256836  GigaBytes
Max Memory Allocated: 19.46945810317993  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7811279296875 GB
    Memory Allocated: 0.12450790405273438  GigaBytes
Max Memory Allocated: 19.46945810317993  GigaBytes

torch.Size([166330, 128])
torch.Size([164060, 32])
torch.Size([156133, 32])
torch.Size([124609, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 19.498948097229004  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 0.12442636489868164  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

torch.Size([166324, 128])
torch.Size([163927, 32])
torch.Size([155724, 32])
torch.Size([123405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 19.439740657806396  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 0.1244344711303711  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

torch.Size([166164, 128])
torch.Size([163800, 32])
torch.Size([155557, 32])
torch.Size([123365, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 19.460617065429688  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 0.12445211410522461  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

torch.Size([166159, 128])
torch.Size([163781, 32])
torch.Size([155603, 32])
torch.Size([123612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 19.442965984344482  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 0.12447547912597656  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

torch.Size([166288, 128])
torch.Size([163922, 32])
torch.Size([155947, 32])
torch.Size([124201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 19.48180913925171  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7850341796875 GB
    Memory Allocated: 0.12448453903198242  GigaBytes
Max Memory Allocated: 19.506117820739746  GigaBytes

torch.Size([166380, 128])
torch.Size([164150, 32])
torch.Size([156146, 32])
torch.Size([124201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.499545574188232  GigaBytes
Max Memory Allocated: 19.506633281707764  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12447023391723633  GigaBytes
Max Memory Allocated: 19.506633281707764  GigaBytes

torch.Size([166325, 128])
torch.Size([164072, 32])
torch.Size([156084, 32])
torch.Size([124287, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.47320032119751  GigaBytes
Max Memory Allocated: 19.506633281707764  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12444257736206055  GigaBytes
Max Memory Allocated: 19.506633281707764  GigaBytes

torch.Size([166286, 128])
torch.Size([163926, 32])
torch.Size([155707, 32])
torch.Size([123516, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.463695526123047  GigaBytes
Max Memory Allocated: 19.506633281707764  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12447977066040039  GigaBytes
Max Memory Allocated: 19.506633281707764  GigaBytes

torch.Size([166217, 128])
torch.Size([163849, 32])
torch.Size([155528, 32])
torch.Size([123459, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.50676918029785  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12446260452270508  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166315, 128])
torch.Size([164023, 32])
torch.Size([155896, 32])
torch.Size([124080, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.463575839996338  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12445592880249023  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166298, 128])
torch.Size([163920, 32])
torch.Size([155649, 32])
torch.Size([123601, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.48112964630127  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12443017959594727  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166048, 128])
torch.Size([163549, 32])
torch.Size([155290, 32])
torch.Size([123386, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.44627618789673  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12441825866699219  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166265, 128])
torch.Size([163954, 32])
torch.Size([155812, 32])
torch.Size([123218, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.43997859954834  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12446832656860352  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166270, 128])
torch.Size([163970, 32])
torch.Size([155825, 32])
torch.Size([123982, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.483632564544678  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1244363784790039  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166292, 128])
torch.Size([164003, 32])
torch.Size([155732, 32])
torch.Size([123256, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.44647789001465  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0401681512594223 |0.06358633935451508 |0.511543482542038 |0.00010591745376586914 |0.6282213926315308 |0.013261795043945312 |
----------------------------------------------------------pseudo_mini_loss sum 4.514723300933838
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10416900
Number of first layer input nodes during this epoch:  2660169
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.20260238647460938  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.02392101287841797
range selection method range initialization spend 0.015926361083984375
time for parepare:  0.0175323486328125
local_output_nid generation:  0.0018966197967529297
local_in_edges_tensor generation:  0.007233858108520508
mini_batch_src_global generation:  0.0023310184478759766
r_  generation:  0.020390748977661133
local_output_nid generation:  0.0020296573638916016
local_in_edges_tensor generation:  0.000988006591796875
mini_batch_src_global generation:  0.0021560192108154297
r_  generation:  0.01982283592224121
local_output_nid generation:  0.00189971923828125
local_in_edges_tensor generation:  0.0008966922760009766
mini_batch_src_global generation:  0.0015113353729248047
r_  generation:  0.0191652774810791
local_output_nid generation:  0.0018801689147949219
local_in_edges_tensor generation:  0.0009081363677978516
mini_batch_src_global generation:  0.0015225410461425781
r_  generation:  0.019878387451171875
local_output_nid generation:  0.0017862319946289062
local_in_edges_tensor generation:  0.0009248256683349609
mini_batch_src_global generation:  0.0015676021575927734
r_  generation:  0.019103050231933594
local_output_nid generation:  0.0018048286437988281
local_in_edges_tensor generation:  0.0009002685546875
mini_batch_src_global generation:  0.0015952587127685547
r_  generation:  0.02005791664123535
local_output_nid generation:  0.00177001953125
local_in_edges_tensor generation:  0.0008931159973144531
mini_batch_src_global generation:  0.0015728473663330078
r_  generation:  0.01996469497680664
local_output_nid generation:  0.00177001953125
local_in_edges_tensor generation:  0.00093841552734375
mini_batch_src_global generation:  0.001512765884399414
r_  generation:  0.019617319107055664
local_output_nid generation:  0.0017762184143066406
local_in_edges_tensor generation:  0.0009355545043945312
mini_batch_src_global generation:  0.0015997886657714844
r_  generation:  0.02010059356689453
local_output_nid generation:  0.0017695426940917969
local_in_edges_tensor generation:  0.0009181499481201172
mini_batch_src_global generation:  0.0016055107116699219
r_  generation:  0.019637107849121094
local_output_nid generation:  0.001744985580444336
local_in_edges_tensor generation:  0.0009024143218994141
mini_batch_src_global generation:  0.001560211181640625
r_  generation:  0.019697189331054688
local_output_nid generation:  0.001680612564086914
local_in_edges_tensor generation:  0.0008680820465087891
mini_batch_src_global generation:  0.0015552043914794922
r_  generation:  0.019609689712524414
local_output_nid generation:  0.0017137527465820312
local_in_edges_tensor generation:  0.0009922981262207031
mini_batch_src_global generation:  0.001589059829711914
r_  generation:  0.020021915435791016
local_output_nid generation:  0.0016970634460449219
local_in_edges_tensor generation:  0.0009055137634277344
mini_batch_src_global generation:  0.0016415119171142578
r_  generation:  0.020561933517456055
local_output_nid generation:  0.0017375946044921875
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.001641988754272461
r_  generation:  0.019825458526611328
local_output_nid generation:  0.0017108917236328125
local_in_edges_tensor generation:  0.0008790493011474609
mini_batch_src_global generation:  0.0015511512756347656
r_  generation:  0.019788742065429688
----------------------check_connections_block total spend ----------------------------- 0.4823465347290039
generate_one_block  0.03672075271606445
generate_one_block  0.03225278854370117
generate_one_block  0.03232240676879883
generate_one_block  0.03384828567504883
generate_one_block  0.03200721740722656
generate_one_block  0.03513002395629883
generate_one_block  0.03275179862976074
generate_one_block  0.03196835517883301
generate_one_block  0.03251767158508301
generate_one_block  0.032953739166259766
generate_one_block  0.03239870071411133
generate_one_block  0.03258013725280762
generate_one_block  0.032736778259277344
generate_one_block  0.03297066688537598
generate_one_block  0.03298187255859375
generate_one_block  0.03273153305053711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.03887224197387695
gen group dst list time:  0.016913175582885742
time for parepare:  0.019567012786865234
local_output_nid generation:  0.00762629508972168
local_in_edges_tensor generation:  0.02113938331604004
mini_batch_src_global generation:  0.01934337615966797
r_  generation:  0.19944524765014648
local_output_nid generation:  0.01150059700012207
local_in_edges_tensor generation:  0.018064260482788086
mini_batch_src_global generation:  0.02476978302001953
r_  generation:  0.20576024055480957
local_output_nid generation:  0.012064933776855469
local_in_edges_tensor generation:  0.014681100845336914
mini_batch_src_global generation:  0.024086713790893555
r_  generation:  0.2153775691986084
local_output_nid generation:  0.01278233528137207
local_in_edges_tensor generation:  0.015325546264648438
mini_batch_src_global generation:  0.025381803512573242
r_  generation:  0.21602082252502441
local_output_nid generation:  0.0121917724609375
local_in_edges_tensor generation:  0.013120651245117188
mini_batch_src_global generation:  0.026164531707763672
r_  generation:  0.21722769737243652
local_output_nid generation:  0.012939691543579102
local_in_edges_tensor generation:  0.011667251586914062
mini_batch_src_global generation:  0.026529550552368164
r_  generation:  0.2159416675567627
local_output_nid generation:  0.012988805770874023
local_in_edges_tensor generation:  0.014412403106689453
mini_batch_src_global generation:  0.028562068939208984
r_  generation:  0.21920156478881836
local_output_nid generation:  0.013098478317260742
local_in_edges_tensor generation:  0.013152122497558594
mini_batch_src_global generation:  0.02670574188232422
r_  generation:  0.21770477294921875
local_output_nid generation:  0.013324975967407227
local_in_edges_tensor generation:  0.013589143753051758
mini_batch_src_global generation:  0.027241230010986328
r_  generation:  0.22063326835632324
local_output_nid generation:  0.013369321823120117
local_in_edges_tensor generation:  0.014942646026611328
mini_batch_src_global generation:  0.02731943130493164
r_  generation:  0.2200162410736084
local_output_nid generation:  0.013465166091918945
local_in_edges_tensor generation:  0.013647079467773438
mini_batch_src_global generation:  0.027518510818481445
r_  generation:  0.2232952117919922
local_output_nid generation:  0.01333308219909668
local_in_edges_tensor generation:  0.013469696044921875
mini_batch_src_global generation:  0.029021024703979492
r_  generation:  0.22246193885803223
local_output_nid generation:  0.013625144958496094
local_in_edges_tensor generation:  0.017670869827270508
mini_batch_src_global generation:  0.027187108993530273
r_  generation:  0.22810029983520508
local_output_nid generation:  0.013073444366455078
local_in_edges_tensor generation:  0.013648748397827148
mini_batch_src_global generation:  0.029323101043701172
r_  generation:  0.22372674942016602
local_output_nid generation:  0.012823104858398438
local_in_edges_tensor generation:  0.014139175415039062
mini_batch_src_global generation:  0.027780771255493164
r_  generation:  0.2240300178527832
local_output_nid generation:  0.012844562530517578
local_in_edges_tensor generation:  0.012329816818237305
mini_batch_src_global generation:  0.027981996536254883
r_  generation:  0.2215433120727539
----------------------check_connections_block total spend ----------------------------- 5.135274171829224
generate_one_block  0.29739952087402344
generate_one_block  0.29509568214416504
generate_one_block  0.29465723037719727
generate_one_block  0.30428004264831543
generate_one_block  0.3049166202545166
generate_one_block  0.33693885803222656
generate_one_block  0.32830309867858887
generate_one_block  0.29550671577453613
generate_one_block  0.2969696521759033
generate_one_block  0.29798007011413574
generate_one_block  0.29224681854248047
generate_one_block  0.2974998950958252
generate_one_block  0.29781293869018555
generate_one_block  0.30170130729675293
generate_one_block  0.29778575897216797
generate_one_block  0.29546165466308594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.06247258186340332
gen group dst list time:  0.06017041206359863
time for parepare:  0.021317481994628906
local_output_nid generation:  0.02682662010192871
local_in_edges_tensor generation:  0.05956745147705078
mini_batch_src_global generation:  0.04965949058532715
r_  generation:  0.5141932964324951
local_output_nid generation:  0.031984806060791016
local_in_edges_tensor generation:  0.05171704292297363
mini_batch_src_global generation:  0.05885124206542969
r_  generation:  0.5325319766998291
local_output_nid generation:  0.03260016441345215
local_in_edges_tensor generation:  0.05592060089111328
mini_batch_src_global generation:  0.06948018074035645
r_  generation:  0.5115630626678467
local_output_nid generation:  0.033833980560302734
local_in_edges_tensor generation:  0.04194974899291992
mini_batch_src_global generation:  0.059206485748291016
r_  generation:  0.513662576675415
local_output_nid generation:  0.03272891044616699
local_in_edges_tensor generation:  0.0998225212097168
mini_batch_src_global generation:  0.05932450294494629
r_  generation:  0.5086324214935303
local_output_nid generation:  0.03383469581604004
local_in_edges_tensor generation:  0.035941123962402344
mini_batch_src_global generation:  0.06022167205810547
r_  generation:  0.516472578048706
local_output_nid generation:  0.031374454498291016
local_in_edges_tensor generation:  0.032126665115356445
mini_batch_src_global generation:  0.06027984619140625
r_  generation:  0.5213866233825684
local_output_nid generation:  0.03212904930114746
local_in_edges_tensor generation:  0.03157973289489746
mini_batch_src_global generation:  0.059359073638916016
r_  generation:  0.5105459690093994
local_output_nid generation:  0.032973289489746094
local_in_edges_tensor generation:  0.052657365798950195
mini_batch_src_global generation:  0.0749349594116211
r_  generation:  0.531670093536377
local_output_nid generation:  0.03475356101989746
local_in_edges_tensor generation:  0.04189872741699219
mini_batch_src_global generation:  0.06376981735229492
r_  generation:  0.5212304592132568
local_output_nid generation:  0.03268861770629883
local_in_edges_tensor generation:  0.03611564636230469
mini_batch_src_global generation:  0.059456586837768555
r_  generation:  0.5221784114837646
local_output_nid generation:  0.03284764289855957
local_in_edges_tensor generation:  0.03197479248046875
mini_batch_src_global generation:  0.060602664947509766
r_  generation:  0.5177617073059082
local_output_nid generation:  0.03302264213562012
local_in_edges_tensor generation:  0.044919729232788086
mini_batch_src_global generation:  0.06283855438232422
r_  generation:  0.518904447555542
local_output_nid generation:  0.033139705657958984
local_in_edges_tensor generation:  0.03543853759765625
mini_batch_src_global generation:  0.06252312660217285
r_  generation:  0.5231680870056152
local_output_nid generation:  0.03366255760192871
local_in_edges_tensor generation:  0.03797578811645508
mini_batch_src_global generation:  0.060211181640625
r_  generation:  0.5256307125091553
local_output_nid generation:  0.03320646286010742
local_in_edges_tensor generation:  0.040355682373046875
mini_batch_src_global generation:  0.062363386154174805
r_  generation:  0.5234236717224121
----------------------check_connections_block total spend ----------------------------- 12.327131509780884
generate_one_block  0.6971337795257568
generate_one_block  0.6767017841339111
generate_one_block  0.6829378604888916
generate_one_block  0.697974443435669
generate_one_block  0.6787717342376709
generate_one_block  0.6734046936035156
generate_one_block  0.667844295501709
generate_one_block  0.6814761161804199
generate_one_block  0.7208061218261719
generate_one_block  0.6845734119415283
generate_one_block  0.6626713275909424
generate_one_block  0.6662991046905518
generate_one_block  0.6821856498718262
generate_one_block  0.6915867328643799
generate_one_block  0.6682586669921875
generate_one_block  0.659888505935669
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.044759511947631836
gen group dst list time:  0.09968709945678711
time for parepare:  0.01983952522277832
local_output_nid generation:  0.0343012809753418
local_in_edges_tensor generation:  0.06346702575683594
mini_batch_src_global generation:  0.0496368408203125
r_  generation:  0.5316276550292969
local_output_nid generation:  0.03957533836364746
local_in_edges_tensor generation:  0.05764365196228027
mini_batch_src_global generation:  0.06196165084838867
r_  generation:  0.539726734161377
local_output_nid generation:  0.039759159088134766
local_in_edges_tensor generation:  0.054268598556518555
mini_batch_src_global generation:  0.058841705322265625
r_  generation:  0.5490241050720215
local_output_nid generation:  0.040587663650512695
local_in_edges_tensor generation:  0.048607587814331055
mini_batch_src_global generation:  0.07432174682617188
r_  generation:  0.5474457740783691
local_output_nid generation:  0.04071998596191406
local_in_edges_tensor generation:  0.0457000732421875
mini_batch_src_global generation:  0.05800437927246094
r_  generation:  0.5447096824645996
local_output_nid generation:  0.03847861289978027
local_in_edges_tensor generation:  0.03894186019897461
mini_batch_src_global generation:  0.0575408935546875
r_  generation:  0.5492572784423828
local_output_nid generation:  0.03870058059692383
local_in_edges_tensor generation:  0.04055190086364746
mini_batch_src_global generation:  0.06352448463439941
r_  generation:  0.5548098087310791
local_output_nid generation:  0.039234161376953125
local_in_edges_tensor generation:  0.045720577239990234
mini_batch_src_global generation:  0.06005215644836426
r_  generation:  0.5515782833099365
local_output_nid generation:  0.039028167724609375
local_in_edges_tensor generation:  0.041706085205078125
mini_batch_src_global generation:  0.060335397720336914
r_  generation:  0.5578107833862305
local_output_nid generation:  0.03887939453125
local_in_edges_tensor generation:  0.03986096382141113
mini_batch_src_global generation:  0.06228280067443848
r_  generation:  0.5569446086883545
local_output_nid generation:  0.038987159729003906
local_in_edges_tensor generation:  0.04113435745239258
mini_batch_src_global generation:  0.060006141662597656
r_  generation:  0.5545356273651123
local_output_nid generation:  0.039389848709106445
local_in_edges_tensor generation:  0.047510385513305664
mini_batch_src_global generation:  0.060381174087524414
r_  generation:  0.5576889514923096
local_output_nid generation:  0.03911399841308594
local_in_edges_tensor generation:  0.040472984313964844
mini_batch_src_global generation:  0.061777591705322266
r_  generation:  0.5556800365447998
local_output_nid generation:  0.04286003112792969
local_in_edges_tensor generation:  0.04026389122009277
mini_batch_src_global generation:  0.060851335525512695
r_  generation:  0.5571937561035156
local_output_nid generation:  0.03999137878417969
local_in_edges_tensor generation:  0.0366213321685791
mini_batch_src_global generation:  0.06071805953979492
r_  generation:  0.5630156993865967
local_output_nid generation:  0.04030942916870117
local_in_edges_tensor generation:  0.03602004051208496
mini_batch_src_global generation:  0.06043362617492676
r_  generation:  0.5624501705169678
----------------------check_connections_block total spend ----------------------------- 13.256132125854492
generate_one_block  0.7274742126464844
generate_one_block  0.7207865715026855
generate_one_block  0.7129840850830078
generate_one_block  0.7046911716461182
generate_one_block  0.7042560577392578
generate_one_block  0.6949949264526367
generate_one_block  0.777456521987915
generate_one_block  0.7143814563751221
generate_one_block  0.7160470485687256
generate_one_block  0.693523645401001
generate_one_block  0.7039313316345215
generate_one_block  0.7112107276916504
generate_one_block  0.7132973670959473
generate_one_block  0.708432674407959
generate_one_block  0.6978387832641602
generate_one_block  0.6926314830780029
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05441784858703613
gen group dst list time:  0.09823918342590332
time for parepare:  0.01966547966003418
local_output_nid generation:  0.037427425384521484
local_in_edges_tensor generation:  0.04558825492858887
mini_batch_src_global generation:  0.043666839599609375
r_  generation:  0.5082831382751465
local_output_nid generation:  0.04118061065673828
local_in_edges_tensor generation:  0.03511309623718262
mini_batch_src_global generation:  0.057969093322753906
r_  generation:  0.5064435005187988
local_output_nid generation:  0.039656639099121094
local_in_edges_tensor generation:  0.03587913513183594
mini_batch_src_global generation:  0.057576894760131836
r_  generation:  0.5135266780853271
local_output_nid generation:  0.04020977020263672
local_in_edges_tensor generation:  0.04304909706115723
mini_batch_src_global generation:  0.06134295463562012
r_  generation:  0.5109751224517822
local_output_nid generation:  0.04062604904174805
local_in_edges_tensor generation:  0.043218135833740234
mini_batch_src_global generation:  0.056735992431640625
r_  generation:  0.5209097862243652
local_output_nid generation:  0.04008841514587402
local_in_edges_tensor generation:  0.04495859146118164
mini_batch_src_global generation:  0.07149291038513184
r_  generation:  0.5106651782989502
local_output_nid generation:  0.042269229888916016
local_in_edges_tensor generation:  0.04587268829345703
mini_batch_src_global generation:  0.05837607383728027
r_  generation:  0.5239932537078857
local_output_nid generation:  0.04142928123474121
local_in_edges_tensor generation:  0.040430307388305664
mini_batch_src_global generation:  0.05704927444458008
r_  generation:  0.5139005184173584
local_output_nid generation:  0.041510820388793945
local_in_edges_tensor generation:  0.04089999198913574
mini_batch_src_global generation:  0.056246280670166016
r_  generation:  0.5191419124603271
local_output_nid generation:  0.041658639907836914
local_in_edges_tensor generation:  0.04535245895385742
mini_batch_src_global generation:  0.05653023719787598
r_  generation:  0.5184609889984131
local_output_nid generation:  0.04208731651306152
local_in_edges_tensor generation:  0.04098987579345703
mini_batch_src_global generation:  0.05635643005371094
r_  generation:  0.5327160358428955
local_output_nid generation:  0.0419459342956543
local_in_edges_tensor generation:  0.04548311233520508
mini_batch_src_global generation:  0.0572507381439209
r_  generation:  0.5209798812866211
local_output_nid generation:  0.04217982292175293
local_in_edges_tensor generation:  0.04102134704589844
mini_batch_src_global generation:  0.0567317008972168
r_  generation:  0.5365555286407471
local_output_nid generation:  0.041770219802856445
local_in_edges_tensor generation:  0.04062771797180176
mini_batch_src_global generation:  0.057097673416137695
r_  generation:  0.5243585109710693
local_output_nid generation:  0.04168820381164551
local_in_edges_tensor generation:  0.04575300216674805
mini_batch_src_global generation:  0.05742049217224121
r_  generation:  0.5280940532684326
local_output_nid generation:  0.04185986518859863
local_in_edges_tensor generation:  0.04080486297607422
mini_batch_src_global generation:  0.05704641342163086
r_  generation:  0.5287222862243652
----------------------check_connections_block total spend ----------------------------- 12.55977487564087
generate_one_block  0.6688451766967773
generate_one_block  0.6703665256500244
generate_one_block  0.6639459133148193
generate_one_block  0.6695561408996582
generate_one_block  0.6635832786560059
generate_one_block  0.6574270725250244
generate_one_block  0.6635832786560059
generate_one_block  0.6680259704589844
generate_one_block  0.6656429767608643
generate_one_block  0.7378222942352295
generate_one_block  0.6619806289672852
generate_one_block  0.6720643043518066
generate_one_block  0.6706831455230713
generate_one_block  0.6647639274597168
generate_one_block  0.6628479957580566
generate_one_block  0.6619963645935059
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.20260238647460938  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

connection checking time:  43.27831268310547
block generation total time  37.84414315223694
average batch blocks generation time:  2.3652589470148087
block dataloader generation time/epoch 84.60357451438904
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12580204010009766  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166225, 128])
torch.Size([163823, 32])
torch.Size([155409, 32])
torch.Size([123201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.454509735107422  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12580537796020508  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166240, 128])
torch.Size([163813, 32])
torch.Size([155577, 32])
torch.Size([123289, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.452478885650635  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12581682205200195  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166329, 128])
torch.Size([164042, 32])
torch.Size([155703, 32])
torch.Size([123518, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 19.46637725830078  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12587213516235352  GigaBytes
Max Memory Allocated: 19.51397466659546  GigaBytes

torch.Size([166336, 128])
torch.Size([164015, 32])
torch.Size([155952, 32])
torch.Size([124284, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.514564514160156  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12581872940063477  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166290, 128])
torch.Size([163907, 32])
torch.Size([155642, 32])
torch.Size([123620, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.455187797546387  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.1258254051208496  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166164, 128])
torch.Size([163685, 32])
torch.Size([155551, 32])
torch.Size([123731, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.455004692077637  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12581110000610352  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166261, 128])
torch.Size([163816, 32])
torch.Size([155551, 32])
torch.Size([123239, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.456381797790527  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12581253051757812  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166302, 128])
torch.Size([163985, 32])
torch.Size([155888, 32])
torch.Size([123581, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.450429916381836  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12583208084106445  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166272, 128])
torch.Size([163949, 32])
torch.Size([155797, 32])
torch.Size([123850, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.464269638061523  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.1258373260498047  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166287, 128])
torch.Size([163880, 32])
torch.Size([155543, 32])
torch.Size([123282, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.4647798538208  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12580347061157227  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166218, 128])
torch.Size([163867, 32])
torch.Size([155666, 32])
torch.Size([123287, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.456729888916016  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12583160400390625  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166352, 128])
torch.Size([164104, 32])
torch.Size([155903, 32])
torch.Size([123805, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.48694086074829  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12584209442138672  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166299, 128])
torch.Size([163991, 32])
torch.Size([156009, 32])
torch.Size([124210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.487276077270508  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.12589406967163086  GigaBytes
Max Memory Allocated: 19.52169895172119  GigaBytes

torch.Size([166327, 128])
torch.Size([163987, 32])
torch.Size([156032, 32])
torch.Size([124910, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.519354820251465  GigaBytes
Max Memory Allocated: 19.52650785446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.1258406639099121  GigaBytes
Max Memory Allocated: 19.52650785446167  GigaBytes

torch.Size([166288, 128])
torch.Size([163973, 32])
torch.Size([155701, 32])
torch.Size([123424, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.493616104125977  GigaBytes
Max Memory Allocated: 19.52650785446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 0.1258072853088379  GigaBytes
Max Memory Allocated: 19.52650785446167  GigaBytes

torch.Size([166233, 128])
torch.Size([163925, 32])
torch.Size([155858, 32])
torch.Size([123965, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7928466796875 GB
    Memory Allocated: 19.46662950515747  GigaBytes
Max Memory Allocated: 19.52650785446167  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03868068754673004 |0.0422816127538681 |0.4630768895149231 |9.95248556137085e-05 |0.6234047263860703 |0.009158134460449219 |
----------------------------------------------------------pseudo_mini_loss sum 4.008124828338623
Total (block generation + training)time/epoch 103.34535908699036
Training time/epoch 18.741190433502197
Training time without block to device /epoch 18.064684629440308
Training time without total dataloading part /epoch 17.394456386566162
load block tensor time/epoch 0.6188910007476807
block to device time/epoch 0.6765058040618896
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10414686
Number of first layer input nodes during this epoch:  2660423
