Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648471206.9006772
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.026912927627563477
range selection method range initialization spend 0.012817859649658203
time for parepare:  0.017920494079589844
local_output_nid generation:  0.0026280879974365234
local_in_edges_tensor generation:  0.0047550201416015625
mini_batch_src_global generation:  0.0036649703979492188
r_  generation:  0.04027104377746582
local_output_nid generation:  0.0029578208923339844
local_in_edges_tensor generation:  0.0016856193542480469
mini_batch_src_global generation:  0.004578113555908203
r_  generation:  0.04211163520812988
local_output_nid generation:  0.003130674362182617
local_in_edges_tensor generation:  0.0016846656799316406
mini_batch_src_global generation:  0.0030815601348876953
r_  generation:  0.04346895217895508
local_output_nid generation:  0.00321197509765625
local_in_edges_tensor generation:  0.0016875267028808594
mini_batch_src_global generation:  0.0032558441162109375
r_  generation:  0.04305911064147949
local_output_nid generation:  0.003099203109741211
local_in_edges_tensor generation:  0.0017008781433105469
mini_batch_src_global generation:  0.0033025741577148438
r_  generation:  0.04560208320617676
local_output_nid generation:  0.003134012222290039
local_in_edges_tensor generation:  0.0017080307006835938
mini_batch_src_global generation:  0.003591299057006836
r_  generation:  0.045827627182006836
local_output_nid generation:  0.0031137466430664062
local_in_edges_tensor generation:  0.0017027854919433594
mini_batch_src_global generation:  0.0037374496459960938
r_  generation:  0.04676485061645508
local_output_nid generation:  0.0031540393829345703
local_in_edges_tensor generation:  0.0017178058624267578
mini_batch_src_global generation:  0.0038042068481445312
r_  generation:  0.04678797721862793
----------------------check_connections_block total spend ----------------------------- 0.5158801078796387
generate_one_block  0.06119275093078613
generate_one_block  0.0603184700012207
generate_one_block  0.06151103973388672
generate_one_block  0.06107306480407715
generate_one_block  0.06341862678527832
generate_one_block  0.061722517013549805
generate_one_block  0.06284022331237793
generate_one_block  0.06296205520629883
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04538226127624512
gen group dst list time:  0.016435623168945312
time for parepare:  0.01922130584716797
local_output_nid generation:  0.011580228805541992
local_in_edges_tensor generation:  0.03179788589477539
mini_batch_src_global generation:  0.03784012794494629
r_  generation:  0.3565685749053955
local_output_nid generation:  0.017047882080078125
local_in_edges_tensor generation:  0.031171083450317383
mini_batch_src_global generation:  0.04505777359008789
r_  generation:  0.36257481575012207
local_output_nid generation:  0.017352819442749023
local_in_edges_tensor generation:  0.025513172149658203
mini_batch_src_global generation:  0.04414200782775879
r_  generation:  0.3734607696533203
local_output_nid generation:  0.017836570739746094
local_in_edges_tensor generation:  0.029604434967041016
mini_batch_src_global generation:  0.04755091667175293
r_  generation:  0.37282323837280273
local_output_nid generation:  0.017972707748413086
local_in_edges_tensor generation:  0.01952075958251953
mini_batch_src_global generation:  0.04589724540710449
r_  generation:  0.38206028938293457
local_output_nid generation:  0.018278121948242188
local_in_edges_tensor generation:  0.023229122161865234
mini_batch_src_global generation:  0.04740285873413086
r_  generation:  0.382918119430542
local_output_nid generation:  0.018423080444335938
local_in_edges_tensor generation:  0.027367591857910156
mini_batch_src_global generation:  0.04690408706665039
r_  generation:  0.39241695404052734
local_output_nid generation:  0.018666744232177734
local_in_edges_tensor generation:  0.0307462215423584
mini_batch_src_global generation:  0.04742550849914551
r_  generation:  0.38735055923461914
----------------------check_connections_block total spend ----------------------------- 4.381648063659668
generate_one_block  0.5039169788360596
generate_one_block  0.4875447750091553
generate_one_block  0.4927201271057129
generate_one_block  0.49605250358581543
generate_one_block  0.4961411952972412
generate_one_block  0.5136065483093262
generate_one_block  0.507042407989502
generate_one_block  0.5071532726287842
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03262495994567871
gen group dst list time:  0.0372166633605957
time for parepare:  0.01920914649963379
local_output_nid generation:  0.025804758071899414
local_in_edges_tensor generation:  0.044255733489990234
mini_batch_src_global generation:  0.051609039306640625
r_  generation:  0.5370490550994873
local_output_nid generation:  0.033380985260009766
local_in_edges_tensor generation:  0.057282209396362305
mini_batch_src_global generation:  0.06371235847473145
r_  generation:  0.5494627952575684
local_output_nid generation:  0.03371787071228027
local_in_edges_tensor generation:  0.04201865196228027
mini_batch_src_global generation:  0.06524991989135742
r_  generation:  0.5489187240600586
local_output_nid generation:  0.034089088439941406
local_in_edges_tensor generation:  0.048586130142211914
mini_batch_src_global generation:  0.05991244316101074
r_  generation:  0.5655333995819092
local_output_nid generation:  0.03441190719604492
local_in_edges_tensor generation:  0.03719663619995117
mini_batch_src_global generation:  0.06218433380126953
r_  generation:  0.5632979869842529
local_output_nid generation:  0.03496813774108887
local_in_edges_tensor generation:  0.04314732551574707
mini_batch_src_global generation:  0.06291818618774414
r_  generation:  0.5715198516845703
local_output_nid generation:  0.034857988357543945
local_in_edges_tensor generation:  0.05835700035095215
mini_batch_src_global generation:  0.06275773048400879
r_  generation:  0.5742897987365723
local_output_nid generation:  0.034822940826416016
local_in_edges_tensor generation:  0.0430300235748291
mini_batch_src_global generation:  0.06328225135803223
r_  generation:  0.5709946155548096
----------------------check_connections_block total spend ----------------------------- 6.6118669509887695
generate_one_block  0.7107434272766113
generate_one_block  0.7113990783691406
generate_one_block  0.7138416767120361
generate_one_block  0.7218344211578369
generate_one_block  0.7003881931304932
generate_one_block  0.7363533973693848
generate_one_block  0.7494287490844727
generate_one_block  0.7206411361694336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008554458618164062  GigaBytes
Max Memory Allocated: 0.0008554458618164062  GigaBytes

connection checking time:  10.993515014648438
block generation total time  9.768807888031006
average batch blocks generation time:  1.2211009860038757
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10231494903564453  GigaBytes
Max Memory Allocated: 0.10231494903564453  GigaBytes

torch.Size([162481, 128])
torch.Size([146078, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9530029296875 GB
    Memory Allocated: 18.414884090423584  GigaBytes
Max Memory Allocated: 18.44627332687378  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5506591796875 GB
    Memory Allocated: 0.10532951354980469  GigaBytes
Max Memory Allocated: 18.44627332687378  GigaBytes

torch.Size([162569, 128])
torch.Size([145922, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5506591796875 GB
    Memory Allocated: 18.35015058517456  GigaBytes
Max Memory Allocated: 18.44627332687378  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5506591796875 GB
    Memory Allocated: 0.10595846176147461  GigaBytes
Max Memory Allocated: 18.44627332687378  GigaBytes

torch.Size([162563, 128])
torch.Size([145871, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5506591796875 GB
    Memory Allocated: 18.4196457862854  GigaBytes
Max Memory Allocated: 18.452813148498535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8397216796875 GB
    Memory Allocated: 0.10530328750610352  GigaBytes
Max Memory Allocated: 18.452813148498535  GigaBytes

torch.Size([162500, 128])
torch.Size([145823, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8416748046875 GB
    Memory Allocated: 18.44108295440674  GigaBytes
Max Memory Allocated: 18.47374153137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8416748046875 GB
    Memory Allocated: 0.10595464706420898  GigaBytes
Max Memory Allocated: 18.47374153137207  GigaBytes

torch.Size([162598, 128])
torch.Size([145737, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8416748046875 GB
    Memory Allocated: 18.423030376434326  GigaBytes
Max Memory Allocated: 18.47374153137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8416748046875 GB
    Memory Allocated: 0.10487222671508789  GigaBytes
Max Memory Allocated: 18.47374153137207  GigaBytes

torch.Size([162669, 128])
torch.Size([145985, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8416748046875 GB
    Memory Allocated: 18.482228755950928  GigaBytes
Max Memory Allocated: 18.515352725982666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1346435546875 GB
    Memory Allocated: 0.10597562789916992  GigaBytes
Max Memory Allocated: 18.515352725982666  GigaBytes

torch.Size([162644, 128])
torch.Size([146139, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1424560546875 GB
    Memory Allocated: 18.548120975494385  GigaBytes
Max Memory Allocated: 18.581831455230713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4393310546875 GB
    Memory Allocated: 0.10544443130493164  GigaBytes
Max Memory Allocated: 18.581831455230713  GigaBytes

torch.Size([162720, 128])
torch.Size([146148, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4393310546875 GB
    Memory Allocated: 18.56398057937622  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04127129912376404 |0.06896862387657166 |0.8140246272087097 |0.00012442469596862793 |1.1431201994419098 |0.016136646270751953 |
----------------------------------------------------------pseudo_mini_loss sum 4.952795028686523
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3057585
Number of first layer input nodes during this epoch:  1300744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 0.1434617042541504  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.029860496520996094
range selection method range initialization spend 0.015622377395629883
time for parepare:  0.017098426818847656
local_output_nid generation:  0.003293752670288086
local_in_edges_tensor generation:  0.004990100860595703
mini_batch_src_global generation:  0.0045337677001953125
r_  generation:  0.04369950294494629
local_output_nid generation:  0.0034940242767333984
local_in_edges_tensor generation:  0.0017561912536621094
mini_batch_src_global generation:  0.004673004150390625
r_  generation:  0.044272422790527344
local_output_nid generation:  0.0035295486450195312
local_in_edges_tensor generation:  0.0017447471618652344
mini_batch_src_global generation:  0.003216981887817383
r_  generation:  0.04568743705749512
local_output_nid generation:  0.0036230087280273438
local_in_edges_tensor generation:  0.001920938491821289
mini_batch_src_global generation:  0.0034720897674560547
r_  generation:  0.047713518142700195
local_output_nid generation:  0.003561258316040039
local_in_edges_tensor generation:  0.001753091812133789
mini_batch_src_global generation:  0.003595113754272461
r_  generation:  0.0474238395690918
local_output_nid generation:  0.0035970211029052734
local_in_edges_tensor generation:  0.0018057823181152344
mini_batch_src_global generation:  0.0037865638732910156
r_  generation:  0.04871010780334473
local_output_nid generation:  0.003518342971801758
local_in_edges_tensor generation:  0.0017304420471191406
mini_batch_src_global generation:  0.0036773681640625
r_  generation:  0.048621177673339844
local_output_nid generation:  0.0035631656646728516
local_in_edges_tensor generation:  0.0018198490142822266
mini_batch_src_global generation:  0.0037975311279296875
r_  generation:  0.04839634895324707
----------------------check_connections_block total spend ----------------------------- 0.5525808334350586
generate_one_block  0.08162117004394531
generate_one_block  0.07584428787231445
generate_one_block  0.0770413875579834
generate_one_block  0.07946610450744629
generate_one_block  0.07658100128173828
generate_one_block  0.07783722877502441
generate_one_block  0.07903027534484863
generate_one_block  0.07786059379577637
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.043398141860961914
gen group dst list time:  0.0259859561920166
time for parepare:  0.03288388252258301
local_output_nid generation:  0.015731334686279297
local_in_edges_tensor generation:  0.032828330993652344
mini_batch_src_global generation:  0.03824663162231445
r_  generation:  0.37996840476989746
local_output_nid generation:  0.024875402450561523
local_in_edges_tensor generation:  0.03679251670837402
mini_batch_src_global generation:  0.0467069149017334
r_  generation:  0.40280795097351074
local_output_nid generation:  0.024955034255981445
local_in_edges_tensor generation:  0.03290557861328125
mini_batch_src_global generation:  0.04816603660583496
r_  generation:  0.3850884437561035
local_output_nid generation:  0.025111675262451172
local_in_edges_tensor generation:  0.023882389068603516
mini_batch_src_global generation:  0.045734405517578125
r_  generation:  0.39706945419311523
local_output_nid generation:  0.02536296844482422
local_in_edges_tensor generation:  0.03400850296020508
mini_batch_src_global generation:  0.04625678062438965
r_  generation:  0.39740610122680664
local_output_nid generation:  0.02654886245727539
local_in_edges_tensor generation:  0.03792834281921387
mini_batch_src_global generation:  0.06022524833679199
r_  generation:  0.3884906768798828
local_output_nid generation:  0.02534198760986328
local_in_edges_tensor generation:  0.029287338256835938
mini_batch_src_global generation:  0.04650282859802246
r_  generation:  0.3842434883117676
local_output_nid generation:  0.022923707962036133
local_in_edges_tensor generation:  0.019818782806396484
mini_batch_src_global generation:  0.046743154525756836
r_  generation:  0.40082454681396484
----------------------check_connections_block total spend ----------------------------- 4.6480629444122314
generate_one_block  0.5738437175750732
generate_one_block  0.5372202396392822
generate_one_block  0.541212797164917
generate_one_block  0.5464227199554443
generate_one_block  0.532520055770874
generate_one_block  0.5617325305938721
generate_one_block  0.5320568084716797
generate_one_block  0.5630757808685303
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052199602127075195
gen group dst list time:  0.0400390625
time for parepare:  0.019500017166137695
local_output_nid generation:  0.030513763427734375
local_in_edges_tensor generation:  0.06144285202026367
mini_batch_src_global generation:  0.05280494689941406
r_  generation:  0.5416584014892578
local_output_nid generation:  0.03775620460510254
local_in_edges_tensor generation:  0.0536808967590332
mini_batch_src_global generation:  0.06419110298156738
r_  generation:  0.5528542995452881
local_output_nid generation:  0.04083871841430664
local_in_edges_tensor generation:  0.044817209243774414
mini_batch_src_global generation:  0.0606226921081543
r_  generation:  0.5599355697631836
local_output_nid generation:  0.05073356628417969
local_in_edges_tensor generation:  0.03542184829711914
mini_batch_src_global generation:  0.06079554557800293
r_  generation:  0.5590460300445557
local_output_nid generation:  0.042961835861206055
local_in_edges_tensor generation:  0.03908586502075195
mini_batch_src_global generation:  0.06220555305480957
r_  generation:  0.5718643665313721
local_output_nid generation:  0.040166616439819336
local_in_edges_tensor generation:  0.046031951904296875
mini_batch_src_global generation:  0.06228899955749512
r_  generation:  0.5738093852996826
local_output_nid generation:  0.04066944122314453
local_in_edges_tensor generation:  0.03564023971557617
mini_batch_src_global generation:  0.061992645263671875
r_  generation:  0.5748753547668457
local_output_nid generation:  0.04079389572143555
local_in_edges_tensor generation:  0.039939165115356445
mini_batch_src_global generation:  0.06740117073059082
r_  generation:  0.5731115341186523
----------------------check_connections_block total spend ----------------------------- 6.6794633865356445
generate_one_block  0.7468428611755371
generate_one_block  0.7575464248657227
generate_one_block  0.7657365798950195
generate_one_block  0.7606186866760254
generate_one_block  0.7417910099029541
generate_one_block  0.7672979831695557
generate_one_block  0.748999834060669
generate_one_block  0.7484340667724609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 0.1434617042541504  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

connection checking time:  11.327526330947876
block generation total time  10.425352096557617
average batch blocks generation time:  1.3031690120697021
block dataloader generation time/epoch 24.489542961120605
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 0.1076812744140625  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162835, 128])
torch.Size([146195, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 18.552037239074707  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 0.10760688781738281  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162487, 128])
torch.Size([145863, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 18.461997985839844  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 0.10766172409057617  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162706, 128])
torch.Size([146348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 18.519570350646973  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7381591796875 GB
    Memory Allocated: 0.10712575912475586  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162686, 128])
torch.Size([146017, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 18.475041389465332  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 0.10765314102172852  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162329, 128])
torch.Size([145567, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 18.423248767852783  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 0.10706710815429688  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162585, 128])
torch.Size([145999, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 18.470008373260498  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 0.10706853866577148  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162435, 128])
torch.Size([145431, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 18.401936531066895  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 0.10702085494995117  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

torch.Size([162500, 128])
torch.Size([145860, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7615966796875 GB
    Memory Allocated: 18.470338344573975  GigaBytes
Max Memory Allocated: 18.597793579101562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044689834117889404 |0.03025507926940918 |0.6813952028751373 |0.00011834502220153809 |1.1089391708374023 |0.006829500198364258 |
----------------------------------------------------------pseudo_mini_loss sum 3.799370050430298
Total (block generation + training)time/epoch 39.44247794151306
Training time/epoch 14.952669858932495
Training time without block to device /epoch 14.710629224777222
Training time without total dataloading part /epoch 14.330451250076294
load block tensor time/epoch 0.35751867294311523
block to device time/epoch 0.24204063415527344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3057374
Number of first layer input nodes during this epoch:  1300563
