Using backend: pytorch
WARNING:root:The OGB package is out of date. Your version is 1.3.2, while the latest version is 1.3.3.
main start at this time 1648475274.5908408
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024067163467407227
range selection method range initialization spend 0.013544797897338867
time for parepare:  0.018381595611572266
local_output_nid generation:  0.0006954669952392578
local_in_edges_tensor generation:  0.0034279823303222656
mini_batch_src_global generation:  0.0013327598571777344
r_  generation:  0.008912324905395508
local_output_nid generation:  0.0007648468017578125
local_in_edges_tensor generation:  0.0005588531494140625
mini_batch_src_global generation:  0.0013077259063720703
r_  generation:  0.008050918579101562
local_output_nid generation:  0.0007097721099853516
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0008101463317871094
r_  generation:  0.007824182510375977
local_output_nid generation:  0.0007576942443847656
local_in_edges_tensor generation:  0.0004718303680419922
mini_batch_src_global generation:  0.0007269382476806641
r_  generation:  0.007399559020996094
local_output_nid generation:  0.0007171630859375
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.007866859436035156
local_output_nid generation:  0.0007457733154296875
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.0007467269897460938
r_  generation:  0.007701396942138672
local_output_nid generation:  0.0007052421569824219
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0009069442749023438
r_  generation:  0.007959127426147461
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.0007526874542236328
r_  generation:  0.008129119873046875
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0007698535919189453
r_  generation:  0.007970809936523438
local_output_nid generation:  0.0007166862487792969
local_in_edges_tensor generation:  0.0004534721374511719
mini_batch_src_global generation:  0.0007736682891845703
r_  generation:  0.0080718994140625
local_output_nid generation:  0.0007243156433105469
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0009074211120605469
r_  generation:  0.008263349533081055
local_output_nid generation:  0.0007271766662597656
local_in_edges_tensor generation:  0.00046372413635253906
mini_batch_src_global generation:  0.0008380413055419922
r_  generation:  0.008071660995483398
local_output_nid generation:  0.0007450580596923828
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0008165836334228516
r_  generation:  0.008342981338500977
local_output_nid generation:  0.0007157325744628906
local_in_edges_tensor generation:  0.00046133995056152344
mini_batch_src_global generation:  0.0008449554443359375
r_  generation:  0.00926828384399414
local_output_nid generation:  0.0007166862487792969
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0008680820465087891
r_  generation:  0.008421897888183594
local_output_nid generation:  0.0007159709930419922
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0008234977722167969
r_  generation:  0.007931232452392578
local_output_nid generation:  0.0007364749908447266
local_in_edges_tensor generation:  0.00046944618225097656
mini_batch_src_global generation:  0.0008192062377929688
r_  generation:  0.007974624633789062
local_output_nid generation:  0.0007052421569824219
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.0008187294006347656
r_  generation:  0.008322954177856445
local_output_nid generation:  0.0007114410400390625
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.0008103847503662109
r_  generation:  0.008078336715698242
local_output_nid generation:  0.0007154941558837891
local_in_edges_tensor generation:  0.00045418739318847656
mini_batch_src_global generation:  0.0008180141448974609
r_  generation:  0.008041858673095703
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.00045680999755859375
mini_batch_src_global generation:  0.000812530517578125
r_  generation:  0.00826120376586914
local_output_nid generation:  0.0007207393646240234
local_in_edges_tensor generation:  0.00047588348388671875
mini_batch_src_global generation:  0.0008709430694580078
r_  generation:  0.008352518081665039
local_output_nid generation:  0.0007140636444091797
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0008072853088378906
r_  generation:  0.008039236068725586
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0007929801940917969
r_  generation:  0.00786900520324707
local_output_nid generation:  0.0007157325744628906
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.0009458065032958984
r_  generation:  0.00822758674621582
local_output_nid generation:  0.0007114410400390625
local_in_edges_tensor generation:  0.0004563331604003906
mini_batch_src_global generation:  0.0008134841918945312
r_  generation:  0.008156299591064453
local_output_nid generation:  0.0007147789001464844
local_in_edges_tensor generation:  0.00046133995056152344
mini_batch_src_global generation:  0.0008594989776611328
r_  generation:  0.008061647415161133
local_output_nid generation:  0.0007455348968505859
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.0008194446563720703
r_  generation:  0.008202791213989258
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0008189678192138672
r_  generation:  0.008314847946166992
local_output_nid generation:  0.0007140636444091797
local_in_edges_tensor generation:  0.003965139389038086
mini_batch_src_global generation:  0.0010569095611572266
r_  generation:  0.00789785385131836
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0005068778991699219
mini_batch_src_global generation:  0.0009062290191650391
r_  generation:  0.008120059967041016
local_output_nid generation:  0.0007627010345458984
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0009303092956542969
r_  generation:  0.008369684219360352
----------------------check_connections_block total spend ----------------------------- 0.4157450199127197
generate_one_block  0.014079093933105469
generate_one_block  0.013422966003417969
generate_one_block  0.01311492919921875
generate_one_block  0.012544870376586914
generate_one_block  0.01293635368347168
generate_one_block  0.01289820671081543
generate_one_block  0.013023138046264648
generate_one_block  0.01324772834777832
generate_one_block  0.012999773025512695
generate_one_block  0.013417243957519531
generate_one_block  0.01314854621887207
generate_one_block  0.013365507125854492
generate_one_block  0.013315439224243164
generate_one_block  0.013582706451416016
generate_one_block  0.013517141342163086
generate_one_block  0.013034582138061523
generate_one_block  0.01282191276550293
generate_one_block  0.013360023498535156
generate_one_block  0.012992143630981445
generate_one_block  0.013051271438598633
generate_one_block  0.013299703598022461
generate_one_block  0.013297796249389648
generate_one_block  0.012830257415771484
generate_one_block  0.012729644775390625
generate_one_block  0.013149261474609375
generate_one_block  0.013175010681152344
generate_one_block  0.01306462287902832
generate_one_block  0.013122797012329102
generate_one_block  0.01312565803527832
generate_one_block  0.012896060943603516
generate_one_block  0.01302027702331543
generate_one_block  0.013329267501831055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04162430763244629
gen group dst list time:  0.020960330963134766
time for parepare:  0.018802642822265625
local_output_nid generation:  0.0038192272186279297
local_in_edges_tensor generation:  0.012112140655517578
mini_batch_src_global generation:  0.011476516723632812
r_  generation:  0.11765503883361816
local_output_nid generation:  0.00634455680847168
local_in_edges_tensor generation:  0.006804227828979492
mini_batch_src_global generation:  0.014424324035644531
r_  generation:  0.12091660499572754
local_output_nid generation:  0.006371259689331055
local_in_edges_tensor generation:  0.009073019027709961
mini_batch_src_global generation:  0.013007164001464844
r_  generation:  0.12461042404174805
local_output_nid generation:  0.006113767623901367
local_in_edges_tensor generation:  0.007758140563964844
mini_batch_src_global generation:  0.013184309005737305
r_  generation:  0.12067580223083496
local_output_nid generation:  0.006414651870727539
local_in_edges_tensor generation:  0.009306669235229492
mini_batch_src_global generation:  0.01437234878540039
r_  generation:  0.12996530532836914
local_output_nid generation:  0.006406545639038086
local_in_edges_tensor generation:  0.008308649063110352
mini_batch_src_global generation:  0.015294790267944336
r_  generation:  0.12876343727111816
local_output_nid generation:  0.006425619125366211
local_in_edges_tensor generation:  0.007266998291015625
mini_batch_src_global generation:  0.015376567840576172
r_  generation:  0.13066458702087402
local_output_nid generation:  0.0067555904388427734
local_in_edges_tensor generation:  0.0075778961181640625
mini_batch_src_global generation:  0.01564335823059082
r_  generation:  0.13149142265319824
local_output_nid generation:  0.006577491760253906
local_in_edges_tensor generation:  0.0078008174896240234
mini_batch_src_global generation:  0.01565408706665039
r_  generation:  0.13088321685791016
local_output_nid generation:  0.006788015365600586
local_in_edges_tensor generation:  0.008884191513061523
mini_batch_src_global generation:  0.019026994705200195
r_  generation:  0.13406920433044434
local_output_nid generation:  0.006807088851928711
local_in_edges_tensor generation:  0.010021209716796875
mini_batch_src_global generation:  0.01687932014465332
r_  generation:  0.1353609561920166
local_output_nid generation:  0.00693058967590332
local_in_edges_tensor generation:  0.009104490280151367
mini_batch_src_global generation:  0.016303539276123047
r_  generation:  0.13796472549438477
local_output_nid generation:  0.006845951080322266
local_in_edges_tensor generation:  0.010051250457763672
mini_batch_src_global generation:  0.016144514083862305
r_  generation:  0.13664484024047852
local_output_nid generation:  0.006987094879150391
local_in_edges_tensor generation:  0.010068178176879883
mini_batch_src_global generation:  0.017714977264404297
r_  generation:  0.13802599906921387
local_output_nid generation:  0.006998538970947266
local_in_edges_tensor generation:  0.008081197738647461
mini_batch_src_global generation:  0.01707744598388672
r_  generation:  0.1386263370513916
local_output_nid generation:  0.006729841232299805
local_in_edges_tensor generation:  0.007881641387939453
mini_batch_src_global generation:  0.01621222496032715
r_  generation:  0.13325166702270508
local_output_nid generation:  0.006784915924072266
local_in_edges_tensor generation:  0.007723569869995117
mini_batch_src_global generation:  0.015426397323608398
r_  generation:  0.12912821769714355
local_output_nid generation:  0.0069959163665771484
local_in_edges_tensor generation:  0.008444547653198242
mini_batch_src_global generation:  0.01773214340209961
r_  generation:  0.1363074779510498
local_output_nid generation:  0.006917476654052734
local_in_edges_tensor generation:  0.009891510009765625
mini_batch_src_global generation:  0.015942811965942383
r_  generation:  0.13343572616577148
local_output_nid generation:  0.0068285465240478516
local_in_edges_tensor generation:  0.0077667236328125
mini_batch_src_global generation:  0.01602458953857422
r_  generation:  0.1298084259033203
local_output_nid generation:  0.0068128108978271484
local_in_edges_tensor generation:  0.009459495544433594
mini_batch_src_global generation:  0.01589512825012207
r_  generation:  0.13717055320739746
local_output_nid generation:  0.007030010223388672
local_in_edges_tensor generation:  0.010654211044311523
mini_batch_src_global generation:  0.017091035842895508
r_  generation:  0.1387031078338623
local_output_nid generation:  0.006754636764526367
local_in_edges_tensor generation:  0.0077550411224365234
mini_batch_src_global generation:  0.01569223403930664
r_  generation:  0.13051128387451172
local_output_nid generation:  0.006667613983154297
local_in_edges_tensor generation:  0.007503032684326172
mini_batch_src_global generation:  0.015262603759765625
r_  generation:  0.12705135345458984
local_output_nid generation:  0.006911277770996094
local_in_edges_tensor generation:  0.008100032806396484
mini_batch_src_global generation:  0.0158536434173584
r_  generation:  0.14199566841125488
local_output_nid generation:  0.006953239440917969
local_in_edges_tensor generation:  0.007842540740966797
mini_batch_src_global generation:  0.016317367553710938
r_  generation:  0.131561279296875
local_output_nid generation:  0.006880521774291992
local_in_edges_tensor generation:  0.00850057601928711
mini_batch_src_global generation:  0.0155181884765625
r_  generation:  0.13233113288879395
local_output_nid generation:  0.006986856460571289
local_in_edges_tensor generation:  0.008878946304321289
mini_batch_src_global generation:  0.017185449600219727
r_  generation:  0.1343691349029541
local_output_nid generation:  0.0069086551666259766
local_in_edges_tensor generation:  0.008822441101074219
mini_batch_src_global generation:  0.015707015991210938
r_  generation:  0.1345081329345703
local_output_nid generation:  0.006837606430053711
local_in_edges_tensor generation:  0.0078084468841552734
mini_batch_src_global generation:  0.015494346618652344
r_  generation:  0.13231229782104492
local_output_nid generation:  0.0068454742431640625
local_in_edges_tensor generation:  0.008947610855102539
mini_batch_src_global generation:  0.01635265350341797
r_  generation:  0.1307072639465332
local_output_nid generation:  0.007015705108642578
local_in_edges_tensor generation:  0.010245800018310547
mini_batch_src_global generation:  0.016579389572143555
r_  generation:  0.13599038124084473
----------------------check_connections_block total spend ----------------------------- 6.242630958557129
generate_one_block  0.1692206859588623
generate_one_block  0.16180920600891113
generate_one_block  0.18108105659484863
generate_one_block  0.1526777744293213
generate_one_block  0.16440773010253906
generate_one_block  0.16311860084533691
generate_one_block  0.16205811500549316
generate_one_block  0.16786766052246094
generate_one_block  0.16647124290466309
generate_one_block  0.16419649124145508
generate_one_block  0.16733098030090332
generate_one_block  0.16954779624938965
generate_one_block  0.1673741340637207
generate_one_block  0.17166709899902344
generate_one_block  0.17282414436340332
generate_one_block  0.18252015113830566
generate_one_block  0.158005952835083
generate_one_block  0.17343759536743164
generate_one_block  0.16445493698120117
generate_one_block  0.16129255294799805
generate_one_block  0.1704099178314209
generate_one_block  0.1739041805267334
generate_one_block  0.15858769416809082
generate_one_block  0.15740346908569336
generate_one_block  0.16744422912597656
generate_one_block  0.1646578311920166
generate_one_block  0.16104793548583984
generate_one_block  0.1693735122680664
generate_one_block  0.16623950004577637
generate_one_block  0.15828800201416016
generate_one_block  0.16050028800964355
generate_one_block  0.17316627502441406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03615546226501465
gen group dst list time:  0.09433460235595703
time for parepare:  0.01862812042236328
local_output_nid generation:  0.01958465576171875
local_in_edges_tensor generation:  0.03346562385559082
mini_batch_src_global generation:  0.039222002029418945
r_  generation:  0.378558874130249
local_output_nid generation:  0.025630950927734375
local_in_edges_tensor generation:  0.03885078430175781
mini_batch_src_global generation:  0.04550790786743164
r_  generation:  0.39017677307128906
local_output_nid generation:  0.02630305290222168
local_in_edges_tensor generation:  0.03274178504943848
mini_batch_src_global generation:  0.04537630081176758
r_  generation:  0.39407825469970703
local_output_nid generation:  0.024203062057495117
local_in_edges_tensor generation:  0.029108047485351562
mini_batch_src_global generation:  0.04622769355773926
r_  generation:  0.38883543014526367
local_output_nid generation:  0.02459883689880371
local_in_edges_tensor generation:  0.03242158889770508
mini_batch_src_global generation:  0.05220842361450195
r_  generation:  0.4003763198852539
local_output_nid generation:  0.02513861656188965
local_in_edges_tensor generation:  0.03319597244262695
mini_batch_src_global generation:  0.05088496208190918
r_  generation:  0.4024772644042969
local_output_nid generation:  0.02565908432006836
local_in_edges_tensor generation:  0.03870511054992676
mini_batch_src_global generation:  0.055135488510131836
r_  generation:  0.41022634506225586
local_output_nid generation:  0.027933835983276367
local_in_edges_tensor generation:  0.03394031524658203
mini_batch_src_global generation:  0.04769587516784668
r_  generation:  0.40004944801330566
local_output_nid generation:  0.025798797607421875
local_in_edges_tensor generation:  0.031171798706054688
mini_batch_src_global generation:  0.04636955261230469
r_  generation:  0.39820337295532227
local_output_nid generation:  0.025603055953979492
local_in_edges_tensor generation:  0.02701282501220703
mini_batch_src_global generation:  0.04763913154602051
r_  generation:  0.39525580406188965
local_output_nid generation:  0.02563786506652832
local_in_edges_tensor generation:  0.028792142868041992
mini_batch_src_global generation:  0.05064225196838379
r_  generation:  0.4038264751434326
local_output_nid generation:  0.026038169860839844
local_in_edges_tensor generation:  0.032299041748046875
mini_batch_src_global generation:  0.047322750091552734
r_  generation:  0.4008660316467285
local_output_nid generation:  0.025890350341796875
local_in_edges_tensor generation:  0.02416682243347168
mini_batch_src_global generation:  0.04756927490234375
r_  generation:  0.4002513885498047
local_output_nid generation:  0.02598857879638672
local_in_edges_tensor generation:  0.031713247299194336
mini_batch_src_global generation:  0.050287723541259766
r_  generation:  0.4013979434967041
local_output_nid generation:  0.02630019187927246
local_in_edges_tensor generation:  0.028007030487060547
mini_batch_src_global generation:  0.04731297492980957
r_  generation:  0.4064006805419922
local_output_nid generation:  0.025777101516723633
local_in_edges_tensor generation:  0.024166584014892578
mini_batch_src_global generation:  0.048105478286743164
r_  generation:  0.3964691162109375
local_output_nid generation:  0.025815248489379883
local_in_edges_tensor generation:  0.0244443416595459
mini_batch_src_global generation:  0.04662489891052246
r_  generation:  0.3974626064300537
local_output_nid generation:  0.02586531639099121
local_in_edges_tensor generation:  0.03145241737365723
mini_batch_src_global generation:  0.05044388771057129
r_  generation:  0.39963555335998535
local_output_nid generation:  0.025793790817260742
local_in_edges_tensor generation:  0.030807971954345703
mini_batch_src_global generation:  0.046097517013549805
r_  generation:  0.4037609100341797
local_output_nid generation:  0.02599930763244629
local_in_edges_tensor generation:  0.02614903450012207
mini_batch_src_global generation:  0.04817843437194824
r_  generation:  0.3912012577056885
local_output_nid generation:  0.025882959365844727
local_in_edges_tensor generation:  0.024027585983276367
mini_batch_src_global generation:  0.04648900032043457
r_  generation:  0.4035530090332031
local_output_nid generation:  0.027427196502685547
local_in_edges_tensor generation:  0.03828787803649902
mini_batch_src_global generation:  0.05894660949707031
r_  generation:  0.4100613594055176
local_output_nid generation:  0.027666330337524414
local_in_edges_tensor generation:  0.029852628707885742
mini_batch_src_global generation:  0.049103498458862305
r_  generation:  0.39293766021728516
local_output_nid generation:  0.02579641342163086
local_in_edges_tensor generation:  0.027567148208618164
mini_batch_src_global generation:  0.04727816581726074
r_  generation:  0.39279699325561523
local_output_nid generation:  0.026306867599487305
local_in_edges_tensor generation:  0.03403520584106445
mini_batch_src_global generation:  0.04649639129638672
r_  generation:  0.4052083492279053
local_output_nid generation:  0.025875329971313477
local_in_edges_tensor generation:  0.031357765197753906
mini_batch_src_global generation:  0.047309160232543945
r_  generation:  0.3938772678375244
local_output_nid generation:  0.026219606399536133
local_in_edges_tensor generation:  0.030907154083251953
mini_batch_src_global generation:  0.04926705360412598
r_  generation:  0.40220141410827637
local_output_nid generation:  0.026042461395263672
local_in_edges_tensor generation:  0.031123876571655273
mini_batch_src_global generation:  0.047460079193115234
r_  generation:  0.4171433448791504
local_output_nid generation:  0.026247024536132812
local_in_edges_tensor generation:  0.031222820281982422
mini_batch_src_global generation:  0.04601860046386719
r_  generation:  0.40521693229675293
local_output_nid generation:  0.026141881942749023
local_in_edges_tensor generation:  0.02427220344543457
mini_batch_src_global generation:  0.04721689224243164
r_  generation:  0.3937082290649414
local_output_nid generation:  0.026128530502319336
local_in_edges_tensor generation:  0.025374412536621094
mini_batch_src_global generation:  0.04604315757751465
r_  generation:  0.4003474712371826
local_output_nid generation:  0.02631974220275879
local_in_edges_tensor generation:  0.027400732040405273
mini_batch_src_global generation:  0.05064988136291504
r_  generation:  0.40500831604003906
----------------------check_connections_block total spend ----------------------------- 18.957154035568237
generate_one_block  0.6189277172088623
generate_one_block  0.517014741897583
generate_one_block  0.5182745456695557
generate_one_block  0.5026047229766846
generate_one_block  0.520193338394165
generate_one_block  0.5343389511108398
generate_one_block  0.5276858806610107
generate_one_block  0.5309431552886963
generate_one_block  0.5094757080078125
generate_one_block  0.511876106262207
generate_one_block  0.5393152236938477
generate_one_block  0.5399413108825684
generate_one_block  0.49947190284729004
generate_one_block  0.5167174339294434
generate_one_block  0.5185222625732422
generate_one_block  0.504082441329956
generate_one_block  0.5026910305023193
generate_one_block  0.5201883316040039
generate_one_block  0.502021074295044
generate_one_block  0.5009002685546875
generate_one_block  0.520463228225708
generate_one_block  0.5307316780090332
generate_one_block  0.49604153633117676
generate_one_block  0.497255802154541
generate_one_block  0.5084068775177002
generate_one_block  0.5145232677459717
generate_one_block  0.5160965919494629
generate_one_block  0.5219426155090332
generate_one_block  0.5150659084320068
generate_one_block  0.4971768856048584
generate_one_block  0.5012390613555908
generate_one_block  0.5234208106994629
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0213623046875 GB
    Memory Allocated: 0.005230903625488281  GigaBytes
Max Memory Allocated: 0.005230903625488281  GigaBytes

connection checking time:  25.199784994125366
block generation total time  21.89993715286255
average batch blocks generation time:  0.6843730360269547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.08689451217651367  GigaBytes
Max Memory Allocated: 0.08689451217651367  GigaBytes

torch.Size([145142, 128])
torch.Size([99212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6463623046875 GB
    Memory Allocated: 15.873430728912354  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.3963623046875 GB
    Memory Allocated: 0.09258651733398438  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([145568, 128])
torch.Size([99021, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4334716796875 GB
    Memory Allocated: 15.639167308807373  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 0.09351062774658203  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([145792, 128])
torch.Size([99590, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 15.603511810302734  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 0.09208011627197266  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([145122, 128])
torch.Size([97120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 15.183290958404541  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 0.09355545043945312  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([145837, 128])
torch.Size([99352, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 15.75170373916626  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4354248046875 GB
    Memory Allocated: 0.09284019470214844  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([146040, 128])
torch.Size([99576, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4862060546875 GB
    Memory Allocated: 15.640822887420654  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4881591796875 GB
    Memory Allocated: 0.09240293502807617  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([145259, 128])
torch.Size([98590, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4881591796875 GB
    Memory Allocated: 15.58332633972168  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4881591796875 GB
    Memory Allocated: 0.09401655197143555  GigaBytes
Max Memory Allocated: 15.904012203216553  GigaBytes

torch.Size([146303, 128])
torch.Size([100422, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0897216796875 GB
    Memory Allocated: 15.87558364868164  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0897216796875 GB
    Memory Allocated: 0.09244346618652344  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

torch.Size([145158, 128])
torch.Size([99068, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0897216796875 GB
    Memory Allocated: 15.691355228424072  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0897216796875 GB
    Memory Allocated: 0.09262275695800781  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

torch.Size([145606, 128])
torch.Size([99096, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1170654296875 GB
    Memory Allocated: 15.666540145874023  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1190185546875 GB
    Memory Allocated: 0.0935068130493164  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

torch.Size([145238, 128])
torch.Size([99392, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1190185546875 GB
    Memory Allocated: 15.804685115814209  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1190185546875 GB
    Memory Allocated: 0.09373283386230469  GigaBytes
Max Memory Allocated: 15.906943798065186  GigaBytes

torch.Size([145645, 128])
torch.Size([100569, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 16.02452564239502  GigaBytes
Max Memory Allocated: 16.055756092071533  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09250068664550781  GigaBytes
Max Memory Allocated: 16.055756092071533  GigaBytes

torch.Size([145178, 128])
torch.Size([98967, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.783208847045898  GigaBytes
Max Memory Allocated: 16.055756092071533  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09402084350585938  GigaBytes
Max Memory Allocated: 16.055756092071533  GigaBytes

torch.Size([146189, 128])
torch.Size([100521, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 16.14758825302124  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09460783004760742  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145737, 128])
torch.Size([99989, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 16.026477336883545  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09262895584106445  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145529, 128])
torch.Size([98883, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.72514533996582  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09337234497070312  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145771, 128])
torch.Size([99038, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.447941303253174  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09375476837158203  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145686, 128])
torch.Size([100318, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.99746036529541  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.0925145149230957  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145329, 128])
torch.Size([98850, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.68648099899292  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09255218505859375  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145600, 128])
torch.Size([98678, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.533247470855713  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09241437911987305  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145061, 128])
torch.Size([99085, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.724652290344238  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09370613098144531  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145583, 128])
torch.Size([100565, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 16.065454959869385  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09209632873535156  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([144880, 128])
torch.Size([97428, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.373388290405273  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09214544296264648  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145003, 128])
torch.Size([98031, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.366035461425781  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.0924983024597168  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145349, 128])
torch.Size([98778, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.653249263763428  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09227561950683594  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([144940, 128])
torch.Size([98174, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.571035861968994  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.0934743881225586  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145715, 128])
torch.Size([98982, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.596428394317627  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09375  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145766, 128])
torch.Size([99897, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.823668479919434  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09351253509521484  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145693, 128])
torch.Size([99479, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.614809513092041  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09220314025878906  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145074, 128])
torch.Size([98134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.41510009765625  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.09240436553955078  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145288, 128])
torch.Size([98496, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.525570392608643  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.0936594009399414  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145522, 128])
torch.Size([99838, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.923193454742432  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03107142448425293 |0.024604670703411102 |0.28783391416072845 |0.00010024011135101318 |0.5028842464089394 |0.007559061050415039 |
----------------------------------------------------------pseudo_mini_loss sum 5.382601737976074
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8580428
Number of first layer input nodes during this epoch:  4655603
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.12182903289794922  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.024896860122680664
range selection method range initialization spend 0.012602806091308594
time for parepare:  0.017615795135498047
local_output_nid generation:  0.0009672641754150391
local_in_edges_tensor generation:  0.010049819946289062
mini_batch_src_global generation:  0.002526998519897461
r_  generation:  0.011675596237182617
local_output_nid generation:  0.0013225078582763672
local_in_edges_tensor generation:  0.0007004737854003906
mini_batch_src_global generation:  0.0015718936920166016
r_  generation:  0.009562253952026367
local_output_nid generation:  0.0012431144714355469
local_in_edges_tensor generation:  0.0005958080291748047
mini_batch_src_global generation:  0.000995635986328125
r_  generation:  0.008053064346313477
local_output_nid generation:  0.0011510848999023438
local_in_edges_tensor generation:  0.0005817413330078125
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.007983207702636719
local_output_nid generation:  0.0011060237884521484
local_in_edges_tensor generation:  0.0005967617034912109
mini_batch_src_global generation:  0.0009322166442871094
r_  generation:  0.007781267166137695
local_output_nid generation:  0.0010869503021240234
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0009982585906982422
r_  generation:  0.008634805679321289
local_output_nid generation:  0.0010547637939453125
local_in_edges_tensor generation:  0.0005545616149902344
mini_batch_src_global generation:  0.000982522964477539
r_  generation:  0.008153915405273438
local_output_nid generation:  0.0010654926300048828
local_in_edges_tensor generation:  0.0005633831024169922
mini_batch_src_global generation:  0.0009744167327880859
r_  generation:  0.008214950561523438
local_output_nid generation:  0.0010433197021484375
local_in_edges_tensor generation:  0.0005390644073486328
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.008234024047851562
local_output_nid generation:  0.0010330677032470703
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.00098419189453125
r_  generation:  0.008446693420410156
local_output_nid generation:  0.0010662078857421875
local_in_edges_tensor generation:  0.0005764961242675781
mini_batch_src_global generation:  0.0010139942169189453
r_  generation:  0.009932756423950195
local_output_nid generation:  0.0010485649108886719
local_in_edges_tensor generation:  0.0005843639373779297
mini_batch_src_global generation:  0.001069784164428711
r_  generation:  0.00840449333190918
local_output_nid generation:  0.001039266586303711
local_in_edges_tensor generation:  0.0005617141723632812
mini_batch_src_global generation:  0.001046895980834961
r_  generation:  0.0084381103515625
local_output_nid generation:  0.0010221004486083984
local_in_edges_tensor generation:  0.0005598068237304688
mini_batch_src_global generation:  0.0010175704956054688
r_  generation:  0.008279561996459961
local_output_nid generation:  0.0009951591491699219
local_in_edges_tensor generation:  0.0005474090576171875
mini_batch_src_global generation:  0.0009894371032714844
r_  generation:  0.008320331573486328
local_output_nid generation:  0.000997781753540039
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0009613037109375
r_  generation:  0.008223295211791992
local_output_nid generation:  0.0009818077087402344
local_in_edges_tensor generation:  0.0005278587341308594
mini_batch_src_global generation:  0.000997781753540039
r_  generation:  0.008338451385498047
local_output_nid generation:  0.000978231430053711
local_in_edges_tensor generation:  0.0005517005920410156
mini_batch_src_global generation:  0.0009601116180419922
r_  generation:  0.008128643035888672
local_output_nid generation:  0.0009846687316894531
local_in_edges_tensor generation:  0.0005385875701904297
mini_batch_src_global generation:  0.0009057521820068359
r_  generation:  0.008365631103515625
local_output_nid generation:  0.0009615421295166016
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.008226156234741211
local_output_nid generation:  0.0009710788726806641
local_in_edges_tensor generation:  0.0005486011505126953
mini_batch_src_global generation:  0.0009429454803466797
r_  generation:  0.008394718170166016
local_output_nid generation:  0.0009794235229492188
local_in_edges_tensor generation:  0.0005280971527099609
mini_batch_src_global generation:  0.0009195804595947266
r_  generation:  0.008230447769165039
local_output_nid generation:  0.0009388923645019531
local_in_edges_tensor generation:  0.0005347728729248047
mini_batch_src_global generation:  0.000946044921875
r_  generation:  0.008519649505615234
local_output_nid generation:  0.0009357929229736328
local_in_edges_tensor generation:  0.0005476474761962891
mini_batch_src_global generation:  0.0009589195251464844
r_  generation:  0.008540153503417969
local_output_nid generation:  0.0009348392486572266
local_in_edges_tensor generation:  0.0005400180816650391
mini_batch_src_global generation:  0.0009291172027587891
r_  generation:  0.008330106735229492
local_output_nid generation:  0.0009441375732421875
local_in_edges_tensor generation:  0.0005402565002441406
mini_batch_src_global generation:  0.0009222030639648438
r_  generation:  0.008314371109008789
local_output_nid generation:  0.0009431838989257812
local_in_edges_tensor generation:  0.0005357265472412109
mini_batch_src_global generation:  0.0009348392486572266
r_  generation:  0.008318662643432617
local_output_nid generation:  0.0009200572967529297
local_in_edges_tensor generation:  0.0005512237548828125
mini_batch_src_global generation:  0.0009238719940185547
r_  generation:  0.008374929428100586
local_output_nid generation:  0.0009264945983886719
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0009434223175048828
r_  generation:  0.008404731750488281
local_output_nid generation:  0.0009109973907470703
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.0009279251098632812
r_  generation:  0.008346080780029297
local_output_nid generation:  0.000926971435546875
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0009987354278564453
r_  generation:  0.008528709411621094
local_output_nid generation:  0.0009195804595947266
local_in_edges_tensor generation:  0.0005543231964111328
mini_batch_src_global generation:  0.0009720325469970703
r_  generation:  0.0085296630859375
----------------------check_connections_block total spend ----------------------------- 0.45601773262023926
generate_one_block  0.0332789421081543
generate_one_block  0.017606258392333984
generate_one_block  0.015088796615600586
generate_one_block  0.014802217483520508
generate_one_block  0.014446020126342773
generate_one_block  0.015232086181640625
generate_one_block  0.014640569686889648
generate_one_block  0.014851570129394531
generate_one_block  0.01470184326171875
generate_one_block  0.015077829360961914
generate_one_block  0.015271425247192383
generate_one_block  0.015134334564208984
generate_one_block  0.014811038970947266
generate_one_block  0.01459813117980957
generate_one_block  0.014519929885864258
generate_one_block  0.014485597610473633
generate_one_block  0.014459371566772461
generate_one_block  0.014353275299072266
generate_one_block  0.014779806137084961
generate_one_block  0.01452326774597168
generate_one_block  0.014729499816894531
generate_one_block  0.014419078826904297
generate_one_block  0.014946937561035156
generate_one_block  0.015023231506347656
generate_one_block  0.014817476272583008
generate_one_block  0.014704227447509766
generate_one_block  0.014576196670532227
generate_one_block  0.014576435089111328
generate_one_block  0.014603137969970703
generate_one_block  0.014501094818115234
generate_one_block  0.014782428741455078
generate_one_block  0.014915943145751953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033949851989746094
gen group dst list time:  0.02017974853515625
time for parepare:  0.01937580108642578
local_output_nid generation:  0.004496097564697266
local_in_edges_tensor generation:  0.018885135650634766
mini_batch_src_global generation:  0.011499404907226562
r_  generation:  0.11928415298461914
local_output_nid generation:  0.0069544315338134766
local_in_edges_tensor generation:  0.009003162384033203
mini_batch_src_global generation:  0.014892339706420898
r_  generation:  0.12618136405944824
local_output_nid generation:  0.006969451904296875
local_in_edges_tensor generation:  0.025237560272216797
mini_batch_src_global generation:  0.013202667236328125
r_  generation:  0.12546348571777344
local_output_nid generation:  0.007178068161010742
local_in_edges_tensor generation:  0.006841182708740234
mini_batch_src_global generation:  0.01402735710144043
r_  generation:  0.15973424911499023
local_output_nid generation:  0.01090693473815918
local_in_edges_tensor generation:  0.01008152961730957
mini_batch_src_global generation:  0.01750969886779785
r_  generation:  0.14139199256896973
local_output_nid generation:  0.011776924133300781
local_in_edges_tensor generation:  0.010678768157958984
mini_batch_src_global generation:  0.02052450180053711
r_  generation:  0.15435028076171875
local_output_nid generation:  0.013797283172607422
local_in_edges_tensor generation:  0.010529756546020508
mini_batch_src_global generation:  0.018447160720825195
r_  generation:  0.14776611328125
local_output_nid generation:  0.014177799224853516
local_in_edges_tensor generation:  0.010063648223876953
mini_batch_src_global generation:  0.018329858779907227
r_  generation:  0.15032291412353516
local_output_nid generation:  0.011108875274658203
local_in_edges_tensor generation:  0.011554718017578125
mini_batch_src_global generation:  0.018324851989746094
r_  generation:  0.15572428703308105
local_output_nid generation:  0.011477947235107422
local_in_edges_tensor generation:  0.010736465454101562
mini_batch_src_global generation:  0.01892685890197754
r_  generation:  0.15211701393127441
local_output_nid generation:  0.011943340301513672
local_in_edges_tensor generation:  0.010706424713134766
mini_batch_src_global generation:  0.019961833953857422
r_  generation:  0.15219736099243164
local_output_nid generation:  0.012070655822753906
local_in_edges_tensor generation:  0.011815547943115234
mini_batch_src_global generation:  0.01945638656616211
r_  generation:  0.15169882774353027
local_output_nid generation:  0.012075424194335938
local_in_edges_tensor generation:  0.010948419570922852
mini_batch_src_global generation:  0.019640684127807617
r_  generation:  0.15639424324035645
local_output_nid generation:  0.011940717697143555
local_in_edges_tensor generation:  0.009213685989379883
mini_batch_src_global generation:  0.019253253936767578
r_  generation:  0.14461112022399902
local_output_nid generation:  0.011967897415161133
local_in_edges_tensor generation:  0.011207103729248047
mini_batch_src_global generation:  0.02101922035217285
r_  generation:  0.1685161590576172
local_output_nid generation:  0.0176999568939209
local_in_edges_tensor generation:  0.010252714157104492
mini_batch_src_global generation:  0.027040481567382812
r_  generation:  0.1728992462158203
local_output_nid generation:  0.01023101806640625
local_in_edges_tensor generation:  0.017171621322631836
mini_batch_src_global generation:  0.043250083923339844
r_  generation:  0.17654705047607422
local_output_nid generation:  0.00957036018371582
local_in_edges_tensor generation:  0.011955976486206055
mini_batch_src_global generation:  0.036859750747680664
r_  generation:  0.1506507396697998
local_output_nid generation:  0.012417078018188477
local_in_edges_tensor generation:  0.012567758560180664
mini_batch_src_global generation:  0.019721508026123047
r_  generation:  0.17258191108703613
local_output_nid generation:  0.010477066040039062
local_in_edges_tensor generation:  0.009535074234008789
mini_batch_src_global generation:  0.016750335693359375
r_  generation:  0.137437105178833
local_output_nid generation:  0.00858616828918457
local_in_edges_tensor generation:  0.009862422943115234
mini_batch_src_global generation:  0.016087055206298828
r_  generation:  0.14026975631713867
local_output_nid generation:  0.008011341094970703
local_in_edges_tensor generation:  0.007453441619873047
mini_batch_src_global generation:  0.01613903045654297
r_  generation:  0.13704848289489746
local_output_nid generation:  0.008017539978027344
local_in_edges_tensor generation:  0.01048588752746582
mini_batch_src_global generation:  0.017502546310424805
r_  generation:  0.14087867736816406
local_output_nid generation:  0.007944345474243164
local_in_edges_tensor generation:  0.008671283721923828
mini_batch_src_global generation:  0.01681804656982422
r_  generation:  0.14104795455932617
local_output_nid generation:  0.007834196090698242
local_in_edges_tensor generation:  0.009431123733520508
mini_batch_src_global generation:  0.01629638671875
r_  generation:  0.1395258903503418
local_output_nid generation:  0.0078582763671875
local_in_edges_tensor generation:  0.009484052658081055
mini_batch_src_global generation:  0.0166013240814209
r_  generation:  0.1379256248474121
local_output_nid generation:  0.007799625396728516
local_in_edges_tensor generation:  0.007618904113769531
mini_batch_src_global generation:  0.017377376556396484
r_  generation:  0.13872790336608887
local_output_nid generation:  0.007662296295166016
local_in_edges_tensor generation:  0.007323026657104492
mini_batch_src_global generation:  0.016205310821533203
r_  generation:  0.18219566345214844
local_output_nid generation:  0.007528066635131836
local_in_edges_tensor generation:  0.008252859115600586
mini_batch_src_global generation:  0.02068638801574707
r_  generation:  0.13986706733703613
local_output_nid generation:  0.007663726806640625
local_in_edges_tensor generation:  0.007509469985961914
mini_batch_src_global generation:  0.01796555519104004
r_  generation:  0.13952898979187012
local_output_nid generation:  0.007788896560668945
local_in_edges_tensor generation:  0.009612321853637695
mini_batch_src_global generation:  0.01717090606689453
r_  generation:  0.1399681568145752
local_output_nid generation:  0.007750749588012695
local_in_edges_tensor generation:  0.009505748748779297
mini_batch_src_global generation:  0.016568899154663086
r_  generation:  0.14408063888549805
----------------------check_connections_block total spend ----------------------------- 7.132049560546875
generate_one_block  0.1900784969329834
generate_one_block  0.1778275966644287
generate_one_block  0.17672348022460938
generate_one_block  0.2010636329650879
generate_one_block  0.18880248069763184
generate_one_block  0.18388938903808594
generate_one_block  0.1697535514831543
generate_one_block  0.17490196228027344
generate_one_block  0.18115568161010742
generate_one_block  0.17881989479064941
generate_one_block  0.19101810455322266
generate_one_block  0.18265676498413086
generate_one_block  0.18741273880004883
generate_one_block  0.17562127113342285
generate_one_block  0.17337489128112793
generate_one_block  0.1776721477508545
generate_one_block  0.17282533645629883
generate_one_block  0.1690685749053955
generate_one_block  0.17622923851013184
generate_one_block  0.2022693157196045
generate_one_block  0.19877386093139648
generate_one_block  0.17650461196899414
generate_one_block  0.1815810203552246
generate_one_block  0.19098448753356934
generate_one_block  0.17369580268859863
generate_one_block  0.1786036491394043
generate_one_block  0.18618559837341309
generate_one_block  0.1857309341430664
generate_one_block  0.18575358390808105
generate_one_block  0.1782228946685791
generate_one_block  0.17982745170593262
generate_one_block  0.1783609390258789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03760719299316406
gen group dst list time:  0.13017773628234863
time for parepare:  0.0176694393157959
local_output_nid generation:  0.022788047790527344
local_in_edges_tensor generation:  0.043753623962402344
mini_batch_src_global generation:  0.03575778007507324
r_  generation:  0.382246732711792
local_output_nid generation:  0.027414321899414062
local_in_edges_tensor generation:  0.0377347469329834
mini_batch_src_global generation:  0.04606032371520996
r_  generation:  0.3932042121887207
local_output_nid generation:  0.026865720748901367
local_in_edges_tensor generation:  0.031207561492919922
mini_batch_src_global generation:  0.045642852783203125
r_  generation:  0.39267587661743164
local_output_nid generation:  0.02519392967224121
local_in_edges_tensor generation:  0.024017333984375
mini_batch_src_global generation:  0.046475887298583984
r_  generation:  0.39203763008117676
local_output_nid generation:  0.02552485466003418
local_in_edges_tensor generation:  0.02720808982849121
mini_batch_src_global generation:  0.04653477668762207
r_  generation:  0.41240930557250977
local_output_nid generation:  0.02570176124572754
local_in_edges_tensor generation:  0.034893035888671875
mini_batch_src_global generation:  0.049974918365478516
r_  generation:  0.42307329177856445
local_output_nid generation:  0.03399229049682617
local_in_edges_tensor generation:  0.03703618049621582
mini_batch_src_global generation:  0.05782151222229004
r_  generation:  0.4020528793334961
local_output_nid generation:  0.029537439346313477
local_in_edges_tensor generation:  0.03210020065307617
mini_batch_src_global generation:  0.05002093315124512
r_  generation:  0.40129971504211426
local_output_nid generation:  0.02967071533203125
local_in_edges_tensor generation:  0.03515458106994629
mini_batch_src_global generation:  0.046689748764038086
r_  generation:  0.4042198657989502
local_output_nid generation:  0.029575347900390625
local_in_edges_tensor generation:  0.03196597099304199
mini_batch_src_global generation:  0.04694819450378418
r_  generation:  0.40350866317749023
local_output_nid generation:  0.029615163803100586
local_in_edges_tensor generation:  0.028834819793701172
mini_batch_src_global generation:  0.05018806457519531
r_  generation:  0.413820743560791
local_output_nid generation:  0.029894113540649414
local_in_edges_tensor generation:  0.024760007858276367
mini_batch_src_global generation:  0.04730844497680664
r_  generation:  0.41498279571533203
local_output_nid generation:  0.03135848045349121
local_in_edges_tensor generation:  0.02464127540588379
mini_batch_src_global generation:  0.05015110969543457
r_  generation:  0.41617298126220703
local_output_nid generation:  0.030335664749145508
local_in_edges_tensor generation:  0.034821510314941406
mini_batch_src_global generation:  0.048987388610839844
r_  generation:  0.41351866722106934
local_output_nid generation:  0.03142738342285156
local_in_edges_tensor generation:  0.03241729736328125
mini_batch_src_global generation:  0.048134565353393555
r_  generation:  0.4051063060760498
local_output_nid generation:  0.02734088897705078
local_in_edges_tensor generation:  0.03521418571472168
mini_batch_src_global generation:  0.05179429054260254
r_  generation:  0.40706825256347656
local_output_nid generation:  0.027227401733398438
local_in_edges_tensor generation:  0.03215622901916504
mini_batch_src_global generation:  0.046526432037353516
r_  generation:  0.4039647579193115
local_output_nid generation:  0.02704787254333496
local_in_edges_tensor generation:  0.024134397506713867
mini_batch_src_global generation:  0.04707670211791992
r_  generation:  0.4002523422241211
local_output_nid generation:  0.0270845890045166
local_in_edges_tensor generation:  0.02725505828857422
mini_batch_src_global generation:  0.046621084213256836
r_  generation:  0.4193229675292969
local_output_nid generation:  0.02719593048095703
local_in_edges_tensor generation:  0.031630516052246094
mini_batch_src_global generation:  0.04672503471374512
r_  generation:  0.4016244411468506
local_output_nid generation:  0.027069091796875
local_in_edges_tensor generation:  0.02796626091003418
mini_batch_src_global generation:  0.04640674591064453
r_  generation:  0.4033019542694092
local_output_nid generation:  0.027295589447021484
local_in_edges_tensor generation:  0.03130626678466797
mini_batch_src_global generation:  0.04712510108947754
r_  generation:  0.4038999080657959
local_output_nid generation:  0.03465986251831055
local_in_edges_tensor generation:  0.02863907814025879
mini_batch_src_global generation:  0.04741954803466797
r_  generation:  0.4116377830505371
local_output_nid generation:  0.027606964111328125
local_in_edges_tensor generation:  0.033138275146484375
mini_batch_src_global generation:  0.048562049865722656
r_  generation:  0.4109787940979004
local_output_nid generation:  0.028738975524902344
local_in_edges_tensor generation:  0.028892040252685547
mini_batch_src_global generation:  0.04764413833618164
r_  generation:  0.42743587493896484
local_output_nid generation:  0.027292490005493164
local_in_edges_tensor generation:  0.03401327133178711
mini_batch_src_global generation:  0.053717613220214844
r_  generation:  0.40706300735473633
local_output_nid generation:  0.0281832218170166
local_in_edges_tensor generation:  0.03237771987915039
mini_batch_src_global generation:  0.04752039909362793
r_  generation:  0.4020249843597412
local_output_nid generation:  0.027211427688598633
local_in_edges_tensor generation:  0.0316925048828125
mini_batch_src_global generation:  0.0472264289855957
r_  generation:  0.4026670455932617
local_output_nid generation:  0.026964187622070312
local_in_edges_tensor generation:  0.02476215362548828
mini_batch_src_global generation:  0.04738283157348633
r_  generation:  0.4024991989135742
local_output_nid generation:  0.02725362777709961
local_in_edges_tensor generation:  0.02730107307434082
mini_batch_src_global generation:  0.047363996505737305
r_  generation:  0.40182042121887207
local_output_nid generation:  0.026980876922607422
local_in_edges_tensor generation:  0.028833866119384766
mini_batch_src_global generation:  0.07599878311157227
r_  generation:  0.4054710865020752
local_output_nid generation:  0.026990652084350586
local_in_edges_tensor generation:  0.03150629997253418
mini_batch_src_global generation:  0.05338644981384277
r_  generation:  0.40659594535827637
----------------------check_connections_block total spend ----------------------------- 19.310750007629395
generate_one_block  0.5477731227874756
generate_one_block  0.5418312549591064
generate_one_block  0.5293619632720947
generate_one_block  0.5265135765075684
generate_one_block  0.6508777141571045
generate_one_block  0.5414907932281494
generate_one_block  0.5218541622161865
generate_one_block  0.5381784439086914
generate_one_block  0.5408599376678467
generate_one_block  0.5443718433380127
generate_one_block  0.5461299419403076
generate_one_block  0.5350286960601807
generate_one_block  0.5428066253662109
generate_one_block  0.527195930480957
generate_one_block  0.5201501846313477
generate_one_block  0.543123722076416
generate_one_block  0.5322611331939697
generate_one_block  0.5205948352813721
generate_one_block  0.5243866443634033
generate_one_block  0.5585982799530029
generate_one_block  0.5265100002288818
generate_one_block  0.5468389987945557
generate_one_block  0.5535788536071777
generate_one_block  0.5302338600158691
generate_one_block  0.5490245819091797
generate_one_block  0.5372538566589355
generate_one_block  0.5234065055847168
generate_one_block  0.5309882164001465
generate_one_block  0.5363085269927979
generate_one_block  0.5301601886749268
generate_one_block  0.522324800491333
generate_one_block  0.5410065650939941
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.12182903289794922  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

connection checking time:  26.44279956817627
block generation total time  23.086413145065308
average batch blocks generation time:  0.7214504107832909
block dataloader generation time/epoch 52.2112352848053
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10394620895385742  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145664, 128])
torch.Size([98705, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.641545295715332  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10305309295654297  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145408, 128])
torch.Size([99471, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.808136463165283  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10390090942382812  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145902, 128])
torch.Size([99111, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.558571338653564  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.102081298828125  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([143698, 128])
torch.Size([96968, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.531760215759277  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10384941101074219  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145494, 128])
torch.Size([98434, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.432498931884766  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10392570495605469  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145081, 128])
torch.Size([99115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.995269775390625  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10263824462890625  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([144874, 128])
torch.Size([97949, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.520832538604736  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10325145721435547  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145940, 128])
torch.Size([99920, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.646535396575928  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10399818420410156  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([146273, 128])
torch.Size([100290, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.707040309906006  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10414457321166992  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145583, 128])
torch.Size([99871, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.919273853302002  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10506010055541992  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145939, 128])
torch.Size([100516, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 16.060529232025146  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10295629501342773  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145209, 128])
torch.Size([99097, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.78891372680664  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10390758514404297  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145075, 128])
torch.Size([99283, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.92507791519165  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10276079177856445  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145319, 128])
torch.Size([98076, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.425857543945312  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10267353057861328  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([144916, 128])
torch.Size([98362, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.503183364868164  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10323190689086914  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145869, 128])
torch.Size([99296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.711341857910156  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10394668579101562  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145590, 128])
torch.Size([99495, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.6113920211792  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10276508331298828  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145164, 128])
torch.Size([98507, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.514400005340576  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10278081893920898  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145131, 128])
torch.Size([98505, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.596296787261963  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10308027267456055  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145715, 128])
torch.Size([99110, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.565890312194824  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10393524169921875  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145728, 128])
torch.Size([98624, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.647243022918701  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10326719284057617  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145935, 128])
torch.Size([99914, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.719297409057617  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10501575469970703  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145803, 128])
torch.Size([99964, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.869941711425781  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10403013229370117  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145329, 128])
torch.Size([99521, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.9607834815979  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10500144958496094  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145865, 128])
torch.Size([99852, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.806625843048096  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10397100448608398  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145304, 128])
torch.Size([99522, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.774717807769775  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10293006896972656  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145160, 128])
torch.Size([98808, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.79383134841919  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.1031184196472168  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145629, 128])
torch.Size([99360, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.749494075775146  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10287714004516602  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145099, 128])
torch.Size([98671, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.754778385162354  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10324764251708984  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145962, 128])
torch.Size([99489, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.638805389404297  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10399818420410156  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([145421, 128])
torch.Size([99045, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.763478755950928  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 0.10382699966430664  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

torch.Size([144953, 128])
torch.Size([98854, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 15.833152770996094  GigaBytes
Max Memory Allocated: 16.179271697998047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03373614698648453 |0.013957642018795013 |0.27073823660612106 |0.00010018795728683472 |0.4732799455523491 |0.004917144775390625 |
----------------------------------------------------------pseudo_mini_loss sum 3.8637795448303223
Total (block generation + training)time/epoch 77.60443353652954
Training time/epoch 25.39294195175171
Training time without block to device /epoch 24.94629740715027
Training time without total dataloading part /epoch 23.816704988479614
load block tensor time/epoch 1.0795567035675049
block to device time/epoch 0.44664454460144043
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8577168
Number of first layer input nodes during this epoch:  4654032
